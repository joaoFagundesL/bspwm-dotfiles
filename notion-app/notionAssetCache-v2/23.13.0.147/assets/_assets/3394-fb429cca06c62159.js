"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[3394],{62967:(e,t,n)=>{n.d(t,{$J:()=>D,CJ:()=>O,MV:()=>E,N$:()=>F,RE:()=>C,aS:()=>Z,cN:()=>P,cs:()=>M,kv:()=>B,q7:()=>V,zz:()=>x});n(67294);var o=n(41432),i=n(9291),r=n(31701),a=n(1898),s=n(13447),l=n(40663),c=n(93405),d=n(48019),u=n(52275),p=n(78140),m=n(40721),f=n(86825),g=n(26388),h=n(42782),v=n(95477),b=n(19037),y=n(47853),_=n(33929),S=n(60709),w=n(98742),k=n(5162),I=n(85893);const C=(0,i.defineMessages)({deleteName:{id:"action.delete.name",defaultMessage:"Delete"},undoName:{id:"action.undo.name",defaultMessage:"Undo"},redoName:{id:"action.redo.name",defaultMessage:"Redo"},duplicateName:{id:"action.duplicate.name",defaultMessage:"Duplicate"},duplicateToPrivateName:{id:"action.duplicateToPrivate.name",defaultMessage:"Duplicate to Private"},turnIntoName:{id:"action.turnInto.name",defaultMessage:"Turn into"},copyLinkName:{id:"action.copyLink.name",defaultMessage:"Copy link to block"},copyLinkNavigableTypeName:{id:"action.copyLinkNavigableType.name",defaultMessage:"Copy link"},showCodePreviewFormat:{id:"action.showCodePreviewFormat.name",defaultMessage:"Preview"},showOnlyCodeFormat:{id:"action.showOnlyCodeFormat.name",defaultMessage:"Code"},showSplitViewFormat:{id:"action.showSplitViewFormat.name",defaultMessage:"Split"},searchPlaceholder:{defaultMessage:"Search for a languageâ€¦",id:"codeBlock.searchPrompt"},backgroundColorDefaultKeywords:{id:"action.backgroundColor.default.fuzzySearchKeyword",defaultMessage:"Default Black White"},foregroundColorGrayKeywords:{id:"action.foregroundColor.gray.fuzzySearchKeyword",defaultMessage:"Grey Gray"},backgroundColorGrayKeywords:{id:"action.backgroundColor.gray.fuzzySearchKeyword",defaultMessage:"Grey Gray background Greybackground Graybackground"},foregroundColorBrownKeywords:{id:"action.foregroundColor.brown.fuzzySearchKeyword",defaultMessage:"Brown"},backgroundColorBrownKeywords:{id:"action.backgroundColor.brown.fuzzySearchKeyword",defaultMessage:"Brown background Brownbackground"},foregroundColorOrangeKeywords:{id:"action.foregroundColor.orange.fuzzySearchKeyword",defaultMessage:"Orange"},backgroundColorOrangeKeywords:{id:"action.backgroundColor.orange.fuzzySearchKeyword",defaultMessage:"Orange background Orangebackground"},foregroundColorYellowKeywords:{id:"action.foregroundColor.yellow.fuzzySearchKeyword",defaultMessage:"Yellow"},backgroundColorYellowKeywords:{id:"action.backgroundColor.yellow.fuzzySearchKeyword",defaultMessage:"Yellow background Yellowbackground"},foregroundColorTealKeywords:{id:"action.foregroundColor.teal.fuzzySearchKeyword",defaultMessage:"Teal green"},backgroundColorTealKeywords:{id:"action.backgroundColor.teal.fuzzySearchKeyword",defaultMessage:"Teal green background Tealbackground Greenbackground"},foregroundColorBlueKeywords:{id:"action.foregroundColor.blue.fuzzySearchKeyword",defaultMessage:"Blue"},backgroundColorBlueKeywords:{id:"action.backgroundColor.blue.fuzzySearchKeyword",defaultMessage:"Blue background Bluebackground"},foregroundColorPurpleKeywords:{id:"action.foregroundColor.purple.fuzzySearchKeyword",defaultMessage:"Purple"},backgroundColorPurpleKeywords:{id:"action.backgroundColor.purple.fuzzySearchKeyword",defaultMessage:"Purple background Purplebackground"},foregroundColorPinkKeywords:{id:"action.foregroundColor.pink.fuzzySearchKeyword",defaultMessage:"Pink"},backgroundColorPinkKeywords:{id:"action.backgroundColor.pink.fuzzySearchKeyword",defaultMessage:"Pink background Pinkbackground"},foregroundColorRedKeywords:{id:"action.foregroundColor.red.fuzzySearchKeyword",defaultMessage:"Red"},backgroundColorRedKeywords:{id:"action.backgroundColor.red.fuzzySearchKeyword",defaultMessage:"Red background Redbackground"},backgroundSectionKeywords:{id:"action.section.background.fuzzySearchKeywords",defaultMessage:"Color Background"},backgroundSection:{id:"action.section.background",defaultMessage:"Background"},colorSection:{id:"action.section.color",defaultMessage:"Color"},colorName:{id:"action.color.name",defaultMessage:"Color"},duplicateCollectionSchemaOnlyName:{id:"action.duplicateSchemaOnly.name",defaultMessage:"Duplicate without content"},duplicateCollectionWithDataName:{id:"action.duplicateWithData.name",defaultMessage:"Duplicate with content"}});function x(e){let{title:t}=e;return t}const T={maxWidth:400,whiteSpace:"pre-wrap"};function M(e){const{key:t,displayName:n,displayNameInterpolatedValues:o,contextualDisplayName:i,analyticsName:r,analyticsActionType:a,fuzzySearchKeywords:s,svg:l,svgCustomFill:c,validators:d,shortcuts:u,sortScoreMultiplier:p,closeParentMenu:m,action:f,subActions:g,collapseSubActionsIntoParent:h,nativeImageReference:v,alwaysShowInSearch:b,right:y,renderTooltip:_,userProvidedSearchName:S,hideFromSlashActionMenu:w}=e,{formattedDisplayName:k,searchName:I}=A({displayName:n,displayNameInterpolatedValues:o,userProvidedSearchName:S,fuzzySearchKeywords:s});return{key:`action ${t}`,displayName:k,analyticsName:r,analyticsActionType:a,searchName:I,validators:d,shortcuts:u,sortScoreMultiplier:p,action:f,subActions:g,collapseSubActionsIntoParent:h,closeParentMenu:m,render:e.render??R({svg:l,svgCustomFill:c,formattedDisplayName:k,right:y,contextualDisplayName:i,shortcut:u[0],renderTooltip:_}),nativeImageReference:v,alwaysShowInSearch:b,hideFromSlashActionMenu:w}}function P(e){const{key:t,displayName:n,displayNameInterpolatedValues:o,contextualDisplayName:i,analyticsName:r,analyticsActionType:a,fuzzySearchKeywords:s,svg:l,validators:c,sortScoreMultiplier:d,closeParentMenu:u,action:p,subActions:m,collapseSubActionsIntoParent:f,nativeImageReference:g,alwaysShowInSearch:h,right:v,renderTooltip:b,userProvidedSearchName:y}=e,{formattedDisplayName:_,searchName:S}=A({displayName:n,displayNameInterpolatedValues:o,userProvidedSearchName:y,fuzzySearchKeywords:s});return{key:`action ${t}`,displayName:_,analyticsName:r,analyticsActionType:a,searchName:S,validators:c,sortScoreMultiplier:d,action:p,subActions:m,collapseSubActionsIntoParent:f,closeParentMenu:u,render:e.render??R({svg:l,formattedDisplayName:_,right:v,contextualDisplayName:i,renderTooltip:b}),nativeImageReference:g,alwaysShowInSearch:h}}function A(e){const{displayName:t,displayNameInterpolatedValues:n,fuzzySearchKeywords:o,userProvidedSearchName:i}=e,r=t?_.default.formatMessage(t,n):void 0,a=o||t,s=o?_.default.formatMessage(o):r;let l=i;return l||(l=a?s===a.defaultMessage?s:`${s} ${a.defaultMessage}`:void 0),{formattedDisplayName:r,searchName:l}}function R(e){const{formattedDisplayName:t,svg:n,svgCustomFill:o,shortcut:i,right:r,renderTooltip:a}=e;return(s,l,d)=>{const u=(e.contextualDisplayName?e.contextualDisplayName(l):void 0)||t;return(0,I.jsx)(g.ZP,{render:e=>(0,I.jsx)(c.Z,{...(0,w.Z)(s,e),title:u,svg:n,svgCustomFill:o,shortcut:i,right:"function"==typeof r?r(s,l,d):r}),renderTooltip:()=>(0,I.jsx)("div",{style:T,children:null==a?void 0:a({title:u})}),disableTooltip:!a,placement:g.ug.Right})}}function D(e){const{key:t,title:n,overrideSearchTitle:o,render:i,actions:r}=e,a=n?_.default.formatMessage(n):void 0,s=o||n,l=s&&_.default.formatMessage(s);return{key:t,title:a,searchTitle:s?l===s.defaultMessage?l:`${l} ${s.defaultMessage}`:void 0,render:i,actions:r}}function E(e){const{key:t,displayName:n,displayNameInterpolatedValues:o,analyticsName:i,validators:r,subActions:a,collapseSubActionsIntoParent:s,svg:l,icon:f,right:g,rightStyle:v,width:b,initialFocus:y}=e,_=P({key:`extension ${t}`,displayName:n,displayNameInterpolatedValues:o,analyticsName:i,validators:r,subActions:a,collapseSubActionsIntoParent:s,closeParentMenu:!0,action:()=>{},render:(e,t,n)=>(0,I.jsx)(h.Z,{...e,renderOrigin:(e,t)=>l?(0,I.jsx)(c.Z,{...e,title:_.displayName,svg:l,right:g,rightStyle:v,ref:t}):(0,I.jsx)(u.Z,{...e,title:_.displayName,icon:f,right:g,rightStyle:v,ref:t}),onFocus:n.onFocus,renderExtension:(e,o)=>{let i;return i=t.environment.device.isPhone?{menuType:S.og.Modal,right:(0,I.jsx)(m.DoneMenuText,{}),onClickRight:o.close,...e}:{menuType:S.og.Popup,width:b??220,...e},(0,I.jsx)(p.Z,{...i,children:(0,I.jsx)(d.Z,{initialFocus:y??0,context:t,sections:a(t),onAccept:n.onAccept})})}})});return _}const B=[b.ffD(b.P99(o.Ti.externalObjectInstancePage)),b.ffD(b.K5G),b.J5S,b.ffD((e=>e.blocks.some((e=>e.isDefined()&&(0,l.h7)(e))))),b.vdd];function F(e){return P({key:`format ${e.key}`,displayName:e.displayName,analyticsName:e.displayName.defaultMessage,validators:e.validators,render:(t,n,o)=>{let{blocks:i,environment:r}=n;const a=i[0],s=e.isEnabled(a),{isMobile:l}=r.device;return(0,I.jsx)(f.Z,{...t,title:e.label,icon:e.svg?(0,I.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.svg({width:l?20:17,height:l?20:17})}):void 0,on:s})},closeParentMenu:!1,action:t=>{let{environment:n,blocks:o}=t;s.createAndCommit({userAction:"actionRegistry.createToggleAction",environment:n,perform:t=>{var i;const r=o[0],a=!e.isEnabled(r);e.action(n,r,t),null===(i=e.afterAction)||void 0===i||i.call(e,a,n)}})}})}function O(e){switch(e){case"default":return C.backgroundColorDefaultKeywords;case"gray":return C.foregroundColorGrayKeywords;case"gray_background":return C.backgroundColorGrayKeywords;case"brown":return C.foregroundColorBrownKeywords;case"brown_background":return C.backgroundColorBrownKeywords;case"orange":return C.foregroundColorOrangeKeywords;case"orange_background":return C.backgroundColorOrangeKeywords;case"yellow":return C.foregroundColorYellowKeywords;case"yellow_background":return C.backgroundColorYellowKeywords;case"teal":return C.foregroundColorTealKeywords;case"teal_background":return C.backgroundColorTealKeywords;case"blue":return C.foregroundColorBlueKeywords;case"blue_background":return C.backgroundColorBlueKeywords;case"purple":return C.foregroundColorPurpleKeywords;case"purple_background":return C.backgroundColorPurpleKeywords;case"pink":return C.foregroundColorPinkKeywords;case"pink_background":return C.backgroundColorPinkKeywords;case"red":return C.foregroundColorRedKeywords;case"red_background":return C.backgroundColorRedKeywords;default:return(0,a.t1)(e)}}function Z(e){const t=e.thumbnail?(0,y.D)(null==e?void 0:e.thumbnail):void 0,n=Boolean(void 0!==t&&/^https?:\/\//.test(t));return{remoteImageUrl:t?`${n?"":v.default.domainBaseUrl}${t}`:void 0,localAssetBundleImagePath:n?void 0:t}}function V(e,t,n){const o=e.device.isAndroid&&!(0,k.Y)("supportsNativeMobileDynamicActionBar")?(0,r.gh)({theme:"light"}):(0,r.gh)({theme:e.ThemeStore.state.mode}),i=(0,r.fi)(t,o);let a,s,l;const c="default"!==t;t.includes("background")||null!=n&&n.includes("background")?(a="background",s=c?"square.fill":"square",l="textBackgroundColor"):(a="color",s="character",l="textColor");const d=a in i?i[a]:void 0,u=d&&(0,r.J1)(d);return{sfProGlyphName:s,localImageIdentifier:l,imageTintColor:c?u:void 0}}},52229:(e,t,n)=>{n.d(t,{k:()=>p});n(21703);var o=n(15145),i=n(41432),r=n(21202),a=n(70279),s=n(7032),l=n(95477),c=n(98165),d=n(6258),u=n(9953);function p(e){const{environment:t,parentBlock:n,targetStore:p,transaction:m}=e;if(!p.isDefined())throw new Error("Target store was not defined.");if(!n.isDefined())throw new Error("Parent block store was not defined.");const f=(0,s.ZP)(),g=p instanceof d.G;let h;if(!g){if(c.Dg(p)&&p.isDefined()){const e=p.getParentStore(),t=null==e?void 0:e.getParentStore();var v;if(null!=e&&e.isDefined())h=null==t||null===(v=t.getModel())||void 0===v?void 0:v.getRenderUrl({getRecordModel:p.getRecordModel,baseUrl:l.default.domainBaseUrl,discussionId:e.id,pageVisitSource:o.tY.LinkInPage})}}return u.j4({environment:t,id:f,type:i.Ti.alias,format:{alias_pointer:{table:g?r.iU:a.x_,id:p.id,spaceId:p.getSpaceId()},comment_alias_url:h},spaceId:n.getSpaceId(),useCrdt:n.useCrdt(),inMemoryRecordCache:n.inMemoryRecordCache,transaction:m}),d.G.createChildStore(n.getContentStore(),{table:r.iU,id:f,spaceId:n.getSpaceId()})}},88150:(e,t,n)=>{n.d(t,{x:()=>c,b:()=>l});var o=n(14976),i=n(58202),r=n(85305),a=n(97978);var s=n(24677);function l(e){let{blockStore:t,entrypoint:n,environment:o}=e;const i=!t.getPropertyValue("alt_text");r.Z.setState({open:!0,blockStore:t,originRect:d(t),isEmptyOnOpen:i}),function(e,t){a.j(e,"alt_text_open",t)}(o,{entrypoint:n,is_empty:i})}function c(e){let t=0,n=!1;const i=r.Z.state.blockStore;r.Z.state.open&&null!=i&&i.getPropertyValue("alt_text")&&(t=(0,o.Xh)(i.getPropertyValue("alt_text"),i).length,n=r.Z.state.isEmptyOnOpen),function(e,t){a.j(e,"alt_text_close",t)}(e,{number_of_characters:t,did_create:n}),r.Z.setState({open:!1,blockStore:i}),s.ZH(e)}function d(e){var t;const n=i.R.findNodeFromStore(e);return n&&n instanceof Element?null===(t=n.querySelector(".altTextBlockButton"))||void 0===t?void 0:t.getBoundingClientRect():void 0}},36610:(e,t,n)=>{n.d(t,{NM:()=>b,XW:()=>v,ie:()=>h,vN:()=>ct,j_:()=>pt,gL:()=>dt,jd:()=>ut,tn:()=>Ee,dh:()=>M,eT:()=>A,YU:()=>Z,Op:()=>We,Zz:()=>at,Rb:()=>Ke,sd:()=>B,ze:()=>K,tM:()=>G,ik:()=>W,fM:()=>_e,$X:()=>Se,$q:()=>U,en:()=>ye,Zr:()=>ve,yj:()=>be,wd:()=>N,By:()=>Ye,P_:()=>it,xh:()=>Me,_H:()=>V,xb:()=>j,sG:()=>F,y9:()=>L,Rc:()=>q,YO:()=>_,rv:()=>O,ct:()=>k,UJ:()=>R,YM:()=>ke,RO:()=>we,PL:()=>Ae,Py:()=>x,Bb:()=>y,Md:()=>Xe,y4:()=>et,Lf:()=>lt,uD:()=>le,iA:()=>Ie,FT:()=>Pe,du:()=>Be,Hc:()=>Fe,K9:()=>T,DC:()=>st,V:()=>qe,Ji:()=>H,sS:()=>$e,kq:()=>Ge,DB:()=>He,Fj:()=>Qe,V_:()=>P,y:()=>tt,VJ:()=>ze,iS:()=>S,dw:()=>ue,gP:()=>me,ZZ:()=>$,XX:()=>ge,WF:()=>pe,yT:()=>de,ud:()=>fe,K1:()=>ce,P$:()=>he,n2:()=>Te,wy:()=>xe,TJ:()=>je,R9:()=>rt,gl:()=>Le,mt:()=>D,qD:()=>ot,KI:()=>Ne,n4:()=>Ve,IM:()=>Ce,f7:()=>Je,fE:()=>mt,JE:()=>se,a_:()=>ae,_k:()=>re,lf:()=>ie,LE:()=>oe,ne:()=>ne,gw:()=>te,Al:()=>X,H6:()=>J,CB:()=>ee,iR:()=>Q,zI:()=>Y,Jr:()=>I,l7:()=>Ue,g0:()=>Ze,jR:()=>C,g_:()=>Re,Af:()=>De,tx:()=>Oe,Mz:()=>E,r5:()=>z,nl:()=>w});var o=n(1302),i=n(9852),r=n(7032),a=n(97978),s=n(28020),l=n(75079),c=n(12955);const d="REDACTED";function u(e){e.childNodes.forEach((e=>{e.nodeType===Node.TEXT_NODE?e.replaceWith(d):e.nodeType===Node.ELEMENT_NODE&&u(e)}))}function p(e){const t=(new DOMParser).parseFromString(e,"text/html").body;return u(t),t.innerHTML}var m=n(77080),f=n(27724),g=n(17224);function h(e,t){a.$A({environment:e,userId:(0,r.F9)(t.user_id),traits:{...t,...t.tags?{original_tags:t.tags}:void 0,user_id:(0,r.F9)(t.user_id)}})}function v(e,t){a.$A({environment:e,userId:(0,r.F9)(t.user_id),traits:{...t,user_id:(0,r.F9)(t.user_id)}})}async function b(){await a.NM()}async function y(e){const{environment:t,experiment_id:n,experiment_group:o,experiment_version:r,logging_source:s}=e,l=(0,i.Ag)(n),d=await c.getExperimentDeviceId(t);Boolean(l)&&l===(0,i.So)(r,o)||(a.j(t,"experiment_exposure",{experiment_id:n,experiment_group:o,experiment_version:r,experiment_device_id:d,logging_source:s}),(0,i.UJ)(n,o,r))}function _(e){a.j(e,"delete_workspace_click"),m.default.logEvent("delete_workspace_click")}function S(e){a.j(e,"quick_workspace_creation_click"),m.default.logEvent("quick_workspace_creation_click")}function w(e){a.j(e,"workspace_invite_copy_link"),m.default.logEvent("workspace_invite_copy_link")}function k(e,t){a.lu(e,"edit_block_text_60","edit_block_text_60",60,t)}function I(e,t){a.j(e,"todo_block_check",t)}function C(e,t){a.j(e,"toggle_block_toggle")}function x(e,t){a.j(e,"equation_block_edit",t)}function T(e,t){a.j(e,"view_link_preview",t)}function M(e,t){o.default.afterNextFlush((()=>{let n;const o=f.default.state.stores[0];o&&(n=o.getType());const{parentTeamStore:i,...r}=t;g.ej(e,"block_action",`block_action-${t.analyticsName}-${t.from}-${t.block_id}`,60,{store:i,...r,final_block_type:n})}))}function P(e){a.j(e,"open_slash_menu")}function A(e){a.j(e,"click_add_menu")}function R(e,t){a.j(e,"edit_lock_toggle",t)}function D(e,t){a.j(e,"rich_text_menu_click",t)}function E(e,t){a.j(e,"update_page_section_visibility",t)}function B(e,t,n){a.j(e,t,n)}function F(e,t){a.j(e,"board_item_delete_newly_created",t)}function O(e,t,n){if(!0===n)a.j(e,"edit_block_property_60",t);else{const n=(0,s.zj)(),{property_type:o,collection_id:i,collection_view_id:r}=t;a.lu(e,"edit_block_property_60",`edit_block_property_60-${n||""}-${o||""}-${i||""}-${r||""}`,60,t)}}function Z(e,t){a.j(e,"click_block_property_url",t)}function V(e,t){a.j(e,"create_property",t),m.default.logEvent("create_property",String(Boolean(t.is_suggested_property)),t)}function U(e,t){a.j(e,"configure_property",t)}function L(e,t){a.j(e,"delete_property",t),m.default.logEvent("delete_property")}function j(e,t){a.j(e,"create_view",t)}function N(e,t){a.j(e,"configure_view",t)}function z(e,t){a.j(e,"view_settings",t),m.default.logEvent("view_settings",t.menu,t)}function q(e,t){a.j(e,"delete_view",t)}function W(e,t){a.j(e,"collection_search",t)}function H(e,t){a.j(e,"open_collection_as_page",t)}function K(e){a.j(e,"collection_no_date_menu_add")}function G(e){a.j(e,"collection_no_date_menu_view")}function $(e,t){a.j(e,"relation_database_click",t)}function Q(e,t){a.lu(e,"timeline_view","timeline_view",5,t)}function Y(e,t){a.j(e,"timeline_zoom_level_update",t)}function J(e,t){a.j(e,"timeline_today_click",t)}function X(e,t){a.j(e,"timeline_shift_time_click",t)}function ee(e,t){a.j(e,"timeline_toggle_table_click",t)}function te(e,t){a.j(e,"timeline_item_scroll_arrow_click",t)}function ne(e,t){a.j(e,"timeline_item_resize",t)}function oe(e,t){a.j(e,"timeline_dependency_arrow_add",t)}function ie(e,t){a.j(e,"timeline_dependency_arrow_delete",t)}function re(e,t){a.j(e,"subitem_toggle_block_open",t)}function ae(e,t){a.j(e,"subitem_toggle_block_close",t)}function se(e,t){a.j(e,"create_subitem",t)}function le(e){a.j(e,"inline_collection_load_more_click")}function ce(e,t){a.j(e,"relation_show_as",t)}function de(e,t){a.j(e,"relation_reorder",t)}function ue(e,t){a.j(e,"relation_add_block",t)}function pe(e,t){a.j(e,"relation_remove_block",t)}function me(e,t){a.j(e,"relation_customize_displayed_properties",t)}function fe(e,t){a.j(e,"relation_section_link_pages",t)}function ge(e,t){a.j(e,"relation_navigate_block",t)}function he(e,t){a.j(e,"relation_update_property_visibility",t)}function ve(e,t){a.j(e,"configure_rollup_relation",t)}function be(e,t){a.j(e,"configure_rollup_target_property",t)}function ye(e,t){a.j(e,"configure_rollup_aggregation",t)}function _e(e,t){a.j(e,"collection_table_drag_and_fill",t)}function Se(e,t){a.j(e,"complete_sprint_action",t)}function we(e,t){const{collectionContextStore:n}=t.optionalAnalyticsProperties||{},o=(0,l.Pn)(n)||{},i={from:t.from,block_types:t.draggedTypes,block_count:t.draggedTypes.length,as_copy:t.asCopy||!1,draggable:t.draggableProps,dropzone:t.dropzoneProps,...o};a.j(e,"drag",i)}function ke(e,t){a.j(e,"click_selection_menu",{block_type:t.blockType})}function Ie(e,t){a.j(e,"inline_equation_edit",t)}function Ce(e,t){a.j(e,"set_reminder",{date:t.date,reminder:t.reminder})}function xe(e){a.j(e,"resize_column")}function Te(e){a.j(e,"reset_column_sizes")}function Me(e){a.j(e,"create_column_list")}function Pe(e,t){a.j(e,"insert_column",t)}function Ae(e,t){a.j(e,"drag_near_edge_scroll",t)}function Re(e,t){a.j(e,"transform_text_block_filter",t)}function De(e,t){a.j(e,"unicode_filter",t)}function Ee(e,t){a.j(e,"annotation_filter",t)}function Be(e,t){a.j(e,"keyboard_annotation",t)}function Fe(e,t){a.j(e,"link_filter",t)}function Oe(e,t){a.j(e,"change_email",t)}function Ze(e,t){a.j(e,"toggle_allow_search_engine_indexing",t)}function Ve(e,t){a.j(e,"set_expiration_time_on_public_page",t)}function Ue(e,t){a.j(e,"toggle_allow_duplicate",t)}function Le(e,t){a.j(e,"restrict_permissions",t)}function je(e,t){a.j(e,"restore_permissions",t)}function Ne(e,t){a.j(e,"set_database_sync_permissions",t)}function ze(e,t){let{source:n,types:o,fileExtensions:i,htmlContent:r}=t;const s=p(r),l=s.substring(0,m.default.getConfigKey("paste_event_logging","redactedHtmlMaxSize")),c=[...o];c.sort();const d=i.map((e=>e.toLowerCase()));a.UG(e,"paste",m.default.getConfigKey("paste_event_logging","samplePercentage"),{source:n,types:c,file_extensions:d,redacted_html_content:l,original_html_content_size:r.length,truncated:l.length!==s.length})}function qe(e){a.j(e,"open_breadcrumb_current_page_menu")}function We(e){a.j(e,"click_breadcrumb_current_page_scroll_to_top")}function He(e,t){a.j(e,"open_page_share",t),m.default.logEvent("open_page_share")}function Ke(e,t){a.j(e,"close_page_share",t)}function Ge(e){a.j(e,"open_more_menu")}function $e(e){a.j(e,"open_more_connections_menu")}function Qe(e){a.j(e,"open_public_more_menu")}function Ye(e){a.j(e,"confirm_app_update")}function Je(e,t){a.j(e,"show_page_reload_confirmation_dialog",t)}function Xe(e,t){a.j(e,"export",t)}function et(e,t){a.j(e,"export_failed",t)}function tt(e,t){a.j(e,"open_history",{from:t})}function nt(e){return Date.now()-parseInt(e.timestamp)}function ot(e,t){a.j(e,"select_snapshot",{ageMs:nt(t)})}function it(e,t){a.j(e,"history_copy",{ageMs:nt(t)})}function rt(e,t){a.j(e,"restore_snapshot",{ageMs:nt(t)})}function at(e,t){var n;a.j(e,"fork_page",{blockId:t},{dontWait:!0}),m.default.logEvent("fork_page",null===(n=document.location)||void 0===n||null===(n=n.host)||void 0===n||null===(n=n.split(".notion."))||void 0===n?void 0:n[1])}function st(e,t){a.j(e,"offline_access_failure",t)}function lt(e,t){a.j(e,"full_screen_action",t)}function ct(e){a.j(e,"admin_content_search_analytics_acknowledge_confirm")}function dt(e,t){a.j(e,"admin_content_search_analytics_filter_change",t)}function ut(e,t){a.j(e,"admin_content_search_analytics_queried",t)}function pt(e,t){a.j(e,"admin_content_search_analytics_export_requested",t)}function mt(e){a.j(e,"click_sidebar_student_org_promo")}},10910:(e,t,n)=>{n.d(t,{Bp:()=>f,HC:()=>p,NF:()=>r,RL:()=>l,Tl:()=>u,UD:()=>_,Vo:()=>s,WP:()=>v,Xw:()=>m,_e:()=>d,bd:()=>y,g_:()=>g,ov:()=>h,qG:()=>c,rT:()=>a,zi:()=>b});var o=n(97978),i=n(77080);function r(e,t){o.j(e,"ai_action",t)}function a(e,t,n){const i={site:"client",...n};o.j(e,t,i)}function s(e,t){o.j(e,"ai_favorite_action",t)}function l(e,t){o.j(e,"ai_block_action",t)}function c(e,t){o.j(e,"ai_autofill_action",t),i.default.logEvent("ai_autofill_action",1,{action_type:t.type})}function d(e,t){o.j(e,"ai_autofill_settings_action",t)}function u(e,t){o.j(e,"ai_completion_popup_open",t)}function p(e,t){o.j(e,"ai_completion_popup_close",t),i.default.logEvent("ai_completion_popup_close",1,{exit_type:t.exit_type})}function m(e,t){o.j(e,"ai_completion_popup_retry",t)}function f(e,t){o.j(e,"ai_completion_popup_history_navigation",t)}function g(e,t){o.j(e,"ai_completion_popup_preview_start",t),i.default.logEvent("ai_completion_popup_preview_start",1,{from:t.from,prompt_key:t.prompt_key})}function h(e,t){o.j(e,"ai_completion_popup_update_prompt_text",t)}function v(e,t){o.j(e,"ai_completion_popup_preview_end",t),i.default.logEvent("ai_completion_popup_preview_end",1,{preview_time:t.preview_time})}function b(e,t){o.j(e,"ai_completion_popup_preview_stopped_by_user",t)}function y(e,t){o.j(e,"ai_user_data_sharing_opt_in_submit",t)}function _(e,t){o.j(e,"getCompletion.emptyResponse",t),i.default.logEvent("getCompletion.emptyResponse",1,{promptKey:t.promptKey})}},8406:(e,t,n)=>{n.d(t,{$q:()=>h,Ac:()=>w,Rc:()=>v,S$:()=>y,YU:()=>I,_H:()=>d,bn:()=>M,g2:()=>x,gd:()=>C,gl:()=>g,mH:()=>u,nS:()=>f,qm:()=>k,rv:()=>_,tW:()=>T,tf:()=>P,wd:()=>m,xb:()=>p,y9:()=>b,zF:()=>S});var o=n(34296),i=n(1898),r=n(97978),a=n(75079),s=n(77181),l=n(36610),c=n(92973);function d(e){const{environment:t,collectionContextStore:n,...o}=e,i=(0,a.Pn)(n)||{};l._H(t,{...i,...o})}function u(e,t){r.j(e,"collection_create_suggested_property_latency",t)}function p(e){const{environment:t,collectionContextStore:n,view_type:o,view_config_uri:i,...r}=e,s=(0,a.Pn)(n)||{};l.xb(t,{...s,...r,view_type:o,view_config_uri:i})}function m(e){const{environment:t,collectionContextStore:n,action:o,original_view_type:i,new_view_type:r,new_view_id:s,property_type:c,new_date_shift_mode:d,new_avoid_weekends:u}=e,p=(0,a.Pn)(n);p&&p.view_type&&l.wd(t,{action:o,...p,view_type:p.view_type,original_view_type:i,new_view_type:r,new_view_id:s,property_type:c,new_date_shift_mode:d,new_avoid_weekends:u})}function f(e){const t=(0,a.Pn)(e.collectionContextStore);t&&t.view_type&&c.MU(e.environment,{from:e.from,from_peek_mode:e.from_peek_mode,...t,view_type:t.view_type})}function g(e){const{peek_mode:t,from_peek_mode:n}=e,o=(0,a.Pn)(e.collectionContextStore);o&&o.view_type&&c.lg(e.environment,{from:e.from,peek_mode:t,from_peek_mode:n,...o,view_type:o.view_type})}function h(e){const{environment:t,collectionContextStore:n,property:o,from:i,action:r,new_property_type:s,...c}=e,d=n.normalizedSchemaStore.state[o],u=(0,a.Pn)(n)||{};l.$q(t,{property_type:null==d?void 0:d.type,new_property_type:s,property:o,from:i,action:r,...c,...u})}function v(e){const{environment:t,collectionContextStore:n,view_type:o,from:i,...r}=e,s=(0,a.Pn)(n)||{};l.Rc(t,{from:i,...r,...s,view_type:o})}function b(e){const{environment:t,collectionContextStore:n,property_type:o,from:i,property:r,...s}=e,c=(0,a.Pn)(n)||{};l.y9(t,{property:r,property_type:o,from:i,...s,...c})}function y(e,t,n){var o,s,l;let c="page_properties";const d=(0,a.Pn)(t);switch(d.view_type){case void 0:case"page":case"table":c="table";break;case"list":c="list";break;case"gallery":c="gallery";break;case"board":c="board";break;case"calendar":c="calendar";break;case"timeline":c="timeline";break;case"chart":break;default:(0,i.t1)(d.view_type)}const u={...n,collection_id:null==t||null===(o=t.collectionStore())||void 0===o?void 0:o.id,collection_view_id:null==t||null===(s=t.collectionViewStore())||void 0===s?void 0:s.id,collection_view_block_id:null==t||null===(l=t.collectionViewBlockStore())||void 0===l?void 0:l.id,from:c};r.j(e,"copy_property",u)}function _(e){var t;const{environment:n,collectionContextStore:o,block_id:i,property:r,property_type:c,from:d,isFromBulkActionsToolbar:u,isUnthrottled:p,collection_id:m,...f}=e,g=(0,a.Pn)(o,m)||{};let h;if(null!==(t=o.currentSubitemFormatStoreForCollection.state)&&void 0!==t&&t.property){h=(0,s.EK)({blockId:i,collectionContextStore:o})?"subitem":"parent_item"}else o.currentArrowsByFormatStore.state&&(h="timeline_arrows_by");l.rv(n,{block_id:i,property:r,property_type:c,property_context:h,from:d,isFromBulkActionsToolbar:u,...f,...g},p||!1)}function S(e){const{environment:t,collectionContextStore:n,property:o,property_type:i,from:s,isFromBulkActionsToolbar:l,...c}=e,d=(0,a.Pn)(n)||{};r.j(t,"collection_open_block_property_overlay",{property:o,property_type:i,property_context:undefined,from:s,isFromBulkActionsToolbar:l,...c,...d})}function w(e){const{environment:t,collectionContextStore:n,checkbox_type:o,...i}=e,s=(0,a.Pn)(n)||{};r.j(t,"collection_multi_select_checkbox_clicked",{...s,checkbox_type:o,...i})}function k(e){const{environment:t,collectionContextStore:n,property_type:o,num_rows:i}=e,r=(0,a.Pn)(n)||{};l.fM(t,{property_type:o,num_rows:i,...r})}function I(e){const{environment:t,collectionContextStore:n,...o}=e,i=(0,a.Pn)(n)||{};l.YU(t,{...i,...o})}function C(e){const{environment:t,collectionContextStore:n,...o}=e,i=(0,a.Pn)(n)||{};r.j(t,"convert_db_start",{...i,...o})}function x(e){const{environment:t,collectionContextStore:n,...o}=e,i=(0,a.Pn)(n)||{};r.j(t,"convert_db_complete",{...i,...o})}function T(e){const{environment:t,totalResults:n,clickedIndex:i,eventName:a,sessionId:s,source:l,queryLength:c}=e;let d;l===o.S.Automation?d="automation_collection_picker":l===o.S.Relation?d="collection_settings_select_relation_source":l===o.S.Source&&(d="collection_settings_source");const u=Boolean(0===c);(0,r.j)(t,a,{source:d,"server-indexAlias":"collection",totalResults:n,clickedIndex:i,sessionId:s,queryLength:c,isEmptyQuery:u})}function M(e){r.j(e,"collection_load_more_blocks")}function P(e){r.j(e,"collection_load_more_groups")}},85344:(e,t,n)=>{n.d(t,{$5:()=>c,Em:()=>w,Je:()=>a,Rn:()=>s,SU:()=>y,Uw:()=>_,Yz:()=>u,ZW:()=>r,Zq:()=>k,bR:()=>m,d2:()=>g,hJ:()=>b,jX:()=>p,k$:()=>h,lL:()=>d,pP:()=>S,x6:()=>f,yr:()=>l,zd:()=>v});var o=n(97978),i=n(77080);function r(e,t){o.j(e,"open_block_discussion_menu",t)}function a(e){let{environment:t,from:n,notificationId:i,activityId:r}=e;o.j(t,"open_reply_discussion_menu",{from:n,notificationId:i,activityId:r})}function s(e){let{environment:t,from:n,notificationId:i,activityId:r}=e;o.j(t,"close_reply_discussion_menu",{from:n,notificationId:i,activityId:r})}function l(e){o.j(e,"open_new_block_discussion")}function c(e){o.j(e,"open_new_inline_discussion")}function d(e){o.j(e,"discard_new_discussion_dialog_show")}function u(e){o.j(e,"discard_new_discussion_dialog_confirm")}function p(e){o.j(e,"discard_new_discussion_dialog_cancel")}function m(e,t){o.j(e,"create_block_discussion",t),i.default.logEvent("create_block_discussion")}function f(e,t){o.j(e,"create_inline_discussion",t),i.default.logEvent("create_inline_discussion")}function g(e,t){o.j(e,"add_comment",t),i.default.logEvent("add_comment",t.from)}function h(e,t){o.j(e,"delete_comment",t)}function v(e,t){o.oP(e,{eventName:"edit_comment",eventProperties:t})}function b(e,t){o.j(e,"resolve_discussion",t),i.default.logEvent("resolve_discussion",t.from)}function y(e,t){o.j(e,"reopen_discussion",t)}function _(e,t){o.j(e,"click_discussion",t)}function S(e){const{environment:t,...n}=e;o.j(t,"add_reaction",n),i.default.logEvent("add_reaction",n.reaction_value)}function w(e){const{environment:t,...n}=e;o.j(t,"remove_reaction",n)}function k(e,t){o.j(e,"comment_upload_attachments",t)}},952:(e,t,n)=>{n.d(t,{W:()=>l,t:()=>c});var o=n(53965),i=n(97978),r=n(24646),a=n(17224);const s=o.P2((e=>{i.Zf(e,{created_page:!0})}),864e5,{trailing:!1});function l(e,t){const{teamStore:n,new_page_id:o,...i}=t;a.ej(e,"create_block",`create_block-${t.type}-${t.from}`,60,{store:n,...i}),"page"===t.type&&(a.YP(e,"create_page",{store:n,...i,new_page_id:o,...(0,r.UF)({environment:e})}),s(e))}function c(e,t){"onboarding"===t.from?function(e,t){const{teamStore:n,...o}=t;a.YP(e,"create_onboarding_page",{store:n,...o})}(e,{from:t.from,teamStore:t.teamStore,forkedTemplateId:t.pageId}):l(e,{type:"page",from:t.from,teamStore:t.teamStore,new_page_id:t.pageId,creating_block_id:t.pageId})}},88864:(e,t,n)=>{n.d(t,{Fn:()=>r,Gl:()=>m,Jg:()=>p,QI:()=>l,QU:()=>f,Uk:()=>s,Wl:()=>a,X0:()=>d,el:()=>c,mC:()=>u});var o=n(18265),i=n(97978);function r(e,t){i.j(e,"embed_block_action",t)}function a(e,t){i.j(e,"embed_block_resize",t)}function s(e,t){i.j(e,"download_file",t)}function l(e,t){i.j(e,"file_open_attempt",t)}function c(e,t){const n=(0,o.gy)(t.url);i.j(e,"open_embed_menu",{url_domain:null==n?void 0:n.hostname})}function d(e,t){var n;i.j(e,"click_embed_menu",{url_domain:t.url?null===(n=(0,o.gy)(t.url))||void 0===n?void 0:n.hostname:void 0,type:t.type})}function u(e,t){i.j(e,"url_turned_bookmark",t)}function p(e,t){i.j(e,"embed_type",t)}function m(e,t){i.j(e,"embed_render",t)}function f(e,t){i.j(e,"embed_client_error",t)}},68425:(e,t,n)=>{n.d(t,{VJ:()=>a,fA:()=>l,kz:()=>s,xu:()=>r});var o=n(97978),i=n(77080);function r(e){o.j(e,"open_emoji_menu")}function a(e,t){o.j(e,"emoji_no_results",t)}function s(e,t,n){o.j(e,t,n)}function l(e,t,n){o.j(e,t,n),i.default.logEvent(t,n.icon)}},59301:(e,t,n)=>{n.d(t,{M:()=>r,Z:()=>a});var o=n(97978),i=n(18245);function r(e,t){o.j(e,"image_uploaded",t)}function a(e,t){i.default.mark("image_edit_load"),o.j(e,"image_edit_open",t)}},57549:(e,t,n)=>{n.d(t,{AS:()=>Q,B3:()=>te,BI:()=>A,Cm:()=>F,D:()=>H,D6:()=>k,DU:()=>E,DW:()=>q,EJ:()=>D,EU:()=>re,FB:()=>Z,FI:()=>h,G7:()=>y,Gl:()=>b,IG:()=>K,IN:()=>N,IV:()=>O,Iv:()=>Y,L3:()=>f,Mp:()=>ee,Ng:()=>R,PR:()=>B,SC:()=>ne,SO:()=>S,Sy:()=>m,Vf:()=>g,YY:()=>V,Z3:()=>v,Z9:()=>j,_x:()=>X,a1:()=>u,ay:()=>d,bO:()=>x,cV:()=>I,eR:()=>G,fc:()=>L,iI:()=>z,kM:()=>C,lL:()=>J,oQ:()=>oe,oS:()=>M,pZ:()=>P,pp:()=>ie,qJ:()=>_,qy:()=>p,re:()=>T,tf:()=>W,uu:()=>w,uy:()=>U,wi:()=>$});var o=n(30845),i=n(18265),r=n(97978),a=n(71776),s=n(24646),l=n(77080),c=n(35057);function d(e,t){r.j(e,"import_button_click",t)}function u(e,t){r.j(e,"import_source_auth",t)}function p(e,t){r.j(e,"import_source_input",t)}function m(e,t){r.j(e,"open_import_modal",{...t,...(0,s.UF)({environment:e})})}function f(e,t){r.j(e,"auth_integration",t)}function g(e,t){r.j(e,"integration_select_all",t)}function h(e,t){r.j(e,"integration_deselect_all",t)}function v(e,t){r.j(e,"integration_select_item",t)}function b(e,t){r.j(e,"integration_deselect_item",t)}function y(e,t){r.j(e,"import_integration",t)}function _(e,t){r.j(e,"remove_integration",t)}function S(e,t){r.j(e,"integration_prompt_auth",t)}function w(e){r.j(e,"open_google_drive_file_picker")}function k(e,t){r.j(e,"google_drive_pick_file",t)}function I(e,t){r.j(e,"google_drive_embed_file",t)}function C(e,t){r.j(e,"unfurl_menu_option",t)}function x(e,t){const{pastedText:n}=t;let a;if(o.B(n,"url")){const e=i.Qc(n);e.host&&(a=e.host)}if(a){const{pastedText:n,...o}={...t,url_domain:a};r.j(e,"paste_url",o)}}function T(e,t){const n=t.file.lastIndexOf("."),o=n>0?t.file.substring(n+1):"",i=c.zt();o&&r.j(e,"file_uploads",{source:t.source,extension:o,subscriptionTier:i})}function M(e,t){const n=t.url?(0,i.gy)(t.url):void 0;r.j(e,"edit_link",{type:t.type,url_domain:null==n?void 0:n.hostname})}function P(e){r.j(e,"edit_link_title")}function A(e){r.j(e,"developer_integrations_list_visit")}function R(e){r.j(e,"developer_integrations_new_click")}function D(e,t){r.j(e,"developer_integrations_filter_click",t)}function E(e,t){const n=a.OS[t.table];r.j(e,"developer_integrations_view_visit",{type:n})}function B(e,t){const n=a.OS[t.table];r.j(e,"developer_integrations_create",{type:n})}function F(e,t){const n=a.OS[t.table];r.j(e,"developer_integrations_view_secret",{type:n})}function O(e,t){const n=a.OS[t.table];r.j(e,"developer_integrations_copy_secret",{type:n})}function Z(e,t){const n=a.OS[t.table],{table:o,...i}=t;r.j(e,"developer_integrations_update",{type:n,...i})}function V(e,t){r.j(e,"developer_integrations_my_integrations_click",t)}function U(e,t){r.j(e,"developer_integrations_all_integrations_click",t)}function L(e,t){r.j(e,"developer_integrations_visit_developer_website_click",t)}function j(e,t){r.j(e,"developer_integrations_contact_developer_click",t)}function N(e,t){r.j(e,"developer_integrations_disconnect_click",t)}function z(e,t){r.j(e,"developer_integrations_open_card_dropdown_click",t)}function q(e,t){r.j(e,"developer_integrations_delete_click",t)}function W(e,t){r.j(e,"developer_integrations_confirm_delete_click",t)}function H(e,t){r.j(e,"install_public_integration_oauth",t)}function K(e,t){r.j(e,"security_and_compliance_integration_oauth_attempt",t)}function G(e,t){r.j(e,"security_and_compliance_integration_install",t)}function $(e,t){r.j(e,"security_and_compliance_integration_uninstall",t)}function Q(e,t){r.j(e,"security_and_compliance_integration_update",t)}function Y(e,t){r.j(e,"connect_external_integration",t),l.default.logEvent("connect_external_integration",void 0,t)}function J(e,t){r.j(e,"disconnect_external_integration",t)}function X(e,t){r.j(e,"activate_link_preview_menu",t)}function ee(e,t){r.j(e,"save_link_preview",t)}function te(e,t){r.j(e,"update_link_preview",t)}function ne(e,t){r.j(e,"open_link_preview_help_guide",t)}function oe(e,t){r.j(e,"remove_link_preview_with_error",t)}function ie(e,t){r.j(e,"link_preview_url_miss",t)}function re(e,t){r.j(e,"show_all_discoverable_connected_apps",t)}},91219:(e,t,n)=>{n.d(t,{$2:()=>T,$z:()=>R,E0:()=>M,Mq:()=>A,TC:()=>C,UW:()=>k,bR:()=>E,ci:()=>P,hE:()=>I,jB:()=>w,l5:()=>S,q_:()=>x,yE:()=>D});var o=n(79946),i=n(33728),r=n(19889),a=n(53965),s=n(7032),l=n(97978),c=n(15010),d=n(80444),u=n(77080),p=n(29677),m=n(6258),f=n(88893),g=n(35057),h=n(88280),v=n(81918),b=(n(17224),n(13447)),y=n(37181);function _(e){var t;const n=e.invite_targets.filter(p.cl),o=e.invite_targets.filter(p.fZ),r=n.length+o.length,l=a.oA(e.permission_items.map((e=>{if("user_permission"===e.type)return e.user_id&&(0,s.F9)(e.user_id)}))),c=new Set(null===(t=d.default.state.currentSpaceStore)||void 0===t?void 0:t.getEmailDomains()),u=e.invite_targets.filter((e=>{if("existingUser"!==e.type&&"newUser"!==e.type)return!1;const t=(0,i.Gd)(e.value.email);return t&&c.has(t)})).flatMap((e=>e.value.id?[(0,s.F9)(e.value.id)]:[])),m=(0,g.zt)();return{role:e.role,user_count:r,new_user_count:n.length,new_workspace_member_count:e.is_space?r:u.length,new_workspace_member_ids:e.is_space?l:u,is_onboarding:e.is_onboarding,invite_flow_id:e.invite_flow_id,invite_origin:e.invite_origin,invitee_ids:l,invite_message_length:e.invite_message_length,subscription_tier:m,domain_type:e.domainType,...!e.is_space&&{share_menu_session_id:e.share_menu_session_id},allow_domain_auto_invite:u.length>0,is_space:e.is_space,collection_id:e.collection_id,parent_collection_id:e.parent_collection_id}}function S(e,t){const n=_(t);l.j(e,"invite_error",n)}function w(e,t){const n=(0,g.zt)(),a=_(t);l.j(e,"invite",{...a,is_space:t.is_space}),h.subscriptionDataStoreInstance.waitUntilLoaded().then((()=>{const n=h.subscriptionDataStoreInstance.state,o=n?f.Ln(e,n):void 0,s=n?f.Lz(e,n):void 0;l.j(e,"invite_debug_with_block_usage",{...a,is_space:t.is_space,is_over_block_limit:o,block_usage:s}),t.is_space||(!function(e,t){const{currentSpaceStore:n,currentUserStore:o}=d.default.state,a=n&&n.canEditMembership(),s=c.JF(),u=null==o?void 0:o.getEmail();if(!a||!s||!u)return;if("professional"!==s)return;const p=(0,i.Gd)(u),g=f.A7().slice(0,50).map((e=>({email:m.U6.createChildStore(n,{table:r.KJ,id:e.userId}).getEmail(),guestId:e.userId}))).filter((e=>e.email&&(0,i.Gd)(e.email)===p)).map((e=>e.guestId));l.j(e,"page_invite_guest_summary",{...t,guest_with_same_domain_count:g.length,guest_ids:g})}(e,a),v.fN(e,{inviteTargets:t.invite_targets,origin:t.invite_origin}))})),(t.is_space||a.allow_domain_auto_invite)&&(l.j(e,"space_invite",a),l.Zf(e,{space_invited:!0}),u.default.logEvent("space_invite",a.allow_domain_auto_invite?`${t.invite_origin}_allow_domain`:t.invite_origin,a),v.Jk(e,{invite_origin:t.invite_origin,domainType:t.domainType,new_workspace_member_count:a.new_workspace_member_count,new_workspace_member_ids:a.new_workspace_member_ids,allow_domain_auto_invite:a.allow_domain_auto_invite}),function(e,t){const n=(0,g.zt)();t.visibleMembersCount<=1&&(l.j(e,"workspace_first_invite_sent"),o.kd(n,t.domainType),"professional"===t.domainType&&(l.j(e,"professional_workspace_first_invite_sent",{visible_members_count:t.visibleMembersCount,is_professional_team_user:t.isProfessionalTeamUser,domain_type:t.domainType}),o.Dq()))}(e,{visibleMembersCount:f.qX(),isProfessionalTeamUser:t.isProfessionalTeamUser,domainType:t.domainType})),t.is_space||a.new_workspace_member_ids.length===t.invite_targets.length||(l.j(e,"page_invite",a),u.default.logEvent("page_invite",n,a),function(e,t){const{currentUserSettingsStore:n}=d.default.state;if(!n)return;const o=n.getKeyStore("settings").getKeyStore("signup_time").getValue(),i=n.getKeyStore("settings").getKeyStore("first_page_invite_at").getValue();if(!Boolean(i)){const i=Date.now(),r={...t,...o?{signup_time_ready:!0,time_from_signup_to_first_page_invite:o-i}:{signup_time_ready:!1}};l.j(e,"page_invite_time",r),u.default.logEvent("page_invite_time",t.subscription_tier,r),b.createAndCommit({userAction:"firstPageInvite",environment:e,userId:n.id,perform:e=>{y.d2({userSettingsStore:n,data:{first_page_invite_at:i},transaction:e})}})}}(e,a))}function k(e,t){l.j(e,"invite_typed",t),u.default.logEvent("invite_typed",t.subscription_tier,{...t})}function I(e,t){l.j(e,"invite_select_target",t),u.default.logEvent("invite_select_target",t.subscription_tier,{selected_user_token_rank:t.selected_user_token_rank,from:t.from,type:t.type??"permission_invite"})}function C(e,t){l.j(e,"invite_change_role",t),u.default.logEvent("invite_change_role",t.subscription_tier,{...t})}function x(e,t){l.j(e,"abandon_permissions_invite",t),u.default.logEvent("abandon_permissions_invite",t.subscription_tier,{...t})}function T(e,t){l.j(e,"open_share_workspace_invite",t),u.default.logEvent("open_share_workspace_invite",t.subscription_tier,{...t})}function M(e,t){l.j(e,"send_share_workspace",t),u.default.logEvent("send_share_workspace",t.subscription_tier,{...t})}function P(e,t){l.j(e,"send_membership_request",t),u.default.logEvent("send_membership_request",t.subscription_tier,{...t})}function A(e,t){l.j(e,"open_page_share_invite",t),u.default.logEvent("open_page_share_invite",t.subscription_tier,{...t})}function R(e){l.j(e,"open_space_invite")}function D(e,t){l.j(e,"invite_modal_input_focus",t)}function E(e,t){l.j(e,"invite_users_to_page",t)}},26189:(e,t,n)=>{n.d(t,{Qq:()=>h,SK:()=>f,TI:()=>c,VN:()=>g,Yo:()=>m,Z0:()=>d,ew:()=>l,iH:()=>u,j1:()=>a,pi:()=>p,z7:()=>s});var o=n(7032),i=n(97978),r=n(77080);function a(e,t){i.j(e,"open_mention_menu",t),r.default.logEvent("open_mention_menu",void 0,t)}function s(e,t){const{clickIndexLocal:n,clickIndexGlobal:o}=t,a=void 0!==n?1/(n+1):void 0,s=void 0!==o?1/(o+1):void 0,l={...t,localReciprocalRank:a,globalReciprocalRank:s};i.j(e,"insert_mention_from_mention_menu",l),r.default.logEvent("insert_mention_from_mention_menu",a,l)}function l(e,t){i.j(e,"mention_menu_abandon",t),r.default.logEvent("mention_menu_abandon",void 0,t)}function c(e,t){i.j(e,"mention_user",{mentioned_user_id:(0,o.F9)(t.user_id),mentioned_user_access_level:t.user_access_level,from:t.from,block_type:t.block_type,share_menu_selection:t.share_menu_selection}),r.default.logEvent("mention_user",t.user_access_level,t)}function d(e,t){i.j(e,"mention_group",{mentioned_group_id:(0,o.F9)(t.group_id),from:t.from,block_type:t.block_type})}function u(e,t){i.j(e,"hover_mention_group",{group_id:(0,o.F9)(t.group_id)})}function p(e,t){i.j(e,"hover_page_mention_start",t)}function m(e,t){i.j(e,"hover_page_mention_end",t)}function f(e,t){i.j(e,"page_mention_click",t)}function g(e,t){i.j(e,"mention_date",t)}function h(e,t){i.j(e,"mention_page",{mentioned_page_id:(0,o.F9)(t.page_id),from:t.from,block_type:t.block_type})}},83249:(e,t,n)=>{n.d(t,{FG:()=>r,YO:()=>i,jD:()=>a,nB:()=>s,w3:()=>c,xx:()=>l});var o=n(97978);function i(e,t){o.j(e,"tap_mobile_action_bar_item",{item_name:t.itemName,from:t.from})}function r(e){o.j(e,"scroll_mobile_action_bar")}function a(e){o.j(e,"open_mobile_sidebar")}function s(e,t){o.j(e,"tap_mobile_bottom_bar_item",{...t})}function l(e){o.j(e,"mobile_add_to_menu_accept")}function c(e,t){o.j(e,"navigation",{...t})}},73990:(e,t,n)=>{n.d(t,{A6:()=>c,Fo:()=>i,Y8:()=>d,_T:()=>a,a6:()=>u,fW:()=>r,mf:()=>s,rY:()=>l,w6:()=>p});var o=n(97978);function i(e){o.j(e,"click_breadcrumb_move_to")}function r(e,t){o.j(e,"move_to_error",t)}function a(e,t){o.j(e,"move_to",t)}function s(e,t){o.j(e,"move_to_value_selected",t)}function l(e,t){o.j(e,"move_to_menu_open",t)}function c(e,t){o.j(e,"move_to_menu_cancel",t)}function d(e,t){o.j(e,"add_editor_permission_to_ensure_undo",t)}function u(e,t){o.j(e,"move_to_autocomplete_query_change",t)}function p(e,t){o.j(e,"move_to_toggle_click",t)}},32441:(e,t,n)=>{n.d(t,{$k:()=>x,AM:()=>h,BR:()=>T,D6:()=>y,Es:()=>f,PB:()=>p,Pu:()=>m,Q4:()=>b,Sn:()=>C,T3:()=>S,VU:()=>I,_W:()=>g,eb:()=>w,ux:()=>_,yv:()=>k,zX:()=>v});var o=n(79946),i=n(15145),r=n(9852),a=n(37850),s=n(18265),l=n(97978),c=n(14654),d=n(24646),u=n(77080);function p(e,t){const{page_id:n,query:o,team_id:r,page_visit_id:a,previous_page_visit_id:u,...p}=t,m=s.Ph(o,i.$X),f=parseInt(m),g="push"===e.RouterStore.getState().action,h=(0,i.bh)(f)&&g?(0,i.xt)(i.tY.LinkInPage):(0,i.xt)(f),v=s.Ph(o,i.Qs),b=c.t3({blockOrCollectionId:n}),y={eventName:"page_visit",eventProperties:{...p,page_visit_source:h,notification_id:v,page_visit_id:a,previous_page_visit_id:u,entered_at:Date.now(),home_page_type:b,...(0,d.UF)({environment:e})}};l.oP(e,y,{forceOverrideAutomaticEventData:{team_id:r}})}function m(e,t){l.j(e,"page_exit",{exited_at:Date.now(),page_visit_id:t.pageVisitId},{forceOverrideAutomaticEventData:t})}function f(e){const t=[{name:"initial_partner_stack_key",value:e.partner_stack_key,operation:"setOnce"},{name:"partner_stack_key",value:e.partner_stack_key,operation:"set"}];l.fK(t)}function g(e,t){const n=s.nx(t,(0,r.x6)());if(n){const{fbclid:e,gclid:t}=n;e&&o.xx({type:"facebook",id:e}),t&&o.xx({type:"google",id:t}),(0,r.NW)(n)}l.oP(e,{eventName:"visit",eventProperties:{}})}function h(e,t){l.j(e,"page_error",t)}function v(e,t){l.j(e,"page_error_button_click",t)}function b(e,t){l.j(e,"reorder_workspaces",t)}function y(e,t){l.j(e,"multi_account_add_or_create_account_clicked",t)}function _(e){l.j(e,"content_classification_proceed")}function S(e,t){l.j(e,"notion_topbar_click",t,{dontWait:!0}),u.default.logEvent("notion_topbar_click",t.variant)}function w(e,t){l.j(e,"template_gallery_public_page_topbar_click",t,{dontWait:!0}),u.default.logEvent("template_gallery_public_page_topbar_click",t.target)}function k(e,t){l.j(e,"getting_started_page_create",t)}function I(e,t){l.j(e,"debug_getting_started_page_error",t)}function C(e,t){l.j(e,"landing_page_visit",{routerName:t}),(0,a.Vs)(4e3).then((n=>{u.default.logEvent(`${t}_page_visit`,e.device.deviceType,{})}))}function x(e,t){l.j(e,"desktop_app_signup_browser_visit",{desktop_app_reroute_email:t.desktopAppRerouteEmail,desktop_app_device_id:t.desktopAppDeviceId})}function T(e,t,n){const o=e=>({blockId:"blockId"in e?e.blockId:void 0,peekViewBlockId:"peekViewBlockId"in e?e.peekViewBlockId:void 0}),{blockId:r,peekViewBlockId:a}=o(t),{blockId:s,peekViewBlockId:c}=o(n),d="pageVisitSource"in n&&n.pageVisitSource?(0,i.xt)(parseInt(n.pageVisitSource)):void 0;l.j(e,"click_in_page_navigation",{current_route_name:t.name,next_route_name:n.name,page_visit_source:d,current_page_id:r,current_peek_view_page_id:a,next_page_id:s,next_peek_view_page_id:c})}},19719:(e,t,n)=>{n.d(t,{Br:()=>B,Cg:()=>N,EH:()=>U,EQ:()=>S,Ee:()=>Z,F5:()=>g,FR:()=>L,GP:()=>x,Jn:()=>M,Md:()=>q,Q6:()=>T,RJ:()=>W,U0:()=>D,Up:()=>C,Xf:()=>R,Z8:()=>_,Zh:()=>z,_H:()=>O,_b:()=>f,b2:()=>P,bE:()=>V,cC:()=>h,gM:()=>j,gY:()=>y,ix:()=>b,kL:()=>K,l2:()=>E,lh:()=>F,nI:()=>k,pw:()=>I,u_:()=>v,ub:()=>H,zD:()=>A});var o=n(27328),i=n(82813),r=n(1898),a=n(41549),s=n(50770),l=n(16746),c=n(24646),d=n(77080),u=n(4761),p=n(17659),m=n(97978);function f(e){w({...e,target:"archive"})}function g(e){w({...e,target:"unarchive"})}function h(e){w({...e,target:"mark_as_read"})}function v(e){w({...e,target:"mark_as_unread"})}function b(e){w({...e,target:"frame"})}function y(e){w({...e,target:"open_reply_menu"})}function _(e){let{environment:t,pageId:n,isCurrentlyFollowing:o,from:i,notificationId:r}=e;m.j(t,"click_page_updates_notifications_button",{pageId:n,isCurrentlyFollowing:o,from:i,notificationId:r})}function S(e){let{environment:t,backlinkPageId:n,notificationId:o,alreadyRead:i,activity:r,tab:a}=e;w({environment:t,target:"title",notificationId:o,alreadyRead:i,activity:r,tab:a,otherArgs:{backlinkPageId:n}})}function w(e){let{environment:t,target:n,notificationId:o,alreadyRead:r,activity:a,tab:s,otherArgs:l}=e;I({environment:t,target:n});const c=u.ZP.state.sessionId;N(t,{target:n,notification_id:o,activity_id:a.id,tab:s,sessionId:c,is_filtered:u.ZP.isFilteredToUnreadOnly(),...l}),o&&i.e(m.mc(t),{alreadyRead:r,notificationId:o,activityId:a.id,from:n,sessionId:c})}function k(e){const t=u.ZP.state.sessionId;t&&(m.j(e,"close_sidebar_updates",{sessionId:t,tab:M()}),u.ZP.endSession())}function I(e){let{environment:t,target:n}=e,o=!1;switch(n){case"title":case"body":o=!0;break;case"archive":case"unarchive":case"mark_as_read":case"mark_as_unread":case"add_reaction":case"open_reply_menu":case"frame":case"main":o=!1;break;default:(0,r.t1)(n)}(0,s.z_)(t)?"peek"===l.Z.state.mode&&o&&B({environment:t}):o&&k(t)}function C(e){let{environment:t,from:n}=e;const i=(0,o.w_)(t.TabbedRouterStore.state);var r;"web"===(r=i).type&&"nativeTab"===r.route.name&&"updates"===r.route.tab&&x({environment:t,from:n})}function x(e){let{environment:t,forceRestartSession:n,from:o}=e;u.ZP.startSession({forceRestart:n??!1}),function(e,t){d.default.logEvent("open_sidebar_updates",t.tab,t),m.j(e,"open_sidebar_updates",{...t,...(0,c.UF)({environment:e})})}(t,{tab:M(),unread_notifications_count:p.aY(),sessionId:u.ZP.state.sessionId,from:o})}function T(e){let{environment:t,activityUpdatesSource:n,filters:o,prevFilters:i}=e;m.j(t,"update_notification_filters",{source:n,prev_date_range_filter_start:i.dateRange.start,prev_date_range_filter_end:i.dateRange.end,prev_activity_types:i.activityTypes,date_range_filter_start:o.dateRange.start,date_range_filter_end:o.dateRange.end,activity_types:o.activityTypes})}function M(){const e=u.ZP.state.currentTab;switch(e){case"mentions":return"mentions_comments";case"archive":return"archive";case"allPages":return"all_updates";default:(0,r.t1)(e)}}function P(e){let{environment:t,action:n,args:o}=e;m.j(t,"push_notification_desktop",{...o,action:n})}function A(e,t){const n={...t,onlyRead:"read"===t.readFilter,sessionId:u.ZP.state.sessionId};d.default.logEvent("archive_all_notifications",t.readFilter,n),m.j(e,"archive_all_notifications",n)}function R(e){d.default.logEvent("mark_all_notifications_as_read"),m.j(e,"mark_all_notifications_as_read",{sessionId:u.ZP.state.sessionId})}function D(e,t){m.j(e,"toggle_filter_for_unread_notifications",t)}function E(e){let{environment:t}=e;u.ZP.startSession({forceRestart:!0});const n={tab:a.Fz(),unread_notifications_count:p.aY(),sessionId:u.ZP.state.sessionId,from:"inbox",...(0,c.UF)({environment:t})};d.default.logEvent("open_sidebar_updates",a.Fz(),n),m.j(t,"open_sidebar_updates",n)}function B(e){let{environment:t}=e;const n=u.ZP.state.sessionId;n&&(m.j(t,"close_sidebar_updates",{tab:a.Fz(),sessionId:n}),u.ZP.endSession())}function F(e,t){const{mode:n}=t;m.j(e,"toggle_sidebar_updates_panel",{tab:a.Fz(),unread_notifications_count:p.aY(),sessionId:u.ZP.state.sessionId,view_type:n,...(0,c.UF)({environment:e})})}function O(e){w({...e,target:"main"})}function Z(e,t){const{notificationActivityPairs:n,affectedNotificationIds:o,target:i}=t,r=new Set(o),a=n.filter((e=>{let{notification:t}=e;return r.has(t.id)}));if(0===a.length)return;const s=new Set,l=new Set;a.forEach((e=>{let{notification:t,activity:n}=e;"commented"===t.type?s.add(n.discussion_id):l.add(t.id)})),m.j(e,"click_update_group",{target:i,sessionId:u.ZP.state.sessionId,notification_ids:Array.from(l),discussion_ids:Array.from(s),notification_page_id:a[0].notification.navigable_block_id})}function V(e,t){m.j(e,"toggle_inbox_tab",{...t,sessionId:u.ZP.state.sessionId})}function U(e,t){m.j(e,"click_expand_replies",{...t,sessionId:u.ZP.state.sessionId})}function L(e){m.j(e,"open_notification_settings_from_all_updates")}function j(e){m.j(e,"open_page_updates")}function N(e,t){m.j(e,"click_update",{...t,...(0,s.H7)(e)?{tab:a.Fz(),view_type:l.Z.state.mode}:{view_type:"popup"}})}function z(e,t){const{target:n,...o}=t;let i;"notify_mobile"===n?i="set_mobile_notification":"notify_desktop"===n?i="set_desktop_notification":"notify_email"===n?i="set_email_notification":"notify_email_always"===n?i="set_email_always_notification":"notify_email_digest"===n?i="set_email_digest_notification":"notify_slack_mention"===n?i="set_slack_mention_notification":"notify_slack_all_activity"===n?i="set_slack_all_activity_notification":(0,r.t1)(n),m.j(e,i,o)}function q(e){m.j(e,"set_marketing_emails_preferences")}function W(e,t){m.j(e,"follow_page",t)}function H(e,t){m.j(e,"unfollow_page",t)}function K(e,t){m.j(e,"update_page_follow_settings",t)}},86615:(e,t,n)=>{n.d(t,{Et:()=>s,G:()=>c,QK:()=>r,QL:()=>a,Wy:()=>l,dl:()=>i,eZ:()=>d,kS:()=>u});var o=n(97978);async function i(e){return o.j(e,"notion_calendar_connect")}function r(e,t){o.j(e,"click_open_in_calendar",t)}function a(e){o.j(e,"calendar_rebrand_onboarding_modal_show")}function s(e,t){o.j(e,"calendar_rebrand_onboarding_modal_click",t)}function l(e){o.j(e,"calendar_rebrand_success_modal_show")}function c(e,t){o.j(e,"calendar_rebrand_success_modal_click",t)}function d(e){o.j(e,"click_calendar_sidebar_link")}function u(e){o.j(e,"click_calendar_upsell_prompt_cta")}},38208:(e,t,n)=>{n.d(t,{$D:()=>g,$l:()=>w,AD:()=>B,C$:()=>x,Gk:()=>c,IE:()=>y,J7:()=>m,L:()=>D,NG:()=>d,PL:()=>E,SY:()=>P,TL:()=>R,VZ:()=>O,Vk:()=>_,YV:()=>S,_0:()=>u,a7:()=>Z,ax:()=>k,e7:()=>I,fP:()=>M,ho:()=>l,iI:()=>A,jB:()=>v,jw:()=>p,o7:()=>b,p5:()=>T,qJ:()=>f,rx:()=>F,vd:()=>C,wq:()=>V,y6:()=>h});var o=n(79946),i=n(97978),r=n(15010),a=n(80444),s=n(77080);function l(e,t){i.j(e,"onboarding_dialog_error",t),b(e,"onboarding_dialog_error",t)}function c(e,t){i.j(e,"onboarding_error",t),b(e,"onboarding_error",t)}function d(e,t){if(i.j(e,"onboarding_show",t),s.default.logEvent("onboarding_show",1,{...t}),t.is_new_onboarding){var n;const{currentUserSettingsStore:e}=a.default.getState();s.default.logEvent("sign_up_by_domain_type",null==e||null===(n=e.getSettings())||void 0===n?void 0:n.domain_type,{})}}function u(e,t){i.j(e,"onboarding_invite_copy",t),b(e,"onboarding_invite_copy",t)}function p(e,t){i.j(e,"onboarding_close",t),b(e,"onboarding_close",t)}function m(e,t){i.j(e,"onboarding_skip",t),b(e,"onboarding_skip",t)}function f(e,t){i.j(e,"onboarding_invite_send",t),b(e,"onboarding_invite_send",t)}function g(e,t){i.j(e,"onboarding_space_icon_upload",t),b(e,"onboarding_space_icon_upload",t)}function h(e,t){i.j(e,"onboarding_stage",t),s.default.logEvent("onboarding_stage",1,{stage:t.stage,workspace_type:t.initial_workspace_type,is_new_onboarding:t.is_new_onboarding,device_type:e.device.deviceType})}function v(e,t){i.j(e,"onboarding_stage_exit",t),s.default.logEvent("onboarding_stage_exit",1,{stage:t.stage,workspace_type:t.initial_workspace_type,is_new_onboarding:t.is_new_onboarding,device_type:e.device.deviceType})}function b(e,t,n){i.j(e,"onboarding_serverside",{...n,phase:t},{dontWait:!0})}function y(e,t){i.j(e,"onboarding_join_space_click",t),s.default.logEvent("onboarding_join_space_click",t.joined_space_index,{...t})}function _(e,t){i.j(e,"onboarding_create_space_click",t),s.default.logEvent("onboarding_create_space_click")}function S(e,t){i.j(e,"onboarding_invite_click",t);const{invited_emails:n,...o}=t;s.default.logEvent("onboarding_invite_click",n.length,{...o})}function w(e,t){i.j(e,"onboarding_invite_attempt",t)}function k(e,t){i.j(e,"onboarding_upload_profile_photo",t)}function I(e,t){i.j(e,"onboarding_join_space",t)}function C(e,t){i.j(e,"onboarding_create_space",t)}function x(e,t){i.j(e,"onboarding_plan_type_select",t),s.default.logEvent("onboarding_plan_type_select",t.planType,{...t})}function T(e,t){i.j(e,"onboarding_persona_select",t),s.default.logEvent("onboarding_persona_select","persona",{...t})}function M(e,t){i.j(e,"onboarding_persona_select",t),s.default.logEvent("onboarding_persona_select","role",{...t})}function P(e,t){i.j(e,"onboarding_persona_select",t),s.default.logEvent("onboarding_persona_select","useCases",{...t})}function A(e,t){i.j(e,"onboarding_persona_select",t),s.default.logEvent("onboarding_persona_select","companySize",{...t})}function R(e,t){i.j(e,"onboarding_persona_survey_action",{...t,action:t.action}),s.default.logEvent("onboarding_persona_survey_action",t.action,{}),s.default.logEvent(`onboarding_persona_survey_action_${t.action}`,t.plan_selection,{})}function D(e,t){i.j(e,"onboarding_mobile_app_download_click",t),s.default.logEvent("onboarding_mobile_app_download_click")}function E(e,t){var n,l;const{currentUserSettingsStore:c,currentUserRootStore:d}=a.default.state,u=s.default.getExperimentsMap();i.Zf(e,{onboarding_complete:!0,onboarding_emails_experiment:u["onboarding-emails"]}),i.j(e,"onboarding_complete",t),o.PL(),s.default.logEvent("onboarding_complete",1,{domain_type:null==c||null===(n=c.getSettings())||void 0===n?void 0:n.domain_type,device_type:e.device.deviceType,is_new_onboarding:t.is_new_onboarding,is_professional_team_user:r.QZ(),user_persona:t.user_persona,plan_type:t.plan_type,create_or_join:t.initial_workspace_type}),s.default.logEvent("onboarding_complete_by_plan_type",t.plan_type,{}),s.default.logEvent("onboarding_complete_by_device_type",e.device.deviceType,{}),s.default.logEvent("onboarding_complete_by_user_persona",t.user_persona,{}),s.default.logEvent("onboarding_complete_by_user_team_role",t.user_team_role,{}),t.user_use_cases&&t.user_use_cases.forEach((e=>{s.default.logEvent("onboarding_complete_by_user_use_case",e,{})})),s.default.logEvent("onboarding_complete_by_domain_type",null==c||null===(l=c.getSettings())||void 0===l?void 0:l.domain_type,{}),s.default.logEvent("onboarding_complete_by_create_or_join_space",t.initial_workspace_type,{}),s.default.logEvent("onboarding_complete_by_is_new_user_onboarding",t.is_new_onboarding.toString(),{}),s.default.logEvent("onboarding_complete_by_workspaces_count",(null==d?void 0:d.getSpaceViewStores().length)||0,{}),r.QZ()&&s.default.logEvent("pro_team_onboarding_complete",1,{})}function B(e,t){i.j(e,"proj_management_onboarding_tooltip_show",t),s.default.logEvent("proj_management_tooltip_show")}function F(e,t){i.j(e,"proj_management_onboarding_tooltip_dismiss",t),s.default.logEvent("proj_management_tooltip_dismiss")}function O(e,t){i.j(e,"onboarding_team_invite_email_entered",t)}function Z(e,t){i.j(e,"onboarding_team_invite_add_more_clicked",t)}function V(e,t){i.j(e,"onboarding_bulk_invites_rendered",t)}},92973:(e,t,n)=>{n.d(t,{$C:()=>s,MU:()=>c,UZ:()=>p,hy:()=>l,lg:()=>u,sx:()=>i,v2:()=>d,vc:()=>a,zP:()=>r});var o=n(97978);function i(e,t){o.j(e,"open_peek_as_page",t)}function r(e,t){o.j(e,"peek_arrow_navigation",t)}function a(e,t){o.j(e,"close_side_peek",t)}function s(e,t){o.j(e,"close_peek",t)}function l(e,t){o.j(e,"expand_block",t)}function c(e,t){o.j(e,"open_peek_mode_picker",t)}function d(e,t){o.j(e,"open_peek_mode_picker",t)}function u(e,t){o.j(e,"update_peek_mode_format",t)}function p(e,t){o.j(e,"update_peek_mode_format",t)}},91536:(e,t,n)=>{n.d(t,{Ad:()=>m,E5:()=>K,If:()=>q,Jp:()=>H,Kf:()=>D,L7:()=>y,LA:()=>h,Mv:()=>C,NL:()=>w,O8:()=>F,PH:()=>$,Pd:()=>M,RP:()=>g,SM:()=>j,Xb:()=>A,b4:()=>b,cO:()=>W,d:()=>B,dE:()=>x,dS:()=>k,dU:()=>N,g9:()=>G,gR:()=>T,hY:()=>I,kM:()=>O,kx:()=>f,nC:()=>z,oE:()=>Z,pZ:()=>v,qT:()=>P,xt:()=>E,zU:()=>R});var o=n(87479),i=n(72141),r=n(49902),a=n(53965),s=n(7032),l=n(97978),c=n(46654),d=n(28578),u=n(77080),p=n(17224);function m(e,t){l.j(e,"permissions_settings_security_banner_show",t)}function f(e,t){l.j(e,"permissions_settings_security_banner_click",t)}function g(e,t){l.j(e,"permissions_settings_search_click",t),u.default.logEvent("permissions_settings_search_click",t.current_tab)}function h(e,t){l.j(e,"permissions_settings_export_guests_button_click",t),u.default.logEvent("permissions_settings_export_guests_button_click",1,t)}function v(e,t){l.j(e,"permissions_settings_table_multiselect_click",t)}function b(e,t){l.j(e,"permissions_settings_table_button_click",t),u.default.logEvent("permissions_settings_table_button_click",t.button_name,t)}function y(e,t){l.j(e,"permissions_settings_invite_button_click",t),u.default.logEvent("permissions_settings_invite_button_click",t.type)}function _(e){const{user_id:t,page_id:n,...o}=e;return o}function S(e,t){l.j(e,"update_page_permission","user_id"in t||"page_id"in t?_(t):t)}function w(e,t){l.j(e,"set_permission_item",t)}function k(e,t){if("team"===t.type){const{team_id:n,...o}=t;l.j(e,"expand_permission",{...o},{forceOverrideAutomaticEventData:{team_id:n}})}else l.j(e,"expand_permission",t)}function I(e,t){l.j(e,"page_share_user_access_role",t)}function C(e){const{newRole:t,availableRoles:n}=e;if("none"===t||"content_only_editor"===t)return;n.some((e=>"content_only_editor"===e.role))&&r.j({name:"save_non_content_editor_role"})}function x(e,t,n){l.j(e,"update_space_permission",{...i.jg(t)&&{updated_user_id:(0,s.cj)(t.user_id)},...i.FB(t)&&{updated_bot_id:(0,s.cj)(t.bot_id)},..."user_id"in t||"page_id"in t?_(t):t,...n}),u.default.logEvent("update_space_permission",null==n?void 0:n.from,{role:t.role})}function T(e,t){var n;let{item:o,teamStore:i}=t;const r=null===(n=i.getPermissionItems())||void 0===n?void 0:n.find((e=>e.type===o.type));(null==r?void 0:r.role)!==o.role&&p.YP(e,"update_team_permission",{store:i,..."user_id"in o||"page_id"in o?_(o):o,..."user_id"in o&&{permission_user_id:(0,s.cj)(o.user_id)},old_role:null==r?void 0:r.role,is_team_role_change:!1,is_permission_change:!0})}function M(e,t){let{permission_user_id:n,store:o,team_role:i}=t;p.YP(e,"update_team_permission",{store:o,permission_user_id:n,team_role:i,is_team_role_change:!0,is_permission_change:!1})}function P(e,t){l.j(e,"permissions_settings_tab_click",t),u.default.logEvent("permissions_settings_tab_click",t.tab,t)}function A(e){l.j(e,"permission_group_rename")}function R(e,t){l.j(e,"permission_group_set_icon",t)}function D(e,t){l.j(e,"permission_group_add_members",t)}function E(e){l.j(e,"permission_group_remove_member")}function B(e){l.j(e,"permission_group_delete")}function F(e){l.j(e,"permission_group_create")}function O(e){var t;let{environment:n,location:o,inSudoMode:i,store:r,newItems:a,fromPermissionWrapper:s}=e;const l=null===(t=r.getCollectionViewCollectionStore())||void 0===t?void 0:t.id,c=r.getParentCollectionIdUpToTwoLevels();V({store:r,newItems:a}).forEach((e=>{let{role_old_inherited_or_most_permissive:t,role_old_on_page:r,privacy_level:a,old_privacy_level:u,newItem:p}=e;S(n,a||u?{...p,location:o,in_sudo_mode:i||void 0,role_old_inherited_or_most_permissive:t,role_old_on_page:r,privacy_level:a,old_privacy_level:u,share_menu_session_id:d.ZP.state.sessionId,from_permission_wrapper:s,collection_id:l,parent_collection_id:c}:{...p,location:o,in_sudo_mode:i||void 0,role_old_inherited_or_most_permissive:t,role_old_on_page:r,share_menu_session_id:d.ZP.state.sessionId,from_permission_wrapper:s,collection_id:l,parent_collection_id:c})}))}function Z(e){const{environment:t,calculatedPermissions:n}=e;l.j(t,"page_share_permissions_summary",{share_menu_session_id:d.ZP.state.sessionId,page_permission_summary:L(n)})}function V(e){let{store:t,newItems:n}=e;const r=e=>`${e.type}:${o.D3(e)}`,s=t.getPermissionItems(),l=a.KX(s,r),d=c.YO(t).map((e=>e.permissionItem)),u=a.KX(d,r);return n.map((e=>{var t;const n=r(e),o=u[n],a=null===(t=l[n])||void 0===t?void 0:t.role,s=null==o?void 0:o.role;return(0,i.ix)(e)?{newItem:e,role_old_inherited_or_most_permissive:s,role_old_on_page:a,privacy_level:U(e),old_privacy_level:o&&(0,i.ix)(o)?U(o):"private"}:{newItem:e,role_old_inherited_or_most_permissive:s,role_old_on_page:a}}))}function U(e){return"none"===e.role?"private":e.unlisted_timestamp?"unlisted":"open"}function L(e){const{mostPermissiveSpaceItem:t,mostPermissiveAncestorTeamOwnerItem:n,mostPermissiveAncestorTeamMemberItem:o,pagePermissionUIModel:r}=e,{mostPermissiveGroupPermissions:a,mostPermissiveUserPermissions:s}=r;return{space:t.permissionItem.role,team_owner:null==n?void 0:n.permissionItem.role,team_member:null==o?void 0:o.permissionItem.role,groups:{full_access:a.filter((e=>{let{permissionItem:{role:t}}=e;return i.zz(t)})).length,can_edit:a.filter((e=>{let{permissionItem:{role:t}}=e;return i.VM(t)})).length,can_edit_content:a.filter((e=>{let{permissionItem:{role:t}}=e;return i.WY(t)})).length,can_comment:a.filter((e=>{let{permissionItem:{role:t}}=e;return i.rG(t)})).length,can_view:a.filter((e=>{let{permissionItem:{role:t}}=e;return i.rz(t)})).length},users:{full_access:s.filter((e=>{let{permissionItem:{role:t}}=e;return i.zz(t)})).length,can_edit:s.filter((e=>{let{permissionItem:{role:t}}=e;return i.VM(t)})).length,can_edit_content:s.filter((e=>{let{permissionItem:{role:t}}=e;return i.WY(t)})).length,can_comment:s.filter((e=>{let{permissionItem:{role:t}}=e;return i.rG(t)})).length,can_view:s.filter((e=>{let{permissionItem:{role:t}}=e;return i.rz(t)})).length},privacy_level:U(t.permissionItem)}}function j(e){l.j(e,"widen_permissions")}function N(e,t){l.j(e,"request_access",t),u.default.logEvent("request_access","page"===t.request_access_type?t.previous_access_level:"team_access_request",t)}function z(e,t){l.j(e,"grant_access",t),u.default.logEvent("grant_access",t.newAccessLevel,t)}function q(e,t){l.j(e,"grant_access_update_access_level",t)}function W(e,t){l.j(e,"ignore_access_request",t)}function H(e,t){l.j(e,"toggle_request_access_security_setting",t)}function K(e,t){l.j(e,"view_all_requests_from_membership_request_notification",t),u.default.logEvent("view_all_requests_from_membership_request_notification","notification",t)}function G(e){l.j(e,"open_guest_membership_request_modal"),u.default.logEvent("open_guest_membership_request_modal")}function $(e){l.j(e,"render_guest_membership_request_entry_point"),u.default.logEvent("render_guest_membership_request_entry_point")}},51787:(e,t,n)=>{n.d(t,{Cr:()=>b,EH:()=>u,Eb:()=>f,Kk:()=>m,Sn:()=>h,WC:()=>l,Zb:()=>v,Zf:()=>p,fh:()=>g,nL:()=>c,sb:()=>d,wF:()=>s});var o=n(97978),i=n(24646),r=n(77080),a=n(87956);function s(e,t){const n={...t,...(0,i.UF)({environment:e}),isSidePanelCloseable:r.default.checkGate("search_toggle_side_peek")};o.j(e,"open_search",n)}function l(e,t){o.j(e,"space_invitation_email_clicked",t)}function c(e,t){o.j(e,"select_search_item",t);const{numKeystrokes:n,timeToSelectMs:i,selectedItemIndex:a,originalPosition:s,context:l,numLocalResults:c,searchSessionId:d,searchSessionFlowNumber:u,numVisibleMembers:p,localSources:m,isMobile:f,timeToRenderResult:g}=t,h=Boolean(!!m&&m.length>0),v=p>1;r.default.logEvent("select_search_item",a,{numKeystrokes:n,timeToSelectMs:i,selectedItemIndex:a,numLocalResults:c,originalItemIndex:s,searchSessionFlowNumber:u,searchSessionId:d,context:l,isMultiplayer:v,isLocalResult:h,isMobile:f,timeToRenderResult:g});const b=1/(a+1);o.j(e,"quick_find_reciprocal_rank",{reciprocalRank:b,context:l,searchSessionId:d,numLocalResults:c,isMultiplayer:v}),r.default.logEvent("quick_find_reciprocal_rank",b,{context:l,searchSessionId:d,numLocalResults:c,isMultiplayer:v,isLocalResult:h,isMobile:f})}function d(e,t){o.j(e,"search_copy_link",t)}function u(e,t){o.j(e,"abandoned_search",t);const{numKeystrokes:n,timeToAbandonMs:i,numLocalResults:a,numVisibleMembers:s,isMobile:l}=t,c=s>1;r.default.logEvent("abandoned_search",n,{numKeystrokes:n,timeToAbandonMs:i,numLocalResults:a,searchSessionId:t.searchSessionId,isMultiplayer:c,isMobile:l}),o.j(e,"quick_find_reciprocal_rank",{reciprocalRank:0,searchSessionId:t.searchSessionId,numLocalResults:a,isMultiplayer:c}),r.default.logEvent("quick_find_reciprocal_rank",0,{searchSessionId:t.searchSessionId,numLocalResults:a,isMultiplayer:c,isMobile:l})}function p(e,t){o.j(e,"search_client_results",t)}function m(e,t){o.j(e,"search_post_click_page_interaction",t)}function f(e,t){var n;o.j(e,"search_post_click_page_exit",{dwellTime:(new Date).getTime()-t.timeEntered.getTime()},{forceOverrideAutomaticEventData:{queryId:null===(n=a.Z.state)||void 0===n?void 0:n.queryId}})}function g(e,t){const{currentSearchSessionId:n,currentWorkspaceId:i,newWorkspaceId:r}=t;o.j(e,"search_quick_search_switch_workspace",{current_search_session_id:n,current_workspace_id:i,new_workspace_id:r})}function h(e,t){o.j(e,"search_open_shortcut_settings_from_command_search_hint",{search_session_id:t.searchSessionId})}function v(e,t){o.j(e,"search_hover_command_search_hint",{search_session_id:t.searchSessionId})}function b(e,t){o.j(e,"search_query_has_operators",{operations:t.operations,search_session_id:t.searchSessionId})}},14549:(e,t,n)=>{n.d(t,{A0:()=>h,AQ:()=>m,He:()=>c,O$:()=>d,SU:()=>a,Wb:()=>f,XI:()=>s,eo:()=>b,gV:()=>l,ps:()=>p,qP:()=>u,wr:()=>g,xG:()=>y,xU:()=>v});var o=n(97978),i=n(24646),r=n(77080);function a(e,t){o.j(e,"open_settings",{...t,...(0,i.UF)({environment:e})})}function s(e,t){o.j(e,"toggle_settings_tab",t)}function l(e,t){o.j(e,"site_settings_action",t)}function c(e){o.j(e,"upload_profile_photo")}function d(e,t){o.j(e,"name_changed",t)}function u(e){o.j(e,"delete_account_clicked")}function p(e){o.j(e,"delete_account_confirmed")}function m(e){o.j(e,"log_out_from_active_sessions_clicked")}function f(e){o.j(e,"change_password_clicked")}function g(e){o.j(e,"remove_password_clicked")}function h(e,t){o.j(e,"locale_changed",t)}function v(e,t){o.j(e,"change_locale_clicked",t)}function b(e,t){o.j(e,"invite_link_updated",t),r.default.logEvent("invite_link_updated",String(t.enabled),t)}function y(e,t){o.j(e,"allowed_email_domains_updated",t)}},66324:(e,t,n)=>{n.d(t,{An:()=>k,HY:()=>S,LM:()=>s,ME:()=>b,MR:()=>g,Qd:()=>l,Se:()=>v,VS:()=>h,Yg:()=>I,Zm:()=>u,_f:()=>m,ai:()=>y,kV:()=>p,mv:()=>a,ph:()=>d,qY:()=>w,so:()=>_,t8:()=>f,v$:()=>c});var o=n(97978),i=n(24646),r=n(17224);function a(e,t){o.j(e,"reorder_outliner_section",t)}function s(e){o.j(e,"sidebar_expand")}function l(e){o.j(e,"sidebar_unexpand")}function c(e,t){o.j(e,"open_comments_sidebar",t)}function d(e,t){o.j(e,"open_updates_sidebar",t)}function u(e,t){o.j(e,"updates_sidebar_tab_click",t)}function p(e,t){o.j(e,"open_view_all_popover",t)}function m(e,t){o.j(e,"select_page_from_view_all_popover",t)}function f(e,t){const{teamStore:n,...o}=t;r.YP(e,"outliner_item_toggle",{store:n,...o})}function g(e,t){r.YP(e,"outliner_team_toggle",t)}function h(e,t){o.j(e,"outliner_section_toggle",t)}function v(e){o.j(e,"click_nested_child_page")}function b(e,t){o.j(e,"click_desktop_navigator",t)}function y(e){o.j(e,"open_space_switcher")}function _(e){o.j(e,"space_switcher_select_space")}function S(e){o.j(e,"space_switcher_logout_click")}function w(e,t){o.j(e,"pin_page",t)}function k(e,t){o.j(e,"unpin_page",t)}function I(e,t){const{teamStore:n,...o}=t;r.YP(e,"click_outliner_item",{store:n,...(0,i.UF)({environment:e}),...o})}},81918:(e,t,n)=>{n.d(t,{$B:()=>O,BP:()=>g,Cg:()=>ae,Ci:()=>y,Dn:()=>_,Ef:()=>k,HH:()=>S,Io:()=>oe,JX:()=>B,Jk:()=>q,Jo:()=>D,KF:()=>R,KZ:()=>ee,LO:()=>E,NF:()=>T,O8:()=>se,Om:()=>ne,P0:()=>W,P1:()=>C,Rb:()=>h,S4:()=>J,Sw:()=>b,T4:()=>w,TJ:()=>Y,VM:()=>le,VT:()=>p,Vi:()=>$,Y7:()=>X,ZA:()=>G,Zm:()=>P,Zv:()=>te,_6:()=>j,_m:()=>Z,aT:()=>N,am:()=>x,bw:()=>v,dw:()=>V,fN:()=>de,j7:()=>F,jk:()=>re,kj:()=>m,l0:()=>I,o8:()=>ce,pC:()=>z,pR:()=>Q,rZ:()=>A,rv:()=>L,tB:()=>ie,tX:()=>K,vC:()=>U,wV:()=>M,x8:()=>H,z0:()=>f});var o=n(79946),i=n(54642),r=n(97978),a=n(15010),s=n(77080),l=n(29677),c=n(88893),d=n(35057),u=n(88280);function p(e,t){r.oP(e,{eventName:"create_space",eventProperties:t});const n=(0,d.zt)();if("professional"===t.domain_type&&(r.j(e,"professional_workspace_created",t),o.L1({subscriptionTier:n,planType:t.planType})),"team"===t.planType&&(r.j(e,"team_workspace_created",t),o.tO({subscriptionTier:n,planType:t.planType})),o.VT({subscriptionTier:n,domainType:t.domain_type}),"team"===t.planType){const t=o.Q3(),n=o.SY();i.trackConversionEvent(e,{eventName:"create_team_space",fbp:t,clickIds:n})}}function m(e,t){r.j(e,"join_space",t)}function f(e){r.j(e,"leave_space"),q(e,{invite_origin:"workspace_leave",domainType:(0,a.JF)(),new_workspace_member_count:-1,new_workspace_member_ids:[e.currentUser.id??""]})}function g(e){r.j(e,"delete_space"),s.default.logEvent("delete_space")}function h(e,t){r.j(e,"convert_guest_to_member",t),s.default.logEvent("convert_guest_to_member",t.convert_to,{origin:t.origin})}function v(e){r.j(e,"remove_guest")}function b(e,t){s.default.logEvent("remove_member",t.member_user_id,t),q(e,{invite_origin:"workspace_remove_member",domainType:t.domainType,new_workspace_member_count:t.new_workspace_member_count,new_workspace_member_ids:[t.member_user_id]}),r.j(e,"remove_member",{member_user_id:t.member_user_id,member_role:t.member_role,contraction_survey_id:t.contraction_survey_id})}function y(e){r.j(e,"managed_user_reactivate_button_clicked")}function _(e,t){r.j(e,"managed_user_support_access_toggled",t)}function S(e,t){r.j(e,"managed_users_dashboard_search",t)}function w(e,t){r.j(e,"managed_users_external_space_access_set",t)}function k(e,t){r.j(e,"managed_users_prevent_support_access_toggled",t)}function I(e,t){r.j(e,"managed_users_session_duration_modal_confirmed",t)}function C(e,t){r.j(e,"managed_user_delete_button_clicked",t)}function x(e,t){r.j(e,"managed_user_edit_modal_submitted",t)}function T(e){r.j(e,"managed_user_log_out_button_clicked")}function M(e,t){r.j(e,"managed_user_remove_from_external_workspace_button_clicked",t)}function P(e){r.j(e,"managed_user_reset_password_button_clicked")}function A(e){r.j(e,"managed_user_suspend_button_clicked")}function R(e,t){r.j(e,"managed_users_log_out_all_button_clicked",t)}function D(e,t){r.j(e,"managed_users_reset_passwords_all_button_clicked",t)}function E(e,t){r.j(e,"managed_users_session_duration_selected",t)}function B(e,t){r.j(e,"managed_user_edit_profile_modal_open",t)}function F(e,t){r.j(e,"managed_user_delete_modal_confirmed",t)}function O(e,t){r.j(e,"managed_user_edit_modal_confirmed",t)}function Z(e){r.j(e,"managed_user_log_out_modal_confirmed")}function V(e,t){r.j(e,"managed_user_remove_from_external_workspace_modal_confirmed",t)}function U(e){r.j(e,"managed_user_reset_password_modal_confirmed")}function L(e){r.j(e,"managed_user_suspend_modal_confirmed")}function j(e,t){r.j(e,"managed_users_log_out_all_modal_confirmed",t)}function N(e,t){r.j(e,"managed_users_reset_passwords_all_modal_confirmed",t)}function z(e){r.j(e,"managed_users_dashboard_button_clicked")}function q(e,t){const n=(0,d.zt)();r.j(e,"workspace_member_number_update",{new_workspace_member_count:t.new_workspace_member_count,new_workspace_member_ids:t.new_workspace_member_ids,origin:t.invite_origin,subscription_tier:n,domain_type:t.domainType,allow_domain_auto_invite:t.allow_domain_auto_invite,company_segment:(0,c.Ns)()}),s.default.logEvent("workspace_member_number_update",t.new_workspace_member_count,{origin:t.allow_domain_auto_invite?`${t.invite_origin}_allow_domain`:t.invite_origin,subscription_tier:n,domain_type:t.domainType,company_segment:(0,c.Ns)()})}function W(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_click_menu_item",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id})}function H(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_render_menu_item",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id})}function K(e,t){const n=(0,d.zt)(),o=(0,a.JF)(),i="member"===t.invite_option?t.can_add_member?"member":"request_member":"guest";r.j(e,"person_property_invite_click_invite_button",{subscription_tier:n,domain_type:o,invited_type:i,invited_user_count:t.invited_user_count,origin:t.origin,invite_token_query:t.inviteTokenQuery,invite_targets:t.inviteTargets,invite_flow_id:t.invite_flow_id})}function G(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_click_upgrade_button",{subscription_tier:n,domain_type:o,origin:t.origin,invited_user_count:t.invited_user_count,invite_flow_id:t.invite_flow_id})}function $(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_guest_invited",{subscription_tier:n,domain_type:o,invited_user_count:t.invited_user_count,origin:t.origin,invite_flow_id:t.invite_flow_id})}function Q(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_member_invited",{subscription_tier:n,domain_type:o,invited_user_count:t.invited_user_count,origin:t.origin,invite_flow_id:t.invite_flow_id})}function Y(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_member_requested",{subscription_tier:n,domain_type:o,invited_user_count:t.invited_user_count,origin:t.origin,invite_flow_id:t.invite_flow_id})}function J(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_error",{subscription_tier:n,domain_type:o,invite_stage:t.invite_stage,invite_flow_id:t.invite_flow_id,error:t.error})}function X(e,t){const n=(0,d.zt)(),o=(0,a.JF)(),i="member"===t.invite_option?t.can_add_member?"member":"request_member":"guest";r.j(e,"person_property_invite_completed",{subscription_tier:n,domain_type:o,invited_type:i,invited_user_count:t.invited_user_count,is_success:t.is_success,origin:t.origin,invite_flow_id:t.invite_flow_id})}function ee(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_message_typed",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id})}function te(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_dismiss_popup",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id})}function ne(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_change_permission",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id,invited_role:t.invited_role})}function oe(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_click_invite_option",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id,invite_option:t.invite_option})}function ie(e,t){r.j(e,"guest_invite_request_setting_toggled",t)}function re(e,t){r.j(e,"settings_deeplink_clicked",t)}function ae(e,t){r.j(e,"guest_invite_request_resolved",t)}function se(e,t){r.j(e,"resolve_membership_request",t),s.default.logEvent("resolve_membership_request",t.status,t)}function le(e,t){r.j(e,"request_access_review_button_clicked",t),s.default.logEvent("request_access_review_button_clicked",t.status,{from:t.from,user_count:t.user_count,request_type:t.request_type})}function ce(e,t){if(r.j(e,"disable_guest_toggle",t),!0===t.new_value&&!t.keep_existing_guests_if_disabled){const t=u.subscriptionDataStoreInstance.state;if(!t)return;const n=(0,c.ND)(t).length;n>0&&de(e,{origin:"space_setting_disable_guest",changedNumber:-n})}}function de(e,t){let{inviteTargets:n,origin:o,changedNumber:i}=t;const p=(0,a.JF)(),m=(0,d.zt)();if(i)return r.j(e,"workspace_guest_number_update",{new_workspace_guest_count:i,origin:o,subscription_tier:m,domain_type:p,company_segment:(0,c.Ns)()}),void s.default.logEvent("workspace_guest_number_update",i,{origin:o,subscription_tier:m,domain_type:p,company_segment:(0,c.Ns)()});const f=u.subscriptionDataStoreInstance.state;if(!f||!n)return;const g=c.CM(f).map((e=>e.userId)),h=n.filter((e=>!!(0,l.cl)(e)||"existingUser"===e.type&&!g.includes(e.value.id)));0!==h.length&&(r.j(e,"workspace_guest_number_update",{new_workspace_guest_count:h.length,origin:o,subscription_tier:m,domain_type:p,company_segment:(0,c.Ns)()}),s.default.logEvent("workspace_guest_number_update",h.length,{origin:o,subscription_tier:m,domain_type:p,company_segment:(0,c.Ns)()}))}},86572:(e,t,n)=>{n.d(t,{$l:()=>b,Aq:()=>j,Bg:()=>L,Dc:()=>D,EU:()=>v,FR:()=>E,Ib:()=>ne,LY:()=>z,Lc:()=>R,Ls:()=>$,NI:()=>te,PN:()=>O,QO:()=>J,Qr:()=>P,R3:()=>T,VQ:()=>Z,Vk:()=>se,YT:()=>_,Zb:()=>Q,_j:()=>H,_q:()=>q,b0:()=>k,bf:()=>re,cY:()=>U,e3:()=>y,fZ:()=>F,g3:()=>Y,iL:()=>V,j:()=>le,jh:()=>K,jw:()=>A,k1:()=>C,k6:()=>W,lj:()=>ie,lq:()=>x,ms:()=>ae,nd:()=>S,q7:()=>w,qz:()=>B,rO:()=>h,rY:()=>N,rx:()=>X,sA:()=>ee,wl:()=>G,xo:()=>M,y$:()=>I,z2:()=>oe});var o=n(79946),i=n(99405),r=n(2438),a=n(53965),s=n(7032),l=n(19584),c=n(47839),d=n(95477),u=n(97978),p=n(15010),m=n(77080),f=n(88893),g=n(35057);function h(e,t){u.j(e,"pricing_grid_button_click",t),m.default.logEvent("pricing_grid_button_click",void 0,t),te(e,{location:"plans_page",cta_item:t.plan,currency_code:t.currency_code,page_section:"all_plans_grid",button_text:t.button_text})}function v(e){u.j(e,"pricing_grid_contact_sales_click")}function b(e,t){u.j(e,"pricing_grid_view",t),m.default.logEvent("pricing_grid_view",void 0,t)}function y(e){u.j(e,"pricing_grid_view_end"),m.default.logEvent("pricing_grid_view_end")}function _(e,t){u.j(e,"subscription_update_modal_open",t),m.default.logEvent("subscription_update_modal_open",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function S(e,t){u.j(e,"subscription_update_modal_confirmation_click",{...a.CE(t.state,"modalId"),modal_id:t.state.modalId}),m.default.logEvent("subscription_update_modal_confirmation_click",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function w(e,t){u.j(e,"subscription_update_modal_exit",{...a.CE(t.state,"modalId"),modal_id:t.state.modalId}),m.default.logEvent("subscription_update_modal_exit",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function k(e,t){u.j(e,"subscription_update_modal_billing_interval_updated",t),m.default.logEvent("subscription_update_modal_billing_interval_updated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function I(e,t){u.j(e,"subscription_update_modal_expand_billing_summary",{...a.CE(t.state,"modalId"),modal_id:t.state.modalId}),m.default.logEvent("subscription_update_modal_expand_billing_summary",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function C(e,t){u.j(e,"subscription_update_modal_hide_billing_summary",{...a.CE(t.state,"modalId"),modal_id:t.state.modalId}),m.default.logEvent("subscription_update_modal_hide_billing_summary",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function x(e){u.j(e,"subscription_billing_dismissed"),m.default.logEvent("subscription_billing_dismissed",void 0,{device_os:e.device.os,platform:e.device.platform})}function T(e,t){u.j(e,"subscription_billing_opened",t),m.default.logEvent("subscription_billing_opened",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function M(e){u.j(e,"subscription_plans_dismissed"),m.default.logEvent("subscription_plans_dismissed",void 0,{device_os:e.device.os,platform:e.device.platform})}function P(e,t){u.j(e,"subscription_plans_opened",t),m.default.logEvent("subscription_plans_opened",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function A(e){u.j(e,"currently_subscribed")}function R(e,t){u.j(e,"subscription_upgrade_modal_open",t),m.default.logEvent("subscription_upgrade_modal_open",void 0,t)}function D(e,t){const{event:n,modal_id:o}=t,i={...(0,l.by)(n),modal_id:o};u.j(e,"subscription_upgrade_modal_payment_element_changed",i),m.default.logEvent("subscription_upgrade_modal_payment_element_changed",void 0,{...i,device_os:e.device.os,platform:e.device.platform})}function E(e,t){u.j(e,"subscription_upgrade_modal_billing_interval_updated",t),m.default.logEvent("subscription_upgrade_modal_billing_interval_updated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function B(e,t){u.j(e,"subscription_upgrade_modal_add_on_features_updated",t),m.default.logEvent("subscription_upgrade_modal_add_on_features_updated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function F(e,t){u.j(e,"subscription_upgrade_modal_upgrade_accepted",t),m.default.logEvent("subscription_upgrade_modal_upgrade_accepted",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function O(e,t){u.j(e,"subscription_upgrade_modal_upgrade_click",t),m.default.logEvent("subscription_upgrade_modal_upgrade_click",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function Z(e,t){u.j(e,"subscription_upgrade_modal_upgrade_failed_validation",t),m.default.logEvent("subscription_upgrade_modal_upgrade_failed_validation",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function V(e,t){u.j(e,"subscription_upgrade_onboarding_failed_validation",t)}function U(e,t){u.j(e,"subscription_upgrade_modal_upgrade_failed_payment",t),m.default.logEvent("subscription_upgrade_modal_upgrade_failed_payment",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function L(e){u.j(e,"subscription_upgrade_onboarding_failed_payment")}function j(e,t){u.j(e,"subscription_upgrade_modal_upgrade_failed_payment_recovery_initiated",t),m.default.logEvent("subscription_upgrade_modal_upgrade_failed_payment_recovery_initiated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function N(e,t){u.j(e,"subscription_upgrade_modal_address_form_updated",t),m.default.logEvent("subscription_upgrade_modal_address_form_updated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function z(e,t){u.j(e,"subscription_upgrade_modal_exit",t),m.default.logEvent("subscription_upgrade_modal_exit",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function q(e,t){u.j(e,"subscription_upgrade_modal_stripe_error",t),m.default.logEvent("subscription_upgrade_modal_stripe_error",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function W(e,t){u.j(e,"create_subscription",t),m.default.logEvent("create_subscription",t.plan,t)}async function H(e,t){var n,a,l,g;const h=p.JF(),v=f.qX();u.j(e,"update_subscription_tier",{from:t.from,action:t.action,old_subscription_tier:t.oldSubscriptionTier,new_subscription_tier:t.newSubscriptionTier,old_price_id:t.oldPriceId,new_price_id:t.newPriceId,old_currency:t.oldCurrency,new_currency:t.newCurrency,old_add_ons:t.oldAddOns,new_add_ons:t.newAddOns,old_billing_interval:t.oldBillingInterval,new_billing_interval:t.newBillingInterval,is_cancel_subscription:t.isCancelSubscription,is_professional_team:t.isProfessionalTeamUser,domain_type:h,space_visible_members:v,is_trial:t.isTrial,is_mm_or_ent_trial:t.isMmOrEnt,trial_id:null===(n=t.trialData)||void 0===n?void 0:n.id,trial_from:null===(a=t.trialData)||void 0===a?void 0:a.from}),m.default.logEvent("update_subscription_tier",void 0,{from:t.from,action:t.action,old_subscription_tier:t.oldSubscriptionTier,new_subscription_tier:t.newSubscriptionTier,old_price_id:t.oldPriceId,new_price_id:t.newPriceId,old_currency:t.oldCurrency,new_currency:t.newCurrency,old_add_ons:t.oldAddOns,new_add_ons:t.newAddOns,old_billing_interval:t.oldBillingInterval,new_billing_interval:t.newBillingInterval,is_cancel_subscription:t.isCancelSubscription,space_visible_members:v,is_trial:t.isTrial,device_os:e.device.os,platform:e.device.platform,is_mm_or_ent_trial:t.isMmOrEnt});const b=null===(l=t.oldAddOns)||void 0===l?void 0:l.includes("ai"),y=null===(g=t.newAddOns)||void 0===g?void 0:g.includes("ai");if(!b&&y&&(u.j(e,"ai_addon_purchased",t),o.dG({eventType:"ai_addon_purchased",source:"client"})),!t.oldSubscriptionTier||!t.newSubscriptionTier)return;const{device:_}=e;if(!(0,r.nR)(t.oldSubscriptionTier)&&(0,r.nR)(t.newSubscriptionTier)&&"personal"!==t.newSubscriptionTier){const n={country:t.addressCountry,productName:t.newPriceId,price:t.creditAmount||0,spaceId:(0,s.cj)(t.spaceId),deviceType:_.isTablet?"tablet":_.isMobile?"mobile":"desktop",subscriptionTier:t.newSubscriptionTier};if("professional"===h&&u.j(e,"professional_workspace_upgraded",t),u.j(e,"workspace_upgraded",t),o.dG({eventType:"workspace_upgraded",source:"client",eventData:{...n,domainType:h}}),"professional"===h&&o.dG({eventType:"professional_workspace_upgraded",source:"client"}),"team"===t.planType&&(u.j(e,"team_workspace_upgraded",t),o.dG({eventType:"team_workspace_upgraded",source:"client"})),e.device.isElectron){const o=(0,i.fo)(d.default.domainBaseUrl,{deviceId:await u.cG(e),oldSubscriptionTier:t.oldSubscriptionTier,newSubscriptionTier:t.newSubscriptionTier,isProfessionalTeamUser:t.isProfessionalTeamUser,deviceType:e.device.deviceType,domainType:h,eventData:n});return void c.openExternalUrl(o)}}}function K(e,t){u.j(e,"subscription_update_plan",t),m.default.logEvent("subscription_update_plan",void 0,t)}function G(e,t){u.j(e,"subscription_update_billing",t),m.default.logEvent("subscription_update_billing",void 0,t)}function $(e,t){const{name:n,email:o,...i}=t;u.j(e,"enterprise_sales_contact",{...i,enterprise_name:n,enterprise_email:o}),m.default.logEvent("enterprise_sales_contact")}function Q(e){u.j(e,"enterprise_sales_contact_opened")}function Y(e){u.j(e,"enterprise_sales_contact_dismissed")}function J(e,t){u.j(e,"enterprise_sales_contact_updated",t)}function X(e,t){u.j(e,"cancel_subscription",t),m.default.logEvent("cancel_subscription",void 0,t)}function ee(e,t){u.j(e,"click_upgrade_button",t),m.default.logEvent("click_upgrade_button",void 0,t)}function te(e,t){u.j(e,"plan_cta_click",t),m.default.logEvent("plan_cta_click",void 0,t)}function ne(e){u.j(e,"compare_all_features_click"),m.default.logEvent("compare_all_features_click",void 0)}function oe(e){u.lu(e,"approaching_block_limit","approaching_block_limit",60)}function ie(e){const t=u.lu(e,"reach_block_limit","reach_block_limit",60);m.default.logEvent("reach_block_limit",1),t&&u.Zf(e,{reach_block_limit:!0,reach_block_limit_time:Date.now(),subscription_tier:g.zt()})}function re(e,t){le(e,{name:"member_requested_ai_addon",args:t}),m.default.logEvent("member_requested_ai_addon",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function ae(e,t){le(e,{name:"partner_trial_signup",args:t}),m.default.logEvent("partner_trial_signup",void 0,{...t})}function se(e){le(e,{name:"cancel_trial_button_clicked"}),m.default.logEvent("cancel_trial_button_clicked",void 0)}function le(e,t){const n=t.name,o="args"in t?t.args:void 0;u.j(e,n,o)}},25888:(e,t,n)=>{n.d(t,{Ar:()=>s,Fs:()=>c,IS:()=>d,LS:()=>u,Ot:()=>a,V:()=>l,wk:()=>p});var o=n(97978),i=n(24646),r=n(77080);function a(e,t){o.j(e,"open_support_chat",t)}function s(e,t){o.j(e,"click_help",{from:t.from,qna_session_id:t.qnaSessionId}),r.default.logEvent("click_help")}function l(e,t){o.j(e,"click_help_item",{...t,...(0,i.UF)({environment:e})}),"sales_chat"===t.item&&r.default.logEvent("click_help_item")}function c(e,t){o.j(e,"global_click_learn",t)}function d(e,t){o.j(e,"qna_terms_click",t)}function u(e){o.j(e,"zendesk_metadata_open_messenger")}function p(e){o.j(e,"zendesk_metadata_signup")}},17224:(e,t,n)=>{n.d(t,{$:()=>M,$1:()=>w,$4:()=>p,BW:()=>R,Bd:()=>g,FN:()=>j,GZ:()=>d,Gp:()=>C,HN:()=>f,IW:()=>T,LB:()=>W,NO:()=>y,OR:()=>D,Ph:()=>N,Pr:()=>_,Qk:()=>E,SJ:()=>V,UD:()=>I,XT:()=>z,YP:()=>O,cX:()=>k,co:()=>H,dw:()=>u,ej:()=>Z,er:()=>A,ix:()=>S,kr:()=>v,mF:()=>x,mi:()=>P,o_:()=>b,pi:()=>m,rF:()=>L,uA:()=>q,v2:()=>h,z:()=>B});var o=n(53965),i=n(1898),r=n(97978),a=n(24646),s=n(68418),l=n(55838),c=n(77080);async function d(e,t){await r.j(e,"manage_teams_filter_click",t)}function u(e,t){r.j(e,"manage_teams_sort",t)}function p(e,t){O(e,"duplicate_team",t)}function m(e,t){r.j(e,"open_team_browser",{...t,...(0,a.UF)({environment:e})})}function f(e,t){r.j(e,"close_team_browser",{...t,num_of_total_teams:t.num_of_joined_teams+t.num_of_unjoined_teams})}function g(e,t){r.j(e,"team_browser_search_cleared",t)}function h(e,t){const{teamStore:n,outliner_type:o}=t;O(e,"team_browser_member_list_hover",{store:n,outliner_type:o})}function v(e,t){r.j(e,"create_team_start",{from:t.from,flow_id:t.flowId}),c.default.logEvent("create_team_start",1,{...t,...(0,a.UF)({environment:e})})}async function b(e,t){const{store:n}=t;await n.load(),O(e,"create_team_complete",t),F("create_team_complete",t)}async function y(e,t){const{store:n}=t;await n.load(),O(e,"enable_teams",t)}function _(e,t){const{screen:n,...o}=t;if(n===s.F.Team){const t={screen:"team",...o};return O(e,"close_create_team_modal",t),void F("close_create_team_modal",t)}const i={screen:"members",flow_id:t.flow_id,from:t.from,team_id:t.team_id,store:t.store};O(e,"close_create_team_modal",i),F("close_create_team_modal",i)}function S(e,t){O(e,"invite_team_members",t),F("invite_team_members",t)}function w(e,t){O(e,"invite_team_groups",t),F("invite_team_groups",t)}function k(e,t){O(e,"set_default_team",t)}function I(e,t){O(e,"join_team",t),F("join_team",t)}function C(e,t){O(e,"archive_team",t)}function x(e,t){O(e,"transition_to_zero_teams",t)}function T(e,t){O(e,"restore_team",t)}function M(e,t){O(e,"remove_team_members",t)}function P(e,t){O(e,"remove_team_groups",t)}function A(e,t){O(e,"change_teams_order",t)}function R(e,t){O(e,"change_team_access_level",t)}function D(e,t){O(e,"update_team_settings",t)}function E(e,t){O(e,"open_outliner_team_overflow",{...t,...(0,a.UF)({environment:e})})}function B(e,t){O(e,"click_outliner_team_overflow_option",t),F("click_outliner_team_overflow_option",t)}function F(e,t){const{store:n,...o}=t;n?c.default.logEvent(e,1,{...r.nB(n),...o}):c.default.logEvent(e,1,t)}async function O(e,t,n){const{store:i,...a}=n;if(!i)return void(await r.j(e,t,{...a}));const s=r.nB(i),l=o.CE(s,"team_id");await r.j(e,t,{...l,...a},{forceOverrideAutomaticEventData:{team_id:s.team_id}})}function Z(e,t,n,i,a){const{store:s,...l}=a;if(!s)return void r.lu(e,t,n,i,{...l});const c=r.nB(s),d=o.CE(c,"team_id");r.lu(e,t,n,i,{...d,...l},{forceOverrideAutomaticEventData:{team_id:c.team_id}})}function V(e,t){O(e,"open_team_home",t)}function U(e){switch(e){case l.a.General:return"general";case l.a.Members:return"members";case l.a.Security:return"security";default:(0,i.t1)(e)}}function L(e,t){O(e,"click_team_settings_tab",{store:t.store,tab_old_value:U(t.tab_old_value),tab_new_value:U(t.tab_new_value)})}function j(e,t){O(e,"restore_team_permissions",t)}function N(e,t){O(e,"team_invite_link_confirmation_selection",t)}function z(e,t){O(e,"copy_team_invite_link",t),F("copy_team_invite_link",t)}function q(e,t){O(e,"click_team_invite_link",t)}function W(e,t){O(e,"request_access_to_team",t)}function H(e,t){O(e,"resolve_team_access_request",t)}},81193:(e,t,n)=>{n.d(t,{$6:()=>F,$K:()=>w,Cu:()=>P,EZ:()=>B,HU:()=>p,Ib:()=>d,JJ:()=>E,Jw:()=>x,PE:()=>m,T2:()=>c,Ui:()=>Z,XQ:()=>y,Xy:()=>u,Y4:()=>R,Yn:()=>I,ZE:()=>k,ar:()=>D,bR:()=>T,dZ:()=>b,en:()=>v,gI:()=>O,jW:()=>f,me:()=>A,n1:()=>g,nn:()=>C,rN:()=>_,sY:()=>S,ye:()=>h});n(57658);var o=n(92996),i=n(7032),r=n(1898),a=n(97978),s=n(24646),l=n(77080);function c(e){a.j(e,"browse_more_templates_click"),l.default.logEvent("browse_more_templates_click",1)}function d(e){a.j(e,"in_app_template_gallery_brand_click")}function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];a.j(e,"duplicate_template",{...t,is_paid:!1,is_selectable_fork_page:n}),n&&l.default.logEvent("duplicate_template_from_fork_page_multiple_spaces",t.success?"succeed":"error",{from:t.from,context:t.context})}function p(e,t){a.j(e,"duplicate_template_attempt",t)}function m(e,t){a.j(e,"configure_template_button",t)}function f(e,t){a.j(e,"template_modal_open",{...t,...(0,s.UF)({environment:e})}),l.default.logEvent("template_modal_open",1)}function g(e,t){a.j(e,"template_modal_item_click",t),l.default.logEvent("template_modal_item_click",1)}function h(e,t){a.j(e,"template_modal_get_template_click",t),l.default.logEvent("template_modal_get_template_click",1)}function v(e,t){const{team_id:n,...o}=t;a.j(e,"template_modal_accept",o,{forceOverrideAutomaticEventData:{team_id:n}}),l.default.logEvent("template_modal_accept",1)}function b(e,t){a.j(e,"create_collection_template",t),l.default.logEvent("create_collection_template",1)}function y(e,t){a.j(e,"activate_collection_template",t),l.default.logEvent("activate_collection_template",1)}function _(e,t){a.j(e,"select_template",t)}function S(e,t){a.j(e,"collection_template_action",t)}function w(e,t){a.j(e,"click_outliner_team_new_page",t)}function k(e,t){a.j(e,"click_team_new_page_option",t)}function I(e,t){a.j(e,"show_team_duplicate_template_confirmation",t)}function C(e,t){a.j(e,"click_team_duplicate_template_confirmation_option",t)}function x(e,t){let{from:n,wiki_block_id:i,destination_team_id:r,wiki_template_id:a}=t;M(e,{from:n,preset_uri:"notion://wiki/wiki_preset",created_page_ids:[i],database_types:[o.GZ],destination_team_id:r,wiki_template_id:a})}function T(e,t){let{from:n,preset_uri:o,created_block_stores:i,destination_team_id:a}=t;const s=[],l=[];for(const r of i){var c;const e=null===(c=r.getCollectionStore())||void 0===c?void 0:c.getDatabaseType();e&&(l.push(r.id),s.push(e))}const d=i.map((e=>{var t;return null===(t=e.getFormat())||void 0===t?void 0:t.app_id})).filter(r.$K);M(e,{from:n,preset_uri:o,created_page_ids:l,database_types:s,destination_team_id:a,app_ids:[...new Set(d)]})}function M(e,t){a.j(e,"create_app_template",t)}function P(e,t){a.j(e,"delete_app_template",t)}function A(e,t){a.j(e,"create_typed_dbs_in_team_latency",t)}function R(e,t){a.j(e,"apply_preset_features",t)}function D(e,t){a.j(e,"template_duplication_v2_modal_exposed",{template_block_id:(0,i.F9)(t.templateBlockId),from:t.from,num_of_space_views:t.numOfSpaceViews,num_of_loaded_space_views:t.numOfLoadedSpaceViews,num_of_editable_space_views:t.numOfEditableSpaceViews,group:t.group})}function E(e,t){a.j(e,"template_duplication_v2_modal_open",{template_block_id:(0,i.F9)(t.templateBlockId),from:t.from,num_of_space_views:t.numOfSpaceViews,num_of_loaded_space_views:t.numOfLoadedSpaceViews,num_of_editable_space_views:t.numOfEditableSpaceViews,group:t.group})}function B(e,t){a.j(e,"template_duplication_v2_modal_close",{template_block_id:t.templateBlockId&&(0,i.F9)(t.templateBlockId)})}function F(e,t){a.j(e,"template_duplication_v2_account_switcher_open",{template_block_id:(0,i.F9)(t.templateBlockId),num_of_users:t.numOfUsers})}function O(e,t){a.j(e,"template_duplication_v2_switch_space",{template_block_id:(0,i.F9)(t.templateBlockId),template_destination_space_id:t.templateDestinationSpaceId&&(0,i.F9)(t.templateDestinationSpaceId),num_of_users:t.numOfUsers})}function Z(e,t){a.j(e,"template_not_found_in_gallery",{template_block_id:(0,i.F9)(t.templateBlockId)})}},11969:(e,t,n)=>{n.d(t,{K:()=>i,y:()=>r});var o=n(97978);function i(e,t){const{from:n}=t;o.j(e,"show_tooltip",{from:n,time:Date.now()})}function r(e,t){const{from:n}=t;o.j(e,"dismiss_tooltip",{from:n,time:Date.now()})}},3022:(e,t,n)=>{n.d(t,{F4:()=>u,Gb:()=>r,LA:()=>a,SL:()=>m,Y_:()=>v,ap:()=>f,h2:()=>h,iB:()=>l,kY:()=>c,mc:()=>b,sI:()=>p,vk:()=>i,vt:()=>s,y9:()=>d,zQ:()=>g});var o=n(97978);function i(e,t){o.lu(e,"legacy_transclusion_show",`legacy_transclusion_show_${t.block_type}`,3600,t)}function r(e,t){o.j(e,"legacy_transclusion_autofix",t)}function a(e,t){o.j(e,"transaction_timestamp_collision",t)}function s(e,t){o.j(e,"transaction_timestamp_regression",t)}function l(e,t){o.j(e,"transaction_race_hazard",t)}function c(e,t){o.j(e,"transaction_async_data_loss",t)}function d(e,t){o.j(e,"transaction_deadlock_warning",t)}function u(e,t){o.j(e,"transaction_too_large",t)}function p(e,t){o.j(e,"transaction_queue_error_show",t)}function m(e){o.j(e,"connection_error_show",{})}function f(e,t){o.j(e,"connection_error_indicator_details_show",t)}function g(e,t){o.j(e,"low_storage_error_show",t)}function h(e,t){o.j(e,"transaction_queue_healthcheck",t)}function v(e,t){o.j(e,"save_edits_error_modal_show",t)}function b(e,t){o.j(e,"unsaved_transaction_error",t)}},54642:(e,t,n)=>{n.r(t),n.d(t,{activateReferral:()=>Po,addUserToOrganizationSpaces:()=>td,addUserToWaitlist:()=>Zc,addUsersToSpace:()=>Mn,addWebClipperFile:()=>Bt,addWebClipperURLs:()=>zo,adminAddLinkPreviewToSpace:()=>Ic,adminAddPublicEmailDomains:()=>mr,adminAddZeroRetentionSpace:()=>ln,adminAllowlistCreditDomain:()=>si,adminBanUser:()=>ys,adminBlockEmailDomain:()=>Ta,adminBulkAddEduUniversitiesAndDomains:()=>jc,adminBulkAddPromotionCodes:()=>fa,adminBulkApplyPromotionCodes:()=>ya,adminBulkBanUsers:()=>_s,adminBulkCreateTimedTrials:()=>ql,adminBulkRemoveSpaceGuests:()=>ga,adminBulkSetSubscriptionBanner:()=>$i,adminBulkUpgradeEduPlusUser:()=>wa,adminBypassEmailReputationChecks:()=>xi,adminCancelSpaceConsolidation:()=>Ms,adminCancelSubscription:()=>Yi,adminChangeEmail:()=>or,adminCheckHIPAAComplianceStatus:()=>cn,adminCheckStatsigSegment:()=>ii,adminClaimAndUpgradeForSalesAssisted:()=>Cs,adminContentSearch:()=>ul,adminCopyPageBetweenEnvironments:()=>Aa,adminCountWordsInPage:()=>Ra,adminCreateMarketingRoute:()=>bs,adminDelayClaimSpaceDeletion:()=>xs,adminDeleteFileFromS3:()=>na,adminDeleteSpaces:()=>yn,adminDeleteUser:()=>sn,adminDescribeAccountsToReset:()=>_n,adminDescribeDeleteFileFromS3:()=>oa,adminDescribeDeletedBlockPermissions:()=>ca,adminDescribeEditSpacePermission:()=>fn,adminDescribeRestoreDeletedGuestPermissions:()=>kc,adminDescribeRunSpaceConsolidation:()=>bn,adminDescribeSpacesToDelete:()=>vn,adminDisableReverifyForUser:()=>hn,adminDowngradeFraudSubscription:()=>Ws,adminEditBlockPermissions:()=>un,adminEditSpacePermissions:()=>mn,adminEditTeamMembership:()=>In,adminExplainPaymentStatus:()=>Jl,adminFindDeletedUser:()=>ai,adminForceResyncExternalObjects:()=>ms,adminGetAutomationsForRecordId:()=>Lc,adminGetBulkIds:()=>Xl,adminGetBulkSpaceIdsByDomain:()=>gi,adminGetBulkSpaceIdsByEmail:()=>hi,adminGetBulkUserIdsByEmail:()=>vi,adminGetClientExperiments:()=>ti,adminGetCurrentUserPermissions:()=>Jr,adminGetDataAccessConsent:()=>fi,adminGetDomainClaimEligibleSpaces:()=>ks,adminGetDomainManagementSettings:()=>Is,adminGetIntegrationData:()=>ls,adminGetOwnership:()=>Yr,adminGetPublicPages:()=>Oa,adminGetRateLimits:()=>Xr,adminGetSamlConfig:()=>ea,adminGetSlackIntegrationData:()=>ds,adminGetSpaceMembershipUpdates:()=>zl,adminGetSpacesForAllowedEmailDomain:()=>ia,adminGetStatsigExperiment:()=>ni,adminGetStatsigFeatureGate:()=>oi,adminGetSubscriptionBannerHistory:()=>Qi,adminGetSyncedDatabaseData:()=>us,adminGetUserBillingInformation:()=>Ci,adminGetWorkspaceWebhookSubscriptions:()=>Vc,adminIsSpaceDomainClaimEligible:()=>ws,adminIsWorkspaceInQnA:()=>Dc,adminJoinSpacesForOauthRedirect:()=>ps,adminListData:()=>dn,adminMergeUsers:()=>Ec,adminModifyBlock:()=>sa,adminMonetizationTaskRunnerEnqueue:()=>Sa,adminOnboardAISlackQnA:()=>Sn,adminOptOutNotionAIDataSharing:()=>$l,adminOverrideInternalDomains:()=>va,adminOverridePremiumFeatureAvailability:()=>ha,adminPartnerStackFixMissingProductKeys:()=>_a,adminPrimaryWorkspaceChange:()=>ta,adminQnACheckIndexingStatus:()=>wn,adminReadBlockPermissions:()=>pn,adminRecoverMfa:()=>ki,adminRecoverUserContentInSpace:()=>Bc,adminReleaseSubscriptionSchedule:()=>El,adminRemoveAllowedEducationEmails:()=>ba,adminRemoveChildFromExternalCollection:()=>Ts,adminRemoveSpaceUsersAndTransferContent:()=>Ii,adminResetAccounts:()=>kn,adminResetRateLimits:()=>ra,adminRestoreBlock:()=>la,adminRestoreDeletedCollectionProperties:()=>Za,adminRestoreDeletedGuestPermissions:()=>wc,adminRevokeBotToken:()=>en,adminRunSpaceConsolidation:()=>Ps,adminSamlConfigForSpace:()=>Ti,adminSearchAuditLog:()=>Ss,adminSearchBlocks:()=>bi,adminSearchBots:()=>Uc,adminSearchCollectionViews:()=>Si,adminSearchCollections:()=>_i,adminSearchForUsersInSpaces:()=>mi,adminSearchOrganizations:()=>wi,adminSearchPermanentlyDeletedPages:()=>Ma,adminSearchSpaceActivity:()=>Pa,adminSearchSpaces:()=>pi,adminSearchTeams:()=>yi,adminSearchUserAdminToolRoles:()=>ei,adminSearchUsers:()=>Xo,adminSetDisableSpacePublicAccess:()=>sr,adminSetPageContentClassification:()=>gn,adminSetSpaceDomain:()=>lr,adminSetSubscriptionBanner:()=>Gi,adminSetupExperiment:()=>Wi,adminShowCustomerInvoice:()=>fr,adminSwapUserDomains:()=>gr,adminSwapUserEmails:()=>hr,adminUpdateAddOnSubscription:()=>Dl,adminUpdateExperiment:()=>qi,adminUpdateIntegrationData:()=>cs,adminUpdateNotionAIAvailabilityForSpace:()=>Nl,adminUpdateNotionCalendarAvailableForSpace:()=>Kc,adminUpdatePaymentStatus:()=>ec,adminUpdateStatsigSegmentIds:()=>ri,adminUpdateSubscription:()=>Ki,adminUpdateTeamMember:()=>Cn,adminUpdateUserSettings:()=>xn,adminViewDeletedCollectionProperties:()=>Va,adminViewExperiments:()=>zi,aiSourcePicker:()=>La,allowEducationEmails:()=>Ji,annotateRecentIntercomConversation:()=>aa,applyCustomerOffer:()=>el,authCreateBackupCodes:()=>Il,authCreateSms:()=>Ht,authCreateTotp:()=>Sl,authGetLoginConfiguration:()=>Zt,authSendSms:()=>Gt,authUpdateMfa:()=>Qt,authVerifyBackupCodesLogin:()=>Cl,authVerifyPassword:()=>xl,authVerifySmsEnroll:()=>Kt,authVerifySmsLogin:()=>$t,authVerifyTotpEnroll:()=>kl,authVerifyTotpLogin:()=>wl,authWithAsana:()=>Ro,authWithEvernote:()=>Wo,authWithExternalIntegration:()=>Zo,authWithGoogleForDrive:()=>Oo,authWithSlack:()=>Fo,authWithTrello:()=>Bo,authenticateConfluenceUser:()=>Ge,authenticateJiraUser:()=>$e,authenticateMondayUser:()=>et,calculateTax:()=>ka,cancelSpaceDeletionForDomain:()=>qs,cancelSubscription:()=>je,changeEmail:()=>qt,checkFilePermission:()=>po,checkSpaceDomain:()=>Ia,claimAndUpgradeSpace:()=>Ls,completeMultipartUpload:()=>Ks,createDebuggingQnaQuery:()=>jl,createDomainVerificationCode:()=>Ds,createEmailUser:()=>he,createOauthAuthorizationCode:()=>Fa,createPublicDomain:()=>Yc,createSpace:()=>ar,createTeam:()=>Ja,deleteBlocks:()=>En,deleteBot:()=>Ca,deleteDomainVerificationCode:()=>As,deleteGroup:()=>zn,deleteIntegration:()=>xa,deleteManagedUser:()=>Di,deletePublicDomain:()=>ed,deleteSpace:()=>nn,deleteSpaceForDomain:()=>zs,deleteTemplate:()=>uc,deleteTemplateDraft:()=>pc,deleteUser:()=>on,disableUserAnalytics:()=>So,disconnectAsana:()=>Ut,disconnectConfluence:()=>it,disconnectDrive:()=>Nt,disconnectEvernote:()=>jt,disconnectJiraAccount:()=>Ye,disconnectMonday:()=>rt,disconnectSlackIngestion:()=>ad,disconnectTrello:()=>Lt,duplicateBlock:()=>ne,duplicateTemplateBlock:()=>oe,enableTeams:()=>an,enqueueScanContentTask:()=>qc,enqueueTask:()=>xt,exportAdminContentSearch:()=>yo,exportAuditLog:()=>go,exportBlock:()=>It,exportBlockPreview:()=>Qo,exportContentAnalytics:()=>bo,exportDomainClaimableSpaces:()=>ho,exportSpace:()=>fo,exportSpaceGuests:()=>Pc,exportSpaceMembers:()=>Mc,exportUserAnalytics:()=>vo,finalizeAppTemplate:()=>Jo,findUser:()=>re,generateTemplateScreenshot:()=>Ct,getAIUsageEligibility:()=>Bl,getAboutNotionDevelopers:()=>hl,getAccessRequests:()=>_r,getActiveExportTasks:()=>Yl,getActiveImportTasks:()=>ie,getActivityLog:()=>zt,getAdminHistory:()=>$r,getAiSuggestedProperties:()=>Vl,getAiWaitlistRequestsForSpace:()=>Wc,getAllTeamsInSpaceForAdmin:()=>ns,getAsanaAccount:()=>$,getAsanaWorkspacesNames:()=>X,getAssetsJson:()=>H,getAssetsJsonV2:()=>K,getAssetsJsonV3:()=>G,getAssistantAutomationsInSpace:()=>Re,getAssistantLibraryCode:()=>Fe,getAssistantLogs:()=>Be,getAuthorizedEmailPreferenceCenterLink:()=>Pr,getAvailableCountries:()=>qr,getBacklinksForBlock:()=>Yt,getBillingHistory:()=>mo,getBlockAdminApiLog:()=>Gr,getBlockFileDownloadUrl:()=>me,getBookmarks:()=>Dn,getBotToken:()=>Jt,getBots:()=>ko,getBraintrustDatasetsForProject:()=>Me,getCalendarEvents:()=>$c,getChatTranscriptSessionHistoryForUser:()=>De,getClientExperiments:()=>ji,getClientExperimentsV2:()=>Ni,getCollectionViewBlocksByAppId:()=>$s,getCompletion:()=>Eo,getCompletionForProperty:()=>Fl,getCompletionForSelectOption:()=>Zl,getConfluenceAccount:()=>ot,getConfluenceSpaces:()=>nt,getConnectedAppsForUniversalQna:()=>id,getConnectedAppsStatus:()=>Do,getContentEngagementAnalytics:()=>rl,getCostForSpaceUpgrade:()=>Us,getCustomerOffer:()=>Js,getCustomerOfferEligibility:()=>Xs,getDailyUsersAnalytics:()=>ol,getDataAccessConsent:()=>Rr,getDataAccessConsentForManagedUser:()=>Fi,getDesktopAppRegistration:()=>yl,getDesktopDownloadUrl:()=>Le,getDeveloperBotsAndIntegrations:()=>ua,getDomainVerificationCodesForSpace:()=>Es,getEmailDomainSettings:()=>Vi,getEmailDomainsForSpace:()=>Pi,getEmailsWithoutAccessToBlock:()=>za,getEvernoteAccount:()=>Q,getEvernoteNotebooks:()=>jo,getExternalCollectionSyncState:()=>Na,getExternalIntegrationAccessToken:()=>tl,getExternalIntegrations:()=>Da,getExternalNotificationChannels:()=>dl,getExternalOrgData:()=>Oc,getExternalSyncedCollectionInTeams:()=>bt,getFieldsForJiraIssues:()=>Qa,getGenericEmbedBlockData:()=>tr,getGeoIpLocation:()=>Wl,getGiphyRandomId:()=>di,getGoogleDriveAccounts:()=>Vo,getHarmonicData:()=>Ce,getHistoricalAuditLogUsers:()=>ue,getHomeEnabledSpaceViews:()=>Hc,getIdFromUniqueId:()=>Pl,getInAppCategoriesAndTemplates:()=>Rl,getInferenceTestExamples:()=>ml,getIntegrationDataForGallery:()=>rs,getIntegrationDomainVerifications:()=>pa,getIntegrationIdsForGallery:()=>as,getIntegrationSecret:()=>ma,getInternalDomains:()=>qe,getInvitesForInvitees:()=>We,getInvoiceData:()=>Tn,getJiraAccount:()=>J,getJiraSitesForWorkspace:()=>yt,getJoinableSpaces:()=>An,getLivestormEvents:()=>Ve,getLivestormSessions:()=>Ue,getLoginOptions:()=>Ot,getManagedUsers:()=>Ai,getMondayFoldersAndBoards:()=>st,getMondayUser:()=>tt,getMondayWorkspaces:()=>at,getNextRelabelingTask:()=>Ee,getNotificationLog:()=>Hn,getNotificationLogPrototype:()=>Gn,getNotificationLogV2:()=>Kn,getPageAnalytics:()=>Ys,getPageAssistantPreferences:()=>_c,getPageSignals:()=>Nr,getPageVisitors:()=>Er,getPrivatePageInfo:()=>os,getProjectsForJiraSite:()=>$a,getPromoCode:()=>er,getPublicApiObject:()=>_l,getPublicPageData:()=>rn,getPublicSpaceData:()=>ao,getPublishedPagesForUser:()=>Rc,getQnaOnboardingData:()=>He,getRecentPageVisits:()=>ge,getRecentlyRemovedUsers:()=>hs,getRecoverableSpaceUserContent:()=>fs,getSamlConfigForSpace:()=>Mi,getSamlRedirect:()=>Vt,getSelectPropertyValues:()=>qn,getSignedFileUrl:()=>gd,getSkillsInSpace:()=>Ae,getSlackIngestionAuthorizeUrl:()=>rd,getSnapshotContents:()=>To,getSnapshotsList:()=>xo,getSpaceAdminApiLog:()=>Kr,getSpaceMembershipUpdates:()=>gc,getSpaces:()=>Rn,getSpacesCreatedByUserWithDomains:()=>Zs,getSpacesInOrganization:()=>Nc,getSprintBoardViewBlocks:()=>Qs,getSubitems:()=>W,getSubscriptionBanner:()=>ze,getSubscriptionData:()=>Ne,getSuggestedPageQna:()=>Ul,getTasks:()=>br,getTeamAccessRequestMetadata:()=>Hl,getTeams:()=>ts,getTeamsAndProjectsInAsanaWorkspace:()=>ee,getTeamsForOrganizationSpace:()=>Cr,getTemplateContentGroup:()=>ye,getTemplateCreator:()=>oc,getTemplateDrafts:()=>mc,getTemplateSearchResults:()=>tc,getTemplates:()=>nc,getTestFlightStatus:()=>yr,getTransitivePageRelations:()=>Ql,getTrelloAccount:()=>Y,getTrelloBoards:()=>te,getTypedDatabases:()=>Gs,getUniversitiesAndDomains:()=>Tc,getUnreadAccessRequestCount:()=>Mr,getUnvisitedNotificationIds:()=>$n,getUploadFileUrl:()=>tn,getUserAdminApiLog:()=>Hr,getUserAnalyticsSettings:()=>Fn,getUserContractionData:()=>hc,getUserEngagementAnalytics:()=>il,getUserHomePages:()=>zr,getUserNotifications:()=>eo,getUserOrganizations:()=>zc,getUserSharedPagesInSpace:()=>Lr,getUserSignals:()=>jr,getUserSpaceExternalBots:()=>Ba,getUserTasks:()=>vr,getVerifiedDomainsForOrganization:()=>xr,getVerifiedEmailDomain:()=>cl,getVerifiedUsersCountForOrganization:()=>Tr,getVisibleUsers:()=>Ke,getWebClipperData:()=>No,getWebhookSubscriptions:()=>Io,getZendeskTicketConversation:()=>Ea,handleRecordMapForResponse:()=>O,identifySegmentUser:()=>Jn,identifySegmentWorkspace:()=>Yn,importAsanaIntoBetterTemplate:()=>ht,importConfluenceExport:()=>pt,importEvernote:()=>kt,importFile:()=>lt,importGoogleDoc:()=>ct,importTrello:()=>gt,initializeGoogleDriveBlock:()=>Uo,initializePageTemplate:()=>Yo,initializeUserAnalytics:()=>lo,initializeUserAnalyticsEmptySync:()=>co,initiateMultipartUpload:()=>Hs,initiateWorkspaceTransfer:()=>Vs,insertIntoBraintrustDataset:()=>Te,invalidateSubscriptionData:()=>Wr,inviteGuestsToSpace:()=>ur,isDesktopVersionCompatible:()=>Gc,isEligibleForGuestMembershipRequest:()=>fl,isEmailEducation:()=>Xi,isRecordKeyAvailable:()=>Ml,isUserDomainJoinable:()=>nr,leaveBlock:()=>ro,listExternalCollections:()=>Ga,listExternalObjects:()=>Ya,listPrices:()=>Se,loadBlockSubtree:()=>so,loadCachedPageChunk:()=>Vn,loadCachedPageChunkBatched:()=>cd,loadCachedPageChunks:()=>Un,loadContacts:()=>vl,loadContentAnalytics:()=>sl,loadPageChunk:()=>Ln,loadSearchAnalytics:()=>ll,loadUserContent:()=>Zn,loadWorkspaceAnalyticsUsers:()=>al,loginWithAppleAuth:()=>Tt,loginWithAppleNativeAuth:()=>Mt,loginWithEmail:()=>Pt,loginWithGoogleAuth:()=>Rt,loginWithGoogleJwt:()=>At,logout:()=>Dt,logoutActiveSessions:()=>rr,logoutManagedUsers:()=>Ui,markDiscussionNotificationsRead:()=>is,moveToSpace:()=>dr,parallelAsanaImport:()=>St,parallelImportConfluenceExport:()=>mt,parallelImportConfluenceViaApi:()=>ft,parallelJiraImport:()=>_t,parallelMondayImport:()=>wt,pendingTaskEventsById:()=>hd,pendingTaskIds:()=>z,performAiSearch:()=>Pe,ping:()=>Ko,postGiphyAnalytics:()=>ui,previewMidtermSubscriptionChanges:()=>we,processShareActionToBlock:()=>qa,publishAiSession:()=>Ac,queryCollection:()=>jn,recordCookieConsent:()=>ss,recordPageExit:()=>Fr,recordPageVisit:()=>Br,recoverSpace:()=>Go,recoverUser:()=>Ho,recoverUserContentInSpace:()=>vs,refetchExternalObjectInstanceBlocks:()=>Ka,refreshGoogleDriveBlock:()=>Lo,refreshInviteLink:()=>pr,registerDesktopApp:()=>bl,releaseSubscriptionSchedule:()=>_e,removeManagedUserFromSpace:()=>Zi,removeUserFromOrganizationSpaces:()=>nd,removeUsersFromSpace:()=>Pn,renameGroup:()=>Nn,reportBadQnA:()=>de,reportBadSearch:()=>ce,reportPage:()=>Qr,requestAccess:()=>Ar,requestClaimAndUpgrade:()=>js,resetExperimentOverrides:()=>Ha,resetPasswordsForManagedUsers:()=>Li,resolveAccessRequest:()=>Fc,resolveAddress:()=>da,restoreBlock:()=>Bn,restoreSnapshot:()=>Mo,resubscribeExternalCollection:()=>ja,resyncJiraCollection:()=>Xe,retrieveFeedbackRecord:()=>Ll,revokeBotToken:()=>Xt,revokeUserTokens:()=>$o,runAsyncAiSearch:()=>dt,runFinetuningDataGenerator:()=>ut,saveAssistantChatHistory:()=>sd,saveAssistantFeedback:()=>xe,saveAssistantLabelerFeedback:()=>Oe,saveRelabelingTaskFeedback:()=>Ze,saveTransactions:()=>cr,search:()=>ae,searchAuditLog:()=>se,searchContacts:()=>le,searchGiphyImages:()=>ci,searchIntegrations:()=>pe,searchUnsplashImages:()=>li,searchVectors:()=>pl,searchWebClipperPages:()=>qo,sendEmailVerification:()=>Wt,sendTemporaryPassword:()=>Ft,sendVerifyTransferEmail:()=>nl,setAdminPrivilegedTeamMembership:()=>Xa,setBookmarkMetadata:()=>Ao,setDataAccessConsent:()=>Dr,setDataAccessConsentForManagedUser:()=>Oi,setLocale:()=>fe,setNotificationsAsRead:()=>Xn,setNotificationsStatus:()=>no,setPageAssistantPreferences:()=>Sc,setPageNotificationsAsRead:()=>to,setPassword:()=>ir,setRecordKey:()=>Tl,setSamlConfig:()=>Os,setSeenGuestMembershipRequests:()=>gl,setSpaceNotificationsAsRead:()=>oo,setStatusPropertyDefaults:()=>Wn,spaceAdminRestoreAccess:()=>Or,streamCascadeInference:()=>Ol,stripeAdvanceTestClock:()=>Kl,stripeGetTestClock:()=>Gl,submitContactSales:()=>ke,submitEducationGroupApplication:()=>xc,submitFormstack:()=>Ie,submitTemplateCreator:()=>ic,submitTemplateDraft:()=>cc,submitTemplateDraftLocalizedBulk:()=>dc,suggestRecordKey:()=>Al,syncJiraProjects:()=>vt,syncRecordValue:()=>ud,syncRecordValues:()=>On,testCreatePage:()=>bc,testDeleteRecord:()=>yc,testSetupWorkspace:()=>vc,testWebhookConnection:()=>Co,trackConversionEvent:()=>Zr,trackSegmentEvent:()=>Qn,transferPermissionGroup:()=>_o,transferSpaceUserContent:()=>gs,transferWorkspaceToUser:()=>Ns,unfurlUrl:()=>Ua,unsubscribeFromEmails:()=>io,unsubscribeFromIntercomEmails:()=>wo,updateDisableGuestsOnSpace:()=>Cc,updateEmailDomainSettings:()=>Ei,updateExperimentOverride:()=>Wa,updateJiraSyncedTaskCollectionSchema:()=>Qe,updateJiraWebhook:()=>Je,updateOrganization:()=>Sr,updateOrganizationSettings:()=>Ir,updateOrganizationSpaceSettings:()=>kr,updateOrganizationTeamSettings:()=>wr,updatePaymentMethod:()=>be,updatePinnedTemplates:()=>fc,updatePublicDomain:()=>Jc,updatePublicDomainHomePage:()=>Xc,updatePublicHomePage:()=>Ur,updateSpaceDomain:()=>Vr,updateSubscription:()=>ve,updateSubscriptionToEducationPlan:()=>Hi,updateTeamMembers:()=>es,updateUserProfile:()=>Bi,updateUserRoleInOrganizationSpace:()=>od,updateUserSuspension:()=>Ri,updateWorkspaceCreationForEmailDomains:()=>Bs,validateActorOwnsTemplate:()=>sc,validatePublicDomainAvailability:()=>Qc,validateTemplate:()=>rc,validateTemplateCreatorHandle:()=>ac,validateTemplateDraftSlug:()=>lc,validateUserCanCreateWorkspace:()=>Fs,verifyDomain:()=>Rs,verifyEmail:()=>Et});n(57658),n(21703);var o=n(39593),i=n.n(o),r=n(28084),a=n(54064),s=n(43593),l=n(68626),c=n(59730),d=n(97213),u=n(45953),p=n(606),m=n(89101),f=n(98151),g=n(53965),h=n(52629),v=n(3303),b=n(19584),y=n(95477),_=n(97978),S=n(41424),w=n(33954),k=n(79947),I=n(33929),C=n(18514),x=n(80444),T=n(88632),M=n(79167),P=n(77144),A=n(33759),R=n(47307),D=n(97977),E=n(4408),B=n(8055),F=n(61202);function O(e){const{environment:t,eventName:n,response:o,userId:i}=e;if(o&&o.recordMap){const e=u.PF.create(o.recordMap);"syncRecordValues"!==n&&E.fL({environment:t,userId:i,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,recordMap:e,maybeStaleRecordMap:"loadCachedPageChunk"===n||"loadCachedPageChunks"===n,debugSource:"handleRecordMapForResponse"})}}let Z;async function V(e,t,n,o){if((0,c.tn)(n.body)){R.showError(n);const t=n.body.clientData&&(0,w.cq)(n.body.clientData);_.j(e,"show_user_validation_response",{type:null==t?void 0:t.type})}if(n.offline)return n;console.error(n.error);const{RouterStore:i}=e;if(401===n.status&&l.log({level:"error",from:"api",type:"httpTrigger401",data:{eventName:t,isLoggedIn:e.currentUser.isLoggedIn(),miscDataToConvertToString:{response:n},routeName:i.state.route.name}}),403===n.status&&n.headers["content-type"]&&n.headers["content-type"].startsWith("text/html")&&l.logWithSampleRate({logMessage:{level:"error",from:"api",type:"httpTrigger403",data:{eventName:t,isLoggedIn:e.currentUser.isLoggedIn(),miscDataToConvertToString:{response:n},userId:e.currentUser.id,routeName:i.state.route.name}},samplePercentage:1}),401===n.status&&Boolean(n.body&&n.body.errorId)&&e.currentUser.isLoggedIn())switch(i.state.route.name){case"page":if((0,C.Sr)(e)){await D.actuallyLogoutAndDeleteMostLocalData({environment:e,nextLocation:window.location.pathname,logoutOrigin:d.F.PublicPageAccessDenied});break}case"root":case"space":case"onboarding":case"myIntegrations":case"creatorProfile":case"creatorProfileAnalytics":case"creatorProfileTemplates":case"studentGroupSignup":if(o&&o===e.currentUser.id){const t=g.Ds((async()=>await D.actuallyLogoutAndDeleteMostLocalData({environment:e,userId:o,doNotRedirect:!0,logoutOrigin:d.F.PageAccessDenied})),1e3);await t();!function(e,t){if((0,c.Jx)(t.body)&&"saml_sso_required"===t.body.clientData.type){const e=(0,w.wf)(I.default.getIntl(),t);A.Z.setState({...A.Z.state,loginType:"saml",alert:e})}B.c4({environment:e,url:m._j.login})}(await D.clearCurrentUser(e),n)}}return n}async function U(e){const{environment:t,eventName:n,data:o,userId:i,tracking:r,abortSignal:a,prefetchCacheKey:s,encoding:c}=e;!function(e){for(const t of Object.keys(e)){const n=e[t];(g.Ft(n)||g.o8(n))&&delete e[t]}}(o);const d=i||t.currentUser.id,u=(0,S.yX)({environment:t,eventName:n,data:o,activeUserId:d,tracking:r,abortSignal:a,encoding:c});let p;s&&t.prefetchCache&&(p=t.prefetchCache.getPrefetchedHttpRequest(s,u,a)),p||(p=(0,k.ZP)(u)),P.Z.incrementNumApiCallsInitiated();const m=await p;return P.Z.incrementNumApiCallsCompleted(),"success"===m.type?(O({environment:t,eventName:n,response:m.data,userId:d}),function(e){const{environment:t,responseUserId:n,eventName:o}=e;if(!n)return;if("saveTransactions"!==o)return;const{id:i}=t.currentUser;if(n!==i){if(Z===n)return;const{currentUserStore:e,currentUserRootStore:t,currentUserSettingsStore:r,currentSpaceViewStore:a}=x.default.state,s=i||"<undefined>",c=`currentUser ${s} didn't match user's cookie ${n}`;l.log({from:"client/api",level:"error",type:"currentUserWrong",data:{eventName:o,miscDataToConvertToString:{responseUserId:n,connectionStoreState:T.Z.state,currentUserId:s,userStoreId:e&&e.id,userRootStoreId:t&&t.id,userSettingsStoreId:r&&r.id,currentSpaceViewStoreParentId:a&&a.getParentId()},message:c}}),Z=n}else Z=void 0}({environment:t,eventName:n,responseUserId:m.headers["X-Notion-User-Id"]}),m):V(t,n,m,d)}function L(e){return function(t,n,o,i,r,a,s){return U({environment:t,eventName:e,data:n,userId:o,tracking:i,abortSignal:r,prefetchCacheKey:a,encoding:s})}}function j(e){return async function(t,n,o,i){const r=o||t.currentUser.id,a=(0,S.tZ)({environment:t,eventName:e,data:n,activeUserId:r,tracking:i,abortSignal:void 0,format:"jsonStream"}),s=await(0,k.ZP)(a);return"failed"===s.type?V(t,e,s,r):(f.H1.is(s.data)||O({environment:t,eventName:e,response:s.data,userId:r}),s)}}async function N(e){return new Promise(((t,n)=>{hd.addOnceListener(e,(e=>{t(e)}))}))}const z=new Set;function q(e){return async function*(t,n){const o={task:{eventName:e,request:n}},i=await xt(t,o);if("failed"===i.type)yield{error:i.error,taskStatus:"not_started"};else{const{taskId:o}=i.data;for(z.add(o);;){const i=await N(o);if("success"===i.state){const n=i.status;O({environment:t,eventName:e,response:n}),yield{value:n,taskStatus:i.state};break}if("failure"===i.state){yield{error:new c.hm(i.error||"Something went wrong.",{eventName:e,request:n},i.clientData),taskStatus:i.state};break}"in_progress"===i.state&&i.status&&(yield{value:i.status,taskStatus:i.state})}}}}const W=L("getSubitems"),H=L("getAssetsJson"),K=L("getAssetsJsonV2"),G=L("getAssetsJsonV3"),$=L("getAsanaAccount"),Q=L("getEvernoteAccount"),Y=L("getTrelloAccount"),J=L("getJiraAccount"),X=L("getAsanaWorkspacesNames"),ee=L("getTeamsAndProjectsInAsanaWorkspace"),te=L("getTrelloBoards"),ne=q("duplicateBlock"),oe=q("duplicateTemplateBlock"),ie=L("getActiveImportTasks"),re=L("findUser"),ae=L("search"),se=L("searchAuditLog"),le=L("searchContacts"),ce=L("reportBadSearch"),de=L("reportBadQnA"),ue=L("getHistoricalAuditLogUsers"),pe=L("searchIntegrations"),me=L("getBlockFileDownloadUrl"),fe=L("setlocale"),ge=L("getRecentPageVisits"),he=L("createEmailUser"),ve=L("updateSubscription"),be=L("updatePaymentMethod"),ye=L("getTemplateContentGroup"),_e=L("releaseSubscriptionSchedule"),Se=L("listPrices"),we=L("previewMidtermSubscriptionChanges"),ke=L("submitContactSales"),Ie=L("submitFormstack"),Ce=L("getHarmonicData"),xe=L("saveAssistantFeedback"),Te=L("insertIntoBraintrustDataset"),Me=L("getBraintrustDatasetsForProject"),Pe=L("performAiSearch"),Ae=L("getSkillsInSpace"),Re=L("getAssistantAutomationsInSpace"),De=L("getChatTranscriptSessionHistoryForUser"),Ee=L("getNextRelabelingTask"),Be=L("getAssistantLogs"),Fe=L("getAssistantLibraryCode"),Oe=L("saveAssistantLabelerFeedback"),Ze=L("saveRelabelingTaskFeedback"),Ve=L("getLivestormEvents"),Ue=L("getLivestormSessions"),Le=L("getDesktopDownloadUrl"),je=L("cancelSubscription"),Ne=L("getSubscriptionData"),ze=L("getSubscriptionBanner"),qe=L("getInternalDomains"),We=L("getInvitesForInvitees"),He=L("getQnaOnboardingData"),Ke=L("getVisibleUsers"),Ge=L("authenticateConfluenceUser"),$e=L("authenticateJiraUser"),Qe=L("updateJiraSyncedTaskCollectionSchema"),Ye=L("disconnectJiraAccount"),Je=L("updateJiraWebhook"),Xe=L("resyncJiraCollection"),et=L("authenticateMondayUser"),tt=L("getMondayUser"),nt=L("getConfluenceSpaces"),ot=L("getConfluenceAccount"),it=L("disconnectConfluence"),rt=L("disconnectMonday"),at=L("getMondayWorkspaces"),st=L("getMondayFoldersAndBoards"),lt=q("importFile"),ct=q("importGoogleDoc"),dt=q("runAsyncAiSearch"),ut=q("runFinetuningDataGenerator"),pt=q("importConfluenceExport"),mt=q("parallelImportConfluenceExport"),ft=q("parallelImportConfluenceViaApi"),gt=q("importTrello"),ht=q("importAsanaIntoBetterTemplate"),vt=L("syncJiraProjects"),bt=L("getExternalSyncedCollectionInTeams"),yt=L("getJiraSitesForWorkspace"),_t=q("parallelJiraImport"),St=q("parallelAsanaImport"),wt=q("parallelMondayImport"),kt=q("importEvernote"),It=q("exportBlock"),Ct=q("generateTemplateScreenshot"),xt=L("enqueueTask"),Tt=L("loginWithAppleAuth"),Mt=L("loginWithAppleNativeAuth"),Pt=L("loginWithEmail"),At=L("loginWithGoogleJwt"),Rt=L("loginWithGoogleAuth"),Dt=L("logout"),Et=L("verifyEmail"),Bt=L("addWebClipperFile"),Ft=L("sendTemporaryPassword"),Ot=L("getLoginOptions"),Zt=L("authGetLoginConfiguration"),Vt=L("getSamlRedirect"),Ut=L("disconnectAsana"),Lt=L("disconnectTrello"),jt=L("disconnectEvernote"),Nt=L("disconnectDrive"),zt=L("getActivityLog"),qt=L("changeEmail"),Wt=L("sendEmailVerification"),Ht=L("authCreateSms"),Kt=L("authVerifySmsEnroll"),Gt=L("authSendSms"),$t=L("authVerifySmsLogin"),Qt=L("authUpdateMfa"),Yt=L("getBacklinksForBlock"),Jt=L("getBotToken"),Xt=L("revokeBotToken"),en=L("adminRevokeBotToken"),tn=L("getUploadFileUrl"),nn=q("deleteSpace"),on=L("deleteUser"),rn=L("getPublicPageData"),an=L("enableTeams"),sn=L("adminDeleteUser"),ln=L("adminAddZeroRetentionSpace"),cn=L("adminCheckHIPAAComplianceStatus"),dn=L("adminListData"),un=L("adminEditBlockPermissions"),pn=L("adminReadBlockPermissions"),mn=L("adminEditSpacePermissions"),fn=L("adminDescribeEditSpacePermission"),gn=L("adminSetPageContentClassification"),hn=L("adminDisableReverifyForUser"),vn=L("adminDescribeSpacesToDelete"),bn=L("adminDescribeRunSpaceConsolidation"),yn=L("adminDeleteSpaces"),_n=L("adminDescribeAccountsToReset"),Sn=L("adminOnboardAISlackQnA"),wn=L("adminQnACheckIndexingStatus"),kn=L("adminResetAccounts"),In=L("adminEditTeamMembership"),Cn=L("adminUpdateTeamMember"),xn=L("adminUpdateUserSettings"),Tn=L("getInvoiceData"),Mn=L("addUsersToSpace"),Pn=L("removeUsersFromSpace"),An=L("getJoinableSpaces"),Rn=L("getSpaces"),Dn=L("getBookmarks"),En=L("deleteBlocks"),Bn=L("restoreBlock"),Fn=L("getUserAnalyticsSettings"),On=L("syncRecordValues"),Zn=L("loadUserContent"),Vn=L("loadCachedPageChunk"),Un=L("loadCachedPageChunks"),Ln=L("loadPageChunk"),jn=L("queryCollection"),Nn=q("renameGroup"),zn=q("deleteGroup"),qn=L("getSelectPropertyValues"),Wn=L("setStatusPropertyDefaults"),Hn=L("getNotificationLog"),Kn=L("getNotificationLogV2"),Gn=L("getNotificationLogPrototype"),$n=L("getUnvisitedNotificationIds"),Qn=L("trackSegmentEvent"),Yn=L("identifySegmentWorkspace"),Jn=L("identifySegmentUser"),Xn=L("setNotificationsAsRead"),eo=L("getUserNotifications"),to=L("setPageNotificationsAsRead"),no=L("setNotificationsStatus"),oo=L("setSpaceNotificationsAsRead"),io=L("unsubscribeFromEmails"),ro=L("leaveBlock"),ao=L("getPublicSpaceData"),so=L("loadBlockSubtree"),lo=L("initializeUserAnalytics"),co=L("initializeUserAnalyticsEmptySync"),uo=L("getSignedFileUrls"),po=L("checkFilePermission"),mo=L("getBillingHistory"),fo=q("exportSpace"),go=q("exportAuditLog"),ho=q("exportDomainClaimableSpaces"),vo=q("exportUserAnalytics"),bo=q("exportContentAnalytics"),yo=q("exportAdminContentSearch"),_o=L("transferPermissionGroup"),So=L("disableUserAnalytics"),wo=L("unsubscribeFromIntercomEmails"),ko=L("getBots"),Io=L("getWebhookSubscriptions"),Co=L("testWebhookConnection"),xo=L("getSnapshotsList"),To=L("getSnapshotContents"),Mo=q("restoreSnapshot"),Po=L("activateReferral"),Ao=L("setBookmarkMetadata"),Ro=L("authWithAsana"),Do=L("getConnectedAppsStatus"),Eo=j("getCompletion"),Bo=L("authWithTrello"),Fo=L("authWithSlack"),Oo=L("authWithGoogleForDrive"),Zo=L("authWithExternalIntegration"),Vo=L("getGoogleDriveAccounts"),Uo=L("initializeGoogleDriveBlock"),Lo=L("refreshGoogleDriveBlock"),jo=L("getEvernoteNotebooks"),No=L("getWebClipperData"),zo=L("addWebClipperURLs"),qo=L("searchWebClipperPages"),Wo=L("authWithEvernote"),Ho=L("recoverUser"),Ko=L("ping"),Go=L("recoverSpace"),$o=L("revokeUserTokens"),Qo=L("exportBlockPreview"),Yo=L("initializePageTemplate"),Jo=L("finalizeAppTemplate"),Xo=L("adminSearchUsers"),ei=L("adminSearchUserAdminToolRoles"),ti=L("adminGetClientExperiments"),ni=L("adminGetStatsigExperiment"),oi=L("adminGetStatsigFeatureGate"),ii=L("adminCheckStatsigSegment"),ri=L("adminUpdateStatsigSegmentIds"),ai=L("adminFindDeletedUser"),si=L("adminAllowlistCreditDomain"),li=L("searchUnsplashImages"),ci=L("searchGiphyImages"),di=L("getGiphyRandomId"),ui=L("postGiphyAnalytics"),pi=L("adminSearchSpaces"),mi=L("adminSearchForUsersInSpaces"),fi=L("adminGetDataAccessConsent"),gi=L("adminGetBulkSpaceIdsByDomain"),hi=L("adminGetBulkSpaceIdsByEmail"),vi=L("adminGetBulkUserIdsByEmail"),bi=L("adminSearchBlocks"),yi=L("adminSearchTeams"),_i=L("adminSearchCollections"),Si=L("adminSearchCollectionViews"),wi=L("adminSearchOrganizations"),ki=L("adminRecoverMfa"),Ii=L("adminRemoveSpaceUsersAndTransferContent"),Ci=L("adminGetUserBillingInformation"),xi=L("adminBypassEmailReputationChecks"),Ti=L("adminSamlConfigForSpace"),Mi=L("getSamlConfigForSpace"),Pi=L("getEmailDomainsForSpace"),Ai=L("getManagedUsers"),Ri=L("updateUserSuspension"),Di=L("deleteManagedUser"),Ei=L("updateEmailDomainSettings"),Bi=L("updateUserProfile"),Fi=L("getDataAccessConsentForManagedUser"),Oi=L("setDataAccessConsentForManagedUser"),Zi=L("removeManagedUserFromSpace"),Vi=L("getEmailDomainSettings"),Ui=L("logoutManagedUsers"),Li=L("resetPasswordsForManagedUsers"),ji=L("getClientExperiments"),Ni=L("getClientExperimentsV2"),zi=L("adminViewExperiments"),qi=L("adminUpdateExperiment"),Wi=L("adminSetupExperiment"),Hi=L("updateSubscriptionToEducationPlan"),Ki=L("adminUpdateSubscription"),Gi=L("adminSetSubscriptionBanner"),$i=L("adminBulkSetSubscriptionBanner"),Qi=L("adminGetSubscriptionBannerHistory"),Yi=L("adminCancelSubscription"),Ji=L("allowEducationEmails"),Xi=L("isEmailEducation"),er=L("getPromoCode"),tr=L("getGenericEmbedBlockData"),nr=L("isUserDomainJoinable"),or=L("adminChangeEmail"),ir=L("setPassword"),rr=L("logoutActiveSessions"),ar=L("createSpace"),sr=L("adminSetDisableSpacePublicAccess"),lr=L("adminSetSpaceDomain"),cr=L("saveTransactions"),dr=q("moveToSpace"),ur=L("inviteGuestsToSpace"),pr=L("refreshInviteLink"),mr=L("adminAddPublicEmailDomains"),fr=L("adminShowCustomerInvoice"),gr=L("adminSwapUserDomains"),hr=L("adminSwapUserEmails"),vr=L("getUserTasks"),br=L("getTasks"),yr=L("getTestFlightStatus"),_r=L("getAccessRequests"),Sr=L("updateOrganization"),wr=L("updateOrganizationTeamSettings"),kr=L("updateOrganizationSpaceSettings"),Ir=L("updateOrganizationSettings"),Cr=L("getTeamsForOrganizationSpace"),xr=L("getVerifiedDomainsForOrganization"),Tr=L("getVerifiedUsersCountForOrganization"),Mr=L("getUnreadAccessRequestCount"),Pr=L("getAuthorizedEmailPreferenceCenterLink"),Ar=L("requestAccess"),Rr=L("getDataAccessConsent"),Dr=L("setDataAccessConsent"),Er=L("getPageVisitors"),Br=L("recordPageVisit"),Fr=L("recordPageExit"),Or=L("spaceAdminRestoreAccess"),Zr=L("trackConversionEvent"),Vr=L("updateSpaceDomain"),Ur=L("updatePublicHomePage"),Lr=L("getUserSharedPagesInSpace"),jr=L("getUserSignals"),Nr=L("getPageSignals"),zr=L("getUserHomePages"),qr=L("getAvailableCountries"),Wr=L("invalidateSubscriptionData"),Hr=L("getUserAdminApiLog"),Kr=L("getSpaceAdminApiLog"),Gr=L("getBlockAdminApiLog"),$r=L("getAdminHistory"),Qr=L("reportPage"),Yr=L("adminGetOwnership"),Jr=L("adminGetCurrentUserPermissions"),Xr=L("adminGetRateLimits"),ea=L("adminGetSamlConfig"),ta=L("adminPrimaryWorkspaceChange"),na=L("adminDeleteFileFromS3"),oa=L("adminDescribeDeleteFileFromS3"),ia=L("adminGetSpacesForAllowedEmailDomain"),ra=L("adminResetRateLimits"),aa=L("annotateRecentIntercomConversation"),sa=L("adminModifyBlock"),la=L("adminRestoreBlock"),ca=L("adminDescribeDeletedBlockPermissions"),da=L("resolveAddress"),ua=L("getDeveloperBotsAndIntegrations"),pa=L("getIntegrationDomainVerifications"),ma=L("getIntegrationSecret"),fa=L("adminBulkAddPromotionCodes"),ga=L("adminBulkRemoveSpaceGuests"),ha=L("adminOverridePremiumFeatureAvailability"),va=L("adminOverrideInternalDomains"),ba=L("adminRemoveAllowedEducationEmails"),ya=L("adminBulkApplyPromotionCodes"),_a=L("adminPartnerStackFixMissingProductKeys"),Sa=L("adminMonetizationTaskRunnerEnqueue"),wa=L("adminBulkUpgradeEduPlusUser"),ka=L("calculateTax"),Ia=L("checkSpaceDomain"),Ca=L("deleteBot"),xa=L("deleteIntegration"),Ta=L("adminBlockEmailDomain"),Ma=L("adminSearchPermanentlyDeletedPages"),Pa=L("adminSearchSpaceActivity"),Aa=L("adminCopyPageBetweenEnvironments"),Ra=L("adminCountWordsInPage"),Da=L("getExternalIntegrations"),Ea=L("getZendeskTicketConversation"),Ba=L("getUserSpaceExternalBots"),Fa=L("createOauthAuthorizationCode"),Oa=L("adminGetPublicPages"),Za=L("adminRestoreDeletedCollectionProperties"),Va=L("adminViewDeletedCollectionProperties"),Ua=L("unfurlUrl"),La=L("aiSourcePicker"),ja=L("resubscribeExternalCollection"),Na=L("getExternalCollectionSyncState"),za=L("getEmailsWithoutAccessToBlock"),qa=L("processShareActionToBlock"),Wa=L("updateExperimentOverride"),Ha=L("resetExperimentOverrides"),Ka=L("refetchExternalObjectInstanceBlocks"),Ga=L("listExternalCollections"),$a=L("getProjectsForJiraSite"),Qa=L("getFieldsForJiraIssues"),Ya=L("listExternalObjects"),Ja=L("createTeam"),Xa=L("setAdminPrivilegedTeamMembership"),es=L("updateTeamMembers"),ts=L("getTeams"),ns=L("getAllTeamsInSpaceForAdmin"),os=L("getPrivatePageInfo"),is=L("markDiscussionNotificationsRead"),rs=L("getIntegrationDataForGallery"),as=L("getIntegrationIdsForGallery"),ss=L("recordCookieConsent"),ls=L("adminGetIntegrationData"),cs=L("adminUpdateIntegrationData"),ds=L("adminGetSlackIntegrationData"),us=L("adminGetSyncedDatabaseData"),ps=L("adminJoinSpacesForOauthRedirect"),ms=L("adminForceResyncExternalObjects"),fs=L("getRecoverableSpaceUserContent"),gs=L("transferSpaceUserContent"),hs=L("getRecentlyRemovedUsers"),vs=L("recoverUserContentInSpace"),bs=L("adminCreateMarketingRoute"),ys=L("adminBanUser"),_s=L("adminBulkBanUsers"),Ss=L("adminSearchAuditLog"),ws=L("adminIsSpaceDomainClaimEligible"),ks=L("adminGetDomainClaimEligibleSpaces"),Is=L("adminGetDomainManagementSettings"),Cs=L("adminClaimAndUpgradeForSalesAssisted"),xs=L("adminDelayClaimSpaceDeletion"),Ts=L("adminRemoveChildFromExternalCollection"),Ms=L("adminCancelSpaceConsolidation"),Ps=L("adminRunSpaceConsolidation"),As=L("deleteDomainVerificationCode"),Rs=L("verifyDomain"),Ds=L("createDomainVerificationCode"),Es=L("getDomainVerificationCodesForSpace"),Bs=L("updateWorkspaceCreationForEmailDomains"),Fs=L("validateUserCanCreateWorkspace"),Os=L("setSamlConfig"),Zs=L("getSpacesCreatedByUserWithDomains"),Vs=L("initiateWorkspaceTransfer"),Us=L("getCostForSpaceUpgrade"),Ls=L("claimAndUpgradeSpace"),js=L("requestClaimAndUpgrade"),Ns=L("transferWorkspaceToUser"),zs=L("deleteSpaceForDomain"),qs=L("cancelSpaceDeletionForDomain"),Ws=L("adminDowngradeFraudSubscription"),Hs=L("initiateMultipartUpload"),Ks=L("completeMultipartUpload"),Gs=L("getTypedDatabases"),$s=L("getCollectionViewBlocksByAppId"),Qs=L("getSprintBoardViewBlocks"),Ys=L("getPageAnalytics"),Js=L("getCustomerOffer"),Xs=L("getCustomerOfferEligibility"),el=L("applyCustomerOffer"),tl=L("getExternalIntegrationAccessToken"),nl=L("sendVerifyTransferEmail"),ol=L("getDailyUsersAnalytics"),il=L("getUserEngagementAnalytics"),rl=L("getContentEngagementAnalytics"),al=L("loadWorkspaceAnalyticsUsers"),sl=L("loadContentAnalytics"),ll=L("loadSearchAnalytics"),cl=L("getVerifiedEmailDomain"),dl=L("getExternalNotificationChannels"),ul=L("adminContentSearch"),pl=L("searchVectors"),ml=L("getInferenceTestExamples"),fl=L("isEligibleForGuestMembershipRequest"),gl=L("setSeenGuestMembershipRequests"),hl=L("getAboutNotionDevelopers"),vl=L("loadContacts"),bl=L("registerDesktopApp"),yl=L("getDesktopAppRegistration"),_l=L("getPublicApiObject"),Sl=L("authCreateTotp"),wl=L("authVerifyTotpLogin"),kl=L("authVerifyTotpEnroll"),Il=L("authCreateBackupCodes"),Cl=L("authVerifyBackupCodesLogin"),xl=L("authVerifyPassword"),Tl=L("setRecordKey"),Ml=L("isRecordKeyAvailable"),Pl=L("getIdFromUniqueId"),Al=L("suggestRecordKey"),Rl=L("getInAppCategoriesAndTemplates"),Dl=L("adminUpdateAddOnSubscription"),El=L("adminReleaseSubscriptionSchedule"),Bl=L("getAIUsageEligibility"),Fl=j("getCompletionForProperty"),Ol=j("streamCascadeInference"),Zl=L("getCompletionForSelectOption"),Vl=L("getAiSuggestedProperties"),Ul=L("getSuggestedPageQna"),Ll=L("retrieveFeedbackRecord"),jl=L("createDebuggingQnaQuery"),Nl=L("adminUpdateNotionAIAvailabilityForSpace"),zl=L("adminGetSpaceMembershipUpdates"),ql=L("adminBulkCreateTimedTrials"),Wl=L("getGeoIpLocation"),Hl=L("getTeamAccessRequestMetadata"),Kl=L("stripeAdvanceTestClock"),Gl=L("stripeGetTestClock"),$l=L("adminOptOutNotionAIDataSharing"),Ql=L("getTransitivePageRelations"),Yl=L("getActiveExportTasks"),Jl=L("adminExplainPaymentStatus"),Xl=L("adminGetBulkIds"),ec=L("adminUpdatePaymentStatus"),tc=L("getTemplateSearchResults"),nc=L("getTemplates"),oc=L("getTemplateCreator"),ic=L("submitTemplateCreator"),rc=L("validateTemplate"),ac=L("validateTemplateCreatorHandle"),sc=L("validateActorOwnsTemplate"),lc=L("validateTemplateDraftSlug"),cc=L("submitTemplateDraft"),dc=L("submitTemplateDraftLocalizedBulk"),uc=L("deleteTemplate"),pc=L("deleteTemplateDraft"),mc=L("getTemplateDrafts"),fc=L("updatePinnedTemplates"),gc=L("getSpaceMembershipUpdates"),hc=L("getUserContractionData"),vc=L("testSetupWorkspace"),bc=L("testCreatePage"),yc=L("testDeleteRecord"),_c=L("getPageAssistantPreferences"),Sc=L("setPageAssistantPreferences"),wc=L("adminRestoreDeletedGuestPermissions"),kc=L("adminDescribeRestoreDeletedGuestPermissions"),Ic=L("adminAddLinkPreviewToSpace"),Cc=L("updateDisableGuestsOnSpace"),xc=L("submitEducationGroupApplication"),Tc=L("getUniversitiesAndDomains"),Mc=L("exportSpaceMembers"),Pc=L("exportSpaceGuests"),Ac=L("publishAiSession"),Rc=L("getPublishedPagesForUser"),Dc=L("adminIsWorkspaceInQnA"),Ec=L("adminMergeUsers"),Bc=L("adminRecoverUserContentInSpace"),Fc=L("resolveAccessRequest"),Oc=L("getExternalOrgData"),Zc=L("addUserToWaitlist"),Vc=L("adminGetWorkspaceWebhookSubscriptions"),Uc=L("adminSearchBots"),Lc=L("adminGetAutomationsForRecordId"),jc=L("adminBulkAddEduUniversitiesAndDomains"),Nc=L("getSpacesInOrganization"),zc=L("getUserOrganizations"),qc=L("enqueueScanContentTask"),Wc=L("getAiWaitlistRequestsForSpace"),Hc=L("getHomeEnabledSpaceViews"),Kc=L("adminUpdateNotionCalendarAvailableForSpace"),Gc=L("isDesktopVersionCompatible"),$c=L("getCalendarEvents"),Qc=L("validatePublicDomainAvailability"),Yc=L("createPublicDomain"),Jc=L("updatePublicDomain"),Xc=L("updatePublicDomainHomePage"),ed=L("deletePublicDomain"),td=L("addUserToOrganizationSpaces"),nd=L("removeUserFromOrganizationSpaces"),od=L("updateUserRoleInOrganizationSpace"),id=L("getConnectedAppsForUniversalQna"),rd=L("getSlackIngestionAuthorizeUrl"),ad=L("disconnectSlackIngestion"),sd=L("saveAssistantChatHistory"),ld=new r.Z({performRequests:async e=>{const{environment:t}=e[0],n=e.map((e=>e.args)),o=await Un(t,{requests:n});if("failed"===o.type)throw o.error;return[]},batchSize:50,maxWorkers:2,requestDelayMs:20,requestTimeoutMs:10*b.C0});async function cd(e,t){return await ld.enqueue({environment:e,args:t})}const dd=new r.Z({performRequests:async e=>{const t=new Array(e.length),n=e.map(((e,t)=>({environment:e.environment,request:e.args,index:t}))),o=g.vM(n,(e=>e.request.userId));for(const[i,r]of Object.entries(o)){const e=r[0].environment,n=[];for(const{request:t}of r){const{pointer:e,version:o}=t;n.push({pointer:e,version:o})}const o=await On(e,{requests:n},i);if("failed"===o.type)throw o.error;const a=u.PF.create(o.data.recordMap);M.Z.addFromRecordMapWithRole(a),M.Z.isEmpty()||F.dY({environment:e});for(const{request:i,index:s}of r)if(i.pointer){const e=a.getValue(i.pointer),n=a.getRole(i.pointer);n&&(e&&i.pointer.id!==(null==e?void 0:e.id)&&l.log({from:"client/api",level:"warning",type:"FetchedPointerMismatch",error:(0,h.Ui)(new Error("Value returned does not match pointer inside syncRecordValuesBatched")),data:{miscDataToConvertToString:{requestedPointer:i.pointer,fetchedId:e.id}}}),t[s]={value:e,role:n})}}return t},batchSize:500,maxWorkers:2,requestDelayMs:20,requestTimeoutMs:30*b.C0});async function ud(e,t){if(t.pointer&&(0,p.Ok)(t.pointer))try{const n=await dd.enqueue({environment:e,args:t});return n||-1!==t.version?n:{value:void 0,role:"editor"}}catch(n){}}function pd(e){return[e.url,e.downloadName,e.download].filter(Boolean).join(":")}const md=new class{constructor(){this.lru=new(i())({max:1e3,maxAge:b.U6})}set(e,t){this.lru.set(pd(e),t)}get(e){return this.lru.get(pd(e))}},fd=new r.Z({performRequests:async e=>{const t=e.map((e=>{let{url:t}=e;return t})),n=await uo(e[0].environment,{urls:t});if("failed"===n.type)throw n.error;const{signedUrls:o}=n.data;return t.forEach(((e,t)=>{const n=o[t];md.set(e,n)})),o},batchSize:500,maxWorkers:1});async function gd(e,t,n){const o=md.get(t);let i;return i=o||await fd.enqueue({environment:e,url:t}),i&&(0,s.x$)(i)&&n&&(i=(0,v.NV)({httpUrl:i,protocol:y.default.protocol,includePort:!0})),i}const hd=new a.Z},35793:(e,t,n)=>{n.d(t,{Bs:()=>fe,_S:()=>he,qY:()=>Se,mc:()=>me,KJ:()=>ve,Uz:()=>ge});var o=n(50112),i=n(15145),r=n(82813),a=n(68626),s=n(97213),l=n(99405),c=n(21202),d=n(13493),u=n(65311),p=n(19889),m=n(66079),f=n(28182),g=n(9852),h=n(54153),v=n(57347),b=n(7032),y=n(18265),_=n(19584),S=n(25320),w=n(17707),k=n(97978),I=n(19124),C=n(84210),x=n(98165),T=n(18514),M=n(51),P=n(80444),A=n(81258),R=n(69327),D=n(64970),E=n(93220),B=n(72014),F=n(89523),O=n(6258),Z=n(32470),V=n(87956),U=n(29026),L=n(81023),j=n(28517),N=(n(21703),n(1898)),z=n(80736),q=n(54642);var W=n(32441),H=n(98688),K=n(50950),G=n(47307),$=n(57400),Q=n(91367),Y=n(94273),J=n(97977),X=n(98958),ee=n(17659),te=n(31304),ne=n(40277),oe=n(32953),ie=n(8055),re=n(87531),ae=n(29974),se=n(13447),le=n(61202),ce=n(70782),de=n(12321),ue=n(37181),pe=n(65452);function me(e){P.default.setState(P.default.getInitialState());const{id:t}=e.currentUser;(!P.default.state.currentUserStore||t&&t!==P.default.state.currentUserStore.id)&&(t?(de.j(e,t),Y.Bk(e,t),ve(e,t)):(P.default.setState({...P.default.state,initialized:!0}),K.dd(e)))}function fe(){const{currentSpaceStore:e}=P.default.getState();return e?e.id:void 0}async function ge(e){const{nextRoute:t,currentRoute:n,environment:p,query:m}=e,f=P.default.state.mainEditorCurrentBlockStore,h=P.default.state.currentCollectionViewStore,_=p.currentUser.id,x=e=>{P.default.state.lastUpdater===x&&(p.device.isMobileNative&&e.currentSpaceStore&&a.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"AppStore setting space with update in updateCurrentRoute: ",spaceId:e.currentSpaceStore.id}}),P.default.setState({...P.default.state,...e}))};P.default.setState({...P.default.state,lastUpdater:x});const T=e=>{P.default.state.lastUpdater===x&&M.Z.setState({publicPageData:e})};if("page"===t.name&&t.queryId&&V.Z.setState({queryId:t.queryId,pageId:t.blockId,timeEntered:new Date}),"page"===t.name||"space"===t.name||"nativeTab"===t.name||"quickSearch"===t.name||"chat"===t.name||"workspaceSetup"===t.name){let e;Y.nr(t,_);const d=async()=>{e||(e=ne.I6({environment:p,request:{type:"block-space",...t}}));const[n]=await Promise.all([e.next(),P.default.waitUntil((()=>P.default.state.initialized))]),o=n.value;return T(o),o},h=(0,g.QG)();if((0,I.AC)(p),"page"===t.name&&(!f||f.id!==t.blockId||n&&"page"===n.name&&n.blockId!==t.blockId||f.userId!==_)){oe.Pg(p),oe.LU(p),L.$B(),oe.rM(p);const{blockId:e}=t,l=new O.G(p,{table:c.iU,id:e}),g=new E.Z;x({mainEditorCurrentBlockStore:l,currentLoadingContainerStore:g}),f||await he({environment:p,store:l});const v=await d(),{currentUserSettingsStore:I}=P.default.state;if(_e({environment:p,publicPageData:v}))return void function(e){const{store:t,environment:n}=e,o=(0,C.ZP)({store:t,preferPublicLink:!1,pageVisitSource:void 0});ie.c4({environment:n,url:o})}({store:l,environment:p});const{presenceStore:T,currentUserRootStore:M}=P.default.state;te.E(T,p,B.$g,f),S.UX(p,{block:l,fromPageRefresh:h,pageVisitStore:P.default.state.pageVisitStore,timestamp:Date.now()}),w.Y0(l.id);const A=new F.Z;x({presenceStore:A});const D=B.$g.getCurrentPageVisitId();if(B.$g.initializeNewPageVisitId(),te._({userId:_,rootStore:l,presenceStore:A,environment:p,pageVisitIdStore:B.$g}),M){if("root"===(null==n?void 0:n.name)){const e=M.getSpaceViewStores();if(void 0===v.spaceId||e.map((e=>e.getSpaceId())).indexOf(v.spaceId)<0){if(I)return p.device.isMobileNative&&a.log({level:"warning",from:"loginActions",type:"setLoggedInUserId",data:{message:"SpaceDebug: navigateToFirstSpace because updateCurrentRoute is root and page is not in current spaceView"}}),void(await ae.L5({environment:p,userRootStore:M,userSettingsStore:I,pageVisitSource:i.tY.BackForward}));if(_)return void(await J.logoutSingleAccount({environment:p,userId:_,logoutOrigin:s.F.NoAvailableSpaces}))}}if(v.spaceId&&(v.canJoinSpace||v.userHasExplicitAccess)){const e=await ae.j({environment:p,userRootStore:M,spaceId:v.spaceId,navigate:!1,analyticsFrom:"redirect",userSettingsStore:I});p.device.isMobileNative&&a.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"updateCurrentRoute updating space because the route is a page with spaceId",spaceId:v.spaceId}}),x({currentSpaceViewStore:e.spaceViewStore,currentSpaceStore:e.spaceViewStore.getSpaceStore()})}else if(!v.spaceId&&P.default.state.currentSpaceStore){const e=await ae.j({environment:p,userRootStore:M,spaceId:P.default.state.currentSpaceStore.id,navigate:!1,analyticsFrom:"redirect",userSettingsStore:I});var W;if(p.device.isMobileNative)a.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"updateCurrentRoute updating space because of joinSpaceResult of current space",spaceId:null===(W=e.spaceViewStore)||void 0===W?void 0:W.getSpaceId()}});x({currentSpaceViewStore:e.spaceViewStore,currentSpaceStore:e.spaceViewStore.getSpaceStore()})}}v.spaceId&&_&&(pe.h({environment:p,spaceId:v.spaceId,userId:_}),j.I({environment:p,spaceId:v.spaceId,userId:_}));const{currentSpaceStore:Z}=P.default.state;Z?(L.OR({environment:p,spaceId:Z.id}).then((async()=>{await l.load(),ye(p,l,m,B.$g,D)})),k.Jq(p)):v&&v.spaceId&&(await l.load(),ye(p,l,m,B.$g,D)),async function(e,t,n){const a=(0,y.Qc)(t).query,s=a[o.gS];if(parseInt(a[i.$X])===i.tY.Email&&(s.includes("email_digest")||s.includes("email_push"))&&a[i.Qs]&&n){const t=(0,b.wr)(a[i.Qs]),o=O.Xo.createChildStore(n,{table:u.uX,id:t});await o.load();const s=o.getModel();if(!s)return;if((0,r.e)((0,k.mc)(e),{alreadyRead:s.getRead(),notificationId:t,activityId:s.getActivityId(),from:"email"}),!s.getRead()){const t={id:s.id,space_id:s.getSpaceId(),read:s.getRead()};se.createAndCommit({userAction:"appActions.setNotificationAsReadFromEmail",environment:e,perform:e=>ee.$h({notification:t,rootStore:n,transaction:e,read:!0})})}}}(p,m,Z);const V=(null==Z?void 0:Z.id)||v.spaceId;V&&(le.pt({environment:p,spaceId:V,force:!1}),H.L({environment:p,spaceId:V,force:!1})),V&&Q.Wf({environment:p,spaceId:V}),V&&async function(e){const{environment:t,spaceId:n,force:o}=e;await P.default.waitUntilRendered();const i=z.Z.state,r=t.currentUser.id,{currentSpaceStore:a}=P.default.state;if(r&&a&&(!i.loaded&&!i.loading||i.loaded&&n!==i.spaceId||i.loaded&&r!==i.userId||o)){z.Z.setState({...z.Z.state,loading:!0});const e=await q.getAiWaitlistRequestsForSpace(t,{spaceId:n});if("success"!==e.type)throw new Error("Request failed.");const{aiWaitlistIds:o}=e.data,i=a.getRole()??"none";(0,N.Of)(o)?z.Z.setState({loaded:!0,loading:!1,spaceId:n,userId:r,isOnWaitlist:!0,spaceRole:i,aiWaitlistIds:o}):z.Z.setState({loaded:!0,loading:!1,spaceId:n,userId:r,isOnWaitlist:!1,spaceRole:i,aiWaitlistIds:void 0})}}({environment:p,spaceId:V,force:!1}),V&&_&&(R.Z.isInitialized||R.Z.reinitializeState(p,_,V))}else if("space"===t.name){const e=await d();if(e.publicHomePage){const t=new O.G(p,{table:c.iU,id:e.publicHomePage}),n=new E.Z;x({mainEditorCurrentBlockStore:t,currentLoadingContainerStore:n})}else if(x({mainEditorCurrentBlockStore:void 0,currentLoadingContainerStore:void 0}),_e({environment:p,publicPageData:e}))return void Se({spaceDomain:e.spaceDomain,environment:p})}else if("nativeTab"===t.name||"quickSearch"===t.name||"chat"===t.name){oe.Pg(p),oe.LU(p),L.$B(),oe.rM(p),await P.default.waitUntil((()=>P.default.state.initialized));const e="spaceId"in t?t.spaceId:void 0;if((!P.default.state.currentSpaceViewStore||!P.default.state.currentSpaceStore||e&&P.default.state.currentSpaceStore.id!==e)&&P.default.state.currentUserRootStore){const n=P.default.state.currentUserRootStore.getSpaceViewStores(),o=e?n.find((t=>{var n;return(null===(n=t.getSpaceId())||void 0===n?void 0:n.replaceAll("-",""))===(null==e?void 0:e.replaceAll("-",""))})):n[0],i=null==o?void 0:o.getSpaceStore();if(o&&i){var K,X;if(p.device.isMobileNative)a.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:`updateCurrentRoute updating space because it's native tab and current space store id (${null===(K=P.default.state.currentSpaceStore)||void 0===K?void 0:K.id}, spaceView: ${null===(X=P.default.state.currentSpaceViewStore)||void 0===X?void 0:X.id}) doesn't match nextRoute space id`,spaceId:e}});x({currentSpaceStore:i,currentSpaceViewStore:o});const n="nativeTab"===t.name&&"search"===t.tab&&_&&!1,r="quickSearch"===t.name&&_,s="chat"===t.name&&_;(n||r||s)&&R.Z.reinitializeState(p,_,i.id)}}"chat"===t.name&&x({mainEditorCurrentBlockStore:void 0,currentCollectionViewStore:void 0})}else if((0,l.wO)(t)&&(oe.Pg(p),oe.LU(p),L.$B(),oe.rM(p),await P.default.waitUntil((()=>P.default.state.initialized)),t.spaceId&&P.default.state.currentUserRootStore)){const e=P.default.state.currentUserRootStore.getSpaceViewStores().find((e=>e.getSpaceId()===t.spaceId)),n=null==e?void 0:e.getSpaceStore();e&&n&&(p.device.isMobileNative&&a.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"updateCurrentRoute updating space because routeWithoutSpecificBlock and current nextRoute space id is",spaceId:t.spaceId}}),x({currentSpaceStore:n,currentSpaceViewStore:e,mainEditorCurrentBlockStore:void 0}))}if("searchQuery"in t||"searchRequest"in t)if(t.searchQuery)re.UT({environment:p,analyticsFrom:"query-args",renderAsPage:!1}),U.ZP.setState({...U.ZP.state,query:{...U.ZP.state.query,text:t.searchQuery}});else if(t.searchRequest)try{const e=JSON.parse(t.searchRequest),{text:n,sort:o,filters:i}=e;m&&U.ZP.setState({...U.ZP.state,query:{text:n,sort:o,filters:i}}),Z.ZP.setState({...Z.ZP.state,showDebugInfo:!0,debug:"everything"})}catch(ue){G.deprecatedShowErrorMessage("Invalid json in searchRequest param"),a.log({level:"error",from:"appActions",type:"JSONParseError",error:{miscDataString:(0,v.t)(ue).message}})}if(e)for await(const t of e)T(t);$.Yh(p),(0,g.um)(!1)}const ce=h?h.id:void 0;if("page"===t.name&&ce!==t.collectionViewId){const e=t.collectionViewId;x({currentCollectionViewStore:e?new O.Xr(p,{table:d.np,id:e}):void 0})}const de=(0,y.Qc)(m).query[i.RL];Boolean(de)&&(D.m.setState(!0),A.Z.setState({open:!0}))}async function he(e){const{environment:t,store:n}=e,o=await async function(e){const{environment:t,blockId:n}=e,{currentUser:o}=t,i=(0,_.jj)([...o.id?[o.id]:[],...o.loggedInUserIds]);for(const r of i){const e=new O.G(t,{table:c.iU,id:n},{userId:r});if(await e.load(),e.isDefined())return o.id===r?void 0:r}}({environment:t,blockId:n.id});o&&await ce.f({newCurrentUserId:o,environment:t,store:n})}async function ve(e,t){const n=new O.U6(e,{table:p.KJ,id:t},{userId:t}),o=new O.vO(e,{table:f.Sr,id:t},{userId:t});o.addListener(be);const i=new O.r9(e,{table:m.dx,id:t},{userId:t});X.registerPushNotifications(e),P.default.setState({...P.default.state,currentUserStore:n,currentUserSettingsStore:o,currentUserRootStore:i,initialized:!1}),await de.w(),P.default.setState({...P.default.state,initialized:!0}),ue.fG(e),K.oG(e)}function be(e){const t=e.getSettingsStore().getKeyStore("preferred_locale").getValue();t||h.Z.set("preferredLocale",t)}function ye(e,t,n,o,i){var r,a;W.PB(e,{query:n,page_id:t.id,is_peek:!1,peek_mode:void 0,type:"collection"===t.getParentTable()?"database_page":"page",collection_id:t.getAssociatedCollectionId()??(null===(r=t.getCollectionViewCollectionStore())||void 0===r?void 0:r.id),team_id:null===(a=(0,x.VP)(t))||void 0===a?void 0:a.id,page_visit_id:o.getCurrentPageVisitId(),previous_page_visit_id:i})}function _e(e){const{environment:t,publicPageData:n}=e;return!(!(0,T.Sr)(t)||"none"!==n.publicAccessRole||!n.spaceName)}function Se(e){const{spaceDomain:t,environment:n}=e,o=(0,T.Rs)(t);ie.c4({environment:n,url:o,redirect:!0})}},2449:(e,t,n)=>{n.d(t,{D$:()=>g,M0:()=>p,W$:()=>v,ac:()=>h,cM:()=>m,hC:()=>u,uG:()=>b});n(21703);var o=n(68626),i=n(9852),r=n(54153),a=n(11342),s=n(19584),l=n(95477),c=n(53730),d=n(47839);function u(e){var t;const{environment:n,url:r,version:a}=e,{AppUpdateStore:s,device:l}=n;l.isElectron&&r.startsWith("https:")?o.log({level:"error",from:"appUpdateActions",type:"installAppJsUpdate",error:{message:"Attempting to refresh app js on desktop for an https url",stack:(new Error).stack},data:{url:r}}):(s.setState({electronUpdate:s.state.electronUpdate,appUpdate:void 0}),a&&g(a),p(a)||(n.mobileNative&&n.mobileNative.showSplashscreen(),(0,i.um)(!0),null!==(t=d.electronApi)&&void 0!==t&&t.installAppJsUpdate?d.electronApi.installAppJsUpdate(r):r!==window.location.href?window.location.href=r:window.location.reload()))}function p(e){return(0,a.isEqualVersion)(e,b())}function m(e,t){if(!t)return!1;if("ready"!==t.state)return!1;if(c.transactionQueue.hasTasks())return!1;if(!e.currentUser.isLoggedIn())return!1;if(t.type===a.UpdateType.Silent){if(e.device.isMobileNative)return!1;const t=v(),n=168;if(t&&(Date.now()-t)/s.U6<n)return!1;o.log({level:"info",from:"appUpdateActions",type:"shouldUpdateOnNavigate",data:{lastKnownUpdateTime:t}})}return!0}const f="lastKnownAppJsVersion";function g(e){r.Z.set(f,{version:e,time:Date.now()})}function h(){const e=r.Z.get(f);if(e&&e.version)return e.version;{const e=(0,a.parseVersion)(l.default.version);return r.Z.set(f,{version:e,time:Date.now()}),e}}function v(){const e=r.Z.get(f);if(e&&e.time)return e.time}function b(){return(0,a.parseVersion)(l.default.version)}},35253:(e,t,n)=>{n.d(t,{Bw:()=>r,Js:()=>s,qL:()=>a});var o=n(1898),i=n(22294);function r(e){const{id:t,styleKey:n,contentKey:r,removeTimeout:s,bannerStore:l,blockStore:c,context:d,disabled:u}=e,{banners:p}=l.state;if(!p.find((e=>e.id===t))){let m;switch(r){case"template_in_page":case"template_in_button":m={id:t,contentKey:r,styleKey:n,blockStore:c,context:d,disabled:u};break;case"space_content_duplication":case"deleted_or_moved_page":case"importing_evernote":case"asana_importer_banner":case"external_sync_progress_banner":case"site":m={id:t,contentKey:r,styleKey:n,blockStore:c};break;case"over_free_block_limit":case"editing_page":case"subscription_trial_add_payment_method":case"upload_limit_exceeded":case"admin_mode":case"subscription_payment_status":case"subscription_uncollectible":case"minor_app_update":case"mobile_platform_unsupported":case"page_in_archived_team":case"crdt_page":case"test_clock":m={id:t,contentKey:r,styleKey:n};break;default:(0,o.t1)(r)}const f=e.prepend?[m,...p]:[...p,m];l.setState({banners:f}),i.Z.setKeyboardMode(!1),s&&setTimeout((()=>{a({bannerStore:l,id:t})}),s)}}function a(e){const{id:t,bannerStore:n}=e,{banners:o}=n.state,i=o.filter((e=>e.id!==t));i.length!==o.length&&n.setState({banners:i})}function s(e){e.bannerStore.state.banners.length>0&&e.bannerStore.setState({banners:[]})}},54564:(e,t,n)=>{n.d(t,{Ib:()=>w,LZ:()=>k,Xv:()=>I});var o=n(1302),i=n(33709),r=n(23867),a=n(53965),s=n(37850),l=n(33767),c=n(17707),d=n(65598),u=n(58202),p=n(46351),m=n(74948),f=n(24646),g=n(36391),h=n(24229),v=n(6258),b=n(85344),y=n(24677),_=n(98104);function S(e,t){const n=p.Z.find((e=>e.getStore().id===t));n&&(y.ZH(e),_.NX({store:n.getInputStore().state.textStore}))}async function w(e){var t;const{environment:n,blockStore:p,analyticsFrom:w,discussionIds:k,shouldFocusDiscussion:I,recursivelyLoadAllDiscussions:C}=e,x=(null==k?void 0:k.map((e=>v.t1.createChildStore(p,{table:i.qF,id:e,spaceId:(0,r.C)(p.pointer.spaceId)}))))||d.al(p,{recursivelyLoadAllDiscussions:C});let{rect:T}=e;const{resolved:M,unresolved:P}=d.bB(x),{discussionHelpers:A}=await l.Av.loader(),R=A.sortDiscussionStoresByLatestComment(P.length>0?P:M)||[],D=null==R||null===(t=R[0])||void 0===t?void 0:t.id,{device:E}=n;E.isMobile&&"updates_sidebar"!==w&&(y.ZH(n),E.isIOS&&_.sD()),c.AM(R.map((e=>e.id))),await o.default.afterNextFlush();const B=(0,f.Sx)(n);if(p.isNavigableBlock()){if(D){"PageDetailsStore"in n&&n.PageDetailsStore.setToggleState({type:"discussion",id:p.id,environment:n},!0);const e=v.t1.createChildStore(p,{table:i.qF,id:D,spaceId:(0,r.C)(p.pointer.spaceId)});if((B||!B&&I)&&c.T4(D),e.getResolved())if((0,f.Sx)(n))m.setUpdateSidebarCommentsMode(g.F7.Resolved);else{const e=u.R.findBlockFromStoreWithMethod(p,"openResolvedDiscussionPopup");e&&(e.openResolvedDiscussionPopup(),await o.default.afterNextFlush(),c.T4(D))}b.ZW(n,{from:w,discussion_id:e.id})}if(!B)return}if(!T&&!B&&"margin_comments"!==w){const e=u.R.getRect(p);if(!e)return;const t=e.width,n=e.height,o=e.right-t;T=new DOMRect(o,e.top,t,n)}let F=h.u.Open;if(D){const e=v.t1.createChildStore(p,{table:i.qF,id:D,spaceId:(0,r.C)(p.pointer.spaceId)});e.getResolved()&&(F=h.u.Resolved),e.getResolved()||(m.setUpdateSidebarCommentsMode(g.F7.Unresolved),m.setUpdateSidebarTab(g.gY.Comments))}else F=h.u.Resolved;if(E.isMobile&&"updates_sidebar"!==w&&(y.ZH(n),E.isIOS&&_.sD()),h.Z.setState({open:!0,rect:T,tab:F,blockStore:p,discussionIds:x.map((e=>e.id)),recursivelyLoadAllDiscussions:C}),b.ZW(n,{from:w,discussion_id:D}),I)if(D){if(await s.Vs(10),await o.default.afterNextFlush(),c.T4(D),n.device.isMobile)return;(function(e){var t;const{blockStore:n,discussionIds:o}=e;return h.Z.state.open&&h.Z.state.blockStore.id===n.id&&a.Xy(null===(t=h.Z.state)||void 0===t?void 0:t.discussionIds,o)})(e)||S(n,D)}else{if(n.device.isMobile)return;P.length>0&&(await s.Vs(10),await o.default.afterNextFlush(),S(n,P[0].id))}}function k(){const e=h.Z.state;e.open&&h.Z.setState({open:!1,rect:e.rect})}function I(){const e=h.Z.state;if(e.open&&e.tab===h.u.Open){0===d.vV(e.blockStore,{recursivelyLoadAllDiscussions:!1}).length&&k()}}},6404:(e,t,n)=>{n.d(t,{$Z:()=>p,Qn:()=>u,xv:()=>m});var o=n(75079),i=n(95802),r=n(24646),a=n(8949),s=n(17903),l=n(83212),c=n(50628),d=n(17224);function u(e){const{environment:t,left:n,top:o,actionSectionGroupKey:i,showInput:r,stores:c,analyticsFrom:d,optionalAnalyticsProperties:u,pageAnnotationToken:p}=e,m=new DOMRect(n,o,1,1);a.Z.setState({isActive:!0,inputValue:"",actionSectionGroupKey:i,stores:c,frameScrollTop:s.Z.state.scrollTop,originBlockRect:m,showInput:r,analyticsFrom:d,publicEditMode:c[0]?l.Z.getMode(t,c[0]):void 0,collectionContextStore:null==u?void 0:u.collectionContextStore,clickedPageAnnotation:p}),f(t,{from:d,block_type:c[0]&&c[0].getType(),optionalAnalyticsProperties:u})}function p(e){const{environment:t,analyticsFrom:n,actionSectionGroupKey:o,stores:r,showInput:d}=e,u=i.C.findSelectableFromStore(r[0]);if(!u)return;const p=c.Z.state.selectableRectMap.get(u);p&&a.Z.setState({isActive:!0,inputValue:"",actionSectionGroupKey:o,stores:r,frameScrollTop:s.Z.state.scrollTop,originBlockRect:p,showInput:void 0===d||d,analyticsFrom:n,publicEditMode:r[0]?l.Z.getMode(t,r[0]):void 0}),t&&f(t,{from:n,block_type:r[0]&&r[0].getType()})}function m(){a.Z.setState({isActive:!1})}function f(e,t){const{optionalAnalyticsProperties:n,...i}=t,{teamStore:a,collectionContextStore:s,...l}=t.optionalAnalyticsProperties||{},c=(0,o.Pn)(s)||{};d.YP(e,"open_block_menu",{store:a,...(0,r.UF)({environment:e}),...c,...i,...l})}},79554:(e,t,n)=>{n.d(t,{Dq:()=>R,H8:()=>D,RH:()=>M,_x:()=>C,kE:()=>I,ry:()=>E,wK:()=>P,xv:()=>x});n(21703);var o=n(15145),i=n(41432),r=n(1800),a=n(606),s=n(21202),l=n(70203),c=n(53965),d=n(1898),u=n(95477),p=n(28020),m=n(95802),f=n(61207),g=n(6258),h=n(52229),v=n(19785),b=n(9953),y=n(42858),_=n(24677),S=n(64964),w=n(993),k=n(13447);function I(e){const{blocks:t,copiedStores:n,pageSource:o}=e,i=c.Z$(t);if(!i)return;const r=m.C.getRectFromStore(i);r&&f.Z.setState({open:!0,type:"blocks",blocks:t,rect:r,copiedStores:n,pageSource:o})}function C(e){const{blocks:t,copiedLinks:n,rootStore:o}=e;if(!t.every(T))return!1;if(n.some((e=>e.blockId===o.id)))return!1;const i=c.Z$(t);if(!i)return!1;const r=m.C.getRectFromStore(i);return!!r&&(f.Z.setState({open:!0,type:"links",blocks:t,rect:r,copiedLinks:n}),!0)}function x(){f.Z.setState({open:!1})}function T(e){return!(e.isType(i.Ti.copyIndicator)||e.isTransclusionType()||e.isInsideCollection())}function M(e){const{blocks:t,pageSource:n,wasContiguousSelection:o,action:r,rootStore:s,copiedStores:l}=e;return"copy"===r&&o&&!(0,a.qo)(n,s.pointer)&&(P(e)||D({currentSpaceId:s.getSpaceId(),...e}))&&t.every(T)&&!l.every((e=>e.getType()===i.Ti.externalObjectInstance))}function P(e){const{blocks:t}=e;return 1===t.length}function A(e){const{transaction:t,blockUrl:n,spaceId:o,useCrdt:r,environment:a}=e,s=b.j4({environment:a,type:i.Ti.text,inMemoryRecordCache:a.defaultRecordCache.inMemoryRecordCache,transaction:t,spaceId:o,useCrdt:r}),c=[(0,l.V3y)(n,[(0,l.edl)(n)])];return w.sO({environment:a,editorMode:"default",store:s.getBlockTitleStore(),value:c,transaction:t}),s}async function R(e){const{environment:t,blocks:n,source:i}=e,a=c.Ps(n);if(!a)return;const l=a.getParentBlockStore();if(!l)return;const p=a.getContentStore();let m;await k.createAndCommitAsync({environment:t,userAction:"blockPasteMenuActions.acceptLinkToPage",waitForServerCommit:!0,perform:async e=>{if("blocks"===i.type){const{copiedStores:n,pageSource:c}=i,d=a,f=n[0];if(!d||!f)return;const v=g.G.createChildStore(p,{table:s.iU,id:f.id});if(v.isNavigableBlock())await v.load(),m=[h.k({environment:t,parentBlock:l,targetStore:v,transaction:e})];else{const n=(0,r.Z)({pageId:c.id,scrollToBlockId:v.id,baseUrl:u.default.domainBaseUrl,pageVisitSource:o.tY.LinkInPage});m=[A({blockUrl:n,spaceId:a.getSpaceId(),useCrdt:a.useCrdt(),environment:t,transaction:e})]}}else if("links"===i.type){const{copiedLinks:c}=i;if(c.length!==n.length)return;m=await Promise.all(c.map((async n=>{const i=n.scrollToBlockId||n.peekViewBlockId||n.blockId,c=g.G.createChildStore(p,{table:s.iU,id:i});if(await c.load(),c.isNavigableBlock())return h.k({environment:t,parentBlock:l,targetStore:c,transaction:e});{const i=n.peekViewBlockId||n.blockId,l=g.G.createChildStore(p,{table:s.iU,id:i});await l.load();return A({blockUrl:(0,r.Z)({pageId:i,pageModel:l.getModel(),scrollToBlockId:c.id,baseUrl:u.default.domainBaseUrl,pageVisitSource:o.tY.LinkInPage}),spaceId:a.getSpaceId(),useCrdt:a.useCrdt(),environment:t,transaction:e})}})))}else(0,d.t1)(i);const c=y.is({environment:t,blocks:m,selection:n,replaceEmptyTextBlock:!0,transaction:e});y.Cl({environment:t,blocks:n,transaction:e}),_.Z5({environment:t,stores:c}),x()}})}function D(e){const{currentSpaceId:t,blocks:n,copiedStores:o}=e;return n.length>0&&!o.some((e=>e.isInsideCollection()))&&o.every((e=>e.canEdit()))&&o.every((e=>e.getSpaceId()===t))&&o.every((e=>e.useCrdt()===n[0].useCrdt()))}async function E(e){const{environment:t,blocks:n,copiedBlockIds:o}=e,r=await Promise.all(o.map((async e=>{const t=g.G.createChildStore(n[0],{table:s.iU,id:e});await t.load();const o=t.getParentBlockStore();if(!o)throw new Error("Block has no parent.");await o.load();const i=o.getContentStore();return{store:g.G.createChildStore(i,{table:s.iU,id:e}),parentStore:o,parentContentStore:i}}))),a=r[0];if(!a)return;const l=(0,p.RM)();if(!l)return;if(a.store.useCrdt()!==l.useCrdt())return void S.oV({label:l.useCrdt()?"Cannot sync a non-CRDT block in a CRDT page.":"Cannot sync a CRDT block in a non-CRDT page."});const{serverCommitResult:c}=k.createAndCommit({userAction:"blockPasteMenuActions.acceptCreateTransclusion",environment:t,perform:e=>{let o;if(a.store.getType()===i.Ti.transclusionContainer)o=a.store;else if(a.store.getType()===i.Ti.transclusionReference){const e=a.store.getTransclusionReferenceTargetStore();if(!e)throw new Error("Could not find target");o=e}else if(a.parentStore.getType()===i.Ti.transclusionContainer)o=a.parentStore;else{o=b.j4({environment:t,type:i.Ti.transclusionContainer,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:a.store.pointer.spaceId,useCrdt:a.store.useCrdt()});const n=o.getContentStore();v.rS({parentStore:a.parentContentStore,oldChildStore:a.store,newChildStore:o,transaction:e});for(const{store:t}of r)v.jG({parentStore:n,childStore:t,transaction:e})}const s=b.j4({environment:t,type:i.Ti.transclusionReference,format:{transclusion_reference_pointer:o.pointer},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:0!==n.length?n[n.length-1].pointer.spaceId:l.pointer.spaceId,useCrdt:0!==n.length?n[n.length-1].useCrdt():l.useCrdt()}),c=y.is({environment:t,blocks:[s],selection:n,transaction:e,replaceEmptyTextBlock:!0});y.Cl({environment:t,blocks:n,transaction:e}),_.Z5({environment:t,stores:c}),x()}});await c}},51365:(e,t,n)=>{n.d(t,{$o:()=>v,RX:()=>b,bA:()=>f,fG:()=>S,gT:()=>y,i2:()=>_,mm:()=>w,vO:()=>h,xv:()=>g});var o=n(73935),i=n(1302),r=n(99036),a=n(80951),s=n(70203),l=n(58299),c=n(61045),d=n(24677),u=n(993),p=n(98104),m=n(13447);function f(e){const{environment:t,blockPropertyValueOverlayStore:n,store:a,additionalStores:f=[],property:g,format:h,preventClearSelection:v,insertChar:b,uploadFiles:y,disableHorizontalEdgeScroll:_,isNewBlock:S,collectionContextStore:w,mode:k,collectionsBulkActionsToolbarStore:I,readOnly:C}=e,x=((null==w?void 0:w.normalizedSchemaStore.state)??a.getSchema())[g],T=l.Z.findBlockPropertyValue(a,g,h);let M=e.rect;const P=null==T?void 0:T.getNode();if(P&&(c.bx({element:P,vertical:{reveal:"closest"},horizontal:_?void 0:{reveal:"closest"},scrollers:{verticalScroller:null==T?void 0:T.getContextVerticalScroller(),horizontalScroller:null==T?void 0:T.getContextHorizontalScroller()}}),!M)){const e=o.findDOMNode(P);e instanceof Element&&(M=e.getBoundingClientRect())}if(!M)return;const A=a.clone();if(n.setState({isOpen:!0,store:a,clonedStore:A,additionalStores:f,property:g,format:h,rect:M,preventClearSelection:v,insertChar:b,uploadFiles:y,isNewBlock:S,collectionContextStore:w,mode:k,collectionsBulkActionsToolbarStore:I,readOnly:C}),!I||"title"!==(null==x?void 0:x.type)&&"text"!==(null==x?void 0:x.type)||null==I||I.setState({textStoresBeingEdited:[...f,a],lastBlockPropertyValueOverlayCloseTime:void 0}),x&&r.Yl(x.type)){v||d.ZH(t);const e=A.getNormalizedPropertyStore(g);b&&m.createAndCommit({userAction:"blockPropertyValueOverlayActions.open",environment:t,perform:n=>{u.sO({environment:t,editorMode:"default",store:e,value:s.TPx(b),transaction:n})}}),i.default.afterNextFlush((()=>{i.default.afterNextFlush((()=>{i.default.afterNextFlush((()=>{p.NX({store:e})}))}))}))}else v||d.ZH(t),p.ZH(t)}function g(e){const{environment:t,blockPropertyValueOverlayStore:n}=e,o=n.state;o.isOpen&&(o.preventClearSelection||d.ZH(t),n.reset(),i.default.afterNextFlush((()=>{var e;return null===(e=o.collectionsBulkActionsToolbarStore)||void 0===e?void 0:e.setState({textStoresBeingEdited:[],lastBlockPropertyValueOverlayCloseTime:Date.now()})})))}function h(e){const{stores:t,property:n,transaction:o}=e,i=t[0].getPropertyStore(n),r=(0,a.Ml)(i.getValue());for(const s of t)u.sO({environment:s.environment,editorMode:"default",store:s.getNormalizedPropertyStore(n),value:(0,a._I)(!r),transaction:o})}function v(e){const{blockPropertyValueOverlayStore:t}=e,n=t.state;if(n.isOpen){const{store:t,property:r}=n,a=l.Z.findBlockPropertyValue(t,r);var o,i;if(null!=a&&a.getProps().onTab)null==a||null===(o=(i=a.getProps()).onTab)||void 0===o||o.call(i);else g(e)}}function b(e){const{blockPropertyValueOverlayStore:t}=e,n=t.state;if(n.isOpen){const{store:t,property:r}=n,a=l.Z.findBlockPropertyValue(t,r);var o,i;if(null!=a&&a.getProps().onUntab)null==a||null===(o=(i=a.getProps()).onUntab)||void 0===o||o.call(i);else g(e)}}function y(e){const{blockPropertyValueOverlayStore:t}=e,n=t.state;if(n.isOpen){const{store:t,property:r}=n,a=l.Z.findBlockPropertyValue(t,r);var o,i;if(null!=a&&a.getProps().onEnter)null==a||null===(o=(i=a.getProps()).onEnter)||void 0===o||o.call(i);else g(e)}}function _(e){const{blockPropertyValueOverlayStore:t}=e,n=t.state;if(n.isOpen){const{store:t,property:r}=n,a=l.Z.findBlockPropertyValue(t,r);var o,i;if(null!=a&&a.getProps().onEsc)null==a||null===(o=(i=a.getProps()).onEsc)||void 0===o||o.call(i);else g(e)}}function S(e){const{blockPropertyValueOverlayStore:t}=e,n=t.state;if(n.isOpen){const{store:t,property:r}=n,a=l.Z.findBlockPropertyValue(t,r);var o,i;if(null!=a&&a.getProps().onBgClick)null==a||null===(o=(i=a.getProps()).onBgClick)||void 0===o||o.call(i);else g(e)}}function w(e){const{blockPropertyValueOverlayStore:t,openProperty:n}=e,o=t.state;if(o.isOpen){var i,r;const{store:t,property:a}=o,s=l.Z.findBlockPropertyValue(t,a);(null==s||null===(i=(r=s.getProps()).onOpenProperty)||void 0===i?void 0:i.call(r,n))||g(e)}}},48948:(e,t,n)=>{n.d(t,{K:()=>p});var o=n(41432),i=n(23867),r=n(70203),a=n(37850),s=n(80444),l=n(54642),c=n(9953),d=n(993),u=n(13447);async function p(e){const{store:t,url:n,environment:p,teamId:m}=e,f=void 0!==e.transformTimeout?e.transformTimeout:3e3,{serverCommitResult:g}=u.createAndCommit({userAction:"bookmarkBlockActions.createBookmark",environment:p,perform:e=>{c.sW({store:t.getPropertiesStore(),data:{link:r.TPx(n)},transaction:e}),d.sO({environment:p,editorMode:"default",store:t.getBlockTitleStore(),value:r.TPx(n),transaction:e})}}),{winner:h,rest:v}=await a.S3([g,a.Vs(f)]);if(1===h&&(await async function(e,t){const{serverCommitResult:n}=u.createAndCommit({userAction:"bookmarkBlockActions.transformIntoBookmark",environment:e,perform:e=>{c.sW({store:t,data:{type:o.Ti.bookmark},transaction:e})}});await n}(p,t),await v),m){const{currentSpaceStore:e}=s.default.state;await l.setBookmarkMetadata(p,{type:"team-invite-bookmark",block:{id:t.id,spaceId:(0,i.C)(t.pointer.spaceId)},url:n,teamId:m,spaceId:e&&e.id})}else await l.setBookmarkMetadata(p,{type:"external-bookmark",block:{id:t.id,spaceId:(0,i.C)(t.pointer.spaceId)},url:n})}},893:(e,t,n)=>{n.d(t,{tq:()=>lt,JG:()=>Vt,IK:()=>fn,VG:()=>pn,g9:()=>gn,Hs:()=>un,Dw:()=>mn,RD:()=>hn,Pm:()=>yn,by:()=>Zt,tk:()=>nn,of:()=>Kt,e0:()=>Pt,Mt:()=>Sn,wc:()=>_n,v:()=>ln,AL:()=>Ut,R$:()=>qt,jm:()=>Dt,f4:()=>bn,Lh:()=>wn});n(57658);var o=n(27856),i=n.n(o),r=n(1302),a=n(66897),s=n(15145),l=n(41432),c=n(99036),d=n(1800),u=n(95538),p=n(15095),m=n(64962),f=n(61075),g=n(42509),h=n(43593),v=n(35102),b=n(68626),y=n(38297),_=n(42875),S=n(19531),w=n(64572),k=n(22808),I=n(30845),C=n(25718),x=n(59753),T=n(482),M=n(77337),P=n(19233),A=n(45953),R=n(606),D=n(82883),E=n(99405),B=n(21202),F=n(6287),O=n(70279),Z=n(23867),V=n(54153),U=n(70203),L=n(38585),j=n(95371),N=n(9291),z=n(31701),q=n(53965),W=n(7032),H=n(15828),K=n(1898),G=n(18265),$=n(96313),Q=n(94419),Y=n(37524),J=n(75330),X=n(95477),ee=n(27105),te=n(24990),ne=n(28020),oe=n(56518),ie=n(44486),re=n(84210),ae=n(33929),se=n(68056),le=n(45162),ce=n(70219),de=n(65598),ue=n(73959),pe=n(41984),me=n(89224),fe=n(89086),ge=n(58202),he=n(28685),ve=n(44534),be=n(85305),ye=n(80444),_e=n(87143),Se=n(88632),we=n(77080),ke=n(30874),Ie=n(22294),Ce=n(6258),xe=n(27724),Te=n(24666),Me=n(81023),Pe=n(36610),Ae=n(952),Re=n(57549),De=n(79554),Ee=(n(21703),n(374)),Be=n(70842),Fe=n(82798),Oe=n(78791),Ze=n(98165),Ve=n(69645),Ue=n(95802),Le=n(54532),je=n(19358),Ne=n(993),ze=n(98104),qe=n(68422);function We(e){const{environment:t,clipboardData:n,transaction:o,allowPasteIntoHeaderWithoutChildren:i,selectAll:a,developerDebug:s}=e;if(Te.default.isEditingComment()||(0,fe.qK)())return!1;if(n.blockSelection.blocks.some((e=>!e.blockSubtree)))return!1;const c=Te.default.state;if("editing"!==c.mode)return!1;const d=c.multiSelection.start.store;if(!d.isTable(B.iU))return!1;const u=(0,ue.sQ)(d);if(!u)return!1;if(d!==u.getBlockTitleStore())return!1;const p=u.getType(),m=u.getFormat();if(!p)return!1;if(!((0,l.Um)(p,m)||i&&(0,l.zp)(p)))return!1;if(i&&(0,l.zp)(p)){const e=n.blockSelection.blocks[0],t=null==e?void 0:e.blockId,o=null==e?void 0:e.blockSubtree,i=t&&o?o.getModel({id:t,table:"block"}):void 0;if(Boolean(null==i?void 0:i.getContentLength()))return!1}const f=(0,Ve.dq)({includeNonSelectableListContainer:!0});if(!f)return!1;const g=(0,Ve.v5)(u,[f]);if(!g)return!1;let h=0;for(let r=g.length-1;r>=0;r--){const e=g[r].value.store,t=Ue.C.findSelectableFromStore(e),n=e.getModel();if(null!=n&&n.isType(l.$t)||t&&!t.props.canSelect){h=r;break}}const v=g.slice(h);if(0===v.length)return!1;const b=v[0].value.store,y=b.pointer.spaceId,_=b.isInsideTemplate()||b.isInsideFactoryOrDuplicateBlocksAction();s("pasting at",v,{spaceId:y,pastingIntoTemplate:_,insertionPathRootStore:b});const S=n.blockSelection.blocks.map((e=>{var n;let{blockId:i,blockSubtree:r}=e;if(!r)throw new Error("Missing data for local duplicate block during paste");const a=(null===(n=r.getModel({table:B.iU,id:i}))||void 0===n?void 0:n.getType())===l.Ti.factory,s=!(_||a),c=Ce.G.createChildStore(b,{table:B.iU,id:i}),d=Le.E9({environment:t,sourceBlockId:i,targetBlockPointer:{table:B.iU,id:(0,W.ZP)(),spaceId:y},sourceBlockSubtree:r,targetInMemoryRecordCache:b.inMemoryRecordCache,addCopyName:(0,pe.Z)(c),deepCopyTransclusionContainers:!1,resolveTemplateVariables:s,transaction:o,useCrdt:b.useCrdt()}),p=d.targetBlock.getType();return p&&Ae.W(t,{from:"paste",type:p,new_page_id:"page"===p?d.targetBlock.id:void 0,creating_block_id:d.targetBlock.id,parent_collection_id:u.getParentCollectionIdUpToTwoLevels()}),d})),w=n.multiTextSelection.start.pointerPath,k=n.multiTextSelection.end.pointerPath,I=[],C=[],x=Math.max(w.length,k.length),T=(v[v.length-x]||v[0]).value.store,M=(0,j.MW)({node:n.tree,recordStoreParent:T},(e=>{let{node:t,recordStoreParent:n}=e;const o=((e,t)=>{let n;for(const{originalToDuplicate:o}of S)if(n=o.get(t),n)break;if(n)return Ce.G.createChildStore(e,n)})(n,t.value),i=I.length<w.length?w[I.length]:void 0,r=C.length<k.length?k[C.length]:void 0;let a=!1;if((null==i?void 0:i.id)===t.value.id&&(a=!0,I.push(o)),(null==r?void 0:r.id)===t.value.id&&(a=!0,C.push(o)),!a)return{value:{store:o}};const s=(null==o?void 0:o.getContentStore())||b;return{value:{store:o},children:t.children.map((e=>({node:e,recordStoreParent:s})))}}));if(I.length!==w.length||0===I.length)throw new Error(`Failed to hydrate start path during paste (found ${I.length} of ${w.length})`);if(C.length!==k.length||0===C.length)throw new Error(`Failed to hydrate end path during paste (found ${C.length} of ${k.length})`);const P=I[I.length-1],A=C[C.length-1];if(!P||!A)throw new Error(`Failed to hydrate position during paste (${P?"":"missing start"} ${A?"":"missing end"})`);const R=(0,j.DY)([M],(e=>e.value.store===P)),D=(0,j.DY)([M],(e=>e.value.store===A)),E=R&&D&&Be.T.fromNearestCommonAncestor(R,D);if(!E)throw new Error(`Failed to build range for paths: ${R?"":"missing start"} ${D?"":"missing end"}`);Ne.pz({environment:t,editorMode:"default",multiSelection:c.multiSelection,transaction:o});const F=Te.default.state,O="editing"===F.mode?F.multiSelection:c.multiSelection;if((0,de.PF)(u)&&0===n.multiTextSelection.start.textIndex){const e=P.getType();e&&(0,l.Zu)(e)&&qe.Cj({environment:t,blocks:[u],blockType:e,transaction:o})}let Z;return b.useCrdt()?(Ke({transaction:o,developerDebug:s,clipboardData:n,startBlock:u,duplicateStartStore:P,range:E,insertionPath:v,duplicates:S,insertionPathRootStore:b}),Z=He({environment:t,transaction:o,clipboardData:n,insertionPoint:O,developerDebug:s,textSelectionState:c,duplicateEndStore:A,pastingIntoTemplate:_}).newSelectionIndex):(Z=He({environment:t,transaction:o,clipboardData:n,insertionPoint:O,developerDebug:s,textSelectionState:c,duplicateEndStore:A,pastingIntoTemplate:_}).newSelectionIndex,Ke({transaction:o,developerDebug:s,clipboardData:n,startBlock:u,duplicateStartStore:P,range:E,insertionPath:v,duplicates:S,insertionPathRootStore:b})),r.default.afterNextFlush((()=>{const e=(0,Ve.kC)({rootStore:b,root:f,target:E.end}),t=e&&(0,ue.mh)(e[e.length-1]);if(!t)return;const n={start:{index:a?O.start.index:Z,store:a?O.start.store:t},end:{index:Z,store:t}};ze.NA({multiSelection:n})})),!0}function He(e){const{insertionPoint:t,duplicateEndStore:n,pastingIntoTemplate:o,environment:i,transaction:r,developerDebug:a,clipboardData:s}=e;let l=0;const c=t.end.store,d=t.end.index,u=(0,ue.mh)(n);if(u){l=U.eeV(u.getValue()).length;const e=(0,Fe.TO)((0,ue.sQ)(c)),t=(0,Fe.TO)((0,ue.sQ)(u));ee.Ls({store:c,blockStore:e})&&ee.Ls({store:u,blockStore:t})?(Oe.Wc({sourceBlockStore:e,targetBlockStore:t,splitAtGraphemeIndex:d,transaction:r,moveIntoNewBlock:!1}),a("(CRDT) pasted suffix into end",u)):(Ne.gc({environment:i,editorMode:"default",sourceStore:c,sourceIndex:d,targetStore:u,targetIndex:l,transaction:r}),a("pasted suffix into end",u))}else Ne.pe({environment:i,editorMode:"default",transaction:r,store:c,selection:{startIndex:d,endIndex:1/0}}),a("no end title store to paste text into");let p=U.V3g(s.multiTextSelection.start.copiedText,{removeSuggestions:!0,removeDiscussions:!0});return o||(p=U.KV2(p,{currentUserId:i.currentUser.id,currentTimeZone:(0,_.r)()})),Ne.mM({environment:i,index:t.start.index,store:t.start.store,tokens:p,transaction:r}),{newSelectionIndex:l}}function Ke(e){const{transaction:t,clipboardData:n,startBlock:o,duplicateStartStore:i,insertionPath:r,insertionPathRootStore:a,duplicates:s,range:l,developerDebug:c}=e;for(const u of l.iterateInsertionAt(r))(0,Ve.D_)({transaction:t,treeOperation:u,deleteFrom:"tree-parent"}),Ee.f.applyMutable(u);if(n.blockSelection.wasContiguousSelection&&n.blockSelection.blocks.length>0&&!o.hasContent())for(const u of i.getContentStores())Q.R3({parent:o.getContentStore(),append:u,transaction:t});const d=new Set;for(const{originalToDuplicate:u}of s){const e=u.getByTable(B.iU);for(const{value:n}of e){if(!n||d.has(n.id))continue;d.add(n.id);const e=Ce.G.createChildStore(i,n);(0,Ze.qA)(e).find((e=>e.id===a.id))||(c("disposing of unwanted duplicated block:",e,e.id===i.id),je.YM({childStore:e,parentStore:a,alive:!1,transaction:t}))}}}var Ge=n(42274),$e=n(47307),Qe=n(31781),Ye=n(89951),Je=n(9953),Xe=n(42858),et=n(24677),tt=n(64964),nt=n(80402),ot=n(13447),it=n(61202);const rt=!1;function at(){if(rt){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log("clipboardActions:",...t)}}const st=(0,N.defineMessages)({offlineError:{id:"clipboardActions.offlineError.message",defaultMessage:"Please go online to copy this block."}}),lt=(0,N.defineMessages)({copiedQnAMessageToClipboard:{id:"action.copiedQnAMessageToClipboard",defaultMessage:"Copied response to clipboard"},copiedLinkToClipboard:{id:"action.copiedLinkToClipboard.snackBarMessage",defaultMessage:"Copied link to clipboard"},copiedBlockLinkToClipboard:{id:"action.copiedBlockLinkToClipboard.snackBarMessage",defaultMessage:"Copied block link to clipboard"},copiedLinksToClipboard:{id:"action.copiedLinksToClipboard.snackBarMessage",defaultMessage:"Copied links to clipboard"},copiedPropertyToClipboard:{id:"action.copiedPropertyToClipboard.snackBarMessage",defaultMessage:"Copied property to clipboard"},copiedCodeToClipboard:{id:"action.copiedCodeToClipboard.snackBarMessage",defaultMessage:"Copied code to clipboard"},copiedTokenToClipboard:{id:"action.copiedTokenToClipboard.snackBarMessage",defaultMessage:"Copied token to clipboard"},copiedToClipboard:{id:"action.copiedToClipboard.snackBarMessage",defaultMessage:"Copied to clipboard"},copiedApiObjectToClipboard:{id:"action.copiedApiObjectToClipboard.snackBarMessage",defaultMessage:"Copied API object to clipboard"}}),ct={...P.Y,dockerfile:"Docker",javascriptreact:"JavaScript",jsonc:"JSON","objective-c":"Objective-C",proto:"Protobuf",shellscript:"Shell",typescriptreact:"TypeScript",vb:"Visual Basic"},dt="text/_notion-blocks-v3-production",ut="text/_notion-text-production",pt="text/_notion-multi-text-production",mt="text/_notion-page-source-production",ft="vscode-editor-data",gt=[dt,ut,pt,mt],ht=new Set(gt);const vt={fromJson:e=>e,toJson:e=>e},bt=vt,yt=vt,_t=vt,St={fromJson(e){const t=(0,j.MW)(e.tree,(e=>e)),n=wt.fromJson(e.blockSelection);return{...e,tree:t,blockSelection:n}},toJson(e){const t=wt.toJson(e.blockSelection);return{...e,blockSelection:t}}},wt={fromJson:e=>({...e,blocks:e.blocks.map((e=>({...e,blockSubtree:e.blockSubtree?A.Ak.create(e.blockSubtree):void 0})))}),toJson:e=>({...e,blocks:e.blocks.map((e=>({...e,blockSubtree:e.blockSubtree?e.blockSubtree.toJson({allowVersionDowngrade:!1}):void 0})))})},kt="VirtualClipboard:production";let It;function Ct(e){return e.isAndroid}function xt(e,t){if(!Ct(t))return e;const n=(0,oe.nZ)(e.getData("text/html"));if(n){It||(It=V.Z.get(kt));const t=It;if(n===(null==t?void 0:t.id)){const n=e.types.concat(Object.keys(t.mimeTypes));return{getData(n){const o=e.getData(n);return!o&&function(e){return ht.has(e)}(n)?t.mimeTypes[n]||"":o},types:[...new Set(n)].filter((n=>{const o=t.mimeTypes[n];return""!==e.getData(n)||o&&""!==o})),items:e.items}}}return e}function Tt(e,t,n,o){if(!e.clipboardData)return;const i=n.toJson(o),r=JSON.stringify(i);e.clipboardData.setData(t,r)}function Mt(e,t,n){try{const o=e.getData(t),i=JSON.parse(o);return n.fromJson(i)}catch(o){return}}function Pt(e){const{clipboardData:t}=e,{text:n,html:o,isFromMicrosoftOffice:i,isHtmlTable:r}=function(e){const{clipboardData:t,tinyMceMicrosoftWordPasteFilter:n}=e,o=t.getData("text/uri-list"),i=t.getData("text/plain").replace(sn,"\n")||o,r=t.getData("text/html"),a=Jt(r),{isHtmlTable:s,htmlContainsRichFormatting:l}=function(e){var t;const n=document.createElement("div");n.innerHTML=Xt(e);const o=Boolean("table"===(null===(t=n.firstElementChild)||void 0===t?void 0:t.nodeName.toLowerCase()));return{htmlContainsRichFormatting:S.RE({node:n,window,emojiData:te.Z.state}),isHtmlTable:o}}({html:r,tinyMceMicrosoftWordPasteFilter:n});if(!l&&!function(e,t){return an.test(e)&&an.test(t)}(r,i))return{text:i,isFromMicrosoftOffice:a,isHtmlTable:s};return{text:i,html:r,isFromMicrosoftOffice:a,isHtmlTable:s}}(e);return{text:n,html:o,multiTextSelectionData:Mt(t,pt,St),textSelectionData:Mt(t,ut,bt),blockSelectionData:Mt(t,dt,wt),isFromMicrosoftOffice:i,isHtmlTable:r}}function At(e){const{blocks:t,action:n,environment:o}=e;if(0===t.length)return{action:n,blocks:[],wasContiguousSelection:!1};const i=t[0],r=i.inMemoryRecordCache,a=q.jj(q.oA(t.map((e=>e.id)))),s=i.getParentBlockStore(),l=s?s.getRenderableContentIds():[],c=l.indexOf(i.id),d=Boolean(s&&t.every(((e,t)=>l.indexOf(e.id)===c+t)));if(r.isTemplatePreview){return{blocks:a.map((e=>({blockId:e,snapshotData:void 0,blockSubtree:Le.K8(o,{blockId:e,inMemoryRecordCache:r,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,excludeCrdtData:!0})}))),action:n,wasContiguousSelection:d}}if(r.snapshotData){Pe.P_(o,r.snapshotData);return{blocks:a.map((e=>({blockId:e,snapshotData:r.snapshotData,blockSubtree:Le.K8(o,{blockId:e,inMemoryRecordCache:r,allowCopyCollections:!0,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,excludeCrdtData:!0})}))),action:n,wasContiguousSelection:d}}{const e=(0,oe.IU)(t),i=e&&function(e){var t;const{environment:n,multiColumnPasteInfo:o,inMemoryRecordCache:i}=e,{columnListId:r,columnIds:a,spaceId:s}=o,l=A.Ak.create(),c=null===(t=i.getEntry({pointer:{table:B.iU,id:r,spaceId:s},userId:n.currentUser.id}))||void 0===t?void 0:t.value.value;if("column_list"!==(null==c?void 0:c.type))return;const d={...c,content:(c.content||[]).filter((e=>a.has(e)))};l.setValue({table:B.iU,id:r,spaceId:s},d);for(const m of a){var u;const e=null===(u=i.getEntry({pointer:{table:B.iU,id:m,spaceId:s},userId:n.currentUser.id}))||void 0===u?void 0:u.value.value;if("column"!==(null==e?void 0:e.type))return;const t={...e,content:(e.content||[]).filter((e=>o.blockIds.has(e)))};l.setValue({table:B.iU,id:m,spaceId:s},t)}const p=[l];for(const m of o.blockIds){const e=Le.K8(n,{blockId:m,inMemoryRecordCache:i,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,excludeCrdtData:!0});if(!e)return;p.push(e)}return A.Ak.merge(p)}({environment:o,inMemoryRecordCache:r,multiColumnPasteInfo:e});if(e&&i){let t=!1;const s=[];for(const n of a)e.blockIds.has(n)?t||(s.push({blockId:e.columnListId,snapshotData:void 0,blockSubtree:i}),t=!0):s.push({blockId:n,snapshotData:void 0,blockSubtree:Le.K8(o,{blockId:n,inMemoryRecordCache:r,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,excludeCrdtData:!0})});return{blocks:s,action:n,wasContiguousSelection:d}}return{blocks:a.map((e=>({blockId:e,snapshotData:void 0,blockSubtree:Le.K8(o,{blockId:e,inMemoryRecordCache:r,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,excludeCrdtData:!0})}))),action:n,wasContiguousSelection:d}}}function Rt(e){const{markdown:t,markdownOptions:n,markdownLinkifyIt:o}=e;if(o)return C.c8({...o,markdown:t,plugin:null==n?void 0:n.plugin})}function Dt(e){const{rootBlock:t,getRecordValue:n}=e,o=n(t);if(!o)return;const i=(0,y.ky)({block:o,getRecordValue:n});if(!i)return;const r=(0,oe.ax)({rootBlock:t,getRecordValue:n}),a=(0,c.oC)(i),s=Object.keys(a),l=q.MR(s,(e=>{const t=a[e];return t&&t.name||""}));let d="";for(const c of l){const e=a[c];if(e&&"title"!==c){const t=(0,f.Wy)({property:c,schema:a,block:o,exportArgs:r,renderers:m.O});t&&(d+=`${e.name}: ${t}\n`)}}return d||void 0}function Et(e){const{treePath:t,textPosition:n,endpoint:o}=e,{store:i,index:r}=n,a=t.map((e=>e.value.store.pointer)),s=ee.FX(n.store)?["properties","title"]:n.store.path,l=U.xrQ(i.getValue(),r,r);return{copiedText:"end"===o?l.tokensBeforeRange:l.tokensAfterRange,textIndex:r,attributePath:s,pointerPath:a}}function Bt(e){var t;const{multiSelection:n,action:o,environment:i}=e;(0,se.qS)(n)&&console.warn("Warning, serializeMultiTextSelectionToClipboardData() was called with a single-store text selection! This function should only be  called with a multi-selection that spans multiple blocks.");const r=null===(t=(0,le.tp)({filterCommonAncestors:!0,multiSelection:n,focus:void 0}))||void 0===t?void 0:t.stores;if(!r)return;const a=At({action:o,blocks:r,environment:i});if(0===a.blocks.length)return;const s=(0,le.Nj)({multiSelection:n,includeNonSelectable:!1});if(!s)return;const{treeRange:l}=s,c=[],d=new Map,u=(e,t)=>{t.forEach((e=>u(e,[])));const n=d.get(e),o=n&&n.length>t.length?n:t;d.set(e,o)};for(const{start:v,end:b}of l.iterateAnalogousNodes()){if(v){const e=v.childrenBeforeRange.slice(-1).concat(v.childrenInsideRange);u(v.parent,e)}b&&(u(b.parent,b.childrenInsideRange),c.push(T.op.set({pointer:b.parent.value.store.pointer,path:["content"],args:b.childrenInsideRange.map((e=>e.value.store.id))})))}const p=Et({textPosition:n.start,endpoint:"start",treePath:l.startPath}),m=Et({textPosition:n.end,endpoint:"end",treePath:l.endPath});c.push(...(0,oe.FQ)(p),...(0,oe.FQ)(m));for(const v of[null===(f=a.blocks[0])||void 0===f?void 0:f.blockSubtree,null===(g=a.blocks[a.blocks.length-1])||void 0===g?void 0:g.blockSubtree]){var f,g;v&&(0,M.FS)({recordMap:v,operations:c,updateOnly:!0})}const h=(0,j.MW)(l.commonAncestor,(e=>{const t=d.get(e);if(t)return{value:e.value.store.pointer,children:t}}));if(h)return{blockSelection:a,tree:h,multiTextSelection:{start:p,end:m},action:o};at("unexpected: trimming tree produced undefined")}function Ft(e){const{environment:t,event:n}=e,o=(0,W.ZP)();!function(e){const{environment:t,event:n,markdownLinkifyIt:o}=e;if(!n.clipboardData)return;const i=xe.default.state.stores,r=Te.default.isEditingComment(),a=be.Z.state.open,s=ve.g$.getSimpleTableCellFromTextSelection(),c="empty"!==Te.default.state.mode&&Te.default.state.multiSelection,d=t.currentUser.id,u="copy"===n.type?"copy":"cut",p=ne.RM();p&&(0,R.$O)(p.pointer,B.iU)&&Tt(n,mt,yt,p.pointer);const m=c&&(0,se.QY)(c);if(m&&m.selection.startIndex!==m.selection.endIndex){const e=ae.default.getIntl(),{store:o,selection:i}=m,r=o.inMemoryRecordCache,a=o.getValue();if(at("copy: copying single-store text selection"),n.preventDefault(),a&&!nn()){var f;const e="title"===o.path[o.path.length-1],t=null===(f=(0,ue.sQ)(o))||void 0===f?void 0:f.getType(),r=e&&t&&(0,l.Zu)(t)?t:void 0,s=a.filter((e=>!U.eIM(e)));Tt(n,ut,bt,{blockType:r,editing:s,selection:i,action:u})}const s=U.KU1(a,i.startIndex,i.endIndex),c=x.om.fromGetRecordValueFn(r.makeGetRecordValueFn(d)),p=r.makeGetRecordRoleFn(d),g=(0,D.X)({intl:e,textValue:s,getRecordModel:c,userTimeZone:(0,_.r)(),externalIntegrations:ke.Z.integrations.state});n.clipboardData.setData("text/plain",(0,oe.ZI)(t.device.isWindows,g));const h=L.hW({textValue:s&&{value:s,spaceId:(0,Z.C)(o.pointer.spaceId)},getRecordModel:c,getRecordRole:p,userTimeZone:(0,_.r)(),isAndroid:!1,isSafariOrIOS:!1,isWindows:!1,disableLinks:!1,disabled:!0,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,baseUrl:X.default.domainBaseUrl,publicDomainName:X.default.publicDomainName,showEmojiInline:!0,emojiType:"raw",theme:(0,z.Vx)(),intl:e,katex:void 0,isClient:void 0,currentUserId:void 0,overwriteBaseUrlFromSpaceId:(0,ce.b)(t),externalIntegrations:ke.Z.integrations.state,formulaValueTypes:[],emojiData:te.Z.state,isMobileNative:!1});return void n.clipboardData.setData("text/html",(0,oe.ZI)(t.device.isWindows,h))}if(c&&!(0,se.iG)(c)&&!r&&c.start.store.table===B.iU&&c.end.store.table===B.iU){const e=Bt({environment:t,multiSelection:c,action:u});if(e){at("copy: copying multi-text selection"),n.preventDefault(),Tt(n,pt,St,e);const i=c.start.store.inMemoryRecordCache,r=c.start.store.getRecordStoreUIRoot().getValue();if(!r)return;const{markdown:a,html:s}=(0,oe.Ef)({clipboardData:e,rootBlock:{id:r.id,table:B.iU,spaceId:r.space_id},isWindows:t.device.isWindows,fallbackGetRecordValue:i.makeGetRecordValueFn(d),markdownLinkifyIt:o,markdownSerializationOptions:{transformBlockMapping:{image:we.default.checkGate("docs_clipboard_imagedata")?Ot:void 0}}});return a&&n.clipboardData.setData("text/plain",a),void(s&&n.clipboardData.setData("text/html",s))}}if(c&&!(0,se.iG)(c)&&!r&&c.start.store.table===O.x_&&c.end.store.table===O.x_){at("copy: copying comment multi-text selection"),n.preventDefault();const e=(0,le.L5)(c),o=ae.default.getIntl(),i=e.map((e=>{let{store:n,selection:i}=e;if(i.startIndex===i.endIndex)return;const r=n.inMemoryRecordCache,a=x.om.fromGetRecordValueFn(r.makeGetRecordValueFn(d)),s=r.makeGetRecordRoleFn(d),l=U.KU1(n.getValue(),i.startIndex,i.endIndex);return{plainText:(0,D.X)({intl:o,textValue:l,getRecordModel:a,userTimeZone:(0,_.r)(),externalIntegrations:ke.Z.integrations.state}),htmlContent:L.hW({textValue:l&&{value:l,spaceId:(0,Z.C)(n.pointer.spaceId)},getRecordModel:a,getRecordRole:s,userTimeZone:(0,_.r)(),isAndroid:!1,isSafariOrIOS:!1,isWindows:!1,disableLinks:!1,disabled:!0,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,baseUrl:X.default.domainBaseUrl,publicDomainName:X.default.publicDomainName,showEmojiInline:!0,emojiType:"raw",theme:(0,z.Vx)(),intl:o,katex:void 0,isClient:void 0,currentUserId:void 0,overwriteBaseUrlFromSpaceId:(0,ce.b)(t),externalIntegrations:ke.Z.integrations.state,formulaValueTypes:[],emojiData:te.Z.state,isMobileNative:!1}),textValue:l}})).filter(K.$K),r=i.map((e=>e.plainText)).join("\n\n"),a=`<div>${i.map((e=>e.htmlContent)).join("</div><div>")}</div>`;return n.clipboardData.setData("text/plain",(0,oe.ZI)(t.device.isWindows,r)),void n.clipboardData.setData("text/html",(0,oe.ZI)(t.device.isWindows,a))}if(i.length>0&&!r&&!s&&!a){at("copy: copying block selection"),n.preventDefault();const e=i[0],r=e.inMemoryRecordCache,a=At({blocks:i,environment:t,action:u});if(Tt(n,dt,wt,a),!e.isDefined())return;const s=q.oA(i.map((e=>e.computeWithRecordValues((t=>{let{getRecordValueAndSubscribe:n}=t;return n(e)}))))),l=r.makeGetRecordValueFn(d),{markdown:c,html:p}=(0,oe.X4)({rootBlock:{id:e.id,table:B.iU,spaceId:e.getSpaceId()},blockValues:s,getRecordValue:l,isWindows:t.device.isWindows,markdownLinkifyIt:o});return c&&n.clipboardData.setData("text/plain",c),void(p&&n.clipboardData.setData("text/html",p))}at("copy: doing nothing")}(e),(0,oe.Li)(n,o),function(e){let{event:t,device:n,customEventId:o}=e;if(!t.clipboardData||!Ct(n))return;const i={};for(const s of gt)i[s]=t.clipboardData.getData(s);const r=t.clipboardData.getData("text/html");t.clipboardData.setData("text/html",`${r}${(0,oe.Gp)(o)}`),It={id:o,mimeTypes:i};try{V.Z.set(kt,It)}catch(a){b.log({level:"error",from:"clipboardActions",type:"setVirtualClipboardData",error:{message:"Unable to persistently store virtual clipboard data."}})}}({event:n,device:t.device,customEventId:o})}function Ot(e){const{block:t,exportArgs:n}=e,{getExportedRenderAsset:o}=n,{source:i}=x.kk.fromBlock(t).getProperties(),r=U.QaF(i),a=function(e){if(!e.file_ids)return;const t=ge.R.findBlockFromId(e.id);if(!t)return;const n=t.getNode();if(!(n instanceof Element))return;const o=n.querySelector("img");if(!o)return;const i=document.createElement("canvas");i.width=o.width,i.height=o.height;const r=i.getContext("2d");if(!r)return;return r.drawImage(o,0,0,o.width,o.height),i.toDataURL()}(t)??o({fromBlockId:n.blockId,toFileURI:r}),s=C.cG(e)||C.WB({block:t,exportArgs:n})||a;return{text:(0,u.SR)({url:r})?`![${s}](${a})`:`[${s}](${a})`,breakLines:!0,children:C.AS(e)}}async function Zt(e){const{event:t,environment:n,markdownLinkifyIt:o}=e;ze.Zk(n);const i=xe.default.state.stores,r=Te.default.isEditingComment(),a=ne.JE(),s="editing"===Te.default.state.mode&&Te.default.state.multiSelection,{phase:l}=xe.default.state;Vt({environment:n,event:t,disableSyncTextSelection:!0,markdownLinkifyIt:o}),s&&!(0,se.iG)(s)?ot.createAndCommit({userAction:"clipboardActions.cutWithMaybeConfirmation",environment:n,perform:e=>{Ne.pz({environment:n,editorMode:"default",multiSelection:s,transaction:e})}}):(l===xe.SelectionPhase.Selected||s)&&i.length>0&&!r&&!a&&await Xe.Qw({environment:n,blocks:i,shouldCheckSuggestEdit:!0}),Ie.Z.setKeyboardMode(!0)}function Vt(e){const{environment:t,event:n,disableSyncTextSelection:o,markdownLinkifyIt:i}=e;o||ze.Zk(t),Ft({environment:t,event:n,markdownLinkifyIt:i}),Ie.Z.setKeyboardMode(!0)}function Ut(e){const{environment:t,files:n,transaction:o}=e,i=xe.default.getCurrentRecordCache(),r=ne.qQ(t);if(i){var a,s;const e=xe.default.state.stores,l=Qe.z({environment:t,files:n,inMemoryRecordCache:i,transaction:o,pageWidth:r,spaceId:0!==e.length?e[0].pointer.spaceId:null===(a=ne.RM())||void 0===a?void 0:a.pointer.spaceId,useCrdt:0!==e.length?e[0].useCrdt():(null===(s=ne.RM())||void 0===s?void 0:s.useCrdt())??!1});l.forEach((e=>{const n=e.getType();n&&Ae.W(t,{from:"paste",type:n,creating_block_id:e.id})})),Nt({environment:t,blocks:l,transaction:o,replaceEmptyTextBlock:!0})}}function Lt(e){const{environment:t,store:n,tokens:o,index:i,transaction:a,multiTextSelection:s,disableEmbedMenu:l,selectAll:c}=e,d=(0,se.QY)(s),u=d?{value:d.store.getValue()}:void 0;Ne.mM({environment:t,store:n,tokens:o,index:i,transaction:a,selectAll:c});const m=jt(o);!l&&u&&m&&function(e){const{environment:t,hyperlink:n,oldTextValue:o}=e,i="editing"===Te.default.state.mode&&(0,se.QY)(Te.default.state.multiSelection),a=xe.default.state;if(i&&a.stores.length>0){const e=i.store.getValue(),a=U.QaF(e),s=p.p4(a.substring(0,a.indexOf(n.text))).length,l=s+p.p4(n.text).length;if(i.store.isTable(B.iU)||i.store.isTable(O.x_)){if(it.KT({environment:t,blockStore:xe.default.state.stores[0],textStore:i.store,textValueBeforePaste:o,url:n.url,urlSelection:{startIndex:s,endIndex:l}}))return;if($.QZ({environment:t,textStore:i.store,blockStore:xe.default.state.stores[0],oldTextValue:o,url:n.url,urlSelection:{startIndex:s,endIndex:l}}))return}r.default.afterNextFlush((()=>{let e=n.url;try{e=decodeURIComponent(n.url)}catch(r){b.log({level:"info",from:"clipboardActions",type:"activateMenuFromLink",error:{message:`Encountered error in decodeURIComponent ${n.url}`}})}Ye.KT({environment:t,textStore:i.store,oldTextValue:o,url:e,urlSelection:{startIndex:s,endIndex:l}})}))}}({environment:t,hyperlink:m,oldTextValue:u.value,transaction:a})}function jt(e){if(1!==e.length)return;const t=e[0];if(!U.AJd(t))return;const[n,o]=t;if(1!==o.length)return;const i=o[0];if(!U.j0F(i))return;return{text:n,url:U.zW$(i)}}function Nt(e){const{environment:t,blocks:n,transaction:o,replaceEmptyTextBlock:i}=e,r=xe.default.state.stores;if(1===r.length){const e=r[0];if(e.getType()&&e.isType(l.hY)&&function(e){if("editing"!==Te.default.state.mode||!Te.default.state.multiSelection)return!1;const t=(0,se.QY)(Te.default.state.multiSelection);if(!t)return!1;return t.store===e.getTitleStore()}(e)){const i=e.getContentStore(),r=q.d9(n).reverse().map((e=>Q.Ce({parent:i,prepend:e,transaction:o}).child));return et.Z5({environment:t,stores:r}),r}}return Xe.is({selection:r,environment:t,blocks:n,transaction:o,replaceEmptyTextBlock:i})}function zt(e,t,n,o){const i=(0,ne.RM)();if(!i)return;const a=xe.default.state.stores,s=0!==a.length?a[0].pointer.spaceId:i.pointer.spaceId,c=0!==a.length?a[0].useCrdt():i.useCrdt();let d=function(e,t){if("cut"!==t.action||!we.default.checkGate("convert_cut_paste_to_move"))return;const n=[];for(const o of t.blocks){const t=Ce.G.createChildStore(e,{table:B.iU,id:o.blockId});if(!t.isReady())return;if(t.useCrdt()!==e.useCrdt())return;const i=t.getModel();if(!i)return;if(i.getSpaceId()!==e.getSpaceId())return;if(!1!==i.alive)return;n.push(t)}return n}(i,t);d||(d=t.blocks.map((t=>{var n;let{blockId:r,blockSubtree:a,snapshotData:l}=t;const d=Ce.G.createChildStore(i,{table:B.iU,id:r});let u;if(d.isDefined())u=d.getModel();else{const e=null==a?void 0:a.getValue({table:B.iU,id:r});u=e&&x.kk.fromBlock(e)}const p=!(i.isInsideTemplate()||on()||i.isInsideFactoryOrDuplicateBlocksAction()||null!==(n=u)&&void 0!==n&&n.isTemplateVariableContainerBlock());if(a){const t=Le.E9({environment:e,sourceBlockId:r,targetBlockPointer:{table:B.iU,spaceId:s,id:(0,W.ZP)()},sourceBlockSubtree:a,targetInMemoryRecordCache:d.inMemoryRecordCache,addCopyName:(0,pe.Z)(d),deepCopyTransclusionContainers:!1,resolveTemplateVariables:p,transaction:o,useCrdt:c}).targetBlock,n=t.getType();return n&&Ae.W(e,{from:"paste",type:n,new_page_id:"page"===n?t.id:void 0,creating_block_id:t.id,parent_collection_id:d.getParentCollectionIdUpToTwoLevels()}),t}{Se.Z.state.online||$e.showErrorMessage(ae.default.formatMessage(st.offlineError));const[t,n]=Le.WJ({environment:e,sourceBlocks:[{id:r,spaceId:(0,Z.C)(void 0)}],targetInMemoryRecordCache:d.inMemoryRecordCache,addCopyName:(0,pe.Z)(d),transaction:o,deepCopyTransclusionContainers:!1,resolveTemplateVariables:p,snapshotData:l,targetSpaceId:(0,Z.C)(s),convertExternalObjectInstancesToPlaceholders:!1,useCrdt:c}),i=t[0],a=i.getType();return n.then((t=>{t?$e.showErrorMessage(t):a&&Ae.W(e,{from:"paste",type:a,new_page_id:"page"===a?i.id:void 0,creating_block_id:i.id,parent_collection_id:d.getParentCollectionIdUpToTwoLevels()})})),i}}))),Nt({environment:e,blocks:d,transaction:o,replaceEmptyTextBlock:!0});const u=xe.default.state.stores,p=u.length>0?u:[i],m=t.blocks.map((e=>{const t=p.length>0?p[0]:function(e){return e.isCollectionView()?e.getCollectionViewCollectionStore()||e:e.getContentStore()}(i);return Ce.G.createChildStore(t,{table:B.iU,id:e.blockId})}));r.default.afterNextFlush((async()=>{await Promise.all(p.map((e=>e.waitUntil((()=>{const t=e.getType();return Boolean(t&&t!==l.Ti.copyIndicator)}))))),await Promise.all(m.map((e=>e.load()))),n&&De.RH({environment:e,blocks:p,pageSource:n,copiedStores:m,action:t.action,wasContiguousSelection:t.wasContiguousSelection,rootStore:i})&&De.kE({copiedStores:m,blocks:p,pageSource:n})}))}function qt(e){const{environment:t,disableEmbedMenu:n,transaction:o,overwrite:i,selectAll:r,markdownOptions:a,markdownLinkifyIt:s,text:l,tinyMceMicrosoftWordPasteFilter:c}=e,d=l.includes("\n"),u=Te.default.state,p=tn(u);d&&"inline"!==p||"editing"!==u.mode?i?(at("paste: pasting as markdown overwrite"),function(e){const{environment:t,text:n,transaction:o,selectAll:i,markdownOptions:r,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s}=e,l=Rt({markdown:n,markdownOptions:r,markdownLinkifyIt:a});if(!l)return;let c=Ht({html:l,wrapInEmptyBlocks:!1,tinyMceMicrosoftWordPasteFilter:s});c||(c=Ht({html:l,wrapInEmptyBlocks:!0,tinyMceMicrosoftWordPasteFilter:s}));if(!c)return;We({environment:t,clipboardData:c,transaction:o,allowPasteIntoHeaderWithoutChildren:!0,selectAll:i,developerDebug:at})}({environment:t,text:l,transaction:o,selectAll:r,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c})):l&&(at("paste: pasting as markdown append"),function(e){const{environment:t,text:n,transaction:o,markdownOptions:i,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:a}=e,s=Rt({markdown:n,markdownOptions:i,markdownLinkifyIt:r});if(s)$t({environment:t,html:s,transaction:o,tinyMceMicrosoftWordPasteFilter:a})}({environment:t,text:l,transaction:o,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c})):(at("paste: pasting as inline markdown"),function(e){const{environment:t,text:n,disableEmbedMenu:o,transaction:i,selectAll:r,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}=e,c="editing"===Te.default.state.mode&&Te.default.state.multiSelection;if(c){const e=(0,se.QY)(c);if(e&&function(e){const t=Te.default.state;return"editing"===t.mode&&!(0,se.iG)(t.multiSelection)&&(0,se.qS)(t.multiSelection)&&I.B(e,"url")}(n))rn({environment:t,text:n,transaction:i,editingSelection:e,selectAll:r});else if((0,fe.Ld)("c"))Ne.hJ({environment:t,editorMode:"default",multiSelection:c,string:n,disableMentions:!0,disableEmojiCommands:!0,disableSlashCommands:!0,transaction:i,selectAll:r});else{const e=s&&C.lM({...s,markdown:n,plugin:null==a?void 0:a.plugin});if(!e)return;Gt({environment:t,html:e,transaction:i,stripText:!1,stripSurroundingWhitespace:!1,disableEmbedMenu:o,selectAll:r,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l})}}}({environment:t,text:l,disableEmbedMenu:n,transaction:o,selectAll:r,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c}))}function Wt(e,t){const n=e.getValue({table:B.iU,id:t});if(!n)return;const o={table:B.iU,id:t,spaceId:n.space_id},i=(n.content??[]).map((t=>Wt(e,t))).filter(K.$K);return new j.mp(o,i)}function Ht(e){var t,n,o,i;const{html:r,wrapInEmptyBlocks:a,tinyMceMicrosoftWordPasteFilter:s}=e,l=Yt({html:r,tinyMceMicrosoftWordPasteFilter:s,useCrdt:!1});if(!l)return;let{allOperations:c,rootContentIds:d}=l;if(a){const e=Qt(),t=Qt();if(!e||!t)return;c=[e.operation,...c,t.operation],d=[e.id,...d,t.id]}const u=A.Ak.create();(0,M.FS)({recordMap:u,operations:c,updateOnly:!1});const p=[];for(const S of d)p.push({blockId:S,snapshotData:void 0,blockSubtree:u.clone()});const m=new j.mp({table:B.iU,id:(0,W.ZP)(),spaceId:void 0},d.map((e=>Wt(u,e))).filter(K.$K));if(0===m.children.length)return;const f=m.children[0],g=null===(t=(0,j.DY)([m],(e=>e===f)))||void 0===t?void 0:t.map((e=>e.value)),h=null===(n=u.getValue(f.value))||void 0===n||null===(n=n.properties)||void 0===n?void 0:n.title,v=(0,j.CY)(m),b=null===(o=(0,j.DY)([m],(e=>e===v)))||void 0===o?void 0:o.map((e=>e.value)),y=null===(i=u.getValue(v.value))||void 0===i||null===(i=i.properties)||void 0===i?void 0:i.title,_=y?U.QaF(y).length:0;return h&&g&&y&&b?{blockSelection:{blocks:p,wasContiguousSelection:!0,action:"copy"},tree:m,multiTextSelection:{start:{textIndex:0,copiedText:h,attributePath:["properties","title"],pointerPath:g},end:{textIndex:_,copiedText:y,attributePath:["properties","title"],pointerPath:b}},action:"copy"}:void 0}function Kt(e){const{text:t,html:n,stripText:o,stripSurroundingWhitespace:i,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:a}=e,s=n||(t?Rt({markdown:t,markdownLinkifyIt:r}):void 0);if(!s)return;const l=document.createElement("div");return l.innerHTML=Xt({html:s,tinyMceMicrosoftWordPasteFilter:a}),S.xR({node:l,window,stripText:o,stripSurroundingWhitespace:i,emojiData:te.Z.state})}function Gt(e){const{environment:t,html:n,transaction:o,stripText:i,stripSurroundingWhitespace:r,disableEmbedMenu:a,selectAll:s,markdownLinkifyIt:l,tinyMceMicrosoftWordPasteFilter:c}=e,d="editing"===Te.default.state.mode&&Te.default.state.multiSelection;if(d){const e=Kt({html:n,stripText:i,stripSurroundingWhitespace:r,markdownLinkifyIt:l,tinyMceMicrosoftWordPasteFilter:c});if(!e)return;const u=1===e.length;if(u){if(u&&(!e[0][1]||0===e[0][1].length)){at("pasteInlineHtml: insertString");const n=e[0][0];return void Ne.hJ({environment:t,editorMode:"default",multiSelection:d,string:n,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:o,selectAll:s})}const n=(0,se.QY)(d);if(n&&!(0,se.iG)(d)){const[,i]=e[0],r=i&&U.rlz(i);if(r){at("pasteInlineHtml: pasteLinkOverText");return void rn({environment:t,text:U.zW$(r),transaction:o,editingSelection:n,selectAll:s})}}}at("pasteInlineHtml: delete selection and insert"),Ne.pz({environment:t,editorMode:"default",multiSelection:d,transaction:o}),Lt({environment:t,store:d.start.store,tokens:e,index:d.start.index,transaction:o,disableEmbedMenu:a,multiTextSelection:d,selectAll:s})}}function $t(e){const{environment:t,html:n,transaction:o,tinyMceMicrosoftWordPasteFilter:i}=e,a=ne.RM();if(!a)return;const s=Yt({html:n,tinyMceMicrosoftWordPasteFilter:i,useCrdt:a.useCrdt()});if(!s)return;const{allOperations:c,rootContentIds:d}=s;for(const r of c){const e=(0,Ce.Kv)(a,r.pointer);ot.applyOperation({store:e,operation:r,transaction:o})}const u=d.map((e=>Ce.G.createChildStore(a,{table:B.iU,id:e})));u.forEach((e=>{const n=e.getType();n&&Ae.W(t,{from:"paste",type:n,creating_block_id:e.id,parent_collection_id:e.getParentCollectionIdUpToTwoLevels()})}));const p=Nt({environment:t,blocks:u,transaction:o,replaceEmptyTextBlock:!0}).slice().reverse();return r.default.afterNextFlush((()=>{const e=p.map((e=>{if(e.getType()!==l.Ti.text)return;const n=jt(e.getTitleValue());if(!n)return;const o=(0,E.Wj)({url:n.url,baseUrl:X.default.domainBaseUrl,publicDomainName:X.default.publicDomainName,isMobile:t.device.isMobile,protocol:X.default.protocol,currentUrl:window.location.href});return"page"===o.name?o:void 0})).filter(K.$K);e.length===p.length&&De._x({environment:t,rootStore:a,blocks:p,copiedLinks:e})})),u}function Qt(){const e=(0,W.ZP)(),{currentUserStore:t}=ye.default.state,n=ne.RM();if(!t||!n)return;const o=t.id;if(!o)return;const i=n.id,r=n.pointer.spaceId;return{operation:{pointer:{table:"block",id:e,spaceId:r},command:"set",path:[],args:{id:e,version:1,type:"text",properties:{title:[[""]]},parent_id:i,parent_table:"block",space_id:r,created_by_table:"notion_user",created_by_id:o,created_time:Date.now(),last_edited_by_table:"notion_user",last_edited_by_id:o,last_edited_time:Date.now(),alive:!0}},id:e}}function Yt(e){const{useCrdt:t,...n}=e,o=document.createElement("div");o.innerHTML=Xt(n);const{currentUserStore:i}=ye.default.state,r=ne.RM();if(!i||!r)return;const s=i.getValue();return s?S.$O({actor:(0,a.dp)(s),parent:{id:r.id,table:B.iU,spaceId:r.getSpaceId()},rootNode:o,deps:{importFileMap:{},window,secureFileS3Url:X.default.secureFileS3.url,secureFileS3UrlV2:X.default.secureFileS3V2.url,intl:ae.default.getIntl(),randomID:W.ZP,randomShortID:H.ZP,isPhoneNumber:en,emojiData:te.Z.state},options:{useCrdt:t,ignoreBlockCount:!1}}):void 0}function Jt(e){return/schemas-microsoft-com:office/.test(e)||/xmlns:m="http:\/\/schemas.microsoft.com\/office\/2004\/12\/omml"/.test(e)}function Xt(e){const{html:t,tinyMceMicrosoftWordPasteFilter:n}=e;return i().sanitize(n&&Jt(t)?n(t):t)}function en(e){return/^(\+\d{1,2}\s)?\(?\d{3}\)?[\s.-]\d{3}[\s.-]\d{4}$/.test(e)}function tn(e){const t="editing"===e.mode&&e.multiSelection;if(!t)return;const n=he.E.findEditableWithStore(t.start.store),o=null==n?void 0:n.props;return o&&!o.disabled?o.pasteBehavior:void 0}function nn(){if("editing"!==Te.default.state.mode)return;const e=Te.default.state.multiSelection.start,t=e.store.path;if("formula"!==t[t.length-1])return;const n=e.store.getRecordStoreAtRootPath();if(n.table!==B.iU)return;const o=n.getParentId();if(!o)return;const i={table:F.vF,id:o,spaceId:n.getSpaceId()},r=n.getRecordModel(i);return r?{parentCollection:r,start:e,getRecordModel:n.getRecordModel}:void 0}function on(){const e=xe.default.state.stores;if("editing"!==Te.default.state.mode)return e.length>0&&e[0].isInsideFactoryOrDuplicateBlocksAction();if(0===e.length)return!1;const{multiSelection:t}=Te.default.state,n=t.start.store;if(!n.isTable(B.iU))return!1;const o=ie.W(n);return Boolean(o)}function rn(e){const{text:t,transaction:n,environment:o,editingSelection:i,selectAll:r}=e,a=(0,E.Wj)({url:t,baseUrl:X.default.domainBaseUrl,publicDomainName:X.default.publicDomainName,isMobile:o.device.isMobile,protocol:X.default.protocol,currentUrl:window.location.href}),s="page"===a.name?(0,w.nR)({pageId:a.blockId,peekViewBlockId:a.peekViewBlockId,peekMode:a.peekMode,discussionId:a.discussionId,scrollToBlockId:a.scrollToBlockId,collectionViewId:a.collectionViewId}):t;Ne.Be({environment:o,store:i.store,selection:i.selection,type:"a",transaction:n}),Ne.i8({environment:o,store:i.store,selection:i.selection,annotation:["a",s],transaction:n}),ze.Z5({store:i.store,selection:{startIndex:r?i.selection.startIndex:i.selection.endIndex,endIndex:i.selection.endIndex}})}const an=/\<\!-- wp:/;const sn=/\u2028/g;function ln(e){var t;let{environment:n,event:o,disableEmbedMenu:i,transaction:r,onPasteFiles:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c}=e;if(o.preventDefault(),ze.Zk(n),!o.clipboardData)return;if(!Me.M_(n))return;const d=xt(o.clipboardData,n.device),u=Array.from(Array((null===(t=d.items)||void 0===t?void 0:t.length)??0).keys()).flatMap((e=>{var t;const n=d.items[e];if("file"!==n.kind)return[];const o=null===(t=n.getAsFile())||void 0===t||null===(t=t.name.match(/\.[^.]+$/))||void 0===t?void 0:t[0];return o?[o]:[]}));Pe.VJ(n,{source:"editor",types:d.types||[],fileExtensions:u,htmlContent:d.getData("text/html")});const{text:m,html:f,multiTextSelectionData:g,textSelectionData:h,blockSelectionData:b,isFromMicrosoftOffice:y,isHtmlTable:S}=Pt({clipboardData:d,tinyMceMicrosoftWordPasteFilter:c}),w=Mt(d,mt,yt),k=function(e){return e.clipboardData?e.clipboardData.items?q.oA(q.UI(e.clipboardData.items,(e=>{const t=e.getAsFile();if(t&&t.size>0)return new File([t],"Untitled",{type:e.type})}))):p.p4(e.clipboardData.files):[]}(o),I=tn(Te.default.state),C=(null==b?void 0:b.action)||(null==g?void 0:g.action)||(null==h?void 0:h.action);r.annotateWithUserAction("cut"===C?"paste.from_cut":oe.xF);const x=m.includes("\n"),T=function(e){const t=Mt(e,ft,_t),n=null==t?void 0:t.mode;if(!n)return;return ct[n]||"Plain Text"}(d),M=x&&T&&"inline"!==I&&!(0,fe.qK)()?function(e){const{codeLanguage:t,environment:n,transaction:o}=e,i=Te.default.state,r="editing"===i.mode&&i.multiSelection,a=xe.default.state.stores;if(!r&&0===a.length)return;let s,c,d;r?(s=r.start.store,c=r.end.store,d=(0,ue.sQ)(c)):(s=a[0],c=a[a.length-1],d=c);if(!d)return;let u=d;if((0,de.PF)(d))!function(e){const{block:t,environment:n,transaction:o,codeLanguage:i}=e;qe.Cj({environment:n,blocks:[t],blockType:"code",transaction:o}),Ge.E5({blocks:[t],language:i,transaction:o})}({block:d,environment:n,transaction:o,codeLanguage:t});else{const e=(0,ue.sQ)(d);if(!e)return;const t=s.inMemoryRecordCache;if(!t)return;u=Je.j4({environment:n,type:l.Ti.code,inMemoryRecordCache:t,transaction:o,spaceId:e.pointer.spaceId,useCrdt:e.useCrdt()}),Q.BE({parent:e.getContentStore(),after:c,insert:u,transaction:o})}me.clear(n);const p=(0,ue.mh)(u);p&&ze.N_({store:p});return u}({codeLanguage:T,environment:n,transaction:r}):void 0;Re.bO(n,{pastedText:m,source:"editor_paste"});const P=ve.g$.getSimpleTableCellFromTextSelection(),A=o.clipboardData.getData(Y.mH),R=nn();if(k.length>0&&!y&&!S)at("paste: file/image detected -> onPasteFiles"),a({environment:n,files:k,transaction:r});else if("body"!==(0,fe.qK)()||h)if(M)at("paste: pasting code in existing empty text block with no selection or new code block after selection  -> pasteRawText"),cn(n,m,r);else if(R){at("paste: formulaInformation detected, attempting to paste as formula");const{parentCollection:e,start:t}=R,o=[[m]],i=e;if(!i)return void cn(n,m,r);const a=Te.default.state;"multiSelection"in a&&Ne.pz({environment:n,editorMode:"default",multiSelection:a.multiSelection,transaction:r});const s=(0,v.UQ)(o,i,R.getRecordModel);Ne.mM({environment:n,tokens:s,store:t.store,index:t.index,transaction:r})}else if("plaintext"===I)at("paste: plaintext paste behavior detected, pasting as inline html"),Gt({environment:n,html:m,transaction:r,stripText:!0,stripSurroundingWhitespace:!0,disableEmbedMenu:i,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c});else if(g){at("paste: multiTextSelectionData detected, attempting to paste as textselection");const e=function(e){const{environment:t,transaction:n,multiTextSelectionData:o,disableEmbedMenu:i,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:a}=e,s=e.pasteBehavior||"inline",l=e.html||Rt({markdown:e.text,markdownLinkifyIt:r});if("editing"===Te.default.state.mode)switch(s){case"inline":return!!l&&(Gt({environment:t,html:l,transaction:n,stripText:!1,stripSurroundingWhitespace:!0,disableEmbedMenu:i,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:a}),!0);case"block":return We({environment:t,clipboardData:o,transaction:n,developerDebug:at});default:(0,K.t1)(s)}}({multiTextSelectionData:g,environment:n,html:f,text:m,transaction:r,disableEmbedMenu:i,pasteBehavior:I,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c});e||(at("paste: could not paste as textSelection -> paste as blockSelection"),zt(n,g.blockSelection,w,r))}else if(h&&h.editing)at("paste: textSelectionData detected, pasting text selection"),function(e){const{environment:t,textSelectionData:n,transaction:o,disableEmbedMenu:i}=e,r=xe.default.getCurrentRecordCache(),{editing:a,selection:s}=n;let{tokensInsideRange:c}=U.xrQ(a,s.startIndex,s.endIndex);c=U.V3g(c,{removeSuggestions:!0,removeDiscussions:!0});const d=(0,ne.RM)();if(d&&!(d.isInsideTemplate()||on()||d.isInsideFactoryOrDuplicateBlocksAction())&&(c=U.KV2(c,{currentUserId:t.currentUser.id,currentTimeZone:(0,_.r)()})),"body"===(0,fe.qK)()){const e=U.vNd(c);e&&(c=e)}const u="editing"===Te.default.state.mode&&Te.default.state.multiSelection;if(u){Ne.pz({environment:t,editorMode:"default",multiSelection:u,transaction:o});const e=Te.default.state;if("editing"===e.mode){const r=e.multiSelection;if(n.blockType&&0===s.startIndex){const e=(0,ue.sQ)(r.start.store);e&&"page"!==n.blockType&&(0,de.PF)(e)&&qe.Cj({environment:t,blocks:[e],blockType:n.blockType,transaction:o})}Lt({environment:t,store:r.end.store,tokens:c,index:r.end.index,transaction:o,disableEmbedMenu:i,multiTextSelection:u})}}else if(r){var p,m;const e=xe.default.state.stores,n=Je.j4({environment:t,type:l.Ti.text,inMemoryRecordCache:r,transaction:o,spaceId:0!==e.length?e[e.length-1].pointer.spaceId:null===(p=ne.RM())||void 0===p?void 0:p.pointer.spaceId,useCrdt:0!==e.length?e[e.length-1].useCrdt():(null===(m=ne.RM())||void 0===m?void 0:m.useCrdt())??!1}),i=n.getTitleStore();i&&Ne.mM({environment:t,store:i,tokens:c,index:0,transaction:o}),Nt({environment:t,blocks:[n],transaction:o,replaceEmptyTextBlock:!1}),Ae.W(t,{from:"paste",type:l.Ti.text,creating_block_id:n.id,parent_collection_id:n.getParentCollectionIdUpToTwoLevels()})}}({environment:n,textSelectionData:h,transaction:r,disableEmbedMenu:i});else if(b&&b.blocks.length>0&&"inline"!==I)at("paste: blockSelectionData detected, pasting block selection"),zt(n,b,w,r);else if(P&&A){const{simpleTableStore:e,selection:t}=P.getProps(),i=ve.g$.getColumnOrder(e);t&&i&&nt.j0({environment:n,simpleTableStore:e,selection:t,currentRows:e.getContentStores(),columnOrder:i,event:o,transaction:r,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c})}else if(f)if(P){const{simpleTableStore:e,selection:t}=P.getProps(),i=ve.g$.getColumnOrder(e);t&&i&&(at("paste: pasting selection into simple table"),nt.j0({environment:n,simpleTableStore:e,selection:t,currentRows:e.getContentStores(),columnOrder:i,event:o,transaction:r,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c}))}else(x||S)&&"inline"!==I?(at("paste: pasting as html"),$t({environment:n,html:f,transaction:r,tinyMceMicrosoftWordPasteFilter:c})):(at("paste: pasting as inline html"),Gt({environment:n,html:f,transaction:r,stripText:!1,stripSurroundingWhitespace:!1,disableEmbedMenu:i,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c}));else at("paste: pasting as markdown"),qt({environment:n,text:m,disableEmbedMenu:i,transaction:r,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c});else at("paste: editing code block contents with no Notion text selection -> pasteRawText"),cn(n,m,r);Ie.Z.setKeyboardMode(!0)}function cn(e,t,n){const o="editing"===Te.default.state.mode&&Te.default.state.multiSelection;o&&Ne.hJ({environment:e,editorMode:"default",multiSelection:o,string:t,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:n})}function dn(e){const t=e.getNavigableBlockStore();if(t)return(0,re.Hu)({store:t,scrollToBlockId:t.id===e.id?void 0:e.id,fullyQualified:!0,pageVisitSource:s.tY.CopyLink})}function un(e){const{environment:t,blocks:n}=e,o=n[0];J.wG(),ve.HM.clearSelection();const i=dn(o);if(i){hn({environment:t,stringValue:i,copiedMessage:o.isPageBlock()?lt.copiedLinkToClipboard:lt.copiedBlockLinkToClipboard})}}function pn(e){const{environment:t,blocks:n}=e,o=n[0];J.wG(),ve.HM.clearSelection();const i=dn(o),r=function(e,t){var n;const o=dn(t);if(!o)return;const i=e.currentUser.id,r=(0,f.Ho)({blockId:t.id,intl:ae.default.getIntl(),getRecordValue:t.inMemoryRecordCache.makeGetRecordValueFn(i),userTimeZone:(0,_.r)()}),a=null===(n=t.getBlockIconStore())||void 0===n?void 0:n.getValue(),s=[(0,k.Z)(a)?a:void 0,r].filter(K.$K).join(" ");return s?`<a href="${o}"><span>${s}</span></a>`:o}(t,o);if(i&&r){gn({environment:t,stringValue:i,htmlValue:r,copiedMessage:lt.copiedLinkToClipboard})}}function mn(e){const{environment:t,blocks:n}=e;if(n.length<2)return un(e);J.wG(),ve.HM.clearSelection();const o=n.map(dn).filter(K.$K);if(o.some(Boolean)){const e=o.length>1?lt.copiedLinksToClipboard:lt.copiedLinkToClipboard;hn({environment:t,stringValue:o.join("\n\n"),copiedMessage:e})}}function fn(e){const{environment:t,blocks:n}=e,o=n[0];if(!o.isDefined())return;const i=o.getModel(),r=o.getProperties(),a=o.getFormat();let s;if(o.isType(l.Ti.bookmark))s=null==r?void 0:r.link,s=U.QaF(s);else if(i.isType(l.Ok))s=null==r?void 0:r.source,s=U.QaF(s);else if(o.isType(l.Ti.file))s=null==r?void 0:r.source,s=U.QaF(s);else if(o.isType(l.Ti.externalObjectInstance)||o.isType(l.Ti.externalObjectInstancePage))s=(null==a?void 0:a.original_url)||(null==a?void 0:a.uri);else if(o.isType(l.Ti.collectionView)){var c;const e=null===(c=o.getCollectionViewCollectionStore())||void 0===c?void 0:c.getValue();var d;if(e&&(0,g.Gq)(e))s=null===(d=e.format)||void 0===d?void 0:d.original_url}else{if(!o.isType(l.Ti.alias))return;s=null==a?void 0:a.comment_alias_url}if(!s)return;if(h.E$(s,[X.default.secureFileS3.url,X.default.secureFileS3V2.url]))return void b.log({level:"error",from:"clipboardActions",type:"copyDirectLinkToContent",error:{message:"Attempted to copy a direct signed url for S3-housed content."}});if(s=G.yn(s),!s)return;J.wG(),ve.HM.clearSelection();hn({environment:t,stringValue:s,copiedMessage:lt.copiedLinkToClipboard})}function gn(e){return vn(e)}function hn(e){return vn(e)}async function vn(e){const{environment:t,htmlValue:n,stringValue:o,copiedMessage:i,showCopyModal:r}=e;function a(){et.ZH(t),_e.Z.setState({..._e.Z.state,active:!0,stringValue:o})}if(r)a();else try{if("undefined"==typeof ClipboardItem)await navigator.clipboard.writeText(o);else{const e={"text/plain":new Blob([o],{type:"text/plain"})};n&&(e["text/html"]=new Blob([n],{type:"text/html"}));const t=new ClipboardItem(e);await navigator.clipboard.write([t])}tt.oV({label:ae.default.formatMessage(i)})}catch{a()}}function bn(){document.queryCommandSupported("copy")&&document.execCommand("copy")}async function yn(e,t){let n;n="string"==typeof t?t:JSON.stringify(t),n&&await hn({environment:e,stringValue:n,copiedMessage:lt.copiedToClipboard})}function _n(e){const{environment:t,textSelection:n,markdownSerializationOptions:o,markdownLinkifyIt:i}=e,r=(0,se.QY)(n);if(r&&r.selection.startIndex!==r.selection.endIndex)return function(e){const{environment:t,singleStoreTextSelection:n,markdownSerializationOptions:o}=e,{store:i,selection:r}=n,a=t.currentUser.id,l=i.inMemoryRecordCache,c=ae.default.getIntl(),u=i.getValue(),p=U.KU1(u,r.startIndex,r.endIndex),m=i.getRecordStoreUIRoot().getValue();if(!m)return;const f={id:m.id,table:B.iU,spaceId:m.space_id},g=l.makeGetRecordValueFn(a);return C.CK({textValue:p,exportArgs:{root:f,navigableBlockId:f.id,renderParentBlockId:void 0,blockId:f.id,userTimeZone:(0,_.r)(),intl:c,getRecordValue:g,numberedListCache:{},bulletedListCache:{},getRecordsWithParent:()=>[],getExportedPathToFile:e=>{let{toFileURI:t}=e;return t},getExportedRenderAsset:e=>{let{toFileURI:t}=e;return t},getExportedPathToPage:e=>{let{toPageId:t}=e;return(0,d.Z)({pageId:t,pageValue:g({table:B.iU,id:t}),baseUrl:X.default.domainBaseUrl,pageVisitSource:s.tY.Export})},baseUrl:X.default.domainBaseUrl,publicDomainName:X.default.publicDomainName,transformAnnotation:null==o?void 0:o.transformAnnotation,transformBlockMapping:null==o?void 0:o.transformBlockMapping,resultCache:new Map}})}({environment:t,singleStoreTextSelection:r,markdownSerializationOptions:o});const a=Bt({environment:t,multiSelection:n,action:"copy"});if(!a)return;const l=n.start.store.inMemoryRecordCache,c=n.start.store.getRecordStoreUIRoot().getValue();if(!c)return;const u=t.currentUser.id,{markdown:p}=(0,oe.Ef)({clipboardData:a,rootBlock:{id:c.id,table:B.iU,spaceId:c.space_id},isWindows:t.device.isWindows,fallbackGetRecordValue:l.makeGetRecordValueFn(u),markdownSerializationOptions:o,markdownLinkifyIt:i});return p}function Sn(e){const{environment:t,inMemoryRecordCache:n,text:o,transaction:i,markdownOptions:r,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l,useCrdt:c}=e,d=Rt({markdown:o,markdownOptions:r,markdownLinkifyIt:s});if(!d)return;const u=document.createElement("div");u.innerHTML=Xt({html:d,tinyMceMicrosoftWordPasteFilter:l});const{currentUserStore:p,currentSpaceStore:m}=ye.default.state;if(!p||!m)return;const f=p.getValue();if(!f)return;const g=(ne.RM()??m).id,{allOperations:h,rootContentIds:v}=S.$O({actor:(0,a.dp)(f),parent:{id:g,table:B.iU,spaceId:m.id},rootNode:u,deps:{importFileMap:{},window,secureFileS3Url:X.default.secureFileS3.url,secureFileS3UrlV2:X.default.secureFileS3V2.url,intl:ae.default.getIntl(),randomID:W.ZP,randomShortID:H.ZP,isPhoneNumber:en,emojiData:te.Z.state},options:{ignoreBlockCount:!1,useCrdt:c}});for(const a of h){const e=new Ce.ST({environment:t,pointer:a.pointer,inMemoryRecordCache:n,userId:f.id});ot.applyOperation({store:e,operation:a,transaction:i})}return v.map((e=>new Ce.G(t,{table:B.iU,id:e},{inMemoryRecordCache:n})))}function wn(e){const{environment:t,stores:n,listId:o,inMemoryRecordCache:i,transaction:r}=e,a=new Ce.ST({environment:t,pointer:{table:B.iU,id:o||(0,W.ZP)()},inMemoryRecordCache:i,userId:t.currentUser.id,path:["content"]});for(const s of n)Q.R3({parent:a,append:s,transaction:r}),Je.sW({store:s,data:{parent_id:a.id,parent_table:a.table,alive:!0},transaction:r});return a}},42274:(e,t,n)=>{n.d(t,{XQ:()=>u,Cn:()=>p,pZ:()=>d,E5:()=>c});const o={TypeScript:async()=>({plugins:[(await n.e(8182).then(n.t.bind(n,90119,23))).default],parser:"babel"}),JavaScript:async()=>({plugins:[(await n.e(8182).then(n.t.bind(n,90119,23))).default],parser:"babel"}),GraphQL:async()=>({plugins:[(await n.e(214).then(n.t.bind(n,80214,23))).default],parser:"graphql"}),HTML:async()=>({plugins:[(await n.e(2237).then(n.t.bind(n,72237,23))).default],parser:"html"}),CSS:async()=>({plugins:[(await n.e(8089).then(n.t.bind(n,45657,23))).default],parser:"css"}),Scss:async()=>({plugins:[(await n.e(8089).then(n.t.bind(n,45657,23))).default],parser:"scss"}),JSON:async()=>({plugins:[(await n.e(8182).then(n.t.bind(n,90119,23))).default],parser:"json"}),XML:async()=>({plugins:[await Promise.all([n.e(9236),n.e(4219)]).then(n.t.bind(n,84219,23))],parser:"xml",prettierOptionsOverride:{xmlWhitespaceSensitivity:"ignore"}}),Rust:async()=>({plugins:[await Promise.all([n.e(9236),n.e(3411)]).then(n.bind(n,73411))],parser:"jinx-rust"})};var i=n(70203),r=n(96802),a=n(9953),s=n(993),l=n(13447);function c(e){const{blocks:t,language:n,transaction:o}=e,r=i.TPx(n);for(const i of t)a.sW({store:i.getPropertiesStore(),data:{language:r},transaction:o})}function d(e){const{environment:t,blocks:n,previewFormat:o}=e;l.createAndCommit({userAction:"codeBlockActions.setPersistedCodePreviewFormat",environment:t,perform:e=>{r.FH({stores:n,update:{code_preview_format:o},transaction:e})}})}async function u(e){const{codeSnippet:t,language:i}=e,r=o[i];if(!r)return;const{parser:a,plugins:s,prettierOptionsOverride:l}=await r();let c="";try{c=(await n.e(3945).then(n.t.bind(n,73945,23))).format(t,{parser:a,plugins:s,...l})}finally{if(!c||c===t)return}return c=function(e){const t=e.split("\n");t.length>0&&""===t[t.length-1].trim()&&t.pop();return t.join("\n")}(c),c}async function p(e){const{codeBlock:t,environment:n}=e,{title:o,language:r}=t.getProperties(),a=i.QaF(o);if(!a||0===a.length)return;const c=i.QaF(r),d=await u({codeSnippet:a,language:c});if(!d)return;const p=i.TPx(d);l.createAndCommit({userAction:"codeBlockActions.formatCode",environment:n,perform:e=>{s.sO({environment:t.environment,editorMode:"default",store:t.getBlockTitleStore(),value:p,transaction:e})}})}},74882:(e,t,n)=>{n.d(t,{K:()=>a});var o=n(68626),i=n(6287),r=n(54642);async function a(e){const{environment:t,collectionStore:n}=e,a={id:n.id,table:i.vF,spaceId:n.getSpaceId()},s=await r.suggestRecordKey(t,{...a,shouldSetSuccessfullySuggestedRecord:!0});if("success"===s.type)return s.data.key;o.log({level:"error",from:"collectionAutoIncrementIdActions.suggestRecordKeyResponse",type:"JSONParseError",error:{miscDataString:s.error.message}})}},34993:(e,t,n)=>{n.d(t,{mO:()=>w,Ys:()=>k,k7:()=>I,ul:()=>M,iU:()=>C,RD:()=>T,_x:()=>x});n(67294);var o=n(1302),i=n(76205),r=n(14714),a=n(53965),s=n(1898),l=n(64964),c=n(75330),d=n(480),u=n(9291),p=n(52423),m=n(6854),f=n(85893);function g(){return(0,f.jsx)(u.FormattedMessage,{defaultMessage:"Changes saved for everyone.",id:"database.filterBar.saved.title"})}function h(e){const{collectionContextStore:t,temporaryState:n}=e,o=(0,d.O7)();return(0,f.jsx)(m.Pn,{onClick:()=>{p.Yw(o,!0),l.rN(),C({environment:o,collectionContextStore:t,temporaryState:n})},children:(0,f.jsx)(u.FormattedMessage,{defaultMessage:"Undo",id:"database.filterBar.undo.title"})})}var v=n(97004),b=n(80444),y=n(5149),_=n(13447),S=n(37181);let w=function(e){return e[e.All=0]="All",e[e.Filters=1]="Filters",e[e.Sorts=2]="Sorts",e}({});function k(e){const{environment:t,collectionContextStore:n,targetCollectionView:o,preventSnackbarNotification:i,type:r,transaction:a}=e,s=n.temporaryState.state,d=n.currentPropertyFiltersStore.state,u=o.getPropertyFiltersStore(),p=(0,v.Zh)(n,"persisted");if(r===w.All||r===w.Filters){p.combinatorFilter&&c.Es({collectionViewStore:o,update:{filter:p.combinatorFilter.value||null},transaction:a});for(const e of p.filters.removed)_.applyOperation({store:u,operation:{pointer:u.pointer,command:"keyedObjectListRemove",path:u.path,args:{remove:{id:e}}},transaction:a});for(const{id:e,beforeId:t}of p.filters.moveOps){const n=d.find((t=>t.id===e));n&&(t?_.applyOperation({store:u,operation:{pointer:u.pointer,command:"keyedObjectListBefore",path:u.path,args:{before:{id:t},value:n}},transaction:a}):_.applyOperation({store:u,operation:{pointer:u.pointer,command:"keyedObjectListAfter",path:u.path,args:{value:n}},transaction:a}))}for(const e of p.filters.updated){const t=d.find((t=>t.id===e));t&&_.applyOperation({store:u,operation:{pointer:u.pointer,command:"keyedObjectListUpdate",path:u.path,args:{value:t}},transaction:a})}}r!==w.All&&r!==w.Sorts||!p.sorts||c.Es({collectionViewStore:o,update:{sort:p.sorts.value||null},transaction:a}),x({environment:t,collectionContextStore:n,temporaryState:r===w.All?void 0:r===w.Filters?{...s,combinatorFilter:void 0,propertyFilters:void 0}:{...s,sorts:void 0}}),i||l.oV({label:(0,f.jsx)(g,{}),right:(0,f.jsx)(h,{collectionContextStore:n,temporaryState:s})})}function I(e){const{environment:t,intl:n,collectionContextStore:i,transaction:r}=e,a=i.collectionViewStore(),s=i.isFullScreen.state,l=i.isRootChild.state,d=i.isInPeekRenderer.state;if(!a)return;const u=c.tG({environment:t,collectionContextStore:i,collectionViewStore:a,intl:n,collectionSettingsStore:i.settingsStore,transaction:r});u&&(k({environment:t,type:w.All,collectionContextStore:i,targetCollectionView:u,transaction:r}),u&&(c.f8({environment:t,collectionContextStore:i,collectionViewId:u.id,isFullScreen:s,isRootChild:l,isInPeekRenderer:d}),o.default.afterNextFlush((()=>{y.r$({collectionContextStore:i,collectionSettingsStore:i.settingsStore,selectViewNameInitial:!0})}))))}function C(e){x(e),function(e){const{environment:t,collectionContextStore:n}=e,o=n.collectionViewStore();if(!o)return;n.blockIsPrivateStore.state&&n.permissionScopes.state.canConfigureBlock&&_.createAndCommit({userAction:"collectionFilterActions.applyTemporaryStateIfPrivate",environment:t,perform:e=>{k({environment:t,collectionContextStore:n,type:w.All,targetCollectionView:o,preventSnackbarNotification:!0,transaction:e})}})}(e)}function x(e){const{environment:t,collectionContextStore:n,temporaryState:o}=e,i=n.collectionViewStore();if(!i)return;const r=t.currentUser.id;n.temporaryState.setState(o||{}),c.bu({currentUserId:r,collectionViewId:i.id,temporaryState:o}),n.groupsStore.resetAllLimits()}function T(e){const{environment:t,seen:n}=e,{currentUserSettingsStore:o}=b.default.state;o&&_.createAndCommit({userAction:"collectionFilterActions.setSeenFiltersIntroTooltip",environment:t,perform:e=>{S.d2({userSettingsStore:o,transaction:e,data:{seen_filters_tooltip:n}})}})}function M(e){var t;let{transaction:n,newGroups:o,collectionContextStore:l,environment:c}=e;const d=l.collectionViewStore(),u=l.currentCombinatorFilterStore.state,p=(0,a.Xh)(u),m=null==p||null===(t=p.filters)||void 0===t?void 0:t.find(i.s9),f=(0,v.yU)(l);if(!(d&&p&&p.filters&&m))return;const g=m.filter.value.filter((e=>"exact"===e.type)).map((e=>e.value)).filter(s.$K),h=o.map((e=>e.value)).filter(r.tL).map((e=>e.value)).filter(r.RA).map((e=>e.id)),b=(0,a.zu)(h,...g);0!==b.length&&(m.filter.value=[...m.filter.value,...b.map((e=>({type:"exact",value:e})))],x({environment:c,collectionContextStore:l,temporaryState:{...l.temporaryState.state,combinatorFilter:{value:p}}}),f||k({environment:c,collectionContextStore:l,type:w.Filters,targetCollectionView:d,preventSnackbarNotification:!0,transaction:n}))}},54569:(e,t,n)=>{n.d(t,{$D:()=>we,$T:()=>ae,A6:()=>ge,Ab:()=>ce,BN:()=>ie,BO:()=>me,ID:()=>Me,IW:()=>fe,Od:()=>re,V$:()=>Ie,by:()=>de,hz:()=>he,iE:()=>ve,mp:()=>se,o3:()=>Se,tH:()=>Te,tQ:()=>ue,uo:()=>Ce,w$:()=>xe,yk:()=>be});n(57658);var o=n(15145),i=n(92996),r=n(41432),a=n(14248),s=n(14714),l=n(99036),c=n(93824),d=n(43593),u=n(42875),p=n(15157),m=n(21202),f=n(6287),g=n(23867),h=n(70203),v=n(95371),b=n(9291),y=n(53965),_=n(1898),S=n(75330),w=n(10906),k=n(21100),I=n(27105),C=n(28020),x=n(97004),T=n(75079),M=n(92918),P=n(65183),A=n(77181),R=n(33929),D=n(18245),E=n(80444),B=n(55367),F=n(6258),O=n(8406),Z=n(952),V=n(54642),U=n(34993),L=n(98834),j=n(30188),N=n(47307),z=n(42239),q=n(31781),W=n(96802),H=n(94419),K=n(19785),G=n(9953),$=n(79978),Q=n(26999),Y=n(42858),J=n(24677),X=n(64964),ee=n(13447),te=n(27370),ne=n(37181);const oe=(0,b.defineMessages)({removeSortingConfirmation:{id:"databaseActions.removeSortingConfirmationDialog.prompt",defaultMessage:"Would you like to remove sorting?"},removeSortingButton:{id:"databaseActions.removeSortingConfirmationDialog.removeSortingButton.label",defaultMessage:"Remove"},removeSortingCancel:{id:"databaseActions.removeSortingConfirmationDialog.cancelRemoveSortingButton.label",defaultMessage:"Don't remove"}});function ie(e){const{store:t,groupsPointer:n,environment:o,collectionContextStore:i,transaction:r}=e;if(!t.isDefined())return;const s=i.normalizedSchemaStore.state,l=i.relativeVariableStore.state,c=new Map;for(const d of n){const e=a.ND({block:t.getModel(),schema:s,propertyMapping:void 0,userFilterContext:{userId:o.currentUser.id,userTimeZone:(0,u.r)(),userStartOfWeek:C.AK.state},group:d,getRecordModel:t.getRecordModel,intl:R.default.getIntl(),relativeVariableResult:l,resultCache:c});Pe({environment:o,blockStore:t,properties:e,transaction:r})}}function re(e){const{store:t,transaction:n}=e;K.hh({childStore:t,transaction:n})}function ae(e){var t,n;const{environment:o,collectionContextStore:i,before:r,insertStores:a,store:s,groupsPointer:l,transaction:c}=e,d=i.collectionViewStore(),u=(null===(t=i.groupsStore.getGroupState(l))||void 0===t?void 0:t.resultsStore.state)||[],p=null===(n=i.groupsStore.getGroupState(l))||void 0===n?void 0:n.groupUiParentStore;if(!p)return[];const f=[];for(const b of a){const t=e.collectionStore??b.getAssociatedCollectionStore();t&&(se({environment:o,store:b,collectionStore:t,collectionContextStore:i,groupsPointer:l,shouldCoerce:!0,transaction:c}),f.push(F.G.createChildStore(p,{table:m.iU,id:b.id})))}const g=u.indexOf(s),h=r?g:g+1,v=[...u.slice(0,h),...f,...u.slice(h)];return d&&le({resultIds:v.map((e=>e.id)),collectionViewStore:d,collectionContextStore:i,transaction:c}),i.groupsStore.setLimitIfGreater(l,v.length),f}function se(e){var t;const{environment:n,store:o,collectionStore:i,collectionContextStore:s,groupsPointer:c,transaction:d,shouldCoerce:p,alreadyMovedToCollection:m}=e,f=i.getSchema(),g=i.getParentBlockStore(),h=g&&g.isNonEditableState();let v=!p;const b=(null==s||null===(t=s.groupsStore.getGroupState(c))||void 0===t?void 0:t.resultsStore.state)||[];if(o.isDefined()){var _,k;const e=m?(0,l.Kc)(R.default.getIntl()):o.getSchema()||{},t=null===(_=o.getAssociatedCollectionStore())||void 0===_?void 0:_.getDatabaseType(),r=i.getDatabaseType(),s=void 0!==t&&t===r,c=a.Xq({blockProperties:o.getProperties(),oldSchema:e,oldPropertyMapping:null===(k=o.getAssociatedCollectionStore())||void 0===k?void 0:k.getPropertyMapping(),newPropertyMapping:i.getPropertyMapping(),newSchema:f,typesMatch:s});c.propertyUpdate&&Pe({environment:n,blockStore:o,properties:c.propertyUpdate,transaction:d}),y.Xy(f,c.newSchema)||h||!w.eD({collectionStore:i,collectionViewBlockStore:g,checkNavigableAncestorLocked:!1})||S.Rm({environment:n,collectionStore:i,update:{schema:c.newSchema},transaction:d})}if(o.getType()===r.Ti.page||o.getType()===r.Ti.collectionViewPage&&o.isAssociatedCollectionAPageTree()||i.isPageTreeCollection()||o.getType()===r.Ti.copyIndicator||o.getType()===r.Ti.externalObjectInstancePage||G.sW({store:o,data:{type:r.Ti.page},transaction:d}),s){if(s.collectionViewStore()){const e=o.getModel(),t=s.relativeVariableStore.state,r=(0,x.ze)(s,!1);if(e&&p){const l=o.getAssociatedCollectionStore()??i,p="collectionTypedView"===s.contextType&&l?l.getSchema():s.normalizedSchemaStore.state,m=a.RA({block:e,schema:p,propertyMapping:i.getPropertyMapping(),filter:r,userFilterContext:{userId:n.currentUser.id,userTimeZone:(0,u.r)(),userStartOfWeek:C.AK.state},relativeVariableResult:t,groupsPointer:c,getRecordModel:i.getRecordModel,intl:R.default.getIntl(),resultCache:new Map});Pe({environment:n,blockStore:o,properties:m.update,transaction:d}),v=m.coercionSucceeded}}}const I="collectionTypedView"===(null==s?void 0:s.contextType)&&w.fm(o)===s;if(m||I?ee.applyOperation({store:o,operation:{pointer:o.pointer,path:["alive"],command:"set",args:!0},transaction:d}):K.zw({childStore:o,parentStore:i,transaction:d}),s&&s.resultSet.addLocalChange([o.id]),s){var T;const e=null===(T=s.groupsStore.getGroupState(c))||void 0===T?void 0:T.currentLimit;if(e){const t=e.state,n=b.find((e=>e.id===o.id));b.length>=t&&!n&&e.setState(b.length+1)}}return v}function le(e){const{resultIds:t,collectionViewStore:n,collectionContextStore:o,transaction:i}=e,r=n.getPageSortStore(),a=r.getValue()||[],{beforeOps:s}=(0,c.q)(a,t.slice(0,l.gq));for(const[l,c]of Object.entries(s))if(c){const e=(0,F.Kv)(n,{table:m.iU,id:c});H.Vt({parent:r,insert:(0,F.Kv)(n,{table:m.iU,id:l}),before:e,transaction:i})}else{const e=t.findIndex((e=>e===l)),o=t[e-1],a=o?(0,F.Kv)(n,{table:m.iU,id:o}):void 0;H.BE({parent:r,insert:(0,F.Kv)(n,{table:m.iU,id:l}),after:a,transaction:i})}!function(e){const{collectionContextStore:t,collectionViewStore:n,transaction:o}=e,i=n.getPageSortStore(),r=i.getValue(),a=t.groupsStore.getAllGroupStates(),s=new Set(a.flatMap((e=>e.resultsStore.state.map((e=>e.id))))),c=function(e){const{pageSort:t,currentResults:n}=e;if(!t||t.length<=l.gq)return[];const o=t.filter((e=>!n.has(e))),i=y.jj([...o.reverse(),...y.d9(t).reverse()]).slice(0,t.length-l.gq);return i}({pageSort:r,currentResults:s});for(const l of c)H.Od({parent:i,childToRemove:(0,F.Kv)(i,{table:m.iU,id:l}),transaction:o})}({collectionContextStore:o,collectionViewStore:n,transaction:i})}function ce(e){const{environment:t,collectionStore:n,duplicate:o,droppedStores:i,transaction:r,duplicateUseCrdt:a}=e,{movedStores:s,reparentedStores:l}=i.reduce(((e,t)=>(o||t.getAssociatedCollectionId()!==(null==n?void 0:n.id)?e.reparentedStores.push(t):e.movedStores.push(t),e)),{movedStores:[],reparentedStores:[]});return[...s,...z.LQ({environment:t,droppedStores:l,duplicate:o,duplicateUseCrdt:a,transaction:r,resolveTemplateVariables:!1})]}function de(e){var t,n,o;const{environment:r,collectionStore:a,targetStore:s,droppedDirection:c,droppedStores:d,transaction:u,duplicate:p,collectionContextStore:g,groupsPointer:h,subitemPath:b}=e,_=g.collectionViewStore();if(!_)return;if(!(null===(t=g.groupsStore.getGroupState(h))||void 0===t?void 0:t.groupUiParentStore))return;const S=(null===(n=g.groupsStore.getGroupState(h))||void 0===n?void 0:n.resultsStore.state)||[],w=d.every((e=>e.isExternalObjectInstancePageBlockStore()))&&!(null!=a&&a.isSyncedCollection()&&(null===(o=d[0])||void 0===o?void 0:o.getParentId())===(null==a?void 0:a.id))||p;if(c===B.vh.Onto){if(J.ZH(r),!w&&(0,I.iG)(s,d))return void X.oV({label:(0,I.s8)(s)});const e=s.getContentStore(),t=ce({environment:r,droppedStores:d,duplicate:w,duplicateUseCrdt:s.useCrdt(),transaction:u,collectionStore:a});for(const n of t)H.R3({parent:e,append:n,transaction:u});return[]}let k=!1,C=[];if(!w&&a){const e=function(e){const{environment:t,droppedStores:n,collectionStore:o,transaction:i}=e;if(!n.length)return;const r=Se({environment:t,stores:n,spaceId:o.getSpaceId(),transaction:i});for(const a of r){if(a.getParentTable()===f.vF||a.getAssociatedCollectionStore())return;if(!K.zw({childStore:a,parentStore:o,transaction:i}))return}return r}({environment:r,droppedStores:d,collectionStore:a,transaction:u});k=void 0!==e,C=e??[]}const x=g.groupsStore.getAllGroupStates();d.forEach((e=>{const t=x.find((t=>t.resultsStore.state.includes(e)));t&&ie({environment:r,store:e,collectionContextStore:g,groupsPointer:t.groupsPointer,transaction:u})}));const T=ce({environment:r,droppedStores:d,duplicate:w,duplicateUseCrdt:"same_as_store",transaction:u,collectionStore:a});k||(C=Se({environment:r,stores:T,spaceId:s.getSpaceId(),transaction:u})),u.postSubmitCallbacks.push((async e=>{!e&&a&&await j.YE({droppedStores:d,createdStores:T,collectionStore:a,environment:r,collectionContextStore:g,groupsPointer:h,alreadyMovedToCollection:k,shouldDuplicate:w})}));const M=(0,A.Af)([...(null==b?void 0:b.map((e=>e.value.store.pointer)))??[]]),P=g.subitemExpandedStore.state.get(M),R=b&&b.length>1||(null==P?void 0:P.isExpanded)&&c===B.vh.Below;for(const i of C){const e=a??i.getAssociatedCollectionStore();e&&se({environment:r,store:i,collectionStore:e,collectionContextStore:g,groupsPointer:Boolean(R)?[]:h,shouldCoerce:!0,transaction:u,alreadyMovedToCollection:k})}a&&function(e){var t,n;const{environment:o,isInsertingAsSubitem:i,shouldDuplicate:r,collectionContextStore:a,collectionStore:s,droppedStores:c,wrappedStores:d,targetSubitemExpandedState:u,subitemPath:p,targetStore:m,transaction:f}=e,g=a.currentSubitemFormatStoreForCollection.state,h=null==g?void 0:g.inverse,b=h&&a.normalizedSchemaStore.state[h],y=null==g?void 0:g.property,_=y&&a.normalizedSchemaStore.state[y],S=null===(t=a.collectionViewStore())||void 0===t?void 0:t.getType(),w=null===(n=a.collectionViewStore())||void 0===n?void 0:n.getFormat(),k=(null==w?void 0:w.subitem_display_mode)??"show",I=g&&S&&(0,A.Av)(S)&&b&&(0,l.p_)(b)&&"flattened"!==k,C=(0,A.g0)(c[0]);null!=C&&C.subitemFormat&&g&&_&&(0,l.p_)(_)&&j.i6({blocksToDuplicate:[...c],duplicatedBlocks:[...d],environment:o,shouldDuplicate:r,originSubitemFormat:C.subitemFormat,destinationSubitemFormat:g,transaction:f,subitemRelationSchema:_,relationPropertyCollectionId:s.id});const x=g?(0,A.Kg)(d,g):void 0,T=x?d.filter(((e,t)=>x.includes(t))):[];for(const l of T){if(I){const e=(0,A.xb)({store:l,subitemFormat:g,propertySchema:b});for(const t of e){const e=F.G.createChildStore(l,t);$.Bl({environment:o,sourceStore:e,destStore:l,propertyWithInverse:g,transaction:f})}}if(i){const e=null!=u&&u.isExpanded?"into":"below";ye({environment:o,collectionContextStore:a,collectionStore:s,subitemPath:p&&(null==p?void 0:p.length)>0?p:[new v.mp((0,A.SM)(m),[])],store:m,before:"into"===e,insertBlock:l,insertDirection:e,transaction:f})}}}({environment:r,isInsertingAsSubitem:Boolean(R),shouldDuplicate:w,collectionContextStore:g,collectionStore:a,droppedStores:d,wrappedStores:C,targetSubitemExpandedState:P,subitemPath:b,targetStore:s,transaction:u});const D=S.filter((e=>!T.includes(e))),O=D.indexOf(s),Z=c===B.vh.Above||c===B.vh.Left?O:O+1;le({resultIds:[...D.slice(0,Z),...C,...D.slice(Z)].map((e=>e.id)),collectionViewStore:_,collectionContextStore:g,transaction:u}),pe({environment:r,collectionContextStore:g});const V=g.collectionViewBlockStore();if(!V)return;const U=R?s:V,L=y.UI(C,(e=>F.G.createChildStore(U,{table:m.iU,id:e.id})));return J.Z5({environment:r,stores:L}),function(e,t){var n,o;const r=(null===(n=e.collectionViewStore())||void 0===n?void 0:n.getFormat().app_config_uri)===i.g3&&"sprint_board"===(null===(o=E.default.state.mainEditorCurrentBlockStore)||void 0===o?void 0:o.getFormat().special_page_for_pm_launch);r&&te.tutorialAdvanceToStepAfter(t,"sprints-onboarding","sprint-task-tooltip")}(g,u),L}function ue(e){const{environment:t,collectionStore:n,targetStore:o,droppedDirection:i,files:r,transaction:a,collectionContextStore:s,groupsPointer:l}=e,c=s.collectionViewStore(),u=C.qQ(t);if(!c)return;const p=n.inMemoryRecordCache,m=q.z({environment:t,files:r,inMemoryRecordCache:p,pageWidth:u,transaction:a,spaceId:n.pointer.spaceId,useCrdt:I.dy({source:"collection_unknown_view"})}).map(((e,o)=>{const i=r[o],s=G.j4({environment:t,type:"page",inMemoryRecordCache:p,properties:{title:(0,h.TPx)(d.AA(i.name))},transaction:a,spaceId:n.pointer.spaceId,useCrdt:e.useCrdt()});return H.R3({parent:s.getContentStore(),append:e,transaction:a}),s}));de({environment:t,collectionStore:n,targetStore:o,droppedDirection:i,collectionContextStore:s,groupsPointer:l,droppedStores:m,duplicate:!1,transaction:a})}function pe(e){const{environment:t,collectionContextStore:n}=e,o=n.collectionViewBlockStore(),i=n.collectionViewStore();if(!i||!o)return!1;const r=n.currentViewHasSort(),a=i.getType(),s=n.permissionScopes.state;return!!(r&&a&&P.Km[a]&&s.canConfigureBlock)&&(N.showDialog({message:R.default.formatMessage(oe.removeSortingConfirmation),items:[{label:R.default.formatMessage(oe.removeSortingButton),color:"red",onAccept:()=>{ee.createAndCommit({userAction:"collectionGroupActions.offerToRemoveSort",environment:t,perform:e=>{S.Es({collectionViewStore:i,update:{sort:[]},transaction:e})}})}},{label:R.default.formatMessage(oe.removeSortingCancel),onAccept:()=>{}}],showCancel:!1,keepFocus:!0}),!0)}function me(e){const{environment:t,droppedStores:n,duplicate:o,collectionContextStore:i,groupsPointer:r,transaction:a}=e,s=i.collectionStore(),l=i.collectionViewStore(),c=ce({environment:t,droppedStores:n,duplicate:o,duplicateUseCrdt:"same_as_store",transaction:a,collectionStore:s});for(const d of c){const e=s??d.getAssociatedCollectionStore();e&&se({environment:t,store:d,collectionStore:e,collectionContextStore:i,groupsPointer:r,shouldCoerce:!0,transaction:a})}return l&&le({resultIds:c.map((e=>e.id)),collectionViewStore:l,collectionContextStore:i,transaction:a}),a.postSubmitCallbacks.push((async e=>{!e&&s&&await j.YE({droppedStores:n,createdStores:c,collectionStore:s,environment:t,collectionContextStore:i,groupsPointer:r,shouldDuplicate:o})})),[]}function fe(e){var t,n,o;const{environment:i,collectionContextStore:a,groupsPointer:s,insertAtIndex:l,shouldCoerce:c,initializeDefaultTemplate:d,transaction:u,from:p,tracker:f,useCrdt:g}=e,h=D.default.mark("collections.add_item_lag");D.default.measureAfterNextFlush(h,{environment:i,getData:()=>({...T.vS(a),from:p})});const v=null===(t=E.default.state.currentSpaceStore)||void 0===t?void 0:t.id,b=G.j4({environment:i,type:r.Ti.page,inMemoryRecordCache:i.defaultRecordCache.inMemoryRecordCache,transaction:u,spaceId:v,tracker:f,useCrdt:g??!1}),y="collectionTypedView"===a.contextType,_=a.databaseType,S=a.collectionStoresStore.state,w=S.find((e=>e.canEdit()||e.canEditCollection()||e.canEditContentOnly()))||S[0];!y&&w&&ne.zq({transaction:u,dbType:_,collectionId:w.id});const k=E.default.state.currentUserSettingsStore,I=y&&_&&v&&k&&[...k.getAllPreferredCollections(v),...k.getPreferredCollectionsOfType(v,_)]||[];let C;const x=s[0];if("group_header"===p&&"location"===x.value.type){const e=x.value.value;if(e){C=S.find((t=>t.id===e.id&&(t.canEdit()||t.canEditCollection()||t.canEditContentOnly())))}}else C=function(e,t){for(const n of e){const e=t.find((e=>e.id===n&&(e.canEdit()||e.canEditCollection()||e.canEditContentOnly())));if(e)return e}}(I,S);const M=C??w,P=a.collectionViewStore(),A=a.getViewType();if(!M||!P||!A)return{coercionSucceeded:!0,newStore:b};const R=null===(n=a.groupsStore.getGroupState(s))||void 0===n?void 0:n.groupUiParentStore;if(!R)return{coercionSucceeded:!0,newStore:b};const B=F.G.createChildStore(R,{table:m.iU,id:b.id});if(d){const e=a.defaultPageTemplateStore.state;e&&L.ob({title:"template",environment:i,store:b,templateStore:e,isKeyboard:!1,isCreateIn:!1,transaction:u,from:"collection_group_actions"})}const O=se({environment:i,store:b,collectionStore:M,collectionContextStore:a,groupsPointer:s,shouldCoerce:c,transaction:u}),Z=(null===(o=a.groupsStore.getGroupState(s))||void 0===o||null===(o=o.reducerResultStore.state)||void 0===o?void 0:o.blockIds)||[],V=void 0!==l?l:Z.length;if(a.permissionScopes.state.canEditContent||y){le({resultIds:[...Z.slice(0,V),B.id,...Z.slice(V)],collectionViewStore:P,collectionContextStore:a,transaction:u})}return{coercionSucceeded:O,newStore:B}}function ge(e){const{collectionContextStore:t,newGroups:n,groupsFormatKey:o,transaction:i}=e,r=t.collectionViewStore();r&&W.FH({stores:[r],update:{[o]:n},transaction:i})}function he(e){const{environment:t,collectionStore:n,property:o,oldValue:i,newValue:r,transaction:s}=e,l=n.getSchema(),c=t.currentUser.id;n.inMemoryRecordCache.forEachRecord(c,(e=>{var c;let{model:d}=e;if(d.table!==m.iU)return;const u=F.G.createChildStore(n,{table:m.iU,id:d.id});if(u.canEdit()&&(null===(c=u.getAssociatedCollectionStore())||void 0===c?void 0:c.id)===n.id){const e=a.hz({block:d,schema:l,property:o,oldValue:i,newValue:r});Pe({environment:t,blockStore:u,properties:e,transaction:s})}})),n.isDefaultRecordCache()&&s.postSubmitCallbacks.push((async e=>{const a=n.pointer,{value:s}=await V.renameGroup(t,{collection:{id:a.id,spaceId:(0,g.C)(a.spaceId)},property:o,oldValue:i,newValue:r}).next();if(s.error)throw s.error}))}function ve(e){const{environment:t,collectionStore:n,groupsFormatKey:o,property:i,groupFormat:r,currentGroups:c,collectionContextStore:d,transaction:p,intl:f}=e,h=n.getSchema(),v=h[r.property];ge({collectionContextStore:d,newGroups:c.filter((e=>!(0,s.we)(r.value,e.value))),groupsFormatKey:o,transaction:p});const b=r.value;if(v&&(0,l.cu)(v)&&b.type===v.type&&n){const e=(v.options||[]).filter((e=>e.value!==b.value)),o={...v,options:e},i={...h,[r.property]:o};S.Rm({environment:t,collectionStore:n,update:{schema:i},transaction:p})}const y=t.currentUser.id,_=new Map;n.inMemoryRecordCache.forEachRecord(y,(async e=>{let{model:o}=e;if(o.table!==m.iU)return;const r=F.G.createChildStore(n,o.pointer);if(a.wg({block:o,schema:h,property:i,value:b,intl:f,timeZone:(0,u.r)(),getRecordModel:n.getRecordModel,resultCache:_}))if(o.parent_id===n.id)K.hh({childStore:r,transaction:p});else{const e=r.getAssociatedCollectionStore();e&&e.id===n.id&&("page"===r.getType()||"collection_view_page"===r.getType()&&!r.isCollectionViewPageWithContent())&&await Y.Qw({environment:t,blocks:[r],shouldCheckSuggestEdit:!0})}})),n.isDefaultRecordCache()&&p.postSubmitCallbacks.push((async e=>{const o=await V.deleteGroup(t,{collection:{id:n.id,spaceId:(0,g.C)(n.pointer.spaceId)},property:i,value:b}).next();if(o.value.error)throw o.value.error}))}function be(e){var t;const{environment:n,collectionContextStore:i,before:a,store:s,groupsPointer:l,collectionStore:c,transaction:d,subitemPath:u,subitemInsertDirection:p,from:f,event:g}=e,h=i.collectionViewStore();if(!h)return;const v=i.groupsStore.getGroupState(l),b=null==v?void 0:v.groupUiParentStore,y=(null==v?void 0:v.resultsStore.state)||[];if(!b)return;const _=G.j4({environment:n,type:r.Ti.page,inMemoryRecordCache:s.inMemoryRecordCache,transaction:d,spaceId:h.pointer.spaceId,useCrdt:(0,I.SL)({event:g,source:"collection_unknown_view",contextualDefault:null===(t=i.defaultPageTemplateStore.state)||void 0===t?void 0:t.useCrdt()})});if(f){const e="collectionTypedView"===i.contextType?_.getAssociatedCollectionId():void 0;Z.W(n,{from:f,type:"page",new_page_id:_.id,creating_block_id:_.id,...T.Pn(i,e)})}const S=se({environment:n,store:_,collectionStore:c,collectionContextStore:i,groupsPointer:l,shouldCoerce:!0,transaction:d}),k=i.defaultPageTemplateStore.state;k&&L.ob({title:"template",environment:n,store:_,templateStore:k,isKeyboard:!1,isCreateIn:!1,transaction:d,from:"collection_group_actions"});const C=F.G.createChildStore(b,{table:m.iU,id:_.id});u&&u.length>0&&ye({environment:n,collectionContextStore:i,subitemPath:u,collectionStore:c,store:s,before:!1,insertBlock:C,insertDirection:p,transaction:d});const x=y.indexOf(s),M=a?x:x+1;if(le({resultIds:[...y.slice(0,M),C,...y.slice(M)].map((e=>e.id)),collectionViewStore:h,collectionContextStore:i,transaction:d}),S){if(u){var P;const e="into"===p?s:null===(P=u[u.length-2])||void 0===P?void 0:P.value.store;return e?F.G.createChildStore(e,C.pointer):C}return J.Ys({environment:n,store:C}),pe({environment:n,collectionContextStore:i}),C}Q.CH({environment:n,store:C,peekMode:w.kr(i),resultsStore:null==v?void 0:v.resultsStore,collectionContextStore:i,pageVisitSource:o.tY.Create})}function ye(e){const{environment:t,collectionContextStore:n,subitemPath:o,collectionStore:i,store:r,before:a,insertBlock:s,insertDirection:l,transaction:c}=e,d=n.currentSubitemFormatStoreForCollection.state;if(!d)return;const u=i.getSchema()[d.property];if(!u||"relation"!==u.type)return;if("into"===l){var p;const e=o[o.length-1],n=e.value.store;return void $.hE({environment:t,sourceStore:n,destStore:s,position:a?{type:"before",before:null===(p=e.children[0])||void 0===p?void 0:p.value.store.id}:{type:"after"},propertyWithInverse:d,transaction:c})}const m=o[o.length-2];if(!m)return;const f=m.value.store;$.hE({environment:t,sourceStore:f,destStore:s,propertyWithInverse:d,position:a?{type:"before",before:r.id}:{type:"after",after:r.id},transaction:c})}function _e(e){const{environment:t,collectionContextStore:n,groupFormat:o,newGroupFormat:i,groupsFormatKey:r,currentGroups:a,transaction:l}=e,c=n.collectionStore();!(0,s.we)(o.value,i.value)&&c&&he({environment:t,collectionStore:c,property:o.property,oldValue:o.value,newValue:i.value,transaction:l});ge({collectionContextStore:n,newGroups:a.map((e=>(0,s.we)(o.value,e.value)?i:e)),groupsFormatKey:r,transaction:l})}function Se(e){const{environment:t,stores:n,spaceId:o,transaction:i}=e;return n.map((e=>{const n=e.getType();if(n&&(r.Ok[n]||n===r.Ti.file||n===r.Ti.externalObjectInstance)){const n=G.j4({environment:t,type:"page",inMemoryRecordCache:e.inMemoryRecordCache,transaction:i,spaceId:o,useCrdt:e.useCrdt()});return K.jG({parentStore:n,childStore:e,transaction:i}),n}return e}))}function we(e){const{environment:t,format:n,groupsFormatKey:o,collectionContextStore:i,currentGroups:r}=e,a=n[o]||[];if(!i.permissionScopes.state.canConfigureBlock)return;if(0===r.length)return;const s=r.slice(0,M.XD),l=a.slice(0,M.XD);y.Xy(s,l)||ee.createAndCommit({userAction:"collectionGroupActions.persistFormatGroups",environment:t,canUndo:!1,perform:e=>{ge({collectionContextStore:i,newGroups:r,groupsFormatKey:o,transaction:e})}})}function ke(e,t){return`group-${e}-${(0,s.mD)(t)}`}function Ie(e){const{environment:t,groupFormat:n,collectionContextStore:o}=e,i=o.collectionViewStore();if(!i)return;const r=o.groupsStore.getGroupState(n);if(!r)return;const a=p.Z.get({userId:t.currentUser.id,key:ke(i.id,n)});r.toggleStateStore.setState(a??!0)}function Ce(e){const{environment:t,groupFormat:n,toggleStateStore:o,newValue:i,collectionContextStore:r}=e,a=r.collectionViewStore();a&&(o.setState(i),p.Z.set({userId:t.currentUser.id,key:ke(a.id,n),value:i}))}function xe(e){const{newGroupValue:t,groupFormat:n,schema:o,collectionContextStore:i,currentGroups:r,groupsFormatKey:a,collectionStore:c,environment:d}=e,u=o[n.property];if(!u)return;if(!(0,s.LG)(u))return;const p=n.value;if((0,l.cu)(u)){if(p.type!==u.type)return;if(t.type!==u.type)return;if(void 0===t.value)return;const e=u.options||[],s=t.value,l=e.map((e=>e.value===p.value?{...e,value:s}:e)),m={...u,options:l},f={...o,[n.property]:m},g={...n,value:{...p,value:s}};ee.createAndCommit({userAction:"collectionGroupActions.handleCollectionGroupValueChange",environment:d,perform:e=>{_e({environment:d,collectionContextStore:i,groupFormat:n,newGroupFormat:g,currentGroups:r,transaction:e,groupsFormatKey:a}),S.Rm({environment:d,collectionStore:c,update:{schema:f},transaction:e})}})}else if("person"!==u.type)if((0,s.HB)(u.type)){if(p.type!==u.type)return;if(t.type!==u.type)return;if(!t.value||"exact"!==t.value.type)return;const e={...n,value:t};ee.createAndCommit({userAction:"collectionGroupActions.handleCollectionGroupValueChange",environment:d,perform:t=>{_e({environment:d,collectionContextStore:i,groupFormat:n,newGroupFormat:e,currentGroups:r,groupsFormatKey:a,transaction:t})}})}else"status"===u.type||(0,s.A1)(u.type)||"created_by"===u.type||"last_edited_by"===u.type||"number"===u.type||"checkbox"===u.type||"formula"===u.type||"relation"===u.type||"location"===u.type||(0,_.t1)(u.type);else{if(p.type!==u.type)return;if(t.type!==u.type)return;const e={...n,value:t};ee.createAndCommit({userAction:"collectionGroupActions.handleCollectionGroupValueChange",environment:d,perform:t=>{_e({environment:d,collectionContextStore:i,groupFormat:n,newGroupFormat:e,currentGroups:r,groupsFormatKey:a,transaction:t})}})}}async function Te(e){const{update:t,collectionContextStore:n,groupsFormatKey:o,collectionStore:i,environment:a,schema:s,groupBy:c}=e,d=s[c.property];if(!d)return;const u="relation"===d.type&&(0,l.F0)(d),p=u&&new F.NW(a,{table:f.vF,id:u});p&&await p.load(),ee.createAndCommit({userAction:"collectionGroupActions.handleCollectionAddGroupButtonAccept",environment:a,perform:e=>{if(t.newGroups&&(ge({collectionContextStore:n,newGroups:t.newGroups,groupsFormatKey:o,transaction:e}),U.ul({transaction:e,newGroups:t.newGroups,collectionContextStore:n,environment:a})),t.newSchema&&S.Rm({environment:a,collectionStore:i,update:{schema:t.newSchema},transaction:e}),t.newPage&&"relation"===d.type&&p){const n=(0,h.TPx)(t.newPage.name),o=G.j4({environment:a,id:t.newPage.id,type:r.Ti.page,spaceId:t.newPage.spaceId,properties:{title:n},inMemoryRecordCache:i.inMemoryRecordCache,transaction:e,useCrdt:I.dy({source:"collection_unknown_view"})});K.zw({parentStore:p,childStore:o,transaction:e});const s=p.getDefaultTemplatePageStore();s&&L.ob({title:{text:n},environment:a,store:F.G.createChildStore(p,o.pointer),templateStore:s,isKeyboard:!1,isCreateIn:!1,transaction:e,from:"collection_group_actions"})}}})}function Me(e){const{collectionContextStore:t,environment:n,incrementLimitArgs:o}=e;t.groupsStore.incrementLimit(e.incrementLimitArgs),t.loadingDetails.setState({type:"load_more_blocks",group:o.groupsPointer}),O.bn(n)}function Pe(e){const{environment:t,blockStore:n,properties:o,transaction:i}=e;k.b({environment:t,editorMode:"default",store:n,properties:o,transaction:i})}},16956:(e,t,n)=>{n.d(t,{Bv:()=>D,E2:()=>V,G3:()=>P,LC:()=>A,OK:()=>E,TI:()=>O,bL:()=>R,er:()=>B,fH:()=>F,yV:()=>Z});n(57658),n(67294);var o=n(46283),i=n(99036),r=n(95200),a=n(6287),s=n(9291),l=n(15828),c=n(1898),d=n(37810),u=n(91851),p=n(75330),m=n(10906),f=n(76798),g=n(65183),h=n(33929),v=n(29376),b=n(85526),y=n(6258),_=n(8406),S=n(31869),w=n(5149),k=n(87085),I=n(47307),C=n(96802),x=n(13447),T=n(12304),M=n(85893);function P(e){const{environment:t,collectionViewArgs:n,collectionStore:a,propertyName:s,propertyType:d,selectOptions:u,transaction:m}=e,f={},v=a.getSchema(),b=Object.keys(v),y=(0,r.Z)(s??g.SO[d],(e=>!b.find((t=>{const n=v[t];return Boolean(n&&n.name===e)})))),_=(0,l.ZP)();let S;const w=(0,g.k4)();if((0,i.XU)(d))switch(d){case"ai_custom_prompt":S={name:y,type:"text",ai_inference:{type:"custom",prompt:"",auto_update_on_edit:w}};break;case"ai_summary":S={name:y,type:"text",ai_inference:{type:"summarize",auto_update_on_edit:w}};break;case"ai_extract":S={name:y,type:"text",ai_inference:{type:"extract",prompt:"",auto_update_on_edit:w}};break;case"ai_translate":S={name:y,type:"text",ai_inference:{type:"translate",targetProperties:["title"],toLanguage:"english",auto_update_on_edit:w}};break;case"ai_keywords":S={name:y,type:"multi_select",select_ai_inference:{type:"multi_select",add_options:!0,auto_update_on_edit:!1}};break;default:(0,c.t1)(d)}else S=!u||"select"!==d&&"multi_select"!==d?{name:y,type:d}:{name:y,type:d,options:u};if(f[_]=S,i.iE(S)&&(b.includes(o.k.Owner)||(f[o.k.Owner]={name:h.default.formatMessage(T.Zi.ownerPropertyName),type:"person",default:"created_by"}),S.verifier_property=o.k.Owner),n){const{format:e,formatKey:t,collectionViewStore:o}=n,i=[...e[t]||[],{property:_,visible:!0}];C.FH({stores:[o],update:{[t]:i},transaction:m})}return p.xO({environment:t,collectionStore:a,update:f,transaction:m}),_}function A(e){const{environment:t,collectionStore:n,property:o,type:r,transaction:a}=e,s=n.getSchema()[o];if(!s||s.type===r)return;const l={...s};l.type=(0,i.TN)(r),p.xO({environment:t,collectionStore:n,update:{[o]:l},transaction:a})}function R(e){const{collectionStore:t,property:n,autoRelate:o,transaction:i}=e;t.getSchema()[n]&&x.applyOperation({store:t,operation:{pointer:t.pointer,path:["schema",n,"autoRelate"],command:"set",args:o},transaction:i})}function D(e){const{collectionStore:t,property:n,name:o,transaction:i}=e;t.getSchema()[n]&&x.applyOperation({store:t,operation:{pointer:t.pointer,path:["schema",n,"name"],command:"set",args:o},transaction:i})}function E(e){const{collectionStore:t,property:n,icon:o,transaction:i}=e;t.getSchema()[n]&&x.applyOperation({store:t,operation:{pointer:t.pointer,path:["schema",n,"icon"],command:"set",args:o},transaction:i})}function B(e){const{formatStore:t,formatKey:n,property:o,update:i,transaction:r}=e,a=[...t.getFormat()[n]||[]],s=a.findIndex((e=>e.property===o));-1!==s?a[s]={...a[s],...i}:a.push({property:o,...i}),C.FH({stores:t instanceof y.G||t instanceof y.NW||t instanceof y.Xr?[t]:(0,c.t1)(t),update:{[n]:a},transaction:r})}function F(e){const{collectionContextStore:t,collectionStore:n,environment:o,isInPeekRenderer:r,onCloseMenu:a}=e,s=t.settingsStore;w.H4({collectionSettingsStore:s,item:{type:"propertyType",onAccept:(e,l,c,d)=>{if("relation"===e)return void w.H4({collectionSettingsStore:s,item:{type:"selectRelationSource",property:void 0,formatKey:"collection_page_properties"}});const{performResult:u}=x.createAndCommit({userAction:"PageProperties.handleAddPropertyClick",environment:o,perform:t=>P({environment:o,collectionStore:n,collectionViewArgs:void 0,propertyType:e,propertyName:c,selectOptions:d,transaction:t})});null==a||a(),w.FK({collectionSettingsStore:s,item:{type:"property",formatKey:"collection_page_properties",property:u,selectNameInitial:!o.device.isMobile}}),b.Z.setState({...b.Z.state,openProperty:{property:u,isInPeekRenderer:r},forceShowProperties:!0}),(0,i.XU)(e)&&k.K7({propertyType:e,propertyId:u,collectionContextStore:t}),_._H({environment:o,collectionContextStore:t,from:"page_properties",property_type:(0,i.TN)(e),property:(0,i.XU)(e)?e:void 0,is_suggested_property:l})}}})}async function O(e){const{environment:t,collectionContextStore:n,property:o,handleDeleteAccept:i}=e,r=n.collectionStore();if(!r)return;if(r.isTypedProperty(o)){if(await u.w0({environment:t,property:o,collectionContextStore:n,theme:e.theme,from:e.from}))return}const a=n.normalizedSchemaStore.state,l=a[o],c=v.ny(n,l);await(null==c?void 0:c.load());const p=c&&v.OP(n,o,c),m=c&&v.gZ(c),g=c&&r.id===c.id,h=[{label:(0,M.jsx)(s.FormattedMessage,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:i}];let b;if(p&&r&&m&&!g&&h.push({label:(0,M.jsx)(s.FormattedMessage,{id:"database.tableHeaderCell.deleteProperty.modal.inverseConfirmButton",defaultMessage:"Delete, but keep related property"}),color:"red",onAccept:()=>{x.createAndCommit({userAction:"collectionPropertyActions.showDeletePropertyDialog",environment:t,perform:e=>{if(l&&"relation"===l.type&&l.property&&c){const n=l.property,o=c.getSchema();S.q0({environment:t,collectionStore:c,propertySchema:o[n],property:n,targetPropertyID:void 0,autoRelate:r.isSyncedCollection()&&!c.isSyncedCollection()?{enabled:!1}:l.autoRelate,transaction:e})}S.kQ({environment:t,collectionStore:r,property:o,transaction:e})}})}}),"auto_increment_id"===(null==l?void 0:l.type))b=v.pR(a)?(0,M.jsx)(s.FormattedMessage,{id:"database.tableHeaderCell.deleteUniqueIdWithGithubProperty.modal.prompt",defaultMessage:"You will no longer be able to link new GitHub PRs and status automations will stop working."}):(0,M.jsx)(s.FormattedMessage,{id:"database.tableHeaderCell.deleteUniqueIdProperty.modal.prompt",defaultMessage:"The ID property will be permanently deleted."});else if("status"===(null==l?void 0:l.type)){const e=v.Pi(a);if(e){const t=e.connectedRelation.automation;t&&t[o]&&(b=(0,M.jsx)(s.FormattedMessage,{id:"database.tableHeaderCell.deleteStatusProperty.modal.prompt",defaultMessage:"Deleting this status property will stop the GitHub Pull Requests status automation."}))}}else c&&m&&!g&&p&&(b=(0,M.jsx)(s.FormattedMessage,{id:"database.tableHeaderCell.deleteRelatedProperty.modal.prompt",defaultMessage:"This property has a related property on {relationTargetName} which will also be deleted.",values:{relationTargetName:(0,M.jsx)(f.Z,{style:{display:"inline",fontWeight:d.Z.fontWeight.medium},store:c})}}));I.showDialog({message:(0,M.jsx)("span",{children:(0,M.jsx)(s.FormattedMessage,{id:"database.tableHeaderCell.deleteProperty.modal.prompt",defaultMessage:"Delete this property for everyone on {databaseName}?",values:{databaseName:(0,M.jsx)(f.Z,{style:{display:"inline",fontWeight:d.Z.fontWeight.medium},shouldWrap:!0,store:r})}})}),description:b,showCancel:!0,keepFocus:!0,items:h,mode:"wide"})}async function Z(e){const{environment:t,collectionStore:n,schema:o,property:r,transaction:a}=e,s=o[r];if(s)if("relation"===s.type&&i.F0(s)&&s.property&&i.F0(s)!==n.id){const e=new y.NW(t,i.j0(s));await e.load(),V({environment:t,collectionStore:n,schema:o,property:r,transaction:a,targetCollectionStore:e})}else V({environment:t,collectionStore:n,schema:o,property:r,transaction:a})}function V(e){const{environment:t,collectionStore:n,schema:o,property:i,transaction:r,targetCollectionStore:s,permanentlyDelete:l}=e;if(!n.isDefined())return;const c=Boolean(l),d=m.zm({environment:t,collectionId:n.id,schema:o,property:i,targetCollectionStore:s});if(!d)return;p.Rm({environment:t,collectionStore:n,update:{schema:d.newSchema,...!c&&d.deletedSchema&&{deleted_schema:d.deletedSchema}},transaction:r}),d.otherCollectionId&&d.otherCollectionSchema&&p.Rm({environment:t,collectionStore:y.NW.createChildStore(n,{table:a.vF,id:d.otherCollectionId}),update:{schema:d.otherCollectionSchema,...!c&&d.otherCollectionDeletedSchema&&{deleted_schema:d.otherCollectionDeletedSchema}},transaction:r});const u=o[i];("auto_increment_id"===(null==u?void 0:u.type)||c)&&p.$N({collectionStore:n,update:{[i]:null},transaction:r})}},75134:(e,t,n)=>{n.d(t,{H:()=>x,r:()=>T});n(67294);var o=n(52936),i=n(42875),r=(n(57658),n(21703),n(53965)),a=n(80951),s=n(61158),l=n(45953);const c=500;function*d(e){const{startingBlock:t,relationPropertyIdGroups:n,receiver:o}=e;let i,s=n.map((e=>function*(e){const{startingBlock:t,relationPropertyIds:n,receiver:o}=e,i=new Set,s=[{block:t}];let l=0;for(;;){const e=s.shift();if(!e)break;const{block:t}=e;if(i.has(t.id))continue;i.add(t.id);const d=n.flatMap((e=>{var n;return(0,a.rq)(null===(n=t.properties)||void 0===n?void 0:n[e])}));if(!o.receive(d))return;if(d.length>0){const{recordMap:e}=yield{recordPointers:d};s.push(...r.oA(d.map((t=>{const n=e.getValue(t);if(n&&n.alive)return{block:n}}))))}if(l++,l>c)throw new Error("Reached maximum number of iterations")}}({relationPropertyIds:e,startingBlock:t,receiver:o})));for(;s.length>0;){const e=[];s=s.filter((t=>{const n=i?t.next(i):t.next();return!n.done&&(e.push(n.value),!0)})),e.length>0&&(i=yield{recordPointers:e.flatMap((e=>e.recordPointers))})}}class u{constructor(e){this.blockPointerSet=new s.Z,this.limit=e}getBlockPointers(){return this.blockPointerSet.entries()}receive(e){return this.blockPointerSet.add(...e),this.blockPointerSet.size<this.limit}}function p(e){return function(e){const{startingBlock:t,relationPropertyIdGroups:n,getRecordValue:o,limit:i}=e,r=new u(i),a=d({startingBlock:t,relationPropertyIdGroups:n,receiver:r});let s=a.next();for(;!s.done;){const e=l.Ak.create();for(const t of s.value.recordPointers)e.setValue(t,o(t));s=a.next({recordMap:e})}return r.getBlockPointers()}(e).every((t=>Boolean(e.getRecordValue(t))))}var m=n(9291),f=n(90038),g=n(1898),h=n(6854),v=n(81166),b=n(80444),y=n(77080),_=n(6258),S=n(54642),w=n(64964),k=n(13447),I=n(85893);const C=100;function x(e){const{environment:t,store:n}=e;P({environment:t,store:n,change:{type:"date",...e}})}function T(e){const{environment:t,store:n}=e;P({environment:t,store:n,change:{type:"relation",...e}})}const M=new f.z(1);function P(e){const{environment:t,store:n,change:a}=e;if(!y.default.checkGate("dependency_date_shifting_by_space"))return;const s=n.getAssociatedCollectionStore();if(!s)return;const l=s.getDatabaseType(),c=s.getSchema(),d=s.getNormalizedDependencyDateShiftingConfig();if(!d)return;const u=s.getFormatStore().getKeyStore("collection_default_arrows_by").getValue();if(!u)return;const f=c[u];if("relation"!==(null==f?void 0:f.type))return;const x=f.property;x&&M.enqueue((()=>async function(e){var t,n;const{environment:a,store:s,dateShiftConfig:l,databaseType:c,blockedByPropertyId:d,blockingPropertyId:u,change:f,collectionSchema:y}=e,x={id:s.id,properties:s.getProperties()},T=null===(t=b.default.state.currentUserSettingsStore)||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.locale,M=(0,i.r)();let P,A,R;if("date"===f.type){var D;if(0===r.jV(r.oA([l.date_property,l.end_date_property]),r.oA([f.dateProperty.id,null===(D=f.otherDateProperty)||void 0===D?void 0:D.id])).length)return;const e=new Map;e.set(f.dateProperty.id,f.dateProperty),f.otherDateProperty&&e.set(f.otherDateProperty.id,f.otherDateProperty);const t=t=>{const n=e.get(t);if((0,g.$K)(n))return n;{var o;const e=null===(o=x.properties)||void 0===o?void 0:o[t];return{id:t,oldValue:e,newValue:e}}};P=t(l.date_property),(0,g.$K)(l.end_date_property)&&(A=t(l.end_date_property))}else if("relation"===f.type){if(f.relationPropertyId!==u&&f.relationPropertyId!==d)return;if("preserve_gap"===l.mode)return;P={id:l.date_property,oldValue:void 0,newValue:x.properties[l.date_property]},l.end_date_property&&(A={id:l.end_date_property,oldValue:void 0,newValue:x.properties[l.end_date_property]})}else(0,g.t1)(f);"preserve_gap"===l.mode?R=[[d,u]]:"consume_gap"===l.mode?R=[[d],[u]]:(0,g.t1)(l.mode);p({startingBlock:x,relationPropertyIdGroups:R,limit:C,getRecordValue:s.getRecordValue})?await Promise.resolve():await S.getTransitivePageRelations(a,{blockId:x.id,limit:C,relationPropertyIdGroups:R}).then((()=>{}));const E=(0,o.yu)({block:{id:x.id,properties:{...x.properties,...P.oldValue?{[P.id]:P.oldValue}:{},...null!==(n=A)&&void 0!==n&&n.oldValue?{[A.id]:A.oldValue}:{}}},blockingPropertyId:u,blockedByPropertyId:d,dateProperty:P,endDateProperty:A,getRecordValue:s.getRecordValue,timeZone:M,locale:T,options:l,collectionSchema:y,getRecordRole:s.getRecordRole}),{operations:B}=E;k.createAndCommit({userAction:"collectionDateActions.handleDependencyDateShifting",environment:a,perform:e=>{for(const t of B){const n=(0,_.Kv)(s,t.pointer);k.applyOperation({store:n,operation:t,transaction:e})}}});const F=(0,v.vi)({result:E,databaseType:c});F&&w.oV({label:(0,I.jsx)(m.FormattedMessage,{...F.message}),right:F.canUndo?(0,I.jsx)(h.ow,{}):void 0})}({environment:t,store:n,dateShiftConfig:d,databaseType:l,blockedByPropertyId:x,blockingPropertyId:u,change:a,collectionSchema:c}))).catch((e=>{console.error(e)}))}},31869:(e,t,n)=>{n.d(t,{gy:()=>b,kQ:()=>h,n7:()=>v,q0:()=>g,qK:()=>_,sf:()=>y});var o=n(80951),i=n(15828),r=n(36610),a=n(75330),s=n(29376),l=n(8406),c=n(16956),d=n(75134),u=n(96802),p=n(993),m=n(13447);function f(e){const{environment:t,collectionStore:n,collectionPointer:o,property:i,name:r,autoRelate:s,limit:l,targetPropertyID:c,connectedRelation:d,transaction:u,hideByDefaultInUnconfiguredViews:p}=e,m={type:"relation",name:r,collection_id:o.id,collection_pointer:o,limit:"1"===l?1:void 0,property:c,version:"v2",autoRelate:s,connectedRelation:d,hideByDefaultInUnconfiguredViews:p};a.xO({environment:t,collectionStore:n,update:{[i]:m},transaction:u})}function g(e){const{environment:t,collectionStore:n,propertySchema:o,targetPropertyID:i,property:r,autoRelate:s,transaction:l}=e;a.xO({environment:t,collectionStore:n,update:{[r]:{...o,autoRelate:s,property:i,version:"v2"}},transaction:l})}function h(e){const{environment:t,collectionStore:n,property:o,transaction:i}=e,r=n.getSchema()[o];r&&"relation"===r.type&&(a.xO({environment:t,collectionStore:n,update:{[o]:null},transaction:i}),a.$N({collectionStore:n,update:{[o]:r},transaction:i}))}function v(e){const{environment:t,collectionContextStore:n,collectionStore:o,property:r,propertyName:a,propertyLimit:d,targetCollectionStore:u,hasInverseRelation:p,inverseName:m,autoRelate:g,intl:h,connectedRelation:v,transaction:b,from:y,analyticsFrom:_,onlyCheckPermissions:S}=e,w=u.pointer.id===o.id&&Boolean(p)?"separate_property":"same_property",k=s.KV(n,r),I="subitem"===y||void 0,C=function(e){const{environment:t,collectionContextStore:n,property:o,limit:r,collectionPointer:a,selfRelationType:s,oneWay:l,autoRelate:c,connectedRelation:d,transaction:u,hideByDefaultInUnconfiguredViews:p}=e,m=n.collectionStore();if(!m)return;const g=m.getSchema()[o];if(!g)return;const h=a.id===m.id?"same_property"===s?o:(0,i.ZP)():l?void 0:(0,i.ZP)();return f({environment:t,collectionStore:m,collectionPointer:a,property:o,name:g.name,autoRelate:c,limit:r,targetPropertyID:h,connectedRelation:d,transaction:u,hideByDefaultInUnconfiguredViews:p}),h}({environment:t,collectionContextStore:n,property:r,limit:d,collectionPointer:u.pointer,selfRelationType:w,oneWay:!p,autoRelate:g,connectedRelation:v,transaction:b,hideByDefaultInUnconfiguredViews:I});if((null==k?void 0:k.name)!==a&&(c.Bv({collectionStore:o,property:r,name:a,transaction:b}),l.$q({environment:t,collectionContextStore:n,property:r,from:_??"view_settings",action:"rename"})),S&&p&&null!=o&&o.canEditCollection()&&C){const e=s.rj({inverseName:m,collectionStore:o,propertySchema:k,intl:h,targetCollectionStore:u,from:y});f({environment:t,collectionStore:u,collectionPointer:o.pointer,property:C,name:e,autoRelate:g,limit:"subitem"===y?"1":"no_limit",targetPropertyID:r,connectedRelation:v,transaction:b,hideByDefaultInUnconfiguredViews:I})}if(p&&s.gZ(u)&&C){const e=s.rj({inverseName:m,collectionStore:o,propertySchema:k,intl:h,targetCollectionStore:u,from:y});f({environment:t,collectionStore:u,collectionPointer:o.pointer,property:C,name:e,autoRelate:g,limit:"subitem"===y?"1":"no_limit",targetPropertyID:r,connectedRelation:v,transaction:b,hideByDefaultInUnconfiguredViews:I})}}function b(e){const{environment:t,collectionContextStore:n,property:o,hasInverseRelation:r,inverseName:a,autoRelate:l,intl:d,transaction:u}=e,p=s.KV(n,o);if(!p||"relation"!==p.type)return;const m=s.ny(n,p),v=n.collectionStore();if(!v||!m)return;const b=s.rj({inverseName:a,collectionStore:v,propertySchema:p,intl:d,targetCollectionStore:m});if(r&&!s.OP(n,o,m)){const e=(0,i.ZP)();g({environment:t,collectionStore:v,propertySchema:p,property:o,targetPropertyID:e,autoRelate:l,transaction:u}),f({environment:t,collectionStore:m,collectionPointer:v.pointer,property:e,name:b,autoRelate:l,limit:"no_limit",targetPropertyID:o,transaction:u,hideByDefaultInUnconfiguredViews:void 0})}else if(r){const e=p.property;if(!e)return;c.Bv({collectionStore:m,property:e,name:b,transaction:u}),l&&(c.bL({collectionStore:v,property:o,autoRelate:l,transaction:u}),c.bL({collectionStore:m,property:e,autoRelate:l,transaction:u}))}else{l&&c.bL({collectionStore:v,property:o,autoRelate:l,transaction:u});const e=p.property;if(!e)return;g({environment:t,collectionStore:v,propertySchema:p,property:o,targetPropertyID:void 0,autoRelate:l,transaction:u}),h({environment:t,collectionStore:m,property:e,transaction:u})}}function y(e){var t;const{store:n,propertyId:i,value:r,environment:a,relatedPageId:s,propertySchema:c,transaction:u,collectionContextStore:m,analyticsData:f,isUnthrottled:g}=e,{analyticsFrom:h,isFromBulkActionsToolbar:v}=f,b=n.getNormalizedPropertyStore(i),y=o.ow(r);p.sO({environment:a,editorMode:"default",store:b,value:y,transaction:u}),l.rv({environment:a,block_id:s,property:i,property_type:c.type,from:h,collectionContextStore:m,isFromBulkActionsToolbar:v,isUnthrottled:g,integration_id:null===(t=c.connectedRelation)||void 0===t?void 0:t.integration_id,action:"remove"}),d.r({environment:a,store:n,relationPropertyId:i})}function _(e){const{propertyFormat:t,visibility:n,collectionStore:i,property:a,environment:l}=e,c=t.property,d=s.U1({collectionStore:i,property:a}),p=(0,o.pX)(d,c,!n),f={...s.ZI(i)};f[a]||(f[a]={}),f[a].related_properties=p,m.createAndCommit({userAction:"collectionRelationActions.updateRelationPropertyVisibility",environment:l,perform:e=>{u.FH({stores:[i],update:{collection_relation_options:f},transaction:e})}}),r.P$(l,{collection_id:i.id,property_id:a,related_property_id:c,visible:!n})}},5149:(e,t,n)=>{n.d(t,{E3:()=>U,FK:()=>j,H4:()=>L,NG:()=>V,Ol:()=>K,R0:()=>$,TT:()=>W,iN:()=>G,nr:()=>Q,qU:()=>q,r$:()=>Z,wl:()=>N,z$:()=>z,zt:()=>H});n(67294);var o=n(1302),i=n(15145),r=n(92996),a=n(41432),s=n(59730),l=n(15157),c=n(21202),d=n(75246),u=n(29369),p=n(9291),m=n(37850),f=n(19584),g=n(40663),h=n(75330),v=n(95477),b=n(27105),y=n(92918),_=n(84210),S=n(33929),w=n(16402),k=n(77907),I=n(80444),C=n(8406),x=n(54642),T=n(893),M=n(47307),P=n(96802),A=n(19785),R=n(9953),D=n(42858),E=n(64964),B=n(13447),F=n(85893);const O=(0,p.defineMessages)({copySuccessMessage:{defaultMessage:"Link to view copied to clipboard",id:"database.viewSettings.copyLinkSnackBarItem.title"}});function Z(e){const{collectionContextStore:t,selectViewNameInitial:n,collectionSettingsStore:o,hideSettingsPopup:i,fromBlock:r}=e,a=t.hasSingleCollection()&&!t.collectionStore()?{type:"createViewSource"}:{type:"main",selectViewNameInitial:n};o.setState({open:!0,hideSettingsPopup:i,stack:[a],fromBlock:r})}function V(e){const{collectionSettingsStore:t}=e;N({collectionSettingsStore:t,item:{type:"createSyncedViewSource"}})}function U(e){const{collectionSettingsStore:t}=e;t.setState({...t.state,open:!1,hideSettingsPopup:void 0,stack:[]})}function L(e){const{collectionSettingsStore:t,item:n,hideSettingsPopup:o}=e,i=t.state;t.setState({...i,open:!0,stack:[...i.stack,n],...void 0!==o?{hideSettingsPopup:o}:{}})}function j(e){const{collectionSettingsStore:t,item:n}=e,o=t.state;t.setState({open:!0,stack:[...o.stack.slice(0,o.stack.length-1),n]})}function N(e){const{collectionSettingsStore:t,item:n}=e;t.setState({open:!0,stack:[n]})}function z(e){const{collectionSettingsStore:t}=e,n=t.state,o=n.stack.slice(0,n.stack.length-1);0===o.length?U({collectionSettingsStore:t}):t.setState({open:!0,stack:o})}function q(e){const{collectionSettingsStore:t,property:n,formatKey:o,selectNameInitial:i}=e,r=t.state,a=r.stack.findIndex((e=>"property"===e.type));t.setState({open:!0,stack:[...a>=0?r.stack.slice(0,a):r.stack,{type:"property",property:n,formatKey:o,selectNameInitial:i}]})}function W(e){const{environment:t,collectionContextStore:n,collectionViewStore:o,collectionSettingsStore:i,from:r}=e,a=(0,m.UZ)();return M.showDialog({showCancel:!0,keepFocus:!1,message:(0,F.jsx)(p.FormattedMessage,{defaultMessage:"Are you sure you want to delete this view?",id:"database.viewSettings.mainTab.deleteViewConfirm.text"}),items:[{label:(0,F.jsx)(p.FormattedMessage,{defaultMessage:"Delete view",id:"database.viewSettings.deleteButton.text"}),color:"red",onAccept:()=>{const e=n.collectionViewStore(),s=n.collectionViewBlockStore(),l=n.isFullScreen.state,c=o.getType();e&&s&&c&&(B.createAndCommit({userAction:"collectionSettingsActions.handleDeleteCollectionView",environment:t,perform:a=>{if(h.dp({collectionViewBlockStore:s,collectionViewStore:o,transaction:a}),U({collectionSettingsStore:i}),e.id===o.id){const e=s.getCollectionViewStores()[0];e?h.f8({environment:t,collectionContextStore:n,collectionViewId:e.id,isFullScreen:n.isFullScreen.state,isRootChild:n.isRootChild.state,isInPeekRenderer:n.isInPeekRenderer.state}):(h.ME({environment:t,collectionContextStore:n,transaction:a}),l||D.Cl({environment:t,blocks:[s],transaction:a}))}C.Rc({environment:t,collectionContextStore:n,view_type:c,from:r})}}),a.resolve(!0))}}],handleCancel:()=>a.resolve(!1)}),a.promise}function H(e){const{environment:t,collectionContextStore:n,collectionViewStore:i,collectionSettingsStore:r,intl:a}=e,s=n.isFullScreen.state,l=n.isRootChild.state,c=n.isInPeekRenderer.state,{performResult:d}=B.createAndCommit({userAction:"collectionSettingsActions.newView",environment:t,perform:e=>h.tG({environment:t,collectionContextStore:n,collectionViewStore:i,collectionSettingsStore:r,intl:a,transaction:e})});d&&(h.f8({environment:t,collectionContextStore:n,collectionViewId:d.id,isFullScreen:s,isRootChild:l,isInPeekRenderer:c}),o.default.afterNextFlush((()=>{Z({collectionContextStore:n,collectionSettingsStore:r,selectViewNameInitial:!0})})))}async function K(e){const{environment:t,collectionContextStore:n,collectionViewStore:o}=e,r=n.collectionViewBlockStore();if(!o||!r)return;const a=(0,_.ZP)({store:r,collectionViewId:o.id,fullyQualified:!0,pageVisitSource:i.tY.CopyLink});await T.RD({environment:t,stringValue:a,copiedMessage:T.tq.copiedLinkToClipboard}),E.oV({label:S.default.formatMessage(O.copySuccessMessage)})}function G(e){const{environment:t,collectionContextStore:n}=e,o=n.normalizedFormatStore.state,i=o.board_columns_by,r=n.collectionViewStore();if(!i||!r)return;const a=!(0,y.h6)(o);B.createAndCommit({userAction:"collectionSettingsActions.handleBoardGroupColorColumnsClick",environment:t,perform:e=>{P.FH({stores:[r],update:{board_columns_by:{...i,disableBoardColorColumns:a}},transaction:e})}}),C.wd({environment:t,collectionContextStore:n,action:"toggle_group_color_columns"})}async function $(e){const{environment:t,uri:n,botId:o,collectionId:i,isStale:r,nextSync:a,setNextSync:c}=e;if(!a||Date.now()>a){var d;let e=Date.now()+f.U6;const a=await x.resubscribeExternalCollection(t,{botId:o,uri:n,isStale:r,collectionId:i});if("failed"===a.type&&(0,s.A6)(a.body)&&"rate_limited"===(null===(d=a.body.clientData)||void 0===d?void 0:d.type)){const t=a.body.clientData.retryAfter;t&&(e=Date.now()+t*f.C0),E.oV({label:(0,F.jsx)(p.FormattedMessage,{id:"database.viewSettings.syncedSourceTab.update.rateLimitError",defaultMessage:"This database was synced recently. You may try again in {time}.",values:{time:(0,w.hH)(Date.now(),e)}})})}if(v.default.isAdminMode)return;l.Z.set({userId:t.currentUser.id,key:`${o}:${n}`,value:e}),c(e)}}async function Q(e){const{appTemplatesSetupActions:t,appConfigs:n}=await k.deps.AppTemplates.loader(),{environment:i,selectedDBType:s,collectionName:l,collectionContextStore:p,collectionViewBlockStore:m,collectionViewStore:f,useTemporaryRecordCache:v,temporaryRecordCache:y,baseViewType:_}=e,{currentSpaceViewStore:S}=I.default.state;let w=f,x=m,T=m.getParentStore();var M;v&&(w=f.clone(y),x=m.clone(y),T=null===(M=m.getParentStore())||void 0===M?void 0:M.clone(y));if(s===r.br)C.wd({environment:i,collectionContextStore:p,action:"select_new_collection"}),B.createAndCommit({userAction:"CollectionSettingsNewDBType.handleCreateDB",environment:i,perform:e=>{if(v){R.sW({store:w,data:{name:void 0,format:void 0,query2:void 0,type:_??"table"},transaction:e}),R.sW({store:x,data:{properties:void 0},transaction:e});const t=x.getCollectionViewSourceCollectionStore();t&&h.A9({collectionViewBlockStore:x,collectionStore:t,transaction:e})}h.TM({environment:i,collectionViewStore:w,collectionViewBlockStore:x,name:l,transaction:e});const t=x.getCollectionViewSourceCollectionStore();p.setContext({type:"collectionView",collectionViewBlockStore:m,collectionStore:t,collectionViewStore:f})}}),o.default.afterNextFlush((()=>{h.W1({environment:i,collectionContextStore:p})}));else{const e=s,o=(0,g.YB)(n(),e);if(!o)return;const r=(0,g.Zu)(o,e);if(!r)return;B.createAndCommit({userAction:"CollectionSettingsNewDBType.handleCreateDB",environment:i,perform:e=>{if(!T||T.table!==d.bx&&T.table!==u.e0&&T.table!==c.iU||!S)return;if(!v&&y){i.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(y);x.getCollectionViewStores().forEach((t=>h.dp({collectionViewBlockStore:x,collectionViewStore:t,transaction:e})))}const s=(0,g.KC)(n(),r);t.applyFeatures({environment:i,spaceViewStore:S,appParentStore:T,appUri:o.uri,features:s,createOrModify:"create",initializeStore:x,transaction:e});const l=x.getCollectionViewSourceCollectionStore();if(l){const t=T.table===d.bx?T.id:T.getSpaceId();if(!t)return;for(let o=0;o<3;o++){const n=R.j4({environment:i,type:a.Ti.page,inMemoryRecordCache:x.inMemoryRecordCache,transaction:e,spaceId:t,useCrdt:b.dy({source:"table"===_?"collection_table_view":"collection_non_table_view"})});A.zw({childStore:n,parentStore:l,transaction:e})}const n=x.getCollectionViewStores()[0];p.setContext({type:"collectionView",collectionViewBlockStore:m,collectionStore:l,collectionViewStore:n}),p.filtersBarOpen.setState(!1)}}})}}},87085:(e,t,n)=>{n.d(t,{G0:()=>E,Jw:()=>O,K7:()=>B,PW:()=>F});n(57658),n(21703);var o=n(92996),i=n(90559),r=n(99036),a=n(77657),s=n(74181),l=n(21202),c=n(9844),d=n(75246),u=n(29369),p=n(9291),m=n(53965),f=n(1898),g=n(40663),h=n(75330),v=n(10906),b=n(33929),y=n(77907),_=n(80444),S=n(30874),w=n(6258),k=n(8406),I=n(54642),C=n(74882),x=n(16956),T=n(31869),M=n(5149),P=n(28673),A=n(96802),R=n(13447);const D=(0,p.defineMessages)({aiCustomPromptDefaultPropertyName:{id:"collectionSettingsCreatePropertyActions.createProperty",defaultMessage:"Text"}});async function E(e){var t;const{appTemplatesSetupActions:n,appTemplatesSprintBoardActions:r,appConfigs:p}=await y.deps.AppTemplates.loader(),{environment:m,collectionContextStore:f,feature:h}=e,{currentSpaceViewStore:v}=_.default.state,b=f.collectionStore(),x=f.collectionViewStore(),T=null==b?void 0:b.getParentBlockStore(),D=null==T?void 0:T.getParentStore(),E=null==b||null===(t=b.getFormat())||void 0===t?void 0:t.app_config_uri,B=E&&(0,g.YB)(p(),E);if(!b||!T||!D||D.table!==d.bx&&D.table!==l.iU&&D.table!==u.e0||!B)return;const F=b.getSchema(),O=T.getFormat().app_id,Z=O?await I.getCollectionViewBlocksByAppId(m,{spaceId:T.getSpaceId(),appId:O}):void 0,V="success"===(null==Z?void 0:Z.type)&&Z.data.result.length?Z.data.result.map((e=>w.G.createChildStore(D,{table:l.iU,id:e.blockId,spaceId:T.getSpaceId()}))):[T],U=h.integrationId;if(U){const e=S.Z.getIntegrationsAsRecordMap().getValue({table:c.K2,id:U});if(!e||!(0,s.VM)(e))return;await P.V(m,b,e,Boolean(h.canOnlyAdminAuth))}U===a.U9&&F&&0===(0,i.$z)(F).length&&await C.K({environment:m,collectionStore:b});const L=Date.now();R.createAndCommit({environment:m,userAction:"collectionSettingsCreatePropertyActions.handleCreateNewSuggestedProperty",perform:e=>{var t;if(!B||!v)return;const i=null===(t=b.getFormat())||void 0===t?void 0:t.app_config_uri;if(!i)return;const a=n.applyFeatures({environment:m,spaceViewStore:v,appParentStore:D,appUri:B.uri,features:[{type:"simple",featureUri:h.uri}],transaction:e,createOrModify:"modify",appCollectionViewBlockStores:V});if(r.createSprintPage({environment:m,spaceViewStore:v,appParentStore:D,transaction:e,blockStores:a,creationEntryPoint:{type:"sprint_relation"}}),"notion://tasks/sub_task_feature"===h.uri&&A.FH({stores:[b],update:{subitem_property:o.Es.SubTaskRelation},transaction:e}),"notion://tasks/task_dependencies_feature"===h.uri&&(A.FH({stores:[b],update:{collection_default_arrows_by:o.Es.BlockingRelation},transaction:e}),x&&A.FH({stores:[x],update:{timeline_arrows_by:{property:o.Es.BlockingRelation}},transaction:e})),"dependencies"in h&&h.dependencies.forEach((e=>{"property"===e.type&&e.collectionUri===i&&k._H({environment:m,collectionContextStore:f,from:"view_settings",property:e.uri,property_type:e.propertySchema.type,is_suggested_property:!0})})),"dependencies"in h&&h.dependencies.map((e=>e.type)).every((e=>"property"===e))){const t=f.collectionViewStore(),n=f.getPropertyFormatKey(),o=f.normalizedFormatStore.state;if(n&&t){const i=o[n]||[],r=[...i];h.dependencies.forEach((e=>{const t=i.findIndex((t=>t.property===e.uri));-1===t?r.push({visible:!0,property:e.uri}):r[t]={...i[t],visible:!0}})),A.FH({stores:[t],update:{[n]:r},transaction:e})}}if(void 0!==h.propertyIdCollectionSettingToNavigateTo){const e={type:"property",property:h.propertyIdCollectionSettingToNavigateTo,selectNameInitial:!1,formatKey:f.getPropertyFormatKey()};M.H4({collectionSettingsStore:f.settingsStore,item:e})}e.postSubmitCallbacks.push((e=>{k.mH(m,{collection_uri:h.collectionUri,feature_uri:h.uri,time:Date.now()-L,status:Boolean(e)?"fail":"success"})}))}})}function B(e){let{propertyType:t,collectionContextStore:n,propertyId:o}=e;switch(t){case"ai_custom_prompt":case"ai_summary":case"ai_extract":case"ai_translate":return M.H4({collectionSettingsStore:n.settingsStore,item:{type:"propertyAiAutofill",propertySchema:n.normalizedSchemaStore[o],property:o}});case"ai_keywords":return M.H4({collectionSettingsStore:n.settingsStore,item:{type:"property",property:o,formatKey:n.getPropertyFormatKey()}});default:(0,f.t1)(t)}}function F(e){const{environment:t,collectionContextStore:n,propertyType:o,isSuggestedProperty:i,propertyName:a,selectOptions:s,from:l}=e,c=n.collectionStore(),d=n.collectionViewStore(),u=n.getPropertyFormatKey();if(!c||!u)return;if("relation"===o)return void M.H4({collectionSettingsStore:n.settingsStore,item:{type:"selectRelationSource",property:void 0,formatKey:"collection_page_properties"}});let p=a;"ai_custom_prompt"===o&&(p=b.default.formatMessage(D.aiCustomPromptDefaultPropertyName));const{performResult:m}=R.createAndCommit({userAction:"collectionSettingsCreatePropertyActions.handleCreateNewStandardProperty",environment:t,perform:e=>x.G3({environment:t,collectionStore:c,collectionViewArgs:d?{collectionViewStore:d,format:d.getFormat(),formatKey:u}:void 0,propertyName:p,propertyType:o,selectOptions:s,transaction:e})});(0,r.XU)(o)?B({propertyType:o,propertyId:m,collectionContextStore:n}):M.qU({collectionSettingsStore:n.settingsStore,property:m,formatKey:u,selectNameInitial:!0}),k._H({environment:t,collectionContextStore:n,from:l,property_type:(0,r.TN)(o),property:(0,r.XU)(o)?o:void 0,is_suggested_property:i})}async function O(e){const{environment:t,collectionContextStore:n,intl:o,connectedRelationProperty:s}=e,l=n.collectionStore(),c=n.collectionViewStore(),d=n.getPropertyFormatKey();if(!l||!d)return;const u=s.integration.id;[a.f3,a.mQ].includes(u)||await P.V(t,l,s.integration,Boolean(s.canOnlyAdminAuth));const p=l.getSchema();let g;u===a.U9&&p&&0===(0,i.$z)(p).length&&(g=await C.K({environment:t,collectionStore:l})),R.createAndCommit({environment:t,userAction:"collectionSettingsCreatePropertyActions.handleCreateNewConnectedRelationProperty",perform:e=>{g&&x.G3({environment:t,collectionStore:l,collectionViewArgs:c?{collectionViewStore:c,format:c.getFormat(),formatKey:d}:void 0,propertyType:"auto_increment_id",transaction:e});const i=l.getDeletedSchema(),p=(0,f.qP)(i).map((e=>{let[t,n]=e;if(n&&r.NK(n)&&n.connectedRelation.integration_id===a.U9)return{propertyId:t,propertySchema:n}})).filter(f.$K);if(!m.xb(p)){const{propertyId:o}=p[0],r=(0,v.D8)({deletedSchema:i,property:o});if(!r)throw new Error("Deleted property schema was not found");h.xO({environment:t,collectionStore:l,update:r.updateSchema,transaction:e}),h.$N({collectionStore:l,update:r.updateDeletedSchema,transaction:e});const a={type:"property",property:o,formatKey:d};return void M.H4({collectionSettingsStore:n.settingsStore,item:a})}const b=P.c({environment:t,pattern:s.pattern,integration:s.integration,parentCollectionStore:l,transaction:e}),y=x.G3({environment:t,collectionStore:l,collectionViewArgs:c&&d?{collectionViewStore:c,format:c.getFormat(),formatKey:d}:void 0,propertyType:"relation",transaction:e});T.n7({environment:t,collectionContextStore:n,collectionStore:l,property:y,propertyName:s.name,propertyLimit:"no_limit",targetCollectionStore:b,hasInverseRelation:!0,autoRelate:void 0,intl:o,connectedRelation:{integration_id:u},transaction:e});const _={type:"property",property:y,formatKey:d};M.H4({collectionSettingsStore:n.settingsStore,item:_}),k._H({environment:t,collectionContextStore:n,from:"view_settings",property_type:"relation",integration_id:u})}})}},98834:(e,t,n)=>{n.d(t,{$p:()=>D,R5:()=>P,Zh:()=>M,nx:()=>T,ob:()=>R});n(21703),n(57658);var o=n(41432),i=n(76837),r=n(42875),a=n(23867),s=n(70203),l=n(9291),c=n(21100),d=n(27105),u=n(33929),p=n(18245),m=n(94896),f=n(6258),g=n(81193),h=n(54642),v=n(47307),b=n(54532),y=n(96802),_=n(94419),S=n(9953),w=n(993),k=n(98724),I=n(29373);const C=(0,l.defineMessages)({duplicateTemplateError:{id:"databaseTemplatePickerActions.duplicateTemplateFailedError.message",defaultMessage:"Duplicate template failed."}});function x(e){const{environment:t,pageStore:n,copiedFromPointer:o,useInMemoryRecordCache:s,addCopyName:l,transaction:c,resolveTemplateVariables:d}=e,p=n.useCrdt(),g=new f.G(t,o,{inMemoryRecordCache:s});if(s){const e=b.K8(t,{blockId:g.id,inMemoryRecordCache:g.inMemoryRecordCache,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!1,allowCopyExternalObjectInstances:!0});if(!e)throw new Error("Client copy could not be created.");b.E9({environment:t,sourceBlockId:g.id,targetBlockPointer:n.pointer,sourceBlockSubtree:e,targetInMemoryRecordCache:n.inMemoryRecordCache,addCopyName:l,transaction:c,deepCopyTransclusionContainers:!1,resolveTemplateVariables:d,useCrdt:p})}else{if(A({environment:t,store:n,properties:g.getProperties(),transaction:c}),d&&k.bt({environment:t,store:n,context:{currentUserId:t.currentUser.id,currentTimeZone:(0,r.r)()},transaction:c}),l){const e=n.getBlockTitleStore();w.sO({environment:t,editorMode:"default",store:e,value:i.eb(e.getValue()),transaction:c})}const e={copied_from:o.id};S.sW({store:n,data:e,transaction:c});const{use_crdt:s,text_clocks:f,text_slice_tree:b,automation_id:y,app_config_uri:_,...I}=g.getFormat(),x={...I,copied_from_pointer:o};S.sW({store:n.getFormatStore(),data:x,transaction:c}),g.hasContent()&&(m.Z.setStatus(n.id,!0),c.postSubmitCallbacks.push((async e=>{if(e)return v.showErrorMessage(u.default.formatMessage(C.duplicateTemplateError)),void m.Z.setStatus(n.id,!1);await h.duplicateBlock(t,{sourceBlocks:[{id:o.id,spaceId:(0,a.C)(o.spaceId)}],targetBlocks:[{id:n.id,spaceId:(0,a.C)(n.pointer.spaceId)}],addCopyName:l,appendContentOnly:!0,isTemplateInstantiation:!0,resolveTemplateVariables:!!d&&{currentUserId:t.currentUser.id,currentTimeZone:(0,r.r)()},deepCopyTransclusionContainers:!1,useCrdt:p}).next().finally((()=>{m.Z.setStatus(n.id,!1)}))})))}return n}function T(e){const{environment:t,collectionStore:n,transaction:i,title:r,useCrdt:a}=e,l=S.j4({environment:t,type:o.Ti.page,inMemoryRecordCache:n.inMemoryRecordCache,transaction:i,spaceId:n.getTemplatePagesStore().pointer.spaceId,properties:{title:(0,s.TPx)(r||"")},useCrdt:a});return S.sW({store:l,data:{is_template:!0},transaction:i}),_.R3({parent:n.getTemplatePagesStore(),append:l,transaction:i}),l}function M(e){const{environment:t,event:n,collectionStore:i,templateStore:r,transaction:a}=e,s=S.j4({environment:t,type:o.Ti.page,inMemoryRecordCache:r.inMemoryRecordCache,transaction:a,spaceId:i.getTemplatePagesStore().pointer.spaceId,useCrdt:(0,d.SL)({event:n,source:"collection_instantiate_template",contextualDefault:r.useCrdt()})});S.sW({store:s,data:{is_template:!0},transaction:a}),_.BE({parent:i.getTemplatePagesStore(),after:r,insert:s,transaction:a});try{x({environment:t,copiedFromPointer:r.pointer,pageStore:s,addCopyName:!0,transaction:a,resolveTemplateVariables:!1})}catch(l){v.showErrorMessage(u.default.formatMessage(C.duplicateTemplateError))}return s}function P(e){const{collectionStore:t,templateStore:n,transaction:o}=e;_.Od({parent:t.getTemplatePagesStore(),childToRemove:n,transaction:o})}function A(e){const{environment:t,store:n,properties:o,transaction:i}=e;c.b({environment:t,editorMode:"default",store:n,properties:o,transaction:i})}function R(e){const{environment:t,store:n,templateStore:o,title:i,isKeyboard:r,isCreateIn:a,transaction:s,from:l}=e,c=n.getProperties(),d=p.default.mark("rum.initialize_collection_template");if(x({environment:t,pageStore:n,copiedFromPointer:o.pointer,useInMemoryRecordCache:n.inMemoryRecordCache!==t.defaultRecordCache.inMemoryRecordCache?n.inMemoryRecordCache:void 0,transaction:s,resolveTemplateVariables:!0}),"template"!==i){const e="empty"===i?void 0:i.text;w.sO({environment:t,editorMode:"default",store:n.getBlockTitleStore(),value:e,transaction:s})}A({environment:t,store:n,properties:c,transaction:s}),S.sW({store:n,data:{is_template:null},transaction:s}),y.Wq({environment:t,store:n,isLocked:!1,transaction:s}),0===o.getContentLength()&&I.ls({environment:t,store:n,transaction:s}),p.default.measure(d,{environment:t}),g.XQ(t,{template_id:o.id,collection_id:o.getParentId(),is_keyboard:r,is_create_in:a,from:l})}function D(e){const{collectionStore:t,newTemplateIds:n,transaction:o}=e;S.sW({store:t,data:{template_pages:n},transaction:o})}},30188:(e,t,n)=>{n.d(t,{Bb:()=>le,Cz:()=>me,FC:()=>te,R2:()=>re,VP:()=>de,W9:()=>pe,YE:()=>se,cI:()=>ae,e2:()=>ee,h5:()=>ue,i6:()=>ce,km:()=>ne,rT:()=>X,wA:()=>$,xr:()=>oe});n(57658),n(21703),n(52262),n(24506),n(67294);var o=n(1302),i=n(15145),r=n(92996),a=n(99036),s=n(80951),l=n(21202),c=n(23867),d=n(29369),u=n(95371),p=n(39721),m=n(73597),f=n(70842),g=n(9291),h=n(53965),v=n(7032),b=n(1898),y=n(37810),_=n(75754),S=n(51592),w=n(10906),k=n(97978),I=n(77181),C=n(33929),x=n(29376),T=n(35328),M=n(80444),P=n(77080),A=n(53730),R=n(6258),D=n(36610),E=n(8406),B=n(952),F=n(54642),O=n(54569),Z=n(16956),V=n(31869),U=n(47307),L=n(54532),j=n(96802),N=n(19785),z=n(9953),q=n(79978),W=n(42858),H=n(24677),K=n(13447),G=n(85893);function $(e){const{environment:t,transaction:n,blocks:o,action:i}=e,r=(0,w.fm)(o[0]);if(!r)return;const a=r.subitemTreeStore.state;if(!a)return;const s=r.currentSubitemFormatStoreForUiDisplay.state;if(!s||!s.property)return;const l=r.collectionViewBlockStore();if(!l)return;const c=new u.mp({store:l,pathKey:""},a.map((e=>e)).children),d=function(e,t){const n=new Set(e);let o,i;for(const r of m.JK(t)){if(!n.has(r.value.store)){if(o)return;continue}const e=(0,u.DY)([t],(e=>e===r));if(!e||e.length<2)return;if(o??=e,i=e,n.delete(r.value.store),0===n.size)break}if(o&&i)return f.T.fromNearestCommonAncestor(o,i)}(o,c);if(!d)return;const g=p.o.getIndentOperationsFromTreeRange(d,i),h=new Set,v=[],y="unindentSelf"===i?new Set(g.map((e=>e.target))):new Set;for(const m of g){const{target:e,operation:o}=m,i=(0,u.DY)([c],(t=>t===e));if(void 0===i)return;const a=i[i.length-2];if("indentSelfAndSubtree"===o){if(h.has(a)){h.add(e),v.push(e.value.store);continue}const o=a.children,i=o.indexOf(e);if(0===i)return;const l=o[i-1].value.store;Q({environment:t,parentStore:a.value.store,previousSiblingStore:l,targetStore:e.value.store,subitemFormat:s,transaction:n}),v.push(R.G.createChildStore(l,e.value.store.pointer)),X({collectionContextStore:r,pathKey:(0,I.zV)(a.value.pathKey,l)})}else{if("unindentSelf"!==o)break;{var _;if(y.has(a)){y.delete(e),v.push(e.value.store);continue}if(1===i.length)return;const o=null===(_=i[i.length-3])||void 0===_?void 0:_.value.store;Y({environment:t,parentStore:a.value.store,grandparentStore:o,targetStore:e.value.store,subitemFormat:s,transaction:n}),v.push(R.G.createChildStore(o&&o.isPageBlock()?o:r.collectionViewBlockStore(),e.value.store.pointer))}}if(p.F.applyMutable(c,m))if("indentSelfAndSubtree"===o)h.add(e);else if("unindentSelf"===o){const t=r.subitemExpandedStore.state,n=a.value.pathKey,o=t.get(n);0===a.children.length&&null!=o&&o.isExpanded&&(t.delete(n),r.subitemExpandedStore.emit()),y.delete(e)}else(0,b.t1)(o)}v&&H.Z5({environment:t,stores:v})}function Q(e){const{environment:t,parentStore:n,previousSiblingStore:o,targetStore:i,subitemFormat:r,transaction:a}=e;n.isPageBlock()&&q.Bl({environment:t,sourceStore:n,destStore:i,propertyWithInverse:r,transaction:a}),q.hE({environment:t,sourceStore:o,destStore:i,propertyWithInverse:r,transaction:a,position:{type:"after"}})}function Y(e){const{environment:t,parentStore:n,grandparentStore:o,targetStore:i,subitemFormat:r,transaction:a}=e;q.Bl({environment:t,sourceStore:n,destStore:i,propertyWithInverse:r,transaction:a}),o&&o.isPageBlock()&&q.hE({environment:t,sourceStore:o,destStore:i,propertyWithInverse:r,position:{type:"after",after:n.id},transaction:a})}function J(e){var t,n;const{blocksToDuplicate:o,duplicatedBlocks:i,environment:r,transaction:s,migrateSubitemFormat:l,collectionContextStoreFromPage:c,originalSubitemSchemas:d}=e;if(o.length!==i.length)throw new Error("Error rebuilding relations. blocksToDuplicate and duplicatedBlocks must be the same length");const u=o.at(0);if(!u)return;const{from:p,to:m}=l||function(e){const t=(0,I.g0)(e);if(!t)throw new Error("Error rebuilding relations");const{subitemFormat:n}=t;return{from:n,to:n}}(u),f=(0,w.fm)(u)||c;if(!f)return;const g=(null===(t=f.collectionStore())||void 0===t?void 0:t.getSchema()[p.property])||(null==d?void 0:d.subitemRelationSchema),v=(null===(n=f.collectionStore())||void 0===n?void 0:n.getSchema()[p.inverse])||(null==d?void 0:d.parentRelationSchema);if(!(g&&v&&(0,a.p_)(g)&&(0,a.p_)(v)))return;const b=new Map(h.$R(o.map((e=>e.id)),i));h.$R(o,i).forEach((e=>{let[t,n]=e;const o=(0,I.CJ)({store:t,subitemFormat:{property:p.property},propertySchema:g}),i=(0,I.xb)({store:t,subitemFormat:p,propertySchema:v});o.forEach((e=>{const t=R.G.createChildStore(n,e),o=b.get(e.id);o&&(q.Bl({environment:r,sourceStore:n,destStore:t,propertyWithInverse:p,transaction:s}),q.hE({environment:r,sourceStore:n,destStore:o,propertyWithInverse:m,transaction:s,position:{type:"after"}}))})),i.forEach((e=>{const t=R.G.createChildStore(n,e);b.get(e.id)&&q.Bl({environment:r,sourceStore:t,destStore:n,propertyWithInverse:p,transaction:s})}))}))}function X(e){const{collectionContextStore:t,pathKey:n}=e,o=t.subitemExpandedStore.state,i=o.get(n);null!=i&&i.isExpanded||(o.set(n,{isExpanded:!0,limit:20}),t.subitemExpandedStore.emit())}function ee(e){const t=(0,w.fm)(e);if(!t)return;const n=t.subitemTreeStore.state,o=(0,u.DY)(n.children,(t=>t.value.store===e));if(!o)return;const i=o.map((e=>e.value.store.pointer)),r=(0,I.Af)(i),a=t.subitemExpandedStore.state,s=a.get(r);s&&s.isExpanded&&(a.delete(r),t.subitemExpandedStore.emit())}function te(e){var t;const n=(0,w.fm)(e);if(!n)return;const o=n.subitemTreeStore.state,i=(0,u.DY)(o.children,(t=>t.value.store===e));if(!i)return;const r=n.currentSubitemFormatStoreForUiDisplay.state;if(!r)return;const a=null===(t=n.collectionStore())||void 0===t?void 0:t.getSchema()[r.property];if(!a||"relation"!==a.type)return;if(0===(0,I.CJ)({store:e,subitemFormat:r,propertySchema:a}).length)return;const s=i.map((e=>e.value.store.pointer));X({collectionContextStore:n,pathKey:(0,I.Af)(s)})}function ne(e){var t;const{collectionContextStore:n,relationPropertyId:o,transaction:i,environment:a}=e,s=n.collectionStore();if(!s)return;const l=o?s.getSchema()[o]:void 0,c="relation"===(null==l?void 0:l.type)&&l.property&&"relation"===(null===(t=s.getSchema()[l.property])||void 0===t?void 0:t.type)?l.property:void 0,d=s.getFormat().subitem_property&&o?"collectionViewSubitemActions.changeSubitemProperty":s.getFormat().subitem_property?"collectionViewSubitemActions.turnOffSubitems":"collectionViewSubitemActions.turnOnSubitems";j.FH({stores:[s],update:{subitem_property:o,...s.getFormat().app_config_uri===r.iS?{app_uri_map:{...s.getFormat().app_uri_map?s.getFormat().app_uri_map:{},[r.Es.SubTaskRelation]:o,[r.Es.ParentTaskRelation]:c}}:{}},transaction:i}),k.j(a,"update_subitem_property",{userAction:d})}async function oe(e){const{environment:t,blocks:n,options:o}=e;if(n.some((e=>!e.isPageBlock())))return[];const i=h.Ps(n);if(!i)return[];const r=e.collectionContextStore??(0,w.fm)(i);if(!r)return[];const s=r.collectionStore();if(!s)return[];const l=r.currentSubitemFormatStoreForCollection.state,c=r.normalizedSchemaStore.state,d=(null==l?void 0:l.inverse)&&c[l.inverse];if(!d||!(0,a.p_)(d))return[];const u=d.property;if(!u)return[];const p=s.id,m=s.getSpaceId();if(!n.some((e=>(0,I.CJ)({store:e,subitemFormat:l,propertySchema:d}).length>0)))return[];await A.transactionQueue.drain();const f=await F.getSubitems(t,{collection:{id:p,spaceId:m},blocks:n.map((e=>({id:e.id,spaceId:m}))),childRelationProperty:u,canEdit:null==o?void 0:o.canEdit});return"failed"===f.type?[]:f.data.blocks.map((e=>R.G.createChildStore(s,{table:"block",...e})))}function ie(e){const t=h.Ps(e);if(!t)return[];const n=(0,w.fm)(t);if(!n)return[];const o=n.collectionStore(),i=n.collectionViewBlockStore();if(!o||!i)return[];const r=n.currentSubitemFormatStoreForCollection.state,s=n.normalizedSchemaStore.state,l=(null==r?void 0:r.inverse)&&s[r.inverse];if(!l||!(0,a.p_)(l))return[];if(!l.property)return[];const c=new Set(e.map((e=>e.id)));let d=e;const u=[];for(;d.length>0;){const e=h.xH(d.map((e=>(0,I.CJ)({store:e,subitemFormat:r,propertySchema:l})))).filter((e=>!c.has(e.id))).map((e=>R.G.createChildStore(i,e)));for(const t of e)c.add(t.id);u.push(...e),d=e}return u}function re(e){let{environment:t,blocks:n,recordMaps:o,analyticsFrom:i,transaction:r,migrateSubitemFormat:a,collectionContextStore:s,originalSubitemSchemas:u,useCrdt:p}=e;const m=n.at(0);if(!m)return[];const f=e=>{const n=o?o.get(e.id):L.K8(t,{blockId:e.id,inMemoryRecordCache:e.inMemoryRecordCache,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,skipBlockContent:!0});if(!n)throw new Error("Could not find cached copy of block during sub-item duplication.");return n};n.forEach((e=>{var n;const o=e.getModel();if(!o)return[];const{currentSpaceStore:r}=M.default.getState();let a;r&&o.getParentTable()===d.e0&&o.parent_id&&(a=R.zX.createChildStore(r,{table:d.e0,id:o.parent_id})),B.W(t,{from:i??"copy",type:o.type,teamStore:a,is_toggleable:(0,T._A)(o.type,o.getFormat()),collection_id:e.getAssociatedCollectionId()??(null===(n=e.getCollectionViewCollectionStore())||void 0===n?void 0:n.id),new_page_id:"page"===o.type?e.id:void 0,creating_block_id:e.id})}));const g=n.map((e=>{const n=L.E9({environment:t,transaction:r,sourceBlockId:e.id,targetBlockPointer:{id:(0,v.ZP)(),table:l.iU,spaceId:(0,c.C)(e.pointer.spaceId)},sourceBlockSubtree:f(e),targetInMemoryRecordCache:e.inMemoryRecordCache,addCopyName:!1,deepCopyTransclusionContainers:!m.isTransclusionType(),resolveTemplateVariables:!(m.isInsideTemplate()||m.isInsideFactoryOrDuplicateBlocksAction()),useCrdt:p??e.useCrdt()}).targetBlock;return z.sW({store:n,data:{content:[]},transaction:r}),n}));return J({blocksToDuplicate:n,duplicatedBlocks:g,environment:t,transaction:r,migrateSubitemFormat:a,collectionContextStoreFromPage:s,originalSubitemSchemas:u}),r.postSubmitCallbacks.push((async e=>{e||await Promise.all(n.map(((e,n)=>F.duplicateBlock(t,{sourceBlocks:[{id:e.pointer.id,spaceId:(0,c.C)(e.pointer.spaceId)}],targetBlocks:[{id:g[n].pointer.id,spaceId:(0,c.C)(g[n].pointer.spaceId)}],addCopyName:!1,appendContentOnly:!0,isTemplateInstantiation:!0,resolveTemplateVariables:!1,deepCopyTransclusionContainers:!1,useCrdt:p??e.useCrdt()}).next().finally((()=>{})))))})),g}function ae(e){let{blocks:t,transaction:n,from:o,to:i,environment:r,originAction:a}=e;return t.forEach((e=>{(0,I.dI)({store:e,subitemFormat:{property:o.property},originAction:a}).forEach((t=>{const o=R.G.createChildStore(e,t);q.hE({environment:r,sourceStore:e,destStore:o,propertyWithInverse:i,transaction:n,position:{type:"after"}})}))})),t}async function se(e){let{droppedStores:t,createdStores:n,collectionStore:o,environment:i,collectionContextStore:r,groupsPointer:a,alreadyMovedToCollection:s,shouldDuplicate:l}=e;if(!P.default.checkGate("collection_subitem_nested_operations"))return;const c=t.at(0);if(!c)return;const d=(0,I.g0)(c);let u=(0,I.ko)(o);if(!d)return;const p=await oe({environment:i,blocks:t,options:{canEdit:!0}});if(p.length<=0)return;let m=[...p];if(l){const e=await pe({environment:i,blocks:p,analyticsFrom:"subitem_option_drag_drop"});e&&(m=[...e])}K.createAndCommit({userAction:"collectionGroupActions.handleGroupDrop.subitemsDrop",environment:i,perform:e=>{if(!u){le({transaction:e,collectionContextStore:r,environment:i})&&(u=(0,I.ko)(o))}for(const t of m)O.mp({environment:i,store:t,collectionStore:o,collectionContextStore:r,groupsPointer:a,shouldCoerce:!0,transaction:e,alreadyMovedToCollection:s});u&&ce({blocksToDuplicate:[...t,...p],duplicatedBlocks:[...n,...m],environment:i,shouldDuplicate:l,originSubitemFormat:d.subitemFormat,destinationSubitemFormat:u,transaction:e,subitemRelationSchema:d.childRelationSchema,relationPropertyCollectionId:o.id})}}),D.RO(i,{draggedTypes:h.oA(m.map((e=>e.getType()))),from:"subitem_drag",asCopy:l,optionalAnalyticsProperties:{collectionContextStore:r}})}function le(e){let{transaction:t,collectionContextStore:n,environment:o}=e;if(n.permissionScopes.state.isLocked)return;const i=n.collectionStore(),r=n.collectionViewStore();if(!i)return;const a=i.getModel();if(!a)return;const s=n.normalizedSchemaStore.state,l=x.m8(C.default.getIntl(),{targetCollectionStore:i,isSelfRelation:!0,sourceSchema:s,createUnique:!0,from:"subitem"}),c=x.aI(C.default.getIntl(),{sourceCollection:a,isSelfRelation:!0,targetCollectionStore:i,createUnique:!0,from:"subitem"}),d=Z.G3({environment:o,collectionStore:i,collectionViewArgs:r?{collectionViewStore:r,format:r.getFormat(),formatKey:"collection_page_properties"}:void 0,propertyType:"relation",transaction:t});return V.n7({environment:o,collectionContextStore:n,collectionStore:i,property:d,propertyName:l,targetCollectionStore:i,hasInverseRelation:!0,inverseName:c,autoRelate:{enabled:!1},propertyLimit:"no_limit",intl:C.default.getIntl(),transaction:t,from:"subitem",analyticsFrom:"nested_subitem_operation",onlyCheckPermissions:!0}),ne({environment:o,collectionContextStore:n,relationPropertyId:d,transaction:t}),E._H({environment:o,collectionContextStore:n,from:"nested_subitem_operation",property_type:"relation"}),d}function ce(e){let{blocksToDuplicate:t,duplicatedBlocks:n,environment:o,shouldDuplicate:i,originSubitemFormat:r,destinationSubitemFormat:a,transaction:s,subitemRelationSchema:l,relationPropertyCollectionId:c}=e;i?J({blocksToDuplicate:t,duplicatedBlocks:n,environment:o,transaction:s,migrateSubitemFormat:{from:r,to:a}}):ae({blocks:t,transaction:s,from:r,to:a,environment:o})}async function de(e){var t;let{blocks:n,subitems:o,environment:i,canUndo:r,skipConfirmation:a}=e;const s=o||ie(n),l=[...n,...s];W.zO(l);const c=n.at(0);if(!c)return;const d=(0,w.fm)(c)??(0,I.Ll)(c,i),u=o||await oe({environment:i,blocks:n,options:{canEdit:!0},collectionContextStore:d}),p=null==d||null===(t=d.collectionStore())||void 0===t?void 0:t.getFormat().app_config_uri,m=(0,S.sN)(p,!0),f=(0,S.Q_)(p,!0);if(!a&&u.length>0){const e=await function(e){let{itemCount:t,subitemCount:n,newItemName:o,newItemNamePlural:i}=e;return new Promise((e=>{U.showDialog({onDismiss(){e(!1)},description:(0,G.jsx)(g.FormattedMessage,{id:"deleteSubitems.confirmation.description",defaultMessage:"This will also delete {subitemCount, plural, one {{subitemCount} sub-{newItemName}} other {{subitemCount} sub-{newItemNamePlural}}}.",values:{subitemCount:n,newItemName:o,newItemNamePlural:i}}),message:(0,G.jsx)("div",{style:{fontWeight:y.Z.fontWeight.semibold,fontSize:18},children:(0,G.jsx)(g.FormattedMessage,{id:"deleteSubitems.confirmation.message",defaultMessage:"Are you sure you want to delete {itemCount, plural, one {this {newItemName}} other {these {newItemNamePlural}}}?",values:{itemCount:t,newItemName:o,newItemNamePlural:i}})}),innerStyle:{textAlign:"center"},showCancel:!0,keepFocus:!0,items:[{label:(0,G.jsx)(g.FormattedMessage,{id:"deleteSubitems.confirmation.acceptLabel",defaultMessage:"Delete"}),color:"red",onAccept:()=>{e(!0)}}]})}))}({itemCount:n.length,subitemCount:u.length,newItemName:m,newItemNamePlural:f});if(!e)return W.bj(l),!1}const{serverCommitResult:h}=K.createAndCommit({userAction:"collectionViewSubitemActions.removeBlocksWithSubitems",environment:i,canUndo:r,perform:e=>{W.Cl({environment:i,blocks:n,transaction:e});for(const t of u)z.sW({store:t,data:{alive:!1},transaction:e})}});return await h,!0}async function ue(e){let{environment:t,blocks:n,collectionContextStore:o,useCrdt:r}=e;const a=await oe({environment:t,blocks:n,collectionContextStore:o,options:{canEdit:!0}});await Promise.all(a.map((e=>e.load())));const s=(0,I.JR)(o);if(!s)throw new Error("Could not find subitem info during duplication");const l=s.subitemFormat;K.createAndCommit({userAction:"collectionViewSubitemActions.duplicateBlocksWithSubitemsFromPage",environment:t,perform:e=>{const s=re({blocks:[...n,...a],environment:t,transaction:e,migrateSubitemFormat:{from:l,to:l},collectionContextStore:o,analyticsFrom:"subitem_duplication_page_menu",useCrdt:r}),c=o.collectionStore();if(!c)return;s.map((t=>{N.zw({childStore:t,parentStore:c,transaction:e})}));const d=s.at(0);d&&_._c({environment:t,store:d,pageVisitSource:i.tY.Duplicate})}})}async function pe(e){var t;let{environment:n,blocks:i,analyticsFrom:r}=e;const a=i.at(0);if(!a)return;const s=(0,I.g0)(a),l=null===(t=(0,w.fm)(a))||void 0===t?void 0:t.collectionViewBlockStore();if(!l||!s)return;const{parentRelationProperty:c,parentRelationSchema:d}=s,u=[...i,...ie(i)];W.zO(u);const p=i.at(-1);if(!p)return;const m=await oe({environment:n,blocks:i,options:{canEdit:!0}});let f=[],g=[];K.createAndCommit({userAction:"actionRegistry.duplicateToSelectionWithSubitems",environment:n,perform:e=>{g=re({blocks:[...i,...m],environment:n,transaction:e,analyticsFrom:r}),f=W.is({environment:n,blocks:g,selection:i,transaction:e,replaceEmptyTextBlock:!1,insertAfterBlock:p,preventSetSelection:!0})}});const h=(0,I.T2)({blocks:f,parentRelationProperty:c,parentRelationSchema:d,collectionViewBlockStore:l});return o.default.afterNextFlush((()=>{o.default.afterNextFlush((()=>{H.Z5({environment:n,stores:h})}))})),W.bj(u),g}function me(e){const{environment:t,block:n,collectionStore:o,subitemFormat:i,transaction:r}=e,a=n.getPropertyValue(i.inverse);s.rq(a).forEach((e=>{const a=R.G.createChildStore(o,e);q.Bl({environment:t,sourceStore:n,destStore:a,propertyWithInverse:{property:i.inverse,inverse:i.property},transaction:r})}))}},98688:(e,t,n)=>{n.d(t,{L:()=>f,v:()=>m});var o=n(68626),i=n(45953),r=n(9844),a=n(35794),s=n(53965),l=n(52629),c=n(80444),d=n(72371),u=n(54642),p=n(9377);async function m(e){const{currentSpaceStore:t}=c.default.state;t&&await f({environment:e.environment,spaceId:t.id,force:!0})}async function f(e){const{environment:t,spaceId:n,force:m}=e;if(!t.currentUser.id)return;await c.default.waitUntilRendered();const f=d.Z.state;if(!f.loaded&&!f.loading||f.loaded&&n!==f.spaceId||m){d.Z.setState({...d.Z.state,loading:!0});const e=async()=>{const e=await u.searchIntegrations(t,{query:"",type:"compliance",spaceId:n});return"success"!==e.type?(o.log({level:"error",from:"complianceIntegrationActions",type:"searchIntegrationsError",error:(0,l.Ui)(e.error)}),{status:"rejected",error:e.error}):{status:"resolved",value:e}},c=async()=>{try{return{status:"resolved",value:await p.j({environment:t,spaceId:n})}}catch(e){return o.log({level:"error",from:"complianceIntegrationActions",type:"fetchWebhookSubscriptionsError",error:(0,l.Ui)(e)}),{status:"rejected",error:e}}},[m,f]=await Promise.all([e(),c()]);if("rejected"===m.status||"rejected"===f.status)return;const{value:g}=m,{value:h}=f,v=i.PF.create(g.data.recordMap),b=i.PF.create(h.recordMap);d.Z.setState({loaded:!0,loading:!1,spaceId:n,integrations:s.MR(s.oA(g.data.integrationIds.map((e=>v.getModel({table:r.K2,id:e})))),(e=>{let{created_at:t}=e;return t})),webhookSubscriptions:s.oA(h.webhookSubscriptionIds.map((e=>b.getModel({table:a.bf,id:e,spaceId:n}))))})}}},86080:(e,t,n)=>{n.d(t,{b:()=>r,x:()=>a});var o=n(37850),i=n(81700);function r(e){const t=o.UZ();return i.Z.setState({...e,open:!0,onComplete:t.resolve,inputValue:""}),t.promise}function a(e){const t=i.Z.state;t.open&&(t.onComplete(e.didConfirm),i.Z.reset())}},28673:(e,t,n)=>{n.d(t,{V:()=>h,c:()=>v});n(21703);var o=n(6287),i=n(23867),r=n(9291),a=n(7032),s=n(1898),l=n(70764),c=n(33929),d=n(32363),u=n(6258),p=n(47307),m=n(89475),f=n(9953);const g=(0,r.defineMessages)({authError:{defaultMessage:"Auth failed. Please try again or contact Notion support.",id:"database.viewSettings.propertyTypeSection.connected.authFail"},mobileAdminError:{defaultMessage:"Ask your workspace admin to configure the GitHub (Workspace) app in settings to use this feature.",id:"database.viewSettings.propertyTypeSection.connected.mobileAdminError"},mobileError:{defaultMessage:"Please authorize this integration on the desktop app or a browser.",id:"database.viewSettings.propertyTypeSection.connected.mobileError"}});async function h(e,t,n,o){const i=e.device.isMobile,r=null==t?void 0:t.getSpaceStore();if(!r)return;const a=(0,l.NP)(n.id).length;if(i&&o&&!a){const e=c.default.formatMessage(g.mobileAdminError);throw p.showErrorMessage(e),new Error(e)}if(i&&!o&&!a){const e=c.default.formatMessage(g.mobileError);throw p.showErrorMessage(e),new Error(e)}if(!a&&o&&r.canAdmin()||!a&&!o)try{await m.hM({environment:e,integration:n,spaceId:r.id,from:"collection_settings_property_type"})}catch(s){const e=c.default.formatMessage(g.authError);throw p.showErrorMessage(e),new Error(e)}if(!(0,l.NP)(n.id).length){const e=c.default.formatMessage(g.authError);throw p.showErrorMessage(e),new Error(e)}}function v(e){const{environment:t,pattern:n,integration:r,parentCollectionStore:l,transaction:c}=e;if(!n.connected_relation_properties)throw new Error("Cannot create a connected relation collection without properties");const p=new u.NW(t,{table:o.vF,id:(0,a.ZP)(),spaceId:l.pointer.spaceId}),m={};n.connected_relation_sub_schemas&&(0,s.qP)(n.connected_relation_sub_schemas).map((e=>{let[n,r]=e;const s=new u.NW(t,{table:o.vF,id:(0,a.ZP)(),spaceId:l.pointer.spaceId}),d={bot_id:void 0,external_object_id:void 0,uri:n,integration_id:void 0,is_placeholder:void 0,original_url:void 0,domain:void 0,external_schema:r,sync_state:void 0,pattern_name:void 0},g={id:s.id,version:0,space_id:(0,i.C)(l.pointer.spaceId),parent_table:o.vF,parent_id:p.id,alive:!0,format:d,schema:{}};m[n]=s.id,f.sW({store:s,data:g,transaction:c})}));const g={id:p.id,version:0,space_id:(0,i.C)(l.pointer.spaceId),parent_table:o.vF,parent_id:l.id,alive:!0,format:{attributes:[{id:"title",name:"title",type:"inline",format:{type:"title",section:"title"},values:[(0,d.ni)({pattern:n,integration:r})]}],bot_id:void 0,external_object_id:void 0,uri:`notion://user-defined-collection/${r.id}/${n.name}`,integration_id:r.id,is_placeholder:void 0,original_url:void 0,domain:void 0,external_schema:n.connected_relation_properties,sync_state:void 0,pattern_name:n.name,related_external_object_uris_to_instance_ids:m},schema:{}};return f.sW({store:p,data:g,transaction:c}),p}},50950:(e,t,n)=>{n.d(t,{wk:()=>D,Tz:()=>B,OM:()=>L,qo:()=>j,oG:()=>N,dd:()=>z,Nh:()=>F,a9:()=>Z});n(67294);var o=n(15145),i=n(86658),r=n(74686),a=n(55632),s=n(68626),l=n(9291),c=n(53965),d=n(52629),u=n(15828),p=n(19584),m=n(54642),f=n(480),g=n(24405),h=n(56666),v=n(10182),b=n(89728),y=n(85893);const _=function(){const e=(0,f.O7)(),t=(0,g.Fg)();return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(b.Z,{onClick:()=>L(e,{necessary:!0,performance:!0,preference:!0,targeting:!0}),children:(0,y.jsx)("b",{style:{color:t.contentBackground},children:(0,y.jsx)(l.FormattedMessage,{...i.ze.acceptAllButtonLabel})})}),(0,y.jsx)(b.Z,{onClick:()=>L(e,{necessary:!0,performance:!1,preference:!1,targeting:!1}),children:(0,y.jsx)("b",{style:{color:t.contentBackground},children:(0,y.jsx)(l.FormattedMessage,{...i.ze.rejectAllButtonLabel})})}),(0,y.jsx)(v.Z,{hasDismissButton:!0,renderOrigin:e=>(0,y.jsx)(b.Z,{style:{paddingLeft:8,paddingRight:8},...e,children:(0,h.o)({width:14,marginLeft:4,fill:t.contentBackground})})})]})};var S=n(42402),w=n(97978),k=n(12955),I=n(33929),C=n(36867),x=n(80444),T=n(61893),M=n(45293),P=n(1310),A=n(47307);const R=(0,l.defineMessages)({cookieConsentSaveError:{id:"cookieConsent.saveError",defaultMessage:"Cannot record cookie consent, please try again later."}});async function D(e){const{environment:t,onboardingState:n}=e;if(await E(t))return(0,C.g)(t.currentUser.id)>=2?(U(),M.Z.setState({open:!0}),W({environment:t,type:"modal",onboardingState:n}),void w.j(t,"cookie_modal_shown")):void(P.ZP.state.currentItem||(P.ZP.setState({...P.ZP.state,currentItem:{key:(0,u.ZP)(),label:(0,y.jsx)("div",{children:(0,i.Fd)(B,"snackbar")}),right:(0,y.jsx)(_,{})}}),W({environment:t,type:"snackbar",onboardingState:n})))}async function E(e){if(!(0,k.canSetCookie)(e))return!1;if(!(0,k.canShowCookieUi)(e))return!1;const t=await(0,k.getHasPermissionArgs)(e);return"true"===(null==t?void 0:t.notion_check_cookie_consent)&&(null==t||!t.notion_cookie_consent)}function B(e,t){return(0,y.jsx)(S.Z,{href:e,children:t})}function F(e,t){if("necessary"===t)return;const n={...T.Z.getState().permission};n[t]=!n[t],T.Z.setPermission(n),O(e,n)}const O=c.Ds(((e,t)=>{Z(e,t)}),2e3);async function Z(e,t){const n=await m.recordCookieConsent(e,{id:T.Z.getId(),permission:t,document_version:i.fV,userId:e.currentUser.id}).catch((e=>{V({type:"recordCookieConsentError",error:(0,d.Ui)(e)})}));if(!n)return void V({type:"recordCookieConsentEmptyResult"});if("success"!==n.type)return void V({type:"recordCookieConsentReturnsNonSuccess",data:{miscDataToConvertToString:{result:n}}});const s=n.data;await T.Z.setCookieConsent(e,s),o.e9();const l=await w.cG(e),c=o.Zk(l);await a.Pv(c);const{permission:u}=s;w.j(e,"record_cookie_consent",{permission:u,consent_type:(0,r.JT)(u)})}function V(e){let{type:t,data:n,error:o}=e;A.showErrorMessage(I.default.formatMessage(R.cookieConsentSaveError)),s.log({level:"error",from:"cookieActions",type:t,data:n,error:o})}function U(){P.ZP.setState({...P.ZP.state,currentItem:void 0})}function L(e,t){Z(e,t),U(),j()}function j(){A.showMessage({message:I.default.formatMessage(i.ze.reloadAfterSaveMessage),onAccept:()=>{window.location.reload()}})}async function N(e){const{currentUserSettingsStore:t}=x.default.state;if(!t)return;await t.load();const n=t.getSettings();if(!n)return;const o=n.cookie_consent;o?(await T.Z.setCookieConsent(e,o),U()):(T.Z.clearCookieConsent(),await E(e)&&T.Z.setPermission(i.cW))}async function z(e){const t=await(0,k.getCookieConsentCookie)(e);if(!t)return;const n=(0,p.dj)(t);n&&T.Z.setState(n)}const q={tracked:!1};function W(e){let{environment:t,type:n,onboardingState:o}=e;if(q.tracked)return;const i={type:n,onboardingStage:null==o?void 0:o.stage};w.j(t,"cookie_banner_shown",i),q.tracked=!0}},41433:(e,t,n)=>{n.d(t,{Ns:()=>M,ZI:()=>A,fC:()=>P,jf:()=>R,nF:()=>T});n(21703),n(57658);var o=n(80951),i=n(97531),r=n(76837),a=n(42875),s=n(59730),l=n(15157),c=n(482),d=n(19233),u=n(45953),p=n(21202),m=n(19889),f=n(70203),g=n(67175),h=n(7032),v=n(1898),b=n(95477),y=n(83960),_=n(80444),S=n(6258),w=n(952),k=n(96802),I=n(9953),C=n(993),x=n(13447);const T="calloutBlockIcon",M="calloutBlockBackground";function P(e){var t,n,o;const{environment:i,createBlockItem:r,from:a,inMemoryRecordCache:s,transaction:l,useCrdt:c,selection:d}=e;if(!r.templateRootBlockId||!r.createTemplate)throw new Error("Invalid createBlock item.");const m=(null===(t=_.default.state.currentSpaceStore)||void 0===t?void 0:t.id)??(null===(n=_.default.state.mainEditorCurrentBlockStore)||void 0===n?void 0:n.getSpaceId()),{targetBlock:f}=A({environment:i,sourceBlockId:r.templateRootBlockId,targetBlockPointer:{id:(0,h.ZP)(),table:p.iU,spaceId:m},sourceBlockSubtree:(0,u.R3)(r.createTemplate(i)),targetRecordCache:s,transaction:l,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,useCrdt:c});if(null===(o=r.postCreateCallback)||void 0===o||o.call(r,f,i),R({store:f,transaction:l}),a&&r.blockType){var g,v;const e=r.collectionViewType,t=0!==d.length?null===(g=d[0])||void 0===g?void 0:g.getParentCollectionIdUpToTwoLevels():void 0;w.W(i,{from:a,type:r.blockType,collection_id:f.getAssociatedCollectionId()??(null===(v=f.getCollectionViewCollectionStore())||void 0===v?void 0:v.id),view_type:"inline"===e||"full_page"===e?"table":e,is_toggleable:r.isToggleable,automation_id:f.getAutomationId(),new_page_id:"page"===r.blockType?f.id:void 0,creating_block_id:f.id,parent_collection_id:t})}return f}function A(e){const{environment:t,sourceBlockId:n,sourceBlockSubtree:o,targetBlockPointer:l,targetRecordCache:d,transaction:u,deepCopyTransclusionContainers:f,resolveTemplateVariables:h,recordPointerMap:y,useCrdt:_}=e,w=t.currentUser.id,{duplicateRecordMap:k,originalToDuplicate:C}=r.PZ({sourceBlockId:n,targetBlockPointer:l,recordMap:o,recordPointerMap:y,options:{deepCopyTransclusionContainers:f,resolveTemplateVariables:!!h&&{currentUserId:w,currentTimeZone:(0,a.r)()}},baseUrl:b.default.domainBaseUrl,publicDomainName:b.default.publicDomainName,actor:w?{table:m.KJ,id:w}:void 0,getRecordRole:d.makeGetRecordRoleFn(w),duplicateForCrdt:_}),T=new S.G(t,l,{inMemoryRecordCache:d});u.postPerformAssertions.push((function(){if(u.isLocal)return;if(!T.getParentStore())throw new s.p8(`Initialized template was not given a parent before being committed in transaction ${u.getUserActionForAnalyticsPurposesOnly()}`)}));for(const{model:r}of k)if(r)if(r.table===p.iU){var M,P;const e=r.__IM_SORRY__getValue(),t=S.G.createChildStore(T,r.pointer),n=i.nY(r.getFormat()),o=i.nY((null===(M=d.getRecord({pointer:r.pointer,userId:w}))||void 0===M||null===(M=M.value)||void 0===M?void 0:M.format)??{}),a=c.op.update({pointer:r.pointer,path:["format"],args:(0,v.Yd)(o).reduce(((e,t)=>t in n&&void 0!==n[t]?e:{...e,[t]:null}),{})}),s=r.pointer.table===l.table&&r.pointer.id===l.id?null===(P=d.getRecord({pointer:r.pointer,userId:w}))||void 0===P?void 0:P.value:void 0,p=s?i.Ry({existingBlock:s,duplicateBlock:e}).concat([a]):i.mz({block:e,useCrdt:_});for(const i of p)(0,g.Qf)(i)?x.applyCrdtTextOperation({store:t,operation:i,invertedOperation:void 0,transaction:u}):x.applyOperation({store:t,operation:i,transaction:u})}else{const e=r.__IM_SORRY__getValue(),t=(0,S.Kv)(T,r.pointer);I.sO({store:t,value:e,transaction:u})}return{targetBlock:T,originalToDuplicate:C}}function R(e){const{store:t,transaction:n}=e;"code"===t.getType()?function(e){const{store:t,transaction:n}=e,i=t.getProperties(),r=t.getFormat(),a=t.environment.currentUser.id,s=l.Z.get({userId:a,key:y.T.localLanguagePreferenceKey}),c=s&&d.W[s]?s:y.T.defaultLanguage,u=l.Z.get({userId:a,key:y.T.localCodeWrapPreferenceKey}),p=t.getBlockTitleStore(),m=p.getValue(),g=f.vNd(m);g&&C.sO({environment:t.environment,editorMode:"default",store:p,value:g,transaction:n});void 0===i.language&&I.sW({store:t.getPropertiesStore(),data:{language:o.O2(c)},transaction:n});void 0===r.code_wrap&&I.sW({store:t.getFormatStore(),data:{code_wrap:u},transaction:n})}({store:t,transaction:n}):"table_of_contents"===t.getType()?function(e){const{store:t,transaction:n}=e,o=t.getFormat();void 0===o.block_color&&k.FH({stores:[t],update:{block_color:"gray"},transaction:n})}({store:t,transaction:n}):"callout"===t.getType()?function(e){const{store:t,transaction:n}=e,o=t.environment.currentUser.id,i=l.Z.get({userId:o,key:T})||"ðŸ’¡",r=l.Z.get({userId:o,key:M})||"gray_background",a=t.getFormat();void 0===a.block_color&&k.FH({stores:[t],update:{block_color:r},transaction:n});void 0===a.page_icon&&k.FH({stores:[t],update:{page_icon:i},transaction:n})}({store:t,transaction:n}):"quote"===t.getType()&&function(e){const{store:t,transaction:n}=e,o=t.environment.currentUser.id,i=l.Z.get({userId:o,key:y.l.localSizePreferenceKey});void 0!==i&&I.sW({store:t.getFormatStore(),data:{quote_size:i},transaction:n})}({store:t,transaction:n})}},67133:(e,t,n)=>{n.d(t,{b:()=>a,x:()=>s});var o=n(28748),i=n(24677),r=n(98104);function a(e,t){i.ZH(e),r.ZH(e),o.Z.setState({open:!0,...t})}function s(){o.Z.setState({open:!1,originRect:o.Z.state.originRect})}},99813:(e,t,n)=>{n.d(t,{Wl:()=>b,ji:()=>g,oi:()=>h});var o=n(43593),i=n(17755),r=n(68626),a=n(11342),s=n(37850),l=n(95477),c=n(88864),d=n(54642),u=n(47839),p=n(12714);function m(e){if(!Boolean(e.mobileNative))return!1;const{device:t}=e,n=(0,a.parseMobileAppVersion)(t.mobileAppVersion,t.isAndroid);return!!n&&(t.isIOS?(0,a.isGreaterThanOrEqualToVersion)(n,[0,4,669]):!!t.isAndroid&&(0,a.isGreaterThanOrEqualToVersion)(n,[0,6,735]))}async function f(e,t){return e.device.isElectron||e.device.isMobileNative?await d.getSignedFileUrl(e,t,!1):(0,i.g)({...t,baseURL:l.default.domainBaseUrl,currentUserId:e.currentUser&&e.currentUser.id})}async function g(e,t){let n=t.url;const a=e.mobileNative&&m(e),c=o.E$(t.url,[l.default.secureFileS3.url,l.default.secureFileS3V2.url]);c&&(a&&e.mobileNative.showLightBoxV2({url:void 0,downloadName:t.downloadName,type:"file",from:"download",state:"fetching"}),n=(await s.OI(i.nK,f(e,t))).result),n?c&&a?e.mobileNative.showLightBoxV2({url:n,downloadName:t.downloadName,type:"file",from:"download",state:"url_ready"}):c?v({environment:e,url:n}):p.D({environment:e,url:n}):(a&&e.mobileNative.showLightBoxV2({url:void 0,downloadName:t.downloadName,type:"file",from:"download",state:"error"}),r.log({level:"error",from:"routerActions",type:"openFileUrl",data:{message:`failed to get url for ${t.url}`}}))}function h(e,t){const n=e.mobileNative&&m(e);if(o.x$(t)&&n){const n=o.rF({title:void 0,source:t});e.mobileNative.showLightBoxV2({url:void 0,downloadName:n,type:"file",from:"download",state:"fetching"}),e.mobileNative.showLightBoxV2({url:t,downloadName:n,type:"file",from:"download",state:"url_ready"})}else v({environment:e,url:t})}function v(e){const{environment:t,url:n}=e;t.mobileNative?t.mobileNative.openInAppBrowser(n):t.device.isElectron?u.downloadUrl(n):window.location.href=n}async function b(e,t){c.QI(e,{from:"embedded_block_click",type:t.type});let n=t.url;const a=e.mobileNative&&m(e),d=o.E$(t.url,[l.default.secureFileS3.url,l.default.secureFileS3V2.url]);d&&(a&&e.mobileNative.showLightBoxV2({url:void 0,downloadName:t.downloadName,type:t.type,from:t.from,state:"fetching"}),n=(await s.OI(i.nK,f(e,t))).result),n?d&&a?e.mobileNative.showLightBoxV2({url:n,downloadName:t.downloadName,type:t.type,from:t.from,state:"url_ready"}):p.D({environment:e,url:n}):(a&&e.mobileNative.showLightBoxV2({url:void 0,downloadName:t.downloadName,type:t.type,from:t.from,state:"error"}),r.log({level:"error",from:"routerActions",type:"openFileUrl",data:{message:`failed to get url for ${t.url}`}}))}},42239:(e,t,n)=>{n.d(t,{LQ:()=>F,_4:()=>D,cQ:()=>A,eN:()=>O,f$:()=>B,fX:()=>R,td:()=>E});n(57658);var o=n(41432),i=n(15095),r=n(42875),a=n(23867),s=n(31701),l=n(53965),c=n(7032),d=n(1898),u=n(10906),p=n(95477),m=n(97978),f=n(43250),g=n(98165),h=n(41984),v=n(27406),b=n(81844),y=n(95802),_=n(55367),S=n(86486),w=n(27724),k=n(36610),I=n(47307),C=n(54532),x=n(42858),T=n(24677),M=n(98724),P=n(98104);function A(e,t){_.ZP.state.isDragging&&(_.ZP.reset(),T.$Y({environment:e,phase:w.SelectionPhase.Selected,preventClearEditingText:t}))}function R(e){if(_.ZP.state.isDragging){const{draggedStores:i,currentDropZone:r}=_.ZP.state,a=e.optionKey;let s;if(r){var t,n;const e=r.type===_.Dl.Selectable?y.C.findSelectablesFromStore(r.store):v.Z.findDropTargetsFromKey(r.key);null===(t=e.find((e=>Boolean(e.props.onSelectableDrop))))||void 0===t||null===(t=t.props)||void 0===t||null===(n=t.onSelectableDrop)||void 0===n||n.call(t,{droppedDirection:r.direction,droppedStores:i,duplicate:a}),s=function(e,t){const n=t.props,o="store"in n?n.store:void 0,i=o?b.Z.findOutlinerItemFromStore(o):void 0,r=o&&g.VP(o),a=r&&(0,m.nB)(r),s={...i&&{...a,type:i.type},..."analyticsName"in n&&{dropzone_from:n.analyticsName}};if(!e)return{...s,has_dropzone:!1};let l;switch(e.direction){case _.vh.Above:l="above";break;case _.vh.Below:l="below";break;case _.vh.Left:l="left";break;case _.vh.Onto:l="onto";break;case _.vh.Right:l="right";break;default:(0,d.t1)(e.direction)}if(e.type===_.Dl.Selectable)return{...s,has_dropzone:!0,dropzone_type:"selectable",dropzone_block_id:(0,c.cj)(e.store.id),dropzone_direction:l};return{...s,has_dropzone:!0,dropzone_type:"drop_target",dropzone_key:e.key,dropzone_direction:l}}(r,e[0])}const p=i.find((e=>{const t=e.getType();return Boolean(t&&(0,o.S9)(t))})),f=p&&g.VP(p),h=p&&(0,u.fm)(p);k.RO(e.environment,{draggedTypes:l.oA(i.map((e=>e.getType()))),from:e.analyticsFrom,asCopy:a,draggableProps:{draggable_from:e.analyticsFrom,...f&&(0,m.nB)(f)},dropzoneProps:s,optionalAnalyticsProperties:{collectionContextStore:h}}),A(e.environment),e.environment.device.isPhone&&T.ZH(e.environment)}}function D(e){const{environment:t,files:n,analyticsFrom:o}=e;if(_.ZP.state.isDragging){var i;const e=_.ZP.state.currentDropZone;let s;var r,a;if(e)s=e.type===_.Dl.Selectable?y.C.findSelectableFromStore(e.store):v.Z.findDropTargetFromKey(e.key),null===(r=s)||void 0===r||null===(r=r.props)||void 0===r||null===(a=r.onNativeDrop)||void 0===a||a.call(r,{files:n,droppedDirection:e.direction});k.RO(t,{draggedTypes:[],from:o,asCopy:!1}),A(t,null===(i=s)||void 0===i?void 0:i.props.keepTextSelectionOnDrop)}}function E(e,t){_.ZP.state.isDragging&&(P.ZH(e),_.ZP.setState({..._.ZP.state,...t}))}function B(e,t){if(_.ZP.state.isDragging)return!1;{const{startX:n,startY:o,isNativeDrag:i}=t,r=T.aw(t.stores);P.ZH(e);const a=y.C.getRectFromStore(r[0]);return _.ZP.setState({isDragging:!0,startX:n,startY:o,currentX:n,currentY:o,offsetX:n-(a&&a.left||0),offsetY:o-(a&&a.top||0),currentHintDropZones:[],draggedStores:r,isNativeDrag:i,ghostElements:r.map((e=>t.getGhostElement?t.getGhostElement(e):function(e){const{store:t}=e,n=y.C.findSelectablesFromStore(t);return l.oA(n.map((e=>{if(e.props.canSelect){const t=e.getNode();if(t)return O(t)}})))}({store:e})))}),T.$Y({environment:e,phase:w.SelectionPhase.Selected}),S.default.reset(),!0}}function F(e){const{droppedStores:t,transaction:n,environment:i,duplicate:s,duplicateUseCrdt:l}=e,c=e.resolveTemplateVariables;return t.map((e=>{if(!y.C.findSelectableFromStore(e))return e;if(s){const t=!e.isTransclusionType(),[r,s]=C.Qi({environment:i,stores:[e],addCopyName:(0,h.Z)(e),transaction:n,deepCopyTransclusionContainers:t,targetSpaceId:(0,a.C)(e.pointer.spaceId),resolveTemplateVariables:e.getType()!==o.Ti.factory&&c,baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:"same_as_store"===l?e.useCrdt():l}),d=r[0];return s.then((e=>{e&&I.showErrorMessage(e)})),d}return c&&M.bt({environment:i,store:e,context:{currentUserId:i.currentUser.id,currentTimeZone:(0,r.r)()},transaction:n}),x.Od({store:e,transaction:n}),e}))}function O(e){const t=e.style.transform,n=e.style.transition;e.style.transform="",e.style.transition="";const o=e.getBoundingClientRect();e.style.transform=t,e.style.transition=n;const i=e.cloneNode(!0);!function(e,t){const{firstElementChild:n}=e;if(n&&n.hasAttribute("embed-ghost")){const n=Z(e,[]);if(n){const i=V(e,n),r=V(t,n);if(i&&r)if(i.shadowRoot){const e=i.shadowRoot;let t=null;if(r.createShadowRoot)t=r.createShadowRoot();else if(r.attachShadow)try{t=r.attachShadow({mode:"open"})}catch(o){}t&&(t.innerHTML=e.innerHTML)}else if(!i.src&&i.contentDocument){const e=document.createElement("iframe");e.width=i.offsetWidth,e.height=i.offsetHeight,U(e,r),r.parentElement.replaceChild(e,r),e.onload=t=>{const n=e.contentDocument.children[0],o=i.contentDocument.children[0];U(n,o),n.innerHTML=o.innerHTML}}else r.width=i.offsetWidth,r.height=i.offsetHeight,r.style.backgroundColor=s.ZP.blackWithAlpha(.12),r.style.backgroundImage=null,r.src=""}}}(e,i);const r=getComputedStyle(e);for(let s=0;s<r.length;s++){const e=r[s],t=r.getPropertyValue(e);"app-region"===e&&"none"===t||(i.style[e]=t)}"absolute"!==r.position&&"relative"!==r.position||(i.style.position="",i.style.top="",i.style.left="",i.style.bottom="",i.style.right="");const a=i.querySelectorAll(`.${f.No6}`);for(const s of a)s.remove();i.style.pointerEvents="none";const l=i.querySelectorAll("*");for(const s of l)s.style&&(s.style.pointerEvents="none");return{cloned:i,rect:o}}function Z(e,t){if(e.shadowRoot)return t;if(e instanceof HTMLIFrameElement)return t;{const{firstElementChild:n,nextElementSibling:o}=e;if(n){t.push(0);const e=Z(n,t);if(e)return e;t.pop()}if(o){t[t.length-1]+=1;const e=Z(o,t);if(e)return e}return null}}function V(e,t){return t.reduce(((e,t)=>e&&e.children&&e.children[t]?e.children[t]:null),e)}function U(e,t){i.p4(t.attributes).forEach((t=>{let{name:n,value:o}=t;e.setAttribute(n,o)}))}},91584:(e,t,n)=>{n.d(t,{O$:()=>k,Ui:()=>b,WO:()=>y,cR:()=>S,qN:()=>w,vQ:()=>_});var o=n(99405),i=n(23867),r=n(9291),a=n(18265),s=n(57549),l=n(47307),c=n(47839),d=n(95477),u=n(91924),p=n(7844),m=n(53730),f=n(54642),g=n(92625),h=n(15356);const v=(0,r.defineMessages)({authenticatingWithGoogle:{id:"googleDriveActions.authenticatingWithGoogle.loadingMessage",defaultMessage:"Authenticating with Googleâ€¦"},googleLoginTitle:{defaultMessage:"Google login",id:"googleDriveActions.loginWithGoogleModal.title"}});async function b(e){const{environment:t,store:n,fileId:o,token:r}=e;await m.transactionQueue.awaitRecordTransaction(n.pointer);const a=await f.initializeGoogleDriveBlock(t,{block:{id:n.id,spaceId:(0,i.C)(n.pointer.spaceId)},fileId:o,token:r});if("failed"!==a.type)return a.data.file&&s.cV(t,{file_type:a.data.file.mimeType??void 0}),a.data;l.showError(a)}function y(e,t){f.refreshGoogleDriveBlock(e,{block:t})}async function _(e){const t=await f.getGoogleDriveAccounts(e,{});return"success"===t.type&&t.data.accounts?t.data:{accounts:[]}}function S(e,t){const{onSuccess:n,onFailure:o}=t;p.Z.setState({open:!0,onConfirm:async()=>{const t=await w(e);t&&t.token?n(t.token):o&&o()},onDecline:o})}async function w(e){const t=(0,u.eC)(e);let n=(0,o.ZQ)(d.default.domainBaseUrl,{authType:t});if(n=t.redirectToAuth?n:await(0,u.HU)(e,n),e.device.isElectron)return void c.openExternalUrl(n);const i=await h.M(e,{width:610,height:700,url:n,titleMessage:v.googleLoginTitle});if(!i)return;const r=a.Qc(i);return await k(e,r.query.code)}async function k(e,t){if(!t)return;g.j({message:v.authenticatingWithGoogle});const n=await f.authWithGoogleForDrive(e,{code:t});if(g.x(),"failed"!==n.type)return s.L3(e,{integration_name:"google"}),n.data;{const e=n.error;console.error(e),l.showError(n)}}},54532:(e,t,n)=>{n.d(t,{E9:()=>U,K8:()=>N,Qi:()=>j,WJ:()=>L});n(21703),n(57658);var o=n(41432),i=n(97531),r=n(76837),a=n(42875),s=n(59730),l=n(64572),c=n(59753),d=n(45953),u=n(606),p=n(98963),m=n(18844),f=n(21202),g=n(6287),h=n(13493),v=n(23867),b=n(29369),y=n(70203),_=n(9291),S=n(37850),w=n(7032),k=n(95477),I=n(33954),C=n(33929),x=n(35328),T=n(80444),M=n(88632),P=n(6258),A=n(952),R=n(54642),D=n(41433),E=n(47307),B=n(29533),F=n(9953),O=n(993),Z=n(39865);const V=(0,_.defineMessages)({offlineError:{id:"duplicateActions.offlineError.message",defaultMessage:"Please go online to copy this block."},unknownError:{id:"duplicateActions.unknownError.message",defaultMessage:"An unknown error occurred."}});function U(e){const{environment:t,sourceBlockId:n,targetBlockPointer:o,sourceBlockSubtree:i,targetInMemoryRecordCache:a,addCopyName:s,deepCopyTransclusionContainers:l,resolveTemplateVariables:c,transaction:d,useCrdt:u}=e,{targetBlock:p,originalToDuplicate:m}=D.ZI({environment:t,sourceBlockId:n,targetBlockPointer:o,sourceBlockSubtree:i,targetRecordCache:a,transaction:d,deepCopyTransclusionContainers:l,resolveTemplateVariables:c,useCrdt:u});if(s&&p&&p.isNavigableBlock()){const e=p.getTitleStore();if(e){const n=e.getValue(),o=r.eb(n);O.sO({environment:t,editorMode:"default",store:e,value:o,transaction:d})}}return{targetBlock:p,originalToDuplicate:m}}function L(e){const{environment:t,sourceBlocks:n,targetInMemoryRecordCache:i,snapshotData:r,addCopyName:l,deepCopyTransclusionContainers:c,resolveTemplateVariables:d,transaction:u,targetSpaceId:p,convertExternalObjectInstancesToPlaceholders:m,useCrdt:f,duplicateOnlyCollectionSchema:g}=e;if(0===n.length)throw new Error("Must duplicate at least one block");const h=n.map(((e,n)=>F.j4({environment:t,type:o.Ti.copyIndicator,inMemoryRecordCache:i,transaction:u,spaceId:p,useCrdt:f}))),b=S.UZ();return u.postSubmitCallbacks.push((async e=>{if(e)(0,s.Jx)(e)?b.resolve((0,I.nX)(C.default.getIntl(),e)):b.resolve(C.default.formatMessage(V.unknownError));else{const e=R.duplicateBlock(t,{sourceBlocks:n,targetBlocks:h.map((e=>({id:e.id,spaceId:e.getSpaceId()}))),snapshotData:r,addCopyName:l,deepCopyTransclusionContainers:c,resolveTemplateVariables:!!d&&{currentUserId:t.currentUser.id,currentTimeZone:(0,a.r)()},convertExternalObjectInstancesToPlaceholders:m,useCrdt:f,duplicateOnlyCollectionSchema:g});let o;for await(const t of e){for(const e of h)B.R(t,e.id);o=t}for(const t of h)B.h(t.id);if(!o)return void b.resolve(void 0);if(o.error){f?R.deleteBlocks(t,{blocks:h.map((e=>({id:e.id,spaceId:(0,v.C)(e.pointer.spaceId)}))),permanentlyDelete:!1}):Z.Tq({environment:t,blocks:h});const e=(0,I.HV)(C.default.getIntl(),o.error);b.resolve(e)}else b.resolve(void 0)}})),[h,b.promise]}function j(e){const{environment:t,stores:n,addCopyName:o,deepCopyTransclusionContainers:i,resolveTemplateVariables:r,transaction:a,targetSpaceId:s,preferDuplicateLocation:l,analyticsFrom:c,useCrdt:d,duplicateOnlyCollectionSchema:u}=e;if(0===n.length)throw new Error("Must duplicate at least one block");const p=n[0].getSpaceId();if(!n.every((e=>e.getSpaceId()===p)))throw new Error("All stores must be in the same space");if(n.length>1&&!n.every((e=>e.isTypedCollectionViewBlock())))throw new Error("Multiple source blocks only supported for grouped typed DB duplication");for(const f of n){const e=f.getRecordStoreAtRootPath().getValue();let n;const{currentSpaceStore:o}=T.default.getState();var m;if(o&&(null==e?void 0:e.parent_table)===b.e0&&(n=P.zX.createChildStore(o,{table:b.e0,id:e.parent_id})),e)A.W(t,{from:c??"copy",type:e.type,teamStore:n,is_toggleable:(0,x._A)(e.type,e.format),collection_id:f.getAssociatedCollectionId()??(null===(m=f.getCollectionViewCollectionStore())||void 0===m?void 0:m.id),new_page_id:"page"===e.type?f.id:void 0,creating_block_id:f.id,parent_collection_id:f.getParentCollectionIdUpToTwoLevels()})}const g=p!==s;if("local"===l&&1===n.length){const e=n[0],l=N(t,{blockId:e.id,inMemoryRecordCache:e.inMemoryRecordCache,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!i,allowCopyExternalObjectInstances:!g});if(l){const{targetBlock:n}=U({environment:t,sourceBlockId:e.id,targetBlockPointer:{id:(0,w.ZP)(),table:f.iU,spaceId:s},sourceBlockSubtree:l,targetInMemoryRecordCache:e.inMemoryRecordCache,addCopyName:o,deepCopyTransclusionContainers:i,resolveTemplateVariables:r,transaction:a,useCrdt:d});return[[n],Promise.resolve(void 0)]}}for(const f of n)if(f.inMemoryRecordCache!==t.defaultRecordCache.inMemoryRecordCache)throw new Error("Can only server duplicate from the environment.defaultRecordCache.inMemoryRecordCache.");const h=t.defaultRecordCache.inMemoryRecordCache;return M.Z.state.online||E.showErrorMessage(C.default.formatMessage(V.offlineError)),L({environment:t,sourceBlocks:n.map((e=>({id:e.id,spaceId:e.getSpaceId()}))),targetInMemoryRecordCache:h,addCopyName:o,transaction:a,deepCopyTransclusionContainers:i,resolveTemplateVariables:r,targetSpaceId:s,convertExternalObjectInstancesToPlaceholders:g,useCrdt:d,duplicateOnlyCollectionSchema:u})}function N(e,t){const{blockId:n,inMemoryRecordCache:r,allowCopyCollections:a,requireFullSubtree:s,skipTransclusionContainerChildren:v,allowCopyExternalObjectInstances:b,skipBlockContent:_,excludeCrdtData:S}=t,w=e.currentUser.id,I=d.Ak.create(),C=new Set,x=[{pointer:{table:f.iU,id:n},parentId:"doesn't matter"}];for(;x.length>0;){const e=x.shift();if(!e)continue;if(C.has(e.pointer.id))continue;const t=n===e.pointer.id;if((0,u.$O)(e.pointer,f.iU)){var T,M,P;const n=r.getRecord({pointer:e.pointer,userId:w});if(!n||!n.value){if(s)return;continue}const a=S?i.cX(n.value):n.value;if(!t&&a.parent_id!==e.parentId)continue;if(a.type===o.Ti.externalObjectInstance&&!b)return;if(I.setValue(e.pointer,a),null!==(T=a.format)&&void 0!==T&&T.collection_pointer&&x.push({pointer:a.format.collection_pointer,parentId:a.id}),a.collection_id&&x.push({pointer:{table:g.vF,id:a.collection_id},parentId:a.id}),a.view_ids)for(const e of a.view_ids)x.push({pointer:{table:h.np,id:e,spaceId:a.space_id},parentId:a.id});if(!(_||v&&"transclusion_container"===a.type)){const e=c.kk.fromBlock(a).getRenderableContentIds();for(const t of e)x.push({pointer:{table:f.iU,id:t},parentId:a.id})}if(a.type===o.Ti.externalObjectInstance){var A,R;const e=(null===(A=a.format)||void 0===A?void 0:A.related_external_object_uris_to_instance_ids)&&Object.values(null===(R=a.format)||void 0===R?void 0:R.related_external_object_uris_to_instance_ids)||[];for(const t of e)x.push({pointer:{table:f.iU,id:t,spaceId:a.space_id},parentId:a.id})}if(a.properties)for(const e of Object.values(a.properties))if(e)for(const t of e)for(const e of y.hDy(t)){if(y.STW(e)){const t=y.TOT(e);x.push({pointer:{table:f.iU,id:t},parentId:a.id})}if(y.j0F(e)){const t=y.zW$(e),n=(0,l.A5)({url:t,baseUrl:k.default.domainBaseUrl,publicDomainName:k.default.publicDomainName});n&&x.push({pointer:{table:f.iU,id:n},parentId:a.id})}if(y.nSN(e)){const t=y.frW(e);t&&x.push({pointer:{table:f.iU,id:t,spaceId:a.space_id},parentId:a.id})}}null!==(M=a.format)&&void 0!==M&&M.automation_id&&x.push({pointer:{table:p.cv,id:a.format.automation_id,spaceId:a.space_id},parentId:a.id}),null!==(P=a.format)&&void 0!==P&&P.ai_instructions_page_pointer&&x.push({pointer:a.format.ai_instructions_page_pointer,parentId:a.id})}else if((0,u.$O)(e.pointer,g.vF)){var D;if(!a)return;const t=r.getRecord({pointer:e.pointer,userId:w});if(!t||!t.value){if(s)return;continue}if(t.value.parent_id!==e.parentId)continue;const n=t.value;I.setValue(e.pointer,n),r.forEachRecord(w,(t=>{let{model:n}=t;n.table===f.iU&&n&&n.parent_id===e.pointer.id&&n.alive&&x.push({pointer:n.pointer,parentId:e.pointer.id})}));const o=(null===(D=n.format)||void 0===D?void 0:D.automation_ids)??[];for(const e of o)x.push({pointer:{table:p.cv,id:e,spaceId:n.space_id},parentId:n.id})}else if((0,u.$O)(e.pointer,h.np)){const t=r.getRecord({pointer:e.pointer,userId:w});if(!t||!t.value){if(s)return;continue}if(t.value.parent_id!==e.parentId)continue;I.setValue(e.pointer,t.value)}else if((0,u.$O)(e.pointer,p.cv)){const t=r.getRecord({pointer:e.pointer,userId:w});if(!t||!t.value){if(s)return;continue}if(t.value.parent_id!==e.parentId)continue;I.setValue(e.pointer,t.value);for(const e of t.value.action_ids??[])x.push({pointer:{table:m.Xj,id:e,spaceId:t.value.space_id},parentId:t.value.id})}else if((0,u.$O)(e.pointer,m.Xj)){const t=r.getRecord({pointer:e.pointer,userId:w});if(!t||!t.value){if(s)return;continue}if(t.value.parent_id!==e.parentId)continue;I.setValue(e.pointer,t.value);for(const e of t.value.blocks??[])x.push({pointer:{table:f.iU,id:e,spaceId:t.value.space_id},parentId:t.value.id})}C.add(e.pointer.id)}return I}},47839:(e,t,n)=>{n.r(t),n.d(t,{appUpdateAvailable:()=>M,appUpdateChecking:()=>T,appUpdateError:()=>x,appUpdateFinished:()=>D,appUpdateInstall:()=>E,appUpdateNotAvailable:()=>P,appUpdateProgress:()=>R,appUpdateReady:()=>C,appUpdateReload:()=>A,checkForUpdates:()=>_,clearBrowserHistory:()=>g,clearCookies:()=>ne,clearGoogleAuthCookies:()=>oe,closeGlobalSearchModal:()=>ye,closeQuickSearch:()=>Se,downloadUrl:()=>re,electronApi:()=>d,electronAppFeatures:()=>pe,electronUpdateAvailable:()=>w,electronUpdateChecking:()=>S,electronUpdateError:()=>y,electronUpdateNotAvailable:()=>k,electronUpdateProgress:()=>I,electronUpdateReady:()=>b,fullscreen:()=>O,getAppPath:()=>ie,getCurrentZoom:()=>j,getDesktopVersion:()=>u,getSubstitutions:()=>G,inPageSearch:()=>Z,initializeElectron:()=>de,installElectronUpdate:()=>B,isActiveTab:()=>he,isMainTabOrWindow:()=>$,isProtocolRegistered:()=>le,isRunningUnderArm64Translation:()=>F,isWindowVisible:()=>ve,onNewWindow:()=>J,openDevTools:()=>H,openExternalUrl:()=>f,openGoogleDrivePickerPopup:()=>ee,openInNewTab:()=>p,openInNewWindow:()=>m,openOauthPopup:()=>X,openPageFromGlobalSearch:()=>_e,openQuickSearchResult:()=>we,openQuickSearchShortcutSetting:()=>xe,openSearchModalFromQuickSearch:()=>Me,quickSearchNotReady:()=>Ie,quickSearchReady:()=>ke,quickSearchRefresh:()=>Ce,quickSearchVisibilityState:()=>Te,ready:()=>ce,refreshAll:()=>ue,setAppStoreState:()=>ge,setBadge:()=>h,setLogglyData:()=>te,setOverlay:()=>v,setTabColors:()=>Y,setTheme:()=>Q,setWindowTitle:()=>K,sidebarState:()=>me,subscribeToProtocolUrl:()=>ae,subscribeToSettingsMenuItem:()=>se,toggleMaximized:()=>W,track:()=>be,windowSidebarState:()=>fe,zoomIn:()=>N,zoomOut:()=>z,zoomReset:()=>q});n(97391);var o=n(40654),i=n(68626),r=n(53965),a=n(18265);function s(){const e=function(e){const t=e.match(/Mac OS X (\d+_\d+)/);if(t)return t[1].split("_").map((e=>parseInt(e,10)));return}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator.userAgent);return!!e&&(10===e[0]&&e[1]<15)}var l=n(63643);let c="lastProtocolUrlDeduplicationId";const d=l.electronApi,u=l.getDesktopVersion;function p(e){const t=a.T1(e.url);d&&(d.openInNewTab?d.openInNewTab(t,e.makeTabActive,e.position):d.openInNewWindow(t))}function m(e){const t=a.T1(e);null==d||d.openInNewWindow(t)}function f(e){if(d){void 0!==a.yn(e)&&d.openExternalUrl(e)}}function g(){null==d||d.clearBrowserHistory()}function h(e){return null==d?void 0:d.setBadge(e)}function v(e){var t;return null==d||null===(t=d.setOverlay)||void 0===t?void 0:t.call(d,e)}const b={addListener(e){null==d||d.updateReady.addListener(e)},removeListener(e){null==d||d.updateReady.removeListener(e)}},y={addListener(e){var t;null==d||null===(t=d.updateError)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.updateError)||void 0===t||t.removeListener(e)}};function _(){var e;null==d||null===(e=d.checkForUpdates)||void 0===e||e.call(d)}const S={addListener(e){var t;null==d||null===(t=d.updateChecking)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.updateChecking)||void 0===t||t.removeListener(e)}},w={addListener(e){var t;null==d||null===(t=d.updateAvailable)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.updateAvailable)||void 0===t||t.removeListener(e)}},k={addListener(e){var t;null==d||null===(t=d.updateNotAvailable)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.updateNotAvailable)||void 0===t||t.removeListener(e)}},I={addListener(e){var t;null==d||null===(t=d.updateProgress)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.updateProgress)||void 0===t||t.removeListener(e)}},C={addListener(e){var t;null==d||null===(t=d.appUpdateReady)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.appUpdateReady)||void 0===t||t.removeListener(e)}},x={addListener(e){var t;null==d||null===(t=d.appUpdateError)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.appUpdateError)||void 0===t||t.removeListener(e)}},T={addListener(e){var t;null==d||null===(t=d.appUpdateChecking)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.appUpdateChecking)||void 0===t||t.removeListener(e)}},M={addListener(e){var t;null==d||null===(t=d.appUpdateAvailable)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.appUpdateAvailable)||void 0===t||t.removeListener(e)}},P={addListener(e){var t;null==d||null===(t=d.appUpdateNotAvailable)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.appUpdateNotAvailable)||void 0===t||t.removeListener(e)}},A={emit:e=>{var t;null==d||null===(t=d.appUpdateReload)||void 0===t||t.emit(e)},addListener(e){var t;null==d||null===(t=d.appUpdateReload)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.appUpdateReload)||void 0===t||t.removeListener(e)}},R={addListener(e){var t;null==d||null===(t=d.appUpdateProgress)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.appUpdateProgress)||void 0===t||t.removeListener(e)}},D={addListener(e){var t;null==d||null===(t=d.appUpdateFinished)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.appUpdateFinished)||void 0===t||t.removeListener(e)}},E={addListener(e){var t;null==d||null===(t=d.appUpdateInstall)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.appUpdateInstall)||void 0===t||t.removeListener(e)}};function B(){null==d||d.installUpdate()}function F(){var e;return null==d||null===(e=d.isRunningUnderArm64Translation)||void 0===e?void 0:e.call(d)}const O={get:()=>null==d?void 0:d.fullscreen.get(),addListener(e){null==d||d.fullscreen.addListener(e)},removeListener(e){null==d||d.fullscreen.removeListener(e)}},Z={start(e){d&&d.inPageSearch&&d.inPageSearch.start(e)},stop(){d&&d.inPageSearch&&d.inPageSearch.stop()},started:{addListener(e){d&&d.inPageSearch&&d.inPageSearch.started.addListener(e)},removeListener(e){d&&d.inPageSearch&&d.inPageSearch.started.removeListener(e)}},stopped:{addListener(e){d&&d.inPageSearch&&d.inPageSearch.stopped.addListener(e)},removeListener(e){d&&d.inPageSearch&&d.inPageSearch.stopped.removeListener(e)}}};function V(e,t,n){return Math.min(Math.max(e,n),t)}let U,L=1;function j(){return L}function N(){d&&d.zoom&&(L+=o.to,d.zoom.set(V(o.x_,o.A_,L)))}function z(){d&&d.zoom&&(L-=o.to,d.zoom.set(V(o.x_,o.A_,L)))}function q(){d&&d.zoom&&(L=o.lO,d.zoom.set(L))}function W(){d&&d.toggleMaximized&&d.toggleMaximized()}function H(){d&&d.openDevTools&&d.openDevTools()}function K(e){d&&d.setWindowTitle&&d.setWindowTitle(e)}function G(){return U||[]}async function $(){return d&&d.isMainTab?d.isMainTab():!d||!d.isMainWindow||d.isMainWindow()}function Q(e){d&&d.setTheme&&d.setTheme(e)}function Y(e){d&&d.setTabColors&&d.setTabColors(e)}function J(e){d&&d.newWindow&&d.newWindow.addListener(e)}async function X(e){if(d&&d.openOauthPopup)return d.openOauthPopup(e)}async function ee(e){if(d&&d.openGoogleDrivePickerPopup)return d.openGoogleDrivePickerPopup(e)}function te(e){d&&(d.setLoggerData?d.setLoggerData(e):d.setLogglyData&&d.setLogglyData(e))}function ne(){d&&d.clearCookies&&d.clearCookies()}function oe(){d&&d.clearAllCookies&&d.clearAllCookies()}async function ie(){if(d&&d.getAppPath)return d.getAppPath()}function re(e){if(d&&d.downloadUrl)d.downloadUrl(e);else{const t=document.createElement("a");t.download=e,t.href=e,t.click()}}function ae(e){d&&d.onNavigate&&d.onNavigate.addListener(((t,n)=>{if("string"!=typeof n&&n.deduplicationID){const e=n.deduplicationID;if(c===e)return void i.log({level:"warning",from:"electronActions",type:"duplicateOnNavigateObjectDetected"});c=e}e(n)}))}function se(e){d&&d.onOpenSettings&&d.onOpenSettings.addListener(((t,n)=>e(n)))}async function le(e){return!(!d||!d.isProtocolRegistered)&&d.isProtocolRegistered(e)}function ce(){d&&d.ready&&d.ready()}async function de(e){const{device:t,electronSqlite:n}=e;if(d){if(await l.getAndCacheDesktopVersionAsync(),d.zoom&&(L=await d.zoom.get()),n&&n.sqliteConnection&&(await n.sqliteConnection.ensureMigrated(),n.sqliteConnection.optimize()),d.getSubstitutions&&t.isElectronMac){const e=await d.getSubstitutions();U=e.filter((e=>e.replace!==e.with)).map((e=>({length:e.replace.length,replace:new RegExp(`\\b${r.hr(e.replace)} $`),with:`${e.with} `})))}t.isElectronMac&&s()&&pe.setPreference("isAutoUpdaterDisabled",!0)}}function ue(e){d&&d.refreshAll&&d.refreshAll(e.includeFocusedWindow)}const pe={get(){if(d&&d.electronAppFeatures)return d.electronAppFeatures.get()},setPreference(e,t){var n;d&&null!==(n=d.electronAppFeatures)&&void 0!==n&&n.setPreference&&d.electronAppFeatures.setPreference(e,t)},addListener(e){d&&d.electronAppFeatures&&d.electronAppFeatures.addListener(e)},removeListener(e){d&&d.electronAppFeatures&&d.electronAppFeatures.removeListener(e)}},me={set(e){d&&d.sidebarState&&d.sidebarState.set(e)},addSetSidebarOpenListener(e){var t;d&&null!==(t=d.sidebarState)&&void 0!==t&&t.addSetSidebarOpenListener&&d.sidebarState.addSetSidebarOpenListener(e)},removeSetSidebarOpenListener(e){var t;d&&null!==(t=d.sidebarState)&&void 0!==t&&t.removeSetSidebarOpenListener&&d.sidebarState.removeSetSidebarOpenListener(e)},addToggleListener(e){d&&d.sidebarState&&d.sidebarState.addToggleListener(e)},removeToggleListener(e){d&&d.sidebarState&&d.sidebarState.removeToggleListener(e)}},fe={get:()=>d&&d.windowSidebarState?d.windowSidebarState.get():Promise.resolve(void 0),set(e){d&&d.windowSidebarState&&d.windowSidebarState.set(e)},addListener(e){d&&d.windowSidebarState&&d.windowSidebarState.addListener(e)},removeListener(e){d&&d.windowSidebarState&&d.windowSidebarState.removeListener(e)}};function ge(e){d&&d.setAppStoreState&&d.setAppStoreState(e)}const he={get:()=>d&&d.isActiveTab?d.isActiveTab.get():Promise.resolve(!1),addListener(e){d&&d.isActiveTab&&d.isActiveTab.addListener(e)},removeListener(e){d&&d.isActiveTab&&d.isActiveTab.removeListener(e)}};async function ve(){return d&&d.windowIsVisible?d.windowIsVisible():"visible"===document.visibilityState}const be={addListener(e){d&&d.track&&d.track.addListener(e)},removeListener(e){d&&d.track&&d.track.removeListener(e)}};function ye(){d&&d.closeGlobalSearchModal&&d.closeGlobalSearchModal()}function _e(e){d&&d.openPageFromGlobalSearch&&d.openPageFromGlobalSearch(e)}function Se(){d&&d.closeQuickSearch&&d.closeQuickSearch()}function we(e){d&&d.openQuickSearchResult&&d.openQuickSearchResult(e)}function ke(){d&&d.quickSearchReady&&d.quickSearchReady()}function Ie(){d&&d.quickSearchNotReady&&d.quickSearchNotReady()}function Ce(){d&&d.quickSearchRefresh&&d.quickSearchRefresh()}function xe(){d&&d.openQuickSearchShortcutSetting&&d.openQuickSearchShortcutSetting()}const Te={isVisible:()=>d&&d.quickSearchVisibilityState?d.quickSearchVisibilityState.isVisible():Promise.resolve(!1),addListener(e){d&&d.quickSearchVisibilityState&&d.quickSearchVisibilityState.addListener(e)},removeListener(e){d&&d.quickSearchVisibilityState&&d.quickSearchVisibilityState.removeListener(e)}},Me={addListener(e){d&&d.openSearchModalFromQuickSearch&&d.openSearchModalFromQuickSearch.addListener(e)},removeListener(e){d&&d.openSearchModalFromQuickSearch&&d.openSearchModalFromQuickSearch.removeListener(e)}}},31781:(e,t,n)=>{n.d(t,{vW:()=>B,z:()=>O,TH:()=>N,I:()=>V,qC:()=>F,qL:()=>L,x1:()=>z,cT:()=>Z});n(57658);var o=n(1302),i=n(41432),r=n(80951),a=n(95538),s=n(43593),l=n(70203),c=n(9291),d=n(54642),u=n(48948),p=n(95477),m=n(33929),f=n(45010),g=n(18245),h=n(58202),v=n(53809),b=n(30548);const y=new v.D({key:"urlTurnedBookmarkToastStatusSetting",namespace:b.$p,important:!0,trackingType:"preference"});var _=n(77080),S=n(27411),w=n(88864),k=n(59301),I=n(99813),C=n(62365),x=n(96802),T=n(27153),M=n(9953),P=n(64964),A=n(993),R=n(13447),D=n(53471);const E=(0,c.defineMessages)({urlTurnedBookmark:{id:"action.urlTurnedBookmark.snackBarMessage",defaultMessage:"Pasted url is not embeddable, turned to bookmark instead!"}});let B=function(e){return e[e.Page=0]="Page",e[e.PageComment=1]="PageComment",e[e.SidebarComment=2]="SidebarComment",e}({});function F(e){return e===B.PageComment||e===B.SidebarComment}function O(e){const{environment:t,files:n,inMemoryRecordCache:o,transaction:i,pageWidth:r,ignoreOversizedFiles:a,spaceId:s,useCrdt:l}=e;return n.filter((e=>{if(a){if(!D.Q7({environment:t,file:e,preventLimitFreeFileSize:!1}))return D.A3(t),!1}return!0})).map((e=>{if(e.type&&(e.type.startsWith("image")||e.type.startsWith("video")||e.type.startsWith("audio"))&&!e.type.includes("photoshop")){const n=M.j4({environment:t,type:"embed",inMemoryRecordCache:o,transaction:i,spaceId:s,useCrdt:l});return i.postSubmitCallbacks.push((o=>{o||Z({environment:t,store:n,file:e,pageWidth:r,preferredType:void 0})})),n}{const n=M.j4({environment:t,type:"file",inMemoryRecordCache:o,transaction:i,spaceId:s,useCrdt:l});return i.postSubmitCallbacks.push((o=>{o||C.c({environment:t,store:n,file:e})})),n}}))}function Z(e){const{environment:t,store:n,file:i,pageWidth:r,preferredType:s}=e,l=S.default.getBlockKey(n.id);let c;T.Z(),D.cT({environment:t,file:i,bucket:"secure",record:n.pointer,onStart:e=>{if(c=g.default.mark("image_upload"),S.default.setKeyState(l,{progressPercent:0,file:i,name:e.name,size:e.size}),i.type.indexOf("image")>=0&&!(0,a.y_)(e.name,"tiff")&&!(0,a.y_)(e.name,"tif")){const e=URL.createObjectURL(i),a=new Image;a.onload=function(){U(t,{store:n,width:a.naturalWidth,height:a.naturalHeight,scale:!0,type:"image",pageWidth:r}),t.device.isMobile&&o.default.afterNextFlush((()=>{f.Z.PageScroller&&f.Z.PageScroller.scrollerHack()})),URL.revokeObjectURL(e)},a.src=e}else{const e=(0,a.Dz)({url:i.name||"",baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,preferredType:s});U(t,{store:n,width:r,type:e,pageWidth:r})}},onProgress:e=>{const t=S.default.getKeyState(l);t&&S.default.setKeyState(l,{...t,progressPercent:e.progressPercent})},onComplete:async e=>{const o=S.default.getKeyState(l);if(o){const a=Boolean(o.dataURL),d=o.name,u=o.size;await V(t,{source:e,store:n,isDataURL:a,pageWidth:r,preferredType:s,name:d,size:u}),i.type.indexOf("image")>=0&&(k.M(t,{blockId:n.id,fileIds:n.getFileIds(),fileSize:i.size,fileType:i.type}),g.default.measure(c,{environment:t,data:{success:!0,type:i.type}})),S.default.setKeyState(l,void 0)}},onError:e=>{g.default.measure(c,{environment:t,data:{success:!1,type:i.type}}),S.default.setKeyState(l,void 0)},retryWhenOffline:!0})}async function V(e,t){const{store:n,source:o,isDataURL:r,pageWidth:s,preferredType:c,name:f,size:h}=t;let v=r?"image":(0,a.Dz)({url:o,baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,preferredType:c});const b=function(e,t){const n=/^https?:\/\//i,o=/^https:\/\/[^\/]+\.streamlit\.app/;return"maps"===e?n.test(t)?_.default.checkGate("remove_apostrophe_for_maps_url")?t.replace(/'/g,""):t:`https://maps.google.com/maps/search/${encodeURIComponent(t)}`:"embed"===e&&o.test(t)?`${t}?embed=true`:(0,a.x$)(t)}(v,o),{properties:S,type:k,format:I}=await(0,a.Ol)({source:b,type:v,isDataURL:r,pageWidth:s,isMobileDevice:e.device.isMobile,getEmbedData:async t=>{const n=await d.getGenericEmbedBlockData(e,t);return"failed"===n.type?void console.error(n.error):n.data},trackEmbedType:t=>w.Jg(e,{embedType:t})});if(v=k,v===i.Ti.bookmark){const o=n;return await u.K({environment:e,store:o,url:b,transformTimeout:0}),w.mC(e),function(){if("do_not_prompt"===y.state)return;y.state?"displayed_once"===y.state?y.setState("displayed_twice"):"displayed_twice"===y.state&&y.setState("do_not_prompt"):y.setState("displayed_once");P.oV({label:m.default.formatMessage(E.urlTurnedBookmark)})}(),void(t.metric&&g.default.measure(t.metric,{environment:e,data:{embedType:v}}))}let C,T;w.Gl(e,{embedType:k}),f&&h&&(C={size:l.TPx(h)},T=l.TPx(f));const{serverCommitResult:D}=R.createAndCommit({userAction:"embedBlockActions.initializeEmbedBlock",environment:e,perform:t=>{M.sW({store:n.getPropertiesStore(),data:{...S||{},...C},transaction:t}),T&&A.sO({environment:e,editorMode:"default",store:n.getBlockTitleStore(),value:T,transaction:t}),x.FH({stores:[n],update:I,transaction:t}),M.sW({store:n,data:{type:v},transaction:t})}});await D,t.metric&&g.default.measure(t.metric,{environment:e,data:{embedType:v}})}function U(e,t){let{store:n,...o}=t;R.createAndCommit({userAction:"embedBlockActions.initializeFormat",environment:e,perform:e=>{x.FH({stores:[n],update:(0,a.tj)(o),transaction:e})}})}async function L(e,t){const{store:n}=t,o=n.getProperties();if(o){const u=n.getType(),p=u===i.Ti.bookmark?o.link:o.source,m=r.zB(p),f=l.QaF(o.title),{display_source:g,original_url:h}=n.getFormat(),v=n.isExternalObjectInstanceBlockStore()?h:m||g;let b;v&&(b=s.rF({title:f,source:v}));var a,c,d="file";if("image"===u?d="image":"video"===u&&(d="video"),v)await I.Wl(e,{url:v,downloadName:b,type:d,from:t.from,permissionRecord:t.store.pointer,download:(null===(a=b)||void 0===a?void 0:a.endsWith(".html"))||(null===(c=b)||void 0===c?void 0:c.endsWith(".htm"))})}}const j=(0,c.defineMessages)({downloadingImage:{id:"embedBlockActions.downloading.label",defaultMessage:"Downloadingâ€¦"}});async function N(e){const{store:t,environment:n}=e,o=await async function(e){let{store:t,environment:n,calledFrom:o}=e;const i=t.getNavigableBlockStore();if(!i)return;const r=await d.getBlockFileDownloadUrl(n,{blockId:t.id,pageBlockId:i.id,meta:{name:o}});if("success"!==r.type)return;const{url:a,fileName:s}=r.data;return{url:a,fileName:s}}({store:t,environment:n,calledFrom:"downloadSource"});if(!o)return;const{url:i,fileName:r}=o;if(i){let o;w.Uk(n,{url:i,fileName:r,from:"embedBlockActions"}),o=s.E$(i,[p.default.secureFileS3.url,p.default.secureFileS3V2.url])?I.ji(n,{url:i,download:!0,downloadName:r,permissionRecord:t.pointer}):function(e){const{store:t,environment:n}=e;if(!n.currentUser.id)return Promise.resolve();const o=t.getProperties(),i=l.QaF(null==o?void 0:o.source),r=l.QaF(null==o?void 0:o.caption);return s.GN(i,t.pointer,p.default.domainBaseUrl,n.currentUser.id,r)}(e),P.oV({label:m.default.formatMessage(j.downloadingImage),durationMs:"keep"}),await o.finally((()=>{P.rN()}))}}function z(e){const{store:t}=e,n=h.R.findBlockFromStoreWithMethod(t,"replace");n&&n.replace()}},89951:(e,t,n)=>{n.d(t,{KT:()=>F,RL:()=>O,f_:()=>B,xv:()=>Z});var o=n(1302),i=n(41432),r=n(95538),a=n(43593),s=n(99405),l=n(21202),c=n(13493),d=n(70203),u=n(53965),p=n(95477),m=n(69783),f=n(28020),g=n(63085),h=n(89224),v=n(58202),b=n(64233),y=n(19111),_=n(6258),S=n(27724),w=n(10743),k=n(52229),I=n(88864),C=n(79554),x=n(48948),T=n(96802),M=n(72711),P=n(9953),A=n(42858),R=n(993),D=n(13447),E=n(68422);function B(e){const t=e.getRecordStoreAtRootPath();return t instanceof _.G&&void 0!==t.getAssociatedCollectionStore()}function F(e){const{environment:t,textStore:n,url:o,oldTextValue:i,urlSelection:a}=e;if(w.Z.state.open||m.Z.state.open||y.Z.state.open||b.Z.state.open||B(n)&&r.Cm({url:o,baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName}))return;const s=h.get();if(!s)return;const l=h.getRect(s);l&&(b.Z.setState({open:!0,textStore:n,url:o,oldTextValue:i,urlSelection:a,selectionRect:l}),I.el(t,{url:o}))}async function O(e){const{environment:t}=e,n=b.Z.state;if(n.open){const{url:r,textStore:m,oldTextValue:h}=n,b=S.default.state.stores,y=b[0];if(!y)return;const w=(0,a.Wv)(r,p.default.secureFileS3.url,p.default.secureFileS3V2.url,p.default.secureFileConfig.rootPath,p.default.secureFileConfig.hostname),I=w?w.link:r,B=(0,s.Wj)({url:I,baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,isMobile:t.device.isMobile,protocol:p.default.protocol,currentUrl:window.location.href});if("page"===B.name)await D.createAndCommitAsync({environment:t,userAction:"embedMenuActions.embedPageAlias",waitForServerCommit:!1,perform:async i=>{let r;if(R.sO({environment:t,editorMode:"default",store:m,value:h,transaction:i}),B.peekViewBlockId){const e=_.G.createChildStore(m,{table:l.iU,id:B.peekViewBlockId});await e.load(),e.isPageBlock()&&(r=e)}if(r||(r=_.G.createChildStore(m,{table:l.iU,id:B.blockId})),r){if("mention-page"===e.type){const e=r.getRecordModel({id:r.id,table:l.iU});R.lZ({environment:t,editorMode:"default",store:m,selection:{startIndex:n.urlSelection.startIndex,endIndex:n.urlSelection.startIndex},annotation:d.$0A(B.scrollToBlockId??r.id,null==e?void 0:e.space_id),transaction:i,analyticsFrom:"block"})}else if("create-transclusion"===e.type){if(!B.scrollToBlockId)return;C.ry({environment:t,blocks:S.default.state.stores,copiedBlockIds:[B.scrollToBlockId]})}else if(r.isCollectionView()){const e=B.collectionViewId?_.Xr.createChildStore(r,{table:c.np,id:B.collectionViewId}):void 0;await Promise.all([r.load(),e?e.load():void 0]);const n=e?e.getCollectionStore():r.getCollectionViewCollectionStore();n&&(await n.load(),M.Y_({environment:t,store:y,collectionStore:n,collectionViewStore:e,transaction:i}))}else{const e=y.getParentBlockStore();if(e){const n=k.k({environment:t,parentBlock:e,targetStore:r,transaction:i});A.is({environment:t,blocks:[n],selection:b,transaction:i,replaceEmptyTextBlock:!0})}}o.default.afterNextFlush((()=>{D.createAndCommit({userAction:"embedMenuActions.accept",environment:t,perform:e=>{A.MD({blocks:b,transaction:e})}})}))}}});else if(e.type===i.Ti.bookmark||"teamsInvite"===B.name){const{performResult:e}=D.createAndCommit({userAction:"embedMenuActions.insertedBlocks",environment:t,perform:e=>{var n,o;R.sO({environment:t,editorMode:"default",store:m,value:h,transaction:e});const r=P.j4({environment:t,type:i.Ti.bookmark,inMemoryRecordCache:y.inMemoryRecordCache,transaction:e,spaceId:0!==b.length?b[b.length-1].pointer.spaceId:null===(n=(0,f.RM)())||void 0===n?void 0:n.pointer.spaceId,useCrdt:0!==b.length?b[b.length-1].useCrdt():(null===(o=(0,f.RM)())||void 0===o?void 0:o.useCrdt())??!1}),a=A.is({environment:t,blocks:[r],selection:b,transaction:e,replaceEmptyTextBlock:!0});return T.FH({stores:[r],transaction:e,update:{bookmark_loading_ttl:Date.now()}}),a}});o.default.afterNextFlush((()=>{D.createAndCommit({userAction:"embedMenuActions.accept",environment:t,perform:e=>{A.MD({blocks:b,transaction:e})}})}));const n=e[0];"teamsInvite"===B.name?await x.K({environment:t,store:n,url:r,teamId:B.teamId}):await x.K({environment:t,store:n,url:r})}else if(e.type===i.Ti.drive){const{performResult:e}=D.createAndCommit({userAction:"embedMenuActions.insertedBlocks",environment:t,perform:e=>{var n,o;R.sO({environment:t,editorMode:"default",store:m,value:h,transaction:e});const r=P.j4({environment:t,type:i.Ti.drive,inMemoryRecordCache:y.inMemoryRecordCache,transaction:e,spaceId:0!==b.length?b[b.length-1].pointer.spaceId:null===(n=(0,f.RM)())||void 0===n?void 0:n.pointer.spaceId,useCrdt:0!==b.length?b[b.length-1].useCrdt():(null===(o=(0,f.RM)())||void 0===o?void 0:o.useCrdt())??!1});return A.is({environment:t,blocks:[r],selection:b,transaction:e,replaceEmptyTextBlock:!0})}});o.default.afterNextFlush((()=>{D.createAndCommit({userAction:"embedMenuActions.accept",environment:t,perform:e=>{A.MD({blocks:b,transaction:e})}})}));const n=e[0];o.default.afterNextFlush((()=>{const e=v.R.find((e=>e.getBlockStore()===n));e&&e.initializeGoogleDriveBlockFromUrl(r)}))}else{const{performResult:n}=D.createAndCommit({userAction:"embedMenuActions.insertedBlocks",environment:t,perform:e=>{var n,o;R.sO({environment:t,editorMode:"default",store:m,value:h,transaction:e});const r=P.j4({environment:t,type:i.Ti.copyIndicator,inMemoryRecordCache:y.inMemoryRecordCache,transaction:e,spaceId:0!==b.length?b[b.length-1].pointer.spaceId:null===(n=(0,f.RM)())||void 0===n?void 0:n.pointer.spaceId,useCrdt:0!==b.length?b[b.length-1].useCrdt():(null===(o=(0,f.RM)())||void 0===o?void 0:o.useCrdt())??!1});return A.is({environment:t,blocks:[r],selection:b,transaction:e,replaceEmptyTextBlock:!0})}});o.default.afterNextFlush((()=>{D.createAndCommit({userAction:"embedMenuActions.accept",environment:t,perform:e=>{A.MD({blocks:b,transaction:e})}})}));const r=n[0],a=n=>{D.createAndCommit({environment:t,userAction:"embedMenuActions.accept.insertExtractedData",perform:t=>{let o;e.type&&"mention-page"!==e.type&&"create-transclusion"!==e.type?o=e.type:(o=i.Ti.embed,n&&n.media&&("photo"===n.media.type?o=i.Ti.image:"video"===n.media.type&&(o=i.Ti.video))),E.vs({environment:e.environment,block:r,blockType:o,transaction:t})}}),o.default.afterNextFlush((()=>{const e=v.R.find((e=>e.getBlockStore()===r&&u.mf(e.embed)));e&&e.embed(I)}))};g.W4(t,I).then(a)}}Z()}function Z(){b.Z.setState({open:!1})}},4727:(e,t,n)=>{n.d(t,{RL:()=>g,_P:()=>f,jZ:()=>v,xv:()=>h});var o=n(70203),i=n(69783),r=n(68056),a=n(89224),s=n(64233),l=n(19111),c=n(10743),d=n(24666),u=n(68425),p=n(993),m=n(13447);function f(e){const{environment:t,textStore:n,oldSelection:r,oldTextValue:d}=e,p=o.eeV(n.getValue()||[]),m=r.startIndex;if(":"!==p[m])return;const f=o.gPn(p,m-5,m).join("");if(/[0-9]$/.test(f[f.length-1]))return;if(f.endsWith("http")||f.endsWith("https"))return;if(f.endsWith(":"))return;if(c.Z.state.open||i.Z.state.open||l.Z.state.open||s.Z.state.open)return;if(t.device.isPhone)return;const g=a.get();if(!g)return;const h=a.getRect(g);h&&(i.Z.setState({open:!0,textStore:n,oldTextValue:d,oldSelection:r,selectionRect:h}),u.xu(t))}function g(e){const t=i.Z.state,{environment:n,emoji:o,transaction:r}=e;t.open&&(p.sO({environment:n,editorMode:"default",store:t.textStore,value:t.oldTextValue,transaction:r}),p.Q0({environment:n,editorMode:"default",store:t.textStore,selection:t.oldSelection,emoji:o,transaction:r}),h())}function h(){i.Z.setState({open:!1})}function v(e){p.N3({direction:"end"});const t=d.default.state;if("editing"!==t.mode)return;const n=(0,r.QY)(t.multiSelection);if(!n)return;let a=!1;if(n.selection.startIndex>0){const e=n.store.getValue()||[],t=o.eeV(e)[n.selection.startIndex-1];/[\s]/g.test(t)||(a=!0)}m.createAndCommit({userAction:"emojiMenuActions.triggerInsertEmojiMenu",environment:e,perform:t=>{a?(p.hJ({environment:e,store:n.store,editorMode:"default",string:" ",selection:n.selection,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t}),p.hJ({environment:e,store:n.store,editorMode:"default",string:":",selection:{startIndex:n.selection.startIndex+1,endIndex:n.selection.endIndex+1},disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!1,transaction:t})):p.hJ({environment:e,store:n.store,editorMode:"default",string:":",selection:n.selection,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!1,transaction:t})}});const s=i.Z.state;s.open&&i.Z.setState({...s,showPopupWithEmptyFilter:!0})}},36280:(e,t,n)=>{n.d(t,{Wj:()=>g,gt:()=>v,qn:()=>f});n(21703);var o=n(1302),i=n(70203),r=n(1898),a=n(83631),s=n(68056),l=n(89224),c=n(89086),d=n(66949),u=n(24666),p=n(993),m=n(98104);function f(e){var t;const{environment:n,selectedToken:o,selectionRect:r,analyticsFrom:p}=e,f=l.get();if(!f)return;if("editing"!==u.default.state.mode)return;const g=null===(t=(0,s.QY)(u.default.state.multiSelection))||void 0===t?void 0:t.store;if(!g)return;const h=o||a.JT(u.default.state);h&&m.Z5({store:g,selection:h.position});const v=c.lV(u.default.state),b=h?i.o0h(h.token):a.Jf(v),y=a.by({environment:n,equation:b,displayMode:"inline"}),_=h?{editingToken:h.token}:{annotations:a.nk(u.default.state)};d.Z.setState({open:!0,value:b,error:y,savedTextSelectionState:u.default.state,savedTextSelectionRect:r||a.TJ({environment:n,selection:f}),..._,analyticsFrom:a.D9({source:p,currentEquationToken:Boolean(h),selectedText:v})}),u.default.setState({mode:"empty"})}function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d.P.Forward;d.Z.isOpen()&&(h({equationStore:d.Z,getNextSelection:t=>e===d.P.Forward?{startIndex:t.endIndex,endIndex:t.endIndex}:e===d.P.Backward?{startIndex:t.startIndex,endIndex:t.startIndex}:(0,r.t1)(e)}),d.Z.reset(),o.default.afterNextFlush((()=>{u.default.emit()})))}function h(e){const{equationStore:t,getNextSelection:n}=e;if(!t.isOpen())return;const{savedTextSelectionState:o}=t.state,i=(0,s.QY)(o.multiSelection);if(!i)return;const r=n(i.selection);if(m.Z5({store:i.store,selection:r}),"editing"!==u.default.state.mode)throw new Error("TextSelectionStore should have a selection after calling `setSelection`.");t.setState({...t.state,savedTextSelectionState:u.default.state})}function v(e){const{environment:t,equationStore:n,transaction:o}=e;n.isOpen()&&(n.state.error||n.state.editingToken&&i.o0h(n.state.editingToken)===n.state.value||(!function(e){const{environment:t,equationStore:n,transaction:o}=e;if(!n.isOpen())return;if(n.state.error)return;const{savedTextSelectionState:r}=n.state,{multiSelection:s}=r;let l;p.pz({environment:t,editorMode:"default",multiSelection:s,transaction:o}),n.state.value&&(l=a.qZ({equationState:n.state,isTemporary:!1}),p.mM({environment:t,store:s.start.store,index:s.start.index,tokens:[l],transaction:o})),h({equationStore:n,getNextSelection:e=>{const t=l?i.eeV([l]).length:0;return{startIndex:e.startIndex,endIndex:e.startIndex+t}}}),u.default.setState({mode:"empty"})}({environment:t,equationStore:d.Z,transaction:o}),h({equationStore:n,getNextSelection:e=>({startIndex:e.endIndex,endIndex:e.endIndex})}),a.ND({environment:t,equation:n.state.value,from:n.state.analyticsFrom})))}},57400:(e,t,n)=>{n.d(t,{BX:()=>f,Of:()=>g,Th:()=>p,Tm:()=>m,Yh:()=>u,mc:()=>v});var o=n(15157),i=n(12139),r=n(54642),a=n(47307),s=n(12955),l=n(64496),c=n(77080),d=n(7339);async function u(e){const t=await(0,s.getExperimentDeviceId)(e),n=e.currentUser.id;let i;const r=(0,l.qE)();if(i=(0,l._3)(e)&&r?(0,l.fP)(t,n,r):o.Z.get({userId:n,key:c.localExperimentsV2Key}),i){const e=i.deviceId!==t,o=i.userId!==n,r=Boolean(i.test);!e&&!o||r||(i=void 0,c.default.reset())}i?c.default.updateState(i,e):await p({environment:e,force:!1}),c.default.getState().isLoaded||c.default.updateState({experimentsBySpace:{},experimentsWithoutSpace:[],isLoaded:!0,userId:n,deviceId:t,test:!1},e),c.default.isStatsigEnabled()&&await d.C.initialize(e)}async function p(e){const{environment:t,force:n}=e;if((0,l._3)(t)&&!n){var o;if(null!==(o=t.mobileNative)&&void 0!==o&&o.api.getExperimentData){const e=await t.mobileNative.api.getExperimentData();e?c.default.updateState(e,t):b({message:"Attempt to get experiments from the mobile cache did not return a result."})}else b({message:"getExperimentData is not implemented in the react native API."})}else{const e=await h(t);"failed"!==e.type&&c.default.updateState(e.data,t)}}async function m(e){const t=await h(e);"failed"!==t.type&&o.Z.set({userId:t.data.userId,key:c.localExperimentsV2Key,value:t.data})}async function f(e,t,n){if(!c.default.state.isLoaded)return;const o=await(0,s.getExperimentDeviceId)(e),i=await r.updateExperimentOverride(e,{experimentId:t,experimentGroup:n,deviceId:o});"failed"!==i.type?await p({environment:e,force:!1}):a.showError(i)}async function g(e){if(!c.default.state.isLoaded)return;const t=await(0,s.getExperimentDeviceId)(e),n=await r.resetExperimentOverrides(e,{deviceId:t});"failed"!==n.type?(await p({environment:e,force:!1}),a.showMessage({message:"Successfully reset experiment overrides."})):a.showError(n)}async function h(e){const t=await(0,s.getExperimentDeviceId)(e),n=e.currentUser.id,o=await r.getClientExperimentsV2(e,{deviceId:t});return"failed"===o.type&&b(o,n,t),o}function v(){c.default.reset()}function b(e,t,n){i.rn(e,{from:"experimentActions",type:"ExperimentFetchError",data:{deviceId:n,userId:t}})}},89475:(e,t,n)=>{n.d(t,{$$:()=>A,cM:()=>D,hM:()=>R});n(21703);var o=n(77657),i=n(74181),r=n(99405),a=n(89101),s=n(98275),l=n(9852),c=n(94826),d=n(9291),u=n(40470),p=n(18265),m=n(95477),f=n(91924),g=n(79947),h=n(77080),v=n(30874),b=n(92083),y=n(57549),_=n(54642),S=n(47307),w=n(47839),k=n(94273),I=n(15356),C=n(31120),x=n(8055),T=n(10259),M=n(61202);const P=(0,d.defineMessages)({authenticating:{id:"externalIntegrationAuthActions.authenticationWithIntegration.loadingMessage",defaultMessage:"Authorizing with integrationâ€¦"},titleMessage:{id:"externalIntegrationAuthActions.loginWithExternalIntegrationPopupModal.title",defaultMessage:"Authenticate"}});async function A(e){const{environment:t,integration:n,spaceId:o,from:i}=e,a=n.id,s=t.currentUser.id,l=(0,f.eC)(t);if(!s)throw new Error("No user id found");let d;y.Iv(t,{integrationId:a,from:i});const u=(0,c.I$)(a);if("dlp"===(null==u?void 0:u.type)||"ediscovery"===(null==u?void 0:u.type)){const e=await _.createOauthAuthorizationCode(t,{integrationId:a,spaceId:o});if("failed"===e.type)return S.showError(e),{error:`Unexpected error creating authorization code: ${(0,g.pO)(e)}`};d=e.data.code}await E({environment:t,notionAuthorizationCode:d,integration:n,spaceId:o,userId:s,authType:l,from:i,callbackRouteName:(null==u?void 0:u.id)===c.ZB.datadog.id?r.AY.datadogAuthCallback:r.AY.authCallback}),await M.pJ({environment:t}),"workspace_connections_redirect"===i&&b.Z.setState({open:!0,openedFrom:"workspace_connections_redirect",currentTab:"integrations",defaultSubtab:"workspace_connections",highlightedSetting:void 0})}async function R(e){const{environment:t,spaceId:n,integration:c,externalObjectInstanceBlockId:d,unfurlUrl:b,from:A}=e;l.In(void 0);const R=c.id,D=R===o.nO?v.Z.completeSlackAuthentications.state:v.Z.externalAuthentications.state,B=new Set(D.filter((e=>{let{integration_id:t}=e;return t===R})).map((e=>e.parent_id)));R===o.f3&&T.pc(t);const F=(0,o.BP)({integrationId:R,env:"production"}),O=(0,i.lT)(m.default.domainBaseUrl),Z=c.redirect_uris.includes(O)?O:c.redirect_uris[0],V=await _.createOauthAuthorizationCode(t,{integrationId:R,spaceId:n,...F?{redirectUri:Z}:{}});if("failed"===V.type)return S.showError(V),{error:`Unexpected error creating authorization code: ${(0,g.pO)(V)}`};const U=V.data.code,L=t.currentUser.id,j=(0,f.eC)(t),N=r.AY.authCallback;if(!L)return{error:"User must be signed in."};const z={environment:t,notionAuthorizationCode:U,integration:c,spaceId:n,externalObjectInstanceBlockId:d,unfurlUrl:b,authType:j,from:A,userId:L,callbackRouteName:N};(0,o.BP)({integrationId:R,env:"production"})?await async function(e){const{environment:t,redirectUri:n,notionAuthorizationCode:o,integration:i,spaceId:l,externalObjectInstanceBlockId:c,unfurlUrl:d,authType:f,userId:g}=e,v=await async function(e){const{integration:t}=e;if("external"===t.type&&void 0!==t.info.handled_by_integrations_server){if("github"===t.info.handled_by_integrations_server)return await async function(e){const{environment:t,notionAuthorizationCode:n,spaceId:o,authType:i}=e,l={notion_workspace_id:o,notion_user_id:t.currentUser.id,notion_last_visited_url:window.location.href,notion_authorization_code:n,callback_type:i.callbackType,...i.redirectToAuth&&{redirectToAuth:"true"}},c=h.default.checkGate("enable_server_integrations_proxy"),d=(0,p.bf)({url:(0,s.r8)("production",c),query:{...l}});if((t.device.isTablet||t.device.isMobile)&&t.mobileNative&&"on"===h.default.getEligibleGroup({experimentId:"allow_auth_with_app_browser_for_mobile",defaultGroup:"control"}))return void t.mobileNative.openInAppBrowser(d);if(t.device.isElectron){if(h.default.checkGate("enable_oauth_from_desktop_ux_v2")){const e=(0,p.bf)({url:`${m.default.domainBaseUrl}${a._j.initiateExternalAuthenticationFromDesktop}`,query:{redirectUri:encodeURIComponent(d)}});w.openExternalUrl(e)}else w.openExternalUrl(d);return}const u=await I.M(t,{width:610,height:700,url:d,titleMessage:P.titleMessage});if(!u)return;const f=(0,r.Wj)({url:u,isMobile:t.device.isMobile,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,protocol:m.default.protocol,currentUrl:window.location.href}),{url:g}=k.Vr(t);"externalAuthCallback"===f.name&&await C.xp({route:f,environment:t});x.c4({url:g||a._j.root,environment:t})}(e),{value:{success:!0}};if("slack"===t.info.handled_by_integrations_server){return h.default.checkGate("link_preview_auth_with_server_integration")?(await async function(e){const{environment:t,userId:n,spaceId:o,authType:i,from:l,externalObjectInstanceBlockId:c,options:d,notionAuthorizationCode:u}=e,f={notion_workspace_id:o,notion_user_id:n,notion_last_visited_url:window.location.href,auth_initiator:l,callback_type:i.callbackType,slack_workspace_id:null==d?void 0:d.slackWorkspaceId,external_object_instance_block_id:c,...i.redirectToAuth&&{redirectToAuth:"true"},notion_authorization_code:u},g=h.default.checkGate("enable_server_integrations_proxy"),v=(0,p.bf)({url:(0,s.St)("production",g),query:{...f}});if(t.mobileNative)return void t.mobileNative.openInAppBrowser(v);if(t.device.isElectron){if(h.default.checkGate("enable_oauth_from_desktop_ux_v2")){const e=(0,p.bf)({url:`${m.default.domainBaseUrl}${a._j.initiateExternalAuthenticationFromDesktop}`,query:{redirectUri:encodeURIComponent(v)}});w.openExternalUrl(e)}else w.openExternalUrl(v);return}const b=await I.M(t,{width:610,height:700,url:v,titleMessage:P.titleMessage});if(!b)return;const y=(0,r.Wj)({url:b,isMobile:t.device.isMobile,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,protocol:m.default.protocol,currentUrl:window.location.href});"externalAuthCallback"===y.name&&await C.xp({route:y,environment:t})}(e),{value:{success:!0}}):{error:{success:!1}}}return"zendesk"===t.info.handled_by_integrations_server?(await async function(e){const{environment:t,notionAuthorizationCode:n,spaceId:o,authType:i,externalObjectInstanceBlockId:s}=e,l={notion_workspace_id:o,notion_user_id:t.currentUser.id,notion_last_visited_url:window.location.href,notion_authorization_code:n,external_object_instance_block_id:s,callback_type:i.callbackType,integration_id:e.integration.id,...i.redirectToAuth&&{redirectToAuth:"true"}},c=(0,p.bf)({url:`${m.default.domainBaseUrl}/initiateExternalAuthentication`,query:{...l}});if(t.device.isElectron)return void w.openExternalUrl(c);const d=await I.M(t,{width:610,height:700,url:c,titleMessage:P.titleMessage});if(console.log(`The popup callback: ${d}`),!d)return;const u=(0,r.Wj)({url:d,isMobile:t.device.isMobile,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,protocol:m.default.protocol,currentUrl:window.location.href}),{url:f}=k.Vr(t);"externalAuthCallback"===u.name&&await C.xp({route:u,environment:t});x.c4({url:f||a._j.root,environment:t})}(e),{value:{success:!0}}):{error:{success:!1}}}return{error:{success:!1}}}(e);if(u.x.isSuccess(v))return;const b={externalObjectInstanceBlockId:c,spaceId:l,userId:g,callbackType:f.callbackType,...f.redirectToAuth&&{redirectToAuth:"true"}},y={code:o,notion_state:JSON.stringify(b),integration_id:i.id,external_url:d,redirect_uri:n},_=(0,p.bf)({url:n,query:{...y}});if(t.device.isElectron){if(h.default.checkGate("enable_oauth_from_desktop_ux_v2")){const e=(0,p.bf)({url:`${m.default.domainBaseUrl}${a._j.initiateExternalAuthenticationFromDesktop}`,query:{redirectUri:encodeURIComponent(_)}});w.openExternalUrl(e)}else w.openExternalUrl(_);return}const S=await I.M(t,{width:610,height:700,url:_,titleMessage:P.titleMessage});if(!S)return;const T=(0,r.Wj)({url:S,isMobile:t.device.isMobile,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,protocol:m.default.protocol,currentUrl:window.location.href});"externalAuthCallback"===T.name&&await C.xp({route:T,environment:t})}({...z,integration:c,notionAuthorizationCode:U,redirectUri:Z}):await E(z),y.Iv(t,{integrationId:c.id,numberOfAccountsAlreadyConnected:B.size,from:A}),await M.pJ({environment:t});return{value:{externalAuthentication:v.Z.externalAuthentications.state.filter((e=>{let{integration_id:t}=e;return t===R})).find((e=>!B.has(e.parent_id)))}}}function D(e){const{environment:t,notion_workspace_id:n,notion_user_id:o,notion_last_visited_url:i,notion_authorization_code:r,external_object_instance_block_id:a,callback_type:l,redirectToAuth:c,zendeskSubDomain:d}=e,u={notion_workspace_id:n,notion_user_id:o,notion_last_visited_url:i,notion_authorization_code:r,external_object_instance_block_id:a,callback_type:l,zendeskSubDomain:d,...c&&{redirectToAuth:"true"}},m=h.default.checkGate("enable_server_integrations_proxy"),f=(0,p.bf)({url:(0,s.vl)("production",m),query:{...u}});t.device.isElectron?w.openExternalUrl(f):window.location.href=f}async function E(e){const{environment:t,notionAuthorizationCode:n,integration:o,spaceId:i,userId:s,authType:l,externalObjectInstanceBlockId:c,from:d,callbackRouteName:u}=e,g=o.id,h={notionAuthorizationCode:n,userId:s,spaceId:i,integrationId:g,externalObjectInstanceBlockId:c,callbackType:l.callbackType,...l.redirectToAuth&&{redirectToAuth:"true"}};let v=(0,p.bf)({url:`${m.default.domainBaseUrl}${a._j.externalIntegrationPopupRedirect}`,query:{...h}});if(v=l.redirectToAuth?v:await(0,f.HU)(t,v),t.device.isElectron)return void w.openExternalUrl(v);const b=await I.M(t,{width:610,height:700,url:v,titleMessage:P.titleMessage});if(!b)return;const y=(0,r.Wj)({url:b,isMobile:t.device.isMobile,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,protocol:m.default.protocol,currentUrl:window.location.href});y.name===u&&await C.wN({route:y,environment:t,integrationId:g,from:d})}},62365:(e,t,n)=>{n.d(t,{c:()=>u,v:()=>p});var o=n(70203),i=n(18265),r=n(27411),a=n(27153),s=n(9953),l=n(993),c=n(13447),d=n(53471);function u(e){const{store:t,file:n,environment:o}=e,i=r.default.getBlockKey(t.id);a.Z(),d.cT({environment:o,file:n,bucket:"secure",record:t.pointer,onStart:e=>{r.default.setKeyState(i,{progressPercent:0,file:n,name:e.name,size:e.size})},onProgress:e=>{const t=r.default.getKeyState(i);t&&r.default.setKeyState(i,{...t,progressPercent:e.progressPercent})},onComplete:e=>{const n=r.default.getKeyState(i);n&&c.createAndCommit({userAction:"fileBlockActions.uploadFile",environment:o,perform:a=>{p({environment:o,store:t,source:e,name:n.name,size:n.size,transaction:a}),r.default.setKeyState(i,void 0)}})},onError:()=>{r.default.setKeyState(i,void 0)},retryWhenOffline:!0})}function p(e){const{environment:t,store:n,source:r,name:a,size:c,transaction:d}=e;let u;a?u=a:r&&(u=(0,i.je)(r)),l.sO({environment:t,editorMode:"default",store:n.getBlockTitleStore(),value:o.TPx(u),transaction:d}),s.sW({store:n.getPropertiesStore(),data:{source:o.TPx(r),size:o.TPx(c)},transaction:d})}},98604:(e,t,n)=>{n.d(t,{AW:()=>l,Du:()=>s,bA:()=>a,xv:()=>r});var o=n(69316),i=n(24666);function r(e){const{clearQuery:t}=e;o.Z.state.open&&o.Z.update((e=>({...e,focused:!1,open:!1,findQuery:t?"":e.findQuery})))}function a(e){const{currentTextSelection:t,shouldSelectAllInput:n}=e,r=t&&t.length>0;o.Z.update((e=>({...e,open:!0,findQuery:r?t:o.Z.state.findQuery,focused:!0,shouldSelectAllInput:n,showReplaceInput:!1}))),i.default.setState({mode:"empty"})}function s(){const e=o.Z.hasFindQuery();o.Z.state.focused||o.Z.update((t=>({...t,focused:!0,shouldSelectAllInput:e})))}function l(){o.Z.update((e=>({...e,showReplaceInput:!e.showReplaceInput})))}},3297:(e,t,n)=>{n.d(t,{DK:()=>Z,OH:()=>U,S:()=>O,VE:()=>j,nM:()=>N,qd:()=>z,sC:()=>F,yR:()=>V});var o=n(15145),i=n(15157),r=n(89101),a=n(53965),s=n(37850),l=n(1898),c=n(83105),d=n(75754),u=n(91851),p=n(95477),m=n(27105),f=n(97978),g=n(28020),h=n(8304),v=n(84210),b=n(33929),y=n(80444),_=n(89256),S=n(36610),w=n(81193),k=n(47307),I=n(54532),C=n(96802),x=n(92625),T=n(11302),M=n(19785),P=n(69915),A=n(8055),R=n(28014),D=n(13447);const E=750,B="forkPageTemplate";function F(){_.Z.setState({open:!1})}async function O(e){const{environment:t,store:n,originRect:i}=e;S.Zz(t,n.id);const{RouterStore:a}=t,s=a.state.route;if("page"===s.name&&s.requestedOnPublicDomain){const e=(0,v.ZP)({store:n,fullyQualified:!1,duplicate:!0,pageVisitSource:o.tY.Duplicate});return void A.Li({environment:t,url:e,extraSearchParams:{...await P.tc(t),utm_source:"public_page",utm_content:"duplicate_button",tid:await(0,f.cG)(t),from:"public_page",n:"duplicate_public_page"}})}const{currentUserRootStore:l}=y.default.state;if(l){const e=g.o(l);if(1===e.length){const o=e[0],i=o.getSpaceStore();if(!i)return;Z({environment:t,store:n,spaceStore:i,spaceViewStore:o,isPrivate:!0,context:"public_page_duplicate_single_workspace"})}else _.Z.setState({open:!0,store:n,originRect:i})}else N({currentUserId:t.currentUser.id,blockId:n.id}),A.c4({environment:t,url:r._j.login})}async function Z(e){const{environment:t,store:n,spaceStore:i,context:r}=e,{blockTitle:a}=V({store:n,spaceStore:i}),l=Date.now();let u;const p=e.duplicateFunc?e.duplicateFunc():U({...e,useCrdt:q(e)}),[m]=await Promise.all([p.then((e=>(u=Date.now()-l,e))),(0,s.Vs)(E)]);x.x();const f=Date.now()-l;"public_page_duplicate_multiple_workspace"!==r&&"public_page_duplicate_single_workspace"!==r&&"signin_after_duplicate"!==r||w.Xy(t,{from:"publicPage",success:!m.error,template_name:a,template_block_id:n.id,target_space_id:i.id,context:r,template_duplication_duration_ms:u,template_duplication_duration_with_minimum_ms:f},e.shouldLogToStatsig),void 0!==m.error?k.showErrorMessage(m.error):d._c({environment:t,store:m.value,visitType:c.vu.Link,pageVisitSource:o.tY.Duplicate})}function V(e){const{store:t,spaceStore:n}=e,o=b.default.getIntl(),i=(0,h.M5)(t,o),r=(0,h.A1)(n,o);return x.j({message:h.sY.loadingStateDisplayText,interpolatedValues:{blockTitle:i,spaceTitle:r}}),{blockTitle:i,spaceTitle:r}}async function U(e){const{environment:t,store:n,spaceStore:o,spaceViewStore:i,isPrivate:r,duplicateOnlyCollectionSchema:a}=e;return new Promise((s=>{D.createAndCommit({userAction:"forkPageActions.forkPage",environment:t,perform:l=>{const[c,d]=I.Qi({environment:t,stores:[n],transaction:l,addCopyName:!1,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,targetSpaceId:o.id,baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:q(e),duplicateOnlyCollectionSchema:a}),u=c[0];d.then((e=>{e?s({error:e}):(s({value:u}),u.isLocked()&&D.createAndCommit({userAction:"forkPageActions.forkPageWithLoadingAndNavigate",environment:t,perform:e=>{C.Wq({environment:t,store:u,isLocked:!1,transaction:e})}}))})),R.Hj({environment:t,spaceStore:o,spaceViewStore:i,pageStore:u,isPrivate:r,location:{type:"prepend"},transaction:l})}})}))}function L(e){const{newParent:t,blocksToDuplicate:n,event:o}=e;return"block"===t.table?t.useCrdt():"space"===t.table&&(0,m.Sy)({event:o,contextualDefault:n.every((e=>e.useCrdt()))})}async function j(e){const{environment:t}=e,n=await async function(e){const{environment:t,store:n,duplicateOnlyCollectionSchema:o}=e,i=y.default.state.currentSpaceStore,r=y.default.state.currentSpaceViewStore,s=y.default.state.mainEditorCurrentBlockStore;if(!i||!r||!s)return;const c=await u.NN({environment:t,block:n,action:"duplicate"});if("user_canceled"===c)return;return await new Promise((s=>{D.createAndCommit({userAction:"forkPageActions.duplicateTo",environment:t,perform:d=>{const[u,m]=I.Qi({environment:t,stores:c,transaction:d,addCopyName:e.addCopyName,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,targetSpaceId:i.id,baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:L({...e,blocksToDuplicate:c}),duplicateOnlyCollectionSchema:o});m.then((n=>{n?s({error:n}):(s({value:u}),e.unlockPage&&u.find((e=>e.isLocked()))&&D.createAndCommit({userAction:"forkPageActions.duplicateToHelper",environment:t,perform:e=>{u.forEach((n=>{n.isLocked()&&C.Wq({environment:t,store:n,isLocked:!1,transaction:e})}))}}))}));const f={type:"append",after:e.appendWithoutAfter?void 0:n.id},g=a.d9(u).reverse();if("team"===e.newParent.table)T.at({transaction:d,currentSpaceViewStore:r,teamStore:e.newParent,targets:u,environment:t,location:f,action:"move",value:{type:"team",id:e.newParent.id,spaceId:i.id}});else if("block"===e.newParent.table)for(const t of g)M.jG({parentStore:e.newParent,childStore:t,transaction:d,after:f.after});else if("space"===e.newParent.table)for(const e of g)R.Hj({environment:t,spaceStore:i,spaceViewStore:r,pageStore:e,isPrivate:!0,location:f,transaction:d});else(0,l.t1)(e.newParent);return u}})}))}({...e,addCopyName:!0});n&&(void 0!==n.error?k.showErrorMessage(n.error):d._c({environment:t,store:n.value[0],visitType:c.vu.Link,pageVisitSource:o.tY.Duplicate}))}function N(e){let{currentUserId:t,blockId:n}=e;i.Z.set({userId:t,key:B,value:n})}function z(e){return i.Z.get({userId:e,key:B})}function q(e){const{isPrivate:t,store:n,useCrdt:o}=e;return"boolean"==typeof o?o:t?(0,m.dy)({source:"private",contextualDefault:n.useCrdt()}):n.useCrdt()}},96802:(e,t,n)=>{n.d(t,{FH:()=>m,MF:()=>_,Mp:()=>S,Wq:()=>f,bf:()=>w,eO:()=>v,fs:()=>h,hc:()=>g,is:()=>y,zM:()=>b});var o=n(41432),i=n(43593),r=n(15157),a=n(53965),s=n(19584),l=n(95477),c=n(24990),d=n(6258),u=n(41433),p=n(9953);function m(e){const{stores:t,update:n,transaction:i}=e;for(const a of t){switch(a.table){case"block":case"collection":case"collection_view":p.sW({store:a.getFormatStore(),data:(0,s.Q2)(n),transaction:i})}a instanceof d.G&&a.getType()===o.Ti.callout&&n.block_color&&r.Z.set({userId:a.environment.currentUser.id,key:u.Ns,value:n.block_color})}}function f(e){const{environment:t,store:n,isLocked:o,transaction:i}=e,{id:r}=t.currentUser;if(!r)return;const a={block_locked:o,block_locked_by:r};p.sW({store:n.getFormatStore(),data:a,transaction:i})}function g(e){const{environment:t,store:n,alignment:o,transaction:i}=e,{id:r}=t.currentUser;if(!r)return;const a={block_alignment:o};p.sW({store:n.getFormatStore(),data:a,transaction:i})}function h(e){const{store:t,url:n,position:o,transaction:r}=e,a=(0,i.Wv)(n,l.default.secureFileS3.url,l.default.secureFileS3V2.url,l.default.secureFileConfig.rootPath,l.default.secureFileConfig.hostname),s=a?a.link:n;m({stores:[t],update:{page_cover_position:o},transaction:r});const c=t.getCoverStore();c&&p.sO({store:c,value:s,transaction:r})}function v(e){const{store:t,url:n,transaction:o}=e,r=(0,i.Wv)(n,l.default.secureFileS3.url,l.default.secureFileS3V2.url,l.default.secureFileConfig.rootPath,l.default.secureFileConfig.hostname);m({stores:[t],update:{social_media_image_preview_url:r?r.link:n},transaction:o})}function b(){const e=a.UP(["Activities","Objects","Travel & Places"]),t=c.Z.state.emojiByCategory[e];return a.UP(t)}function y(e){const{store:t,transaction:n}=e,o=t.getIconStore();if(o){if(!o.getValue()){const e=b();p.sO({store:o,value:e,transaction:n})}}}function _(e){const{store:t,transaction:n}=e,o=t.getCoverStore();o&&p.sO({store:o,value:null,transaction:n})}function S(e){const{store:t,coverPosition:n,transaction:o}=e;if(t.isCollectionView()){const e=t.getCollectionViewCollectionStore();if(e)return void p.sW({store:e.getFormatStore(),data:{collection_cover_position:n},transaction:o})}m({stores:[t],update:{page_cover_position:n},transaction:o})}function w(e){const{store:t,coverPosition:n,transaction:o}=e;m({stores:[t],update:{card_cover_position:n},transaction:o})}},47678:(e,t,n)=>{n.d(t,{Y:()=>u});var o=n(53965),i=n(45010),r=n(80444),a=n(24612),s=n(27724),l=n(77503),c=n(54564),d=n(42858);function u(e,t){const{RouterStore:n}=e,{PageScroller:u}=i.Z;if("page"===n.state.route.name&&r.default.state.currentLoadingContainerStore&&r.default.state.currentLoadingContainerStore.state.ready)if(a.Z.reset(),l.Z.reset(),n.state.route.scrollToBlockId){const o=[n.state.route.scrollToBlockId];d.WG(e,{blockIds:o,animate:t.animateScrollToBlocks});const i=s.default.state.stores[0];i&&n.state.route.discussionId&&c.Ib({environment:e,blockStore:i,discussionIds:[n.state.route.discussionId],analyticsFrom:"page_load",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:!1})}else n.state.route.discussionId&&r.default.state.mainEditorCurrentBlockStore?c.Ib({environment:e,blockStore:r.default.state.mainEditorCurrentBlockStore,discussionIds:[n.state.route.discussionId],analyticsFrom:"page_load",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:!1}):"pop"===n.state.action&&n.state.historyState&&(u&&o.hj(n.state.historyState.scrollTop)&&u.scrollTo(n.state.historyState.scrollTop,void 0),n.state.historyState.blockIds&&d.DQ(e,n.state.historyState.blockIds))}},54604:(e,t,n)=>{n.d(t,{ui:()=>a,xv:()=>s,zp:()=>l});var o=n(36610),i=n(17903),r=n(38302);function a(e){const{environment:t,renderFullScreenNode:n,fullScreenNodeRect:a,contentAspectRatio:s,block:l,imageUrl:c}=e;o.Lf(t,{type:"open"}),r.Z.setState({...r.Z.state,isOpen:!0,fullscreenNodeAnimationComplete:!1,backgroundAnimationComplete:!1,renderFullScreenNode:n,startScrollTop:i.Z.state.scrollTop,fullScreenNodeRect:a,contentAspectRatio:s,block:l,imageUrl:c})}function s(){r.Z.setState({...r.Z.state,isOpen:!1})}function l(e){return e<1020?0:32}},44886:(e,t,n)=>{n.d(t,{A1:()=>h,WY:()=>f,dD:()=>p,gq:()=>y,nt:()=>b,rB:()=>g,uv:()=>m,vi:()=>v});n(57658);var o=n(41432),i=n(53965),r=n(28020),a=n(73959),s=n(35328),l=n(95802),c=n(26664),d=n(45131),u=n(94419);function p(e){const{parentStore:t,block:n,type:o,transaction:i}=e,r=t.getTransclusionReferenceTargetStore()??t,a=r.getContentStores(),l=a.indexOf(n);if(l<=0)return;const c=a[l-1];if(!c)return;if(!_(r)||!_(c))return;u.Od({parent:r.getContentStore(),childToRemove:n,transaction:i});const{child:p}=u.R3({parent:c.getContentStore(),append:n,transaction:i});if("self"===o&&!p.isType("table"))for(const s of p.getContentStores().reverse())u.Od({parent:p.getContentStore(),childToRemove:s,transaction:i}),u.BE({parent:c.getContentStore(),insert:s,after:p,transaction:i});return s.BX(c)&&d.Z.setOpen(c.id,!0),p}function m(e){const{grandparentStore:t,parentStore:n,block:o,transaction:i}=e,r=t.getTransclusionReferenceTargetStore()??t;if(r.getContentStores().indexOf(n)<0)return;const a=n.getContentStores(),s=a.indexOf(o);if(s<0)return;if(!_(r)||!_(n))return;if("transclusion_container"===n.getType()||"transclusion_reference"===n.getType())return;if(_(o))for(let c=s+1;c<a.length;c++){const e=a[c];u.Od({parent:n.getContentStore(),childToRemove:e,transaction:i}),u.R3({parent:o.getContentStore(),append:e,transaction:i})}u.Od({parent:n.getContentStore(),childToRemove:o,transaction:i});const{child:l}=u.BE({parent:r.getContentStore(),insert:o,after:n,transaction:i});return l}function f(e){const{transaction:t}=e,n=e.blocks,o=n[0];if(!o)return;const i=S(o);if(!i)return;const{previousChildStore:r}=i,a=r.getContentStore();return s.BX(r)&&d.Z.setOpen(r.id,!0),n.map((e=>{const n=e.getRecordStoreUIParent();null!=n&&n.valueIs(c.i)&&u.Od({parent:n,childToRemove:e,transaction:t});return u.R3({parent:a,append:e,transaction:t}).child}))}function g(e){const{transaction:t}=e;let n=e.blocks;const o=n[0];if(!o)return;const r=w(o);if(!r)return;const{closestParentStore:a,closestParentParentStore:s}=r,l=a.getContentStores(),d=s.getContentStore();if(l){let e;for(const[t,o]of l.entries())if(o.id===n[n.length-1].id){e=l.splice(t+1);break}n=i.d9(n).reverse(),n=n.map(((n,o)=>{const i=n.getRecordStoreUIParent();null!=i&&i.valueIs(c.i)&&u.Od({parent:i,childToRemove:n,transaction:t});const r=u.BE({parent:d,insert:n,after:a,transaction:t});if(0===o&&e&&_(n))for(const a of e){const e=a.getRecordStoreUIParent();null!=e&&e.valueIs(c.i)&&u.Od({parent:e,childToRemove:a,transaction:t}),u.BE({parent:n.getContentStore(),insert:a,transaction:t})}return r.child}))}return n}function h(e){const{transaction:t,blocks:n}=e,o=n[0];if(!o)return;const a=r.RM();if(!a)return;const s=I(a),l=i.cx(s,(e=>e.parent===o.getRecordStoreUIParent()&&e.after===o)),c=i.qr(s,((e,t)=>t<l&&e.parent===o.getRecordStoreUIParent())),d=i.dF(s,((e,t)=>t<c&&!o.uiContains(e.parent)));return d?x({blocks:n,listPosition:d,transaction:t}):void 0}function v(e){const{transaction:t,blocks:n}=e,o=i.Z$(n);if(!o)return;const a=r.RM();if(!a)return;const s=I(a),l=i.cx(s,(e=>e.parent===o.getRecordStoreUIParent()&&e.after===o)),c=s.find(((e,t)=>t>l&&!o.uiContains(e.parent)));return c?x({blocks:n,listPosition:c,transaction:t}):void 0}function b(e){return Boolean(e&&S(e))}function y(e){return Boolean(e&&w(e))}function _(e){const t=r.np(),n=e.getType(),i=e.getFormat();return n&&((0,o.TT)(n,i)||e===t)}function S(e){const t=(0,a.sQ)(e);if(null==t||!t.isDefined()||!_(t))return;const n=t.getContentStores(),o=n[n.indexOf(e)-1];return null!=o&&o.isDefined()&&_(o)?{previousChildStore:o}:void 0}function w(e){const t=(0,a.sQ)(e);if(!t)return;if(!t.isDefined()||!_(t))return;const n=(0,a.sQ)(t);return n&&n.isDefined()&&_(n)?{closestParentStore:t,closestParentParentStore:n}:void 0}function k(e,t){let n=[];const{store:o}=e.props;if(e.props.canDropAbove&&C(o)){const e=o.getRecordStoreUIParent();null!=e&&e.valueIs(c.i)&&n.push({parent:e})}const r=t.filter((t=>t.getContextClosestSelectable()===e));for(const a of r)n=i.G0(n,k(a,t));if(e.props.canDropBelow&&C(o)){const e=o.getRecordStoreUIParent();null!=e&&e.valueIs(c.i)&&(e.id===o.id?n.push({parent:e}):n.push({parent:e,after:o}))}return n}function I(e){let t=[];const n=l.C.getMembersByDOMOrder({filter:()=>!0}),o=e.getContentStores();for(const r of o){const e=n.find((e=>e.props.store===r));e&&(t=i.G0(t,k(e,n)))}return t}function C(e){return"collection"!==e.getParentTable()}function x(e){const{blocks:t,listPosition:n,transaction:o}=e,r=i.d9(t).reverse();for(const i of t){const e=i.getRecordStoreUIParent();null!=e&&e.valueIs(c.i)&&u.Od({parent:e,childToRemove:i,transaction:o})}let a;return a=n.after?r.map((e=>u.BE({insert:e,after:n.after,parent:n.parent,transaction:o}).child)):r.map((e=>u.Ce({prepend:e,parent:n.parent,transaction:o}).child)),a}},88295:(e,t,n)=>{n.d(t,{Hk:()=>M,c_:()=>C,f8:()=>I,gt:()=>T,lP:()=>x});var o=n(41432),i=n(21202),r=n(82798),a=n(1898),s=n(19785),l=n(68422),c=n(28020),d=n(98165),u=n(46654),p=n(80444),m=n(83212),f=n(6258),g=n(952),h=n(54569),v=n(98834),b=n(94419),y=n(60870),_=n(11302),S=n(19358),w=n(9953),k=n(13447);function I(e){const{environment:t,transaction:n,titleText:o,recordStoreParent:a}=e,{databaseTemplate:s,createInValue:l}=function(e,t){let n;if("page"===e.type){const o=f.G.createChildStore(t,{table:i.iU,id:e.id});if(o.isTemplate()){const t=(0,d.Dg)(o,1);t&&(n=o,e={type:"page",id:t.id})}}return{databaseTemplate:n,createInValue:e}}(e.createInValue,a),c="block"===l.type?f.G.createChildStore(a,{table:i.iU,id:l.id}):void 0,u=w.j4({transaction:n,environment:t,type:"page",inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,properties:o?{title:[[o]]}:void 0,spaceId:a.pointer.spaceId,useCrdt:"block"===l.type&&(0,r.TO)(c).useCrdt()});let p;if("block"===l.type)S.YM({transaction:n,childStore:u,parentStore:(0,r.TO)(c),alive:!0});else p=_.Ws({transaction:n,environment:t,targets:[u],value:l});return{environment:t,databaseTemplate:s,createdPages:[u],moveToStorePromise:p}}async function C(e){const{environment:t,createdPages:n,databaseTemplate:o,moveToStorePromise:r}=e.createInState;let a,s;(null==n?void 0:n.length)>0&&(a=n[0].id,s=n[0].getParentCollectionIdUpToTwoLevels()),g.W(t,{type:"page",from:e.analyticsFrom,new_page_id:a,creating_block_id:a,parent_collection_id:s});const{currentSpaceStore:l}=p.default.state;if(o)k.createAndCommit({userAction:"inlinePageActions.completeCreateIn",environment:t,perform:e=>{n.forEach((n=>v.ob({title:{text:n.getTitleValue()},environment:t,store:n,templateStore:o,isKeyboard:!1,isCreateIn:!0,transaction:e,from:"inline_page_action"})))}}),l&&await y.j2(l,l.id,o.id);else{const e=await r;l&&e&&e.table===i.iU&&await y.j2(l,l.id,e.id)}}function x(e){const{environment:t,transaction:n,parentStore:r,inlinePageIds:l}=e;if(0===l.length)return;const c=f.G.createChildStore(r,r.pointer),p=(0,d.qA)(c).find((e=>{if(e.table!==i.iU)return!1;const t=e.getType(),n=e.getFormat();return!(!t||!n)&&((0,o.Um)(t,n)||(0,o.S9)(t))})),g=p&&p.isCollectionView()?p.getCollectionViewCollectionStore():p,v=g&&m.Z.getMode(t,g);if(!g||(0,u.YF)(v)||!g.canEdit()){for(const e of l)s.nO({pageStore:f.G.createChildStore(r,{table:i.iU,id:e}),transaction:n});return}let y=r;for(const o of l){const e=f.G.createChildStore(r,{table:i.iU,id:o});if(e.isEmptyPage()){s.nO({pageStore:e,transaction:n});continue}const l=!e.isDefined()||Boolean(e.getAlive());S.YM({parentStore:g,childStore:e,transaction:n,alive:l}),"block"!==g.table?"collection"!==g.table?(0,a.t1)(g):h.mp({environment:t,store:e,collectionStore:g,shouldCoerce:!0,groupsPointer:[],transaction:n}):(b.BE({parent:g.getContentStore(),after:y,insert:e,transaction:n}),y=e)}}function T(e){const t=c.np();if(t){if(e&&e.table===i.iU)return{pageStore:(0,d.Dg)(e,0)||t,createInValue:{type:"block",id:e.id}};if(e&&(0,d.n3)(e)){const t=(0,d.Dg)(e,0);if(t)return{pageStore:t,createInValue:{type:"page",id:t.id}}}return{pageStore:t,createInValue:{type:"page",id:t.id}}}}async function M(e,t){const{createInValue:n,blocksToTransform:o}=t,r="page"===n.type?new f.G(e,{table:i.iU,id:n.id}):void 0,a=Boolean(r&&r.isTemplate()),{performResult:{transformedPages:s,pageStore:c}}=await k.createAndCommitAsync({environment:e,userAction:"inlinePageActions.createNewPageIn",waitForServerCommit:!0,perform:async t=>{const s=o.map((n=>l.vs({environment:e,block:n,blockType:"page",transaction:t})));let c;if("page"===n.type)if(r&&a){const n=r.getAssociatedCollectionStore(),o=null==n?void 0:n.getParentPointer();o&&o.table===i.iU&&(c=await _.Y({transaction:t,environment:e,targets:s,value:{type:"page",id:o.id}}))}else{const{mainEditorCurrentBlockStore:o}=p.default.state;o&&o.id!==n.id&&(c=await _.Y({transaction:t,environment:e,targets:s,value:n}))}else"team"===n.type&&await _.Ws({transaction:t,environment:e,targets:s,value:n});return{transformedPages:s,pageStore:c}}});await C({analyticsFrom:"new_page_in",createInState:{environment:e,createdPages:s,databaseTemplate:a?r:void 0,moveToStorePromise:Promise.resolve(c)}})}},96313:(e,t,n)=>{n.d(t,{QZ:()=>D,az:()=>B,pg:()=>E});var o=n(26263),i=n(14577),r=n(41432),a=n(59753),s=n(99405),l=n(21202),c=n(33709),d=n(23867),u=n(70203),p=n(1898),m=n(9953),f=n(24677),g=n(98104),h=n(95477),v=n(69783),b=n(65598),y=n(89224),_=n(70726),S=n(64233),w=n(48863),k=n(19111),I=n(6258),C=n(10743),x=n(52229),T=n(88864),M=n(94419),P=n(4408),A=n(993),R=n(13447);function D(e){const{environment:t,textStore:n,blockStore:r,url:a,oldTextValue:u,urlSelection:p}=e;if(C.Z.state.open||v.Z.state.open||k.Z.state.open||S.Z.state.open)return!1;const m=y.get();if(!m)return!1;const f=y.getRect(m);if(!f)return!1;const g=(0,s.Wj)({url:a,baseUrl:h.default.domainBaseUrl,publicDomainName:h.default.publicDomainName,isMobile:t.device.isMobile,protocol:h.default.protocol,currentUrl:window.location.href});if("page"===g.name&&!!g.discussionId&&g.discussionId){const e=g.discussionId,s=g.blockId,m=r.getParentBlockStore();if(!m)return!1;const h=(0,I.Kv)(m,{table:l.iU,id:s,spaceId:(0,d.C)(m.pointer.spaceId)}),v=(0,I.Kv)(h,{table:c.qF,id:e,spaceId:(0,d.C)(r.pointer.spaceId)});if("none"===v.getRole())return!1;const y=new i.Z((()=>b.D4(v)[0]),{debugName:"firstCommentStore"}),S=new o.Z({name:"internalUnfurlingMenuActions.activate",isTemporaryData:!0});t.defaultRecordCache.inMemoryRecordCache.addCacheOverride(S);const k=r.clone(S),C=n.clone(S),x=m.clone(S);return w.Z.setState({args:{commentStore:y},stores:{blockStore:r,textStore:n,parentStore:m},temporaryStores:{blockStore:k,textStore:C,parentStore:x},temporaryRecordCache:S,focusedIndex:_.Z.Preview,selectionRect:f,oldTextValue:u,open:!0,url:a,urlSelection:p}),T.el(t,{url:a}),!0}return!1}function E(e){const{actionType:t,environment:n,commentStore:o,useTempStores:i}=e,r=w.Z.state;if(!r.open)return;const{oldTextValue:s}=r,l=i?r.temporaryStores:r.stores,{textStore:c,blockStore:m,parentStore:h}=l,v=n.currentUser.id;if(v){if(i){r.temporaryRecordCache.clearCache();for(const e in r.temporaryStores){const t=r.temporaryStores[e],o={userId:v,pointer:t.pointer},i=n.defaultRecordCache.inMemoryRecordCache.getRecord(o);i?P.Wl({environment:n,inMemoryRecordCache:r.temporaryRecordCache,pointer:t.pointer,model:a.kk.fromValue(t.pointer.table,i.value),role:i.role,updatePaths:[[]],userId:v,force:!0,debugSource:"setUnfurlType"}):P.uo({environment:n,inMemoryRecordCache:r.temporaryRecordCache,persistedRecordCache:void 0,pointer:t.pointer,userId:v})}}else n.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(r.temporaryRecordCache);switch(t){case _.Z.Link:f.eP({environment:n,store:r.stores.blockStore}),g.Z5({store:r.stores.textStore,selection:{startIndex:r.urlSelection.endIndex,endIndex:r.urlSelection.endIndex}}),w.Z.setState({...r,focusedIndex:_.Z.Link});break;case _.Z.Mention:if(!o)return;const e=(0,d.C)(c.pointer.spaceId);if(!e)return;const i=o.id;R.createAndCommit({environment:n,userAction:"internalUnfurlingMenuActions.mention",perform:t=>{A.sO({environment:n,editorMode:"default",store:c,value:s,transaction:t}),A.lZ({environment:n,editorMode:"default",store:c,selection:{startIndex:r.urlSelection.startIndex,endIndex:r.urlSelection.startIndex},annotation:u.mfJ(i,e),transaction:t,analyticsFrom:"block"})}}),w.Z.setState({...r,focusedIndex:_.Z.Mention});break;case _.Z.Preview:if(!o)return;R.createAndCommit({environment:n,userAction:"internalUnfurlingMenuActions.preview",perform:e=>{A.sO({environment:n,editorMode:"default",store:c,value:s,transaction:e});const t=b.GP(o);if(!t)return;if(!b.HK(t)||!h||!t.getParentId())return;const i=x.k({environment:n,parentBlock:h,targetStore:o,transaction:e});if(M.BE({parent:h.getContentStore(),insert:i,after:m,transaction:e}),0===u.QaF(r.oldTextValue).trim().length){const t=I.G.createChildStore(h.getContentStore(),r.stores.blockStore.pointer);M.Od({parent:h.getContentStore(),childToRemove:t,transaction:e})}}}),w.Z.setState({...r,focusedIndex:_.Z.Preview});break;default:throw(0,p.t1)(t)}i||w.Z.setState({open:!1})}}function B(e){var t,n;const{block:o,transaction:i}=e,a=o.getType(),s=o.getFormat(),l=o.getSpaceId();if(!o.isDefined()||a!==r.Ti.alias||null==s||null===(t=s.alias_pointer)||void 0===t||!t.id)return;const c=[u.YCD(u.mfJ(null==s||null===(n=s.alias_pointer)||void 0===n?void 0:n.id,l))];m.sW({store:o,data:{type:r.Ti.text},transaction:i}),m.sW({store:o.getFormatStore(),data:{alias_pointer:null},transaction:i}),A.sO({environment:o.environment,editorMode:"default",store:o.getBlockTitleStore(),value:c,transaction:i})}},91367:(e,t,n)=>{n.d(t,{G2:()=>S,Pf:()=>w,Wf:()=>k});var o=n(92996),i=n(6695),r=n(9291),a=n(47307),s=n(40663),l=n(33929),c=n(77907),d=n(80444),u=n(21039),p=n(6258),m=n(92083),f=n(30397),g=n(57549),h=n(54642),v=n(92625),b=n(9953),y=n(13447);const _=(0,r.defineMessages)({JiraAuthorizationError:{id:"jiraImport.unauthorizedAccess",defaultMessage:"Unauthorized Error: API key does not belong to Jira Admin."},JiraAuthenticationSuccess:{id:"jiraImport.successfulAuth",defaultMessage:"Successfully established Jira connection"},JiraAuthenticationInvalidDetails:{id:"jiraImport.invalidDetails",defaultMessage:"Invalid Details"}});async function S(e){const{environment:t,userEmail:n,site:o,apiToken:i,spaceId:r,flowId:s}=e;if(!t.currentUser.id)return a.showMessage({message:l.default.formatMessage(_.JiraAuthenticationInvalidDetails)}),void v.x();const c=await h.authenticateJiraUser(t,{userEmail:n,site:o,apiKey:i,userId:t.currentUser.id,spaceId:r});if("failed"===c.type){g.a1(t,{import_source:"jira",data:{import_type:"api",status:"failure",error:c.error},flowId:s}),console.error(c.error);const e=u.Z.getInitialState();u.Z.setState(e),a.showError(c)}else{var d;if(null!=c&&null!==(d=c.data)&&void 0!==d&&d.isAdmin){g.a1(t,{import_source:"jira",data:{import_type:"api",status:"success"},flowId:s}),u.Z.setState({...u.Z.state,type:"teamspace-selection",open:!0,flowId:s,site:o,botId:c.data.botId});const e=m.Z.getInitialState();m.Z.setState(e)}else g.a1(t,{import_source:"jira",data:{import_type:"api",status:"failure"},flowId:s}),u.Z.setState({...u.Z.state,type:"auth",open:!0,adminTokenError:!0,flowId:s,site:void 0})}v.x()}async function w(e){let{environment:t,selectedTeamspaceId:n,siteUrl:r,botId:a}=e;try{const{appTemplatesSetupActions:e,appConfigs:a}=await c.deps.AppTemplates.loader(),{teams:l}=f.Z.getState(),{currentSpaceStore:m,currentSpaceViewStore:g}=d.default.getState(),h=n?l.find((e=>e.id===n)):m;if(!g||!h)return;const{serverCommitResult:v,performResult:_}=y.createAndCommit({environment:t,perform:n=>{var i;const r={type:"preset",uri:o.T3}.uri,l=null===(i=(0,s.iX)(a(),r))||void 0===i?void 0:i.uri;if(!l)return;const c=a().find((e=>e.uri===l));if(null==c?void 0:c.presets.find((e=>e.uri===r))){return e.initializeApp({environment:t,spaceViewStore:g,appParentStore:h,appUri:l,presetUri:r,transaction:n,from:"jira_import"})}return[]},userAction:"importActions.importJira"}),S=t.defaultRecordCache.inMemoryRecordCache;return await v,null==_||_.forEach((e=>{const n=e.getFormat(),o=null==n?void 0:n.collection_pointer;if(o){const e=S.getRecord({pointer:o,userId:t.currentUser.id});e&&e.value&&y.createAndCommit({userAction:"jiraActions.updateFormatForCollections",environment:t,perform:n=>{const a=e.value;if(null!=a&&a.format){const e=a.format;if(e){e.external_collection_type=i.Vj.Jira,e.synced_collection_external_url=r,e.bot_id=u.Z.state.botId;const a=new p.NW(t,o);b.sW({store:a.getFormatStore(),data:e,transaction:n})}}}})}})),null==_?void 0:_.find((e=>{var t;return(null===(t=e.getFormat())||void 0===t?void 0:t.app_config_uri)===o.Aw}))}catch(l){return}}function k(e){const t=u.Z.state.spaceId;e.spaceId!==t&&u.Z.setState(u.Z.getInitialState())}},62134:(e,t,n)=>{n.d(t,{B4:()=>d,Fe:()=>a,Zm:()=>l,dJ:()=>r,fg:()=>c,ys:()=>s});n(57658);var o=n(53965);function i(e,t){return e.KeyboardShortcutStackStore.state.stack.some((e=>t===e.listener))}function r(e,t,n){const{stack:o}=e.KeyboardShortcutStackStore.state;for(let i=o.length-1;i>=0;i--){const r=o[i],a=r.shortcuts[n];if(e.KeyboardShortcutStackStore.debugPropagation){const[t,o]=e.KeyboardShortcutStackStore.getDebugInfoForStackItem(i),s=r.enable&&a?`propagating ${n} to ${t}`:`not propagating ${n} to ${t}`;console.info(`keyboardShortcutStackActions: ${s}`,o)}if(r.enable&&a)return void a(t)}}function a(e){const{environment:t,stackItem:n}=e,r=t.KeyboardShortcutStackStore;if(i(t,n.listener)){const e=r.state.stack.map((e=>e.listener===n.listener?n:e));r.setState({...r.state,stack:e})}else r.state.stack.push(n),r.setState({stack:o.MR(r.state.stack,(e=>e.priority))})}function s(e,t){if(i(e,t)){const n=e.KeyboardShortcutStackStore,i=n.state.stack,r=o.d1(i,(e=>t===e.listener));n.setState({...n.state,stack:r})}}function l(e,t){r(e,t,t.type)}function c(e){return{command:e.device.isMac?"âŒ˜":"ctrl",enter:"â†µ",delete:"del",backspace:"del",esc:"escape",left:"â†",right:"â†’",up:"â†‘",down:"â†“",tab:"â‡¥",alt:e.device.isMac?"âŒ¥":"alt"}}function d(e){return{command:e.device.isMac?"command":"control",esc:"escape"}}},94273:(e,t,n)=>{n.d(t,{Bk:()=>p,Ie:()=>f,Vr:()=>m,nr:()=>g,vq:()=>h});var o=n(99405),i=n(21202),r=n(54153),a=n(95477),s=n(84210),l=n(46654),c=n(6258);const d="lastVisitedRoute",u="lastVisitedRouteUserId";function p(e,t){const n=o.Wj({url:window.location.href,isMobile:e.device.isMobile,baseUrl:a.default.domainBaseUrl,publicDomainName:a.default.publicDomainName,protocol:a.default.protocol,currentUrl:window.location.href}),{route:r,userId:s}=v();("root"===n.name||"new"===n.name||"nativeTab"===n.name)&&r&&"page"===r.name&&r.blockId&&s===t&&new c.G(e,{table:i.iU,id:r.blockId,spaceId:r.spaceId}).load()}function m(e){const{route:t,userId:n}=v();if(t&&"page"===t.name){return{url:(0,s.ZP)({fullyQualified:!1,store:new c.G(e,{table:i.iU,id:t.blockId,spaceId:t.spaceId},{userId:n}),scrollToBlockId:t.scrollToBlockId,peekViewBlockId:t.peekViewBlockId,peekMode:t.peekMode,collectionViewId:t.collectionViewId,templateGalleryItem:t.templateGalleryItem,projectManagementLaunch:t.projectManagementLaunch,discussionId:void 0,pageVisitSource:void 0}),userId:n}}if(t&&"space"===t.name){return{url:(0,o.Xs)({route:t}),userId:n}}return{}}async function f(e){const{route:t,userId:n}=v();let r,a;if(t)if("page"===t.name){const d=new c.G(e,{table:i.iU,id:t.blockId,spaceId:t.spaceId},{userId:n});await d.load();l.IJ(e,d)?(a=t.spaceId??d.getSpaceId(),r=a?o.pv(a):void 0):(r=(0,s.ZP)({fullyQualified:!1,store:d,scrollToBlockId:t.scrollToBlockId,peekViewBlockId:t.peekViewBlockId,peekMode:t.peekMode,collectionViewId:t.collectionViewId,templateGalleryItem:t.templateGalleryItem,projectManagementLaunch:t.projectManagementLaunch,discussionId:void 0,pageVisitSource:void 0}),a=d.getSpaceId())}else"space"===t.name?(a=t.spaceId,r=(0,o.Xs)({route:t})):("nativeTab"===t.name||"workspaceSetup"===t.name)&&(a=t.spaceId);return{url:r,userId:n,route:t,spaceId:a}}function g(e,t){r.Z.set(d,e),r.Z.set(u,t)}function h(){r.Z.remove(d),r.Z.remove(u)}function v(){return{route:r.Z.get(d),userId:r.Z.get(u)}}},20747:(e,t,n)=>{n.d(t,{FZ:()=>v,U_:()=>h,fU:()=>_});var o=n(41432),i=n(21202),r=n(82798),a=n(6258),s=n(26664),l=n(36610),c=n(96802),d=n(94419),u=n(9953);function p(e){const t=e.getRecordStoreUIAncestor(2);if(t&&t instanceof a.G&&t.isType(o.Ti.columnList))return t}function m(e){return e&&e instanceof a.G&&e.isType(o.Ti.column)}function f(e){const{environment:t,targets:n,inMemoryRecordCache:i,transaction:a}=e;(0,r.T)(n.length>0);const s=u.j4({environment:t,type:o.Ti.columnList,properties:{},inMemoryRecordCache:i,transaction:a,spaceId:n[0].pointer.spaceId,useCrdt:n[0].useCrdt()}),c=s.getContentStore();for(const o of n)d.R3({parent:c,append:o,transaction:a});return l.xh(t),s}function g(e){const{environment:t,targets:n,inMemoryRecordCache:i,transaction:a}=e;(0,r.T)(n.length>0);const s=u.j4({environment:t,type:o.Ti.column,format:{column_ratio:1},inMemoryRecordCache:i,transaction:a,spaceId:n[0].pointer.spaceId,useCrdt:n[0].useCrdt()}),l=s.getContentStore();for(const o of n)d.R3({parent:l,append:o,transaction:a});return s}function h(e){const{environment:t,parent:n,insertStores:o,left:r,transaction:s}=e;if(0===o.length)return[];let c,u;if(l.FT(t,{side:"left"}),m(r))c=r,u=p(r);else{c=g({environment:t,targets:[r],inMemoryRecordCache:n.inMemoryRecordCache,transaction:s});const o=f({environment:t,targets:[c],inMemoryRecordCache:n.inMemoryRecordCache,transaction:e.transaction});u=d.rS({parent:n,oldChild:r,newChild:o,transaction:s}).child}const h=g({environment:t,targets:o,inMemoryRecordCache:n.inMemoryRecordCache,transaction:s});if(u){const t=u.getContentStore();d.Vt({parent:t,insert:h,before:c,transaction:e.transaction}),b({columnList:u,addedColumn:h,transaction:s});return a.G.createChildStore(t,{table:i.iU,id:h.id}).getContentStores()}return[]}function v(e){const{environment:t,parent:n,insertStores:o,right:r,transaction:s}=e;if(0===o.length)return[];let c,u;if(l.FT(t,{side:"right"}),m(r))c=r,u=p(r);else{c=g({environment:t,targets:[r],inMemoryRecordCache:n.inMemoryRecordCache,transaction:s});const o=f({environment:t,targets:[c],inMemoryRecordCache:n.inMemoryRecordCache,transaction:e.transaction});u=d.rS({parent:n,oldChild:r,newChild:o,transaction:s}).child}const h=g({environment:t,targets:o,inMemoryRecordCache:n.inMemoryRecordCache,transaction:s});if(u){const t=u.getContentStore();d.BE({parent:t,insert:h,after:c,transaction:e.transaction}),b({columnList:u,addedColumn:h,transaction:s});return a.G.createChildStore(t,{table:i.iU,id:h.id}).getContentStores()}return[]}function b(e){const{columnList:t,addedColumn:n,transaction:o}=e,i=t.getContentStores(),r=1/i.length;c.FH({stores:[n],update:{column_ratio:r},transaction:o});for(const a of i)if(a.id!==n.id){const e=a.getColumnRatio();c.FH({stores:[a],update:{column_ratio:(1-r)*e},transaction:o})}}function y(e){const{columnList:t,removedColumn:n,transaction:o}=e,i=t.getContentStores(),r=n.getColumnRatio();for(const a of i){const e=a.getColumnRatio();c.FH({stores:[a],update:{column_ratio:e/(1-r)},transaction:o})}}function _(e){const{parent:t,transaction:n}=e,o=t.getRecordStoreUIParent();let i;if(m(o)&&(i=p(o)),i){const e=i.getContentStore(),t=i.getContentStores();for(const r of t){0===r.getContentStores().length&&(d.Od({parent:e,childToRemove:r,shouldGarbageCollect:!1,transaction:n}),y({columnList:i,removedColumn:r,transaction:n}))}const o=i.getContentStores();if(0===o.length){const e=i.getRecordStoreUIParent();null!=e&&e.valueIs(s.i)&&d.Od({parent:e,childToRemove:i,transaction:n,shouldGarbageCollect:!1})}else if(1===o.length){const e=i.getRecordStoreUIParent(),t=o[0],r=t.getContentStore(),a=t.getContentStores();if(a.reverse(),null!=e&&e.valueIs(s.i)){for(const t of a)d.Od({parent:r,childToRemove:t,shouldGarbageCollect:!1,transaction:n}),d.BE({parent:e,insert:t,after:i,transaction:n});d.Od({parent:e,childToRemove:i,transaction:n,shouldGarbageCollect:!1})}}}}},65770:(e,t,n)=>{n.d(t,{Y:()=>y,Z:()=>b});n(57658);var o=n(68626),i=n(21202),r=n(23867),a=n(52629),s=n(7032),l=n(95477),c=n(65598),d=n(6258),u=n(3022),p=n(54532),m=n(94419),f=n(42858),g=n(24677),h=n(13447);const v=new Set(["text","table_row","header","sub_header","sub_sub_header","to_do","bulleted_list","numbered_list","toggle"]);function b(e){const{parentStore:t,transaction:n,store:r,environment:l}=e,c=r.path[1];if(2!==r.path.length||"properties"!==r.path[0]||"string"!=typeof c)return;const f=r.getRecordStoreAtRootPath();if(!(f instanceof d.G))return;const g=f.getType();if(!g||!v.has(g))return;const h=function(e){var t;const{environment:n,store:o,parentStore:r,transaction:a}=e;if(o.getSpaceId()!==r.getSpaceId())return;const l=null===(t=r.getModel())||void 0===t?void 0:t.getContentIds();if(null==l||!l.includes(o.id))return;const c=p.K8(n,{blockId:o.id,inMemoryRecordCache:o.inMemoryRecordCache,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0});if(!c)return;const d=p.E9({environment:n,sourceBlockId:o.id,targetBlockPointer:{table:i.iU,id:(0,s.ZP)(),spaceId:o.pointer.spaceId},sourceBlockSubtree:c,targetInMemoryRecordCache:o.inMemoryRecordCache,deepCopyTransclusionContainers:!1,resolveTemplateVariables:!1,transaction:a,useCrdt:r.getRecordStoreAtRootPath().useCrdt()});return m.rS({parent:r.getContentStore(),oldChild:o,newChild:d.targetBlock,transaction:a}),d.targetBlock}({environment:l,store:f,parentStore:t,transaction:n}),b=null==h?void 0:h.getPropertyStore(c);if(b)return n.postSubmitCallbacks.push((e=>{e&&o.log({from:"legacyTransclusionActions",level:"error",type:"maybeAutofixLegacyTransclusionProperty",error:{miscErrorString:(0,a.LK)(e)}}),u.Gb(l,{block_type:g,successful:!e})})),b;o.log({from:"legacyTransclusionActions",level:"error",type:"maybeAutofixLegacyTransclusionProperty",error:{message:"copied transclusion block does not have expected property"}})}function y(e){const{environment:t,store:n}=e,o=n.getRecordStoreUIParent();o&&(0,c.dz)(o)&&h.createAndCommit({userAction:"legacyTransclusionActions.fixLegacyTransclusion",environment:t,perform:e=>{const[i]=p.Qi({environment:t,stores:[n],addCopyName:!1,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,targetSpaceId:(0,r.C)(n.pointer.spaceId),baseUrl:l.default.domainBaseUrl,publicDomainName:l.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:o.getRecordStoreAtRootPath().useCrdt()}),a=i[0],{child:s}=m.BE({parent:o,insert:a,after:n,transaction:e});f.Od({store:n,transaction:e}),g.Z5({environment:t,stores:[s]})}})}},45990:(e,t,n)=>{n.d(t,{F5:()=>h,PP:()=>f,dz:()=>p,gp:()=>m,iX:()=>g});var o=n(70203),i=n(48709),r=n(68056),a=n(89224),s=n(23178),l=n(24666),c=n(993),d=n(98104),u=n(13447);function p(e){const t=l.default.state;if("editing"!==t.mode)return;const n="selectionFocus"===e.type?(0,r.TD)({store:e.store,selection:e.selection}):t.multiSelection,c=(0,r.QY)(n);if(!c)return;const{tokensInsideRange:d}=o.xrQ(c.store.getValue(),n.start.index,n.end.index),u=d.find((e=>Boolean(o.Hze(e)))),p=a.get();if(!p)return;const m=a.getRect(p);if(!m)return;const f=Boolean(u);let g="";if(!u){const e=o.Jcv(d),t=o.rOz(e);t&&(g=t.href)}s.Z.setState({open:!0,url:g,title:u&&(0,i.Ts)(u)||"",editingToken:u,savedTextSelectionState:{...t,multiSelection:n},selectionRect:m,focusLinkInput:!f&&e.focus,focusTitleInput:f&&e.focus})}function m(e){const{environment:t,transaction:n,url:o,title:i,editingToken:a,savedTextSelectionState:s}=e,l=(0,r.QY)(s.multiSelection);if(!l)return;a&&c.Be({environment:t,store:l.store,type:"a",selection:l.selection,transaction:n});const u=["a",o];return c.i8({environment:t,store:l.store,annotation:u,selection:l.selection,transaction:n}),d.Z5({store:l.store,selection:{startIndex:l.selection.startIndex,endIndex:l.selection.endIndex}}),i?{editingToken:[i,[u]]}:void 0}function f(e){const t=s.Z.state;if(!t.open)return;const{editingToken:n,savedTextSelectionState:o}=t;if(!n)return;const i=(0,r.QY)(o.multiSelection);i&&(u.createAndCommit({userAction:"linkAnnotationActions.unlinkSelection",environment:e,perform:t=>{c.Be({environment:e,store:i.store,type:"a",selection:i.selection,transaction:t})}}),l.default.emit(),s.Z.reset())}function g(e){const{environment:t,title:n,transaction:i,editingToken:a,savedTextSelectionState:s}=e;if(!n||!a)return;const l=(0,r.QY)(s.multiSelection);if(!l)return;const u=l.store;c.pz({environment:t,editorMode:"default",multiSelection:s.multiSelection,transaction:i});const p=l.selection.startIndex,m=p+n.length,f={startIndex:p,endIndex:m},g=["a",o.Hze(a)],h=o.V3y(n);return c.mM({environment:t,store:u,tokens:[h],index:p,transaction:i}),c.i8({environment:t,store:u,annotation:g,selection:f,transaction:i}),d.Z5({store:u,selection:f}),{editingToken:[n,[g]],savedTextSelectionState:{...s,multiSelection:{start:{store:u,index:p},end:{store:u,index:m}}}}}function h(){s.Z.setState({open:!1})}},94419:(e,t,n)=>{n.d(t,{BE:()=>c,Ce:()=>f,HP:()=>g,MK:()=>p,Od:()=>u,R3:()=>m,Vt:()=>d,rS:()=>l});n(57658);var o=n(77080),i=n(20747),r=n(19785),a=n(19358),s=n(13447);function l(e){const{parent:t,oldChild:n,newChild:o,transaction:i}=e,r=n.id,l=o.id,c=(t.getValue()||[]).indexOf(r);a.D0({parentStore:t,childStore:o,transaction:i}),a.If({parentStore:t,childStore:n,transaction:i}),c>=0&&(s.applyOperation({transaction:i,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{id:l,after:r}}}),s.applyOperation({transaction:i,store:t,operation:{pointer:t.pointer,path:t.path,command:"listRemove",args:{id:r}}}));return{parent:t,child:o.cloneWithNewUIParent(t)}}function c(e){const{parent:t,insert:n,after:i,transaction:l,preferHighLevelOperations:c}=e;let d;i&&(d=i.id),c&&o.default.checkGate("prefer_high_level_operations")?(l.annotateWithDebugTag("tx_tag.prefer_high_level_operations"),r.jG({childStore:n,parentStore:t,transaction:l,after:d})):(a.D0({parentStore:t,childStore:n,transaction:l}),s.applyOperation({transaction:l,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{after:d,id:n.id}}}));return{parent:t,child:n.cloneWithNewUIParent(t)}}function d(e){const{parent:t,insert:n,before:o,transaction:i}=e;let r;o&&(r=o.id),a.D0({parentStore:t,childStore:n,transaction:i}),s.applyOperation({transaction:i,store:t,operation:{pointer:t.pointer,path:t.path,command:"listBefore",args:{before:r,id:n.id}}});return{parent:t,child:n.cloneWithNewUIParent(t)}}function u(e){void 0===e.shouldGarbageCollect&&(e.shouldGarbageCollect=!0);const{parent:t,childToRemove:n,shouldGarbageCollect:o,transaction:r}=e;a.If({parentStore:t,childStore:n,transaction:r}),s.applyOperation({transaction:r,store:t,operation:{pointer:t.pointer,path:t.path,command:"listRemove",args:{id:n.id}}}),o&&r.preEnqueueActions.push((()=>{i.fU({parent:t,transaction:r})}));const l=n.cloneWithNewUIParent(t);return{parent:t,child:l}}function p(e){const{parent:t,append:n,transaction:o}=e;a.D0({parentStore:t,childStore:n,transaction:o}),s.applyOperation({transaction:o,store:t,operation:{pointer:t.pointer,path:t.path,command:"keyedObjectListAfter",args:{value:n.pointer,after:void 0}}});return{parent:t,child:n.cloneWithNewUIParent(t)}}function m(e){const{parent:t,append:n,transaction:o,after:i}=e;a.D0({parentStore:t,childStore:n,transaction:o}),s.applyOperation({transaction:o,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{id:n.id,after:i}}});return{parent:t,child:n.cloneWithNewUIParent(t)}}function f(e){const{parent:t,prepend:n,transaction:o,before:i}=e;a.D0({parentStore:t,childStore:n,transaction:o}),s.applyOperation({transaction:o,store:t,operation:{pointer:t.pointer,path:t.path,command:"listBefore",args:{id:n.id,before:i}}});return{parent:t,child:n.cloneWithNewUIParent(t)}}function g(e){const{parent:t,current:n,after:o,transaction:i}=e;o?c({parent:t,insert:n,after:o,transaction:i}):f({parent:t,prepend:n,transaction:i});return{parent:t,child:n.cloneWithNewUIParent(t)}}},13084:(e,t,n)=>{n.d(t,{Bm:()=>M,DC:()=>T,HO:()=>P,LQ:()=>C,UG:()=>A,dM:()=>E,uQ:()=>x});n(21703);var o=n(1302),i=n(41432),r=n(14248),a=n(21202),s=n(95371),l=n(53965),c=n(28020),d=n(65598),u=n(69645),p=n(73959),m=n(55367),f=n(6258),g=n(81023),h=n(54569),v=n(42239),b=n(31781),y=n(20747),_=n(94419),S=n(9953),w=n(42858),k=n(24677),I=n(98104);function C(e){const{environment:t,droppedDirection:n,droppedStores:o,targetStore:s,targetParentStore:c,transaction:d,duplicate:u}=e,p=o.every((e=>e.isExternalObjectInstancePageBlockStore()))||u;if(s&&n===m.vh.Onto){k.ZH(t);const e=!(s.isInsideTemplate()||s.isInsideFactoryOrDuplicateBlocksAction());let n=s;if(s.isType(i.Ti.alias)){const e=s.getAliasTargetStore();if(!e)throw new Error("Alias has no target.");e instanceof f.G&&(n=e)}const a=v.LQ({environment:t,droppedStores:o,duplicate:p,transaction:d,resolveTemplateVariables:e,duplicateUseCrdt:n.useCrdt()}),l=n.getCollectionViewCollectionStore();if(n.isCollectionView()&&!n.isCollectionViewPageWithContent()){if(!l)throw new Error("CollectionStore is not defined.");const e=h.o3({environment:t,stores:a,transaction:d,spaceId:l.getSpaceId()});for(const n of e)h.mp({environment:t,store:n,collectionStore:l,shouldCoerce:!0,groupsPointer:[],transaction:d});return e}{const e=n.getAssociatedCollectionStore();if(null!=e&&e.isPageTreeCollection())for(const n of a){if("page"!==n.getType())continue;if(!n.isDefined())continue;const t=r.Xq({blockProperties:n.getProperties(),oldSchema:n.getSchema(),newSchema:e.getSchema(),typesMatch:!1,oldPropertyMapping:void 0,newPropertyMapping:void 0});t.propertyUpdate&&Object.keys(t.propertyUpdate).length>0&&S.sW({store:n.getPropertiesStore(),data:t.propertyUpdate,transaction:d})}const t=n.getContentStore();for(const n of a)_.R3({parent:t,append:n,transaction:d});return a}}{const e=!!s&&!(s.isInsideTemplate()||s.isInsideFactoryOrDuplicateBlocksAction(!1)),i=c.getRecordStoreAtRootPath();let r=v.LQ({environment:t,droppedStores:o,duplicate:p,transaction:d,resolveTemplateVariables:e,duplicateUseCrdt:i.table===a.iU?i.useCrdt():"same_as_store"});return n===m.vh.Above?(r=l.d9(r),s?r=l.UI(r,(e=>_.Vt({parent:c,insert:e,before:s,transaction:d}).child)):(r.reverse(),r=l.UI(r,(e=>_.Ce({parent:c,prepend:e,transaction:d}).child)))):n===m.vh.Below?(r=l.d9(r),s?(r.reverse(),r=l.UI(r,(e=>_.BE({parent:c,insert:e,after:s,transaction:d}).child))):r=l.UI(r,(e=>_.R3({parent:c,append:e,transaction:d}).child))):s&&n===m.vh.Left?r=y.U_({environment:t,parent:c,insertStores:r,left:s,transaction:d}):s&&n===m.vh.Right&&(r=y.FZ({environment:t,parent:c,insertStores:r,right:s,transaction:d})),w.DV({environment:t,insertedStores:r}),k.Z5({environment:t,stores:r}),r}}function x(e){var t;const{environment:n,files:o,droppedDirection:i,targetStore:r,targetParentStore:a,transaction:s}=e,l=a.inMemoryRecordCache,d=c.qQ(n);C({environment:n,targetParentStore:a,targetStore:r,droppedDirection:i,droppedStores:b.z({environment:n,files:o,inMemoryRecordCache:l,pageWidth:d,transaction:s,spaceId:null==r?void 0:r.pointer.spaceId,useCrdt:(null===(t=(0,p.sQ)(a))||void 0===t?void 0:t.useCrdt())??!1}),duplicate:!1,transaction:s})}function T(e){const{environment:t,targetStore:n,isAtStartOfLine:o}=e;(function(e){const{environment:t,isClick:n,targetStore:o}=e;if(!n)return!1;const r=o.findRecordStoreUIAncestor((e=>e instanceof f.G&&e.isTransclusionType())).ancestor;if(r&&r instanceof f.G){const e=o.findRecordStoreUIAncestor((e=>e instanceof f.G&&e.getType()===i.Ti.transclusionReference)).ancestor,n=(e&&e instanceof f.G?e:void 0)||r,a=n.getRecordStoreUIParent();if(!a||!(0,d.dz)(a))return;return k.Z5({environment:t,stores:[n]}),!0}return!1})(e)||E({environment:t,store:n,isAtStartOfLine:o})||function(e){const{environment:t,targetStore:n,isAtStartOfLine:o}=e,i=k.KX(),r=i.indexOf(n);if(-1===r)return!1;if(o)for(let a=r;a>=0&&a>r-20;a--){if(E({environment:t,store:i[a],isAtStartOfLine:!1}))return!0}else for(let a=r;a<i.length&&a<r+20;a++){if(E({environment:t,store:i[a],isAtStartOfLine:!0}))return!0}}(e)}function M(e){const{environment:t,targetStore:n,isAtStartOfLine:o}=e;E({environment:t,store:n,isAtStartOfLine:o})||D({...e,placement:"after"})}function P(e){return R(e)}function A(e){return R(e)}function R(e){const{environment:t,container:n,store:o,transaction:r}=e,c=function(e){var t;const{container:n,store:o}=e;let r=(0,u.dq)({includeNonSelectableListContainer:!0,container:n});r&&o&&(r=l.Z$((0,s.DY)([r],(e=>e.value.store===o))));if(!r)return;let a=r;for(;a.children.length>0;){const e=l.Z$(a.children);if(0===e.children.length)break;const t=e.value.store.getType();if(t&&i.BT[t])break;a=e}return{parentStore:a.value.store,siblingStore:null===(t=l.Z$(a.children))||void 0===t?void 0:t.value.store}}({container:n,store:o});if(!c)return!1;const{parentStore:p,siblingStore:m}=c;if(m&&(0,d.PF)(m))return!1;const f=p.getParentStore();return D({environment:t,targetParentStore:(p.getType()===i.Ti.tab&&(null==f?void 0:f.table)===a.iU?f:p).getContentStore(),placement:"after",transaction:r})}function D(e){const{environment:t,targetStore:n,targetParentStore:r,placement:a,transaction:s}=e;if(r.getValue()&&g.M_(t)&&g.M_(t)){var l;const e=S.j4({environment:t,type:i.Ti.text,inMemoryRecordCache:r.inMemoryRecordCache,transaction:s,spaceId:r.pointer.spaceId,useCrdt:(null===(l=(0,p.sQ)(r))||void 0===l?void 0:l.useCrdt())??!1}),c="after"===a?_.BE({parent:r,after:n,insert:e,transaction:s}):_.Vt({parent:r,before:n,insert:e,transaction:s});return o.default.afterNextFlush((()=>{E({environment:t,store:c.child,isAtStartOfLine:!1})})),!0}return!1}function E(e){const{environment:t,store:n,isAtStartOfLine:o}=e,i=(0,p.mh)(n);return!!i&&(k.eP({environment:t,store:n}),o?I.N_({store:i}):I.NX({store:i}),!0)}},92625:(e,t,n)=>{n.d(t,{j:()=>r,x:()=>a});var o=n(33929),i=n(31104);function r(e){let{message:t,interpolatedValues:n,targetRecordId:r}=e;i.Z.setState({open:!0,message:o.default.formatMessage(t,n),targetRecordId:r})}function a(){i.Z.setState({open:!1,targetRecordId:void 0})}},98730:(e,t,n)=>{n.d(t,{S:()=>s});var o=n(97638),i=n(96820),r=n(80444),a=n(84166);async function s(e){const{hasPublicAccessPermission:t}=o.bC(e),n=r.default.state.currentSpaceStore,s=r.default.state.currentSpaceViewStore;if(t)return;if(!n)return;const l=await(0,i.S)({environment:e,currentSpaceStore:n,currentSpaceViewStore:s,excludeCurrentPage:!1});l&&a.Z.update((e=>({...e,localSearchableBlocksCache:l})))}},35979:(e,t,n)=>{n.d(t,{Be:()=>c,TR:()=>h,V_:()=>u,WA:()=>v,_5:()=>d,lJ:()=>m,nk:()=>g,wt:()=>f,z_:()=>l});var o=n(79946),i=n(38208),r=n(97978),a=n(77080);function s(e,t){r.j(e,t)}function l(e){s(e,"request_login_with_apple"),p(e,"login-with-apple")}function c(e){s(e,"request_login_with_google"),p(e,"login-with-google")}function d(e){s(e,"send_temporary_password"),p(e,"temporary-passcode")}function u(e){s(e,"redirect_to_saml_login"),p(e,"saml")}function p(e,t){r.j(e,"login_attempt",{login_method:t})}function m(e,t){i.o7(e,"signup_login_button_clicked",t),a.default.logEvent("signup_login_button_clicked",t.login_method,t)}function f(e,t){r.j(e,"login_success",t,{dontWait:!0})}function g(e,t){const{isBannedGoogleSSOUserAgent:n,isSignup:r}=t;i.o7(e,"onboarding_landing_page",{is_banned_google_sso_user_agent:n,is_signup:r}),r&&o.T1()}function h(e,t){const{actionType:n,isSignup:o}=t;r.j(e,"google_one_tap_login_button_click",{is_signup:Boolean(o),action_type:n},{dontWait:!0})}function v(e,t){r.lu(e,"login_email_input_updates","login_email_input_updates",1)}},97977:(e,t,n)=>{n.r(t),n.d(t,{actuallyLogoutAndDeleteMostLocalData:()=>Ie,clearCurrentUser:()=>ke,clearMostUserStorageAndState:()=>de,handleLoginFailureIfSamlRequired:()=>Ee,handleLoginSuccess:()=>Ce,handleLoginWithMfa:()=>xe,handleLoginWithTemporaryPasscodeSuccess:()=>fe,initialize:()=>Pe,loginPasswordReset:()=>ye,loginSamlUser:()=>_e,loginSamlUserWithToken:()=>be,loginWithAppleAuth:()=>ge,loginWithGoogleAuth:()=>he,loginWithTemporaryPasscode:()=>me,logout:()=>we,logoutSingleAccount:()=>Se,openBrowserInMobileNative:()=>pe,redirectToSaml:()=>ve,requestLoginWithGoogleOneTap:()=>ue,setLocalStorageUserId:()=>Me,shouldCreatePassword:()=>Re,showSamlRedirectMessage:()=>Be});n(57658),n(21703);var o=n(87997),i=n(79946),r=n(15145),a=n(53504),s=n(68626),l=n(99405),c=n(89101),d=n(19889),u=n(66079),p=n(9852),m=n(54153),f=n(66504),g=n(9291),h=n(53965),v=n(52629),b=n(37850),y=n(7032),_=n(1898),S=n(18265),w=n(47839),k=n(29974),I=n(95477),C=n(97978),x=n(91924),T=n(12955),M=n(33954),P=n(87381),A=n(33929),R=n(28125),D=n(57491),E=n(78873),B=n(18514),F=n(15517),O=n(32223),Z=n(75538),V=n(18245),U=n(19034),L=n(78861),j=n(84693),N=n(58455),z=n(80444),q=n(77080),W=n(53730),H=n(6258),K=n(27724),G=n(24666),$=n(88893),Q=n(36610),Y=n(54642),J=n(35793),X=n(47307),ee=n(57400),te=n(3297),ne=n(94273),oe=n(92625),ie=n(35979),re=n(4408),ae=n(8055),se=n(32219),le=n(70782);const ce=(0,g.defineMessages)({unsavedChanges:{id:"loginActions.dialogError.logoutUnsavedChanges.message",defaultMessage:"You have unsaved changes. If you log out now, you could lose them."},logoutWithoutSaving:{defaultMessage:"Discard edits and log out",id:"loginActions.dialogError.logoutUnsavedChanges.confirmButton.label"},signupPendingMessage:{defaultMessage:"Creating Notion accountâ€¦",id:"loginActions.signup.pending.message"},loginPendingMessage:{defaultMessage:"Logging in to Notionâ€¦",id:"loginActions.login.pending.message"},redirectSamlMessage:{defaultMessage:"SAML SSO required. Redirecting to the configured login page.",id:"loginActions.login.redirect.saml.message"}});async function de(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=[];if(t){const e=(0,p.DD)();sessionStorage.clear(),(0,p.In)(e)}else sessionStorage.clear();if(F.ZL(),n&&o.push(ke(e)),o.push(Q.NM()),e.mobileNative&&(o.push(e.mobileNative.logoutOfGoogle()),o.push(e.mobileNative.cancelUserBackgroundTasks())),e.device.isElectron&&(w.clearBrowserHistory(),t||w.clearCookies()),z.default.reset(),K.default.reset(),G.default.reset(),re.LK(e),O.resetRecordSubscriptions(),U.Z.reset(),N.default.reset(),Z.default.reset(),o.push(W.transactionQueue.reset()),"on"===q.default.getGroup("clear-record-cache-on-login")){const t=e.defaultRecordCache.persistedRecordCache;t&&"reset"in t&&o.push(t.reset())}q.default.reset(),await Promise.all(o)}async function ue(e){const{environment:t,idToken:n,store:o,frontPathName:i}=e,r=await(0,P.loadCurrentUserId)(t),a=V.default.mark("login_time.google"),s=await Y.loginWithGoogleJwt(t,{idToken:n});if(V.default.measure(a,{environment:t}),"success"===s.type){const{isNewSignup:e,userId:n}=s.data;return await Ce({environment:t,isNewSignup:e,userId:n,previousPersistedUserId:r,loginMethod:"login-with-google-onetap",frontPathName:i}),{status:"success"}}{await Ee(t,s);const e=(0,M.wf)(A.default.getIntl(),s);return o.setState({...o.state,alert:e}),{status:"fail"}}}function pe(e,t){e.mobileNative&&((0,x.Q7)(e)?e.mobileNative.openAuthSessionBrowser(t):e.mobileNative.openInAppBrowser(t))}async function me(e){const{environment:t,state:n,password:o,redirectURL:i,webBrowserDeviceId:r,passcodeEnterMethod:a,showInvitationVersion:s}=e,l=V.default.mark("login_time.passcode"),d=await(0,P.loadCurrentUserId)(t),u=await Y.loginWithEmail(t,{state:n,password:o});if(V.default.measure(l,{environment:t}),"success"!==u.type){await Ee(t,u);return(0,M.wf)(A.default.getIntl(),u)}{const{isNewSignup:e,userId:n}=u.data;if(w.electronApi&&function(e){let{environment:t,isNewSignup:n,webBrowserDeviceId:o}=e;const i=t.device.isElectron&&n&&!o;if(!i)return!1;return q.default.checkGate("desktop_app_login_with_email_redirect")}({environment:t,isNewSignup:e,webBrowserDeviceId:r})){const e=S.$U(S.bf({url:`${I.default.domainBaseUrl}${c._j.loginSuccess}`}));w.electronApi.openExternalUrl(e)}else await fe({environment:t,isNewSignup:e,userId:n,redirectURL:i,previousPersistedUserId:d,loginMethod:"temporary-passcode",webBrowserDeviceId:r,passcodeEnterMethod:a,showInvitationVersion:s})}}async function fe(e){const{environment:t}=e;await Ce(e);const[n,o,i]=await Promise.all([Re(t),De(t),Ae()]);(n&&o||n&&i)&&E.E({environment:t})}async function ge(e){const{environment:t,code:n,encryptedToken:o,encryptedNonce:i,encryptedUserObject:r,webBrowserDeviceId:a}=e,s=V.default.mark("login_time.apple"),l=await(0,P.loadCurrentUserId)(t),c=await Y.loginWithAppleAuth(t,{code:n,encryptedToken:o,encryptedNonce:i,encryptedUserObject:r});if(V.default.measure(s,{environment:t}),"success"!==c.type)return await Ee(t,c),(0,M.wf)(A.default.getIntl(),c);{const{isNewSignup:e,userId:n}=c.data;await Ce({environment:t,isNewSignup:e,userId:n,previousPersistedUserId:l,loginMethod:"login-with-apple",webBrowserDeviceId:a})}}async function he(e){const{environment:t,encryptedToken:n,code:o,callbackType:i,webBrowserDeviceId:r}=e,a=await(0,P.loadCurrentUserId)(t),s=await Y.loginWithGoogleAuth(t,{code:o,encryptedToken:n,callbackType:i});if("success"!==s.type)return await Ee(t,s),(0,M.wf)(A.default.getIntl(),s);{const{isNewSignup:e,userId:n}=s.data;await Ce({environment:t,isNewSignup:e,userId:n,previousPersistedUserId:a,loginMethod:"login-with-google",webBrowserDeviceId:r})}}function ve(e,t){ie.V_(e),e.mobileNative?pe(e,t):e.device.isElectron&&w.electronApi?w.electronApi.openExternalUrl(t):window.location.href=t}async function be(e){const{environment:t,csrfState:n,token:o,isNewSignup:i}=e,r=await(0,P.loadCurrentUserId)(t),a=await T.getBrowserId(t);n||o||s.log({level:"error",type:"loginSamlUserWithToken",from:"loginActions",error:{stack:(new Error).stack},data:{miscDataToConvertToString:{deviceId:a,isNewSignup:i}}});const l=await Y.loginWithEmail(t,{state:n,password:o});if("success"!==l.type)return await Ee(t,l),(0,M.wf)(A.default.getIntl(),l);{const{userId:e}=l.data;await Ce({environment:t,isNewSignup:i,userId:e,previousPersistedUserId:r,loginMethod:"saml"})}}async function ye(e){const{environment:t,csrfState:n,password:o,loginStore:i}=e,r=await(0,P.loadCurrentUserId)(t);if(!n){const e=await T.getCookie(t,"notion_browser_id");s.log({level:"error",type:"loginPasswordReset",from:"loginActions",error:{stack:(new Error).stack},data:{miscDataToConvertToString:{deviceId:e,previousPersistedUserId:r}}})}const a=await Y.loginWithEmail(t,{state:n,password:o,passwordReset:!0});if("success"!==a.type)return await Ee(t,a),(0,M.wf)(A.default.getIntl(),a);{const{userId:e,enabledMfaSettings:n}=a.data;n&&n.length>0?(xe({environment:t,isNewSignup:!1,userId:e,previousPersistedUserId:r,loginMethod:"password-reset",loginStore:i,mfaSettings:n}),ae.Li({environment:t,url:c._j.login}),E.E({environment:t})):(await Ce({environment:t,isNewSignup:!1,userId:e,previousPersistedUserId:r,loginMethod:"password-reset"}),E.E({environment:t}))}}async function _e(e){const{environment:t,userId:n,previousUserId:o,isNewSignup:i}=e;await Ce({environment:t,isNewSignup:i,userId:n,previousPersistedUserId:o,loginMethod:"saml"})}async function Se(e){const{environment:t,userId:n,logoutOrigin:o}=e,{nextUserId:i,nextSpaceViewStore:a}=function(e){const{environment:t,userId:n}=e,o=t.currentUser.id;if(n===o){const e=L.Z.getAllSpaceViewStores(t).filter((e=>{const t=e.getUserRootParentId();return t&&t!==n}))[0];return{nextUserId:e&&e.getUserRootParentId(),nextSpaceViewStore:e}}{const{currentSpaceViewStore:e}=z.default.state;return{nextUserId:o,nextSpaceViewStore:e}}}(e);if(i&&a){if(await W.transactionQueue.hasTasksForUser(n)){if(!(await X.confirmUserAction({message:A.default.formatMessage(ce.unsavedChanges),acceptLabel:A.default.formatMessage(ce.logoutWithoutSaving)})))return}await Y.logout(t,{userId:n,logoutOrigin:o}),await W.transactionQueue.clearForUser(n),F.ZL(n);const e=await le.x({environment:t,newCurrentUserId:i,loggedOutUserId:n}),{currentUserRootStore:s,currentUserSettingsStore:l}=z.default.state;s&&l&&k.y3({environment:e,spaceViewStore:a,userSettingsStore:l,userRootStore:s,pageVisitSource:r.tY.Login,navigationType:"switchingToOrLoadingSpace"}),w.refreshAll({includeFocusedWindow:!1})}else await we(t),w.refreshAll({includeFocusedWindow:!1})}async function we(e){if(await W.transactionQueue.anySessionHasTasks()){if(!(await X.confirmUserAction({message:A.default.formatMessage(ce.unsavedChanges),acceptLabel:A.default.formatMessage(ce.logoutWithoutSaving)})))return}(0,B.Sr)(e)?window.location.href=`${I.default.domainBaseUrl}/logout`:ae.c4({environment:e,url:c._j.logout})}async function ke(e){if(e.mobileNative&&await e.mobileNative.unregisterPushNotifications(),e.updateCurrentUserId){const t={environment:e,currentUserId:void 0,userIds:[]};e.updateCurrentUserId(t)}return{...e,currentUser:new o.CurrentUser}}async function Ie(e){const{environment:t,nextLocation:n,userId:o,doNotRedirect:i,logoutOrigin:r}=e;o?await Y.logout(t,{userId:o,logoutOrigin:r}):await Y.logout(t,{logoutOrigin:r}),await de(t),w.clearGoogleAuthCookies(),w.refreshAll({includeFocusedWindow:!1}),i||(window.location.href=n||c._j.root)}async function Ce(e){const{environment:t,isNewSignup:n,userId:o,redirectURL:r,previousPersistedUserId:d,frontPathName:u,webBrowserDeviceId:m,passcodeEnterMethod:f,showInvitationVersion:g}=e;n?oe.j({message:ce.signupPendingMessage}):oe.j({message:ce.loginPendingMessage});try{const h=R.k(t);if(re.LK(t),t.device.isElectron&&(w.clearBrowserHistory(),w.refreshAll({includeFocusedWindow:!1})),d&&d!==o){const e=await W.transactionQueue.getTotalNumberOfTasks();e>5&&s.log({level:"warning",from:"loginActions",type:"setLoggedInUserId",data:{userId:o,currentUserId:d,clearedTransactionCount:e}}),await de(t,h,!t.currentUser.loggedInUserIds.includes(d))}if(!d){const e=te.qd(void 0);te.nM({currentUserId:o,blockId:e}),te.nM({currentUserId:void 0,blockId:void 0})}const v=await Te(t,o);if(ie.lJ(v,{is_new_signup:n,login_method:e.loginMethod,front_pathname:u}),n){Q.ie(v,{user_id:o,tags:(0,p.mM)(),origin_initial_page:se.getInitialPage(o)});const t=await(0,C.of)(v);await(0,b.OI)(200,Y.initializeUserAnalyticsEmptySync(v,{isNewSignup:n,analyticsProperties:(0,a.Z)({...(0,C.Ts)(),...(0,C.eR)(),...(0,D.getMobileNativeDeviceInfo)(),...t,experiments:q.default.getExperimentsMap(),login_method:e.loginMethod,signup_from:t.route_name,front_pathname:u,web_browser_device_id:m,passcode_enter_method:f},"ignore-class-instances")}))}const S=q.default.checkGate("enable_oauth_from_desktop_ux_v2"),k=(0,p.r4)({config:S?I.default:void 0,fileHostProtocol:I.default.secureFileConfig.protocol,fileHostName:I.default.secureFileConfig.hostname});let x,M=r;if(M||"other"!==(null==k?void 0:k.type)||(M=k.result,(0,p.Rq)()),M&&(x=l.Wj({url:M,isMobile:v.device.isMobile,baseUrl:I.default.domainBaseUrl,publicDomainName:I.default.publicDomainName,protocol:I.default.protocol,currentUrl:window.location.href})),x)if(!x||"space"!==x.name&&"page"!==x.name){if(x&&"oauthAuthorization"===x.name){const{responseType:e,redirectUri:t,integrationId:n,state:o,owner:i,userId:r,spaceId:a}=x;(0,p.In)({responseType:e,redirectUri:t,integrationId:n,state:o,owner:i,userId:r,spaceId:a})}}else ne.nr(x,o);if(J.mc(v),ee.mc(),await ee.Yh(v),n&&(q.default.logEvent("sign_up",void 0,{login_method:e.loginMethod,device_type:t.device.deviceType}),q.default.logEvent("sign_up_by_login_method",e.loginMethod),q.default.logEvent("sign_up_by_device_type",t.device.deviceType)),ie.wt(v,{is_new_signup:n,login_method:e.loginMethod,logged_in_user_ids:v.currentUser.loggedInUserIds.map((e=>(0,y.F9)(e))),most_recent_user_id:(0,y.F9)(o),web_browser_device_id:m,passcode_enter_method:f}),i.j({device:v.device,event:{facebook:{eventName:"ViewContent"},google:{eventName:"loggedIn"}},cookieService:t.cookieService}),I.default.isAdminMode){if(!(await T.getGhostAdminUserId(t)))return void ae.c4({environment:t,url:"/__admin"})}const P="login"===t.RouterStore.state.route.name?t.RouterStore.state.route.redirectURL:void 0;"oauth"===(null==k?void 0:k.type)||"file"===(null==k?void 0:k.type)?((0,p.Rq)(),window.location.href=k.result):!h&&d&&d!==o?window.location.href=c._j.root:n?g?ae.c4({environment:v,url:c._j.onboarding}):ae.c4({environment:v,url:c._j.root}):M&&x&&(0,_.qg)(c.VP,x.name)||M&&x&&"samlAuthCallback"===t.RouterStore.state.initialRoute.name?ae.c4({environment:v,url:M}):P&&P.startsWith(`https://${l.VP("production")}/`)?ae.c4({environment:v,url:P}):ae.c4({environment:v,url:c._j.root})}finally{oe.x()}}function xe(e){const{loginStore:t,userId:n}=e,o=new H.U6(e.environment,{table:d.KJ,id:n},{userId:n});t.setState({...t.state,settings:e.mfaSettings,loginType:"mfa",redirectURL:e.redirectURL,previousPersistedUserId:e.previousPersistedUserId,userStore:o})}async function Te(e,t){await async function(e,t){await Me(e,t)}(e,t);let n=[t];const i=await(0,P.getUserIdsFromCookie)(e);i&&(i.push(t),n=h.jj(i));const r=await T.getGhostAdminUserId(e),a={...e,currentUser:new o.CurrentUser({id:t,loggedInUserIds:n,adminUserId:r})};if(e.updateCurrentUserId){const o={environment:e,currentUserId:t,userIds:n};await e.updateCurrentUserId(o)}return a.device.isFirefox||F.lr(),a}async function Me(e,t){const n=await(0,P.getUserIdsFromCookie)(e);n&&!n.includes(t)||m.Z.set(P.currentUserIdKey,t)}async function Pe(e){const t=await(0,P.loadCurrentUserId)(e),{mobileNative:n}=e;if(n&&n.sqliteConnection)try{await j.y6(n.sqliteConnection,t||f.I)}catch(o){s.log({level:"error",from:"loginAction.ts",type:"backfillRecordsWithUserId",error:(0,v.Ui)(o),data:{}})}return t?await Te(e,t):e}async function Ae(){var e;const{currentUserStore:t}=z.default.state;if(!t)return!1;if(!t.getEmail())return!1;const{currentUserSettingsStore:n}=z.default.state;return!!n&&(await n.load(),Boolean(null===(e=n.getSettings())||void 0===e?void 0:e.should_set_password_on_login))}async function Re(e){const{currentUserStore:t}=z.default.state;if(!t)return!1;const n=t.getEmail();if(!n)return!1;const o=await E.c({environment:e,userEmail:n});if(o.error)throw o.error;return!o.value.isSamlEnforced&&!o.value.hasPassword&&!o.value.didLogInWithSaml}async function De(e){const t=e.currentUser.id;if(!t)return!1;const n=new H.r9(e,{table:u.dx,id:t});await n.load();return(await(0,$.Gh)({environment:e,userRootStore:n})||[]).some((e=>e===I.default.pricing.student.productId))}async function Ee(e,t){var n,o;if("saml_sso_required"===(null===(n=t.body.clientData)||void 0===n?void 0:n.type)&&null!==(o=t.body.clientData)&&void 0!==o&&o.redirectUrl){await Be(2e3);ve(e,t.body.clientData.redirectUrl)}}async function Be(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;oe.j({message:ce.redirectSamlMessage}),await(0,b.Vs)(e),oe.x()}},27153:(e,t,n)=>{n.d(t,{$:()=>r,Z:()=>a});var o=n(91390),i=n(24677);function r(e,t){t.disableClearSelection||i.ZH(e),o.Z.setState({...t,isActive:!0})}function a(){const e=o.Z.state;e.isActive&&e.onCancel&&e.onCancel(),o.Z.reset()}},67060:(e,t,n)=>{n.d(t,{Br:()=>j,RL:()=>U,WI:()=>V,_P:()=>O,lZ:()=>Z,xv:()=>L});var o=n(49085),i=n(49143),r=n(21202),a=n(70203),s=n(53965),l=n(7032),c=n(69783),d=n(28020),u=n(49117),p=n(4708),m=n(44486),f=n(68056),g=n(98165),h=n(89224),v=n(90335),b=n(80444),y=n(64233),_=n(77080),S=n(19111),w=n(74510),k=n(83212),I=n(40061),C=n(72087),x=n(10743),T=n(24666),M=n(81023),P=n(35057),A=n(26189),R=n(88295),D=n(98730),E=n(993),B=n(13447);function F(e){const{textStore:t,environment:n}=e,o=(0,g.n3)(t)&&k.Z.getMode(n,t).hasPublicPermission,r=t.isDefaultRecordCache(),a=!o,l=a&&function(e){const t=(0,d.np)(),n=b.default.state.currentSpaceStore;if(!t||!n)return!1;return _.default.checkGate("inline_mention_invites")&&t.canEditMembership()&&n.canEditMembership()&&"enterprise"!==(0,P.zt)()&&!e.device.isMobile}(n),c=a&&function(e){const t=(0,d.np)();if(!t)return!1;return(0,v.gi)({store:t})&&t.canEditMembership()&&(0,p.$t)()}(),f=a,h=!o,y=function(e){const t=(0,d.RM)();if(!t||"block"!==e.table)return!1;if(t.isInsideTemplate())return!0;const n=m.W(e);if(n||t.isInsideFactoryOrDuplicateBlocksAction()){const t=null==n?void 0:n.getTitleStore();return!(n&&t&&t.id===e.id&&s.Xy(t.path,e.path))}if((0,u.td)(e))return!0;return!1}(t);return(0,i.lX)({page:true,createPage:r,user:a,inviteUserToWorkspace:l,inviteUserToPage:c,bot:f,date:!0,reminder:!0,templateVariable:y,group:h,heading:!0})}function O(e){const{environment:t,textStore:n,oldSelection:r,oldTextValue:s,disabledMentionTypes:d}=e,u=function(e){const{textStore:t,oldSelection:n}=e;if(x.Z.state.open||c.Z.state.open||y.Z.state.open)return;const o=a.eeV(t.getValue()||[]),i=n.startIndex,r=(o[i]||"").normalize("NFKD"),s=(o[i-1]||"").normalize("NFKD"),l=S.Z.state;if(l.open)return"[["===l.insertionType&&"]"===r&&"]"===s?"]]":void 0;if("@"===r){if(s&&!/[\s\(\)\[\]]/g.test(s))return;return"@"}if("+"===r){if(s&&!/[\s\(\)\[\]]/g.test(s))return;return"+"}if("[["===o.slice(i-1,i+1).join("")){const e=o[i-1];if(e&&!/[\s\(\)\[\]]/g.test(e))return;return"[["}}(e);if(!u)return;const p=S.Z.state;if("]]"===u){if(p.open){const e=p.temporaryInputData.state;e&&p.temporaryInputData.setState({...e,suffix:"]]"}),S.Z.setState({...p,showCreateIn:!0})}return}const m=h.get();if(!m)return;const f=h.getRect(m);if(!f)return;const g=F({textStore:n,environment:t}),v=g.page&&!d.page,b=g.heading&&!d.heading,_=g.createPage&&!d.createPage,w=g.user&&"@"===u&&!d.user,k=g.inviteUserToWorkspace&&"@"===u&&!d.inviteUserToWorkspace,I=g.inviteUserToPage&&"@"===u&&!d.inviteUserToPage,T=g.bot&&"@"===u&&!d.bot,M=g.date&&"@"===u&&!d.date,P=g.reminder&&"@"===u&&!d.reminder,R=g.templateVariable&&"@"===u&&!d.date&&!d.templateVariable,E=g.group&&"@"===u&&!d.group;if(!(w||E||v||_||M||P||R))return;if("+"===u&&!_)return;const B=(0,l.ZP)(),O=(0,l.ZP)();D.S(t),S.Z.setState({open:!0,flowId:B,sessionId:O,openTime:Date.now(),insertionType:u,textStore:n,oldTextValue:s,oldSelection:r,selectionRect:f,userRequestStore:new C.Z,botRequestStore:new C.Z,pageRequestStore:new C.Z,temporaryInputData:o.default.createValue(void 0),mentionTypes:(0,i.lX)({page:v,createPage:_,user:w,inviteUserToWorkspace:k,inviteUserToPage:I,bot:T,date:M,reminder:P,templateVariable:R,group:E,heading:b}),expandSection:void 0,showCreateIn:!1,showInvite:!1,showMentionAndShare:!1,createInQuery:"",isEmptyPageTitle:!1}),A.j1(t,{analyticsFrom:V(),flowId:B,searchSessionId:O})}function Z(e,t){E.N3({direction:"end"});const n=T.default.state;if("editing"!==n.mode)return;const o=(0,f.QY)(n.multiSelection);if(!o)return;let r=!1;if(o.selection.startIndex>0){const e=o.store.getValue()||[],t=a.eeV(e)[o.selection.startIndex-1];/[\s]/g.test(t)||(r=!0)}B.createAndCommit({userAction:"mentionMenuActions.insertMention",environment:e,perform:t=>{r?(E.hJ({environment:e,store:o.store,editorMode:"default",string:" ",selection:o.selection,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t}),E.hJ({environment:e,store:o.store,editorMode:"default",string:"@",selection:{startIndex:o.selection.startIndex+1,endIndex:o.selection.endIndex+1},disableMentions:!1,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t})):E.hJ({environment:e,store:o.store,editorMode:"default",string:"@",selection:o.selection,disableMentions:!1,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t})}});const s=S.Z.state;if(!s.open)return;const l=F({environment:e,textStore:o.store});S.Z.setState({...s,mentionTypes:(0,i.lX)({page:l.page&&t.page,createPage:l.createPage&&t.createPage,user:l.user&&t.user,inviteUserToWorkspace:l.inviteUserToWorkspace&&t.inviteUserToWorkspace,inviteUserToPage:l.inviteUserToPage&&t.inviteUserToPage,bot:l.bot&&t.bot,date:l.date&&t.date,reminder:l.reminder&&t.reminder,templateVariable:l.templateVariable&&t.templateVariable,group:l.group&&t.group,heading:l.heading&&t.heading})})}function V(){const e=S.Z.state;if(e.open)return e.textStore.table===r.iU?"block":"comment"}function U(e){const t=S.Z.state,{environment:n,annotations:o=[],transaction:i,menuListItemAction:r,query:s,serverEventProperties:l,mentionType:c,resultId:d,shareMenuSelection:u}=e;if(t.open){let e=t.oldTextValue,p=t.oldSelection;const m=t.insertionType.length-1;m>0&&(e=a._QS(e,t.oldSelection.startIndex-m,t.oldSelection.startIndex),p={startIndex:p.startIndex-m,endIndex:p.endIndex-m}),E.sO({environment:n,editorMode:"default",store:t.textStore,value:e,transaction:i});const f=V();o.forEach((e=>{E.lZ({environment:n,editorMode:"default",store:t.textStore,selection:p,annotation:e,analyticsFrom:f,transaction:i,shareMenuSelection:u})}));const g=Date.now();if("page"===c&&d&&I.Z.recordMention({id:d,timestamp:g,currentUserId:n.currentUser.id}),c){const{numServerRequests:e}=w.Z.state;A.z7(n,{clickIndexGlobal:null==r?void 0:r.index,clickIndexLocal:null==r?void 0:r.indexLocal.indexLocal,sectionIndex:null==r?void 0:r.indexLocal.section,analyticsFrom:f,timeToClickInMs:g-t.openTime,queryLength:s.length,serverEventProperties:l,mentionType:c,resultId:d,flowId:t.flowId,searchSessionId:t.sessionId,searchSessionFlowNumber:e})}L()}}function L(){S.Z.setState({open:!1,sessionId:void 0,userRequestStore:S.Z.state.userRequestStore,botRequestStore:S.Z.state.botRequestStore,pageRequestStore:S.Z.state.pageRequestStore,mentionTypes:S.Z.state.mentionTypes}),w.Z.reset()}async function j(e){const{environment:t,titleText:n,ignoreSelectionAreaStore:o,createInValue:i,onPageCreated:r,menuListItemAction:a}=e,s=S.Z.state;if(!s.open)return;if(!M.M_(t))return;o.reset();const{performResult:l}=await B.createAndCommitAsync({environment:t,userAction:"mentionMenuActions.acceptCreateIn",waitForServerCommit:!0,perform:async e=>{const o=R.f8({environment:t,transaction:e,titleText:n,createInValue:i,recordStoreParent:s.textStore}),l=o.createdPages[0];if(l)return r&&r(l),U({environment:t,annotations:[["p",l.id]],transaction:e,menuListItemAction:a,query:n,mentionType:"createPage"}),await o.moveToStorePromise,{createInState:o}}});if(l){const{createInState:e}=l;return await R.c_({analyticsFrom:"mention_menu",createInState:e}),e}}},91376:(e,t,n)=>{n.d(t,{CT:()=>l,r$:()=>s});var o=n(97799),i=n(80444),r=n(64404),a=n(92083);function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{currentTab:t,subtab:n,isMobile:r,openedFrom:s}=e;if(r)"notifications"!==t&&"notifications_and_settings"!==t&&"user_settings"!==t||o.Z.setState({open:!0});else if(t)a.Z.setState({open:!0,openedFrom:s,...c({currentTab:t,subtab:n}),highlightedSetting:void 0});else{const{currentSpaceStore:e}=i.default.state;a.Z.setState({open:!0,openedFrom:s,currentTab:l(e),defaultSubtab:void 0,highlightedSetting:void 0})}}function l(e){return e&&e.canRead()?"members":"settings"}function c(e){const{currentTab:t,subtab:n}=e;if("members"===t){return{currentTab:"members",defaultSubtab:n===r.Q.Members||n===r.Q.Groups||n===r.Q.Guests||n===r.Q.Reprovisioning||n===r.Q.Requests?n:void 0}}if("integrations"===t){return{currentTab:"integrations",defaultSubtab:"member_connections"===n||"workspace_connections"===n?n:void 0}}return{currentTab:t,defaultSubtab:void 0}}},60971:(e,t,n)=>{n.d(t,{aV:()=>r,eV:()=>a,kW:()=>c,sv:()=>d});var o=n(53965),i=n(85818);function r(e){const{store:t,itemsPerRow:n,sections:o,disableKeyboardArrowWrap:i}=e,{focus:r}=t.state;if(void 0===r.indexLocal)return c({store:t,sections:o,indexGlobal:0});const a=r.indexLocal+n,d=o[r.section],u=d.items.length-1;if(a<=u)return c({store:t,sections:o,indexLocal:{section:r.section,indexLocal:a}});const p=function(e){const{indexLocal:t,section:n,itemsPerRow:o}=e,i=l({indexLocal:t,section:n,itemsPerRow:o});if(!i)return;const r=s({section:n,itemsPerRow:o});if(!r)return;return i.rowsBefore===r.rowsBefore}({indexLocal:r.indexLocal,section:d,itemsPerRow:n});if(void 0===p)return;if(!1===p)return c({store:t,sections:o,indexLocal:{section:r.section,indexLocal:u}});const m=function(e){const{currentSection:t,sections:n,disableWrap:o}=e;if(0===n.length)return;if(t&&t>=n.length&&o)return;const i=void 0===t?0:(t+1)%n.length,r=n[i];if(!r)return;return{index:i,section:r}}({currentSection:r.section,sections:o,disableWrap:i});if(!m)return;const f=r.indexLocal%n;return m.section.items.length<=f?c({store:t,sections:o,indexLocal:{section:m.index,indexLocal:0}}):c({store:t,sections:o,indexLocal:{section:m.index,indexLocal:f}})}function a(e){const{store:t,itemsPerRow:n,sections:o,disableKeyboardArrowWrap:r}=e,{focus:a}=t.state;if(void 0===a.indexLocal){return c({store:t,indexGlobal:i.tM(o)-1,sections:o})}const l=a.indexLocal-n;if(l>=0)return c({store:t,sections:o,indexLocal:{section:a.section,indexLocal:l}});const d=function(e){const{currentSection:t,sections:n,disableWrap:o}=e;if(0===n.length)return;if(0===t||void 0===t){if(o)return;const e=n.length-1,t=n[e];if(!t)return;return{index:e,section:t}}const i=n[t-1];if(!i)return;return{index:t-1,section:i}}({currentSection:a.section,sections:o,disableWrap:r});if(!d)return;const u=s({section:d.section,itemsPerRow:n});if(!u)return;const p=a.indexLocal%n;if(u.column<p)return c({store:t,sections:o,indexLocal:{section:d.index,indexLocal:u.indexLocal}});{const e=u.rowsBefore*n+p;return c({store:t,sections:o,indexLocal:{section:d.index,indexLocal:e}})}}function s(e){const{section:t,itemsPerRow:n}=e;if(0===t.items.length)return;if(0===n)return;const o=t.items.length-1,i=l({indexLocal:o,section:t,itemsPerRow:n});return i?{indexLocal:o,...i}:void 0}function l(e){const{indexLocal:t,section:n,itemsPerRow:o}=e;if(!(o<=0||t>=n.items.length))return{rowsBefore:Math.trunc(t/o),column:t%o}}function c(e){const{store:t,sections:n}=e;if(e.indexLocal){const o=i.$6(e.indexLocal,n);if(!i._K(e.indexLocal,n))return;t.setState({...t.state,focus:{...e.indexLocal,indexGlobal:o}})}else if(void 0===e.indexGlobal)t.unsetFocus();else{const o=i.Ds(e.indexGlobal,n);if(!o)return;t.setState({...t.state,focus:{...o.index,indexGlobal:e.indexGlobal}})}}function d(e){let{store:t,focus:n}=e;"number"==typeof t.state.focus.indexLocal&&(o.Xy(n,t.state.focus)||t.setState({...t.state,focus:n}))}},98958:(e,t,n)=>{n.r(t),n.d(t,{handleTokenRefresh:()=>m,initializeMobileNativeApp:()=>u,registerPushNotifications:()=>p,waitForCssInsets:()=>f});var o=n(68626),i=n(62643),r=n(52629),a=n(37850),s=(n(95477),n(97978)),l=n(54642),c=n(9953),d=n(13447);async function u(e){if(e.device.isMobileNative&&e.mobileNative&&(await f(e),e.mobileNative.updateReceiveApiHandlers({track:t=>{s.j(e,t.eventName,{...t.eventData,logging_source:"mobile_native"})}}),e.mobileNative&&e.mobileNative.sqliteConnection))try{await e.mobileNative.sqliteConnection.ensureMigrated(),e.mobileNative.sqliteConnection.optimize()}catch(t){o.log({level:"error",from:"loginAction.ts",type:"backfillRecordsWithUserId",error:(0,r.Ui)(t),data:{}})}}async function p(e){const{mobileNative:t}=e;if(t&&t.api.registerPushNotifications){const n=await t.api.registerPushNotifications();n&&m(e,n,"registration")}}async function m(e,t,n){const o=e.currentUser.id;if(t&&o){const n=(0,i.r9)({user_id:o,token:t}),r=await l.syncRecordValue(e,{pointer:{table:i.q4,id:n},userId:o,version:-1});let a=!1;r&&(r.value&&!r.value.invalid||(d.createAndCommit({userAction:"mobileNativeActions.handleTokenRefresh",environment:e,perform:r=>{c.ae({environment:e,table:i.q4,value:{id:n,token:t,user_id:o,invalid:!1},inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,transaction:r})}}),a=!0))}}async function f(e){if(!e.device.isIOS||!e.device.isMobileNative)return;const t=document.createElement("div");t.style.width=`calc(${["env(safe-area-inset-top)","env(safe-area-inset-bottom)","env(safe-area-inset-left)","env(safe-area-inset-right)"].join(" + ")})`,t.style.visibility="hidden",document.body.appendChild(t);let n=0;for(;n<50&&!(t.offsetWidth>0);)await a.Vs(1),n++;document.body.removeChild(t),e.WindowSizeStore.updateWindowSize()}},29533:(e,t,n)=>{n.d(t,{R:()=>r,h:()=>a});var o=n(40470),i=n(17294);function r(e,t){const n={taskStatus:e.taskStatus,...o.x.isSuccess(e)?{completeBlocks:e.value.completeBlocks,totalBlocks:e.value.totalBlocks}:{}};i.Z.update((e=>({...e,[t]:n})))}function a(e){i.Z.update((t=>({...t,[e]:void 0})))}},60870:(e,t,n)=>{n.d(t,{I0:()=>y,eX:()=>v,j2:()=>b,wS:()=>h});n(67294);var o=n(15157),i=n(21202),r=n(53965),a=n(19584),s=n(75770),l=n(98110),c=n(80444),d=n(6258),u=n(73990),p=n(76464),m=n(64964),f=n(85893);const g=10;function h(e){const{environment:t,movedItems:n,previousParentIds:o,moveToLocation:i,disableSuccessToast:r,numSubitems:a}=e,c=n.some((e=>{const t=o[e.id],n=e.getParentId();return!(!t||t===n)}));!r&&c&&m.oV({label:(0,s.ah)({environment:t,movedItems:n,moveToLocation:i,numSubitems:a}),right:(0,f.jsx)(l.Z,{moveToLocation:i,movedItems:n})})}function v(e){const{environment:t,transaction:n,moveToStore:o,targetBlocks:i,from:r}=e,{currentUserStore:a}=c.default.state;null!=a&&a.isDefined()&&o.canEdit()&&!o.canAdmin()&&i.forEach((e=>{if(e.canAdmin())return u.Y8(t,{from:r}),p.ep({transaction:n,store:e,environment:t,permissionItems:[{type:"user_permission",user_id:a.id,role:"editor"}]})}))}async function b(e,t,n){const i=await y(e,t),a=r.jj([n,...i]).slice(0,g);o.Z.set({userId:e.environment.currentUser.id,key:_(t),value:JSON.stringify(a)})}async function y(e,t){const n=o.Z.get({userId:e.environment.currentUser.id,key:_(t)});if(n){const t=(0,a.dj)(n);if(t){const n=await Promise.all(t.map((async t=>{const n=d.G.createChildStore(e,{table:i.iU,id:t});return await n.load(),n.canEdit()})));return t.filter(((e,t)=>n[t]))}}return[]}function _(e){return`recentMoveToTargets2:${e}`}},11302:(e,t,n)=>{n.d(t,{$X:()=>X,QF:()=>ee,RL:()=>ne,Ws:()=>ie,Y:()=>ae,at:()=>de,bA:()=>J,kj:()=>re,pB:()=>te,xv:()=>oe,z1:()=>Q});n(52262),n(24506),n(21703);var o=n(15145),i=n(92996),r=n(41432),a=n(99036),s=n(68626),l=n(21202),c=n(6287),d=n(9291),u=n(53965),p=n(7032),m=n(1898),f=n(10906),g=n(27105),h=n(19037),v=n(97978),b=n(77181),y=n(33929),_=n(75770),S=n(98165),w=n(48779),k=n(5162),I=n(80444),C=n(77556),x=n(77080),T=n(42330),M=n(98452),P=n(6258),A=n(52258),R=n(52229),D=n(73990),E=n(6404),B=n(54569),F=n(30188),O=n(47307),Z=n(57400),V=n(92625),U=n(60870),L=n(72711),j=n(19785),N=n(1357),z=n(24677),q=n(64964),W=n(29974),H=n(150),K=n(13447),G=n(68422),$=n(65452);function Q(){return[h._z,h.Ggh,h.jlf,h.ffD(h.$I3),h.ffD(h.xwj),h.ffD(h.P99(r.Ti.externalObjectInstancePage)),h.ffD(h.CJE),h.k5s,h.ffD(h.q4$),h.ffD(h.uY7)]}const Y=(0,d.defineMessages)({duplicatingContent:{id:"moveToMenuActions.duplicatingContent.loadingMessage",defaultMessage:"Duplicating contentâ€¦"},duplicatedToSpace:{id:"moveToMenuActions.duplicatedToSpace.toast",defaultMessage:"Duplicated {name} to {spaceName}"}});function J(e){const{environment:t,blocks:n,originRect:o,moveToContext:r,onAccept:a,isAddTo:s,isDefaultPrivateLocation:l,disableSuccessToast:c,forceUntyped:d}=e,u=Date.now(),m=(0,T.rJ)(n),f=function(e){const{hasDatabaseType:t,forceUntyped:n}=e;if(n)return i.br;if(t)return i.ii;return i.br}({forceUntyped:d,hasDatabaseType:Boolean(m)}),g=(0,p.ZP)();n.length&&(A.Z.reset(),M.Z.reset(),E.xv(),T.ZP.setState({variant:f,isOpen:!0,rect:o,targets:n,autocompleteQuery:"",moveToContext:r,onAccept:a,isAddTo:s,isDefaultPrivateLocation:l,lastPageId:T.ZP.state.lastPageId,disableSuccessToast:c,openedTimeMs:u,flowId:g}),D.rY(t,{from:r,render_type:"web",target_block_ids:n.map((e=>e.id)),targets_database_type:m,flowId:g}))}async function X(e){const t=await async function(e){var t;const{environment:n,blocks:o,originRect:r,moveToContext:a,onAccept:s,isAddTo:l}=e,{currentSpaceStore:c}=I.default.state,d=Date.now(),u=T.ZP.state.isOpen?T.ZP.state.flowId:(0,p.ZP)(),m=(0,T.rJ)(o);if(m&&m!==i.GZ)return!1;if(!(0,k.Y)("supportsNativeMoveTo")||null===(t=n.mobileNative)||void 0===t||!t.api.moveTo||0===o.length||!c)return!1;const f=o.map((e=>e.id)),g=await n.mobileNative.moveTo({targets:f,spaceId:c.id,isAddTo:l||!1,moveToContext:a,flowId:u});if(!g)return!1;if(!g.supported||!g.destination)return g.supported;A.Z.reset(),M.Z.reset(),E.xv(),T.ZP.setState({variant:i.br,isOpen:!0,rect:r,targets:o,autocompleteQuery:"",moveToContext:a,onAccept:s,isAddTo:l,lastPageId:T.ZP.state.lastPageId,renderType:"mobileNative",openedTimeMs:d,flowId:u});const h=T.ZP.state.isOpen&&T.ZP.state.useSudoMode;return await te({environment:n,value:g.destination,useSudoMode:h,renderType:"native",isSearchResult:g.isSearchResult}),oe(n),!0}(e);t||J(e)}function ee(e,t,n){if("page"!==n.type)return!1;const o=new P.G(e,{table:l.iU,id:n.id}),i=(0,S.qA)(o);for(const r of i)if(t.includes(r.id))return!0;return!1}async function te(e){const{environment:t,value:n,useSudoMode:o,renderType:i,shouldClearPagePermissions:r,isSearchResult:a}=e;await K.createAndCommitAsync({environment:t,userAction:"MoveToMenuRenderer.completeMoveTransaction",waitForServerCommit:!1,useSudoMode:o,perform:async e=>{const o=T.ZP.state;if(!o.isOpen)return;const{targets:s,disableSuccessToast:l,moveToContext:c,isDefaultPrivateLocation:d,flowId:u,autocompleteQuery:p}=o;await ne({targets:s,value:n,transaction:e,environment:t,shouldClearPagePermissions:r,disableSuccessToast:l,moveToContext:c,isDefaultPrivateLocation:d,renderType:i,timeToSelectMs:Date.now()-o.openedTimeMs,flowId:u,isSearchResult:Boolean(p)||a}),o.onAccept&&o.onAccept(n)}})}async function ne(e){let{targets:t}=e;const{value:n,transaction:o,environment:i,shouldClearPagePermissions:s,disableSuccessToast:d,moveToContext:p,isDefaultPrivateLocation:g,renderType:h,timeToSelectMs:y,flowId:w,isSearchResult:k}=e,{currentSpaceStore:C}=I.default.state;if(!C)return;let M=[];x.default.checkGate("collection_subitem_nested_operations")&&(M=await async function(e,t,n,o){let i=[];const r=u.Ps(e);if(!r)return[];const s=(0,f.fm)(r)??(0,b.Ll)(r,n);if(!s)return[];if(!s.collectionStore())return[];const l=s.currentSubitemFormatStoreForCollection.state,c=s.normalizedSchemaStore.state,d=(null==l?void 0:l.inverse)&&c[l.inverse];if(!d||!(0,a.p_)(d))return[];if(!e.some((e=>(0,b.CJ)({store:e,subitemFormat:l,propertySchema:d}).length>0)))return[];const p=(0,_.uw)(t);if(p instanceof P.NW||p instanceof P.G){if(await le(p)instanceof P.NW)return i=await F.xr({environment:n,blocks:e,options:{canEdit:!0},collectionContextStore:s}),i}return[]}(t,n,i),t=[...t,...M]),oe(i);const A=C.id,R=function(e){const{type:t}=e;switch(t){case"page":case"collection":case"space-private-pages":case"team":return e.spaceId;case"space":return e.id;default:(0,m.t1)(t)}}(n);if(R&&A!==R){if(!(await(0,_.cJ)()))return}const E=t.find((e=>{const t=e.getType();return Boolean(t&&(0,r.S9)(t))})),B=E&&(0,S.VP)(E),O=(0,T.rJ)(t),Z=Object.fromEntries(t.map((e=>[e.id,e.getParentId()]))),V=await re({environment:i,value:n,targets:t,transaction:o,shouldClearPagePermissions:s});if(!V)return;const L=(0,_.HE)(n,i);U.wS({environment:i,previousParentIds:Z,movedItems:t,moveToLocation:L,disableSuccessToast:d,numSubitems:M.length});const j=E&&(0,S.VP)(E);D._T(i,{table:V.table,from:p,type:null==L?void 0:L.type,team_before:B&&(0,v.nB)(B),team_after:j&&(0,v.nB)(j),targets_database_type:O,destination_database_type:V.table===c.vF?V.getDatabaseType():void 0,isDefaultPrivateLocation:g,render_type:h,time_to_select_ms:y,flowId:w,isSearchResult:k,subitemTreeSize:M.length>0?M.length:void 0}),V.table===l.iU&&await U.j2(C,C.id,V.id)}function oe(e){const t=T.ZP.state;T.ZP.setState({isOpen:!1,lastPageId:t.lastPageId}),z.ZH(e),t.isOpen&&"home_tab"===t.moveToContext&&N.d(e)}async function ie(e){return se({...e,action:"add"})}async function re(e){return se({...e,action:"move"})}async function ae(e){return se({...e,action:"retain-alias"})}async function se(e){const{value:t,transaction:n,targets:i,shouldClearPagePermissions:r}=e;if("user_cancelled_move"===await H.Hl({transaction:n,moveStores:i,moveTargetStore:(0,_.uw)(t)}))return;r&&W.O2({blocks:i,transaction:n});const a=x.default.checkGate("collection_subitem_nested_operations");let c;const d=i.at(0);a&&d&&(c=(0,b.g0)(d)||(0,b.kG)(d,e.environment));const u=await async function(e){const{transaction:t,targets:n,value:i,environment:r,action:a}=e,{mainEditorCurrentBlockStore:c,currentSpaceStore:d,currentSpaceViewStore:u}=I.default.state,{id:p}=r.currentUser;if(!p||!u)return;const f=(0,_.uw)(i);if(!f)return;let h;const{table:v}=f;switch(v){case"collection":case"block":h=await async function(e){const{environment:t,blockOrCollectionStore:n,targets:o,transaction:i,retainAliasInCurrentParent:r}=e,a=await le(n);if(!a)throw new Error("Move to store invalid.");if(a instanceof P.G&&x.default.checkGate("enable_text_crdt_client")&&(await a.load(),(0,g.iG)(a,o)))return void q.oV({label:(0,g.s8)(a)});for(const s of o){const e=s.getParentStore();if(e instanceof P.G&&r){const n=R.k({environment:t,parentBlock:e,targetStore:s,transaction:i});j.jG({parentStore:e.getContentStore(),after:s.id,childStore:n,transaction:i})}if(a instanceof P.G)j.jG({parentStore:a,childStore:s,transaction:i});else if(a instanceof P.NW){const e=B.o3({environment:t,stores:[s],spaceId:a.getSpaceId(),transaction:i})[0];B.mp({environment:t,store:e,collectionStore:a,shouldCoerce:!0,groupsPointer:[],transaction:i}),j.zw({parentStore:a,childStore:e,transaction:i})}}return a}({environment:r,blockOrCollectionStore:f,targets:n,transaction:t,retainAliasInCurrentParent:"retain-alias"===a});break;case"space":if("space-private-pages"===i.type&&f.id===(null==d?void 0:d.id))h=ce({environment:r,spaceStore:f,spaceViewStore:u,targets:n,transaction:t,currentUserId:p,retainAliasToBlock:"retain-alias"===a});else{if(!c)return;h=await async function(e){const{environment:t,transaction:n,currentSpaceViewStore:i,currentBlockStore:r,currentUserId:a,spaceStore:c,targets:d,action:u,value:p}=e;if("space"!==p.type&&p.spaceId&&p.spaceId!==c.id)throw new Error("Wrong value to move to another space");G._w({environment:t,blocks:d,transaction:n});const m=r.getSpaceId()||c.id;let f;if("move"===u&&("space"!==p.type&&p.spaceId&&p.spaceId!==m||"space"===p.type&&p.id!==m||"space-private-pages"!==p.type)){V.j({message:Y.duplicatingContent,targetRecordId:c.id});const e=await W.eX({environment:t,blockStores:d,spaceId:c.id,targetParent:ue(p)});if(V.x(),void 0!==e.error)return void O.showErrorMessage(e.error);f=e.value}else"space-private-pages"===p.type&&ce({environment:t,spaceStore:c,spaceViewStore:i,targets:d,transaction:n,currentUserId:a,retainAliasToBlock:"retain-alias"===u});await async function(e){const{environment:t,currentBlockStore:n,currentUserId:i,spaceStore:r,targets:a,crossSpaceTargetBlockId:c}=e,d=Boolean(a.find((e=>e.id===n.id))),u=(0,w.w3)(r.id);if(!d||!u)return;const p=c?P.G.createChildStore(n,{table:l.iU,id:c}):n;await $.l({environment:t,spaceId:r.id,userId:i}),await async function(e){const{environment:t,spaceStore:n,spaceViewStore:o,blockStore:i}=e;n&&o&&(t.device.isMobileNative&&s.log({level:"info",from:"moveToMenuActions",type:"SpaceSwitchingDebug",data:{message:"moveToMenuActions.switchToSpace"}}),I.default.setState({...I.default.state,currentSpaceStore:n,currentSpaceViewStore:o,mainEditorCurrentBlockStore:i}),await Z.Yh(t))}({environment:t,spaceStore:r,spaceViewStore:u,blockStore:p}),L.ru({environment:t,blocks:[p],pageVisitSource:o.tY.Move})}({environment:t,currentBlockStore:r,currentUserId:a,targets:d,spaceStore:c,crossSpaceTargetBlockId:f}),f&&q.oV({label:y.default.formatMessage(Y.duplicatedToSpace,{name:(0,_.EC)({movedItems:d}),spaceName:c.getName()})});return c}({environment:r,transaction:t,currentSpaceViewStore:u,currentBlockStore:c,currentUserId:p,spaceStore:f,targets:n,value:i,action:a})}break;case"team":h=de({environment:r,transaction:t,currentSpaceViewStore:u,teamStore:f,targets:n,value:i,action:a,location:{type:"append"}});break;default:(0,m.t1)(v)}"move"===a&&U.eX({environment:r,transaction:t,moveToStore:f,targetBlocks:n,from:"move_to"});return h}({...e});if(!u)return;if(a&&c&&u instanceof P.NW&&d){let t=(0,b.ko)(u);if(!t){const o=new C.Z(e.environment);if(o.setContext({type:"collectionPage",collectionViewBlockStore:void 0,collectionStore:u}),o){F.Bb({transaction:n,collectionContextStore:o,environment:e.environment})&&(t=(0,b.ko)(u))}}c&&t&&F.cI({blocks:i,transaction:n,from:c.subitemFormat,to:{property:t.property,inverse:t.inverse},environment:e.environment})}return u}async function le(e){let t;return await e.load(),t=e instanceof P.NW?e:e.isLinkedCollectionView()?e.getCollectionViewSourceOrLinkCollectionStores()[0]:e.isCollectionView()?e.getCollectionViewCollectionStore():e,t}function ce(e){let{environment:t,spaceStore:n,spaceViewStore:o,targets:i,currentUserId:r,transaction:a,retainAliasToBlock:s}=e;for(const l of i){const e=l.getParentStore();if(K.applyOperation({store:l,operation:{command:"moveToPrivate",path:[],pointer:l.getSpaceShardedPointer(),args:{spaceViewPointer:o.getSpaceShardedPointer(),userId:r,removeFromParent:null==e?void 0:e.pointer}},transaction:a}),e instanceof P.G&&s){const n=R.k({environment:t,parentBlock:e,targetStore:l,transaction:a});j.jG({parentStore:e.getContentStore(),after:l.id,childStore:n,transaction:a})}}return n}function de(e){let{transaction:t,currentSpaceViewStore:n,teamStore:o,targets:i,location:r,environment:a}=e;const s=n.getTeamsStores(),l=o.getTeamPagesStore();G._w({environment:a,blocks:i,transaction:t});for(const c of i){const e=u.sE(s,(e=>{const t=e.getTeamPagesStore().getValue();if(t)return t.includes(c.id)}));(null==e?void 0:e.id)!==o.id&&("append"===r.type?j.jG({parentStore:l,childStore:c,after:r.after,transaction:t}):"prepend"===r.type?j.SH({parentStore:l,childStore:c,before:r.before,transaction:t}):(0,m.t1)(r),e&&H.sp({teamStore:e,store:c,transaction:t}))}return o}function ue(e){const{type:t}=e;switch(t){case"space":case"space-private-pages":return;case"page":return e.spaceId?{id:e.id,table:"block",spaceId:e.spaceId}:void 0;case"collection":case"team":return e.spaceId?{id:e.id,table:t,spaceId:e.spaceId}:void 0;default:(0,m.t1)(t)}}},17659:(e,t,n)=>{n.d(t,{$h:()=>F,E1:()=>B,G7:()=>V,Jl:()=>A,Qy:()=>Z,aY:()=>O,aZ:()=>E,go:()=>M,qQ:()=>U,rG:()=>R,w1:()=>L});var o=n(68626),i=n(65311),r=n(9291),a=n(52629),s=n(1898),l=n(95477),c=n(33929),d=n(41549),u=n(50770),p=n(75419),m=n(74948),f=n(24646),g=n(19034),h=n(38676),v=n(80444),b=n(88923),y=n(6258),_=n(4761),S=n(83249),w=n(19719),k=n(54642),I=n(47307),C=n(87420),x=n(13447);const T=(0,r.defineMessages)({archiveError:{id:"notificationActions.archiveNotification.errorMessage",defaultMessage:"Failed to archive. Please try again."},setReadError:{id:"notificationActions.setRead.errorMessage",defaultMessage:"Failed to mark notification as read. Please try again."},setAllAsReadError:{id:"notificationActions.setAllAsRead.errorMessage",defaultMessage:"Failed to mark all notifications as read. Please try again."},setUnreadError:{id:"notificationActions.setUnread.errorMessage",defaultMessage:"Failed to mark notification as unread. Please try again."}});async function M(e){const t=_.ZP.state.currentTab,{currentSpaceStore:n}=v.default.state;if(n&&!l.default.isAdminMode&&(0,_.g0)(t)){try{await k.setNotificationsAsRead(e,{spaceId:n.id,timestamp:Date.now(),type:t})}catch(i){return I.showErrorMessage(c.default.formatMessage(T.setAllAsReadError)),void o.log({level:"error",from:"notificationActions",type:"setCurrentUpdatesTabAsRead",error:(0,a.Ui)(i)})}A(t,n.id,P.decrementToZero)}}const P={incrementByOne:e=>e+1,decrementByOne:e=>Math.max(e-1,0),decrementToZero:e=>0};function A(e,t,n){const{results:o}=g.Z.state,i=o.map((o=>{if(o.spaceId===t){const t=o.unread[e];return void 0===t?o:{...o,unread:{...o.unread,[e]:n(t)}}}return o}));g.Z.setState({results:i})}async function R(e,t,n){const{currentSpaceStore:i}=v.default.state;if(i&&!l.default.isAdminMode){try{for(;;){if(!(await D({environment:e,currentSpaceStore:i,inbox:t,readFilter:n})).more)break}}catch(r){return I.showErrorMessage(c.default.formatMessage(T.archiveError)),void o.log({level:"error",from:"notificationActions",type:"archiveAll",error:(0,a.Ui)(r)})}"read"!==n&&A(t,i.id,P.decrementToZero)}}async function D(e){const{environment:t,currentSpaceStore:n,inbox:i,readFilter:r}=e,s=await k.getUnvisitedNotificationIds(t,{spaceId:n.id,timestamp:Date.now(),type:i,size:500,readFilter:r});if("failed"===s.type)return I.showErrorMessage(c.default.formatMessage(T.archiveError)),o.log({level:"error",from:"notificationActions",type:"archiveApiError",error:(0,a.Ui)(s.error)}),{more:!1};const{notificationIds:l}=s.data;return await async function(e){const{environment:t,notificationIds:n,rootStore:o}=e,{serverCommitResult:i}=x.createAndCommit({userAction:"notificationActions.archiveNotificationIds",environment:t,canUndo:!0,undoCheckpoint:!0,perform:e=>{for(const t of n)B({transaction:e,rootStore:o,visited:!0,notificationId:t})}});await i}({environment:t,notificationIds:l,rootStore:n}),l.length>=500?{more:!0}:{more:!1}}function E(e){const{notification:t,rootStore:n,transaction:r}=e;if(!t.visited){try{B({notificationId:t.id,rootStore:n,transaction:r,visited:!0})}catch(s){return I.showErrorMessage(c.default.formatMessage(T.archiveError)),void o.log({level:"error",from:"notificationActions",type:"archiveNotification",error:(0,a.Ui)(s)})}if(!t.read){A(i.hE[t.type],t.space_id,P.decrementByOne)}}}function B(e){const{transaction:t,notificationId:n,rootStore:o,visited:r}=e,a=(0,y.Kv)(o,{table:i.uX,id:n});x.applyOperation({transaction:t,store:a,operation:{command:"update",pointer:{table:i.uX,id:n},path:[],args:r?{visited:!0,read:!0,archived_at:Date.now()}:{visited:!1,archived_at:null}}})}function F(e){const{transaction:t,notification:n,rootStore:r,read:s}=e;if(n.read===s)return;const l=(0,y.Kv)(r,{table:i.uX,id:n.id});try{x.applyOperation({transaction:t,store:l,operation:{command:"update",pointer:{table:i.uX,id:n.id},path:[],args:{read:s}}})}catch(d){return e.suppressErrorMessage||I.showErrorMessage(c.default.formatMessage(s?T.setReadError:T.setUnreadError)),void o.log({level:"error",from:"notificationActions",type:"setRead",error:(0,a.Ui)(d)})}A("mentions",n.space_id,s?P.decrementByOne:P.incrementByOne)}function O(){return g.Z.getUnreadCountForCurrentSpace().mentions}async function Z(e){const{environment:t}=e,{currentSpaceStore:n}=v.default.state;if(!n)return[];const o=await k.getUnvisitedNotificationIds(t,{spaceId:n.id,timestamp:Date.now(),type:"mentions",size:100,readFilter:"unread"});return"failed"===o.type?[]:o.data.notificationIds}function V(e){let{environment:t,newTab:n,shouldTrack:o}=e;const i=_.ZP.state.currentTab;if(i!==n&&("mentions"===n?_.ZP.update((e=>({...e,currentTab:n,containsBothReadAndUnreadNotifications:!1,containsUnreadNotifications:!1,showOnlyUnreadNotifications:!1,unreadNotificationIds:[]}))):_.ZP.update((e=>({...e,currentTab:n})))),o){const e=t.device.isMobile;w.GP({environment:t,forceRestartSession:!1,from:"updates-tab-click"}),e&&S.nB(t,{itemName:"updates"})}"mentions"===i&&async function(e){const t=(0,u.tO)(e),n=await k.getUserNotifications(e,{size:1e3,isInboxV2:t});if("failed"===n.type)return;const{results:o}=n.data;g.Z.setState({results:o})}(t)}function U(e){const{environment:t,open:n}=e;if(n){const e=h.sidebarExpandedStore.state;h.sidebarOpenStore.state&&!e&&m.close(),(0,f.Sx)(t)&&m.setUpdateExpand({environment:t,isExpanded:!1,from:"close_for_space"}),b.default.isSidePeekOpen()&&C.xv(t,"inbox_panel_expand"),m.closeAssistantChatHistory({wasChatHistoryClosedAutomatically:!0}),p.DD("inbox","overlay_and_pinning"===(0,u.me)(t)?"peek":"panel"),w.l2({environment:t})}else p.TN(),w.Br({environment:t})}function L(e){const t=d.T6();switch(t){case"open":case"opening":U({environment:e,open:!1});break;case"closed":case"closing":U({environment:e,open:!0});break;default:(0,s.t1)(t)}}},36110:(e,t,n)=>{n.d(t,{V:()=>v,g:()=>h});var o=n(77657),i=n(74181),r=n(56589),a=n(82036),s=n(89101),l=n(9852),c=n(18265),d=n(19584),u=n(86615),p=n(54642),m=n(47307),f=n(12714),g=n(8055);function h(e){const{environment:t,responseType:n,integrationId:o,redirectUri:i,state:r,owner:a,userId:l,spaceId:u}=e,p=c.bf({url:s._j.oauthAuthorization,query:(0,d.m8)(Object.entries({response_type:n,client_id:o,redirect_uri:i,state:r,owner:a,user_id:l,space_id:u}).filter((e=>{let[,t]=e;return t})))});g.c4({environment:t,url:p,redirect:!0})}async function v(e){const{environment:t,params:n,integration:d}=e;l.In(void 0);const h=d&&r._(d,n.redirectUri);if(!h)return void g.c4({environment:t,url:s._j.root,redirect:!0});let b;if("errorType"in e)b={error:e.errorType,state:n.state};else{const{integration:o,spaceId:r,blockIdsForBot:s,acceptedIntegrationCapabilities:l}=e;let c;if(c=(0,i.VM)(o)?await p.createOauthAuthorizationCode(t,{integrationId:o.id,spaceId:r,redirectUri:n.redirectUri,acceptedIntegrationCapabilities:l}):await p.createOauthAuthorizationCode(t,{integrationId:o.id,spaceId:r,redirectUri:n.redirectUri,blockIdsForBot:s,templatePageId:e.templatePageId,acceptedIntegrationCapabilities:l}),"failed"===c.type){m.showError(c);return v({environment:t,params:n,integration:o,errorType:503===c.status?a._.temporarily_unavailable:a._.server_error})}b={code:c.data.code,state:n.state}}d.id===o.Dv&&await u.dl(t);const y=c.bf({url:h,query:{...b}});f.D({environment:t,url:y,targetSelf:!0})}},15356:(e,t,n)=>{n.d(t,{M:()=>m});var o=n(89101),i=n(9291),r=n(37850),a=n(18265),s=n(95477),l=n(33929),c=n(77080),d=n(47307),u=n(47839);const p=(0,i.defineMessages)({allowPopup:{id:"authAction.authorize.popupBlocked",defaultMessage:"It looks like your browser is currently blocking popups. Please allow pop-ups to continue"},dismissButtonLabel:{defaultMessage:"Okay",id:"dialog.dismissButton.label"}});async function m(e,t){const{width:n,height:i,url:m,titleMessage:g}=t,h=l.default.formatMessage(g);if(e.device.isElectron)return u.openOauthPopup({width:n,height:i,url:m,title:h});const v=e.device.isMobile,b=void 0!==window.screenX?window.screenX:window.screenLeft,y=void 0!==window.screenY?window.screenY:window.screenTop,_=void 0!==window.outerWidth?window.outerWidth:document.documentElement.clientWidth,S=void 0!==window.outerHeight?window.outerHeight:document.documentElement.clientHeight-22,w=v?0:n,k=v?0:i;let I="toolbar=0,menubar=0,location=0";0!==w&&(I+=`,width=${w}`),0!==k&&(I+=`,height=${k}`),I+=`,left=${(b<0?window.screen.width+b:b)+(_-w)/2}`,I+=`,top=${y+(S-k)/2.5}`,I+=",scrollbars=1";const C=f()?(0,a.bf)({url:`${s.default.domainBaseUrl}${o._j.verifyNoPopupBlockerHtmlAndRedirect}`,query:{redirectUri:m}}):m,x=window.open(C,h,I);if(x)x.focus();else if(f())return void d.showDialog({showCancel:!1,keepFocus:!1,message:l.default.formatMessage(p.allowPopup),items:[{label:l.default.formatMessage(p.dismissButtonLabel),onAccept:()=>{}}]});const T=r.UZ();if(C.includes("evernotepopupredirect")&&c.default.checkGate("is_evernote_authpopup_closing_fix_enabled")){const e=e=>{if(e&&e.data&&"popup-callback"===e.data.type){const t=e.data.url;T.resolve(t)}const t=localStorage.getItem("externalAuthCallback");t&&T.resolve(t)};window.addEventListener("message",e,!1);const t=await T.promise;return window.removeEventListener("message",e,!1),localStorage.removeItem("externalAuthCallback"),x&&x.close(),window.focus(),t}{const e=e=>{if(e&&e.data&&"popup-callback"===e.data.type){const t=e.data.url;T.resolve(t)}},t=setInterval((()=>{const e=localStorage.getItem("externalAuthCallback");e?T.resolve(e):x&&x.closed&&T.resolve(void 0)}),300);window.addEventListener("message",e,!1);const n=await T.promise;return window.removeEventListener("message",e,!1),localStorage.removeItem("externalAuthCallback"),clearInterval(t),x&&x.close(),window.focus(),n}}function f(){return"on"===c.default.getEligibleGroup({experimentId:"show_instruction_on_auth_popup_blocked",defaultGroup:"control"})}},89858:(e,t,n)=>{n.d(t,{A5:()=>ie,D0:()=>Q,Eo:()=>oe,LR:()=>ne,NP:()=>te,kC:()=>Y,mv:()=>J,pq:()=>X,v9:()=>ee});n(21703),n(57658),n(67294);var o=n(15145),i=n(41432),r=n(15157),a=n(72141),s=n(29369),l=n(9291),c=n(53965),d=n(83105),u=n(75754),p=n(91851),m=n(27105),f=n(75770),g=n(35026),h=n(48779),v=n(95697),b=n(81844),y=n(74948),_=n(24646),S=n(77999),w=n(80444),k=n(55367),I=n(42330),C=n(6258),x=n(81023),T=n(88893),M=n(88280),P=n(73292),A=n(952),R=n(66324),D=n(98834),E=n(47307),B=n(94419),F=n(13084),O=n(60870),Z=n(11302),V=n(19785),U=n(76464),L=n(9953),j=n(26999),N=n(64964),z=n(29974),q=n(28014),W=n(150),H=n(13447),K=n(68422),G=n(1742),$=n(85893);function Q(e){var t,n;const{environment:r,store:a,transaction:s,navigateToParent:l,event:c}=e,p=a.isCollectionView()?(0,m.SL)({event:c,source:"collection_unknown_view",contextualDefault:null===(t=a.getCollectionViewCollectionStore())||void 0===t||null===(t=t.getDefaultTemplatePageStore())||void 0===t?void 0:t.useCrdt()}):a.useCrdt(),f=L.j4({environment:r,type:i.Ti.page,inMemoryRecordCache:a.inMemoryRecordCache,transaction:s,spaceId:a.isCollectionView()?null===(n=a.getCollectionViewCollectionStore())||void 0===n?void 0:n.pointer.spaceId:a.pointer.spaceId,useCrdt:p}),g=a.getAssociatedCollectionStore();if(a.isCollectionView()){const e=a.getCollectionViewCollectionStore()||g;if(!e)throw new Error("getCollectionViewCollectionStore() returned undefined");if(!V.zw({parentStore:e,childStore:f,transaction:s}))throw new Error("parentChildActions.moveToCollection() returned false");const t=e.getDefaultTemplatePageStore();t&&D.ob({title:"template",environment:r,store:f,templateStore:t,isKeyboard:!1,isCreateIn:!1,transaction:s,from:"outliner_actions"})}a.isCollectionView()||V.jG({parentStore:a.getContentStore(),childStore:f,transaction:s}),I.ZP.setState({...I.ZP.state,lastPageId:w.default.state.mainEditorCurrentBlockStore?w.default.state.mainEditorCurrentBlockStore.id:void 0}),r.device.isMobile?u._c({environment:r,store:f,showMoveTo:!1,saveParent:!1,visitType:d.vu.Link,pageVisitSource:o.tY.Create}):j.CH({environment:r,store:f,showMoveTo:!0,saveParent:!1,currentBlockStore:l?a:void 0,peekMode:void 0,resultsStore:void 0,collectionContextStore:void 0,pageVisitSource:o.tY.Create}),A.W(r,{from:"sidebar_outliner_item",type:"page",new_page_id:f.id,creating_block_id:f.id,parent_collection_id:f.getParentCollectionIdUpToTwoLevels()})}async function Y(e){const{environment:t,spaceStore:n,spaceViewStore:i,type:r,prepend:a,outlinerToggleButtonStore:s,shouldPersistToggleState:c,title:p,useCrdt:m}=e,f=new G.sA(t,"createPageInSection");if(x.M_(t)){if("workspace"===r){const e=M.subscriptionDataStoreInstance.state,t=e?(0,T.su)(e):1;if(t>=10){if(!(await E.confirmUserAction({message:(0,$.jsx)("span",{children:(0,$.jsx)(l.FormattedMessage,{defaultMessage:"Are you sure you want to create a new top-level page? <strongtext>This page will be visible in the sidebar to all {memberCount} members of your workspace.</strongtext>",id:"sidebarActions.confirmDialog.newWorkspacePage.message",values:{strongtext:e=>(0,$.jsx)("strong",{children:e}),memberCount:t}})}),acceptLabel:(0,$.jsx)(l.FormattedMessage,{defaultMessage:"Create top-level page",id:"sidebarActions.confirmDialog.newWorkspacePage.confirmButton.label"})})))return null}}const{serverCommitResult:e,performResult:{createdPage:g}}=H.createAndCommit({userAction:"outlinerActions.createPageInSection",environment:t,perform:e=>{const o=q.KE({environment:t,spaceStore:n,spaceViewStore:i,isPrivate:"private"===r,prepend:a,transaction:e,title:p,tracker:f,useCrdt:m});return s&&oe({environment:t,spaceViewStore:i,type:r,outlinerToggleButtonStore:s,newIsHidden:!1,shouldPersistToggleState:Boolean(c)}),t.device.isMobile&&y.close(),{createdPage:o}}});"private"===r?A.W(t,{from:"sidebar_private_section",type:"page",new_page_id:g.id,creating_block_id:g.id}):"workspace"===r&&A.W(t,{from:"sidebar_workspace_section",type:"page",new_page_id:g.id,creating_block_id:g.id});const h=n.getDisableSpacePageEdits();return"workspace"===r&&h&&await e,u._c({environment:t,store:g,visitType:d.vu.Link,pageVisitSource:o.tY.Create}),g}}async function J(e){const{environment:t,spaceStore:n,spaceViewStore:i,teamStore:r,andNavigate:a,from:s,outlinerToggleButtonStore:l,shouldPersistToggleState:c,title:p,loading:m,appendOrPrepend:f,event:g}=e,{serverCommitResult:h,performResult:{createdPage:v}}=H.createAndCommit({userAction:"outlinerActions.createPageInTeam",environment:t,perform:e=>({createdPage:X({environment:t,spaceStore:n,spaceViewStore:i,teamStore:r,from:s,title:p,event:g,loading:m,appendOrPrepend:f,transaction:e})})});return await h,a&&u._c({environment:t,store:v,visitType:d.vu.Link,pageVisitSource:o.tY.Create}),l&&P.k7({environment:t,spaceViewStore:i,teamStore:r,outlinerToggleButtonStore:l,newIsHidden:!1,shouldPersistToggleState:Boolean(c),isExplicitUserAction:!1}),v}function X(e){const{environment:t,spaceStore:n,spaceViewStore:o,teamStore:i,from:r,title:a,event:l,loading:c,appendOrPrepend:d,transaction:u}=e;if(!(0,g.si)({teamStore:i,environment:t}))throw new Error("User is not eligible to create top-level page in team");const p=q.KE({environment:t,spaceStore:n,spaceViewStore:o,isPrivate:!1,prepend:!1,title:a,loading:c,transaction:u,useCrdt:(0,m.Sy)({event:l,source:"team"})});A.t(t,{teamStore:i,from:r,pageId:p.id,transaction:u}),U.u9({store:p,transaction:u});const h=(0,f.uw)({type:"team",id:i.id});if(h.table!==s.e0)throw new Error("Assertion failure, moveToStore table is not TeamTable!");return Z.at({environment:t,transaction:u,action:"add",teamStore:h,currentSpaceViewStore:o,targets:[p],value:{type:"team",id:i.id},location:{type:d}}),p}async function ee(e){var t,n;const{environment:o,droppedStores:r,droppedDirection:s,type:c,targetStore:d,targetParentStore:u}=e,g=await(0,f.ed)({environment:e.environment,blocks:r,from:"dragAndDrop",dropArgs:{direction:s,destination:d,destinationOutlinerType:c}});if(!g.confirmed)return;const{shouldClearPagePermissions:v}=g;if(1===r.length&&(null===(t=u.getValue())||void 0===t||null===(n=t.includes)||void 0===n||!n.call(t,r[0].id))){let e=[];for(const n of r)if(e=await p.NN({environment:o,block:n,action:"move"}),"user_canceled"===e)return;const t=r[0].id;for(const n of e)n.id!==t&&r.push(n)}const y=Object.fromEntries(r.map((e=>[e.id,e.getParentId()]))),{performResult:{moved:_}}=await H.createAndCommitAsync({environment:o,userAction:"outlinerActions.confirmAndHandleDrop",waitForServerCommit:!0,perform:async t=>{const n=await async function(e){const{environment:t,type:n,droppedDirection:o,targetStore:r,targetParentStore:s,droppedStores:c,transaction:d,isTopLevelItem:u,shouldClearPagePermissions:p}=e,g=function(e){for(const t of e){const e=b.Z.findOutlinerItemFromStore(t);if(e)return e.type}}(c),{currentSpaceStore:v,currentUserStore:y}=w.default.state,_=null==v?void 0:v.id,S=M.subscriptionDataStoreInstance.state,I="bookmarks"===g&&"bookmarks"===n,x=re(e),P=_&&c.some((e=>e.isTopLevelWorkspacePage(_))),A=r&&_&&r.isTopLevelWorkspacePage(_),R=null==v?void 0:v.getDisableSpacePageEdits();if(_&&R&&(P||A)&&!I&&o!==k.vh.Onto&&null!=y&&y.isDefined()&&S){const e=(0,T.hn)(S).filter((e=>e.userId===y.id))[0];if(e&&!a.zz(e.role))return E.showErrorMessage((0,$.jsx)(l.FormattedMessage,{defaultMessage:"This workspace has locked top-level workspace page operations.",id:"sidebarActions.confirmDialog.lockedWorkspaceTopLevel.message"})),!1}const D=function(e){let{targetStore:t,targetParentStore:n}=e;if(t)return t;const{id:o,table:i}=n;let r;switch(i){case"space":case"space_view":r={type:"space",id:o};break;case"block":r={type:"page",id:o};break;case"team":r={type:"team",id:o};break;default:throw new Error("Unexpected table type")}return(0,f.uw)(r)}({targetStore:r,targetParentStore:s});if(function(e){const{droppedDirection:t,targetStore:n,droppedStores:o,targetParentStore:i}=e,r=t===k.vh.Onto?n:i.getRecordStoreAtRootPath();if(!(r instanceof C.G))return!1;const a=(0,m.iG)(r,o);a&&N.oV({label:(0,m.s8)(r)});return a}(e))return!1;if(!I&&!x){if("user_cancelled_move"===await W.Hl({transaction:d,moveStores:c,moveTargetStore:D}))return!1}O.eX({environment:t,transaction:d,moveToStore:D,targetBlocks:c,from:"drag_and_drop"});const B=function(e){const{environment:t,type:n,targetStore:o,targetParentStore:r,droppedDirection:a,droppedStores:s,duplicate:l,transaction:c}=e,{currentSpaceViewStore:d,currentSpaceStore:u,currentUserSettingsStore:p}=w.default.state;let m;const f=null==o?void 0:o.getModel();if(a===k.vh.Onto&&o&&r&&null!=f&&f.isType(i.m3))m=F.LQ({environment:t,targetParentStore:r,targetStore:o,droppedDirection:k.vh.Below,droppedStores:s,duplicate:l,transaction:c});else if(re(e)&&o){if(!d||!p)throw new Error("currentSpaceViewStore or currentUserSettingsStore not found");const{visiblePagesStores:e}=(0,h._o)({environment:t,spaceViewStore:d,userSettingsStore:p,type:"shared"}).state,n=e.map((e=>e.id)),i=s.map((e=>e.id)),r=n.filter((e=>i.indexOf(e)<0)),l=r.findIndex((e=>e===o.id));let u=[];u=a===k.vh.Above?[...r.slice(0,l),...i,...r.slice(l)]:[...r.slice(0,l+1),...i,...r.slice(l+1)],L.sW({store:d,data:{shared_pages:u},transaction:c}),m=s}else"private"===n&&u&&d&&q.OQ({environment:t,spaceStore:u,spaceViewStore:d,transaction:c}),m=F.LQ({environment:t,targetParentStore:r,targetStore:o,droppedDirection:a,droppedStores:s,duplicate:l,transaction:c});return m}(e),Z=B.filter((e=>e.isTopLevel()));p&&z.O2({blocks:B,transaction:d});"workspace"===n?z.lF({environment:t,blocks:Z,transaction:d}):"private"===n&&z.IY({environment:t,blocks:Z,transaction:d});const V=u&&o!==k.vh.Onto;V&&K._w({environment:t,blocks:c,transaction:d});return!0}({...e,transaction:t,shouldClearPagePermissions:v});return{moved:n}}});_&&O.wS({environment:o,movedItems:r,previousParentIds:y,moveToLocation:(0,f.vz)({targetStore:d,droppedDirection:s,outlinerSectionType:c,environment:o})})}async function te(e){const{droppedStores:t,duplicate:n}=e.dropArgs,{environment:o,type:i,isTopLevel:r,parentStore:a}=e,s=k.vh.Below;return!!a&&(await ee({environment:o,type:i,targetParentStore:a,isTopLevelItem:r,droppedDirection:s,droppedStores:t,duplicate:n}),!0)}function ne(e){const{environment:t,store:n,parentStore:o,insertStores:i,transaction:r,before:a,type:s}=e,{currentSpaceViewStore:l,currentSpaceStore:d}=w.default.state,u=c.d9(i).reverse();"private"===s&&d&&l&&q.OQ({environment:t,spaceStore:d,spaceViewStore:l,transaction:r});const p=a?i.map((e=>B.Vt({parent:o,insert:e,before:n,transaction:r}).child)):u.map((e=>B.BE({parent:o,insert:e,after:n,transaction:r}).child)),m=p.filter((e=>e.isTopLevel()));return"workspace"===s?z.lF({environment:t,blocks:m,transaction:r}):"private"===s&&z.IY({environment:t,blocks:m,transaction:r}),p}function oe(e){const{environment:t,spaceViewStore:n,type:o,outlinerToggleButtonStore:i,newIsHidden:a,shouldPersistToggleState:s}=e;i.setState({...i.state,isHidden:a}),R.VS(t,{is_toggled:!a,outliner_type:o}),s&&r.Z.set({userId:n.environment.currentUser.id,key:(0,_.Fl)(n,o),value:a}),"inactive"!==S.default.state.type&&a&&S.default.setState({type:"inactive"})}function ie(e){const{type:t,targetStore:n,targetParentStore:o,transaction:i,isTopLevelItem:r}=e,a=(0,v.bq)()&&"team"===t&&o.table===s.e0&&r;if(B.Od({childToRemove:n,parent:o,transaction:i}),a&&n.getParentId()===o.id){const t=C.zX.createChildStore(e.targetParentStore,{...e.targetParentStore.pointer,table:s.e0});W.sp({teamStore:t,store:n,transaction:i})}}function re(e){let{type:t,droppedDirection:n,isTopLevelItem:o}=e;return"shared"===t&&n!==k.vh.Onto&&o}},65889:(e,t,n)=>{function o(e){const{key:t,overlayContainerStore:n}=e;n.state.overlays.has(t)||(n.state.overlays.add(t),n.emit())}function i(e){const{key:t,overlayContainerStore:n}=e;n.state.overlays.has(t)&&(n.state.overlays.delete(t),n.emit())}n.d(t,{I:()=>o,O:()=>i})},72711:(e,t,n)=>{n.d(t,{Y_:()=>P,bo:()=>R,hc:()=>M,og:()=>E,ru:()=>A,tk:()=>D});n(21703);var o=n(1302),i=n(41432),r=n(21202),a=n(6287),s=n(53965),l=n(7032),c=n(75754),d=n(10906),u=n(84210),p=n(12534),m=n(39500),f=n(89014),g=n(58202),h=n(80444),v=n(94896),b=n(6258),y=n(26664),_=n(17963),S=n(52229),w=n(96802),k=n(94419),I=n(9953),C=n(8055),x=n(29373),T=n(13447);function M(e){const{environment:t,store:n,targetStore:o,transaction:i}=e,r=n.getParentBlockStore();if(r){const e=r.getContentStore(),a=S.k({environment:t,parentBlock:r,targetStore:o,transaction:i});return k.rS({parent:e,oldChild:n,newChild:a,transaction:i}).child}throw new Error("Could not create alias block.")}function P(e){const{environment:t,store:n,collectionStore:s,collectionViewStore:c,transaction:u}=e,{id:p}=t.currentUser,m=n.getRecordStoreUIParent();if(null!=m&&m.valueIs(y.i)){if(!n.isDefined())throw new Error("Block to replace was not defined.");if(m&&p){var h,v;const e=(0,l.ZP)(),p=null===(h=(0,d.Vv)(s))||void 0===h?void 0:h.getFormatStore().getKeyStore("table_properties").getValue(),y=null===(v=(0,d.Vv)(s))||void 0===v||null===(v=v.getQueryStore())||void 0===v?void 0:v.getKeyStore("sort").getValue(),_={id:(0,l.ZP)(),version:0,type:"table",parent_id:e,parent_table:"block",alive:!0,space_id:n.getSpaceId(),format:{table_properties:p,collection_pointer:{table:a.vF,id:s.id,spaceId:s.pointer.spaceId}},query2:{sort:y}};I.ae({environment:t,table:"collection_view",value:_,inMemoryRecordCache:n.inMemoryRecordCache,transaction:u});const S=I.j4({environment:t,id:e,type:i.Ti.collectionView,spaceId:n.getSpaceId(),useCrdt:n.useCrdt(),inMemoryRecordCache:n.inMemoryRecordCache,transaction:u});I.sW({store:S,data:{view_ids:[_.id]},transaction:u});const w=k.rS({parent:m,oldChild:n,newChild:b.G.createChildStore(m,{table:r.iU,id:e}),transaction:u}).child;return(0,f.u)(_.id,{viewPointer:null==c?void 0:c.pointer}),o.default.afterNextFlush((()=>{const e=g.R.findBlockFromStoreWithMethod(w,"handleCreated");e&&e.handleCreated()})),w}}}function A(e){const{environment:t,blocks:n,openInNew:o,pageVisitSource:i}=e,r=n[0];if(o){const e=(0,u.ZP)({store:r,pageVisitSource:i});C.c4({environment:t,url:e,openInNew:o})}else{const e=r.recordStoreUIParentStore instanceof b.G&&r.recordStoreUIParentStore.isCollectionView(),{mainEditorCurrentBlockStore:n}=h.default.state;if(e&&n){const e=(0,u.ZP)({store:n,fullyQualified:!1,peekViewBlockId:r.id,pageVisitSource:i});C.c4({environment:t,url:e})}else c._c({environment:t,store:r,pageVisitSource:i})}}function R(e){const{environment:t,store:n,lock:o}=e,{id:i}=t.currentUser;if(!i)return;const r={block_locked:o,block_locked_by:i};T.createAndCommit({userAction:"pageBlockActions.setPageLock",environment:t,perform:e=>{I.sW({store:n.getFormatStore(),data:r,transaction:e})}})}function D(e){const{transaction:t,store:n,coverStore:o,pageCovers:i}=e,r=Object.keys(i),a=i[r[s.MX(0,r.length-1)]],l=a.items[s.MX(0,a.items.length-1)],c=l.coverUrl,d=l.position;I.sO({store:o,value:c,transaction:t}),w.Mp({store:n,coverPosition:d,transaction:t})}function E(e,t,n){(0,p.ZP)({event:e,context:p.Af.EditorClick,callback:()=>function(e,t){const n=Boolean(_.Z.state.pageMap[e.id])||v.Z.state.pages.has(e.id);!e.canEdit()||e.isNonEditableState()||n||(0,m.X9)()||T.createAndCommit({userAction:"PageViewBlock.handlePlaceholderClick",environment:t,perform:n=>{x.ls({environment:t,store:e,transaction:n})}})}(t,n)})}},73661:(e,t,n)=>{n.d(t,{P:()=>a});var o=n(55320),i=n(32441),r=n(54642);function a(e,t,n){i.Pu(t,{page_id:e.id,searchSessionId:o.default.state.sessionId,spaceId:e.getSpaceId(),pageVisitId:n.getCurrentPageVisitId()}),r.recordPageExit(t,{block:{id:e.id,spaceId:e.getSpaceId()},timestamp:Date.now()})}},25320:(e,t,n)=>{n.d(t,{Ri:()=>y,UX:()=>b,s4:()=>v});var o=n(50475),i=n(21202),r=n(70017),a=n(89470),s=n(23867),l=n(53965),c=n(1898),d=n(46654),u=n(65598),p=n(80444),m=n(53730),f=n(6258),g=n(54642);const h=32,v=100;async function b(e,t){await p.default.waitUntilRendered();const{fromPageRefresh:n,block:l,pageVisitStore:c,timestamp:h}=t,v=e.currentUser.id;if(void 0===v||n)return;t.block.id!==c.state.pageId&&c.setState({...c.getInitialState(),pageId:t.block.id});const b=(0,f.Kv)(l,{table:a.UI,id:(0,a.Pv)({parent_id:l.id,user_id:v}),spaceId:(0,s.C)(l.pointer.spaceId)}),y=(0,f.Kv)(l,{table:r.Kk,id:(0,a.Pv)({parent_id:l.id,user_id:v}),spaceId:(0,s.C)(l.pointer.spaceId)});if(await m.transactionQueue.awaitRecordTransaction({table:i.iU,id:l.id}),await(0,u.M1)(l),!l.canRead()||(0,d.IJ)(e,l))return;await b.load(),await y.load();const S=b.getKeyStore("visited_at").getValue(),w=y.getKeyStore("exited_at").getValue(),k=await async function(e,t,n,i){const{id:r}=e.currentUser,a=t.id,s=t.getSystemBlockTypeStore().getValue();if((0,o.EW)(s))return{type:"skipped"};var l;r&&(null==e||null===(l=e.mobileNative)||void 0===l||l.recordPageVisit(r,{blockId:a,spaceId:n,visitedAt:i}));const c=await g.recordPageVisit(e,{block:{id:a,spaceId:n},timestamp:i});return c}(e,l,(0,s.C)(l.pointer.spaceId),h);if("skipped"===k.type)return;if("failed"===k.type)return;const I=_({pageVisits:k.data.pageVisits,omittedUserIds:[],currentState:c.state,block:l});c.state.pageId===l.id&&c.setState({...I,lastViewTime:S,lastExitTime:w})}async function y(e,t){await p.default.waitUntilRendered();const n=e.currentUser.id;if(void 0===n)return;const{block:o,pageVisitStore:i,incremental:r}=t,a=t.limit||h;let d;if(r){const{pageId:e,lastViewTime:t,lastExitTime:o,omittedUserIds:r,...a}=i.state,s=Object.entries(a).map((e=>{let[t,o]=e;if(n===t)return;const i=o.getVisitedAt();return void 0!==i?i+1:void 0}));d=l.Fp(s.filter(c.$K))}const u=await g.getPageVisitors(e,{block:{id:o.id,spaceId:(0,s.C)(o.pointer.spaceId)},sinceTimestamp:d,limit:a});if("failed"===u.type)return;const m=_({pageVisits:u.data.pageVisits,omittedUserIds:u.data.omittedUserIds,block:o,currentState:i.state});let f;if(Object.keys(m).length<=v)f=m;else{const{pageId:e,lastViewTime:t,lastExitTime:n,omittedUserIds:o,...i}=m,r=(0,c.qP)(i).map((e=>{let[t,n]=e;return[t,n.getVisitedAt()??0]}));f={pageId:e,omittedUserIds:o,lastViewTime:void 0,lastExitTime:void 0};const a=l.MR(r,(e=>{let[,t]=e;return-t})).slice(0,v);for(const[s]of a)f[s]=m[s]}i.state.pageId===m.pageId&&i.setState(f)}function _(e){const{block:t,pageVisits:n,currentState:o,omittedUserIds:i}=e,r={...o,pageId:t.id,omittedUserIds:[...o.omittedUserIds,...i]};for(const l of n){const{id:e,user_id:n}=l;n in r||(r[n]=f.t1.createChildStore(t,{table:a.UI,id:e,spaceId:(0,s.C)(t.pointer.spaceId)}))}return r}},19785:(e,t,n)=>{n.d(t,{SH:()=>m,hh:()=>c,hr:()=>u,jG:()=>p,nO:()=>d,rS:()=>f,zo:()=>l,zw:()=>s});n(21703);var o=n(45681),i=n(65598),r=n(9953),a=n(13447);function s(e){const{childStore:t,parentStore:n,transaction:o}=e,i=t.getRecordStoreAtRootPath(),r=i.getValue(),s=i.getAssociatedCollectionId();if(r){const{alive:e}=r;if(s!==n.id||!e){const e=n.getParentBlockStore();return e&&e.isCollectionViewPageWithContent()?(p({parentStore:e,childStore:t,transaction:o}),!0):(a.applyOperation({store:n,operation:{pointer:t.pointer,path:[],command:"setParent",args:{parentId:n.id,parentTable:n.table}},transaction:o}),!0)}}return!1}function l(e){const{block:t,transaction:n}=e,i=t.getParentStore();if(i){(0,o.A6)(i.table,t.table)?u({parentStore:i,childStore:t,transaction:n}):c({childStore:t,transaction:n})}}function c(e){const{childStore:t,transaction:n}=e;if((0,i.OY)(t)){const e=t,o=e.getAssociatedCollectionStore();if(null!=o&&o.isPageTreeCollection()){const o=t.getParentBlockStore();o&&u({childStore:e,parentStore:o,transaction:n})}}t.getRecordStoreAtRootPath().getAlive()&&r.sW({store:t,data:{alive:!1},transaction:n})}function d(e){const{pageStore:t,transaction:n}=e;t.getRecordStoreAtRootPath().getAlive()&&r.sW({store:t,data:{alive:!1},transaction:n})}function u(e){const{childStore:t,parentStore:n,transaction:i}=e,r=(0,o.A6)(n.table,t.table);if(!r)throw new Error(`Could not find child path for parent table ${n.table} and child table ${t.table}`);a.applyOperation({store:n,operation:{pointer:n.pointer,path:r,command:"removeChild",args:{id:t.id}},transaction:i})}function p(e){const{childStore:t,parentStore:n,transaction:i}=e,r=(0,o.A6)(n.table,t.table);if(!r)throw new Error(`Could not find child path for parent table ${n.table} and child table ${t.table}`);a.applyOperation({store:n,operation:{pointer:n.pointer,path:r,command:"insertChildrenAfter",args:{ids:[t.id],after:e.after}},transaction:i})}function m(e){const{childStore:t,parentStore:n,transaction:i}=e,r=(0,o.A6)(n.table,t.table);if(!r)throw new Error(`Could not find child path for parent table ${n.table} and child table ${t.table}`);a.applyOperation({store:n,operation:{pointer:n.pointer,path:r,command:"insertChildrenBefore",args:{ids:[t.id],before:e.before}},transaction:i})}function f(e){const{parentStore:t,oldChildStore:n,newChildStore:o,transaction:i}=e,r=n.id;(t.getValue()||[]).indexOf(r)>=0&&(p({parentStore:t,childStore:o,transaction:i,after:r}),u({parentStore:t,childStore:n,transaction:i}))}},19358:(e,t,n)=>{n.d(t,{D0:()=>h,If:()=>v,YM:()=>g});n(57658);var o=n(73360),i=n(18844),r=n(21202),a=n(6287),s=n(70279),l=n(91644),c=n(75246),d=n(77858),u=n(29369),p=n(66079),m=n(27105),f=n(9953);function g(e){const{childStore:t,parentStore:n,transaction:o}=e,i=t.getRecordStoreAtRootPath().getValue();if(i){const{parent_id:r,parent_table:a,alive:s}=i;r===n.id&&a===n.table&&s===e.alive||(f.sW({store:t,data:{parent_id:n.id,parent_table:n.table,alive:e.alive},transaction:o}),o.postPerformAssertions.push((()=>{(0,m.be)({parentStore:n,childStore:t})})))}}function h(e){if((0,o.hL)(e.childStore.table)){const t=e.childStore;return function(e){const{childStore:t,parentStore:n,transaction:o}=e,m=t.getRecordStoreUIParent();if(n.table===c.bx&&t.table===r.iU||n.table===u.e0&&t.table===r.iU||n.table===p.dx&&t.table===d.zU||n.table===i.Xj&&t.table===r.iU||n.table===l.AT&&t.table===r.iU)g({childStore:t,parentStore:n,alive:!0,transaction:o});else if(n.table===d.zU&&n.path&&"private_pages"===n.path[0]&&t.table===r.iU){const e=n.getRecordStoreUIParent().getSpaceStore();e&&g({childStore:t,parentStore:e,alive:!0,transaction:o})}else n.table===r.iU&&m&&m.table===d.zU&&m.path&&"private_pages"===m.path[0]?g({childStore:t,parentStore:n,alive:!0,transaction:o}):n.table!==r.iU&&n.table!==a.vF&&n.table!==s.x_||g({childStore:t,parentStore:n,alive:!0,transaction:o})}({...e,childStore:t})}{const{childStore:t,parentStore:n,transaction:o}=e,{parent_id:i,parent_table:r}=t.getValue()||{};i===n.id&&r===n.table||f.sW({store:t,data:{parent_id:n.id,parent_table:n.table},transaction:o})}}function v(e){const{childStore:t,parentStore:n,transaction:o}=e,{parent_id:i,parent_table:r,alive:a}=t.getValue()||{},s=n.table===d.zU&&n.path&&"private_pages"===n.path[0]&&a,l=i===n.id&&r===n.table&&a;(s||l)&&f.sW({store:t,data:{alive:!1},transaction:o})}},87420:(e,t,n)=>{n.d(t,{Af:()=>P,E5:()=>R,ME:()=>B,Om:()=>F,Xd:()=>O,bA:()=>M,jG:()=>A,xv:()=>E});n(57658);var o=n(15145),i=n(70096),r=n(89101),a=n(59183),s=n(10906),l=n(28020),c=n(84210),d=n(75419),u=n(16746),p=n(74948),m=n(38676),f=n(80444),g=n(22294),h=n(88923),v=n(86486),b=n(27724),y=n(24666),_=n(36610),S=n(92973),w=n(94419),k=n(32953),I=n(8055),C=n(13447),x=n(39865),T=n(37181);function M(e,t){const{mode:n}=t,o=e.WindowSizeStore.state.width,r=h.default.state.preferredSidePeekWidth||o/2;h.default.setState({...h.default.state,open:!0,preferredSidePeekWidth:Math.min(r,o/1.5),isOpening:!0,isClosing:!1,...t}),n===i.R&&p.toggleLeftSidebarByWindowSize(e),u.Z.isVisible()&&d.TN(),p.closeAssistantChatHistory({wasChatHistoryClosedAutomatically:!0})}function P(e){const{resultsStore:t,collectionContextStore:n,pageVisitSource:o}=e;null==n||n.searchOpen.setState(!1),h.default.setState({...h.default.state,resultsStore:t,collectionContextStore:n,pageVisitSource:o})}function A(e){(h.default.isSidePeekOpen()||h.default.isCenterPeekOpen())&&D(e)}function R(e){h.default.isSidePeekOpen()&&D(e)}function D(e){l.kw.state&&!g.Z.state.isKeyboardMode||v.default.state.isOpen&&v.default.state.menuIsOpen||b.default.isSelected()||y.default.hasSelection()||E(e,"empty_space_click")}function E(e,t,n){const i=h.default.state;if(!i.open||i.isClosing)return;h.default.isSidePeekOpen()&&(h.default.setState({...i,isClosing:!0}),F({environment:e,seen:!0}));const{mode:s,target:l,showMoveTo:d,collectionContextStore:u,savedSelectionStoreState:p,savedTableSelectionStoreState:g,savedSidebarExpandedStoreState:v}=i,y=l.getContentStores(),T=1===y.length?y[0]:void 0,M=T&&T.isEmptyEditableBlock(),P=d&&l.isEmptyTitle()&&(l.isEmptyPage()||M);C.createAndCommit({userAction:"PeekRenderer.close",environment:e,perform:t=>{P?(x.y8({environment:e,blocks:[i.target],transaction:t}),t.postSubmitCallbacks.push((t=>{t||_.dh(e,{analyticsName:"delete",from:"peek_actions",block_id:l.id,block_type:"page"})}))):M&&w.Od({parent:l.getContentStore(),childToRemove:T,transaction:t})}}),t&&"side_peek"===s&&S.vc(e,{from:t}),S.$C(e,{peek_mode:s,from:t,target_page_id:l.id,target_parent_id:l.getParentId(),page_source:n,should_delete:P}),k.jC(e,s),k.LU(e),k.rM(e),b.default.setState({...b.default.state,...p}),g.isActive&&a.Z.setState(g),v&&m.sidebarExpandedStore.setState(!0);const{mainEditorCurrentBlockStore:A}=f.default.state,{RouterStore:R}=e,D=R.state.route;if(null!=u&&u.searchQuery.state&&(null==u||u.searchOpen.setState(!0)),A&&"page"===D.name){const t=(0,c.ZP)({store:A,fullyQualified:!1,scrollToBlockId:D.scrollToBlockId,collectionViewId:D.collectionViewId,discussionId:D.discussionId,showMoveTo:D.showMoveTo,saveParent:D.saveParent,pageVisitSource:o.tY.PeekClose});I.c4({environment:e,url:t})}else"chat"===D.name&&I.c4({environment:e,url:r._j.chat})}function B(){const e=h.default.state;e.open&&!e.isClosing&&h.default.setState({...e,open:!1,resultsStore:void 0,collectionContextStore:void 0})}function F(e){const{environment:t,seen:n}=e,{currentUserSettingsStore:o}=f.default.state;o&&C.createAndCommit({userAction:"peekActions.setSeenPeekModeIntroTooltip",environment:t,perform:e=>{T.d2({userSettingsStore:o,transaction:e,data:{seen_peek_mode_tooltip:n}})}})}function O(e){const{collectionContextStore:t,resultsStore:n}=e;(0,s.YG)(t)||P({collectionContextStore:t,resultsStore:n,pageVisitSource:void 0})}},76464:(e,t,n)=>{n.d(t,{GQ:()=>ce,Kh:()=>ie,MX:()=>ne,Pk:()=>te,ep:()=>J,hs:()=>oe,n_:()=>se,u9:()=>ue});n(57658);var o=n(1302),i=n(66897),r=n(59730),a=n(24211),s=n(63306),l=n(87479),c=n(72141),d=n(77420),u=n(84683),p=n(75246),m=n(29369),f=n(19889),g=n(94044),h=n(64684),v=n(9291),b=n(57347),y=n(53965),_=n(7032),S=n(1898),w=n(15010),k=n(33954),I=n(33929),C=n(98165),x=n(46654),T=n(45101),M=n(65598),P=n(48779),A=n(95697),R=n(18245),D=n(28578),E=n(80444),B=n(81236),F=n(6258),O=n(81023),Z=n(88893),V=n(35057),U=n(88280),L=n(9867),j=n(36610),N=n(91219),z=n(91536),q=n(81918),W=n(17224),H=n(54642),K=n(47307),G=n(9953),$=n(29974),Q=n(13447);const Y=(0,v.defineMessages)({preventFullPageAccessDeletion:{id:"permissionsActions.preventRemovingAllFullAccess.message",defaultMessage:"Please give someone else Full Access before removing this permission."},preventUserOrGroupDeletion:{id:"permissionsActions.preventUserOrGroupDeletion.message",defaultMessage:"At least one person or group must have access."},confirmUpgradeMessage:{defaultMessage:"To add members to your workspace, you need to switch it to the Team plan. You will be charged a prorated amount based on your current billing interval and account balance.",id:"permissions.confirmDialog.upgradeToTeamWorkspace.message"},confirmUpgradeButtonLabel:{defaultMessage:"Upgrade to Team workspace",id:"permissions.confirmDialog.upgradeToTeamWorkspace.confirmButton.label"}});function J(e){const{environment:t,store:n,permissionItems:i,transaction:r,from:a,skipAnalytics:s,pagePermissionChangeLocation:d,fromPermissionWrapper:u}=e;if((0,x.SO)(e))return!1;if(!n.isDefined())return!1;const m=n.getPermissionItems();let f=[...m];const{id:g}=t.currentUser,v=n instanceof F.H2,b=n instanceof F.G&&n.getParentTable()===p.bx,_=n instanceof F.G&&(b||n.isRestricted());s||(n instanceof F.G?z.kM({environment:t,store:n,newItems:i,location:d,inSudoMode:r.useSudoMode,fromPermissionWrapper:u}):i.forEach((e=>{v?z.dE(t,e,{from:a}):n instanceof F.zX?z.gR(t,{item:e,teamStore:n}):(0,S.t1)(n)}))),f=f.filter((e=>!i.some((t=>l.Kf(e,t)))));for(const o of i)f.push(o);f=f.filter((e=>"none"!==c.cY(e)));const w=Boolean(i.find((e=>"user_permission"===e.type&&e.user_id===g&&!c.zz(e.role))));if(n instanceof F.G&&_&&g){const e=C.Pj(n),t=e?(0,P.jv)(e):[],o=e?e.getPermissionGroups():[],a=Boolean(f.find((e=>"user_permission"===e.type&&c.zz(e.role)&&e.user_id===g))),s=C.VP(n),l=null==s?void 0:s.getMembers(),d=void 0!==l&&(0,h.pd)({membership:l},g),u=e&&s&&(0,A.AL)({teamStore:s,spaceStore:e,userId:g}),p=t.find((e=>"user_permission"===e.type&&e.user_id===g)),m=i.find((e=>"space_permission"===e.type&&c.zz(e.role))),v=i.find((e=>"space_permission"===e.type&&c.YX(e.role))),b=i.find((e=>"space_permission"===e.type&&!c.YX(e.role))),y=f.find((e=>Boolean("group_permission"===e.type&&c.zz(e.role)&&o.find((t=>Boolean(t.id===e.group_id&&t.user_ids&&t.user_ids.indexOf(g)>=0)))))),_=(0,A.bq)();if(e&&e.canEdit()&&!_){const t=e.getPagesStore();v?Q.applyOperation({transaction:r,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{id:n.id}}}):b&&Q.applyOperation({transaction:r,store:t,operation:{pointer:t.pointer,path:t.path,command:"listRemove",args:{id:n.id}}})}if(!_&&a&&p&&(m||y)&&(f=f.filter((e=>!("user_permission"===e.type&&e.user_id===g)))),!w){f.some((e=>!("space_permission"!==e.type||!c.zz(e.role)||!p)||(!("user_permission"!==e.type||!c.zz(e.role)||e.user_id!==g)||(!("group_permission"!==e.type||!c.zz(e.role)||!o.find((t=>Boolean(t.id===e.group_id&&t.user_ids&&t.user_ids.indexOf(g)>=0))))||(!!((0,c.zU)(e)&&c.zz(e.role)&&(null==s?void 0:s.id)===e.team_id&&u)||!!((0,c.LW)(e)&&c.zz(e.role)&&(null==s?void 0:s.id)===e.team_id&&d))))))||r.useSudoMode||(f=f.filter((e=>!("user_permission"===e.type&&e.user_id===g))),f.push({type:"user_permission",user_id:g,role:"editor"}))}}if(!f.some((e=>{const t=c.cY(e);return c.zz(t)}))&&(v||_))return o.default.afterNextFlush((()=>{K.showErrorMessage(I.default.formatMessage(Y.preventFullPageAccessDeletion))})),!1;const k=f.some((e=>(c.jg(e)||c.hV(e))&&"editor"===e.role));if((0,A.bq)()&&b&&!k)return o.default.afterNextFlush((()=>{K.showErrorMessage(I.default.formatMessage(Y.preventUserOrGroupDeletion))})),!1;const T=(0,F.Vh)(n,n.pointer,"permissions"),M=[];for(const o of m){!f.find((e=>l.Kf(o,e)))&&c.C2(o)&&M.push({...o,role:"none"})}for(const o of f){const e=m.find((e=>l.Kf(o,e)));!c.C2(o)||e&&y.Xy(e,o)||M.push(o)}let D=[];const E=C.Om(n);if(n instanceof F.G&&!n.isRestricted()&&E&&E instanceof F.G){const e=(0,x.YO)(E);D=M.map((t=>e.find((e=>y.Xy(e.permissionItem,t)))?{...t,role:"none"}:t))}else D=M;for(const o of D)Q.applyOperation({store:T,operation:{pointer:T.pointer,command:"setPermissionItem",path:T.path,args:o},transaction:r});return r.postSubmitCallbacks.push((async n=>{z.NL(t,{status:Boolean(n)?"fail":"success",location:d}),n||await O.bi(t),e.metric&&R.default.measure(e.metric,{environment:t})})),!0}function X(e){var t;const{environment:n,store:o,permissionItems:i,transaction:r,inviteFlowId:a,inviteMessage:s,inviteOrigin:l,disable_invite_email:c}=e,d=null===(t=E.default.state.currentSpaceStore)||void 0===t?void 0:t.id,{id:u}=n.currentUser;for(const p of i)if(d&&"user_permission"===p.type&&p.invite_id){const{inviteeId:e,inviteeTable:t}=ee({item:p,spaceId:d}),n={id:p.invite_id,version:1,flow_id:a,space_id:d,target_id:o.id,target_table:o.table,inviter_id:u,inviter_table:f.KJ,invitee_id:e,invitee_table_or_group:t,message:s,created_time:Date.now(),attributes:{permission:p,origin_type:l,disable_invite_email:c}};G.sW({store:(0,F.Kv)(o,{table:"invite",id:n.id,spaceId:d}),data:n,transaction:r})}return r.postSubmitCallbacks.push((e=>{N.bR(n,{status:Boolean(e)?"fail":"success",origin:l})})),!0}function ee(e){const{item:t,spaceId:n}=e;return c.jg(t)?{inviteeId:t.user_id,inviteeTable:f.KJ}:c.FB(t)?{inviteeId:t.bot_id,inviteeTable:d.cZ}:c.hV(t)?{inviteeId:t.group_id,inviteeTable:u._e}:c.ix(t)?{inviteeId:n,inviteeTable:p.bx}:c.zU(t)?{inviteeId:t.team_id,inviteeTable:m.e0}:{}}function te(e){const{environment:t,store:n,permissionItem:o,transaction:r,shouldInherit:a,fromPermissionWrapper:d}=e;if(!n.isDefined())return;const u=[];if(a){const e=(0,x.YO)(n).map((e=>e.permissionItem)).filter((e=>!l.Kf(e,o)));for(const t of e)c.C2(t)&&(n.isCollectionView()||!c.WY(t.role)||c.FB(t)?u.push(t):u.push({...t,role:"read_and_write"}))}const p=t.currentUser.id,m=p?n.getRecordValue({table:f.KJ,id:p}):void 0,g=m&&(0,i.dp)(m),h=s.DW(n.pointer,n.getRecordModel);!p||l.ZO({actor:g,ancestors:h,updatedPermissionItem:o})||r.useSudoMode||u.push({type:"user_permission",user_id:p,role:"editor"}),u.push(o);const v=n.getPermissionItemsStore();z.kM({environment:t,store:n,newItems:[o],fromPermissionWrapper:d});for(const i of u)Q.applyOperation({store:v,operation:{pointer:v.pointer,command:"setPermissionItem",path:v.path,args:i},transaction:r});Q.applyOperation({store:v,operation:{pointer:v.pointer,command:"setSingletonPermissionItem",path:v.path,args:{singletonPermissionItem:{type:"restricted_permission"},set:!0}},transaction:r}),j.gl(t,{type:"none"===o.role?"remove":"narrow"}),r.postSubmitCallbacks.push((e=>{e||O.bi(t)}))}function ne(e){const{environment:t,store:n,transaction:o}=e;if(!n.isDefined())return;const i=n.getPermissionItems(),r=C.Om(n),a=r?l.Wo(C.fJ(r)):[],s=l.Ub(n.getModel(),i,a),c=n.getPermissionItemsStore();for(const l of s)Q.applyOperation({store:c,operation:l,transaction:o});j.TJ(t,{using_admin_api:!1}),o.postSubmitCallbacks.push((e=>{e||O.bi(t)}))}async function oe(e){const{environment:t,store:n}=e,{currentSpaceStore:o}=E.default.state;if(o){const e=o.id,i=n.id,r=await H.spaceAdminRestoreAccess(t,{spaceId:e,blockId:i});j.TJ(t,{using_admin_api:!0}),"failed"===r.type&&K.showError(r)}}function ie(e){const{environment:t,store:n,transaction:o}=e,i=n.getPermissionItems();if(!n.isTopLevelTeamPage()||0===i.length)return;const r=i.filter((e=>c.FB(e)));G.sW({store:n,transaction:o,data:{permissions:r}}),W.FN(t,{store:C.VP(n)})}function re(e){const t=e.inviteTargets[0];return!(!t||"bot"!==t.type)}function ae(e){return c.jg(e.permissionItem)&&(0,T.OA)(e.inviteTarget)}async function se(e){const{environment:t,isOnboarding:n,invite:o}=e;if(0===e.inviteTargets.length)return{success:!0,invitedUsers:{},requestedUsers:{}};const i=U.subscriptionDataStoreInstance.state,r=(0,Z.qX)();let a;if(re(e))if((0,M.Mm)(e.store)){const t=e.inviteRole;a=e.inviteTargets.map((e=>({inviteTarget:e,permissionItem:{type:"bot_permission",role:t,bot_id:e.value.id}})))}else(0,M.OY)(e.store)?a=e.inviteTargets.map((e=>({inviteTarget:e,permissionItem:{type:"bot_permission",role:l.uH(e.value.capabilities),bot_id:e.value.id,parent_table:e.value.parent_table,parent_id:e.value.parent_id}}))):(0,S.t1)(e.store);else a=await async function(e){const{environment:t,inviteTargets:n,inviteRole:o}=e;return Promise.all(n.map((async n=>{if("newUser"===n.type){const e=await le(t,n),i={type:"user_permission",role:o,user_id:e};return{inviteTarget:{...n,value:{...n.value,id:e}},permissionItem:i}}if("existingUser"===n.type){return{inviteTarget:n,permissionItem:{type:"user_permission",role:e.inviteRole,user_id:n.value.id}}}if("group"===n.type){return{inviteTarget:n,permissionItem:{type:"group_permission",role:e.inviteRole,group_id:n.value.id}}}(0,S.t1)(n)})))}({environment:t,inviteTargets:e.inviteTargets,inviteRole:e.inviteRole,data:i});const{toInvite:s,toRequest:d}=function(e,t){if(!((0,P.Q6)(E.default.state.currentSpaceStore)&&e instanceof F.G))return{toInvite:t,toRequest:[]};const n=[],o=[];for(const i of t)ae(i)?n.push(i):o.push(i);return{toInvite:o,toRequest:n}}(e.store,a),u={};if(e.store instanceof F.G&&d.length>0){const n=await async function(e){const{environment:t,permissionItems:n,inviteMessage:o,store:i}=e,r=await Promise.allSettled(n.map((async e=>H.requestAccess(t,{type:"guest-invite-request",block:{id:i.id,spaceId:i.getSpaceId()},forActorId:e.user_id,message:void 0,attributes:{role:e.role,inviteMessage:o}}))));return!r.find((e=>"rejected"===e.status||"fulfilled"===e.status&&"failed"===e.value.type))}({environment:t,store:e.store,permissionItems:d.map((e=>e.permissionItem)),inviteMessage:o.inviteMessage});if(!n)return{success:!1};for(const e of d)u[e.inviteTarget.value.email]=e.permissionItem.user_id}if(0===s.length)return{success:!0,invitedUsers:{},requestedUsers:u};const p=s.map((e=>e.inviteTarget)),m=s.map((e=>e.permissionItem));let f,h;if(e.store instanceof F.G&&void 0!==(0,V.c4)(i))f=await async function(e){const{environment:t,store:n,permissionItems:o,invite:i}=e,r=n.getSpaceId();if(!r)return!1;const a=B.Z.getData(t,{spaceId:r});if(!a)return!1;const s=o.filter(c.jg).map((e=>({...e,invite_id:(0,_.ZP)()}))),l=await H.inviteGuestsToSpace(t,{block:{id:n.id,spaceId:r},permissionItems:s});if("failed"===l.type)return!1;const{serverCommitResult:d}=Q.createAndCommit({userAction:"permissionsActions.saveInvites",environment:t,perform:e=>{const{inviteFlowId:o,inviteMessage:r,inviteOrigin:a,disable_invite_email:l}=i;X({environment:t,store:n,permissionItems:s,transaction:e,inviteFlowId:o,inviteMessage:(0,g.my)(r),inviteOrigin:a,disable_invite_email:l})}});await d;const u=o.filter(c.FB);u.length>0&&await de({environment:t,store:n,permissionItems:u,invite:i});return!0}({environment:t,store:e.store,permissionItems:m,invite:o});else try{await de({environment:t,store:e.store,sudoModeStore:e.sudoModeStore,permissionItems:m,invite:o}),f=!0}catch(x){f=!1,h=(0,b.t)(x)}if(!re(e)){var v;const n=e.store instanceof F.G?null===(v=e.store.getCollectionViewCollectionStore())||void 0===v?void 0:v.id:void 0,i=e.store instanceof F.G?e.store.getParentCollectionIdUpToTwoLevels():void 0;var y,k;if(f)N.jB(t,{role:e.inviteRole,is_space:e.store instanceof F.H2,invite_targets:p,is_onboarding:e.isOnboarding,invite_origin:o.inviteOrigin,permission_items:m,invite_message_length:(null===(y=o.inviteMessage)||void 0===y?void 0:y.length)??0,invite_flow_id:o.inviteFlowId,isProfessionalTeamUser:(0,w.QZ)(),domainType:(0,w.JF)(),share_menu_session_id:D.ZP.state.sessionId,collection_id:n,parent_collection_id:i});else N.l5(t,{error:h,role:e.inviteRole,is_space:e.store instanceof F.H2,invite_targets:p,is_onboarding:e.isOnboarding,invite_origin:o.inviteOrigin,permission_items:m,invite_message_length:(null===(k=o.inviteMessage)||void 0===k?void 0:k.length)??0,invite_flow_id:o.inviteFlowId,isProfessionalTeamUser:(0,w.QZ)(),domainType:(0,w.JF)(),share_menu_session_id:D.ZP.state.sessionId,collection_id:n,parent_collection_id:i})}n||await O.bi(t);const I={};p.forEach(((e,t)=>{var n;const o=m[t];"newUser"!==e.type&&"existingUser"!==e.type||null===(n=e.value)||void 0===n||!n.email||"user_permission"!==o.type||(I[e.value.email]=o.user_id)}));const C=1===r&&(0,Z.qX)()>1;return!(0,Z.DB)(U.subscriptionDataStoreInstance.state)&&C&&$.bR(t),{success:f,error:h,invitedUsers:I,requestedUsers:u}}async function le(e,t){const n=(0,a.E2)(I.default.getIntl()),o=t.value.email,i=await H.createEmailUser(e,{email:o,preferredLocaleOrigin:"inferred_from_inviter",preferredLocale:n});if("failed"===i.type){if((0,r.Jx)(i.error)){const e=(0,k.nX)(I.default.getIntl(),i.error);e?K.showErrorMessage(e):K.deprecatedShowErrorMessage(i.error.message)}else K.deprecatedShowErrorMessage(i.error.message);throw i.error}return i.data.userId}async function ce(e){let{environment:t,store:n,inviteTargets:o,inviteRole:i,createNewTeamFlowId:r}=e;const a=n.getSpaceId(),s=t.currentUser.id;if(0===o.length)return!0;if(!a||!s)return!1;const l=U.subscriptionDataStoreInstance.state,{teamMemberInfos:c,invitedMemberIds:d}=await async function(e){const{environment:t,inviteTargets:n,inviteRole:o}=e,i=[],r=[];for(const a of n){let e;if("newUser"===a.type){const n=await le(t,a);e={entity_type:"user",type:o,user_id:n},i.push(n)}else"existingUser"===a.type?(e={entity_type:"user",type:o,user_id:a.value.id},"none"!==a.spaceRole&&"not_in_space"!==a.spaceRole||i.push(a.value.id)):"group"===a.type?e={entity_type:"group",type:"member",group_id:a.value.id}:(0,S.t1)(a);r.push(e)}return{teamMemberInfos:r,invitedMemberIds:i}}({environment:t,inviteTargets:o,inviteRole:i,data:l}),u=await L.Uj({environment:t,teamMemberInfos:c,teamStore:n,isSettingDefaultTeam:!1,createNewTeamFlowId:r});return u&&(q.Jk(t,{invite_origin:"team_invite_overlay",domainType:(0,w.JF)(),new_workspace_member_count:d.length,new_workspace_member_ids:d}),await O.bi(t)),u}async function de(e){const{environment:t,store:n,sudoModeStore:o,permissionItems:i,invite:r}=e,{serverCommitResult:a}=Q.createAndCommit({userAction:"permissionsActions.savePermissionItems",environment:t,useSudoMode:"block"===n.table&&(null==o?void 0:o.shouldSaveTransactionWithSudoMode(n)),perform:e=>{const o=i.map((e=>"user_permission"!==e.type?e:{...e,invite_id:(0,_.ZP)()})),{inviteFlowId:a,inviteMessage:s,inviteOrigin:l,disable_invite_email:c}=r;X({environment:t,store:n,permissionItems:o,transaction:e,inviteFlowId:a,inviteMessage:(0,g.my)(s),inviteOrigin:l,disable_invite_email:c}),J({environment:t,store:n,permissionItems:o,transaction:e,from:l})}});await a}function ue(e){const{store:t,transaction:n}=e;G.sW({store:t,data:{permissions:null},transaction:n})}},9700:(e,t,n)=>{n.d(t,{m:()=>m});var o=n(87078),i=n(4023),r=n(15723),a=n(31194);const{Top:s,Bottom:l,Left:c,Right:d}=i.u,{Start:u,Center:p}=i.v;function m(e){const{store:t,placementToOrigin:n,alignmentToOrigin:i,popupRect:u,originRect:p,viewportPadding:m,placementFlipped:g,viewportAdditionalBottomPadding:h}=e,v=(0,o.Z)();let b=r.jn(v,-m||0);0!==h&&(b=new r.iL(b.x,b.y,b.width,b.height-h));const y=f(u,p,n,i),_=Math.max(b.left-y.left,0)+Math.min(b.right-y.right,0),S=Math.max(b.top-y.top,0)+Math.min(b.bottom-y.bottom,0),w=n===c&&Math.abs(_)>0&&r.TF(b,f(u,p,(0,a.FJ)(n),i)),k=n===d&&Math.abs(_)>0&&r.TF(b,f(u,p,(0,a.FJ)(n),i)),I=n===s&&Math.abs(S)>0&&r.kL(b,f(u,p,(0,a.FJ)(n),i)),C=n===l&&Math.abs(S)>0&&r.kL(b,f(u,p,(0,a.FJ)(n),i)),x={placementFlipped:!1,offsetX:0,offsetY:0};x.placementFlipped=g||w||k||I||C,(!x.placementFlipped||n!==c&&n!==d)&&(x.offsetX=Math.round(_)),(!x.placementFlipped||n!==s&&n!==l)&&(x.offsetY=Math.round(S)),t.setState({...t.state,...x})}function f(e,t,n,o){if(n===s||n===l){let i,r;return i=o===u?t.left:o===p?t.left+t.width/2-e.width/2:t.right-e.width,r=n===s?t.top-e.height:t.bottom,new DOMRect(i,r,e.width,e.height)}{let i,r;return i=o===u?t.top:o===p?t.top+t.height/2-e.height/2:t.bottom-e.height,r=n===c?t.left-e.width:t.right,new DOMRect(r,i,e.width,e.height)}}},31304:(e,t,n)=>{n.d(t,{E:()=>w,_:()=>k});var o=n(18466),i=n(68626),r=n(75189),a=n(44615),s=n(41641),l=n(53965),c=n(52629),d=n(19584),u=n(63811),p=n(95477),m=n(2688),f=n(85844),g=n(6258),h=n(27724),v=n(24666),b=n(73661);const y=1e3,_=1*d.U6,S="presenceActions";function w(e,t,n,o){!function(e,t){const{persistAutoListener:n,rootStore:o,isActive:r,listenerReference:s,userId:l}=e.state;if(r){if(n&&n.destroy(),s&&m.ZP.removeListener(s,t),l&&o&&x({userId:l,rootStore:o})){const e=(0,a.T0)(o.id);m.ZP.updateField(e,l,{present:!1},_,t),m.ZP.clearOnDisconnect(e,S,t).catch((e=>{i.log({level:"error",from:"destroyPresence",type:"SystemError",error:(0,c.Ui)(e)})}))}e.reset()}}(e,t),o&&b.P(o,t,n)}async function k(e){const{userId:t,rootStore:n,presenceStore:i,environment:s,pageVisitIdStore:c}=e;if(await n.load(),C({userId:t,rootStore:n})){i.setState({...i.state,isActive:!0,rootStore:n,userId:t});const e=l.P2((()=>{i&&i.state.isActive&&i.state.rootStore===n&&I(i,s)}),y),d=(e,t)=>{i&&i.state.isActive&&i.state.rootStore===n&&function(e,t){const{remotePresenceData:n}=t.state,o=e||{};l.Xy(n,o)||t.setState({...t.state,remotePresenceData:o})}(function(e){const t={};if(l.Kn(e)){const n=Object.keys(e);for(const o of n){const n=e[o];n&&!(0,u.Gu)(r.uP,n)&&(t[o]=n)}}return t}(t),i)},p=(0,a.T0)(n.id),f=m.ZP.addListener(p,d,void 0,s);i.setState({...i.state,persistAutoListener:new o.Z({onChange:e}),listenerReference:f}),t&&x({userId:t,rootStore:n})&&await m.ZP.onDisconnect(p,[{operation:"updateField",key:p,field:t,updates:{present:!1},ttl:_},{operation:"logPageExit",userId:t,blockId:n.id,spaceId:n.getSpaceId(),pageVisitId:c.getCurrentPageVisitId()}],S,s),I(i,s)}}function I(e,t){const{persistAutoListener:n,rootStore:o,userId:i}=e.state;if(n&&n.startListener({incrementCycle:!0}),!o||!x({userId:i,rootStore:o}))return;let r;if(i&&o.canEdit()){var s,l;let e;const t=h.default.state;t.stores.length&&(e=t.stores[0]);const n=v.default.state,a="editing"===n.mode&&n.multiSelection;a&&o.uiContains(a.start.store)&&"block"===a.start.store.table&&(e=a.start.store),e||t.pivot&&(e=t.pivot);const c=null===(s=e)||void 0===s?void 0:s.findRecordStoreUIAncestors((e=>e instanceof g.G)).map((e=>e.id)),u=d.ud(Date.now());r={userId:i,present:f.Z.state.isVisible,activityTimestampNearestMinuteMs:u,blockId:(null===(l=e)||void 0===l?void 0:l.id)||null,blockPath:c||null}}if(n&&n.stopListener({isEndOfCycle:!0}),r){const e=(0,a.T0)(o.id);i&&m.ZP.updateField(e,i,r,_,t)}}function C(e){const{userId:t,rootStore:n}=e;return Boolean(n)&&(0,s.Z)(n.id)&&n.canEdit()&&t}function x(e){const{userId:t,rootStore:n}=e;return C({userId:t,rootStore:n})&&!p.default.isAdminMode}},40277:(e,t,n)=>{n.d(t,{th:()=>D,Jv:()=>M,I6:()=>P,Hr:()=>R});n(21703),n(57658);var o=n(68626),i=n(15157),r=n(63306),a=n(53965),s=n(66897),l=n(33728),c=n(59753),d=n(87479),u=n(72141),p=n(21202),m=n(6287),f=n(75246);function g(e,t,n){if(h(e,t))return!0;const o=Boolean(e.disable_public_access_requests||e.admin_disable_public_access);return!(!(t&&(0,s.pu)(t)&&n)||o)}function h(e,t){if(!t)return!1;if(!t.isUser())return!1;let n=!1;const o=e.getEmailDomains()||[],i=e.getPermissionItems()||[];if(t&&t.email&&o){const e=(0,l.Gd)(t.email);n=a.q9(o,e)}return i.find((e=>"user_permission"===e.type&&e.user_id===t.id))&&(n=!0),n}function v(e){const{block:t,space:n,viewer:o}=e;if(!t)return;if(!h(n,o))return;const i=t.getPermissionItems().filter((e=>"user_permission"===e.type&&(0,u.zz)(e.role))).map((e=>e.user_id));if(0===i.length)return;const r=n.getUserPermissionItems();return i.find((e=>(0,d.GU)({spacePermissions:r,userId:e})))}var b=n(73360),y=n(19889),_=n(57347),S=n(52629),w=n(33929),k=n(45950),I=n(5659),C=n(77080),x=n(54642);const T="publicAccessPageId";async function*M(e){const{environment:t,request:n}=e;if("block-space"===n.type){const e=await I.A.measure("loadPublicPageData",`block:${n.blockId} space:${n.spaceId}`,(()=>A(t,n)));"value"in e&&(yield e.value)}const i=await x.getPublicPageData(t,n);"success"===i.type?yield i.data:(o.log({level:"error",from:"publicPageDataActions",type:"loadPublicPageData",error:(0,S.Ui)(i.error)}),yield)}async function*P(e){const{environment:t,request:n}=e;if("block-space"===n.type){const e=await I.A.measure("loadPublicPageData",`block:${n.blockId} space:${n.spaceId}`,(()=>A(t,n)));"value"in e&&(yield e.value)}const i=await x.getPublicPageData(t,n);if("success"!==i.type)throw o.log({level:"error",from:"publicPageDataActions",type:"loadPublicPageDataUnsafely",error:(0,S.Ui)(i.error)}),i.error;yield i.data}async function A(e,t){if("block-space"!==t.type)return{error:Error("Shouldn't be looking for a non-block-space page")};const{blockId:n}=t,{id:o}=e.currentUser;if(n&&o){let t,a,s,l;try{const i=await k.yY({environment:e,recordPointers:[{table:p.iU,id:n},{table:y.KJ,id:o}],recurFn:e=>{const o=[];return e.table===p.iU&&e.id===n&&(t=e),e.table===f.bx&&(a=e),e.table===m.vF&&t&&t.parent_id===e.id&&(s=e),e.table===y.KJ&&(l=e),(0,b.tz)(e)&&o.push(e.getParentPointer()),o},recordIsRequired:()=>!0});if(t&&a&&l){const e=r.om({table:p.iU,id:n},i),o=l,d=Boolean(r.YL(e,o)),u=r.YP(e),b=function(e){const{spaceDomain:t,actor:n,userHasExplicitAccess:o,intl:i,requireInterstitial:r,requireLogin:a,publicAccessRole:s,publicHomePage:l,template:d,securitySettings:u}=e,b=c.kk.fromValue(p.iU,e.block),y=c.kk.fromValue(f.bx,e.space),_=c.kk.fromValue(m.vF,e.associatedCollectionValue),S="none"!==s,w=h(y,n),k=_&&(o||S)?_.getNormalizedSchema():void 0,I=_&&(o||S)?_.id:void 0,C=_&&(o||S)?_.getFormat():void 0;return{pageId:null==b?void 0:b.id,spaceName:y.name||i.formatMessage({id:"publicPageDataHelpers.untitledWorkspace.placeholder",defaultMessage:"Untitled Workspace"}),spaceId:y.id,spaceDomain:t,canJoinSpace:w,icon:y.icon,userHasExplicitAccess:o,ownerUserId:v({block:b,space:y,viewer:n}),collectionId:I,collectionSchema:k,collectionFormat:C,betaEnabled:y.beta_enabled,canRequestAccess:g(y,n,e.publicAccessRequestExpEnabled),requireInterstitial:r,requireLogin:Boolean(a),publicAccessRole:s,publicHomePage:l,securitySettings:u,template:d}}({block:t,space:a,spaceDomain:void 0,associatedCollectionValue:s,actor:o,userHasExplicitAccess:d,intl:w.default.getIntl(),requireInterstitial:void 0,publicAccessRole:u,securitySettings:void 0,publicHomePage:void 0,template:void 0,publicAccessRequestExpEnabled:C.default.checkGate("allow_public_page_access_request")});return{value:b}}}catch(i){return{error:(0,_.t)(i)}}}return{error:Error("No offline public page data found.")}}function R(e){let{currentUserId:t,blockId:n}=e;i.Z.set({userId:t,key:T,value:n})}function D(e){return i.Z.get({userId:e,key:T})}},9953:(e,t,n)=>{n.d(t,{GI:()=>y,Ue:()=>k,ae:()=>v,j4:()=>b,nj:()=>w,sO:()=>_,sW:()=>S});n(57658),n(21703);var o=n(66749),i=n(97531),r=n(59730),a=n(59753),s=n(73360),l=n(606),c=n(21202),d=(n(12139),n(53965)),u=n(7032),p=n(18821),m=n(1600),f=(n(95477),n(6258)),g=n(13447),h=n(1742);function v(e){const{environment:t,table:n,value:o,transaction:i,inMemoryRecordCache:r}=e;o.id||(o.id=(0,u.ZP)());const a=o,c=s.mk.create(n,a),d=l.dr.fromRecordWithTable(c),p=f.t1.createUniqueRootStore(t,d,{userId:i.userId,inMemoryRecordCache:r});return g.applyOperation({store:p,operation:{pointer:p.pointer,path:[],command:"set",args:o},transaction:i}),p}function b(e){var t;const{environment:n,type:o,properties:a,format:s,permissions:l,transaction:d,inMemoryRecordCache:p,useCrdt:m}=e;let v=e.tracker;const b=e.id||(0,u.ZP)(),y=e.spaceId||d.spaceId,_=new f.G(n,{table:c.iU,id:b,spaceId:y},{userId:d.userId,inMemoryRecordCache:p});if(!v&&!d.getUserFlowForAnalyticsPurposesOnly()){const e="page"===o?"user_flow_create_page":"user_flow_create_block";v=new h.BW({environment:n,entryPointName:"recordActions.createBlock",userFlow:e,succeedOnEnqueue:!0})}null===(t=v)||void 0===t||t.track(_.pointer,d);const S=i.mz({block:{id:b,type:o,permissions:l,properties:a,format:s,space_id:y},useCrdt:m});for(const i of S)g.applyOperation({store:_,operation:i,transaction:d});return d.postPerformAssertions.push((function(){if(d.isLocal)return;if(!_.getParentStore())throw new r.p8(`Created block was not given a parent before being committed in transaction ${d.getUserActionForAnalyticsPurposesOnly()}`)})),_}function y(e){const{environment:t,transaction:n,discussionId:o=(0,u.ZP)()}=e,i=b(e);(0,m.n1)(n,i,{id:(0,u.ZP)(),type:"insert",discussionId:o});if(!(0,p.i8)({environment:t,blockStore:i,commentTextValue:[[""]],transaction:n,files:[],type:"suggestion",discussionId:o}))throw new Error("Discussion must be created when creating a block with suggestion");return i}function _(e){const{store:t,value:n,transaction:o}=e,i=t.path;g.applyOperation({store:t,operation:{pointer:t.pointer,path:i,command:"set",args:n??null},transaction:o})}function S(e){const{store:t,transaction:n}=e,i=t.path;let r=e.data;r&&t.table===c.iU&&(d.Xy(i,[])?(r=function(e){const{properties:t,format:n,...o}=e;return o}(r),r=o.pp(r)):d.Xy(i,["properties"])?"title"in r||(r=o.pp(r)):d.Xy(i,["format"])&&(r=function(e){const{use_crdt:t,text_slice_tree:n,text_clocks:o,...i}=e;return i}(r),r=o.pp(r))),g.applyOperation({store:t,operation:{pointer:t.pointer,path:i,command:"update",args:r},transaction:n})}function w(e){const{store:t,source:n,fileIds:o,transaction:i}=e,r=t.path;for(const a of o)g.applyOperation({store:t,operation:{pointer:t.pointer,path:r,command:"copyFile",args:{source:n,fileId:a}},transaction:i})}function k(e){let{environment:t,table:n,args:o,transaction:i,inMemoryRecordCache:r}=e;const s=a.vk[n],{model:l,operation:c}=s.create(o),d=f.t1.createUniqueRootStore(t,l.pointer,{userId:i.userId,inMemoryRecordCache:r});return g.applyOperation({store:d,operation:c,transaction:i}),d}},4408:(e,t,n)=>{n.d(t,{HB:()=>Se,LK:()=>ke,Wl:()=>be,bG:()=>_e,fL:()=>ye,uo:()=>we});n(21703);var o=n(68626),i=n(59753),r=n(72141),a=n(54368),s=n(45149),l=n(51650),c=n(8542),d=n(10188),u=n(98963),p=n(18844),m=n(56358),f=n(21202),g=n(6359),h=n(44312),v=n(19639),b=n(32161),y=n(82447),_=n(49953),S=n(14710),w=n(66726),k=n(30754),I=n(73081),C=n(84683),x=n(1849),T=n(11318),M=n(94578),P=n(86854),A=n(80396),R=n(24836),D=n(86135),E=n(84323),B=n(1311),F=n(83200),O=n(67627),Z=n(65963),V=n(14130),U=n(34406),L=n(42314),j=n(16663),N=n(19221),z=n(93646),q=n(91644),W=n(75246),H=n(96740),K=n(75990),G=n(57829),$=n(56877),Q=n(47238),Y=n(35623),J=n(77858),X=n(63368),ee=n(26195),te=n(14718),ne=n(14327),oe=n(71495),ie=n(53412),re=n(19889),ae=n(98897),se=n(66079),le=n(58161),ce=n(28182),de=n(35794),ue=n(70203),pe=n(52629),me=n(37850),fe=n(44133),ge=n(69151),he=n(53730),ve=n(54642);function be(e){const{environment:t,pointer:n,userId:i,inMemoryRecordCache:a,model:s,role:l,force:c,maybeStaleRecordMap:d,updatePaths:u,debugSource:p}=e;"block"===n.table&&(0,fe.setBlockIdDebugSource)(n.id,p);const m=i||t.currentUser.id,g=null==s?void 0:s.getVersion(),h=a.getRole({pointer:n,userId:m}),v=a.getVersion({pointer:n,userId:m}),b="number"==typeof g&&g>v;if(!(c||b||void 0!==l&&h!==l))return;!s||s.id===n.id&&s.pointer.id===n.id&&s.pointer.table===n.table||o.log({level:"warning",from:"recordCacheActions.ts",type:"FetchedPointerMismatch",error:(0,pe.Ui)(new Error("Updated model being set on record does not match pointer")),data:{miscDataToConvertToString:{requestedPointer:n,modelPointer:null==s?void 0:s.pointer,modelId:s.id,debugSource:p}}});let y=s;if(!c&&!b&&function(e){const{oldRole:t,newRole:n}=e;if(!n||!r.YX(n))return!1;if(t&&!r.J5(t))return!1;return!0}({oldRole:h,newRole:l})){const e=a.getRecordModel({pointer:n,userId:m});e&&(e.id===n.id&&e.pointer.id===n.id&&e.pointer.table===n.table||o.log({level:"warning",from:"recordCacheActions.ts",type:"FetchedPointerMismatch",error:(0,pe.Ui)(new Error("Previous model fetched from cache does not match pointer")),data:{miscDataToConvertToString:{requestedPointer:n,previousModelPointer:e.pointer,previousModelId:e.id}}}),y=e)}a.setModelAndRole({pointer:n,userId:m},y,l);for(const o of u)a.emitRecord(n,o);if(y&&!a.isTemporaryData){const e=y.__IM_SORRY__getValue();if(n.table===f.iU&&e){const t=e;t.properties&&t.properties.title&&(t.properties.title=t.properties.title.map((e=>ue.Y_F(e))))}const o=t.defaultRecordCache.persistedRecordCache;if(o&&Ce[n.table]){const i=function(e){const{environment:t,pointer:n,model:o,role:i}=e,{id:a}=t.currentUser,s=n.table===re.KJ||n.table===se.dx||n.table===ce.Sr;if(s&&a===n.id)return Ie.LoggedInUser;if((null==o?void 0:o.table)===J.zU&&o.parent_id===a)return Ie.JoinedSpace;if(n.table===W.bx&&(0,r.Jy)(i))return Ie.JoinedSpace;return}({environment:t,pointer:n,model:y,role:l}),a={value:e,role:l};o.set(n,a,i,m,d)}}a===t.defaultRecordCache.inMemoryRecordCache&&ge.unsubscribeAfterDelay({pointer:n,userId:m,environment:t})}function ye(e){const{environment:t,userId:n,recordMap:r,inMemoryRecordCache:a,force:s,maybeStaleRecordMap:l,debugSource:c}=e,d=t.defaultRecordCache.persistedRecordCache;(0,me.Lc)(r,100,(async e=>{let{pointer:r,model:u,role:p}=e,m=u,f=p;if(he.transactionQueue.isPendingTransactionForRecord(r)&&d){const e=await d.get(r,n||t.currentUser.id);e&&(e.value&&e.value.id!==r.id&&o.log({level:"warning",from:"recordCacheActions.ts",type:"FetchedPointerMismatch",error:(0,pe.Ui)(new Error("Updated model from persistedRecordCache does not match pointer in setRecordMap")),data:{miscDataToConvertToString:{requestedPointer:r,resultId:e.value.id,debugSource:c}}}),m=i.kk.fromValue(r.table,e.value),f=p)}be({environment:t,inMemoryRecordCache:a,pointer:r,userId:n,model:m,role:f,updatePaths:[[]],force:s,maybeStaleRecordMap:l,debugSource:c})}))}async function _e(e){const{inMemoryRecordCache:t,pointer:n,userId:o,environment:r,minimumVersion:a}=e,s=he.transactionQueue.isPendingTransactionForRecord(n),l=r.defaultRecordCache.persistedRecordCache;if(s)return l&&await l.get(n,o);let c,d;l&&(c=await l.get(n,o),c&&be({environment:r,inMemoryRecordCache:t,pointer:n,userId:o,model:i.kk.fromValue(n.table,c.value),role:c.role,updatePaths:[[]],debugSource:"refreshAndReturnRecord (localResult)"}));try{const e=t.getEntry({pointer:n,userId:o}),s=e?e.value:void 0,l=e?e.pointer:void 0;if(a&&null!=s&&s.value&&(null==s?void 0:s.value.version)>=a)return s;d=await ve.syncRecordValue(r,{userId:o,version:s&&s.value&&s.value.version?s.value.version:-1,pointer:l||n}),d&&be({environment:r,inMemoryRecordCache:t,pointer:n,userId:o,model:i.kk.fromValue(n.table,d.value),role:d.role,updatePaths:[[]],debugSource:"refreshAndReturnRecord (remoteResult)"})}catch(u){console.error(u)}return d||c}async function Se(e){const{inMemoryRecordCache:t,pointer:n,userId:o,environment:r}=e,{defaultRecordCache:a}=r,s=await ve.syncRecordValue(r,{pointer:n,userId:o,version:-1});s&&(we({environment:r,inMemoryRecordCache:t,persistedRecordCache:a.persistedRecordCache,pointer:n,userId:o}),be({environment:r,inMemoryRecordCache:t,pointer:n,userId:o,model:i.kk.fromValue(n.table,s.value),role:s.role,updatePaths:[[]],debugSource:"forceFetchRemoteRecord"}))}function we(e){const{inMemoryRecordCache:t,persistedRecordCache:n,pointer:o,userId:i}=e;t.deleteRecord({pointer:o,userId:i}),t.emitRecord(o,[]),null==n||n.deleteRecord(o,i)}function ke(e){const t=e.defaultRecordCache.inMemoryRecordCache;for(const{pointer:n}of t.data)ge.unsubscribeForAllUsers({pointer:n,environment:e});t.clearCache()}const Ie={LoggedInUser:100,JoinedSpace:50},Ce={block:!0,notion_user:!0,space:!0,space_bot:!0,space_user:!0,organization:!0,organization_space:!0,space_view:!0,user_root:!0,collection:!0,collection_view:!0,follow:!0,discussion:!0,comment:!0,user_settings:!0,slack_integration:!0,bot:!0,integration:!0,space_invite_link:!0,page_visit:!0,page_exit:!0,[b.PJ]:!0,team:!0,[A.yo]:!0,[a.y0]:!0,[q.AT]:!0,[T.Bh]:!0,activity:!1,notification:!1,access_request:!1,customer:!1,temporary_password:!1,password:!1,slack_notification:!1,snapshot:!1,credit:!1,used_credit:!1,space_recover_pages:!1,user_metadata:!1,saml_config:!1,experiment:!1,education_domain:!1,education_email:!1,public_email_domain:!1,user_data_consent_permissions:!1,token:!1,apple_token:!1,google_token:!1,firebase_token:!1,trello_token:!1,asana_token:!1,confluence_token:!1,monday_token:!1,external_entity:!1,external_integration_app:!1,external_token:!1,evernote_token:!1,drive_token:!1,block_token:!1,bot_token:!1,integration_token:!1,subscription:!1,space_domain:!1,admin_api_log:!1,admin_api_op_log:!1,oauth_authorization_code:!1,mfa_settings:!1,device:!1,user_device:!1,[S.Dw]:!1,[le.t]:!1,[z.O]:!1,[g.H]:!1,[k.G]:!1,[w.l]:!1,[y.r]:!1,[_.r9]:!1,[h.Jd]:!1,[v.mz]:!1,[K.F]:!1,[C.Tu]:!1,[u.cv]:!1,[R.qV]:!1,[D.FM]:!1,[p.Xj]:!1,[G.fF]:!1,[Q.x]:!1,[ae.pm]:!1,[H.L]:!1,[$.L9]:!1,[ie.nt]:!1,[ee.nE]:!1,[ne.z]:!1,[te.u]:!1,[oe.Az]:!1,[Y.M]:!1,[l.b]:!1,[s.P]:!1,[de.bf]:!1,[c.t_]:!1,[d.J4]:!1,[X.ah]:!1,[I.bC]:!1,[P.X]:!1,[m.EK]:!1,[x.a]:!1,[Z.a]:!1,[j.h]:!1,[U.f1]:!1,[L.P]:!1,[F.wM]:!1,[V.O]:!1,[O.m]:!1,[E.b]:!1,[B.M]:!1,[N.a]:!1,[M.P9]:!1}},52989:(e,t,n)=>{n.d(t,{AI:()=>h,MZ:()=>v,qw:()=>b});n(57658);var o=n(53965),i=n(75330),r=n(73744),a=n(28314),s=n(77546),l=n(95802),c=n(44534),d=n(15723),u=n(4926),p=n(69784),m=n(50628),f=n(27724),g=n(24677);function h(e){const{environment:t,target:n,startX:o,startY:d,showSelectionRect:m,preventSelectStores:h,allowVerticalEdgeScroll:b,allowHorizontalEdgeScroll:y}=e,_=f.default.getDefaultContainerFromTarget(n);if(!_)return;if(o>=window.innerWidth-u.Z.state)return;if(d>=window.innerHeight-u.Z.state)return;const S=s.VW(n),w=s.xH(n),k=l.C.getMembersByDOMOrder({filter:e=>e.getContextSelectableContainer()===_}),I=()=>{p.default.state.isActive&&(g.Jy(),v({environment:t,currentX:p.default.state.currentX,currentY:p.default.state.currentY,toggle:a.yA().shift}))};S&&r.lj(S,"scroll",I),w&&r.lj(w,"scroll",I),p.default.setState({moved:!1,isActive:!0,startX:o,startY:d,currentX:o,currentY:d,currentRect:void 0,defaultContainer:_,startSelection:f.default.state.stores,startSelectables:k,verticalScrollerEl:S,horizontalScrollerEl:w,startScrollTop:S?S.scrollTop:0,startScrollLeft:w?w.scrollLeft:0,showSelectionRect:m,handleScroll:I,preventSelectStores:h,allowVerticalEdgeScroll:b,allowHorizontalEdgeScroll:y}),g.ZH(t),i.wG(),c.HM.clearSelection()}function v(e){const{environment:t}=e,n=p.default.state;if(n.isActive){const{currentX:i,currentY:r,verticalScrollerEl:a,horizontalScrollerEl:s,startScrollTop:l,startScrollLeft:c,preventSelectStores:u}=n;let f=n.startY;if(a){f-=a.scrollTop-l}let h=n.startX;if(s){h-=s.scrollLeft-c}const v={top:Math.min(f,r),bottom:Math.max(f,r),left:Math.min(h,i),right:Math.max(h,i)},b=m.Z.state.selectableRectMap,_=function(e){const t=new Map,n={root:!0};for(const o of e){const e=y(o)||n;t.get(e)||t.set(e,[]),t.get(e).push(o)}return Array.from(t.values())}(n.startSelectables.filter((e=>{const t=b.get(e),o=e.props.store;return e.props.canSelect&&t&&d.kK(v,t)&&u.indexOf(o)<0&&(!n.showSelectionRect||o.isTransclusionType()||!o.isInsideTransclusion())})));let S=[];const w=_.find((e=>e.length>1));if(w)S=w;else{const e=o.Z$(_);e&&(S=e)}let k=o.UI(S,(e=>e.props.store));if(e.toggle)for(const e of n.startSelection)o.q9(k,e)?k=o.zu(k,e):k.push(e);p.default.setState({...n,moved:!0,currentX:e.currentX,currentY:e.currentY,currentRect:v}),g.Z5({environment:t,stores:k})}}function b(e){const t=p.default.state;if(t.isActive){const{moved:n,verticalScrollerEl:o,horizontalScrollerEl:i,handleScroll:a}=t;n||g.ZH(e),o&&r.ZV(o,"scroll",a),i&&r.ZV(i,"scroll",a),p.default.setState({isActive:!1})}}function y(e){if(e)for(;;){if(!(e=e.getContextClosestSelectable()))return;if(e.props.canSelect)return e}}},79978:(e,t,n)=>{n.d(t,{Bl:()=>u,hE:()=>d,tG:()=>c});var o=n(80951),i=n(75134),r=n(9953),a=n(13447);function s(e){const{environment:t,store:n,propertyId:o,id:r,position:s,transaction:l}=e;let c;c="before"===s.type?{pointer:n.pointer,path:["properties",o],command:"addRelationBefore",args:{id:r,spaceId:n.getSpaceId(),before:s.before}}:{pointer:n.pointer,path:["properties",o],command:"addRelationAfter",args:{id:r,spaceId:n.getSpaceId(),after:s.after}},a.applyOperation({store:n,operation:c,transaction:l}),i.r({environment:t,store:n,relationPropertyId:o})}function l(e){const{environment:t,store:n,propertyId:o,id:r,transaction:s}=e;a.applyOperation({store:n,operation:{pointer:n.pointer,path:["properties",o],command:"removeRelation",args:{id:r,spaceId:n.getSpaceId()}},transaction:s}),i.r({environment:t,store:n,relationPropertyId:o})}function c(e){const{environment:t,store:n,propertyId:a,transaction:s,pointers:l}=e,c=(0,o.ow)(l);r.sW({store:n.getPropertiesStore(),data:{[a]:c},transaction:s}),i.r({environment:t,relationPropertyId:a,store:n})}function d(e){const{environment:t,sourceStore:n,destStore:o,propertyWithInverse:i,position:r,transaction:a}=e;s({environment:t,store:n,propertyId:i.property,id:o.id,position:r,transaction:a}),s({environment:t,store:o,propertyId:i.inverse,id:n.id,transaction:a,position:{type:"after"}})}function u(e){const{environment:t,sourceStore:n,destStore:o,propertyWithInverse:i,transaction:r}=e;l({environment:t,store:n,propertyId:i.property,id:o.id,transaction:r}),l({environment:t,store:o,propertyId:i.inverse,id:n.id,transaction:r})}},43008:(e,t,n)=>{n.d(t,{g:()=>l,x:()=>c});var o=n(95802),i=n(80444),r=n(6258),a=n(64951),s=n(24677);function l(e){const{mainEditorCurrentBlockStore:t}=i.default.state;if(t){const n=r.G.createChildStore(t,e.blockStore.pointer);a.Z.setState({...a.Z.state,originRect:e.originRect||o.C.getRectFromStore(e.blockStore),blockStore:n})}}function c(e){a.Z.reset(),s.ZH(e)}},52771:(e,t,n)=>{n.d(t,{$:()=>l,x:()=>c});var o=n(95802),i=n(80444),r=n(6258),a=n(82187),s=n(24677);function l(e){const{mainEditorCurrentBlockStore:t}=i.default.state;if(t){const n=r.G.createChildStore(t,e.blockStore.pointer);a.Z.setState({...a.Z.state,originRect:e.originRect||o.C.getRectFromStore(e.blockStore),clonedBlockStore:n,originalBlockStore:e.blockStore,renderDelete:e.renderDelete})}}function c(e){a.Z.reset(),s.ZH(e)}},52423:(e,t,n)=>{n.d(t,{AZ:()=>O,L0:()=>F,hv:()=>L,K9:()=>R,dA:()=>B,M7:()=>U,XT:()=>V,KX:()=>E,Yw:()=>D,qB:()=>Z});n(57658),n(52262),n(24506);var o=n(59730),i=n(606),r=n(67175),a=n(82798),s=n(53965),l=n(1898),c=n(16861),d=n(6258),u=n(70354),p=n(27724),m=n(24666),f=n(993),g=n(13447),h=n(73959),v=n(65663),b=n(54843);function y(e,t,n,o){const i=o.getClosestPageAndTransclusionReferenceAncestorIds(t),r=o.getClosestPageAndTransclusionReferenceAncestorIds(n);if(0===i.length||0===r.length)return[];const l=[];for(const c of s.jV(i,r)){const i=(0,a.TO)(o.getPathToBlock(c)),r=(0,a.TO)(S(e,i));l.push(..._(r,t,n))}return l.sort(((e,t)=>e.length-t.length)),l}function _(e,t,n){const o=[];let i=[];for(const r of function*(e,t){let n=!1;for(const o of function*(e){function t(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function*(){if(yield e,(!e.isNavigableBlock()||n)&&("transclusion_reference"!==e.getType()||o))for(const n of(0,b.y)(e))yield*t(n,!1,!1)}()}yield*t(e,!0,!0)}(e))o.id===t&&(n=!0),n&&(yield o)}(e,t))if(r.id!==t){if(i.length>0){if("transclusion_reference"===r.getType()){i=[];continue}i.push(r),r.id===n&&(o.push(i),i=[])}}else i=[r],t===n&&(o.push(i),i=[]);return o.sort(((e,t)=>e.length-t.length)),o}function S(e,t){(0,a.T)(t.length>0,"Path must not be empty"),(0,a.T)(e.id===t.shift(),"Path must start with root store id");let n=e;for(;t.length>0;){const e=(0,a.TO)(t.shift()),o=(0,b.y)(n).find((t=>t.id===e));if(!o)return;n=o}return n}var w=n(77282),k=n(28685);function I(e){const{store:t}=e;let n;(0,a.T)(t.useCrdt());const o=w.Z.getPageStoreForBlockStore(t);if(n=o?C({...e,pageStore:o,allowNonRenderedSingleStoreSelection:!1}):x(e),n&&(n.start.store!==n.end.store||n.start.index<n.end.index))return n}function C(e){var t,n;const{store:o,startTextInstanceId:i,startId:r,endTextInstanceId:l,endId:c,pageStore:d,allowNonRenderedSingleStoreSelection:u}=e,p=(0,a.TO)(w.Z.getPageTextInstanceTrackerForPage(d.pointer)),m=p.getBlockIdForTextInstanceItemId(i,r),f=p.getBlockIdForTextInstanceItemId(l,c);if(void 0===m||void 0===f)return;const g=y(d,m,f,(0,a.TO)(w.Z.getPageBlockTrackerForPage(d.pointer)));let h,v;const b=s.MR(g,(e=>(0,a.TO)(e.at(0))===o?-1:1));for(const s of b){const e=(0,a.TO)(s.at(0)),t=(0,a.TO)(s.at(-1));if(k.E.findEditableWithStore(e.getBlockTitleStore())&&k.E.findEditableWithStore(t.getBlockTitleStore())){h=e,v=t;break}}if((!h||!v)&&u&&b.length>0&&b[0].at(0)===b[0].at(-1)&&(h=(0,a.TO)(b[0].at(0)),v=(0,a.TO)(b[0].at(-1))),!h||!v)return;let _=(0,a.TO)(null===(t=h.getTextSliceTree())||void 0===t?void 0:t.findGraphemeIndexOfOpId(i,r)),S=(0,a.TO)(null===(n=v.getTextSliceTree())||void 0===n?void 0:n.findGraphemeIndexOfOpId(l,c));return _<0&&(_=-_-1),S<0?S=-S-1:S+=1,{start:{store:h.getBlockTitleStore(),index:_},end:{store:v.getBlockTitleStore(),index:S}}}function x(e){const{store:t,startTextInstanceId:n,startId:o,endTextInstanceId:i,endId:r}=e;(0,a.T)(t.useCrdt());const s=t.getSerializedTextClocksStore().getValue();if(!s||void 0===s[n]||void 0===s[i])return;const l=(0,a.TO)(t.getTextSliceTree());let c=l.findGraphemeIndexOfOpId(e.startTextInstanceId,e.startId);if(!c)return;let d=i===n&&r===o?c:l.findGraphemeIndexOfOpId(e.endTextInstanceId,e.endId);return d?(c<0&&(c=-c-1),d<0?d=-d-1:d+=1,{start:{store:t.getBlockTitleStore(),index:c},end:{store:t.getBlockTitleStore(),index:d}}):void 0}function T(e){const{store:t,textInstanceId:n,itemId:o,options:i}=e;(0,a.T)(t.useCrdt());const r=w.Z.getPageStoreForBlockStore(t);if(!r)return;const s=(0,a.TO)(w.Z.getPageTextInstanceTrackerForPage(r.pointer)).getBlockIdForTextInstanceItemId(n,o,i);if(!s)return;const l=y(r,s,s,(0,a.TO)(w.Z.getPageBlockTrackerForPage(r.pointer)));if(l.length>0){const e=l[0];return(0,a.T)(1===e.length),e[0]}}function M(e){const{store:t,transaction:n,operation:o}=e,i=function(e){const{store:t,textInstanceId:n,id:o}=e;(0,a.T)(t.useCrdt());const i=w.Z.getPageStoreForBlockStore(t),r=i?C({store:t,startTextInstanceId:n,startId:o,endTextInstanceId:n,endId:o,pageStore:i,allowNonRenderedSingleStoreSelection:!0}):x({store:t,startTextInstanceId:n,startId:o,endTextInstanceId:n,endId:o});return null==r?void 0:r.end}({store:t,textInstanceId:o.args.textInstanceId,id:o.args.originId});if(!i)return"err_no_store_position";const r=(0,a.TO)((0,h.sQ)(i.store)),s=(0,a.TO)(r.getTextSliceTree()),{operations:l,invertedOperations:c}=s.getOperationsForInsertTextValueAfterOriginId(o.args.textInstanceId,o.args.originId,o.args.textValue);return v.F({transaction:n,store:r,crdtOperations:l,invertedOperations:c}),"success"}function P(e){const{environment:t,editorMode:n,store:o,transaction:i,operation:r}=e;switch(r.command){case"invertedInsertText":return function(e){const{environment:t,editorMode:n,store:o,transaction:i,operation:r}=e,a=I({store:o,startTextInstanceId:r.args.textInstanceId,startId:r.args.startId,endTextInstanceId:r.args.textInstanceId,endId:r.args.endId});return a?(f.pz({environment:t,editorMode:n,multiSelection:a,transaction:i}),"success"):"err_no_multiselection"}({environment:t,editorMode:n,store:o,transaction:i,operation:r});case"invertedDeleteText":return M({environment:t,store:o,transaction:i,operation:r});case"invertedMoveTextSlice":return function(e){const{store:t,transaction:n,operation:o}=e,i=T({store:t,textInstanceId:o.args.textInstanceId,itemId:o.args.textSliceStartItemId,options:{type:"start"}});if(!i)return"err_no_source_block_store";const r=T({store:t,textInstanceId:o.args.targetTextInstanceId,itemId:o.args.targetTextSliceEndItemId,options:{type:"end"}});if(!r)return"err_no_target_block_store";const s=(0,a.TO)(i.getTextSliceTree()),l=(0,a.TO)(s.findTextSliceTreeBeforeTextSliceStartingWithItemId(o.args.textInstanceId,o.args.textSliceStartItemId)).getTextSlice();return g.applyCrdtTextOperation({transaction:n,store:i,operation:{command:"moveTextSlice",path:[],pointer:i.pointer,args:{textInstanceId:o.args.textInstanceId,textSliceStartItemId:o.args.textSliceStartItemId,targetBlockId:r.id,targetTextInstanceId:o.args.targetTextInstanceId,targetTextSliceEndItemId:o.args.targetTextSliceEndItemId}},invertedOperation:{command:"invertedMoveTextSlice",path:[],pointer:i.pointer,args:{textInstanceId:o.args.textInstanceId,textSliceStartItemId:o.args.textSliceStartItemId,targetTextInstanceId:l.textInstanceId,targetTextSliceEndItemId:l.getEndItem().id}}}),"success"}({environment:t,store:o,transaction:i,operation:r});case"invertedAddAnnotation":return function(e){const{environment:t,store:n,transaction:o,operation:i}=e,r=I({store:n,startTextInstanceId:i.args.startTextInstanceId,startId:i.args.startId,endTextInstanceId:i.args.endTextInstanceId,endId:i.args.endId});return r?(f.QX({environment:t,multiSelection:r,annotationTypeOrKey:i.args.annotationKey,transaction:o}),"success"):"err_no_multiselection"}({environment:t,store:o,transaction:i,operation:r});case"invertedRemoveAnnotation":return function(e){const{environment:t,store:n,transaction:o,operation:i}=e,r=I({store:n,startTextInstanceId:i.args.startTextInstanceId,startId:i.args.startId,endTextInstanceId:i.args.endTextInstanceId,endId:i.args.endId});return r?(f.KM({environment:t,multiSelection:r,annotation:i.args.annotation,transaction:o}),"success"):"err_no_multiselection"}({environment:t,store:o,transaction:i,operation:r});default:(0,l.t1)(r)}}var A=n(24161);function R(e){const t=u.default.state,{undoStack:n,invertedTextOperationIdMapper:o}=t,i=e.currentTime??Date.now(),a=e.transaction.getUserActionForAnalyticsPurposesOnly()??"unknown";if("string"==typeof e.undoCheckpoint){const t=n.find((t=>t.namedRevisionId===e.undoCheckpoint));t?(t.transactions.push(e.transaction),t.userActions.push(a)):n.push({userActions:[a],transactions:[e.transaction],timestamp:i,namedRevisionId:e.undoCheckpoint,undoRedoCount:0})}else{const t=n.at(-1);!e.undoCheckpoint&&t&&!t.namedRevisionId&&i-t.timestamp<=u.groupIntervalMs&&0===t.undoRedoCount&&t.transactions[0].isLocal===e.transaction.isLocal&&t.transactions[0].operations.some(r.Qf)===e.transaction.operations.some(r.Qf)?(t.transactions.push(e.transaction),t.userActions.push(a)):n.push({userActions:[a],transactions:[e.transaction],timestamp:i,undoRedoCount:0})}u.default.setState({undoStack:n,redoStack:[],invertedTextOperationIdMapper:o}),u.default.emit()}function D(e,t){const n=u.default.state,{invertedTextOperationIdMapper:o}=n,{undoStack:i,redoStack:r}=q(n),a=i.pop();if(a){const n=N({environment:e,revision:a,preventSelectText:t,invertedTextOperationIdMapper:o});r.push(n),u.default.setState({undoStack:i,redoStack:r,invertedTextOperationIdMapper:o})}}function E(e,t){const n=u.default.state,{invertedTextOperationIdMapper:o}=n,{undoStack:i,redoStack:r}=q(n),a=r.pop();if(a){const n=N({environment:e,revision:a,preventSelectText:t,invertedTextOperationIdMapper:o});i.push(n),u.default.setState({undoStack:i,redoStack:r,invertedTextOperationIdMapper:o})}}function B(){u.default.reset()}function F(){return Boolean(V())}function O(){return Boolean(U())}function Z(e){const t=u.default.state,{environment:n,namedRevisionId:o}=e,{invertedTextOperationIdMapper:i}=t,{undoStack:r,redoStack:a}=q(t),s=r.findIndex((e=>e.namedRevisionId===o));if(s<0)return;const l=N({environment:n,revision:r.splice(s,1)[0],invertedTextOperationIdMapper:i});a.push(l),u.default.setState({undoStack:r,redoStack:a,invertedTextOperationIdMapper:i})}function V(){const e=u.default.state.undoStack.at(-1);return e?j(e):void 0}function U(){const e=u.default.state.redoStack.at(-1);return e?j(e):void 0}function L(e){return u.default.state.undoStack.some((t=>t.namedRevisionId===e))}function j(e){return{getUserActions:()=>e.userActions.slice(),getFirstStore(){var t;return null==e||null===(t=e.transactions)||void 0===t||null===(t=t[0].stores)||void 0===t?void 0:t[0]}}}function N(e){const{environment:t,revision:n,invertedTextOperationIdMapper:o,preventSelectText:r}=e;let{transactions:u}=n;c.Z.provider&&console.log("Undoing/redoing transactions with user actions",n.userActions.join(","));const{performResult:f}=g.createAndCommit({userAction:"revisionActions.performUndoRedoRevisionTransaction",environment:t,canUndo:!1,perform:e=>{u=s.d9(u),u.reverse();for(const n of u){const u=s.d9(n.invertedOperations);u.reverse(),e.copyDebugTagsFrom(n);for(const r of u)if((0,A.v)(r)){const s=n.stores.filter((e=>(0,i.qo)(e.pointer,r.pointer)&&e instanceof d.G)),u=s.find((e=>Boolean(e.uiLocation.uiParent)))??s.at(0);if(!u)continue;const p=e.operations.length,m=o.getInvertedTextOperationWithMaybeRemappedIds(r),f=P({environment:t,editorMode:"default",store:u,transaction:e,operation:m});"success"!==f&&c.Z.logInvertedTextOperationError({transaction:n,invertedOperation:r,maybeRemappedInvertedOperation:m,errorCode:f});const g=e.operations.length;if("invertedDeleteText"===m.command&&g>p){const t=z(e.operations.slice(p,g));o.remapIdsForReinsertedText(m,(0,a.Fb)(t,(0,l.AO)((e=>"insertText"===e.command?{true:e}:{false:e}))))}}else{const t=n.stores.find((e=>(0,i.qo)(e.pointer,r.pointer)));if(!t)continue;g.applyOperation({transaction:e,store:t,operation:r})}n.beforeSelection&&p.default.setState({...p.default.state,...n.beforeSelection}),n.beforeTextSelection&&!r&&m.default.setState(n.beforeTextSelection)}return e}});return{...n,transactions:[f],undoRedoCount:n.undoRedoCount+1}}function z(e){for(const t of e)if("insertText"===t.command)return t;throw new o.p8("Operations should conatin an InsertTextOperation")}function q(e){const{undoStack:t,redoStack:n}=e;return{undoStack:t.slice(),redoStack:n.slice()}}},56863:(e,t,n)=>{n.d(t,{w:()=>r});var o=n(49557),i=n(4935);function r(){o.Z.state.isActive&&(i.Z.setState({...i.Z.state,open:!1}),o.Z.setState({...o.Z.state,isActive:!1,isAnimatingClosed:!0}))}},75754:(e,t,n)=>{n.d(t,{_c:()=>h,qV:()=>v,sC:()=>y});n(57658);var o=n(49085),i=n(15145),r=n(21202),a=n(18265),s=n(83105),l=n(84210),c=n(73203),d=n(46735),u=n(6258),p=n(36610),m=n(13447),f=n(39865),g=n(8055);function h(e){const{environment:t,store:n,redirect:o,scrollToBlockId:r,collectionViewId:c,openInNew:u,discussionId:p,showMoveTo:m,saveParent:f,visitType:h,templateGalleryItem:v,projectManagementLaunch:b,pageVisitSource:y,openInSidePeek:_,queryId:S,callback:w,peekMode:k}=e,I=(0,l.Hu)({store:n,fullyQualified:!1,scrollToBlockId:r,collectionViewId:c,discussionId:p,showMoveTo:m,saveParent:f,templateGalleryItem:v,projectManagementLaunch:b,openInSidePeek:_,pageVisitSource:y,peekMode:k});n.isNavigableBlock()&&d.Z.recordVisit({id:n.id,systemBlockType:n.getSystemBlockTypeStore().getValue(),type:void 0!==h?h:s.vu.Default,currentUserId:t.currentUser.id}),g.c4({environment:t,url:y?a.SK(I,{[i.$X]:y,[i.Mf]:u?S:void 0}):I,redirect:o,openInNew:u,queryId:S,callback:w})}function v(e){const{environment:t,targetId:n}=e;if(!(0,c.r)())return;const o=b.state;if(void 0===o)return;if(n!==o.pageId)return;const i=new u.G(t,{id:n,table:r.iU});if("page"!==i.getType())return;const a=i.getContentStores(),s=1===a.length?a[0]:void 0,l=s&&s.isEmptyEditableBlock();i.isEmptyTitle()&&(i.isEmptyPage()||l)&&m.createAndCommit({userAction:"blockNavigationActions.maybeGarbageCollectEmptyPage",environment:t,perform:e=>{f.y8({environment:t,blocks:[i],transaction:e}),e.postSubmitCallbacks.push((e=>{e||p.dh(t,{analyticsName:"delete",from:"navigation_actions",block_id:i.id,block_type:"page"})}))}})}const b=o.default.createValue(void 0);function y(e,t){b.setState({pageId:t.id,hasBeenFocused:!1})}},12714:(e,t,n)=>{n.d(t,{D:()=>a});var o=n(18265),i=n(95477),r=n(47839);function a(e){const{environment:t,targetSelf:n}=e;let a=e.url;"/"===a[0]&&(a=i.default.domainBaseUrl+a);const s=o.yn(a);if(s)if(t.device.isElectron)r.openExternalUrl(s);else if(t.mobileNative)s.startsWith("http:")||s.startsWith("https:")?t.mobileNative.openInAppBrowser(s):window.location.href=s;else{const t=document.createElement("a");t.href=e.url,t.classList.add("notion-link"),n||t.setAttribute("target","_blank"),t.setAttribute("rel","noopener noreferrer"),document.body.appendChild(t),t.click(),t.remove()}}},32953:(e,t,n)=>{n.d(t,{Hu:()=>J,LU:()=>K,M3:()=>$,Pg:()=>q,UV:()=>Q,Vz:()=>Y,jC:()=>W,rM:()=>H});var o=n(15157),i=n(53965),r=n(75330),a=n(18821),s=n(95306),l=n(9080),c=n(50770),d=n(75419),u=n(16746),p=n(74948),m=n(36896),f=n(44534),g=n(80444),h=n(16772),v=n(89256),b=n(17903),y=n(19671),_=n(13023),S=n(98452),w=n(99332),k=n(24612),I=n(55320),C=n(86486),x=n(27724),T=n(52258),M=n(66708),P=n(77503),A=n(62820),R=n(54564),D=n(6404),E=n(51365),B=n(47839),F=n(54604),O=n(17659),Z=n(43008),V=n(52771),U=n(52423),L=n(24677),j=n(64964),N=n(98104),z=n(53471);function q(e){M.Z.reset(),P.Z.reset(),T.Z.reset(),v.Z.reset(),E.xv({environment:e,blockPropertyValueOverlayStore:y.Z}),z.W8(),j.C1()}function W(e,t){S.Z.reset(),w.Z.reset(),k.Z.reset(),E.xv({environment:e,blockPropertyValueOverlayStore:_.Z})}function H(e){var t;B.inPageSearch.stop(),L.ZH(e),N.ZH(e),r.wG(),f.HM.clearSelection(),L.Fp({pivot:void 0}),D.xv(),C.default.reset(),U.dA(),R.LZ(),V.x(e),Z.x(e),h.default.resetStore({environment:e}),F.xv(),null===(t=e.NativeMobileActionBarStore)||void 0===t||t.clear(!1)}function K(e){if(m.Z.reset(),I.default.reset(),A.Z.state.open&&(A.Z.reset(),e.device.isMobile&&p.close()),u.Z.isPeekDismissableState()){if("inbox"===u.Z.state.contentType)"overlay_and_pinning"===(0,c.me)(e)&&O.qQ({environment:e,open:!1});else d.TN()}l.Z.state.open&&s.UZ(e),a.Cd(e)}function G(){const{mainEditorCurrentBlockStore:e}=g.default.state;let t=0,n=[];if(e){const{stores:e}=x.default.state;n=i.oA(e.map((e=>e.id))),t=b.Z.state.scrollTop}return{scrollTop:t,blockIds:n}}function $(e){let{historyId:t,currentUserId:n}=e;const i=o.Z.get({userId:n,key:t});return i?i.index:0}function Q(e){let{historyId:t,historyIndex:n,currentUserId:i}=e;const r={...G(),index:n};o.Z.set({userId:i,key:t,value:r})}function Y(e){let{historyId:t,currentUserId:n}=e;const i=o.Z.get({userId:n,key:t});if(!i)return;const r={...G(),index:i.index};o.Z.set({userId:n,key:t,value:r})}function J(e){let{RouterStore:t,currentUserId:n}=e;const i=t.state.id;o.Z.remove({userId:n,key:i})}},31120:(e,t,n)=>{n.d(t,{Rd:()=>kt,fE:()=>dt,dH:()=>tt,FA:()=>Mt,xp:()=>gt,E4:()=>pt,LW:()=>ft,ST:()=>rt,Z1:()=>Rt,WC:()=>at,wo:()=>St,OO:()=>bt,kd:()=>vt,hY:()=>Ct,o9:()=>Xe,HR:()=>ot,r$:()=>_t,uO:()=>it,KR:()=>yt,td:()=>st,D_:()=>et,nN:()=>ct,rH:()=>ut,OP:()=>Tt,JW:()=>xt,YU:()=>mt,cQ:()=>It,Z_:()=>lt,wN:()=>ht,AL:()=>wt,yD:()=>nt,CV:()=>Dt,HB:()=>Ye,pN:()=>Je});n(82801),n(21703),n(57658);var o=n(15145),i=n(50475),r=n(68626),a=n(97213),s=n(70096),l=n(45953),c=n(99405),d=n(89101),u=n(21202),p=n(33709),m=n(23867),f=n(77858),g=n(19889),h=n(66079),v=n(9852),b=n(54153),y=n(94826),_=n(9291),S=n(57347),w=n(7032),k=n(15828),I=n(1898),C=n(18265),x=n(63811),T=n(12847),M=n(72899),P=n(91851),A=n(59183),R=n(95477),D=n(28020),E=n(70764),B=n(12955),F=n(21969),O=n(83105),Z=n(15070),V=n(9844),U=n(80444),L=n(49065);var j=n(33929),N=n(98165),z=n(18514),q=n(48779),W=n(55081),H=n(10929),K=n(75538),G=n(30806),$=n(94841),Q=n(74948),Y=n(38676),J=n(36391),X=n(51),ee=n(19511),te=n(77080),ne=n(30874),oe=n(46735),ie=n(33759),re=n(89403),ae=n(49085);class se extends ae.default{getInitialState(){return{args:void 0}}}const le=new se;var ce=n(42330),de=n(93220),ue=n(72014),pe=n(30539),me=n(88923),fe=n(89523),ge=n(6258),he=n(55320),ve=n(27724),be=n(92083),ye=n(83941),_e=n(29949),Se=n(57549),we=n(32441),ke=n(19719),Ie=n(51787),Ce=n(54642),xe=n(35793),Te=n(47307),Me=n(91584),Pe=n(47839),Ae=n(3297),Re=n(94273),De=n(92625),Ee=n(97977),Be=n(36110),Fe=n(73661),Oe=n(25320),Ze=n(87420),Ve=n(31304),Ue=n(40277),Le=n(4408),je=n(87531),Ne=n(29974),ze=n(61202),qe=n(75754),We=n(32953),He=n(21862),Ke=n(65729),Ge=n(8055),$e=n(1357);const Qe=(0,_.defineMessages)({errorSamlMessage:{defaultMessage:"Could not log you in.",id:"router.loginWithSamlError.message"},appleErrorMessage:{id:"loginActions.loggingInWithApple.errorMessage",defaultMessage:"Something went wrong while trying to log in with Apple."},authenticating:{id:"externalIntegrationAuthActions.authenticationWithIntegration.loadingMessage",defaultMessage:"Authorizing with integrationâ€¦"},joinedTeamMessage:{id:"joinedTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},backToContent:{id:"router.joinSpaceError.acceptLabel.backToContent",defaultMessage:"Back to my content"},goBack:{id:"router.joinSpaceError.acceptLabel.goBack",defaultMessage:"Go back"},thirdPartyDebugPrefix:{id:"router.debugMessage.thirdPartyError",defaultMessage:"Error from third party"}});function Ye(e,t){if(B.canSetCookie(e))try{const n=new URL(t),o=n.searchParams.get("ps_partner_key"),i=n.searchParams.get("ps_xid");if(i&&o){const t={partnerKey:window.atob(o),clickId:i};return B.setS2STrackingCookie(e,t),void we.Es({partner_stack_key:t.partnerKey})}const r=n.searchParams.get("gspk");if(r){const t=window.atob(r);return B.setPartnerStackCookie(e,t),void we.Es({partner_stack_key:t})}}catch(n){}}function Je(e,t){if(t)try{const{experimentGroups:n,inviteeEmail:o,inviterName:i}=JSON.parse(window.atob(t));Ie.WC(e,{invitee_email:o,invitation_experiment_groups:n}),re.Z.setState({...re.Z.state,inviteeEmail:o,inviterName:i}),o&&ie.Z.setState({...ie.Z.state,email:o})}catch(n){}}async function Xe(e,t,n,o){if(!e.currentUser.id)return void Ge.c4({environment:e,url:d._j.root,redirect:!0});let i;if(t.spaceId)i=t.spaceId;else{const{spaceId:t}=await Re.Ie(e);i=t}if(xe.Uz({nextRoute:{...t,spaceId:i},currentRoute:n,environment:e,query:""}),"search"===t.tab){if(!he.default.state.sessionId){const t=(0,w.ZP)();he.default.update((e=>({...e,open:!1,openAsPage:!0,openedTimeMs:Date.now(),sessionId:t}))),Ie.wF(e,{from:"pop"===o?"mobile-back-navigation":"mobile-bottom-bar",searchSessionId:t})}}else"updates"===t.tab&&ke.Up({environment:e,from:"pop"===o?"mobile-back-navigation":"mobile-bottom-bar"})}async function et(e,t,n){if(!e.currentUser.id)return;xe.Uz({nextRoute:t,currentRoute:n,environment:e,query:""});const o=e.device.isElectron&&!(await Pe.quickSearchVisibilityState.isVisible());je.UT({environment:e,analyticsFrom:"quick-search",renderAsPage:!0,isQuickSearch:!0,doNotTrackOpenSearchEvent:o})}function tt(e,t,n){e.currentUser.id&&xe.Uz({nextRoute:t,currentRoute:n,environment:e,query:""})}function nt(e,t,n){e.currentUser.id&&t.spaceId&&K.default.state.isOnboarding?xe.Uz({nextRoute:t,currentRoute:n,environment:e,query:""}):Ge.c4({environment:e,url:d._j.root,redirect:!0})}async function ot(e,t){if(!e.currentUser.id)return void Ge.c4({environment:e,url:d._j.root,redirect:!0});const{id:n,type:o,from:i}=t;let r,a;if(t.spaceId)r=t.spaceId;else{const{spaceId:t}=await Re.Ie(e);r=t}if(r){const{currentUserSettingsStore:t}=U.default.state,n=new ge.r9(e,{table:h.dx,id:e.currentUser.id});if(await n.load(),void 0===U.default.state.currentSpaceStore||U.default.state.currentSpaceStore.id!==r)try{await Ne.j({environment:e,userRootStore:n,spaceId:r,navigate:!0,analyticsFrom:"redirect",userSettingsStore:t})}catch(s){return void Te.showMessage({message:(0,S.t)(s).message,onAccept:()=>{Ge.op(e)}})}}else Ge.c4({environment:e,url:d._j.root,redirect:!0}),await U.default.waitUntil((()=>void 0!==U.default.state.currentSpaceStore&&void 0!==U.default.state.currentSpaceViewStore&&void 0!==U.default.state.currentUserRootStore));if(o){if(!(0,x.Gu)(T.literals(...ce.o1),o)){const e=o;switch(e){case"page":case"team":n&&(a={type:e,spaceId:r,id:n});break;case"space":n&&(a={type:e,id:n});break;case"space-private-pages":a={type:e,spaceId:r}}}}Q.quickAddPage({environment:e,from:i||"route",redirect:!0,quickAddParentOverride:a})}async function it(e){if(e.currentUser.isLoggedIn()){await W.zJ(e)&&await W.yH(e)}else{const t=K.default.state,n=b.Z.get(H.WX);t.isOnboarding||n?Ge.c4({environment:e,url:d._j.signup}):Ge.c4({environment:e,url:d._j.login})}}async function rt(e,t){const{code:n,frontPathName:o}=t;if(!n)return void Ge.c4({environment:e,url:d._j.signup});"fail"===(await Ee.requestLoginWithGoogleOneTap({environment:e,store:ie.Z,idToken:n,frontPathName:o})).status&&Ge.c4({environment:e,url:d._j.signup})}function at(e){e.currentUser.isLoggedIn()||Ge.c4({environment:e,url:d._j.login})}function st(e,t,n){var o;if(e.device.isMobile)return;const r=me.default.state;let a,l,c=!1,d=!1;if("page"===t.name&&t.peekViewBlockId){const{mainEditorCurrentBlockStore:e}=U.default.state;if(e){const n=ge.G.createChildStore(e,{table:u.iU,id:t.peekViewBlockId});c=Boolean(t.showMoveTo),d=Boolean(t.saveParent),a=n;const o="page"===t.name&&t.peekMode?t.peekMode:void 0;l=(0,me.getPeekModeFromUrlParam)(o)}}else if("chat"===t.name&&t.peekViewBlockId){c=!1,d=!1,a=new ge.G(e,{table:u.iU,id:t.peekViewBlockId}),l=s.R}if(!(0,i.u7)(null===(o=a)||void 0===o?void 0:o.getSystemBlockTypeStore().getValue())){if(a&&(!r.open||a.id!==r.target.id||l!==r.mode)){var p,m;r.open&&Fe.P(r.target,e,ue.jx);const t=ue.jx.getCurrentPageVisitId();ue.jx.initializeNewPageVisitId();const o=ve.default.cloneState(),i=A.Z.cloneState(),u=ee.Z.cloneState(),f=e.currentUser.id;We.jC(e,r.mode),We.LU(e),We.rM(e),we.PB(e,{page_id:a.id,collection_id:a.getAssociatedCollectionId()??(null===(p=a.getCollectionViewCollectionStore())||void 0===p?void 0:p.id),team_id:null===(m=(0,N.VP)(a))||void 0===m?void 0:m.id,is_peek:!0,peek_mode:l,type:"page",query:n,page_visit_id:ue.jx.getCurrentPageVisitId(),previous_page_visit_id:t});const g=new ge.G(e,a.pointer),h=new pe.Z,b=new fe.Z,y=new de.Z;Ze.bA(e,{mode:l??s.l,target:g,pageVisitStore:h,presenceStore:b,showMoveTo:c,saveParent:d,loadingContainerStore:y,savedSelectionStoreState:o,savedTableSelectionStoreState:i,savedCollectionViewSelectionStoreState:u,savedSidebarExpandedStoreState:Y.sidebarExpandedStore.state}),Ve._({userId:f,rootStore:g,presenceStore:b,environment:e,pageVisitIdStore:ue.jx}),Oe.UX(e,{block:g,pageVisitStore:h,timestamp:Date.now(),fromPageRefresh:(0,v.QG)()}),oe.Z.recordVisit({id:a.id,systemBlockType:a.getSystemBlockTypeStore().getValue(),type:O.vu.Default,currentUserId:f})}r.open&&!a&&(Ze.ME(),Ve.E(r.presenceStore,e,ue.jx,r.target),We.jC(e,r.mode))}}function lt(e,t){if(e.device.isMobile)return;const{mainEditorCurrentBlockStore:n}=U.default.state;if(n)if("page"===t.name&&t.templateGalleryItem){if("closed"===_e.Z.state.status){const e=t.pageVisitSource===o.tY.PersonalHomeTileTemplates.toString()?"home_tile_templates":"direct_link";_e.Z.open({analyticsFrom:e,cloneTo:"destination_picker"})}}else"closed"!==_e.Z.state.status&&_e.Z.setState({..._e.Z.state,status:"closed"})}async function ct(e,t,n){const i=t.currentUser.isLoggedIn(),{RouterStore:a,device:s}=t,l=s.isMobileNative&&s.isIOS,c=a.state.route,d=(e,t)=>{l&&"root"!==a.state.route.name?r.log({level:"warning",from:"routerActions",type:"handleRootRedirect",data:{message:`Prevented ${e} as route has since changed to "${a.state.route.name}"]. Initial route at the start of handleRootRedirect was "${c.name}"}`}}):(l&&r.log({level:"info",from:"routerActions",type:"handleRootRedirect",data:{message:`Redirecting for ${e} as route is still root. Initial route at the start of handleRootRedirect was "${c.name}"}`}}),t())};if(i){l&&r.log({level:"info",from:"routerActions",type:"handleRootRedirect",data:{message:"Called handleRootRedirect"}});const e=await(0,q.iX)({environment:t,disableRedirectUrl:!1}),{firstSpaceView:a,lastVisitedSpaceView:s,forkPageBlockId:c,publicAccessPageId:p,oauthAuthorizationParams:m,userRootStore:g,redirectUrl:h,userSettingsStore:v,userStore:y,isPersonalHomeRedirect:_}=e;_&&(0,G.$X)({environment:t,from:"on_app_start_page"}),await te.default.waitUntil((()=>te.default.state.isLoaded));await W.zJ(t,y)&&await W.yH(t);const S=K.default.state,w=t.currentUser.id,k=b.Z.get(H.WX);if(k&&i)return void(await It(t,k));if(m&&a&&(e.onboardingCompleted||H.BB(S))){const{responseType:e,redirectUri:n,integrationId:o,state:i,owner:r,userId:a,spaceId:s}=m;return void Be.g({environment:t,responseType:e,redirectUri:n,integrationId:o,state:i,owner:r,userId:a,spaceId:s})}const I=Ke.A(void 0);Ke.j({currentUserId:void 0,params:void 0});const x=(null==n?void 0:n.templateGalleryItem)||(null==I?void 0:I.tg),T=(null==n?void 0:n.projectManagementLaunch)||Boolean(null==I?void 0:I.pjm);if(S.isOnboarding)if(H.BB(S)){if(S.spaceViewId){const e=new ge.V9(t,{table:f.zU,id:S.spaceViewId});"workspace_setup"===S.stage?P.Xi(t,{spaceViewStore:e}):await Ne.y3({environment:t,spaceViewStore:e,userSettingsStore:v,userRootStore:g,templateGalleryItem:null==n?void 0:n.templateGalleryItem,projectManagementLaunch:null==n?void 0:n.projectManagementLaunch,pageVisitSource:o.tY.Onboarding,navigationType:"joiningOrCreatingSpace"})}}else Ge.T4(t);else if(m&&e.onboardingCompleted){const{responseType:e,integrationId:n,redirectUri:o,state:i,owner:r,userId:a,spaceId:s}=m;Be.g({environment:t,responseType:e,integrationId:n,redirectUri:o,state:i,owner:r,userId:a,spaceId:s})}else if(p&&e.onboardingCompleted){Ue.Hr({currentUserId:w,blockId:void 0});const e=ge.G.createChildStore(g,{table:u.iU,id:p});await e.load(),qe._c({environment:t,store:e,pageVisitSource:o.tY.Direct})}else if(a&&e.onboardingCompleted){const n=h;if(t.device.isMobile&&!e.mobileOnboardingCompleted)return void(await W.I1(t,{type:"mobile-onboarding",redirectUrl:h}));if(c){Ae.nM({currentUserId:w,blockId:void 0});const e=ge.G.createChildStore(g,{table:u.iU,id:c});await e.load(),await D.wU(g);const n=D.o(g);if(1===n.length){const o=n[0],i=o.getSpaceStore();if(!i)return;return void Ae.DK({environment:t,store:e,spaceStore:i,spaceViewStore:o,isPrivate:!0,context:"signin_after_duplicate"})}await te.default.waitUntilStatsigReady();if(!(0,ye.M)({disableExposureLogging:!0}))return void qe._c({environment:t,store:e,pageVisitSource:o.tY.Duplicate})}if(n){let e=n;(T||x)&&(e=C.SK(e,{tg:x,pjm:T})),d("redirectUrl",(()=>{Ge.c4({environment:t,url:e,redirect:!0})}))}else s?d("lastVisitedSpaceView",(()=>{Ne.y3({environment:t,spaceViewStore:s,userRootStore:g,userSettingsStore:v,templateGalleryItem:x,projectManagementLaunch:T,pageVisitSource:o.tY.Login,navigationType:"switchingToOrLoadingSpace"})})):(t.device.isMobileNative&&r.log({level:"info",from:"routerActions",type:"SpaceSwitchingDebug",data:{message:"navigateToFirstSpace because handleRootRedirect"}}),d("spaceActions.navigateToFirstSpace",(()=>{Ne.L5({environment:t,userRootStore:g,userSettingsStore:v,templateGalleryItem:x,projectManagementLaunch:T,pageVisitSource:o.tY.Login})})))}else await W.I1(t,{type:"new-user",redirectUrl:h})}}async function dt(e,t){const{callbackType:n,encryptedToken:o,encryptedNonce:i,code:r,error:a,encryptedUserObject:s,webBrowserDeviceId:l}=e;if("native"===n&&!t.device.isNative)return void Ge.RX({url:window.location.href,environment:t});if("user_cancelled_authorize"===a)return ie.Z.setState({...ie.Z.state,loginType:"email"}),void Ge.c4({environment:t,url:d._j.login});if(a||!r||!o||!i){const e=j.default.formatMessage(Qe.appleErrorMessage);return ie.Z.setState({...ie.Z.state,alert:e}),void Ge.c4({environment:t,url:d._j.login})}const c=await Ee.loginWithAppleAuth({environment:t,encryptedToken:o,encryptedNonce:i,code:r,encryptedUserObject:s,webBrowserDeviceId:l});c&&(ie.Z.setState({...ie.Z.state,alert:c}),Ge.c4({url:d._j.login,environment:t}))}async function ut(e,t){let n;e.userId?await Ee.loginSamlUser({environment:t,userId:e.userId,isNewSignup:e.isNewSignup||!1,previousUserId:e.previousUserId}):n=e.token&&e.csrfState?await Ee.loginSamlUserWithToken({environment:t,csrfState:e.csrfState,token:e.token,isNewSignup:e.isNewSignup||!1}):e.error||j.default.formatMessage(Qe.errorSamlMessage),n&&(ie.Z.setState({...ie.Z.state,alert:n}),Ge.c4({environment:t,url:d._j.login}))}async function pt(e,t){const{callbackType:n,encryptedToken:o,code:i,error:r,webBrowserDeviceId:a}=e;if("native"===n&&!t.device.isNative)return void Ge.RX({url:window.location.href,environment:t});if("access_denied"===r&&ie.Z.setState({...ie.Z.state,loginType:"email"}),r||!i||!o)return ie.Z.setState({...ie.Z.state,alert:r}),void Ge.c4({environment:t,url:d._j.login});const s=await Ee.loginWithGoogleAuth({environment:t,encryptedToken:o,code:i,callbackType:"native"===n||"nativeredirect"===n?n:void 0,webBrowserDeviceId:a});s&&(ie.Z.setState({...ie.Z.state,alert:s}),Ge.c4({url:d._j.login,environment:t}))}async function mt(e){const{route:t,environment:n}=e;"legacy"===t.type?await async function(e){const{route:{code:t,state:n},environment:o}=e;let i;if(t&&n){const e=await Ce.authWithSlack(o,{code:t,encryptedState:n});"failed"===e.type&&(i=e.error.message)}else i="Something went wrong.";i&&Te.deprecatedShowErrorMessage(i);const{url:r}=Re.Vr(o);Ge.c4({url:r||d._j.root,environment:o})}({environment:n,route:t}):"new"===t.type?await async function(e){const{route:{error:t},environment:n}=e;if(t){const e=j.default.formatMessage((0,E.mO)(t),{value:t});Te.showErrorMessage(e)}else await ze.pJ({environment:n});const{url:o}=Re.Vr(n);Ge.c4({url:o||d._j.root,environment:n})}({environment:n,route:t}):(0,I.t1)(t)}function ft(e,t){const{code:n,error:o}=e;!o&&n&&Me.O$(t,n);const{url:i}=Re.Vr(t);Ge.c4({url:i||d._j.root,environment:t})}async function gt(e){const{route:t,environment:n}=e;let o=t.error?t.errorDescription||j.default.formatMessage((0,E.mO)(t.error),{value:t.error}):void 0;try{if(!t.notionState)throw new Error("No notionState.");const e=JSON.parse(decodeURIComponent(t.notionState));await ze.pJ({environment:n}),await ze.FD({environment:n,notionState:e})}catch(i){o||(o="An unknown error occurred.")}o&&Te.deprecatedShowErrorMessage(o),Ge.iy(n)}async function ht(e){const{route:t,environment:n,integrationId:o,from:i,options:r}=e;let a=t.error?t.errorDescription||j.default.formatMessage((0,E.mO)(t.error),{value:t.error}):void 0;try{if(!t.state)throw new Error("No state provided.");if(!t.code)throw new Error("No code provided.");De.j({message:Qe.authenticating});const e=await Ce.authWithExternalIntegration(n,{code:t.code,state:t.state,...t.name===c.AY.datadogAuthCallback?{accountName:t.organizationName,accountId:t.organizationId,accountDomain:t.site}:void 0});if(De.x(),"failed"===e.type){var s;const t="access_token_retrieval_failed"===(null===(s=e.body)||void 0===s||null===(s=s.clientData)||void 0===s?void 0:s.type)?j.default.formatMessage(Qe.thirdPartyDebugPrefix):void 0;Te.showError(e,t)}else{const{externalObjectInstanceBlockId:t,spaceId:i}=e.data;if(await ze.pJ({environment:n}),await ze.FD({environment:n,notionState:{externalObjectInstanceBlockId:t,spaceId:i}}),o&&(0,y.z6)(o)){const e=ne.Z.bots.state.filter((e=>e.integration_id===o))[0];Se.eR(n,{integration_id:o,configuration_type:"oauth",bot_id:null==e?void 0:e.id})}}}catch(l){a||(a=(0,S.t)(l).message)}a&&Te.deprecatedShowErrorMessage(a),await async function(e){const{environment:t,integrationId:n,from:o}=e;if(function(e){const{currentUserRootStore:t}=U.default.state;if(!t||!e)return!1;const n=(0,L.Kv)(t,{id:e,table:V.K2}).getKeyStore("capabilities").getValue();return(0,Z.ms)(n)}(n)&&!(0,y.uw)(n)){const{spaceId:e}=await Re.Ie(t);Be.g({environment:t,responseType:"code",spaceId:e,integrationId:n,redirectUri:void 0,state:void 0,owner:void 0,userId:void 0})}else"workspace_connections_redirect"!==o&&Ge.iy(t)}({environment:n,integrationId:o,shouldOpenSettings:null==r?void 0:r.shouldOpenSettings,from:i})}async function vt(e,t){const{state:n,password:o,isSignup:i,redirectURL:r,webBrowserDeviceId:a}=e,s=await Ee.loginWithTemporaryPasscode({environment:t,state:n,password:o,redirectURL:r,webBrowserDeviceId:a,passcodeEnterMethod:"magic_link"});s&&(ie.Z.setState({...ie.Z.state,alert:s}),i?Ge.c4({url:d._j.signup,environment:t}):Ge.c4({url:d._j.login,environment:t}))}async function bt(e,t){const{args:n}=le.getState(),{webBrowserDeviceId:o}=e;n?await Ee.handleLoginWithTemporaryPasscodeSuccess({environment:t,...n,webBrowserDeviceId:o}):(r.log({level:"error",from:"routerActions",type:"handleLoginSuccessRedirect",data:{message:"empty args for handleLoginSuccessRedirect"}}),Ge.c4({url:d._j.root,environment:t}))}async function yt(e,t){const{state:n,password:o}=e,i=await Ee.loginPasswordReset({environment:t,csrfState:n,password:o,loginStore:ie.Z});i&&(ie.Z.setState({...ie.Z.state,loginType:"email",alert:i}),Ge.c4({url:d._j.login,environment:t}))}async function _t(e,t){v.In(e);const{userId:n,spaceId:o}=e;if(o){const e=n?[n]:t.currentUser.loggedInUserIds;for(const n of e){const e=new ge.r9(t,{table:h.dx,id:n},{userId:n});await e.load();const i=e.getSpaceViewStores();if(i.length>0){await Promise.all(i.map((e=>e.load())));const e=i.find((e=>e.getSpaceId()===o));if(e)return void(await Ne.ce({environment:t,spaceViewStore:e}))}}}const{currentUserRootStore:i}=U.default.state;if(i){await i.load();const e=i.getSpaceViewStores().find((e=>{var t;return Boolean(null===(t=e.getSpaceStore())||void 0===t?void 0:t.canRead())}));if(e)return void(await Ne.ce({environment:t,spaceViewStore:e}))}Ge.c4({environment:t,url:d._j.login,redirect:!0})}function St(e,t,n){if((0,z.Sr)(e)){const t=C.TW({publicDomainName:R.default.publicDomainName},window.location.host);xe.qY({spaceDomain:t,environment:e})}else!e.currentUser.isLoggedIn()||null!=n&&n.doNotRedirectWhenLoggedIn?we.Sn(e,t):Ge.c4({environment:e,url:d._j.root,redirect:!0})}async function wt(e,t){var n;const i=e.currentUser.id;if(!i)return void Pt(e);const r=new ge.r9(e,{table:h.dx,id:i},{userId:i});await r.load();const a=null===(n=r.getSpaceViewStores())||void 0===n?void 0:n[0].getSpaceId();if(!a)return void Pt(e);const s=await Ce.getIdFromUniqueId(e,{spaceId:a,uniqueId:t});if("failed"===s.type||!s.data.id)return void Pt(e);const l=s.data.id,c=ge.G.createChildStore(r,{table:u.iU,id:l});await c.load(),He.r({environment:e,store:c,pageVisitSource:o.tY.Direct})}async function kt(e){const{environment:t,route:n}=e;Ge.c4({environment:t,url:d._j.root,redirect:!0});const[{favoriteImportActions:o}]=await Promise.all([M.E0.loader(),async()=>{await U.default.waitUntil((()=>void 0!==U.default.state.currentUserSettingsStore&&void 0!==U.default.state.currentSpaceStore&&void 0!==U.default.state.currentSpaceViewStore&&void 0!==U.default.state.currentUserRootStore)),await U.default.waitUntilRendered()}]);await o.importGtmFavorite({environment:t,importArgs:n})}async function It(e,t){const n=Ue.I6({environment:e,request:{type:"invite-link",inviteLinkCode:t}}),i=(await n.next()).value;X.Z.setState({publicPageData:i});const r=()=>{b.Z.set(H.WX,t),Ge.T4(e)};if(e.currentUser.isLoggedIn()&&i.spaceId){const{id:n}=e.currentUser;if(n){const s=new ge.U6(e,{table:g.KJ,id:n});await s.load();if(!s.getFullName(j.default.getIntl())){r();const t=await(0,q.iX)({environment:e,disableRedirectUrl:!1});return void(await W.I1(e,{type:"new-user",redirectUrl:t.redirectUrl}))}const l=new ge.r9(e,{table:h.dx,id:n});await l.load();try{const n=await Ne.j({environment:e,userRootStore:l,userSettingsStore:void 0,spaceId:i.spaceId,navigate:!1,analyticsFrom:"redirect",inviteCode:t});await Ne.y3({environment:e,spaceViewStore:n.spaceViewStore,userSettingsStore:void 0,userRootStore:l,pageVisitSource:o.tY.SwitchSpace,navigationType:"joiningOrCreatingSpace"})}catch(a){const{currentUserRootStore:t,currentUserSettingsStore:n}=U.default.state,i=t&&n;Te.showMessage({message:(0,S.t)(a).message,acceptLabel:i?j.default.formatMessage(Qe.backToContent):j.default.formatMessage(Qe.goBack),onAccept:()=>{b.Z.remove(H.WX),i?Ne.L5({environment:e,userRootStore:t,userSettingsStore:n,pageVisitSource:o.tY.Onboarding}):Ge.op(e)}})}}}else r()}async function Ct(e){await Ee.actuallyLogoutAndDeleteMostLocalData({environment:e,logoutOrigin:a.F.LogoutRouteVisited})}async function xt(e,t){const{mainEditorCurrentBlockStore:n}=U.default.state;if(n&&"page"===t.name&&t.scrollToBlockId&&t.discussionId){const o=ge.G.createChildStore(n,{table:u.iU,id:t.blockId}),i=(0,ge.Kv)(o,{table:p.qF,id:t.discussionId,spaceId:(0,m.C)(o.pointer.spaceId)});await i.load(),i.getKeyStore("resolved").getValue()&&(Q.setUpdateExpand({environment:e,isExpanded:!0,from:"resolved_comment"}),Q.setUpdateSidebarCommentsMode(J.F7.Resolved))}}async function Tt(e,t){"configureOpenInDesktopApp"in t&&t.configureOpenInDesktopApp&&(await te.default.waitUntilStatsigReady(),e.device.isDesktop&&e.device.isBrowser&&(e.device.isMac||e.device.isWindows)&&be.Z.setState({open:!0,openedFrom:"misc",currentTab:"user_settings",defaultSubtab:void 0,highlightedSetting:be.R.OpenInDesktopApp}))}function Mt(e){let t;try{t=C.$U((0,F.W)(window.location.href))}catch{}t&&Ge.c4({environment:e,url:t})}function Pt(e){const t={name:"notFound"};e.RouterStore.setState({id:(0,k.ZP)(),route:t,action:"push",initialRoute:e.RouterStore.state.initialRoute||t})}function At(e){Ge.c4({environment:e,url:d._j.root,redirect:!0})}async function Rt(e){var t;const n=(0,C.Ph)(window.location.href,"pvs");if(null!==(t=e.mobileNative)&&void 0!==t&&t.supportsNativeHomeOnPhone())return void $e.d(e);if(e.device.isMobileNative)return void At(e);let i=e.currentUser.id;if(!i&&(Ge.c4({environment:e,url:d._j.login,redirect:!0}),await U.default.waitUntil((()=>void 0!==U.default.state.currentUserStore&&void 0!==U.default.state.currentUserRootStore&&void 0!==U.default.state.currentSpaceStore)),i=e.currentUser.id,!i))return;const r=await Ce.getHomeEnabledSpaceViews(e,{});if("failed"===r.type)return void At(e);const{usersToSpaceViews:a}=r.data,s=[],c=new ge.r9(e,{table:h.dx,id:i});for(const o of Object.values(a)){const t=l.PF.create(o.recordMap);Le.fL({environment:e,userId:i,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,recordMap:t,debugSource:"handleHomeRedirect"}),s.push(...o.homeEnabledSpaceViewIds.map((e=>ge.V9.createChildStore(c,{table:f.zU,id:e}))))}const{spaceId:u}=await Re.Ie(e),p=function(e){let{currentUserId:t,lastVisitedSpaceId:n,homeEnabledSpaceViewStores:o}=e;const i=n&&o.find((e=>e.getSpaceId()===n&&e.getParentId()===t));if(i)return i;const r=o.find((e=>e.getParentId()===t));if(r)return r;return o[0]}({currentUserId:i,lastVisitedSpaceId:u,homeEnabledSpaceViewStores:s}),m=$.Al(p);if(!m||!p)return void At(e);if(await m.load(),!m.isDefined()){const t=await Ce.getUserHomePages(e,{spaceViewId:p.id},p.getUserId());if("failed"===t.type||void 0===t.data.recordMap.block)return we.AM(e,{type:"invalid_home_block_from_redirect",flow_id:"home_redirect"}),void At(e)}const g=n?Number(n):o.tY.PersonalHomeLink;(0,G.$X)({environment:e,from:g===o.tY.PersonalHomeEmailLink?"email_link":"link"}),qe._c({environment:e,store:m,pageVisitSource:g})}function Dt(e,t){if(e.currentUser.isLoggedIn())return{redirected:!1};const n=C.bf(t),o=C.bf({url:`${R.default.domainBaseUrl}${d._j.login}`,query:{redirectURL:n}});return Ge.c4({environment:e,url:o,redirect:!0}),{redirected:!0}}},21862:(e,t,n)=>{n.d(t,{r:()=>u});var o=n(15157),i=n(53965),r=n(19584),a=n(83105),s=n(98165),l=n(80444),c=n(75754);const d=10;function u(e){const{store:t,openInNew:n,environment:u,pageVisitSource:m,openInSidePeek:f}=e,{currentSpaceStore:g}=l.default.state;if(!t.isDefined())return;const h=t.isNavigableBlock(),{page:v,block:b}=h?{page:t,block:void 0}:{page:s.Dg(t),block:t};v&&(!b&&g&&function(e){let{currentUserId:t,spaceId:n,blockId:a}=e;const s=function(e){let{currentUserId:t,spaceId:n}=e;const i=o.Z.get({userId:t,key:p(n)});if(i){const e=(0,r.dj)(i);return Array.isArray(e)?e:[]}return[]}({currentUserId:t,spaceId:n}),l=i.jj([a,...s]).slice(0,d);o.Z.set({userId:t,key:p(n),value:JSON.stringify(l)})}({currentUserId:u.currentUser.id,spaceId:g.id,blockId:v.id}),c._c({environment:u,store:v,scrollToBlockId:b&&b.id,openInNew:n,visitType:a.vu.Search,pageVisitSource:m,queryId:e.queryId,openInSidePeek:f}))}function p(e){return`recentQuickJumps:${e}`}},26999:(e,t,n)=>{n.d(t,{CH:()=>u,OW:()=>m,Qk:()=>p});var o=n(15145),i=n(37167),r=n(84210),a=n(80444),s=n(88923),l=n(92973),c=n(87420),d=n(8055);function u(e){const{environment:t,store:n,peekMode:l,openInNew:u,showMoveTo:p,saveParent:m,resultsStore:f,collectionContextStore:g,pageVisitSource:h}=e,v=e.currentBlockStore??a.default.state.mainEditorCurrentBlockStore;let b;if("chat"===t.RouterStore.state.route.name&&"side_peek"===l){const e=n.getNavigableBlockStore();if(!e)return;b=(0,i.t)({pageId:e.id,scrollToBlockId:void 0,pageVisitSource:o.tY.AIChat})}else b=Boolean(u)||"full_page"===l||!v?(0,r.Hu)({store:n,fullyQualified:!1,showMoveTo:p,saveParent:m,pageVisitSource:h}):(0,r.Hu)({store:v,peekViewBlockId:n.id,peekMode:(0,s.getUrlParamFromPeekMode)(l),fullyQualified:!1,showMoveTo:p,saveParent:m,pageVisitSource:h});d.c4({environment:t,url:b,openInNew:u}),c.Af({resultsStore:f,collectionContextStore:g,pageVisitSource:h})}function p(){const{resultsStore:e}=s.default.state,t=null==e?void 0:e.getState();if(s.default.state.open&&t){const{target:e}=s.default.state,n=t.findIndex((t=>t.id===e.id)),{mainEditorCurrentBlockStore:i}=a.default.state;if(i&&n>0){const e=(0,r.Hu)({store:i,fullyQualified:!1,peekViewBlockId:t[n-1].id,peekMode:(0,s.getUrlParamFromPeekMode)(s.default.state.mode),pageVisitSource:o.tY.PeekScroll});d.c4({environment:i.environment,url:e}),l.zP(i.environment,{direction:"up"})}}}function m(){const{resultsStore:e}=s.default.state,t=null==e?void 0:e.getState();if(s.default.state.open&&t){const{target:e}=s.default.state,n=t.findIndex((t=>t.id===e.id)),{mainEditorCurrentBlockStore:i}=a.default.state;if(i&&n<t.length-1){const e=(0,r.Hu)({store:i,fullyQualified:!1,peekViewBlockId:t[n+1].id,peekMode:(0,s.getUrlParamFromPeekMode)(s.default.state.mode),pageVisitSource:o.tY.PeekScroll});d.c4({environment:i.environment,url:e}),l.zP(i.environment,{direction:"down"})}}}},69915:(e,t,n)=>{n.d(t,{tc:()=>c,yF:()=>l});n(82801);var o=n(7032),i=n(97978),r=n(12955),a=n(80444),s=n(8055);async function l(e,t){const{utmContent:n,nextRoute:o}=t,[i,r]=await Promise.all([c(e),d(e,{utmContent:n,utmSource:"public_page"})]);s.Li({environment:e,url:o,extraSearchParams:{...i,...r}})}async function c(e){const t=await r.getPartnerStackCookie(e);if(t){return{gspk:window.btoa(t)}}const n=await r.getS2STrackingCookie(e);if(n&&n.partnerKey){return{ps_partner_key:window.btoa(n.partnerKey),ps_xid:n.clickId}}return{}}async function d(e,t){const{utmContent:n,utmSource:r}=t,s={utm_source:r,utm_content:n,tid:await(0,i.cG)(e)},{mainEditorCurrentBlockStore:l}=a.default.state;return null!=l&&l.id&&(s.utm_campaign=(0,o.F9)(null==l?void 0:l.id)),s}},65729:(e,t,n)=>{n.d(t,{A:()=>a,j:()=>r});var o=n(15157);const i="queryParamsRedirect";function r(e){let{currentUserId:t,params:n}=e;o.Z.set({userId:t,key:i,value:n})}function a(e){return o.Z.get({userId:e,key:i})}},8055:(e,t,n)=>{n.d(t,{CZ:()=>Y,LU:()=>ee,Li:()=>W,Oj:()=>G,RX:()=>Q,T4:()=>K,c4:()=>H,eH:()=>X,iy:()=>ne,j7:()=>$,op:()=>J,up:()=>te});n(21703);var o=n(1302),i=n(27328),r=n(15145),a=n(99405),s=n(89101),l=n(53965),c=n(15828),d=n(3303),u=n(1898),p=n(18265),m=n(95477),f=n(97978),g=n(98165),h=n(18514),v=n(97448),b=n(34017),y=n(18245),_=n(95802),S=n(74948),w=n(24646),k=n(38676),I=n(36391),C=n(5162),x=n(80444),T=n(80123),M=n(88923),P=n(6258),A=n(87956),R=n(32441),D=n(51787),E=n(2449),B=n(47839),F=n(47678),O=n(94273),Z=n(3898),V=n(29974),U=n(75754),L=n(12714),j=n(32953),N=n(91100),z=n(1357);const q=[`${r.tY.MentionInPage}`,`${r.tY.LinkInPage}`,`${r.tY.PeekOpen}`,`${r.tY.Expand}`,`${r.tY.Duplicate}`,`${r.tY.Move}`];function W(e){const t=function(e,t){try{const n=e.startsWith("/")?new URL(e,m.default.domainBaseUrl):new URL(e);if(t)for(const[e,o]of Object.entries(t))n.searchParams.append(e,o);return n.pathname+n.search+n.hash}catch{throw new Error(`${e} is neither a URL nor an absolute path`)}}(e.url,e.extraSearchParams);return H({...e,url:`${m.default.domainBaseUrl}${t}`})}function H(e){var t,n;const{environment:o,openInNew:i,frontPreserveScrollPosition:r,queryId:s,callback:l}=e,{RouterStore:f,currentUser:g}=o,_=g.id,{savedSidebarExpandedStoreState:C}=M.default.state;C&&k.sidebarExpandedStore.setState(!0),(0,v.fastCheckGate)("page_layouts")&&b.Z.setState({isOpen:!1});const P=a.Wj({url:e.url,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,isMobile:o.device.isMobile,protocol:m.default.protocol,currentUrl:window.location.href}),{redirect:F,updateMobileTabbedRouterArgs:O}=function(e,t){var n;const o={redirect:e.redirect,updateMobileTabbedRouterArgs:e.updateMobileTabbedRouterArgs};if(!h.__(e.environment))return o;"login"!==t.name&&"logout"!==t.name&&"onboarding"!==t.name||(o.redirect=!0,o.updateMobileTabbedRouterArgs={...o.updateMobileTabbedRouterArgs,clearNativeRootPageOverride:!0});(null===(n=e.updateMobileTabbedRouterArgs)||void 0===n||!n.tabbedRouterStateAlreadyUpdated)&&(e.environment.TabbedRouterStore.state.modal??[]).length>0&&(o.redirect=!0,o.updateMobileTabbedRouterArgs={...o.updateMobileTabbedRouterArgs,clearNativeRootPageOverride:!0});return o}(e,P),Z=p.gy(window.location.href),V=p.gy(e.url),U=Boolean((null==V?void 0:V.hostname)&&V.hostname!==(null==Z?void 0:Z.hostname));if("external"===P.name||U)return void L.D({environment:o,url:e.url,targetSelf:U});const z=d.u5({schemeUrl:e.url,baseUrl:m.default.domainBaseUrl}),W=p.T1(e.url);if("tab"===i)return void(o.device.isElectron&&"page"===P.name?B.openInNewTab({url:W,position:"after-children"}):L.D({environment:o,url:z}));if("window"===i&&o.device.isElectron&&"page"===P.name)return void B.openInNewWindow(W);const H=f.state.route;if("quickSearch"===H.name&&o.device.isElectron)return void B.openQuickSearchResult(W);const K="page"===H.name&&"page"===P.name&&H.blockId===P.blockId,$="page"===H.name&&"page"===P.name&&H.spaceDomain!==P.spaceDomain&&(H.requestedOnPublicDomain||P.requestedOnPublicDomain),Q=o.AppUpdateStore.state.appUpdate;if(!K&&!e.redirect&&E.cM(o,Q))return void E.hC({environment:o,url:W,version:Q.version});if(F||K||(j.Vz({historyId:f.state.id,currentUserId:_}),(0,w.Sx)(o)&&(S.setUpdateExpand({environment:o,isExpanded:!1,from:"close_for_space"}),I.ZP.update((e=>({...e,canRender:!1}))))),j.LU(o),$)return void L.D({environment:o,url:e.url,targetSelf:!0});const Y=(0,c.ZP)();F?window.history.replaceState({id:Y,currentUserId:o.currentUser.id},void 0,W):window.history.pushState({id:Y,currentUserId:o.currentUser.id},void 0,W);const J=j.M3({historyId:f.state.id,currentUserId:_});j.UV({historyId:Y,historyIndex:F?J:J+1,currentUserId:_}),"pageVisitSource"in P&&(0,u.DE)(q,P.pageVisitSource)&&R.BR(o,H,P),!K&&"page"===H.name&&A.Z.state&&(null===(t=A.Z.state)||void 0===t?void 0:t.pageId)===H.blockId&&D.Eb(o,A.Z.state),"page"===H.name&&"page"===P.name&&(0,T.Y)(H,P),N.e({environment:o,id:Y,action:F?"replace":"push",href:W,updateMobileTabbedRouterArgs:O}).then((()=>{"page"===P.name&&!K&&s?A.Z.setState({queryId:s,pageId:P.blockId,timeEntered:new Date}):A.Z.reset()})).then((()=>{l&&l()}));(K||"nativeTab"===H.name&&"page"===P.name&&(null===(n=x.default.state.mainEditorCurrentBlockStore)||void 0===n?void 0:n.id)===P.blockId)&&G(o),!r&&window.scrollTo(0,0),y.default.markEitherOf(["navigation_page_render","navigation_database_render"]),y.default.mark("initial_page_render_after_login")}function K(e){H({environment:e,url:s._j.onboarding})}async function G(e){const{RouterStore:t}=e,n=x.default.state.mainEditorCurrentBlockStore;if(n&&"page"===t.state.route.name){if(t.state.route.scrollToBlockId){const e=[t.state.route.scrollToBlockId];0===l.oA(_.C.findSelectablesFromIds(e)).length&&(await Z.Nz(n,e),await o.default.afterNextFlush())}F.Y(e,{animateScrollToBlocks:!0})}}function $(e){var t;const{environment:n,url:o}=e;if(!h.__(n))return;const{TabbedRouterStore:r}=n,s=(0,i.w_)(r.state);if("web"!==s.type)return;const l=a.Wj({url:o,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,isMobile:n.device.isMobile,protocol:m.default.protocol,currentUrl:window.location.href}),c=(null===(t=s.redirectedTo)||void 0===t?void 0:t.route)??s.route;if(l.name!==c.name)return;const d=p.T1(e.url);s.redirectedTo?(s.redirectedTo.route=l,s.redirectedTo.url=d):(s.route=l,s.url=d)}async function Q(e){const{environment:t,url:n}=e,o=p.T1(n);t.device.isNative?H({url:o,environment:t}):window.location.href=p.SK(d.NV({httpUrl:o,protocol:m.default.protocol}),{di:await(0,f.cG)(t)})}async function Y(e){const{environment:t,blocks:n}=e,{mainEditorCurrentBlockStore:o,currentSpaceViewStore:i,currentUserSettingsStore:a,currentUserRootStore:s}=x.default.state,l=o&&n.find((e=>e.id===o.id));if(l&&i){const e=g.Dg(l,1);(0,C.Y)("supportsNativeHome")?h.NW(t)?J(t):z.d(t):e?U._c({environment:t,store:e,pageVisitSource:r.tY.LeaveOrRemove}):await V.y3({environment:t,spaceViewStore:i,userSettingsStore:a,userRootStore:s,pageVisitSource:r.tY.LeaveOrRemove,navigationType:"switchingToOrLoadingSpace"})}Boolean(n.find((e=>{var t;return e.id===(null===(t=M.default.peekTarget.state)||void 0===t?void 0:t.id)})))&&o&&U._c({environment:t,store:o,pageVisitSource:r.tY.LeaveOrRemove})}function J(e){h.__(e)?function(e){const{TabbedRouterStore:t}=e,n=t.state,o=(0,i.Os)(n);if(!o)return;const r=o.type;"native"===r?t.updateWithNativePage({page:o,clearPages:!1,navigationAction:"pop",navigationSource:"mobile-back-navigation"}):"web"===r?window.history.back():(0,u.t1)(r)}(e):window.history.back()}function X(){window.history.forward()}function ee(){const e=x.default.state.mainEditorCurrentBlockStore;return!!e&&!!g.Dg(e,1)}function te(e){const t=x.default.state.mainEditorCurrentBlockStore;if(!t)return;const n=g.Dg(t,1);n&&U._c({environment:e,store:P.G.createChildStore(n,n.pointer),pageVisitSource:r.tY.Breadcrumb})}function ne(e){const{url:t}=O.Vr(e);H({url:t||s._j.root,environment:e})}},32219:(e,t,n)=>{n.r(t),n.d(t,{getInitialPage:()=>d,initialize:()=>c});var o=n(72128),i=n(15828),r=n(18514),a=n(5162),s=n(32953),l=n(91100);async function c(e){const t=window.history.state&&window.history.state.id||(0,i.ZP)();if(!window.history.state){const n=e.currentUser.id;window.history.replaceState({id:t,currentUserId:n},void 0,window.location.href),s.UV({historyId:t,historyIndex:0,currentUserId:n})}r.__(e)&&e.TabbedRouterStore.setUp({nativeInboxEnabled:(0,a.Y)("supportsNativeInbox")}),await l.e({environment:e,id:t,action:"pop",href:window.location.href,updateMobileTabbedRouterArgs:{forceUpdate:!0,silenceErrors:!0,clearNativeRootPageOverride:"/"!==window.location.pathname},enableDesktopAppRedirect:!0});const n=e.currentUser.id,c=d(n);if(!c||"undefined"===c){const e=window.location.pathname;e&&function(e){let{currentUserId:t,value:n}=e;o.Z.set({userId:t,key:"sourceInitialPage",value:n})}({currentUserId:n,value:e})}}function d(e){return o.Z.get({userId:e,key:"sourceInitialPage"})}},91100:(e,t,n)=>{n.d(t,{e:()=>Z});var o=n(17673),i=n(50112),r=n(15157),a=n(90850),s=n(99405),l=n(89101),c=n(7678),d=n(9852),u=n(93724),p=n(12139),m=n(37850),f=n(18265),g=n(95477),h=n(78873),v=n(18514),b=n(77907),y=n(84437),_=n(80444),S=n(21273),w=n(77080),k=n(45946),I=n(57118),C=n(70060),x=n(88280),T=n(22500),M=n(32441),P=n(86572),A=n(35793),R=n(91376),D=n(87531),E=n(39634),B=n(75754),F=n(31120),O=n(8055);async function Z(e){const{id:t,action:n,href:Z,environment:U,updateMobileTabbedRouterArgs:L}=e,{RouterStore:j,currentUser:N,TabbedRouterStore:z}=U,[q,W]=s.DP({url:Z,isMobile:U.device.isMobile,baseUrl:g.default.domainBaseUrl,publicDomainName:g.default.publicDomainName,protocol:g.default.protocol,currentUrl:window.location.href});p.FB(q.name),u.setRouteTags(q,W);const H=j.state.route,K=r.Z.get({userId:N.id,key:t});j.setState({id:t,historyState:K,action:n,route:q,initialRoute:j.state.initialRoute||q});if("page"===(null==H?void 0:H.name)&&"page"===q.name&&q.blockId!==H.blockId&&B.qV({environment:U,targetId:H.blockId}),null!=L&&L.forceUpdate||v.__(U)&&(null==L||!L.tabbedRouterStateAlreadyUpdated)){const e={type:"web",url:f.T1(Z),route:q};z.updateWithWebPage({page:e,action:null!=L&&L.forceUpdate?"replace":n,updateMobileTabbedRouterArgs:L})}const G=f.Qc(Z),$=G.query[c.Vt];$&&(0,a.Zj)({currentUserId:N.id,promoCode:$});const Q=G.query[i.gS];Q&&((0,d.ob)(Q),V(i.gS)),"page"===q.name||s.KV[q.name]||M._W(U,Z);const{target:Y,subtarget:J}=function(e){if(!e)return{target:void 0};const t=null==e?void 0:e.indexOf(".");if(-1===t)return{target:e};return{target:e.substring(0,t),subtarget:e.substring(t+1)}}(G.query.target);if("intercom"===Y)E.j({environment:U,from:"query_param"}),V("target");else if(U.device.isMobileBrowser&&"plans"===Y){if(await w.default.waitUntilStatsigReady(),(0,C.bQ)()){const e=await b.deps.payments.loader();await _.default.waitUntil((()=>void 0!==_.default.state.currentSpaceStore)),await _.default.waitUntilRendered();const t=_.default.state.currentSpaceStore;e.plans.canShowPlans(t)&&e.plans.showPlans({environment:U,from:"deeplink"}),V("target")}}else if(U.device.isMobileBrowser&&"billing"===Y){if(await w.default.waitUntilStatsigReady(),(0,C.bQ)()){const e=await b.deps.payments.loader();await _.default.waitUntil((()=>void 0!==_.default.state.currentSpaceStore)),await Promise.all([_.default.waitUntilRendered(),x.subscriptionDataStoreInstance.waitUntilLoaded()]);const t=_.default.state.currentSpaceStore,n=x.subscriptionDataStoreInstance.state;t&&n&&e.billing.canShowBilling({subscriptionData:n,spaceStore:t})&&e.billing.showBilling({environment:U,from:"deeplink"}),V("target")}}else"billing"===Y||"plans"===Y||"members"===Y||"audit_log"===Y||"connected_apps"===Y||"identity_provisioning"===Y||"analytics"===Y||"admin_content_search"===Y||"profile"===Y||"notifications_and_settings"===Y||"user_settings"===Y||"notifications"===Y||"language_and_region"===Y||"settings"===Y||"integrations"===Y||"sites"===Y||"imports"===Y?(R.r$({currentTab:Y,subtab:J,isMobile:U.device.isMobile,openedFrom:"email"}),V("target")):"contact_us"===Y?((0,I.n)(),V("target")):"quickfind"===Y?(Promise.race([async()=>{await _.default.waitUntil((()=>void 0!==_.default.state.currentUserSettingsStore&&void 0!==_.default.state.currentSpaceStore&&void 0!==_.default.state.currentSpaceViewStore&&void 0!==_.default.state.currentUserRootStore)),await _.default.waitUntilRendered(),D.UT({environment:U,analyticsFrom:"deeplink"})},m.Vs(1500).then((()=>{D.UT({environment:U,analyticsFrom:"deeplink"})}))]),V("target")):"qna"===Y&&(Promise.race([(async()=>{if(await _.default.waitUntil((()=>void 0!==_.default.state.currentUserSettingsStore&&void 0!==_.default.state.currentSpaceStore&&void 0!==_.default.state.currentSpaceViewStore&&void 0!==_.default.state.currentUserRootStore)),await _.default.waitUntilRendered(),!S.Z.isQnaRightSideDeeplinkEnabled()||S.Z.isQnATooltipsVisible(U.device,_.default.state.currentUserSettingsStore))return!1;return(await b.deps.assistant.loader()).assistantMenuActions.openAssistantRightHandSideMenu({environment:U,from:"deeplink"}),!0})(),(async()=>{if(!S.Z.isQnaRightSideDeeplinkEnabled())return!1;await m.Vs(1500);return(await b.deps.assistant.loader()).assistantMenuActions.openAssistantRightHandSideMenu({environment:U,from:"deeplink"}),!0})()]),V("target"));if("googleOneTapRedirect"===q.name)return void F.ST(U,{code:q.code,frontPathName:q.frontPathName});if("samlAuthCallback"===q.name)return void F.rH(q,U);if("appleAuthCallback"===q.name)return void F.fE(q,U);if("googleAuthCallback"===q.name)return void F.E4(q,U);await w.default.waitUntil((()=>w.default.state.isLoaded));const X=f.T1(Z),ee=o.parse(X.split("?")[1]||"");if("settingsConsoleDefault"===q.name)return await w.default.waitUntilStatsigReady(),w.default.checkGate("admin_console_enabled")?void O.c4({environment:U,url:l._j.settingsConsoleWorkspace,redirect:!0}):void O.c4({environment:U,url:l._j.root,redirect:!0});if("settingsConsoleOrganization"!==q.name||(await w.default.waitUntilStatsigReady(),w.default.checkGate("admin_console_enabled")))if("settingsConsoleWorkspace"!==q.name||(await w.default.waitUntilStatsigReady(),w.default.checkGate("admin_console_enabled")))if(e.enableDesktopAppRedirect&&function(e){const{route:t}=e.RouterStore.state;return s.c$[t.name]&&"always"===k.Z.state&&e.device.isDesktop&&e.device.isBrowser&&(e.device.isMac||e.device.isWindows||!1)&&(!("configureOpenInDesktopApp"in t)||!t.configureOpenInDesktopApp)}(U))F.FA(U);else{if("root"===q.name){const e={templateGalleryItem:q.templateGalleryItem,projectManagementLaunch:"true"===(Array.isArray(ee.pjm)?ee.pjm[0]:ee.pjm)};F.nN(q,U,e)}else if("onboarding"===q.name)F.uO(U);else if("modal"===q.name)if(U.currentUser.isLoggedIn()){let e="/";q.projectManagementLaunch?e+="?tg=gallery":q.templateGalleryItem&&(e+=`?tg=${q.templateGalleryItem}`),O.c4({environment:U,url:e,redirect:!0})}else O.c4({environment:U,url:l._j.login,redirect:!0});else if("googleDriveAuthCallback"===q.name)F.LW(q,U);else if("slackAuthCallback"===q.name)F.YU({route:q,environment:U});else if(q.name===s.AY.datadogAuthCallback)F.wN({route:q,environment:U});else if("externalAuthCallback"===q.name)F.xp({route:q,environment:U});else if(q.name===s.AY.authCallback)F.wN({route:q,environment:U});else if("loginWithEmailCallback"===q.name)F.kd(q,U);else if("loginSuccessCallback"===q.name)F.OO(q,U);else if("passwordResetCallback"===q.name)F.KR(q,U);else if("passwordChangeRedirect"===q.name)O.Li({environment:U,url:l._j.login}),h.E({environment:U});else if("logout"===q.name)F.hY(U);else if("login"===q.name||"signup"===q.name){F.HB(U,Z),Boolean(ee.showNotionCalendarModal)&&y.N$();const e={doNotRedirectWhenLoggedIn:Boolean(ee.newSignup)};F.wo(U,q.name,e)}else if("oauthAuthorization"===q.name)F.r$(q,U);else if("page"===q.name||"space"===q.name)F.HB(U,Z),F.pN(U,q.state),A.Uz({nextRoute:q,currentRoute:H,environment:U,query:X}),F.Z_(U,q),await F.JW(U,q);else if("templatesRedirect"===q.name)O.c4({environment:U,url:(0,v.UY)("templateGallery"),redirect:!0});else if("communityRedirect"===q.name)O.c4({environment:U,url:(0,v.UY)("community"),redirect:!1});else if("guideRedirect"===q.name)O.c4({environment:U,url:(0,v.UY)("guides.guides"),redirect:!0});else if("invoiceRedirect"===q.name)O.c4({environment:U,url:l._j.root,redirect:!0});else if("termsRedirect"===q.name)O.c4({environment:U,url:(0,v.UY)("terms"),redirect:!0});else if("contentPolicyRedirect"===q.name)O.c4({environment:U,url:(0,v.UY)("contentPolicy"),redirect:!0});else if("uiDoc"===q.name)O.c4({environment:U,url:l._j.root,redirect:!0});else if("exportPreview"===q.name)O.c4({environment:U,url:l._j.root,redirect:!0});else if("admin"===q.name)g.default.isAdminMode||O.c4({environment:U,url:l._j.root,redirect:!0});else if("teamInvite"===q.name)F.cQ(U,q.inviteCode);else if("teamsInvite"===q.name)U.currentUser.isLoggedIn()||O.c4({environment:U,url:l._j.signup,redirect:!0});else if("aiGtmFavoriteImport"===q.name)F.Rd({environment:U,route:q});else if("new"===q.name)F.HR(U,q);else if("myIntegrations"===q.name)F.WC(U);else if("creatorProfile"===q.name||"creatorProfileAnalytics"===q.name)F.CV(U,{url:l._j.creatorProfile});else if("creatorProfileTemplates"===q.name)F.CV(U,{url:l._j.creatorProfileTemplates});else if("studentGroupSignup"===q.name)F.CV(U,{url:l._j.studentGroupSignup});else if("unknown"===q.name)O.c4({environment:U,url:l._j.root,redirect:!0});else if("nativeTab"===q.name)F.o9(U,q,H,n);else if("quickSearch"===q.name)await F.D_(U,q,H);else if("chat"===q.name)F.dH(U,q,H);else if("workspaceSetup"===q.name)F.yD(U,q,H);else if("uniqueId"===q.name)await F.AL(U,q.uniqueId);else if("signupWithTrial"===q.name){const e=q.trialUpsell;(0,T.zQ)(e,U),(0,T.O1)(e)&&P.ms(U,{source:e}),O.c4({environment:U,url:l._j.signup,redirect:!0})}else"home"===q.name&&F.Z1(U);s.kd(q)&&(F.td(U,q,X),F.OP(U,q))}else O.c4({environment:U,url:l._j.root,redirect:!0});else O.c4({environment:U,url:l._j.root,redirect:!0})}function V(e){const t=f.T1(f.iO(window.location.href,e));window.history.replaceState(history.state,void 0,t)}},40468:(e,t,n)=>{n.d(t,{P:()=>c,T:()=>l});var o=n(33147),i=n(83105),r=n(97638),a=n(75754),s=n(21862);const l=new o.Z;function c(e){const{searchResult:t,environment:n,openInNew:o,pageVisitSource:l,queryId:c,openInSidePeek:d}=e,{store:u}=t,p=(0,r.dy)(t);void 0===p?s.r({store:u,openInNew:o,environment:n,pageVisitSource:l,queryId:c,openInSidePeek:d,peekMode:d?"s":void 0}):a._c({environment:n,store:u,scrollToBlockId:p,openInNew:o,visitType:i.vu.Search,pageVisitSource:l,queryId:c,openInSidePeek:d,peekMode:d?"s":void 0})}},1357:(e,t,n)=>{n.d(t,{S:()=>y,d:()=>_});n(57658);var o=n(27328),i=n(68626),r=n(99405),a=n(53965),s=n(15828),l=n(95477),c=n(18514),d=n(80444),u=n(3418),p=n(36610),m=n(19719),f=n(13447),g=n(39865),h=n(8055),v=n(40468);function b(e){return"web"===e.type&&"nativeTab"===e.route.name&&"search"===e.route.tab}function y(e){var t,n,u,y,_;const{environment:S,tab:w,navigationAction:k,navigationSource:I}=e,{TabbedRouterStore:C,currentUser:x}=S;if(!c.__(S))return;"updates"!==w&&m.nI(S);const T=C.state.activeTab,M=(0,o.w_)(C.state),P=a.Xh(C.state);P.activeTab=w,P.navigationAction=k,P.navigationSource=I,void 0!==e.nativeRootPageOverrideEnabled&&(P.tabs[P.activeTab].nativeRootPageOverrideEnabled=e.nativeRootPageOverrideEnabled);let A=!1;if(a.Xy(e.modal,P.modal)||(A=!0,P.modal=e.modal??[]),!A&&void 0!==e.pages&&0===((null===(t=e.modal)||void 0===t?void 0:t.length)??0)){const t=e.pages.map((e=>{const t=(0,o.Gt)(e,!0),n=r.Wj({url:t,baseUrl:l.default.domainBaseUrl,publicDomainName:l.default.publicDomainName,isMobile:S.device.isMobile,protocol:l.default.protocol,currentUrl:window.location.href});return{...e,route:n}})),n=P.tabs[P.activeTab].pages;A=!a.Xy(n,t),P.tabs[P.activeTab].pages=t}if(b(M)&&!b((0,o.w_)(P))&&v.T.emit(Date.now()),C.setState(P),C.state.activeTab===T&&!A)return;const R=d.default.state.mainEditorCurrentBlockStore,D="web"===M.type&&(null===(n=M.redirectedTo)||void 0===n?void 0:n.route)&&"page"===(null===(u=M.redirectedTo)||void 0===u?void 0:u.route.name)&&(null===(y=M.redirectedTo)||void 0===y?void 0:y.route.showMoveTo),E=R&&(null==R?void 0:R.canEdit())&&R.isEmptyTitle()&&R.isEmptyPage();"addPage"===T&&D&&E&&x.isLoggedIn()&&f.createAndCommit({userAction:"routerActions.navigateToTab",environment:S,perform:e=>{g.y8({environment:S,blocks:[R],transaction:e}),e.postSubmitCallbacks.push((e=>{e||p.dh(S,{analyticsName:"delete",from:"mobile_navigation",block_id:R.id,block_type:"page"})}))}});const B="addPage"===w,F=(null===(_=P.modal)||void 0===_?void 0:_.filter((e=>"web"===e.type)))??[],O=C.state.tabs[w],{rootPage:Z,pages:V}=O;let U=!1;switch(Z.type){case"native":break;case"web":if(V.length+F.length===0||B)h.c4({environment:S,redirect:!0,url:(0,o.Gt)(Z,!0,{...e.queryParams,from:"mobile_bottom_bar"}),updateMobileTabbedRouterArgs:{tabbedRouterStateAlreadyUpdated:!0}});else{U=!0;const e=(0,s.ZP)();window.history.replaceState({id:e,currentUserId:S.currentUser.id},void 0,(0,o.Gt)(Z))}}if(B)return;const L=!0===P.tabs[P.activeTab].nativeRootPageOverrideEnabled,j=F[F.length-1];F.length>1&&i.log({level:"error",from:"tabNavigationActions",type:"navigateToTab",data:{message:`TabbedRouterStore only support 1 modal page for now. ${F.length} is detected`}}),V.forEach(((e,t)=>{if(!L&&t===V.length-1&&!j)return void h.c4({environment:S,redirect:!U,url:(0,o.Gt)(e),updateMobileTabbedRouterArgs:{tabbedRouterStateAlreadyUpdated:!0}});const n=(0,s.ZP)(),i=(0,o.Gt)(e);U?window.history.pushState({id:n,currentUserId:S.currentUser.id},void 0,i):(U=!0,window.history.replaceState({id:n,currentUserId:S.currentUser.id},void 0,i))})),j&&"web"===j.type&&h.c4({environment:S,redirect:!U,url:(0,o.Gt)(j),updateMobileTabbedRouterArgs:{tabbedRouterStateAlreadyUpdated:!0}})}function _(e,t){var n,o;if(c.__(e))return e.device.isMobileNative&&e.device.isAndroid&&u.Z.closeAll(),y({environment:e,tab:"home",nativeRootPageOverrideEnabled:!0}),void(t&&t());Boolean(null===(n=e.mobileNative)||void 0===n?void 0:n.supportsNativeHomeOnPhone())&&(null===(o=e.mobileNative)||void 0===o||o.showNativeHomeTab(t))}},3898:(e,t,n)=>{n.d(t,{Nz:()=>g,uE:()=>p});var o=n(21202),i=n(53965),r=n(98165),a=n(52315),s=n(35328),l=n(80444),c=n(6258),d=n(15690),u=n(29373);function p(e){const t=e.state;return"page"===t.route.name&&t.route.scrollToBlockId?[t.route.scrollToBlockId]:t.historyState?t.historyState.blockIds:[]}function m(e,t){const n=function(e,t){const n=t.map((t=>c.G.createChildStore(e,{table:o.iU,id:t}))).map((e=>r.qA(e))).filter((t=>{let n=!1;const o=t.slice(1).find((e=>{if("block"===e.table)return e.isTransclusionType()&&(n=!0),e.isNavigableBlock()}));return o&&(o.id===e.id||n)})).map((e=>{const t=e.findIndex((e=>"block"===e.table&&e.isNavigableBlock()));return e.slice(1,t).filter((e=>"block"===e.table&&(0,s.BX)(e)))}));return i.mN(i.xH(n),(e=>e.id))}(e,t);for(const o of n)u.rd({blockId:o.id,state:!0,currentUserId:o.environment.currentUser.id});return n}function f(e,t){const n=function(e,t){const n=t.map((t=>c.G.createChildStore(e,{table:o.iU,id:t,spaceId:e.pointer.spaceId}))).map((e=>r.qA(e))).filter((t=>{const n=t.slice(1).find((e=>"block"===e.table&&e.isNavigableBlock()));return n&&n.id===e.id})).map((e=>{const t=e.findIndex((e=>"block"===e.table&&e.isNavigableBlock()));return e.slice(1,t).filter((e=>{if("block"!==e.table)return!1;const t=e.getParentStore();return"block"===(null==t?void 0:t.table)&&"tab"===(null==t?void 0:t.getType())}))}));return i.mN(i.xH(n),(e=>e.id))}(e,t);for(const i of n){const e=i.getParentStore();var a;if((null==e?void 0:e.table)===o.iU&&"tab"===(null==e?void 0:e.getType()))d.x2({store:e,id:i.id,currentUserId:null===(a=l.default.state.currentUserStore)||void 0===a?void 0:a.id})}return n}async function g(e,t){await async function(e,t){const n=t.map((t=>c.G.createChildStore(e,{table:o.iU,id:t})));await Promise.all(n.map((e=>r.s(e))))}(e,t);const n=i.mN([...m(e,t),...f(e,t)],(e=>e.id));await async function(e){await Promise.all(e.map((e=>a.r(e))))}(n)}},61045:(e,t,n)=>{n.d(t,{Q7:()=>Y,XW:()=>N,YC:()=>G,Zv:()=>z,_4:()=>K,aB:()=>O,bx:()=>j,hQ:()=>$,hl:()=>q});var o=n(35431),i=n(14577),r=n(53965),a=n(68056),s=n(77546),l=n(89224),c=n(47372),d=n(3994),u=n(75987),p=n(95802),m=n(55521),f=n(96198),g=n(5162),h=n(34859),v=n(80796),b=n(64233),y=n(65686),_=n(19111),S=n(69454),w=n(19671),k=n(13023),I=n(88923),C=n(6258),x=n(27724),T=n(10743),M=n(24666),P=n(36610);function A(e,t,n,o){const i=(n-t)/n,r=o/10/60,a=r+(3*o/60-r)*Math.min(i*i,1);return e.device.isIOS?Math.ceil(a):a}const R=1e3,D=r.P2((e=>{P.PL(e,{direction:"top"})}),R),E=r.P2((e=>{P.PL(e,{direction:"bottom"})}),R),B=r.P2((e=>{P.PL(e,{direction:"left"})}),R),F=r.P2((e=>{P.PL(e,{direction:"right"})}),R);function O(e){const{environment:t,scroller:n,currentMouseX:o,currentMouseY:i,verticalEdgeThreshold:r,horizontalEdgeThreshold:a,disableVerticalEdgeScroll:s,disableHorizontalEdgeScroll:l}=e,{clientRect:c,scrollTop:d,scrollHeight:u,scrollLeft:p,scrollWidth:m}=n.stores.store.state;if(c){if(n.props.type!==h.Z.X&&!s){const e=i-c.top;let o,a;S.Z.state.phase!==S.i.shown?(o=r,a=(0,g.Y)("supportsNativeBottomBarOverlappingWebView")?c.bottom-S.Z.estimatedNativeWebBottomOverlap()-i:c.bottom-i):(o=.25*S.Z.state.estimatedKeyboardWebViewOverlap,a=c.bottom-S.Z.estimatedNativeWebBottomOverlap()+o-i);const s=0===d,l=d+c.height===u;if(e<r&&!s){const o=A(t,e,r,c.height);n.scrollTo(d-o,void 0),o>0&&D(t)}if(a<o&&!l){const e=A(t,a,o,c.height);n.scrollTo(d+e,void 0),e>0&&E(t)}}if(n.props.type!==h.Z.Y&&!l){const e=o-c.left,i=c.right-o,r=0===p,s=p+c.width===m;if(e<a&&!r){const o=A(t,e,a,c.width);n.scrollTo(void 0,p-o),o>0&&B(t)}if(i<a&&!s){const e=A(t,i,a,c.width);n.scrollTo(void 0,p+e),e>0&&F(t)}}}}const Z=64,V=64,U=64,L=64;function j(e){const{element:t,scrollers:n,vertical:o,horizontal:i,animate:r}=e,a=t.getBoundingClientRect();if(o&&n.verticalScroller){const{reveal:e}=o,t=o.paddingToTopEdge||Z,i=o.paddingToBottomEdge||V,s=n.verticalScroller,l=s&&s.getClientRect();if(s&&l){const n=l.top+t,o=l.bottom-i,c=a.top>n&&a.top<o,d=a.bottom>n&&a.bottom<o,u=a.top<n&&a.bottom>o,p=a.bottom-o,m=a.top-n;"top"===e?c||s.scrollByOffset(m,0,{animate:r}):"bottom"===e?d||s.scrollByOffset(p,0,{animate:r}):c||d||u||(Math.abs(p)<Math.abs(m)?s.scrollByOffset(p,0,{animate:r}):s.scrollByOffset(m,0,{animate:r}))}}if(i&&n.horizontalScroller){const{reveal:e}=i,t=i.paddingToLeftEdge||L,o=i.paddingToRightEdge||U,s=n.horizontalScroller,l=s&&s.getClientRect();if(s&&l){const n=l.left+t,i=l.right-o,c=a.left>n&&a.left<i,d=a.right>n&&a.right<i,u=a.left<n&&a.right>i,p=a.right-i,m=a.left-n;"left"===e?c||s.scrollByOffset(0,m,{animate:r}):"right"===e?d||s.scrollByOffset(0,p,{animate:r}):c||d||u||(Math.abs(p)<Math.abs(m)?s.scrollByOffset(0,p,{animate:r}):s.scrollByOffset(0,m,{animate:r}))}}}function N(e){const{handle:t,horizontal:n,vertical:i,animate:r}=e;if(!t)return;const a=(0,o.e)(t);return a?j({vertical:i,animate:r,horizontal:n,element:a,scrollers:{verticalScroller:t.getContextVerticalScroller?t.getContextVerticalScroller():void 0,horizontalScroller:t.getContextHorizontalScroller?t.getContextHorizontalScroller():void 0}}):void 0}function z(){if(x.default.state.pivot)q([x.default.state.pivot.id]);else{q(x.default.state.stores.map((e=>e.id)))}}function q(e,t){const n=p.C.findScrollToSelectablesFromIds(e)[0];if(n){const{disableScrollToRevealHorizontal:e}=n.props;N({handle:n,vertical:{reveal:"closest"},horizontal:e?void 0:{reveal:"closest"},animate:t})}}let W=function(e){return e[e.top=0]="top",e[e.middle=1]="middle",e[e.bottom=2]="bottom",e[e.natural=3]="natural",e}({});function H(e){let{position:t}=e;const{paddingTop:n}=e;if("editing"!==M.default.state.mode)return;let o=e.paddingBottom;c.Z.find((e=>e.isShown()))&&(o+=f.O);const i=l.get();if(i){const e=s.SD(i.commonAncestorContainer);if(!e)return;const r=s.hI(e).find((e=>e.scrollHeight>e.clientHeight));if(!r)return;const a=l.getRect(i);if(!a||!r)return;const c=r.getBoundingClientRect();if(!(i.startContainer instanceof Text)){const e=a;e.top+=4,e.bottom-=5,e.height-=9}const d=a.top<c.top+n,u=a.bottom>c.bottom-o;if(i.startContainer instanceof Text&&i.startOffset!==i.endOffset)return;if(t===W.natural)if(u)t=W.bottom;else{if(!d)return;t=W.top}if(t===W.top){const e=r.scrollTop+a.top,t=c.top+n;r.scrollTop=e-t}else if(t===W.bottom){const e=r.scrollTop+a.bottom,t=c.bottom-o;r.scrollTop=e-t}else if(t===W.middle){const e=r.scrollTop+a.top,t=c.top+c.height/2-10;r.scrollTop=e-t}}}function K(){return S.Z.estimatedNativeWebBottomOverlap()+20}function G(e){if(u.Z.isInlineAutocompleteOpen())return!0;const t=e.device.isMobile&&(!e.device.isNative||e.device.isTablet);return!!(!t&&_.Z.state.open||!t&&!(0,g.Y)("supportsNativeMobileDynamicActionBar")&&T.Z.state.open||!t&&function(){var e;const t="editing"===M.default.state.mode&&(null===(e=(0,a.QY)(M.default.state.multiSelection))||void 0===e?void 0:e.store);if(t){const e=t.getRecordStoreAtRootPath();if(e instanceof C.G){const t=e.getValue(),n=t&&t.type;return"link_to_page"===n||"link_to_collection"===n}}return!1}()||b.Z.state.open)}function $(e){const t=d.Z.shouldPreventMobileAutoScroll(e);G(e)?H({position:W.top,paddingTop:20,paddingBottom:K()}):t||w.Z.state.isOpen&&!I.default.state.open||k.Z.state.isOpen||H({position:W.natural,paddingTop:20,paddingBottom:K()})}const Q=r.IH((e=>{const{device:t}=e;return new i.Z((()=>t.isMobile&&v.Z.state.isDragging||t.isMobile&&m.Z.state.swiping?h.Z.All:y.Z.getPreventScrollType()),{debugName:"preventScrollTypeStore"})}));function Y(e){return Q(e).state}},87531:(e,t,n)=>{n.d(t,{IB:()=>A,Kf:()=>M,Ky:()=>R,LR:()=>T,UT:()=>P,X2:()=>E,bn:()=>D});var o=n(30120),i=n(89101),r=n(94804),a=n(70203),s=n(7032),l=n(1898),c=n(4437),d=n(63594),u=n(81598),p=n(28344),m=n(91683),f=n(69128),g=n(59139),h=n(77907),v=n(80444),b=n(21273),y=n(98180),_=n(22294),S=n(55320),w=n(29026),k=n(51787),I=n(8055),C=n(13447),x=n(37181);const T=6;function M(e){S.default.state.open?A(e.environment):P(e)}function P(e){const{environment:t,renderAsPage:n,isQuickSearch:o,isPublicPageSearch:a}=e,l=(0,s.ZP)(),c=Date.now();if(Boolean(o))S.default.setState({open:!1,openAsPage:!0,openedTimeMs:c,sessionId:l,isPublicPageSearch:a??!1,preferSidePeekOpen:(0,r.w8)(t.currentUser.id)});else if(Boolean(n))I.c4({environment:t,url:`${i.VP.nativeTab}/search`,redirect:!0}),S.default.setState({open:!1,openAsPage:!0,openedTimeMs:c,sessionId:l,isPublicPageSearch:a??!1,preferSidePeekOpen:(0,r.w8)(t.currentUser.id)});else{if(S.default.state.open)return;S.default.update((e=>({...e,open:!0,openAsPage:!1,isQuickSearch:!1,openedTimeMs:c,sessionId:l,isPublicPageSearch:a??!1,preferSidePeekOpen:(0,r.w8)(t.currentUser.id)})))}if(Boolean(e.doNotTrackOpenSearchEvent)||k.wF(e.environment,{from:e.analyticsFrom,searchSessionId:l}),"assistant"===w.ZP.state.mode){const n=y.Z.getActiveSession();if(h.deps.assistant.loader().then((e=>{let{assistantMenuActions:n}=e;n.closeAssistantRightHandSideMenu({environment:t})})),n){const t=S.default.state.sessionId;p.trackQnAOpened(e.environment,{from:"return_to_search",hasQuery:!1,searchSessionId:t,isReminder:!1,reminderType:void 0,sessionId:n.sessionId,startTimestamp:n.assistantConfigurationState.sessionStartTimestamp||Date.now(),transcript:n.evaluator.getTranscript()||[]})}}}function A(e){if(S.default.state.open&&(S.default.reset(),_.Z.setKeyboardMode(!1),"assistant"===w.ZP.state.mode)){const t=y.Z.getActiveSession();t&&p.trackQnaClosed(e,{sessionContext:t,from:"search"})}}async function R(e){var t,n;const{environment:o,shouldResetAssistantStore:i=!0}=e,r=v.default.state.mainEditorCurrentBlockStore??v.default.state.currentSpaceStore,s=w.ZP.state.query.text,l=S.default.state.sessionId,c=s.length>T&&d.Z.state;if(!r)return;const{assistantActions:m,assistantMenuActions:f}=await u.L6.loader();i&&m.clearActiveAssistantSession({environment:o});const h=s.length<=T?s:void 0,_=b.Z.isFullPageAssistantChatEnabled(o.device),k=(0,g.bN)(o);let I;if(_&&!k?(A(o),f.openFullPageChat({environment:o,primeTextInput:h})):(w.ZP.update((e=>({...e,mode:"assistant"}))),f.setPrimeTextInput(h),await f.closeAssistantRightHandSideMenu({environment:o})),c){I=(await m.resetAndInitializeAssistantSession({environment:o})).sessionId,m.commitHumanStep({environment:o,text:(0,a.TPx)(s),sessionId:I})}I||(I=y.Z.getActiveSessionId()??y.Z.getNextSessionId());const C=null===(t=y.Z.getSessionContext(I))||void 0===t||null===(t=t.assistantConfigurationStore)||void 0===t?void 0:t.state,x=(null===(n=y.Z.getSessionContext(I))||void 0===n?void 0:n.evaluator.getTranscript())??[];p.trackQnAOpened(o,{hasQuery:c,from:"search",searchSessionId:l,isReminder:!1,reminderType:void 0,sessionId:I,startTimestamp:(null==C?void 0:C.sessionStartTimestamp)||Date.now(),transcript:x})}function D(){S.default.update((e=>({...e,preferSidePeekOpen:!e.preferSidePeekOpen})))}async function E(e){let{environment:t,timeToAbandonMs:n,query:i}=e;const r=await h.deps.assistant.loader(),a=r.getCurrentQnaReminderUserSettings();if(!a)return;if(!(0,l.$K)(a.last_exposed_to_ai_qna_at))return;const s=o.ou.utc(),d=a.last_exposed_to_ai_qna_at,u=s.diff(o.ou.fromMillis(d),"days").days;if(u<7||u>14)return;const p=a.ai_qna_abandoned_search_reminder_shown_at??[],g=p[p.length-1],_={ai_qna_abandoned_search_reminder_shown_at:[...p,s.toMillis()]};if((a.qna_reminders_shown_at??[]).length<m.Qz||p.length>=f.JV||(0,l.$K)(g)&&s.diff(o.ou.fromMillis(g),"days").days<1)return;if(!b.Z.isQnaAbandonedSearchReminderEnabledForUser())return;if(i.trim().length<8)return;if("idle"!==f.Pf.state.type)return;f.Pf.setState({type:"loading",query:i});const S=v.default.state.currentUserSettingsStore;S&&C.createAndCommit({environment:t,userAction:"searchMenuActions.setAbandonedSearchReminderShownAt",perform:e=>{x.d2({userSettingsStore:S,transaction:e,data:_})}});const w=await(0,c.b_)({environment:t,type:"keywordSearchToSuggestedQuestions",inputs:[{query:i}]});w?(f.Pf.setState({type:"ready",questions:w}),y.Z.endCurrentSession(),r.assistantMenuActions.openAssistantRightHandSideMenu({environment:t,from:"button",isReminder:!0,reminderType:"abandoned_search"})):f.Pf.setState({type:"idle"})}},5851:(e,t,n)=>{n.d(t,{n:()=>f,y:()=>g});n(57658);var o=n(9291),i=n(53965),r=n(1898),a=n(33929),s=n(81918),l=n(54642),c=n(47307),d=n(9953),u=n(29974),p=n(13447);const m=(0,o.defineMessages)({saveFieldError:{id:"securitySAMLSettings.saveSettingsError.message",defaultMessage:"Something went wrong."}});function f(e,t){const{securitySettingsState:n,spaceStore:o}=t,{disablePublicAccess:i,disableGuests:r,disableMoveToSpace:a,disableExport:s,disableSpacePageEdits:l,disablePublicAccessRequests:c,disableTeamCreation:d,disableMembershipRequests:m,disableExternalMembershipRequests:f,disableGuestMembershipRequests:g,enableAiFeature:h,disableTeamGuests:v,enableGuestInviteRequests:b,enableAiTraining:y}=n;return p.createAndCommit({userAction:"securitySettingsActions.saveSecuritySettings",environment:e,perform:t=>{u.Xr({environment:e,transaction:t,spaceStore:o,disablePublicAccess:i,disableGuests:r,disableMoveToSpace:a,disableExport:s,disableSpacePageEdits:l,disablePublicAccessRequests:c,disableTeamCreation:d,disableMembershipRequests:m,disableExternalMembershipRequests:f,disableGuestMembershipRequests:g,enableAiFeature:Boolean(h),disableTeamGuests:v,enableGuestInviteRequests:b,enableAiTraining:Boolean(y)})}})}function g(e,t){const{securitySettingsStore:n,spaceStore:o,fields:u}=t,f={...n.state},g={...n.state,...u};n.setState(g),void 0!==u.disableGuests&&(l.updateDisableGuestsOnSpace(e,{spaceId:o.id,newDisableGuestsValue:u.disableGuests,keepExistingGuests:Boolean(u.keepExistingGuests)}).then((e=>{if("failed"===e.type)return c.showErrorMessage(a.default.formatMessage(m.saveFieldError)),void n.setState(f)})),s.o8(e,{new_value:u.disableGuests,keep_existing_guests_if_disabled:Boolean(u.keepExistingGuests)})),p.createAndCommit({userAction:"SecuritySettings.saveToggle",environment:e,perform:e=>{e.postSubmitCallbacks.push((e=>{if(e)return c.showErrorMessage(a.default.formatMessage(m.saveFieldError)),void n.setState(f)}));const t=i.GM({disable_public_access:u.disablePublicAccess,disable_move_to_space:u.disableMoveToSpace,disable_export:u.disableExport,disable_space_page_edits:u.disableSpacePageEdits,disable_public_access_requests:u.disablePublicAccessRequests},(e=>i.kK(e)));d.sW({store:o,data:t,transaction:e});const s=i.GM({enable_guest_invite_requests:u.enableGuestInviteRequests,disable_membership_requests:u.disableMembershipRequests,disable_external_membership_requests:u.disableExternalMembershipRequests,disable_guest_membership_requests:u.disableGuestMembershipRequests},(e=>!(0,r.$K)(e)));Object.keys(s).length>0&&p.applyOperation({store:o,operation:{pointer:o.pointer,path:["settings"],command:"update",args:s},transaction:e})}}),(0,r.$K)(u.enableGuestInviteRequests)&&s.tB(e,{new_value:u.enableGuestInviteRequests})}},42858:(e,t,n)=>{n.d(t,{Ah:()=>ve,Cl:()=>se,DQ:()=>_e,DV:()=>Ce,MD:()=>oe,Od:()=>ne,QZ:()=>he,Qw:()=>ae,VJ:()=>ye,WG:()=>Se,YP:()=>we,ZJ:()=>ke,aO:()=>de,at:()=>pe,bj:()=>re,dK:()=>ge,is:()=>le,jQ:()=>be,mp:()=>ce,nG:()=>me,uE:()=>Ie,zO:()=>ie});n(57658),n(21703),n(52262),n(24506);var o=n(1302),i=n(15145),r=n(41432),a=n(21202),s=n(23867),l=n(82798),c=n(9291),d=n(53965),u=n(19584),p=n(75754),m=n(91851),f=n(10906),g=n(1600),h=n(27016),v=n(95477),b=n(27105),y=n(19037),_=n(28020),S=n(77181),w=n(40959),k=n(83105),I=n(33929),C=n(65598),x=n(41984),T=n(58202),M=n(95802),P=n(80444),A=n(807),R=n(77080),D=n(88923),E=n(6258),B=n(27724),F=n(81023),O=n(81193),Z=n(54642),V=n(30188),U=n(41433),L=n(47307),j=n(54532),N=n(54604),z=n(94419),q=n(19785),W=n(87420),H=n(8055),K=n(61045),G=n(24677),$=n(84084),Q=n(64964),Y=n(15690),J=n(98104),X=n(13447),ee=(n(68422),n(1742));const te=(0,c.defineMessages)({deletePages:{id:"action.deletePages.snackBarMessage",defaultMessage:"Moved to trash"}});function ne(e){var t,n;const{store:o,transaction:i}=e,r=M.C.findSelectablesFromStore(o).find((e=>Boolean(e.props.onRemove)));null==r||null===(t=(n=r.props).onRemove)||void 0===t||t.call(n,{transaction:i})}function oe(e){const{blocks:t,transaction:n}=e;if(1===t.length){const e=t[0];e&&C.PF(e)&&ne({store:e,transaction:n})}}function ie(e){const t=M.C.findAllSelectablesFromIds(e.map((e=>e.id)));for(const n of t)n.stores.selectableStore.setState({...n.stores.selectableStore.state,showActionIsInFlight:!0})}function re(e){const t=M.C.findAllSelectablesFromIds(e.map((e=>e.id)));for(const n of t)n.stores.selectableStore.setState({...n.stores.selectableStore.state,showActionIsInFlight:!1})}async function ae(e){const{environment:t,blocks:n,shouldCheckSuggestEdit:o}=e;if(n.length>0&&o){if("suggest"===A.Z.getMode(n[0]))return X.createAndCommit({userAction:"selectableBlockActions.removeBlocksWithMaybeConfirmation",environment:t,canUndo:!0,perform:e=>{n.forEach((n=>{(0,l.T)("suggest"!==A.Z.getState().blockStoreMode[n.id]),g.rl({environment:t,transaction:e,blockStore:n})}))}})}let i=!0;const r=[];for(const a of n){const e=T.R.findBlockFromStore(a);if(e&&d.mf(e.handleRemoveBlockFromComment)){if(await e.handleRemoveBlockFromComment())continue}else if(e&&d.mf(e.canRemoveBlock)){const t=await e.canRemoveBlock();if(!t.canRemove)return;i=t.canUndo}const n=await m.NN({environment:t,block:a,action:"delete"});if("user_canceled"===n)return;n.length>1?r.push(...n):r.push(a)}if(0===r.length)return;if(R.default.checkGate("collection_subitem_nested_operations")){if(!(await V.VP({environment:t,blocks:r,canUndo:i})))return}else{const{serverCommitResult:e}=X.createAndCommit({userAction:"selectableBlockActions.removeBlocksWithMaybeConfirmation",environment:t,canUndo:i,perform:e=>{se({environment:t,blocks:r,transaction:e})}});await e}const{currentSpaceStore:s}=P.default.state;s&&r.some((e=>e.isPageBlock()))&&Q.d4({item:{label:I.default.formatMessage(te.deletePages)},undoFunc:()=>{for(const e of r)Z.restoreBlock(t,{pointer:{table:a.iU,id:e.id,spaceId:e.pointer.spaceId||s.id}})}}),r.some((e=>{var t;return e.id===(null===(t=D.default.peekTarget.state)||void 0===t?void 0:t.id)}))&&W.xv(t,void 0)}function se(e){const{environment:t,blocks:n,transaction:o,preventClearSelection:i}=e,a=n[0],l=function(e){const t=M.C.getMembersByDOMOrder({filter:()=>!0}),n=d.cx(t,(t=>t.props.store===e)),o=t[n];if(!o)return;const i=o.getContextSelectableContainer(),r=d.tP(t,0,n),a=d.dF(r,(e=>e.props.canSelect&&e.getContextSelectableContainer()===i));if(a)return a.props.store;const s=d.tP(t,n+1).find((e=>Boolean(e.props.canSelect&&e.getContextSelectableContainer()===i)));if(s)return s.props.store}(a);!function(e){const{environment:t,block:n,entryPointName:o}=e,i=new ee.GD({environment:t,userFlow:"user_flow_delete_block",entryPointName:o,timeoutMs:90*u.C0});if(i.isDisabled())return;const r=()=>{n.pathIsDead()&&i.succeed()};i.postFinishCallbacks.push((()=>{n.removeListener(r)})),n.addListener(r)}({environment:t,block:a,entryPointName:o.getUserActionForAnalyticsPurposesOnly()||"selectableBlockActions.removeBlocks"});for(const r of n)ne({store:r,transaction:o});if(i||(G.ZH(t),G.Fp({pivot:l})),y._Jj({environment:t,blocks:n,publicEditMode:void 0})||y.NnH({environment:t,blocks:n,publicEditMode:void 0})||y.OOv({environment:t,blocks:n,publicEditMode:void 0})||n.some((e=>{var t;return e.getType()===r.Ti.transclusionContainer||(null===(t=e.getAssociatedCollectionStore())||void 0===t?void 0:t.isPageTreeCollection())}))){o.postSubmitCallbacks.push((e=>{e||Z.deleteBlocks(t,{blocks:n.map((e=>({id:e.id,spaceId:(0,s.C)(e.pointer.spaceId)}))),permanentlyDelete:!1})}));for(const e of n){const{app_id:n,app_config_uri:i}=e.getFormat();n&&i&&O.Cu(t,{block_id:e.id,app_id:n,app_config_uri:i}),q.zo({block:e,transaction:o})}H.CZ({environment:t,blocks:n})}i||J.ZH(t)}function le(e){const{environment:t,blocks:n,selection:o,transaction:i,replaceEmptyTextBlock:r,preventSetSelection:a,insertAfterBlock:s}=e,l=_.RM();if(!l)throw new Error("No root store.");let c;if(o.length>0){const e=s||o.at(-1);let a=e;if(Boolean(n.find((e=>e.isType("column_list"))))){const t=null==e?void 0:e.findRecordStoreUIAncestor((e=>e&&e instanceof E.G&&e.isType("column_list"))).ancestor;t&&t instanceof E.G&&(a=t)}const u=M.C.find((e=>e.props.store===a&&e.props.canInsertBelow&&e.props.onInsertBelow));if(u&&u.props.onInsertBelow)c=d.oA(u.props.onInsertBelow({insertStores:n,transaction:i})),r&&e&&e.isEmptyTextBlock()&&se({environment:t,blocks:[e],transaction:i});else{c=d.d9(n).reverse().map((e=>z.Ce({parent:l.getContentStore(),prepend:e,transaction:i}).child))}}else if(l.isCollectionView()){const e=T.R.findBlockFromStoreWithMethod(l,"insertBlocks");if(!e)throw new Error("No collection view found.");c=e.insertBlocks(n,i)}else{const e=l.getContentStore();c=n.map((t=>z.R3({parent:e,append:t,transaction:i}).child))}return Boolean(a)||(c=c.flatMap((e=>e.isType("column_list")?e.getContentStores().flatMap((e=>e.getContentStores())):[e])),G.Z5({environment:t,stores:c})),c}function ce(e){const{blocks:t}=e,n=t[0];if(n){const t=M.C.findSelectableFromStore(n);t&&t.props.onEnter&&t.props.onEnter(e)}}function de(e){const{environment:t,createBlockItem:n,selection:o,transaction:i,analyticsFrom:r,preventSetSelection:a}=e,s=B.default.getCurrentRecordCache(),l=new ee.BW({environment:t,userFlow:"page"===(null==n?void 0:n.blockType)?"user_flow_create_page":"user_flow_create_block",succeedOnEnqueue:!0});let c;if(F.M_(t)&&n&&s){var d;const e=U.fC({environment:t,createBlockItem:n,transaction:i,inMemoryRecordCache:s,from:r,useCrdt:0!==o.length?o[0].useCrdt():(null===(d=_.RM())||void 0===d?void 0:d.useCrdt())??!1,selection:o});l.track(e.pointer,i),c=le({environment:t,blocks:[e],selection:o,transaction:i,replaceEmptyTextBlock:!1,preventSetSelection:a})[0]}else l.fail("invalid_state");return c}function ue(e){const{environment:t,createBlockItem:n,selection:o,transaction:i,analyticsFrom:r}=e,a=B.default.getCurrentRecordCache();let s;if(F.M_(t)&&n&&a){var l;s=function(e){const{environment:t,selection:n,transaction:o}=e,{blocks:i}=e,r=_.RM();if(!r)throw new Error("No root store.");if(n.length>0){const e=n[0],r=M.C.find((t=>t.props.store===e&&t.props.canInsertAbove&&t.props.onInsertAbove));if(!r||!r.props.onInsertAbove)throw new Error("No Selectable found.");const a=r.props.onInsertAbove({insertStores:i,transaction:o});return G.Z5({environment:t,stores:a}),a}{const e=r.getContentStore(),n=i.map((t=>z.R3({parent:e,append:t,transaction:o}).child));return G.Z5({environment:t,stores:n}),n}}({environment:t,blocks:[U.fC({environment:t,createBlockItem:n,transaction:i,inMemoryRecordCache:a,from:r,useCrdt:0!==o.length?o[0].useCrdt():(null===(l=_.RM())||void 0===l?void 0:l.useCrdt())??!1,selection:o})],selection:o,transaction:i})[0]}return s}function pe(e){const{environment:t,selection:n,transaction:o}=e,i=de({...e,preventSetSelection:!0});i&&Ce({environment:t,insertedStores:[i],isCreated:!0}),oe({transaction:o,blocks:n})}async function me(e){const{environment:t,blocks:n,duplicateOnlyCollectionSchema:i,event:r}=e;if(!F.M_(t))return;let a=n;if(1===n.length){const e=await m.NN({environment:t,block:n[0],action:"duplicate"});if("user_canceled"===e)return;a=e}const s=R.default.checkGate("collection_subitem_nested_operations"),l=a.at(0);if(!l)return;const c=(0,f.fm)(l);if(s&&(0,S.vJ)(l,c))await V.W9({blocks:a,environment:t,analyticsFrom:"subitem_duplication"});else{const e=(0,b.Sy)({event:r,contextualDefault:0!==n.length&&n[0].useCrdt()});X.createAndCommit({userAction:"actionRegistry.duplicateToSelection",environment:t,perform:n=>{fe({environment:t,blocks:a,transaction:n,preferDuplicateLocation:"local",duplicateOnlyCollectionSchema:i,useCrdt:e})},transactionTooBigFallback:n=>{fe({environment:t,blocks:a,transaction:n,preferDuplicateLocation:"server",duplicateOnlyCollectionSchema:i,useCrdt:e})}})}o.default.afterNextFlush((()=>{K.Zv()}))}function fe(e){const{environment:t,blocks:n,transaction:o,preferDuplicateLocation:i,lastTopLevelBlock:r,preventSetSelection:a,duplicateOnlyCollectionSchema:l,useCrdt:c}=e,u=d.vM(n,(e=>e.getFormat().app_id??e.id)),p=[];return d.Ed(u,(e=>{const n=e[0],r=!n.isTransclusionType(),[a,d]=j.Qi({environment:t,stores:e,addCopyName:(0,x.Z)(n),transaction:o,deepCopyTransclusionContainers:r,resolveTemplateVariables:!(n.isInsideTemplate()||n.isInsideFactoryOrDuplicateBlocksAction()),targetSpaceId:(0,s.C)(n.pointer.spaceId),baseUrl:v.default.domainBaseUrl,publicDomainName:v.default.publicDomainName,preferDuplicateLocation:i,useCrdt:c,duplicateOnlyCollectionSchema:l});p.push(...a),d.then((e=>{e&&L.showErrorMessage(e)}))})),le({environment:t,blocks:p,selection:r?[r]:n,transaction:o,replaceEmptyTextBlock:!1,preventSetSelection:a}),p}function ge(e){const t=e.blocks[0],{blockLocationOfTargetBlock:n}=e,o=T.R.find((e=>e instanceof h.ZP&&e.props.store.id===t.id&&(!n||e.props.blockLocation===n)));if(o&&o.canRenderFullScreen()){const e=o.getFullScreenNodeRect(),n=e.width/e.height;N.ui({environment:o.environment,renderFullScreenNode:o.renderFullScreenNode,fullScreenNodeRect:e,contentAspectRatio:n,block:t})}}function he(e){let t;e.blocks.find((e=>{const n=T.R.findBlockFromStoreWithMethod(e,"activate");return!!n&&(t=n,!0)})),t&&t.activate&&t.activate()}function ve(e){e.blocks.forEach((t=>{const n=t.getParentStore();n&&n.table===a.iU&&n.getType()===r.Ti.tab&&Y.x2({store:n,id:t.id,currentUserId:e.environment.currentUser.id})}))}function be(e){const t=e.blocks[0],n=T.R.findBlockFromStoreWithMethod(t,"configure");n&&(n.configure(),O.PE(e.environment,{from:"block_action"}))}function ye(e){const t=e.blocks[0],n=T.R.findBlockFromStoreWithMethod(t,"caption");n&&n.caption()}function _e(e,t){const n=d.oA(M.C.findSelectablesFromIds(t)).map((e=>e.props.store));G.Z5({environment:e,stores:n})}function Se(e,t){const{blockIds:n,animate:o}=t,i=M.C.findScrollToSelectablesFromIds(n);i[0]&&(K.XW({handle:i[0],vertical:{reveal:"top"},horizontal:{reveal:"closest"},animate:o}),G.Z5({environment:e,stores:i.map((e=>e.props.store))}))}function we(e){const{environment:t,blocks:n}=e,o=n[0].findRecordStoreUIAncestor((e=>e instanceof E.G&&e.isCollectionView())).ancestor;o&&p._c({environment:t,store:o,visitType:k.vu.Link,pageVisitSource:i.tY.Expand})}function ke(e){const{blocks:t,transaction:n,environment:i}=e,r=de({environment:i,selection:t,createBlockItem:w.Hc.text,analyticsFrom:"text_insert_below",transaction:n});return r&&o.default.afterNextFlush((()=>{$.hb({environment:i,blockStore:r})})),r}function Ie(e){const{blocks:t,transaction:n,environment:i}=e,r=ue({environment:i,selection:t,createBlockItem:w.Hc.text,analyticsFrom:"text_insert_above",transaction:n});return r&&o.default.afterNextFlush((()=>{$.hb({environment:i,blockStore:r})})),r}function Ce(e){const{environment:t,insertedStores:n,isCreated:i}=e;i?o.default.afterNextFlush((()=>{const e=n[0];if(!e)return;const o=T.R.findBlockFromStoreWithMethod(e,"handleCreated");o?o.handleCreated():(G.Ys({environment:t,store:e}),G.Db(t))})):G.Z5({environment:t,stores:n})}},24677:(e,t,n)=>{n.d(t,{$Y:()=>B,Af:()=>F,Ch:()=>ee,DI:()=>K,Db:()=>j,FC:()=>$,Fp:()=>O,Jy:()=>X,KX:()=>M,OS:()=>R,Ys:()=>U,Z5:()=>V,ZH:()=>z,aw:()=>E,e2:()=>H,eP:()=>L,hn:()=>J,ji:()=>A,td:()=>Q,w5:()=>Y,wI:()=>Z,yu:()=>N,zJ:()=>q});n(57658);var o=n(55010),i=n(1302),r=n(95371),a=n(53965),s=n(75330),l=n(77181),c=n(28314),d=n(69645),u=n(35328),p=n(27406),m=n(16339),f=n(95802),g=n(44534),h=n(12211),v=n(50628),b=n(27724),y=n(45131),_=n(30188),S=n(89951),w=n(67060),k=n(61045),I=n(84084),C=n(98104),x=n(29373),T=n(13447);function M(){const e=b.default.getCurrentDefaultContainer();if(e){return f.C.getMembersByDOMOrder({filter:t=>t.getContextSelectableContainer()===e&&t.props.canSelect}).map((e=>e.props.store))}return[]}function P(e){const t=b.default.state.stores,n=b.default.state.pivot,o=a.oA(a.zu(t,n));let i;i=n===a.Z$(t)?t[t.length-2]:t[1],V({environment:e,stores:o,pivot:i})}function A(e){const t=c.yA();return e.device.isMac?t.shift&&t.command:t.shift&&t.option}function R(){return c.yA().shift}function D(e){e.sort(((e,t)=>(0,o.Z)(f.C.findNodeFromStore(e),f.C.findNodeFromStore(t))))}function E(e){const t=new Array(e.length);return f.C.forEach((n=>{if(n.props.canSelect){const o=e.indexOf(n.props.store);if(o>=0){const e=n.getNode();e&&(t[o]=e)}}})),e.filter(((n,o)=>{const i=t[o];return n&&!e.some(((e,n)=>{const o=t[n];return Boolean(o&&o!==i&&i&&o.contains(i))}))}))}function B(e){b.default.setState({...b.default.state,phase:e.phase}),e.phase===b.SelectionPhase.Editing||e.preventClearEditingText||C.ZH(e.environment)}function F(e){const{stores:t}=e,n=b.default.state.stores,o=a.G0(t,n);o.length===t.length&&o.length===n.length||b.default.setState({...b.default.state,stores:e.stores}),t.length>0&&(s.wG(),g.g$.blockSelectionInSimpleTable(t)||g.HM.clearSelection())}function O(e){b.default.setState({...b.default.state,pivot:e.pivot})}function Z(e){const{stores:t}=b.default.state;F({stores:t.map((t=>t===e.store?e.replace:t))})}function V(e){const{environment:t}=e,n=E(e.stores);F({stores:n}),B({environment:e.environment,phase:e.phase||b.SelectionPhase.Selected}),1===n.length&&function(e){var t;const n=e.anchor,o=null===(t=f.C.findSelectableFromStore(n))||void 0===t?void 0:t.getNode();let i;o&&(i=b.default.getDefaultContainerFromTarget(o)),b.default.setState({...b.default.state,anchor:n,anchorContainer:i})}({anchor:n[0]});const o=e.pivot||n[0];if(O({pivot:o}),i.default.afterNextFlush((()=>{D(n)})),e.phase===b.SelectionPhase.Editing&&o)if(t.device.isMobile)k.hQ(t);else if(!t.device.isMobileBrowser){const e=f.C.findScrollToSelectableFromStore(o);e&&k.XW({handle:e,vertical:{reveal:"closest"},horizontal:e.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function U(e){void 0===e.toggle&&(e.toggle=!1),void 0===e.selectBetween&&(e.selectBetween=!1);const{stores:t}=b.default.state;if(e.toggle)a.q9(t,e.store)?V({environment:e.environment,stores:a.zu(t,e.store)}):V({environment:e.environment,stores:a.G0(t,[e.store])});else if(e.selectBetween){let n=a.d9(t);const o=M(),i=o.indexOf(e.store);a.q9(n,e.store)||n.push(e.store);const r=t[0];if(r){const e=o.indexOf(r);if(e>=0){const t=a.tP(o,i,e);n=a.G0(n,t)}}const s=a.Z$(t);if(s){const e=o.indexOf(s);if(e>=0){const t=a.tP(o,e,i);n=a.G0(n,t)}}V({environment:e.environment,stores:n})}else a.q9(t,e.store)||V({environment:e.environment,stores:[e.store]});B({environment:e.environment,phase:b.SelectionPhase.Selected})}function L(e){const{environment:t,store:n}=e;if(n)if(F({stores:[n]}),O({pivot:void 0}),B({environment:t,phase:b.SelectionPhase.Editing}),t.device.isMobile)k.hQ(t);else if(!t.device.isMobileBrowser){const e=f.C.findScrollToSelectableFromStore(n);e&&k.XW({handle:e,vertical:{reveal:"closest"},horizontal:e.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function j(e){const{stores:t}=b.default.state,n=t[0];if(!n)return;const o=f.C.findSelectableFromStore(n);if(o&&o.props.onEditText){const t=o.props.onEditText;T.createAndCommit({userAction:"selectionActions.editSelection",environment:e,perform:e=>{t({isAtStartOfLine:!1,isClick:!1,transaction:e})}})}}function N(e){const{environment:t,stores:n}=e,o=a.Z$(n);if(!o)return;const i=f.C.findSelectableFromStore(o);if(i&&i.props.onEditText){const e=i.props.onEditText;T.createAndCommit({userAction:"selectionActions.editStoresAtEnd",environment:t,perform:t=>{e({isAtStartOfLine:!1,isClick:!1,transaction:t})}})}}function z(e){F({stores:[]}),B({environment:e,phase:b.SelectionPhase.Selected}),w.xv(),I.xv(),S.xv()}function q(e){const{environment:t}=e,n=b.default.state.stores;D(n);const o=b.default.state.pivot,i=n[0];if(i)if(e.shiftKey)if(o===i){const o=(0,d.Bj)({includeNonSelectableListContainer:!1}),s=(0,d.v5)(i,o.children),{prev:l,parent:c}=e.altKey?(0,r.Sr)(o,s):(0,r.YL)(o,s);if(l){const e=l.value.store;V({environment:t,stores:a.G0(n,[e]),pivot:e})}else if(c){const e=c.value.store;V({environment:t,stores:a.G0(n.filter((e=>!(0,r.Yz)(c,(t=>t.store===e)))),[e]),pivot:e})}}else P(e.environment);else{const n=(0,d.Bj)({includeNonSelectableListContainer:!1}),o=(0,d.v5)(i,n.children),{prev:a,parent:s}=e.altKey?(0,r.Sr)(n,o):(0,r.YL)(n,o);if(a){const e=a.value.store;V({environment:t,stores:[e],pivot:e})}else if(s){const e=s.value.store;V({environment:t,stores:[e],pivot:e})}else V({environment:t,stores:[i],pivot:i})}else if(o)V({environment:t,stores:[o]});else{const e=M(),n=a.Z$(e);n&&V({environment:t,stores:[n],pivot:n})}W()}function W(){const e=b.default.state.pivot||b.default.state.stores[0],t=f.C.findScrollToSelectableFromStore(e);t&&k.XW({handle:t,vertical:{reveal:"top"},horizontal:t.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}function H(e){const t=b.default.state.stores;D(t);const n=b.default.state.pivot;if(0!==t.length&&n)if((0,u.BX)(n)&&y.Z.isOpen(n.id))V({environment:e,stores:[n],pivot:n}),x.rd({blockId:n.id,state:!1,currentUserId:e.currentUser.id});else if((0,l.bX)(n))_.e2(n);else{const t=(0,d.Bj)({includeNonSelectableListContainer:!1}),o=(0,d.v5)(n,t.children),i=(0,r.ub)(o);if(i){const t=i.value.store;V({environment:e,stores:[t],pivot:t})}else V({environment:e,stores:[n],pivot:n})}else if(n)V({environment:e,stores:[n]});else{const t=M(),n=a.Z$(t);n&&V({environment:e,stores:[n],pivot:n})}W()}function K(e){const{environment:t}=e,n=b.default.state.stores;D(n);const o=b.default.state.pivot,i=a.Z$(n);if(i)if(e.shiftKey)if(o===i){const e=(0,d.Bj)({includeNonSelectableListContainer:!1}),o=(0,d.v5)(i,e.children),{next:s}=(0,r.Xf)(e,o);if(s){const e=s.value.store;V({environment:t,stores:a.G0(n,[e]),pivot:e})}}else P(t);else{const n=(0,d.Bj)({includeNonSelectableListContainer:!1}),o=(0,d.v5)(i,n.children),{next:a}=e.altKey?(0,r.Xf)(n,o):(0,r.lj)(n,o);if(a){const e=a.value.store;V({environment:t,stores:[e],pivot:e})}else V({environment:t,stores:[i],pivot:i})}else if(o)V({environment:t,stores:[o]});else{const e=M()[0];e&&V({environment:t,stores:[e],pivot:e})}G()}function G(){const e=b.default.state.pivot||a.Z$(b.default.state.stores);if(e){const t=f.C.findScrollToSelectableFromStore(e);t&&k.XW({handle:t,vertical:{reveal:"bottom"},horizontal:t.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function $(e){const t=b.default.state.stores;D(t);const n=b.default.state.pivot;if(0!==t.length&&n)if((0,u.BX)(n)&&!y.Z.isOpen(n.id))V({environment:e,stores:[n],pivot:n}),x.rd({blockId:n.id,state:!0,currentUserId:e.currentUser.id});else if((0,l.bX)(n))_.FC(n);else{const t=(0,d.Bj)({includeNonSelectableListContainer:!1}),o=(0,d.v5)(n,t.children),i=(0,r.si)(o);if(i){const t=i.value.store;V({environment:e,stores:[t],pivot:t})}else V({environment:e,stores:[n],pivot:n})}else if(n)V({environment:e,stores:[n]});else{const t=M()[0];t&&V({environment:e,stores:[t],pivot:t})}G()}function Q(e){const t=M();V({environment:e,stores:t,pivot:t[0]})}function Y(e){const t=M()[0];if(t){V({environment:e,stores:[t],pivot:t});const n=f.C.findScrollToSelectableFromStore(t);n&&k.XW({handle:n,vertical:{reveal:"top"},horizontal:n.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function J(e){const t=M(),n=t[t.length-1];if(n){V({environment:e,stores:[n],pivot:n});const t=f.C.findScrollToSelectableFromStore(n);t&&k.XW({handle:t,vertical:{reveal:"bottom"},horizontal:t.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function X(){const e=performance.now(),t=new Map,n=new Map;f.C.forEach((e=>{const o=e.getNode();if(o&&o instanceof Element){const i=o.getBoundingClientRect();t.set(e,i),n.set(o,i)}}));const o=new Map;m.Z.forEach((e=>{const t=e.getNode();t&&t instanceof Element&&o.set(e,t.getBoundingClientRect())}));const i=new Map;p.Z.forEach((e=>{const t=e.getNode();t&&t instanceof Element&&i.set(e,t.getBoundingClientRect())})),v.Z.setState({...v.Z.state,selectableRectMap:t,selectableContainerRectMap:o,selectableElementRectMap:n,lastUpdate:e}),h.Z.setState({...h.Z.state,dropTargetRectMap:i})}const ee=a.P2(X,200)},84084:(e,t,n)=>{n.d(t,{RL:()=>I,_P:()=>w,hb:()=>k,pZ:()=>S,xv:()=>C});var o=n(13991),i=n(70203),r=n(69783),a=n(73959),s=n(89224),l=n(95802),c=n(5162),d=n(64233),u=n(19111),p=n(10743),m=n(36610),f=n(24677),g=n(993),h=n(98104);const v="/",b="ï¼›",y=new Set([v,"ï¼"]),_={"ja-JP":new Set([b])};function S(){return"ja-JP"===o.SP?b:v}function w(e){const{environment:t,textStore:n,oldSelection:a,oldTextValue:l,isAddMenu:f=!!(0,c.Y)("supportsNativeMobileDynamicActionBar")}=e,g=i.eeV(n.getValue()||[]),h=a.startIndex,v=g[h],b=_[o.SP]||new Set;if(!y.has(v)&&!b.has(v))return;const S=i.gPn(g,h-10,h).join("");if(/[0-9]$/.test(S[S.length-1]))return;if(S.endsWith("http:")||S.endsWith("http:/")||S.endsWith("https:")||S.endsWith("https:/"))return;if(p.Z.state.open||r.Z.state.open||u.Z.state.open||d.Z.state.open)return;if(!(0,c.Y)("supportsNativeMobileDynamicActionBar")&&t.device.isPhone)return;const w=s.get();if(!w)return;const k=s.getRect(w);k&&(p.Z.setState({open:!0,isAddMenu:f,textStore:n,oldTextValue:l,oldSelection:a,selectionRect:k,lettersAtLastResult:0,filter:""}),m.V_(t))}function k(e){const{environment:t,blockStore:n}=e,o=p.Z.state;if(f.eP({environment:t,store:n}),h.N_({store:n.getBlockTitleStore()}),!o.open&&!t.device.isPhone){const e=n.getBlockTitleStore(),t=l.C.getRectFromStore(n);t&&p.Z.setState({open:!0,isAddMenu:!0,textStore:e,oldTextValue:e.getValue(),oldSelection:{startIndex:0,endIndex:0},selectionRect:t,lettersAtLastResult:0,filter:""})}}function I(e){const{transaction:t,environment:n}=e,o=p.Z.state;if(o.open){const{textStore:e,oldTextValue:i,oldSelection:r}=o;g.sO({environment:n,editorMode:"default",store:e,value:i,transaction:t}),C();const s=(0,a.sQ)(e);s&&f.eP({environment:n,store:s}),h.Z5({store:e,selection:r})}}function C(){p.Z.setState({open:!1,previousFilter:p.Z.state.open?p.Z.state.filter:void 0})}},64964:(e,t,n)=>{n.d(t,{C1:()=>d,d4:()=>c,oV:()=>s,rN:()=>l});n(67294);var o=n(15828),i=n(6854),r=n(1310),a=n(85893);function s(e){const t={...e,key:(0,o.ZP)()};r.ZP.setState({...r.ZP.state,currentItem:t}),"keep"!==t.durationMs&&setTimeout((()=>{r.ZP.state.currentItem===t&&"keep"!==r.ZP.state.currentItem.durationMs&&r.ZP.setState({...r.ZP.state,currentItem:void 0})}),t.durationMs??r.Ty)}function l(){r.ZP.setState({...r.ZP.state,currentItem:void 0})}function c(e){const{item:t,undoFunc:n}=e;s({...t,right:(0,a.jsx)(i.ow,{onUndo:n})})}function d(){r.ZP.state.shouldReset&&r.ZP.reset()}},29974:(e,t,n)=>{n.d(t,{$F:()=>be,BR:()=>_e,F1:()=>ge,IY:()=>Me,L5:()=>he,LV:()=>Le,Ns:()=>Te,O2:()=>Ae,OF:()=>we,Xr:()=>ke,Xv:()=>Ee,Y5:()=>Ze,Yi:()=>ve,_Q:()=>Be,_u:()=>Se,bR:()=>Ue,bf:()=>xe,ce:()=>me,eX:()=>pe,j:()=>Ce,jF:()=>De,lF:()=>Pe,mo:()=>Re,oy:()=>Fe,u3:()=>ye,wg:()=>Ve,wh:()=>ue,y3:()=>fe,ys:()=>Ie});n(21703),n(57658),n(67294);var o=n(15145),i=n(68626),r=n(72141),a=n(45953),s=n(21202),l=n(75246),c=n(77858),d=n(29369),u=n(66079),p=n(90965),m=n(54153),f=n(9291),g=n(53965),h=n(52629),v=n(7032),b=n(26249),y=n(1898),_=n(75754),S=n(81598),w=n(95477),k=n(97978),I=n(15010),C=n(33929),x=n(46654),T=n(48779),M=n(95697),P=n(55081),A=n(10929),R=n(30806),D=n(94841),E=n(78861),B=n(80444),F=n(21273),O=n(88632),Z=n(21051),V=n(69327),U=n(81236),L=n(6258),j=n(81023),N=n(70060),z=n(33493),q=n(91536),W=n(14549),H=n(81918),K=n(54642),G=n(35253),$=n(47307),Q=n(57400),Y=n(94273),J=n(94419),X=n(92625),ee=n(29533),te=n(76464),ne=n(9953),oe=n(4408),ie=n(8055),re=n(5851),ae=n(28014),se=n(13447),le=n(70782),ce=n(85893);const de=(0,f.defineMessages)({deletingWorkspace:{id:"spaceActions.deletingWorkspace.loadingMessage",defaultMessage:"Deleting workspaceâ€¦"},goOnlineCreateSpace:{defaultMessage:"Please go online to create your workspace.",id:"spaceActions.dialogError.createWorkspaceError.goOnline.message"},createSpaceError:{defaultMessage:"Sorry! We could not create your workspace. Please try again.",id:"spaceActions.dialogError.createWorkspaceError.message"},loginToCreateSpace:{defaultMessage:"Must be logged in.",id:"spaceActions.dialogError.createWorkspaceError.notLoggedIn.message"},moveToSpaceOnlineError:{defaultMessage:"Please go online to move content to another space.",id:"spaceActions.dialogError.moveContentError.goOnline.message"},cannotMoveShardRestriction:{defaultMessage:"Cannot move these pages at once.",id:"spaceActions.dialogError.moveContentError.cannotMovePages.message"},cannotMoveContent:{defaultMessage:"Sorry! We could not move this content. Please try again.",id:"spaceActions.dialogError.couldNotMoveContentError.message"},loginToMoveContent:{defaultMessage:"Must be logged in.",id:"spaceActions.dialogError.movetoWorkspace.notLoggedIn.message"},invalidSpaceStore:{defaultMessage:"Invalid space data.",id:"spaceActions.dialogError.createTemplatesInSpace.invalidStorage.message"},invalidSpaceStoreOnNavigate:{defaultMessage:"Invalid space data.",id:"spaceActions.dialogError.navigateToWorkspace.invalidStorage.message"},noSpaceViewOnJoin:{defaultMessage:"No space view data was created.",id:"spaceActions.dialogError.joinWorkspace.invalidWorkspaceStorage.message"},noLocalDataForPermissionGroup:{defaultMessage:"No local data about this workspace.",id:"spaceActions.dialogError.createOrUpdatePermissionGroup.invalidWorkspaceStorage.message"}});async function ue(e){const{environment:t,name:n,domain:o,userRootStore:r,emailDomains:a,analyticsFrom:s,icon:p,planType:m,userPersona:f,shouldCreateUserPersonaTeam:h,shouldMakeUserPersonaTeamDefault:v}=e,{id:b}=t.currentUser;if(b){const e=await K.createSpace(t,{name:n,domain:o,emailDomains:a,icon:p,planType:m,initialPersona:f,shouldCreateUserPersonaTeam:h,shouldMakeUserPersonaTeamDefault:v});if("failed"===e.type){if(e.offline)throw new Error(C.default.formatMessage(de.goOnlineCreateSpace));throw new Error(C.default.formatMessage(de.createSpaceError))}const{spaceId:y,teamId:_,personaTeamId:S,inviteLinkCode:w}=e.data,k=new L.H2(t,{table:l.bx,id:y}),x=_?L.zX.createChildStore(k,{table:d.e0,id:_}):void 0,T=S?L.zX.createChildStore(k,{table:d.e0,id:S}):void 0,{serverCommitResult:M,performResult:{spaceViewStore:P}}=se.createAndCommit({userAction:"spaceActions.createSpace",environment:t,perform:e=>{const n=ne.ae({environment:t,table:c.zU,value:{space_id:k.id,notify_mobile:!0,notify_desktop:!0,notify_email:!0,parent_id:b,parent_table:u.dx,alive:!0,joined:!0,joined_teams:(x||T)&&g.oA([null==x?void 0:x.id,null==T?void 0:T.id]),settings:{notify_email_digest:!0}},inMemoryRecordCache:r.inMemoryRecordCache,transaction:e}),o=new L.V9(t,n.pointer);return J.R3({parent:r.getSpaceViewsStore(),append:n,transaction:e}),J.MK({parent:r.getSpaceViewPointersStore(),append:n,transaction:e}),t.device.isMobileNative&&i.log({level:"info",from:"spaceActions",type:"SpaceSwitchingDebug",data:{message:"spaceActions.createSpace setting space"}}),B.default.setState({...B.default.state,currentSpaceStore:k,currentSpaceViewStore:o}),H.VT(t,{from:s,planType:m,isProfessionalTeamUser:(0,I.QZ)(),domain_type:(0,I.JF)()}),{spaceViewStore:o}}});return await M,await Q.Yh(t),{spaceViewStore:P,spaceStore:k,inviteLinkCode:w,teamStore:x,personaTeamStore:T}}throw new Error(C.default.formatMessage(de.loginToCreateSpace))}async function pe(e){const{environment:t,blockStores:n,spaceId:o,targetParent:r}=e,{id:l}=t.currentUser;if(l){if(!O.Z.state.online)return{error:C.default.formatMessage(de.moveToSpaceOnlineError)};const e=[],u=[];for(const t of n)t.isDefined()&&(e.push({id:t.id,spaceId:t.getSpaceId()}),u.push(o));if(g.jj(u).length>1)return{error:C.default.formatMessage(de.cannotMoveShardRestriction)};if(r&&r.spaceId!==o)return{error:C.default.formatMessage(de.cannotMoveShardRestriction)};const p=K.moveToSpace(t,{blocks:e,targetSpaceId:o,targetParent:r,clearPermissions:(0,M.bq)()});let m;for await(const n of p){if(ee.R(n,o),n.error)return k.j(t,"move_to_space_error",{}),i.log({level:"error",from:"spaceActions",type:"moveSpaceError",error:(0,h.Ui)(n.error),data:{userId:l,blocks:e,spaceId:o}}),{error:C.default.formatMessage(de.cannotMoveContent)};{const e=a.PF.create(n.value.recordMap).getByTable(s.iU);for(const{value:t}of e){var c,d;if("copy_indicator"===(null==t||null===(c=t.value)||void 0===c?void 0:c.type))m=null==t||null===(d=t.value)||void 0===d?void 0:d.id}}}return ee.h(o),{value:m}}return{error:C.default.formatMessage(de.loginToMoveContent)}}async function me(e){const{environment:t,spaceViewStore:n,openInNew:o,isNewlyCreatedSpace:r,leavingSpace:a}=e;await n.awaitNonNullValue();const s=n.getSpaceStore();if(!s)throw new Error(C.default.formatMessage(de.invalidSpaceStoreOnNavigate));if(!o&&(G.qL({bannerStore:Z.Z,id:"SubscriptionEditingBlocker"}),t.device.isMobileNative&&i.log({level:"info",from:"spaceActions",type:"SpaceSwitchingDebug",data:{message:"spaceActions.switchToSpace",spaceId:s.id}}),B.default.setState({...B.default.state,currentSpaceStore:s,currentSpaceViewStore:n}),a)){const e=await(0,T.rg)(t,n);B.default.setState({...B.default.state,mainEditorCurrentBlockStore:e})}z.Z.reset();const l=t.currentUser.id,c=n.getUserRootParentId();if(c&&l!==c){const e=await le.x({environment:t,newCurrentUserId:c});await j.OR({environment:e,spaceId:s.id,isNewlyCreatedSpace:r});const{currentUserSettingsStore:n,currentUserRootStore:o}=B.default.state;return{switchedUser:!0,newEnvironment:e,newUserRootStore:o,newUserSettingsStore:n}}return await j.OR({environment:t,spaceId:s.id,isNewlyCreatedSpace:r}),{switchedUser:!1}}async function fe(e){B.default.setState({...B.default.state,spaceTransitionStatus:e.navigationType}),await async function(e){const{spaceViewStore:t,redirectPageId:n,openInNew:r,isNewlyCreatedSpace:a,templateGalleryItem:l,projectManagementLaunch:c,leavingSpace:d,pageVisitSource:u}=e;let{environment:p,userSettingsStore:m,userRootStore:f}=e;const g=t.getSpaceStore();if(!g)throw new Error(C.default.formatMessage(de.invalidSpaceStoreOnNavigate));const h=await me({environment:p,spaceViewStore:t,openInNew:r,isNewlyCreatedSpace:a,leavingSpace:d});h.switchedUser&&(p=h.newEnvironment,m=h.newUserSettingsStore,f=h.newUserRootStore),F.Z.isAiEnabled()&&S.L6.loader().then((e=>{let{assistantActions:t}=e;t.clearAllAssistantSessions()}));const v=f&&f.getSpaceViewStores(),b=T.g4(p,null==t?void 0:t.getModel()),y=D.Al(t);if(n)return void _._c({environment:p,store:new L.G(p,{table:s.iU,id:n}),openInNew:r,pageVisitSource:u});if(f&&await V.Z.reinitializeState(p,f.id,g.id),"last_visited_page"===b){const e=ge({environment:p,spaceId:g.id});if(e&&e.canRead()&&e.pathIsAccessibleAndAlive()&&!x.IJ(p,e))return void _._c({environment:p,store:e,openInNew:r,templateGalleryItem:l,projectManagementLaunch:c,pageVisitSource:o.tY.LastVisitedPage})}if("personal_home"===b&&y&&(await y.load(),y.canRead()))return _._c({environment:p,store:y,openInNew:r,templateGalleryItem:l,projectManagementLaunch:c,pageVisitSource:o.tY.DefaultHome}),void(0,R.$X)({environment:p,from:"on_app_start_page"});if("chat"===b)return void ie.c4({environment:p,url:"/chat"});const w=await(0,T.rg)(p,t);if(w)_._c({environment:p,store:w,openInNew:r,templateGalleryItem:l,projectManagementLaunch:c,pageVisitSource:u});else if(g.canEdit()){const{performResult:e}=se.createAndCommit({userAction:"spaceActions.createdPage",environment:p,perform:e=>ae.KE({environment:p,spaceStore:g,spaceViewStore:t,isPrivate:!0,transaction:e,prepend:!1})});_._c({environment:p,store:e,openInNew:r,pageVisitSource:u})}else{if(m&&f&&v&&v.length>0&&v[0]&&v[0].id!==t.id)return Y.vq(),p.device.isMobileNative&&i.log({level:"info",from:"spaceActions",type:"SpaceSwitchingDebug",data:{message:"navigateToFirstSpace because navigateToSpace didn't find a page"}}),void(await he({environment:p,userRootStore:f,userSettingsStore:m,openInNew:r,pageVisitSource:u}));Y.vq(),await P.xN(p)}}(e),await Q.Yh(e.environment),B.default.setState({...B.default.state,spaceTransitionStatus:"notTransitioning"})}function ge(e){const{spaceId:t}=e,n=V.Z.getWithoutSubscribing(t);if(!Array.isArray(n))return;const o=n[0];return void 0!==(null==o?void 0:o.pageId)?o.store:void 0}async function he(e){const{environment:t,userRootStore:n,ignoreSpaceId:o,userSettingsStore:i,openInNew:r,skipPendingTransferWorkspaces:a,leavingSpace:s,templateGalleryItem:l,projectManagementLaunch:c,pageVisitSource:d}=e;await n.load();const u=n.getSpaceViewStores();await Promise.all(u.map((e=>e.load())));const m=u.filter((e=>{var t;return!!e.isDefined()&&(o?e.getSpaceId()!==o:!a||!(0,p.DI)(null===(t=e.getSpaceStore())||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.space_request))}));let f;for(const p of m){if(!T.Cx(p.getSpaceStore())){f=p;break}{const e=await(0,T.rg)(t,p);if(e&&e.isDefined()){f=p;break}}}f?await fe({environment:t,spaceViewStore:f,userSettingsStore:i,userRootStore:n,openInNew:r,leavingSpace:s,templateGalleryItem:l,projectManagementLaunch:c,pageVisitSource:d,navigationType:"switchingToOrLoadingSpace"}):(Y.vq(),await P.xN(t))}async function ve(e){const{environment:t,index:n,userRootStore:i,userSettingsStore:r}=e,a=E.Z.getAllSpaceViewStores(t)[n];a&&await fe({environment:t,spaceViewStore:a,userSettingsStore:r,userRootStore:i,pageVisitSource:o.tY.SwitchSpace,navigationType:"switchingToOrLoadingSpace"})}async function be(e){const{environment:t,spaceStore:n}=e;n.isDefined()&&!(0,b.Z)(n.getEmailDomains(),e.emailDomains)&&W.xG(t,{domains:e.emailDomains||[],confirmed:!0});const o={email_domains:e.emailDomains};e.name&&(o.name=e.name);const i={};for(const r of(0,y.Yd)(o)){const e=n.getKeyStore(r).getValue(),t=o[r];g.Xy(e,t)||(i[r]=t||null)}g.xb(i)||await new Promise(((e,o)=>{se.createAndCommit({userAction:"spaceActions.updateSpace",environment:t,perform:t=>{ne.sW({store:n,data:i,transaction:t}),t.postSubmitCallbacks.push((t=>{t?o(t):e()}))}})}))}async function ye(e){const{environment:t,spaceId:n,domain:o}=e,i=U.Z.getData(t,{spaceId:n});(null==i?void 0:i.domain)!==o&&(await K.updateSpaceDomain(t,{spaceId:n,domain:o}),U.Z.getData(t,{spaceId:n},!0))}async function _e(e){const{environment:t,spaceId:n,publicHomePage:o}=e,i=U.Z.getData(t,{spaceId:n});(null==i?void 0:i.publicHomePage)!==o&&(await K.updatePublicHomePage(t,{spaceId:n,publicHomePage:o}),U.Z.getData(t,{spaceId:n},!0))}function Se(e){const{environment:t,spaceStore:n,domain:o}=e,{currentUserStore:i}=B.default.state;return K.checkSpaceDomain(t,{spaceId:n.id,domain:o},null==i?void 0:i.id)}async function we(e){const{environment:t,spaceStore:n,spaceBasicSettingsStore:o,securitySettingsStore:i}=e,{name:r,domain:a,emailDomains:s,publicHomePage:l}=o.state;await Promise.all([be({environment:t,spaceStore:n,name:r,emailDomains:s}),ye({environment:t,spaceId:n.id,domain:a}),_e({environment:t,spaceId:n.id,publicHomePage:l}),i?re.n(t,{spaceStore:n,securitySettingsState:i.state}):Promise.resolve()])}function ke(e){const{environment:t,transaction:n,spaceStore:o,disablePublicAccess:i,disableGuests:r,disableMoveToSpace:a,disableExport:s,disableSpacePageEdits:l,disablePublicAccessRequests:c,disableTeamCreation:d,disableMembershipRequests:u,disableExternalMembershipRequests:p,disableGuestMembershipRequests:m,enableAiFeature:f,disableTeamGuests:g,enableGuestInviteRequests:h,enableAiTraining:v}=e;ne.sW({store:o,data:{disable_public_access:i,disable_guests:r,disable_move_to_space:a,disable_export:s,disable_space_page_edits:l,disable_public_access_requests:c,settings:{...o.getSettings(),enable_ai_feature:f,disable_team_guests:g,enable_guest_invite_requests:h,enable_ai_training:v},disable_team_creation:d},transaction:n}),se.applyOperation({store:o,operation:{pointer:o.pointer,path:["settings","disable_membership_requests"],command:"set",args:u},transaction:n}),se.applyOperation({store:o,operation:{pointer:o.pointer,path:["settings","disable_external_membership_requests"],command:"set",args:p},transaction:n}),se.applyOperation({store:o,operation:{pointer:o.pointer,path:["settings","disable_guest_membership_requests"],command:"set",args:m},transaction:n}),c&&q.Jp(t,{disable_public_access_requests:c})}function Ie(e){const{transaction:t,spaceStore:n,inviteLinkEnabled:o}=e;ne.sW({store:n,data:{invite_link_enabled:o},transaction:t})}async function Ce(e){const{environment:t,spaceId:n,userRootStore:r,navigate:a,analyticsFrom:s,userSettingsStore:l,redirectPageId:c,inviteCode:d}=e,u=r.getSpaceViewStores().find((e=>e.getSpaceId()===n));if(w.default.isAdminMode||K.setSpaceNotificationsAsRead(t,{timestamp:Date.now(),spaceId:n}),u)return!0!==u.getJoined()&&se.createAndCommit({userAction:"spaceActions.joinSpace",environment:t,perform:e=>{Oe({spaceViewStore:u,transaction:e})}}),a&&await fe({environment:t,spaceViewStore:u,userSettingsStore:l,redirectPageId:c,userRootStore:r,pageVisitSource:o.tY.SwitchSpace,navigationType:"switchingToOrLoadingSpace"}),{spaceViewStore:u};{const u=await K.addUsersToSpace(t,{userIds:[r.id],spaceId:e.spaceId,inviteCode:d});if("failed"===u.type)throw u.body&&u.body.clientData&&"invite_link_disabled"===u.body.clientData.type&&m.Z.remove(A.WX),i.log({level:"error",from:"spaceActions",type:"addUsersToSpace",error:(0,h.Ui)(u.error),data:{miscDataToConvertToString:{response:u}}}),u.error;const p=r.getSpaceViewStores();await Promise.all(p.map((e=>e.load())));const f=p.find((e=>e.getSpaceId()===n));if(!f)throw new Error(C.default.formatMessage(de.noSpaceViewOnJoin));const g=f.getJoined();if(!0!==g&&se.createAndCommit({userAction:"spaceActions.joinSpace",environment:t,perform:e=>{Oe({spaceViewStore:f,transaction:e})}}),a&&await fe({environment:t,spaceViewStore:f,userSettingsStore:l,redirectPageId:c,userRootStore:r,pageVisitSource:o.tY.SwitchSpace,navigationType:"joiningOrCreatingSpace"}),j.OR({environment:t,spaceId:e.spaceId}).then((()=>{H.kj(t,{from:s})})),m.Z.remove(A.WX),t.device.isMobileNative&&i.log({level:"info",from:"spaceActions",type:"SpaceSwitchingDebug",data:{message:"spaceActions.joinSpace"}}),B.default.setState({...B.default.state,currentSpaceStore:f.getSpaceStore(),currentSpaceViewStore:f}),Q.Th({environment:t,force:!0}),await Q.Yh(t),!0!==g){const e=d?"shareable_link_join":"verified_domain_join";H.Jk(t,{invite_origin:e,domainType:(0,I.JF)(),new_workspace_member_count:1,new_workspace_member_ids:[r.id]})}return{spaceViewStore:f}}}async function xe(e){const{environment:t,spaceId:n,userSettingsStore:i}=e,{currentUserRootStore:r,currentUserStore:a}=B.default.state;if(r&&a){const e=await K.removeUsersFromSpace(t,{userIds:[a.id],spaceId:n,removePagePermissions:!0,revokeUserTokens:!1});return"success"===e.type?(he({environment:t,userRootStore:r,ignoreSpaceId:n,userSettingsStore:i,leavingSpace:!0,pageVisitSource:o.tY.SwitchSpace}),!0):($.showError(e),!1)}}async function Te(e){const{environment:t,spaceId:n,userSettingsStore:i}=e,{currentUserRootStore:r,currentUserStore:a}=B.default.state;if(r&&a){X.j({message:de.deletingWorkspace});try{const{value:e}=await K.deleteSpace(t,{spaceId:n}).next();if(e.error)throw e.error;await oe.bG({environment:t,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,pointer:{table:u.dx,id:r.id},userId:t.currentUser.id}),he({environment:t,userRootStore:r,ignoreSpaceId:n,userSettingsStore:i,pageVisitSource:o.tY.SwitchSpace})}finally{X.x()}}}function Me(e){const{environment:t,blocks:n,transaction:o}=e,i=t.currentUser.id;if(i)for(const a of n){const e=a.getPermissionItems().filter((e=>(0,r.FB)(e)));ne.sW({store:a,data:{permissions:[...e,{type:"user_permission",role:"editor",user_id:i}]},transaction:o})}}function Pe(e){const{environment:t,blocks:n,transaction:o}=e;if(t.currentUser.id)for(const i of n){const e=i.getPermissionItems(),n=e.find((e=>"space_permission"===e.type)),a=e.filter((e=>(0,r.FB)(e)));n||te.ep({environment:t,store:i,permissionItems:[...a,{type:"space_permission",role:"editor"}],transaction:o})}}function Ae(e){const{blocks:t,transaction:n}=e;for(const o of t){const e=o.getPermissionItems().filter((e=>(0,r.FB)(e)));ne.sW({store:o,data:{permissions:e.length>0?e:null},transaction:n})}}function Re(e){const{spaceStore:t,transaction:n}=e;if(!t.isDefined())throw new Error(C.default.formatMessage(de.noLocalDataForPermissionGroup));const o=Date.now(),i={id:(0,v.ZP)(),last_edited_time:o};return se.applyOperation({store:t,operation:{pointer:t.pointer,path:[...t.path,"permission_groups"],command:"keyedObjectListBefore",args:{value:i}},transaction:n}),i}function De(e){const{spaceStore:t,group:n,transaction:o}=e;if(!t.isDefined())throw new Error(C.default.formatMessage(de.noLocalDataForPermissionGroup));se.applyOperation({store:t,operation:{pointer:t.pointer,path:[...t.path,"permission_groups"],command:"keyedObjectListUpdate",args:{value:n}},transaction:o})}async function Ee(e){const{environment:t,spaceStore:n,group:o,transaction:i}=e;if(!n.isDefined())throw new Error(C.default.formatMessage(de.noLocalDataForPermissionGroup));se.applyOperation({store:n,operation:{pointer:n.pointer,path:[...n.path,"permission_groups"],command:"keyedObjectListRemove",args:{remove:{id:o.id}}},transaction:i}),await K.transferPermissionGroup(t,{spaceId:n.id,groupId:o.id})}function Be(e){const{userRootStore:t,spaceViewIds:n,transaction:o,spaceViewPointers:i}=e;ne.sW({store:t,data:{space_views:n,space_view_pointers:i},transaction:o})}function Fe(e){const{planType:t,spaceStore:n,transaction:o}=e;ne.sW({store:n,data:{plan_type:t},transaction:o})}function Oe(e){ne.sW({store:e.spaceViewStore,data:{joined:!0},transaction:e.transaction})}function Ze(e){let{domain:t,environment:n,spaceId:o}=e;return new Promise(((e,i)=>{const r=U.Z.getData(n,{spaceId:o});t!==(null==r?void 0:r.domain)&&null!=r&&r.hasPublicPages?$.showDialog({message:(0,ce.jsxs)("div",{style:{overflowWrap:"anywhere"},children:[(0,ce.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.changeWorkspaceDomain.prompt",defaultMessage:"This workspace has public pages. If you proceed with changing the domain, any existing links starting with {current_domain}.notion.site will no longer work.",values:{current_domain:(null==r?void 0:r.domain)||"your_domain"}}),(0,ce.jsx)("p",{}),(0,ce.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.changeWorkspaceDomain.areYouSure",defaultMessage:"Are you sure you want to change your domain?"})]}),showCancel:!1,keepFocus:!0,items:[{label:(0,ce.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.changeWorkspaceDomain.changeButton.label",defaultMessage:"Change"}),color:"red",onAccept:()=>e(!0)},{label:(0,ce.jsx)(f.FormattedMessage,{id:"spaceBasicSettings.changeWorkspaceDomain.cancelButton.label",defaultMessage:"Cancel"}),color:void 0,onAccept:()=>e(!1)}]}):e(!0)}))}function Ve(e,t,n){const o=n||B.default.state.currentSpaceStore;if(!o)throw i.log({level:"error",from:"spaceActions",type:"setSpaceSurveyData",error:{message:"Couldn't find a SpaceStore."}}),new Error;se.createAndCommit({userAction:"spaceActions.setSpaceSurveyData",environment:e,perform:e=>{je(o,e,{space_survey_data:t})}})}function Ue(e){const t=B.default.state.currentSpaceStore;t?(0,N.Gr)()&&se.createAndCommit({userAction:"spaceActions.setHideBlockLimitCounter",environment:e,perform:e=>{je(t,e,{exposed_to_hide_block_limit_counter:!0})}}):i.log({level:"error",from:"spaceActions",type:"setHideBlockLimitCounter",error:{message:"Couldn't find a SpaceStore to set show block limit earlier experiment."}})}function Le(e){const t=e.getEditDomain();return t?`${window.location.host}/${t}`:null}function je(e,t,n){se.applyOperation({store:e,operation:{pointer:e.pointer,path:["settings"],command:"update",args:{...e.getSettings(),...n}},transaction:t})}},28014:(e,t,n)=>{n.d(t,{Hj:()=>w,KE:()=>S,OQ:()=>k,cc:()=>I,sY:()=>_,ux:()=>C});n(21703);var o=n(41432),i=n(21202),r=n(70203),a=n(9291),s=n(7032),l=n(1898),c=n(33929),d=n(48779),u=n(77080),p=n(6258),m=n(81193),f=n(54532),g=n(3297),h=n(94419),v=n(9953),b=n(4408),y=n(993);const _=(0,a.defineMessages)({createAndDuplicatePageError:{defaultMessage:"Duplicated page could not be created.",id:"spaceActions.createAndDuplicatePageInSpace.copyNotCreated.error"},forkPageError:{defaultMessage:"Could not fork page.",id:"spaceActions.dialogError.forkPageError.message"}});function S(e){const{environment:t,spaceViewStore:n,spaceStore:i,isPrivate:r,prepend:a,title:s,transaction:l,loading:c,tracker:d}=e,p=Boolean(u.default.checkGate("enable_text_crdt_client")&&e.useCrdt),m=v.j4({environment:t,type:c?o.Ti.copyIndicator:o.Ti.page,inMemoryRecordCache:i.inMemoryRecordCache,transaction:l,spaceId:i.id,tracker:d,useCrdt:p});return s&&y.sO({environment:t,editorMode:"default",store:m.getBlockTitleStore(),value:[[s]],transaction:l}),w({environment:t,spaceStore:i,spaceViewStore:n,pageStore:m,isPrivate:r,location:{type:a?"prepend":"append"},transaction:l}),m}function w(e){const{environment:t,spaceStore:n,spaceViewStore:o,pageStore:i,isPrivate:r,location:a,transaction:s}=e,{id:c}=t.currentUser;let d;r?c&&(d={type:"user_permission",role:"editor",user_id:c}):d={type:"space_permission",role:"editor"},v.sW({store:i,data:{permissions:d?[d]:[]},transaction:s}),r&&k({environment:t,spaceStore:n,spaceViewStore:o,transaction:s});const u=a||{type:"append"};"prepend"===u.type?h.Ce({parent:r?o.getPrivatePagesStore():n.getPagesStore(),prepend:i,before:u.before,transaction:s}):"append"===u.type?h.R3({parent:r?o.getPrivatePagesStore():n.getPagesStore(),append:i,after:u.after,transaction:s}):(0,l.t1)(u)}function k(e){const{environment:t,spaceStore:n,spaceViewStore:o,transaction:i}=e,r=new Set(o.getPrivatePageStores().map((e=>e.id)));(0,d.XD)(t,n).filter((e=>e.isTopLevelPrivatePage({spaceStore:n,environment:t}))).forEach((e=>{r.has(e.id)||h.R3({parent:o.getPrivatePagesStore(),append:e,transaction:i})}))}function I(e){const{environment:t,spaceStore:n,spaceViewStore:o,transaction:i,copyPageId:r,recordMap:a,isPrivate:s,allowCopyExternalObjectInstances:l}=e,d=S({environment:t,spaceStore:n,spaceViewStore:o,isPrivate:s,loading:!0,transaction:i});b.fL({environment:t,inMemoryRecordCache:d.inMemoryRecordCache,recordMap:a,debugSource:"spaceActions.createAndDuplicatePageInSpace"});const u=f.K8(t,{blockId:r,inMemoryRecordCache:d.inMemoryRecordCache,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!1,allowCopyExternalObjectInstances:l});if(!u)throw new Error(c.default.formatMessage(_.createAndDuplicatePageError));return f.E9({environment:t,sourceBlockId:r,targetBlockPointer:d.pointer,sourceBlockSubtree:u,targetInMemoryRecordCache:d.inMemoryRecordCache,transaction:i,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:d.useCrdt()}),d}async function C(e){const{environment:t,userRootStore:n,isPrivate:o,forkedPageId:a,spaceStore:l,spaceViewStore:d}=e;if(l.canEdit()){const e=p.G.createChildStore(n,{table:i.iU,id:a});g.nM({currentUserId:t.currentUser.id,blockId:void 0});const c=Date.now(),u=await g.OH({environment:t,store:e,spaceStore:l,spaceViewStore:d,isPrivate:o}),f=Date.now()-c;if(m.Xy(t,{from:"onboarding",success:!u.error,template_name:r.QaF(e.getTitleValue()),template_block_id:a,target_space_id:(0,s.F9)(l.id),context:"fork_page_into_space",template_duplication_duration_ms:f}),void 0===u.error)return u.value}throw new Error(c.default.formatMessage(_.forkPageError))}},10259:(e,t,n)=>{n.d(t,{NY:()=>b,ZJ:()=>f,TY:()=>u,E6:()=>m,pE:()=>d,GZ:()=>p,lo:()=>c,pu:()=>h,kY:()=>g,ni:()=>w,aW:()=>S,pc:()=>y,Q1:()=>_,MA:()=>v});n(21703);var o=n(68626);var i=n(52629),r=n(97978),a=n(80444),s=n(13447);function l(e,t,n){s.applyOperation({store:e,operation:{pointer:e.pointer,path:["settings"],command:"update",args:{...e.getSettings(),...n}},transaction:t})}function c(e){var t;const{currentSpaceViewStore:n}=a.default.state;n&&void 0===(null===(t=n.getSettings())||void 0===t?void 0:t.space_analytics_settings_prompt)&&s.createAndCommit({userAction:"userSettingsActions.initializeSpaceAnalyticsPromptSettings",environment:e,perform:e=>{l(n,e,{space_analytics_settings_prompt:{status:"showing",num_times_shown:0}})}})}function d(e){var t;const{currentSpaceViewStore:n}=a.default.state;if(!n)return;const o=null===(t=n.getSettings())||void 0===t?void 0:t.space_analytics_settings_prompt;if(!o||"dismissed"===o.status||"hidden"===o.status)return;const i={...o,num_times_shown:o.num_times_shown+1};i.num_times_shown>3&&(i.status="hidden"),s.createAndCommit({userAction:"spaceViewActions.incrementSpaceAnalyticsSettings",environment:e,perform:e=>{l(n,e,{space_analytics_settings_prompt:i})}})}function u(e){var t;const{currentSpaceViewStore:n}=a.default.state;if(!n)return;const o=null===(t=n.getSettings())||void 0===t?void 0:t.space_analytics_settings_prompt;o&&"dismissed"!==o.status&&s.createAndCommit({userAction:"spaceViewActions.incrementspaceAnalyticsSettings",environment:e,perform:e=>{l(n,e,{space_analytics_settings_prompt:{status:"dismissed"}})}})}function p(e){var t;const{currentSpaceViewStore:n}=a.default.state;n&&void 0===(null===(t=n.getSettings())||void 0===t?void 0:t.mfa_settings_prompt)&&s.createAndCommit({userAction:"userSettingsActions.initializeMfaPromptSettings",environment:e,perform:e=>{l(n,e,{mfa_settings_prompt:{status:"showing",num_times_shown:0}})}})}function m(e){var t;const{currentSpaceViewStore:n}=a.default.state;if(!n)return;const o=null===(t=n.getSettings())||void 0===t?void 0:t.mfa_settings_prompt;if(!o||"dismissed"===o.status||"hidden"===o.status)return;const i={...o,num_times_shown:o.num_times_shown+1};i.num_times_shown>3&&(i.status="hidden"),s.createAndCommit({userAction:"spaceViewActions.incrementOrHideMfaPrompt",environment:e,perform:e=>{l(n,e,{mfa_settings_prompt:i})}})}function f(e){var t;const{currentSpaceViewStore:n}=a.default.state;if(!n)return;const o=null===(t=n.getSettings())||void 0===t?void 0:t.mfa_settings_prompt;o&&"dismissed"!==o.status&&s.createAndCommit({userAction:"spaceViewActions.dismissMfaPromptSetting",environment:e,perform:e=>{l(n,e,{mfa_settings_prompt:{status:"dismissed"}})}})}function g(e,t){var n;const{currentSpaceViewStore:o}=a.default.state;if(!o)return;const i=(null===(n=o.getSettings())||void 0===n?void 0:n.page_analytics_opt_out_list)||[];i.includes(t)||(s.createAndCommit({userAction:"spaceViewActions.optOutOfPageAnalyticsForPage",environment:e,perform:e=>{l(o,e,{page_analytics_opt_out_list:[...i,t]})}}),r.j(e,"page_analytics_page_opt_out"))}function h(e,t){var n;const{currentSpaceViewStore:o}=a.default.state;if(!o)return;const i=(null===(n=o.getSettings())||void 0===n?void 0:n.page_analytics_opt_out_list)||[];i.includes(t)&&(s.createAndCommit({userAction:"spaceViewActions.optInToPageAnalyticsForPage",environment:e,perform:e=>{l(o,e,{page_analytics_opt_out_list:i.filter((e=>e!==t))})}}),r.j(e,"page_analytics_page_opt_in"))}function v(e,t){const{currentSpaceViewStore:n}=a.default.state;n&&s.createAndCommit({userAction:"userSettingsActions.emailDigestSetting.onToggle",environment:e,perform:e=>{l(n,e,{notify_email_digest:t})}})}function b(e){const{currentSpaceViewStore:t}=a.default.state;t&&s.createAndCommit({userAction:"spaceViewActions.confirmAdminContentSearchAcknowledgement",environment:e,perform:e=>{l(t,e,{admin_content_search_acknowledgement:!0})}})}function y(e){var t;const{currentSpaceViewStore:n}=a.default.state;n&&(null!==(t=n.getSettings())&&void 0!==t&&t.has_migrated_to_google_drive_external_integration||s.createAndCommit({userAction:"spaceViewActions.setUserMigratedToGoogleDriveExternalIntegrationInSpace",environment:e,perform:e=>{l(n,e,{has_migrated_to_google_drive_external_integration:!0})}}))}function _(e,t,n){const i=n||a.default.state.currentSpaceViewStore;if(!i)throw o.log({level:"error",from:"spaceActions",type:"setUserSurveyData",error:{message:"Couldn't find a SpaceViewStore."}}),new Error;s.createAndCommit({userAction:"spaceViewActions.setUserSurveyData",environment:e,perform:e=>{l(i,e,{user_survey_data:t})}})}function S(e,t){const{shown:n,transactionUserAction:o,spaceViewStore:i}=t;s.createAndCommit({environment:e,userAction:o,perform:e=>{l(i,e,{ai_qna_waitlist_shown:n})}})}function w(e){let{environment:t,spaceViewStore:n}=e;const r=n.getModel();if(!r)return;const a=function(e){let{spaceView:t}=e;return[{pointer:{table:"user_root",id:t.parent_id},path:["space_views"],command:"listRemove",args:{id:t.id}},{pointer:{table:"user_root",id:t.parent_id},path:["space_view_pointers"],command:"keyedObjectListRemove",args:{remove:{id:t.id}}},{pointer:{table:"space_view",id:t.id,spaceId:t.space_id},path:[],command:"update",args:{alive:!1}}]}({spaceView:r});try{s.createAndCommit({environment:t,userAction:"spaceViewActions.removeUserSpaceViews",perform:e=>{for(const t of a)s.applyOperation({store:n,operation:t,transaction:e})}})}catch(l){o.log({level:"error",from:"spaceViewActions",type:"removeUserSpaceViews",error:(0,i.Ui)(l)})}}},15690:(e,t,n)=>{n.d(t,{gG:()=>w,jL:()=>f,nz:()=>y,ls:()=>_,x2:()=>h,a:()=>g});var o=n(41432),i=n(15157),r=n(9291),a=n(33929),s=n(49085);class l extends s.default{getInitialState(){return{}}setSelected(e,t){this.setState({...this.state,[e]:t})}getSelectedTab(e){return this.state[e]}}const c=new l;var d=n(94419),u=n(9953),p=n(24677),m=n(98104);function f(e){const t=e.getContentStores(),n=e.id,o=c.getSelectedTab(n);return o?t.findIndex((e=>e.id===o)):0}function g(e){const{store:t,index:n,currentUserId:o}=e,i=t.getContentStores()[n];i&&h({store:t,id:i.id,currentUserId:o})}function h(e){const{store:t,id:n,currentUserId:o}=e;c.setSelected(t.id,n),i.Z.set({userId:o,key:b(t.id),value:n})}const v="TabBlock";function b(e){return`${v}-${e}`}function y(e){const{blockId:t,currentUserId:n}=e,o=i.Z.get({userId:n,key:b(t)});o&&c.setSelected(t,o)}function _(e){const{environment:t,store:n,transaction:i}=e,r=u.j4({environment:t,type:o.Ti.text,inMemoryRecordCache:n.inMemoryRecordCache,transaction:i,useCrdt:n.useCrdt()});d.R3({parent:n.getContentStore(),append:r,transaction:i});const a=n.getContentStores()[0];p.eP({environment:t,store:a});const s=a.getBlockTitleStore();m.N_({store:s})}const S=(0,r.defineMessages)({newTab:{id:"tabBlockActions.addTab.title",defaultMessage:"New tab"}});function w(e){const{environment:t,store:n,transaction:i}=e,r=u.j4({environment:t,type:o.Ti.text,inMemoryRecordCache:n.inMemoryRecordCache,transaction:i,properties:{title:[[a.default.formatMessage(S.newTab)]]},useCrdt:n.useCrdt()});return d.R3({parent:n.getContentStore(),append:r,transaction:i}),c.setSelected(n.id,r.id),r}},80402:(e,t,n)=>{n.d(t,{AU:()=>J,DI:()=>j,FC:()=>U,K4:()=>te,MO:()=>Z,NE:()=>z,Z5:()=>O,d1:()=>X,e2:()=>V,j0:()=>G,nA:()=>q,oz:()=>ne,qY:()=>ee,qn:()=>W,zJ:()=>L});n(57658),n(21703);var o=n(15145),i=n(68497),r=n(35011),a=n(80951),s=n(1800),l=n(53877),c=n(61075),d=n(35102),u=n(84682),p=n(42875),m=n(5773),f=n(59753),g=n(82883),h=n(21202),v=n(23867),b=n(19889),y=n(70203),_=n(53965),S=n(37524),w=n(59183),k=n(75330),I=n(95477),C=n(33929),x=n(44534),T=n(77080),M=n(8406),P=n(893),A=n(54569),R=n(96802),D=n(9953),E=n(24677),B=n(993),F=n(13447);function O(e){const{environment:t,selectionKey:n,selection:o}=e;w.Z.setState({isActive:!0,selectionKey:n,selection:o}),E.ZH(t)}function Z(){w.Z.setState({isActive:!1})}function V(e){const{environment:t,selectionKey:n,shiftKey:o,columnCount:i,selection:r}=e;if(o&&r.end.col>0){const e={col:r.end.col-1,row:r.end.row};O({environment:t,selectionKey:n,selection:{start:r.start,end:e}})}else if(!o&&r.start.col>0){const e={col:r.start.col-1,row:r.start.row};O({environment:t,selectionKey:n,selection:{start:e,end:e}})}else if(!o&&0===r.start.col&&r.start.row>0){const e={col:i-1,row:r.start.row-1};O({environment:t,selectionKey:n,selection:{start:e,end:e}})}}function U(e){const{environment:t,selectionKey:n,shiftKey:o,columnCount:i,rowCount:r,selection:a}=e;if(o&&a.end.col<i-1){const e={col:a.end.col+1,row:a.end.row};O({environment:t,selectionKey:n,selection:{start:a.start,end:e}})}else if(!o&&a.start.col<i-1){const e={col:a.start.col+1,row:a.start.row};O({environment:t,selectionKey:n,selection:{start:e,end:e}})}else if(!o&&a.start.col>=i-1&&a.start.row<r-1){const e={col:0,row:a.start.row+1};O({environment:t,selectionKey:n,selection:{start:e,end:e}})}}function L(e){const{environment:t,selectionKey:n,shiftKey:o,selection:i}=e;if(o&&i.end.row>0){const e={col:i.end.col,row:i.end.row-1};O({environment:t,selectionKey:n,selection:{start:i.start,end:e}})}else if(!o&&i.start.row>0){const e={col:i.start.col,row:i.start.row-1};O({environment:t,selectionKey:n,selection:{start:e,end:e}})}}function j(e){const{environment:t,selectionKey:n,shiftKey:o,rowCount:i,selection:r}=e;if(o&&r.end.row<i-1){const e={col:r.end.col,row:r.end.row+1};O({environment:t,selectionKey:n,selection:{start:r.start,end:e}})}else if(!o&&r.start.row<i-1){const e={col:r.start.col,row:r.start.row+1};O({environment:t,selectionKey:n,selection:{start:e,end:e}})}}const N=new Set(["auto_increment_id"]);function z(e){const{selection:t,schema:n,currentRows:o,currentPropertyFormats:i,transaction:r}=e,a=S.AV(t);for(let s=a.minRow;s<=a.maxRow;s++){const e=o[s];if(e)for(let t=a.minCol;t<=a.maxCol;t++){const o=i[t],a=n[o.property];if(null!=a&&a.type&&N.has(a.type))continue;const s=e.getNormalizedPropertyStore(o.property);B.sO({environment:s.environment,editorMode:"default",store:s,value:void 0,transaction:r})}}}function q(e){W(e),z(e)}function W(e){const{selection:t,currentRows:n,event:i}=e;if(null===i.clipboardData)return;const r=S.AV(t);let a="";const l=[],d=n.slice(Math.max(0,r.minRow),r.maxRow+1).filter((e=>e&&e.isDefined()));for(const o of d){const t=[];l.push(t);for(let n=r.minCol;n<=r.maxCol;n++){const[i,s]="selectionKey"in e?H({row:o,x:n,collectionViewBlockStore:e.selectionKey.collectionViewBlockStore,...e}):K({row:o,x:n,...e});t.push([i,o.pointer]),s&&(a+=s),n<r.maxCol&&(a+="\t")}o!==_.Z$(d)&&(a+="\n")}if(i.preventDefault(),i.clipboardData.setData("text/plain",a),function(e,t){if(null===e.clipboardData)return;e.clipboardData.setData(S.mH,JSON.stringify(t))}(i,l),"simpleTableStore"in e){const{environment:t,simpleTableStore:n,columnOrder:a,exportJsxRenderer:l}=e;if(!l)return;const{default:u,jsxToStaticMarkup:m}=l,g=t.currentUser.id,b=t.defaultRecordCache.inMemoryRecordCache.makeGetRecordValueFn(g),y=f.om.fromGetRecordValueFn(b),_=a.slice(r.minCol,r.maxCol+1).filter((e=>void 0!==e)),S=(0,c._2)({exportArgs:{root:{table:h.iU,id:n.id,spaceId:(0,v.C)(n.pointer.spaceId)},navigableBlockId:n.id,renderParentBlockId:void 0,blockId:n.id,userTimeZone:(0,p.r)(),intl:C.default.getIntl(),getRecordValue:b,numberedListCache:{},bulletedListCache:{},getRecordsWithParent:()=>[],getExportedPathToFile:e=>{let{toFileURI:t}=e;return t},getExportedRenderAsset:e=>{let{toFileURI:t}=e;return t},getExportedPathToPage:e=>{let{toPageId:t}=e;return(0,s.Z)({pageId:t,pageModel:y({table:h.iU,id:t}),baseUrl:I.default.domainBaseUrl,pageVisitSource:o.tY.Export})},baseUrl:I.default.domainBaseUrl,publicDomainName:I.default.publicDomainName,table:{[n.id]:{renderRows:d.map((e=>e.id)),renderColumns:_}},katex:t.KatexStore.getKatex(),resultCache:new Map},renderers:u});if(S){const e=m(S);i.clipboardData.setData("text/html",e)}}}function H(e){const{row:t,x:n,collectionViewBlockStore:o,schema:s,currentPropertyFormats:c}=e,m=c[n],f=function(e,t,n){const o=t[n];if(!o)throw new Error("Property not found");if(!e.isDefined())return[];const i=e.getPropertyValue(n);if("formula"===o.type){if("v2"===o.version){if(!o.formula2)return[];const t=(0,r.EC)({block:e.getModel(),property:n,formulaCode:o.formula2.code,getRecordModel:e.getRecordModel,intl:C.default.getIntl(),userTimeZone:(0,p.r)(),depth:0,visitedProperties:new Set,resultCache:new Map});return t?(0,d.j4)(t):[]}{const o=(0,u.y4)({property:n,schema:t,block:e.getModel(),getRecordModel:e.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:(0,p.r)(),depth:0,intl:C.default.getIntl(),resultCache:new Map,visitedProperties:new Set}});return y.TPx(o)}}if("created_time"===o.type&&e.getCreatedTime())return a.d7(l.CQ(e.getCreatedTime(),(0,p.r)()));if("created_by"===o.type&&e.getCreatedByPointer()){const{table:t,id:n}=e.getCreatedByPointer()??{};return n&&t===b.KJ?[y.YCD(["u",n])]:n?[y.YCD(["r",n])]:[]}if("last_edited_time"===o.type&&e.getLastEditedTime())return a.d7(l.CQ(e.getLastEditedTime(),(0,p.r)()));if("last_edited_by"===o.type&&e.getLastEditedByPointer()){const{table:t,id:n}=e.getLastEditedByPointer()??{};return n&&t===b.KJ?[y.YCD(["u",n])]:n?[y.YCD(["r",n])]:[]}return i||[]}(t,s,m.property);if(!t.isDefined())return[f,void 0];return[f,(0,i.L)({property:m.property,schema:s,block:t.getModel(),getRecordModel:o.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:(0,p.r)(),depth:0,intl:C.default.getIntl(),visitedProperties:new Set,resultCache:new Map},exportedFilePaths:!1})]}function K(e){const{row:t,x:n,columnOrder:o,simpleTableStore:i}=e,r=t.getPropertyStore(o[n]);return[r.getValue()||[],(0,g.X)({textValue:r.getValue(),getRecordModel:i.getRecordModel,userTimeZone:(0,p.r)(),intl:C.default.getIntl()})]}function G(e){const{environment:t,selection:n,currentRows:o,event:i,transaction:r,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s}=e;if(!i.clipboardData)return;let l;const c=i.clipboardData.getData(S.mH),d=i.clipboardData.getData("text/html");if(c)l=JSON.parse(c);else if(d){const e=document.createElement("div");e.innerHTML=d;const t=e.querySelector("table");if(t){const e=t.querySelectorAll("tr");l=[];for(const t of Array.from(e)){const e=[],n=t.querySelectorAll("td, th");for(const t of Array.from(n)){const n=y.TPx(t.textContent||"");e.push([n,void 0])}l.push(e)}}}if(!l){const e=function(e){const{event:t,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o}=e;if(!t.clipboardData)return;const{text:i,html:r,multiTextSelectionData:a,textSelectionData:s,blockSelectionData:l}=P.e0({clipboardData:t.clipboardData,tinyMceMicrosoftWordPasteFilter:o});if(a)return P.of({text:i,html:r,stripText:!1,stripSurroundingWhitespace:!0,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o});if(s){const{editing:e,selection:t}=s;return y.V3g(y.xrQ(e,t.startIndex,t.endIndex).tokensInsideRange,{removeSuggestions:!0,removeDiscussions:!0})}if(r||i)return function(e){const{text:t,html:n,blockSelectionData:o,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:r}=e,a=t.includes("\n");return a||o&&o.blocks.length>0?y.TPx(t):P.of({text:t,html:n,stripText:!1,stripSurroundingWhitespace:!0,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:r})}({text:i,html:r,blockSelectionData:l,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o})}({event:i,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s});e&&(l=[[[e,void 0]]])}if(l){const i=S.AV(n),a=l[0].length;let s=Math.floor((i.maxCol-i.minCol+1)/a);0===s&&(s=1);const c=l.length;let d=Math.floor((i.maxRow-i.minRow+1)/c);0===d&&(d=1);for(let t=0;t<d;t++)for(let n=0;n<s;n++){const s=i.minCol+n*a,d=i.minRow+t*c;for(let t=0;t<c;t++){let n=o[d+t];if(!n){const t="selectionKey"in e?$(e):x.HM.appendRow(e);t&&(e.currentRows.push(t),n=t)}for(let o=0;o<a;o++){const i=l[t][o];if(!i)continue;const a=s+o;"currentPropertyFormats"in e?Q({row:n,x:a,serializedValue:i,currentPropertyFormats:e.currentPropertyFormats,transaction:r,schema:e.schema}):Y({row:n,x:a,serializedValue:i,columnOrder:e.columnOrder,transaction:r})}}}const u={start:{col:i.minCol,row:i.minRow},end:{col:i.minCol+a*s-1,row:i.minRow+c*d-1}};"selectionKey"in e?O({environment:t,selectionKey:e.selectionKey,selection:u}):x.HM.selectMultiCell({environment:t,start:u.start,end:u.end,simpleTableStore:e.simpleTableStore})}}function $(e){const{environment:t,currentRows:n,collectionContextStore:o,selectionKey:i,transaction:r}=e,{groupFormat:a}=i,s=A.IW({environment:t,collectionContextStore:o,groupsPointer:a?[a]:[],insertAtIndex:n.length,shouldCoerce:!0,initializeDefaultTemplate:!1,transaction:r,from:"table_paste_selection"});return null==s?void 0:s.newStore}function Q(e){var t;const{row:n,x:o,serializedValue:i,currentPropertyFormats:r,transaction:s,schema:l}=e,c=r[o];if(!c)return;if("verification"===(null===(t=l[c.property])||void 0===t?void 0:t.type))return;const[d,u]=i,p=n.getNormalizedPropertyStore(c.property);if(B.sO({environment:p.environment,editorMode:"default",store:p,value:d,transaction:s}),u){var f;const e=d?a.g(d):void 0,t=(0,m.jy)(e,[I.default.secureFileS3.url,I.default.secureFileS3V2.url],(null===(f=I.default.secureFileConfig)||void 0===f?void 0:f.rootPath)??"");D.nj({store:n,source:u,fileIds:t.map((e=>e.id)),transaction:s})}}function Y(e){const{row:t,x:n,serializedValue:o,transaction:i,columnOrder:r}=e,a=r[n];if(!a)return;const[s,l]=o,c=t.getNormalizedPropertyStore(a);B.sO({environment:c.environment,editorMode:"default",store:c,value:y.V3g(s,{removeSuggestions:!0,removeDiscussions:!0}),transaction:i})}function J(e){let{environment:t,collectionViewStore:n,currentValue:o}=e;F.createAndCommit({userAction:"tableActions.toggleTableVerticalLines",environment:t,perform:e=>{R.FH({stores:[n],update:{hide_table_vertical_lines:!o},transaction:e})}})}function X(e){let{environment:t,collectionViewStore:n,currentValue:o}=e;const i="title"===o?void 0:"title";F.createAndCommit({userAction:"tableActions.toggleTableSubitemToggleOnTitle",environment:t,perform:e=>{R.FH({stores:[n],update:{table_subitem_toggle_column:i},transaction:e})}})}function ee(e){let{environment:t,collectionViewStore:n,currentValue:o}=e;const i=n.getFormat().table_properties,r=null==i?void 0:i.map((e=>({...e,wrap:!o})));F.createAndCommit({userAction:"tableActions.toggleTableWrapCells",environment:t,perform:e=>{R.FH({stores:[n],update:{table_wrap:!o,table_properties:r},transaction:e})}})}function te(e){let{property:t,collectionViewStore:n,format:o,formatKey:i,environment:r,currentValue:a}=e;const s=!a,l=n.getFormat().table_wrap,c=o[i]||[];let d=!0;const u=c.map((e=>{let n;return n=e.property===t?s:Boolean(l||e.wrap),n||(d=!1),{...e,wrap:n}})),p={...o,[i]:u,table_wrap:d};F.createAndCommit({userAction:"tableActions.toggleWrapColumn",environment:r,perform:e=>{k.iG({collectionViewStore:n,update:{format:p},transaction:e})}})}function ne(e){let{environment:t,collectionContextStore:n,currentIndex:o,entrypoint:i,transaction:r,propertyAction:a}=e;const s=n.collectionViewStore(),l=n.normalizedFormatStore.state;if(!s||void 0===o)return;const c=n.frozoneStore.state.frozenIndex;let d;switch(a){case"toggle":c!==o?d=o:c===o&&(d=-1);break;case"delete":case"hide":if(!(void 0!==c&&o<=c))return;d=c-1;break;case"duplicate":if(!(void 0!==c&&o<=c))return;d=c+1;break;case void 0:if(c!==o)d=o;else if(c===o)return}const u={...l,table_frozen_column_index:d};n.frozoneStore.setState({...n.frozoneStore.state,frozenIndex:d}),d&&T.default.logEvent("freeze_columns","true",{from:i}),M.wd({environment:t,collectionContextStore:n,action:void 0===d?"table_unfreeze_columns":"table_freeze_column",entrypoint:i,propertyIndex:d}),D.sW({store:s.getFormatStore(),data:u,transaction:r})}},150:(e,t,n)=>{n.d(t,{Ct:()=>g,Hl:()=>h,c0:()=>b,sp:()=>y});n(57658),n(67294);var o=n(72141),i=n(29369),r=n(64684),a=n(9291),s=n(98165),l=n(6258),c=n(17224),d=n(47307),u=n(94419),p=n(9953),m=n(13447),f=n(85893);function g(e){const{environment:t,currentSpaceViewStore:n,orderedTeamIds:o,userAction:r}=e;if(m.createAndCommit({userAction:r,environment:t,perform:e=>{p.sW({store:n,data:{joined_teams:o},transaction:e})}}),e.isExplicitUserAction){const{key:o,startPosition:r,endPosition:a}=e.dropArgs,s=l.zX.createChildStore(n,{table:i.e0,id:o});c.er(t,{store:s,start_position:r,end_position:a})}}async function h(e){let{transaction:t,...n}=e;const{moveToTeam:o,permissionsUpdateItems:i}=function(e){let{moveStores:t,moveTargetStore:n}=e;const o=t.reduce(((e,t)=>(e[t.id]=(0,s.VP)(t),e)),{}),i=(0,s.VP)(n),r=[];for(const a of t){const e=v({blockStore:a,moveFromTeam:o[a.id],moveToTeam:i});e&&r.push(e)}return{moveToTeam:i,permissionsUpdateItems:r}}(n);if(0===i.length)return"not_cleared";const r=await async function(e){let{numPagesMoved:t,moveToTeam:n,permissionsUpdateItems:o}=e;if(0===o.length)return!0;if(!n)return!0;const i=n.getName(),r=o.some((e=>{let{isRemovingRestricted:t}=e;return!0===t})),s=r&&(0,f.jsx)(a.FormattedMessage,{id:"teamActions.confirmMoveToTeam.removeRestrictedDescription",defaultMessage:" {numPagesMoved, plural, one {This page} other {These pages}} will no longer have restricted access.",values:{numPagesMoved:t}});return await d.confirmUserAction({message:(0,f.jsx)(a.FormattedMessage,{defaultMessage:"Are you sure you want to move {numPagesMoved, plural, one {this page} other {these pages}} to {moveToTeamName}?",id:"teamActions.confirmMoveToTeam.title",values:{moveToTeamName:i,numPagesMoved:t}}),description:(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(a.FormattedMessage,{id:"teamActions.confirmMoveFromTeam.description",defaultMessage:"This will transfer the permissions on {numPagesMoved, plural, one {this page} other {these pages}} to members of {moveToTeamName}. ",values:{moveToTeamName:i,numPagesMoved:t}}),s]})})}({numPagesMoved:n.moveStores.length,moveToTeam:o,permissionsUpdateItems:i});if(!r)return"user_cancelled_move";for(const{blockStore:a,permissions:s}of i)p.sW({store:a,data:{permissions:s},transaction:t});return"cleared"}function v(e){let{blockStore:t,moveFromTeam:n,moveToTeam:i}=e;if(void 0===n&&void 0===i)return;if((null==n?void 0:n.id)===(null==i?void 0:i.id))return;const a=t.getPermissionItems();let s=!1;const l=a.filter((e=>(0,o.Le)(e)?(s=!0,!1):!(0,o.ix)(e)&&(!n||!(0,r.J2)(e,n.id)&&!(0,r.jc)(e,n.id))));return a.length!==l.length?{blockStore:t,permissions:l,moveFromTeam:n,isRemovingRestricted:s}:void 0}function b(e){const{store:t,teamStore:n,transaction:o,location:i}=e,r=n.getTeamPagesStore(),a=l.G.createChildStore(r,t.pointer);"append"===i.type?u.R3({parent:r,append:a,transaction:o,after:i.after}):"prepend"===i.type&&u.Ce({parent:r,prepend:a,transaction:o,before:i.before})}function y(e){const{store:t,teamStore:n,transaction:o}=e,i=n.getTeamPagesStore(),r=l.G.createChildStore(i,t.pointer);u.Od({childToRemove:r,parent:i,transaction:o})}},993:(e,t,n)=>{n.d(t,{AE:()=>dt,Be:()=>Ye,Du:()=>Ge,E3:()=>ut,KM:()=>We,MY:()=>qe,N3:()=>Ze,Nh:()=>ft,O5:()=>ct,ON:()=>mt,Q0:()=>st,QT:()=>$e,QX:()=>He,ST:()=>Je,VO:()=>pt,YV:()=>ot,Zl:()=>gt,aS:()=>it,fs:()=>nt,g2:()=>rt,gc:()=>et,gy:()=>yt,hJ:()=>Ve,i8:()=>Ke,lZ:()=>at,mM:()=>Ue,n2:()=>tt,pe:()=>Fe,pz:()=>Be,sO:()=>je,vE:()=>_t,wA:()=>lt,yJ:()=>Xe});n(57658),n(21703),n(30541);var o=n(1302),i=n(15145),r=n(37167),a=n(66749),s=n(1800),l=n(15095),c=n(35102),d=n(68626),u=n(59730),p=n(64572),m=n(49143),f=n(99405),g=n(21202),h=n(70279),v=n(33709),b=n(23867),y=n(70203),_=n(38585),S=n(39721),w=n(82798),k=n(53965),I=n(40470),C=n(1898),x=n(18265),T=n(54564),M=n(67133),P=n(62878),A=n(28344),R=n(91567),D=n(66402),E=n(17707),B=n(1600),F=n(95477),O=n(78791),Z=n(27105),V=n(14976),U=n(73744),L=n(84210),j=n(68056),N=n(45162),z=n(98165),q=n(46654),W=n(65598),H=n(18514),K=n(69645),G=n(73959),$=n(60846),Q=n(89224),Y=n(89086),J=n(35328),X=n(77907),ee=n(89574),te=n(95802),ne=n(98180),oe=n(24229),ie=n(807),re=n(66949),ae=n(77080),se=n(72014),le=n(88923),ce=n(81236),de=n(6258),ue=n(27724),pe=n(24666),me=n(45131),fe=n(65663),ge=n(36610),he=n(26189),ve=n(6404),be=n(893),ye=n(4727),_e=n(36280),Se=n(44886),we=n(88295),ke=n(67060),Ie=n(9953),Ce=n(12714),xe=n(8055),Te=n(61045),Me=n(24677),Pe=n(84084),Ae=n(17269),Re=n(98104),De=n(32741),Ee=n(13447);function Be(e){const{multiSelection:t,environment:n,transaction:o,editorMode:i}=e,r=(0,N.L5)(t);if(0===r.length)return;if(1===r.length){const{store:e,selection:t}=r[0];return Fe({environment:n,transaction:o,store:e,selection:t,editorMode:i})}const a=t.start.store,s=Z.FX(a),l=(0,N.Nj)({multiSelection:t,includeNonSelectable:!1});if(!l)return;const{treeRange:c}=l;if(s){const e=new Set,r=[];for(const t of c.iterateDeletion())if("delete"===t.operation)for(const{childToRemove:e}of(0,K.XL)({treeOperation:t,deleteFrom:"record-store-parent"}))r.push(e);else if("move"===t.operation)for(const n of t.movingChildren)n.value.store&&e.add(n.value.store);let a=0;for(const t of r)a+=1+(0,W.MI)({blockStore:t,traverseTransclusionReferences:!1}).length;const s=ae.default.getConfigKey("text_crdt_config","delete_merge_slice_tree_block_limit");a<=s?O.Cf({environment:n,transaction:o,multiSelection:t,removedBlocks:r,movedBlocks:e,editorMode:i}):d.log({level:"info",from:"deleteMultiSelection",type:"crdt:deleteMultiSelectionOverBlockLimit",data:{miscDataToConvertToString:{blockLimit:s,numBlocksInSelection:a}}})}const{start:u,end:p}=t;Fe({environment:n,transaction:o,selection:{startIndex:u.index,endIndex:1/0},store:u.store,editorMode:i});const m=(0,Y.x0)(u.store);if(s){const e=(0,w.TO)((0,G.sQ)(p.store),"End of selection must be in a block");Fe({environment:n,editorMode:i,transaction:o,selection:{startIndex:0,endIndex:p.index},store:p.store}),O.tE({transaction:o,block:e,targetStore:a})}else m?et({environment:n,editorMode:i,transaction:o,sourceStore:p.store,sourceIndex:p.index,targetStore:u.store,targetIndex:m.endIndex}):Fe({environment:n,transaction:o,store:p.store,selection:{startIndex:p.index,endIndex:1/0},editorMode:i});for(const d of c.iterateDeletion())(0,K.D_)({transaction:o,treeOperation:d,deleteFrom:"record-store-parent"});Re.Z5({store:u.store,selection:m}),Me.eP({environment:n,store:c.start.value.store})}function Fe(e){Oe({...e,updateSelection:!0,removeInlineRecords:!0})}function Oe(e){const{environment:t,store:n,selection:o,transaction:i,updateSelection:r,removeInlineRecords:a}=e,s=n.getValue(),c=y.Ulv(s,o);if(c.startIndex===c.endIndex)return void(r&&Re.Z5({store:n,selection:c}));let d;const u=n.isTable(g.iU)&&(0,G.sQ)(n)||n.getRecordStoreAtRootPath();if(u instanceof de.G&&Z.Ls({store:n,blockStore:u})){const o=(0,w.TO)(u.getTextSliceTree()),r=new l.W3(y.eeV(s)),{startIndex:p,endIndex:m}=r.getInclusiveStringRangeForSelection(c),{operations:f,invertedOperations:g}=o.getOperationsForDeleteText(p,m);fe.F({transaction:i,store:u,crdtOperations:f,invertedOperations:g}),ze(e),d=(0,w.TO)(n.getValue()),a&&bt({environment:t,store:n,oldTextValue:s,newTextValue:d,transaction:i,rootStore:u})}else d=y._QS(s,o.startIndex,o.endIndex),Ne({environment:t,store:n,value:d,transaction:i}),vt({environment:t,store:n,oldTextValue:s,newTextValue:d,transaction:i,rootStore:u,removeInlineRecords:a});r&&Re.Z5({store:n,selection:{startIndex:c.startIndex,endIndex:c.startIndex}})}function Ze(e){const t=pe.default.state;if("editing"!==t.mode)return;if((0,j.iG)(t.multiSelection))return;const{start:n,end:o}=t.multiSelection,i="start"===e.direction?n:o;pe.default.setState({...t,multiSelection:{start:i,end:i}})}function Ve(e){const{environment:t,editorMode:n,disableMentions:o,disableSlashCommands:i,disableEmojiCommands:r,disableFilters:a,string:s,transaction:c,selectAll:d,mobileActionBarEnableInsertInsteadOfTurnIntoInSlashCommands:p}=e,f=(0,m.lU)(e.disabledMentionTypes);let g;if("editing"!==pe.default.state.mode)return;const h="multiSelection"in e?e.multiSelection:(0,j.TD)(e),_=(0,j.QY)(h),S=_?{canRestore:!0,oldSelection:_,toTextValue:_.store.getValue()}:{canRestore:!1};"default"===n?Be({environment:t,editorMode:n,multiSelection:h,transaction:c}):"suggest"===n||(0,C.t1)(n);const w=y.vJ3(s),k=l.p4(w).length;if(0===k)return;const I=(0,Y.bj)();if("suggest"===n){const e=I.findFirstOfType(y.GKr.SuggestionInsertText);if(e)g=y.fgJ(e);else{const e=B.DH(h);if(e){var x;if(g=null===(x=e.getInsertSuggestion())||void 0===x?void 0:x.discussionId,!g){const{discussionStore:n}=B.L9({environment:t,transaction:c,blockStore:e,modifiedBlockIds:[e.id]});g=n.id}I.add([y.GKr.SuggestionInsertText,g])}}}const T=y.V3y(w,I.toArray());Le({environment:t,store:h.start.store,tokens:[T],index:h.start.index,transaction:c,updateSelection:!1});const M={startIndex:d?h.start.index:h.start.index+k,endIndex:h.start.index+k};if(Re.Z5({store:h.start.store,selection:M}),a||Ae.f({environment:t,editorMode:n,store:h.start.store,transaction:c}),S.canRestore&&(o||ke._P({environment:t,textStore:S.oldSelection.store,oldSelection:S.oldSelection.selection,oldTextValue:S.toTextValue,disabledMentionTypes:f}),i||Pe._P({environment:t,textStore:S.oldSelection.store,oldSelection:S.oldSelection.selection,oldTextValue:S.toTextValue,isAddMenu:p}),r||ye._P({environment:t,textStore:S.oldSelection.store,oldSelection:S.oldSelection.selection,oldTextValue:S.toTextValue}),"suggest"===n&&g)){const e=B.DH(h);if(!e)throw new u.p8("Can not find associated block store");const t=de.t1.createChildStore(e,{table:v.qF,id:g,spaceId:(0,b.C)(e.pointer.spaceId)});B.vh(t,c)}}function Ue(e){Le({...e,updateSelection:!0})}function Le(e){const{environment:t,store:n,index:o,transaction:i,selectAll:r,updateSelection:a}=e,s=e.tokens.map(y.Y_F);if(s.length){const r=n.getValue()||[];if(Z.FX(n)){const t=(0,w.TO)((0,G.sQ)(n)),r=(0,w.TO)(t.getTextSliceTree()),a=new l.W3(y.eeV(n.getValue())).getStringStartIndex(o),{operations:c,invertedOperations:d}=r.getOperationsForInsertTextValue(a,s);fe.F({transaction:i,store:t,crdtOperations:c,invertedOperations:d}),ze(e)}else{const e=y.P$X(r,s,o);Ne({environment:t,store:n,value:e,transaction:i});const a=n.getRecordStoreAtRootPath();vt({environment:t,store:n,rootStore:a,transaction:i,oldTextValue:r,newTextValue:e,removeInlineRecords:!1})}}if(a){const e=y.eeV(s).length;Re.Z5({store:n,selection:{startIndex:r?o:o+e,endIndex:o+e}})}}function je(e){const{environment:t,editorMode:n,store:o,value:i,transaction:r}=e;Z.FX(o)?(Oe({environment:t,editorMode:n,store:o,selection:{startIndex:0,endIndex:1/0},transaction:r,updateSelection:!1,removeInlineRecords:!0}),i&&y.VrM(i)&&Le({environment:t,store:o,tokens:i,index:0,transaction:r,updateSelection:!1}),ze(e)):Ne(e)}function Ne(e){const{store:t,value:n,transaction:o}=e;(0,w.T)(!Z.FX(t),"setValueInTitleStore should not be used for updating the title of a CRDT block");const i=y.Zxt(n);Ee.applyOperation({transaction:o,store:t,operation:{pointer:t.pointer,path:t.path,command:"set",args:t.table===g.iU?(0,a.pp)(i):i}}),ze(e)}function ze(e){const{environment:t,store:n}=e;if(!n.isTable("block"))return;const o=n.getRecordStoreAtRootPath();if(!o.inMemoryRecordCache.isMockTextStore){const e=o.getValue();var i;if(e)ge.ct(t,{block_id:e.id,type:e.type,is_toggleable:(0,J._A)(e.type,e.format),parent_collection_id:o.getAssociatedCollectionId()??(null===(i=o.getParentBlockStore())||void 0===i?void 0:i.getAssociatedCollectionId())})}}function qe(e){const{environment:t,multiSelection:n,annotation:o,transaction:i}=e,r=y.J7s(o),a=(0,N.L5)(n),s=B.DH(n),l=s?ie.Z.getMode(s):"default",c=!y.xw5(o)&&!y.BIG(o)&&Boolean((0,Y.k2)([r],n,{})[r]);if("default"!==l&&(0,y.X5l)(o))if("suggest"===l){const r=B.DH(n);if(!r)throw new u.p8("Can not find associated block store");const s=a.map((e=>e.store.id)),{discussionStore:l}=B.L9({...e,blockStore:r,modifiedBlockIds:s}),d=l.id,p=c?[y.GKr.SuggestionUnannotate,d,o]:[y.GKr.SuggestionAnnotate,d,o];a.forEach((e=>{let{store:n,selection:o}=e;Qe({environment:t,store:n,annotation:p,selection:o,transaction:i})})),B.vh(l,i)}else(0,C.t1)(l);else a.forEach((e=>{let{store:n,selection:a}=e;c?Je({environment:t,store:n,annotationTypeOrKey:r,selection:a,transaction:i,updateSelection:!1}):Qe({environment:t,store:n,annotation:o,selection:a,transaction:i})}))}function We(e){const{environment:t,multiSelection:n,annotation:o,transaction:i}=e;(0,N.L5)(n).forEach((e=>{let{store:n,selection:r}=e;Qe({environment:t,store:n,annotation:o,selection:r,transaction:i})}))}function He(e){const{environment:t,multiSelection:n,annotationTypeOrKey:o,transaction:i}=e;(0,N.L5)(n).forEach((e=>{let{store:n,selection:r}=e;Je({environment:t,store:n,annotationTypeOrKey:o,selection:r,transaction:i,updateSelection:!1})}))}function Ke(e){const{store:t,selection:n}=e;qe({...e,multiSelection:(0,j.TD)({store:t,selection:n})})}function Ge(e){const{environment:t,blocks:n,annotation:o,transaction:i}=e,r=y.J7s(o),a=k.oA(n.map((e=>{const t=e.getTitleStore();if(!t)return;const n=t.getValue();return n?{block:e,titleStore:t,titleValue:n}:void 0}))),s=a.every((e=>{let{titleValue:t}=e;return t.every((e=>y.hDy(e).some((e=>y.J7s(e)===r))))}));for(const{titleStore:l}of a)$e({environment:t,annotation:o,textStore:l,action:s?"removeAnnotationType":"annotate",transaction:i})}function $e(e){const{environment:t,annotation:n,transaction:o,textStore:i,action:r}=e;"annotate"===r?Qe({environment:t,store:i,annotation:n,selection:{startIndex:0,endIndex:1/0},transaction:o}):Je({environment:t,store:i,annotationTypeOrKey:y.J7s(n),selection:{startIndex:0,endIndex:1/0},transaction:o,updateSelection:!1})}function Qe(e){const{environment:t,store:n,annotation:o,selection:i,transaction:r}=e,a=n.getValue();if(a)if(Z.FX(n)){!function(e){const{blockStore:t,selection:n,annotation:o,transaction:i}=e;(0,w.T)(t.useCrdt());const r=t.getBlockTitleStore().getValue(),a=y.Ulv(r,n);if((0,Y.wd)(a))return;const s=(0,w.TO)(t.getTextSliceTree()),c=new l.W3(y.eeV(r)),{startIndex:d,endIndex:u}=c.getInclusiveStringRangeForSelection(a),{operations:p,invertedOperations:m}=s.getOperationsForAddAnnotation(d,u,o);fe.F({transaction:i,store:t,crdtOperations:p,invertedOperations:m})}({blockStore:(0,w.TO)((0,G.sQ)(n)),selection:i,annotation:o,transaction:r})}else{const e=y.aSf({textValue:a,selection:i,annotation:o});Ne({environment:t,store:n,value:e,transaction:r});const s=n.getRecordStoreAtRootPath();vt({environment:t,store:n,oldTextValue:a,newTextValue:e,transaction:r,rootStore:s,removeInlineRecords:!1})}}function Ye(e){Je({...e,annotationTypeOrKey:e.type,updateSelection:!0})}function Je(e){const{environment:t,store:n,selection:o,annotationTypeOrKey:i,transaction:r,updateSelection:a}=e,s=n.getValue();if(!s)return;let c;const d=n.isTable(g.iU)&&(0,G.sQ)(n)||n.getRecordStoreAtRootPath();d instanceof de.G&&Z.Ls({store:n,blockStore:d})?(!function(e){const{blockStore:t,selection:n,annotationTypeOrKey:o,transaction:i}=e;(0,w.T)(t.useCrdt());const r=t.getBlockTitleStore().getValue(),a=y.Ulv(r,n);if((0,Y.wd)(a))return;const s=(0,w.TO)(t.getTextSliceTree()),c=new l.W3(y.eeV(r));if("string"==typeof o&&y.WU4(o)){const e=o,n=[],l=[],d=y.fWo({textValue:r,startIndex:a.startIndex,endIndex:a.endIndex,annotationType:e});for(const{startIndex:t,endIndex:o,annotationKey:i}of d){const{startIndex:e,endIndex:r}=c.getInclusiveStringRangeForSelection({startIndex:t,endIndex:o}),{operations:a,invertedOperations:d}=s.getOperationsForRemoveAnnotation(e,r,i);n.push(...a),l.push(...d)}n.length>0&&fe.F({transaction:i,store:t,crdtOperations:n,invertedOperations:l})}else{const{startIndex:e,endIndex:n}=c.getInclusiveStringRangeForSelection(a),{operations:r,invertedOperations:l}=s.getOperationsForRemoveAnnotation(e,n,o);fe.F({transaction:i,store:t,crdtOperations:r,invertedOperations:l})}}({blockStore:d,selection:o,annotationTypeOrKey:i,transaction:r}),c=(0,w.TO)(n.getValue())):(c=y.STJ({textValue:s,selection:o,annotationTypeOrKey:i}),je({environment:t,editorMode:"default",store:n,value:c,transaction:r}),vt({environment:t,store:n,oldTextValue:s,newTextValue:c,transaction:r,rootStore:d,removeInlineRecords:!0})),a&&Re.Z5({store:n,selection:o})}function Xe(e){const{selection:t,titleStore:n,environment:o,transaction:i,annotationsToAdd:r=[],annotationKeysToRemove:a=[]}=e;let s=n.getValue();r.forEach((e=>{s=y.aSf({textValue:s,selection:t,annotation:e})})),a.forEach((e=>{s=y.STJ({textValue:s,selection:t,annotationTypeOrKey:e})}));const{tokensInsideRange:l}=y.xrQ(s,t.startIndex,t.endIndex);Fe({environment:o,store:n,editorMode:"default",selection:t,transaction:i}),Ue({environment:o,store:n,tokens:l,index:t.startIndex,transaction:i})}function et(e){const{environment:t,editorMode:n,sourceStore:o,sourceIndex:i,targetStore:r,targetIndex:a,transaction:s}=e,l=y.lzi(o.getValue()),c=y.QaF(l).length,{tokensInsideRange:d}=y.xrQ(l,i,c);d.length>0&&(Oe({environment:t,editorMode:n,store:o,selection:{startIndex:i,endIndex:c},transaction:s,updateSelection:!0,removeInlineRecords:!1}),Ue({environment:t,store:r,tokens:d,index:a,transaction:s}))}function tt(e){const{environment:t,closestSelectable:n,shiftKey:i,transaction:r}=e;if((0,N.Aw)(t))return void function(e){const{transaction:t}=e,n=pe.default.state;if("editing"!==n.mode)return;const{multiSelection:i}=n,r=(0,N.Nj)({multiSelection:i,includeNonSelectable:!0});if(!r)return;const{tree:a,treeRange:s}=r,l=a.value.store,c=S.o.getIndentOperationsFromTreeRange(s,e.direction);for(const o of c){const{target:e,operation:n}=o,i=(0,K.kC)({rootStore:l,root:a,target:e});if(void 0===i)throw new Error("Cannot find node to indent");let r=!1;switch(n){case"indentSelf":case"indentSelfAndSubtree":if(i.length>=2){const e=i[i.length-2],o=i[i.length-1];if(o){let i="indentSelf"===n?"self":"subtree";(0,J.BX)(o)&&!me.Z.isOpen(o.id)&&(i="subtree");void 0!==Se.dD({block:o,parentStore:e,transaction:t,type:i})&&(r=!0)}}break;case"unindentSelfAndUpdateSiblings":if(i.length>=3){const e=i[i.length-3],n=i[i.length-2],o=i[i.length-1];if(n&&o){void 0!==Se.uv({block:o,parentStore:n,grandparentStore:e,transaction:t})&&(r=!0)}}}r&&S.F.applyMutable(a,o)}o.default.afterNextFlush((()=>{const e=(0,K.kC)({rootStore:l,root:a,target:s.start}),t=(0,K.kC)({rootStore:l,root:a,target:s.end}),n=e&&(0,G.mh)(e[e.length-1]),o=t&&(0,G.mh)(t[t.length-1]);if(n&&o){const e={start:{store:n,index:i.start.index},end:{store:o,index:i.end.index}};Re.NA({multiSelection:e})}}))}({environment:t,transaction:r,direction:e.shiftKey?"unindent":"indent"});const a=i?Se.rB({environment:t,blocks:[n],transaction:r}):Se.WY({environment:t,blocks:[n],transaction:r});if(!a)return;const s=pe.default.state;if("editing"===s.mode){var l;const e=null===(l=(0,N.xI)("textActions",s.multiSelection))||void 0===l?void 0:l.selection;if(!e)return;o.default.afterNextFlush((()=>{const o=te.C.findSelectableFromStore(a[0]);if(Me.wI({store:n,replace:a[0]}),o){const n=(0,G.mh)(o.props.store);n?Re.Z5({store:n,selection:e}):Me.$Y({environment:t,phase:ue.SelectionPhase.Selected})}}))}}function nt(e){const{transaction:t,direction:n}=e,i=pe.default.state;if("editing"!==i.mode)return;const{multiSelection:r}=i,a=(0,N.tp)({multiSelection:r,filterCommonAncestors:!0,focus:void 0});if(!a)return;const s=a.stores;("up"===n?Se.A1({transaction:t,blocks:s}):Se.vi({transaction:t,blocks:s}))&&o.default.afterNextFlush((()=>{const[e,t]=te.C.findSelectablesFromIds([r.start.store.id,r.end.store.id]),n=(null==e?void 0:e.props.store)&&(0,G.mh)(null==e?void 0:e.props.store),o=(null==t?void 0:t.props.store)&&(0,G.mh)(null==t?void 0:t.props.store);n&&o&&(Re.NA({multiSelection:{start:{store:n,index:r.start.index},end:{store:o,index:r.end.index}},forceEmit:!0}),Te.Zv())}))}function ot(e){const{transaction:t,editorMode:n,environment:o,multiSelection:i}=e;i&&!(0,j.qS)(i)&&Be({environment:o,editorMode:n,transaction:t,multiSelection:i}),it({...e,usingMultiSelection:!0})}function it(e){const{environment:t,editorMode:n,store:o,newValue:i,disableSlashCommands:r,disableEmojiCommands:a,disableFilters:s,transaction:c,usingMultiSelection:d,disableMentions:u,disabledMentionTypes:p}=e,m=o.getValue(),f=y.QaF(m),g=$.UZ(f,i),h=pe.default.state;if("editing"!==h.mode)return;const v=h.multiSelection.start.index;let b=0;for(let y=0;y<g.length;y++){const e=g[y];if(b+l.p4(e[1]).length>v){if(e[0]===$.JZ){const t=g[y-1],n=g[y+1];let o=g[y-2],i=g[y+2];if(n&&n[0]===$.D$)for(i||(i=[$.JZ,""],g.push(i));b+l.p4(e[1]).length>v&&e[1].endsWith(n[1]);)e[1]=e[1].slice(0,e[1].length-n[1].length),i[1]=n[1]+i[1];else if(t&&t[0]===$.D$)for(o||(o=[$.JZ,""],g.unshift(o));b+l.p4(e[1]).length>v&&e[1].startsWith(t[1]);)e[1]=e[1].slice(t[1].length),o[1]=o[1]+t[1],b-=l.p4(t[1]).length}break}b+=l.p4(e[1]).length}let _=!1,S=!1,w=0;for(const[k,I]of g)if(k===$.D$)_=!0,Ve({environment:t,editorMode:n,store:o,selection:{startIndex:w,endIndex:w},string:I,disableSlashCommands:r,disableEmojiCommands:a,disableFilters:s,transaction:c,disableMentions:u,disabledMentionTypes:p}),w+=l.p4(I).length;else if(k===$.NL){_=!0,S=I===y.qyI;Fe({environment:t,store:o,selection:{startIndex:w,endIndex:w+l.p4(I).length},transaction:c,editorMode:n})}else k===$.JZ&&(w+=l.p4(I).length);!_||S||t.TextSelectionCompositionStore.state.isComposing||rt({environment:t,store:o,usingMultiSelection:d})}function rt(e){const{environment:t,usingMultiSelection:n,store:o}=e;if(n){const e=Q.get(),t=(0,N.fx)({range:e,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0});t&&Re.NA(t)}else{const e=V.Ut(t);e&&(Re.Z5({store:o,selection:e.selection}),e.forceEmitSelectionStore&&pe.default.emit())}}function at(e){const{environment:t,store:n,selection:o,annotation:i,analyticsFrom:r,transaction:a,editorMode:s,shareMenuSelection:l}=e;Fe({environment:t,store:n,selection:o,transaction:a,editorMode:s});const c=(0,Y.yj)(o,n).toArray(),d=[y.YCD(i,c),y.V3y(" ",c)];if(Ue({environment:t,store:n,tokens:d,index:o.startIndex,transaction:a}),Re.Z5({store:n,selection:{startIndex:o.startIndex+d.length,endIndex:o.startIndex+d.length}}),y.IWo(i)&&(n.isTable("block")||n.isTable("comment"))){const e=t.currentUser.id,o=y.zEN(i),a=n.getRecordStoreAtRootPath();e&&he.TI(t,{is_current_user:o===e,user_id:o,user_access_level:(0,q.rc)(o),from:r,block_type:a instanceof de.G?a.getType():void 0,share_menu_selection:l})}else if(y._bk(i)&&(n.isTable("block")||n.isTable("comment"))){var u;const e=null===(u=y.kxk(i))||void 0===u?void 0:u.groupId,o=n.getRecordStoreAtRootPath();e&&he.Z0(t,{group_id:e,from:r,block_type:o instanceof de.G?o.getType():void 0})}else if(y.fpG(i)&&(n.isTable("block")||n.isTable("comment"))){const e=y.zyO(i),o=n.getRecordStoreAtRootPath();he.VN(t,{date:e,from:r,block_type:o instanceof de.G?o.getType():void 0})}else if(y.STW(i)&&(n.isTable("block")||n.isTable("comment"))){const e=y.TOT(i),o=n.getRecordStoreAtRootPath();he.Qq(t,{page_id:e,from:r,block_type:o instanceof de.G?o.getType():void 0})}}function st(e){const{environment:t,editorMode:n,store:o,selection:i,emoji:r,transaction:a}=e;Fe({environment:t,editorMode:n,store:o,selection:i,transaction:a});const s=[y.V3y(r)];Ue({environment:t,store:o,tokens:s,index:i.startIndex,transaction:a}),Re.Z5({store:o,selection:{startIndex:i.startIndex+s.length,endIndex:i.startIndex+s.length}})}function lt(e){const{environment:t,editorMode:n,shouldStripTokens:o,disableFilters:i,store:r,selection:a,transaction:s}=e,c=(0,Y.fM)(r,a,o),d=o?y.Jcv(r.getValue()):y.QaF(r.getValue());let u=l.p4(d),p=0;for(const l of c)if(p++,0===l)u.unshift("\t");else{const e=l+p;u=[...k.tP(u,0,e),"\t",...k.tP(u,e)]}it({environment:t,store:r,editorMode:n,newValue:y.vJ3(u.join("")),disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:i,transaction:s}),Re.Z5({store:r,selection:{startIndex:a.startIndex+1,endIndex:a.endIndex+p}})}function ct(e){const{environment:t,editorMode:n,shouldStripTokens:o,disableFilters:i,store:r,selection:a,transaction:s}=e,c=(0,Y.fM)(r,a,o),d=o?y.Jcv(r.getValue()):y.QaF(r.getValue());let u=l.p4(d),p=0,m=0;for(const l of c){const e=l-p;0===e?"\t"===u[0]?(u=k.tP(u,1),p+=1):" "===u[0]&&" "===u[1]?(u=k.tP(u,2),p+=2):" "===u[0]&&(u=k.tP(u,1),p+=1):"\t"===u[e+1]?(u=[...k.tP(u,0,e+1),...k.tP(u,e+2)],p+=1):" "===u[e+1]&&" "===u[e+2]?(u=[...k.tP(u,0,e+1),...k.tP(u,e+3)],p+=2):" "===u[e+1]&&(u=[...k.tP(u,0,e+1),...k.tP(u,e+2)],p+=1),l<=a.startIndex&&(m=p)}it({environment:t,store:r,editorMode:n,newValue:y.vJ3(u.join("")),disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:i,transaction:s}),Re.Z5({store:r,selection:{startIndex:a.startIndex-m,endIndex:a.endIndex-p}})}function dt(e){const{token:t,store:n,readOnly:o}=e;let i=0,r=0;if(t.textValue){let e=0;for(;e<t.tokenIndex;)i+=y.J1x(t.textValue[e]),e++;r=i+y.J1x(t.textValue[e])}Re.Z5({store:n,selection:{startIndex:i,endIndex:r},readOnly:o})}async function ut(e,t){if(!t)return;const n=await async function(e,t){const n=await X.deps.assistantShared.loader();return(0,R.M)(e,t,{parseQueryDatabaseObservation:n.parseQueryDatabaseObservation,parseSimpleXML:n.parseSimpleXML,runParser:n.runParser})}(e,t);if(I.x.isFail(n))return;if(!t)return;const o=ne.Z.getSessionContext(t);if(!o)return;const i=o.getCombinedSteps(),r=n.value,a=i.find((e=>"queryDatabase"===e.type&&e.collectionPointer.id===r));if(null==a||!a.ephemeralViewData)return;const{collectionViewBlockId:s,collectionViewId:l}=a.ephemeralViewData;return D.j.open({collectionViewId:l,collectionViewBlockId:s,assistantSessionId:t})}function pt(e){const{environment:t,event:n,interactiveToken:o,store:a,parentStore:l,canEdit:c}=e,d=y.hDy(o.textToken),u=y.rlz(d),p=y.wPk(d),m=y.V8Y(d),S=y.jC0(d),w=y.zrg(d).map((e=>y.h19(e))),k=y.$d7(d).map((e=>y.fgJ(e))),I=t.RouterStore.state.route,R=Boolean("chat"===I.name);if(y.YrK(o.textToken)&&!n.shiftKey&&!n.altKey){if(n.preventDefault(),!re.Z.state.open){const e=o.textToken,n=document.createRange(),i=o.node.parentNode,r=o.tokenIndex+1;if(n.setStart(i,o.tokenIndex),n.setEnd(i,r),Q.set(n,t.device),rt({environment:t,store:a,usingMultiSelection:!0}),"editing"!==pe.default.state.mode)return;const s=(0,j.QY)(pe.default.state.multiSelection);if(!s)return;return void _e.qn({environment:t,selectedToken:{token:e,position:s.selection},selectionRect:o.node.getBoundingClientRect(),analyticsFrom:"click_token"})}_e.Wj()}const D=[...w,...k].map((e=>{const t=l||a;return de.t1.createChildStore(t,{table:v.qF,id:e,spaceId:(0,b.C)(t.pointer.spaceId)})})),{unresolved:E}=W.bB(D);if(E.length>0){const e=Boolean(u||m),o=oe.Z.state.open||t.device.isMobile,i=(0,G.sQ)(a);if(e&&o)T.LZ();else if(i){const r=n.target&&n.target.getBoundingClientRect();if(T.Ib({environment:t,blockStore:i,analyticsFrom:"existing_comment",discussionIds:E.map((e=>e.id)),rect:r,shouldFocusDiscussion:!1,recursivelyLoadAllDiscussions:!1}),e&&!o)return void n.preventDefault()}}else{W.dv(a)||ee.Z.find((e=>e.isEditing()))||T.LZ()}let B,O;u&&(B=function(e){const t=x.Nm({str:e,allowNoProtocol:!0}),n=x.Qc(t);if(t&&!t.startsWith("/")&&n&&!n.protocol)return`http://${e}`;return t}(y.zW$(u)));let Z=!1;if(m){O=y.TOT(m);const e=de.G.createChildStore(l||a,{table:g.iU,id:O});Z=e.isNavigableBlock();const o=(n.altKey||le.default.isSidePeekOpen())&&!n.metaKey;B=(0,L.ZP)({store:e,openInSidePeek:o,preferPublicLink:(0,H.Sr)(t),getSpaceDomain:()=>{var n;return null===(n=ce.Z.getData(t,{spaceId:e.getSpaceId()}))||void 0===n?void 0:n.domain},pageVisitSource:i.tY.LinkInPage})}if(S){const e=y.Vv0(S);if("query_database_result"===e.type)return void ut(e.queryDatabaseResultId,a.inMemoryRecordCache.relatedAssistantSessionId);if("slack"===e.type)B=(0,_.St)({domain:e.domain,channelId:e.channelId,messageId:e.messageId,threadTs:e.threadTs});else if((0,C.$K)(e.type)&&"block"!==e.type)(0,C.t1)(e.type);else{const o=e.blockId;if(o){const e=de.G.createChildStore(l||a,{table:g.iU,id:o});Z=e.isNavigableBlock();const s=e.getNavigableBlockStore();if(!s)return;B=R&&!n.metaKey?(0,r.t)({pageVisitSource:i.tY.AIQna,pageId:s.id,scrollToBlockId:s.id!==e.id?e.id:void 0}):(0,L.ZP)({store:e,openInSidePeek:!1,preferPublicLink:(0,H.Sr)(t),getSpaceDomain:()=>{var e;return null===(e=ce.Z.getData(t,{spaceId:s.getSpaceId()}))||void 0===e?void 0:e.domain},pageVisitSource:i.tY.AIQna})}}}if(B){n.preventDefault(),Re.ZH(t),De.lY();const{device:e}=t;if(e.isIOS&&Re.sD(),n.shiftKey&&!n.altKey)return;const o=(0,f.Wj)({url:B,baseUrl:F.default.domainBaseUrl,publicDomainName:F.default.publicDomainName,isMobile:t.device.isMobile,protocol:F.default.protocol,currentUrl:window.location.href});if("page"===o.name||"chat"===o.name){const e=U.DJ(n);if(xe.c4({environment:t,url:B,openInNew:e}),m&&O&&he.SK(t,{page_visit_id:se.$g.getCurrentPageVisitId(),mentioned_page_id:O,source_type:"inline_page_mention_token",hover_preview_enabled:!0,is_navigable_block:Z}),a.inMemoryRecordCache.isSyntheticAssistantData){const e=ne.Z.getActiveAssistantConfigurationState(),n="page"===o.name?o.blockId:o.peekViewBlockId;e&&n&&A.trackQnaResultClicked(t,{configurationState:e,clickedPageId:n,source:"chat"})}}else{if("aiGtmFavoriteImport"===o.name&&t.currentUser.isLoggedIn())return void(0,P.importGtmFavorite)({environment:t,importArgs:o});Ce.D({environment:t,url:B})}}else{if(c){const{textToken:e,node:i,tokenIndex:r}=o,s=y.hDy(e);if(y.K9C(s))return De.lY(),M.b(t,{originRect:i.getBoundingClientRect(),textStore:a,tokenIndex:r,allowReminders:"comment"!==a.table}),void n.preventDefault()}if(p){const e=de.T5.createChildStore(a,{table:h.x_,id:p[1],spaceId:p[2]}),o=e.getModel();if(!o)return;const r=z.Dg(e);if(!r)return;const l=de.jQ.createChildStore(r,o.getParentPointer()).getModel();if(!l)return;const c=de.G.createChildStore(r,l.getParentPointer()).getModel(),d=c&&"table_row"===c.getType()?c.getParentId():l.getParentId(),u=(0,s.Z)({pageId:r.id,scrollToBlockId:d,pageModel:r.getModel(),baseUrl:void 0,discussionId:l.id,pageVisitSource:i.tY.MentionInPage});n.preventDefault(),xe.c4({environment:t,url:u})}}}function mt(e){const{environment:t,event:n,interactiveToken:o,store:i,parentStore:r}=e;if(!r)return;const a=y.hDy(o.textToken),s=y.V8Y(a);if(s){const e=y.yrl(s);if(!e)return;const o=de.G.createChildStore(r||i,e);n.preventDefault(),ve.Qn({environment:t,stores:[o],left:n.clientX,top:n.clientY,showInput:!1,actionSectionGroupKey:"page_mention",analyticsFrom:"page_mention_block_menu",pageAnnotationToken:{parentStore:r,pageAnnotation:s}})}}function ft(e){De.HM({token:e.interactiveToken,store:e.store})}function gt(e){De.lY({relatedNode:e.interactiveToken.node})}function ht(e){const{blockStore:t,discussionIds:n,transaction:o}=e;if(t)for(const i of n){const e=de.t1.createChildStore(t,{table:v.qF,id:i,spaceId:(0,b.C)(t.pointer.spaceId)});E.Gu({discussionStore:e,blockStore:t,transaction:o})}}function vt(e){const{oldTextValue:t,newTextValue:n,transaction:o,rootStore:i,removeInlineRecords:r}=e;if(i instanceof de.G){const e=new Set(k.zu(y.llS(t),...y.llS(n)));if(ht({blockStore:i,discussionIds:e,transaction:o}),i.isType("table_row")){ht({blockStore:i.getParentBlockStore(),discussionIds:e,transaction:o})}const r=k.zu(y.llS(n),...y.llS(t));for(const t of r)if(E.tR({transaction:o,blockStore:i,discussionId:t}),i.isType("table_row")){const e=i.getParentBlockStore();e&&E.tR({transaction:o,blockStore:e,discussionId:t})}}r&&bt(e)}function bt(e){const{store:t,environment:n,oldTextValue:o,newTextValue:i,transaction:r,rootStore:a}=e;if(a instanceof de.G){const e=a.getValue();if(e){const s=(0,p.m3)({parentBlock:e,oldTextValue:o,newTextValue:i,getRecordValue:t.getRecordValue,baseUrl:F.default.domainBaseUrl,publicDomainName:F.default.publicDomainName});we.lP({environment:n,transaction:r,parentStore:a,inlinePageIds:s})}}const s=k.zu(y.zUo(o),...y.zUo(i));for(const l of s){const e=de.G.createChildStore(a,{table:g.iU,id:l,spaceId:(0,b.C)(a.pointer.spaceId)});Ie.sW({store:e,data:{alive:!1},transaction:r})}}function yt(e){const{block:t,editorMode:n,transaction:o,tokenIndex:i}=e,r=t.getBlockTitleStore();if(!t.getTitleStore()||!r.isDefined()||!r.getValue()||r.getValue().length<i)return!1;const a=r.getValue(),s=y.VrM(a.slice(0,i)),l=y.VrM(a.slice(0,i+1));return Oe({environment:t.environment,editorMode:n,store:r,selection:{startIndex:s,endIndex:l},transaction:o,updateSelection:!1,removeInlineRecords:!0}),!0}function _t(e){var t;const{store:n,editorMode:o,transaction:i}=e,r=be.tk();if(!r)return;if(!("editing"===pe.default.state.mode&&(null===(t=(0,j.QY)(pe.default.state.multiSelection))||void 0===t?void 0:t.selection)))return;const a=n.getValue();if(!a)return;const s=(0,c.UQ)(a,r.parentCollection,n.getRecordModel);je({environment:n.environment,editorMode:o,store:n,value:s,transaction:i})}},98724:(e,t,n)=>{n.d(t,{QE:()=>g,aS:()=>m,bt:()=>h,mX:()=>f});var o=n(70203),i=n(53965),r=n(45162),a=n(65598),s=n(89086),l=n(24666),c=n(9953),d=n(993),u=n(98104),p=n(13447);function m(e){const{environment:t,annotation:n}=e,o=l.default.state;if("editing"!==o.mode)return;if(l.default.isEmptySelection())return void u.Km({annotation:n});const{multiSelection:i}=o;(0,r.L5)(i).length>0&&(p.createAndCommit({userAction:"textAnnotationActions.annotateSelection",environment:t,perform:t=>{d.MY({...e,transaction:t,multiSelection:i})}}),u.NA({multiSelection:i}))}function f(e){const{environment:t,annotationType:n}=e,o=l.default.state;if("editing"!==o.mode)return;if(l.default.isEmptySelection())return;const{multiSelection:i}=o,a=(0,r.L5)(i);a.length>0&&(p.createAndCommit({userAction:"textAnnotationActions.unannotateSelection",environment:t,perform:e=>{for(const{selection:o,store:i}of a)d.Be({environment:t,store:i,type:n,selection:o,transaction:e})}}),u.NA({multiSelection:i}))}function g(e){const{environment:t,annotationType:n,blocks:o,transaction:i}=e;for(const r of(0,a.Sd)({blockStores:o,traverseTransclusionReferences:!1})){const e=r.getBlockTitleStore(),o=(0,s.P2)(e);o&&d.Be({environment:t,store:e,type:n,selection:o,transaction:i})}}function h(e){const{environment:t,store:n,context:r,transaction:a}=e;if(!n.canEdit())return;const{title:s,...l}=n.getProperties(),u=Object.entries(l).reduce(((e,t)=>{let[n,a]=t;if(a){const t=o.KV2(a,r);i.Xy(a,t)||(e[n]=t)}return e}),{});i.xb(u)||c.sW({store:n.getPropertiesStore(),data:u,transaction:a});const p=n.getTitleValue();if(p){const e=o.KV2(p,r);i.Xy(p,e)||d.sO({environment:t,editorMode:"default",store:n.getBlockTitleStore(),value:e,transaction:a})}}},94887:(e,t,n)=>{n.d(t,{ew:()=>V,as:()=>j,YV:()=>N});n(67635);var o=n(1302),i=n(41432),r=n(80951),a=n(59730),s=n(70203),l=n(53965),c=n(7032),d=n(17707),u=n(1600),p=n(78791),m=n(27105),f=n(68056),g=n(45162),h=n(73959),v=n(89086),b=n(35328),y=n(28685),_=n(95802),S=n(77080),w=n(24666),k=n(96802),I=n(44886),C=n(94419),x=n(42858),T=n(24677),M=n(33709),P=n(23867),A=n(6258),R=n(993);function D(e){const{environment:t,transaction:n,multiSelection:o,blockStore:i,suggestDiscussionId:r}=e;R.KM({environment:t,annotation:[s.GKr.SuggestionRemoveText,r],multiSelection:o,transaction:n});const a=A.t1.createChildStore(i,{table:M.qF,id:r,spaceId:(0,P.C)(i.pointer.spaceId)});u.vh(a,n)}var E=n(98104),B=n(95982),F=n(68422);function O(e){const{transaction:t,store:n,block:o,targetStore:i,targetBlock:r}=e;o&&(0,m.Ls)({store:n,blockStore:o})&&r&&(0,m.Ls)({store:i,blockStore:r})?p.tE({transaction:t,targetStore:i,block:o}):Z(e)}function Z(e){const{environment:t,editorMode:n,transaction:o,store:i,targetStore:r}=e,a=(0,v.x0)(r);a?R.gc({environment:t,editorMode:n,sourceStore:i,sourceIndex:0,targetStore:r,targetIndex:a.endIndex,transaction:o}):R.pe({environment:t,transaction:o,editorMode:n,store:i,selection:{startIndex:0,endIndex:1/0}})}function V(e){const{environment:t,store:n,transaction:a}=e;a.annotateWithUserAction("textBackspaceActions.annotatedContentBlockBackspaceAtBeginning");const s=(0,h.sQ)(n);if(s){if("callout"===s.getType()&&k.FH({stores:[s],update:{block_color:void 0},transaction:a}),s.isType("to_do")){const e=s.getProperties();e&&r.Ml(e.checked)&&B.c({environment:t,blocks:[s],transaction:a})}let e=s,n=i.Ti.text;if(b.fn(s)){const e=s.getType();e&&(n=e)}e=F.vs({environment:t,block:s,blockType:n,transaction:a}),o.default.afterNextFlush((()=>{const n=_.C.findEditableStoreWithin(e);n&&(E.N_({store:n}),T.eP({environment:t,store:e}))}))}return n}function U(e){const{multiSelection:t,event:n}=e,o=(0,h.sQ)(t.start.store);if(!o)throw new a.p8("Can not make suggest edits without associated block store");n.preventDefault(),(0,f.iG)(t)?function(e){const{environment:t,multiSelection:n,transaction:o,deleteForwards:i,blockStore:r}=e;let a;const l=n.start,u={indexOfAboutToBeDeletedChar:i?l.index:l.index-1,indexOfLeadingChar:i?l.index-1:l.index,annotateSelectionIndex:i?[l.index,l.index+1]:[l.index-1,l.index],newCursorIndex:i?l.index+1:l.index-1},p={start:{store:l.store,index:u.annotateSelectionIndex[0]},end:{store:l.store,index:u.annotateSelectionIndex[1]}};if(function(e){const{blockStore:t,index:n}=e,o=(0,v.W8)(t.getTitleValue(),n,s.GKr.SuggestionInsertText);if(o&&s.BIG(o))return!0;return!1}({blockStore:r,index:u.indexOfAboutToBeDeletedChar}))return void R.pz({...e,multiSelection:p,editorMode:"suggest"});const[m,f]=[u.indexOfAboutToBeDeletedChar,u.indexOfLeadingChar].map((e=>{const t=(0,v.W8)(r.getTitleValue(),e,s.GKr.SuggestionRemoveText);if(t&&s.BIG(t))return s.fgJ(t)})),g=s.eeV(r.getTitleValue()).length;(i&&l.index<g||!i&&l.index>0)&&L(l.store,u.newCursorIndex);if(m)return;if(f)a=f;else{const e=(0,c.ZP)(),n={createDiscussionArgs:{type:"suggestion",modifiedBlockIds:[r.id],snapshotTextValue:s.KU1(r.getTitleValue(),p.start.index,p.end.index)},blockStore:r,environment:t,transaction:o,commentTextValue:[[""]],files:[],discussionId:e};d.cj(n),a=e}D({...e,multiSelection:p,blockStore:r,suggestDiscussionId:a})}({...e,blockStore:o}):function(e){const{multiSelection:t,blockStore:n}=e,o=g.L5(t),i=o.map((e=>e.store.id)),{discussionStore:r}=u.L9({...e,blockStore:n,modifiedBlockIds:i});D({...e,suggestDiscussionId:r.id}),L(t.start.store,t.start.index)}({...e,blockStore:o})}function L(e,t){E.NA({multiSelection:{start:{store:e,index:t},end:{store:e,index:t}}})}function j(e){const{environment:t,editorMode:n,multiSelection:r,transaction:a,deleteForwards:s,event:c}=e,d=t.device.isApple&&c.metaKey,u=!(t.device.isIOS&&(0,f.iG)(r));E.aJ();const p=(0,f.QY)(r);if("suggest"===n)return void U(e);if(p&&0===p.selection.startIndex&&0===p.selection.endIndex&&!s){const{store:e}=p;c.preventDefault();const r=(0,h.sQ)(e);if(r){const s=r.getModel();if(s){const r=s.isType(i.q7);r&&!d?V({environment:t,store:e,transaction:a}):s.isType(i.Q3)||r&&d?function(e){const{store:t,editorMode:n,transaction:i,environment:r}=e;i.annotateWithUserAction("textBackspaceActions.textBackspaceAtBeginning");const a=(0,h.sQ)(t);if(!a)return;const s=(0,h.sQ)(a),c=s&&(0,h.sQ)(s);if(s&&c){const e=s.getRenderableContentIds()??[];if(!(l.Z$(e)!==a.id||s.isTransclusionType()||b.BX(s)&&l.Ps(e)===a.id||"tab"===c.getType())){const e=I.uv({block:a,parentStore:s,grandparentStore:c,transaction:i});if(e)return void o.default.afterNextFlush((()=>{if(e){const t=_.C.findEditableStoreWithin(e);t&&(T.eP({environment:r,store:e}),E.N_({store:t}))}}))}}if(S.default.checkGate("text_align")){if("center"===a.getFormat().block_alignment)return void k.hc({environment:r,store:a,alignment:"left",transaction:i});if("right"===a.getFormat().block_alignment)return void k.hc({environment:r,store:a,alignment:"center",transaction:i})}const d=y.E.getMembersByDOMOrder({filter:e=>!e.props.store.inMemoryRecordCache.isMockTextStore}),u=l.cx(d,(e=>e.props.store===t)),p=l.dF(d,((e,t)=>t<u&&e.props.canInsertText));let m;if(p&&(m=p.props.store),m&&a){const e=(0,v.x0)(m),o=(0,h.sQ)(m);if(O({environment:r,editorMode:n,transaction:i,store:t,block:a,targetStore:m,targetBlock:o}),E.Z5({store:m,selection:e}),T.eP({environment:r,store:o}),!b.BX(a)&&s){const e=a.getContentStores();for(const o of e)C.Vt({parent:s.getContentStore(),before:a,insert:o,transaction:i});const t=a.getContentStore(),n=a.getContentStores();for(const o of n)C.Od({parent:t,childToRemove:o,transaction:i})}x.Od({store:a,transaction:i})}}({environment:t,editorMode:n,store:e,transaction:a}):p.store.path.includes("caption")&&function(e){const{environment:t,editorMode:n,store:o,transaction:i}=e;i.annotateWithUserAction("textBackspaceActions.captionBackspaceAtBeginning");const r=y.E.getMembersByDOMOrder({filter:()=>!0}),a=r.findIndex((e=>e.props.store===o)),s=r.findLast(((e,t)=>t<a&&e.props.canInsertText)),l=null==s?void 0:s.props.store;if(!l)return;if(!(0,h.sQ)(o))return;const c=(0,v.x0)(l);Z({environment:t,editorMode:n,store:o,targetStore:l,transaction:i}),E.Z5({store:l,selection:c});const d=(0,h.sQ)(l);T.eP({environment:t,store:d})}({environment:t,editorMode:n,store:e,transaction:a})}}}else p&&(0,v.J_)(p.store,p.selection)&&s?(c.preventDefault(),function(e){const{environment:t,editorMode:n,store:o,transaction:i}=e;i.annotateWithUserAction("textBackspaceActions.textDeleteAtEnd");const r=y.E.getMembersByDOMOrder({filter:()=>!0}),a=l.cx(r,(e=>e.props.store===o)),s=r.find(((e,t)=>Boolean(t>a&&e.props.canInsertText)));let c;s&&(c=s.props.store);const d=(0,h.sQ)(o);if(d&&c){const e="readOnly"===w.default.state.mode,r="empty"!==w.default.state.mode&&w.default.state.multiSelection,a=(0,h.sQ)(c);if(O({environment:t,editorMode:n,transaction:i,store:c,block:a,targetStore:o,targetBlock:d}),a){const t=(0,h.sQ)(a);if(t){const e=a.getContentStore(),n=a.getContentStores();for(const o of n)C.Od({parent:e,childToRemove:o,transaction:i}),C.Vt({parent:t.getContentStore(),before:a,insert:o,transaction:i})}x.Od({store:a,transaction:i}),r&&E.NA({multiSelection:r,readOnly:e})}}}({environment:t,editorMode:n,store:p.store,transaction:a})):u&&(c.preventDefault(),function(e){const{environment:t,editorMode:n,multiSelection:o,transaction:i,deleteForwards:r}=e;let a;i.annotateWithUserAction("textBackspaceActions.textBackspaceWithinContent"),a=(0,f.iG)(o)?r?{start:o.start,end:{store:o.start.store,index:o.start.index+1}}:{start:{store:o.start.store,index:o.start.index-1},end:o.start}:o,R.pz({environment:t,editorMode:n,multiSelection:a,transaction:i})}({environment:t,editorMode:n,multiSelection:r,deleteForwards:s,transaction:a}));const m=w.default.state;"editing"===m.mode&&(0,v.ST)(m.multiSelection.start.store.getValue(),m.multiSelection.start.index-1,"c")&&E.aR({annotation:["c"],extend:!0})}function N(e){const{event:t,multiSelection:n,device:o}=e;return(o.isApple&&t.metaKey||!o.isApple&&t.ctrlKey||o.isApple&&t.altKey)&&!(0,v.dQ)(n)}},74284:(e,t,n)=>{n.d(t,{IO:()=>T,PF:()=>A});n(52262),n(24506);var o=n(1302),i=n(41432),r=n(21202),a=n(70203),s=n(82798),l=n(78791),c=n(68056),d=n(73959),u=n(35328),p=n(77080),m=n(6258),f=n(24666),g=n(45131),h=n(81023),v=n(952),b=n(44886),y=n(94419),_=n(9953),S=n(61045),w=n(24677),k=n(993),I=n(94887),C=n(98104);function x(e){const t=(0,d.sQ)(e.store);if(t&&function(e){var t;const n=e.getType();return!!n&&(!!(0,i.he)(n)&&!(e.id!==(null===(t=e.getParentBlockStore())||void 0===t?void 0:t.getRenderableContentIds().at(-1))))}(t)){const n=b.rB({environment:e.environment,blocks:[t],transaction:e.transaction});if(n)return void o.default.afterNextFlush((()=>{const e=n[0].getTitleStore();e&&C.NA({multiSelection:{start:{store:e,index:0},end:{store:e,index:0}}})}))}I.ew(e)}function T(e){const{environment:t,transaction:n,multiSelection:r}=e;h.M_(t)&&((0,d.x7)(r.start.store)?function(e){const{environment:t,editorMode:n,transaction:r}=e;let a=e.multiSelection;const s=(0,d.sQ)(a.start.store);if(!s||s.isCollectionView())return;k.pz({environment:t,editorMode:n,multiSelection:a,transaction:r});const l=f.default.state;a="editing"===l.mode&&l.multiSelection||a;const c=a.start.store,u={environment:t,type:i.Ti.text,inMemoryRecordCache:c.inMemoryRecordCache,transaction:r,spaceId:s.pointer.spaceId,useCrdt:s.useCrdt()},p="default"===n?_.j4(u):_.GI(u),m=y.Ce({parent:s.getContentStore(),prepend:p,transaction:r}).child;A({environment:t,editorMode:n,block:s,store:c,targetBlock:m,splitAtIndex:a.start.index,transaction:r}),o.default.afterNextFlush((()=>{C.N_({store:m.getBlockTitleStore()})})),v.W(t,{from:"text_enter",type:i.Ti.text,creating_block_id:p.id,parent_collection_id:p.getParentCollectionIdUpToTwoLevels()})}(e):(0,c.iG)(r)&&function(e){const t=e.getRecordStoreUIParent();return t instanceof m.G&&e&&t.isType(i.q7)&&0===a.QaF(t.getTitleValue()).length}(r.start.store)?x({environment:t,transaction:n,store:r.start.store}):(0,c.ko)(r)&&M(r.start.store)&&P(r.start.store)?function(e){var t;const{environment:n,transaction:r,multiSelection:a}=e,s=a.start.store,l=(0,d.sQ)(s);if(!l)return;const c=l.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:t}=e;return t(l)})),u=(0,d.sQ)(l);if(!c||!u)return;const p=_.j4({environment:n,type:(0,i.he)(c.type)?c.type:i.Ti.text,inMemoryRecordCache:s.inMemoryRecordCache,transaction:r,spaceId:u.pointer.spaceId,properties:c.properties?R(c.properties):void 0,format:c.format?D(c.format):void 0,permissions:c.permissions,useCrdt:Boolean(null===(t=c.format)||void 0===t?void 0:t.use_crdt)});y.Vt({parent:u.getContentStore(),before:l,insert:p,transaction:r}).child,v.W(n,{from:"text_enter",type:i.Ti.text,creating_block_id:p.id,parent_collection_id:p.getParentCollectionIdUpToTwoLevels()}),n.device.isMobile&&o.default.afterNextFlush((()=>S.hQ(n)))}(e):function(e){var t;const{environment:n,editorMode:o,transaction:r}=e;let a=e.multiSelection;const s=(0,d.sQ)(a.start.store);if(!s)return;const l=(0,d.sQ)(s);if(!l)return;k.pz(e);const c=f.default.state;a="editing"===c.mode&&c.multiSelection||a;const m=a.start.store,h=s.getType(),b=s.getContentLength(),S=s.getModel();let w;if((0,u.BX)(s)&&g.Z.isOpen(s.id))w=i.Ti.text;else if(S&&b>0&&S.isType(i.nH)){w=i.Ti.text;const e=s.getContentStores()[0];if(e){const t=e.getType();e.isDefined()&&t&&i.kC[t]&&(w=t)}}else w=!(h&&S&&!S.isType(i.Q2)&&M(m)&&P(m)&&"code"!==h)||S.isType("ai_block")&&S.isSkillBlock()?i.Ti.text:h;const I={environment:n,type:w,inMemoryRecordCache:m.inMemoryRecordCache,transaction:r,spaceId:l.pointer.spaceId,format:{block_alignment:p.default.checkGate("text_align")?null===(t=s.getFormat())||void 0===t?void 0:t.block_alignment:void 0},useCrdt:s.useCrdt()},C="default"===o?_.j4(I):_.GI(I),x=l.getRenderableContentIds()||[];let T,R=!1;if((0,u.BX)(s)&&g.Z.isOpen(s.id)){const e=s.getContentStore();R=!0,T=y.Ce({parent:e,prepend:C,transaction:r})}else if(S&&b&&S.isType(i.nH)){const e=s.getContentStore();R=!0,T=y.Ce({parent:e,prepend:C,transaction:r})}else if(null!=S&&S.isType("ai_block")&&S.isSkillBlock()){const e=s.getContentStore();R=!0,T=y.Ce({parent:e,prepend:C,transaction:r})}else T=x.indexOf(s.id)>=0?y.BE({parent:l.getContentStore(),after:s,insert:C,transaction:r}):y.Ce({parent:l.getContentStore(),prepend:C,transaction:r});const D=T.child;if(M(m)&&h&&!R&&!(0,u.BX)(s)){const e=s.getContentStores(),t=s.getContentStore(),n=D.getContentStore();for(const o of e)y.Od({parent:t,childToRemove:o,transaction:r}),y.R3({parent:n,append:o,transaction:r})}A({environment:n,editorMode:o,block:s,store:a.start.store,targetBlock:D,splitAtIndex:a.start.index,transaction:r}),v.W(n,{from:"text_enter",type:w,creating_block_id:C.id,is_toggleable:(0,u._A)(w,C.getFormat()),parent_collection_id:C.getParentCollectionIdUpToTwoLevels()})}(e),t.device.isMobile||o.default.afterNextFlush((()=>{S.Zv()})))}function M(e){if(e.table===r.iU){const t=m.G.createChildStore(e,{table:r.iU,id:e.id}).getType();return t&&!(0,i.S9)(t)}return!1}function P(e){if(e.table===r.iU){const t=m.G.createChildStore(e,{table:r.iU,id:e.id}).getModel();return t&&!t.isType(i.oe)&&!t.isType(i.Ok)}return!1}function A(e){const{environment:t,editorMode:n,block:o,store:i,targetBlock:r,splitAtIndex:a,transaction:d}=e,u={store:i,index:a},p={start:u,end:u};if(o.useCrdt()&&o.getBlockTitleStore()===i){(0,s.T)(r.useCrdt(),"Calling splitText() with a non-CRDT target block is not currently supported");(0,c.NV)(p)||l.Wc({sourceBlockStore:o,targetBlockStore:r,splitAtGraphemeIndex:a,transaction:d,moveIntoNewBlock:!0})}else k.gc({environment:t,editorMode:n,sourceStore:p.end.store,sourceIndex:p.end.index,targetStore:r.getBlockTitleStore(),targetIndex:0,transaction:d});w.eP({environment:t,store:r}),C.N_({store:r.getBlockTitleStore()})}function R(e){const{title:t,...n}=e;return n}function D(e){const{text_slice_tree:t,text_clocks:n,...o}=e;return o}},17269:(e,t,n)=>{n.d(t,{G:()=>H,f:()=>K});n(97391),n(57658);var o=n(41432),i=n(15095),r=n(23512),a=n(21202),s=n(70203),l=n(82798),c=n(11342),d=n(53965),u=n(1898),p=n(40959),m=n(83631);function f(e,t){return i.p4(e.substring(0,t)).length}var g=n(68056),h=n(99445),v=n(73959),b=n(35328),y=n(6258),_=n(27724),S=n(24666),w=n(36610),k=n(47839),I=n(96802),C=n(42858),x=n(24677),T=n(993),M=n(74284),P=n(98104),A=n(13447),R=n(68422);function D(e){var t;const{environment:n,store:r,toBlockType:a,matchRegex:c,insertTextAfter:d,transaction:u,postTransformAction:m,editorMode:f}=e,h="editing"===S.default.state.mode&&(null===(t=(0,g.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!h)return;const k=i.p4(s.QaF(r.getValue())).slice(0,h.endIndex).join(""),I=c.exec(k);if(!I)return;const A=r.getRecordStoreUIParent();if(!(A&&A instanceof y.G))return;const D=A.getType();if(!D)return;if(D!==o.Ti.text&&!o.q7[D])return;const E=a(I);if(void 0===E||E===D)return;let B=E;A instanceof y.G&&("toggle"===E&&(0,o.zp)(A.getType())?B=b.m1(D):"toggle"===D&&b.JO(E)&&(B=b.m1(E)),R.vs({environment:n,block:A,blockType:B,transaction:u}));const F={startIndex:0,endIndex:I&&i.p4(I[0]).length||0};if(T.pe({environment:n,store:r,selection:F,transaction:u,editorMode:f}),d){const e=C.aO({environment:n,selection:_.default.state.stores,createBlockItem:p.Hc[o.Ti.text],analyticsFrom:"divider"===E?"divider_block_transform":"text_filter_actions",transaction:u});e&&(M.PF({environment:n,editorMode:f,block:(0,l.TO)((0,v.sQ)(r)),store:r,targetBlock:e,splitAtIndex:0,transaction:u}),x.eP({environment:n,store:e}),P.N_({store:e.getBlockTitleStore()}))}m&&m(I),w.g_(n,{type:E})}function E(e){var t,n;const{environment:o,editorMode:r,store:a,transaction:l,regex:c,length:d,analyticsType:u,replace:p}=e,m="editing"===S.default.state.mode&&(null===(t=(0,g.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!m)return;const h=a.getValue()||[],v=s.QaF(h),b=i.p4(v).slice(0,m.endIndex).join(""),y=c.exec(b);if(!y)return;const _=f(v,y.index),k={startIndex:_,endIndex:_+d},I=a.getValue()||[];if(s.oP(I,k.startIndex,k.endIndex,"c"))return;const C="function"==typeof p?p({match:y,matchIndex:_,textValue:h}):p;if(void 0===C)return;if(T.pe({environment:o,editorMode:r,store:a,selection:k,transaction:l}),"editing"!==S.default.state.mode)return;const x=null===(n=(0,g.QY)(S.default.state.multiSelection))||void 0===n?void 0:n.selection;x&&(T.hJ({environment:o,editorMode:r,store:a,selection:x,string:C,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:l}),w.Af(o,{type:u}))}function B(e){var t;const{environment:n,store:o,editorMode:r,delimiter:a,annotation:l,transaction:c}=e,d="editing"===S.default.state.mode&&(null===(t=(0,g.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!d)return;const u=o.getValue(),p=F({delimiter:a,storeValue:u,selectionEndIndex:d.endIndex});if(!p)return;if(!O({delimiter:a,storeValue:u,...p}))return;if(s.p9b(u,p.startIndex,p.endIndex,s.GKr.Code))return;const{textValue:m,startIndex:h,endIndex:v}=p,b=f(m,h),y=m.slice(h,v),_=i.p4(y).length,k={startIndex:b,endIndex:b+a.length};T.pe({environment:n,editorMode:r,store:o,selection:k,transaction:c});const I={startIndex:b+_-a.length-a.length,endIndex:b+_-a.length};T.pe({environment:n,editorMode:r,store:o,selection:I,transaction:c});const C={startIndex:k.startIndex,endIndex:I.startIndex};T.i8({environment:n,store:o,selection:C,annotation:l,transaction:c});const x=C.endIndex;P.Z5({store:o,selection:{startIndex:x,endIndex:x}}),P.aR({annotation:l,extend:!1}),w.tn(n,{type:s.J7s(l)})}function F(e){const{delimiter:t,storeValue:n,selectionEndIndex:o}=e,r=i.p4(s.QaF(n)).slice(0,o).join("");if(0===r.length||!r.endsWith(t))return;const a=r.split(t);if(a.length<=2)return;a.reverse();const[l,...c]=a.slice(1),u=d.Sm(c.map((e=>e.length+t.length)))-t.length;return{textValue:r,matchString:l,startIndex:u,endIndex:u+l.length+2*t.length}}function O(e){const{delimiter:t,matchString:n,startIndex:o,endIndex:i,textValue:r}=e;return n.length>0&&!/\s/g.test(n[0])&&!/\s/g.test(n[n.length-1])&&!n.startsWith(t)&&!n.endsWith(t)&&(!r[o-1]||/[\s(]/g.test(r[o-1]))&&(!r[i]||/[\s)]/g.test(r[i]))}function Z(e){var t;const{environment:n,delimiter:o,store:r,transaction:a,editorMode:l}=e,c="editing"===S.default.state.mode&&(null===(t=(0,g.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!c)return;const d=r.getValue(),u=F({delimiter:o,storeValue:d,selectionEndIndex:c.endIndex});if(!u)return;if(!function(e){const{storeValue:t,startIndex:n,endIndex:o,delimiter:i}=e;if(!O(e))return!1;const r={[s.GKr.User]:s.GKr.User,[s.GKr.Page]:s.GKr.Page,[s.GKr.Comment]:s.GKr.Comment,[s.GKr.Bot]:s.GKr.Bot,[s.GKr.ExternalObjectInstance]:s.GKr.ExternalObjectInstance,[s.GKr.Date]:s.GKr.Date,[s.GKr.TemporaryPage]:s.GKr.TemporaryPage,[s.GKr.TemplateVariable]:s.GKr.TemplateVariable,[s.GKr.FormulaPageProperty]:s.GKr.FormulaPageProperty,[s.GKr.FormulaContextValue]:s.GKr.FormulaContextValue,[s.GKr.Group]:s.GKr.Group,[s.GKr.Citation]:s.GKr.Citation};for(const a of Object.values(r))if(s.oP(t,n,o,a))return!1;if(s.oP(t,n,n+i.length,s.GKr.Code)&&s.oP(t,o-i.length,o,s.GKr.Code))return!1;return!0}({delimiter:o,storeValue:d,...u}))return;const{textValue:p,matchString:h,startIndex:v,endIndex:b}=u,y=f(p,v),_=p.slice(v,b);T.pe({environment:n,store:r,selection:{startIndex:y,endIndex:y+i.p4(_).length},transaction:a,editorMode:l});const k=s.qZ6(h);T.mM({environment:n,store:r,tokens:[k],index:y,transaction:a});const I=y+i.p4(s.WiV(k)).length;P.Z5({store:r,selection:{startIndex:I,endIndex:I}}),w.tn(n,{type:s.GKr.Equation}),m.ND({environment:n,equation:h,from:{type:"create",source:"text_filter",selection:!0}})}const V=["\\.",",",";","\\?","!","\\)","\\]"," "].join("|"),U=new RegExp(` (${V})$`);function L(e){const t=s.xrQ(e.textValue,e.matchIndex-1,e.matchIndex),n=d.Z$(t.tokensInsideRange);if(n&&s.km_(n))return e.match[1]}const j=[{delimiter:"**",type:s.GKr.Bold},{delimiter:"ï¼Šï¼Š",type:s.GKr.Bold},{delimiter:"*",type:s.GKr.Italic},{delimiter:"ï¼Š",type:s.GKr.Italic},{delimiter:"__",type:s.GKr.Bold},{delimiter:"ï¼¿ï¼¿",type:s.GKr.Bold},{delimiter:"_",type:s.GKr.Italic},{delimiter:"ï¼¿",type:s.GKr.Italic},{delimiter:"~",type:s.GKr.Strike},{delimiter:"ã€œ",type:s.GKr.Strike},{delimiter:"ï½ž",type:s.GKr.Strike}],N=[{toBlockType:()=>o.Ti.toDo,matchRegex:/^(\[\] |\[ \] |\ã€Œ\ã€ã€€)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.subSubHeader,matchRegex:/^(### |ï¼ƒï¼ƒï¼ƒ)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.subHeader,matchRegex:/^(## |ï¼ƒï¼ƒ)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.header,matchRegex:/^(# |ï¼ƒ)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.toggle,matchRegex:/^(> |ï¼ž)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.quote,matchRegex:/^(\| |\" |\â€œ |\â€)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.bulletedList,matchRegex:/^(\* |\- |\+ |\ï¼Š|\ãƒ¼|\ï¼‹|\ãƒ»)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.divider,matchRegex:/^â€”-$/,insertTextAfter:!0}],z=[{annotationDelimiter:"`",blockMatchRegex:/^```$/},{annotationDelimiter:"Â´",blockMatchRegex:/^Â´Â´Â´$/},{annotationDelimiter:"ï½€",blockMatchRegex:/^ï½€ï½€ï½€$/}],q=[{regex:/^'$/,length:1,replace:"â€˜",analyticsType:"sentence_start_single_quote"},{regex:/ '$/,length:2,replace:" â€˜",analyticsType:"start_single_quote"},{regex:/'$/,length:1,replace:"â€™",analyticsType:"middle_single_quote"}],W=[{regex:/^"$/,length:1,replace:"â€œ",analyticsType:"sentence_start_double_quote"},{regex:/ "$/,length:2,replace:" â€œ",analyticsType:"start_double_quote"},{regex:/"$/,length:1,replace:"â€",analyticsType:"end_double_quote"},{regex:/--$/,length:2,replace:"â€”",analyticsType:"em_dash"},{regex:/->$/,length:2,replace:"â†’",analyticsType:"right_arrow"},{regex:/<->$/,length:3,replace:"â†”",analyticsType:"right_left_arrow"},{regex:/â†>$/,length:2,replace:"â†”",analyticsType:"right_left_arrow"},{regex:/=>$/,length:2,replace:"â‡’",analyticsType:"right_arrow_double"},{regex:/<-$/,length:2,replace:"â†",analyticsType:"left_arrow"},{regex:/>=$/,length:2,replace:"â‰¥",analyticsType:"greater_than_or_equal_to"},{regex:/<=$/,length:2,replace:"â‰¤",analyticsType:"less_than_or_equal_to"},{regex:/!=$/,length:2,replace:"â‰ ",analyticsType:"not_equal"},{regex:/\.\.\.$/,length:3,replace:"â€¦",analyticsType:"ellipsis"}];function H(e){const{environment:t,editorMode:n,store:l,transaction:p}=e,m=l.getRecordStoreAtRootPath(),v=m instanceof y.G?m.getType():void 0;if("code"!==v||S.default.isEditingCaption()){if("callout"!==v){for(const e of N)D({environment:t,editorMode:n,store:l,toBlockType:e.toBlockType,matchRegex:e.matchRegex,insertTextAfter:e.insertTextAfter,transaction:p});D({environment:t,editorMode:n,store:l,matchRegex:/^(\d+|[\uff10-\uff19]+)(\. |\ã€‚|\ï¼Ž)$/,insertTextAfter:!1,transaction:p,toBlockType:t=>{var n;const o=t[1],i=(0,r.DA)(o);return null===(n=G(e,parseInt(i)))||void 0===n?void 0:n.type},postTransformAction:t=>{var n;const o=t[1],i=(0,r.DA)(o),s=null===(n=G(e,parseInt(i)))||void 0===n?void 0:n.number;if(l.table!==a.iU)return;const c=l.getRecordStoreAtRootPath();if(!(c instanceof y.G))return;const d=(0,u.$K)(s)&&s>-1?s:void 0;I.FH({stores:[c],update:{list_start_index:d},transaction:p})}}),D({environment:t,editorMode:n,store:l,matchRegex:/^([a-z]+)(\. |\ã€‚|\ï¼Ž)$/,insertTextAfter:!1,transaction:p,toBlockType:t=>{const n=(0,h.UF)(t[1]),o=G(e,n);if(1===n||void 0===(null==o?void 0:o.number))return null==o?void 0:o.type},postTransformAction:()=>{m instanceof y.G&&I.FH({stores:[m],update:{list_format:"roman"},transaction:p})}}),D({environment:t,editorMode:n,store:l,matchRegex:/^([a-z]+)(\. |\ã€‚|\ï¼Ž)$/,insertTextAfter:!1,transaction:p,toBlockType:t=>{const n=(0,h.yk)(t[1]),o=G(e,n);if(1===n||void 0===(null==o?void 0:o.number))return null==o?void 0:o.type},postTransformAction:()=>{m instanceof y.G&&I.FH({stores:[m],update:{list_format:"letters"},transaction:p})}});for(const{blockMatchRegex:e}of z)D({environment:t,editorMode:n,store:l,toBlockType:()=>o.Ti.code,matchRegex:e,insertTextAfter:!1,transaction:p})}if(!function(e){var t;const n="editing"===S.default.state.mode&&(null===(t=(0,g.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!n)return!1;const o=e.getValue()||[],i=s.xrQ(o,0,n.endIndex),r=d.qr(i.tokensInsideRange,(e=>s.hDy(e).some((e=>s.fTS(e))))),a=i.tokensInsideRange.slice(-1===r?0:r,i.tokensInsideRange.length),l=s.QaF(a);return Boolean(l.match(/(^| )`[^ ]/))}(l)){const e=k.getSubstitutions();for(const i of e)E({environment:t,editorMode:n,store:l,transaction:p,regex:i.replace,length:i.length,replace:i.with,analyticsType:"custom_substitution"});for(const i of W)E({environment:t,editorMode:n,store:l,transaction:p,regex:i.regex,length:i.length,replace:i.replace,analyticsType:i.analyticsType});const o=t.device.browserVersion.split(".").map((e=>parseInt(e,10)));if(!t.device.isSafari||(0,c.isGreaterThanOrEqualToVersion)(o,[16,4]))for(const i of q)E({environment:t,editorMode:n,store:l,transaction:p,regex:i.regex,length:i.length,replace:i.replace,analyticsType:i.analyticsType});!function(e){E({environment:e.environment,editorMode:e.editorMode,store:e.store,transaction:e.transaction,regex:U,length:2,replace:L,analyticsType:"mention_punctuation"})}({environment:t,editorMode:n,store:l,transaction:p})}for(const{annotationDelimiter:e}of z)B({environment:t,editorMode:n,delimiter:e,annotation:[s.GKr.Code],store:l,transaction:p});for(const{delimiter:e,type:o}of j)B({environment:t,editorMode:n,delimiter:e,annotation:[o],store:l,transaction:p});Z({environment:t,editorMode:n,delimiter:"$$",store:l,transaction:p}),Z({environment:t,editorMode:n,delimiter:"ï¼„ï¼„",store:l,transaction:p}),function(e){var t;const{environment:n,store:o,transaction:r}=e,a="editing"===S.default.state.mode&&(null===(t=(0,g.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!a)return;const l=o.getValue(),c=i.p4(s.QaF(l)).slice(0,a.endIndex).join("");if(s.oP(l,a.startIndex,a.endIndex,"c"))return;const d=/([^ ]+) $/.exec(c);if(!d)return;const u=d[1],p=s.rOz(u);if(!p)return;const{value:m,href:h}=p,v=f(c,c.indexOf(m)),b=v+i.p4(m).length,y={startIndex:v,endIndex:b};s.oP(l,v,b,"a")||(T.i8({environment:n,store:o,annotation:["a",h],selection:y,transaction:r}),P.Z5({store:o,selection:a}),w.Hc(n,{href:h}))}({environment:t,store:l,transaction:p})}}function K(e){const{store:t,editorMode:n,transaction:o,environment:i}=e;o.postEnqueueActions.push((()=>{A.createAndCommit({userAction:"textFilterActions.runAllFiltersAfterTransaction",environment:i,undoCheckpoint:!0,perform:e=>{H({environment:i,editorMode:n,store:t,transaction:e})}})}))}function G(e,t){const{store:n}=e;if(n.table!==a.iU)return;const i=n.getRecordStoreAtRootPath();if(!(i instanceof y.G))return;const r=i.getType();if(r===o.Ti.header||r===o.Ti.subHeader||r===o.Ti.subSubHeader)return;const s=i.getParentBlockStore();if(!s)return;const l=s.getContentStores(),c=l.findIndex((e=>e.id===i.id));if(-1===c)return;const d=l.slice(0,c);let p=-1,m=1;for(let a=0;a<d.length;a++){const e=d[a];if(e.getType()!==o.Ti.numberedList)m=1,p=a;else{var f;const t=null===(f=e.getFormat())||void 0===f?void 0:f.list_start_index;(0,u.$K)(t)?m=t+1:m++}}return m===t?{type:o.Ti.numberedList,number:void 0}:c===p+1?{type:o.Ti.numberedList,number:t}:void 0}},98104:(e,t,n)=>{n.d(t,{AL:()=>ee,Ch:()=>z,D1:()=>ne,DI:()=>X,FC:()=>oe,FG:()=>J,J9:()=>ie,Km:()=>E,LG:()=>ae,N3:()=>Q,NA:()=>A,NX:()=>Z,N_:()=>O,UV:()=>V,Z5:()=>D,ZH:()=>H,Zk:()=>de,aJ:()=>F,aR:()=>B,bc:()=>le,e2:()=>te,jh:()=>re,ls:()=>j,mT:()=>U,o9:()=>K,sD:()=>W,z9:()=>R,zJ:()=>Y});n(57658);var o=n(1302),i=n(70203),r=n(53965),a=n(4827),s=n(14976),l=n(46150),c=n(28314),d=n(68056),u=n(45162),p=n(73959),m=n(89224),f=n(89086),g=n(28685),h=n(95802),v=n(44534),b=n(77080),y=n(69316),_=n(27724),S=n(24666),w=n(36280),k=n(98604),I=n(45990),C=n(13084),x=n(24677),T=n(993),M=n(13447);const P=!1;function A(e){const{multiSelection:t,readOnly:n,forceEmit:o}=e,i=S.default.state,r="empty"!==i.mode&&i.savedSelectionXPosition||void 0,a="editing"===i.mode&&(0,d.e6)(i.multiSelection,t)?i.forceExtendAnnotations:{},s=n?{mode:"readOnly",multiSelection:t,savedSelectionXPosition:r}:{mode:"editing",multiSelection:t,savedSelectionXPosition:r,forceExtendAnnotations:a};if("editing"===s.mode&&y.Z.isOpen()&&k.xv({clearQuery:!1}),s.mode!==i.mode||!(0,d._v)(i.multiSelection,t))return S.default.setState(s),void v.HM.updateCellSelectionFromTextSelection();o&&S.default.emit()}function R(e,t){if(!("always"===(0,u.Aw)(e)))return;const{TextSelectionCompositionStore:n}=e;n.setState({isComposing:t})}function D(e){const{store:t,selection:n,readOnly:o}=e;if(t&&n){A({multiSelection:(0,d.TD)({store:t,selection:n}),readOnly:o})}else if(t&&!n){const e={store:t,index:0},n={start:e,end:e};o?S.default.setState({mode:"readOnly",multiSelection:n,savedSelectionXPosition:0}):(S.default.setState({mode:"editing",multiSelection:n,forceExtendAnnotations:{},savedSelectionXPosition:0}),y.Z.isOpen()&&k.xv({clearQuery:!1}))}else"empty"!==S.default.state.mode&&S.default.setState({mode:"empty"})}function E(e){const{annotation:t}=e;if(i.k87[i.J7s(t)])return;const n=i.J7s(t),o=(0,f.bj)().findFirstOfType(n);B(o?{annotation:o,extend:!1}:{annotation:t,extend:!0})}function B(e){const{annotation:t,extend:n}=e,o=S.default.state,r=i.J7s(t);"editing"===o.mode&&S.default.setState({...o,forceExtendAnnotations:{...o.forceExtendAnnotations,[r]:{annotation:t,extend:n}}})}function F(){const e=S.default.state;"editing"===e.mode&&S.default.setState({...e,forceExtendAnnotations:{}})}function O(e){const{store:t}=e;D({store:t,selection:{startIndex:0,endIndex:0}})}function Z(e){const{store:t}=e;D({store:t,selection:(0,f.x0)(t)})}function V(e){var t;F();const{environment:n,store:o,canSelectAllBlocks:i,contentEditableContextId:r}=e,a=S.default.state;let s;s="empty"===a.mode?{start:{store:o,index:0},end:{store:o,index:0}}:a.multiSelection;const l={start:{store:s.start.store,index:0},end:{store:s.end.store,index:(null===(t=(0,f.x0)(s.end.store))||void 0===t?void 0:t.endIndex)||0}};if(!(0,d._v)(l,s))return void A({multiSelection:l});const c=b.default.checkGate("never_select_title_on_select_all")&&(0,p.Mn)(n.device);if(r&&!c){const e=(0,f.Ov)(),t=e=>{var t;return(null===(t=e.contentEditableContext)||void 0===t?void 0:t.id)===r},n=e.find(t),o=e.reverse().find(t);if(n&&o){const e=n.props.store,t=o.props.store;if(e&&t){var u;return void A({multiSelection:{start:{store:e,index:0},end:{store:t,index:(null===(u=(0,f.x0)(t))||void 0===u?void 0:u.endIndex)||0}}})}}}i&&(0,p.Mn)(n.device)&&x.td(n)}function U(e){var t;F();const{environment:n,store:o,canSelectAllBlocks:i}=e,r=(0,f.x0)(o),a={startIndex:0,endIndex:r?r.endIndex:0};i&&"empty"!==S.default.state.mode&&(0,f.fu)(null===(t=(0,u.xI)("textSelectionActions",S.default.state.multiSelection))||void 0===t?void 0:t.selection,a)?x.td(n):D({store:o,selection:a})}function L(e){const t=S.default.state;"empty"===t.mode||t.savedSelectionXPosition||S.default.setState({...t,savedSelectionXPosition:e.savedSelectionXPosition})}function j(){"empty"!==S.default.state.mode&&S.default.setState({...S.default.state,savedSelectionXPosition:void 0})}let N=[];function z(e){if(0===N.length)return!1;P&&console.log("maybeHandleExpectedBrowserSelectionUpdate",e);const t=N;N=[];for(const n of t)n();return!0}function q(e){const{store:t,contentEditableLeafRegistry:n,avoidEdgesOfContentEditableRoot:i,selection:r}=e;N.push((()=>{const e=m.get(),o=(0,u.fx)({contentEditableLeafRegistry:n,range:e,allowInvisibleEndSelection:(0,c.yA)().shift,avoidEdgesOfContentEditableRoot:i});o?A(o):D({store:t,selection:r})})),o.default.afterNextFlush((()=>z("renderQueueFlush")))}function W(){const e=document.activeElement;e instanceof HTMLElement&&e.blur()}function H(e){m.clear(e),K()}function K(){D({store:void 0,selection:void 0})}function G(e){const{currentEditableTopBottomPadding:t,targetEdge:n,targetEditable:o,selectionXPosition:i}=e,s=o.getNode();if(!(s&&s instanceof Element))return;const l=s.getBoundingClientRect(),c=Math.min(Math.max(i,l.left),l.right),d=Math.min(t,o.props.topBottomPadding),u="top"===n?l.top:l.bottom;return function(e,t,n){const o=new Map,i={visibility:"hidden"},s=Object.keys(i);let l;try{for(;l=m.rangeFromPoint(e,t);){if(n.contains(l.commonAncestorContainer))return l;const e=(0,a.R)(l.commonAncestorContainer);if(!e)return;if(o.has(e))return;const t=r.ei(e.style,s);o.set(e,t),Object.assign(e.style,i)}}finally{for(const[e,t]of o)Object.assign(e.style,t)}}(c,"top"===n?u+d:u-d,s)}function $(e){const{focusContainerOffset:t,focusStore:n,edge:o,topBottomPadding:i}=e,r=g.E.findNodeFromStore(n);if(!(r&&r instanceof Element))return;const a=m.getRect(m.rangeFromContainerOffsets({start:t,end:t})),s=r.getBoundingClientRect();if(!a||!s)return;const[l,c]="top"===o?[a.top,s.top]:[a.bottom,s.bottom];return{focusIsAtEdge:Math.abs(l-c)<=i,focusSelectionRect:a,renderedNode:r,renderedNodeRect:s}}function Q(e){const{environment:t,event:n,topBottomPadding:o,contentEditableLeafRegistry:i}=e,r=m.get();if(!r)return;F();const a=S.default.state;if("empty"===a.mode)return;const{multiSelection:s}=a,{focus:c,anchor:p}=(0,u.uZ)(s),h=$({focusContainerOffset:m.rangeToContainerOffsets(r).focus,focusStore:c.store,topBottomPadding:o,edge:"top"});if(!h)return;const{focusIsAtEdge:b,focusSelectionRect:y}=h,_=v.g$.getSimpleTableCellFromTextSelection(),w=_?v.g$.getPreviousEditableStoreForSimpleTable(_):(0,f.mK)(c.store),k=w&&g.E.findEditableWithStore(w);if(b&&k){var I;const e=Math.max(a.savedSelectionXPosition||0,y.left),i=G({targetEditable:k,targetEdge:"bottom",currentEditableTopBottomPadding:o,selectionXPosition:e}),s=(null===(I=(0,u.fx)({range:i,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0}))||void 0===I?void 0:I.multiSelection)||(0,d.TD)({store:k.props.store,selection:(0,f.x0)(k.props.store)});if(n.shiftKey&&!n.altKey&&s&&(0,l.D1)(k.getNode(),r.commonAncestorContainer))return n.preventDefault(),L({savedSelectionXPosition:e}),void le({environment:t,multiSelection:(0,u.$r)(s.start,p),focus:s.start,forceEmit:!1});if(!n.shiftKey&&!n.altKey&&s)return n.preventDefault(),L({savedSelectionXPosition:e}),void le({environment:t,forceEmit:!1,multiSelection:s,focus:"start"})}if(n.shiftKey&&!n.altKey&&(0,f.e7)(c,s.start.store)){if(ce(t))return void v.HM.handleUpDownKey({environment:t,direction:"up",bypassExistingTextSelection:!1,expandSelection:!0});const e=(0,u.tp)({multiSelection:s,focus:c,filterCommonAncestors:!0});if(e)return n.preventDefault(),void x.Z5({environment:t,...e})}q({store:c.store,contentEditableLeafRegistry:i,avoidEdgesOfContentEditableRoot:!0})}function Y(e){const{environment:t,store:n,event:o,topBottomPadding:i}=e,r=m.get();if(!r)return;F();const a=m.getRect(r),l=g.E.findNodeFromStore(n),c=S.default.state;if(!l)return;if(!(l instanceof Element))return;if("empty"===c.mode)return;const d=(0,u.xI)("textSelectionActions",c.multiSelection);if(!d)return;const h=l.getBoundingClientRect(),b=v.g$.getSimpleTableCellFromTextSelection(),y=b?v.g$.getPreviousEditableStoreForSimpleTable(b):(0,f.mK)(n);if(a&&h){const e=Math.abs(a.top-h.top),l={startIndex:d.selection.startIndex,endIndex:d.selection.startIndex},u=(0,p.sQ)(n);if(!o.altKey&&o.shiftKey&&(0,f.Rw)(l)&&(m.selectionIsBackwards()||r.collapsed)&&u)x.Z5({environment:t,stores:[u]});else if(!o.altKey&&!o.shiftKey&&e<=i&&y){o.preventDefault();const e=Math.max(c.savedSelectionXPosition||0,a.left);L({savedSelectionXPosition:e});const n=g.E.findNodeFromStore(y);if(n&&n instanceof Element){const o=n.getBoundingClientRect(),r=Math.min(Math.max(e,o.left),o.right),a=o.bottom-i,l=m.rangeFromPoint(r,a),c=s.Ut(t,l);c&&(se({environment:t,store:y,selection:c.selection}),c.forceEmitSelectionStore&&S.default.emit())}}else q({store:n})}}function J(e){const{environment:t,event:n,topBottomPadding:o,contentEditableLeafRegistry:i}=e,r=m.get();if(!r)return;F();const a=S.default.state;if("empty"===a.mode)return;const{multiSelection:s}=a,{focus:c,anchor:h}=(0,u.uZ)(s),b=$({focusContainerOffset:m.rangeToContainerOffsets(r).focus,focusStore:c.store,topBottomPadding:o,edge:"bottom"});if(!b)return;const{focusIsAtEdge:y,focusSelectionRect:_}=b,w=v.g$.getSimpleTableCellFromTextSelection(),k=w?v.g$.getNextEditableStoreForSimpleTable(w):(0,f.hn)(c.store),I=k&&g.E.findEditableWithStore(k);if(y&&I){var C;const e=Math.max(a.savedSelectionXPosition||0,_.left),i=G({targetEditable:I,targetEdge:"top",currentEditableTopBottomPadding:o,selectionXPosition:e}),s=(null===(C=(0,u.fx)({range:i,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0}))||void 0===C?void 0:C.multiSelection)||(0,d.TD)({store:I.props.store,selection:{startIndex:0,endIndex:0}});if(n.shiftKey&&!n.altKey&&s&&(0,l.D1)(I.getNode(),r.commonAncestorContainer))return n.preventDefault(),L({savedSelectionXPosition:e}),void le({environment:t,multiSelection:(0,u.$r)(s.start,h),focus:s.start,forceEmit:!1});if(!n.shiftKey&&!n.altKey&&s)return n.preventDefault(),L({savedSelectionXPosition:e}),void le({environment:t,forceEmit:!1,multiSelection:s,focus:"end"})}const T=(0,p.sQ)(s.start.store);if(n.shiftKey&&!n.altKey&&(0,f.iB)(c,s.end.store)&&T){if(ce(t))return void v.HM.handleUpDownKey({environment:t,direction:"down",bypassExistingTextSelection:!1,expandSelection:!0});const e=(0,u.tp)({multiSelection:s,focus:c,filterCommonAncestors:!0});if(e)return n.preventDefault(),void x.Z5({environment:t,...e})}q({store:c.store,contentEditableLeafRegistry:i,avoidEdgesOfContentEditableRoot:!0,selection:(0,f.x0)(c.store)})}function X(e){const{environment:t,store:n,event:o,topBottomPadding:i}=e,r=m.get();if(!r)return;F();const a=m.getRect(r),l=g.E.findNodeFromStore(n),c=S.default.state;if(!l)return;if(!(l instanceof Element))return;if("empty"===c.mode)return;const d=(0,u.xI)("textSelectionActions",c.multiSelection);if(!d)return;const h=l.getBoundingClientRect();if(a&&h){const e=v.g$.getSimpleTableCellFromTextSelection(),l=e?v.g$.getNextEditableStoreForSimpleTable(e):(0,f.hn)(n),u=Math.abs(a.bottom-h.bottom),b={startIndex:d.selection.endIndex,endIndex:d.selection.endIndex},y=(0,p.sQ)(n);if(!o.altKey&&o.shiftKey&&(0,f.J_)(n,b)&&(!m.selectionIsBackwards()||r.collapsed)&&y)x.Z5({environment:t,stores:[y]});else if(!o.altKey&&!o.shiftKey&&u<=i&&l){o.preventDefault();const e=Math.max(c.savedSelectionXPosition||0,a.left);L({savedSelectionXPosition:e});const n=g.E.findNodeFromStore(l);if(n&&n instanceof Element){const o=n.getBoundingClientRect(),r=Math.min(Math.max(e,o.left),o.right),a=o.top+i,c=m.rangeFromPoint(r,a),d=s.Ut(t,c);d&&(se({environment:t,store:l,selection:d.selection}),d.forceEmitSelectionStore&&S.default.emit())}}else q({store:n})}}function ee(e){o.default.afterNextFlush((()=>{j()})),F();const{environment:t,event:n,contentEditableLeafRegistry:r}=e,a=m.get(),s=S.default.state;if("empty"===s.mode)return;const{multiSelection:c}=s,{focus:p,anchor:h}=(0,u.uZ)(c),b=p.store&&g.E.findEditableWithStore(p.store),y=(0,f.mK)(p.store),_=y&&g.E.findEditableWithStore(y);if((0,f.e7)(p,p.store)&&_&&b&&_.props.isDiscussionInput===b.props.isDiscussionInput){const e=(0,d.TD)({store:_.props.store,selection:(0,f.x0)(_.props.store)});if(n.shiftKey&&!n.altKey&&e&&(0,l.D1)(_.getNode(),null==a?void 0:a.commonAncestorContainer))return n.preventDefault(),void le({environment:t,multiSelection:(0,u.$r)(e.start,h),focus:e.start,forceEmit:!1});if(!n.shiftKey&&!n.altKey&&e&&(0,d.iG)(c))return n.preventDefault(),void le({environment:t,forceEmit:!1,multiSelection:e,focus:"start"})}if(n.shiftKey&&!n.altKey&&(0,f.e7)(p,c.start.store)){if(ce(t))return void v.HM.handleLeftRightKey({environment:t,direction:"left",bypassExistingTextSelection:!1,expandSelection:!0});const e=(0,u.tp)({multiSelection:c,focus:p,filterCommonAncestors:!0});if(e)return n.preventDefault(),void x.Z5({environment:t,...e})}if(n.altKey||n.shiftKey||n.ctrlKey||n.metaKey||!a||!a.collapsed)q({store:p.store,contentEditableLeafRegistry:r});else{const e=p.index-1,r=i.b1T(c.start.store.getValue(),e);if(r&&i.tk7(r)){n.preventDefault(),A({multiSelection:{start:{...p,index:e},end:p}});const a={startIndex:e,endIndex:p.index};i.YrK(r)&&o.default.afterNextFlush((()=>{w.qn({environment:t,selectedToken:{token:r,position:a},analyticsFrom:"arrow_keys"})}))}const a=i.hpT(p.store.getValue(),e,((e,t)=>{const n=i.Hze(e);return t?Boolean(n&&i.Hze(t)===n):Boolean(n)}));a&&I.dz({type:"selectionFocus",store:p.store,focus:!1,selection:a})}}function te(e){o.default.afterNextFlush((()=>{j()})),F();const{environment:t,store:n,event:r}=e,a=m.get(),s=S.default.state;if("empty"===s.mode)return;const l=(0,u.xI)("textSelectionActions",s.multiSelection);if(!l)return;const c={startIndex:l.selection.startIndex,endIndex:l.selection.startIndex},d=(0,p.sQ)(n);if(!r.altKey&&r.shiftKey&&a&&(0,f.Rw)(c)&&(m.selectionIsBackwards()||a.collapsed)&&d)x.Z5({environment:t,stores:[d]});else if(r.altKey||r.shiftKey||l.store!==n||!(0,f.Rw)(l.selection))if(r.altKey||r.shiftKey||r.ctrlKey||r.metaKey||!a||!a.collapsed)q({store:n});else{const e=i.b1T(n.getValue(),c.startIndex-1);if(e&&i.tk7(e)){r.preventDefault();const a={startIndex:c.startIndex-1,endIndex:c.startIndex};D({store:n,selection:a}),i.YrK(e)&&o.default.afterNextFlush((()=>{w.qn({environment:t,selectedToken:{token:e,position:a},analyticsFrom:"arrow_keys"})}))}const a=i.hpT(n.getValue(),c.startIndex-1,((e,t)=>{const n=i.Hze(e);return t?Boolean(n&&i.Hze(t)===n):Boolean(n)}));a&&I.dz({type:"selectionFocus",store:n,focus:!1,selection:a})}else{r.preventDefault();const e=(0,f.mK)(n);if(e){const n=(0,f.x0)(e);n&&se({environment:t,store:e,selection:n})}}}function ne(e){o.default.afterNextFlush((()=>{j()})),F();const{environment:t,event:n,contentEditableLeafRegistry:r,editorMode:a}=e,s=m.get(),c=S.default.state;if("empty"===c.mode)return;const{multiSelection:p}=c,{focus:h,anchor:b}=(0,u.uZ)(p),y=h.store&&g.E.findEditableWithStore(h.store),_=(0,f.hn)(h.store),k=_&&g.E.findEditableWithStore(_);if((0,f.ST)(c.multiSelection.start.store.getValue(),c.multiSelection.start.index-1,i.GKr.Code)&&(0,f.iB)(h,h.store)&&(0,d.iG)(p))return n.preventDefault(),void M.createAndCommit({userAction:"textSelectionActions.arrowRightInCodeBlockAtEOL",environment:t,perform:e=>{T.hJ({environment:t,editorMode:a,store:h.store,multiSelection:p,string:" ",transaction:e,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:!0})}});if((0,f.iB)(h,h.store)&&k&&y&&k.props.isDiscussionInput===y.props.isDiscussionInput){const e=(0,d.TD)({store:k.props.store,selection:{startIndex:0,endIndex:0}});if(n.shiftKey&&!n.altKey&&e&&(0,l.D1)(k.getNode(),null==s?void 0:s.commonAncestorContainer))return n.preventDefault(),void le({environment:t,multiSelection:(0,u.$r)(e.start,b),focus:e.start,forceEmit:!1});if(!n.shiftKey&&!n.altKey&&e&&(0,d.iG)(p))return n.preventDefault(),void le({environment:t,forceEmit:!1,multiSelection:e,focus:"end"})}if(n.shiftKey&&!n.altKey&&(0,f.iB)(h,p.end.store)){if(ce(t))return void v.HM.handleLeftRightKey({environment:t,direction:"right",bypassExistingTextSelection:!1,expandSelection:!0});const e=(0,u.tp)({multiSelection:p,focus:h,filterCommonAncestors:!0});if(e)return n.preventDefault(),void x.Z5({environment:t,...e})}if(n.altKey||n.shiftKey||n.ctrlKey||n.metaKey||!s||!s.collapsed)q({store:h.store,contentEditableLeafRegistry:r});else{const e=h.index,r=h.index+1,a=i.b1T(p.start.store.getValue(),e);if(a&&i.tk7(a)){n.preventDefault(),A({multiSelection:{start:h,end:{...h,index:r}}});const s={startIndex:e,endIndex:r};i.YrK(a)&&o.default.afterNextFlush((()=>{w.qn({environment:t,selectedToken:{token:a,position:s},analyticsFrom:"arrow_keys"})}))}const s=i.hpT(h.store.getValue(),e,((e,t)=>{const n=i.Hze(e);return t?Boolean(n&&i.Hze(t)===n):Boolean(n)}));s&&I.dz({type:"selectionFocus",store:h.store,focus:!1,selection:s})}}function oe(e){o.default.afterNextFlush((()=>{j()})),F();const{environment:t,store:n,event:r}=e,a=m.get(),s=S.default.state;if("empty"===s.mode)return;const l=(0,u.xI)("textSelectionActions",s.multiSelection);if(!l)return;const c={startIndex:l.selection.endIndex,endIndex:l.selection.endIndex},d=(0,p.sQ)(n);if(!r.altKey&&r.shiftKey&&a&&(0,f.J_)(n,c)&&(!m.selectionIsBackwards()||a.collapsed)&&d)x.Z5({environment:t,stores:[d]});else if(r.altKey||r.shiftKey||l.store!==n||!(0,f.J_)(n,l.selection))if(r.altKey||r.shiftKey||r.ctrlKey||r.metaKey||!a||!a.collapsed)q({store:n});else{const e=i.b1T(n.getValue(),c.startIndex);if(e&&i.tk7(e)){r.preventDefault();const a={startIndex:c.startIndex,endIndex:c.startIndex+1};D({store:n,selection:a}),i.YrK(e)&&o.default.afterNextFlush((()=>{w.qn({environment:t,selectedToken:{token:e,position:a},analyticsFrom:"arrow_keys"})}))}const a=i.hpT(n.getValue(),c.startIndex+1,((e,t)=>{const n=i.Hze(e);return t?Boolean(n&&i.Hze(t)===n):Boolean(n)}));a&&I.dz({type:"selectionFocus",store:n,focus:!1,selection:a})}else{r.preventDefault();const e=(0,f.hn)(n);e&&se({environment:t,store:e,selection:{startIndex:0,endIndex:0}})}}function ie(e,t){const{x:n,y:o,target:i}=t,r=(0,f.fx)(n,o,i);r&&r.selectable.props.onEditText&&M.createAndCommit({userAction:"textSelectionActions.editNearestBlock",environment:e,perform:e=>{r.selectable.props.onEditText&&r.selectable.props.onEditText({isAtStartOfLine:n<=r.rect.left,isClick:!0,transaction:e})}})}function re(e,t,n){const{x:o,y:i,target:r}=t,a=r?_.default.getDefaultContainerFromTarget(r):void 0;if(a&&(0,f.Q3)(i,a)&&C.HO({environment:e,container:a,transaction:n}))return;const s=(0,f.fx)(o,i,r);if(s&&s.selectable.props.onEditText){const e=i<=s.rect.top;s.selectable.props.onEditText({isAtStartOfLine:o<=s.rect.left,isAtStartOfContainer:e,isClick:!0,transaction:n})}}function ae(e,t,n,o){const{y:i,target:r}=t,a=r?_.default.getDefaultContainerFromTarget(r):void 0,s=h.C.findSelectableFromStore(n);a&&s&&(0,f.qh)(i,s)&&C.UG({environment:e,container:a,store:n,transaction:o})}function se(e){const{environment:t,store:n,selection:o}=e;D({store:n,selection:o});const i=(0,p.sQ)(n);i&&x.eP({environment:t,store:i})}function le(e){const{environment:t,multiSelection:n,forceEmit:o,readOnly:i,focus:r}=e;A({multiSelection:n,forceEmit:o,readOnly:"infer"===i?(0,u.L5)(n).some((e=>{let{editable:t}=e;return!t.props.store.canEdit()})):i});const a=(0,u.tp)({multiSelection:n,filterCommonAncestors:!1,focus:r});a&&x.Z5({environment:t,phase:_.SelectionPhase.Editing,...a})}function ce(e){const t=v.g$.getSimpleTableCellFromTextSelection();if(t){const{rowIndex:n,columnIndex:o,simpleTableStore:i}=t.getProps();return v.HM.selectCell({environment:e,rowIndex:n,columnIndex:o,simpleTableStore:i}),H(e),!0}return!1}function de(e){var t;if(!(0,u.Aw)(e))return;const n=m.get(),o=null===(t=(0,u.fx)({range:n,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0}))||void 0===t?void 0:t.multiSelection;if(o){A({readOnly:(0,u.L5)(o).some((e=>{let{editable:t}=e;return t.props.disabled})),multiSelection:o})}}},95982:(e,t,n)=>{n.d(t,{B:()=>a,c:()=>s});var o=n(80951),i=n(36610),r=n(9953);function a(e){const{blocks:t,transaction:n,environment:a}=e;for(const i of t)r.sW({store:i.getPropertiesStore(),data:{checked:o._I(!0)},transaction:n});i.Jr(a,{is_checked:!0})}function s(e){const{environment:t,blocks:n,transaction:a}=e;for(const i of n)r.sW({store:i.getPropertiesStore(),data:{checked:o._I(!1)},transaction:a});i.Jr(t,{is_checked:!1})}},29373:(e,t,n)=>{n.d(t,{LO:()=>S,X_:()=>k,ls:()=>b,nz:()=>_,rd:()=>y});n(57658);var o=n(41432),i=n(15157),r=n(23867),a=n(53965),s=n(35328),l=n(58202),c=n(45131),d=n(54642),u=n(54569),p=n(94419),m=n(9953),f=n(24677),g=n(98104);const h="ToggleBlock";function v(e){return`${h}-${e}`}function b(e){const{environment:t,store:n,transaction:i}=e,r=m.j4({environment:t,type:o.Ti.text,inMemoryRecordCache:n.inMemoryRecordCache,transaction:i,spaceId:n.pointer.spaceId,useCrdt:n.useCrdt()});p.R3({parent:n.getContentStore(),append:r,transaction:i});const a=n.getContentStores()[0];f.eP({environment:t,store:a});const s=a.getBlockTitleStore();g.N_({store:s})}function y(e){let{blockId:t,state:n,currentUserId:o}=e;c.Z.setOpen(t,n),i.Z.set({userId:o,key:v(t),value:n})}function _(e){let{blockId:t,currentUserId:n}=e;const o=i.Z.get({userId:n,key:v(t)});c.Z.setOpen(t,o)}function S(e,t){d.loadCachedPageChunkBatched(e,{page:{id:t.id,spaceId:(0,r.C)(t.spaceId)},limit:25,chunkNumber:0,cursor:{stack:[]},verticalColumns:!1})}function w(e,t){const n=(null==t?void 0:t.toggleBlockIds)||[],i=(null==t?void 0:t.collectionBlockIds)||[],r=e.getType();if((0,s.BX)(e)&&n.push(e.id),"collection_view"!==r&&"collection_view_page"!==r||i.push(e.id),r===o.Ti.transclusionReference){const t=e.getTransclusionReferenceTargetStore();t&&w(t,{toggleBlockIds:n,collectionBlockIds:i})}else{const t=e.getContentStores();for(const e of t)e.isNavigableBlock()||w(e,{toggleBlockIds:n,collectionBlockIds:i}),"collection_view"===e.getType()&&i.push(e.id)}return{toggleBlockIds:n,collectionIds:i}}function k(e,t){const{toggleBlockIds:n,collectionIds:o}=w(t),i=t.environment.currentUser.id;n.forEach((e=>_({blockId:e,currentUserId:i})));const r=a.oA(o.map((e=>function(e){const t=l.R.findCollectionViewBlockFromId(e);if(t)return t.collectionContextStore}(e)))),s=r.flatMap((e=>e.groupsStore.getAllGroupStates())),d=n.every((e=>c.Z.isOpen(e))),p=s.every((e=>e.toggleStateStore.state)),m=!(d&&p);n.forEach((e=>y({blockId:e,state:m,currentUserId:i}))),function(e,t,n){for(const o of t)for(const t of o.groupsStore.getAllGroupStates())u.uo({environment:e,collectionContextStore:o,groupFormat:t.groupsPointer[0],toggleStateStore:t.toggleStateStore,newValue:n})}(e,r,m)}},32741:(e,t,n)=>{n.d(t,{lY:()=>f,qA:()=>g,HM:()=>m});var o=n(70203),i=n(38585),r=n(1898),a=n(92120);var s=n(4708),l=n(42092),c=n(80444),d=n(62740),u=n(96049),p=n(48588);function m(e){var t;if(u.Z.state)return;const n=(0,s.En)(),{token:m,store:g}=e,h=o.hDy(m.textToken),v=null===(t=c.default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.getSpaceId(),b=v?o.zrg(h).filter((e=>!(0,i.vz)({annotation:e,spaceId:v,getRecordModel:g.getRecordModel}))):[],y=v?o.$d7(h).filter((e=>!(0,i.vz)({annotation:e,spaceId:v,getRecordModel:g.getRecordModel}))):[],_=o.eQP(h),S=[o.rlz(h),o.K9C(h),o.QGY(h),o.frE(h),o.xat(h),o.V8Y(h)||void 0,n&&o.hH9(h)||void 0,...b,...y,o.jC0(h),_].filter(r.$K);S.length>0?(p.Z.setState({token:m,store:g,annotations:S}),(b.length>0||y.length>0)&&function(e){let{source:t,discussionAnnotations:n}=e;a.Z.setState({source:t,discussionIds:n.map(o.XIY)})}({discussionAnnotations:[...b,...y],source:"editor"}),_&&!l.Z.containedByAssistantEditCard(m.node)&&d.Z.setState({...d.Z.state,hoveredEditId:_[1]})):f()}function f(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{relatedNode:t}=e;var n,o;p.Z.state&&p.Z.setState(void 0),n="editor",(null===(o=a.Z.state)||void 0===o?void 0:o.source)===n&&a.Z.setState(void 0),!d.Z.state.hoveredEditId||t&&l.Z.containedByAssistantEditCard(t)||d.Z.setState({...d.Z.state,hoveredEditId:void 0})}function g(e){e&&p.Z.state&&p.Z.state.store===e&&f()}},13447:(e,t,n)=>{n.r(t),n.d(t,{DEADLOCK_WARNING_TIMEOUT_MS:()=>_e,MetadataUpdateManager:()=>we,applyCrdtTextOperation:()=>xe,applyCrdtTextOperations:()=>Te,applyOperation:()=>Ce,createAndCommit:()=>Ee,createAndCommitAsync:()=>Be,updateConnectionState:()=>Se});n(57658),n(21703);var o=n(18466),i=n(45060),r=n(63144),a=n(68626),s=n(38297),l=n(5773),c=n(43593);var d=n(45681),u=n(59730),p=n(59753),m=n(482),f=n(77337),g=n(606),h=n(98963),v=n(21202),b=n(6287),y=n(13493),_=n(70279),S=n(75246),w=n(19889),k=n(67175),I=n(12139),C=n(45605),x=n(82798),T=n(9291),M=n(53965),P=n(52629),A=n(1898),R=n(19584),D=n(95477),E=n(66749),B=n(47307),F=n(16861),O=n(77080),Z=n(26842);var V=n(21830),U=n(33929),L=n(98165),j=n(3932),N=n(99341),z=n(88632),q=n(37598),W=n(53730),H=n(6258),K=n(27724),G=n(24666),$=n(81023),Q=(n(67266),n(7032),n(19056),n(47247),n(68955)),Y=n(70203);function J(e){const{blockValue:t,textSliceTree:n,originalTextValue:o}=e,i=n.getTextValue();!function(e){const{blockValue:t,textSliceTree:n}=e,o=(0,x.TO)(t.format);(0,x.T)(o.use_crdt),o.text_slice_tree=Q.Z.serialize(n),o.text_clocks=Q.Z.serializeClocks(n),t.properties??={},t.properties.title=n.getTextValue(),t.version++}({blockValue:t,textSliceTree:n}),t.discussions=function(e){const{existingDiscussions:t,oldTextValue:n,newTextValue:o}=e,i=M.e5(Y.llS(n),Y.llS(o));return i.length>0?M.zu(t??[],...i):t}({existingDiscussions:t.discussions,oldTextValue:o,newTextValue:i}),t.discussions=function(e){const{existingDiscussions:t,oldTextValue:n,newTextValue:o}=e,i=M.e5(Y.llS(o),Y.llS(n));return i.length>0?M.G0(t??[],i):t}({existingDiscussions:t.discussions,oldTextValue:o,newTextValue:i})}var X=n(77282);function ee(e){const{transaction:t,inMemoryRecordCache:n,store:o,operation:i}=e,r=i.command;switch(r){case"insertText":case"deleteText":case"addAnnotation":case"removeAnnotation":case"splitText":const e=(0,x.TO)(o.getTextSliceTree());return a=o,s=new re(t,i),X.Z.getPageStoreForBlockStore(a)||ae("source",a,s),te({inMemoryRecordCache:n,textSliceTreeToMutate:e,store:o,operation:i});case"splitTextIntoBlock":return function(e){const{transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:i}=e;(0,x.T)(i.args.targetBlockId!==i.pointer.id,"Target block should be different from source block.");const r=(0,x.TO)(o.getTextSliceTree()),[{newValue:a,role:s}]=te({inMemoryRecordCache:n,store:o,textSliceTreeToMutate:r,operation:{command:"splitText",pointer:i.pointer,path:[],args:i.args}}),l=new H.G(o.environment,{table:v.iU,id:i.args.targetBlockId});return se(o,l,new re(t,i)),oe({transaction:t,inMemoryRecordCache:n,sourceValue:a,sourceRole:s,sourceRootTextSliceTree:r,targetStore:l,operation:{command:"moveTextSlice",pointer:{table:v.iU,id:i.args.targetBlockId},path:[],args:{textInstanceId:i.args.textInstanceId,textSliceStartItemId:i.args.id,targetBlockId:i.args.targetBlockId,targetTextInstanceId:i.args.targetBlockId,targetTextSliceEndItemId:"end"}}})}({transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:i});case"moveTextSlice":return ne({transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:i});case"moveTextSliceIntoBlock":return function(e){const{transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:i}=e;return(0,x.T)(i.args.targetBlockId!==i.pointer.id,"Target block should be different from source block."),ne({transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:{...i,command:"moveTextSlice",args:{...i.args,targetTextInstanceId:i.args.targetBlockId,targetTextSliceEndItemId:"end"}},debugInfo:new re(t,i)})}({transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:i});case"replaceTextInBlock":throw new Error("replaceTextInBlock operation should not be applied on the client");default:(0,A.t1)(r)}var a,s}function te(e){const{inMemoryRecordCache:t,store:n,operation:o,textSliceTreeToMutate:i}=e,r=i.getTextValue(),a=o.command;switch(a){case"insertText":i.applyInsertTextOperation({type:a,...o.args});break;case"deleteText":i.applyDeleteOperation({type:a,...o.args});break;case"addAnnotation":case"removeAnnotation":i.applyAnnotationOperation({type:a,...o.args});break;case"splitText":i.applySplitOperation({type:a,...o.args});break;default:(0,A.t1)(a)}const s=M.Xh((0,x.TO)(n.getValue()));return J({blockValue:s,textSliceTree:i,originalTextValue:r}),[{pointer:n.pointer,newValue:s,role:ie(t,n),updatePaths:[["format","text_slice_tree"],["format","text_clocks"],["discussions"]]}]}function ne(e){const{transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:i,debugInfo:r}=e,a=(0,x.TO)(o.getValue()),s=ie(n,o),l=(0,x.TO)(o.getTextSliceTree()),c=i.args.targetBlockId===o.id?o:new H.G(o.environment,{table:v.iU,id:i.args.targetBlockId});return se(o,c,r??new re(t,i)),oe({transaction:t,inMemoryRecordCache:n,sourceValue:a,sourceRole:s,sourceRootTextSliceTree:l,targetStore:c,operation:i})}function oe(e){const{transaction:t,inMemoryRecordCache:n,sourceRole:o,sourceValue:i,sourceRootTextSliceTree:r,targetStore:a,operation:s}=e,l=(0,x.TO)(r.findTextSliceTreeContainingItemWithId(s.args.textInstanceId,s.args.textSliceStartItemId));(0,x.T)(l!==r,"Can not move root node of text slice tree.");const c=r.getTextValue();!function(e,t){const n=t.getRecordStoreAtRootPath().getValue(),o=t.getRecordStoreAtRootPath().getRole(),i=e.initialRecordMap.getRole(t.pointer);i||(o?e.initialRecordMap.setValueAndRole(t.pointer,n,o):e.initialRecordMap.delete(t.pointer))}(t,a);const d=s.args.targetBlockId===i.id,u=d?r:(0,x.TO)(a.getTextSliceTree()),p=(0,x.TO)(u.findTextSliceTreeContainingItemWithId(s.args.targetTextInstanceId,s.args.targetTextSliceEndItemId,{type:"end"})),m=d?c:u.getTextValue();l.detachFromParent(),p.appendChild(l);const f=M.Xh(i);J({blockValue:f,textSliceTree:r,originalTextValue:c});const g=[{pointer:{table:v.iU,id:i.id,spaceId:i.space_id},newValue:f,role:o,updatePaths:[["format","text_slice_tree"],["format","text_clocks"],["discussions"]]}];if(!d){const e=M.Xh((0,x.TO)(a.getValue()));J({blockValue:e,textSliceTree:u,originalTextValue:m}),g.push({pointer:a.pointer,newValue:e,role:ie(n,a),updatePaths:[["format","text_slice_tree"],["format","text_clocks"],["discussions"]]})}return g}function ie(e,t){return e.getRole({pointer:t.pointer,userId:t.userId})??"editor"}class re{constructor(e,t){this.transaction=e,this.operation=t}get(){return{transactionName:this.transaction.getUserActionForAnalyticsPurposesOnly(),operationName:this.operation.command}}}function ae(e,t,n){const{transactionName:o,operationName:r}=n.get();(0,i.XY)(`The ${e} block store for CRDT text operation "${r}" in transaction "${o}" is not on the page. Undoing the transaction may not work!`,[["block id =",t.id]])}function se(e,t,n){const o=X.Z.getPageStoreForBlockStore(e);if(!o)return void ae("source",e,n);(0,x.TO)(X.Z.getPageBlockTrackerForPage(o.pointer)).getPathToBlock(t.pointer.id)||ae("target",t,n)}var le=n(3022),ce=n(35793),de=n(36576),ue=n(74446),pe=n(45953),me=n(33361);var fe=n(4408),ge=n(52423);let he;const ve=new Set;let be=0;const ye=(0,T.defineMessages)({invalidBlockOperation:{defaultMessage:"Hey there! Blocks cannot be moved inside of themselves.",id:"saveChanges.errorDialog.blocksCannotBeMovedInsideSelf.message"},saveEditsError:{id:"saveEditsError.message",defaultMessage:"There was an issue persisting your edits. Please message us for help."}}),_e=25*R.C0;function Se(e){z.Z.state.online&&e.currentUser.id&&W.transactionQueue.unpause()}class we{constructor(e){this.transaction=void 0,this.timeMs=void 0,this.userId=void 0,this.skipUpdatingEditedMetadata=void 0,this.seenStoreIds=void 0,this.operations=void 0,this.transaction=e.transaction,this.timeMs=e.timeMs,this.userId=e.userId,this.skipUpdatingEditedMetadata=e.skipUpdatingEditedMetadata,this.seenStoreIds=new Set,this.operations=new Map}addStoreWithLargeSubtree(e){this.addStoreInternal(e,{shouldDebounceEditedTime:!0})}addStore(e){this.addStoreInternal(e,{shouldDebounceEditedTime:!1})}getAllOperations(){return Array.from(this.operations.entries())}addStoreInternal(e,t){if(e.inMemoryRecordCache.recordHasOverride({pointer:e.pointer,userId:this.transaction.userId}))return;if(this.seenStoreIds.has(e.id))return;this.seenStoreIds.add(e.id);const n={};M.TS(n,this.collectCreationMetadata(e),this.skipUpdatingEditedMetadata?{}:this.collectEditionMetadata(e,t.shouldDebounceEditedTime)),Object.keys(n).length>0&&this.operations.set(e,{pointer:e.pointer,path:[],command:"update",args:n})}collectCreationMetadata(e){const t={};(e.isDefined()?e.getCreatedById():void 0)||(t.created_by_id=this.userId,t.created_by_table=w.KJ);return(e.isDefined()?e.getCreatedTime():void 0)||(t.created_time=this.timeMs),t}collectEditionMetadata(e,t){const n={},o=e.isDefined()?e.getLastEditedTime():-1;if((t?this.hasDebounceEnded(o,this.timeMs):o!==this.timeMs)&&(n.last_edited_time=this.timeMs),e instanceof H.G||e instanceof H.H2||e instanceof H.Mz){const t=n;(e.isDefined()?e.getLastEditedById():void 0)!==this.userId&&(t.last_edited_by_id=this.userId,t.last_edited_by_table=w.KJ)}return n}hasDebounceEnded(e,t){return R.ud(e)!==R.ud(t)}}function ke(e){M.mN(e.stores,(e=>e.id)).forEach((t=>{if(!t.inMemoryRecordCache.recordHasOverride({pointer:t.pointer,userId:e.userId}))if(t.table===v.iU){const n=H.G.fromRecordStore(t);if(n.isDefined()){const t=n.getModel(),o=(0,l.xN)(t,D.default.secureFileS3.url,D.default.secureFileS3V2.url,D.default.secureFileConfig.rootPath,D.default.secureFileConfig.hostname,t.pointer),i=o.files,r=o.operations,a=n.getFileIds();for(const s of i)a.indexOf(s.id)<0&&Ce({transaction:e,store:n,operation:{pointer:n.pointer,path:["file_ids"],command:"listAfter",args:{id:s.id}}});for(const s of r)Ce({transaction:e,store:n,operation:s})}}else if(t.table===b.vF){const n=H.NW.fromRecordStore(t),o=n.getFileIds(),i=n.getIconStore().getValue(),r=n.getCoverStore().getValue();if(n.isDefined()){const t=function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(n&&!e.file_ids)return[];const r=[],{cover:a,icon:s}=e;if(a){const e=(0,c.mV)(a,t,o,i);e&&r.push(e)}if(s){const e=(0,c.mV)(s,t,o,i);e&&r.push(e)}return r}({cover:r,icon:i,file_ids:o},[D.default.secureFileS3.url,D.default.secureFileS3V2.url],!1,D.default.secureFileConfig.rootPath,D.default.secureFileConfig.hostname),a=o;for(const o of t)a.indexOf(o.id)<0&&Ce({transaction:e,store:n,operation:{pointer:n.pointer,path:["file_ids"],command:"listAfter",args:{id:o.id}}})}}}))}function Ie(e){var t;const{environment:n,userId:o,userAction:r}=e,s=ce.Bs(),l=new Error("Potential transaction deadlock"),c=new j.Y({spaceId:s,userId:o||n.currentUser.id,deadlockTimeoutMs:_e,onDeadlockWarning:()=>{ve.delete(c);const e=c.getUserActionForAnalyticsPurposesOnly();(0,i.XY)(`A ${e} transaction hasn't been committed in ${_e} ms.`,[["stack =",l.stack]]),I.IE(l,{extra:{operations_count:c.operations.length},tags:{userAction:e}}),le.y9(n,{operations_count:c.operations.length,user_action:e});const t=c.operations.map((e=>({command:e.command,stringifiedArgs:(0,P.LK)({path:e.path,pointer:e.pointer})})));a.log({level:"warning",from:"transactionActions",type:"transactionDeadlockWarning",data:{userAction:e,operations:t}})}});return c.beforeSelection=K.default.cloneState(),c.beforeTextSelection=G.default.cloneState(),c.annotateWithUserAction(r),ve.add(c),null===(t=F.Z.provider)||void 0===t||t.onTransactionEvent("create",c),c}function Ce(e){const{store:t,operation:n,transaction:o}=e,{inMemoryRecordCache:r}=t;if((0,k.Qf)(n)&&(0,i.XY)(`In ${o.getUserActionForAnalyticsPurposesOnly()}, use applyCrdtTextOperations() for text operations!`),(0,m.SH)(n)){const i=(0,d.rb)(n,r.makeGetRecordValueFn(o.userId)),a=(0,d.T1)(n,r.makeGetRecordValueFn(o.userId));for(const o of a)n.additionalUpdatedPointers||(n.additionalUpdatedPointers=[]),n.additionalUpdatedPointers.push(o.pointer),Me({...e,operation:o,isInvertible:!1,store:(0,H.Kv)(t,o.pointer)});return o.operations.push(n),void o.invertedOperations.push(...i)}Me({store:t,operation:n,transaction:o,isInvertible:!0})}function xe(e){const{store:t,operation:n,invertedOperation:o,transaction:i}=e;Te({store:t,operations:[n],invertedOperations:o?[o]:[],transaction:i})}function Te(e){var t;const{store:n,operations:o,transaction:i}=e;i.invertedOperations.push(...e.invertedOperations),null===(t=F.Z.provider)||void 0===t||t.rememberStackTrace(e.invertedOperations);for(const r of o)Me({store:n,operation:r,transaction:i,isInvertible:!0})}function Me(e){var t;const{store:n,operation:o,transaction:r}=e,{inMemoryRecordCache:a,environment:l,pointer:c,userId:d}=n;if(null===(t=F.Z.provider)||void 0===t||t.onApplyOperation(e),r.committed)throw new Error("Transaction has already been committed.");const u=n.getRecordStoreAtRootPath().getValue(),m=n.getRecordStoreAtRootPath().getRole(),g=(0,k.Qf)(o)?[]:e.isInvertible?[f.bv(o,u)].filter(A.$K):[];let h;if(r.initialRecordMap.getRole(c)||(m?r.initialRecordMap.setValueAndRole(c,u,m):r.initialRecordMap.delete(c)),(0,k.Qf)(o))h=ee({transaction:r,inMemoryRecordCache:a,store:(0,x.R9)(n,H.G),operation:o});else{!function(e,t){if(!E.k8||e.pointer.table!==v.iU)return;const n=t.getUserActionForAnalyticsPurposesOnly();if(null!=n&&n.startsWith("revisionActions"))return;const o=(t,o)=>{O.default.checkGate("show_crdt_warnings"),(0,i.XY)(`In ${n}, ${t}`,[["id =",e.pointer.id],o,"If you have questions, please ask us on #proj-conflict-resolution!"]),I.IE(new Error(t),{tags:{userAction:n,warningType:"possiblyCrdtUnawareOperation"}})};"set"===e.command?0===e.path.length?(0,E.IG)(e.args)?F.Z.isDebuggingEnabled()&&console.log("Block created in a CRDT-aware way (this is good)."):o("a new block was not created in a CRDT-aware way!","Please use a CRDT-aware function instead, such as recordActions.createBlock()."):M.Xy(e.path,["properties","title"])||Z.G.isTextSliceTreeTextValuePath(e.path)?(0,E.IG)(e.args)?F.Z.isDebuggingEnabled()&&console.log("Title update performed in a CRDT-aware way (this is good)."):o("a title update was not performed in a CRDT-aware way!","Please use a CRDT-aware function instead, such as textActions.setValue()."):M.Xy(e.path,["properties"]||0)&&((0,E.IG)(e.args)||o(`a ${e.path[0]} update was not performed in a CRDT-aware way!`,"Please use a CRDT-aware function instead, such as recordActions.updateValue().")):"update"===e.command&&(0===e.path.length&&M.Kn(e.args)&&"properties"in e.args||M.Xy(e.path,["properties"])&&M.Kn(e.args)&&"title"in e.args?(0,E.IG)(e.args)||o("a properties update was not performed in a CRDT-aware way!","Please use textActions.setValue() to set the title separately from the rest of the properties."):(0===e.path.length&&M.Kn(e.args)&&"format"in e.args||M.Xy(e.path,["format"])&&M.Kn(e.args)&&("use_crdt"in e.args||"text_slice_tree"in e.args||"text_clocks"in e.args))&&((0,E.IG)(e.args)||o("a format update was not performed in a CRDT-aware way!","Please use a CRDT-aware function instead, such as recordActions.updateValue().")))}(o,r);h=[{pointer:c,newValue:f.lK(o,u),role:a.getRole({pointer:c,userId:d})??"editor",updatePaths:"update"===o.command?Object.keys(o.args).map((e=>o.path.concat([e]))):[o.path]}]}for(const i of h){const{pointer:e,newValue:t,role:o,updatePaths:c}=i;if(fe.Wl({environment:l,inMemoryRecordCache:a,pointer:e,userId:d,force:!0,model:p.kk.fromValue(n.pointer.table,t),role:o,updatePaths:c,debugSource:r.getUserActionForAnalyticsPurposesOnly()??"applyOperation"}),"block"===n.table){const e=t;if(e){const t=(0,s.ky)({block:e,getRecordValue:a.makeGetRecordValueFn(r.userId)});t&&q.Z.setEditedBlock(t.id,e.id)}0}}r.isLocal=!n.shouldCacheSaveTransactions(),e.isInvertible&&(r.operations.push(o),r.invertedOperations.push(...g)),r.stores.push(n),a.appliedTransaction=!0}const Pe=[{type:"userAction",allowedUserAction:"revisionActions.undoRevision"},{type:"userAction",allowedUserAction:"revisionActions.redoRevision"}];function Ae(e){var t;null===(t=F.Z.provider)||void 0===t||t.onTransactionEvent("cancel",e),e.cancelDeadlockWarning(),ve.delete(e);const n=M.mN(e.stores,(e=>e.id));for(const o of n){fe.uo({inMemoryRecordCache:o.inMemoryRecordCache,persistedRecordCache:o.environment.defaultRecordCache.persistedRecordCache,pointer:o.pointer,userId:o.userId,environment:o.environment});const t=e.initialRecordMap.getValue(o.pointer),n=e.initialRecordMap.getRole(o.pointer);n&&fe.Wl({environment:o.environment,inMemoryRecordCache:o.inMemoryRecordCache,pointer:o.pointer,userId:o.userId,updatePaths:[[]],model:p.kk.fromValue(o.pointer.table,t),role:n,debugSource:"cancelTransaction"})}for(const o of e.postCancelCallbacks)o()}const Re=M.P2(((e,t)=>{le.Y_(e,{errorType:t.type||t.name}),t.type===V.vZ?B.showThrottledErrorMessage(t.message):B.showThrottledErrorMessage(U.default.formatMessage(ye.saveEditsError))}),3e4);function De(e){return new Promise(((t,n)=>{var o,i;ve.delete(e.transaction);const s=Array.from(ve).filter((e=>e.operations.length>0));var l,c;if(s.length>0&&le.iB(e.environment,{committed_transaction_user_action:e.transaction.getUserActionForAnalyticsPurposesOnly(),first_uncommitted_transaction_user_action:s[0].getUserActionForAnalyticsPurposesOnly(),uncommitted_transaction_count:s.length}),0===e.transaction.operations.length)return null===(l=W.transactionQueue.logEmptyTaskForDebugging)||void 0===l||l.call(W.transactionQueue,e.transaction.getUserActionForAnalyticsPurposesOnly()),e.transaction.committed=!0,e.transaction.done(),null===(c=F.Z.provider)||void 0===c||c.onTransactionEvent("commitEmpty",e.transaction),t();void 0===e.canUndo&&(e.canUndo=!0);const{transaction:d,canUndo:u}=e,m=function(e){for(const t of e.stores)if("block"===t.table){const e=L.Om(t);if(e&&L.qA(e).find((e=>e.table===t.table&&e.id===t.id)))return U.default.formatMessage(ye.invalidBlockOperation)}}(d);if(m)return Ae(d),B.showErrorMessage(m),void t();null===(o=he)||void 0===o||o(e.environment,d),d.cancelDeadlockWarning();for(const e of d.preEnqueueActions)e();if(function(e){const{environment:t,transaction:n,skipUpdatingEditedMetadata:o}=e,i=t.currentUser.adminUserId?w.el.id:t.currentUser.id,a=new we({transaction:n,userId:i,skipUpdatingEditedMetadata:o,timeMs:Date.now()}),s=M.mN(n.stores,(e=>e.id));for(const l of s)if(l.table===v.iU){const e=H.G.createChildStore(l,l.pointer);if(e.canEdit()&&a.addStore(e),!e.isNavigableBlock()){const t=L.Dg(e);t&&t.canEdit()&&a.addStoreWithLargeSubtree(t)}}else if(l.table===_.x_){if(l.path.length)continue;const e=l.pointer,t=n.initialRecordMap.getValue(e),o=l.getValue();(void 0===t||r.P(p.kk.fromValue(_.x_,t),p.kk.fromValue(_.x_,o)))&&a.addStore(H.T5.createChildStore(l,l.pointer))}else if(l.table===S.bx)a.addStoreWithLargeSubtree(H.H2.createChildStore(l,l.pointer));else if(l.table===b.vF){const e=H.NW.createChildStore(l,l.pointer).getParentBlockStore();e&&e.canEdit()&&a.addStore(e)}else if(l.table===y.np){const e=H.Xr.createChildStore(l,l.pointer).getParentBlockStore();e&&e.canEdit()&&a.addStoreWithLargeSubtree(e)}else if(l.table===h.cv&&l.canEdit()){const e=H.Mz.createChildStore(l,l.pointer);a.addStore(e);const t=e.getParentBlockStore();t&&t.canEdit()&&a.addStore(t)}a.getAllOperations().forEach((e=>{let[t,o]=e;return Ce({transaction:n,store:t,operation:o})}))}({environment:e.environment,transaction:d,skipUpdatingEditedMetadata:e.skipUpdatingEditedMetadata}),ke(d),function(e,t){const n=t.operations.filter((e=>e.pointer.table===y.np));n.length>0&&g.dr.uniq(n.map((e=>e.pointer))).map((e=>t.initialRecordMap.getRole(e))).includes(void 0)&&t.postSubmitCallbacks.push((()=>{$.bi(e)}))}(e.environment,d),d.afterSelection=K.default.cloneState(),d.afterTextSelection=G.default.cloneState(),u&&ge.K9({transaction:d,undoCheckpoint:e.undoCheckpoint}),null===(i=F.Z.provider)||void 0===i||i.onTransactionEvent("commit",d),d.isLocal){for(const e of d.postEnqueueActions)e();d.done(),t()}else{const o=e=>{d.done(e),e?n(e):t()},{LocalBacklinkStore:i,currentUser:r}=e.environment;i&&async function(e,t){const{LocalBacklinkStore:n,currentUser:o}=e;if(0===t.stores.length)return;const i=t.stores[0].inMemoryRecordCache,r=[],a=pe.Ak.create(),s=new Set;for(const p of t.stores)s.has(p.id)||(s.add(p.id),r.push(p.pointer),a.setValue(p.pointer,p.getRecordStoreAtRootPath().getValue()));const l=me.DI(t.initialRecordMap),{createdBacklinks:c,deletedBacklinks:d}=await(0,de.xU)({loadRecordValue:ue.zF.fromGetRecordValueFn(i.makeGetRecordValueFn(o.id)),operationPointers:r,getInitialRecordModel:p.om.fromRecordMap(l),getFinalRecordModel:p.om.fromRecordMap(a)}),u=n.updateBacklinks({createdBacklinks:c,deletedBacklinks:d,currentUserId:o.id});t.postSubmitCallbacks.push((e=>{e&&n.resetBacklinkState({blockIds:u,currentUserId:o.id})}))}({LocalBacklinkStore:i,currentUser:r},d);const s=Date.now();s<be&&le.vt(e.environment,{regression_amount:be-s}),be=s,W.transactionQueue.enqueueTask((0,N.JG)({transaction:d,timestamp:s,callback:o})).catch((t=>{a.log({level:"error",from:"transactionActions",type:"enqueueTask",error:(0,P.Ui)(t)}),e.environment.device.isMobileNative&&"SqliteOutOfSpace"===t.name||Re(e.environment,t),Ae(d),o(t)}));for(const e of d.postEnqueueActions)e()}d.committed=!0}))}function Ee(e){const{userAction:t,environment:n,userId:i,perform:r,canUndo:s,undoCheckpoint:l,transactionTooBigFallback:c,skipUpdatingEditedMetadata:d,useSudoMode:p}=e;return o.Z.withListenerIgnored((()=>{const o=Ie({environment:n,userId:i,userAction:t});let m;p&&(o.useSudoMode=!0);try{m=r(o),function(e){if(e.isLocal)return;for(const t of e.stores){const n=t.inMemoryRecordCache.checkRecordForTemporaryData(t);if(n)throw new u.p8(`Transaction "${e.getUserActionForAnalyticsPurposesOnly()}" is manipulating a store with temporary local changes from an in-memory record cache named "${n.name}"!`)}}(o);for(const e of o.postPerformAssertions)e()}catch(f){Ae(o);const e=o.getUserActionForAnalyticsPurposesOnly(),t=o.getUserFlowForAnalyticsPurposesOnly(),n=o.getDebugTagsForAnalyticsPurposesOnly(),i=n&&(0,C.o)(n);throw I.IE(f,{tags:{userAction:e,userFlow:t,...i}}),a.log({level:"error",from:"transactionActions",type:"createAndCommit",error:(0,P.Ui)(f),data:{userAction:e,userFlow:t,debugTags:n,spaceId:o.spaceId}}),f}finally{0}if(c&&(0,N.jQ)(o))return Ae(o),Ee({...e,perform:c,transactionTooBigFallback:void 0,userAction:`${t} transactionTooBigFallback`});return{performResult:m,serverCommitResult:De({environment:n,transaction:o,canUndo:s,undoCheckpoint:l,skipUpdatingEditedMetadata:d})}}))}async function Be(e){const{environment:t,perform:n,waitForServerCommit:o,userAction:i,userId:r,canUndo:s,undoCheckpoint:l,skipUpdatingEditedMetadata:c,useSudoMode:d}=e,u=Ie({environment:t,userId:r,userAction:i});let p;d&&(u.useSudoMode=!0);try{p=await n(u);for(const e of u.postPerformAssertions)e()}catch(f){const t=u.getUserActionForAnalyticsPurposesOnly();ve.delete(u);const n=u.operations.length>0;throw n&&le.kY(e.environment,{user_action:t,operation_count:u.operations.length}),I.IE(f,{tags:{userAction:t,transactionOperationCount:u.operations.length}}),a.log({level:"error",from:"transactionActions",type:"createAndCommitAsync",error:(0,P.Ui)(f),data:{message:n?`POSSIBLE DATA LOSS: asynchronous transaction had ${u.operations.length} operations`:void 0,userAction:t}}),f}const m=De({environment:t,transaction:u,canUndo:s,undoCheckpoint:l,skipUpdatingEditedMetadata:c});return o&&await m,{performResult:p,serverCommitResult:m}}},68422:(e,t,n)=>{n.d(t,{_w:()=>R,vs:()=>M,Cj:()=>P});var o=n(1302),i=n(41432),r=n(72141),a=n(70203),s=n(53965),l=n(7032),c=n(42274),d=n(65598),u=n(35328),p=n(26664),m=n(81023),f=n(41433),g=n(94419),h=n(76464),v=n(9953),b=n(42858),y=n(24677),_=n(98104),S=n(29373),w=n(73959),k=n(55367),I=n(96802),C=n(13084);function x(e,t){const{store:n,transaction:o,disableAutoChildrenMove:i}=e;return i||function(e){const{environment:t,store:n,transaction:o}=e,i=(0,w.sQ)(n),r=(null==i?void 0:i.getContentStores())||[];let a=!1;const s=r.filter((e=>{return a?(t=e.getType(),o=n.getType(),!(!t||!o||t===o||"divider"===t||"collection_view"===t||"sub_header"===o&&"header"===t||"sub_sub_header"===o&&("header"===t||"sub_header"===t))||(a=!1,!1)):(e===n&&(a=!0),!1);var t,o}));C.LQ({environment:t,targetParentStore:n.getContentStore(),droppedDirection:k.vh.Below,droppedStores:s,duplicate:!1,transaction:o})}(e),I.FH({stores:[n],update:{toggleable:t},transaction:o})}var T=n(13447);function M(e){const{environment:t,block:n,blockType:o,transaction:l,isMultiBlockTransformation:d}=e,p=n.getType(),b=n.getFormat(),y=n.recordStoreUIParentStore;if(m.M_(t)&&p&&!function(e,t){const n=e.type,o=e.format;if(u.ih(t)){var r;return"mermaid_code_block"===t?e.type===i.Ti.code&&"Mermaid"===a.QaF(null===(r=e.properties)||void 0===r?void 0:r.language):(0,i.Fx)(t)?u.tZ(t)===e.type&&(0,i.eJ)(n,o):u.tZ(t)===e.type}return e.type===t&&!(0,i.eJ)(n,o)}({type:p,format:b,properties:n.getProperties()},o)){const e=p,a=u.ih(o)?u.tZ(o):o;if(v.sW({store:n,data:{type:a},transaction:l}),(0,i.Fx)(o)&&!u.fn(n)?function(e){x(e,!0)}({environment:t,store:n,transaction:l,disableAutoChildrenMove:Boolean(d)}):!(0,i.Fx)(o)&&u.fn(n)&&function(e){const{store:t}=e;t.recordStoreUIParentStore&&x(e,!1)}({environment:t,store:n,transaction:l,disableAutoChildrenMove:Boolean(d)}),"mermaid_code_block"===o&&c.E5({blocks:[n],language:"Mermaid",transaction:l}),i.Z7[e]&&!i.Z7[o]){n.getPermissionItems().some(r.Le)&&h.MX({environment:t,store:n,transaction:l})}u.BX(n)&&S.rd({blockId:n.id,state:!0,currentUserId:t.currentUser.id});const m=n.getType();m&&y&&p&&(0,i.Um)(p,b)&&!(0,i.Um)(m,n.getFormat())&&function(e){let{environment:t,block:n,parentStore:o}=e;const i=async()=>{const e=n.getContentStores();await Promise.all(e.map((e=>e.load()))),T.createAndCommit({userAction:"transformActions.runAsync",environment:t,perform:t=>{const i=s.d9(e).reverse();for(const e of i)g.Od({parent:n.getContentStore(),childToRemove:e,transaction:t}),g.BE({parent:o,insert:e,after:n,transaction:t})}})};i()}({environment:t,parentStore:y,block:n}),f.jf({store:n,transaction:l})}return n}function P(e){const{environment:t,blocks:n,blockType:r,transaction:a}=e;if(r!==i.Ti.transclusionContainer)if(r!==i.Ti.columnList)if((0,i.sX)(r)){const e=parseInt(r.replace("column","").replace("block","")),i=s.oA(s.DZ(e-1,(()=>b.ZJ({environment:t,blocks:n,transaction:a})))),l=[...n,...i],c=A({environment:t,blocks:l,transaction:a});o.default.afterNextFlush((()=>{_.N_({store:c[0].getBlockTitleStore()})}))}else for(const o of n)M({environment:t,block:o,blockType:r,transaction:a,isMultiBlockTransformation:n.length>1});else A({environment:t,blocks:n,transaction:a});else!function(e){const{environment:t,blocks:n,transaction:o}=e,r=n[0];if(!r)return;const a=r.getRecordStoreUIParent();if(!a||!(0,d.dz)(a))return;const s=a.getRecordStoreUIParent();if(!s||!(0,d.OY)(s))return;if(!s.isDefined())return;const c=(0,l.ZP)(),u=v.j4({environment:t,id:c,type:i.Ti.transclusionContainer,inMemoryRecordCache:a.inMemoryRecordCache,transaction:o,spaceId:s.getSpaceId(),useCrdt:s.useCrdt()});g.BE({parent:a,insert:u,after:r,transaction:o});(function(e){const{newParent:t,blocks:n,transaction:o}=e;for(const i of n){const e=i.getRecordStoreUIParent();null!=e&&e.valueIs(p.i)&&(g.Od({parent:e,childToRemove:i,transaction:o}),g.R3({parent:t,append:i,transaction:o}))}})({newParent:u.getContentStore(),blocks:n,transaction:o}),_.ZH(t),y.ZH(t),y.Z5({environment:t,stores:[u]})}({environment:t,blocks:n,transaction:a})}function A(e){const{environment:t,blocks:n,transaction:o}=e,r=n[0];if(!r)return[];const a=r.recordStoreUIParentStore;if(null==a||!a.valueIs(p.i))return[];const s=(0,l.ZP)(),c=v.j4({environment:t,id:s,type:i.Ti.columnList,inMemoryRecordCache:r.inMemoryRecordCache,transaction:o,spaceId:r.getSpaceId(),useCrdt:r.useCrdt()}),{child:d}=g.Vt({parent:a,insert:c,before:r,transaction:o});return n.map((e=>{const n=(0,l.ZP)(),s=v.j4({environment:t,id:n,type:i.Ti.column,inMemoryRecordCache:r.inMemoryRecordCache,transaction:o,spaceId:r.getSpaceId(),useCrdt:r.useCrdt()}),{child:c}=g.Od({parent:a,childToRemove:e,transaction:o}),{child:u}=g.BE({parent:d.getContentStore(),insert:s,transaction:o}),{child:p}=g.BE({parent:u.getContentStore(),insert:c,transaction:o});return p}))}function R(e){let{environment:t,blocks:n,transaction:o}=e;(function(e){return 1===e.length&&"collection_view"===e[0].getType()})(n)&&P({environment:t,blocks:n,blockType:"collection_view_page",transaction:o})}},39865:(e,t,n)=>{n.d(t,{DV:()=>w,Rn:()=>I,Tq:()=>C,y8:()=>k});n(57658);var o=n(15145),i=n(59730),r=n(21202),a=n(23867),s=n(9291),l=n(75754),c=n(97978),d=n(33929),u=n(74948),p=n(44604),m=n(80444),f=n(1310),g=n(54642),h=n(47307),v=n(19785),b=n(8055),y=n(64964),_=n(65452);const S=(0,s.defineMessages)({deletePageConfirmationMessage:{id:"trashActions.deletePagePermanentlyDialog.prompt",defaultMessage:"Are you sure you want to delete this page permanently?"},deletePageConfirmationButton:{id:"trashActions.deletePagePermanentlyDialog.confirmDeleteButton.label",defaultMessage:"Yes. Delete this page"},permanentlyDeleteFailedToast:{id:"trashActions.deletePagePermanentlyDialog.actionFailed.toast",defaultMessage:"Failed to delete, please try again later."},permanentlyDeletePermissionsFailure:{id:"trashActions.deletePagePermanentlyDialog.actionFailed.permissions",defaultMessage:"You do not have sufficient permissions to permanently delete this page."}});async function w(e){const{environment:t,block:n,spaceId:i}=e;p.Z.state.excludePages.add(n.id),p.Z.emit(),await g.restoreBlock(t,{pointer:{table:r.iU,id:n.id,spaceId:i}}),l._c({environment:t,store:n,pageVisitSource:o.tY.Restore}),t.device.isMobile&&u.close(),function(e){c.j(e,"restore_trash_page")}(t)}function k(e){const{environment:t,blocks:n,transaction:o,permanentlyDelete:i=!1}=e;for(const r of n)v.zo({block:r,transaction:o});o.postSubmitCallbacks.push((async e=>{e||await g.deleteBlocks(t,{blocks:n.map((e=>({id:e.id,spaceId:(0,a.C)(e.pointer.spaceId)}))),permanentlyDelete:i})}))}function I(e){const{environment:t}=e;!function(e){c.j(e,"open_delete_trash_page_modal")}(t),h.showDialog({message:d.default.formatMessage(S.deletePageConfirmationMessage),showCancel:!0,keepFocus:!1,items:[{label:d.default.formatMessage(S.deletePageConfirmationButton),color:"red",onAccept:()=>C(e)}],handleCancel:()=>{!function(e){c.j(e,"cancel_delete_trash_page")}(t)}})}async function C(e){const{blocks:t,environment:n}=e,{currentSpaceStore:o}=m.default.state,r=e.environment.currentUser.id;if(o&&r){await g.deleteBlocks(e.environment,{blocks:t.map((e=>({id:e.id,spaceId:(0,a.C)(e.pointer.spaceId)}))),permanentlyDelete:!0}).then((e=>{if("failed"===e.type)throw function(e){let t=S.permanentlyDeleteFailedToast;(0,i.QW)(e)&&(t=S.permanentlyDeletePermissionsFailure);y.oV({label:d.default.formatMessage(t),durationMs:f.JY})}(e.body),e.error})),function(e){c.j(e,"delete_trash_page")}(n);for(const e of t)p.Z.state.excludePages.add(e.id),p.Z.emit();await _.l({environment:n,spaceId:o.id,userId:r}),b.CZ({environment:e.environment,blocks:t})}}},27370:(e,t,n)=>{n.r(t),n.d(t,{dismissTutorial:()=>d,resetTutorials:()=>u,tutorialAdvanceToStep:()=>p,tutorialAdvanceToStepAfter:()=>m,tutorialGoToNextStep:()=>l,tutorialGoToPrevStep:()=>c});var o=n(9163),i=n(13447),r=n(37181),a=n(64856),s=n(80444);function l(e,t){var n;const{currentUserSettingsStore:o}=s.default.state;if(!o)return;const i=null===(n=o.getSettings())||void 0===n?void 0:n.tutorials;f({userAction:"TutorialActions.nextStep",environment:e,perform:e=>{r.d2({userSettingsStore:o,transaction:e,data:{tutorials:{...i,[t]:(0,a.ox)(o,t)}}})},userId:o.id})}function c(e,t){var n;const{currentUserSettingsStore:o}=s.default.state;if(!o)return;const i=null===(n=o.getSettings())||void 0===n?void 0:n.tutorials;f({userAction:"TutorialActions.prevStep",environment:e,perform:e=>{r.d2({userSettingsStore:o,transaction:e,data:{tutorials:{...i,[t]:(0,a.IJ)(o,t)}}})},userId:o.id})}function d(e,t){var n;const{currentUserSettingsStore:i}=s.default.state;if(!i)return;const a=null===(n=i.getSettings())||void 0===n?void 0:n.tutorials;f({userAction:"TutorialActions.dismissTutorial",environment:e,perform:e=>{r.d2({userSettingsStore:i,transaction:e,data:{tutorials:{...a,[t]:o.lR}}})},userId:i.id})}function u(e){const{currentUserSettingsStore:t}=s.default.state;t&&f({userAction:"TutorialActions.resetTutorialsDebug",environment:e,perform:e=>{r.d2({userSettingsStore:t,transaction:e,data:{tutorials:{}}})},userId:t.id})}function p(e,t,n){var i;const{currentUserSettingsStore:l}=s.default.state;if(!l||(0,a.W$)(l,t))return;const c=(0,a.wF)(l,t);o.eU[t].steps.findIndex((e=>e.id===c))>=o.eU[t].steps.findIndex((e=>e.id===n))||r.d2({userSettingsStore:l,transaction:e,data:{tutorials:{...null===(i=l.getSettings())||void 0===i?void 0:i.tutorials,[t]:n}}})}function m(e,t,n){if((0,a.AK)(n))return;const o=(0,a.Xv)(t,n);o&&p(e,t,o)}function f(e){return i.createAndCommit({...e,canUndo:!1})}},61202:(e,t,n)=>{n.d(t,{KT:()=>Te,FD:()=>De,xv:()=>Me,jh:()=>Ve,pt:()=>Ie,os:()=>qe,dY:()=>Ze,pJ:()=>xe,hJ:()=>Re,UY:()=>Fe,yp:()=>Be,sz:()=>Ke,aV:()=>Ge,qK:()=>$e});n(21703),n(57658);var o=n(26263),i=n(1302),r=n(41432),a=n(98953),s=n(99036),l=n(97531),c=n(95538),d=n(77657),u=n(2864),p=n(68626),m=n(20270),f=n(59753),g=n(45953),h=n(21202),v=n(77420),b=n(6287),y=n(13493),_=n(32161),S=n(9844),w=n(23867),k=n(90965),I=n(70203),C=n(44876),x=n(82798),T=n(9291),M=n(53965),P=n(7032),A=n(1898),R=n(18265),D=n(19584),E=n(893),B=n(31781),F=n(94419),O=n(9953),Z=n(24677),V=n(993),U=n(98104),L=n(13447),j=(n(95477),n(27105)),N=n(69783),z=n(97978),q=n(28020),W=n(65454),H=n(77080);var K=n(70764),G=n(41232),$=n(28415),Q=n(33929),Y=n(65598),J=n(73959),X=n(89224),ee=n(58202),te=n(80444),ne=n(30874),oe=n(79167),ie=n(19111),re=n(6258),ae=n(1634),se=n(80064),le=n(40671),ce=n(81023),de=n(57549),ue=n(54642),pe=n(35793),me=n(5149),fe=n(47307),ge=n(89475),he=n(27153),ve=n(19785),be=n(4408),ye=n(64964);const _e=!1;const Se=[d.Aw],we=[d.Aw];const ke=(0,T.defineMessages)({browse:{id:"externalBlock.mediaPicker.browseTab.title",defaultMessage:"Browse {appName}"},somethingWentWrong:{defaultMessage:"Something went wrong.",id:"externalActions.dialogError.openFilePicker.errorMessage"},copyDebuggingInformation:{id:"externalActions.dialogItem.openFilePicker.copyDebugData",defaultMessage:"Copy debugging information"},copiedDebuggingInfo:{id:"externalActions.dialogError.copiedDebuggingInfo",defaultMessage:"Copied to clipboard."},userReAuth:{id:"externalActions.dialogError.userReAuth",defaultMessage:"Authentication Expired. Please Re-Authenticate to continue."}});async function Ie(e){const{environment:t,spaceId:n,force:o}=e;await te.default.waitUntilRendered();const i=ne.Z.state,r=t.currentUser.id;if(!i.loaded&&!i.loading||i.loaded&&n!==i.spaceId||i.loaded&&r!==i.userId||o){ne.Z.setState({...ne.Z.state,loading:!0});const[e,o]=await Promise.all([ue.getExternalIntegrations(t,{spaceId:n}),Ce({environment:t,spaceId:n})]);if("success"!==e.type||"success"!==o.type)throw new Error("Request failed.");const i=g.PF.create(e.data.recordMap),r=g.PF.create(o.data.recordMap);ne.Z.setState({loaded:!0,loading:!1,spaceId:n,userId:t.currentUser.id,integrations:M.MR(M.oA(e.data.integrationIds.map((e=>i.getValue({table:S.K2,id:e})))),(e=>{let{created_at:t}=e;return t})),externalAuthentications:M.MR(M.oA(o.data.externalAuthenticationIds.map((e=>r.getValue({table:_.PJ,id:e})))),(e=>{let{created_at:t}=e;return t})),bots:M.Xo(M.oA(o.data.botIds.map((e=>r.getValue({table:v.cZ,id:e})))),(e=>{let{last_edited_at:t,created_at:n}=e;return t||n}),"desc"),completeSlackAuthentications:M.MR(M.oA(o.data.completeSlackAuthenticationIds.map((e=>r.getValue({table:_.PJ,id:e})))),(e=>{let{created_at:t}=e;return t}))})}}async function Ce(e){const{environment:t,spaceId:n}=e;return t.currentUser.isLoggedIn()?await ue.getUserSpaceExternalBots(t,{spaceId:n}):{type:"success",status:200,headers:{},data:{botIds:[],externalAuthenticationIds:[],recordMap:{},completeSlackAuthenticationIds:[]}}}async function xe(e){const{environment:t}=e,{currentSpaceStore:n}=te.default.state;n&&await Ie({environment:t,spaceId:n.id,force:!0})}function Te(e){var t;const{environment:n,blockStore:a,textStore:s,url:l,textValueBeforePaste:u,urlSelection:m}=e,f=X.get();if(!a||N.Z.state.open||ie.Z.state.open||se.Z.state.open||!f)return!1;const{currentSpaceStore:g}=te.default.state,v=(0,c.x$)(l),_=(0,R.Qc)(v);if(!_.host)return!1;const S=n.currentUser.id;if(null==g||!g.isDefined()||!S)return!1;const x=ne.Z.integrations.state.filter((e=>e.id!==d.U9)),T=(0,C.ny)({url:v,integrations:x,currentSpaceId:g.id});if("partial"===T.type)return function(e){const{environment:t,parsedUrl:n,urlDomain:o,integrationId:i}=e;de.pp(t,{integrationId:i,urlDomain:o}),p.log({level:"debug",from:"activateFromLinkCreation",type:"linkPreviewUrlMiss",data:{miscDataToConvertToString:{integrationId:i,urlDomain:o,path:n.path}}})}({...T,integrationId:T.integration.id,environment:n}),!1;if("failure"===T.type)return!1;const{integration:A,pattern:D}=T;if(!g.getSpaceUserStore(S).isWorkspaceOwner()&&!(0,k.hU)({spaceBotSettings:g.getBotSettingsStore().getValue(),integrationId:A.id,env:"production"}))return!1;const E=(0,K.NP)(A.id),B=function(e){const{integration:t,pattern:n,blockStore:o,textValueBeforePaste:i}=e,a=o&&o.getType()===r.Ti.text&&0===(0,I.QaF)(i).trim().length,s=H.default.getEligibleGroup({experimentId:"gdrive_embed_option_placement",defaultGroup:"none"}),{canUnfurlAsEmbed:l,hasServerDeterminedOptionTypes:c,canUnfurlAsCollection:u,canUnfurlAsImport:p}=function(e,t){var n;const o=Boolean(e&&Se.includes(e.id));return{canUnfurlAsEmbed:(null==e?void 0:e.id)===d.f3,hasServerDeterminedOptionTypes:o,canUnfurlAsCollection:Boolean(!o&&(null==t||null===(n=t.additional_types)||void 0===n?void 0:n.collection)),canUnfurlAsImport:Boolean(e&&we.includes(e.id))}}(t,n);return t?a?"control"===s?M.oA([l&&"drive","preview","mention","link",(c||u)&&"collection",p&&"import"]):"below"===s?M.oA(["preview",l&&"drive","mention","link",(c||u)&&"collection",p&&"import"]):M.oA(["preview","mention","link",(c||u)&&"collection",p&&"import"]):M.oA(["mention","preview","link",(c||u)&&"collection",p&&"import"]):a?M.oA(["preview","mention","link",(c||u)&&"collection",p&&"import"]):M.oA(["mention","preview","link",(c||u)&&"collection",p&&"import"])}({blockStore:a,integration:A,pattern:D,textValueBeforePaste:u}),F=X.getRect(f);if(!F)return!1;const O=a.getRecordStoreUIParent();if(!O||!(0,Y.dz)(O))return!1;const Z=new o.Z({name:"unfurlingActions.activateFromLinkCreation",isTemporaryData:!0});n.defaultRecordCache.inMemoryRecordCache.addCacheOverride(Z);const V=O.clone(Z),U=a.clone(Z),j=s.table===h.iU&&s===(null===(t=(0,J.sQ)(s))||void 0===t?void 0:t.getBlockTitleStore())?U.getBlockTitleStore():s.clone(Z),z=new re.G(n,{table:h.iU,id:(0,P.ZP)(),spaceId:a.pointer.spaceId}),q=z.clone(Z),W=M.w6(C.wh).map((()=>new re.G(n,{table:h.iU,id:(0,P.ZP)(),spaceId:(0,w.C)(a.pointer.spaceId)}))),G=W.map((e=>e.clone(Z))),$=new re.NW(n,{table:b.vF,id:(0,P.ZP)(),spaceId:a.pointer.spaceId}),ee=$.clone(Z);let oe;oe=D.defaultViews?D.defaultViews.map((e=>new re.Xr(n,{table:y.np,id:(0,P.ZP)(),spaceId:a.pointer.spaceId}))):[new re.Xr(n,{table:y.np,id:(0,P.ZP)(),spaceId:a.pointer.spaceId})];const ae=oe.map((e=>e.clone(Z))),le=M.w6(C.wh).map((()=>new re.NW(n,{table:b.vF,id:(0,P.ZP)(),spaceId:a.pointer.spaceId}))),ce=le.map((e=>e.clone(Z))),ue=M.w6(C.wh).map((()=>new re.Xr(n,{table:y.np,id:(0,P.ZP)(),spaceId:a.pointer.spaceId}))),pe=ue.map((e=>e.clone(Z)));se.Z.setState({open:!0,url:v,textValueBeforePaste:u,textValueAfterPaste:s.getValue(),urlSelection:m,renderRect:F,integration:A,pattern:D,currentOption:{type:"link"},allOptionTypes:B,temporaryRecordCache:Z,stores:{blockStore:a,blockParentStore:O,textStore:s,externalObjectInstanceBlockStore:z,subExternalObjectInstanceBlockStores:W,externalCollectionStore:$,externalCollectionViewStores:oe,subExternalCollectionStores:le,subExternalCollectionViewStores:ue},temporaryStores:{blockParentStore:V,blockStore:U,textStore:j,externalObjectInstanceBlockStore:q,subExternalObjectInstanceBlockStores:G,externalCollectionStore:ee,externalCollectionViewStores:ae,subExternalCollectionStores:ce,subExternalCollectionViewStores:pe},unfurlResponse:void 0}),E.length>0&&Ee({environment:n,url:l,botIds:E.map((e=>{let{id:t}=e;return t})),integrationId:A.id,externalObjectInstanceBlockStore:z}),de._x(n,{integrationId:A.id,entity:D.name,domain:_.host,from:"link_paste"});const me=B[0];if("import"===me)throw new Error(`${me} is not a valid initial option type`);return i.default.afterNextFlush((()=>{L.createAndCommit({userAction:"unfurlingActions.activateFromLinkCreation",environment:n,perform:e=>{Re({environment:n,type:me,useTemporaryRecordCache:"drive"!==me,transaction:e,intl:Q.default.getIntl()})}})})),!0}function Me(e){const{environment:t,setType:n,transaction:o}=e,{currentUserSettingsStore:i}=te.default.state,r=q.qQ(t),a=se.Z.state;if(!a.open)return;t.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(a.temporaryRecordCache);const s=(0,K.NP)(a.integration.id).length>0;if(Re({environment:t,type:n||a.currentOption.type,useTemporaryRecordCache:!1,transaction:o,intl:Q.default.getIntl()}),"preview"===a.currentOption.type){if(Z.Z5({environment:t,stores:[a.currentOption.externalObjectInstanceBlockStore]}),a.integration.id===d.f3){const e=H.default.getEligibleGroup({experimentId:"gdrive_embed_option_placement",defaultGroup:"none"});"control"===e?Ae(t,{from:"firstOption"}):"below"===e&&Ae(t,{from:"secondOption"})}}else if("drive"===a.currentOption.type){B.I(t,{source:a.url,isDataURL:!1,store:a.stores.blockStore,pageWidth:r,preferredType:"drive"});const e=H.default.getEligibleGroup({experimentId:"gdrive_embed_option_placement",defaultGroup:"none"});"control"===e?Pe(t,{from:"firstOption"}):"below"===e&&Pe(t,{from:"secondOption"})}if(a.integration&&!s){(null==i?void 0:i.hasDismissedIntegrationPopup({integrationId:a.integration.id}))||ae.Z.setState({open:!0,integration:a.integration,externalObjectInstanceBlockId:a.stores.externalObjectInstanceBlockStore.id,unfurlUrl:a.url})}se.Z.setState({open:!1})}function Pe(e,t){z.j(e,"select_gdrive_embed_from_unfurling_menu",t)}function Ae(e,t){z.j(e,"select_gdrive_preview_from_unfurling_menu",t)}function Re(e){const{environment:t,type:n,transaction:o,useTemporaryRecordCache:a}=e,s=se.Z.state;if(!s.open)return;const l=t.currentUser.id;if(!l)return;const d=a?s.temporaryStores:s.stores;if(a){s.temporaryRecordCache.clearCache();for(const e in s.temporaryStores){const n=s.temporaryStores[e],o=Array.isArray(n)?n:[n];for(const e of o){const n={userId:l,pointer:e.pointer},o=t.defaultRecordCache.inMemoryRecordCache.getRecord(n);o?be.Wl({environment:t,inMemoryRecordCache:s.temporaryRecordCache,pointer:e.pointer,model:f.kk.fromValue(e.pointer.table,o.value),role:o.role,updatePaths:[[]],userId:l,force:!0,debugSource:"setUnfurlingOptionType"}):be.uo({environment:t,inMemoryRecordCache:s.temporaryRecordCache,persistedRecordCache:void 0,pointer:e.pointer,userId:l})}}}const p=(0,c.x$)(s.url),{host:m}=(0,R.Qc)(p);if(m){if("preview"===n||"mention"===n){const e=d.blockParentStore.getRecordStoreAtRootPath().useCrdt(),n={original_url:p,domain:m};let i;const{unfurlResponse:a}=s;if(a){const s=(0,D.m8)(M.oA(a.relations.map(((n,i)=>{if(n.external_schema)return;const a=d.subExternalObjectInstanceBlockStores[i];return a?((0,x.T)(!a.isDefined()),O.j4({environment:t,id:a.id,type:r.Ti.externalObjectInstance,spaceId:(0,w.C)(d.blockStore.pointer.spaceId),format:n,inMemoryRecordCache:a.inMemoryRecordCache,transaction:o,useCrdt:e}),O.sW({store:a,data:{parent_table:h.iU,parent_id:d.externalObjectInstanceBlockStore.id,alive:!0},transaction:o}),[n.uri,a.id]):void 0})))),{external_object_id:l,uri:c,bot_id:p}=a.root;if(l&&c&&p){let e,t;const o=(0,u.o)(a.root.attributes,(0,G.o$)());o&&(e=o.block_width,t=o.block_height),i={...n,...{...a.root,block_width:e,block_height:t,external_schema:void 0},related_external_object_uris_to_instance_ids:s,external_object_id:l,uri:c,bot_id:p}}else{var g;i={...n,attributes:a.root.attributes,error:a.root.error,auth_refresh_in_progress:439===(null===(g=a.root.error)||void 0===g?void 0:g.status_code)||null}}}else i=n;(0,x.T)(!d.externalObjectInstanceBlockStore.isDefined()),O.j4({environment:t,id:d.externalObjectInstanceBlockStore.id,type:"external_object_instance",format:i,inMemoryRecordCache:d.externalObjectInstanceBlockStore.inMemoryRecordCache,transaction:o,useCrdt:d.blockParentStore.getRecordStoreAtRootPath().useCrdt()})}else if("collection"===n){const{unfurlResponse:e}=s;let n=d.externalCollectionStore.pointer;const a=d.externalCollectionViewStores.map(((e,t)=>{var n,o,i;return{id:e.id,version:0,space_id:(0,w.C)(d.blockStore.pointer.spaceId),type:(null===(n=s.pattern.defaultViews)||void 0===n?void 0:n[t].type)||"table",format:null===(o=s.pattern.defaultViews)||void 0===o?void 0:o[t].format,query2:null===(i=s.pattern.defaultViews)||void 0===i?void 0:i[t].query2,parent_table:h.iU,parent_id:d.externalObjectInstanceBlockStore.id,alive:!0}}));let l;if(e){const{external_object_id:t,uri:i,bot_id:r}=e.root;if(t&&i&&r)if("collectionId"in e&&e.collectionId){l={id:e.collectionId,version:0,space_id:(0,w.C)(d.blockStore.pointer.spaceId),parent_table:h.iU,parent_id:d.externalObjectInstanceBlockStore.id,alive:!0,schema:{}},n={id:e.collectionId,table:b.vF,spaceId:(0,w.C)(d.blockStore.pointer.spaceId)}}else{const t={};e.relations.forEach(((e,n)=>{const i=d.subExternalCollectionStores[n],r=e,a={id:i.id,version:0,space_id:(0,w.C)(d.blockStore.pointer.spaceId),parent_table:b.vF,parent_id:d.externalCollectionStore.id,alive:!0,format:r,schema:{}};t[e.uri]=i.id,O.sW({store:i,data:a,transaction:o})}));l={id:d.externalCollectionStore.id,version:0,space_id:(0,w.C)(d.blockStore.pointer.spaceId),parent_table:h.iU,parent_id:d.externalObjectInstanceBlockStore.id,alive:!0,format:{original_url:p,domain:m,...e.root,related_external_object_uris_to_instance_ids:{...t}},schema:{}}}else{l={id:d.externalCollectionStore.id,version:0,space_id:(0,w.C)(d.blockStore.pointer.spaceId),parent_table:h.iU,parent_id:d.externalObjectInstanceBlockStore.id,alive:!0,format:{original_url:p,domain:m,error:e.root.error},schema:{}}}}else{l={id:d.externalCollectionStore.id,version:0,space_id:(0,w.C)(d.blockStore.pointer.spaceId),parent_table:h.iU,parent_id:d.externalObjectInstanceBlockStore.id,alive:!0,format:{original_url:p,domain:m},schema:{}}}(0,x.T)(!d.externalObjectInstanceBlockStore.isDefined());const c=O.j4({environment:t,id:d.externalObjectInstanceBlockStore.id,type:r.Ti.collectionView,format:{collection_pointer:n},spaceId:(0,w.C)(d.blockStore.pointer.spaceId),inMemoryRecordCache:d.externalObjectInstanceBlockStore.inMemoryRecordCache,transaction:o,useCrdt:d.blockParentStore.getRecordStoreAtRootPath().useCrdt()});O.sW({store:c,data:{collection_id:n.id,parent_table:h.iU,parent_id:d.blockParentStore.id,alive:!0,view_ids:d.externalCollectionViewStores.map((e=>e.id))},transaction:o});const u=ze();d.externalCollectionViewStores.forEach(((t,n)=>{e&&"collectionId"in e&&e.collectionId&&a[n].format&&(a[n].format={collection_pointer:{id:e.collectionId,table:b.vF}}),u&&e&&"table"===a[n].type&&(a[n].format={...a[n].format,table_properties:He(e.root.external_schema)}),O.sW({store:t,data:a[n],transaction:o})})),O.sW({store:d.externalCollectionStore,data:l,transaction:o});const f=s.integration;i.default.afterNextFlush((()=>{const e=ee.R.findCollectionViewBlockFromId(d.externalObjectInstanceBlockStore.id);if(e){const t=e.collectionContextStore.settingsStore;me.wl({collectionSettingsStore:t,item:{type:"shareSyncedView",integrationName:f.name,integrationIcon:f.info.icon}})}}))}if("preview"===n){V.sO({environment:t,editorMode:"default",store:d.textStore,value:s.textValueBeforePaste,transaction:o});const e=re.G.createChildStore(d.blockParentStore,d.externalObjectInstanceBlockStore.pointer);if(F.BE({parent:d.blockParentStore,insert:e,after:d.blockStore,transaction:o}),0===(0,I.QaF)(s.textValueBeforePaste).trim().length){const e=re.G.createChildStore(d.blockParentStore,s.stores.blockStore.pointer);F.Od({parent:d.blockParentStore,childToRemove:e,transaction:o})}const i=re.G.createChildStore(s.stores.blockParentStore,s.stores.externalObjectInstanceBlockStore.pointer);Z.ZH(t),se.Z.setState({...s,currentOption:{type:n,externalObjectInstanceBlockStore:i}})}else if("mention"===n){const e=(0,I.x36)(d.externalObjectInstanceBlockStore.id),n=(0,I.YCD)(e),i=(0,I.P$X)(s.textValueBeforePaste,[n],s.urlSelection.startIndex),r={startIndex:s.urlSelection.startIndex+1,endIndex:s.urlSelection.startIndex+1};V.sO({environment:t,editorMode:"default",store:d.textStore,value:i,transaction:o}),O.sW({store:d.externalObjectInstanceBlockStore,data:{parent_id:d.textStore.id,parent_table:h.iU,alive:!0},transaction:o}),Z.eP({environment:t,store:s.stores.blockStore}),U.Z5({store:s.stores.textStore,selection:r}),se.Z.setState({...s,currentOption:{type:"mention",mentionTokenSelection:r}})}else if("link"===n)se.Z.setState({...s,currentOption:{type:"link"}}),Z.eP({environment:t,store:s.stores.blockStore}),U.Z5({store:s.stores.textStore,selection:{startIndex:s.urlSelection.endIndex,endIndex:s.urlSelection.endIndex}});else if("drive"===n)se.Z.setState({...s,currentOption:{type:"drive"}}),Z.eP({environment:t,store:s.stores.blockStore}),U.Z5({store:s.stores.textStore,selection:{startIndex:s.urlSelection.endIndex,endIndex:s.urlSelection.endIndex}});else if("collection"===n){V.sO({environment:t,editorMode:"default",store:d.textStore,value:s.textValueBeforePaste,transaction:o});const e=re.G.createChildStore(d.blockParentStore,d.externalObjectInstanceBlockStore.pointer);if(F.BE({parent:d.blockParentStore,insert:e,after:d.blockStore,transaction:o}),0===(0,I.QaF)(s.textValueBeforePaste).trim().length){const e=re.G.createChildStore(d.blockParentStore,s.stores.blockStore.pointer);F.Od({parent:d.blockParentStore,childToRemove:e,transaction:o})}Z.ZH(t),se.Z.setState({...s,currentOption:{type:n}})}else(0,A.t1)(n);if(!a){const{unfurlResponse:e}=s;de.Mp(t,{integrationId:s.integration.id,type:n,entity:s.pattern.name,domain:m,from:"unfurl_menu",...e&&{status:null!=e&&e.root.error?"failure":"success"},collection_id:"collection"===n?d.externalCollectionStore.pointer.id:void 0,collection_view_block_id:"collection"===n&&d.blockStore.isCollectionView()?d.blockStore.id:void 0})}}}async function De(e){const{environment:t,notionState:n}=e,{externalObjectInstanceBlockId:o,spaceId:i}=n;if(o){const e=new re.G(t,{table:h.iU,id:o,spaceId:i});let n;if(await Promise.all([e.load(),ne.Z.waitUntil((()=>ne.Z.state.loaded))]),e.isExternalObjectInstanceBlockStore()||e.isExternalObjectInstancePageBlockStore())n=e.getFormat();else if(e.isCollectionView()){var r;n=null===(r=e.getCollectionViewSourceCollectionStore())||void 0===r?void 0:r.getFormat()}if(!n)throw new Error("External object instance has no value.");const a=n.original_url||n.uri;if(!a)throw new Error("External object instance has no original_url.");const s=(0,C.ny)({url:a,integrations:ne.Z.integrations.state,currentSpaceId:i});if("success"!==s.type)throw new Error("Could not find integration.");const{integration:l}=s,c=(0,K.NP)(l.id);if(0===c.length)throw new Error("Could not find bot.");if(e.isExternalObjectInstanceBlockStore()||e.isExternalObjectInstancePageBlockStore())await Ee({environment:t,url:a,botIds:c.map((e=>{let{id:t}=e;return t})),integrationId:l.id,externalObjectInstanceBlockStore:e});else{if(!e.isCollectionView())throw new Error(`BlockStore is neither an ExternalObject nor a ExternalCollection. It has type: ${e.getType()}`);{const n=e.getCollectionViewSourceCollectionStore();if(!n)throw new Error("Could not find collection store.");await Fe({environment:t,url:a,botIds:c.map((e=>{let{id:t}=e;return t})),externalCollectionViewBlockStore:e,externalCollectionStore:n})}}}}async function Ee(e){const{environment:t,url:n,botIds:o,integrationId:i,externalObjectInstanceBlockStore:a}=e;le.Z.add(n);const s=await ue.unfurlUrl(t,{url:n,botIds:o,integrationId:i,spaceId:pe.Bs()});le.Z.delete(n);const l=se.Z.state,d="success"===s.type?s.data:{root:{error:{status_code:s.status}},relations:[]};if(l.open&&l.stores.externalObjectInstanceBlockStore===a){se.Z.setState({...l,unfurlResponse:d});const e=function(e,t,n){if(Se.includes(e)&&"collection"===n)return t.root.hasOwnProperty("external_schema")?"collection":"preview";if("import"===n)return"link";return n}(i,d,l.currentOption.type);L.createAndCommit({userAction:"unfurlingActions.startUnfurlRequest",environment:t,perform:n=>{Re({environment:t,type:e,useTemporaryRecordCache:!0,transaction:n,intl:Q.default.getIntl()})}})}else if(a.isExternalObjectInstanceBlockStore())!function(e){const{environment:t,unfurlResponse:n,url:o,externalObjectInstanceBlockStore:i}=e,a=i.pointer.spaceId,s=t.currentUser.id;if(!s)return;const l=(0,c.x$)(o),{host:d}=(0,R.Qc)(l);if(!d)return;if("collectionId"in n)return;const p=i.getFormat().related_external_object_uris_to_instance_ids,m=(0,D.m8)(Object.entries(p||{}).map((e=>{let[t,n]=e;return[t,re.G.createChildStore(i,{id:n,table:h.iU,spaceId:i.getSpaceId()})]})));L.createAndCommit({userAction:"unfurlingActions.createExternalObjectInstanceFromInitialUnfurl",environment:t,perform:e=>{const s=(0,D.m8)(M.oA(n.relations.map((n=>{if(n.external_schema)return;let o=m[n.uri];return o?(O.sW({store:o,data:{type:r.Ti.externalObjectInstance,parent_table:h.iU,parent_id:i.id,alive:!0},transaction:e}),O.sW({store:o.getFormatStore(),data:n,transaction:e})):(o=O.j4({environment:t,type:r.Ti.externalObjectInstance,spaceId:a,format:n,inMemoryRecordCache:i.inMemoryRecordCache,transaction:e,useCrdt:i.useCrdt()}),O.sW({store:o,data:{parent_table:h.iU,parent_id:i.id,alive:!0},transaction:e})),[n.uri,o.id]})))),l=i.getFormatStore().getValue();let c,d;if(l&&(c=l.block_width,d=l.block_height),!c&&!d){const e=(0,u.o)(n.root.attributes,(0,G.o$)());e&&(c=e.block_width,d=e.block_height)}O.sW({store:i.getFormatStore(),data:{...{...n.root,block_width:c,block_height:d,external_schema:void 0,integration_id:null,original_url:o,is_placeholder:null,error:n.root.error??null},related_external_object_uris_to_instance_ids:s},transaction:e})}})}({environment:t,unfurlResponse:d,url:n,externalObjectInstanceBlockStore:a}),function(e){const{environment:t,url:n,spaceId:o,status:i}=e,r=(0,G.GQ)(n,o),a=(0,c.x$)(n),s=(0,R.Qc)(a);r&&s.host&&de.Mp(t,{integrationId:r.integration.id,type:"preview",entity:r.pattern.name,domain:s.host,from:"link_preview_placeholder",...i&&{status:i}})}({environment:t,url:n,spaceId:a.getSpaceId(),...d&&{status:d.root.error?"failure":"success"}});else{if(!a.isCollectionView()){if(a.isExternalObjectInstancePageBlockStore())return;throw new Error(`BlockStore is neither an ExternalObject nor a ExternalCollection. It has type: ${a.getType()}`)}{const e=a.getCollectionViewSourceCollectionStore();if(!e)throw new Error("Could not find collection store.");L.createAndCommit({userAction:"unfurlingActions.startUnfurlRequest",environment:t,perform:o=>{Oe({environment:t,unfurlResponse:d,url:n,externalCollectionStore:e,externalCollectionViewBlockStore:a,transaction:o})}})}}}async function Be(e){const{environment:t,url:n,botIds:o,userDefinedExternalCollectionStore:i,relatedPageId:a}=e,s=i.getFormat();if(!s.uri||void 0!==s.external_object_id)return;le.Z.add(n);const l=await ue.unfurlUrl(t,{url:n,botIds:o,spaceId:i.getSpaceId(),targetCollectionId:i.id,relatedPageId:a});if("failed"===l.type)return void fe.showError(l);le.Z.delete(n);const d=l.data;return"pageId"in d&&d.pageId?new re.G(t,{table:h.iU,id:d.pageId,spaceId:i.getSpaceId()}):function(e){const{environment:t,unfurlResponse:n,url:o,rootUserDefinedExternalCollectionStore:i}=e,a=i.pointer.spaceId,s=t.currentUser.id;if(!s)return;const l=(0,c.x$)(o),{host:d}=(0,R.Qc)(l);if(!d)return;if(!n.root.external_object_id)return;const u=n.root;return L.createAndCommit({userAction:"unfurlingActions.createExternalObjectInstancePageFromInitialUnfurl",environment:t,perform:e=>{const n=O.j4({environment:t,type:r.Ti.externalObjectInstancePage,spaceId:a,format:u,inMemoryRecordCache:i.inMemoryRecordCache,transaction:e,useCrdt:j.dy({source:"external_object_instance_page"})});return ve.zw({parentStore:i,childStore:n,transaction:e}),new re.G(t,n.pointer)}}).performResult}({environment:t,unfurlResponse:d,url:n,rootUserDefinedExternalCollectionStore:i})}async function Fe(e){const{environment:t,url:n,botIds:o,externalCollectionStore:i,externalCollectionViewBlockStore:r}=e;le.Z.add(n);const a=await ue.unfurlUrl(t,{url:n,botIds:o,spaceId:pe.Bs()});le.Z.delete(n);const s="success"===a.type?a.data:{root:{error:{status_code:a.status}},relations:[]};L.createAndCommit({userAction:"unfurlingActions.startUnfurlRequestForCollection",environment:t,perform:e=>{Oe({environment:t,unfurlResponse:s,url:n,externalCollectionStore:i,externalCollectionViewBlockStore:r,transaction:e})}})}function Oe(e){const{environment:t,unfurlResponse:n,url:o,externalCollectionStore:i,externalCollectionViewBlockStore:r,transaction:l}=e,d=(0,c.x$)(o),{host:u}=(0,R.Qc)(d);if(!u)return;const{external_object_id:p,uri:m,bot_id:f}=n.root;if(!p||!m||!f)return;const g=M.w6(C.wh).map((()=>new re.NW(t,{table:b.vF,id:(0,P.ZP)(),spaceId:r.pointer.spaceId}))),v={};n.relations.forEach(((e,t)=>{const n=g[t],o=e,a={id:n.id,version:0,space_id:(0,w.C)(r.pointer.spaceId),parent_table:b.vF,parent_id:i.id,alive:!0,format:o,schema:{}};v[e.uri]=n.id,O.sW({store:n,data:a,transaction:l})}));const _={id:i.id,version:0,space_id:(0,w.C)(r.pointer.spaceId),parent_table:h.iU,parent_id:r.id,alive:!0,format:{original_url:d,domain:u,...n.root,property_visibility:(S=n.root.external_schema,S&&Object.keys(S).flatMap((e=>(0,s.HF)(e)?[]:{property:`${a.U}${e}`,visibility:"hide_if_empty"}))),related_external_object_uris_to_instance_ids:{...v},is_placeholder:void 0,integration_id:void 0},schema:{}};var S;O.sW({store:i,data:_,transaction:l});if(ze()&&n){const e=r.getCollectionViewIds();null==e||e.forEach((e=>{const t=re.Xr.createChildStore(r,{table:y.np,id:e,spaceId:r.getSpaceId()});if("table"===t.getType()){const e={...t.getFormat(),table_properties:He(n.root.external_schema)};O.sW({store:t,data:{format:e},transaction:l})}}))}}async function Ze(e){const{environment:t}=e,{externalObjectInstanceBlockPointersMap:n,externalCollectionInstancePointersMap:o}=oe.Z.state;await ue.refetchExternalObjectInstanceBlocks(t,{recordPointers:[...Object.values(n),...Object.values(o)]}),oe.Z.reset()}async function Ve(e){const{environment:t,externalAuthenticationValue:n}=e;let o=await ue.getExternalIntegrationAccessToken(t,{botId:n.id,integrationId:n.integration_id,spaceId:n.space_id});if("failed"===o.type){const e=ne.Z.integrations.state.find((e=>e.id===n.integration_id));if(!e)return;ye.oV({label:Q.default.formatMessage(ke.userReAuth)}),await ge.hM({environment:t,integration:e,spaceId:n.space_id,from:"integration_file_picker"});const i=ne.Z.bots.state.filter((e=>e.integration_id===n.integration_id))[0];if(!i)return;o=await ue.getExternalIntegrationAccessToken(t,{botId:i.id,integrationId:i.integration_id,spaceId:i.space_id})}return o}function Ue(e){const{integration:t}=e;return t.id===d.YM&&"on"===H.default.getEligibleGroup({experimentId:"box_file_picker",defaultGroup:"control"})?Le({integrationType:"box",...e}):t.id===d.f3&&(0,$.qH)()?Le({integrationType:"drive",...e}):void 0}function Le(e){const{integrationType:t,integration:n}=e;return"box"===t?{type:t,title:Q.default.formatMessage(ke.browse,{appName:n.name}),accounts:ne.Z.externalAuthentications.state.filter((e=>{let{integration_id:t}=e;return t===n.id})),onSelect:je(e)}:"drive"===t?{type:t,title:Q.default.formatMessage(ke.browse,{appName:n.name}),accounts:ne.Z.externalAuthentications.state.filter((e=>{let{integration_id:t}=e;return t===n.id})),onSelect:je(e)}:void 0}function je(e){const{integration:t,environment:n,externalObjectTokenStore:o,externalObjectInstanceBlockStore:i}=e;return async e=>{let r=e?e.id:void 0;if(!e){const{currentSpaceStore:e}=te.default.state,o=ne.Z.integrations.state.find((e=>{let{id:n}=e;return n===t.id}));if(o&&e){const i=ne.Z.bots.state;await ge.hM({environment:n,integration:o,spaceId:e.id,from:"integration_file_picker"});const a=function(e,t){const n=ne.Z.bots.state;var o;if(e.length!==n.length)return null===(o=n.filter((e=>e.integration_id===t))[0])||void 0===o?void 0:o.id}(i,t.id);a&&(r=a)}}const a=ne.Z.externalAuthentications.state.find((e=>e.id===r));if(a){const e=await async function(e,t,n,o,i){if(!ne.Z.state.loaded)return;i.setState({error:!1,loading:!0});const r=await Ve({environment:e,externalAuthenticationValue:o});if(i.setState({error:!r||"success"!==r.type,loading:!1}),r&&"failed"!==r.type)return r.data;fe.showDialog({message:Q.default.formatMessage(ke.somethingWentWrong),showCancel:!0,keepFocus:!0,items:[{label:Q.default.formatMessage(ke.copyDebuggingInformation),color:void 0,onAccept:()=>{const t={statusCode:null==r?void 0:r.status,integrationId:n.id,botId:o.id};E.RD({environment:e,stringValue:JSON.stringify(t,null,2),copiedMessage:ke.copiedDebuggingInfo})}}]})}(n,0,t,a,o);e&&(he.Z(),await function(e){const{integration:t,tokenDetails:n,environment:o,externalObjectInstanceBlockStore:i,botId:r}=e;if(t.id===d.YM)return async function(e,t){const{access_token:n}=e;try{await(0,W.ZP)("https://cdn01.boxcdn.net/polyfills/core-js/2.5.3/core.min.js",{resourceType:W._g.Javascript});const e=[{url:"https://cdn01.boxcdn.net/platform/elements/15.0.0/en-US/picker.js",resourcetype:W._g.Javascript},{url:"https://cdn01.boxcdn.net/platform/elements/15.0.0/en-US/picker.css",resourcetype:W._g.Stylesheet}];await Promise.all(e.map((e=>{let{url:t,resourcetype:n}=e;return(0,W.ZP)(t,{resourceType:n})})))}catch(a){return void t(!0,"")}const o=document.createElement("div");o.setAttribute("id","box-app-container"),document.body.appendChild(o);const i=new Box.FilePicker;i.show("0",n,{size:"small",container:"#box-app-container",maxSelectable:1,logoUrl:"box"});const r=()=>{i.hide(),o.remove()};i.addListener("choose",(function(e){var n;const o=null==e||null===(n=e[0])||void 0===n?void 0:n.id;o&&t(!1,`https://app.box.com/file/${o}`),r()})),i.addListener("cancel",r)}(n,Ne({environment:o,externalObjectInstanceBlockStore:i,botId:r}));if(t.id===d.f3)return(0,$.vE)({environment:o,accessToken:n.access_token,callback:Ne({environment:o,externalObjectInstanceBlockStore:i,botId:r}),integration:t,from:"link_preview_placeholder"});return void function(){if(_e){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.warn("multiTextSelectionHelpers:",...t)}}(`no matching integration found for external file picker with integration ID ${t.id}}`)}({integration:t,environment:n,externalObjectInstanceBlockStore:i,externalObjectTokenStore:o,botId:a.id,tokenDetails:e}))}}}function Ne(e){const{environment:t,externalObjectInstanceBlockStore:n,botId:o}=e;return(e,i)=>{if(e)return fe.showDialog({message:Q.default.formatMessage(ke.somethingWentWrong),showCancel:!0,keepFocus:!0,items:[{label:Q.default.formatMessage(ke.copyDebuggingInformation),color:void 0,onAccept:()=>{const n={err:e,botId:o};E.RD({environment:t,stringValue:JSON.stringify(n,null,2),copiedMessage:ke.copiedDebuggingInfo})}}]});We({environment:t,externalObjectInstanceBlockStore:n,url:i,botId:o})}}function ze(){return H.default.checkGate("is_visibility_enabled_for_db_sync")}function qe(e){const{environment:t,originRect:n,externalObjectInstanceBlockStore:o,integration:i}=e,r=[{type:"embed",onChange:n=>{We({environment:t,url:n,externalObjectInstanceBlockStore:o,placeholderIntegrationId:e.placeholderIntegrationId}),he.Z()}}];if(H.default.checkGate("ai_source_picker")&&((null==i?void 0:i.id)===d.Gw||(null==i?void 0:i.id)===d.mC)){const n=(null==i?void 0:i.id)===d.Gw?"/images/external_integrations/github-icon.png":"/images/external_integrations/jira-icon.png";r.push({type:"aiSourcePicker",integration:null==i?void 0:i.id,defaultAvatar:n,onChange:n=>{We({environment:t,url:n,externalObjectInstanceBlockStore:o,placeholderIntegrationId:e.placeholderIntegrationId}),he.Z()},getResults:async(e,n)=>await async function(e){const{environment:t,query:n,integrationId:o,botId:i}=e,r=i?[i]:ne.Z.bots.state.filter((e=>e.integration_id===o)).map((e=>{let{id:t}=e;return t}));if(0===r.length)return{root:{error:{status_code:500,messages:["No bot found for this integration"]}},relations:[]};return await async function(e){const{environment:t,query:n,botIds:o}=e,i=await ue.aiSourcePicker(t,{query:n,botIds:o,spaceId:pe.Bs()}),r="success"===i.type?i.data:{root:{error:{status_code:i.status}},relations:[]};return"failed"===i.type&&fe.showError(i),r}({environment:t,query:n,botIds:r})}({environment:t,query:e,integrationId:n})})}if(i&&!t.device.isMobile){const n=Ue({integration:i,environment:t,externalObjectInstanceBlockStore:o,externalObjectTokenStore:e.externalObjectTokenStore});n&&r.push(n)}he.$(t,{originGap:0,originRect:n,title:"Embed Link Preview",currentTab:"embed",tabs:r})}function We(e){const{environment:t,url:n,externalObjectInstanceBlockStore:o,placeholderIntegrationId:i,botId:a}=e,s=(0,C.ny)({url:n,integrations:ne.Z.integrations.state,currentSpaceId:o.getSpaceId()});if("success"===s.type){const{integration:e,pattern:i}=s,l=a?[a]:ne.Z.bots.state.filter((t=>t.integration_id===e.id)).map((e=>{let{id:t}=e;return t}));if(l.length>0){const a=o.getParentId(),s=(0,c.x$)(n),{host:d}=(0,R.Qc)(s);d&&a&&(L.createAndCommit({userAction:"unfurlingActions.startUnfurlFromPlaceholder",environment:t,perform:e=>{O.sW({store:o,data:{type:r.Ti.externalObjectInstance},transaction:e}),O.sW({store:o.getFormatStore(),data:{original_url:n,domain:d},transaction:e})}}),de._x(t,{integrationId:e.id,entity:i.name,domain:d,from:"placeholder"})),Ee({environment:t,url:n,botIds:l,integrationId:e.id,externalObjectInstanceBlockStore:o})}else L.createAndCommit({userAction:"unfurlingActions.startUnfurlFromPlaceholder",environment:t,perform:e=>{O.sW({store:o.getFormatStore(),data:{integration_id:null,original_url:n,is_placeholder:null},transaction:e})}})}else if("partial"===s.type){const{integration:e}=s;L.createAndCommit({userAction:"unfurlingActions.startUnfurlFromPlaceholder",environment:t,perform:t=>{O.sW({store:o.getFormatStore(),data:{is_placeholder:null,integration_id:e.id,original_url:n,error:{status_code:m.Rl.UNPROCESSABLE_ENTITY}},transaction:t})}})}else"failure"===s.type?L.createAndCommit({userAction:"unfurlingActions.startUnfurlFromPlaceholder",environment:t,perform:e=>{O.sW({store:o.getFormatStore(),data:{is_placeholder:null,original_url:n,integration_id:i,error:{status_code:m.Rl.UNPROCESSABLE_ENTITY}},transaction:e})}}):(0,A.t1)(s)}function He(e){return e&&Object.entries(e).flatMap((e=>{let[t,n]=e;return(0,s.HF)(t)?[]:"hidden"===(null==n?void 0:n.visibility)?{property:`${a.U}${t}`,visible:!1}:{property:`${a.U}${t}`,visible:!0}}))}function Ke(e){const{environment:t,block:n,transaction:o}=e;if(!n.isDefined()||!ce.M_(t)||!n.isType(r.Ti.externalObjectInstance))return;const i=(0,P.ZP)(),a=O.j4({environment:t,id:i,type:r.Ti.externalObjectInstance,spaceId:n.getSpaceId(),format:n.getFormat(),inMemoryRecordCache:n.inMemoryRecordCache,transaction:o,useCrdt:n.useCrdt()});O.sW({store:a,data:{parent_id:n.id,parent_table:n.table,alive:!0},transaction:o});const s=n.getFormatStore().getKeyStore("related_external_object_uris_to_instance_ids").getValue();if(s)for(const r of Object.values(s)){const e={table:h.iU,id:r,spaceId:n.getSpaceId()};L.applyOperation({store:(0,re.Kv)(n,e),operation:{pointer:e,path:[],command:"update",args:{parent_table:h.iU,parent_id:i}},transaction:o})}const c=[(0,I.YCD)((0,I.x36)(i))];O.sW({store:n,data:{type:r.Ti.text},transaction:o}),V.sO({environment:t,editorMode:"default",store:n.getBlockTitleStore(),value:c,transaction:o});const d=l.nY(n.getFormat());O.sW({store:n.getFormatStore(),data:(0,D.Q8)(d,(()=>null)),transaction:o})}function Ge(e){var t;const{block:n,transaction:o,token:i,parentStore:r}=e,{tokenIndex:a}=i;if(!n.isDefined())return;const s=null===(t=r.getParentBlockStore())||void 0===t?void 0:t.getContentStore();if(!s)return;V.gy({block:r,editorMode:"default",transaction:o,tokenIndex:a})&&F.BE({parent:s,insert:n,after:r,transaction:o})}function $e(e){const{environment:t,spaceId:n,from:o,store:i,bypassCache:r}=e,a=(0,G.y6)(i),s=(null==a?void 0:a.original_url)||(null==a?void 0:a.uri);if(!s)return;const l=(0,G.GQ)(s,n),c=(0,G.Ue)(s,n);if(!l||0===c.length)return;const u=i.getCollectionViewCollectionStore(),{integration:p,pattern:m}=l;i.isCollectionView()&&u?ue.refetchExternalObjectInstanceBlocks(t,{recordPointers:[{...u.pointer,spaceId:n}],bypassCache:r}):i.isExternalObjectInstancePageBlockStore()?d.tO.includes(p.id)?Ee({environment:t,url:s,botIds:c.map((e=>{let{id:t}=e;return t})),integrationId:p.id,externalObjectInstanceBlockStore:i}):ue.refetchExternalObjectInstanceBlocks(t,{recordPointers:[{...i.pointer,spaceId:n}],bypassCache:r}):i.isExternalObjectInstanceBlockStore()&&Ee({environment:t,url:s,botIds:c.map((e=>{let{id:t}=e;return t})),integrationId:p.id,externalObjectInstanceBlockStore:i}),de.B3(t,{integrationId:p.id,entity:m.name,from:o})}},53471:(e,t,n)=>{n.d(t,{A3:()=>j,IL:()=>B,K_:()=>z,Q7:()=>F,W8:()=>N,Xo:()=>D,cR:()=>U,cT:()=>Z,dm:()=>G,nQ:()=>R,y:()=>L});n(21703),n(57658);var o=n(15095),i=n(68626),r=n(53770),a=n(23867),s=n(70203),l=n(9291),c=n(57347),d=n(53965),u=n(37850),p=n(7032),m=n(40470),f=n(19584),g=n(91754),h=n(33954),v=n(33929),b=n(52533),y=n(2414),_=n(77080),S=n(21051),w=n(53730),k=n(91551),I=n(88923),C=n(88893),x=n(88280),T=n(57549),M=n(54642),P=n(35253);const A=(0,l.defineMessages)({uploadFileFailed:{defaultMessage:"Upload failed.",id:"uploadActions.uploadFailedError.message"}});function R(e){return e.filter((e=>e.getAlive())).map((e=>{const{source:t,title:n,size:o}=e.getProperties()||{};return{type:"remote",id:e.id,source:s.QaF(t),name:s.QaF(n),size:s.QaF(o),store:e}}))}function D(e){return{...E(e),id:(0,p.ZP)(),dataURL:URL.createObjectURL(e),type:"local"}}function E(e){return{file:e,name:e.name,size:`${(e.size/1024).toFixed(1)}KB`}}function B(e){var t;const n=e.files.map(E);null===(t=e.onBatchStart)||void 0===t||t.call(e,n);const o={};let i=0;u.jl(e.files,W,(t=>Promise.all(t.map((t=>{const n=(0,p.ZP)();return new Promise(((a,s)=>{const l={environment:e.environment,..."secure"===e.bucket?{bucket:e.bucket,record:e.record}:{bucket:e.bucket},file:t,onStart:t=>{var o;null===(o=e.onSingleFileStart)||void 0===o||o.call(e,t,n)},onProgress:t=>{var o,r;let{progressPercent:a,uploadedFiles:s}=t;null===(o=e.onBatchProgress)||void 0===o||o.call(e,{progressPercent:a,uploadedFiles:i}),null===(r=e.onSingleFileProgress)||void 0===r||r.call(e,{progressPercent:a,uploadedFiles:s},n)},onComplete:r=>{var s;i++,o[t.name]=r,null===(s=e.onSingleFileComplete)||void 0===s||s.call(e,r,n),a()},onError:t=>{var o;const i=new Error(t.message);null===(o=e.onSingleFileError)||void 0===o||o.call(e,i,n),s(i)},preventLimitFreeFileSize:e.preventLimitFreeFileSize};"confluence"===e.uploadType||"genericImporter"===e.uploadType?async function(e){const{environment:t,file:n,preventLimitFreeFileSize:o}=e,i=n.type||"text/plain; charset=utf-8";if(F({preventLimitFreeFileSize:o,environment:t,file:n})){var a;null===(a=e.onStart)||void 0===a||a.call(e,E(n));const o=Math.floor(n.size/O)+1,f={bucket:e.bucket,name:n.name,contentType:i,supportExtraHeaders:!0,contentLength:n.size,numberOfFileChunks:o},g=await M.initiateMultipartUpload(t,f);var s;if("failed"===g.type)return void(null===(s=e.onError)||void 0===s||s.call(e,{message:g.error.message,offline:g.offline}));const h=await async function(e){const{file:t,signedUrlsForChunks:n}=e,o=[];let i,a,s,l=[];const u=[];for(let r=0;r<n.length;r++){i=r*O,a=(r+1)*O,s=r+1<n.length?t.slice(i,a):t.slice(i);const e=n[r],l=fetch(e,{method:"PUT",body:new Blob([s],{type:t.type})});o.push(l)}const p=d.yo(o,3);for(const[d,g]of p.entries()){var m;try{const e=await(0,r.Yb)((()=>Promise.all(g)),[100,1e3,3e3]);l=[...l,...e]}catch(f){return{error:(0,c.t)(f)}}null===(m=e.onProgress)||void 0===m||m.call(e,{progressPercent:Math.floor(d/p.length*100),uploadedFiles:0})}return l.forEach(((e,t)=>{const n=e.headers.get("etag");n&&u.push({ETag:n,PartNumber:t+1})})),{value:u}}({file:n,signedUrlsForChunks:g.data.signedUrlsForChunks,onProgress:e.onProgress});var l;if(m.x.isFail(h))return void(null===(l=e.onError)||void 0===l||l.call(e,{message:h.error.message,offline:void 0}));const v={...f,multipartUploadEtags:h.value,fileKey:g.data.key,uploadId:g.data.uploadId},b=await M.completeMultipartUpload(t,v);var u,p;if("success"===b.type)null===(u=e.onComplete)||void 0===u||u.call(e,g.data.url);else null===(p=e.onError)||void 0===p||p.call(e,{message:b.error.message,offline:b.offline})}else j(e.environment)}(l):V(l)}))}))))).then((()=>{var t;const n=e.files.map((e=>o[e.name]));null===(t=e.onBatchComplete)||void 0===t||t.call(e,n)})).catch((t=>{var n;"confluence"===e.uploadType&&T.a1(e.environment,{import_source:"confluence",data:{import_type:"file",status:"failure",error:t,fileSize:e.files[0].size},flowId:e.flowId}),null===(n=e.onBatchError)||void 0===n||n.call(e,t)}))}function F(e){const{preventLimitFreeFileSize:t,environment:n,file:o}=e,i=x.subscriptionDataStoreInstance.state;let r=!1;if(n.device.isMobileNative){const e="personal"===C.M9(n);r=!((0,b.S$)({environment:n})&&e)}return!(!t&&i&&C.Bu(i)&&!r&&o.size>q)}const O=20971520;function Z(e){const{retryWhenOffline:t,backoffController:n=new y.h(void 0)}=e;V({...e,onComplete:t=>{var o;n.getFailures()>0&&_.default.logEvent("upload_offline_success_after_retries",n.getFailures()),null===(o=e.onComplete)||void 0===o||o.call(e,t)},onError:o=>{var i;if(t&&o.offline){if(_.default.checkGate("autoretry_file_uploads"))return void n.backOffOnFailure(10*f.C0).then((()=>{Z({...e,backoffController:n})}));_.default.logEvent("upload_offline_failure")}null===(i=e.onError)||void 0===i||i.call(e,o)}})}async function V(e){const{environment:t,file:n,preventLimitFreeFileSize:o}=e,r=n.type||"text/plain; charset=utf-8";if(F({preventLimitFreeFileSize:o,environment:t,file:n})){e.onStart&&e.onStart(E(n));const o="secure"===e.bucket?{bucket:e.bucket,name:n.name,contentType:r,record:{table:e.record.table,id:e.record.id,spaceId:(0,a.C)(e.record.spaceId)},supportExtraHeaders:!0,contentLength:n.size}:{bucket:e.bucket,name:n.name,contentType:r,supportExtraHeaders:!0,contentLength:n.size};"secure"===e.bucket&&await w.transactionQueue.awaitRecordTransaction(e.record);const s=await M.getUploadFileUrl(t,o);if("success"===s.type){const{url:t,signedPutUrl:o,putHeaders:a}=s.data,l=u.UZ(),c=new XMLHttpRequest;c.open("PUT",o),c.setRequestHeader("Content-type",r);for(const e of a)c.setRequestHeader(e.name,e.value);c.upload.addEventListener("progress",(t=>{if(t.lengthComputable){const n=Math.round(100*t.loaded/t.total);e.onProgress&&e.onProgress({progressPercent:n,uploadedFiles:0})}})),c.onreadystatechange=function(){4===c.readyState&&(200===c.status?l.resolve({value:t}):(i.log({level:"error",from:"uploadActions",type:"ClientUploadError",data:{miscDataToConvertToString:{status:c.status,responseText:c.responseText}}}),l.resolve({error:{message:v.default.formatMessage(A.uploadFileFailed),offline:0===c.status}})))},c.send(n);const d=await l.promise;d.error?e.onError&&e.onError(d.error):e.onComplete&&(e.onComplete(t),i.log({level:"info",from:"uploadActions",type:"ClientUploadSuccess",data:{miscDataToConvertToString:{url:t}}}))}else if(e.onError){const t=(0,h.wf)(v.default.getIntl(),s);e.onError({message:t,offline:s.offline})}}else j(e.environment)}function U(e){K({...e,onChange:t=>{if(!t.files||0===t.files.length)return;const n=Array.from(t.files);B({environment:e.environment,files:n,..."secure"===e.bucket?{bucket:e.bucket,record:e.record}:{bucket:e.bucket},onBatchStart:e.onStart,onBatchProgress:e.onProgress,onBatchComplete:e.onComplete,onBatchError:e.onError,preventLimitFreeFileSize:e.preventLimitFreeFileSize})}})}async function L(e){const t=u.UZ();return K({...e,onChange:e=>{const n=o.p4(e.files);t.resolve(n)}}),t.promise}function j(e){P.Bw({bannerStore:I.default.state.open?k.Z:S.Z,id:"SubscriptionEditingBlocker",styleKey:g.v.Red,contentKey:"upload_limit_exceeded"})}function N(){P.qL({bannerStore:S.Z,id:"SubscriptionEditingBlocker"}),P.qL({bannerStore:k.Z,id:"SubscriptionEditingBlocker"})}const z=5,q=1e6*z,W=5;let H;function K(e){H&&H.remove(),H=document.createElement("input"),H.type="file",H.style.opacity="0",H.style.pointerEvents="none",H.style.position="fixed",H.style.left="-1000px",H.style.top="-1000px",H.ariaHidden="true",document.body.appendChild(H),e.multiple?H.setAttribute("multiple",""):H.removeAttribute("multiple"),e.accept&&H.setAttribute("accept",e.accept),H.addEventListener("change",(()=>{e.onChange&&e.onChange(H)})),H.addEventListener("blur",(()=>{e.onBlur&&e.onBlur(H)})),H.addEventListener("click",(e=>{e.stopPropagation()})),H.click(),H.focus({preventScroll:!0})}function G(e){return e.filter($).map((e=>e.file))}function $(e){return"local"===e.type}},70782:(e,t,n)=>{n.d(t,{f:()=>y,x:()=>b});var o=n(87997),i=n(15145),r=n(9852),a=n(54153),s=n(75754),l=n(12955),c=n(87381),d=n(32223),u=n(55081),p=n(75538),m=n(80444),f=n(77080),g=n(6258),h=n(35793),v=n(97977);async function b(e){const{newCurrentUserId:t,loggedOutUserId:n,environment:i}=e;await v.setLocalStorageUserId(i,t),(0,r.xj)(t),await l.setCookie(i,{name:"notion_user_id",value:t});const s=i.currentUser.loggedInUserIds.filter((e=>e!==n)),m=await l.getGhostAdminUserId(i),g={...i,currentUser:new o.CurrentUser({id:t,loggedInUserIds:s,adminUserId:m})};if(i.updateCurrentUserId){const e={environment:i,currentUserId:t,userIds:s};"on"!==f.default.getGroup("await-update-user-id")?await i.updateCurrentUserId(e):i.updateCurrentUserId(e)}a.Z.set(c.currentUserIdKey,t),d.resetRecordSubscriptions(),p.default.reset();return await u.zJ(i)&&u.yH(g),await h.KJ(g,t),g}async function y(e){const{newCurrentUserId:t,environment:n,store:o}=e,{mainEditorCurrentBlockStore:r}=m.default.state,a=await b({environment:n,newCurrentUserId:t});if(r){const e=new g.G(a,o.pointer);m.default.setState({...m.default.state,mainEditorCurrentBlockStore:void 0}),s._c({environment:a,store:e,pageVisitSource:i.tY.SwitchSpace})}}},12321:(e,t,n)=>{n.d(t,{j:()=>g,w:()=>h});n(21703),n(57658);var o=n(45953),i=n(21202),r=n(75246),a=n(77858),s=n(66079),l=n(45950),c=n(5659),d=n(88310),u=n(88632),p=n(29226),m=n(54642),f=n(4408);function g(e,t){!function(){v&&u.Z.removeListener(v);p.Z.reset()}(),async function(e,t){try{const n=await c.A.measure("loadUserContent","(current user)",(()=>async function(e){const{defaultRecordCache:t,currentUser:n}=e;if(!t.persistedRecordCache)throw new Error("No local database found.");const o=n.id;if(!o)throw new Error("User is not logged in.");const i=[],c=await l.yY({environment:e,recordPointers:[{table:s.dx,id:o}],recurFn:e=>{const t=[],n=e=>{e&&(e.table!==a.zU&&e.table!==s.dx||i.push(e),t.push(e))};return e.table===s.dx?(n(e.getUserPointer()),e.getSpaceViewPointers().forEach(n)):e.table===a.zU?(e.getBookmarkedPagePointers().forEach(n),e.getSharedPagePointers().forEach(n),n(e.getSpacePointer())):e.table===r.bx&&e.getPagePointers().forEach(n),t},recordIsRequired:e=>e.table===s.dx||e.table===a.zU});for(const r of i){const e=c.getModel(r);if(c.getRole(r)&&!e)throw new Error(`Not defined: ${r.table}, ${r.id}`)}return{recordMap:c.toJson({allowVersionDowngrade:!1})}}(e))),i=o.PF.create(n.recordMap);f.fL({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,recordMap:i,debugSource:"fetchLocalUserContent"}),p.Z.setState({...p.Z.state,localSpaceInaccessiblePages:y(i,t)}),p.Z.state.readyPromise.resolve()}catch(n){}}(e,t),b(e);let n=u.Z.state.online;v=()=>{const t=u.Z.state.online;!t||n||p.Z.state.remoteSpaceInaccessiblePages||b(e),n=t},u.Z.addListener(v)}async function h(){await p.Z.state.readyPromise.promise}let v;async function b(e){d.$L("await_get_spaces_start");const t=await m.getSpaces(e,{},void 0,void 0,void 0,"getSpaces");d.$L("await_get_spaces_end");const n=e.currentUser.id;if("success"===t.type)for(const[i,r]of Object.entries(t.data)){const t=o.PF.create(r);f.fL({environment:e,userId:i,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,recordMap:t,debugSource:"fetchAllUserSpaces"}),i===n&&(p.Z.setState({...p.Z.state,remoteSpaceInaccessiblePages:y(t,i)}),p.Z.state.readyPromise.resolve())}}function y(e,t){const n={};for(const{pointer:o}of e.getByTable(r.bx)){const a=o.id,s=e.getValue({table:r.bx,id:a});if(s){const o=new Set;if(s.pages){for(const t of s.pages){e.getValue({table:i.iU,id:t})||o.add(t)}n[t]||(n[t]={}),n[t][a]=o}}}return n}},39634:(e,t,n)=>{n.d(t,{j:()=>_,z:()=>S});var o=n(13991),i=n(24211),r=n(7250),a=n(7928),s=n(88642),l=n(97978),c=n(28020),d=n(79897),u=n(33929),p=n(58455),m=n(80444),f=n(77080),g=n(88280),h=n(25888),v=n(54642),b=n(98958),y=n(12714);function _(e){const{environment:t,from:n,prepopulatedContent:i}=e;h.Ot(t,{from:n});const a=(0,c.Fv)(),u=p.default.state;if(t.device.isMobileNative){const m=(0,c.B7)(t),g=`${t.device.os} v${t.device.mobileAppVersion}(${t.device.version})`,_="team@makenotion.com",w=`Help with my account ${null==m?void 0:m.getEmail()} on ${g}`,k=()=>{const e=encodeURIComponent(w);y.D({environment:t,url:`mailto:${_}?subject=${e}`})},I=t.mobileNative;I&&I.api.submitUserFeedback?I.submitUserFeedback({sendToEmailAddress:_,subject:w},k):k()}else if(u.isZendeskEnabled&&(0,l.Ug)()){const{userHighestPlanType:C,isSalesAssistedPlan:x}=(0,d.rf)(t);(0,s.g)({locale:o.SP,analyticsSettings:u,isForethoughtEnabled:f.default.checkGate("forethought"),forethoughtInitializeArgs:S(t),userHighestPlanType:C,isSalesAssistedPlan:x,cookieService:t.cookieService}),h.LS(t)}else if(u.isIntercomEnabled){function T(){if(a&&a.id)return v.annotateRecentIntercomConversation(t,{page:a})}let M=0;const P=3,A=60;async function R(){M++;const e=await T();e&&"success"===e.type&&"not_found"===e.data.status&&M<P&&setTimeout(R,A)}r.Nv({prepopulatedContent:i,waitForCssInsets:()=>b.waitForCssInsets(t)}),setTimeout(R,1e3*A)}}function S(e){var t,n,o;const r=u.default.getIntl(),s=null===(t=m.default.state.currentUserStore)||void 0===t?void 0:t.getValue(),l=s?(0,a.Nz)(r,s,!0):void 0,c=null===(n=g.subscriptionDataStoreInstance.state)||void 0===n?void 0:n.subscriptionTier,d=(null===(o=m.default.state.currentUserSettingsStore)||void 0===o||null===(o=o.getSettings())||void 0===o?void 0:o.preferred_locale)||i.al;return{fullName:l,email:null==s?void 0:s.email,planType:c,locale:d,cookieService:e.cookieService}}},1742:(e,t,n)=>{n.d(t,{BW:()=>g,GD:()=>f,sA:()=>h,uO:()=>b});n(57658);var o=n(68626),i=n(76870),r=n(19584),a=n(68056),s=n(77080),l=n(24666),c=n(10910);const d=!1,u=15*r.C0,p={user_flow_edit_block:.005,user_flow_edit_page_title:.01,user_flow_create_block:.01,user_flow_delete_block:.01};function m(e){if(d)return!0;const t=p[e];if(void 0!==t)return(0,i.aw)(t);const n=s.default.getConfigKey("event_trail_events",e);if("object"==typeof n&&"number"==typeof n.sampleRate)return(0,i.aw)(n.sampleRate);const o=s.default.getConfigKey("event_trail_events","defaultSampleRateUserFlows");return"number"==typeof o&&(0,i.aw)(o)}class f{constructor(e){this.stage=void 0,this.timeout=void 0,this.error=void 0,this.logDataInCaseOfFailure=void 0,this.postFinishCallbacks=[],this.environment=void 0,this.userFlow=void 0,this.entryPointName=void 0,this.handleTimeout=()=>{this.fail("timeout")};const{environment:t,userFlow:n,entryPointName:o,timeoutMs:i}=e;this.environment=t,this.userFlow=n,this.entryPointName=o;e.isEnabled??m(n)?(this.stage="inProgress",this.timeout=window.setTimeout(this.handleTimeout,i??u),this.debugLog("constructed")):this.stage="disable"}isDisabled(){return"disable"===this.stage}updateLogDataInCaseOfFailure(e){this.logDataInCaseOfFailure={...this.logDataInCaseOfFailure,...e}}succeed(){"inProgress"===this.stage&&this.finish("success")}fail(e){"inProgress"===this.stage&&(this.error=e,this.finish("fail"))}finish(e){this.stage=e,this.debugLog("finish"),"number"==typeof this.timeout&&window.clearTimeout(this.timeout),this.timeout=void 0,c.rT(this.environment,this.userFlow,{status:e,error:this.error,entryPointName:this.entryPointName}),"fail"===e&&o.log({level:"error",from:"userFlowActions",type:"userFlowFailed",data:{userFlow:this.userFlow,userFlowEntrypointName:this.entryPointName,userFlowError:this.error,...this.logDataInCaseOfFailure}});for(const t of this.postFinishCallbacks)t()}debugLog(){if(d){const o=this.entryPointName?`${this.userFlow}.${this.entryPointName}`:this.userFlow;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.groupCollapsed(`${this.constructor.name} ${o} stage=${this.stage}`,...t),console.trace(),console.groupEnd()}}}class g extends f{constructor(e){super(e),this.pointer=void 0,this.succeedOnEnqueue=void 0,this.trackCallbacks=[];const{succeedOnEnqueue:t}=e;this.succeedOnEnqueue=t}track(e,t){if("inProgress"===this.stage&&void 0===this.pointer){this.pointer=e,v({tracker:this,transaction:t,succeedOnEnqueue:this.succeedOnEnqueue});for(const e of this.trackCallbacks)e();this.debugLog("track",e.id)}}}class h extends g{constructor(e,t){super({environment:e,userFlow:"user_flow_create_page",entryPointName:t,succeedOnEnqueue:!1}),this.handleTextSelectionChange=e=>{"inProgress"===this.stage&&this.pointer&&"editing"===e.state.mode&&(0,a.qS)(e.state.multiSelection)&&e.state.multiSelection.start.store.pointer.id===this.pointer.id&&this.succeed()},"inProgress"===this.stage&&this.trackCallbacks.push((()=>{l.default.addListener(this.handleTextSelectionChange),this.postFinishCallbacks.push((()=>{l.default.removeListener(this.handleTextSelectionChange)}))}))}}function v(e){const{tracker:t,transaction:n,succeedOnEnqueue:o}=e;"inProgress"===t.stage&&(t.updateLogDataInCaseOfFailure({transactionId:n.id,transactionUserAction:n.getUserActionForAnalyticsPurposesOnly()}),n.annotateWithUserFlow(t.userFlow),n.postCancelCallbacks.push((()=>{t.fail("cancelled_transaction")})),n.postEnqueueActions.push((()=>{n.isEmpty()?t.fail("empty_transaction"):o&&t.succeed()})))}function b(e,t,n,o){if(!m(t))return;v({tracker:new f({environment:e,userFlow:t,isEnabled:!0,entryPointName:o}),transaction:n,succeedOnEnqueue:!0})}},37181:(e,t,n)=>{n.d(t,{$n:()=>k,GK:()=>_,Kq:()=>I,Nb:()=>b,Qm:()=>w,Y:()=>C,Zf:()=>h,d2:()=>g,dM:()=>S,fG:()=>f,rx:()=>v,zq:()=>y});n(57658);var o=n(79946),i=n(42875),r=n(95477),a=n(15010),s=n(95697),l=n(80444),c=n(6258),d=n(75769),u=n(11969),p=n(9953),m=n(13447);async function f(e){if(!r.default.isAdminMode)return;const{currentUserSettingsStore:t}=l.default.state;if(!t)return;await t.load();const n=t.getSettings();if(!n)return;const{device:o}=e,a={};(0,i.r)()!==n.time_zone&&(a.time_zone=(0,i.r)()),o.isDesktopBrowser&&!n.used_desktop_web_app&&(a.used_desktop_web_app=!0),o.isMobileBrowser&&!n.used_mobile_web_app&&(a.used_mobile_web_app=!0),o.isElectron&&o.isMac&&!n.used_mac_app&&(a.used_mac_app=!0),o.isElectron&&o.isWindows&&!n.used_windows_app&&(a.used_windows_app=!0),o.isMobileNative&&o.isIOS&&!n.used_ios_app&&(a.used_ios_app=!0),o.isMobileNative&&o.isAndroid&&!n.used_android_app&&(a.used_android_app=!0),Object.keys(a).length>0&&m.createAndCommit({userAction:"userSettingsActions.updateUserSettingsOnReset",environment:e,perform:e=>{g({userSettingsStore:t,data:a,transaction:e})}})}function g(e){const{userSettingsStore:t,data:n,transaction:o}=e;p.sW({store:t.getSettingsStore(),data:n,transaction:o})}function h(e){m.createAndCommit({userAction:"userSettingsActions.setStartWeekToMonday",environment:e,perform:e=>{const{currentUserSettingsStore:t}=l.default.state;t&&g({userSettingsStore:t,data:{start_day_of_week:1},transaction:e})}})}function v(e){m.createAndCommit({userAction:"userSettingsActions.setStartWeekToSunday",environment:e,perform:e=>{const{currentUserSettingsStore:t}=l.default.state;t&&g({userSettingsStore:t,data:{start_day_of_week:0},transaction:e})}})}function b(e){const{transaction:t,userSettingsStore:n,spaceId:o,type:i}=e;p.sO({store:(0,c._J)(n,n.pointer,["settings","sidebar_outliner_settings",o,i,"has_pinned"]),value:!0,transaction:t})}function y(e){var t;const n=null===(t=l.default.state.currentSpaceStore)||void 0===t?void 0:t.id,o=l.default.state.currentUserSettingsStore,{collectionId:i,dbType:r,transaction:a}=e;if(n&&o){var s,c;const e=(null===(s=o.getSettings())||void 0===s?void 0:s.lastUsedTypedCollections)||{},t=(null===(c=o.getSettings())||void 0===c?void 0:c.lastUsedDatabases)||{},l=e[n]||{},d=t[n]||[],u=r?l[r]??[]:[],p=[i,...u.filter((e=>e!==i))].slice(0,2),m=[i,...d.filter((e=>e!==i))].slice(0,5);g({userSettingsStore:o,transaction:a,data:{lastUsedDatabases:{...t,[n]:m},...r?{lastUsedTypedCollections:{...e,[n]:{...l,[r]:p}}}:{}}})}}function _(e){const{transaction:t,userSettingsStore:n,integrationId:o}=e;p.sO({store:(0,c._J)(n,n.pointer,["settings","dismissed_link_preview_integration_popup",o]),value:!0,transaction:t})}function S(e,t){const n=(0,o.SY)(),i=(0,o.Q3)();if(!n||!i)return;const r={};i&&(r.fbp=i),n&&(r.click_ids=n),m.createAndCommit({userAction:"userSettingsActions.persistAdClick",environment:e,perform:e=>{e.postSubmitCallbacks.push((e=>{e||((0,o.iI)(),(0,o.HR)())})),g({userSettingsStore:t,data:r,transaction:e})}})}function w(e){const t=l.default.state.currentUserSettingsStore;if(!t)return;const n=t.getKeyStore("settings").getKeyStore("seen_share_button_tooltip_at").getValue();Boolean(n)||m.createAndCommit({userAction:"dismissShareButtonTooltip",environment:e,userId:t.id,perform:e=>{g({userSettingsStore:t,data:{seen_share_button_tooltip_at:Date.now()},transaction:e})}})}function k(e){let{environment:t,teamId:n}=e;if(!d.Z.hasShownTootlip(n))return;if((0,s.wP)(t))return;const o=(0,a.WD)(t);if(!o)return!1;m.createAndCommit({userAction:"userSettingsActions.dismissTeamAddAppTemplateTooltip",environment:t,userId:o.id,perform:e=>{g({userSettingsStore:o,data:{seen_team_add_app_template_tooltip_at:Date.now()},transaction:e})}}),u.y(t,{from:"team_add_app_template"})}function I(e,t){const{phase:n,transactionUserAction:o,userSettingsStore:i}=t;m.createAndCommit({environment:e,userAction:o,perform:e=>{g({userSettingsStore:i,transaction:e,data:{enterprise_launch_modal_phase:n}})}})}function C(e){const t=(0,a.WD)(e);t&&m.createAndCommit({environment:e,userAction:"userSettingsActions.setDismissStudentOrgPrompt",perform:e=>{g({userSettingsStore:t,transaction:e,data:{dismissed_sidebar_student_org_prompt:!0}})}})}},65452:(e,t,n)=>{n.d(t,{h:()=>g,l:()=>h});n(21703);var o=n(15157),i=n(44615),r=n(45953),a=n(21202),s=n(53965),l=n(37850),c=n(45950),d=n(5659),u=n(2688),p=n(92425),m=n(54642),f=n(4408);async function g(e){const{environment:t,userId:n,spaceId:o}=e,r=(0,i.NP)({userId:n,spaceId:o});if(!y||y!==r){let n;!function(e){b&&u.ZP.removeListener(b,e)}(t);const o=(t,o)=>{void 0!==n&&n!==o&&h(e),n=o},i=s.P2(o,5e3);b=u.ZP.addListener(r,i,void 0,t),y=r;if(!p.Z.getSharedPagesState(e))return h(e)}}async function h(e){const{environment:t,userId:n,spaceId:i}=e,s=p.Z.getSharedPagesState(e);if(s&&s.loadingDone)return s.loadingDone;const u=(0,l.UZ)();p.Z.setSharedPagesState({spaceId:i,userId:n,state:{currentPageIds:null==s?void 0:s.currentPageIds,loadingDone:u.promise}});try{const s=async function*(e,t,n){try{const n=await d.A.measure("loadUserSharedPages","(current user)",(()=>async function(e,t){const{id:n}=e.currentUser;if(!n)throw new Error("Must be logged in.");if(!e.defaultRecordCache.persistedRecordCache)throw new Error("No local database found.");const i=o.Z.get({userId:n,key:v({userId:n,spaceId:t.spaceId})})||void 0;if(!i)throw new Error("No local shared pages found.");const r=await c.yY({environment:e,recordPointers:i.map((e=>({table:a.iU,id:e}))),recurFn:()=>[],recordIsRequired:()=>!1});return{pages:i,recordMap:r.toJson({allowVersionDowngrade:!1})}}(e,{spaceId:t})));f.fL({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,recordMap:r.PF.create(n.recordMap),debugSource:"loadUserSharedPagesInSpace"}),yield n}catch(s){}const i=await m.getUserSharedPagesInSpace(e,{spaceId:t,includeDeleted:!0},n);"success"===i.type&&(e.defaultRecordCache.persistedRecordCache&&o.Z.set({userId:e.currentUser.id,key:v({userId:n,spaceId:t}),value:i.data.pages}),yield i.data)}(t,i,n);for await(const e of s)p.Z.setSharedPagesState({spaceId:i,userId:n,state:{currentPageIds:e.pages,loadingDone:u.promise}});const l=p.Z.getSharedPagesState(e);l&&l.currentPageIds?p.Z.setSharedPagesState({spaceId:i,userId:n,state:{currentPageIds:l.currentPageIds,loadingDone:void 0}}):p.Z.setSharedPagesState({spaceId:i,userId:n,state:void 0})}catch(g){p.Z.setSharedPagesState({spaceId:i,userId:n,state:void 0})}}function v(e){return`UserSharedPagesInSpace:${e.userId}:${e.spaceId}`}let b,y},9377:(e,t,n)=>{n.d(t,{E:()=>S,j:()=>w});n(1898);var o=n(12847);n(50202);const i=["2021-05-11","2021-05-13","2021-08-16","2022-02-22","2022-06-28"],r=i[i.length-1];o.literals(...i);var a=n(77420),s=n(19889),l=n(35794),c=n(9291),d=n(7032),u=n(57549),p=n(33929),m=n(80444),f=n(77080),g=n(6258),h=n(54642),v=n(47307),b=n(9953),y=n(13447);const _=(0,c.defineMessages)({webhookUrlError:{id:"webhookActions.webhookUrlError",defaultMessage:"Connection failed. Please wait and try again or try another URL."}});async function S(e){const{environment:t,integration:n,webhookUrl:o,webhookSecret:i,webhookSubscriptionId:c,onError:f,onSuccess:S=(()=>{})}=e,{currentUserRootStore:w,currentSpaceStore:k}=m.default.state;if(!w||!k)return{error:{success:!1}};if("failed"===(await h.testWebhookConnection(t,{integrationId:n.id,webhookUrl:o,webhookSecret:i||void 0})).type)return v.showErrorMessage(p.default.formatMessage(_.webhookUrlError)),{error:{success:!1}};const{serverCommitResult:I}=y.createAndCommit({userAction:"webhookActions.createWebhookSubscription",environment:t,perform:p=>{p.postSubmitCallbacks=[f];const h=Date.now(),v=k.id;if(e.webhookSubscriptionId){const e=m.default.state.currentSpaceStore,r=c&&e?g.n4.createChildStore(e,{id:c,table:l.bf,spaceId:e.id}):void 0;if(r){const e=r.getWebhookUrl()!==o,a=r.getWebhookSecret()!==i;(e||a)&&(u.AS(t,{integration_id:n.id,has_updated_webhook_url:e||void 0,has_updated_webhook_secret:a||void 0}),b.sW({transaction:p,data:{webhook_url:o,webhook_secret:i,health:{status:"active"}},store:r}))}}else{const e=d.ZP();b.ae({environment:t,table:a.cZ,value:{id:e,space_id:v,parent_id:k.id,parent_table:"space",type:"external",alive:!0,name:n.getName(),icon:n.getInfo().icon,integration_id:n.id,capabilities:n.getCapabilities(),created_at:h,last_edited_at:h,last_edited_by_id:w.id,created_by_id:w.id,created_by_table:s.KJ,last_edited_by_table:s.KJ},inMemoryRecordCache:k.inMemoryRecordCache,transaction:p}),b.ae({environment:t,table:l.bf,value:{id:d.ZP(),bot_id:e,space_id:v,parent_id:k.id,api_version:r,webhook_url:o,webhook_secret:i,parent_table:"space",last_edited_time:h,last_edited_by_id:w.id,created_by_id:w.id,created_time:h,created_by_table:s.KJ,last_edited_by_table:s.KJ,health:{status:"active"}},inMemoryRecordCache:k.inMemoryRecordCache,transaction:p}),u.eR(t,{integration_id:n.id,configuration_type:"manual",bot_id:e})}}});return await I,S(),{value:{success:!0}}}async function w(e){const t=f.default.checkGate("webhooks_beta"),{environment:n,spaceId:o}=e;if(!n.currentUser.isLoggedIn()||!t)return{webhookSubscriptionIds:[],recordMap:{}};const i=await h.getWebhookSubscriptions(n,{spaceId:o});if("failed"===i.type)throw i.error;return i.data}},12304:(e,t,n)=>{n.d(t,{Cq:()=>F,Y:()=>B,Zi:()=>E});n(67294);var o=n(92996),i=n(46283),r=n(41432),a=n(72141),s=n(21202),l=n(6287),c=n(13493),d=n(70203),u=n(49902),p=n(9291),m=n(7032),f=n(15828),g=n(75330),h=n(6854),v=n(97978),b=n(28020),y=n(65183),_=n(33929),S=n(45010),w=n(77080),k=n(6258),I=n(1310),C=n(47307),x=n(9953),T=n(64964),M=n(993),P=n(13447),A=n(68422),R=n(73060),D=n(85893);const E=(0,p.defineMessages)({home:{id:"wikiActions.collectionView.home",defaultMessage:"Home"},allPages:{id:"wikiActions.collectionView.allPages",defaultMessage:"All pages"},pagesIOwn:{id:"wikiActions.collectionView.pagesIOwn",defaultMessage:"Pages I own"},pagePropertyName:{id:"wikiActions.collectionView.pagePropertyName",defaultMessage:"Page"},ownerPropertyName:{id:"wikiActions.collectionView.ownerPropertyName",defaultMessage:"Owner"},tagsPropertyName:{id:"wikiActions.collectionView.tagsPropertyName",defaultMessage:"Tags"},tagsDesignValue:{id:"wikiActions.collectionView.tagsDesignValue",defaultMessage:"Design"},tagsOnboardingValue:{id:"wikiActions.collectionView.tagsOnboardingValue",defaultMessage:"Onboarding"},verificationPropertyName:{id:"wikiActions.collectionView.verificationPropertyName",defaultMessage:"Verification"},undoToast:{id:"wikiActions.convertToWiki.undo.toastMessage",defaultMessage:"Turned {pageName} into a wiki"}});function B(e){const{blocks:t,transaction:n,environment:a,source:u}=e,p=(0,m.ZP)(),g=t[0];if(!g||!g.isPageBlock())return;const C=g.getSpaceId(),M=(0,m.ZP)(),A=g.getFormat().page_icon,B=(0,f.ZP)(),O=i.k.Owner,Z=(0,f.ZP)(),V=(0,f.ZP)(),U={title:{name:_.default.formatMessage(E.pagePropertyName),type:"title"},[O]:{name:_.default.formatMessage(E.ownerPropertyName),type:"person",default:"created_by"},[V]:{name:_.default.formatMessage(E.tagsPropertyName),type:"multi_select",options:[{id:(0,m.ZP)(),value:_.default.formatMessage(E.tagsOnboardingValue),color:"blue"},{id:(0,m.ZP)(),value:_.default.formatMessage(E.tagsDesignValue),color:"green"}]},[B]:{name:y.SO.last_edited_time,type:"last_edited_time",date_format:"relative"}},L=[{visible:!0,property:"title",width:300},{visible:!0,property:O,width:150},{visible:!0,property:Z,width:150},{visible:!0,property:V,width:150},{visible:!0,property:B,width:250}];U[Z]={name:_.default.formatMessage(E.verificationPropertyName),type:"verification",verifier_property:O};const j={table:l.vF,id:M,spaceId:C};P.applyOperation({store:(0,k.Kv)(g,j),operation:{pointer:j,command:"set",path:[],args:{id:M,version:0,parent_table:s.iU,parent_id:g.id,space_id:C,name:g.getTitleValue(),schema:U,cover:g.getFormat().page_cover,format:{collection_mode:{type:"page_tree",root_page_pointer:{table:s.iU,id:g.id,spaceId:C}},app_config_uri:o.GZ,property_visibility:[{property:B,visibility:"hide"},{property:V,visibility:"show"},{property:O,visibility:"show"},{property:Z,visibility:"show"}],collection_page_properties:L,collection_cover_position:g.getFormat().page_cover_position},icon:A,alive:!0}},transaction:n});const N=(0,m.ZP)(),z=(0,m.ZP)(),q=(0,m.ZP)();x.sW({store:g,data:{type:r.Ti.collectionViewPage,collection_id:M,view_ids:[N,z,q]},transaction:n}),x.sW({store:g.getFormatStore(),data:{collection_pointer:j,app_config_uri:o.jh,app_uri_map:{[o.GZ]:M},app_id:p},transaction:n});const W={table:c.np,id:N,spaceId:C};P.applyOperation({store:(0,k.Kv)(g,W),operation:{pointer:W,command:"set",path:[],args:{id:N,version:0,type:"page",name:_.default.formatMessage(E.home),parent_id:g.id,parent_table:"block",space_id:C,format:{page_pointer:{id:(0,m.Mt)(g.id),spaceId:C,table:"block"}},alive:!0}},transaction:n});const H={table:c.np,id:z,spaceId:C};P.applyOperation({store:(0,k.Kv)(g,H),operation:{pointer:H,command:"set",path:[],args:{id:z,version:0,type:"table",name:_.default.formatMessage(E.allPages),parent_id:g.id,parent_table:"block",space_id:C,format:{table_properties:L},query2:{sort:[{property:B,direction:"descending"}]},alive:!0}},transaction:n});const K={table:c.np,id:q,spaceId:C};P.applyOperation({store:(0,k.Kv)(g,K),operation:{pointer:K,command:"set",path:[],args:{id:q,version:0,type:"table",name:_.default.formatMessage(E.pagesIOwn),parent_id:g.id,parent_table:"block",space_id:C,format:{table_properties:L,property_filters:[{id:(0,m.ZP)(),filter:{filter:{value:{type:"relative",value:"me"},operator:"person_contains"},property:O}}]},query2:{sort:[{property:B,direction:"descending"}]},alive:!0}},transaction:n});const G=S.Z.PageScroller;G&&G.scrollToTop({animate:!0}),R.rm(n),function(e,t){v.j(e,"wiki_convert",t),w.default.logEvent("wiki_convert",void 0,t)}(a,{source:u,root_page_id:g.id,collection_id:M}),function(e){const{environment:t,blocks:n}=e,o=n[0];if(!o||!o.isCollectionViewPageWithContent())return;const i=(0,d.QaF)(o.getTitleValue());I.ZP.setState({...I.ZP.state,shouldReset:!1});const r=(0,b.zj)()===o.id;T.oV({label:_.default.formatMessage(E.undoToast,{pageName:i}),durationMs:I.JY,right:(0,D.jsx)(h.wr,{blockStoreToOpen:r?void 0:o,performUndo:()=>{P.createAndCommit({userAction:"wikiActions.wikiConversionToast.undo",environment:t,perform:e=>{T.rN(),F({environment:t,blocks:n,transaction:e,source:"snackbar"})}})}})})}({environment:a,blocks:t})}function F(e){var t;const{environment:n,blocks:o,transaction:i,source:s}=e,l=o[0];if(!l||!l.isCollectionView())return void C.deprecatedShowErrorMessage("Something went wrong");const c=l.getFormat().collection_pointer;if(!c)return void C.deprecatedShowErrorMessage("Something went wrong");const d=k.NW.createChildStore(l,c),p=null===(t=l.getCover())||void 0===t?void 0:t.cover,m=d.getFormat().collection_cover_position,f=d.getName();A.vs({environment:n,block:l,blockType:r.Ti.page,transaction:i}),x.sW({store:l.getFormatStore(),data:{app_config_uri:null,app_uri_map:null,app_id:null,page_cover:p??null,page_cover_position:m??null},transaction:i}),M.sO({environment:n,editorMode:"default",store:l.getBlockTitleStore(),value:f,transaction:i});for(const r of l.getPermissionItems())if(a.C2(r)&&a.WY(r.role)&&!a.FB(r)){const e={...r,role:"read_and_write"};P.applyOperation({store:l.getPermissionItemsStore(),operation:{pointer:l.pointer,command:"setPermissionItem",path:l.getPermissionItemsStore().path,args:e},transaction:i})}g.A9({collectionViewBlockStore:l,collectionStore:d,transaction:i}),function(e,t){v.j(e,"wiki_undo_conversion",t),w.default.logEvent("wiki_undo_conversion",void 0,t),u.j({name:"wiki_undo_conversion",args:t})}(n,{source:s,root_page_id:l.id,collection_id:c.id})}},73060:(e,t,n)=>{n.d(t,{B1:()=>s,FO:()=>c,Rg:()=>l,nX:()=>u,rm:()=>d});var o=n(28182),i=n(80444),r=n(13447),a=n(37181);function s(){const{currentUserSettingsStore:e}=i.default.state;if(!e||!e.isReady())return;const t=e.getSettings();return t?t.wiki_onboarding_phase??"unseen":void 0}function l(e){const t=s();if(void 0===t)return;const n=o.dF.indexOf(t);if(-1!==n&&n<o.dF.length-1){const{currentUserSettingsStore:t}=i.default.state;if(!t)return;r.createAndCommit({userAction:"wikiOnboardingActions.advanceOnboardingStep",environment:e,perform:e=>{a.d2({userSettingsStore:t,transaction:e,data:{wiki_onboarding_phase:o.dF[n+1]}})}})}}function c(e){const t=s();if(void 0===t)return;const n=o.dF.indexOf(t);if(-1!==n&&n>1){const{currentUserSettingsStore:t}=i.default.state;if(!t)return;r.createAndCommit({userAction:"wikiOnboardingActions.previousOnboardingStep",environment:e,perform:e=>{a.d2({userSettingsStore:t,transaction:e,data:{wiki_onboarding_phase:o.dF[n-1]}})}})}}function d(e){const{currentUserSettingsStore:t}=i.default.state;t&&"unseen"===s()&&a.d2({userSettingsStore:t,transaction:e,data:{wiki_onboarding_phase:"home"}})}function u(e){if("complete"===s())return;const{currentUserSettingsStore:t}=i.default.state;t&&r.createAndCommit({userAction:"wikiOnboardingActions.completeOnboarding",environment:e,perform:e=>{a.d2({userSettingsStore:t,transaction:e,data:{wiki_onboarding_phase:"complete"}})},userId:t.id})}},89626:(e,t,n)=>{n.d(t,{ON:()=>m,__:()=>u,h1:()=>f,lZ:()=>h,sy:()=>p,w9:()=>g});n(21703);var o=n(67294),i=n(480),r=n(49085),a=n(66673),s=n(28182),l=n(13447),c=n(37181),d=n(80444);const u=r.default.createValue(void 0);function p(){const{currentUserSettingsStore:e}=d.default.state;if(!e||!e.isReady())return;const t=e.getSettings();return t?t.ai_onboarding_phase??"space_for_ai":void 0}function m(e){"space_for_ai"===p()&&f(e)}function f(e){const t=p();if(void 0===t)throw new Error("Assertion failure, AI onboarding state is undefined!");const n=s.AQ.indexOf(t);if(-1===n)throw new Error(`Assertion failure, ${t} is not a valid AI onboarding state!`);if(n<s.AQ.length-1){const{currentUserSettingsStore:t}=d.default.state;if(!t)return;l.createAndCommit({userAction:"AiOnboardingActions.advanceAIOnboardingStage",environment:e,perform:e=>{c.d2({userSettingsStore:t,transaction:e,data:{ai_onboarding_phase:s.AQ[n+1]}})},userId:t.id})}}function g(e){const t=(0,i.O7)(),n="completionPopup"===e.type&&"results"===e.stage&&!e.loading,r=(0,a.D9)(n);(0,o.useEffect)((()=>{r&&!n&&"refine_ai_response"===p()&&f(t)}),[n,r,t])}function h(e){const t=(0,i.O7)(),n="results"===e.stage&&e.loading,r=(0,a.D9)(n);(0,o.useEffect)((()=>{n&&!r&&"ask_ai_anything"===p()&&f(t)}),[n,r,t])}},63594:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n(49085).default.createValue(!0)},4437:(e,t,n)=>{n.d(t,{k6:()=>M,MR:()=>R,mO:()=>C,x:()=>x,qJ:()=>A,b_:()=>k,N2:()=>I,is:()=>T,Is:()=>P});n(57658),n(21703);function o(e){return"action"===e.type?e.humanStepMessage:"question"===e.type?e.question:void 0}var i=n(21202),r=n(70203),a=n(98151),s=n(76870),l=n(7032),c=n(1898),d=n(54642),u=n(77907),p=n(74948),m=n(36391),f=n(41747),g=n(80444),h=n(21273),v=n(98180),b=n(77080),y=n(69327),_=n(6258),S=n(57819);function w(e){try{let{environment:t,type:n,inputs:o}=e;return async function*(e){const i=null===(e=g.default.state.currentSpaceStore)||void 0===e?void 0:e.id;if(!i)return;const r=await d.streamCascadeInference(t,{type:n,inputs:o,spaceId:i,aiSessionId:(0,l.ZP)()});if("success"===r.type&&a.H1.is(r.data))for await(const t of r.data){if("error"===t.type)return;yield t.output}}()}catch(t){return Promise.reject(t)}}async function k(e){let{environment:t,type:n,inputs:o}=e;for await(const i of w({environment:t,type:n,inputs:o}))return i}function I(e){let{environment:t,blockStore:n}=e;if(f.Z.state.loadingState.pageId===n.id)return;if(!h.Z.isAiContextSuggestionsEnabled())return;const o=b.default.getConfigKey("dev_ai_context","suggestOnPageNavigationProbability");(0,s.aw)(o)&&C({environment:t})}async function C(e){let{environment:t}=e;const n=g.default.state.currentSpaceStore,o=g.default.state.currentUserStore;if("loading"===f.Z.state.loadingState.type||!n||!o)return;const r=g.default.state.mainEditorCurrentBlockStore,a=null==n?void 0:n.id,s=y.Z.get(a);if(!s)return;const d=[r,...s.map((e=>_.G.createChildStore(null==n?void 0:n.getPagesStore(),{table:i.iU,id:e.pageId,spaceId:a})))].filter(c.$K).slice(0,10).map((e=>(0,S.yR)(t,e)));try{f.Z.setState({...f.Z.state,loadingState:{type:"loading",pageId:(null==r?void 0:r.id)??void 0}});const e=await k({environment:t,type:"contextSuggestions",inputs:[{recentPages:d}]});e&&f.Z.setState({...f.Z.state,initialSuggestions:e.map((e=>{let{goal:t,suggestions:n}=e;return{type:"server",clientId:(0,l.ZP)(),title:t,suggestions:n.map((e=>({clientId:(0,l.ZP)(),...e})))}}))})}finally{f.Z.setState({...f.Z.state,loadingState:{type:"loaded",pageId:null==r?void 0:r.id}})}}async function x(e){let{environment:t,blockStore:n,topicClientId:o}=e;const i=g.default.state.currentSpaceStore,r=g.default.state.currentUserStore;if("loading"!==f.Z.state.loadingState.type&&i&&r)try{f.Z.setTopicLoading(o,"loading");const e=f.Z.getTopicByClientId(o);if(!e)return;const{title:i,content:r}=(0,S.yR)(t,n),a=await k({environment:t,type:"topicBrief",inputs:[{topic:e.title,title:i,content:r}]});if(!a)return;f.Z.setTopic(o,{...e,loadingState:"loaded",...a})}catch(a){f.Z.setTopicLoading(o,"initial")}}function T(e){let{environment:t,title:n}=e;f.Z.createTopicCard(n),m.ZP.state.expanded&&m.ZP.state.currentTab===m.gY.AiContext||(m.ZP.setState({...m.ZP.state,currentTab:m.gY.AiContext}),(0,p.setUpdateExpand)({environment:t,isExpanded:!0,from:"topbar"}))}function M(){f.Z.setState({...f.Z.state,initialSuggestions:[]})}async function P(e){var t;let{environment:n,suggestion:i}=e;const a=await u.deps.assistant.loader();let s;if("action"===i.type){const e=i.skillType;s=a.clientSkillHelpers.getClientSkills().find((t=>t.skillType===e))}else s=void 0;a.assistantMenuActions.navigateToView({view:"chat"});const{sessionId:c}=await a.assistantActions.resetAndInitializeAssistantSession({environment:n,clientSkill:s,skillSettings:{}}),d=o(i);d&&await a.handleSubmitNewQuestion({newValue:(0,r.TPx)(d),environment:n,currentSkill:s,source:"ai_context_suggested_question"}),null!==(t=s)&&void 0!==t&&null!==(t=t.inAppSkillTrigger)&&void 0!==t&&t.requiresInput||await a.assistantActions.sampleNextAssistantSteps({environment:n,sessionId:c,inferenceId:(0,l.ZP)()})}async function A(e){let{environment:t,suggestion:n}=e;const i=await u.deps.assistant.loader();if("action"===n.type&&void 0!==n.skillType)throw new Error("Follow-up actions may not contain a skillType");const a=v.Z.getActiveSessionId();if(a){const e=o(n);i.assistantActions.commitHumanStep({environment:t,text:(0,r.TPx)(e),sessionId:a,source:"ai_context_suggested_question"})}}async function R(e){let{sessionContext:t,environment:n,transcript:o}=e;const i=await k({environment:n,type:"followupSuggestions",inputs:[{transcript:o}]});i&&t.setFollowupSuggestions(i.map((e=>({clientId:(0,l.ZP)(),...e}))))}},92022:(e,t,n)=>{n.r(t),n.d(t,{closeInitialPromptAndEndSession:()=>y,closeInitialPromptButContinueSession:()=>_,openHelpMeWriteGenericPopup:()=>k,retryInitialPrompt:()=>b,showInitialPromptForAIBlock:()=>S,toggleInitialPrompt:()=>w});var o=n(7032),i=n(10910),r=n(54642),a=n(84084),s=n(98104),l=n(78663),c=n(19124),d=n(68056),u=n(80444),p=n(21273),m=n(16772),f=n(27724),g=n(24666),h=n(89626);function v(e){"completionPopup"!==e.type&&"assistantCompletionPopup"!==e.type||"initialPrompt"!==e.stage||"textSelection"!==e.context.type&&"cursor"!==e.context.type||s.NA({multiSelection:e.context.textSelection})}function b(e){m.default.invalidateLastUpdater();const{environment:t}=e,{state:n}=m.default;if("completionPopup"!==n.type||"results"!==n.stage)return;t.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(n.inMemoryRecordCache);const o={type:"completionPopup",stage:"initialPrompt",prefilledValue:"",context:n.context,sessionId:n.sessionId,from:n.from,futureRevisions:[...n.revisions,...n.futureRevisions]};m.default.setState(o)}function y(){v(m.default.state),m.default.setState({type:"closed"})}function _(){const{state:e}=m.default;v(e),"completionPopup"===e.type&&"initialPrompt"===e.stage&&m.default.setState({type:"closedWithContext",context:e.context,sessionId:e.sessionId,futureRevisions:e.futureRevisions}),setTimeout((()=>{"closedWithContext"===m.default.state.type&&m.default.reset()}),1)}function S(e){m.default.setState({...e,type:"completionPopup",stage:"initialPromptForAIBlock",from:"ai_block",prefilledValue:"",sessionId:(0,o.ZP)()}),I({environment:e.environment,promptForAnalytics:e.clientPrompt})}function w(e){const{environment:t,from:n}=e;let{context:i,prefilledValue:a,sessionId:s}=e,c={type:"closed"};if("closed"===m.default.state.type||"closedWithContext"===m.default.state.type){if(!i&&f.default.state.stores.length>0){const e=g.default.state;i="empty"===e.mode?(0,l.Xc)():(0,d.iG)(e.multiSelection)?(0,l.FD)():(0,l.Fu)()}i&&(a||(a=""),s||(s=(0,o.ZP)()),c=p.Z.isAssistantInWriterEnabled(t.device)?{type:"assistantCompletionPopup",stage:"initialPrompt",context:i,from:n,sessionId:s,loading:!1,hasErrored:!1}:{type:"completionPopup",stage:"initialPrompt",context:i,from:n,prefilledValue:a,sessionId:s,futureRevisions:[]},u.default.state.currentSpaceStore&&r.publishAiSession(t,{inference_type:"writer",spaceId:u.default.state.currentSpaceStore.id,id:c.sessionId,metadata:{from:n}}),"spacebar"===n&&(0,h.ON)(t))}m.default.setState(c),I(e)}function k(e){const{title:t,environment:n}=e,i=(0,l.FD)();if(!i)return;const r=t?(0,c.qB)({customPrompt:t,isPageEmpty:!0}):c.eL;w({environment:n,from:"page_menu",prefilledValue:(0,l.$W)(r),promptForAnalytics:r,sessionId:(0,o.ZP)(),context:i})}function I(e){const{environment:t,promptForAnalytics:n}=e,{state:o}=m.default;"completionPopup"!==o.type&&"assistantCompletionPopup"!==o.type||"results"===o.stage||("initialPromptForAIBlock"!==o.stage&&s.ZH(t),i.Tl(t,{session_id:o.sessionId,prompt_key:(null==n?void 0:n.key)??("completionPopup"!==o.type||o.prefilledValue?"unknown":"alternative_ui_empty_input"),from:o.from}),a.xv())}},71184:(e,t,n)=>{n.d(t,{Gl:()=>l,JS:()=>c,QC:()=>d,gC:()=>s,kg:()=>u});n(30541);var o=n(7032),i=n(37181),r=n(30793);function a(e,t){return e.id===t.id}function s(e,t,n){const o=c(t).slice(),s=o.findIndex((t=>a(e,t)));-1===s?o.unshift(e):o.splice(s,1,e),(0,r.lG)(e.action,t,n),i.d2({userSettingsStore:t,transaction:n,data:{favorite_ai_actions:o}})}function l(e,t){for(const n of c(e))if((0,r.YK)(n.action,t))return n}function c(e){var t;return(null===(t=e.getModel())||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.favorite_ai_actions)??[]}function d(e,t,n){const o=c(t).filter((t=>!a(t,e)));i.d2({userSettingsStore:t,transaction:n,data:{favorite_ai_actions:o}})}function u(e){return{id:(0,o.ZP)(),name:e.promptTitle??"",action:{...e,promptTitle:void 0}}}},62878:(e,t,n)=>{n.r(t),n.d(t,{importGtmFavorite:()=>f});n(67294);var o=n(9291),i=n(10910),r=n(47307),a=n(64964),s=n(13447),l=n(80444),c=n(71184),d=n(24405),u=n(85893);function p(e){const{favorite:t,isReplacingFavorite:n}=e,i=(0,d.yK)((e=>({title:{fontWeight:700,marginBottom:"1em"},prompt:{color:e.lightTextColor,maxHeight:"5em",overflowY:"scroll",whiteSpace:"pre-wrap"}})),[]),r=n?(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Overwrite â€œ{favoriteName}â€ AI action?",id:"ai.favoriteActions.importFavorite.overwriteMessage",values:{favoriteName:t.name}}):(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Add â€œ{favoriteName}â€ AI action?",id:"ai.favoriteActions.importFavorite.addMessage",values:{favoriteName:t.name}}),a=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"â€œ{favoritePrompt}â€",id:"ai.favoriteActions.importFavorite.prompt",values:{favoritePrompt:t.action.prompt}});return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{style:i.title,children:r}),(0,u.jsx)("div",{style:i.prompt,children:a})]})}var m=n(13555);async function f(e){const{environment:t}=e,n=await(0,m.cx)({environment:t,blockId:e.importArgs.blockId});"error"!==n.type?await async function(e){const{environment:t,newFavorite:n}=e,{currentUserSettingsStore:d}=l.default.state;if(!d)return;const m=(0,c.JS)(d);let f=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Add AI action",id:"ai.favoriteActions.importFavorite.addAction"}),g=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Cancel",id:"ai.favoriteActions.importFavorite.cancelAction"}),h=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"â€œ{favoriteName}â€ AI action added to your Favorites.",id:"ai.favoriteActions.importFavorite.favoriteAdded",values:{favoriteName:n.name}}),v=!1;for(const i of m)if(i.name===n.name){if(i.action.type===n.action.type&&i.action.prompt===n.action.prompt)return void a.oV({label:(0,u.jsx)(o.FormattedMessage,{defaultMessage:"â€œ{favoriteName}â€ AI action is already in your Favorites.",id:"ai.favoriteActions.importFavorite.alreadyInFavorites",values:{favoriteName:n.name}})});n.id=i.id,v=!0,f=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Overwrite existing AI action",id:"ai.favoriteActions.importFavorite.overwriteAction"}),g=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Keep existing AI action",id:"ai.favoriteActions.importFavorite.keepExistingAction"}),h=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"â€œ{favoriteName}â€ AI action updated in your Favorites.",id:"ai.favoriteActions.importFavorite.favoriteUpdated",values:{favoriteName:n.name}});break}if(!(await r.confirmUserAction({message:(0,u.jsx)(p,{favorite:n,isReplacingFavorite:v}),acceptLabel:f,cancelLabel:g})))return;s.createAndCommit({userAction:"favoriteActions.handleFavoriteImport",environment:t,perform(e){(0,c.gC)(n,d,e)}}),a.oV({label:h}),i.Vo(t,{type:"create_from_url",session_id:void 0,gtm_favorite_id:n.gtmFavoriteId})}({environment:t,newFavorite:n.favorite}):a.oV({label:(0,u.jsx)(o.FormattedMessage,{defaultMessage:"An error occurred when loading the AI action. ({errorCode})",id:"ai.favoriteActions.importFavorite.favoriteFailedToLoad",values:{errorCode:n.code}})})}},13555:(e,t,n)=>{n.d(t,{OF:()=>f,cx:()=>v});var o=n(45953),i=n(70203),r=n(7032),a=n(54642),s=(n(95477),n(77080));let l=function(e){return e[e.NoConfig=100]="NoConfig",e[e.LoadPageChunkFailed=101]="LoadPageChunkFailed",e[e.MissingPageRecord=103]="MissingPageRecord",e[e.InvalidPageParent=104]="InvalidPageParent",e[e.MissingTitle=105]="MissingTitle",e[e.MissingPromptText=106]="MissingPromptText",e[e.MissingCollectionSchema=107]="MissingCollectionSchema",e[e.MissingPromptType=108]="MissingPromptType",e[e.InvalidPromptType=109]="InvalidPromptType",e[e.FavoritesDisabled=110]="FavoritesDisabled",e}({});const c="Prompt type",d="Prompt text",u="Run immediately",p="Help me write",m="Help me edit";function f(){{const e=s.default.getConfigKey("gtm_ai_favorites","space_id"),t=s.default.getConfigKey("gtm_ai_favorites","collection_id");if(e&&t)return{spaceId:e,collectionId:t}}}function g(e,t,n){const o=function(e,t,n){for(const i in e){const r=e[i];var o;if(r&&r.name===n)return null===(o=t.properties)||void 0===o?void 0:o[i]}}(e,t,n);if(o)return(0,i.Jcv)(o)}function h(e){return{type:"error",code:e}}async function v(e){var t;const{environment:n,blockId:v}=e;if(await s.default.waitUntilStatsigReady(),!s.default.checkGate("ai_favorites"))return h(l.FavoritesDisabled);const b=f();if(!b)return h(l.NoConfig);const{spaceId:y,collectionId:_}=b,S=await a.loadCachedPageChunk(n,{page:{spaceId:y,id:v},limit:0,chunkNumber:0,cursor:{stack:[]},verticalColumns:!1});if("success"!==S.type)return h(l.LoadPageChunkFailed);const w=o.PF.create(S.data.recordMap),k=w.getValue({table:"block",id:v,spaceId:y});if(!k)return h(l.MissingPageRecord);if(k.parent_id!==_)return h(l.InvalidPageParent);const I=(0,i.Jcv)(null===(t=k.properties)||void 0===t?void 0:t.title);if(!I)return h(l.MissingTitle);const C=await async function(e){const{environment:t,recordMap:n,blockId:o,spaceId:i,collectionId:r}=e,s=n.getValue({table:"collection",id:r,spaceId:i});if(null!=s&&s.schema)return s.schema;const l=await a.getPublicPageData(t,{type:"block-space",blockId:o,spaceId:i});return"failed"!==l.type?l.data.collectionSchema:void 0}({environment:n,recordMap:w,blockId:v,spaceId:y,collectionId:_});if(!C)return h(l.MissingCollectionSchema);const x=g(C,k,d);if(!x)return h(l.MissingPromptText);const T=g(C,k,c);if(!T)return h(l.MissingPromptType);const M=(P=T)===m?"helpMeEdit":P===p?"helpMeWrite":void 0;var P;if(!M)return h(l.InvalidPromptType);const A=function(e,t,n){return"Yes"===g(e,t,n)}(C,k,u);return{type:"success",favorite:{id:(0,r.ZP)(),name:I,executeImmediately:A,gtmFavoriteId:v,action:{type:M,prompt:x,promptTitle:void 0}}}}},57819:(e,t,n)=>{n.d(t,{$b:()=>I,Dj:()=>x,RR:()=>_,Tq:()=>k,VZ:()=>S,bJ:()=>y,jq:()=>C,rR:()=>w,yR:()=>T});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(42875),l=n(66673),c=n(82883),d=n(1898),u=n(893),p=n(56518),m=n(43455),f=n(33929),g=n(89224),h=n(80444),v=n(17903),b=n(42057);function y(){const e=(0,i.O7)(),t=(0,r.VK)((()=>e.device.isPhone),[e]);return(0,a.yK)((e=>{const n="dark"===e.mode?e.accentColors.purple[900]:e.accentColors.purple[400];return{purpleButton:{padding:4,fontWeight:600,color:n},keyboardShortcut:{textTransform:"uppercase",fontWeight:500,fontSize:11,marginLeft:6,color:e.lightTextColor,display:t?"none":void 0},lightweightButton:{display:"flex",alignItems:"baseline",justifyContent:"center",fontSize:14,padding:"5px 8px",borderRadius:4,color:e.mediumTextColor,height:32,marginTop:2},returnIndicatorIconStyles:{width:14,height:14,paddingLeft:4,fill:e.lightIconColor},keyboardShortcutInverted:{color:e.mediumInvertedTextColor,paddingLeft:4},writingLabel:{flex:1,color:n,fontWeight:500,flexDirection:"row",gap:6,display:"flex",alignItems:"center"},inputActions:{height:36,display:"flex",alignSelf:"flex-end",alignItems:"center"},loadingDots:{backgroundColor:n}}}),[t])}function _(e){if("completionPopup"===e.type||"assistantCompletionPopup"===e.type)return e}function S(e){return"initialPromptForAIBlock"===e.stage?"aiBlock":e.context.type}function w(e){return"initialPromptForAIBlock"===e.stage?"write":function(e){switch(e.type){case"cursor":return"write";case"blockSelection":case"textSelection":return"edit"}}(e.context)}function k(e){g.clear(e)}function I(e){if("initialPromptForAIBlock"===e.stage){const t=e.originRef.current;if(!t)return;return{origin:t.getBoundingClientRect(),scrollerStore:x(e.store.getRecordStoreUIRoot())}}return e.context}function C(e){const{areWeLoading:t,scrollerStore:n,resetWhenScrolledToBottom:i}=e,a=(0,l.D9)(t);(0,o.useEffect)((()=>{t!==a&&c(!1)}),[t,a]);const[s,c]=(0,o.useState)(!1),d=(0,r.VK)((()=>null==n?void 0:n.state.scrollTop),[n]),u=(0,l.D9)(d),p=(0,r.VK)((()=>{const e=null==n?void 0:n.state.clientRect;if(e)return n.state.scrollHeight-e.height}),[n]);return(0,o.useEffect)((()=>{void 0!==u&&void 0!==d&&u-d>1&&c(!0)}),[d,u]),(0,o.useEffect)((()=>{i&&void 0!==d&&void 0!==p&&Math.abs(d-p)<1&&c(!1)}),[p,d,i]),s}function x(e){return e===h.default.state.mainEditorCurrentBlockStore?v.Z:b.Z}function T(e,t){const n=f.default.getIntl(),o=(0,c.X)({intl:n,textValue:t.getBlockTitleStore().getValue(),getRecordModel:t.getRecordModel,userTimeZone:(0,s.r)()}),i=t.getRenderableContentStores().map((e=>e.getValue())).filter(d.$K);return{title:o,content:[u.jm({rootBlock:{...t.pointer,spaceId:t.getSpaceId()},getRecordValue:t.getRecordValue}),(0,p.X4)({rootBlock:{...t.pointer,spaceId:t.getSpaceId()},getRecordValue:t.getRecordValue,blockValues:i,isWindows:e.device.isWindows,markdownSerializationOptions:(0,m.KF)(),markdownLinkifyIt:void 0}).markdown].filter(d.$K).join("\n\n")}}},72899:(e,t,n)=>{n.d(t,{E0:()=>i,GC:()=>r,oF:()=>a});var o=n(77907);const i=o.deps.ai,r=(0,o.lazyComponent)(i,(e=>e.CompletionPopup)),a=(0,o.lazyComponent)(i,(e=>e.AiEligibilityUpdater))},30793:(e,t,n)=>{n.d(t,{BG:()=>c,Nv:()=>a,TE:()=>u,YK:()=>r,lG:()=>l,pz:()=>s});var o=n(37181);const i=100;function r(e,t){return e.prompt===t.prompt&&e.type===t.type}function a(e,t,n){const a=s(t).filter((t=>!r(t,e)));o.d2({userSettingsStore:t,transaction:n,data:{recent_ai_actions:[e,...a].slice(0,i)}})}function s(e){var t;return(null===(t=e.getModel())||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.recent_ai_actions)??[]}function l(e,t,n){const i=s(t),a=i.filter((t=>!r(t,e)));i.length!==a.length&&o.d2({userSettingsStore:t,transaction:n,data:{recent_ai_actions:a}})}function c(e){const{clientPrompt:t,additionalContext:n,promptTitle:o}=e,i=null==n?void 0:n.prompt;if(("helpMeWrite"===t.key||"helpMeEdit"===t.key||"helpMeDraft"===t.key)&&i)return{type:"helpMeDraft"===t.key?"helpMeWrite":t.key,prompt:i,promptTitle:o};const r=function(e,t){if(!u(e.key))return;return null==t?void 0:t.topic}(t,n);return r?{type:"helpMeWrite",prompt:r,promptTitle:o}:void 0}const d={brainstormIdeas:!0,blogPost:!0,outline:!0,socialMediaPost:!0,pressRelease:!0,creativeStory:!0,essay:!0,poem:!0,todoList:!0,meetingAgenda:!0,prosConsList:!0,jobDescription:!0,salesEmail:!0,recruitingEmail:!0};function u(e){return d[e]}},24502:(e,t,n)=>{n.d(t,{M:()=>c,Z:()=>l});var o=n(67294),i=n(15095),r=n(53965),a=n(24990),s=n(77907);function l(){(0,o.useEffect)((()=>{c()}),[])}const c=r.IH((async function(){const e=await s.deps.emojiData.loader();a.Z.setState((0,i.Lq)(e))}))},4993:(e,t,n)=>{n.d(t,{M:()=>r,Z:()=>s});var o=n(67294),i=n(480);const r=new Set;function a(){for(const e of r)e()}function s(){const e=(0,i.Fy)();(0,o.useEffect)((()=>{if(e.isMobile)return document.addEventListener("scroll",a,!0),()=>{document.removeEventListener("scroll",a,!0)}}),[e.isMobile])}},30583:(e,t,n)=>{n.d(t,{IL:()=>s,ZP:()=>l});var o=n(67294),i=n(480),r=n(25898),a=n(39500);let s={x:0,y:0,moved:!1,device:"mouse"};function l(){const e=(0,i.O7)();(0,o.useEffect)((()=>(e.device.isMobile?(window.addEventListener("touchstart",c),window.addEventListener("touchmove",d),window.addEventListener("mousedown",u),window.addEventListener("mousemove",p)):(window.addEventListener("mousedown",u),window.addEventListener("mousemove",p)),()=>{e.device.isMobile?(window.removeEventListener("touchstart",c),window.removeEventListener("touchmove",d),window.removeEventListener("mousedown",u),window.removeEventListener("mousemove",p)):(window.removeEventListener("mousedown",u),window.removeEventListener("mousemove",p))})),[e.device.isMobile])}function c(e){const t=e.touches[0];s={moved:!1,x:t.clientX,y:t.clientY,device:(0,a.Nf)(t)}}function d(e){const{x:t,y:n}=s,o=e.touches[0];(0,r.Z)(t,n,o.clientX,o.clientY)>a.Vc[(0,a.Nf)(o)]&&(s={...s,moved:!0})}function u(e){s={moved:!1,x:e.clientX,y:e.clientY,device:"mouse"}}function p(e){const{x:t,y:n}=s;(0,r.Z)(t,n,e.clientX,e.clientY)>a.Vc.mouse&&(s={...s,moved:!0})}},91851:(e,t,n)=>{n.d(t,{NN:()=>G,vD:()=>W,Xi:()=>q,w0:()=>$,RQ:()=>H,uR:()=>Q});n(21703),n(57658);var o=n(67294),i=n(92996),r=n(41892),a=n(12396),s=n(33907),l=n(88437),c=n(37612),d=n(89101),u=n(21202),p=n(75246),m=n(29369),f=n(9291),g=n(31701),h=n(53965),v=n(7032),b=n(1898),y=n(37810),_=n(18265),S=n(8406),w=n(54642),k=n(16956),I=n(47307),C=n(96802),x=n(8055),T=n(13447),M=n(37181),P=n(86628),A=n(24405),R=n(20616),D=n(40235),E=n(85893);function B(e){const{relatedDependencies:t}=e,n=(0,A.Fg)(),i=(0,P.VK)((()=>{const e=null==t?void 0:t.viewDeps;return e?e.map((e=>({name:e.getName(),icon:e.getFormat().collection_view_icon,type:e.getType()}))):[]}),[t.viewDeps]),r=o.useCallback((e=>(0,E.jsxs)("span",{style:{marginRight:10,display:"inline-block"},children:[(0,E.jsx)(R.F,{color:"light",viewIcon:e.icon,viewType:e.type,style:{display:"inline-block",verticalAlign:"middle",marginRight:2,marginBottom:2},size:13}),e.name]},e.name)),[]),s=[{key:"entity_type",header:void 0},{key:"entities",header:void 0}];return(0,E.jsx)(D.Z,{columns:s,rows:(()=>{const e=[],o=null==t?void 0:t.propertyDeps;if(o.length>0){const t=o.map((e=>(0,E.jsxs)("span",{style:{marginRight:10,display:"inline-block"},children:[(0,E.jsx)(a.ZP,{icon:e.icon,type:e.type,size:13,style:{display:"inline-block",verticalAlign:"middle",marginRight:2,marginBottom:2},theme:n}),e.name]},e.name))),i=(0,E.jsx)(f.FormattedMessage,{id:"appTemplates.featureBundleDelete.properties",defaultMessage:"{count, plural, one {1 property} other {{count} properties}}",values:{count:t.length}});e.push({key:"bundledProperties",columns:[[i],t]})}if(i.length>0){const t=i.map((e=>r(e))),n=(0,E.jsx)(f.FormattedMessage,{id:"appTemplates.featureBundleDelete.views",defaultMessage:"{count, plural, one {1 view} other {{count} views}}",values:{count:t.length}});e.push({key:"bundledViews",columns:[[n],t]})}return e})(),hideHeader:!0,cellStyle:{width:"40%"}})}var F=n(76798),O=n(27383),Z=n(33929),V=n(77907),U=n(95802),L=n(80444),j=n(6258),N=n(40663);const z=(0,f.defineMessages)({multiDBNameConnector:{id:"appTemplateHelpers.multiDBNameConnector",defaultMessage:"and"}});function q(e,t){const{spaceViewStore:n}=t,o=n.getSpaceId();if(!o)return;const i=_.bf({url:d._j.workspaceSetup,query:{spaceId:v.cj(o)}});L.default.setState({...L.default.state,mainEditorCurrentBlockStore:void 0}),x.c4({environment:e,url:i})}function W(e){const{environment:t,collectionViewBlockStore:n,collectionStore:o,databaseType:r,propertyMapping:a,typedPropertySchemas:s,transaction:l}=e;if(o.isTypedCollection())throw new Error("Collection is already typed");const c=i.LI[r].blockUri,d=r,u={};Object.entries(a).forEach((e=>{let[n,r]=e;if(!r||r===i.bK)return;const a=s[n],c=o.getSchema()[r];if(!c)throw new Error("Mapped property does not exist");a&&a.type!==c.type&&(k.LC({environment:t,collectionStore:o,property:r,type:a.type,transaction:l}),u[r]=c.type)}));const p=Object.entries(a).filter((e=>{let[t,n]=e;return n===i.bK})).map((e=>{let[t,n]=e;return t})),m={};p.forEach((e=>{const t=s[e];t&&(m[e]=t)})),Object.entries(m).forEach((e=>{let[n,i]=e;const r=k.G3({environment:t,collectionStore:o,collectionViewArgs:void 0,propertyName:i.name,propertyType:i.type,transaction:l});a[n]=r})),C.FH({stores:[n],update:{app_id:(0,v.ZP)(),app_config_uri:c,app_uri_map:{[c]:n.id,[d]:o.id}},transaction:l}),C.FH({stores:[o],update:{app_config_uri:d,app_uri_map:a,mapped_property_types:u},transaction:l})}function H(e){var t;const{environment:n,collectionContextStore:o,transaction:i}=e,r=o.collectionStore(),a=o.collectionViewBlockStore();if(!r||!a)return;const s=(null===(t=r.getFormat())||void 0===t?void 0:t.mapped_property_types)??{};Object.entries(s).forEach((e=>{let[t,o]=e;k.LC({environment:n,collectionStore:r,property:t,type:o,transaction:i})})),C.FH({stores:[a],update:{app_id:void 0,app_config_uri:void 0,app_uri_map:void 0},transaction:i}),C.FH({stores:[r],update:{app_config_uri:void 0,app_uri_map:void 0,mapped_property_types:void 0},transaction:i}),S.g2({environment:n,database_type:void 0,collectionContextStore:o})}async function K(e){const{environment:t,blockStore:n}=e,o=n.getFormat().app_id;if(!o)return[n];const i=await w.getCollectionViewBlocksByAppId(t,{spaceId:n.getSpaceId(),appId:o}),r=n.getParentStore();return"success"!==i.type||void 0===r?[n]:i.data.result.map((e=>j.G.createChildStore(r,{table:u.iU,id:e.blockId,spaceId:n.getSpaceId()})))}async function G(e){const{environment:t,block:n,action:o}=e,a=n.getFormat().app_config_uri||"";if(a===i.NB&&(O.y.locallyMutatedTasksDatabase=!0),N.rC.includes(a)){const e=await async function(e){const{environment:t,blockStore:n}=e,o=n.getParentStore();if(!o)return[n];const i=await K({environment:t,blockStore:n}),r=o.id;return i.filter((e=>{var t;return(null===(t=e.getParentStore())||void 0===t?void 0:t.id)===r}))}({environment:t,blockStore:n});if(e.length<=1)return[n];const i=function(e,t,n){if("delete"===e)return{message:(0,E.jsx)(f.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.message",defaultMessage:"Are you sure you want to delete {dbName}?",values:{dbName:t.getTitleValue()}}),description:(0,E.jsx)(f.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.description",defaultMessage:"{appName} work closely together. You can delete them together, or you might encounter issues after deletion.",values:{appName:n}}),allLabel:(0,E.jsx)("div",{style:{maxWidth:"300",textOverflow:"ellipsis",overflowX:"hidden"},children:(0,E.jsx)(f.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.allLabel",defaultMessage:"Delete {appName}",values:{appName:n}})}),cancelLabel:(0,E.jsx)(f.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.cancelLabel",defaultMessage:"Cancel"}),oneLabel:(0,E.jsx)("div",{style:{maxWidth:"300",textOverflow:"ellipsis",overflowX:"hidden"},children:(0,E.jsx)(f.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.oneLabel",defaultMessage:"Delete {dbName} only",values:{dbName:t.getTitleValue()}})}),actionIcon:c.y};if("move"===e)return{message:(0,E.jsx)(f.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.message",defaultMessage:"Are you sure you want to move {dbName}?",values:{dbName:t.getTitleValue()}}),description:(0,E.jsx)(f.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.description",defaultMessage:"{appName} work closely together. You can move them together, or you might encounter issues after separating.",values:{appName:n}}),allLabel:(0,E.jsx)(f.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.allLabel",defaultMessage:"Move together"}),cancelLabel:(0,E.jsx)(f.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.cancelLabel",defaultMessage:"Cancel"}),oneLabel:(0,E.jsx)(f.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.oneLabel",defaultMessage:"Only move {dbName}",values:{dbName:t.getTitleValue()}}),actionIcon:s.n};if("duplicate"===e)return{message:(0,E.jsx)(f.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.message",defaultMessage:"Are you sure you want to duplicate {dbName}?",values:{dbName:t.getTitleValue()}}),description:(0,E.jsx)(f.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.description",defaultMessage:"{appName} work closely together. You can duplicate them together, or you might encounter issues after separating.",values:{appName:n}}),allLabel:(0,E.jsx)(f.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.allLabel",defaultMessage:"Duplicate together"}),cancelLabel:(0,E.jsx)(f.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.cancelLabel",defaultMessage:"Cancel"}),oneLabel:(0,E.jsx)(f.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.oneLabel",defaultMessage:"Only duplicate {dbName}",values:{dbName:t.getTitleValue()}}),actionIcon:l.a};throw(0,b.t1)(e)}(o,n,function(e){if(1===e.length)return e[0].getTitleValue().toString();let t="";for(let n=0;n<e.length-1;n++)t+=e[n].getTitleValue(),e.length>2?t+=", ":t+=" ";return t+=`${Z.default.formatMessage(z.multiDBNameConnector)} ${e[e.length-1].getTitleValue()}`,t}(e)),a=await function(e,t){const{message:n,description:o,allLabel:i,cancelLabel:a,oneLabel:s,actionIcon:l}=e;return new Promise((e=>{I.showDialog({showCancel:!1,keepFocus:!1,message:(0,E.jsxs)("div",{style:{textAlign:"center"},children:[(0,E.jsxs)("span",{style:{display:"inline-block",verticalAlign:"-0.15em",position:"relative"},children:[(0,E.jsx)("img",{src:r.Z.images.appPackages.projectsIconSvg,style:{width:"1.4em",height:"1.4em"}}),l({width:"0.9em",height:"0.9em",position:"absolute",fill:g.O9.red,right:"-0.3em",bottom:"0.05em"})]}),(0,E.jsx)("div",{style:{fontWeight:y.Z.fontWeight.semibold,margin:"0.7em"},children:n}),(0,E.jsx)("div",{style:{fontSize:14},children:o})]}),items:"delete"===t?[{label:s,color:"red",onAccept:()=>{e("one")}},{label:i,onAccept:()=>{e("all")}},{label:a,onAccept:()=>{e("cancel")}}]:[{label:i,color:"blue",onAccept:()=>{e("all")}},{label:s,onAccept:()=>{e("one")}},{label:a,onAccept:()=>{e("cancel")}}],handleCancel:()=>{e("cancel")}})}))}(i,o);if("cancel"===a)return"user_canceled";const d=[n];if("all"===a)for(const t of e)if(t.id!==n.id){const e=U.C.findSelectablesFromIds([t.id]);e.length>0?d.push(e[0].props.store):d.push(t)}return d}return[n]}async function $(e){var t;let{environment:n,property:o,collectionContextStore:i,theme:r,from:s}=e;const{appTemplatesSetupActions:l,appConfigs:c}=await V.deps.AppTemplates.loader(),d=i.collectionStore(),g=i.collectionViewBlockStore(),v=null==g?void 0:g.getCollectionViewStores();if(!(d&&g&&v&&g.getFormat().app_config_uri))return!1;const b=d.getSchema()[o],_=d.getFormat().app_config_uri;if(!b||!_)return!1;const S=(0,N.YB)(c(),_);if(!S)return!1;const k=h.oA([...Object.keys(d.getPropertyMapping()||{}),...Object.keys((null===(t=g.getFormat())||void 0===t?void 0:t.app_uri_map)||{})]),C=(0,N.TD)(k,S),x=h.oA([C.find((e=>e.uri===o))]),T=(0,N.K8)({validDependencies:x,dependencies:C,collectionStore:d,collectionViewBlockStore:g,viewStores:v}),{validDependencies:M}=T;if(0===M.length)return!1;const P=null==g?void 0:g.getParentStore();if(!d||!g||!P||P.table!==p.bx&&P.table!==u.iU&&P.table!==m.e0)return!1;const A=g.getFormat().app_id,R=A?await w.getCollectionViewBlocksByAppId(n,{spaceId:g.getSpaceId(),appId:A}):void 0,D="success"===(null==R?void 0:R.type)?R.data.result.map((e=>j.G.createChildStore(P,{table:u.iU,id:e.blockId,spaceId:g.getSpaceId()}))):[g],O=[{label:(0,E.jsx)(f.FormattedMessage,{id:"appTemplatesHelpers.bundledPropertyDelete.deleteMessage",defaultMessage:"{count, plural, one {Delete} other {Delete all}}",values:{count:M.length}}),color:"red",onAccept:()=>l.removeDependencies({environment:n,dependencies:M,appCollectionViewBlockStores:D,from:s})}],Z=M.length>1&&(0,E.jsx)(B,{relatedDependencies:T,collectionContextStore:i});return I.showDialog({message:(0,E.jsxs)("div",{style:{textAlign:"center"},children:[(0,E.jsx)("span",{style:{fontWeight:y.Z.fontWeight.medium},children:(0,E.jsx)(f.FormattedMessage,{id:"appTemplateHelpers.bundledPropertyDelete.message",defaultMessage:"Delete {property} property for everyone on {databaseName}?",values:{databaseName:(0,E.jsx)(F.Z,{style:{display:"inline",fontWeight:y.Z.fontWeight.medium},shouldWrap:!0,store:d}),property:(0,E.jsxs)("span",{children:[(0,E.jsx)(a.ZP,{icon:b.icon,type:b.type,size:18,style:{verticalAlign:"middle",display:"inline-block",marginRight:3,marginBottom:2},theme:r}),b.name]})}})}),M.length>1&&(0,E.jsx)("div",{style:{margin:"0.17em"},children:(0,E.jsx)("span",{style:{fontSize:13,fontWeight:y.Z.fontWeight.light},children:(0,E.jsx)(f.FormattedMessage,{id:"appTemplateHelpers.bundledPropertyDelete.description",defaultMessage:"These related entities will also be deleted since they work together."})})})]}),description:Z,showCancel:!0,keepFocus:!0,innerStyle:{width:480},items:O}),!0}function Q(e){const{environment:t,requiredCurrPhase:n,nextPhase:o,currentUserSettingsStore:i,currentSpaceStore:r}=e,a=(0,N.jH)(i,r);n&&n!==a||T.createAndCommit({userAction:"ProjManagementIntroModal.updateProjManagementTooltipTourPhase",environment:t,perform:e=>{var t;M.d2({userSettingsStore:i,transaction:e,data:{proj_management_tooltip_tour_v1_phase_per_space:{...(null===(t=i.getSettings())||void 0===t?void 0:t.proj_management_tooltip_tour_v1_phase_per_space)??{},[r.id]:o}}})},userId:i.id})}},40663:(e,t,n)=>{n.d(t,{$Q:()=>N,$j:()=>ne,AG:()=>F,Au:()=>B,EE:()=>L,FQ:()=>G,FW:()=>C,Hw:()=>U,K8:()=>Y,KC:()=>I,Mi:()=>A,RN:()=>W,TD:()=>O,Th:()=>ee,VL:()=>y,Wo:()=>_,YB:()=>k,YC:()=>oe,Z0:()=>X,Zu:()=>R,_3:()=>P,cR:()=>V,ck:()=>M,fm:()=>E,h7:()=>Z,hZ:()=>$,iX:()=>S,jH:()=>te,kY:()=>w,oX:()=>x,rC:()=>Q,rm:()=>J,xB:()=>j});n(57658),n(21703);var o=n(92996),i=n(46283),r=n(76205),a=n(35011),s=n(10070),l=n(53877),c=n(77657),d=n(42875),u=n(96367),p=n(9844),m=n(53965),f=n(1898),g=n(26991),h=n(80444),v=n(77080),b=n(30874);const y=16803324e5;function _(e,t){return e.find((e=>e.uri===t))}function S(e,t){return e.find((e=>e.presets.some((e=>e.uri===t))))}function w(e,t){return e.flatMap((e=>e.presets)).find((e=>e.uri===t))}function k(e,t){if(!t)return;return e.find((e=>e.allFeatures.find((e=>{if(x(e))for(const n of e.dependencies)if("collection"===n.type&&n.uri===t)return!0}))))}function I(e,t){const n=S(e,t.uri);if(!n)return[];return[...t.requiredFeatures,...t.defaultOnFeatures].filter((e=>{const t=n.allFeatures.find((t=>t.uri===e.featureUri));if(!t)return!1;const{type:o}=e;return"simple"===o?"dependencies"in t:"with_variant"===o?"variants"in t:void(0,f.t1)(o)}))}function C(e){return"variants"in e}function x(e){return"dependencies"in e}const T=[i.k.Owner];function M(e,t){const n=k(e,t);if(n)for(const o of n.allFeatures)if(x(o)){const e=o.dependencies.find((e=>"collection"===e.type&&e.uri===t));if(e)return e.value.schema??{}}}function P(e){let{featurePointers:t,appConfig:n}=e;const o=m.oA(t.map((e=>{const{type:t}=e;return"simple"===t?e.featureUri:"with_variant"===t?e.defaultVariantUri:void(0,f.t1)(t)}))),i={};for(const s of n.allFeatures)i[s.uri]=s;const r=o.map((e=>i[e])).filter((e=>x(e))),a={};for(const s of r)for(const e of s.dependencies)a[e.uri]=e;return Object.values(a)}function A(e){return e.endsWith(o.WN)}function R(e,t){return e.presets.find((e=>e.uri===`${t}${o.WN}`))}const D={[o.Es.Status]:["status","checkbox","select"]};function E(e,t,n){const o=t.type,i=e in D?D[e]:[o];return Object.entries(n).filter((e=>{let[t,n]=e;if(n)return i.includes(n.type)}))}function B(e,t){const n={};for(const[o,i]of Object.entries(e)){if(!o.startsWith("notion://"))continue;if(null==i?void 0:i.type){const e=E(o,i,t);1===e.length&&(n[o]=e[0][0])}}return n}function F(e,t,n,i){const a=t.allFeatures.filter((t=>(t=>{var a,l,c,d,u,p,m,h;if(!x(t)||1!==t.dependencies.length||"collection_view"!==t.dependencies[0].type)return!1;const v=t.dependencies[0],b=i.getFormat().app_config_uri,y=n.getFormat().app_config_uri,_=(null===(a=i.getFormat())||void 0===a?void 0:a.app_uri_map)??{};if(!b||!y)return!1;if(v.collectionViewBlockUri!==b||v.collectionUri!==y)return!1;if(v.uri in _)return!1;const S=s.aQ.deriveTypeUris((null==n?void 0:n.getSchema())??{},null==n?void 0:n.getPropertyMapping()),w=v.optionalProperties??[],k=e=>!w.includes(e)&&!S.has(e),I=v.value;switch(I.type){case"table":case"list":case"gallery":case"timeline":if(null!==(l=I.format)&&void 0!==l&&l.collection_group_by){const e=I.format.collection_group_by.property;if(!(0,o.jP)(e)||k(e))return!1}if(null!==(c=I.query2)&&void 0!==c&&c.timeline_by){const e=I.query2.timeline_by;if(!(0,o.jP)(e)||k(e))return!1}break;case"board":if(null!==(d=I.format)&&void 0!==d&&d.board_columns_by){const e=I.format.board_columns_by.property;if(!(0,o.jP)(e)||k(e))return!1}if(null!==(u=I.format)&&void 0!==u&&u.collection_group_by){const e=I.format.collection_group_by.property;if(!(0,o.jP)(e)||k(e))return!1}break;case"calendar":if(null!==(p=I.query2)&&void 0!==p&&p.calendar_by){const e=I.query2.calendar_by;if(!(0,o.jP)(e)||k(e))return!1}break;case"page":case"chart":return!1;default:(0,f.t1)(I.type)}const C=e=>!!(0,r.Oo)(e)||(0,o.jP)(e.property)&&!k(e.property);if(null!==(m=I.format)&&void 0!==m&&m.property_filters)for(const o of I.format.property_filters){if(!z(o.filter,C))return!1;if(!(0,g.qf)(e,o.filter,n))return!1}if(null!==(h=I.query2)&&void 0!==h&&h.filter){const e=I.query2.filter;if(e.filters)for(const t of e.filters)if(!q(t,C))return!1}return!0})(t)));return m.mN(a,"uri")}function O(e,t){const n=m.xH(m.oA(t.allFeatures.map((e=>{if(x(e))return e.dependencies}))));return m.mN(n.filter((t=>e.includes(t.uri))),(e=>e.uri))}function Z(e){return"app_container"===e.getFormatStore().getKeyStore("collection_view_sub_type").getValue()}function V(e,t,n,r){if(t===o.GZ&&n===i.k.Owner)return!0;const a=s.aQ.deriveTypeUri(n,r.getPropertyMapping());if(!a)return!1;const l=function(e,t){if(t===o.GZ)return T;const n=M(e,t);return n?Object.keys(n):void 0}(e,t);return!!l&&l.includes(a)}function U(e,t,n){return(0,u.un)(e,t,n)}function L(e){return e===o.Kk||e===o.tD}function j(e){return e===o.g3}function N(e,t){const n=[];for(const i of t)"property"===i.type||"database_template"===i.type?e.has(i.collectionUri)&&n.push(i):"block"===i.type?e.has(i.parentUri)&&n.push(i):"collection"!==i.type&&"collection_view"!==i.type||e.has(i.collectionViewBlockUri)&&n.push(i);let o=[];return n.length>0&&(o=N(new Set(n.map((e=>e.uri))),t)),[...n,...o]}function z(e,t){return!!t(e)}function q(e,t){if((0,r.aN)(e)){if(!z(e,t))return!1}else{if((0,r.Mm)(e))return!0;if(e.filters)for(const n of e.filters){if(!q(n,t))return!1}}return!0}function W(e,t){const n=[];if(e.filters)for(const o of e.filters){const e=H(o,t);if(!e)throw new Error("Invalid filter");n.push(e)}return{...e,filters:n}}function H(e,t){if((0,r.aN)(e))return null!=t&&t[e.property]?{...e,property:t[e.property]}:e;if((0,r.Mm)(e))return e;if((0,r.vA)(e)){if(e.filters){const n=[];for(const o of e.filters){const e=H(o,t);if(!e)throw new Error("Invalid filter");n.push(e)}return{operator:e.operator,filters:n}}}else(0,f.t1)(e)}function K(e){const{propertyDependency:t,viewDependency:n,collectionViewStore:o,collectionStore:i}=e;if(n.optionalProperties&&n.optionalProperties.includes(t.uri))return!1;const a=o.getQuery(i.getSchema()),s=o.getFormat(),l=null==a?void 0:a.sort;if(l){if(l.some((e=>t.uri===e.property)))return!0}const c=o.getFormat().property_filters;if(c){const e=e=>!(0,r.Oo)(e)&&e.property===t.uri;if(c.some((t=>z(t.filter,e))))return!0}const d=null==a?void 0:a.filter;if(void 0!==d&&d.filters){const e=e=>!!(0,r.Oo)(e)||e.property!==t.uri;for(const t of d.filters){if(!q(t,e))return!0}}switch(o.getType()){case"table":case"list":case"gallery":case"timeline":if(s.collection_group_by){if(s.collection_group_by.property===t.uri)return!0}if(null!=a&&a.timeline_by){if(a.timeline_by===t.uri)return!0}break;case"board":if(s.board_columns_by){if(s.board_columns_by.property===t.uri)return!0}if(s.collection_group_by){if(s.collection_group_by.property===t.uri)return!0}break;case"calendar":if(null!=a&&a.calendar_by){if(a.calendar_by===t.uri)return!0}}return!1}function G(e,t){const n=(0,d.r)(),o=(0,l.em)(e,1,n);return(0,l.fZ)(o.valueOf(),o.plus({weeks:t}).minus({days:1}).valueOf(),n)}function $(e,t){const n=(0,l.DF)(e,(0,d.r)()).plus({days:t});return(0,l.ME)(n)}const Q=[o.NB,o.Aw,o.J1];function Y(e){var t;const{dependencies:n,collectionStore:o,collectionViewBlockStore:i,viewStores:r,validDependencies:l}=e,c=n.filter((e=>"property"===e.type)),d=[...c.filter((e=>"rollup"===e.propertySchema.type)),...c.filter((e=>"formula"===e.propertySchema.type))],u=n.filter((e=>"collection_view"===e.type)),p=s.aQ.deriveTypeUris(o.getSchema(),o.getPropertyMapping()),m=null===(t=i.getFormat())||void 0===t?void 0:t.app_uri_map,f={validDependencies:l,propertyDeps:[],viewDeps:[]};if(!p||!m)return f;for(const s of d){if(!p.has(s.uri))continue;const e=o.getSchema()[s.uri];if(e){if("rollup"===e.type){const t=l.some((t=>t.uri===e.relation_property));t&&(l.push(s),f.propertyDeps.push(e))}if("formula"===e.type){const t=(0,a.pV)(e).some((e=>{for(const t of l)if(t.uri===e)return!0}));t&&(l.push(s),f.propertyDeps.push(e))}}}for(const a of u){if(!m[a.uri])continue;const e=r.find((e=>e.id===m[a.uri]));if(!e)continue;l.some((t=>"property"===t.type&&K({propertyDependency:t,viewDependency:a,collectionViewStore:e,collectionStore:o})))&&(l.push(a),f.viewDeps.push(e))}return f.validDependencies=l,f}function J(){return v.default.checkGate("typed_db_migration")}function X(){const{currentSpaceStore:e}=h.default.state;return!Boolean(e&&!e.canEdit())}function ee(){return b.Z.getIntegrationsAsRecordMap().getModel({table:p.K2,id:c.Dv})&&v.default.checkGate("cron_connected_relation")}function te(e,t){var n;if(t&&e)return null===(n=e.getSettings())||void 0===n||null===(n=n.proj_management_tooltip_tour_v1_phase_per_space)||void 0===n?void 0:n[t.id]}function ne(e,t){return{create_a_task:"assign_to_someone",assign_to_someone:"change_task_status",change_task_status:t?"select_a_project":"click_view_settings",select_a_project:"complete",click_view_settings:"complete"}[e]}function oe(e,t){const n=w(e,t);if(!n)throw new Error(`Preset not found for URI: ${t}`);const{name:o,icon:i}=n;return{name:o,icon:i}}},51592:(e,t,n)=>{n.d(t,{A7:()=>S,Mn:()=>h,Q_:()=>b,sN:()=>v,tV:()=>_,x1:()=>y});n(67294);var o=n(92996),i=n(54855),r=n(86793),a=n(59960),s=n(9291),l=n(1898),c=n(33929),d=n(98165),u=n(46654),p=n(80444),m=n(6258),f=n(85893);i.a,a.w,r.D;const g=(0,s.defineMessages)({page:{defaultMessage:"Page",id:"dbTypesHelpers.singlePage.displayName"},tasks:{defaultMessage:"Task",id:"dbTypesHelpers.singleTask.displayName"},projects:{defaultMessage:"Project",id:"dbTypesHelpers.singleProject.displayName"}});g.page,g.tasks,g.projects;function h(e){return c.default.formatMessage((0,o.J2)(e))}function v(e,t){return c.default.formatMessage((0,o.tq)(e,t))}function b(e,t){return c.default.formatMessage((0,o.Xj)(e,t))}function y(e){var t;let{typedCollections:n,spaceStore:o,environment:i}=e;const r={},a={},s={},c={},f={},g=null===(t=p.default.state.currentUserStore)||void 0===t?void 0:t.id;for(const p of n){if(g){if("none"===(0,u.Dt)({userId:g,store:p}).role){a[p.id]=p;continue}}const e=(0,d.u3)(p);if(!e)continue;const t=_({environment:i,spaceStore:o,collectionStore:p});switch(t){case"team":c[e.id]=[...c[e.id]||[],p],e instanceof m.zX&&(f[e.id]=e);break;case"private":r[p.id]=p;break;case"shared":s[p.id]=p;break;default:(0,l.t1)(t)}}return{privateDatabases:r,restrictedDatabases:a,sharedDatabases:s,teamDatabases:c,teamStores:f}}function _(e){let{environment:t,spaceStore:n,collectionStore:o}=e;const i=(0,d.u3)(o);return i&&i.canRead()?i instanceof m.zX?"team":i.isTopLevelPrivatePage({spaceStore:n,environment:t})?"private":"shared":"shared"}function S(e,t){return(0,f.jsx)(s.FormattedMessage,{...t,defaultMessage:"This property is required for {databaseType}.",id:"database.requiredPropertyExplanation",description:"Educate the users on why this property cannot be deleted.",values:{databaseType:h(e)}})}},23924:(e,t,n)=>{n.d(t,{gD:()=>d,mL:()=>l,qJ:()=>c});n(57658);var o=n(10070),i=n(21202),r=n(44499),a=n(98165),s=n(51592);function l(e){let{environment:t,typedDatabases:n,spaceStore:o,joinedTeamIds:i,blocksToFilterParents:r}=e;const l=function(e){let{environment:t,typedDatabases:n,spaceStore:o,joinedTeamIds:i}=e;const{sharedDatabases:r,privateDatabases:a,restrictedDatabases:l,teamDatabases:c}=(0,s.x1)({environment:t,typedCollections:n,spaceStore:o}),d=Object.values(l),u=Object.values(a),p=Object.values(r),m=function(e){let{teamDatabases:t,joinedTeamIds:n}=e;const o=[];for(const[s,l]of Object.entries(t))for(const e of l)o.push([s,e]);if(0===o.length)return[];const i=Object.keys(t).filter((e=>!n.includes(e))),r=[...n,...i],a=o.sort(((e,t)=>{let[n,o]=e,[i,a]=t;return r.indexOf(n)-r.indexOf(i)||String(o.getName()).localeCompare(String(a.getName()))})).map((e=>{let[t,n]=e;return n}));return a}({teamDatabases:c,joinedTeamIds:i});return[...m,...p,...u,...d]}({environment:t,spaceStore:o,typedDatabases:n.filter((e=>{const t=(0,a.VP)(e);return!t||!t.isArchived()})),joinedTeamIds:i});return c({typedDatabases:l,blocksToFilterParents:r})}function c(e){let{typedDatabases:t,blocksToFilterParents:n}=e;const o=n?new Set((0,r.qB)(n)):void 0;return t.filter((e=>{if(!e.canEdit())return!1;if(!o)return!0;const t=e.getParentPointer();return!t||t.table!==i.iU||!o.has(t.id)}))}function d(e){const t=e.getPropertyMapping(),n=e.getSchema();return o.aQ.toViewSchema(n,t)}},28344:(e,t,n)=>{n.r(t),n.d(t,{trackAIChatTranscriptHistoryItemRestored:()=>E,trackAIChatTranscriptHistoryNewChatCreated:()=>B,trackAiChatTranscriptHistoryOpenHistoryButtonSelected:()=>F,trackQnACopyClick:()=>v,trackQnAOpened:()=>a,trackQnASilentRetry:()=>d,trackQnaBackToSearch:()=>f,trackQnaCitationsSeeMoreClick:()=>h,trackQnaCitationsToggle:()=>g,trackQnaClear:()=>m,trackQnaClosed:()=>s,trackQnaFeedbackGiven:()=>u,trackQnaInferenceEnd:()=>c,trackQnaInferenceStart:()=>l,trackQnaIntroModalClose:()=>y,trackQnaIntroModalContinue:()=>I,trackQnaIntroModalImportClick:()=>k,trackQnaIntroModalOpen:()=>_,trackQnaIntroModalShowImportRecommendation:()=>S,trackQnaIntroModalSkipImportClick:()=>w,trackQnaLargeVariantReminderShown:()=>D,trackQnaReminderShown:()=>R,trackQnaResultClicked:()=>p,trackQnaSessionInitialized:()=>b,trackQnaUpsellNudgeClick:()=>M,trackQnaUpsellNudgeShown:()=>T,trackQnaWaitlistModalClose:()=>C,trackQnaWaitlistModalOpen:()=>x,trackQnaWaitlistModalRequestAccess:()=>P,trackQnaWaitlistModalSkip:()=>A,trackScopeSearchMenuClose:()=>V,trackScopeSearchMenuOpen:()=>O,trackScopeSearchToggle:()=>Z});var o=n(49902),i=n(1898),r=n(97978);function a(e,t){const{sessionId:n,startTimestamp:i,transcript:a,hasQuery:s,searchSessionId:l,from:c,isReminder:d,reminderType:u}=t;r.j(e,"qna_open",{qna_session_id:n,has_query:s,search_session_id:l,from:c,is_reminder:d,reminder_type:u}),o.j({name:"qna_open",args:{qna_session_id:n,from:c,duration:Date.now()-i,questions_asked_in_session:a.filter((e=>"human"===e.type)).length??0,is_reminder:d,reminder_type:u}})}function s(e,t){const{sessionContext:n,from:i}=t,a=n.assistantConfigurationState;r.j(e,"qna_close",{qna_session_id:a.sessionId,qna_session_length:Date.now()-a.sessionStartTimestamp,from:i}),o.j({name:"qna_close",args:{qna_session_id:a.sessionId,from:i,duration:Date.now()-a.sessionStartTimestamp,questions_asked_in_session:n.evaluator.getTranscript().filter((e=>"human"===e.type)).length??0}})}function l(e){const{environment:t,configurationState:n,inferenceId:o,isRetry:a,source:s,scope:l,mentionsUsed:c}=e;if(!n)return;let d;if("everything"===l.type||"workspace"===l.type||"slack"===l.type||"labeler"===l.type);else if("teamspace"===l.type)d=l.teamId;else if("page"===l.type)d=l.pageId;else{if("collection"!==l.type)return(0,i.t1)(l);d=l.collectionId}r.j(t,"qna_inference_start",{qna_session_id:n.sessionId,qna_inference_id:o,is_retry:a,is_suggested_question:"suggested_question"===s,is_reminder_suggested_question:"reminder_suggested_question"===s,is_abandoned_search_suggested_question:"abandoned_search_suggested_question"===s,search_scope_type:l.type,search_scope_id:d,mentions_used:c})}function c(e,t){const{configurationState:n,inferenceId:o,timeTook:i,numCitationsShown:a,numSearchResults:s,topCitationIndex:l,avgCitationIndex:c}=t;n&&r.j(e,"qna_inference_end",{qna_session_id:n.sessionId,qna_inference_id:o,time_took:i,num_citations_shown:a,num_search_results:s,top_citation_index:l,avg_citation_index:c})}function d(e,t){r.j(e,"qna_silent_retry",{qna_session_id:t.sessionId,event:t.event})}function u(e,t,n,o){t&&r.j(e,"qna_feedback_given",{qna_session_id:t.sessionId,qna_inference_id:n,feedback:o})}function p(e,t){const{configurationState:n,clickedPageId:o,source:i}=t;n&&r.j(e,"qna_result_clicked",{qna_session_id:n.sessionId,clicked_page_id:o,source:i})}function m(e,t){if(!t)return;const n=t.assistantConfigurationState;r.j(e,"qna_clear",{qna_session_id:n.sessionId}),o.j({name:"qna_clear",args:{qna_session_id:n.sessionId,duration:Date.now()-n.sessionStartTimestamp,questions_asked_in_session:t.evaluator.getTranscript().filter((e=>"human"===e.type)).length??0}})}function f(e,t){r.j(e,"qna_back_to_search",{qna_session_id:t.sessionId})}function g(e,t){r.j(e,"qna_citations_toggle",{qna_session_id:t.sessionId,shown:t.shown})}function h(e,t){r.j(e,"qna_citations_see_more_click",{qna_session_id:t.sessionId})}function v(e,t){r.j(e,"qna_copy_click",{qna_session_id:t.sessionId})}function b(e,t){r.j(e,"qna_session_initialized",{current_initialization_count:t.current_initialization_count})}function y(e,t){r.j(e,"qna_intro_modal_close",t)}function _(e){r.j(e,"qna_intro_modal_open")}function S(e){r.j(e,"qna_intro_modal_show_import_recommendation")}function w(e){r.j(e,"qna_intro_modal_skip_import_click")}function k(e){r.j(e,"qna_intro_modal_import_click")}function I(e){r.j(e,"qna_intro_modal_continue")}function C(e){r.j(e,"qna_waitlist_modal_close")}function x(e){r.j(e,"qna_waitlist_modal_open")}function T(e){r.j(e,"qna_add_on_upsell_nudge_displayed")}function M(e){r.j(e,"qna_add_on_upsell_nudge_clicked")}function P(e,t){r.j(e,"qna_waitlist_modal_request_access",{is_space_admin:t.isSpaceAdmin,is_sales_assisted:t.isSalesAssisted})}function A(e){r.j(e,"qna_waitlist_modal_skip")}function R(e,t){r.j(e,"qna_reminder_shown",{number:t.number})}function D(e,t){r.j(e,"qna_large_variant_reminder_shown",{number:t.number})}function E(e,t){r.j(e,"ai_chat_transcript_history.restored",t)}function B(e){r.j(e,"ai_chat_transcript_history.new_chat_created")}function F(e,t){r.j(e,"ai_chat_transcript_history.open_history_button_selected",t)}function O(e,t){r.j(e,"ai_scoped_search_menu_open",t)}function Z(e,t){const{from:n,scope:o}=t;let a;if("everything"===o.type||"workspace"===o.type||"slack"===o.type||"labeler"===o.type);else if("teamspace"===o.type)a=o.teamId;else if("page"===o.type)a=o.pageId;else{if("collection"!==o.type)return(0,i.t1)(o);a=o.collectionId}r.j(e,"ai_scoped_search_toggle",{from:n,search_scope_type:o.type,search_scope_id:a})}function V(e,t){r.j(e,"ai_scoped_search_menu_close",t)}},91567:(e,t,n)=>{n.d(t,{M:()=>r});n(21703),n(52262),n(24506);var o=n(7032),i=n(98180);function r(e,t,n){const r=i.Z.getSessionContext(t);if(!r)return{error:new Error("No related assistant session")};const a=r.evaluator.state.getIdMapper(),s=a.mapKeyToCounter({type:"query-database-result",key:e}),l=r.evaluator.getTranscript(),c=l.findIndex((e=>{if("observation"===e.type&&"queryDatabase"===e.observationType){const t=e.value,o=n.parseSimpleXML(t)[0];if("element"===o.type&&o.attributes.id===s)return!0}return!1}));if(-1===c)return{error:new Error("No query database operation found for sessionId")};const d=l.at(c-1);if(!d||"assistant"!==d.type)return{error:new Error("No previous step for query-database-results")};let u;try{u=n.parseSimpleXML(d.value)}catch(m){return{error:new Error("Unable to parse XML for query-database")}}const p=n.runParser(n.parseQueryDatabaseObservation({allocateIdFn:()=>(0,o.ZP)(),mapCounterToKey:e=>a.mapCounterToKey(e)}),u);return p.error?{error:new Error("Could not parse query database observation")}:{value:p.value.query.databaseId}}},91683:(e,t,n)=>{n.d(t,{Bt:()=>b,Qz:()=>v,Tw:()=>y,lW:()=>S});n(52262);var o=n(30120),i=n(67294),r=n(86628),a=n(1898),s=n(19584),l=n(13447),c=n(37181),d=n(2551),u=n(80444),p=n(21273),m=n(85844),f=n(28344);const g=[3,4],h=4*s.C0,v=g.length;function b(){const[e,t]=(0,i.useState)(),[n,l]=(0,i.useState)((()=>o.ou.utc())),[c,u]=(0,i.useState)(!1),f=(0,r.VK)((()=>p.Z.showRemindersToUseQnA()),[]);return(0,i.useEffect)((()=>{const e=setTimeout((()=>{u(!0),l(o.ou.utc())}),h);return()=>clearTimeout(e)}),[]),(0,d.W)((()=>{l(o.ou.utc())}),5*s.hM,c&&f),(0,r.VK)((()=>{if(!f)return;if(!c)return;if((0,a.$K)(e))return;if(!m.Z.state.isVisible)return;const i=function(e){const{now:t}=e,n=y();if(!n)return;return function(e){const{currentUserSettings:t,now:n}=e;if(!(0,a.$K)(t.last_exposed_to_ai_qna_at))return;const i=t.qna_reminders_shown_at??[],r=i.length,s=g.at(r);if(!(0,a.$K)(s))return;const l=0===r?t.last_exposed_to_ai_qna_at:i[r-1],c=n.diff(o.ou.fromMillis(l),"days").days;if(c<s)return;if(r>0){const e=i[r-1];if(t.last_exposed_to_ai_qna_at>=e)return}return{number:r+1,update:{qna_reminders_shown_at:[...i,n.toMillis()]}}}({currentUserSettings:n,now:t})}({now:n});(0,a.$K)(i)&&t(i)}),[f,c,e,n]),e}function y(){const{currentUserSettingsStore:e}=u.default.state;if(!e)return;return{last_exposed_to_ai_qna_at:e.getSettingsStore().getKeyStore("last_exposed_to_ai_qna_at").getValue(),qna_reminders_shown_at:e.getSettingsStore().getKeyStore("qna_reminders_shown_at").getValue(),ai_qna_abandoned_search_reminder_shown_at:e.getSettingsStore().getKeyStore("ai_qna_abandoned_search_reminder_shown_at").getValue()}}function _(){const{currentUserSettingsStore:e}=u.default.state;if(e)return e.getSettingsStore().getKeyStore("qna_sessions_initialized").getValue()??0}function S(e){const{currentUserSettingsStore:t}=u.default.state;if(!t)return;const n=_();void 0!==n&&(l.createAndCommit({environment:e,userAction:"useApplicableQnaReminder.updateQnaUsageCount",perform:e=>{c.d2({userSettingsStore:t,transaction:e,data:{qna_sessions_initialized:n+1}})}}),(0,f.trackQnaSessionInitialized)(e,{current_initialization_count:n+1}))}},81598:(e,t,n)=>{n.d(t,{DO:()=>s,F$:()=>d,L6:()=>i,PS:()=>r,Q:()=>a,eC:()=>l,yX:()=>c});var o=n(77907);const i=o.deps.assistant,r=(0,o.lazyComponent)(i,(e=>e.AssistantFullPageChat)),a=(0,o.lazyComponent)(i,(e=>e.AssistantOriginElement)),s=(0,o.lazyComponent)(i,(e=>e.ModalOverlayCollectionListView)),l=(0,o.lazyComponent)(i,(e=>e.AssistantMenuPopup)),c=(0,o.lazyComponent)(i,(e=>e.SearchAssistantPane)),d=(0,o.lazyComponent)(i,(e=>e.AssistantUpsellElement))},69128:(e,t,n)=>{n.d(t,{JV:()=>i,Pf:()=>a});var o=n(49085);const i=5;class r extends o.default{getInitialState(){return{type:"idle"}}isAvailable(){return"ready"===this.state.type&&this.state.questions.length>0}}const a=new r},66402:(e,t,n)=>{n.d(t,{j:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isOpen:!1}}open(e){const{collectionViewBlockId:t,collectionViewId:n,assistantSessionId:o}=e;this.setState({isOpen:!0,collectionViewBlockId:t,collectionViewId:n,assistantSessionId:o})}close(){this.setState({isOpen:!1})}}const r=new i},41301:(e,t,n)=>{n.d(t,{Fp:()=>d,Mm:()=>c,So:()=>p,TU:()=>u});n(67294);var o=n(86628),i=n(24405),r=n(9291),a=n(53965),s=n(1898),l=n(85893);const c=(0,r.defineMessages)({missingTargetDatabase:{id:"clientAutomationHelpers.errorMessages.missingTargetDatabase",defaultMessage:"Missing a target database"},missingNotificationCollectionPointer:{id:"clientAutomationHelpers.errorMessages.missingNotificationCollectionPointer",defaultMessage:"Missing collection pointer"},missingNotificationTarget:{id:"clientAutomationHelpers.errorMessages.missingNotificationTarget",defaultMessage:"Missing a notification target"},missingNotificationMessage:{id:"clientAutomationHelpers.errorMessages.missingNotificationMessage",defaultMessage:"Missing a notification message"},missingNotificationPropertyId:{id:"clientAutomationHelpers.errorMessages.missingPropertyId",defaultMessage:"Missing a target property"},missingNotificationFormulaValue:{id:"clientAutomationHelpers.errorMessages.missingFormulaValue",defaultMessage:"Missing target people"},missingTargetPage:{id:"clientAutomationHelpers.errorMessages.missingTargetPage",defaultMessage:"Missing a target page"},invalidTemplatePage:{id:"clientAutomationHelpers.errorMessages.invalidTemplatePage",defaultMessage:"Invalid template."},noActions:{id:"clientAutomationHelpers.errorMessages.noActions",defaultMessage:"This button has no actions"},createPageButtonError:{id:"clientAutomationHelpers.errorMessages.createPageButtonError",defaultMessage:"Add page is missing a target database"},createPageButtonTemplateError:{id:"clientAutomationHelpers.errorMessages.createPageWithTemplateError",defaultMessage:"Add page has an invalid template"},openPageButtonError:{id:"clientAutomationHelpers.errorMessages.openPageButtonError",defaultMessage:"Open page is missing a target page"},updatePagesButtonError:{id:"clientAutomationHelpers.errorMessages.editPagesButtonError",defaultMessage:"Edit pages is missing a target database"},slackNotificationAuthenticationError:{id:"clientAutomationHelpers.errorMessages.slackNotificationError",defaultMessage:"Slack notification is missing an authentication."},slackNotificationTargetError:{id:"clientAutomationHelpers.errorMessages.slackNotificationTargetError",defaultMessage:"Slack notification is missing a target channel."}});function d(e){if("create_page"===e.actionType)if("missing_required_config"===e.type){if("collection"===e.key)return{forAction:c.missingTargetDatabase,forButtonTooltip:c.createPageButtonError};(0,s.t1)(e)}else{if("invalid_optional_config"===e.type)return{forAction:c.invalidTemplatePage,forButtonTooltip:c.createPageButtonTemplateError};(0,s.t1)(e)}else if("update_pages"===e.actionType)if("missing_required_config"===e.type){if("target"===e.key)return{forAction:c.missingTargetDatabase,forButtonTooltip:c.updatePagesButtonError};(0,s.t1)(e)}else(0,s.t1)(e);else if("open_page"===e.actionType)if("missing_required_config"===e.type){if("target"===e.key)return{forAction:c.missingTargetPage,forButtonTooltip:c.openPageButtonError};(0,s.t1)(e)}else(0,s.t1)(e);else if("slack_notification"===e.actionType)if("missing_required_config"===e.type){if("external_bot_id"===e.key)return{forAction:c.slackNotificationAuthenticationError,forButtonTooltip:c.slackNotificationAuthenticationError};if("target"===e.key)return{forAction:c.slackNotificationTargetError,forButtonTooltip:c.slackNotificationTargetError};(0,s.t1)(e)}else if("missing_required_value"===e.type){if("external_bot_id"===e.key)return{forAction:c.slackNotificationAuthenticationError,forButtonTooltip:c.slackNotificationAuthenticationError};(0,s.t1)(e)}else(0,s.t1)(e);else if("send_in_app_notification"===e.actionType)if("missing_required_config"===e.type){if("target"===e.key)return{forAction:c.missingNotificationTarget,forButtonTooltip:c.missingNotificationTarget};if("notification_message"===e.key)return{forAction:c.missingNotificationMessage,forButtonTooltip:c.missingNotificationMessage};if("collectionPointer"===e.key)return{forAction:c.missingNotificationCollectionPointer,forButtonTooltip:c.missingNotificationCollectionPointer};if("propertyId"===e.key)return{forAction:c.missingNotificationPropertyId,forButtonTooltip:c.missingNotificationPropertyId};if("formulaValue"===e.key)return{forAction:c.missingNotificationFormulaValue,forButtonTooltip:c.missingNotificationFormulaValue};(0,s.t1)(e)}else(0,s.t1)(e);else(0,s.t1)(e)}function u(e){const{contextStore:t,actionId:n,shouldShow:i,errorKey:s}=e;return(0,o.VK)((()=>{if(!i||!t)return;let e=t.getValidationErrorsForAction(n);s&&(e=e.filter((e=>e.key===s)));const o=(0,a.Ps)(e);if(!o)return;const c=d(o);return(0,l.jsx)(p,{content:(0,l.jsx)(r.FormattedMessage,{...c.forAction})})}),[i,t,n,s])}function p(e){const{content:t,subtitle:n}=e,o=(0,i.yK)((e=>({wrap:{display:"flex",flexDirection:"column",alignItems:"center"},subtitle:{color:e.mediumInvertedTextColor}})),[]);return(0,l.jsxs)("div",{style:o.wrap,children:[(0,l.jsx)("div",{children:t}),n&&(0,l.jsx)("div",{style:o.subtitle,children:n})]})}},58564:(e,t,n)=>{n.d(t,{k:()=>r});var o=n(52315),i=n(6258);function r(e,t){const n=i.Mz.createChildStore(e,t);if(!n||!n.isDefined())return!1;const r=n.getActionStores();for(const i of r){if(!i.isDefined())return!1;const e=i.getBlockStores();for(const t of e){if(!o.b(t))return!1}}return!0}},93174:(e,t,n)=>{n.d(t,{GN:()=>s,IQ:()=>a,On:()=>r,_1:()=>i});var o=n(77907);const i=o.deps.automations,r=(0,o.lazyComponent)(i,(e=>e.PlacedButtonBlockEditor)),a=(0,o.lazyComponent)(i,(e=>e.AutomationWorkflowEditor)),s=(0,o.lazyComponent)(i,(e=>e.AutomationWorkflowEditorActionSection))},87686:(e,t,n)=>{n.d(t,{f:()=>r});n(67294);var o=n(24405),i=n(85893);function r(){const e=(0,o.yK)((e=>({span:{marginLeft:2,marginRight:2,color:e.lightTextColor}})),[]);return(0,i.jsx)("span",{style:e.span,children:"/"})}},25238:(e,t,n)=>{n.d(t,{Z:()=>p});n(67294);var o=n(480),i=n(86628),r=n(24405),a=n(37810),s=n(31278),l=n(76798),c=n(6258),d=n(74016),u=n(85893);function p(e){const{store:t,ignoreMaxLength:n,maxWidth:p,iconSize:m,emojiSize:f,titleStyle:g,iconStyle:h,highlighter:v}=e,{device:b}=(0,o.O7)(),y=m??(b.isMobile?24:20),_=f??y,{hasIcon:S,pageIcon:w,isEmptyPage:k}=(0,i.VK)((()=>({hasIcon:t.hasIcon(),pageIcon:t.getIcon(),isEmptyPage:t instanceof c.G&&t.isEmptyPage()})),[t]),I=(0,r.yK)((()=>({containerStyle:{display:"flex",alignItems:"center",minWidth:0},teamRecordTitle:{maxWidth:p,...g},pageRecordTitle:{maxWidth:n?"none":p,...g},recordIconStyle:{marginRight:6,fontWeight:a.Z.fontWeight.medium,...h}})),[n,p,g,h]);return t instanceof c.zX?(0,u.jsxs)("div",{style:I.containerStyle,children:[(0,u.jsx)(d.p,{disabled:!0,store:t,size:y,style:I.recordIconStyle}),(0,u.jsx)(l.Z,{store:t,style:I.teamRecordTitle,highlighter:v,enableHover:!0})]}):(0,u.jsxs)("div",{style:I.containerStyle,children:[S&&(0,u.jsx)(s.Z,{disabled:!0,icon:w,isEmptyPage:k,size:y,emojiSize:_,style:I.recordIconStyle,largeIcon:!0}),(0,u.jsx)(l.Z,{store:t,style:I.pageRecordTitle,highlighter:v,enableHover:!0})]},`breadcrumb-recordtitle-${t.id}`)}},7692:(e,t,n)=>{n.d(t,{Z:()=>v});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(15145),l=n(13084),c=n(13447),d=n(31945),u=n(89728),p=n(79954),m=n(84210),f=n(87686),g=n(25238),h=n(85893);function v(e){const t=(0,i.O7)(),{device:n}=t,{store:v,showDivider:b,maxWidth:y,popupRenderer:_,iconSize:S,emojiSize:w,titleStyle:k,iconStyle:I,highlighter:C,onClick:x}=e,T=(0,a.yK)((()=>({selectable:{display:"flex",alignItems:"center",minWidth:0},button:{display:"flex",minWidth:0,fontSize:"inherit",paddingTop:2,paddingBottom:2,paddingLeft:6,paddingRight:6}})),[]),{url:M,canEdit:P}=(0,r.VK)((()=>({url:(0,m.ZP)({store:v,fullyQualified:!1,pageVisitSource:s.tY.Breadcrumb}),canEdit:v.canEdit()})),[v]),A=(0,o.useCallback)((e=>{const{droppedDirection:n,droppedStores:o,duplicate:i}=e;c.createAndCommit({userAction:"SearchPathBreadcrumb.onDrop",environment:t,perform:e=>l.LQ({environment:t,targetParentStore:v.getContentStore(),targetStore:v,droppedDirection:n,droppedStores:o,duplicate:i,transaction:e})})}),[t,v]),R=(0,h.jsx)(g.Z,{store:v,maxWidth:y,iconSize:S,emojiSize:w,titleStyle:k,iconStyle:I,highlighter:C});return(0,h.jsxs)(o.Fragment,{children:[(0,h.jsx)(p.Z,{store:v,canDropOnto:P,onSelectableDrop:A,style:T.selectable,analyticsName:"breadcrumb",shouldShowDropZone:!0,children:_?(0,h.jsx)(d.ZP,{originGap:4,popupType:n.isMobile?d.Z4.SlideUp:d.Z4.Popup,render:_,renderOrigin:e=>(0,h.jsx)(u.Z,{...e,style:T.button,isSmall:!0,shouldShrink:!0,mobileFeedback:n.isMobile,children:R})}):(0,h.jsx)(u.Z,{href:M,external:!1,style:T.button,isSmall:!0,shouldShrink:!0,mobileFeedback:n.isMobile,onClick:x,children:R})}),b&&(0,h.jsx)(f.f,{})]},v.id)}},24946:(e,t,n)=>{n.d(t,{Z:()=>g});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(31945),l=n(68785),c=n(89728),d=n(95697),u=n(77907),p=n(87686),m=n(25238),f=n(85893);function g(e){const{device:t}=(0,i.O7)(),{store:n,showDivider:g,popupRenderer:h,iconSize:v,iconStyle:b,highlighter:y}=e,_=(0,a.yK)((()=>({button:{fontSize:"inherit",padding:2},loadingPopupBackground:{width:280,paddingTop:8,paddingBottom:8,display:"flex",justifyContent:"center"}})),[]),{teamsEnabled:S,storeIsDefined:w}=(0,r.VK)((()=>({teamsEnabled:(0,d.bq)(),storeIsDefined:n.isDefined()})),[n]);if(!w||!S)return null;return(0,f.jsxs)(o.Fragment,{children:[(0,f.jsx)(s.ZP,{originGap:4,popupType:t.isMobile?s.Z4.SlideUp:s.Z4.Popup,render:h??(e=>(0,f.jsx)(u.LazyTeamBreadcrumbPopup,{renderLoading:e=>(0,f.jsx)("div",{style:_.loadingPopupBackground,children:e&&(0,f.jsx)(l.Z,{})}),teamStore:n,parent:e})),renderOrigin:o=>(0,f.jsx)(c.Z,{style:_.button,isSmall:!0,shouldShrink:!0,mobileFeedback:t.isMobile,...o,children:(0,f.jsx)(m.Z,{store:n,maxWidth:e.maxWidth,iconSize:v,titleStyle:e.titleStyle,iconStyle:b,highlighter:y})})}),g&&(0,f.jsx)(p.f,{})]},n.id)}},3043:(e,t,n)=>{n.d(t,{Qe:()=>r.Z,Yo:()=>i.Z,fY:()=>o.f,l2:()=>s});var o=n(87686),i=n(24946),r=n(7692),a=n(77907);const s=(0,a.lazyComponent)(a.deps.Breadcrumb,(e=>e.Breadcrumb))},37524:(e,t,n)=>{n.d(t,{AV:()=>m,Xx:()=>h,bp:()=>u,bu:()=>g,f2:()=>v,iZ:()=>w,lO:()=>y,lZ:()=>b,mH:()=>p,oc:()=>S,tA:()=>f,vf:()=>k,vg:()=>_});var o=n(51454),i=n(31701),r=n(10906),a=n(92650),s=n(28020),l=n(77181),c=n(24646),d=n(27724);function u(e,t){return e.col===t.col&&e.row===t.row}const p="text/_notion-table";function m(e){return{minCol:Math.min(e.start.col,e.end.col),maxCol:Math.max(e.start.col,e.end.col),minRow:Math.min(e.start.row,e.end.row),maxRow:Math.max(e.start.row,e.end.row)}}const f=14,g=32,h=g+0;function v(e){let{columnIndex:t,titleColumnIndex:n,indentLevel:o,shouldShowBulkActionsToolbar:i,isSubitemToggleOnTitleColumn:r}=e;const a=0===t&&i?h:0;return b({columnIndex:t,titleColumnIndex:n,indentLevel:o,isSubitemToggleOnTitleColumn:r})+a}function b(e){let{columnIndex:t,titleColumnIndex:n,indentLevel:o,isSubitemToggleOnTitleColumn:i}=e;return y({columnIndex:t,titleColumnIndex:n,isSubitemToggleOnTitleColumn:i})&&o>0?l.Hw*o:0}function y(e){let{columnIndex:t,titleColumnIndex:n,isSubitemToggleOnTitleColumn:o}=e;return o?t===n:0===t}function _(e){let{collectionViewBlockId:t}=e;const n=d.default.state.stores;return 0!==n.length&&!(0,r.v_)(n,t)}function S(e){const{environment:t,collectionContextStore:n,isPhone:r,stickyLeft:a,theme:s}=e;if(r)return{};const l=n.collectionViewBlockStore(),d=null==l?void 0:l.getParentBlockStore();let u;const p=n.isInPeekRenderer.state;if("dark"===s.mode&&p&&(u=s.peekModalBackground),d&&!n.isFullScreen.state&&(null==l||!l.isRootOrDirectChild())){var m;const e=null===(m=d.getModel())||void 0===m?void 0:m.getFormat().block_color;e&&(u=(0,i.fi)(e,s).background)}const f=n.frozoneStore.state.scrollerLeftOffset??0,g=(0,c.Wk)(t),h=Math.max(g-f,0),v=w(t,n)?h:0;return{background:u||s.contentBackground,position:"sticky",left:(a||0)+v,zIndex:o.I5}}function w(e,t){const n=t.collectionViewBlockStore();return!!n&&(n.isRootOrDirectChild()&&(0,a.fg)(e,n)&&!(0,r._5)(n)&&!n.isCollectionViewPageWithContent())}function k(e){const{environment:t,propertyFormat:n}=e,o=n.width;if(!t.device.isPhone)return o;const i=t.WindowSizeStore.getSafePaddingLeftPx((0,s.ui)(t)),r=t.WindowSizeStore.getSafePaddingRightPx((0,s.ui)(t)),a=t.WindowSizeStore.state.width-i-r;return o?Math.min(o,a):a}},59183:(e,t,n)=>{n.d(t,{N:()=>r,Z:()=>s});var o=n(49085),i=n(53965);function r(e,t){return e.collectionViewBlockStore===t.collectionViewBlockStore&&i.Xy(e.groupFormat,t.groupFormat)}class a extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return i.d9(this.state)}}const s=new a},4430:(e,t,n)=>{n.d(t,{AZ:()=>W,B8:()=>Z,BJ:()=>x,C1:()=>G,DS:()=>N,EW:()=>J,GK:()=>L,Ge:()=>k,Gz:()=>A,H5:()=>M,HZ:()=>Se,Ii:()=>ce,Ip:()=>q,Ne:()=>ue,PF:()=>j,Qw:()=>ge,S7:()=>b,ST:()=>E,TW:()=>F,Tp:()=>re,Wk:()=>y,XO:()=>O,YE:()=>ve,YP:()=>le,Zn:()=>me,_Q:()=>ne,_e:()=>P,al:()=>V,bK:()=>U,bk:()=>B,cK:()=>z,d$:()=>K,e$:()=>R,fc:()=>te,fj:()=>$,i2:()=>S,lf:()=>_,lx:()=>I,pQ:()=>ae,pe:()=>de,ph:()=>be,px:()=>w,qG:()=>X,rr:()=>ie,vX:()=>he,x2:()=>D,xI:()=>Q,xJ:()=>Y,xP:()=>oe,xd:()=>fe,y1:()=>pe,yk:()=>ee});var o=n(30120),i=n(13991),r=n(49085),a=n(30823),s=n(99036),l=n(80951),c=n(40506),d=n(7057),u=n(53877),p=n(6695),m=n(42875),f=n(15157),g=n(1898),h=n(77181),v=n(77794);const b=5,y=3,_=2,S=21;let w=function(e){return e[e.LeftResizer=0]="LeftResizer",e[e.RightResizer=1]="RightResizer",e[e.ItemDrag=2]="ItemDrag",e}({});const k=4e3,I=k/4,C=864e5,x={hours:{snapUnit:"fifteen_minutes",primaryDisplayUnit:"fifteen_minutes",secondaryDisplayUnit:"day",activeRangeType:void 0,msPerPixel:C/7e3,primaryDisplayUnitAlignment:"range_start",verticalDividerUnit:"fifteen_minutes",showWeekendIndicators:!1,hidePrimaryIndicatorIntersectionOffset:9,getDateRangePlaceholderDuration:e=>e.plus({hour:1})},day:{snapUnit:"fifteen_minutes",primaryDisplayUnit:"hour",secondaryDisplayUnit:"day",activeRangeType:void 0,msPerPixel:69120,primaryDisplayUnitAlignment:"range_start",verticalDividerUnit:"hour",showWeekendIndicators:!1,hidePrimaryIndicatorIntersectionOffset:2,getDateRangePlaceholderDuration:e=>e.plus({hour:3})},week:{snapUnit:"day",primaryDisplayUnit:"day",secondaryDisplayUnit:"month",activeRangeType:"highlight_days",msPerPixel:48e4,primaryDisplayUnitAlignment:"range_middle",verticalDividerUnit:"day",showWeekendIndicators:!0,hidePrimaryIndicatorIntersectionOffset:void 0,getDateRangePlaceholderDuration:e=>e.plus({day:1})},bi_week:{snapUnit:"day",primaryDisplayUnit:"day",secondaryDisplayUnit:"month",activeRangeType:"highlight_days",msPerPixel:108e4,primaryDisplayUnitAlignment:"range_middle",verticalDividerUnit:void 0,showWeekendIndicators:!0,hidePrimaryIndicatorIntersectionOffset:void 0,getDateRangePlaceholderDuration:e=>e.plus({day:3})},month:{snapUnit:"day",primaryDisplayUnit:"day",secondaryDisplayUnit:"month",activeRangeType:"highlight_days",msPerPixel:216e4,primaryDisplayUnitAlignment:"range_middle",verticalDividerUnit:void 0,showWeekendIndicators:!0,hidePrimaryIndicatorIntersectionOffset:void 0,getDateRangePlaceholderDuration:e=>e.plus({day:5})},quarter:{snapUnit:"day",primaryDisplayUnit:"week",secondaryDisplayUnit:"month",activeRangeType:"display_range",msPerPixel:72e5,primaryDisplayUnitAlignment:"range_start",verticalDividerUnit:"month",showWeekendIndicators:!1,hidePrimaryIndicatorIntersectionOffset:35,getDateRangePlaceholderDuration:e=>e.plus({week:2})},year:{snapUnit:"day",primaryDisplayUnit:"week",secondaryDisplayUnit:"month",activeRangeType:"display_range",msPerPixel:C/5,primaryDisplayUnitAlignment:"range_start",verticalDividerUnit:"month",showWeekendIndicators:!1,hidePrimaryIndicatorIntersectionOffset:6,getDateRangePlaceholderDuration:e=>e.plus({week:4})}},T="month";function M(e){var t;return null===(t=P(e))||void 0===t?void 0:t.property}function P(e){const t=e.normalizedFormatStore.state.timeline_arrows_by;if(null==t||!t.property)return;const n=e.normalizedSchemaStore.state[t.property],o=e.collectionStore();return n&&"relation"===n.type&&n.property&&o&&(0,s.F0)(n)===o.id?{property:t.property,inverse:n.property}:void 0}function A(e){return{zoomLevel:r.default.createValue(T),currentRange:r.default.createValue({startTimestamp:0,endTimestamp:0}),dragState:r.default.createValue(void 0),drawState:r.default.createValue(void 0),hoveredItem:r.default.createValue(void 0),dateRangePlaceholder:r.default.createValue({active:!1}),scrollLeft:r.default.createValue(void 0),outerSizeObserver:new v.E,timelineSizeObserver:new v.E,horizontalScroller:void 0,savePreference:void 0,isFullScreen:e.isFullScreen,isRootChild:e.isRootChild,destroyed:!1}}function R(e,t){return t/x[e].msPerPixel}function D(e,t){return t*x[e].msPerPixel}function E(e){return"fifteen_minutes"===e||"hour"===e}function B(e){const{store:t,query:n,schema:o,userId:i,intl:r}=e,l=t.getModel();if(!l)return;const c=t.getAssociatedCollectionStore(),{timeline_by:d,timeline_by_end:p}=n;if(!d)return;const f=o[d];if(!f||!(0,s.Lt)(f))return;const g=(0,a.FT)({property:d,schema:o,block:l,getRecordModel:t.getRecordModel,propertyMapping:null==c?void 0:c.getPropertyMapping(),collectionRequestContext:{userId:i,userTimeZone:(0,m.r)(),depth:0,intl:r,visitedProperties:new Set,resultCache:new Map}}).next().value;if("date"!==(null==g?void 0:g.type))return;const h=g.value;if(!p||d===p)return h;{const e=o[p];if(!e||!(0,s.Lt)(e))return;const n=(0,a.FT)({property:p,schema:o,block:l,getRecordModel:t.getRecordModel,propertyMapping:null==c?void 0:c.getPropertyMapping(),collectionRequestContext:{userId:i,userTimeZone:(0,m.r)(),depth:0,intl:r,visitedProperties:new Set,resultCache:new Map}}).next().value;if(n&&"date"===n.type){const e=n.value,t=u.rH(h,e);if(t)return u.Qq(t)}}}function F(e){const{store:t,dateValue:n,query:o}=e,{timeline_by:i,timeline_by_end:r}=o;if(!i)return;const a=t.getAssociatedCollectionStore(),d=(null==a?void 0:a.getSchema())??e.schema,u=(null==a?void 0:a.getMappedProperty(i))??i,p=r?(null==a?void 0:a.getMappedProperty(r))??r:void 0,m=d[u];if(m&&(0,s.Lt)(m)){if(!p||u===p)return{[u]:(0,l.d7)(n)};{const e=d[u];if(!e||!(0,s.Lt)(e))return;const o=(0,l.Gl)(t.getPropertyValue(u)),i=(0,l.Gl)(t.getPropertyValue(p));if("date"===n.type)return{[u]:(0,l.d7)({type:"date",start_date:n.start_date,reminder:c.V3(o)}),[p]:(0,l.d7)({type:"date",start_date:n.start_date,reminder:c.V3(i)})};if("daterange"===n.type)return{[u]:(0,l.d7)({type:"date",start_date:n.start_date,reminder:c.V3(o)}),[p]:(0,l.d7)({type:"date",start_date:n.end_date,reminder:c.V3(i)})};if("datetime"===n.type)return{[u]:(0,l.d7)({type:"datetime",start_date:n.start_date,start_time:n.start_time,time_zone:n.time_zone,reminder:c._3(o)}),[p]:(0,l.d7)({type:"datetime",start_date:n.start_date,start_time:n.start_time,time_zone:n.time_zone,reminder:c._3(i)})};if("datetimerange"===n.type)return{[u]:(0,l.d7)({type:"datetime",start_date:n.start_date,start_time:n.start_time,time_zone:n.time_zone,reminder:c._3(o)}),[p]:(0,l.d7)({type:"datetime",start_date:n.end_date,start_time:n.end_time,time_zone:n.time_zone,reminder:c._3(i)})};(0,g.t1)(n)}}}function O(e,t){const n=E(t),o=u.NK(n?e:c.Dy(e),(0,m.r)()),i=N(o.start,t),r=n&&"date"===e.type?o.start.plus({days:1}).startOf("day"):o.end||i;return{start:i,end:n?N(r,t):q(r,t)}}function Z(e){return`timeline:${e}`}function V(e){const{horizontalScroller:t,outerSizeObserver:n}=e,o=e.zoomLevel.state,{startTimestamp:i}=e.currentRange.state;return i+D(o,(t?t.scrollLeft:0)+n.rect.state.width/2)}function U(e){const{environment:t,timestamp:n,timelineState:o,paddingLeft:i,format:r}=e;return n-D(o.zoomLevel.state,Q({environment:t,paddingLeft:i,format:r,isFullScreen:o.isFullScreen,isRootChild:o.isRootChild})/2)}function L(e){const{environment:t,timestamp:n,timelineState:o,paddingLeft:i,format:r}=e;return n-D(o.zoomLevel.state,Q({environment:t,paddingLeft:i,format:r,isFullScreen:o.isFullScreen,isRootChild:o.isRootChild})-o.outerSizeObserver.rect.state.width/2)}function j(e){const{timestamp:t,timelineState:n}=e;return t+D(n.zoomLevel.state,-n.outerSizeObserver.rect.state.width/2)}function N(e,t){if("fifteen_minutes"===t){const t=15*Math.floor(e.minute/15);return e.set({minute:t}).startOf("minute")}return e.startOf(t)}function z(e,t){if("fifteen_minutes"===t){const t=15*Math.floor(e.minute/15)-15;return e.set({minute:t}).startOf("minute")}return e.startOf(t).minus({[t]:1}).startOf(t)}function q(e,t){if("fifteen_minutes"===t){const t=15*Math.floor(e.minute/15)+15;return e.set({minute:t}).startOf("minute")}return e.plus({[t]:1}).startOf(t)}function W(e){const{startValue:t,snapUnit:n,desiredStart:o,desiredEnd:i}=e;let r=t;const a=c.Ze(t)||(0,m.r)();if(o){const e=H(o,n,"start",a);if("datetime"===e.type)if("date"===r.type){const e={type:"daterange",start_date:r.start_date,end_date:r.start_date};r=u.bD(e,(0,m.r)())}else"daterange"===r.type&&(r=u.bD(r,(0,m.r)()));"date"===r.type?r={...r,type:"daterange",start_date:e.start_date,end_date:r.start_date}:"daterange"===r.type?r={...r,type:"daterange",start_date:e.start_date,end_date:r.end_date}:"datetime"===r.type?r={...r,type:"datetimerange",start_date:e.start_date,start_time:"datetime"===e.type?e.start_time:r.start_time,end_date:r.start_date,end_time:r.start_time}:"datetimerange"===r.type&&(r={...r,type:"datetimerange",start_date:e.start_date,start_time:"datetime"===e.type?e.start_time:r.start_time})}if(i){const e=H(i,n,"end",a);if("datetime"===e.type)if("date"===r.type){const e={type:"daterange",start_date:r.start_date,end_date:r.start_date};r=u.bD(e,(0,m.r)())}else"daterange"===r.type&&(r=u.bD(r,(0,m.r)()));"date"===r.type||"daterange"===r.type?r={...r,type:"daterange",end_date:e.start_date}:"datetime"!==r.type&&"datetimerange"!==r.type||(r={...r,type:"datetimerange",end_date:e.start_date,end_time:"datetime"===e.type?e.start_time:"datetimerange"===r.type?r.end_time:r.start_time})}return c.qW(r)}function H(e,t,n,o){const i=z(e,t),r=N(e,t),a=q(e,t),s=E(t);let l;return l="start"===n?e.valueOf()>=r.valueOf()+(r.valueOf()-i.valueOf())/2?a:r:e.valueOf()>=r.valueOf()+(r.valueOf()-i.valueOf())/2?s?a:r:s?r:i,function(e,t,n){return E(t)?u.CQ(e.valueOf(),n):u.hT(e.valueOf(),n)}(l,t,o)}function K(e){const{environment:t,isFullScreen:n,isRootChild:o}=e;return(t.device.isDesktop||t.device.isTablet)&&(n||o)}function G(e){const{environment:t,format:n,isFullScreen:o,isRootChild:i}=e;return K({environment:t,isFullScreen:o,isRootChild:i})&&Boolean(n.timeline_show_table)}function $(e){const{isFullScreen:t,isRootChild:n}=e;return!t&&n&&G(e)}function Q(e){const{environment:t,paddingLeft:n,format:o,isFullScreen:i,isRootChild:r}=e;if(!G({environment:t,format:o,isFullScreen:i,isRootChild:r}))return 0;return n+(o.timeline_table_properties||[]).reduce(((e,t)=>(t.width&&t.visible?t.width:0)+e),0)}function Y(){const e=o.ou.now().setLocale(i.SP);return e.toLocaleString(o.ou.TIME_SIMPLE)===e.toLocaleString(o.ou.TIME_24_SIMPLE)}function J(e,t,n){return"day"===n?(0,d.Yx)(t,"month_day_long",e):"month"===n?(0,d.Yx)(t,"month_long",e):void(0,g.t1)(n)}function X(e,t){return"day"===t?(0,d.Yx)(e,"long",i.SP):"month"===t?(0,d.Yx)(e,"month_year_long",i.SP):void(0,g.t1)(t)}function ee(e,t){const n=u.NK(e,c.Ze(e)||(0,m.r)(),i.SP),{primaryDisplayUnit:o}=x[t],r="fifteen_minutes"===o||"hour"===o?"month_day_time":"month_day";return(0,d.Yx)(n.start.valueOf(),r,i.SP)}function te(e,t){const n=u.NK(e,c.Ze(e)||(0,m.r)(),i.SP),{primaryDisplayUnit:o}=x[t],r=(n.end||n.start).valueOf(),a="fifteen_minutes"===o||"hour"===o?"month_day_time":"month_day";return(0,d.Yx)(r,a,i.SP)}function ne(e,t){const n=u.NK(e,c.Ze(e)||(0,m.r)(),i.SP),{primaryDisplayUnit:o}=x[t],r="fifteen_minutes"===o||"hour"===o?"medium_with_time":"medium",a=(0,d.Yx)(n.start.valueOf(),r,i.SP);return n.end?`${a} â†’ ${(0,d.Yx)(n.end.valueOf(),r,i.SP)}`:a}function oe(e,t){return N(e,t)<e?q(e,t):e}function ie(e){return e.device.nativeScrollbarWidth>0||e.device.isFirefox||e.device.isPhone}function re(e){return!(e.device.isFirefox||e.device.isMobile)}function ae(e,t){const n=t.currentUser.id,o=e.getFormat().timeline_preference,i=Z(e.id),r=f.Z.get({userId:n,key:i}),a={zoomLevel:T,centerTimestamp:Date.now()};return se(r)||se(o)||a}function se(e){if(e&&"number"==typeof e.centerTimestamp&&p.H.includes(e.zoomLevel))return e}function le(e,t){let n=e.timeline_table_properties||[];if(t){n.find((e=>{let{visible:t}=e;return Boolean(t)}))||(n=(0,p.Rt)(n,"title",!0))}return{timeline_show_table:t,timeline_table_properties:n}}function ce(e){const{environment:t,collectionContextStore:n,timelineState:o,isFullScreen:i,isRootChild:r}=e,a=o.zoomLevel.state,s=n.normalizedFormatStore.state,l=G({environment:t,format:s,isFullScreen:i,isRootChild:r}),c=l&&s.timeline_table_properties?s.timeline_table_properties.length:0,d=s.timeline_properties||[],u=d.filter((e=>"title"!==e.property));return{zoom_level:a,show_table:l,show_table_properties_count:c,show_timeline_title:d.length!==u.length,show_timeline_properties_count:u.length}}const de=33,ue=66,pe=22,me=33,fe=4,ge=96;function he(e){return e?de:ue}function ve(e,t,n){if(!t)return[];const o=M(e);if(!o)return[];const i=t.getPropertyValue(o),r=n[o];return i&&r&&"relation"===r.type?(0,l.j$)({relationValue:(0,l.rq)(i),propertySchema:r,getRecordModel:t.getRecordModel}):[]}function be(e,t,n){var o;if(!t)return[];const i=null===(o=(0,h.wf)(e))||void 0===o?void 0:o.property;if(!i)return[];const r=t.getPropertyValue(i),a=n[i];return r&&a&&"relation"===a.type?(0,l.j$)({relationValue:(0,l.rq)(r),propertySchema:a,getRecordModel:t.getRecordModel}):[]}const ye=2,_e=40;function Se(e){const{timelineState:t,placeholderDate:n,subitemPlaceholderDate:o}=e,i=o??e.dateValue;if(!i)return;const r=t.zoomLevel.state,{snapUnit:a}=x[r],{startTimestamp:s,endTimestamp:l}=t.currentRange.state,{start:c,end:d}=O(i,a),u=d.valueOf()>s&&c.valueOf()<l,p=R(r,c.valueOf()-s)+ye,m=o?Math.max(p+_e,0):Math.max(p,0),f=R(r,d.valueOf()-s)-ye,g=R(r,l-s),h=Math.min(f,g),v=h/R(r,l-s);return{visible:u,isPlaceholder:Boolean(n),isExistingSubitemPlaceholder:Boolean(o),left:m,right:h,maskPercent:v}}},75330:(e,t,n)=>{n.d(t,{zz:()=>vt,TM:()=>ht,wG:()=>Pt,MO:()=>Rt,pi:()=>It,ME:()=>ot,NZ:()=>Lt,HW:()=>yt,dp:()=>it,ob:()=>Ye,IH:()=>Dt,tG:()=>nt,dj:()=>wt,lG:()=>Bt,oh:()=>Ct,rm:()=>Ut,C_:()=>_t,mS:()=>St,fI:()=>Et,A9:()=>bt,Wu:()=>rt,mc:()=>Qe,Ip:()=>mt,n1:()=>ft,W1:()=>Mt,bu:()=>Ot,f8:()=>Tt,t5:()=>Je,Z5:()=>At,Rm:()=>lt,$N:()=>dt,$D:()=>xt,xO:()=>ct,iG:()=>at,Uy:()=>pt,Es:()=>st,yc:()=>gt,z2:()=>ut,Ug:()=>Xe});n(57658),n(21703),n(52262),n(24506);var o=n(30120),i=n(1302),r=n(15145),a=n(92996),s=n(1898),l=n(21202);function c(e){switch(e){case"trending":case"similarUsers":case"mostVisited":case"lastEdited":case"favorites":return{title:{name:"Name",type:"title"}};case"myTasks":return{};default:(0,s.t1)(e)}}function d(e){let{source:t,collectionId:n}=e;const{type:o}=t;return{id:n,parent_table:l.iU,parent_id:o,version:1,alive:!0,space_id:t.spaceId,format:{},schema:c(o)}}var u=n(41432),p=n(50475),m=n(7289),f=n(14248),g=n(76205),h=n(14714),v=n(99036),b=n(43690),y=n(10070),_=n(28155),S=n(53877),w=n(93824),k=n(76837),I=n(6695),C=n(68626),x=n(42875),T=n(60310),M=n(15157),P=n(59753),A=n(45953),R=n(96367),D=n(98963),E=n(6287),B=n(13493),F=n(23867),O=n(54153),Z=n(70203),V=n(9291),U=n(53965),L=n(76870),j=n(37850),N=n(7032),z=n(15828),q=n(19584),W=n(952),H=n(54642),K=n(54569),G=n(5149),$=n(41433),Q=n(47307),Y=n(96802),J=n(94419),X=n(92625),ee=n(19785),te=n(9953),ne=n(4408),oe=n(75754),ie=n(32953),re=n(26999),ae=n(80402),se=n(98104),le=n(13447),ce=n(61202),de=n(53471),ue=n(27105),pe=n(28020),me=n(42),fe=n(97004),ge=n(75079),he=n(92918),ve=n(65183),be=n(26991),ye=n(77181),_e=n(27383),Se=n(33929),we=n(45950),ke=n(89796),Ie=n(77546),Ce=n(18245),xe=n(14654),Te=n(94841),Me=n(58202),Pe=n(74948),Ae=n(80444),Re=n(17746),De=n(77556),Ee=n(6776),Be=n(19511),Fe=n(88632),Oe=n(77080),Ze=n(79167),Ve=n(37598),Ue=n(53730),Le=n(6258),je=n(27724),Ne=n(81023),ze=n(10906);const qe=(0,V.defineMessages)({importingCSV:{id:"databaseViewActions.importingCSV.loadingMessage",defaultMessage:"Importing"},uploadingCSV:{id:"databaseViewActions.uploadingCSV.loadingMessage",defaultMessage:"Uploading"},importFailed:{id:"databaseViewActions.importFailedError.message",defaultMessage:"Import failed."}}),We=(0,V.defineMessages)({renameButtonTitle:{defaultMessage:"Rename",id:"database.collectionEditViewButtonPopup.renameButtonTitle"},statusName:{defaultMessage:"Status",id:"database.collectionEditViewButtonPopup.statusNameProperty"},dateName:{defaultMessage:"Date",id:"database.collectionEditViewButtonPopup.dateNameProperty"}}),He=(0,V.defineMessages)({currentSprintViewDefaultName:{defaultMessage:"Current Sprint",id:"collectionViewActions.typedView.currentSprintViewName"}}),Ke=10;function Ge(e,t){if(e||t){if(!e)return"add_filter";if(!t)return"remove_filter";if(!U.Xy(e,t)){if((0,g.aN)(e)&&(0,g.aN)(t))return e.property!==t.property?"change_filter":e.filter.operator!==t.filter.operator?"change_filter_operator":U.Xy(e.filter,t.filter)?void 0:"change_filter_value";if((0,g.Mm)(e)&&(0,g.Mm)(t))return e.timestamp!==t.timestamp?"change_filter":e.filter.operator!==t.filter.operator?"change_filter_operator":U.Xy(e.filter,t.filter)?void 0:"change_filter_value";if(!(0,g.vA)(e)||!(0,g.vA)(t))return"change_filter";{if(e.operator!==t.operator)return"change_filter_operator";function n(e){return(0,g.aN)(e)?`property/${e.property}`:(0,g.Mm)(e)?`property/${e.timestamp}`:(0,g.vA)(e)?`combinator/${e.operator}`:void(0,s.t1)(e)}const o=U.MR(e.filters??[],n),i=U.MR(t.filters??[],n),r=o.length,a=i.length;if(r<a)return"add_filter";if(a<r)return"remove_filter";for(let l=0;l<a;l++){const c=Ge(o[l],i[l]);if(c)return c}}}}}function $e(e,t){if(void 0===t)return;if(void 0===e)return"initial_load";if(!U.Xy(e.collectionView,t.collectionView))return"change_view";if(!U.Xy(e.loader.searchQuery,t.loader.searchQuery))return"change_search";if(!U.Xy(e.loader.sort,t.loader.sort))return"change_sort";const n=Ge(e.loader.filter,t.loader.filter);if(n)return n;const o=e.loader.reducers??{},i=t.loader.reducers??{};if(Object.keys(i).find((e=>{const t=o[e],n=i[e];return n&&(!t||!U.Xy(t,n))})))return"change_group";const r={reducers:void 0,filter:void 0,sort:void 0,reducerDependencies:void 0},a={...null==e?void 0:e.loader,...r},s={...null==t?void 0:t.loader,...r};return U.Xy(a,s)?void 0:"change_loader"}function Qe(e){const{environment:t,collectionViewBlockStore:n,collectionViewStore:a,collectionStore:l,collectionContextStore:c,isFullScreen:d,isRootChild:u,isInPeekRenderer:m}=e;Ye({collectionContextStore:c}),d&&(ie.Pg(t),ie.rM(t));const{remoteRequestStore:f,localResultStore:h}=c;if(a){var v;const e=Boolean(!c.isViewSpecificClientModeEnabled.state&&c.isClientModeEnabled.state&&l&&l.id===(null===(v=c.collectionStore())||void 0===v?void 0:v.id)),b=o.ou.fromMillis(Re.Z.getLocalDateRangeStart({collectionViewId:a.id,currentUserId:t.currentUser.id}));let y;const w=()=>{i.default.afterNextFlush((()=>{const e=f.state;c.isViewSpecificClientModeEnabled.state&&y&&e&&!U.Xy(y.loader.filter,e.loader.filter)&&(c.isClientModeEnabled.setState(!1),c.isViewSpecificClientModeEnabled.setState(!1));const o=$e(y,e);void 0===o||c.isClientModeEnabled.state&&!function(e,t,n,o){if(!n)return!1;if(null!=t&&t.loader.filter&&(0,g.SH)(null==t?void 0:t.loader.filter,(e=>(0,g.aN)(e)&&(0,R.zy)(e,n.getSchema()))))return!0;return(0,be.ki)(null==t?void 0:t.loader.reducers,n.getSchema(),o)}(0,e,l,n)||wt(t,c,{src:o}),y=e}))};f.addListener(w);const k=()=>{if((0,L.lB)(1)){const e=Ce.default.mark("database_update_lag");Ce.default.measureAfterNextFlush(e,{environment:t})}};h.addListener(k);const I=(0,pe.qG)(n.id);c.remoteResult.setState(void 0),c.remoteCollectionIds.setState([]),c.isLoaded.setState(!1),c.searchQuery.setState(""),c.searchOpen.setState(!1),c.calendarByMenuOpen.setState(!1),c.timelineByMenuOpen.setState(!1),c.isFullScreen.setState(d),c.isRootChild.setState(u),c.reducers.setState({}),c.groupsStore.reset(),c.groupsLimit.setState(he.XD),c.boardColumnsLimitStore.setState(he.XD),c.filtersBarOpen.setState(!!I||void 0),c.isInPeekRenderer.setState(m),c.subitemExpandedStore.setState(new Map),c.isClientModeEnabled.setState(e),c.isViewSpecificClientModeEnabled.setState(!1),c.asyncAggregationStatus.reset(),c.dateRangeStart.setState((0,S.IS)(b.startOf("month").valueOf(),pe.AK.state).valueOf()),c.dateRangeEnd.setState(d&&!t.device.isMobile?(0,S.V7)(b.endOf("month").plus({month:1}).valueOf(),pe.AK.state).valueOf():(0,S.V7)(b.endOf("month").valueOf(),pe.AK.state).valueOf());const C=null==a?void 0:a.getFormat(),x=null==C?void 0:C.collection_view_source;"typed"===(null==x?void 0:x.type)?c.setContext({type:"collectionTypedView",collectionViewBlockStore:n,databaseType:x.databaseType,collectionViewStore:a,pageVisitSourceOverride:(0,xe.ib)({blockOrCollectionId:n.id})}):(0,_.nx)(x)?l&&c.setContext({type:"collectionVirtualView",collectionViewBlockStore:n,collectionViewStore:a,collectionStore:l,pageVisitSourceOverride:(0,xe.ib)({blockOrCollectionId:a.id})}):x&&"collection"!==x.type?(0,s.t1)(x):c.setContext({type:"collectionView",collectionViewBlockStore:n,collectionStore:l,collectionViewStore:a}),c.remoteRequestStoreCallback=w,c.localResultStoreCallback=k;const T=Vt(a),P=_e.y.get(T);if(P){const e=0===P.resultSet.blockIds.size,t=c.getPageVisitSourceOverride();(t===r.tY.PersonalHomeTileTasks||t===r.tY.PersonalHomePageTasks)&&(e||_e.y.locallyMutatedTasksDatabase)?_e.y.locallyMutatedTasksDatabase=!1:(c.resetLoadingState(),c.resultSet.setState(U.Xh(P.resultSet)),c.remoteCollectionIds.setState(U.Xh(P.collectionIds)),c.remoteResult.setState(U.Xh(P.remoteResult)),c.isLoaded.setState(!0))}const A=Ue.transactionQueue.isPendingTransactionForRecord(a.pointer);c.wasCreatedThisSession.setState(A);const D=function(e){let{currentUserId:t,collectionViewId:n}=e;const o=M.Z.get({userId:t,key:Zt(n)});if(o)return(0,q.dj)(o)}({currentUserId:t.currentUser.id,collectionViewId:a.id});c.temporaryState.setState(D||{});const{currentSpaceStore:E}=Ae.default.state;if(l&&E&&l.getSpaceId()===E.id&&l.isDefaultRecordCache()&&!(0,p.EW)(n.getSystemBlockTypeStore().getValue())){!function(e){let{currentUserId:t,spaceId:n,collectionId:o}=e;const i=Bt({currentUserId:t,spaceId:n}),r=U.jj([o,...i]).slice(0,Ke);M.Z.set({userId:t,key:Ft(n),value:JSON.stringify(r)})}({currentUserId:t.currentUser.id,spaceId:E.id,collectionId:l.id})}d&&(l&&n.getCollectionViewSourceCollectionStore()&&!l.getName()?Mt({environment:t,collectionContextStore:c}):!l&&c.hasSingleCollection()&&G.r$({collectionContextStore:c,collectionSettingsStore:c.settingsStore})),c.frozoneStore.setState({isScrolled:!1,scrollerWidth:void 0,scrollerLeftOffset:void 0,frozenIndex:void 0,tryShowHiddenFrozenColumn:!1}),c.visitSessionId=(0,N.ZP)()}}function Ye(e){const{collectionContextStore:t}=e,{localResultStore:n,remoteRequestStore:o,remoteRequestStoreCallback:i,localResultStoreCallback:r}=t;i&&o.removeListener(i),r&&n.removeListener(r),t.infiniteScrollLongTaskObserver.disconnect()}function Je(e){const{dateRangeStart:t,dateRangeEnd:n,collectionContextStore:o}=e;o.dateRangeStart.setState(t),o.dateRangeEnd.setState(n)}function Xe(e){const{searchQuery:t,collectionContextStore:n}=e;n.collectionViewStore()&&(n.searchQuery.setState(t||""),n.groupsStore.resetAllLimits())}function et(e){const{environment:t,collectionViewBlockStore:n,collectionView:o,transaction:i}=e,r=te.ae({environment:t,table:B.np,value:o,inMemoryRecordCache:n.inMemoryRecordCache,transaction:i}),a=Le.Xr.createChildStore(n,{table:B.np,id:r.id,spaceId:n.getSpaceId()});return J.R3({parent:n.getCollectionViewsStore(),append:a,transaction:i}),a}function tt(e){const{environment:t,collectionStore:n,property:o,transaction:i}=e,r=n.getSchema()[o];if(!r||!v.D1(r))return;const a=(0,N.ZP)();te.ae({environment:t,table:D.cv,inMemoryRecordCache:n.inMemoryRecordCache,value:{id:a,parent_id:n.id,parent_table:n.table,alive:!0,space_id:n.getSpaceId(),status:"active",trigger:{id:(0,N.ZP)(),type:"button"}},transaction:i}),te.sW({store:n.getSchemaStore(),data:{[o]:{...r,automation_id:a}},transaction:i})}function nt(e){var t;const{environment:n,collectionContextStore:o,collectionViewStore:i,intl:r,transaction:s}=e,l=o.collectionViewBlockStore();if(!l)return;const c=i.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:t}=e;return t(i)}));if(!c)return;const d=(null===(t=c.format)||void 0===t?void 0:t.app_config_uri)===a.g3?Se.default.formatMessage(He.currentSprintViewDefaultName):(0,k.nM)(c.name||r.formatMessage(ze.b1[c.type]));return et({environment:n,collectionViewBlockStore:l,collectionView:{...c,id:(0,N.ZP)(),name:d},transaction:s})}function ot(e){var t,n;const{environment:o,collectionContextStore:r,transaction:a}=e,s=r.collectionViewBlockStore(),c=r.collectionViewStore(),d=r.settingsStore;if(!s)return;const u=null===(t=r.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.collection_default_arrows_by,p=et({environment:o,collectionViewBlockStore:s,collectionView:{type:"table",parent_id:s.id,parent_table:l.iU,alive:!0,space_id:s.getSpaceId(),format:{table_properties:null==c||null===(n=c.getFormat())||void 0===n?void 0:n.table_properties,timeline_arrows_by:u?{property:u}:void 0,table_subitem_toggle_column:"title",...c&&"collectionTypedView"===r.contextType?{collection_view_source:c.getFormat().collection_view_source,property_filters:c.getFormat().property_filters}:{}}},transaction:a});Tt({environment:o,collectionContextStore:r,collectionViewId:p.id,isFullScreen:r.isFullScreen.state,isRootChild:r.isRootChild.state,isInPeekRenderer:r.isInPeekRenderer.state}),i.default.afterNextFlush((()=>{s.getCollectionViewSourceCollectionStore()?(G.r$({collectionContextStore:r,collectionSettingsStore:d}),G.wl({collectionSettingsStore:d,item:{type:"createView"}})):G.r$({collectionContextStore:r,collectionSettingsStore:d})}))}function it(e){const{collectionViewBlockStore:t,collectionViewStore:n,transaction:o}=e,i=Le.Xr.createChildStore(t,{table:B.np,id:n.id,spaceId:t.getSpaceId()}),r=n.getFormat().app_config_uri;if(r){var a;const e=null===(a=t.getFormat())||void 0===a?void 0:a.app_uri_map;e&&delete e[r],Y.FH({stores:[t],update:{app_uri_map:e},transaction:o})}J.Od({parent:t.getCollectionViewsStore(),childToRemove:i,transaction:o})}function rt(e){const{collectionViewBlockStore:t,newViewIds:n,transaction:o}=e,i=t.getCollectionViewStores(),{beforeOps:r}=(0,w.q)(i.map((e=>e.id)).slice(0,n.length),n);U.Ed(r,((e,i)=>{const r=Le.Xr.createChildStore(t,{table:B.np,id:i,spaceId:t.getSpaceId()});if(e)J.Vt({parent:t.getCollectionViewsStore(),insert:r,before:Le.Xr.createChildStore(t,{table:B.np,id:e,spaceId:t.getSpaceId()}),transaction:o});else{const e=U.Z$(n.filter((e=>e!==i)));J.BE({parent:t.getCollectionViewsStore(),insert:r,after:e?Le.Xr.createChildStore(t,{table:B.np,id:e,spaceId:t.getSpaceId()}):void 0,transaction:o})}}))}function at(e){const{collectionViewStore:t,update:n,transaction:o}=e;te.sW({store:t,data:n,transaction:o})}function st(e){const{collectionViewStore:t,update:n,transaction:o}=e;te.sW({store:t.getQueryStore(),data:n,transaction:o})}function lt(e){const{environment:t,collectionStore:n,update:o,transaction:i}=e,r=n.getSchema();o.schema&&(o.schema=v.Fn(o.schema)),o.deleted_schema&&(o.deleted_schema=v.Fn(o.deleted_schema));const a={...o};if(o.deleted_schema){const e=n.getDeletedSchema(),t=(0,y.jf)({schemas:[e,o.deleted_schema],prioritizeLooserLimitRule:!0});t.error?C.log({level:"error",from:"collectionViewActions",type:"updateCollection",error:t.error}):a.deleted_schema=t.value}te.sW({store:n,data:a,transaction:i}),o.schema&&_t({environment:t,collectionStore:n,oldSchema:r,newSchema:o.schema,transaction:i})}function ct(e){const{environment:t,collectionStore:n,update:o,transaction:i}=e,r=n.getSchema(),a=v.Fn(o);te.sW({store:n.getSchemaStore(),data:a,transaction:i}),_t({environment:t,collectionStore:n,oldSchema:r,newSchema:n.getSchema(),transaction:i})}function dt(e){const{collectionStore:t,update:n,transaction:o}=e;te.sW({store:(0,Le._J)(t,t.pointer,["deleted_schema"]),data:n,transaction:o})}function ut(e){const{environment:t,collectionContextStore:n,newViewType:o,transaction:i,intl:r}=e,a=n.collectionViewStore(),s=n.collectionViewBlockStore(),l=n.collectionStore(),c=null==l?void 0:l.isSyncedCollection(),d=n.normalizedFormatStore.state;if(!a||!s)return;const u=n.normalizedSchemaStore.state;if(o===a.getType())return;const p=n.permissionScopes.state,f=a.getType();if(te.sW({store:a,data:{type:o},transaction:i}),"table"===o)te.sW({store:a.getQueryStore(),data:{aggregations:[]},transaction:i});else if("board"===o){var g;const e=a.getFormat().board_columns_by;let o=(null===(g=a.getFormat().collection_group_by)||void 0===g?void 0:g.property)??ze.Se(u);if(l&&!o){o=(0,z.ZP)();const e={name:r.formatMessage(We.statusName),type:"select",options:[]};p.canConfigureCollection&&ct({environment:t,collectionStore:l,update:{[o]:e},transaction:i})}const s=n.normalizedSchemaStore.state,c=o&&s[o];if(!o||!c||!(0,h.LG)(c))return;Y.FH({stores:[a],update:{board_columns_by:{...(0,h.fw)(o,c,"collectionTypedView"===n.contextType),disableBoardColorColumns:null==e?void 0:e.disableBoardColorColumns},collection_group_by:void 0},transaction:i})}else if("calendar"===o){let e=ze.PD(u);if(l&&!e){e=(0,z.ZP)();const n={name:r.formatMessage(We.dateName),type:"date"};p.canConfigureCollection&&ct({environment:t,collectionStore:l,update:{[e]:n},transaction:i})}te.sW({store:a.getQueryStore(),data:{aggregations:[],calendar_by:e},transaction:i})}else if("gallery"===o)Y.FH({stores:[a],update:{gallery_cover:{type:"page_content"}},transaction:i}),te.sW({store:a.getQueryStore(),data:{aggregations:[]},transaction:i});else if("list"===o){if(void 0===d.list_properties){const e=[{property:c?v.bf:v.iw,visible:!0}],t=Object.keys(u).find((e=>{const t=u[e];return Boolean(t&&(0,ve.Rb)(t))}));void 0!==t&&e.push({property:t,visible:!0}),Y.FH({stores:[a],update:{list_properties:e},transaction:i})}if(d.list_properties&&c){const e=d.list_properties.findIndex((e=>e.property===v.iw));if(-1!==e){const t=d.list_properties[e];d.list_properties[e]={...t,property:v.bf},Y.FH({stores:[a],update:{list_properties:d.list_properties},transaction:i})}}te.sW({store:a.getQueryStore(),data:{aggregations:[]},transaction:i})}else if("timeline"===o){let e=ze.HI(u);if(l&&!e){e=(0,z.ZP)();const n={name:r.formatMessage(We.dateName),type:"date"};p.canConfigureCollection&&ct({environment:t,collectionStore:l,update:{[e]:n},transaction:i})}te.sW({store:a.getQueryStore(),data:{aggregations:[],timeline_by:e},transaction:i})}else if("chart"===o){if(!a.getFormat().chart_config){const e=(0,m.K0)({collectionSchema:n.normalizedSchemaStore.state});Y.FH({stores:[a],update:{chart_config:e},transaction:i})}}const b=null==l?void 0:l.getFormat().subitem_property;if(b&&!(0,ye.Av)(o)){const e=f&&!(0,ye.Av)(o)?(0,I.oz)(f):void 0,t=(e?a.getFormat()[e]??[]:[]).find((e=>e.property===b))??{property:b,visible:!0},n=(0,I.oz)(o);if(n){const e=a.getFormat()[n]??[];Y.FH({stores:[a],update:{[n]:[...e,t]},transaction:i})}}mt({collectionContextStore:n})}function pt(e){const{icon:t,collectionViewStore:n,transaction:o}=e;Y.FH({stores:[n],update:{collection_view_icon:t},transaction:o})}function mt(e){const{collectionContextStore:t}=e,n=t.collectionViewBlockStore();if(!n)return;const o=Me.R.findCollectionViewBlockFromStore(n);null!=o&&o.resetLeftScrollAfterFlush&&o.resetLeftScrollAfterFlush()}function ft(e){const{collectionContextStore:t}=e,n=t.collectionViewBlockStore();if(n){const e=Me.R.findCollectionViewBlockFromStore(n);if(e){const t=e.getNode();t&&(0,Ie.Wr)(t,{edgeDist:0,animate:!1})}}}function gt(e){var t,n,o,i;const{collectionContextStore:r,collectionStore:a,transaction:s}=e,l=r.collectionViewStore();if(!l||!a.isDefined())return;const c=ze.Vv(a),d=null===(t=a.getFormat())||void 0===t?void 0:t.collection_default_arrows_by,u={table_properties:null==c||null===(n=c.getFormat())||void 0===n?void 0:n.table_properties,collection_pointer:{table:E.vF,id:a.id,spaceId:a.getSpaceId()},chart_config:null===(o=l.getFormat())||void 0===o?void 0:o.chart_config,timeline_arrows_by:d?{property:d}:void 0,table_subitem_toggle_column:"title"},p=null==r?void 0:r.normalizedSchemaStore.state;te.sW({store:l,data:(0,q.Q2)({format:u,query2:{sort:null==c||null===(i=c.getQuery(p))||void 0===i?void 0:i.sort}}),transaction:s})}function ht(e){var t;const{environment:n,name:o,collectionViewStore:i,collectionViewBlockStore:r,transaction:a}=e,s=i.getType();if(!s||!r.isDefined())return;const l=r.getCollectionPointer(),c=r.getFormat(),d=(0,Z.QaF)(null===(t=r.getTitleStore())||void 0===t?void 0:t.getValue()),p=l||o||!d?o:d,m=(0,me.Yu)({environment:n,isInline:r.getType()===u.Ti.collectionView,name:p,viewType:s}),f=A.Ao.create();f.set({table:B.np,id:"collection_view"},i.pointer),$.ZI({environment:n,sourceBlockId:"root",targetBlockPointer:r.pointer,sourceBlockSubtree:m?(0,A.R3)(m):A.Ak.create(),targetRecordCache:r.inMemoryRecordCache,transaction:a,recordPointerMap:f,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:r.useCrdt()});const g=f.get({table:E.vF,id:"collection"});if(!g)return;Y.FH({stores:[r],update:{collection_pointer:g},transaction:a});const h=r.getCollectionStore();h&&(lt({collectionStore:h,update:{icon:null==c?void 0:c.page_icon,cover:null==c?void 0:c.page_cover},environment:n,transaction:a}),Y.FH({stores:[h],update:{collection_cover_position:null==c?void 0:c.page_cover_position},transaction:a}))}function vt(e){const{collectionViewBlockStore:t,collectionStore:n,transaction:o}=e;if(!t.isDefined()||!n.isDefined())return;if(t.getCollectionPointer())throw new Error("CollectionViewBlock already has a collection");Y.FH({stores:[t],update:{collection_pointer:n.pointer},transaction:o})}function bt(e){const{collectionViewBlockStore:t,collectionStore:n,transaction:o}=e;if(!t.isDefined()||!n.isDefined())return;[t].forEach((e=>{var t;e.getCollectionViewStores().filter((e=>{var t;return(null===(t=e.getCollectionStore())||void 0===t?void 0:t.id)===n.id})).forEach((t=>it({collectionViewBlockStore:e,collectionViewStore:t,transaction:o}))),(null===(t=e.getFormat().collection_pointer)||void 0===t?void 0:t.id)===n.id&&(te.sW({store:e,data:{collection_id:null},transaction:o}),te.sW({store:e.getFormatStore(),data:{collection_pointer:null},transaction:o}))})),ee.hh({childStore:n,transaction:o})}function yt(e){const{environment:t,collectionStore:n,performTransaction:o}=e;return le.createAndCommit({userAction:"collectionViewActions.createSchemaUpdateTransaction",environment:t,perform:e=>{const i=n.getSchema(),r=o(e),a=n.getSchema();return _t({environment:t,collectionStore:n,oldSchema:i,newSchema:a,transaction:e}),r}}).performResult}function _t(e){const{environment:t,collectionStore:n,oldSchema:o,newSchema:i,transaction:r}=e,a=v.Fn(o),s=v.Fn(i),l=Object.keys(s);for(const d of l){const e=a[d],o=s[d];if(o){if("status"===o.type&&"status"!==(null==e?void 0:e.type)){let i;i="select"===(null==e?void 0:e.type)||"multi_select"===(null==e?void 0:e.type)?(0,f.r9)(o.name,e.options??[],Se.default.getIntl()):o.groups&&o.options&&o.defaultOption?o:v.I4(o.name,Se.default.getIntl());const a={...s,[d]:i};if(te.sW({store:n,data:{schema:a},transaction:r}),"checkbox"===(null==e?void 0:e.type)&&"status"===o.type){const e=i.groups??[],o=e[e.length-1];o&&K.hz({environment:t,collectionStore:n,property:d,oldValue:{type:"checkbox",value:!0},newValue:{type:"status",value:{type:"by_group",group:o.name}},transaction:r})}}if("status"===(null==e?void 0:e.type)&&"checkbox"===o.type){const o=e.groups??[],i=e.options??[],a=o[o.length-1],s=i.filter((e=>{var t;return null==a||null===(t=a.optionIds)||void 0===t?void 0:t.includes(e.id)}));for(const e of s)K.hz({environment:t,collectionStore:n,property:d,newValue:{type:"checkbox",value:!0},oldValue:{type:"status",value:{type:"by_option",option:e.value}},transaction:r})}}}for(const d of l){const e=a[d],o=s[d];!o||e&&v.cu(e)||!v.cu(o)||H.getSelectPropertyValues(t,{collection:{id:n.id,spaceId:(0,F.C)(n.pointer.spaceId)},property:d}).then((e=>{if("failed"===e.type)throw e.error;const{results:i}=e.data,r=o.options||[],a=v.Fn(n.getSchema()),s=U.mN([...r,...i.map((e=>({id:(0,z.ZP)(),value:e})))],(e=>e.value)),l={...o,options:s},c={...a,[d]:l};le.createAndCommit({userAction:"collectionViewActions.handleCollectionSchemaUpdated",environment:t,perform:e=>{te.sW({store:n,data:{schema:c},transaction:e})}})})).catch((()=>{}))}const c=U.jj([...Object.keys(a),...Object.keys(s)]);for(const d of c){const e=a[d],o=s[d],i=e&&v.cu(e)||"status"===(null==e?void 0:e.type),l=o&&v.cu(o)||"status"===(null==o?void 0:o.type);if(i&&l&&e.type===o.type){const i=o,a=e.options||[],s=i.options||[],l=U.jj([...a.map((e=>e.id)),...s.map((e=>e.id))]);for(const c of l){const i=a.find((e=>e.id===c)),l=s.find((e=>e.id===c));if(i&&l&&i.value!==l.value){const a="status"===e.type?{type:"status",value:{type:"by_option",option:i.value}}:{type:e.type,value:i.value},s="status"===o.type?{type:"status",value:{type:"by_option",option:l.value}}:{type:o.type,value:l.value};K.hz({environment:t,collectionStore:n,property:d,oldValue:a,newValue:s,transaction:r})}}}}for(const d of c){const e=s[d];"button"!==(null==e?void 0:e.type)||e.automation_id||tt({environment:t,collectionStore:n,property:d,transaction:r})}}function St(e){const{store:t,environment:n}=e;let o;de.cR({environment:n,bucket:"temporary",onStart:e=>{o=e,X.j({message:qe.uploadingCSV})},onComplete:e=>{(async(e,o)=>{X.j({message:qe.importingCSV});const i=t.getCollectionViewCollectionStore();if(!i)return;if(!Me.R.findCollectionViewBlockFromStore(t))return;const{value:r}=await H.importFile(n,{importType:"MergeIntoCollection",fileURL:e,fileName:o,collection:{id:i.id,spaceId:(0,F.C)(i.pointer.spaceId)}}).next();r.error&&Q.showErrorMessage(Se.default.formatMessage(qe.importFailed)),X.x()})(e[0],o[0].name)},onError:e=>{X.x(),Q.showErrorMessage(Se.default.formatMessage(qe.importFailed))}})}async function wt(e,t,n){const o=t.collectionViewStore(),{remoteRequestStore:i}=t;if(!i||!o)return;const r=i.state;if(!r)return;const s=t.createUpdateCounter(),c=t.remoteResult.state;Fe.Z.state.online&&c&&await Ue.transactionQueue.drain();const d=o.inMemoryRecordCache;if(!t.shouldUpdate(s))return;t.isLoading.setState(!0);const u=Ce.default.mark("collections.remote_query_collection_latency");let p;if(d===e.defaultRecordCache.inMemoryRecordCache&&Fe.Z.state.online){const i="initial_load"===n.src?(0,ve.Cg)(r):r,a=Oe.default.getEligibleGroup({experimentId:"collection_querying",defaultGroup:"unassigned"});"unassigned"!==a&&(i.requestBackend=a);const l=[];if("on"===Oe.default.getEligibleGroup({experimentId:"collection_split_aggregation_v3",defaultGroup:"unassigned"})&&"msg"!==n.src&&"chart"!==o.getType()&&!Object.values(i.loader.reducers||{}).some((e=>"groups"===e.type))){let o=!1;const a={};Object.entries(i.loader.reducers||{}).forEach((e=>{let[t,n]=e;"aggregation"!==n.type?a[t]=n:o=!0}));const c={...i,loader:{...i.loader,reducers:a},aggregationStatus:o?"stripped":void 0};if(p=H.queryCollection(e,c,void 0,n,void 0,"queryCollection").then((i=>{const a=ge.vS(t,n.src);if(Ce.default.measure(u,{environment:e,data:a}),"success"===i.type)return"initial_load"===n.src&&O.Z.set((0,ke.Z)(r.collectionView.id),c),kt({environment:e,remoteRequest:r,collectionContextStore:t,response:i.data,updateCounter:s,keepAggregationResults:o})})),l.push(p),o){t.asyncAggregationStatus.setState({...t.asyncAggregationStatus.state,calculating:!0});const o=p.then((()=>H.queryCollection(e,{...r,aggregationStatus:"full"},void 0,n,void 0,"queryCollection").then((n=>{if("success"===n.type)return kt({environment:e,remoteRequest:r,collectionContextStore:t,response:n.data,updateCounter:s})})).finally((()=>{t.asyncAggregationStatus.setState({calculating:!1})}))));l.push(o)}}else p=H.queryCollection(e,i,void 0,n,void 0,"queryCollection").then((o=>{const i=ge.vS(t,n.src);if(Ce.default.measure(u,{environment:e,data:i}),"success"===o.type)return"initial_load"===n.src&&O.Z.set((0,ke.Z)(r.collectionView.id),r),t.asyncAggregationStatus.setState({calculating:!1}),kt({environment:e,remoteRequest:r,collectionContextStore:t,response:o.data,updateCounter:s})})),l.push(p);if(!(await(0,j.OI)(1e4,l)).timeout)return}else try{const n=await async function(e,t,n){const{source:o,collectionView:i,loader:r}=t,s=e.currentUser.id;let c;if("collection"!==o.type)throw new Error("TODO: support typed source");c={table:E.vF,id:o.id};const d=Date.now(),u=await we.Ye({environment:e,pointer:c,inMemoryRecordCache:n});if(null==u||!u.model)throw new Error("Collection not found.");const p=u.model,m=await we.Ye({environment:e,pointer:{table:B.np,id:i.id},inMemoryRecordCache:n});if(null==m||!m.model)throw new Error("Collection view not found.");const f=P.s8.fromMonomorphicFunctionUnsafe((async t=>{const n=await we.Ye({environment:e,pointer:t});return null==n?void 0:n.model})),g=m.model,h=A.Ak.create(),v=P.om.fromRecordMap(h),y=p.getNormalizedSchema(),{groupsReducerIds:_,reducerIdsWithNoGroupDependencies:S}=b.x3(r.reducers,r.reducerDependencies),w=Oe.default.getConfigKey("collection_request_settings","clientFormulaTimeoutMs"),k=Oe.default.checkGate("better_database_text_sorts"),I={schema:y,pageSort:(null==g?void 0:g.getPageSort())||[],collectionViewId:i.id,loader:r,userId:s,userStartOfWeek:pe.AK.state,currentTime:d,getRecordModel:v,intl:Se.default.getIntl(),isSorted:!1,relativeVariableResult:void 0,isSprintPlanningView:(null==g?void 0:g.getAppConfigUri())===a.sV,collectionSourceType:o.type,groupsReducerIds:_,reducerIdsWithNoGroupDependencies:S,formulaTimeoutMs:w,resultCache:new Map,useImprovedSort:k},C=p.__IM_SORRY__getValue(),x=b.fk(I),T=(await we.ne({environment:e,collection:p,inMemoryRecordCache:n})).filter((e=>{let{model:t}=e;return null==t?void 0:t.alive})),M=U.oA(T.map((e=>{let{model:t}=e;return null==t?void 0:t.__IM_SORRY__getValue()}))),R=(r.reducers?Object.values(r.reducers):[]).some((e=>Boolean("results"===e.type&&e.loadContentCover))),D=new Map,F={};M.forEach((e=>F[e.id]=p));const O=g.getFormat(),Z=g.getType(),V=O&&Z&&b.ps(O,Z,y),L=await b.Ct({collectionValueOrModel:C,loader:r,loadAllProperties:!1,recordMap:h,loadRecordModel:f,dependencyCache:D,searchProperties:V});await b.c_({blocks:M,dependencies:L,blockIdToAssociatedCollectionModelCache:F,recordMap:h,loadRecordModel:f,dependencyCache:D,resultCache:I.resultCache}),R&&await b.jF({blocks:M,loadRecordModel:f,recordMap:h});for(const a of M)b.BW(a,C,I,x);const{result:j}=b.kk(I,x),N=A.PF.create(),z=b.aW({result:j});return await Promise.all(z.map((async t=>{const o=await we.Ye({environment:e,pointer:{table:l.iU,id:t},inMemoryRecordCache:n});o&&N.setModelAndRole({table:l.iU,id:t},o.model,o.role)}))),N.setModelAndRole(c,u.model,u.role),N.setModelAndRole({table:B.np,id:i.id},m.model,m.role),{result:j,recordMap:N.toJson({allowVersionDowngrade:!1}),relativeVariableResult:void 0,collectionIds:void 0,shouldUseClientMode:!1,isViewSpecificClientMode:!1,allBlockIds:void 0}}(e,r,d),o=A.PF.create(n.recordMap);ne.fL({environment:e,inMemoryRecordCache:d,recordMap:o,debugSource:"collectionViewActions.fetchRemoteResult (localResponse)"}),kt({environment:e,collectionContextStore:t,remoteRequest:void 0,response:n,updateCounter:s})}catch(m){}finally{t.resetLoadingState()}p&&p.catch((e=>{}))}function kt(e){const{environment:t,remoteRequest:n,collectionContextStore:o,response:i,updateCounter:r,keepAggregationResults:a}=e,s=o.collectionViewStore();if(!o.shouldUpdate(r))return;const l=o.remoteResult.state;if(!l||!U.Xy(l,i.result)){const e=i.result;if("reducer"===i.result.type){if(a){const t=Object.entries((null==l?void 0:l.reducerResults)||{}).filter((e=>{let[t,n]=e;return"aggregation"===n.type})).reduce(((e,t)=>{let[n,o]=t;return e[n]=o,e}),{});e.reducerResults={...t,...e.reducerResults}}o.remoteResult.setState(e)}if(i.shouldUseClientMode)o.isClientModeEnabled.setState(!0),o.isViewSpecificClientModeEnabled.setState(Boolean(i.isViewSpecificClientMode)),o.resultSet.resetWithRemote(i.allBlockIds);else{const e=new Set(b.aW({result:i.result,onlyTypes:["results"]}));o.resultSet.resetWithRemote(e)}}const c=o.remoteCollectionIds.state,d=i.collectionIds||[];U.Xy(c,d)||o.remoteCollectionIds.setState(d),Ze.Z.addFromRecordMapWithRoleJson(i.recordMap),Ze.Z.isEmpty()||ce.dY({environment:t}),o.relativeVariables.setState({...o.relativeVariables.state,...i.relativeVariableResult});if(o.remoteResult.state&&(o.resetLoadingState(),o.isLoaded.setState(!0),o.lastRemoteRequest.setState(n),s)){const e=Vt(s);_e.y.set(e,{remoteResult:o.remoteResult.state,resultSet:o.resultSet.state,collectionIds:o.remoteCollectionIds.state})}}function It(e,t){const{blockIds:n,hasLocalUpdates:o}=t.resultSet.state,i=t.collectionViewStore(),r=e.currentUser.id,c=t.remoteRequestStore.state,u=t.remoteResult.state;if(!i||!i.isDefined()||!c)return;const p=Date.now(),m=Se.default.getIntl(),f=i.getRecordModel,g=i.getFormat(),h=i.getType(),v=i.getCollectionSource();if(!v)return;const S=t.collectionStoresStore.state,w=[];for(const a of S){const e=f(a);e&&w.push(e)}if(0===w.length)return;t.isLoaded.setState(!1);const k=w.some((e=>Ve.Z.getEditedBlocksForCollection(e.id).size>0)),I=U.Xy(t.lastRemoteRequest.state,c);if(!k&&u&&!o&&I)return t.isLoaded.setState(!0),u;const C=Ce.default.mark("collections.compute_local_result_latency");let x={};switch(t.contextType){case"collectionTypedView":const e=(t.databaseType&&(0,a.uV)(m))??{},n=(0,y.jf)({schemas:[...w.map((e=>{var t;const n=null==e||null===(t=e.getFormat())||void 0===t?void 0:t.app_uri_map,o=e.getNormalizedSchema();return y.aQ.toViewSchema(o,n)})),e],onlyPropertyIds:Object.keys(e),prioritizeLooserLimitRule:!0});if(n.error)throw n.error;x=n.value;break;case"collectionVirtualView":case"collectionView":case"collectionViewBlock":case"collectionPage":case void 0:x=w[0].getNormalizedSchema();break;default:(0,s.t1)(t.contextType)}const M=b.ps(g,h,x),A=t.relativeVariableStore.state,{groupsReducerIds:R,reducerIdsWithNoGroupDependencies:D}=b.x3(c.loader.reducers,c.loader.reducerDependencies),E=Oe.default.getConfigKey("collection_request_settings","clientFormulaTimeoutMs"),B=Oe.default.checkGate("better_database_text_sorts"),F={pageSort:i.getPageSort(),schema:x,loader:c.loader,userId:r,userStartOfWeek:pe.AK.state,currentTime:p,getRecordModel:Ae.default.getCurrentBlockModelFn(),intl:Se.default.getIntl(),isSorted:!1,visibleProperties:M,relativeVariableResult:A,isSprintPlanningView:g.app_config_uri===a.sV,collectionSourceType:v.type,groupsReducerIds:R,reducerIdsWithNoGroupDependencies:D,formulaTimeoutMs:E,resultCache:new Map,useImprovedSort:B},O={...F,loader:{...c.loader,filter:void 0}},Z=u?new Set(b.aW({result:u,onlyTypes:["results"]})):new Set,V=b.fk(F);for(const a of n){const e=Le.G.createChildStore(i,{table:l.iU,id:a}),n=e.getAssociatedCollectionStore();if(_.Sl.hasCollections(v)&&(!n||!S.find((e=>{let{id:t}=e;return n.id===t}))))continue;const o=f(e);let r;switch(t.contextType){case"collectionVirtualView":if((0,_.nx)(v)){const e=(0,Te.Ep)((0,T.Eq)(v));r=e&&P.kk.fromCollection(d({source:v,collectionId:e}))}break;case"collectionTypedView":case"collectionView":case"collectionPage":case"collectionViewBlock":case void 0:r=n&&f(n);break;default:(0,s.t1)(t.contextType)}if(!r||!o)continue;const u={...c.loader.upwardTraversalRelation&&Z.has(a)&&(0,ye.uU)({block:P.kk.fromBlock(o),collectionContextStore:t})&&!t.isClientModeEnabled.state?O:F,schema:(0,y.Hs)(v.type,x,r)};b.BW(o,r,u,V)}for(const a of w){const e=Ve.Z.getEditedBlocksForCollection(a.id),t=(0,y.Hs)(v.type,x,a);for(const o of e){if(n.has(o))continue;const e=f(Le.G.createChildStore(i,{table:l.iU,id:o}));e&&b.BW(e,a,{...F,schema:t},V)}}const{result:L}=b.kk(F,V);if(t.isLoaded.setState(!0),"reducer"!==L.type)return;const j=ge.vS(t);return Ce.default.measure(C,{environment:e,data:j}),L}function Ct(e,t){const n=t.collectionViewStore(),o=t.searchQuery.state;if(!n)return;const i=t.currentSubitemFormatStoreForUiDisplay.state,r=null==n?void 0:n.getType(),a=(0,fe.ze)(t,!0),s=t.currentSortsStore.state,l=function(e){const t=e.reducers.state,n={};return U.Ed(t,((e,t)=>{e&&(n[t]=e.reducer)})),n}(t);if(U.xb(l))return;let c;if(t.reducerDependencies.size>0){c={};for(const[e,n]of t.reducerDependencies)c[e]=[...n]}const d=(0,F.C)(n.pointer.spaceId),u=n.getCollectionSource();if(!u)return;const p=t.normalizedSchemaStore.state,m=(null==i?void 0:i.property)&&p[i.property];return{source:u,collectionView:{id:n.id,spaceId:d},loader:{reducers:l,filter:a,sort:s,searchQuery:o,userId:e.currentUser.id,userTimeZone:(0,x.r)(),...m&&(0,v.p_)(m)&&r&&(0,ye.Av)(r)&&{upwardTraversalRelation:m},reducerDependencies:c}}}function xt(e){const{reducerId:t,instanceId:n,reducer:o,collectionContextStore:i,groupsPointer:r}=e,a=i.reducers.state,s=a[t];let l,c;if(r&&r.length>0&&(l=(0,h.KW)(r)),o){if(c={instanceIds:n?U.jj([...(null==s?void 0:s.instanceIds)||[],n]):(null==s?void 0:s.instanceIds)||[],reducer:o},l){i.reducerDependencies.has(l)||i.reducerDependencies.set(l,new Set);const e=i.reducerDependencies.get(l);null==e||e.add(t)}}else{if(l){const e=i.reducerDependencies.get(l);e&&(e.delete(t),0===e.size&&i.reducerDependencies.delete(l))}const e=n?U.zu((null==s?void 0:s.instanceIds)||[],n):(null==s?void 0:s.instanceIds)||[];c=s&&e.length>0?{instanceIds:e,reducer:s.reducer}:void 0}U.Xy(s,c)||i.reducers.setState({...a,[t]:c})}function Tt(e){const{environment:t,collectionViewId:n,openInNew:o,collectionContextStore:i,isFullScreen:a,isRootChild:s,isInPeekRenderer:l}=e,c=i.collectionViewBlockStore();if(c){if(c===Ae.default.state.mainEditorCurrentBlockStore||o)oe._c({environment:t,store:c,openInNew:o,collectionViewId:n,pageVisitSource:r.tY.ChangeCollectionView});else{const e=new Le.Xr(t,{table:B.np,id:n},{inMemoryRecordCache:c.inMemoryRecordCache}),o=e.getCollectionStore();Qe({environment:t,collectionViewBlockStore:c,collectionViewStore:e,collectionStore:o,collectionContextStore:i,isFullScreen:a,isRootChild:s,isInPeekRenderer:l}),M.Z.set({userId:t.currentUser.id,key:De.Z.getLocalViewPreferenceKey(c.id),value:n})}mt({collectionContextStore:i})}}function Mt(e){const{environment:t,collectionContextStore:n}=e;let o=n.collectionStore();const i=n.collectionViewBlockStore();if(!o||!i)return;const{mainEditorCurrentBlockStore:r}=Ae.default.state;r&&n.isFullScreen.state&&(o=Le.NW.createChildStore(r,o.pointer)),se.mT({environment:t,store:o.getNameStore(),canSelectAllBlocks:!1})}function Pt(){ae.MO(),function(){const e=Be.Z.state,t=je.default.state;if(e.isActive&&1===t.stores.length&&t.stores[0].id===e.store.id)return;Rt()}()}function At(e){const{store:t,transient:n}=e;Be.Z.setState({isActive:!0,store:t,transient:Boolean(n)})}function Rt(){Be.Z.setState({...Be.Z.state,isActive:!1})}function Dt(e){const{store:t}=e;"new"===Ee.Z.state.editMode&&Ee.Z.state.store.id===t.id&&Ee.Z.reset()}async function Et(e){const{environment:t,collectionContextStore:n,blockIdToMinimumVersion:o}=e;await async function(e,t){return await Promise.all((0,s.qP)(t).map((async t=>{let[n,o]=t;return ne.bG({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:{table:l.iU,id:n},userId:e.currentUser.id,minimumVersion:o})})))}(t,o),n.resultSet.addLocalChange(Object.keys(o))}function Bt(e){let{currentUserId:t,spaceId:n}=e;const o=M.Z.get({userId:t,key:Ft(n)});if(o){const e=(0,q.dj)(o);return Array.isArray(e)?e:[]}return[]}function Ft(e){return`getRecentlyNavigatedCollections:${e}`}function Ot(e){let{currentUserId:t,collectionViewId:n,temporaryState:o}=e;const i=Zt(n);o?M.Z.set({userId:t,key:i,value:JSON.stringify(o)}):M.Z.remove({userId:t,key:i})}function Zt(e){return`collectionViewTemporaryState2:${e}`}function Vt(e){const t=e.id,n=e.getCollectionSource();return"trending"===(null==n?void 0:n.type)?{collectionViewId:t,teamId:n.teamId}:{collectionViewId:t}}function Ut(e){var t;const{store:n,typedDatabases:o,environment:i,event:r}=e,a=ze.fm(n);if(!(0,Ne.M_)(i))return;i.device.isMobile&&Pe.close();const s=null===(t=n.getCollectionViewStores().at(0))||void 0===t?void 0:t.id;if(!a&&!s)return;const l=a??new De.Z(i);if(!a&&s){const e=Le.Xr.createChildStore(n,{table:B.np,id:s});Qe({environment:i,collectionViewBlockStore:n,collectionViewStore:e,collectionStore:void 0,collectionContextStore:l,isFullScreen:!0,isRootChild:!0,isInPeekRenderer:!1}),l.remoteCollectionIds.setState(o.map((e=>e.id)))}else 0===l.collectionStoresStore.state.length&&l.remoteCollectionIds.setState(o.map((e=>e.id)));le.createAndCommit({userAction:"collectionViewActions.handleAddMultiSourceViewPageButtonClick",environment:i,perform:e=>{var t;Lt({transaction:e,store:n,collectionContextStore:l,environment:i,shouldCoerce:!0,showMoveTo:!0,peekModeOverride:"center_peek",from:"sidebar_new_page_button",useCrdt:(0,ue.SL)({event:r,source:"collection_unknown_view",contextualDefault:null===(t=l.defaultPageTemplateStore.getState())||void 0===t?void 0:t.useCrdt()})})}})}function Lt(e){const{transaction:t,store:n,collectionContextStore:o,environment:i,shouldCoerce:a,showMoveTo:s,peekModeOverride:l,from:c,useCrdt:d}=e,u=K.IW({environment:i,collectionContextStore:o,groupsPointer:[],insertAtIndex:0,shouldCoerce:a,initializeDefaultTemplate:a,transaction:t,from:c,useCrdt:d});if(!u)return;let p=ze.kr(o);l&&(p=l);const m=(0,pe.qG)(n.id),f="collectionTypedView"===o.contextType,g=o.isCompactView.state;re.CH({environment:i,store:u.newStore,peekMode:p,showMoveTo:s,resultsStore:void 0,collectionContextStore:o,pageVisitSource:m?g?r.tY.PersonalHomeTileTasksCreate:r.tY.PersonalHomeTasksCreate:r.tY.Create});const h=f?u.newStore.getAssociatedCollectionId():void 0;return W.W(i,{from:c,type:"page",new_page_id:u.newStore.id,creating_block_id:u.newStore.id,...ge.Pn(o,h)}),u.newStore}},20616:(e,t,n)=>{n.d(t,{F:()=>c});n(67294);var o=n(480),i=n(24405),r=n(62760),a=n(79362),s=n(65183),l=n(85893);function c(e){const{device:t}=(0,o.O7)(),n=(0,i.Fg)(),{color:c,viewIcon:d,viewType:u,size:p,style:m}=e,f=function(e){return{regular:e.regularTextColor,light:e.mediumTextColor,gray:a.Lr[e.mode].gray,lightGray:a.Lr[e.mode].lightgray,blue:e.blueColor}}(n)[c];return u?d?(0,l.jsx)(r.Z,{style:{fill:f,backfaceVisibility:void 0,...m},size:p??(t.isMobile?18:16),theme:n,icon:d}):s.aW[u]({width:p??(t.isMobile?18:16),height:p??(t.isMobile?18:16),backfaceVisibility:void 0,fill:f,...m}):null}},41393:(e,t,n)=>{n.d(t,{Z:()=>C});var o=n(67294),i=n(73935),r=n(480),a=n(86628),s=n(15145),l=n(26249),c=n(26189),d=n(75754),u=n(993),p=n(32741),m=n(68709),f=n(24813),g=n(66213),h=n(14976),v=n(83105),b=n(84210),y=n(73819),_=n(46735),S=n(22294),w=n(72014),k=n(85893);function I(e,t){const n=(0,r.O7)(),l=(0,o.useContext)(g.ZO),I=(0,o.useRef)(null),C=(0,o.useRef)(null),x=(0,y.PE)(e.store,e.disabled),T=(0,y.rv)(e.store),M=(0,o.useCallback)((()=>{_.Z.recordVisit({id:e.store.id,systemBlockType:e.store.getSystemBlockTypeStore().getValue(),type:v.vu.Link,currentUserId:n.currentUser.id}),c.SK(n,{page_visit_id:w.$g.getCurrentPageVisitId(),mentioned_page_id:e.store.id,source_type:"collection_view_page_block",hover_preview_enabled:!0,is_navigable_block:e.store.isNavigableBlock()})}),[n,e.store]),P=(0,o.useCallback)((()=>{if(!C||!C.current)return;const t=i.findDOMNode(C.current);return(0,h.We)(e.store,t)}),[e.store]),A=(0,o.useCallback)((t=>{const o=P(),i=e.store.getTitleStore();i&&o&&u.Nh({environment:n,event:t,interactiveToken:o,store:i,canEdit:x})}),[x,n,P,e.store]),R=(0,o.useCallback)((t=>{const o=P(),i=e.store.getTitleStore();i&&o&&u.Zl({environment:n,event:t,interactiveToken:o,store:i,canEdit:x})}),[x,n,P,e.store]),D=(0,o.useCallback)((()=>{if(l){const t=(0,b.ZP)({store:e.store,pageVisitSource:s.tY.Create});l(t)}else d._c({environment:n,store:e.store,visitType:v.vu.Link,pageVisitSource:s.tY.Create})}),[n,l,e.store]);(0,o.useEffect)((()=>()=>{p.qA(e.store.getTitleStore())}),[e.store]);const E=(0,a.VK)((()=>{const t=e.store.getCollectionViewSourceCollectionStore();return null==t?void 0:t.isSyncedCollection()}),[e.store]),B=(0,a.VK)((()=>e.store.isCollectionViewAlias()||e.store.recordStoreParentDiffersFromPersistedParent()),[e.store]);return(0,y.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"collection_view_page",getNode:()=>I.current,getBlockStore:()=>e.store,activate:D,handleCreated(){D(),S.Z.setKeyboardMode(!1)}})),[D,e.store]),(0,k.jsx)(m.p,{allowSelectionWithin:!1,onMouseOver:A,onMouseOut:R,children:(0,k.jsx)(f.Z,{ref:C,store:e.store,style:{...T,...e.style},isAlias:B,disabled:Boolean(e.disabled||E),onClick:M})}))}const C=o.memo(o.forwardRef(I),l.Z)},10906:(e,t,n)=>{n.d(t,{Bm:()=>Fe,Bs:()=>ue,Cc:()=>me,Ch:()=>ye,D:()=>he,D2:()=>ae,D8:()=>Q,HI:()=>G,Ks:()=>ce,L5:()=>be,Mq:()=>N,NG:()=>oe,NU:()=>te,PD:()=>K,PI:()=>W,Ql:()=>De,SY:()=>Te,Sc:()=>Ie,Se:()=>H,VM:()=>re,Vv:()=>fe,XO:()=>_e,YG:()=>we,YL:()=>ve,_5:()=>de,az:()=>ie,b1:()=>Be,bW:()=>Ee,bd:()=>ne,bu:()=>z,eD:()=>ge,en:()=>le,fk:()=>Ae,fm:()=>Pe,kr:()=>ke,mb:()=>xe,p1:()=>se,pB:()=>Ce,rD:()=>pe,v_:()=>Re,w0:()=>Se,wK:()=>ee,xy:()=>Y,zm:()=>$});n(57658),n(21703);var o=n(15145),i=n(41892),r=n(41432),a=n(99036),s=n(80951),l=n(43690),c=n(93824),d=n(76837),u=n(95538),p=n(6695),m=n(98963),f=n(21202),g=n(6287),h=n(13493),v=n(70203),b=n(9291),y=n(31701),_=n(53965),S=n(7032),w=n(15828),k=n(51592),I=n(35541),C=n(28020),x=n(4708),T=n(48543),M=n(84210),P=n(33929),A=n(50627),R=n(85957),D=n(17311),E=n(58202),B=n(49427),F=n(24646),O=n(80444),Z=n(77080),V=n(88923),U=n(6258),L=n(27724),j=n(51247);const N={showDelay:500,showHold:100},z=new Set(["gallery","list","calendar"]),q=(0,b.defineMessages)({addTypedItemTitle:{id:"collectionViewBlock.action.newItem.typedDatabaseTitle",defaultMessage:"New {singleItemName}"},addItemTitle:{id:"collectionViewBlock.action.newItem.nonTypedDatabaseTitle",defaultMessage:"New"}});function W(e){return"collectionTypedView"===e.contextType?P.default.formatMessage(q.addTypedItemTitle,{singleItemName:(0,k.sN)(e.databaseType)}):P.default.formatMessage(q.addItemTitle)}function H(e){const t=Object.keys(e);return t.find((t=>{const n=e[t];return Boolean(n&&"status"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"select"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"person"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"multi_select"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"relation"===n.type)}))}function K(e){const t=Object.keys(e);return t.find((t=>{const n=e[t];return Boolean(n&&"date"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"created_time"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"last_edited_time"===n.type)}))}function G(e){return Object.keys(e).find((t=>{const n=e[t];return Boolean(n&&"date"===n.type)}))}function $(e){const{collectionId:t,schema:n,property:o,targetCollectionStore:i}=e,r=n[o];if(!r)return;const l={newSchema:{...n,[o]:void 0},deletedSchema:{[o]:n[o]}};if("relation"===r.type&&a.F0(r)&&r.property&&!(0,s.Kp)(r))if(a.F0(r)===t&&r.property!==o){const e={...l.newSchema,[r.property]:void 0},t={...l.deletedSchema,[r.property]:n[r.property]};l.newSchema=e,l.deletedSchema=t}else if(a.F0(r)!==t&&null!=i&&i.canEditCollection()&&i.isDefined()){const e=a.oC({id:i.id,schema:i.getSchema(),format:i.getFormat(),space_id:i.getSpaceId()}),t={...e,[r.property]:void 0},n={[r.property]:e[r.property]};l.otherCollectionId=i.id,l.otherCollectionSchema=t,l.otherCollectionDeletedSchema=n}return l}function Q(e){const{deletedSchema:t,property:n}=e;if(t[n])return{updateSchema:{[n]:t[n]},updateDeletedSchema:{[n]:null}}}async function Y(e){const{schema:t,properties:n,property:o,parentStore:i,spaceId:r}=e,s=t[o];if(!s)return;if(a.dx(s))return;const l=(0,w.ZP)(),c={...s,name:(0,d.nM)(s.name)},u=n.findIndex((e=>e.property===o)),p=n[u],f={property:l,visible:!0,width:p&&p.width},g=[...n];let h;if(g.splice(u+1,0,f),"button"===c.type&&c.automation_id){const e=U.Mz.createChildStore(i,{id:c.automation_id,spaceId:r,table:m.cv});await e.load();const t=e.getActionStores();await Promise.all(t.map((e=>e.load())));const n=(0,S.ZP)();c.automation_id=n,h={sourceAutomationStore:e,targetAutomationId:n}}return{newProperty:l,newPropertySchema:c,newProperties:g,automationUpdate:h}}function*J(e){const{rootStore:t,depth:n=0}=e;if(t.getType()===r.Ti.transclusionReference){const e=t.getTransclusionReferenceTargetStore();e&&(yield*J({rootStore:e,depth:n}))}else{const e=t.getContentStores();for(const t of e)yield{blockStore:t,depth:n},t.isNavigableBlock()||(yield*J({rootStore:t,depth:t.getType()===r.Ti.columnList||t.getType()===r.Ti.column||t.getType()===r.Ti.transclusionContainer||t.getType()===r.Ti.transclusionReference?n:n+1}))}}function X(e){const{rootStore:t,renderAdditionalBlocks:n,startBlockId:o,tableRenderMode:i}=e,a={image:void 0,blocks:[],isDefined:!0},s=J({rootStore:t});let c=0,d=0,p=!1;for(const{blockStore:m,depth:f}of s){if(o&&!p){if(m.id!==o)continue;p=!0}if(c++,c>l.C7)return a;m.isDefined()||(a.isDefined=!1);const e=m.getType(),t=m.getModel();if(!e||!t)continue;const s=m.getProperties();if(t.isType(r.Ok)&&!a.image&&s){const t=(0,v.QaF)(s.source);if(t&&((0,u.SR)({url:t})||e===r.Ti.image))return a.image={pointer:{table:"block",id:m.id},url:t},a}const g=(0,r.nq)(e),h=t.isType(r.MV)&&(!m.isEmptyTitle()||g);let b=m;o&&m.id===o&&"table_row"===e&&(b=b.getParentBlockStore());const y=n&&b&&void 0!==(0,I.u)({store:b,tableRenderMode:i});(h||y)&&d<l.Uo&&(a.blocks.push({blockStore:m,depth:f}),g||d++)}return a}function ee(e){const{image:t,blocks:n,isDefined:o}=X(e);return t?{image:t,blockIds:[],isDefined:o}:{image:void 0,blockIds:n.map((e=>e.blockStore.id)),isDefined:o}}function te(e){const{rootStore:t,renderAdditionalBlocks:n,theme:o}=e;if(n&&t.isCollectionView())return{image:{url:"dark"===o?i.Z.images.blockRendererCovers.collectionTableDarkPng:i.Z.images.blockRendererCovers.collectionTableLightPng,pointer:{id:t.id,table:t.table,spaceId:t.getSpaceId()}},blockIds:[],isDefined:!0};const{image:a,blocks:s,isDefined:l}=X({rootStore:t,renderAdditionalBlocks:n,tableRenderMode:"image"});if(a)return{image:a,blockIds:[],isDefined:l};return{image:void 0,blockIds:s.filter((e=>{const{blockStore:t,depth:n}=e;return 0===n&&t.getType()!==r.Ti.transclusionReference&&t.getType()!==r.Ti.transclusionContainer})).map((e=>e.blockStore.id)),isDefined:l}}function ne(e){const t=e.isFullScreen.state,n=e.collectionViewStore();if(!n)throw new Error("Collection view store not defined.");const o=e.normalizedFormatStore.state,i=n.isDefined()&&n.getType(),r="board"===i,a="table"===i,s=o.collection_group_by;if(!t||s){const e=p.rx(o.inline_collection_first_load_limit,Boolean(s));if("load_limit"===e.type)return e.limit}if(r)return 20;if(t){if(a&&Z.default.checkGate("collections_virtualization")){return Z.default.getConfigKey("collection_virtualized_load_limits","table").initial_limit}return 50}return 20}function oe(e){const{collectionViewStore:t,isFullScreen:n,currentResultCount:o}=e,i=t.isDefined()&&t.getType();if("board"===i)return 20;if(n){if("table"===i&&Z.default.checkGate("collections_virtualization")){return Z.default.getConfigKey("collection_virtualized_load_limits","table").increment_limit}return 50}return o<=50?50:100}function ie(e,t){const n=e.collectionViewStore();if(!n)return!1;if("collectionVirtualView"===e.contextType)return!1;const o=n.getFormat();return!t||Boolean(o.collection_group_by)}function re(e){const{collectionContextStore:t,isFullScreen:n,reducerResult:o}=e;return o&&o.blockIds.length>0&&!((i=o)&&!i.hasMore)&&ie(t,n);var i}function ae(e){const{query:t,schema:n}=e,{timeline_by:o,timeline_by_end:i}=t;if(o){const e=n[o];if(e&&"date"!==e.type)return!1}if(i){const e=n[i];if(e&&"date"!==e.type)return!1}return!0}function se(e){const t=e.getParentBlockStore();return Boolean(t&&t.isLocked())}function le(e){return(0,R.wq)(e)}function ce(e){return V.default.isSidePeekOpen()&&!le(e)&&!e.isImmediateColumnChild()&&(e.isRootOrDirectChild()||"page"===e.getType())}function de(e){const t=e.getRecordStoreUIRoot();return!!(t&&t instanceof U.G)&&t.isFullWidth()}function ue(e){const{environment:t,isFullScreen:n,store:o,sizeObserver:i,viewType:r}=e,{device:a,WindowSizeStore:s}=t,l=o.isRootOrDirectChild(),c=!n&&!l,d=B.Z.isBlockInTemplate(o);if(c&&"gallery"===r)return{paddingLeft:1,paddingRight:1};if(l){if(le(o))return{paddingLeft:V.PeekModePadding.horizontal[V.default.state.mode],paddingRight:V.PeekModePadding.horizontal[V.default.state.mode]};if(a.isPhone)return{paddingLeft:s.getSafePaddingLeftPx((0,C.ui)(t)),paddingRight:s.getSafePaddingRightPx((0,C.ui)(t))};if(n)return{paddingLeft:96,paddingRight:96};if(!d&&!B.Z.isBlockInPageSnapshot(o)||B.Z.isBlockInWiki(o)){if(de(o)||function(e,t){const{WindowSizeStore:n}=e;return n.state.width-((0,F.Wk)(e)+(0,F.ll)(e,t)-(0,F.vJ)(e))<A.zL}(t,le(o))||ce(o)&&!V.default.isSidePeekClosing.state){const e=(0,C.ui)(t);return{paddingLeft:e,paddingRight:e}}{const e=i.rect.state.width;if(0===e)return;const n=(e-(A.zL-2*(0,C.ui)(t)))/2;return{paddingLeft:n,paddingRight:n}}}{const e=i.rect.state.width;if(0===e)return;const t=de(o)&&d?20+j.wN:20,n=Math.max((e-A.zL)/2,t);return{paddingLeft:n,paddingRight:n}}}return{paddingLeft:0,paddingRight:0}}function pe(e){switch(e){case"large":return D.Z.card.desktop.large.width;case"small":return D.Z.card.desktop.small.width;default:return D.Z.card.desktop.medium.width}}function me(e){let{collectionViewName:t,collectionViewType:n}=e;return t||P.default.formatMessage(Be[n])}function fe(e){var t;return((null===(t=e.getParentBlockStore())||void 0===t?void 0:t.getCollectionViewsStore().getValue())||[]).map((t=>U.Xr.createChildStore(e,{table:h.np,id:t}))).find((e=>"table"===e.getType()))}function ge(e){const{collectionStore:t,collectionViewBlockStore:n,checkNavigableAncestorLocked:o}=e;if(!n)return!1;if(o&&n.isNavigableAncestorNonEditableState())return!1;const i=null==t?void 0:t.canEditCollection(),r=null==t?void 0:t.getParentBlockStore(),a=null==r?void 0:r.isNonEditableState();return Boolean(i&&!a)}function he(e,t){const n=e.getType();if(!n)return!1;if(""===t)return!0;return-1!==me({collectionViewName:e.getName(),collectionViewType:n}).toUpperCase().indexOf(t.toUpperCase())}function ve(e){const{newOptions:t,collectionId:n,property:o,schema:i}=e,r=i[o];if(!r)return;if(!a.cu(r)&&"status"!==r.type)return;const s=r.options||[],l=[],d=_.xH(t),u=s.map((e=>e.value)),{beforeOps:p}=(0,c.q)(u,d);for(const[a,c]of Object.entries(p)){const e=s.find((e=>e.value===a));if(e)if(c){const t=s.find((e=>e.value===c));if(t){const i={pointer:{table:g.vF,id:n},command:"keyedObjectListBefore",path:["schema",o,"options"],args:{value:e,before:{id:t.id}}};l.push(i)}}else{const t={pointer:{table:g.vF,id:n},command:"keyedObjectListAfter",path:["schema",o,"options"],args:{value:e}};l.push(t)}}if("status"===r.type){const e=r.groups??[];for(const[i]of e.entries()){const e=t[i];if(!Array.isArray(e))return;const r=s.filter((t=>e.includes(t.value))).map((e=>e.id)),a={pointer:{table:g.vF,id:n},command:"set",path:["schema",o,"groups",i,"optionIds"],args:r};l.push(a)}}return l.length>0?l:void 0}function be(e){const{collectionId:t,property:n,propertySchema:o,schema:i,isAscending:r}=e;return ve({newOptions:[...o.options||[]].map((e=>e.value)).sort(((e,t)=>e.localeCompare(t,void 0,{sensitivity:"base"})*(r?1:-1))),collectionId:t,property:n,schema:i})}function ye(e){const{collectionId:t,property:n,propertySchema:o,newOption:i,isAscending:r}=e,a=o.options||[],s=_.cx(a,(e=>e.value.localeCompare(i.value,void 0,{sensitivity:"base"})*(r?1:-1)>=0));return-1!==s?{pointer:{table:g.vF,id:t},command:"keyedObjectListBefore",path:["schema",n,"options"],args:{value:i,before:a[s]}}:{pointer:{table:g.vF,id:t},command:"keyedObjectListAfter",path:["schema",n,"options"],args:{value:i}}}function _e(e){const{viewType:t,format:n}=e;return"board"===t?p.Lw(n.board_cover):"gallery"===t?p.Lw(n.gallery_cover):"timeline"===t&&p.vP(Boolean(n.timeline_show_table),n.timeline_table_properties||[])}function Se(e){const{viewType:t,property:n}=e;return"table"===t||("board"===t||"gallery"===t?"title"!==n:"calendar"===t&&"title"===n)}function we(e){return"full_page"===(null==e?void 0:e.normalizedFormatStore.state.collection_peek_mode)}function ke(e){const t=null==e?void 0:e.collectionViewStore(),n=null==t?void 0:t.getType();return null!=t&&t.getIsUnlisted()&&null!=e&&e.isCompactView.state?"center_peek":(null==e?void 0:e.normalizedFormatStore.state.collection_peek_mode)??(n?T.Ls[n]:"side_peek")}function Ie(e){const{stores:t,phase:n}=L.default.state;return!(n===L.SelectionPhase.Selected&&t.indexOf(e)>=0)&&(V.default.state.open&&V.default.isSidePeekOpen()&&V.default.state.target.id===e.id)}function Ce(e,t){return e?{background:y.ZP.blueWithAlpha(.025),boxShadow:t.outlineUltraThinBlueInputBoxShadow,borderRadius:4}:{}}function xe(e){const{store:t,mainEditorCurrentBlockStore:n,collectionContextStore:i,fullyQualified:r,overridePeekMode:a,showMoveTo:s}=e,l=null==i?void 0:i.collectionViewStore();if(!a&&we(i))return(0,M.ZP)({store:t,fullyQualified:r,pageVisitSource:(null==i?void 0:i.getPageVisitSourceOverride())??o.tY.Expand,showMoveTo:s});if(n){const e=null==i?void 0:i.getViewType();let c;c=null!=i&&i.isUnlistedView.state&&null!=i&&i.isCompactView.state?"center_peek":(null==i?void 0:i.normalizedFormatStore.state.collection_peek_mode)??(e?T.Ls[e]:void 0);const d=a??(0,V.getPeekModeFromCollectionPeekModeFormat)(c);return(0,M.ZP)({store:n,collectionViewId:null!=i&&i.isFullScreen.state?null==l?void 0:l.id:void 0,fullyQualified:r,peekViewBlockId:t.id,peekMode:(0,V.getUrlParamFromPeekMode)(d),pageVisitSource:(null==i?void 0:i.getPageVisitSourceOverride())??o.tY.PeekOpen,showMoveTo:s})}}function Te(e){var t;const n=null===(t=e.getCollectionViewStores().find((e=>"page"===e.getType())))||void 0===t?void 0:t.getFormat().page_pointer;if(n)return U.G.createChildStore(e,{table:f.iU,id:null==n?void 0:n.id,spaceId:e.getSpaceId()})}function Me(e){const t=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return null==e?void 0:e.findRecordStoreUIAncestor((n=>n instanceof U.G&&n.isCollectionView()&&(t||n.id!==e.id))).ancestor}(e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]);if(t)return E.R.findCollectionViewBlockFromId(t.id)}function Pe(e){const t=Me(e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]);if(null!=t&&t.collectionContextStore)return t.collectionContextStore}function Ae(e){var t,n;let{environment:o,collectionContextStore:i}=e;const r=(0,x.zq)(o),{currentUserStore:a}=O.default.state,s=Boolean(i.permissionScopes.state.canEditContent||"collectionTypedView"===i.contextType&&(null===(t=i.collectionViewBlockStore())||void 0===t?void 0:t.canEdit()));return!!a&&r&&s&&"table"===(null===(n=i.collectionViewStore())||void 0===n?void 0:n.getType())&&!i.isCompactView.state}function Re(e,t){let n=t;return e.every((e=>{if(e.getType()===r.Ti.page||e.getType()===r.Ti.collectionViewPage){var t;const o=null===(t=Me(e,!1))||void 0===t?void 0:t.props.store.id;return!!o&&(void 0===n&&(n=o),o===n)}return!1}))}function De(e){return void 0!==e&&e>=0}function Ee(e){return void 0!==e?e+1:0}const Be=(0,b.defineMessages)({board:{id:"database.collectionView.untitledName.board",defaultMessage:"Board"},gallery:{id:"database.collectionView.untitledName.gallery",defaultMessage:"Gallery"},timeline:{id:"database.collectionView.untitledName.timeline",defaultMessage:"Timeline"},calendar:{id:"database.collectionView.untitledName.calendar",defaultMessage:"Calendar"},list:{id:"database.collectionView.untitledName.list",defaultMessage:"List"},table:{id:"database.collectionView.untitledName.table",defaultMessage:"Table"},page:{id:"database.collectionView.untitledName.page",defaultMessage:"Page"},chart:{id:"database.collectionView.untitledName.chart",defaultMessage:"Chart"}});function Fe(e){let{store:t,collectionContextStore:n}=e;return"collectionVirtualView"===n.contextType?n.collectionStore():t.getAssociatedCollectionStore()}},17707:(e,t,n)=>{n.d(t,{$F:()=>q,AM:()=>J,DF:()=>F,DX:()=>V,Gu:()=>Z,Ri:()=>Q,T4:()=>j,XZ:()=>z,Xi:()=>L,Y0:()=>Y,YF:()=>O,Zo:()=>K,bh:()=>U,cj:()=>W,tR:()=>N});n(57658);var o=n(1302),i=n(22491),r=n(70279),a=n(23867),s=n(19889),l=n(70203),c=n(53965),d=n(7032),u=n(1898),p=n(19584),m=n(85344),f=n(54564),g=n(31781),h=n(94419),v=n(9953),b=n(61045),y=n(3898),_=n(993),S=n(13447),w=n(53471),k=n(27105),I=n(28020),C=n(65598),x=n(77546),T=n(89224),M=n(46351),P=n(95802),A=n(24229),R=n(56681),D=n(6258),E=n(92120),B=n(21899);function F(e){var t,n;const{environment:o,store:i,text:r,files:a,transaction:s,discussionLocation:l}=e,{filesToCreate:c,fileStoresToDelete:d}=function(e,t){const n=[],o=new Set;t.forEach((e=>{"local"===e.type?n.push(e.file):o.add(e.id)}));const i=C.le(e),r=i.filter((e=>e.getAlive()&&!o.has(e.id)));return{filesToCreate:n,fileStoresToDelete:r}}(i,a);K({commentStore:i,fileBlocks:d,transaction:s}),$({commentStore:i,files:c,environment:o,transaction:s});const u=C.zP(i);_.sO({environment:o,editorMode:"default",store:u,value:r,transaction:s}),G(i,s);const p=null==i||null===(t=i.getParentStore())||void 0===t?void 0:t.getParentStore();m.zd(o,{from:l,comment_id:i.id,discussion_id:i.getParentId(),parent_block_id:null===(n=i.getParentStore())||void 0===n?void 0:n.getParentId(),parent_collection_id:null==p?void 0:p.getParentCollectionIdUpToTwoLevels()})}function O(e){var t;const{environment:n,commentStore:o,transaction:i}=e,r=C.GP(o);if(!r)return;const a=C.ak(r),s=a.getValue();if(!s)return;K({commentStore:o,fileBlocks:C.le(o),transaction:i}),v.sW({store:o,transaction:i,data:{alive:!1}}),S.applyOperation({store:a,operation:{pointer:a.pointer,path:a.path,command:"listRemove",args:{id:o.id}},transaction:i}),(0===s.length||1===s.length&&s[0]===o.id)&&function(e){const{discussionStore:t,transaction:n}=e,o=C.HK(t);o&&Z({discussionStore:t,transaction:n,blockStore:o});const i=I.RM();if(i){const e=C.MI({blockStore:i,traverseTransclusionReferences:!0});for(const i of e){if(o&&i.table===o.table&&i.id===o.id)continue;const e=C.x8(i).getValue();null!=e&&e.includes(t.id)&&Z({discussionStore:t,transaction:n,blockStore:i})}}}({discussionStore:r,transaction:i}),G(o,i),m.k$(n,{from:e.discussionLocation,discussion_id:r.id,comment_id:o.id,parent_block_id:r.getParentId(),parent_collection_id:null===(t=r.getParentStore())||void 0===t?void 0:t.getParentCollectionIdUpToTwoLevels()})}function Z(e){const{discussionStore:t,blockStore:n,transaction:o}=e;!function(e){const{blockStore:t,discussionIds:n,transaction:o}=e,i=C.x8(t);for(const r of n)S.applyOperation({store:i,operation:{pointer:i.pointer,path:i.path,command:"listRemove",args:{id:r}},transaction:o})}({blockStore:n,discussionIds:[t.id],transaction:o}),function(e){const{store:t,transaction:n,discussionId:o}=e,i=["m",o],r=l.c14(i);_.ST({environment:t.environment,store:t.getBlockTitleStore(),selection:{startIndex:0,endIndex:1/0},annotationTypeOrKey:r,transaction:n,updateSelection:!1});for(const a of Object.keys(t.getProperties())){if("title"===a)continue;const e=t.getPropertyStore(a);_.ST({environment:t.environment,store:e,selection:{startIndex:0,endIndex:1/0},annotationTypeOrKey:r,transaction:n,updateSelection:!1})}}({store:n,discussionId:t.id,transaction:o})}function V(e){var t,n;const{environment:o,commentStore:i,discussionStore:r,transaction:a}=e;if(A.Z.state.open){var s;const e=null===(s=A.Z.state.discussionIds)||void 0===s?void 0:s.filter((e=>e!==r.id));A.Z.setState({...A.Z.state,discussionIds:e,open:((null==e?void 0:e.length)||0)>0})}v.sW({store:r,data:{resolved:!0},transaction:a}),E.Z.setState({...E.Z.state,discussionIds:(null===(t=E.Z.state)||void 0===t||null===(t=t.discussionIds)||void 0===t?void 0:t.filter((e=>e!==r.id)))||[]}),m.hJ(o,{comment_id:null==i?void 0:i.id,discussion_id:r.id,parent_block_id:r.getParentId(),from:e.discussionLocation,parent_collection_id:null===(n=r.getParentStore())||void 0===n?void 0:n.getParentCollectionIdUpToTwoLevels()})}function U(e){var t;const{environment:n,commentStore:o,discussionStore:i,transaction:r}=e;v.sW({store:i,data:{resolved:!1},transaction:r}),m.SU(n,{comment_id:o.id,discussion_id:i.id,from:e.discussionLocation,parent_block_id:i.getParentId(),parent_collection_id:null===(t=i.getParentStore())||void 0===t?void 0:t.getAssociatedCollectionId()})}function L(e){var t;const{environment:n,discussionStore:o,textValue:i,transaction:r,files:a}=e,{id:s}=n.currentUser;if(!s)return;const l=w.dm(a);if(c.Xy(i,[])&&0===l.length)return;const d=H({discussionStore:o,text:i,files:l,environment:n,transaction:r});m.d2(n,{from:e.discussionLocation,comment_id:d.id,discussion_id:o.id,parent_block_id:o.getParentId(),parent_collection_id:null==o||null===(t=o.getParentStore())||void 0===t?void 0:t.getParentCollectionIdUpToTwoLevels()})}function j(e){const t=M.Z.find((t=>t.getStore().id===e&&!t.isSidebarFormat()&&!t.isMarginFormat()));if(t){const e=t.getNode();if(e&&e.parentElement){const t=Array.from(e.parentElement.children).indexOf(e);x.Wr(e,{edgeDist:0===t?0:-1,animate:!1})}}}function N(e){const{transaction:t,blockStore:n,discussionId:o}=e,i=C.x8(n);S.applyOperation({store:i,operation:{pointer:i.pointer,path:i.path,command:"listAfter",args:{id:o}},transaction:t})}function z(e){const{transaction:t,blockStore:n,discussionId:o}=e,i=C.x8(n);S.applyOperation({store:i,operation:{pointer:i.pointer,path:i.path,command:"listRemove",args:{id:o}},transaction:t})}function q(e){const{context:t,blockStore:n,environment:o,transaction:i,icon:r,discussionId:l=(0,d.ZP)()}=e;if(void 0===o.currentUser.id)return;const c=v.ae({environment:o,table:"discussion",value:{type:"default",id:l,parent_id:n.id,parent_table:n.table,resolved:!1,context:t,space_id:(0,a.C)(n.pointer.spaceId)},inMemoryRecordCache:n.inMemoryRecordCache,transaction:i});N({transaction:i,blockStore:n,discussionId:c.id});const u={table:s.KJ,id:o.currentUser.id};return B.createReaction({environment:o,transaction:i,store:c,icon:r,currentActorPointer:u,discussionLocation:"block_menu"}),c}function W(e){const{createDiscussionArgs:t,blockStore:n,environment:o,transaction:i,commentTextValue:r,files:s,discussionId:l}=e;let c;"default"===t.type?c={id:l,type:"default",parent_id:n.id,parent_table:n.table,resolved:!1,context:t.context,space_id:(0,a.C)(n.pointer.spaceId)}:"suggestion"===t.type?c={id:l,type:"suggestion",parent_id:n.id,parent_table:n.table,resolved:!1,context:{rejected:!1,modifiedBlockIds:t.modifiedBlockIds,snapshot:t.snapshotTextValue?{text:t.snapshotTextValue}:void 0,splitFrom:t.splitFrom},space_id:(0,a.C)(n.pointer.spaceId)}:(0,u.t1)(t);const d=v.ae({environment:o,table:"discussion",value:c,inMemoryRecordCache:n.inMemoryRecordCache,transaction:i});return{discussionStore:d,commentStore:H({discussionStore:d,text:r,files:s,environment:o,transaction:i})}}function H(e){const{discussionStore:t,files:n,text:o,environment:i,transaction:a}=e,s=v.Ue({environment:i,table:r.x_,args:{parent:t.pointer},inMemoryRecordCache:t.inMemoryRecordCache,transaction:a}),l=C.ak(t);h.R3({parent:l,append:s,transaction:a});const c=C.zP(s);return _.sO({environment:i,editorMode:"default",store:c,value:o,transaction:a}),$({commentStore:s,files:n,environment:i,transaction:a}),G(s,a),s}function K(e){const{commentStore:t,fileBlocks:n,transaction:o}=e,i=C.ig(t);n.forEach((e=>{v.sW({store:e,data:{alive:!1},transaction:o}),h.Od({parent:i,childToRemove:e,transaction:o})}))}function G(e,t){const n=C.bQ(e);v.sO({store:n,value:(0,p.ud)(Date.now()),transaction:t})}function $(e){const{environment:t,files:n,commentStore:o,transaction:i}=e,r=I.qQ(t),a=C.ig(o);g.z({files:n,environment:t,inMemoryRecordCache:o.inMemoryRecordCache,transaction:i,pageWidth:r,ignoreOversizedFiles:!0,spaceId:a.pointer.spaceId,useCrdt:k.dy({source:"comment"})}).forEach((e=>{h.R3({parent:a,append:e,transaction:i})}))}async function Q(e){var t;let{discussionStore:n,currentBlockStore:r,environment:a,analyticsFrom:s,currentEl:l}=e;if(!r)return null;if(!n.isDefined())return;function c(e){const t=function(e){var t;let n,{discussionId:o,blockId:r}=e;const a=null===(t=document.getElementsByClassName(`${(0,i.dk)({discussionId:o})}`))||void 0===t?void 0:t[0];a&&(n=P.C.findSelectableFromChildNode(a)),n||(n=P.C.findScrollToSelectablesFromIds([r])[0]);return n}({discussionId:n.id,blockId:e});if(!t)return;const o=document.getElementsByClassName(`discussion-id-${n.id}`)[0];return o?b.bx({element:o,scrollers:{verticalScroller:t.getContextVerticalScroller(),horizontalScroller:t.getContextHorizontalScroller()},vertical:{reveal:"top"},horizontal:{reveal:"closest"},animate:!0}):b.XW({handle:t,vertical:{reveal:"top"},horizontal:{reveal:"closest"},animate:!0}),t.displaySelectionHalo(750),t}const d=(null===(t=n.getRecordStoreUIParent())||void 0===t?void 0:t.id)??n.getParentId();c(d)||(await y.Nz(r,[d]),await o.default.afterNextFlush(),c(d));const u=D.G.createChildStore(r,n.getParentPointer()),p=T.get(),m=null==p?void 0:p.commonAncestorContainer,g=!(null!=p&&p.collapsed)&&m&&(l===m||(null==l?void 0:l.contains(m)));f.Ib({environment:a,blockStore:u||r,analyticsFrom:s,discussionIds:[n.id],shouldFocusDiscussion:!g,recursivelyLoadAllDiscussions:!1})}function Y(e){e!==R.Z.state.pageId&&R.Z.reset()}function J(e){const t={};e.forEach((e=>{t[e]=Date.now()})),R.Z.setState({...R.Z.state,lastInteractionTimes:t})}},18821:(e,t,n)=>{n.d(t,{Bf:()=>P,Cd:()=>E,Dc:()=>F,WD:()=>A,i8:()=>B,tp:()=>R,uK:()=>Z,yw:()=>D});n(57658);var o=n(1302),i=n(41432),r=n(21202),a=n(23867),s=n(70203),l=n(9291),c=n(7032),d=n(85344),u=n(47307),p=n(27153),m=n(56863),f=n(24677),g=n(993),h=n(98104),v=n(13447),b=n(53471),y=n(72187),_=n(33929),S=n(45162),w=n(89224),k=n(58202),I=n(6258),C=n(82994),x=n(48514),T=n(17707);const M=(0,l.defineMessages)({discardCommentConfirmationPrompt:{id:"newDiscussionMenu.discardCommentConfirmationDialog.prompt",defaultMessage:"Do you want to discard the comment?"},discardCommentButtonLabel:{id:"newDiscussionMenu.discardCommentConfirmationDialog.discardButton.label",defaultMessage:"Discard"},emojiPicker:{defaultMessage:"Reaction",id:"ReactionBar.emojiModalMenu.title"},emojiTitle:{id:"recordIcon.emojiTab.title",defaultMessage:"Emojis"}});function P(e){const{environment:t,blockStore:n,multiSelection:o,rect:i}=e;let r=i;if(!r){const e=w.get();if(!e)return;r=w.getRect(e)}if(!r)return;const a=r.width,s=r.height,l=r.right-a;x.Z.setState({open:!0,rect:new DOMRect(l,r.top,a,s),type:"inline",content:"reaction",blockStore:n,multiSelection:o,emoji:void 0}),p.$(t,{originGap:4,originRect:r,popupWidth:y.FZ,popupHeight:y.kX,isSmallWidth:!1,title:_.default.formatMessage(M.emojiPicker),currentTab:"emoji",onCancel:()=>x.Z.reset(),tabs:[{type:"emoji",title:_.default.formatMessage(M.emojiTitle),hideRandomButton:!0,onChange:e=>{const n=x.Z.state;n.open&&"reaction"===n.content&&(x.Z.setState({...n,emoji:e}),F(t),p.Z())}}]})}async function A(e){const{environment:t,blockStore:n,multiSelection:o,rect:i}=e;let r=i;if(!r){const e=w.get();if(!e)return;r=w.getRect(e)}if(!r)return;const s=r.width,l=r.height,c=r.right-s,u=new C.Z(t,(0,a.C)(n.pointer.spaceId));x.Z.setState({open:!0,rect:new DOMRect(c,r.top,s,l),type:"inline",content:"comment",blockStore:n,multiSelection:o,discussionInputStore:u}),m.w(),await O(u,t),d.$5(t)}function R(e){const{environment:t,blockStore:n}=e,o=k.R.getRect(n);if(!o)return;const i=o.width,r=o.height,a=o.right-i;x.Z.setState({open:!0,rect:new DOMRect(a,o.top,i,r),type:"block",content:"reaction",blockStore:n,emoji:void 0}),p.$(t,{originGap:4,originRect:o,popupWidth:y.FZ,popupHeight:y.kX,isSmallWidth:!1,title:_.default.formatMessage(M.emojiPicker),currentTab:"emoji",onCancel:()=>x.Z.reset(),tabs:[{type:"emoji",title:_.default.formatMessage(M.emojiTitle),hideRandomButton:!0,onChange:e=>{const n=x.Z.state;n.open&&"reaction"===n.content&&(x.Z.setState({...n,emoji:e}),F(t),p.Z())}}]})}async function D(e){const{environment:t,blockStore:n}=e,o=k.R.getRect(n);if(!o)return;const i=new C.Z(t,(0,a.C)(n.pointer.spaceId)),r=o.width,s=o.height,l=o.right-r;x.Z.setState({open:!0,rect:new DOMRect(l,o.top,r,s),type:"block",content:"comment",blockStore:n,discussionInputStore:i}),await O(i,t),d.yr(t)}function E(e){const t=x.Z.state;t.open&&x.Z.setState({open:!1,rect:t.rect})}function B(e){const{environment:t,type:n,discussionId:o=(0,c.ZP)(),blockStore:r,commentTextValue:a,transaction:l,files:u}=e,{id:p}=t.currentUser;if(!p)return;let m;const f=r.getType();if(f&&(0,i.XD)(f)&&!(0,i.S9)(f)){const e=r.getTitleValue();m=s.O1u(s.V3g(e,{removeSuggestions:!0,removeDiscussions:!0}))}const{discussionStore:g,commentStore:h}=T.cj({createDiscussionArgs:"default"===n?{type:"default",context:m}:{type:"suggestion",modifiedBlockIds:[r.pointer.id]},blockStore:r,environment:t,transaction:l,commentTextValue:a,files:b.dm(u),discussionId:o});return T.tR({transaction:l,blockStore:r,discussionId:g.id}),d.bR(t,{discussion_id:g.id,comment_id:h.id,parent_block_id:g.getParentId()}),g}function F(e){const t=x.Z.state;if(t.open){if(x.Z.hasContent())if("inline"===t.type)v.createAndCommit({userAction:"newDiscussionMenuActions.submitNewDiscussion",environment:e,perform:n=>{const o=function(e){const{environment:t,multiSelection:n,transaction:o}=e,{id:a}=t.currentUser;if(!a)return;const l=(0,c.ZP)(),d=(0,S.L5)(n).filter((e=>{let{store:t}=e;return t.table===r.iU}));if(0===d.length)return;const u=d[0].store.getRecordStoreAtRootPath(),p=[],m=new Set;d.forEach(((e,n)=>{let{store:r,selection:a}=e;m.add(r.id);const c=r.getRecordStoreAtRootPath();if(!(c instanceof I.G))return;const d=c.getType(),u=c.getFormat();if(d&&(0,i._T)(d,u))return;let f=r.getValue();const h=s.Ulv(f,a);g.i8({environment:t,store:r,selection:h,annotation:[s.GKr.Discussion,l],transaction:o}),f=r.getValue();const v=s.KU1(f,h.startIndex,h.endIndex),b=0===n?[]:[s.V3y("\n")];p.push(...b,...v)}));const f=(0,S.tp)({multiSelection:n,filterCommonAncestors:!1,focus:void 0});if(f)for(const r of f.stores){if(m.has(r.id))continue;const e=r.getType(),t=r.getFormat();e&&(0,i._T)(e,t)||T.tR({blockStore:r,discussionId:l,transaction:o})}return{blockStore:u,context:p,discussionId:l}}({environment:e,multiSelection:t.multiSelection,transaction:n});if(!o)return;const{context:a,blockStore:l,discussionId:u}=o;if("comment"===t.content){const o=t.discussionInputStore.state.textStore.getValue()||[],i=t.discussionInputStore.state.files,{discussionStore:r,commentStore:s}=T.cj({createDiscussionArgs:{type:"default",context:a},blockStore:l,environment:e,transaction:n,commentTextValue:o,files:b.dm(i),discussionId:u});d.x6(e,{discussion_id:r.id,comment_id:s.id,parent_block_id:r.getParentId()})}else t.emoji&&T.$F({context:a,blockStore:l,environment:e,transaction:n,icon:t.emoji,discussionId:u})},skipUpdatingEditedMetadata:!0});else if("block"===t.type&&"comment"===t.content){const n=t.discussionInputStore.state.textStore.getValue()||[],o=t.discussionInputStore.state.files;v.createAndCommit({userAction:"newDiscussionMenuActions.submitNewDiscussion",environment:e,perform:i=>{B({environment:e,type:"default",blockStore:t.blockStore,commentTextValue:n||[],files:o,transaction:i})},skipUpdatingEditedMetadata:!0})}E()}}async function O(e,t){await o.default.afterNextFlush(),f.ZH(t),h.N_({store:e.state.textStore})}function Z(e){const{discussionInputStore:t,environment:n,discussionHelpers:o}=e;o.hasCommentChanged(t)?(d.lL(n),u.showDialog({message:_.default.formatMessage(M.discardCommentConfirmationPrompt),showCancel:!0,handleCancel:()=>d.jX(n),keepFocus:!0,items:[{label:_.default.formatMessage(M.discardCommentButtonLabel),color:"red",onAccept:()=>{d.Yz(n),E()}}]})):E()}},21899:(e,t,n)=>{n.r(t),n.d(t,{createReaction:()=>g,toggleReaction:()=>f});var o=n(33709),i=n(80396),r=n(23867),a=n(19889),s=n(7032),l=n(1898),c=n(85344),d=n(94419),u=n(9953),p=n(13447),m=n(6258);function f(e){const{discussionLocation:t,environment:n,transaction:s,store:d,icon:u}=e,f=function(e){let{store:t,icon:n}=e;const o=(0,m.Vh)(t,t.pointer,"reactions").getValue();if(void 0===o)return;return o.map((e=>{const n=m.t1.createChildStore(t,{table:i.yo,id:e,spaceId:(0,r.C)(t.pointer.spaceId)});if(n.isDefined())return n})).filter(l.$K).find((e=>e.getIcon()===n))}({store:d,icon:u});if(void 0===n.currentUser.id)return;const h={table:a.KJ,id:n.currentUser.id};null!=f&&f.isDefined()?function(e){var t;let{store:n,actorPointer:i,transaction:r,environment:a,discussionLocation:s}=e;const l={store:n,actorPointer:i,transaction:r,environment:a,discussionLocation:s},d=(null===(t=n.getActors())||void 0===t?void 0:t.some((e=>e.id===i.id)))??!1;d?function(e){var t;const{store:n,actorPointer:i,discussionLocation:r,transaction:a,environment:s}=e;if(!n.isDefined())return;const l=n.getParentStore(),d=(null==l?void 0:l.table)===o.qF?l:null==l?void 0:l.getParentStore();c.Em({environment:s,reaction_value:n.getIcon(),comment_id:n.getParentId(),discussion_id:null==d?void 0:d.id,parent_block_id:null==d?void 0:d.getParentId(),parent_collection_id:null==d||null===(t=d.getParentStore())||void 0===t?void 0:t.getParentCollectionIdUpToTwoLevels(),reaction_count:n.getActors().length??0,from:r});const u=n.getModel();p.applyOperation({transaction:a,store:n,operation:u.ops.removeActor(i)})}(l):function(e){var t;const{store:n,actorPointer:i,discussionLocation:r,transaction:a,environment:s}=e;if(!n.isDefined())return;const l=n.getParentStore(),d=(null==l?void 0:l.table)===o.qF?l:null==l?void 0:l.getParentStore();c.pP({environment:s,reaction_value:n.getIcon(),comment_id:n.getParentId(),discussion_id:null==d?void 0:d.id,parent_block_id:null==d?void 0:d.getParentId(),parent_collection_id:null==d||null===(t=d.getParentStore())||void 0===t?void 0:t.getParentCollectionIdUpToTwoLevels(),reaction_count:n.getActors().length??0,from:r});const u=n.getModel();p.applyOperation({transaction:a,store:n,operation:u.ops.appendActor(i)})}(l)}({environment:n,store:f,actorPointer:h,transaction:s,discussionLocation:t}):g({environment:n,transaction:s,store:d,icon:u,currentActorPointer:h,discussionLocation:t})}function g(e){var t;let{environment:n,transaction:a,store:l,icon:p,currentActorPointer:f,discussionLocation:g}=e;const h=(0,s.ZP)(),v=l.table===o.qF?l:l.getParentStore();c.pP({environment:n,reaction_value:p,comment_id:l.id,discussion_id:null==v?void 0:v.id,parent_block_id:null==v?void 0:v.getParentId(),parent_collection_id:null==v||null===(t=v.getParentStore())||void 0===t?void 0:t.getParentCollectionIdUpToTwoLevels(),reaction_count:0,from:g});const b=u.Ue({environment:n,table:i.yo,args:{id:h,spaceId:(0,r.C)(l.pointer.spaceId),commentId:l.id,icon:p,actorPointer:f},inMemoryRecordCache:l.inMemoryRecordCache,transaction:a}),y=(0,m.Vh)(l,l.pointer,"reactions");d.R3({parent:y,append:b,transaction:a})}},95306:(e,t,n)=>{n.d(t,{Cd:()=>m,UZ:()=>p,oK:()=>u});var o=n(1302),i=n(23867),r=n(37850),a=n(85344),s=n(24677),l=n(98104),c=n(82994),d=n(9080);async function u(e){const{environment:t,discussionStore:n,rect:u,blockStore:p,discussionLocation:m,activityId:f,notificationId:g}=e,h=new c.Z(t,(0,i.C)(p.pointer.spaceId));d.Z.setState({open:!0,rect:u,discussionStore:n,discussionInputStore:h,blockStore:p,discussionLocation:m,activityId:f,notificationId:g}),s.ZH(t),await o.default.afterNextFlush(),await(0,r.Vs)(10),l.NX({store:h.state.textStore}),a.Je({environment:t,from:m,activityId:f,notificationId:g})}function p(e){const t=d.Z.state;if(t.open){const{discussionLocation:n,activityId:o,notificationId:i}=t;d.Z.setState({open:!1,rect:t.rect}),s.ZH(e),a.Rn({environment:e,from:n,activityId:o,notificationId:i})}}function m(e){const t=d.Z.state;if(t.open){0===t.discussionStore.getComments().length&&p(e)}}},1600:(e,t,n)=>{n.d(t,{DH:()=>k,L9:()=>w,Yo:()=>y,n1:()=>x,rl:()=>S,vh:()=>I});n(21703);var o=n(59730),i=n(70203),r=n(82798),a=n(53965),s=n(7032),l=n(1898),c=n(9953),d=n(42858),u=n(993),p=n(13447),m=n(98165),f=n(73959),g=n(89086),h=n(80444),v=n(17707),b=n(18821);function y(e){const{action:t,environment:n,commentStore:l,discussionStore:p,transaction:f,discussionLocation:b}=e,S=p.getSuggestModifiedBlockStores()??[],k=h.default.state.mainEditorCurrentBlockStore;if(!k)return;const I=S.filter((e=>{const t=m.Dg(e);return k.id===(null==t?void 0:t.id)}));if(I.length===S.length){v.DX({environment:n,commentStore:l,discussionStore:p,transaction:f,discussionLocation:b}),function(e){const{blockStores:t,discussionStore:n,environment:o,transaction:i,action:r}=e;for(const a of t){const e=C(a,n.id);e&&(T(i,a,e.id),("reject"===r&&"insert"===e.type||"accept"===r&&"remove"===e.type)&&d.Cl({environment:o,blocks:[a],transaction:i}))}}({environment:n,transaction:f,blockStores:I,discussionStore:p,action:t});for(const e of I){const o=(0,r.TO)(e.getTitleStore()),a=e.getTitleValue();for(let e=0;e<a.length;e++){const s=i.hDy(a[e]);for(const l of s)if(i.BIG(l)&&i.fgJ(l)===p.id){_({annotation:l,action:t,selection:(0,r.TO)(g.Ts(a,e)),environment:n,transaction:f,titleStore:o})}}v.tR({transaction:f,blockStore:e,discussionId:p.id})}if("reject"===t){const e=(0,r.TO)(p.getSuggestionRawContextStore());c.sW({store:e,data:{rejected:!0},transaction:f})}}else!function(e){const{action:t,blockStoresInPage:n,discussionStore:l,transaction:d,environment:p,discussionLocation:m}=e,f=l.getParentStore();if(!f)throw new o.p8("Suggestion should have parent block store");const h=l.getRawContextStore(),b=h.getValue(),_=n.map((e=>e.id));c.sO({store:h,value:{...b,modifiedBlockIds:a.zu(l.getSuggestModifiedBlockIds(),..._),resolvedBlockIds:_},transaction:d});const{discussionStore:S,commentStore:k}=w({environment:p,transaction:d,blockStore:f,modifiedBlockIds:_,splitFrom:l.id});(function(e){const{blockStores:t,oldDiscussionStore:n,newDiscussionStore:o,transaction:a}=e;t.forEach((t=>{v.XZ({transaction:a,blockStore:t,discussionId:n.id}),v.tR({transaction:a,blockStore:t,discussionId:o.id});const l=C(t,n.id);l&&(T(a,t,n.id),x(a,t,{id:(0,s.ZP)(),type:l.type,discussionId:o.id})),function(e){const{blockStore:t,oldDiscussionStore:n,newDiscussionStore:o,transaction:a,environment:s}=e,l=(0,r.TO)(t.getTitleStore()),c=t.getTitleValue();for(let d=0;d<c.length;d++){const e=i.hDy(c[d]);for(const t of e)if(i.BIG(t)&&i.fgJ(t)===n.id){const e=(0,r.TO)(g.Ts(c,d)),n=i.c1u(t,o.id);u.yJ({selection:e,titleStore:l,environment:s,transaction:a,annotationKeysToRemove:[i.c14(t)],annotationsToAdd:[n]})}}}({...e,blockStore:t})}))})({blockStores:n,oldDiscussionStore:l,newDiscussionStore:S,transaction:d,environment:p}),y({action:t,environment:p,commentStore:k,discussionStore:S,transaction:d,discussionLocation:m})}({action:t,discussionLocation:b,blockStoresInPage:I,discussionStore:p,transaction:f,environment:n})}function _(e){const{annotation:t,action:n,selection:o,environment:r,transaction:a,titleStore:s}=e;if("accept"===n)if(i.pGj(t)){const e=i.c14(t);u.yJ({selection:o,titleStore:s,annotationKeysToRemove:[e],environment:r,transaction:a})}else if(i.$b8(t))u.pe({environment:r,store:s,editorMode:"default",selection:o,transaction:a});else if(i.u2m(t)||i.Jeu(t)){const e=i.EpE(t);i.u2m(t)?u.yJ({selection:o,titleStore:s,annotationsToAdd:[e],annotationKeysToRemove:[i.c14(t)],environment:r,transaction:a}):u.yJ({selection:o,titleStore:s,annotationKeysToRemove:[i.c14(e),i.c14(t)],environment:r,transaction:a})}else(0,l.t1)(t);else if("reject"===n)if(i.$b8(t)||i.u2m(t)||i.Jeu(t)){const e=i.c14(t);u.yJ({selection:o,titleStore:s,annotationKeysToRemove:[e],environment:r,transaction:a})}else i.pGj(t)?u.pe({environment:r,store:s,editorMode:"default",selection:o,transaction:a}):(0,l.t1)(t);else(0,l.t1)(n)}function S(e){const{environment:t,transaction:n,blockStore:o}=e;if(o.getRemoveSuggestion()||o.getInsertSuggestion())return;const i=(0,s.ZP)();!function(e,t,n){const o=t.getFormatStore().getKeyStore("suggestions");p.applyOperation({store:t,operation:{pointer:o.pointer,command:"keyedObjectListAfter",path:o.path,args:{value:n}},transaction:e})}(n,o,{id:(0,s.ZP)(),type:"remove",discussionId:i});if(!(0,b.i8)({environment:t,blockStore:o,commentTextValue:[[""]],transaction:n,files:[],type:"suggestion",discussionId:i}))throw new Error("Discussion must be created when creating a block with suggestion")}function w(e){const{environment:t,transaction:n,blockStore:o,modifiedBlockIds:i,splitFrom:r}=e,a={createDiscussionArgs:{type:"suggestion",modifiedBlockIds:i,splitFrom:r},blockStore:o,environment:t,transaction:n,commentTextValue:[[""]],files:[],discussionId:(0,s.ZP)()};return v.cj(a)}function k(e){return(0,f.sQ)(e.start.store)}function I(e,t){if("suggestion"!==e.getType())throw new o.p8("This fn only used for suggestion");const n=e.getContext(),i=e.getRawContextStore().getValue();n&&c.sO({store:e.getRawContextStore(),value:{...i,snapshot:{text:n}},transaction:t})}function C(e,t){const n=e.getSuggestionsStore().getValue();return null==n?void 0:n.find((e=>e.discussionId===t))}function x(e,t,n){const o=t.getFormatStore().getKeyStore("suggestions");p.applyOperation({store:t,operation:{pointer:o.pointer,command:"keyedObjectListAfter",path:o.path,args:{value:n}},transaction:e})}function T(e,t,n){const o=t.getFormatStore().getKeyStore("suggestions");p.applyOperation({store:t,operation:{pointer:o.pointer,command:"keyedObjectListRemove",path:o.path,args:{remove:{id:n}}},transaction:e})}},33866:(e,t,n)=>{n.d(t,{I:()=>_,Z:()=>w});n(67294);var o=n(60177),i=n(64338),r=n(480),a=n(86628),s=n(24405),l=n(45238),c=n(85893);const d=(0,l.IU)("reaction",{viewBox:"0 0 16 16",svg:(0,c.jsx)("path",{d:"M7.99414 14.0723C7.16602 14.0723 6.38672 13.9141 5.65625 13.5977C4.92578 13.2852 4.28125 12.8496 3.72266 12.291C3.16797 11.7324 2.73242 11.0879 2.41602 10.3574C2.09961 9.62695 1.94141 8.84766 1.94141 8.01953C1.94141 7.19141 2.09961 6.41211 2.41602 5.68164C2.73242 4.95117 3.16797 4.30859 3.72266 3.75391C4.28125 3.19531 4.92383 2.75781 5.65039 2.44141C6.38086 2.125 7.16016 1.9668 7.98828 1.9668C8.82031 1.9668 9.60156 2.125 10.332 2.44141C11.0625 2.75781 11.707 3.19531 12.2656 3.75391C12.8242 4.30859 13.2617 4.95117 13.5781 5.68164C13.8945 6.41211 14.0527 7.19141 14.0527 8.01953C14.0527 8.84766 13.8945 9.62695 13.5781 10.3574C13.2617 11.0879 12.8242 11.7324 12.2656 12.291C11.707 12.8496 11.0625 13.2852 10.332 13.5977C9.60156 13.9141 8.82227 14.0723 7.99414 14.0723ZM7.99414 12.877C8.66992 12.877 9.30078 12.752 9.88672 12.502C10.4727 12.252 10.9883 11.9043 11.4336 11.459C11.8789 11.0137 12.2266 10.498 12.4766 9.91211C12.7266 9.32617 12.8516 8.69531 12.8516 8.01953C12.8516 7.34766 12.7266 6.71875 12.4766 6.13281C12.2266 5.54297 11.8789 5.02539 11.4336 4.58008C10.9883 4.13477 10.4707 3.78711 9.88086 3.53711C9.29492 3.28711 8.66406 3.16211 7.98828 3.16211C7.31641 3.16211 6.68555 3.28711 6.0957 3.53711C5.50977 3.78711 4.99609 4.13477 4.55469 4.58008C4.11328 5.02539 3.76758 5.54297 3.51758 6.13281C3.26758 6.71875 3.14258 7.34766 3.14258 8.01953C3.14258 8.69531 3.26758 9.32617 3.51758 9.91211C3.76758 10.498 4.11328 11.0137 4.55469 11.459C5 11.9043 5.51562 12.252 6.10156 12.502C6.69141 12.752 7.32227 12.877 7.99414 12.877ZM7.98828 10.9023C7.58203 10.9023 7.22266 10.8301 6.91016 10.6855C6.60156 10.5371 6.36133 10.3672 6.18945 10.1758C6.02148 9.98438 5.9375 9.82422 5.9375 9.69531C5.9375 9.625 5.96484 9.57617 6.01953 9.54883C6.07812 9.51758 6.14062 9.51758 6.20703 9.54883C6.42188 9.66211 6.66602 9.77148 6.93945 9.87695C7.21289 9.98242 7.5625 10.0352 7.98828 10.0352C8.41406 10.0352 8.76367 9.98242 9.03711 9.87695C9.31445 9.77148 9.55859 9.66211 9.76953 9.54883C9.83594 9.51758 9.89844 9.51758 9.95703 9.54883C10.0156 9.57617 10.0449 9.625 10.0449 9.69531C10.0449 9.82422 9.95898 9.98438 9.78711 10.1758C9.61523 10.3672 9.375 10.5371 9.06641 10.6855C8.75781 10.8301 8.39844 10.9023 7.98828 10.9023ZM6.25977 7.49219C6.07617 7.49219 5.91602 7.41797 5.7793 7.26953C5.64648 7.12109 5.58008 6.92969 5.58008 6.69531C5.58008 6.46484 5.64648 6.27539 5.7793 6.12695C5.91602 5.97461 6.07617 5.89844 6.25977 5.89844C6.44336 5.89844 6.60547 5.97461 6.74609 6.12695C6.88672 6.27539 6.95703 6.46484 6.95703 6.69531C6.95703 6.92969 6.88672 7.12109 6.74609 7.26953C6.60547 7.41797 6.44336 7.49219 6.25977 7.49219ZM9.7168 7.49219C9.5332 7.49219 9.37305 7.41797 9.23633 7.26953C9.10352 7.12109 9.03711 6.92969 9.03711 6.69531C9.03711 6.46484 9.10352 6.27539 9.23633 6.12695C9.37305 5.97461 9.5332 5.89844 9.7168 5.89844C9.90039 5.89844 10.0625 5.97461 10.2031 6.12695C10.3438 6.27539 10.4141 6.46484 10.4141 6.69531C10.4141 6.92969 10.3438 7.12109 10.2031 7.26953C10.0625 7.41797 9.90039 7.49219 9.7168 7.49219Z"})});var u=n(47560),p=n(37810),m=n(54564),f=n(24677),g=n(68709),h=n(73063),v=n(28020),b=n(65598),y=n(24229);let _=function(e){return e[e.PushContent=0]="PushContent",e[e.FloatRight=1]="FloatRight",e}({});function S(e){return e.format===_.FloatRight?(0,c.jsx)(g.p,{allowSelectionWithin:!1,style:{width:0,height:0},children:e.children}):(0,c.jsx)(c.Fragment,{children:e.children})}const w=function(e){const t=(0,r.O7)(),n=(0,o.Dl)();(0,i.q7)(null==n?void 0:n.domLock);const{store:l,recursivelyLoadAllDiscussions:g,onlyCountBlockLevelDiscussions:_}=e,w=(0,a.VK)((()=>{const e=b.vV(l,{recursivelyLoadAllDiscussions:g,onlyIncludeBlockLevelDiscussions:_});if(0===e.length)return{numberOfComments:0,numberOfReactions:0,discussionIsSelected:!1};const t=new Set(e.map((e=>e.id))),n=y.Z.getFramePageFirstSelectedDiscussionId(),o=n&&t.has(n),i=v.RM();if(i){const e=b.MI({blockStore:i,traverseTransclusionReferences:!0}),n=e.indexOf(l),o=new Set(t);for(let i=n-1;i>=0;i--){const n=e[i],r=b.vV(n,{recursivelyLoadAllDiscussions:!1,excludeSelf:!1,onlyIncludeBlockLevelDiscussions:!1,includeLoadingDiscussions:!0}).map((e=>e.id));for(const e of o)r.includes(e)?t.delete(e):o.delete(e);if(0===t.size)return{numberOfComments:0,numberOfReactions:0,discussionIsSelected:!1};if(0===o.size)break}}const{comments:r,reactions:a}=b.c3(l,{recursivelyLoadAllDiscussions:g,onlyIncludeBlockLevelDiscussions:_});return{numberOfComments:r,numberOfReactions:a,discussionIsSelected:o}}),[_,g,l]),k=()=>{f.ZH(t),m.Ib({environment:t,blockStore:e.store,analyticsFrom:"discussion_indicator",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:e.recursivelyLoadAllDiscussions})},{numberOfComments:I,discussionIsSelected:C,numberOfReactions:x}=w,T=(0,s.yK)((e=>({icon:{position:"relative",alignSelf:"flex-start",marginLeft:4,marginTop:3,background:C?e.selectLightGray[100]:void 0},commentCount:{marginLeft:2,color:e.lightTextColor,fontWeight:p.Z.fontWeight.semibold}})),[C]);if(0===I&&0===x)return null;const M=I>9?"9+":I,P=x>9?"9+":x;return(0,c.jsx)(S,{format:e.getFormat(),children:I>0?(0,c.jsx)(h.Z,{ariaLabel:`${M} comments`,icon:u.o,style:T.icon,onClick:k,caption:(0,c.jsx)("span",{style:T.commentCount,children:M})}):(0,c.jsx)(h.Z,{ariaLabel:`${P} reactions`,icon:d,style:T.icon,iconStyle:{width:16,height:16,marginLeft:-2},onClick:k,caption:(0,c.jsx)("span",{style:T.commentCount,children:P})})})}},92650:(e,t,n)=>{n.d(t,{fS:()=>U,QB:()=>Z,Z:()=>j,Vs:()=>B,wo:()=>R,az:()=>G,oS:()=>H,H0:()=>Y,Uj:()=>W,gC:()=>q,fg:()=>$,EM:()=>K});n(57658);var o=n(18466),i=n(14577),r=n(41432),a=n(22491),s=n(21202),l=n(70279),c=n(53965),d=n(1898),u=n(10906),p=n(43250),m=n(11599),f=n(65598),g=n(58202),h=n(49427),v=n(95802),b=n(48276),y=n(24646),_=n(15723),S=n(80444),w=n(17903),k=n(88923),I=n(6258),C=n(49085),x=n(92595);class T extends C.default{getInitialState(){return{visible:!0}}}const M=new T;(0,x.exposeDebugValue)("MarginCommentsStore",M);const P=M;var A=n(48514);const R=10,D=10,E="temp-margin-comment-discussion",B=50,F=`.${p.x9t} .notion-collection_view-block`,O=`.${p.OE$}`,Z=372,V=10,U=16,L=1150,j=Z-4*U,N=1500,z=1600;function q(e,t,n){const o=W(e,t);return o>=N||n&&!k.default.isSidePeekClosing.state||t?0:(N-o)/2}function W(e,t){return t&&k.default.isSidePeekOpen()?(0,y.vJ)(e):e.WindowSizeStore.state.width-(0,y.Wk)(e)-(0,y.vJ)(e)-b.VV()}function H(e,t,n){return(W(e,t)-z)/2+2*U+q(e,t,n)}const K=new i.Z((()=>{var e;let t=S.default.state.mainEditorCurrentBlockStore;return null!==(e=t)&&void 0!==e&&e.isCollectionView()&&(t=(0,u.SY)(t)||t),t?(0,f.vV)(t,{recursivelyLoadAllDiscussions:!0,excludeSelf:!0}):[]}),{debugName:"mainEditorBlockUnresolvedDiscussionStore"});function G(e,t){const n=P.state.visible;return Boolean(!e.device.isMobile&&W(e,(0,u.en)(t))>=L&&n&&!(0,y.Sx)(e)&&!k.default.isSidePeekOpen()&&h.Z.isBlockInFrame(t)&&(0,m.A$)("margin_comments","inline"))}function $(e,t){const n=K.state.length>0,o=A.Z.state.open&&A.Z.state.rect;return Boolean(G(e,t)&&(n||o))}function Q(e,t){return e.offsetTop!==t.offsetTop?e.offsetTop<t.offsetTop?-1:1:e.createdTimeMs&&t.createdTimeMs&&e.createdTimeMs!==t.createdTimeMs?e.createdTimeMs<t.createdTimeMs?-1:1:e.id<t.id?-1:1}const Y=(0,c.Ds)((function(e){let{discussionStores:t,pageContentStores:n,marginDiscussionItemRefs:i,selectedDiscussionId:l,newMarginDiscussionArgs:c,marginContainerElement:u,pageViewBlockElement:m,onComputeComplete:f,computedOnce:h,prevSelectedDiscussionId:b,isFullWidth:y,topbarHeight:S,windowHeight:k,previousDiscussionElements:C}=e;const x=new Map;let T=0,M=0;if(!u||!m)return;if(0===t.length&&!c)return;const P=o.Z.withListenerIgnored((()=>w.Z.state.scrollTop)),A=u.getBoundingClientRect(),R=J({currentScrollTop:P,rect:A});let B=function(e){const t=new Map,n=[];return e.forEach((e=>{if(e.shouldGroup){const n=t.get(e.parentBlockStore.id)||[];n.push(e),t.set(e.parentBlockStore.id,n)}else n.push(e)})),t.forEach((e=>{n.push({offsetTop:e[0].offsetTop,groupedDiscussionsData:e,parentBlockStore:e[0].parentBlockStore,type:"grouped",id:e[0].id,createdTimeMs:e[0].createdTimeMs})})),n}(t.map((e=>function(e){let{discussionStore:t,currentScrollTop:n,topbarHeight:o,windowHeight:i,pageViewBlockElement:r,previousDiscussionElements:l,currentDiscussionElements:c,selectedDiscussionId:d}=e;const u=t.id,p=function(e){const{topbarHeight:t,windowHeight:n,pageViewBlockElement:o,discussionId:i,previousDiscussionElements:r,currentDiscussionElements:s,selectedDiscussionId:l}=e,c=o.getElementsByClassName((0,a.dk)({discussionId:i})),d=e=>(s.set(i,e),e);if(c.length>0){if(l===i){let e;for(let o=0;o<c.length;o++){const i=c[o];if(i instanceof HTMLElement){const o=i.getBoundingClientRect();if(o.bottom<t||o.top>n){if(e)return d(e)}else{if(o.top>t)return d(i);e=i}}}}const e=r.get(i);return e&&Array.from(c).includes(e)?d(e):d(c[0])}}({topbarHeight:o,windowHeight:i,pageViewBlockElement:r,discussionId:u,previousDiscussionElements:l,currentDiscussionElements:c,selectedDiscussionId:d}),m=t.recordStoreUIParentStore;if(!(m&&m.id&&m.table===s.iU&&m instanceof I.G))return;if(!m.isReady())return;const f={offsetTop:0,discussionStore:t,parentBlockStore:m,type:"existing",id:t.id,createdTimeMs:X(t)};if(p instanceof HTMLElement)return f.offsetTop=J({rect:p.getBoundingClientRect(),currentScrollTop:n}),f;const g=v.C.findNodeFromStore(m);if(g instanceof HTMLElement)return f.offsetTop=J({rect:g.getBoundingClientRect(),currentScrollTop:n}),f;const{node:h,blockStore:b}=function(e){let t=e.getParentBlockStore();for(;t;){const e=t.getParentBlockStore();if(!e)return{};const n=v.C.findNodeFromBlockId(t.id);if(n)return{node:n,blockStore:t};t=e}return{}}(m);if(h instanceof HTMLElement&&b)return f.offsetTop=J({rect:h.getBoundingClientRect(),currentScrollTop:n})+V,f.parentBlockStore=b,f.shouldGroup=!0,f.closestVisibleParentId=b.id,f}({discussionStore:e,currentScrollTop:P,topbarHeight:S,windowHeight:k,pageViewBlockElement:m,previousDiscussionElements:C,currentDiscussionElements:x,selectedDiscussionId:l}))).filter(d.$K));const Z=c&&function(e){var t;let n,{blockStore:o,discussionInputStore:i,currentScrollTop:r,pageViewBlockElement:a}=e;const s=null===(t=a.getElementsByClassName(p.dXl))||void 0===t?void 0:t[0];n=s instanceof HTMLElement?s.getBoundingClientRect():g.R.getRect(o);if(!n)return;return{offsetTop:J({rect:n,currentScrollTop:r}),parentBlockStore:o,discussionInputStore:i,type:"new",id:E,createdTimeMs:Date.now()}}({...c,currentScrollTop:P,pageViewBlockElement:m}),U=Z?Z.id:l;let L;Z&&B.push(Z);const j=U||b?void 0:function(e){let{pageContentStores:t,currentScrollTop:n,marginContainerRect:o,isFullWidth:i}=e;return t.map((e=>{const t=e.getType();if(!t)return;let n;var a;if((0,d.qg)(r.Ok,t)||"column_list"===t)n=null===(a=v.C.findSelectableFromStore(e))||void 0===a||null===(a=a.getNode())||void 0===a?void 0:a.getBoundingClientRect();else if(t===r.Ti.table){var s,l;const t=null===(s=v.C.findSelectableFromStore(e))||void 0===s?void 0:s.getNode(),o=null==t?void 0:t.getBoundingClientRect(),r=null==t||null===(l=t.querySelector(O))||void 0===l?void 0:l.getBoundingClientRect();n=i?o:o&&r?o.width<r.width?o:r:o||r}else if(e.isInlineCollectionView()){var c,u;const t=null===(c=v.C.findSelectableFromStore(e))||void 0===c?void 0:c.getNode();n=i?null==t?void 0:t.getBoundingClientRect():null==t||null===(u=t.querySelector(F))||void 0===u?void 0:u.getBoundingClientRect()}return n&&n.right>o.left?n:void 0})).filter(d.$K).map((e=>{const t=J({rect:e,currentScrollTop:n});return new DOMRect(e.left,t,e.width,e.height)}))}({pageContentStores:n,currentScrollTop:P,marginContainerRect:A,isFullWidth:y}).sort((e=>-e.top));B=B.sort(Q).map(((e,t)=>{e.offsetTop-R>=18&&(e.offsetTop-=18);const n=e.id,o=i.get(e.id);if(!o)return"new"===e.type||h||(e.offsetTop=-9999,e.hide=!0),e;const r=o.getBoundingClientRect(),a=r.height;let s=e.offsetTop;return s<=T&&(s=T),j&&(s=function(e,t){const n={x:e.x,y:e.y,width:e.width,height:e.height,top:e.top,left:e.left,bottom:e.bottom,right:e.right};let o=t[t.length-1];for(;o;)if((0,_.dQ)(n,o))n.top=o.bottom+D,n.bottom=n.top+n.height,t.pop(),o=t[t.length-1];else{if(n.bottom<o.top)return n.top;t.pop(),o=t[t.length-1]}return n.top}(new DOMRect(r.left,s,r.width,r.height),j)),n===U&&0===M&&(M+=s-e.offsetTop,e.selected=!0,L=t),e.offsetTop=s,e.height=a,T=e.offsetTop+a,e}));const N=B.map((e=>(e.offsetTop=e.offsetTop-R,e)));let z;if(M>0&&void 0!==L)for(let o=L;o>=0;o--){const e=N[o];if(e.height){if(e.id===U)e.offsetTop-=M;else{if(!(z&&z.offsetTop<=e.offsetTop+e.height))break;e.offsetTop-=M}z=e}}f({data:N,hasNewDiscussion:Boolean(Z),selectedDiscussion:l},x)}),100);function J(e){let{rect:t,currentScrollTop:n}=e;return t.top+n}function X(e){const t=f.ak(e),n=t.getValue()||[];if(0===n.length)return;const o=n[0];return I.t1.createChildStore(t,{table:l.x_,id:o,spaceId:t.pointer.spaceId}).getCreatedTime()}},33767:(e,t,n)=>{n.d(t,{Av:()=>i,DU:()=>p,HV:()=>c,Jg:()=>s,Vd:()=>r,gU:()=>a,rI:()=>l,s3:()=>f,tG:()=>m,y4:()=>u,zI:()=>d});var o=n(77907);const i=o.deps.comments,r=(0,o.lazyComponent)(i,(e=>e.Comment)),a=(0,o.lazyComponent)(i,(e=>e.Discussion)),s=(0,o.lazyComponent)(i,(e=>e.DiscussionIndicator)),l=(0,o.lazyComponent)(i,(e=>e.DiscussionInput)),c=(0,o.lazyComponent)(i,(e=>e.MarginCommentsSection)),d=(0,o.lazyComponent)(i,(e=>e.NewDiscussionMenu)),u=(0,o.lazyComponent)(i,(e=>e.ReplyDiscussionMenu)),p=(0,o.lazyComponent)(i,(e=>e.ReactionBar)),m=((0,o.lazyComponent)(i,(e=>e.DiscussionReactionBar)),(0,o.lazyComponent)(i,(e=>e.CommentFileBlock))),f=(0,o.lazyComponent)(i,(e=>e.SuggestionContext))},92120:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){}getFirstSelectedDiscussionId(){var e;return null===(e=this.state)||void 0===e||null===(e=e.discussionIds)||void 0===e?void 0:e[0]}}const a=new r;(0,i.exposeDebugValue)("DiscussionHoverStore",a);const s=a},82994:(e,t,n)=>{n.d(t,{Z:()=>d});var o=n(26263),i=n(49085),r=n(70279),a=n(70203),s=n(7032),l=n(6258);class c extends i.default{constructor(e,t){super(),this.environment=void 0,this.spaceId=void 0,this.environment=e,this.spaceId=t,this.reset()}getInitialState(){if(!this.environment)return;const e=new o.Z({name:"DiscussionInputStore",isTemporaryData:!0});return{textStore:new l.ST({environment:this.environment,pointer:{table:r.x_,id:(0,s.ZP)(),spaceId:this.spaceId},path:["text"],inMemoryRecordCache:e}),localRecordCache:e,files:[],showAttachFileIntro:!1,renderFileAttachIntro:!1}}isEmpty(){const e=this.state.textStore.getValue();return!e||0===e.length}hasNewLineCharacter(){const e=this.state.textStore.getValue();return a.QaF(e).includes("\n")}}const d=c},48514:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(49085),i=n(92595),r=n(15723);class a extends o.default{getInitialState(){return{open:!1,rect:r.bM}}hasContent(){if(this.state.open){if("comment"===this.state.content)return Boolean(this.state.discussionInputStore.state.textStore.getValue())||this.state.discussionInputStore.state.files.length>0;if("reaction"===this.state.content)return void 0!==this.state.emoji}}}const s=new a;(0,i.exposeDebugValue)("NewDiscussionMenuStore",s);const l=s},9080:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(15723);class r extends o.default{getInitialState(){return{open:!1,rect:i.bM}}}const a=new r},24736:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var o=n(24405),i=n(56666),r=n(64921),a=n(85893);function s(e){let{onClick:t,className:n,isMobile:s,style:l,onFocus:c,onBlur:d,onMouseDown:u,onMouseEnter:p,onMouseLeave:m}=e;const{buttonStyle:f,iconStyle:g}=(0,o.yK)((e=>({buttonStyle:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,borderRadius:4,width:s?45:24,height:s?45:24,marginRight:s?-8:-6,...l},iconStyle:{width:s?18:14,height:s?18:14,fill:e.mediumIconColor}})),[s,l]);return(0,a.jsx)(r.Z,{onClick:t,style:f,className:n,mobileFeedback:s,onFocus:c,onBlur:d,onMouseDown:u,onMouseEnter:p,onMouseLeave:m,children:(0,i.o)(g)})}},21914:(e,t,n)=>{n.d(t,{Z:()=>z});var o=n(67294),i=n(73935),r=n(83355),a=n(24405),s=n(15145),l=n(45238),c=n(85893);const d=(0,l.IU)("commentAlert",{viewBox:"0 0 34 28",svg:(0,c.jsx)("path",{d:"M8.99023 25.3516C9.55957 25.3516 9.94629 25.1582 10.6338 24.5566L14.2324 21.3232C15.0059 22.1719 16.1768 22.6338 17.6699 22.6338H21.376L24.9639 25.7061C25.6191 26.2646 25.9736 26.5547 26.4893 26.5547C27.2305 26.5547 27.6494 26.0283 27.6494 25.2119V22.6338H28.1006C30.7969 22.6338 32.5908 21.001 32.5908 18.1973V11.8486C32.5908 9.03418 30.7969 7.40137 28.1006 7.40137H26.4141V6.58496C26.4141 3.67383 24.6846 1.97656 21.7627 1.97656H6.39062C3.58691 1.97656 1.73926 3.67383 1.73926 6.58496V16.4785C1.73926 19.4004 3.58691 21.0869 6.39062 21.0869H7.80859V24.0303C7.80859 24.8574 8.22754 25.3516 8.99023 25.3516ZM9.43066 20.3672C9.43066 19.7549 9.06543 19.4756 8.59277 19.4756H6.49805C4.59668 19.4756 3.46875 18.4336 3.46875 16.4355V6.64941C3.46875 4.65137 4.59668 3.59863 6.49805 3.59863H21.6553C23.5566 3.59863 24.6846 4.65137 24.6846 6.64941V7.40137H17.6699C14.8555 7.40137 13.1904 9.03418 13.1904 11.8486V18.1973C13.1904 18.7773 13.2549 19.3037 13.3945 19.7764L9.43066 23.4395V20.3672ZM26.0381 24.6104L22.5898 21.5166C22.1602 21.1406 21.9023 21.0117 21.3115 21.0117H17.7773C15.9834 21.0117 14.9092 20.0449 14.9092 18.1436L14.9199 11.9023C14.9199 10.0117 15.9834 9.02344 17.7773 9.02344H28.0039C29.7871 9.02344 30.8613 10.0117 30.8613 11.9023V18.1436C30.8613 20.0449 29.7871 21.0117 28.0039 21.0117H26.8652C26.4033 21.0117 26.0381 21.291 26.0381 21.8926V24.6104ZM22.9014 16.3389C23.3955 16.3389 23.6641 16.0596 23.6855 15.5225L23.8359 11.7734C23.8574 11.2148 23.4277 10.8174 22.8906 10.8174C22.3428 10.8174 21.9346 11.2041 21.9561 11.7627L22.0957 15.5225C22.1172 16.0488 22.3857 16.3389 22.9014 16.3389ZM22.8906 19.6045C23.4814 19.6045 23.9971 19.1318 23.9971 18.541C23.9971 17.9395 23.4922 17.4775 22.8906 17.4775C22.2891 17.4775 21.7842 17.9502 21.7842 18.541C21.7842 19.1318 22.2998 19.6045 22.8906 19.6045Z"})});var u=n(21202),p=n(33709),m=n(23867),f=n(9291),g=n(37810),h=n(26189),v=n(66324),b=n(75754),y=n(993),_=n(32741),S=n(33767),w=n(95477),k=n(66213),I=n(95645),C=n(14976),x=n(83105),T=n(84210),M=n(98165),P=n(77907),A=n(77080),R=n(46735),D=n(72014),E=n(31194),B=n(6258),F=n(24736),O=n(68709),Z=n(31945),V=n(84076),U=n(31278),L=n(76798),j=n(24813);class N extends I.Z{constructor(){super(...arguments),this.nodeRef=o.createRef(),this.state={isHovered:!1},this.origin=o.createRef(),this.handlePageMouseOver=e=>{const t=this.getInteractiveToken(),n=this.props.store.getTitleStore();n&&t&&y.Nh({environment:this.environment,event:e,interactiveToken:t,store:n,canEdit:this.canEdit()})},this.handlePageMouseOut=e=>{const t=this.getInteractiveToken(),n=this.props.store.getTitleStore();n&&t&&y.Zl({environment:this.environment,event:e,interactiveToken:t,store:n,canEdit:this.canEdit()})},this.handleMouseEnter=()=>{this.setState({isHovered:!0})},this.handleMouseLeave=()=>{this.setState({isHovered:!1})}}activate(){const{store:e}=this.props;!function(e,t,n){if(n){n((0,T.ZP)({store:e,pageVisitSource:s.tY.LinkInPage}))}else b._c({environment:t,store:e,visitType:x.vu.Link,pageVisitSource:s.tY.LinkInPage})}(e,this.environment,this.context.overrideLinkClick)}willUnmount(){super.willUnmount(),_.qA(this.props.store.getTitleStore())}renderPersisted(){const{disabled:e,store:t}=this.props,n=t.getAliasTargetStore();if(!n)return;if(n instanceof B.G)return(0,c.jsx)(O.p,{allowSelectionWithin:!1,onMouseOver:this.handlePageMouseOver,onMouseOut:this.handlePageMouseOut,children:(0,c.jsx)(j.Z,{ref:this.nodeRef,store:n,style:{...this.getBlockColorStyle(),...this.props.style},isAlias:!0,aliasStore:t,disabled:e,onClick:()=>function(e,t){v.Se(t),R.Z.recordVisit({id:e.id,systemBlockType:e.getSystemBlockTypeStore().getValue(),type:x.vu.Link,currentUserId:t.currentUser.id}),h.SK(t,{page_visit_id:D.$g.getCurrentPageVisitId(),mentioned_page_id:e.id,source_type:"alias_block",hover_preview_enabled:!0,is_navigable_block:e.isNavigableBlock()})}(this.props.store,this.environment)})});const o=M.Dg(n);if("none"===n.getRole())return(0,c.jsx)(O.p,{allowSelectionWithin:!1,children:(0,c.jsx)("div",{style:{border:`1px solid ${this.theme.darkDividerColor}`,borderRadius:4},children:(0,c.jsx)(V.Z,{ref:this.origin,style:{width:"100%"},onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:(0,c.jsxs)("div",{style:{display:"flex",padding:9},children:[d({width:30,height:30,marginRight:10,marginLeft:5}),(0,c.jsxs)("div",{style:{fontSize:14},children:[(0,c.jsx)("div",{style:{fontWeight:g.Z.fontWeight.medium},children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"No access to page comments",id:"aliasBlock.comment.noAccess.title"})}),(0,c.jsx)(f.FormattedMessage,{defaultMessage:"You don't have permission to view this page and its comments",id:"aliasBlock.comment.noAccess.subtitle"})]})]})})})});if(!o||!n.isDefined())return(0,c.jsx)(W,{});const i=B.t1.createChildStore(o,{table:p.qF,id:n.getParentId(),spaceId:(0,m.C)(o.pointer.spaceId)});if(null==i||!i.isDefined())return;const r=i.getModel(),a=B.G.createChildStore(o,r.getParentPointer()).getModel(),l=a&&"table_row"===a.getType()?a.getParentId():r.getParentId(),b=B.t1.createChildStore(o,{table:u.iU,id:l,spaceId:(0,m.C)(o.pointer.spaceId)});if(!b.isDefined())return;const y=o.isDefined()?b.getModel().getRenderUrl({getRecordModel:t.getRecordModel,baseUrl:w.default.domainBaseUrl,discussionId:i.id,pageVisitSource:s.tY.LinkInPage}):void 0,{isMobile:_}=this.environment.device,k=A.default.checkGate("comments_density_image_handling");return(0,c.jsx)(O.p,{allowSelectionWithin:!1,children:(0,c.jsx)("div",{style:{border:`1px solid ${this.theme.darkDividerColor}`,cursor:"pointer",borderRadius:4},children:(0,c.jsxs)(V.Z,{ref:this.origin,style:{display:"flex",flexDirection:"column"},href:y,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,c.jsxs)("div",{style:{display:"flex",pointerEvents:"none"},children:[(0,c.jsx)(S.Vd,{store:n,discussionStore:i,showResolveButtonByDefaultIfPossible:!1,blockStore:t,hoveringDiscussion:!1,discussionLocation:"comment_unfurl",collapsed:!0,maxLines:2,shouldShowThreadLine:!1,discussionContext:"suggestion"===i.getType()&&(0,c.jsx)(S.s3,{discussionStore:i,blockStore:t,collapsed:!0})},n.id),(0,c.jsx)(Z.ZP,{popupType:_?Z.Z4.SlideUp:Z.Z4.Popup,renderOrigin:e=>(0,c.jsx)(F.Z,{...e,isMobile:_,style:{margin:8,opacity:_||this.state.isHovered?1:0}}),placementToOrigin:E.Iw.Top,render:e=>(0,c.jsx)(P.LazyAliasBlockPopupMenu,{onAccept:e.close,block:t})})]}),o&&(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",paddingLeft:k?"42px":"50px",marginBottom:"10px"},children:[(0,c.jsx)(U.Z,{disabled:!0,icon:o.getIcon(),isEmptyPage:o.isEmptyPage(),size:14,style:{marginLeft:2,marginRight:2}}),(0,c.jsx)(L.Z,{store:o,style:{color:"gray",fontSize:"smaller"}})]})]})})})}getInteractiveToken(){const e=this.props.store.getAliasTargetStore();if(!(this.nodeRef&&this.nodeRef.current&&e instanceof B.G))return;const t=i.findDOMNode(this.nodeRef.current);return(0,C.We)(e,t)}}N.contextTypes={...k.wK,...r.w};const z=N;function q(e){let{style:t}=e;const n=(0,a.Fg)();return(0,c.jsx)("div",{style:{overflow:"hidden",position:"relative",background:n.selectLightGray[30],...t},children:(0,c.jsx)("div",{style:{position:"absolute",height:"100%",width:"100%",zIndex:1,animation:"shimmer 1s infinite",background:`linear-gradient(to right, ${n.selectLightGray[30]} 0%, ${n.selectLightGray[50]} 20%, ${n.selectLightGray[30]} 40%, ${n.selectLightGray[30]} 100%)`}})})}function W(){return(0,c.jsxs)(V.Z,{external:!0,style:{flexGrow:1,minWidth:0},children:[(0,c.jsx)(q,{style:{width:38,height:38}}),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",flexGrow:1},children:[(0,c.jsx)(q,{style:{width:"50%",height:14,margin:4}}),(0,c.jsx)(q,{style:{width:"40%",height:12,margin:4}})]})]})}},77933:(e,t,n)=>{n.d(t,{Z:()=>V});var o=n(67294),i=n(480),r=n(86628),a=n(49085),s=n(56666),l=n(9291),c=n(80365),d=n(24405),u=n(15145),p=n(9999),m=n(37810),f=n(84210),g=n(46654),h=n(18514),v=n(80444),b=n(81236),y=n(84076),_=n(31278),S=n(76798),w=n(94096),k=n(78454),I=n(32469),C=n(85893);const x=function(e){let{currentBlockStore:t,backlinkStore:n,scrollToBlockId:o,discussionId:a,showOriginalToken:s,disableCurrentPageToken:c,disableArrow:p}=e;const m=(0,d.Fg)(),_=(0,i.O7)(),I=(0,r.VK)((()=>!(0,g.yi)(_,t)&&(0,g.yi)(_,n)),[_,t,n]),{mainEditorCurrentBlockStore:x}=(0,r.VK)((()=>v.default.state),[]),D=x&&x.id===n.id,E=(0,r.VK)((()=>(0,f.ZP)({store:n,scrollToBlockId:o,discussionId:a,fullyQualified:!0,preferPublicLink:(0,h.Sr)(_),getSpaceDomain:()=>{var e;return null===(e=b.Z.getData(_,{spaceId:n.getSpaceId()}))||void 0===e?void 0:e.domain},pageVisitSource:u.tY.LinkInPage})),[n,o,a,_]);return(0,C.jsx)(y.Z,{href:E,external:!1,innerStyle:{paddingLeft:8,paddingRight:16},children:(0,C.jsx)(k.ZP,{childrenStyle:{padding:"4px 2px"},alignment:k.v2.Center,style:{marginBottom:2,marginRight:4},right:(0,C.jsxs)(C.Fragment,{children:[s&&(0,C.jsx)("div",{style:P(_,m),children:(0,C.jsx)(l.FormattedMessage,{defaultMessage:"Original",id:"backlink.originalTokenLabel"})}),D&&!c&&(0,C.jsx)("div",{style:P(_,m),children:(0,C.jsx)(l.FormattedMessage,{defaultMessage:"This page",id:"backlink.currentPageTokenLabel"})})]}),children:(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[!p&&(0,C.jsx)(A,{}),(0,C.jsx)(T,{backlinkStore:n}),(0,C.jsx)(S.Z,{store:n,style:M(m)}),(0,C.jsxs)("div",{style:{marginTop:-2,minWidth:0,display:"flex",alignItems:"baseline",flex:"2 0 40%",paddingTop:"0.1em"},children:[(0,C.jsx)(w.Z,{store:n,style:{paddingLeft:8}}),(0,C.jsx)(R,{isPrivate:I})]})]})})})};function T(e){let{backlinkStore:t}=e;const n=(0,r.VK)((()=>t.getIcon()),[t]),o=(0,r.VK)((()=>t.isEmptyPage()),[t]);return(0,C.jsx)(_.Z,{disabled:!0,icon:n,isEmptyPage:o,size:20,style:{marginLeft:4,marginRight:4}})}function M(e){return{fontWeight:m.Z.fontWeight.medium,fontSize:m.Z.fontSize.UIRegular.desktop,lineHeight:1.3,borderBottom:`1px solid ${e.darkDividerColor}`,flexShrink:1}}function P(e,t){const{device:n}=e;return{padding:"2px 6px",borderRadius:4,color:t.mediumTextColor,background:t.legacyDefaultSelectColor,fontSize:n.isMobile?11:9,lineHeight:n.isAndroid?1.5:1,textTransform:"uppercase",letterSpacing:"0.04em",whiteSpace:"nowrap",marginLeft:4}}function A(){const e=(0,d.Fg)();return(0,C.jsx)("div",{style:{marginLeft:4,transform:"rotate(180deg)",fill:e.regularIconColor},children:(0,p.J)({width:15,height:15})})}function R(e){let{isPrivate:t}=e;return t?(0,C.jsx)(I.Z,{style:{paddingRight:4,marginLeft:12}}):null}var D=n(89728),E=n(26388),B=n(64369);const F=10,O=a.default.createClass(F),Z=a.default.createClass(!1);const V=function(e){let{store:t,originalTransclusionStore:n,disableInaccessiblePages:a,headerText:d,disableArrow:u,disableCurrentPageToken:p}=e;const m=(0,i.O7)(),f=(0,r.qz)(void 0,Z),g=(0,r.qz)(void 0,O),h=(0,r.VK)((()=>(0,c.L)(t,m)),[t,m]),v=(0,o.useCallback)((()=>function(e){e.setState(e.state+F)}(g)),[g]),b=(0,o.useCallback)((()=>function(e){e.setState(!1)}(f)),[f]),y=(0,o.useCallback)((()=>function(e){e.setState(!0)}(f)),[f]),_=(0,r.VK)((()=>g.state),[g]),S=(0,r.VK)((()=>n?n.getNavigableBlockStore():void 0),[n]);if(0===h.backlinks.length&&!n)return null;const w=h.backlinks.length>_,k=h.inaccessibleBacklinkCount>0&&!a;return(0,C.jsxs)("div",{onMouseMove:y,onMouseLeave:b,children:[d&&(0,C.jsx)(U,{headerText:d}),n&&S&&(0,C.jsx)(x,{currentBlockStore:t,disableArrow:u,disableCurrentPageToken:p,backlinkStore:S,scrollToBlockId:n.id,showOriginalToken:!0}),h.backlinks.slice(0,_).map((e=>(0,C.jsx)(x,{currentBlockStore:t,disableArrow:u,disableCurrentPageToken:p,...e},e.backlinkStore.id))),(w||k)&&(0,C.jsx)(E.ZP,{disableTooltip:w,renderTooltip:()=>(0,C.jsx)(l.FormattedMessage,{defaultMessage:"Synced in pages that you don't have access to.",id:"page.backlinks.privatePagesTooltip"}),render:e=>(0,C.jsx)(D.Z,{icon:s.o,isGray:!0,onClick:v,style:{padding:`2px ${u?17:14}px`,width:"100%"},disabled:!w,...e,children:w?(0,C.jsx)(l.FormattedMessage,{defaultMessage:"{count} more",id:"page.backlinks.more",values:{count:h.backlinks.length-_}}):(0,C.jsx)(l.FormattedMessage,{id:"page.backlinks.privatePages",defaultMessage:"{count, plural, one {{count} private page} other {{count} private pages}}",values:{count:h.inaccessibleBacklinkCount}})})})]})};function U(e){let{headerText:t}=e;return(0,C.jsx)("div",{style:{display:"flex"},children:(0,C.jsx)(B.Z,{isSmall:!0,style:{marginTop:12,marginBottom:8,marginLeft:4,flex:1,paddingLeft:8},children:t})})}},13966:(e,t,n)=>{n.d(t,{Z:()=>f});n(67294);var o=n(480),i=n(24405),r=n(56666),a=n(6404),s=n(24677),l=n(43250),c=n(98742),d=n(27724),u=n(64921),p=n(26388),m=n(85893);const f=function(e){let{tooltipContent:t,fadeIn:n,style:o,hoveredStyle:i,store:r,onClick:a,extraAnalyticsData:s,hideFilterActionsInput:l,actionSectionGroupKey:c,onFocus:d,onBlur:u,iconStyle:f}=e;return t?(0,m.jsx)(p.ZP,{renderTooltip:()=>t,delayThreshold:300,render:e=>(0,m.jsx)(h,{tooltipEvents:e,fadeIn:n,style:o,hoveredStyle:i,store:r,onClick:a,extraAnalyticsData:s,hideFilterActionsInput:l,actionSectionGroupKey:c,onFocus:d,onBlur:u,iconStyle:f})}):(0,m.jsx)(h,{fadeIn:n,style:o,hoveredStyle:i,store:r,onClick:a,extraAnalyticsData:s,hideFilterActionsInput:l,actionSectionGroupKey:c,onFocus:d,onBlur:u,iconStyle:f,tooltipEvents:{}})};function g(e,t,n){const{device:o}=e;return{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:24,height:24,borderRadius:4,fill:o.isMobile?t.lightIconColor:t.mediumIconColor,transition:"opacity 200ms ease-in",...n}}function h(e){let{tooltipEvents:t,fadeIn:n,style:p,hoveredStyle:f,store:h,onClick:v,extraAnalyticsData:b,hideFilterActionsInput:y,actionSectionGroupKey:_,onFocus:S,onBlur:w,iconStyle:k}=e;const I=(0,i.Fg)(),C=(0,o.O7)();return(0,m.jsx)(u.Z,{className:n?l.JiD:void 0,style:g(C,I,p),hoveredStyle:f,onClick:e=>function(e,t,n,o,i,r,l){s.Ys({environment:n,store:t}),a.Qn({environment:n,stores:d.default.state.stores,left:e.clientX,top:e.clientY,showInput:!r,actionSectionGroupKey:l||"default",analyticsFrom:"block_more_menu",optionalAnalyticsProperties:{isFromBulkActionsToolbar:i?i.isFromBulkActionsToolbar:void 0}}),null==o||o()}(e,h,C,v,b,y,_),...(0,c.Z)(t,{onFocus:S,onBlur:w}),children:(0,r.o)({width:14,height:14,...k})})}},91893:(e,t,n)=>{n.d(t,{Z:()=>_});n(67294);var o=n(480),i=n(86628),r=n(24405),a=n(49271),s=n(9291),l=n(37810),c=n(88150),d=n(92650),u=n(68056),p=n(24646),m=n(77080),f=n(24666),g=n(64921),h=n(26388),v=n(65187),b=n(85893);const y=(0,s.defineMessages)({imageCaption:{defaultMessage:"Write a captionâ€¦",id:"block.imageCaption.placeholder"},altText:{defaultMessage:"Add alt text",id:"block.imageCaption.altText.tooltip"}});function _(e){let{captionAriaId:t,disabled:n,store:_}=e;const S=(0,o.O7)(),w=(0,o.Fy)(),k=(0,s.useIntl)(),I=(0,i.VK)((()=>_.getPropertyStore("caption")),[_]),{shouldShowCaption:C,shouldShowAltTextButton:x}=(0,i.VK)((()=>{var e;const t=I.getValue(),n=!t||0===t.length,o="editing"===f.default.state.mode&&(null===(e=(0,u.QY)(f.default.state.multiSelection))||void 0===e?void 0:e.store)===I;return{shouldShowCaption:!n||o,shouldShowAltTextButton:o&&n&&"image"===_.getType()&&!_.getPropertyValue("alt_text")}}),[I,_]),T=(0,i.VK)((()=>m.default.checkGate("alt_text_image_blocks")),[]),M=(0,i.VK)((()=>{const{block_full_width:e,block_width:t,block_page_width:n}=_.getFormat();if(w.isMobile)return!1;if(n)return!1;if(e)return!0;const o=(0,d.fg)(S,_);return(t||0)>=S.WindowSizeStore.state.width-(0,p.Wk)(S)-(o&&_.isFullWidth()?d.QB:0)}),[w.isMobile,S,_]),P=(0,r.yK)((e=>({root:{fontSize:14,lineHeight:1.4,color:e.mediumTextColor,paddingTop:6,paddingBottom:6,paddingLeft:a.ZD.paddingLeft,...M&&{paddingLeft:26,paddingRight:26}},buttonWrapper:{position:"absolute",top:3.5,right:0,background:e.tint.regular,color:e.text.secondary,borderRadius:4,opacity:x?1:0,transition:w.isSafari?void 0:"opacity 300ms ease-in",overflow:"hidden"},button:{padding:"4px 6px",fontSize:12,fontWeight:l.Z.fontWeight.medium,letterSpacing:.2}})),[M,w.isSafari,x]);return C?(0,b.jsxs)("div",{style:{position:"relative"},children:[(0,b.jsx)(v.Z,{id:t,disabled:n,style:P.root,placeholderStyle:P.root,placeholder:k.formatMessage(y.imageCaption),disableSlashCommands:!0,disableEmbedMenu:!0,store:I,pasteBehavior:"block",inPageFind:{type:"block_match"}}),T&&(0,b.jsx)("div",{style:P.buttonWrapper,children:(0,b.jsx)(h.ZP,{renderTooltip:()=>k.formatMessage(y.altText),placement:h.ug.Bottom,disableTooltip:!x,render:e=>(0,b.jsx)(g.Z,{...e,ariaLabel:k.formatMessage(y.altText),style:P.button,disabled:!x,onClick:()=>{c.b({blockStore:_,entrypoint:"caption",environment:S})},children:"ALT"})})})]}):null}},23864:(e,t,n)=>{n.d(t,{Z:()=>v});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(41432),l=n(33767),c=n(33866),d=n(92650),u=n(78175),p=n(98165),m=n(24646),f=n(6258),g=n(4029),h=n(85893);function v(e){let{disableCommentMenu:t,hideContent:n,hideIfSidebarOrMarginCommentsVisible:v,recursivelyLoadAllDiscussions:b,store:y}=e;const _=(0,i.O7)(),S=(0,i.Fy)(),w=(0,r.VK)((()=>{const e=y.getModel();return Boolean(null==e?void 0:e.isType(s.eh))}),[y]),k=(0,r.VK)((()=>{const e=(0,p.qA)(y);let t,n,o,i;for(const r of e){if(r instanceof f.G&&t){const e=r.getType();if(e&&(0,s.S9)(e)&&r.id!==y.id)break;if("column_list"===e){const e=r.getContentStore().getValue()||[];n=e.indexOf(t.id),o=e.length,i=(0,u.Po)(r,_)}}t=r}return{columnListIndex:n,columnListColumnCount:o,columnListResizable:i}}),[_,y]),I=(0,o.useCallback)((()=>{if(!S.isMobile){if(void 0===k.columnListIndex)return c.I.FloatRight;if(!k.columnListResizable&&k.columnListColumnCount&&k.columnListIndex===k.columnListColumnCount-1)return c.I.FloatRight}return c.I.PushContent}),[k.columnListColumnCount,k.columnListIndex,k.columnListResizable,S.isMobile]),C=(0,r.VK)((()=>(0,m.Sx)(_)),[_]),x=(0,r.VK)((()=>(0,d.fg)(_,y)),[_,y]),{blockInsetRight:T}=(0,o.useContext)(g.a),M=(0,a.yK)((e=>({wrapper:I()===c.I.FloatRight?{position:"relative",left:T}:{}})),[I,T]);return t||n||(w||v)&&(C||x)?null:(0,h.jsx)("div",{style:M.wrapper,children:(0,h.jsx)(l.Jg,{store:y,getFormat:I,recursivelyLoadAllDiscussions:Boolean(b),onlyCountBlockLevelDiscussions:C},"DiscussionIndicator")})}},4029:(e,t,n)=>{n.d(t,{a:()=>o});const o=(0,n(67294).createContext)({blockInsetRight:0})},70518:(e,t,n)=>{n.d(t,{IS:()=>P,ZP:()=>R,bZ:()=>A});n(21703);var o=n(67294),i=n(480),r=n(86628),a=n(41432),s=n(95538),l=n(53965),c=n(88864),d=n(96802),u=n(24677),p=n(13447),m=n(28020),f=n(43250),g=n(77546),h=n(58202),v=n(49427),b=n(68859),y=n(6258),_=n(91681),S=n(27724),w=n(6685),k=n(85893);const I={[a.Ti.image]:36,[a.Ti.audio]:24,[a.Ti.video]:96,[a.Ti.embed]:96,[a.Ti.drive]:96,[a.Ti.tweet]:96,[a.Ti.framer]:96,[a.Ti.maps]:96,[a.Ti.gist]:96,[a.Ti.invision]:96,[a.Ti.pdf]:96,[a.Ti.drawing]:200},C={[a.Ti.image]:36,[a.Ti.video]:96,[a.Ti.embed]:246,[a.Ti.maps]:96,[a.Ti.framer]:96,[a.Ti.tweet]:250,[a.Ti.gist]:96,[a.Ti.audio]:96,[a.Ti.drive]:300,[a.Ti.invision]:96,[a.Ti.pdf]:96,[a.Ti.columnList]:"page_width",[a.Ti.drawing]:300},x={display:"contents"},T=96,M=96;let P=function(e){return e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e[e.Corner=2]="Corner",e}({}),A=function(e){return e[e.Left=0]="Left",e[e.Right=1]="Right",e}({});const R=function(e){const t=(0,o.useRef)(void 0),n=(0,i.O7)(),m=(0,o.useRef)(null),I=(0,r.qz)(e.blockResizerStore,b.Z),C=(0,o.useCallback)((o=>{o.preventDefault();const i=e.resizeComponent.getNode();if(!(i&&i instanceof Element))return;let r=0;if(m.current){const e=(0,g.VW)(m.current);e&&(r=e.getBoundingClientRect().width)}let s=0;const c=e.store.getRecordStoreUIParent(),d=c&&c.findRecordStoreUIAncestor((e=>e instanceof y.G)).ancestor;if(d){const e=h.R.getRect(d);e&&(s=e.width);const t=d.getRecordStoreUIParent(),n=t&&t.findRecordStoreUIAncestor((e=>e instanceof y.G)).ancestor;if("tab"===(null==n?void 0:n.getType())){const e=h.R.getRect(n);e&&(s=e.width)}}const p=function(e){const t=e.getRecordStoreUIRoot(),n=v.Z.find((e=>e.props.store===t));if(n)return n.getContentInnerWidth()}(e.store)||0,f=S.default.state.stores.filter((e=>function(e){const t=e&&e.getType();return t&&a.Ok[t]}(e)));let b;b=l.q9(f,e.store)?f:[e.store];const{block_width:w,block_height:k,block_full_width:C,block_page_width:x}=e.store.getFormat();I.setState({...I.state,dragging:!0,temporaryHeight:k,temporaryWidth:w,temporaryFullWidth:C,temporaryPageWidth:x}),_.Z.setState({..._.Z.state,isResizing:!0}),u.ZH(n);const T=i.getBoundingClientRect();t.current={resizingBlocks:b,startWidth:T.width,startHeight:T.height,parentWidth:s,pageWidth:p,isRootChild:e.store.isChildOfRecordStoreUIRoot(),startScrollerWidth:r,didDragMove:!1}}),[I,n,e.resizeComponent,e.store]),T=(0,o.useCallback)((o=>{let{diffX:i}=o;if(!t.current)return;t.current.didDragMove=!0;const{temporaryHeight:r}=I.state,{width:a,isFullWidth:l,isPageWidth:c}=B({diffX:i,dragState:t.current,resizeHorizontally:e.resizeHorizontally,store:e.store,resizerAlignment:e.resizerAlignment,environment:n});if(e.preserveScale){const e=l?r||s.QA:r;I.setState({...I.state,temporaryWidth:a,temporaryFullWidth:l,temporaryPageWidth:c,temporaryHeight:e})}else I.setState({...I.state,temporaryWidth:a,temporaryFullWidth:l,temporaryPageWidth:c})}),[I,n,e.preserveScale,e.resizeHorizontally,e.resizerAlignment,e.store]),M=(0,o.useCallback)((n=>{let{diffY:o}=n;if(!t.current)return;t.current.didDragMove=!0;const{height:i}=D({diffY:o,dragState:t.current,resizeVertically:e.resizeVertically,store:e.store});I.setState({...I.state,temporaryHeight:i})}),[I,e.resizeVertically,e.store]),A=(0,o.useCallback)((o=>{let{diffX:i,diffY:r}=o;if(!t.current)return;t.current.didDragMove=!0;const{width:a,isFullWidth:s,isPageWidth:l}=B({diffX:i,resizeHorizontally:e.resizeHorizontally,store:e.store,resizerAlignment:e.resizerAlignment,dragState:t.current,environment:n}),{height:c}=D({diffY:r,dragState:t.current,resizeVertically:e.resizeVertically,store:e.store});I.setState({...I.state,temporaryWidth:a,temporaryHeight:c,temporaryFullWidth:s,temporaryPageWidth:l})}),[I,n,e.resizeHorizontally,e.resizeVertically,e.resizerAlignment,e.store]),R=(0,o.useCallback)((t=>e.resizerType===P.Horizontal?T(t):e.resizerType===P.Vertical?M(t):e.resizerType===P.Corner?A(t):void 0),[A,T,M,e.resizerType]),E=(0,o.useCallback)((()=>{I.setState({...I.state,dragging:!1,temporaryPageWidth:void 0,temporaryFullWidth:void 0,temporaryWidth:void 0,temporaryHeight:void 0}),u.ZH(n),_.Z.setState({..._.Z.state,isResizing:!1}),t.current=void 0}),[I,n]),F=(0,o.useCallback)((o=>{if(!t.current)return;const i=I.state;if(t.current.didDragMove&&i.dragging){const{temporaryPageWidth:o,temporaryFullWidth:i,temporaryWidth:r,temporaryHeight:a}=I.state;p.createAndCommit({userAction:"BlockResizer.handleDragEnd",environment:n,perform:e=>{t.current&&d.FH({stores:t.current.resizingBlocks,update:{block_height:a,block_width:r,block_full_width:i,block_page_width:o},transaction:e})}});const s=e.store.getType();s&&c.Wl(n,{block_type:s,block_height:a,block_width:r,block_full_width:i,block_page_width:o})}E()}),[I,E,n,e.store]);return(0,k.jsx)(w.Z,{onDraggableDragStart:C,onDraggableDragMove:R,onDraggableDragEnd:F,onDraggableDragCancel:E,preventSidebar:!0,render:t=>(0,k.jsx)("div",{ref:m,style:x,className:f.Ep8,...t,children:e.children})})};function D(e){const t=function(e){const{dragState:t,diffY:n,resizeVertically:o,store:i}=e;if(t){if(o){const e=i.getType(),o=e&&I[e]||T;return Math.max(t.startHeight+n,o)}return t.startHeight}return 0}(e);return{height:Math.min(t,s.Kz)}}function E(e){const{dragState:t,resizeHorizontally:n,store:o,resizerAlignment:i}=e;let r=e.diffX;if(!t)throw new Error("No start rect.");(function(e){const t=e.getModel();return e.isChildOfRecordStoreUIRoot()&&(null==t?void 0:t.isType(a.ib))})(o)&&(r*=2);let s=t.startWidth;n&&(i===A.Left?s-=r:i===A.Right&&(s+=r));const l=o.getType(),c=l&&C[l]||M,d="page_width"===c?Math.min(t.parentWidth,t.pageWidth):c;return d&&s<d&&(s=d),s}function B(e){const{dragState:t,store:n,environment:o}=e,i=E(e),r=i<144?12:48;const s=Math.round(i/r)*r,l=function(e,t,n){if(e)return e.isRootChild?e.pageWidth<t+n&&e.pageWidth>t-n:e.parentWidth<t+n;return!1}(e.dragState,i,r),c=function(e){const{dragState:t,width:n,round:o,environment:i,store:r}=e;if(t&&t.isRootChild){let e=t.startScrollerWidth;const s=r.getModel();return s&&!s.isType(a.GP)&&(e-=2*(0,m.ui)(i)),e<n+o}return!1}({dragState:t,width:i,round:r,environment:o,store:n})&&!l;return{width:s,isFullWidth:c,isPageWidth:l}}},7825:(e,t,n)=>{n.d(t,{Z:()=>y});var o=n(67294),i=n(86628),r=n(24405),a=n(49271),s=n(22491),l=n(9291),c=n(26249),d=n(33929),u=n(73819),p=n(23864),m=n(55217),f=n(78454),g=n(65187),h=n(85893);const v=(0,l.defineMessages)({listPlaceholder:{defaultMessage:"List",id:"bulletedListBlock.placeholder.label"}});function b(e,t){const n=(0,o.useRef)(null),l=(0,i.VK)((()=>{var t;const n=null===(t=e.bulletedListFormatStore)||void 0===t?void 0:t.getState();return function(e,t){switch(e){case"disc":return'"â€¢"';case"circle":return'"â—¦"';case"square":return'"â–ª"';default:return t%3==0?'"â€¢"':t%3==1?'"â—¦"':'"â–ª"'}}(null==n?void 0:n.blockIdFormats.get(e.store.id),(null==n?void 0:n.depth)||0)}),[e.bulletedListFormatStore,e.store.id]),c=(0,i.VK)((()=>e.store.getBlockTitleStore()),[e.store]),b=(0,i.VK)((()=>e.store.getContentStore()),[e.store]),y=(0,u.rv)(e.store),_=(0,r.yK)((()=>({root:{...{paddingLeft:a.ZD.paddingLeft},...y,...e.style}})),[y,e.style]),S=(0,h.jsxs)(f.ZP,{style:_.root,left:(0,h.jsx)("div",{...(0,s.iv)({fontSize:"1.5em",lineHeight:1,marginBottom:0,pseudoBefore:{fontFamily:"Arial",content:l}})}),childrenStyle:{display:"flex",flexDirection:"column"},ref:n,children:[(0,h.jsxs)("div",{style:{display:"flex"},children:[(0,h.jsx)(g.Z,{style:f.R8,disabled:e.disabled,store:c,placeholder:d.default.formatMessage(v.listPlaceholder),pasteBehavior:"block",legacyTransclusionParent:e.legacyTransclusionParent,inPageFind:{type:"block_match"}}),(0,h.jsx)(p.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]}),!e.hideContent&&(0,h.jsx)(m.Z,{disabled:e.disabled,store:b,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag,bulletedListFormatStore:e.bulletedListFormatStore})]});return(0,u.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"bulleted_list",getNode:()=>n.current,getBlockStore:()=>e.store})),[e.store]),S)}const y=o.memo(o.forwardRef(b),c.Z)},27755:(e,t,n)=>{n.d(t,{y:()=>W,Z:()=>G});n(57658);var o=n(67294),i=n(1302),r=n(480),a=n(86628),s=n(24405),l=n(2647),c=n(18442),d=n(54497),u=n(9291),p=n(31701),m=n(53965),f=n(1898),g=n(37810),h=n(24677),v=n(98104),b=n(93174),y=n(41301),_=n(58564),S=n(95645),w=n(28651),k=n(49117),I=n(33929),C=n(98742),x=n(73819),T=n(63474),M=n(49085);class P extends M.default{getInitialState(){return{editing:!1,suppressErrorsForActionIds:[]}}startEditing(e){this.setState({editing:!0,suppressErrorsForActionIds:[],placement:e.placement})}stopEditing(){this.setState({editing:!1,suppressErrorsForActionIds:[]})}suppressErrorsForAction(e){this.setState({...this.state,suppressErrorsForActionIds:m.jj([...this.state.suppressErrorsForActionIds,e])})}}const A=P;var R=n(6258),D=n(77794),E=n(13966),B=n(23864),F=n(68709),O=n(73063),Z=n(68785),V=n(63296),U=n(31278),L=n(26388),j=n(59557),N=n(33831),z=n(85893);const q=function(){const e=(0,s.yK)((e=>({settingsIcon:{fill:e.mediumIconColor},notificationBadge:{fill:e.blueColor,stroke:e.buttonBackground}})),[]);return(0,z.jsxs)(N.Z,{className:"settingsIconWithNotificationBadge",viewBox:"0 0 16 16",style:{width:16,height:16},children:[(0,z.jsx)("path",{d:"M6.406 15.36c-.492 0-.867-.299-.978-.762l-.24-1.037-.159-.059-.902.557c-.404.258-.885.193-1.23-.152l-.82-.82c-.347-.346-.411-.827-.153-1.231l.562-.896-.058-.147-1.032-.24a.981.981 0 01-.761-.979V8.44c0-.48.293-.861.761-.979l1.02-.246.064-.152-.562-.897c-.258-.404-.193-.878.152-1.236l.82-.82a.972.972 0 011.231-.153l.902.551.165-.064.24-1.037c.111-.463.486-.762.978-.762H7.59c.486 0 .867.299.978.762l.24 1.037.165.064.902-.55c.404-.252.885-.188 1.225.152l.82.82c.346.358.41.832.152 1.236l-.556.897.058.152 1.026.246a.981.981 0 01.761.979v1.154c0 .48-.304.862-.761.979l-1.037.24-.053.146.556.897c.258.404.2.885-.152 1.23l-.82.82c-.34.346-.82.41-1.23.153l-.903-.557-.152.059-.24 1.037a.972.972 0 01-.98.762H6.407zm.14-1.06h.903c.1 0 .147-.042.158-.136l.352-1.44c.387-.089.72-.235 1.008-.417l1.265.78c.07.046.141.04.217-.03l.621-.627c.065-.058.065-.129.018-.205l-.773-1.265a3.85 3.85 0 00.404-.997l1.447-.345c.088-.018.135-.065.135-.164v-.88c0-.105-.041-.146-.135-.17l-1.441-.34a3.878 3.878 0 00-.405-1.007l.774-1.26c.053-.082.053-.152-.018-.216l-.627-.616c-.07-.07-.129-.076-.217-.029l-1.26.768a3.782 3.782 0 00-1.013-.41L7.607 3.84c-.011-.093-.058-.134-.158-.134h-.902c-.1 0-.147.046-.164.134l-.346 1.442a4.07 4.07 0 00-1.02.416l-1.26-.768c-.087-.047-.146-.035-.222.03l-.62.615c-.071.07-.071.14-.019.222l.774 1.26a3.94 3.94 0 00-.399 1.008l-1.447.34c-.088.023-.129.064-.129.17v.879c0 .1.041.146.13.164l1.446.345c.088.37.247.721.41.997l-.779 1.265c-.052.076-.047.147.018.211l.621.621c.076.07.147.076.217.03l1.265-.78a3.35 3.35 0 001.014.416l.346 1.441c.017.088.064.135.164.135zm.452-3.071a2.233 2.233 0 01-2.227-2.227c0-1.212 1.008-2.214 2.227-2.214a2.23 2.23 0 012.22 2.214 2.232 2.232 0 01-2.22 2.227zm0-1.002c.656 0 1.201-.557 1.201-1.225 0-.662-.545-1.207-1.2-1.207a1.22 1.22 0 00-1.22 1.207c0 .674.551 1.225 1.22 1.225z",...e.settingsIcon}),(0,z.jsx)("circle",{cx:"12",cy:"4",r:"3.5",...e.notificationBadge})]})},W=(0,u.defineMessages)({addIconButtonAriaLabel:{defaultMessage:"Add icon",id:"buttonBlock.button.addIconButtonAriaLabel"},editButtonAriaLabel:{defaultMessage:"Edit button",id:"buttonBlock.button.editButtonAriaLabel"},buttonPlaceholder:{defaultMessage:"New button",id:"buttonBlock.button.placeholder"},buttonInsufficientPermissions:{defaultMessage:"You donâ€™t have permission to run this button",id:"buttonBlock.button.insufficientPermissions"},clickToEdit:{defaultMessage:"Click to edit button",id:"buttonBlock.button.clickToEdit"}});class H extends S.Z{constructor(){super(...arguments),this.sizeObserver=new D.E,this.buttonRef=o.createRef(),this.storeTypes={mouseStore:w.Z,buttonBlockStore:A},this.handleContainerMount=e=>{e&&this.sizeObserver.observe(e)},this.configureButtonBlock=e=>{const{buttonBlockStore:t}=this.stores;v.ZH(this.environment),h.ZH(this.environment);this.sizeObserver.rect.state.width<300&&!this.environment.device.isPhone&&e?t.startEditing({placement:{type:"popup",originRect:e}}):t.startEditing({placement:{type:"inline"}})},this.allActionDependenciesLoaded=this.createComputedStore((()=>{const e=this.props.store.getAutomationPointer();return!!e&&(0,_.k)(this.props.store,e)}))}handleCreated(){i.default.afterNextFlush((()=>{var e;this.configureButtonBlock(null===(e=this.buttonRef.current)||void 0===e?void 0:e.getBoundingClientRect())}))}willUnmount(){this.sizeObserver.destroy()}UNSAFE_willMountOrUpdate(e){super.UNSAFE_willMountOrUpdate(e),this.allActionDependenciesLoaded.state}activate(){var e;null===(e=this.buttonRef.current)||void 0===e||e.activate()}renderPersisted(){const{store:e}=this.props,{mouseStore:t,buttonBlockStore:n}=this.stores,o=!(e.canEdit()&&!this.props.disabled);return(0,z.jsxs)(F.p,{allowSelectionWithin:!0,style:{display:"flex"},ref:this.handleContainerMount,children:[(0,z.jsxs)("div",{style:{flexGrow:1,flexShrink:1,minWidth:0},children:[(0,z.jsx)(K,{store:e,mouseStore:t,buttonBlockStore:n,onConfigure:this.configureButtonBlock,ref:this.buttonRef,disabledFromEditing:o}),(0,z.jsx)(b.On,{store:e,disabled:o,buttonBlockStore:n})]}),(0,z.jsx)(B.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store,recursivelyLoadAllDiscussions:!0})]})}}const K=o.forwardRef(((e,t)=>{const{store:n,mouseStore:i,buttonBlockStore:_,onConfigure:S,disabledFromEditing:w}=e,M=(0,u.useIntl)(),P=(0,r.O7)(),{isMobile:A}=(0,r.Fy)(),[D,B]=(0,o.useState)(!1),F=(0,a.VK)((()=>i.state.mouseEntered),[i]),N=(0,a.VK)((()=>n.getAutomationStore()),[n]),H=(0,a.VK)((()=>(null==N?void 0:N.getNameStore().getValue())??""),[N]),K=(0,a.VK)((()=>n.getFormat().block_color||"default"),[n]),G=(0,p.p6)(K,(0,s.Fg)()),$=G.background,Q=G.color,Y=G.hoveredBackground,J=G.pressedBackground,X=(0,a.VK)((()=>null==N?void 0:N.getIconStore().getValue()),[N]),ee=function(e){const{store:t,automationStore:n,buttonBlockStore:o}=e,i=function(e){const{store:t,automationStore:n}=e,o=(0,r.O7)(),i=o.currentUser.id;return(0,a.VK)((()=>{const e=t.getRecordStoreUIRoot();if(n&&e instanceof R.G)return(0,k.Gb)({type:"button_block",automationStore:n,blockStore:t,pageStore:e,intl:I.default.getIntl(),parentRecordStore:n,currentUserId:i})}),[n,t,i])}({store:t,automationStore:n});return(0,a.VK)((()=>{const e=null==i?void 0:i.state;if(!e)return{type:"disabled"};if("insufficient"===e.executionPermissionStatus||"unknown"===e.executionPermissionStatus)return{type:"disabled",tooltip:W.buttonInsufficientPermissions};if("sufficient"===e.executionPermissionStatus){if(0===((null==n?void 0:n.getActionIds())??[]).length)return{type:"error",tooltip:y.Mm.noActions,hideErrorIconWhenEditorIsOpen:!0};const t=e.typecheckResult.value.actionValidationFailures,i=Object.entries(t).filter((e=>{let[t]=e;return!o.state.suppressErrorsForActionIds.includes(t)})).flatMap((e=>{let[,t]=e;return t})),r=m.Ps(i);return r?{type:"error",tooltip:(0,y.Fp)(r).forButtonTooltip}:{type:"enabled"}}(0,f.t1)(e)}),[i,n,o])}({store:n,automationStore:N,buttonBlockStore:_}),te=(0,x.cR)(n)||"disabled"===ee.type||D||"error"===ee.type&&w,ne=(0,a.VK)((()=>"error"===ee.type&&!(ee.hideErrorIconWhenEditorIsOpen&&_.state.editing)),[ee,_]),{showFactoryButtonDeprecationBadge:oe,setHasSeenFactoryButtonDeprecationBadge:ie}=(0,j.N)({blockStore:n}),re=(0,s.yK)((e=>{const t=A?"52px":"28px";return{wrap:{display:"flex",alignItems:"center",padding:"2px 0"},configureWrap:{display:"flex",alignItems:"center",marginLeft:4},label:{pointerEvents:"none",color:Q,...g.Z.textOverflowStyle},button:{display:"flex",gap:6,minWidth:50,maxWidth:`calc(100% - ${t})`,padding:"8px 12px",fontWeight:500,...te?{cursor:"not-allowed"}:{}},labelPlaceholder:{color:e.lightTextColor},warningIcon:{width:16,height:16,fill:e.errorText,color:e.errorText},spinnerWrap:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",marginLeft:-4}}}),[te,A,Q]),ae=(0,T.D)(),se=(0,o.useRef)(null),le=(0,o.useCallback)((()=>{i.setState({...i.state,mouseEntered:!0})}),[i]),ce=(0,o.useCallback)((()=>{i.setState({...i.state,mouseEntered:!1})}),[i]),de=(0,o.useCallback)((()=>{var e;S(null===(e=se.current)||void 0===e?void 0:e.getBoundingClientRect())}),[S,se]),ue=(0,o.useCallback)((()=>{_.state.editing?(_.stopEditing(),(0,l.lN)(ae,{block_id:n.id,automation_id:null==N?void 0:N.id})):(de(),ie(),(0,l.yK)(ae,{block_id:n.id,automation_id:null==N?void 0:N.id}))}),[_,ae,n.id,null==N?void 0:N.id,de,ie]),pe=(0,o.useCallback)((async()=>{const e=n.getRecordStoreUIRoot();if(N&&e instanceof R.G)if(v.ZH(P),h.ZH(P),"error"===ee.type)w||de();else if("enabled"===ee.type)try{B(!0);const{automationExecutionActions:t}=await b._1.loader();await t.executeClientAutomation({environment:P,store:n,clientContext:{type:"button_block",automationStore:N,blockStore:n,pageStore:e,intl:I.default.getIntl(),parentRecordStore:N,currentUserId:P.currentUser.id}})}finally{B(!1)}else"disabled"===ee.type||(0,f.t1)(ee)}),[n,N,P,ee,w,de]);(0,o.useImperativeHandle)(t,(()=>({activate:()=>{pe()},getBoundingClientRect:()=>{var e;return null===(e=se.current)||void 0===e?void 0:e.getBoundingClientRect()}})),[pe]);const me=()=>(0,z.jsx)("div",{style:re.spinnerWrap,children:(0,z.jsx)(Z.Z,{})}),fe=[];var ge;X&&(D?fe.push({key:"left",comp:me()}):fe.push({key:"left",comp:(ge=X,(0,z.jsx)(U.Z,{largeIcon:!0,disabled:!0,isEmptyPage:!1,size:20,icon:{icon:ge,pointer:n.pointer},style:{marginLeft:H?-4:0}}))})),H?fe.push({key:"name",comp:(0,z.jsx)("div",{style:re.label,children:H})}):X||fe.push({key:"placeholder",comp:(0,z.jsx)("div",{style:re.labelPlaceholder,children:(0,z.jsx)(u.FormattedMessage,{...W.buttonPlaceholder})})}),!X&&D&&fe.push({key:"right",comp:me()}),ne&&fe.push({key:"error",comp:(0,z.jsx)("div",{children:(0,d.t)(re.warningIcon)})});const he=e=>(0,z.jsx)(V.Z,{disabled:te,disabledFeedback:!0,style:re.button,ref:se,...(0,C.Z)(e??{},{onClick:pe}),backgroundColor:$,hoveredBackgroundColor:Y,pressedBackgroundColor:J,children:fe.map((e=>{let{key:t,comp:n}=e;return(0,z.jsx)(o.Fragment,{children:n},t)}))});return(0,z.jsxs)("div",{style:re.wrap,onMouseMove:le,onMouseLeave:ce,children:[ee.tooltip?(0,z.jsx)(L.ZP,{renderTooltip:()=>(0,z.jsx)(y.So,{content:(0,z.jsx)(u.FormattedMessage,{...ee.tooltip}),subtitle:"error"!==ee.type||w?null:(0,z.jsx)(u.FormattedMessage,{...W.clickToEdit})}),delayThreshold:0,render:he,placement:L.ug.Bottom}):he(),!w&&(P.device.isMobile||F)&&(0,z.jsxs)("div",{style:re.configureWrap,children:[(0,z.jsx)(L.ZP,{renderTooltip:()=>(0,z.jsx)(u.FormattedMessage,{defaultMessage:"Edit button",id:"buttonBlock.configureTemplate.button.label"}),delayThreshold:300,render:e=>(0,z.jsx)(O.Z,{ariaLabel:M.formatMessage(W.editButtonAriaLabel),icon:oe?()=>(0,z.jsx)(q,{}):c.H,onClick:ue,...e})}),P.device.isMobile&&(0,z.jsx)(E.Z,{tooltipContent:(0,z.jsx)(u.FormattedMessage,{defaultMessage:"More actionsâ€¦",id:"buttonBlock.moreActions.button.label"}),store:n,fadeIn:!1})]})]})}));const G=H},38376:(e,t,n)=>{n.d(t,{Z:()=>I});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(49271),l=n(15157),c=n(9291),d=n(31701),u=n(26249),p=n(41433),m=n(9953),f=n(13447),g=n(73819),h=n(23864),v=n(4029),b=n(31278),y=n(55217),_=n(65187),S=n(85893);const w=(0,c.defineMessages)({inputPlaceholder:{defaultMessage:"Type somethingâ€¦",id:"calloutBlock.inputPlaceholder"},changeIconLabel:{defaultMessage:"Change callout icon",id:"calloutBlock.changeIconLabel"},disabledIconLabel:{defaultMessage:"Callout icon",id:"calloutBlock.disabledIconLabel"}});function k(e,t){const n=(0,i.O7)(),u=(0,c.useIntl)(),k=(0,o.useRef)(null),I=(0,g.PE)(e.store,e.disabled),C=(0,r.VK)((()=>e.store.getBlockTitleStore()),[e.store]),x=(0,r.VK)((()=>e.store.getContentStore()),[e.store]),T=(0,r.VK)((()=>e.store.getFormat().block_color||"default"),[e.store]),M=(0,r.VK)((()=>e.store.getIcon()),[e.store]),P=(0,o.useCallback)((async t=>{const o=e.store.getIconStore();if(o){const{serverCommitResult:e}=f.createAndCommit({userAction:"CalloutBlock.handleEmojiChange",environment:n,perform:e=>{m.sO({store:o,value:t,transaction:e}),l.Z.set({userId:n.currentUser.id,key:p.nF,value:t})}});await e}}),[n,e.store]),A=(0,a.yK)((e=>({root:{display:"flex",width:"100%",borderRadius:4,border:(0,d.jS)(T)?void 0:`1px solid ${e.darkDividerColor}`,backgroundColor:"transparent",paddingLeft:12,paddingTop:16,paddingBottom:16,paddingRight:16,...(0,d.x7)(T,e)}})),[T]),{blockInsetRight:R}=(0,o.useContext)(v.a),D=(0,S.jsxs)("div",{role:"note",style:{display:"flex"},ref:k,children:[(0,S.jsxs)("div",{style:{...e.style,...A.root},children:[(0,S.jsx)("div",{children:I?(0,S.jsx)(b.Z,{bucket:"secure",store:e.store,isEmptyPage:!1,onChange:P,disableRemoveIcon:!0,isCallout:!0,icon:M,size:24,disabled:!1,label:u.formatMessage(w.changeIconLabel)}):(0,S.jsx)(b.Z,{icon:M,isEmptyPage:!1,size:24,disabled:!0,label:u.formatMessage(w.disabledIconLabel)})}),(0,S.jsxs)("div",{style:{display:"flex",flexDirection:"column",minWidth:0,marginLeft:8,width:"100%"},children:[(0,S.jsx)(_.Z,{style:{paddingLeft:s.ZD.paddingLeft,paddingRight:s.ZD.paddingRight},disabled:e.disabled,store:C,placeholder:u.formatMessage(w.inputPlaceholder),pasteBehavior:"block",inPageFind:{type:"block_match"}}),!e.hideContent&&(0,S.jsx)(v.a.Provider,{value:{blockInsetRight:R+16},children:(0,S.jsx)(y.Z,{disabled:e.disabled,store:x,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag})})]})]}),(0,S.jsx)(h.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]});return(0,g.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"callout",getNode:()=>k.current,getBlockStore:()=>e.store})),[e.store]),D)}const I=o.memo(o.forwardRef(k),u.Z)},28385:(e,t,n)=>{n.d(t,{Z:()=>U});n(52262),n(24506);var o=n(67294),i=n(83355),r=n(1302),a=n(13991),s=n(15095),l=n(62193),c=n(20852),d=n(6746),u=n(70203),p=n(38585),m=n(53965),f=n(37810),g=n(893),h=n(993),v=n(98724),b=n(94887),y=n(74284),_=n(13447),S=n(48514),w=n(14976),k=n(62619),I=n(68056),C=n(46654),x=n(55227),T=n(89086),M=n(66638),P=n(77907),A=n(807),R=n(77080),D=n(69316),E=n(52689),B=n(24666),F=n(29595),O=n(93262),Z=n(85893);class V extends i.Z{constructor(){super(...arguments),this.editor=null,this.mergeEditorRefs=(0,l.sH)(),this.renderContentContainer=(e,t,n)=>{let{leafRef:o,wrapperRef:i,...r}=e;return(0,Z.jsx)("div",{ref:i,style:{display:"flex",...!this.props.codeWrap&&{overflowX:"auto",WebkitOverflowScrolling:"touch"},...this.props.wrapStyle},className:"line-numbers notion-code-block",...r,children:(0,Z.jsx)(F.Z,{ref:this.mergeEditorRefs(this.editorRef,o),style:{...(s=this.theme,l=this.props.style,{flexGrow:1,flexShrink:1,textAlign:"left",fontFamily:f.Z.getCompositeFontFamily(a.SP).githubMono,fontSize:"85%",tabSize:2,padding:"34px 16px 32px 32px",minHeight:"1em",color:s.regularTextColor,...l}),...this.props.isQuickFind&&{paddingTop:12},...this.props.codeWrap?{whiteSpace:"pre-wrap",wordBreak:"break-all",minWidth:0}:{whiteSpace:"pre"}},getDisabled:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_getDisabled,getHtml:this.getHtml,getSelection:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_getContainerSelection,onMutation:e=>function(e,t,n,o,i){const{newValue:r}=e;j("typing_lag",t,n,o);const a=null!=i&&i.pageStore?A.Z.getMode(null==i?void 0:i.pageStore):"default";_.createAndCommit({userAction:"CodeBlockValue.handleMutation",environment:o,perform:e=>{h.aS({environment:o,editorMode:a,store:n,newValue:r,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:!0,transaction:e})}})}(e,this.props.blockStore,this.props.store,this.environment,this.pageContext),spellCheck:!1,autoCorrect:"off",autoCapitalize:"off",onSelect:t,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,suppressNewlineEvents:!1,placeholder:" ",disableContentEditableWhenNotEditingTextOnMobile:!0})});var s,l},this.handleClick=e=>{w.SD({environment:this.environment,event:e,textValue:z(this.props.store,this.props.blockStore,this.inPageFindQueryStore,this.isNewDiscussionMenuTarget),editorNode:this.getEditorNode(),store:this.props.store,canEdit:q(this.props.disabled,this.props.store,this.pageContext)})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDelete=e=>function(e,t,n,o,i,r){if(!q(n,o,r))return;j("typing_delete",i,o,t);const a=B.default.state;if("editing"===a.mode&&a.multiSelection.start.store===o){const n=null!=r&&r.pageStore?A.Z.getMode(null==r?void 0:r.pageStore):"default";_.createAndCommit({userAction:"CodeBlockValue.handleDelete",environment:t,perform:o=>{b.as({environment:t,multiSelection:a.multiSelection,deleteForwards:!0,transaction:o,event:e,editorMode:n})}})}}(e,this.environment,this.props.disabled,this.props.store,this.props.blockStore,this.pageContext),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleBackspace=e=>function(e,t,n,o,i,r){if(!q(n,o,r))return;j("typing_backspace",i,o,t);const a=B.default.state;if("editing"===a.mode&&a.multiSelection.start.store===o){if(b.YV({device:t.device,event:e,multiSelection:a.multiSelection}))return;const n=null!=r&&r.pageStore?A.Z.getMode(null==r?void 0:r.pageStore):"default";_.createAndCommit({userAction:"CodeBlockValue.handleBackspace",environment:t,perform:o=>{b.as({environment:t,multiSelection:a.multiSelection,deleteForwards:!1,transaction:o,event:e,editorMode:n})}})}}(e,this.environment,this.props.disabled,this.props.store,this.props.blockStore,this.pageContext),this.handleEnter=e=>{var t;if(!q(this.props.disabled,this.props.store,this.pageContext))return;if(j("typing_enter",this.props.blockStore,this.props.store,this.environment),null===(t=e.preventDefault)||void 0===t||t.call(e),this.editor&&this.editor.isComposing)return;const n=B.default.state,o="editing"===n.mode&&(0,I.QY)(n.multiSelection);if(o){var i,r;const e=null!==(i=this.pageContext)&&void 0!==i&&i.pageStore?A.Z.getMode(null===(r=this.pageContext)||void 0===r?void 0:r.pageStore):"default";!function(e){const{environment:t,editorMode:n,store:o,selection:i}=e;let r="";if(R.default.checkGate("code_block_preserve_indent")){const e=u.KU1(o.getValue(),0,i.startIndex),t=u.QaF(e).split("\n").at(-1),n=null==t?void 0:t.match(/^[ \t]+/);n&&(r=n[0])}_.createAndCommit({userAction:"CodeBlockValue.handleEnter",environment:t,perform:e=>{h.hJ({environment:t,editorMode:n,store:o,string:`\n${r}`,selection:i,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e})}})}({environment:this.environment,store:this.props.store,editorMode:e,selection:o.selection})}},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleShiftEnter=e=>function(e,t,n,o,i,r){var a;if(!q(n,o,r))return;j("typing_enter",i,o,t),null===(a=e.preventDefault)||void 0===a||a.call(e);const s=B.default.state;if("editing"===s.mode){const e=null!=r&&r.pageStore?A.Z.getMode(r.pageStore):"default";_.createAndCommit({userAction:"CodeBlockValue.handleShiftEnter",environment:t,perform:n=>{y.IO({environment:t,editorMode:e,multiSelection:s.multiSelection,transaction:n})}}),L()}}(e,this.environment,this.props.disabled,this.props.store,this.props.blockStore,this.pageContext),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleTab=e=>function(e,t,n,o,i,r){if(!q(n,o,r))return;j("typing_tab",i,o,t),e.preventDefault();const a=B.default.state,s="editing"===a.mode&&(0,I.QY)(a.multiSelection);if(s){const e=null!=r&&r.pageStore?A.Z.getMode(r.pageStore):"default";_.createAndCommit({userAction:"CodeBlockValue.handleTab",environment:t,perform:n=>{h.wA({environment:t,editorMode:e,store:o,selection:s.selection,transaction:n,shouldStripTokens:!0})}})}}(e,this.environment,this.props.disabled,this.props.store,this.props.blockStore,this.pageContext),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleUntab=e=>function(e,t,n,o,i,r){if(!q(n,o,r))return;j("typing_untab",i,o,t),e.preventDefault();const a=B.default.state,s="editing"===a.mode&&(0,I.QY)(a.multiSelection);if(s){const e=null!=r&&r.pageStore?A.Z.getMode(r.pageStore):"default";_.createAndCommit({userAction:"CodeBlockValue.handleUntab",environment:t,perform:n=>{h.O5({environment:t,editorMode:e,store:o,selection:s.selection,transaction:n,shouldStripTokens:!0})}})}}(e,this.environment,this.props.disabled,this.props.store,this.props.blockStore,this.pageContext),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleCut=e=>function(e,t,n,o,i,r){if(!q(o,i,r))return void e.preventDefault();g.by({environment:t,event:e,markdownLinkifyIt:n})}(e,this.environment,this.props.markdownLinkifyIt,this.props.disabled,this.props.store,this.pageContext),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handlePaste=e=>function(e,t,n,o,i,r,a){if(!q(i,r,a))return void e.preventDefault();_.createAndCommit({userAction:"CodeBlockValue.handlePaste",environment:t,perform:i=>{g.v({environment:t,event:e,disableEmbedMenu:!0,transaction:i,onPasteFiles:g.AL,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o})}})}(e,this.environment,this.props.markdownLinkifyIt,this.props.tinyMceMicrosoftWordPasteFilter,this.props.disabled,this.props.store,this.pageContext),this.handleMouseOver=e=>{w.vO({environment:this.environment,event:e,textValue:z(this.props.store,this.props.blockStore,this.inPageFindQueryStore,this.isNewDiscussionMenuTarget),editorNode:this.getEditorNode(),store:this.props.store,canEdit:q(this.props.disabled,this.props.store,this.pageContext)})},this.handleMouseOut=e=>{w.kV({environment:this.environment,event:e,textValue:z(this.props.store,this.props.blockStore,this.inPageFindQueryStore,this.isNewDiscussionMenuTarget),editorNode:this.getEditorNode(),store:this.props.store,canEdit:q(this.props.disabled,this.props.store,this.pageContext)})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_getDisabled=()=>{return e=this.props.disabled,t=this.props.store,n=this.pageContext,!q(e,t,n);var e,t,n},this.getHtml=()=>{const{store:e,Prism:t}=this.props,n=z(this.props.store,this.props.blockStore,this.inPageFindQueryStore,this.isNewDiscussionMenuTarget),i=u.QaF(n),r=t.languages[this.props.language];if(this.props.language!==c.PrismLanguages.html&&this.props.language!==c.PrismLanguages.markup||(t.languages.markup.tag.addInlined("style","css"),t.languages.markup.tag.addInlined("script","javascript")),i&&r&&i.length<1e4){const a=document.createElement("div"),s=t.highlight(i,r,this.props.language);a.innerHTML=x.g7(s);const l=Array.from(a.childNodes).map(N),c=function(e){let{syntaxTokens:t,textValue:n,parentSpaceId:o,store:i,theme:r}=e;const a=p.Mw(n&&{value:n,spaceId:o},i.getRecordModel),s=x.kF(a,t),l=a.map(u.hDy).map((e=>p.fn({annotations:e,theme:r,spaceId:o,getRecordModel:i.getRecordModel})));return s.map(((e,t)=>(0,Z.jsx)("span",{className:[e.classNames||"",...l[e.textTokenIndex].classNames].join(" "),style:l[e.textTokenIndex].style,"data-token-index":e.textTokenIndex,children:e.value},t)))}({parentSpaceId:this.props.parentSpaceId,store:e,syntaxTokens:m.oA(l),textValue:n,theme:this.theme}),f=(0,Z.jsxs)(o.Fragment,{children:[c,(0,Z.jsx)("span",{children:"\n"})]});return d.Z.renderToStaticMarkup(f)}{const t=w.IY({environment:this.environment,textValue:n&&{value:n,spaceId:this.props.parentSpaceId},parentStore:e,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!0,disabled:!q(this.props.disabled,this.props.store,this.pageContext),theme:this.theme,emojiType:"raw",katex:void 0,formulaValueTypes:[]});return d.Z.renderToStaticMarkup((0,Z.jsx)(Z.Fragment,{children:t}))}},this.clearBrowserSelection=()=>{var e;null===(e=this.getEditorNode())||void 0===e||e.blur()},this.inPageFindQueryStore=this.createComputedStore((()=>{const e=D.Z.state;return e.open&&e.findQuery.length>0?e.findQuery:void 0})),this.isEditing=this.createComputedStore((()=>{var e;const t=B.default.state;return"editing"===t.mode&&(null===(e=(0,I.QY)(t.multiSelection))||void 0===e?void 0:e.store)===this.props.store})),this.isNewDiscussionMenuTarget=this.createComputedStore((()=>{var e;const t=S.Z.state;return t.open&&"inline"===t.type&&(null===(e=(0,I.QY)(t.multiSelection))||void 0===e?void 0:e.store)===this.props.store})),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_getContainerSelection=()=>function(e,t){if(t.state)return(0,T.HE)(e)}(this.props.store,this.isEditing),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_getEndSelection=()=>function(e,t,n,o){const i=s.p4(u.QaF(z(e,t,n,o)));return{startIndex:i.length,endIndex:i.length}}(this.props.store,this.props.blockStore,this.inPageFindQueryStore,this.isNewDiscussionMenuTarget),this.editorRef=e=>{this.editor=e}}renderComponent(){const{disabled:e}=this.props;return(0,Z.jsx)(O.Z,{store:this.props.store,disabled:e,clearBrowserSelection:this.clearBrowserSelection,getEndSelection:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_getEndSelection,onClick:this.handleClick,onDelete:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDelete,onBackspace:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleBackspace,onEnter:this.handleEnter,onShiftEnter:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleShiftEnter,onCommandEnter:m.yR,onCommandShiftEnter:m.yR,onTab:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleTab,onUntab:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleUntab,onToggleHighlight:e=>W(["h",E.Z.state.color],e,this.environment,this.props.disabled,this.props.store,this.pageContext),onToggleBold:e=>W(["b"],e,this.environment,this.props.disabled,this.props.store,this.pageContext),onToggleItalics:e=>W(["i"],e,this.environment,this.props.disabled,this.props.store,this.pageContext),onToggleUnderline:e=>W(["_"],e,this.environment,this.props.disabled,this.props.store,this.pageContext),onToggleStrike:e=>W(["s"],e,this.environment,this.props.disabled,this.props.store,this.pageContext),onToggleCode:m.yR,onCopy:e=>function(e,t,n){g.JG({environment:n,event:e,markdownLinkifyIt:t})}(e,this.props.markdownLinkifyIt,this.environment),onCut:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleCut,onPaste:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handlePaste,onMoveUp:e=>{return t=this.environment,void _.createAndCommit({userAction:"CodeBlockValue.handleMoveUp",environment:t,perform:e=>{h.fs({environment:t,transaction:e,direction:"up"})}});var t},onMoveDown:e=>{return t=this.environment,void _.createAndCommit({userAction:"CodeBlockValue.handleMoveDown",environment:t,perform:e=>{h.fs({environment:t,transaction:e,direction:"down"})}});var t},render:this.renderContentContainer,disableMentions:!0,disableSlashCommands:!0,canSelectAllBlocks:!0,canInsertText:!0,canSelectionDrag:!0,topBottomPadding:40,pasteBehavior:"inline"})}getEditorNode(){var e;return(null===(e=this.editor)||void 0===e?void 0:e.getNode())||void 0}}function U(e){const{value:t}=(0,P.useDependency)(P.deps.prismjs),{value:n}=(0,P.useDependency)(P.deps.markdownLinkifyIt),{value:o}=(0,P.useDependency)(P.deps.tinyMceMicrosoftWordPasteFilter);return t?(0,Z.jsx)(V,{...e,Prism:t,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o}):null}function L(){r.default.flush()}function j(e,t,n,o){(0,M.u)({type:e,environment:o,blockStore:t,store:n,isInCollectionView:!1})}function N(e){return k.Gs(e)?[e.data]:k.kK(e)?[e.textContent||"",e.className]:void 0}function z(e,t,n,o){let i=e.getValue();return n.state&&(i=w.cD({textValue:i,blockId:null==t?void 0:t.id,textProps:{type:"block_match"}})),o.state?w.Gj({store:e}):i}function q(e,t,n){const o=n&&n.publicEditModeStore.state;return!(0,C.YF)(o)&&Boolean(!e&&t.canEdit())}function W(e,t,n,o,i,r){q(o,i,r)&&(t.preventDefault(),v.aS({environment:n,annotation:e}),L())}V.displayName="CodeBlockValue"},53223:(e,t,n)=>{n.d(t,{DZ:()=>o.LazyCollectionViewBlock,wA:()=>i});var o=n(77907);function i(e){return"isCollectionViewBlock"in e&&"boolean"==typeof e.isCollectionViewBlock&&e.isCollectionViewBlock}},69015:(e,t,n)=>{n.d(t,{b:()=>c,Z:()=>w});n(67294);var o=n(73935),i=n(83355),r=n(1302),a=n(53965),s=n(14976),l=n(1898);let c=function(e){return e.Inline="Inline",e.InlineWrap="InlineWrap",e.Textarea="Textarea",e}({}),d=function(e){return e.Submit="Submit",e.Newline="Newline",e}({});function u(e){const{device:t,e:n,action:o,onSubmit:i}=e;if(o===d.Submit)i&&i(n);else if(o===d.Newline){if(!t.isIOS)return;n.preventDefault&&n.preventDefault(),document.execCommand("insertLineBreak")}else(0,l.t1)(o)}var p=n(73744),m=n(89224),f=n(49085);class g extends f.default{getInitialState(){return{}}}const h=g;var v=n(24666),b=n(29595),y=n(3386),_=n(85893);class S extends i.Z{constructor(){super(...arguments),this.storeTypes={store:h},this.handleWindowMouseDown=e=>{const t=o.findDOMNode(this);t&&!t.contains(e.target)&&this.props.onBlur&&this.props.onBlur()},this.handleEsc=e=>{this.handleKeyEvent(),this.props.onCancel&&this.props.onCancel(e)},this.handleShiftEnter=e=>{const{device:t}=this.environment;t.isIOS&&!("shiftKey"in e)?u({device:t,e,action:d.Newline}):this.handleEnter(e)},this.handleEnter=e=>{const{type:t,onSubmit:n}=this.props,{device:o}=this.environment;if(this.getDisabled())return;const i=function(e){const{device:t,type:n,e:o}=e;return n===c.Inline?d.Submit:n===c.InlineWrap?t.isPhone?d.Submit:"altKey"in o&&o.altKey||"shiftKey"in o&&o.shiftKey?d.Newline:d.Submit:n===c.Textarea?d.Newline:void(0,l.t1)(n)}({device:o,type:t,e});u({device:o,e,action:i,onSubmit:n})},this.handleLeft=e=>{this.getDisabled()||(this.handleKeyEvent(),this.props.onLeft&&this.props.onLeft(e))},this.handleRight=e=>{this.getDisabled()||(this.handleKeyEvent(),this.props.onRight&&this.props.onRight(e))},this.handleKeyEvent=()=>{r.default.afterNextFlush((()=>{this.saveSerializedTextSelection()}))},this.getDisabled=()=>!!this.props.disabled||!this.props.focus,this.getHtml=()=>{const e=a.YU(this.props.value+(this.props.value.length>0?"\n":""));return this.props.getHtml?this.props.getHtml(e):e},this.getSelection=()=>{const e=this.stores.store.state.selection;return e&&{type:"contain",selection:e}},this.handleMutation=e=>{let{newValue:t}=e;this.saveSerializedTextSelection(),this.props.onChange(t)},this.saveSerializedTextSelection=()=>{const{store:e}=this.stores,t=s.Ut(this.environment,m.get());t&&(a.Xy(t.selection,e.state.selection)||this.stores.store.setState({selection:t.selection}),t.forceEmitSelectionStore&&v.default.emit())}}UNSAFE_willMount(e){super.UNSAFE_willMount(e),p.lj(window,"mousedown",this.handleWindowMouseDown)}UNSAFE_willMountOrUpdate(e){super.UNSAFE_willMountOrUpdate(e);const{store:t}=this.stores;e.focus&&!t.state.selection&&(e.selectAll?t.setState({selection:{startIndex:0,endIndex:e.value.length}}):t.setState({selection:{startIndex:e.value.length,endIndex:e.value.length}}))}willUnmount(){super.willUnmount(),p.ZV(window,"mousedown",this.handleWindowMouseDown)}renderComponent(){const{type:e}=this.props;return(0,_.jsx)(y.Z,{debugName:"ContentEditableInput",capture:!this.getDisabled(),onDelete:this.handleKeyEvent,onBackspace:this.handleKeyEvent,onEnter:this.handleEnter,onShiftEnter:this.handleShiftEnter,onCommandEnter:this.handleKeyEvent,onCommandShiftEnter:this.handleKeyEvent,onUp:this.handleKeyEvent,onDown:this.handleKeyEvent,onLeft:this.handleLeft,onRight:this.handleRight,onTab:this.handleKeyEvent,onUntab:this.handleKeyEvent,onSelectAll:this.handleKeyEvent,onToggleBold:this.handleKeyEvent,onToggleItalics:this.handleKeyEvent,onToggleStrike:this.handleKeyEvent,onToggleCode:this.handleKeyEvent,onUndo:this.handleKeyEvent,onRedo:this.handleKeyEvent,onEsc:this.handleEsc,onCut:this.handleKeyEvent,onCopy:this.handleKeyEvent,onPaste:this.handleKeyEvent,onKeypress:this.handleKeyEvent,onHome:this.handleKeyEvent,onEnd:this.handleKeyEvent,onGoToBeginningOfLine:this.handleKeyEvent,onGoToEndOfLine:this.handleKeyEvent,onGoForwardOneChar:this.handleKeyEvent,onGoBackwardOneChar:this.handleKeyEvent,children:(0,_.jsx)(b.Z,{style:{...this.props.style,whiteSpace:"pre-wrap"},placeholder:this.props.placeholder,placeholderStyle:this.props.placeholderStyle,spellCheck:!1,autoCorrect:this.props.autoCorrect,autoCapitalize:this.props.autoCapitalize,getDisabled:this.getDisabled,getHtml:this.getHtml,getSelection:this.getSelection,onMutation:this.handleMutation,suppressNewlineEvents:e===c.Inline})})}}S.displayName="ContentEditableInput";const w=S},29595:(e,t,n)=>{n.d(t,{Z:()=>v});n(21703),n(67294);var o=n(83355),i=n(18466),r=n(1302),a=n(22491),s=n(1898),l=n(14976),c=n(46150),d=n(62619),u=n(45162),p=(n(60846),n(89224)),m=n(24666),f=n(85893);let g=!1;class h extends o.Z{constructor(e){super(e),this.root=null,this.ownNodeIsComposing=!1,this.testDiv=document.createElement("div"),this.shouldDisableContentEditableForMobile=!1,this.handleRootMount=e=>{this.root=e},this.handleTextSelectionEditingStoreForMobile=()=>{this.shouldDisableContentEditableForMobile=!m.default.isEditingStore.state,this.root&&this.updateContentEditableAttribute(this.root)},this.handleCompositionStart=()=>{const{device:e}=this.environment;e.isAndroid||(this.ownNodeIsComposing=!0,this.props.onCompositionStart&&this.props.onCompositionStart())},this.handleCompositionEnd=()=>{const{device:e}=this.environment;e.isAndroid||(this.ownNodeIsComposing=!1,this.handleInput(),this.props.onCompositionEnd&&this.props.onCompositionEnd())},this.handleBeforeInput=e=>{const{suppressNewlineEvents:t}=this.props;if(!d.kA(e))throw new Error("Invalid event");var n;if(t&&("insertLineBreak"!==e.inputType&&"insertParagraph"!==e.inputType||e.preventDefault(),this.environment.device.isAndroid&&"insertCompositionText"===e.inputType&&null!==(n=e.data)&&void 0!==n&&n.endsWith("\n")&&e.target===this.root)){var o;g;const e=()=>{var t;this.delegateMutation({insertedLine:!0,deletedLine:!1,newValue:this.getText(),multiSelection:void 0,isComposing:this.isComposing}),null===(t=this.root)||void 0===t||t.removeEventListener("input",e)};null===(o=this.root)||void 0===o||o.addEventListener("input",e)}},this.handleSelect=e=>{this.delegateSelection("contain")},this.handleClick=e=>{var t,n;3===e.nativeEvent.detail&&(l.TQ(this.environment.device),this.delegateSelection("contain")),null===(t=(n=this.props).onClick)||void 0===t||t.call(n,e)},this.handleInput=this.handleInput.bind(this)}get isComposing(){var e;return Boolean(this.ownNodeIsComposing||(null===(e=this.contentEditableContext)||void 0===e?void 0:e.isComposing()))}get registries(){var e;return[null===(e=this.contentEditableContext)||void 0===e?void 0:e.contentEditableLeafRegistry]}getText(){return l.n$(this.environment,this.root)}delegateSelection(e){var t,n;this.isComposing||(null===(t=(n=this.props).onSelect)||void 0===t||t.call(n,{endpoint:e,component:this}))}delegateMutation(e){this.handleMutation(e)}delegateBeforeInput(e){this.handleBeforeInput(e)}delegateKeyDown(e){var t,n;null===(t=(n=this.props).onKeyDown)||void 0===t||t.call(n,e)}delegateCompositionEnd(e){var t,n;null===(t=(n=this.props).onCompositionEnd)||void 0===t||t.call(n)}getNode(){return this.root}UNSAFE_willMount(){this.environment.device.isMobile&&this.props.disableContentEditableWhenNotEditingTextOnMobile&&(this.shouldDisableContentEditableForMobile=i.Z.withListenerIgnored((()=>!m.default.isEditingStore.state)),m.default.isEditingStore.addListener(this.handleTextSelectionEditingStoreForMobile))}UNSAFE_willMountOrUpdate(e){this.selection=e.getSelection(),this.disabled=e.getDisabled(),this.html=e.getHtml()}didMount(){this.updateContainer(!0),this.root&&d.OW&&this.root.addEventListener("beforeinput",this.handleBeforeInput)}didUpdate(){this.updateContainer(!1)}willUnmount(){this.environment.device.isMobile&&this.props.disableContentEditableWhenNotEditingTextOnMobile&&m.default.isEditingStore.removeListener(this.handleTextSelectionEditingStoreForMobile),this.root&&d.OW&&this.root.removeEventListener("beforeinput",this.handleBeforeInput)}updateContentEditableAttribute(e){const t=e.getAttribute("contenteditable");this.disabled||this.shouldDisableContentEditableForMobile?"false"!==t&&this.mutateDOM((function(){e.contentEditable="false"})):"true"!==t&&this.mutateDOM((function(){e.contentEditable="true"}))}updateContainer(e){var t;const{device:n}=this.environment;if(null===(t=this.contentEditableContext)||void 0===t||t.contentEditableLeafRegistry.register(this),this.root&&(this.updateContentEditableAttribute(this.root),!this.isComposing)){if(e)this.root.innerHTML=this.html;else{this.previousHtml!==this.html&&(this.previousHtml=this.html,this.testDiv.innerHTML=this.html);const e=this.root.innerHTML,t=this.testDiv.innerHTML;e!==t&&(this.root.innerHTML=this.html)}if(this.disabled)return;if(p.isMouseSelecting())return;if(p.isMouseRightClicking())return void p.resetMouseRightClicking();if(this.selection)switch(this.selection.type){case"start":case"end":{var o;null===(o=this.contentEditableContext)||void 0===o||o.tryEnableMultiSelection();const e=l.bD(this.root,this.selection.index),t={endpoint:this.selection.type,onlyIfEqual:this.contentEditableContext,position:e};p.setDOMEndpoint(t,this.environment.device),this.updateSelectionEndpoint(t);break}case"contain":{const e=l.lw(this.root,this.selection.selection.startIndex,this.selection.selection.endIndex),t=p.get();l.Dn(t,e)||(n.isAndroid&&document.activeElement!==this.root&&this.root.focus(),p.set(e,n));break}default:(0,s.t1)(this.selection)}else if(!e){const e=p.get(),t=!n.isAndroid||i.Z.withListenerIgnored((()=>"empty"===m.default.state.mode));e&&e.commonAncestorContainer&&d.UG(e.commonAncestorContainer)&&this.root.contains(e.commonAncestorContainer)&&t&&p.clear(this.environment)}}}updateSelectionEndpoint(e){const t=p.get(),n=p.getIncompleteDOMEndpoint();if(t&&n===e)switch(e.endpoint){case"start":return void p.setDOMEndpoint({endpoint:"end",onlyIfEqual:this.contentEditableContext,position:{container:t.endContainer,offset:t.endOffset}},this.environment.device);case"end":return void p.setDOMEndpoint({endpoint:"start",onlyIfEqual:this.contentEditableContext,position:{container:t.startContainer,offset:t.startOffset}},this.environment.device);default:(0,s.t1)(e.endpoint)}}renderComponent(){const{onContextMenu:e,onKeyDown:t,onDoubleClick:n,onMouseDown:o,onTouchStart:i,placeholder:r,onBlur:s,onFocus:l,onMouseOver:d,onMouseOut:p}=this.props,m=Boolean(!this.html),g=(!(0,u.ri)(this.environment.device)||!(0,u.Aw)(this.environment))&&this.props.spellCheck,h=this.props.tagName??"div";return(0,f.jsx)(h,{id:this.props.id,ref:this.handleRootMount,...(0,a.iv)(this.props.className,m&&this.props.placeholderStyle?this.props.placeholderStyle:this.props.style,!this.disabled&&"notranslate"),onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd,onInput:this.handleInput,spellCheck:g,autoCorrect:this.props.autoCorrect,autoCapitalize:this.props.autoCapitalize,onSelect:this.handleSelect,onClick:this.handleClick,onBlur:s,onFocus:l,onContextMenu:e,onKeyDown:t,onDoubleClick:n,onMouseDown:o,onTouchStart:i,onMouseOver:d,onMouseOut:p,placeholder:r,...c.GF})}handleMutation(e){this.props.onMutation&&this.props.onMutation(e),r.default.flush()}handleInput(){this.handleMutation({newValue:this.getText(),insertedLine:!1,isComposing:this.isComposing})}}h.displayName="ContentEditableLeaf";const v=h},15201:(e,t,n)=>{n.d(t,{O:()=>z});n(57658),n(21703);var o=n(27537),i=n.n(o),r=n(67294),a=n(60177),s=n(64338),l=n(480),c=n(86628),d=n(24405),u=n(41432),p=n(22491),m=n(38585),f=n(53965),g=n(1898),h=n(62134),v=n(98104),b=n(95477),y=n(14976),_=n(46150),S=n(62619),w=n(89224);const k=["initial","keyDown","compositionStart","beforeInput","compositionUpdate","domMutations","input","compositionEnd","keyUp"],I={keyDown:"keyUp",beforeInput:"input",input:"domMutations",domMutations:"input",compositionStart:"compositionEnd"},C={compositionUpdate:"beforeInput"};class x{constructor(){this.flowData=new Map,this.nextFlow=new T,this.currentFlow=void 0,this.previousFlow=void 0,this.listeners=new Set,this.handleSelectionChange=()=>{this.nextFlow.beforeRange=w.toStaticRange(w.get())},this.handleKeyDown=e=>{this.advanceToPhase("keyDown").keyDown=e,this.emitUpdate(),this.endIfComplete()},this.handleCompositionStart=e=>{this.advanceToPhase("compositionStart").compositionStart=e,this.emitUpdate(),this.endIfComplete()},this.handleBeforeInput=e=>{var t;if(!(0,S.kA)(e))return;const n=(null===(t=e.getTargetRanges)||void 0===t?void 0:t.call(e))||[];this.advanceToPhase("beforeInput").beforeInput={event:e,targetRanges:n},this.emitUpdate(),this.endIfComplete()},this.handleCompositionUpdate=e=>{this.advanceToPhase("compositionUpdate").compositionUpdate=e,this.emitUpdate()},this.handleInput=e=>{this.advanceToPhase("input").input=e,this.emitUpdate(),this.endIfComplete()},this.handleCompositionEnd=e=>{this.advanceToPhase("compositionEnd").compositionEnd=e,this.emitUpdate(),this.endIfComplete()},this.handleKeyUp=e=>{this.advanceToPhase("keyUp").keyUp=e,this.emitUpdate(),this.endFlow()},this.handleMutations=e=>{let{currentFlow:t}=this;t&&!t.domMutations||(t=this.advanceToPhase("initial")),t.domMutations={afterPhase:t.phase,mutations:e},this.emitUpdate(),this.endIfComplete()}}attachEventListeners(e){const{div:t,document:n}=e;return n.addEventListener("selectionchange",this.handleSelectionChange),t.addEventListener("input",this.handleInput),t.addEventListener("keydown",this.handleKeyDown),t.addEventListener("keyup",this.handleKeyUp),t.addEventListener("beforeinput",this.handleBeforeInput),t.addEventListener("compositionstart",this.handleCompositionStart),t.addEventListener("compositionupdate",this.handleCompositionUpdate),t.addEventListener("compositionend",this.handleCompositionEnd),()=>{n.removeEventListener("selectionchange",this.handleSelectionChange),t.removeEventListener("input",this.handleInput),t.removeEventListener("keydown",this.handleKeyDown),t.removeEventListener("keyup",this.handleKeyUp),t.removeEventListener("beforeinput",this.handleBeforeInput),t.removeEventListener("compositionstart",this.handleCompositionStart),t.removeEventListener("compositionupdate",this.handleCompositionUpdate),t.removeEventListener("compositionend",this.handleCompositionEnd)}}onInputFlowChange(e){return this.listeners.add(e),()=>this.listeners.delete(e)}isComposing(){var e;return this.currentFlow&&!this.currentFlow.isPhase("initial")?this.currentFlow.isComposing():(null===(e=this.previousFlow)||void 0===e?void 0:e.isComposing())||!1}reset(){this.nextFlow=new T,this.currentFlow=void 0,this.previousFlow=void 0,this.flowData=new Map}getCurrentFlow(){const e=this.currentFlow;if(!e)return;return{flow:e,data:this.getData(e)}}getData(e){const t=this.flowData.get(e);if(t)return t;const n={};return this.flowData.set(e,n),n}endIfComplete(){const{currentFlow:e}=this;e&&e.isComplete()&&this.endFlow()}emitUpdate(){const{currentFlow:e}=this;if(e){const t={type:"update",flow:e,data:this.getData(e)};this.listeners.forEach((e=>e(t)))}}endFlow(){const{currentFlow:e}=this;if(e){const t=this.previousFlow;this.previousFlow=e,this.currentFlow=void 0;const n={type:"end",flow:e,data:this.getData(e)};this.listeners.forEach((e=>e(n))),t&&this.flowData.delete(t)}}advanceToPhase(e){return this.currentFlow&&this.currentFlow.canTransitionToPhase(e)||(this.endFlow(),this.currentFlow=this.nextFlow,this.nextFlow=new T),this.currentFlow.phase=e,this.currentFlow}}class T{constructor(){this.phase="initial",this.beforeRange=w.toStaticRange(w.get()),this.initial=void 0,this.keyDown=void 0,this.compositionStart=void 0,this.beforeInput=void 0,this.compositionUpdate=void 0,this.input=void 0,this.compositionEnd=void 0,this.domMutations=void 0,this.keyUp=void 0}isPhase(e){return this.phase===e}hasEvents(){return Boolean(this.compositionStart||this.compositionEnd||this.compositionUpdate||this.keyDown||this.keyUp||this.beforeInput||this.input)}isComposing(){var e,t;switch(this.phase){case"compositionStart":case"compositionUpdate":return!0;case"compositionEnd":case"initial":return!1;case"beforeInput":return Boolean(null===(e=this.beforeInput)||void 0===e?void 0:e.event.isComposing);case"input":case"keyDown":case"keyUp":return Boolean(null===(t=this[this.phase])||void 0===t?void 0:t.isComposing);default:(0,g.t1)(this.phase)}}transitionToPhase(e,t){return!!this.canTransitionToPhase(e)&&(this.phase=e,this[e]=t,!0)}canTransitionToPhase(e){return!this[e]&&(C[this.phase]===e||1===function(e,t){const n=k.indexOf(e),o=k.indexOf(t),i=n-o;if(i<0)return-1;if(i>0)return 1;return 0}(e,this.phase))}isComplete(){for(const[e,t]of(0,g.qP)(I))if(this[e]&&!this[t])return!1;return!0}getTargetRanges(){var e;const t=null===(e=this.beforeInput)||void 0===e?void 0:e.targetRanges;return null!=t&&t.length?t:this.beforeRange?[this.beforeRange]:[]}}var M=n(68056),P=n(45162),A=n(55010),R=n(35431),D=n(59730);let E,B;E=Symbol.iterator;class F{constructor(e){if(this.leftToRight=new Map,this.rightToLeft=new Map,e)for(const[t,n]of e)this.assoc(t,n)}assoc(e,t){const n=[];if(this.leftToRight.has(e)){const t=this.leftToRight.get(e);n.push((()=>this.rightToLeft.delete(t)))}if(this.rightToLeft.has(t)){const e=this.rightToLeft.get(t);n.push((()=>this.leftToRight.delete(e)))}for(const o of n)o();return this.leftToRight.set(e,t),this.rightToLeft.set(t,e),this}getLeft(e){return this.leftToRight.get(e)}getRight(e){return this.rightToLeft.get(e)}hasLeft(e){return this.leftToRight.has(e)}hasRight(e){return this.rightToLeft.has(e)}deleteLeft(e){if(this.leftToRight.has(e)){const t=this.leftToRight.get(e);return this.leftToRight.delete(e),this.rightToLeft.delete(t),!0}return!1}deleteRight(e){if(this.rightToLeft.has(e)){const t=this.rightToLeft.get(e);return this.leftToRight.delete(t),this.rightToLeft.delete(e),!0}return!1}*[E](){for(const[e,t]of this.leftToRight)yield[e,t]}}B=Symbol.iterator;class O{constructor(e,t,n){if(this.leftName=void 0,this.rightName=void 0,this.biMap=void 0,e===t)throw new D.D3("NamedBiMap left and right names are equal",{data:{name:e}});if(this.leftName=e,this.rightName=t,this.biMap=new F,n)for(const[o,i]of n)this.biMap.assoc(o,i)}assoc(e){const t=e[this.leftName],n=e[this.rightName];return this.biMap.assoc(t,n),this}get(e){if(this.leftName in e){const t=e[this.leftName];return this.biMap.getLeft(t)}if(this.rightName in e){const t=e[this.rightName];return this.biMap.getRight(t)}throw new D.D3("NamedBiMap.get fallthrough should never occur",{data:e})}delete(e){if(this.leftName in e){const t=e[this.leftName];return this.biMap.deleteLeft(t)}if(this.rightName in e){const t=e[this.rightName];return this.biMap.deleteRight(t)}throw new D.D3("NamedBiMap.delete fallthrough should never occur",{data:e})}has(e){if(this.leftName in e){const t=e[this.leftName];return this.biMap.hasLeft(t)}if(this.rightName in e){const t=e[this.rightName];return this.biMap.hasRight(t)}throw new D.D3("NamedBiMap.has fallthrough should never occur",{data:e})}[B](){return this.biMap[Symbol.iterator]()}}class Z extends R.Z{constructor(){super(...arguments),this.nodeMap=new O("node","component",new F)}register(e){const t=super.register(e),n=e.getNode();return n?this.nodeMap.assoc({node:n,component:e}):this.nodeMap.delete({component:e}),t}unregister(e){super.unregister(e),this.nodeMap.delete({component:e})}getByDOMOrder(){const e=Array.from(this.nodeMap.biMap.rightToLeft.entries());return e.sort(((e,t)=>{const n=e[1],o=t[1];return(0,A.Z)(n,o)})),e.map((e=>{let[t,n]=e;return{node:n,leaf:t}}))}getParentContentEditableLeaf(e){const t=(0,_.X1)(e),n=t&&this.nodeMap.get({node:t});if(t&&n)return{node:t,leaf:n}}}var V=n(6258),U=n(24666),L=n(85893);const j=!1,N=500;function z(e){const{children:t,style:n,displayName:o,shouldSelectOnEnter:S}=e,k=!e.disabled,I=(0,r.useRef)(null),C=(0,r.useRef)(0),[T,A]=(0,r.useState)(null),R=(0,r.useRef)(!1),D=(0,r.useRef)(!1),[E]=(0,r.useState)((()=>function(e){return`${e}-${K++}`}(o))),B=(0,r.useRef)(void 0),F=(0,r.useRef)({displayName:E}),[O]=(0,r.useState)((()=>new x)),[z]=(0,r.useState)((()=>new Z)),[G]=(0,r.useState)((()=>new s.T7({onMutations(e){O.handleMutations(e)},enableLogging:!1}))),$=(0,r.useRef)(!1),Q=(0,r.useCallback)((e=>{$.current!==e&&($.current=e,G.mutate((()=>{var t,n;e?null===(t=I.current)||void 0===t||t.setAttribute(_.HM,"true"):null===(n=I.current)||void 0===n||n.removeAttribute(_.HM)})))}),[G]),Y=(0,r.useRef)(!1),J=(0,r.useCallback)((e=>{Y.current!==e&&(Y.current=e,G.mutate((()=>{var t,n;e?null===(t=I.current)||void 0===t||t.setAttribute(_._F,"true"):null===(n=I.current)||void 0===n||n.removeAttribute(_._F)})))}),[G]),X=(0,r.useCallback)((e=>{I.current=e,G.setNode(e),A(e)}),[G]),ee=(0,l.O7)(),te=(0,c.VK)((()=>(0,P.Aw)(ee)),[ee]);(0,r.useEffect)((()=>{if(T&&te)return O.attachEventListeners({div:T,document:window.document})}),[O,te,T]);const{isFirefox:ne,isAndroid:oe}=ee.device;(0,r.useEffect)((()=>{const e=e=>{var t;const n=w.get(),o=(0,P.Zb)({range:n,contentEditableLeafRegistry:z,allowInvisibleEndSelection:!0,constraintToContentEditableRootNode:I.current||void 0}),i=U.default.state,r="editing"===i.mode?i.multiSelection:void 0;return{leafs:o,multiSelection:oe&&e.isPhase("beforeInput")&&(!r||(0,M.iG)(r))&&w.isExpanded(n)?null===(t=(0,P.fx)({range:n,contentEditableLeafRegistry:z,allowInvisibleEndSelection:!0}))||void 0===t?void 0:t.multiSelection:r,range:w.toStaticRange(n)}};return O.onInputFlowChange((t=>{J(O.isComposing());const{flow:n,type:o,data:r}=t;if("end"!==o){if(j){const t=r.log||=[],o={phase:n.phase,hasMutations:Boolean(n.domMutations),target:e(n),isComposing:n.isComposing()};t.push(o),W("flow updated",n.phase,o)}if("update"!==o||!n.isPhase("beforeInput")&&r.target||(r.target=e(n)),"update"===o&&n.domMutations&&!r.handledMutations){var a,l;r.handledMutations=!0;const t=n.domMutations.mutations,o=r.target||e(n),m=!ne||o.multiSelection&&(0,M.iG)(o.multiSelection)?null===(a=o.leafs)||void 0===a?void 0:a.start:q(z,I.current),f=null===(l=o.leafs)||void 0===l?void 0:l.start,h=null==m?void 0:m.leaf.getText();W("onMutations",r,h,n,m);const v=n.hasEvents(),y=j||b.default.isLocalhost||!v;let S=!1,w=!1,k=!1;for(let e=t.length-1;e>=0;e--){const n=t[e];H(n,m);const o=(0,_.xp)(n.target),i=(0,_.X1)(n.target);if(o===I.current){if((v||"attributes"!==n.type||"style"!==n.attributeName)&&("attributes"!==n.type||"dir"!==n.attributeName))if(m){if("childList"===n.type){const e=Array.from(n.removedNodes);w||=e.some(_.eD)||e.some(_.C7);const t=Array.from(n.addedNodes);k||=t.some(_.eD)}if(i&&i===m.node){switch(n.type){case"attributes":(0,s.AJ)(n,y);continue;case"characterData":case"childList":break;default:(0,g.t1)(n.type)}S=!0}else(0,s.AJ)(n,y)}else(0,s.AJ)(n,y)}else W("allowed mutation on interior region",o,n)}if(f&&(S||w)){var c,d,u,p;if("string"!=typeof h)throw new Error("focusedLeafText must be string");const e=null===(c=n.beforeInput)||void 0===c?void 0:c.event,t=null===(d=n.keyDown)||void 0===d?void 0:d.keyCode,o="enter"!==(void 0!==t&&i()(t))&&("insertLineBreak"===(null==e?void 0:e.inputType)||"insertParagraph"===(null==e?void 0:e.inputType)||"insertCompositionText"===(null==e?void 0:e.inputType)&&(null==e||null===(u=e.data)||void 0===u?void 0:u.endsWith("\n"))||k),a={multiSelection:null===(p=r.target)||void 0===p?void 0:p.multiSelection,newValue:h,deletedLine:w,insertedLine:o,isComposing:O.isComposing()};W("delegateMutation",a),f.leaf.delegateMutation(a)}}}else W("flow ended",r,n)}))}),[z,O,oe,ne,J]),(0,r.useEffect)((()=>{const e=I.current;e&&te&&R.current&&G.mutate((()=>{k?e.contentEditable="true":e.removeAttribute("contentEditable")}))}),[k,te,G]);const ie=(0,r.useCallback)((()=>{const e=I.current;return!(!e||!te)&&(R.current?("always"===te&&Q(!0),!1):(G.mutate((()=>{k?e.contentEditable="true":e.removeAttribute("contentEditable"),(0,P.ri)(ee.device)&&(e.spellcheck=!1)})),G.lock(F.current),R.current=!0,Q("gesture"===te),W("enableMultiSelection"),!0))}),[G,te,Q,ee.device,k]),re=(0,r.useCallback)((()=>{const e=I.current;return!(!R.current||!e)&&("always"===te?(Q(!1),!1):!O.isComposing()&&(G.unlock(F.current),e.removeAttribute("contenteditable"),Q(!1),W("disableMultiSelection"),R.current=!1,!0))}),[G,te,Q,O]);(0,r.useEffect)((()=>{let e=w.get();function t(){var t;const n=null===(t=w.get())||void 0===t?void 0:t.cloneRange(),o=e;e=n;const i=I.current;i&&w.isExpanded(n)&&!w.isExpanded(o)&&(0,_.xp)(n.commonAncestorContainer)===i&&(0,_.X1)(n.commonAncestorContainer)&&ie()&&(i.focus(),w.isExpanded(w.get())||w.set(n,ee.device))}return document.addEventListener("selectionchange",t),()=>document.removeEventListener("selectionchange",t)}),[ie,ee.device]);const ae=(0,r.useCallback)((function(){const e=w.get();if(!w.isExpanded(e)&&re()&&e){const t=q(z,I.current,e);t&&t.node&&t.node instanceof HTMLElement&&t.node.focus(),w.set(e,ee.device)}}),[z,re,ee.device]),se=(0,r.useMemo)((()=>f.Ds(ae,50)),[ae]),{KeyboardShortcutStackStore:le}=ee,ce=(0,r.useRef)(),de=(0,r.useCallback)((function(e){const t=I.current;if(!t)return;if(!R.current)return;if(v.Ch("reactSelectionChange"))return void W("maybeHandleExpectedBrowserSelectionUpdate() returned true");const n=w.get();if(W("onSelect (react selection)",w.toStaticRange(n)),!ce.current&&n&&be.current&&n.commonAncestorContainer===be.current)w.clear(ee);else if(!(ce.current&&n&&w.areRangesEqual(n,ce.current))){if(ce.current=w.toStaticRange(n),n){const o=n.startContainer===t&&0===n.startOffset&&n.endContainer===t&&0===n.endOffset,i=be.current&&n.startContainer===be.current&&_e.current&&n.endContainer===_e.current,r=ee.device.isIOS&&ee.device.isMobileNative&&e.timeStamp-C.current>N&&function(e,t,n){if(!e.collapsed||0!==e.startOffset)return!1;const o=(0,P.Zb)({range:e,contentEditableLeafRegistry:t,allowInvisibleEndSelection:!0,constraintToContentEditableRootNode:n}),i=t.getByDOMOrder()[0];return Boolean(i&&o&&o.start.leaf===i.leaf)}(n,z,t);if(o||i||r)return W("onSelect: propagateShortcut selectAll"),void h.dJ({KeyboardShortcutStackStore:le},new KeyboardEvent("keydown"),"selectAll")}if("contextmenu"!==e.nativeEvent.type){if(n&&(w.isExpanded(n)||"always"===te)&&(0,_.xp)(n.commonAncestorContainer)===t){if(D.current)return void(B.current=e);const t=q(z,I.current,n);t&&(W("onSelect: delegateSelection",t),t.leaf.delegateSelection("start"))}w.isExpanded(n)||se()}}}),[te,z,se,le,ee]);(0,r.useEffect)((()=>{if(te&&!k){function e(){const e=w.get(),t=I.current;if(!t||!e)return;const n=(0,P.fx)({contentEditableLeafRegistry:z,range:e,allowInvisibleEndSelection:!0});n&&(0,_.xp)(e.commonAncestorContainer)===t&&v.bc({...n,environment:ee,focus:"start",readOnly:!0})}return document.addEventListener("selectionchange",e),()=>document.removeEventListener("selectionchange",e)}}),[ee,te,k,z]);const ue=(0,r.useCallback)((()=>{D.current=!0,B.current=void 0}),[]),pe=(0,r.useCallback)((e=>{const t=B.current;if(D.current=!1,B.current=void 0,C.current=e.timeStamp,t){const e=q(z,I.current);W("handleTouchEnd: delegateSelection",e),null==e||e.leaf.delegateSelection("start")}}),[z]),me=(0,r.useCallback)((e=>{if(C.current=e.timeStamp,!R.current)return;e.target!==I.current||"Enter"!==e.key||!1!==e.ctrlKey||!1!==e.metaKey||!1!==e.altKey||!1!==e.shiftKey||S&&!S()||void 0!==w.get()||!be.current||w.setOnNode(be.current,ee.device);const t=q(z,I.current);W("handleKeyDown: delegateKeyDown",t),null==t||t.leaf.delegateKeyDown(e)}),[z,ee.device,S]);(0,r.useEffect)((()=>{const e=I.current;if(e)return e.addEventListener("beforeinput",t),()=>e.removeEventListener("beforeinput",t);function t(e){if(!R.current)return;const t=q(z,I.current);null==t||t.leaf.delegateBeforeInput(e)}}),[z]);const fe=(0,r.useCallback)((()=>{const e=I.current;if(!e)return;const t=function(){document.removeEventListener("selectionchange",t);const n=w.get();if(null!=n&&n.collapsed&&(0,_.xp)(n.commonAncestorContainer)===e){const e=(0,_.X1)(n.commonAncestorContainer),t=n.startContainer,o=n.startOffset;if(e&&t&&(0,y.x9)(e,t,o)){const i=e.getElementsByClassName(m.$A)[0];i&&(W("Move collapsed selection before EOL marker",{parentLeafNode:e,caretContainer:t,caretOffset:o}),n.setStartBefore(i),n.setEndBefore(i),w.set(n,ee.device))}}};document.addEventListener("selectionchange",t)}),[ee.device]);(0,r.useEffect)((()=>{"always"!==te||R.current||ie()}),[ie,te]);const ge=(0,r.useCallback)((()=>{const e=w.get();return!w.isExpanded(e)&&re()}),[re]),he=(0,r.useCallback)((()=>!oe&&Boolean(O.isComposing())),[O,oe]),ve=(0,d.yK)((e=>({div:{caretColor:e.regularTextColor,...n},whenContentEditable:{WebkitUserModify:"read-write-plaintext-only"},selectionTrap:{height:"1px",width:"1px",caretColor:"transparent"}})),[n]),be=(0,r.useRef)(null),ye=(0,L.jsx)("span",{style:ve.selectionTrap,ref:be,..._.d_}),_e=(0,r.useRef)(null),Se=(0,L.jsx)("span",{style:ve.selectionTrap,ref:_e,..._.d_}),we=(0,r.useCallback)((()=>{if(!w.get()&&"editing"===U.default.state.mode){const e=U.default.state.multiSelection.start.store;if(e instanceof V.G){const t=e.getType();if(t===u.Ti.linkToPage||t===u.Ti.linkToCollection)return}v.ZH(ee)}}),[ee]),ke=(0,r.useCallback)((()=>{!I.current||w.get()&&"empty"!==U.default.state.mode||I.current.blur()}),[]);return(0,L.jsx)("div",{onBlur:ee.device.isIOS?we:void 0,onFocus:ee.device.isIOS?ke:void 0,onTouchStart:te?ue:void 0,onTouchEnd:te?pe:void 0,onTouchCancel:te?pe:void 0,onKeyDown:te?me:void 0,onCompositionEnd:te?function(e){if(!R.current)return;const t=q(z,I.current);null==t||t.leaf.delegateCompositionEnd(e)}:void 0,ref:X,...(0,p.iv)(ve.div,{whenContentEditable:ve.whenContentEditable}),onMouseDown:fe,onSelect:de,..._.GZ,children:(0,L.jsxs)(a.c1,{id:E,tryEnableMultiSelection:ie,tryDisableMultiSelection:ge,isComposing:he,domLock:G,contentEditableLeafRegistry:z,children:[ye,t,Se]})})}function q(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w.get();const o=(0,P.Zb)({range:n,contentEditableLeafRegistry:e,allowInvisibleEndSelection:!0,constraintToContentEditableRootNode:t||void 0});if(o)return o.start}function W(){if(j){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.warn("ContentEditableRoot:",...t)}}function H(e){const t={};if(t.type=e.type,t.target=e.target,t.targetIsText=e.target.nodeType===Node.TEXT_NODE,t.targetIsLeaf=(0,_.eD)(e.target),e.addedNodes.length){const n=Array.from(e.addedNodes);t.added=n,t.addedALeaf=n.some(_.eD),t.addedAText=n.some((e=>e.nodeType===Node.TEXT_NODE))}if(e.removedNodes.length){const n=Array.from(e.removedNodes);t.removed=n,t.removedALeaf=n.some(_.eD),t.removedAText=n.some((e=>e.nodeType===Node.TEXT_NODE))}"characterData"===e.type&&(t.newChars=e.target.textContent,t.oldChars=e.oldValue),t.mutation=e;for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];W("mutation: ",t,...o)}let K=0},68709:(e,t,n)=>{n.d(t,{p:()=>c});var o=n(67294),i=n(60177),r=n(22491),a=n(46150),s=n(85893);const l={WebkitUserSelect:"none",userSelect:"none",pseudoSelection:{background:"transparent"}},c=o.forwardRef(((e,t)=>{const{allowSelectionWithin:n,style:o,className:c,...d}=e,u=(0,i.Dl)(),p=(0,s.jsx)("div",{ref:t,contentEditable:!1,...(0,r.iv)(c,!n&&l,o),...a.G0,...d});return u?(0,s.jsx)(i.c1,{void:!0,children:p}):p}));c.displayName="ContentEditableVoid"},10182:(e,t,n)=>{n.d(t,{Z:()=>x});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(86658),l=n(53028),c=n(9291),d=n(50950),u=n(43250),p=n(60709),m=n(61893),f=n(31194),g=n(52275),h=n(31945),v=n(78140),b=n(32163),y=n(89728),_=n(72495),S=n(24006),w=n(64369),k=n(85893);function I(e){let{hasDismissButton:t,onDismiss:n}=e;const r=(0,i.O7)(),f=(0,a.Fg)(),g=(0,c.useIntl)(),[h,S]=(0,o.useState)(!1);(0,o.useEffect)((()=>()=>{t||h&&d.qo()}),[g,h,t]);const I=[{key:"trackingTypes",render:e=>(0,k.jsx)(_.Z,{...e,topBorder:0!==e.index}),items:l.m4.map((e=>({key:e,render:t=>(0,k.jsx)(C,{menuListItemProps:t,trackingType:e,setShowReloadOnMenuClose:S,isNativeiOSApp:r.device.isMobileNative&&r.device.isIOS}),action:()=>d.Nh(r,e)})))}];return(0,k.jsxs)(v.Z,{className:u.N7t,menuType:p.og.Popup,width:260,children:[(0,k.jsx)("div",{style:{display:"flex",alignItems:"center",paddingTop:t?4:0},children:t&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(w.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%",paddingLeft:14},children:(0,k.jsx)("b",{children:(0,k.jsx)(c.FormattedMessage,{...s.ze.customizeCookiesHeader})})}),(0,k.jsx)(y.Z,{style:{float:"right",marginLeft:-8,paddingLeft:8,paddingRight:8,color:f.blueColor},onClick:()=>{d.OM(r,m.Z.getPermission()),n&&n()},children:(0,k.jsx)(c.FormattedMessage,{...s.ze.cookieDismissButtonLabel})})]})}),(0,k.jsx)(b.Z,{type:b.i.Vertical,initialFocus:void 0,sections:I})]})}function C(e){const{menuListItemProps:t,trackingType:n,setShowReloadOnMenuClose:o,isNativeiOSApp:l}=e,{title:u,caption:p,subtitle:f}=(0,s.G_)(n,l),[{permission:h}]=(0,r.AF)(m.Z),v=(0,a.Fg)(),b=(0,i.O7)();return(0,k.jsx)(g.Z,{...t,title:(0,k.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,k.jsx)("div",{style:{marginRight:0},children:(0,k.jsx)(c.FormattedMessage,{...u})})}),caption:(0,k.jsxs)("div",{children:[f&&(0,k.jsx)("div",{children:(0,k.jsx)("span",{style:{color:v.errorText},children:(0,k.jsx)(c.FormattedMessage,{...f})})}),(0,k.jsx)("div",{children:(0,k.jsx)("span",{style:{color:v.mediumTextColor},children:(0,k.jsx)(c.FormattedMessage,{...p})})})]}),shouldWrapCaption:!0,right:(0,k.jsx)("div",{style:{display:"flex",width:"100%",alignItems:"center",cursor:"pointer"},children:(0,k.jsx)(S.Z,{on:h[n],disabled:"necessary"===n,onClick:()=>{o(!0),d.Nh(b,n)}})})})}const x=function(e){let{renderOrigin:t,hasDismissButton:n,onDismiss:o}=e;return(0,k.jsx)(h.ZP,{popupType:h.Z4.Popup,placementToOrigin:f.Iw.Bottom,alignmentToOrigin:f.lU.Start,renderOrigin:t,render:()=>(0,k.jsx)(I,{hasDismissButton:n,onDismiss:o})})}},93262:(e,t,n)=>{n.d(t,{Z:()=>U});var o=n(67294),i=n(83355),r=n(1302),a=n(70203),s=n(53965),l=n(1898),c=n(42239),d=n(87420),u=n(52989),p=n(52423),m=n(24677),f=n(98104),g=n(84064),h=n(14976),v=n(12534),b=n(28314),y=n(98742),_=n(39500),S=n(45162),w=n(73959),k=n(89224),I=n(89086),C=n(28685),x=n(95802),T=n(15723),M=n(55367),P=n(807),A=n(22294),R=n(88923),D=n(69784),E=n(27724),B=n(24666),F=n(6685),O=n(3386),Z=n(85893);class V extends i.Z{constructor(){super(...arguments),this.isSelected=!1,this.shouldEditOnClick=!0,this.shouldDisableMultiSelectionOnDragEnd=!1,this.contentEditableLeafRef=o.createRef(),this.wrapperRef=o.createRef(),this.handleDragStart=e=>{const t=this.getContextClosestSelectableStore();e.shiftKey&&!this.isEditing.state&&t?(e.preventDefault(),m.Ys({environment:this.environment,store:t,toggle:m.ji(this.environment),selectBetween:m.OS()}),this.shouldEditOnClick=!1):this.shouldEditOnClick=!0},this.handleDragMove=e=>{if(M.ZP.state.isDragging)c.td(this.environment,{currentX:e.currentX,currentY:e.currentY});else if(e.shiftKey)_.X9()&&c.f$(this.environment,{startX:e.startX,startY:e.startY,stores:E.default.state.stores,isNativeDrag:!1,getGhostElement:void 0});else if(!D.default.state.isActive){if(!this.props.canSelectionDrag)return;const n=this.getNode();if(!n)return;const o=T.jn(n.getBoundingClientRect(),20);if(T.uh(o,e.currentX,e.currentY))return;var t;if((0,S.Aw)(this.environment))return void("mouse"===e.device&&null!==(t=this.contentEditableContext)&&void 0!==t&&t.tryEnableMultiSelection()&&(this.shouldDisableMultiSelectionOnDragEnd=!0));this.shouldEditOnClick=!1,u.AI({environment:this.environment,target:e.target,startX:e.startX,startY:e.startY,showSelectionRect:!1,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!1})}},this.handleDragEnd=e=>{var t;this.shouldDisableMultiSelectionOnDragEnd&&(null===(t=this.contentEditableContext)||void 0===t||t.tryDisableMultiSelection(),this.shouldDisableMultiSelectionOnDragEnd=!1);M.ZP.state.isDragging?c.fX({environment:this.environment,shiftKey:e.shiftKey,optionKey:e.optionKey,commandKey:e.commandKey,analyticsFrom:"page_content"}):f.aJ()},this.handleClick=e=>{const{device:t}=this.environment;(0,v.ZP)({event:e,context:v.Af.EditorClick,callback:()=>{if(this.props.onClick&&this.props.onClick(e),e.defaultPrevented)return;const n=E.default.getDefaultContainerFromTarget(e.target);if(!R.default.isSidePeekOpen()||null!=n&&n.isPeekRenderer()||d.E5(this.environment),this.shouldEditOnClick){const n=this.getContextClosestSelectableStore();if(n?m.eP({environment:this.environment,store:n}):(m.Af({stores:[]}),m.$Y({environment:this.environment,phase:E.SelectionPhase.Selected,preventClearEditingText:!0})),t.isMobile&&!this.isEditing.state&&!this.isPartOfSelection.state){const t=this.getNode();if(t){let n;if(this.mutateDOM((()=>{t.classList.add("editor-force-select"),n=k.rangeFromPoint(e.clientX,e.clientY),t.classList.remove("editor-force-select")})),n){const e=L(n,this.environment);e&&(f.Z5({store:this.props.store,selection:e.selection}),e.forceEmitSelectionStore&&B.default.emit())}}}this.saveSerializedTextSelectionAfterFlush()}else this.shouldEditOnClick=!0}})},this.handleContextMenu=e=>{this.props.onContextMenu&&(0,v.ZP)({event:e,context:v.Af.EditorContextMenu,callback:()=>{var t,n;if(null===(t=(n=this.props).onContextMenu)||void 0===t||t.call(n,e),!e.defaultPrevented)return"unhandled"}}),this.isEditing.state&&(0,v.ZP)({event:e,context:v.Af.EditorContextMenu,callback:()=>{this.saveSerializedTextSelectionAfterFlush()}})},this.handleSelect=e=>{const{device:t}=this.environment;t.isMobile?this.handleMobileSelect(e):this.handleDesktopSelect(e)},this.handleMobileSelect=e=>{if(!this.props.disabled){if(!k.get())return;const t=this.getContextClosestSelectableStore();this.isEditing.state||m.eP({environment:this.environment,store:t}),this.saveSerializedTextSelection(e),r.default.flush()}},this.handleDesktopSelect=e=>{this.props.disabled||!this.isEditing.state&&"contain"===e.endpoint||this.saveSerializedTextSelection(e)},this.defaultShortcutHandlers={onEsc:e=>{if(this.props.disabled)return;if(e.preventDefault(),(0,S.Aw)(this.environment)){const e="empty"!==B.default.state.mode&&B.default.state.multiSelection,t=e&&(0,S.tp)({multiSelection:e,filterCommonAncestors:!0,focus:void 0});if(t)return void m.Z5({environment:this.environment,...t})}const t=this.getContextClosestSelectableStore();if(t){const e=x.C.findSelectableFromStore(t);e&&e.props.canSelect&&m.Z5({environment:this.environment,stores:[t]})}},onUp:e=>{var t;this.props.disabled||((0,S.Aw)(this.environment)?f.N3({environment:this.environment,topBottomPadding:this.props.topBottomPadding,event:e,contentEditableLeafRegistry:null===(t=this.contentEditableContext)||void 0===t?void 0:t.contentEditableLeafRegistry}):f.zJ({environment:this.environment,store:this.props.store,topBottomPadding:this.props.topBottomPadding,event:e}))},onDown:e=>{var t;this.props.disabled||((0,S.Aw)(this.environment)?f.FG({environment:this.environment,topBottomPadding:this.props.topBottomPadding,event:e,contentEditableLeafRegistry:null===(t=this.contentEditableContext)||void 0===t?void 0:t.contentEditableLeafRegistry}):f.DI({environment:this.environment,store:this.props.store,topBottomPadding:this.props.topBottomPadding,event:e}))},onLeft:e=>{if(!this.props.disabled){var t;if((0,S.Aw)(this.environment))return f.AL({environment:this.environment,event:e,contentEditableLeafRegistry:null===(t=this.contentEditableContext)||void 0===t?void 0:t.contentEditableLeafRegistry});f.e2({environment:this.environment,store:this.props.store,event:e})}},onRight:e=>{if(!this.props.disabled){var t;if((0,S.Aw)(this.environment))return f.D1({environment:this.environment,event:e,contentEditableLeafRegistry:null===(t=this.contentEditableContext)||void 0===t?void 0:t.contentEditableLeafRegistry,editorMode:this.getEditorMode()});f.FC({environment:this.environment,store:this.props.store,event:e})}},onSelectAll:e=>{if(!this.props.disabled){var t;if(e.preventDefault(),(0,S.Aw)(this.environment))return f.UV({environment:this.environment,store:this.props.store,canSelectAllBlocks:this.props.canSelectAllBlocks,contentEditableContextId:null===(t=this.contentEditableContext)||void 0===t?void 0:t.id});f.mT({environment:this.environment,store:this.props.store,canSelectAllBlocks:this.props.canSelectAllBlocks})}},onUndo:e=>{e.preventDefault(),p.Yw(this.environment)},onRedo:e=>{e.preventDefault(),p.KX(this.environment)},onGoToBeginningOfLine:e=>{j("start",e.shiftKey)},onGoToEndOfLine:e=>{j("end",e.shiftKey)}},this.saveSerializedTextSelectionAfterFlush=()=>{r.default.afterNextFlush((()=>{this.saveSerializedTextSelection()}))},this.isPartOfSelection=this.createComputedStore((()=>(0,I.ZZ)(this.props.store)),!1,"isPartOfSelection"),this.isEditing=this.createComputedStore((()=>(0,I.J5)(this.props.store)),!1,"isEditing")}get registries(){return[C.E]}getContentEditableLeaf(){return this.contentEditableLeafRef.current||void 0}getNode(){return this.wrapperRef.current?this.wrapperRef.current:this.contentEditableLeafRef.current?this.contentEditableLeafRef.current.getNode():super.getNode()}didMountOrUpdate(){this.isEditing.state?this.isSelected||(this.isSelected=!0,this.props.onSelected&&this.props.onSelected()):this.isSelected&&(this.isSelected=!1,function(e){e()}(this.props.clearBrowserSelection),this.props.onDeselected&&this.props.onDeselected())}willUnmount(){if(this.isSelected){this.isSelected=!1,this.props.onDeselected&&this.props.onDeselected();const e=this.isEditing.state;r.default.afterNextFlush((()=>{const t=C.E.findEditableWithStore(this.props.store),n=this.isEditing.state;e&&n&&!this.componentIsMounted&&!t&&f.ZH(this.environment)}))}}shouldComponentUpdate(e){return!0}getContextClosestSelectable(){var e;return null===(e=this.context.selectable)||void 0===e?void 0:e.closestSelectable}getContextClosestSelectableStore(){var e;return null===(e=this.context.selectable)||void 0===e||null===(e=e.closestSelectable)||void 0===e||null===(e=e.props)||void 0===e?void 0:e.store}getEditorMode(){if(this.props.isDiscussionInput)return"default";const e=(0,w.sQ)(this.props.store);return e?P.Z.getMode(e):"default"}renderComponent(){const{disabled:e,disableUpDownArrows:t,disableEnter:n}=this.props,o=this.isEditing.state;return(0,Z.jsx)(O.Z,{debugName:"Editable",capture:o&&!e,onDelete:this.getShortcutHandler("onDelete"),onDeleteToEndOfLine:this.getShortcutHandler("onDeleteToEndOfLine"),onDeleteNextWord:this.getShortcutHandler("onDeleteNextWord"),onBackspace:this.getShortcutHandler("onBackspace"),onEnter:n?void 0:this.getShortcutHandler("onEnter"),onShiftEnter:this.getShortcutHandler("onShiftEnter"),onCommandEnter:this.getShortcutHandler("onCommandEnter"),onCommandShiftEnter:this.getShortcutHandler("onCommandShiftEnter"),onUp:t?void 0:this.getShortcutHandler("onUp"),onDown:t?void 0:this.getShortcutHandler("onDown"),onLeft:this.getShortcutHandler("onLeft"),onRight:this.getShortcutHandler("onRight"),onCommandLeft:this.getShortcutHandler("onCommandLeft"),onCommandRight:this.getShortcutHandler("onCommandRight"),onTab:this.getShortcutHandler("onTab"),onUntab:this.getShortcutHandler("onUntab"),onSelectAll:this.getShortcutHandler("onSelectAll"),onToggleUnderline:this.getShortcutHandler("onToggleUnderline"),onToggleHighlight:this.getShortcutHandler("onToggleHighlight"),onToggleBold:this.getShortcutHandler("onToggleBold"),onToggleItalics:this.getShortcutHandler("onToggleItalics"),onToggleStrike:this.getShortcutHandler("onToggleStrike"),onToggleCode:this.getShortcutHandler("onToggleCode"),onUndo:this.getShortcutHandler("onUndo"),onRedo:this.getShortcutHandler("onRedo"),onEsc:this.getShortcutHandler("onEsc"),onCut:this.getShortcutHandler("onCut"),onCopy:this.getShortcutHandler("onCopy"),onPaste:this.getShortcutHandler("onPaste"),onKeypress:this.getShortcutHandler("onKeyPress"),onMoveUp:this.getShortcutHandler("onMoveUp"),onMoveDown:this.getShortcutHandler("onMoveDown"),onHome:this.saveSerializedTextSelectionAfterFlush,onEnd:this.saveSerializedTextSelectionAfterFlush,onGoToBeginningOfLine:this.getShortcutHandler("onGoToBeginningOfLine"),onGoToEndOfLine:this.getShortcutHandler("onGoToEndOfLine"),onGoForwardOneChar:this.saveSerializedTextSelectionAfterFlush,onGoBackwardOneChar:this.saveSerializedTextSelectionAfterFlush,children:this.renderDraggable()})}renderDraggable(){const e=this.isEditing.state;return(0,Z.jsx)(F.Z,{disabled:this.props.disableDrag,onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:e=>{return t=this.environment,void(M.ZP.state.isDragging&&(c.cQ(t),m.ZH(t)));var t},cursor:"text",render:t=>this.props.render((0,y.Z)(t,{leafRef:this.contentEditableLeafRef,wrapperRef:this.wrapperRef,onClick:this.handleClick,onContextMenu:this.handleContextMenu,onKeyDown:N,onDoubleClick:z}),this.handleSelect,Boolean(e)),enableAndroidContextMenu:this.props.disabled,disableHorizontalEdgeScroll:this.props.disableHorizontalEdgeScroll})}getShortcutHandler(e){const t=this.props[e],n=this.defaultShortcutHandlers[e];return t??n}saveSerializedTextSelection(e){const t=k.get();if((0,S.Aw)(this.environment)){var n;const e=(0,S.fx)({contentEditableLeafRegistry:null===(n=this.contentEditableContext)||void 0===n?void 0:n.contentEditableLeafRegistry,range:t,allowInvisibleEndSelection:(0,b.yA)().shift});return e?void f.bc({environment:this.environment,...e,readOnly:"infer",focus:void 0}):void 0}const o=L(t,this.environment);if(o){const e="empty"!==B.default.state.mode&&(0,S.xI)("Editable",B.default.state.multiSelection);if(e&&e.store===this.props.store&&s.Xy(e.selection,o.selection)&&!o.forceEmitSelectionStore)return;f.Z5({store:this.props.store,selection:o.selection,readOnly:this.props.disabled}),o.forceEmitSelectionStore&&B.default.emit()}}}V.displayName="Editable",V.contextTypes={...g.Tf,...i.w};const U=V;function L(e,t){return(0,h.Ut)(t,e)}function j(e,t){const n=B.default.state;"empty"!==n.mode&&r.default.afterNextFlush((()=>{const{start:o,end:i}=n.multiSelection;switch(e){case"start":{const e=o.store.getValue();if(!e)return;const n=a.Oqk({textValue:e,substring:"\n",ignoreCase:!1}).reverse().find((e=>{let{endIndex:t}=e;return t<=o.index})),r=(null==n?void 0:n.endIndex)??0,s={store:o.store,index:r};f.NA({multiSelection:{start:s,end:t?i:s}});break}case"end":{const e=(0,I.x0)(i.store);if(!e)return;const n=o.store.getValue();if(!n)return;const r=a.Oqk({textValue:n,substring:"\n",ignoreCase:!1}).find((e=>{let{startIndex:t}=e;return t>=i.index})),s=(null==r?void 0:r.startIndex)??e.endIndex,l={store:i.store,index:s};f.NA({multiSelection:{start:t?o:l,end:l}});break}default:(0,l.t1)(e)}}))}function N(e){e.metaKey||e.ctrlKey||e.altKey||A.Z.setKeyboardMode(!0)}function z(e){(0,v.ZP)({event:e,context:v.Af.EditorDoubleClick,callback:()=>{}})}},27016:(e,t,n)=>{n.d(t,{P9:()=>vn,M1:()=>kn,ZP:()=>wn,ar:()=>hn});var o=n(67294),i=n(73935),r=n(18466),a=n(13991),s=n(480),l=n(53150),c=n(6740),d=n(86628),u=n(24405),p=n(49085),m=n(41432),f=n(95538),g=n(9999),h=n(82477),v=n(70622),b=n(53376),y=n(49089),_=n(42853),S=n(45238),w=n(85893);const k=(0,S.IU)("compass",{viewBox:"0 0 30 30",svg:(0,w.jsx)("path",{d:"M18,4.361V3c0-1.657-1.343-3-3-3s-3,1.343-3,3v1.361C6.27,5.718,2,10.854,2,17c0,7.18,5.82,13,13,13s13-5.82,13-13 C28,10.854,23.73,5.718,18,4.361z M14,3c0-0.552,0.448-1,1-1s1,0.448,1,1v1.051C15.669,4.025,15.338,4,15,4s-0.669,0.025-1,0.051V3z M16,27.949V26h-2v1.949C8.724,27.474,4.526,23.276,4.051,18H6v-2H4.051C4.526,10.724,8.724,6.526,14,6.051V8h2V6.051 c5.276,0.476,9.474,4.673,9.949,9.949H24v2h1.949C25.474,23.276,21.276,27.474,16,27.949z M8,24l10-4l4-10l-10,4L8,24z M18.41,13.59 l-1.949,4.871L11.59,20.41l1.949-4.871L18.41,13.59z"})});var I=n(84197),C=n(64330),x=n(37240),T=n(95855),M=n(30845),P=n(23210),A=n(70203),R=n(9291),D=n(31701),E=n(53965),B=n(37810),F=n(88150),O=n(88864),Z=n(59301),V=n(57549),U=n(54564),L=n(47307),j=n(31781),N=n(96802),z=n(27153),q=n(42858),W=n(24677),H=n(98104),K=n(13447),G=n(18821),$=n(95477),Q=n(95645),Y=n(28020),J=n(43250),X=n(14976),ee=n(41232),te=n(33929),ne=n(98742),oe=n(17504),ie=n(65598),re=n(53824),ae=n(18245),se=n(68859),le=n(61766),ce=n(88632),de=n(80796);class ue extends p.default{getInitialState(){return{hovered:!1,focused:!1,isInFrame:!1}}}const pe=ue;var me=n(77080),fe=n(27411),ge=n(64424),he=n(85529),ve=n(69784),be=n(12534),ye=n(96049),_e=n(24047),Se=n(35021);let we=null;const ke=p.default.createClass(void 0);function Ie(e){let{source:t,contentWrapStyle:n,handleEmbedComp:i,contentStyle:r}=e;const a=(0,d.qz)(void 0,ke),s=(0,o.useCallback)((e=>function(e,t,n){const o=(0,_e.K9)(e.currentTarget,t);o&&n.setState(o)}(e,t,a)),[t,a]),l=(0,d.VK)((()=>function(e){return{...e,pointerEvents:ye.Z.state?"none":"auto",position:"relative"}}(r)),[r]);return(0,w.jsx)("div",{style:n,onMouseDown:be.$0,onTouchStart:be.$0,children:(0,w.jsxs)("div",{style:l,children:[(0,w.jsx)("audio",{ref:e=>i(e),style:l,controls:!0,preload:"none",onError:s,onPlay:xe,onPause:Te,src:t}),(0,w.jsx)(Me,{errorStore:a})]})})}const Ce={render:function(e){const{contentStyle:t,contentWrapStyle:n,handleEmbedComp:o}=e;return(0,w.jsx)(Se.Z,{url:e.source,permissionRecord:e.store.pointer,useS3Url:e.useS3Url,render:(e,i,r)=>r?i?(0,w.jsx)(Ie,{contentStyle:t,contentWrapStyle:n,source:i,handleEmbedComp:o}):void 0:(0,w.jsx)("div",{})})},resizable:!1,hideActions:!0,rendererType:"audio"};function xe(e){we&&we.pause(),we=e.currentTarget}function Te(e){we===e.currentTarget&&(we=null)}function Me(e){let{errorStore:t}=e;const n=(0,d.VK)((()=>t.state),[t]);return n?(0,w.jsx)(_e.ZP,{family:"audio",error:n,isSmall:!0}):null}var Pe=n(13966),Ae=n(91893),Re=n(23864),De=n(70518),Ee=n(68709),Be=n(64921),Fe=n(31945),Oe=n(89728),Ze=n(26388),Ve=n(24098),Ue=n(73959),Le=n(77907),je=n(27724),Ne=n(1743);function ze(e){const t=(0,s.O7)(),n=(0,d.VK)((()=>(0,Ue.iZ)(e.store)),[e.store]),i=(0,u.yK)((t=>({sizer:{height:e.height,display:"flex",borderRadius:3,paddingTop:2,paddingLeft:10,paddingRight:10,paddingBottom:10},border:{display:"flex",flex:1,margin:2,padding:3,boxShadow:n?t.outlineBlueInputBoxShadow:void 0,outline:`1px solid ${t.regularDividerColor}`,transition:"box-shadow 0.1s ease-in-out",willChange:"box-shadow",borderRadius:3},ignoreClickArea:{flex:1,position:"relative"}})),[n,e.height]),r=(0,o.useCallback)((()=>{H.ZH({device:t.device}),W.Z5({environment:t,stores:[e.store],phase:je.SelectionPhase.Editing})}),[t,e.store]),a=(0,o.useCallback)((t=>(0,w.jsx)("div",{...t,style:i.ignoreClickArea,className:"notion-disable-webkit-user-select",children:(0,w.jsx)(Le.LazyTldrawAdapter,{...e,isEditing:n})})),[i.ignoreClickArea,e,n]);return(0,w.jsx)("div",{style:i.sizer,onPointerDown:r,children:(0,w.jsx)("div",{style:i.border,children:(0,w.jsx)(Ne.Z,{debugName:"DrawingBox",capture:n,allowEsc:!0,children:(0,w.jsx)(Ve.Z,{capture:!0,render:a})})})})}const qe={render:e=>(0,w.jsx)(ze,{...e}),resizable:!0,hideActions:!0,rendererType:"drawing"},We=(0,S.IU)("cornerResize",{viewBox:"0 0 16 16",svg:(0,w.jsx)("path",{fillRule:"evenodd",strokeWidth:"1.5",d:"M 14 0C 12.8955 0 12 0.895447 12 2L 12 12L 2 12C 0.895508 12 0 12.8954 0 14C 0 15.1046 0.895508 16 2 16L 14 16C 15.1045 16 16 15.1046 16 14L 16 2C 16 0.895447 15.1045 0 14 0Z"})});var He=n(97466);function Ke(e){let{store:t,resizerType:n,resizerAlignment:i,resizeComponent:r,preserveScale:a,isHovered:l,blockResizerStore:c}=e;const u=(0,s.O7)(),p=(0,s.Fy)(),m=(0,d.qz)(c,se.Z),f=(0,d.VK)((()=>!p.isMobile&&l),[p.isMobile,l]),g=(0,d.VK)((()=>{const e={position:"absolute",pointerEvents:f?"auto":"none",display:"flex",alignItems:"center",justifyContent:"center"};return i===De.bZ.Right?e.right=0:i===De.bZ.Left&&(e.left=0),n===De.IS.Horizontal?(e.top=0,e.zIndex=1,e.height="100%",e.width=Ge,e.cursor="col-resize"):n===De.IS.Vertical?(e.bottom=0,e.zIndex=1,e.width="100%",e.height=Ge,e.cursor="row-resize"):n===De.IS.Corner&&(e.zIndex=2,e.bottom=0,e.width=e.height=Qe,i===De.bZ.Left?e.cursor="nesw-resize":i===De.bZ.Right&&(e.cursor="nwse-resize")),e}),[i,n,f]),h=(0,o.useMemo)((()=>{const e={position:"absolute"};return n===De.IS.Vertical||n===De.IS.Corner?e.bottom=$e:n===De.IS.Horizontal&&(e.top=$e),i===De.bZ.Left?e.left=$e:i===De.bZ.Right&&(e.right=$e),{...g,style:e}}),[i,g,n]),v=(0,d.VK)((()=>{const{ThemeStore:e}=u,t=e.state.mode,o={opacity:f?1:0,transition:vn,borderRadius:20,background:(0,He.Fq)(D.se[t].black,.6),border:`1px solid ${D.ZP.whiteWithAlpha(.9)}`};return n===De.IS.Horizontal?(o.width=6,o.height=48,o.maxHeight="50%"):n===De.IS.Vertical&&(o.height=6,o.width=48,o.maxWidth="50%"),o}),[u,n,f]),b=(0,o.useMemo)((()=>n===De.IS.Corner?We({stroke:D.ZP.whiteWithAlpha(.5),fill:D.ZP.blackWithAlpha(.65),width:Qe,height:Qe,transition:`opacity ${vn}`,opacity:f?1:0,position:"relative",bottom:3,left:i===De.bZ.Left?3:-3,transform:i===De.bZ.Left?"rotate(90deg)":"none"}):(0,w.jsx)("div",{style:v})),[i,v,n,f]);return(0,w.jsx)(De.ZP,{store:t,preserveScale:a,resizerType:n,resizerAlignment:i,resizeComponent:r,blockResizerStore:m,resizeHorizontally:!0,resizeVertically:!0,disabled:!1,children:(0,w.jsx)("div",{style:h,children:b})})}const Ge=15,$e=0,Qe=20;var Ye=n(86329),Je=n(83355),Xe=n(18265),et=n(12457),tt=n(37850);let nt=0;const ot="notion_jsonp_callback_";function it(e){const t=tt.UZ(),n=document.createElement("script");n.type="text/javascript";const o=function(){const e=ot+nt;return nt++,e}();window[o]=e=>{delete window[o],n.parentNode&&n.parentNode.removeChild(n),t.resolve(e)};const i=Xe.SK(e,{callback:o});return n.src=i,n.onerror=e=>{delete window[o],n.parentNode&&n.parentNode.removeChild(n),t.reject(e)},document.head&&document.head.appendChild(n),t.promise}class rt extends p.default{getInitialState(){return{loading:!0,error:!1,html:void 0}}}const at=rt;var st=n(68785);const lt={userSelect:"none",padding:"6px 10px",borderRadius:4,border:"1px solid #dddddd",fontSize:14,width:"100%"};class ct extends Je.Z{constructor(){super(...arguments),this.storeTypes={store:at}}async didMount(){const e=`https://gist.github.com/${function(e){const{pathname:t}=Xe.Qc(e);return(t||"").split("/").pop()}(this.props.source)}.json`;try{const n=await it(e);this.stores.store.setState({loading:!1,error:!1,html:n.div});if(!document.querySelector(`link[href="${n.stylesheet}"]`)){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=n.stylesheet,document.head&&document.head.appendChild(t)}}catch(n){this.stores.store.setState({loading:!1,error:!0,html:void 0})}}renderComponent(){return(0,w.jsx)("div",{children:(0,w.jsx)(Ve.Z,{capture:!0,render:e=>(0,w.jsx)("div",{...e,ref:this.props.handleEmbedComp,style:pt(this.stores.store),children:(0,w.jsx)(ut,{store:this.stores.store})})})})}}ct.displayName="GistBox";const dt={render:function(e){const{source:t,handleEmbedComp:n}=e;return(0,w.jsx)(ct,{source:t,handleEmbedComp:n})},renderFullScreen:void 0,resizable:!0,embedGhost:!0,hideActions:!0};function ut(e){let{store:t}=e;const{error:n,html:o,loading:i}=(0,d.VK)((()=>t.state),[t]);return(0,w.jsx)(et.Z,{show:i,showDelay:1e3,showHold:500,render:e=>e||i?(0,w.jsx)("div",{style:{marginBottom:"1em"},children:(0,w.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",opacity:e?1:0,...lt},children:[(0,w.jsx)(st.Z,{}),(0,w.jsx)("div",{style:{marginLeft:8},children:(0,w.jsx)(R.FormattedMessage,{defaultMessage:"Loading gist",id:"githubGistRenderer.loading.message"})})]})}):n?(0,w.jsx)("div",{style:{marginBottom:"1em"},children:(0,w.jsx)("div",{style:lt,children:(0,w.jsx)(R.FormattedMessage,{defaultMessage:"Error loading gist",id:"githubGistRenderer.errorLoading.message"})})}):(0,w.jsx)("div",{dangerouslySetInnerHTML:{__html:o??""},className:"notion-gist-block"})})}function pt(e){return e.state.html?{width:"100%",marginBottom:"-1em",overflowY:"auto",height:"100%",pointerEvents:ye.Z.state?"none":"auto"}:{width:"100%",marginBottom:"-1em"}}var mt=n(63085),ft=n(25777),gt=n(49271),ht=n(69721);const vt=function(e){const{signedUrl:t,dataSize:n,dataName:o,contentWrapStyle:i,disabled:r,viewOriginal:a}=e,s={paddingTop:gt.ZD.paddingTop,paddingBottom:gt.ZD.paddingBottom,paddingLeft:gt.ZD.paddingLeft};return(0,w.jsx)("div",{style:i,onClick:void 0,onMouseDown:be.$0,children:(0,w.jsx)("div",{style:{position:"relative"},children:t&&(0,w.jsx)(ht.S,{title:o,url:t,size:n,onClick:r?void 0:a,style:s})})})};var bt=n(33626),yt=n(23586);const _t=(0,S.IU)("play",{viewBox:"0 0 14 16",svg:(0,w.jsx)("path",{d:"M1.34699 16C1.73805 16 2.07697 15.8756 2.52017 15.6089L12.8703 9.47556C13.6437 9.01333 14 8.62222 14 8C14 7.37778 13.6437 6.98667 12.8703 6.52444L2.52017 0.391111C2.07697 0.133333 1.73805 0 1.34699 0C0.582247 0 0 0.595556 0 1.57333V14.4356C0 15.4044 0.582247 16 1.34699 16Z"})});function St(e){let{url:t,metadata:n}=e;const o=(0,u.yK)((e=>({previewWrapper:{display:"flex",flexDirection:"column",border:`1px solid ${e.darkDividerColor}`,borderRadius:"3px",height:"100%"},previewImageArea:{flex:1,backgroundColor:e.embedPlaceholderBackground},previewInfoArea:{padding:"0.75em 1em",backgroundColor:e.regularInvertedTextColor,display:"flex",flexDirection:"column",gap:"0.25em"},previewTitle:{fontWeight:B.Z.fontWeight.medium,color:e.darkTextColor},previewUrl:{display:"flex",alignItems:"center",gap:"0.75em"},previewUrlText:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:e.lightTextColor},previewUrlFavicon:{width:"1.25em",height:"1.25em"}})),[]),i=null!=n&&n.images&&n.images.length>0?n.images[0].url:void 0;return(0,w.jsxs)("div",{style:o.previewWrapper,children:[(0,w.jsx)("div",{style:o.previewImageArea,children:i?(0,w.jsx)(wt,{imageUrl:i}):(0,w.jsx)(kt,{})}),(0,w.jsxs)("div",{style:o.previewInfoArea,children:[(null==n?void 0:n.title)&&(0,w.jsx)("div",{style:o.previewTitle,children:n.title}),(0,w.jsxs)("div",{style:o.previewUrl,children:[(null==n?void 0:n.favicon_url)&&(0,w.jsx)("img",{style:o.previewUrlFavicon,src:n.favicon_url}),(0,w.jsx)("div",{style:o.previewUrlText,children:t})]})]})]})}function wt(e){let{imageUrl:t}=e;const n=(0,u.yK)((e=>({wrapper:{display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"flex-start",height:"100%",backgroundSize:"cover",backgroundImage:`url(${t})`},pill:{backgroundColor:e.accentColors.gray[800],color:e.accentColors.gray[50],borderRadius:"99em",padding:"0.5em 1em",margin:"1em",display:"flex",alignItems:"center",gap:"0.75em",fontWeight:B.Z.fontWeight.medium},playButton:{width:"1em",height:"1em",fill:e.accentColors.gray[50]}})),[t]);return(0,w.jsx)("div",{style:n.wrapper,children:(0,w.jsxs)("div",{style:n.pill,children:[_t(n.playButton),(0,w.jsx)("span",{children:(0,w.jsx)(R.FormattedMessage,{defaultMessage:"Load embed",id:"iFramePreview.pillLabel"})})]})})}function kt(){const e=(0,u.yK)((e=>({wrapper:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:e.mediumTextColor,height:"100%"},message:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:"0.75em",fontWeight:B.Z.fontWeight.medium},playButtonWrapper:{backgroundColor:e.mediumTextColor,borderRadius:"2em",width:"2.5em",height:"2.5em",display:"flex",justifyContent:"center",alignItems:"center"},playButton:{marginLeft:"0.1em",width:"1em",height:"1em",fill:e.embedPlaceholderBackground}})),[]);return(0,w.jsx)("div",{style:e.wrapper,children:(0,w.jsxs)("div",{style:e.message,children:[(0,w.jsx)("div",{style:e.playButtonWrapper,children:_t(e.playButton)}),(0,w.jsx)("span",{children:(0,w.jsx)(R.FormattedMessage,{defaultMessage:"Tap to load embed",id:"iFramePreview.imagelessAreaLabel"})})]})})}function It(e){let{source:t}=e;const n=(0,s.O7)(),o={request:t,performRequest:e=>async function(e,t){return(0,mt.W4)(t,e)}(e,n),render:(e,n,o)=>(0,w.jsx)(Ct,{error:e,result:n,ready:o,source:t})};return(0,w.jsx)(yt.Z,{...o})}function Ct(e){let{error:t,result:n,ready:o,source:i}=e;return o?(0,w.jsx)(St,{url:i,metadata:n}):null}const xt={position:"absolute",left:0,top:0,width:"100%",height:"100%",borderRadius:1};function Tt(e){const{render:t,style:n,errorStyle:o,...i}=e,r=(0,mt.NX)(e.url);return(0,w.jsx)(Se.Z,{...i,render:(i,a,s)=>{let l=r;return i&&!l&&(l=(0,mt.sj)(i)??{type:"unknown",source:e.url}),(0,w.jsx)("div",{style:n,children:(0,w.jsx)(ft.Z,{innerStyle:{height:"100%",width:"100%"},loaded:s,style:xt,spinnerSize:"1em",showSpinnerTimeout:500,children:l?(0,w.jsx)("div",{style:o,children:(0,w.jsx)(_e.ZP,{family:"embed",error:l})}):t(a)})})}})}function Mt(e){const{height:t,source:n,contentStyle:i,dataName:r,dataSize:a,width:s}=e,[l,c]=(0,o.useState)(!1);return(0,w.jsx)(Tt,{url:n,permissionRecord:e.store.pointer,useS3Url:e.useS3Url,style:{width:"100%",height:"100%"},errorStyle:{height:t,width:s},render:n=>l&&r&&a?(0,w.jsx)(vt,{...e,dataName:r,dataSize:a,signedUrl:n}):n&&(0,w.jsx)(bt.Z,{source:n,isFullWidth:!0,isFullHeight:!0,height:t,style:i,background:!0,onContentLoadTimeout:()=>c(!0)})})}const Pt={render:function(e){const{disabled:t,contentStyle:n,contentWrapStyle:i,handleFullScreen:r,handleEmbedComp:a,height:s,preserveScale:l,isFullWidth:c,source:d,dataName:u,dataSize:p}=e,[m,f]=(0,o.useState)(!1),g=(0,mt.kl)({height:s,isFullWidth:c,preserveScale:l});return(0,w.jsx)(Tt,{url:d,permissionRecord:e.store.pointer,useS3Url:e.useS3Url,style:g,errorStyle:{position:"relative",height:s},render:o=>m&&u&&p?(0,w.jsx)(vt,{...e,dataName:u,dataSize:p,signedUrl:o}):(0,w.jsx)("div",{style:i,onClick:t?r:void 0,onMouseDown:be.$0,children:(0,w.jsx)("div",{style:{position:"relative"},children:o&&(0,w.jsx)(bt.Z,{ref:e=>a(e),source:o,height:s,style:n,preserveScale:l,isFullWidth:c,background:!0,renderPreview:()=>(0,w.jsx)(It,{source:(0,mt.cJ)(e)}),onContentLoadTimeout:()=>f(!0)})})})})},embedGhost:!0,renderFullScreen:e=>(0,w.jsx)(Mt,{...e}),resizable:!0},At=Pt;var Rt=n(10517),Dt=n.n(Rt),Et=n(43593),Bt=n(54642),Ft=n(79947),Ot=n(24042),Zt=n(12981),Vt=n(32854),Ut=n(81865),Lt=n(5377);function jt(e){const{file:t,fileName:n,fileSize:o,progressPercent:i}=e;return(0,w.jsx)(Ye.Z,{disabled:!0,iconSvg:Lt.y,isLoading:!0,progressPercent:i,file:t,name:n,size:o,onClick:()=>{}})}const Nt=p.default.createClass(void 0);function zt(e){const{store:t,dataURL:n,source:i,isFullWidth:r,isRootChild:a,aspectRatio:l,height:c,dragging:p,blockWidth:m,isFullScreen:f,imageBoxRef:g}=e,h=(0,s.O7)(),v=(0,d.qz)(void 0,Nt),b=(0,d.VK)((()=>v.state),[v]),y=(0,d.VK)((()=>fe.default.getKeyState(fe.default.getBlockKey(t.id))),[t]),_=(0,d.VK)((()=>he.Z.getStatus(t.id)),[t.id]),S=(0,d.VK)((()=>{if("uploading"===_||"completed"===_)return he.Z.getDataURL(t.id)}),[_,t.id]),k=(0,o.useRef)(i),I=(0,o.useRef)(void 0),C=(0,o.useRef)(void 0),x=(0,o.useRef)(void 0),T=(0,o.useRef)(!1),M=Boolean("image/heic"===C.current),P=M&&(null==n?void 0:n.startsWith("blob:"))&&Boolean(!h.device.isSafari),A=r&&!p?void 0:m,R=window.innerWidth,E=A?Math.min(A,window.innerWidth):window.innerWidth;async function B(t,n){const o=Et.E$(e.source,[$.default.secureFileS3.url,$.default.secureFileS3V2.url])?n:e.source;if(n){const e=await(0,Ft.ZP)({url:n,environment:h,method:"HEAD",format:"text"});if("failed"===e.type){const t=(0,_e.cT)(e.error,o);if(t)return v.setState(t),void ae.default.measure("image_load",{environment:h,data:{success:!1,status:e.status}})}}v.setState({type:"unknown",source:o}),ae.default.measure("image_load",{environment:h,data:{success:!1,status:0}})}function F(){v.setState(void 0),ae.default.measure("image_load",{environment:h,data:{success:!0}})}(0,o.useEffect)((()=>{x.current=ae.default.mark("image_load")}),[]),(0,o.useEffect)((()=>{null!=y&&y.file.type&&!Boolean(C.current)&&(C.current=null==y?void 0:y.file.type)}),[y]),(0,o.useEffect)((()=>{if(n||!i||!h.mobileNative)return;if(I.current&&i===k.current)return;k.current=i;Et.E$(i,[$.default.secureFileS3.url,$.default.secureFileS3V2.url])&&Bt.getSignedFileUrl(h,{url:i,download:!1,downloadName:"image",permissionRecord:t.pointer},Boolean(Ot.Z.state.isNotionProtocolBugFixed)).then((e=>{I.current=e}))}),[h,k,I,i,t.pointer,n]),(0,o.useLayoutEffect)((()=>{var e;const n=null===(e=g.current)||void 0===e||null===(e=e.elementRef)||void 0===e?void 0:e.current;n&&!y&&(n.onload=()=>{const e=n.getBoundingClientRect();e.width!==m&&(M||m===n.naturalWidth&&e.width!==n.naturalWidth&&!T.current&&t.canEdit()&&(K.createAndCommit({userAction:"ImageRenderer.updateBlockWidth",environment:h,perform:n=>{N.FH({stores:[t],update:{block_width:e.width},transaction:n})}}),T.current=!0))})}),[M,m,h,g,t,y]);const O=(0,u.yK)((e=>{const t={},n={};return r&&a||!l?c&&(t.height=c,t.background=D.ZP.contentGrayBackground):(t.height=0,t.paddingBottom=100*l+"%",t.background=D.ZP.contentGrayBackground),f||r||p||m&&l&&(n.maxHeight=m*l),{content:n,placeholder:t,contentWrap:{}}}),[r,a,l,c,f,m,p]);if(P&&y){const{file:e,name:t,size:n,progressPercent:o}=y;return(0,w.jsx)(jt,{file:e,fileName:t,fileSize:n,progressPercent:o})}return n?(0,w.jsx)(qt,{...e,proxyError:void 0,renderURL:n,embedError:b,environment:h,signedOriginalURLRef:I,onImageError:B,onImageLoad:F,styles:O}):(0,w.jsx)(Ut.Z,{url:i,width:f?R:E,render:(t,n)=>{var o;let i=n;return void 0===n&&void 0!==C.current&&null!==(o=k.current)&&void 0!==o&&o.startsWith("blob:")&&(i=k.current),S&&(i=S),(0,w.jsx)(qt,{...e,proxyError:t,renderURL:i,embedError:b,environment:h,signedOriginalURLRef:I,onImageError:B,onImageLoad:F,styles:O})},isAuthenticated:!0,permissionRecord:t.pointer},`width-${e.contentStyle.width}`)}function qt(e){const{proxyError:t,renderURL:n,isFullScreen:i}=e,[r,a]=(0,o.useState)(n);(0,o.useEffect)((()=>{void 0!==n&&n!==r&&a(n)}),[r,n]);const s=(0,_e.cT)(t,void 0)||(0,mt.sj)(t)||e.embedError;return i?(0,w.jsx)(Ht,{...e,embedError:s,renderURL:r}):(0,w.jsx)(Wt,{...e,embedError:s,renderURL:r})}function Wt(e){const{embedError:t,renderURL:n,progressPercent:o,disabled:i,isLoading:r,contentStyle:a,contentWrapStyle:s,handleFullScreen:l,handleEmbedComp:c,isFullWidth:u,isRootChild:p,height:m,inlineContentStyle:f,blockLocation:g,imageBoxRef:h,environment:v,onImageError:b,onImageLoad:y,signedOriginalURLRef:_,styles:S,store:k}=e,I=j.qC(g),C=()=>{var e;if(O.QI(v,{from:"embedded_block_click",type:"image"}),!n)return;const t=0===n.indexOf("https:")?n:`${$.default.domainBaseUrl}${n}`;null===(e=v.mobileNative)||void 0===e||e.showLightBox({items:[{type:"image",previewUrl:Dt()(t),originalUrl:Dt()(_.current??t)}],startingIndex:0,from:"embedded_block_click"}),W.ZH(v),H.sD()},x=v.mobileNative&&!1===(null==n?void 0:n.startsWith("data:")),T=x?C:I?void 0:l,M=x?C:I?t=>Gt(t,e.handleFullScreen):void 0,P=I?t=>Gt(t,e.handleFullScreen):l,A=(0,d.VK)((()=>me.default.checkGate("alt_text_image_blocks")?(0,X.Xh)(k.getPropertyValue("alt_text"),k):""),[k]),R=(0,d.VK)((()=>!!r&&"uploading"!==he.Z.getStatus(k.id)),[r,k.id]);return(0,w.jsx)("div",{ref:e=>c(e),style:{...s,...S.contentWrap},onClick:i&&!x?P:void 0,children:(0,w.jsxs)("div",{children:[(0,w.jsx)(Zt.Z,{alt:A,ref:h,src:n,loading:"lazy",isFullScreen:!1,style:{...a,...S.content,...f},placeholderStyle:S.placeholder,onDoubleClick:T,onClick:M,height:u&&p?m:void 0,capMaxHeight:u&&p,onError:b,onLoad:y}),t&&(0,w.jsx)(_e.ZP,{error:t,family:"image"}),R&&(0,w.jsxs)("div",{style:Zt.I,children:[(0,w.jsx)(st.Z,{style:{width:16,height:16,marginRight:4}}),(0,w.jsx)("div",{style:{minWidth:30,textAlign:"right"},children:(0,w.jsx)(Vt.Z,{percentage:o})})]})]})})}function Ht(e){const{contentStyle:t,embedError:n,renderURL:o,onImageError:i,onImageLoad:r,styles:a}=e,s=Math.min(500,window.innerWidth-50);return(0,w.jsx)("div",{style:{alignSelf:"center",margin:0,position:"relative",minWidth:n?s:void 0},children:(0,w.jsxs)("div",{children:[(0,w.jsx)(Zt.Z,{src:o,isFullScreen:!0,style:{...t,...a.content},placeholderStyle:a.placeholder,capMaxHeight:!1,onError:i,onLoad:r}),n&&(0,w.jsx)(_e.ZP,{error:n,family:"image"})]})})}const Kt={rendererType:"image",render:e=>(0,w.jsx)(zt,{...e,isFullScreen:!1}),renderFullScreen:e=>(0,w.jsx)(zt,{...e,isFullScreen:!0}),resizable:!0};function Gt(e,t){e.stopPropagation(),t()}const $t={render:function(e){const{disabled:t,contentStyle:n,contentWrapStyle:o,handleFullScreen:i,source:r,handleEmbedComp:a,height:s}=e;return(0,w.jsx)("div",{style:o,onClick:t?i:void 0,children:(0,w.jsx)("div",{style:{position:"relative"},children:(0,w.jsx)(bt.Z,{ref:e=>a(e),source:r,height:s,style:n,background:!1,renderPreview:()=>(0,w.jsx)(It,{source:(0,mt.cJ)(e)})})})})},renderFullScreen:function(e){const{source:t,height:n,contentStyle:o}=e;return(0,w.jsx)(bt.Z,{source:t,isFullWidth:!0,height:n,style:o,background:!0})},resizable:!0},Qt=$t;var Yt=n(15950),Jt=n(83785);function Xt(e){const{handleEmbedComp:t,source:r,fullScreen:a}=e,s=(0,u.Fg)(),l=(0,u.yK)((e=>({main:{width:a?520:"100%",minWidth:"100%",pointerEvents:"auto",margin:a?"-10px auto":"-10px 0"},loading:{userSelect:"none",borderRadius:4,border:"1px solid #dddddd",fontSize:14,width:"100%",padding:"6px 10px"}})),[a]),c=(0,o.useCallback)((async e=>{if(!e)return;const{pathname:t}=Xe.Qc(r),n=(t||"").split("/")[3],o={dnt:!0,lang:"en",width:"100%",theme:"dark"===s.mode?"dark":"light"};if(n&&window.twttr){e.innerHTML="";if(await window.twttr.widgets.createTweetEmbed(n,e,o))return}i.render((0,w.jsx)("div",{style:l.loading,children:"Error loading tweet"}),e)}),[r,l.loading,s.mode]);return(0,w.jsx)("div",{style:{display:"flex"},children:(0,w.jsx)("div",{style:{marginLeft:"auto",marginRight:"auto",maxWidth:420,minWidth:0,width:"100%"},children:(0,w.jsx)(Ve.Z,{capture:!0,render:e=>(0,w.jsx)("div",{...e,ref:e=>e&&t(e),style:l.main,children:(0,w.jsx)(Jt.Z,{fetch:()=>n.e(898).then(n.bind(n,22062)),loading:e=>e&&(0,w.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",...l.loading},children:[(0,w.jsx)(st.Z,{}),(0,w.jsx)("div",{style:{marginLeft:8},children:(0,w.jsx)(R.FormattedMessage,{id:"tweetRenderer.loadingTweet.message",defaultMessage:"Loading Tweet"})})]}),render:()=>(0,w.jsx)("div",{ref:c})})})})})})}const en={render:function(e){const{source:t,handleEmbedComp:n}=e;return(0,w.jsx)(Xt,{source:t,handleEmbedComp:n,fullScreen:!1})},renderFullScreen:function(e){const{source:t,handleEmbedComp:n}=e;return(0,w.jsx)(Xt,{source:t,handleEmbedComp:n,fullScreen:!0})},resizable:!1,embedGhost:!0,hideActions:!0},tn={position:"absolute",left:"50%",top:"50%",transform:"translate(-30%, -50%)",height:0,width:0,borderStyle:"solid",borderColor:D.ZP.uiBlack,borderRightWidth:0,borderLeftWidth:24.5,borderTopWidth:16.1,borderBottomWidth:16.1,borderTopColor:D.ZP.transparent,borderBottomColor:D.ZP.transparent},nn={position:"relative",height:70,width:70,borderWidth:3,borderStyle:"solid",borderColor:D.ZP.uiBlack,borderRadius:70},on={position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},rn=p.default.createClass(!1),an=p.default.createClass(void 0);function sn(e){let{store:t,source:n,contentWrapStyle:i,handleFullScreen:r,aspectRatio:a,height:s,handleEmbedComp:l,isFullWidth:c,preserveScale:p,mediaType:m,useS3Url:g,isRootChild:h,contentStyle:v,blockLocation:b}=e;const y=(0,u.Fg)(),_=(0,o.useRef)(null),S=(0,o.useCallback)((e=>{l(e),_.current=e}),[l]),k=(0,d.qz)(void 0,an),I=(0,d.qz)(void 0,rn),C=(0,d.VK)((()=>fn("embed_url",y,c,h,p,s,v,b,I)),[y,c,h,p,s,v,b,I]);return(0,w.jsx)(Se.Z,{url:n,permissionRecord:t.pointer,useS3Url:g,render:(e,t,o)=>{if(!o)return(0,w.jsx)("div",{});const d=(0,_e.cT)(e,void 0)||k.state;return t?"video"===m||(0,f.xL)({url:n})?(0,w.jsx)("div",{style:i,onMouseDown:be.$0,children:(0,w.jsxs)("div",{style:{position:"relative"},onDoubleClick:r,children:[(0,w.jsx)(mn,{videoRef:_,setVideoRef:S,source:n,isFullWidth:c,isRootChild:h,preserveScale:p,height:s,contentStyle:v,blockLocation:b,playedStore:I,errorStore:k,signedUrl:t}),d&&(0,w.jsx)(dn,{error:d}),(0,w.jsx)(pn,{videoRef:_,playedStore:I,errorStore:k})]})}):(0,w.jsx)("div",{style:i,onDoubleClick:r,children:(0,w.jsx)("div",{style:{position:"relative"},children:(0,w.jsx)(bt.Z,{ref:e=>l(e),source:t,height:s,style:C,isFullWidth:c,preserveScale:p,aspectRatio:a,background:!0})})}):void 0}})}function ln(e){return(0,w.jsx)("div",{style:{...nn,...e.style},children:(0,w.jsx)("div",{style:tn})})}const cn={render:e=>(0,w.jsx)(sn,{...e}),resizable:!0,embedGhost:!0};function dn(e){let{error:t}=e;return(0,w.jsx)(_e.ZP,{family:"video",error:t})}function un(){const e=(0,s.O7)(),{device:t}=e;return t.isFirefox||t.isMobile?null:(0,w.jsx)(ln,{})}function pn(e){let{videoRef:t,playedStore:n,errorStore:i}=e;const r=(0,o.useCallback)((e=>{const n=t.current;n&&(0,be.ZP)({event:e,context:be.Af.EditorClick,callback:()=>{n.play()}})}),[t]);return(0,d.VK)((()=>n.state||i.state),[n,i])?null:(0,w.jsx)("div",{onClick:r,style:on,children:(0,w.jsx)(un,{})})}function mn(e){let{signedUrl:t,source:n,isFullWidth:i,isRootChild:r,preserveScale:a,height:l,contentStyle:c,blockLocation:p,playedStore:m,errorStore:f,videoRef:g,setVideoRef:h}=e;const v=(0,u.Fg)(),b=(0,s.O7)(),y=(0,o.useCallback)((e=>{const{device:t}=b;t.isMobile&&m.setState(!1)}),[b,m]),_=(0,o.useCallback)((()=>{m.setState(!0)}),[m]),S=(0,o.useCallback)((()=>{const{device:e}=b;e.isAndroid&&document.fullscreenElement&&document.exitFullscreen()}),[b]),k=(0,o.useCallback)((()=>{const{device:e}=b,t=g.current;e.isIOS&&t&&t.pause()}),[b,g]),I=(0,o.useCallback)((e=>{const t=(0,_e.K9)(e.currentTarget,n);t&&f.setState(t)}),[n,f]),C=(0,d.VK)((()=>fn("video_file",v,i,r,a,l,c,p,m)),[v,i,r,a,l,c,p,m]);return(0,w.jsx)("video",{ref:h,style:C,autoPlay:b.device.isIOS,playsInline:!0,controls:!0,preload:"metadata",onPause:y,onPlay:_,onEnded:S,onLoadStart:k,onError:I,src:t})}function fn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"embed_url",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>5?arguments[5]:void 0,o=arguments.length>7?arguments[7]:void 0,i=arguments.length>8?arguments[8]:void 0;const r={...arguments.length>6?arguments[6]:void 0};return(arguments.length>2?arguments[2]:void 0)&&(arguments.length>3?arguments[3]:void 0)&&(arguments.length>4?arguments[4]:void 0)&&(r.height=n),"video_file"!==e||i.state||(r.pointerEvents="none"),j.qC(o)&&(r.maxHeight=240),r.backgroundColor=t.embedPlaceholderBackground,r}const gn={background:"rgba(255, 255, 255, 0.055)"},hn={display:"flex",alignItems:"center",justifyContent:"center",padding:"4px 6px",borderRight:`1px solid ${D.ZP.whiteWithAlpha(.2)}`},vn="opacity 300ms ease-in",bn=(0,R.defineMessages)({embedButtonText:{defaultMessage:"Embed link",id:"embedBlock.embedButton.label"},embedCaption:{defaultMessage:"Works with links of PDFs, Google Drive, Google Maps, CodePenâ€¦",id:"embedBlock.linkPrompt.caption"},pastePrompt:{defaultMessage:"Paste in https://â€¦",id:"embedBlock.pastePrompt"},validLink:{defaultMessage:"Please enter a valid link.",id:"embedBlock.invalidLinkError.message"},embedTitle:{defaultMessage:"Embed",id:"embedBlock.embedTab.title"},actionComment:{defaultMessage:"Comment",id:"embedBlock.actionButton.tooltip.comment"},actionDownload:{defaultMessage:"Download",id:"embedBlock.actionButton.tooltip.download"},actionOriginal:{defaultMessage:"Original",id:"embedBlock.actionButton.tooltip.original"},actionAlign:{defaultMessage:"Align",id:"embedBlock.actionButton.tooltip.align"},actionCaption:{defaultMessage:"Caption",id:"embedBlock.actionButton.tooltip.caption"},actionExpand:{defaultMessage:"Expand",id:"embedBlock.actionButton.tooltip.expand"},actionMore:{defaultMessage:"More actions",id:"embedBlock.actionButton.tooltip.blockActionMenu"},actionEditImage:{defaultMessage:"Crop image",id:"embedBlock.actionButton.tooltip.cropImage"},actionViewAltText:{defaultMessage:"Click to view alt text",id:"embedBlock.actionButton.tooltip.viewAltText"},actionEditAltText:{defaultMessage:"Click to view and edit alt text",id:"embedBlock.actionButton.tooltip.editAltText"}}),yn={tweet:en,gist:dt,video:cn,image:Kt,audio:Ce,invision:Qt,mixpanel:At,maps:At,drive:At,framer:At,figma:At,loom:At,typeform:At,codepen:At,embed:At,pdf:Yt.Z,whimsical:At,miro:At,abstract:At,sketch:At,excalidraw:At,replit:At,hex:At,deepnote:At,drawing:qe},_n=new Set(["pdf","drive"]);class Sn extends Q.Z{constructor(){super(...arguments),this.embedComp=null,this.embedContainerWidth=p.default.createValue(0),this.didHaveNonZeroWidth=p.default.createValue(!1),this.imageBoxRef=o.createRef(),this.isStoreNavigableAncestorNonEditableState=this.createComputedStore((()=>this.props.store.isNavigableAncestorNonEditableState())),this.embedContainerHeight=this.createComputedStore((()=>{var e;const{block_aspect_ratio:t}=this.props.store.getFormat();if(t&&!((null===(e=this.embedContainerWidth)||void 0===e?void 0:e.state)<=0))return this.embedContainerWidth.state*t})),this.captionAriaId=(0,l.Z)(),this.getImageDimensions=()=>{var e;return null===(e=this.imageBoxRef.current)||void 0===e?void 0:e.getImageDimensions()},this.openMenu=()=>{const{device:e}=this.environment;if(!this.props.disableMediaMenu&&this.canEdit()){const{popupWidth:t,maxHeight:n}=this.props,o=this.props.mediaMenuCurrentTab||"embed",r=(this.props.mediaMenuTabs||[{type:"embed"},{type:"file",fileUpload:!0,imageUpload:e.isAndroid,videoUpload:e.isAndroid}]).map((e=>function(e,t,n,o,i,r){switch(e.type){case"embed":const a=n||te.default.formatMessage(bn.embedButtonText);return{type:"embed",caption:o||te.default.formatMessage(bn.embedCaption),buttonText:a,inputPlaceholder:i||te.default.formatMessage(bn.pastePrompt),onChange:e=>{const n=(0,P.D)(e);M.B(n,"url")?(z.Z(),Mn(n,r,t)):L.showErrorMessage(te.default.formatMessage(bn.validLink))}};case"file":return{type:"file",fileUpload:Boolean(e.fileUpload),imageUpload:Boolean(e.imageUpload),videoUpload:Boolean(e.videoUpload),onUpload:e=>function(e,t,n){const o=xn(t);if(o){const t=Y.qQ(n);j.cT({environment:n,store:o,file:e,pageWidth:t,preferredType:o.getType()})}}(e,r,t)};case"unsplash":return{type:"unsplash",onChange:e=>{let{url:n}=e;z.Z(),Mn(n,r,t)}};case"giphy":return{type:"giphy",onChange:e=>{let{url:n}=e;z.Z(),Mn(n,r,t)}}}}(e,this.environment,this.props.embedButtonText,this.props.mediaMenuEmbedCaption,this.props.urlInputPlaceholder,this.props.store))),a=i.findDOMNode(this);if(a&&a instanceof Element){const e=a.getBoundingClientRect();z.$(this.environment,{originRect:e,originGap:0,isSmallWidth:!1,showArrow:!0,currentTab:o,tabs:r,title:te.default.formatMessage(bn.embedTitle),...t?{popupWidth:t}:{},...n?{maxHeight:n}:{}})}}},this.replace=()=>{this.openMenu();const e=this.props.store.getType();e&&O.Fn(this.environment,{type:"replace",block_type:e,block_id:this.props.store.id})},this.caption=()=>{Rn(this.props.store,this.environment)},this.getFullScreenNodeRect=()=>{const{isFullWidth:e,aspectRatio:t}=this.getDimensions();if(this.embedComp){const n=i.findDOMNode(this.embedComp);if(n&&n instanceof Element){const o=n.getBoundingClientRect();return e&&t?{...E.Go(o),width:o.width,height:o.width*t}:o}}},this.renderFullScreenNode=()=>{const e=Cn(this.props.source,this.props.store),t=Ln(Cn(this.props.source,this.props.store),this.props.mediaType,this.props.store,this.fileUploadStore);if(!e)return;const n=this.getRenderArgs({source:e});return t&&t.renderFullScreen?t.renderFullScreen(n):void 0},this.storeTypes={embedBlockStore:pe,blockResizerStore:se.Z,alignmentPopupStore:le.Z},this.renderAlignmentButtons=()=>(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(Be.Z,{style:{...hn,...this.getAlignmentButtonStyle("left"),borderRight:"none"},hoveredStyle:{...gn,opacity:1},onClick:()=>Un("left",this.environment,this.props.store,this.stores.alignmentPopupStore),children:In("left")}),(0,w.jsx)("span",{style:{borderRight:`1px solid ${D.ZP.whiteWithAlpha(.2)}`}}),(0,w.jsx)(Be.Z,{style:{...hn,...this.getAlignmentButtonStyle("center"),borderRight:"none"},hoveredStyle:{...gn,opacity:1},onClick:()=>Un("center",this.environment,this.props.store,this.stores.alignmentPopupStore),children:In("center")}),(0,w.jsx)("span",{style:{borderRight:`1px solid ${D.ZP.whiteWithAlpha(.2)}`}}),(0,w.jsx)(Be.Z,{style:{...hn,...this.getAlignmentButtonStyle("right"),borderRight:"none"},hoveredStyle:{...gn,opacity:1},onClick:()=>Un("right",this.environment,this.props.store,this.stores.alignmentPopupStore),children:In("right")})]}),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseEnter=e=>{return t=this.stores.embedBlockStore,void(de.Z.state.isDragging||ve.default.state.isActive||t.setState({...t.state,hovered:!0}));var t},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave=e=>{return t=this.stores.embedBlockStore,void(de.Z.state.isDragging||ve.default.state.isActive||t.setState({...t.state,hovered:!1}));var t},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleFocus=e=>function(e,t){const n=e.target;n instanceof HTMLElement&&(0,c.E)(n)&&t.setState({...t.state,focused:!0})}(e,this.stores.embedBlockStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleBlur=e=>{var t;(t=this.stores.embedBlockStore).setState({...t.state,focused:!1})},this.fileUploadStore=this.createComputedStore((()=>fe.default.getKeyState(fe.default.getBlockKey(this.props.store.id)))),this.getResizerValues=e=>{const t=this.props.store.getType();if(t&&(0,m.OY)(t)&&_n.has(t))return{leftSide:!1,rightSide:!1,bottom:!1,rightCorner:!0,leftCorner:!0};const n=this.canEdit(),o=this.isRootOrDirectChild(),{preserveScale:i,isFullWidth:r}=this.getDimensions(),{resizable:a}=e,s=n&&a&&!this.props.disableResizers,l=s&&(!i||r&&o),c=l&&!r;return{leftSide:s&&o,rightSide:s,bottom:l,rightCorner:c,leftCorner:c&&o}}}handleCreated(){this.openMenu()}edit(){this.openMenu()}embed(e){Mn(e,this.props.store,this.environment)}async handleRemoveBlockFromComment(){return!!this.props.onRemoveBlockFromComment&&(await this.props.onRemoveBlockFromComment(this.props.store),!0)}activate(){Ln(Cn(this.props.source,this.props.store),this.props.mediaType,this.props.store,this.fileUploadStore)?Dn(this.props.store,this.props.blockLocation,this.environment):this.replace()}canRenderFullScreen(){const e=Ln(Cn(this.props.source,this.props.store),this.props.mediaType,this.props.store,this.fileUploadStore);return!(!e||!e.renderFullScreen)}renderPersisted(){const e=Cn(this.props.source,this.props.store),t=this.fileUploadStore.state;return t&&t.dataURL?this.renderSource(t.dataURL):e?this.renderSource(e):this.renderPlaceholder()}renderSource(e){const{device:t}=this.environment,{preserveScale:n,isFullWidth:o,dragging:i}=this.getDimensions(),r=Ln(e,this.props.mediaType,this.props.store,this.fileUploadStore);if(r){const{resizable:a}=r,{leftSide:s,rightSide:l,bottom:c,leftCorner:d,rightCorner:u}=this.getResizerValues(r),p=me.default.checkGate("alt_text_image_blocks")&&this.props.store.getPropertyValue("alt_text")&&"image"===this.props.store.getType()&&!On(this.props.store,this.stores.blockResizerStore)&&!j.qC(this.props.blockLocation);return(0,oe.Z)((m=>(0,w.jsxs)(Ee.p,{role:"figure","aria-labelledby":this.captionAriaId,allowSelectionWithin:!0,ref:t=>{if(t){this.attachGhost(t,e);const{width:n}=t.getBoundingClientRect();this.embedContainerWidth.setState(n),this.didHaveNonZeroWidth.update((e=>e||n>0))}},...m,children:[this.didHaveNonZeroWidth?(0,w.jsxs)("div",{style:Pn(r,this.props.blockLocation,o,i),children:[(0,w.jsxs)("div",{className:J.QSt,style:{position:"relative",overflow:a?"hidden":"visible",flexGrow:1},onFocus:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleFocus,onBlur:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleBlur,onMouseLeave:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave,onMouseEnter:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseEnter,children:[this.renderEmbed(e),s&&(0,w.jsx)(Ke,{store:this.props.store,resizerType:De.IS.Horizontal,resizerAlignment:De.bZ.Left,resizeComponent:this,preserveScale:n,isHovered:this.stores.embedBlockStore.state.hovered,blockResizerStore:this.stores.blockResizerStore},"LeftResizer"),l&&(0,w.jsx)(Ke,{store:this.props.store,resizerType:De.IS.Horizontal,resizerAlignment:De.bZ.Right,resizeComponent:this,preserveScale:n,isHovered:this.stores.embedBlockStore.state.hovered,blockResizerStore:this.stores.blockResizerStore},"RightResizer"),u&&(0,w.jsx)(Ke,{store:this.props.store,resizerType:De.IS.Corner,resizerAlignment:De.bZ.Right,resizeComponent:this,preserveScale:n,isHovered:this.stores.embedBlockStore.state.hovered,blockResizerStore:this.stores.blockResizerStore},"RightCornerResizer"),d&&(0,w.jsx)(Ke,{store:this.props.store,resizerType:De.IS.Corner,resizerAlignment:De.bZ.Left,resizeComponent:this,preserveScale:n,isHovered:this.stores.embedBlockStore.state.hovered,blockResizerStore:this.stores.blockResizerStore},"LeftCornerResizer"),c&&(0,w.jsx)(Ke,{store:this.props.store,resizerType:De.IS.Vertical,resizeComponent:this,preserveScale:n,isHovered:this.stores.embedBlockStore.state.hovered,blockResizerStore:this.stores.blockResizerStore},"BottomResizer"),!this.props.disableActions&&this.renderActions(e),this.props.disableActions&&this.props.showExpandButton&&r.renderFullScreen&&(0,w.jsx)(Bn,{store:this.props.store,blockLocation:this.props.blockLocation}),this.props.contentBelowSource,me.default.checkGate("alt_text_image_blocks")&&(0,w.jsx)(Fn,{canEdit:this.props.store.canEdit()&&!this.isStoreNavigableAncestorNonEditableState.state,store:this.props.store,show:Boolean(p)})]}),!o&&!t.isMobile&&(0,w.jsx)(Re.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]}):null,(0,w.jsx)(Ae.Z,{store:this.props.store,captionAriaId:this.captionAriaId,disabled:this.props.disabled})]})))}}renderPlaceholder(){const{device:e}=this.environment,t=!ce.Z.state.online,n=e.isMobile||this.stores.embedBlockStore.state.hovered,o=this.fileUploadStore.state,i=me.default.checkGate("comments_density_image_handling"),r=j.qC(this.props.blockLocation);return(0,w.jsxs)("div",{onMouseEnter:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseEnter,onMouseLeave:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave,style:An(this.props.blockLocation,this.theme,i),children:[(0,w.jsx)(Ye.Z,{style:this.getContentWrapStyle(),disabled:!this.canEdit()||t,iconSvg:void 0!==this.props.iconSvg?this.props.iconSvg:k,shouldHideRight:!n,right:this.canEdit()&&(0,w.jsx)(Tn,{blockLocation:this.props.blockLocation,store:this.props.store,isPlaceholder:!0}),onClick:this.openMenu,isLoading:Boolean(o),progressPercent:o?o.progressPercent:0,file:o?o.file:void 0,name:o?o.name:void 0,size:o?o.size:void 0,isInComment:r,children:this.props.children||(0,w.jsx)(R.FormattedMessage,{defaultMessage:"Embed anything (PDFs, Google Docs, Google Maps, Spotifyâ€¦)",id:"embedBlock.embedAnything.placeholder"})}),(0,w.jsx)(Re.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})}renderEmbed(e){const t=Ln(e,this.props.mediaType,this.props.store,this.fileUploadStore);if(t){const n=this.getRenderArgs({source:e}),o=t.render;return(0,w.jsx)(o,{...n})}}renderActions(e){const{device:t}=this.environment,{blockLocation:n}=this.props,{isFullWidth:o,width:i,isPageWidth:r}=this.getDimensions(),a=this.props.store.canEdit(),s=this.props.store.canComment(),l=this.props.store.isExternalObjectInstanceBlockStore(),c=Ln(e,this.props.mediaType,this.props.store,this.fileUploadStore),d=On(this.props.store,this.stores.blockResizerStore),u=this.fileUploadStore.state,p=this.createComputedStore((()=>he.Z.getStatus(this.props.store.id))),f=this.stores.blockResizerStore.state.dragging,h=j.qC(n),v=!t.isMobile&&!h&&!l,b=i&&!r&&!o&&!t.isPhone&&!h,S=!t.isMobile&&(null==c?void 0:c.renderFullScreen)&&l;if(!(u&&"uploading"!==p.state||f||c&&c.hideActions)){const e=ie.Xp(this.props.store,{recursivelyLoadAllDiscussions:!1});if(this.isStoreNavigableAncestorNonEditableState.state)return(0,w.jsx)("div",{style:Vn(this.environment,this.stores.embedBlockStore),children:(0,w.jsx)(Be.Z,{style:hn,hoveredStyle:gn,onClick:()=>En(this.props.store,this.environment),children:(0,w.jsx)(R.FormattedMessage,{defaultMessage:"View original",id:"embedBlock.viewOriginalLink.button.label"})})});if(d)return(0,w.jsx)("div",{style:Vn(this.environment,this.stores.embedBlockStore),children:(0,w.jsx)(Tn,{blockLocation:this.props.blockLocation,store:this.props.store})});{const n=300,o=Ze.ug.Top;let i;const r=this.props.store.getType();let c;"image"===r&&(c=this.props.store.getOriginalImageSource());const d=me.default.checkGate("image_cropping")&&!t.isMobile&&!h&&"image"===r&&a&&c&&(0,re.f)(c)&&!this.props.store.pathIsDead();return i=(0,m.VB)(r)?(0,w.jsx)(Ze.ZP,{renderTooltip:()=>te.default.formatMessage(bn.actionDownload),placement:o,delayThreshold:n,render:e=>(0,w.jsx)(Be.Z,{...e,ariaLabel:te.default.formatMessage(bn.actionDownload),style:hn,hoveredStyle:gn,onClick:()=>function(e,t){const n=xn(e);if(n){j.TH({environment:t,store:n});const o=n.getType();o&&O.Fn(t,{type:"download",block_type:o,block_id:e.id})}}(this.props.store,this.environment),children:(0,C.a)({width:14,height:14,marginRight:0,fill:D.ZP.white})})}):(0,w.jsx)(Ze.ZP,{renderTooltip:()=>te.default.formatMessage(bn.actionOriginal),placement:o,delayThreshold:n,render:e=>(0,w.jsx)(Be.Z,{...e,ariaLabel:te.default.formatMessage(bn.actionOriginal),style:hn,hoveredStyle:gn,onClick:()=>En(this.props.store,this.environment),children:(0,g.J)({width:14,height:14,marginRight:0,fill:D.ZP.white})})}),(0,w.jsxs)("div",{style:Vn(this.environment,this.stores.embedBlockStore),children:[!h&&!l&&s&&(0,w.jsx)(Ze.ZP,{renderTooltip:()=>te.default.formatMessage(bn.actionComment),placement:o,delayThreshold:n,render:n=>(0,w.jsxs)(Be.Z,{...n,ariaLabel:te.default.formatMessage(bn.actionComment),style:{...hn,...t.isMobile&&{paddingLeft:8,paddingRight:8}},hoveredStyle:gn,onClick:()=>{W.ZH(this.environment),e>0?U.Ib({environment:this.environment,blockStore:this.props.store,analyticsFrom:"embed_menu",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:!1}):G.yw({environment:this.environment,blockStore:this.props.store})},children:[(0,T.z)({width:14,height:14,marginRight:e>0?4:0,fill:D.ZP.white}),e>0&&e]})}),a&&b&&(0,w.jsx)(Ze.ZP,{renderTooltip:()=>te.default.formatMessage(bn.actionAlign),placement:o,delayThreshold:n,render:e=>(0,w.jsx)(Fe.ZP,{popupType:Fe.Z4.Popup,buttonPopupStore:this.stores.alignmentPopupStore,originGap:1,renderOrigin:t=>(0,w.jsxs)(Be.Z,{ariaLabel:te.default.formatMessage(bn.actionAlign),style:hn,hoveredStyle:gn,...(0,ne.Z)(t,e),children:[In(this.getBlockAlignment()),(0,_.i)({width:8,fill:D.ZP.white,marginLeft:4})]}),borderRadius:6,render:this.renderAlignmentButtons,popupWrapStyle:{background:kn(this.environment),display:"flex"}})}),a&&v&&(0,w.jsx)(Ze.ZP,{renderTooltip:()=>te.default.formatMessage(bn.actionCaption),placement:o,delayThreshold:n,render:e=>(0,w.jsx)(Be.Z,{...e,ariaLabel:te.default.formatMessage(bn.actionCaption),style:hn,hoveredStyle:gn,onClick:()=>Rn(this.props.store,this.environment),children:(0,y.o)({width:14,height:14,marginRight:0,fill:D.ZP.white})})}),d&&(0,w.jsx)(Ze.ZP,{renderTooltip:()=>te.default.formatMessage(bn.actionEditImage),placement:o,render:e=>(0,w.jsx)(Be.Z,{...e,ariaLabel:te.default.formatMessage(bn.actionEditImage),style:hn,hoveredStyle:gn,onClick:()=>{c&&(q.DQ(this.environment,[this.props.store.id]),ge.Z.openModal({blockStore:this.props.store,originalSource:c}),Z.Z(this.environment,{from:"tooltip"}))},children:(0,I.J)({width:14,height:14,marginRight:0,fill:D.ZP.white})})}),S&&(0,w.jsx)(Ze.ZP,{renderTooltip:()=>te.default.formatMessage(bn.actionExpand),placement:o,delayThreshold:n,render:e=>(0,w.jsx)(Be.Z,{...e,ariaLabel:te.default.formatMessage(bn.actionExpand),style:hn,hoveredStyle:gn,onClick:()=>Dn(this.props.store,this.props.blockLocation,this.environment),children:(0,x.s)({width:14,height:14,marginRight:0,fill:D.ZP.white})})}),!t.isMobile&&i,(0,w.jsx)(Tn,{blockLocation:this.props.blockLocation,store:this.props.store})]})}}}attachGhost(e,t){const n=Ln(t,this.props.mediaType,this.props.store,this.fileUploadStore);e&&n&&n.embedGhost&&this.mutateDOM((()=>e.setAttribute("embed-ghost","")))}getDimensions(){const{block_height:e,block_width:t,block_preserve_scale:n,block_full_width:o,block_page_width:i,block_aspect_ratio:r}=this.props.store.getFormat(),{dragging:a,temporaryHeight:s,temporaryWidth:l,temporaryFullWidth:c,temporaryPageWidth:d}=this.stores.blockResizerStore.state,u=a?l:t??this.embedContainerWidth.state,p=a?s:e,m=Boolean(a?c:o),g=Boolean(a?d:i),h=Boolean(this.props.preserveScale||n);return{blockWidth:t,blockHeight:e,width:u,height:this.props.store.isExternalObjectInstanceBlockStore()&&"image"!==this.props.mediaType?p||f.QA:p,dragging:a,preserveScale:h,isFullWidth:m,isPageWidth:g,aspectRatio:r}}static getEmbedSourceFromBlockStore(e){const t=e.getProperties(),n=null==t?void 0:t.source,o=A.QaF(n),{display_source:i}=e.getFormat();return(0,f.Z8)(i||o)}getRenderArgs(e){const{source:t}=e,n=this.props.store.getProperties(),o=A.Jcv(n&&n.title),i=A.Jcv(n&&n.size),r=this.fileUploadStore.state,{blockWidth:a,blockHeight:s,width:l,height:c,dragging:d,preserveScale:u,isFullWidth:p,isPageWidth:m,aspectRatio:f}=this.getDimensions(),g=this.isRootOrDirectChild(),{device:h}=this.environment,v=this.embedContainerWidth.state&&this.embedContainerHeight.state?{width:this.embedContainerWidth.state,height:this.embedContainerHeight.state}:void 0;return{store:this.props.store,source:t,blockWidth:a,blockHeight:s,aspectRatio:f,width:l,height:c,dragging:d,preserveScale:u,isFullWidth:p,isPageWidth:m,isRootChild:g,dataURL:r?r.dataURL:void 0,dataName:o,dataSize:i,disabled:!this.canEdit(),contentStyle:Zn(this.stores.blockResizerStore),contentWrapStyle:this.getContentWrapStyle(),isLoading:Boolean(r),progressPercent:r?r.progressPercent:0,handleFullScreen:()=>Dn(this.props.store,this.props.blockLocation,this.environment),handleEmbedComp:e=>this.embedComp=e,viewOriginal:()=>En(this.props.store,this.environment),inlineContentStyle:this.props.inlineContentStyle,blockLocation:this.props.blockLocation,mediaType:this.props.mediaType,imageBoxRef:this.imageBoxRef,useS3Url:h.isIOS&&h.isMobileNative,embedContainerDimensions:v}}static hasRendererForStore(e){return r.Z.withListenerIgnored((()=>Boolean(Sn.getRenderer(Sn.getEmbedSourceFromBlockStore(e),void 0,e.getType()))))}static getRenderer(e,t,n){if(t)return yn.image;if(e){if(e.startsWith("data:")||e.startsWith("<img"))return;const t=(0,f.Dz)({url:e,baseUrl:$.default.domainBaseUrl,publicDomainName:$.default.publicDomainName,preferredType:n});if("embed"!==t)return yn[t]}return n&&e?yn[n]:At}getContentWrapStyle(){const e={position:"relative"};return this.canEdit()&&(e.cursor="pointer"),this.props.centerWrappedContent&&(e.display="flex",e.justifyContent="center",e.alignItems="center",e.minHeight=220),e}getBlockAlignment(){const{block_alignment:e}=this.props.store.getFormat(),t=this.isRootOrDirectChild();return e||(t?"center":"left")}getAlignmentButtonStyle(e){let t=.6;return this.getBlockAlignment()===e&&(t=1),{width:26,height:26,opacity:t}}}const wn=Sn;function kn(e){const{device:t}=e;return t.isMobile?D.ZP.blackWithAlpha(.3):D.ZP.blackWithAlpha(.6)}function In(e){const t={left:v.$,center:h.L,right:b.g},n={width:14,height:14,marginRight:0,fill:D.ZP.white};return t[e](n)}function Cn(e,t){return e||Sn.getEmbedSourceFromBlockStore(t)}function xn(e){if("external_object_instance"!==e.getType()||(0,ee.Xg)())return e}function Tn(e){let{isPlaceholder:t,blockLocation:n,store:o}=e;const i=j.qC(n),r=i?"comment_media":"default";return(0,w.jsx)(Pe.Z,{store:o,fadeIn:!1,iconStyle:t?void 0:{fill:D.ZP.white},actionSectionGroupKey:r,hideFilterActionsInput:i,hoveredStyle:gn,tooltipContent:te.default.formatMessage(bn.actionMore)})}function Mn(e,t,n){const o=xn(t);if(!o)return;const i=Y.qQ(n);V.bO(n,{pastedText:e,source:"embed_block_menu"});const r=ae.default.mark("embed_render_complete");j.I(n,{source:e,isDataURL:!1,store:o,pageWidth:i,preferredType:t.getType(),metric:r})}function Pn(e,t,n,o){const i={display:"flex"};return j.qC(t)&&(i.display="inline-flex",i.maxHeight=240),"audio"===e.rendererType&&(i.display="flex"),"image"===e.rendererType&&(n||o||(i.width="fit-content")),i}function An(e,t,n){const o={display:"flex"};return j.qC(e)&&(o.borderWidth=1,o.borderColor=t.regularDividerColor,o.marginBottom=10,o.borderRadius=3,n&&(o.marginBottom=0,o.width=214,o.color=t.text.secondary)),o}function Rn(e,t){const n=e.getPropertyStore("caption");W.eP({environment:t,store:e}),H.NX({store:n});const o=e.getType();o&&O.Fn(t,{type:"caption",block_type:o,block_id:e.id})}function Dn(e,t,n){q.dK({blocks:[e],blockLocationOfTargetBlock:t});const o=e.getType();o&&O.Fn(n,{type:"full_screen",block_type:o,block_id:e.id})}function En(e,t){const n=xn(e);if(n){j.qL(t,{store:n,from:"view_original"});const o=n.getType();o&&O.Fn(t,{type:"original",block_type:o,block_id:e.id})}}function Bn(e){let{store:t,blockLocation:n}=e;const o=(0,u.Fg)(),i=(0,s.O7)();return(0,w.jsx)(Oe.Z,{style:{position:"absolute",right:12,top:12,background:o.buttonBackground},icon:e=>(0,x.s)({...e,width:16,height:16}),hoveredStyle:{background:o.buttonHoveredBackground},pressedStyle:{background:o.buttonPressedBackground},onClick:()=>Dn(t,n,i),children:(0,w.jsx)(R.FormattedMessage,{id:"embedBlock.expandFullScreen.button.label",defaultMessage:"Expand"})})}function Fn(e){let{store:t,canEdit:n,show:o}=e;const i=(0,s.O7)(),{device:r}=i,a=(0,u.yK)((e=>({buttonWrapper:{position:"absolute",bottom:"8px",right:"8px",background:kn(i),borderRadius:4,opacity:o?1:0,transition:r.isSafari?void 0:vn,overflow:"hidden"},button:{padding:"4px 6px",fontSize:12,fontWeight:B.Z.fontWeight.medium,letterSpacing:.2,color:"white"},tooltipText:{overflow:"hidden",textOverflow:"ellipsis"},tooltipSecondaryText:{color:e.mediumInvertedTextColor}})),[i,o,r.isSafari]),{altText:l,isTruncated:c}=(0,d.VK)((()=>{const e=(0,X.Xh)(t.getPropertyValue("alt_text"),t);return{altText:e,isTruncated:e.length>100}}),[t]);return(0,w.jsx)("div",{style:a.buttonWrapper,children:(0,w.jsx)(Ze.ZP,{renderTooltip:()=>(0,w.jsxs)("div",{children:[(0,w.jsx)("div",{style:a.tooltipText,children:c?`${l.slice(0,100)}...`:l}),(0,w.jsx)("div",{style:a.tooltipSecondaryText,children:te.default.formatMessage(n?bn.actionEditAltText:bn.actionViewAltText)})]}),placement:Ze.ug.Bottom,disableTooltip:!o,render:e=>(0,w.jsx)(Be.Z,{className:"altTextBlockButton",...e,ariaLabel:te.default.formatMessage(n?bn.actionEditAltText:bn.actionViewAltText),style:a.button,hoveredStyle:gn,disabled:!o,onClick:()=>{F.b({blockStore:t,entrypoint:"block_button",environment:i})},children:"ALT"})})})}function On(e,t){const{block_width:n}=e.getFormat(),{temporaryWidth:o}=t.state;return void 0!==o?o<=230:void 0!==n&&n<=230}function Zn(e){const{dragging:t}=e.state;return{display:"block",pointerEvents:t?"none":"auto",width:"100%"}}function Vn(e,t){const{device:n}=e,{focused:o,hovered:i}=t.state,{isMobile:r}=n;return{position:"absolute",top:4,right:4,borderRadius:4,color:D.ZP.white,fill:D.ZP.white,fontSize:11.5,background:kn(e),display:"flex",whiteSpace:"nowrap",height:26,maxWidth:"calc(100% - 16px)",overflow:"hidden",pointerEvents:o||i||r?"auto":"none",opacity:o||i||r?1:0,transition:n.isSafari?void 0:vn,fontFamily:B.Z.getCompositeFontFamily(a.SP).sans,zIndex:2}}function Un(e,t,n,o){const i=xn(n);o.reset(),i&&K.createAndCommit({userAction:"EmbedBlock.handleAlignment",environment:t,perform:n=>{N.hc({environment:t,store:i,alignment:e,transaction:n})}});const r=n.getType(),a=n.getFormat(),s=a.block_alignment,l=a.block_width,c=a.block_height,d=n.isRootOrDirectChild()?"center":"left";r&&O.Fn(t,{type:"alignment",block_type:r,block_id:n.id,block_alignment:e,block_height:c,block_width:l,previous_alignment:s,default_alignment:d}),W.Jy()}function Ln(e,t,n,o){var i,r;return Sn.getRenderer(e,null===(i=o.state)||void 0===i?void 0:i.dataURL,t??(null===(r=xn(n))||void 0===r?void 0:r.getType()))}},24047:(e,t,n)=>{n.d(t,{ZP:()=>P,cT:()=>I,K9:()=>C});var o=n(67294),i=n(480),r=n(24405),a=n(43593),s=n(80750),l=n(45238),c=n(85893);const d=(0,l.IU)("imageError",{viewBox:"0 0 32 32",svg:(0,c.jsxs)(o.Fragment,{children:[(0,c.jsx)("path",{d:"M6.39515 31.0485c3.44161 0 6.29115-2.8495 6.29115-6.2911 0-3.4355-2.8557-6.2912-6.29732-6.2912-3.43544 0-6.28495 2.8557-6.28495 6.2912 0 3.4416 2.85568 6.2911 6.29112 6.2911zm-.00617-5.366c-.32689 0-.50575-.1912-.51809-.5181l-.08635-3.0468c-.01233-.3393.24671-.5798.59828-.5798.34539 0 .61677.2467.60444.5859l-.09252 3.0407c-.01233.3331-.1912.5181-.50576.5181zm0 2.2698c-.35773 0-.69078-.2838-.69078-.6662s.32689-.6661.69078-.6661c.3639 0 .69079.2776.69079.6661 0 .3886-.33305.6662-.69079.6662z"}),(0,c.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 17.5539V3h26v26H12.6862c.4113-.6095.7364-1.282.9578-2H28v-4H13.7749c-.1687-.7106-.4373-1.3825-.7902-2H28V5H6v12.1798c-.69548.0352-1.36626.164-2 .3741zM11.3329 19c-.6875-.5905-1.48192-1.0601-2.35027-1.3757L13 12l2 1 5-5 6 11H11.3329zM12 9c0 1.104-.896 2-2 2s-2-.896-2-2 .896-2 2-2 2 .896 2 2zm3.395 6.434l-1.76-.881L11.887 17h10.744l-3.107-5.695-4.129 4.129z"})]})}),u=(0,l.IU)("lockedDocument",{viewBox:"0 0 27 33",svg:(0,c.jsx)("path",{d:"M9.281 26.605c0 .878.406 1.318 1.216 1.318h6.02c.811 0 1.216-.44 1.216-1.318V21.99c0-.79-.327-1.216-.981-1.274v-1.348c0-1.084-.298-1.958-.894-2.622-.595-.664-1.377-.996-2.343-.996-.967 0-1.748.332-2.344.996-.596.664-.894 1.538-.894 2.622v1.348c-.664.058-.996.483-.996 1.274v4.615zm2.359-5.919v-1.45c0-.654.17-1.176.512-1.567.342-.4.796-.6 1.363-.6.566 0 1.015.2 1.347.6.342.39.513.913.513 1.567v1.45H11.64zM5.692 32.288h15.601c1.572 0 2.759-.41 3.56-1.23.8-.81 1.2-2.002 1.2-3.575V14.197c0-.683-.038-1.26-.117-1.728a3.829 3.829 0 00-.454-1.304c-.214-.4-.537-.815-.966-1.245L16.84 2.112c-.41-.42-.81-.737-1.201-.952a3.822 3.822 0 00-1.275-.454 8.661 8.661 0 00-1.611-.132h-7.06c-1.573 0-2.76.41-3.56 1.23C1.332 2.616.932 3.808.932 5.38v22.104c0 1.582.4 2.779 1.2 3.59.802.81 1.988 1.215 3.56 1.215zm.235-2.886c-.703 0-1.23-.18-1.582-.542-.352-.361-.528-.879-.528-1.552V5.569c0-.673.176-1.196.528-1.567.351-.371.884-.557 1.596-.557h6.24v8.028c0 1.045.255 1.826.762 2.343.518.518 1.3.777 2.344.777h7.896v12.715c0 .673-.176 1.191-.528 1.552-.351.362-.884.542-1.596.542H5.927zm9.638-17.343c-.302 0-.522-.069-.659-.205-.127-.137-.19-.357-.19-.66V3.841l8.071 8.218h-7.222z"})}),p=(0,l.IU)("playbackError",{viewBox:"0 0 32 32",svg:(0,c.jsxs)(o.Fragment,{children:[(0,c.jsx)("path",{d:"M6.39515 29.0485c3.44161 0 6.29115-2.8495 6.29115-6.2911 0-3.4355-2.8557-6.2912-6.29732-6.2912-3.43544 0-6.28495 2.8557-6.28495 6.2912 0 3.4416 2.85568 6.2911 6.29112 6.2911zm-.00617-5.366c-.32689 0-.50575-.1912-.51809-.5181l-.08635-3.0468c-.01233-.3393.24671-.5798.59828-.5798.34539 0 .61677.2467.60444.5859l-.09252 3.0407c-.01233.3331-.1912.5181-.50576.5181zm0 2.2698c-.35773 0-.69078-.2838-.69078-.6662s.32689-.6661.69078-.6661c.3639 0 .69079.2776.69079.6661 0 .3886-.33306.6662-.69079.6662z"}),(0,c.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M29.1373 16.1987c0 6.7017-5.542 12.2437-12.2436 12.2437-1.622 0-3.1761-.3246-4.6001-.9118.3323-.4107.6226-.8567.8644-1.3316 1.1612.4325 2.4197.6687 3.7357.6687 5.9082 0 10.6689-4.7608 10.6689-10.669-.0122-5.9082-4.7729-10.65671-10.6812-10.65671-5.5497 0-10.08288 4.20726-10.5961 9.62871-.55173.0075-1.08925.0738-1.60656.193.4362-6.32082 5.78156-11.40862 12.20266-11.40862 6.7139 0 12.2559 5.54199 12.2559 12.24362zm-15.4585 4.4372a7.628 7.628 0 00-.0797-.2566.65573.65573 0 01-.0013-.0424v-8.2764c0-.5004.5859-.7202 1.0498-.4516l6.7016 4.0161c.4395.2686.4517.8911 0 1.1597l-6.7016 3.9917c-.3763.2257-.796.1398-.9688-.1405z"})]})});var m=n(9291),f=n(1898),g=n(18265),h=n(88864),v=n(25888),b=n(95477),y=n(79947),_=n(18514),S=n(16354),w=n(64369);function k(e,t){switch(e){case"image":return d;case"pdf":return"document_locked"===t?u:s.l;case"audio":case"video":return p;default:return s.l}}function I(e,t){if(e&&e instanceof y.Gg){let n=t||e.data.url;return g.j3(n)&&(n=g.O_({relativeUrl:n,baseUrl:b.default.domainBaseUrl})),e.data.offline?g.j3(e.data.url)||e.data.url.startsWith(b.default.domainBaseUrl)?{type:"offline"}:{type:"unknown",source:n}:{type:"http",source:n,statusCode:e.data.status}}}function C(e,t){const n=e.error,o=t||e.src;if(n)return n.code===n.MEDIA_ERR_DECODE||n.code===n.MEDIA_ERR_SRC_NOT_SUPPORTED?{type:"unsupported_content_type",extension:o&&(0,a.mD)(o)}:n.code===n.MEDIA_ERR_NETWORK?{type:"offline"}:void 0}function x(){return(0,c.jsx)(m.FormattedMessage,{id:"embedError.extension.unknown",defaultMessage:"unknown"})}function T(e){const{source:t,statusCode:n}=e,o=g.Qc(t).hostname;return(0,c.jsx)(m.FormattedMessage,{defaultMessage:"{hostname} (Error {statusCode})",id:"embedError.hostnameAndStatusCode",values:{hostname:o,statusCode:n}})}function M(e){switch(e){case"audio":return(0,_.UY)("guides.audioFaqs");case"video":return(0,_.UY)("guides.videosFaqs");case"image":return(0,_.UY)("guides.imagesFaqs");default:return(0,_.UY)("guides.embedsFaqs")}}const P=function(e){let{style:t,error:n,family:a,isSmall:s,onClickLink:l}=e;const d=(0,r.Fg)(),u=(0,i.O7)(),p={background:d.embedPlaceholderBackground,cursor:"default",...t||{},position:"absolute",top:0,bottom:0,left:0,right:0,display:"flex",alignContent:"center",alignItems:"center",justifyContent:s?"flex-start":"center",padding:s?"7px 14px":"0.5em 1em",textAlign:"center",flexDirection:s?"row":"column",overflow:"hidden"},b=s?25:48,y=s?"0px 14px 0 0":"0 0 14px 0",_=function(e,t){return"image"===t?"unsupported_content_type"===e.type?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This image format ({extension}) can't be played on this device.",id:"embedError.image.unsupportedContentType",values:{extension:e.extension||x()}}):"offline"===e.type?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"Go online to view this image",id:"embedError.image.offline"}):"unknown"===e.type||"invalid_protocol"===e.type||"invalid_url"===e.type||"document_locked"===e.type?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This image couldn't be loaded.",id:"embedError.image.unknown"}):404===e.statusCode?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This image couldn't be found.",id:"embedError.image.notFound"}):401===e.statusCode||403===e.statusCode?(0,c.jsx)(m.FormattedMessage,{id:"embedError.image.permissionDenied",defaultMessage:"Permission denied."}):(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This image couldn't be loaded.",id:"embedError.image.serverError"}):"audio"===t?"unsupported_content_type"===e.type?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This audio format ({extension}) can't be played on this device.",id:"embedError.audio.unsupportedContentType",values:{extension:e.extension||x()}}):"offline"===e.type?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"Go online to view this audio",id:"embedError.audio.offline"}):"unknown"===e.type||"invalid_protocol"===e.type||"invalid_url"===e.type||"document_locked"===e.type?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This audio couldn't be loaded.",id:"embedError.audio.unknown"}):404===e.statusCode?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This audio couldn't be found.",id:"embedError.audio.notFound"}):401===e.statusCode||403===e.statusCode?(0,c.jsx)(m.FormattedMessage,{id:"embedError.audio.permissionDenied",defaultMessage:"Permission denied."}):(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This audio couldn't be loaded.",id:"embedError.audio.serverError"}):"video"===t?"unsupported_content_type"===e.type?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This video format ({extension}) can't be played on this device.",id:"embedError.video.unsupportedContentType",values:{extension:e.extension||x()}}):"offline"===e.type?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"Go online to view this video",id:"embedError.video.offline"}):"unknown"===e.type||"invalid_protocol"===e.type||"invalid_url"===e.type||"document_locked"===e.type?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This video couldn't be loaded.",id:"embedError.video.unknown"}):404===e.statusCode?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This video couldn't be found.",id:"embedError.video.notFound"}):401===e.statusCode||403===e.statusCode?(0,c.jsx)(m.FormattedMessage,{id:"embedError.video.permissionDenied",defaultMessage:"Permission denied."}):(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This video couldn't be loaded.",id:"embedError.video.serverError"}):"file"===t?"unsupported_content_type"===e.type?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This file format ({extension}) can't be played on this device.",id:"embedError.file.unsupportedContentType",values:{extension:e.extension||x()}}):"offline"===e.type?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"Go online to view this file",id:"embedError.file.offline"}):"unknown"===e.type||"invalid_protocol"===e.type||"invalid_url"===e.type||"document_locked"===e.type?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This file couldn't be loaded.",id:"embedError.file.unknown"}):404===e.statusCode?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This file couldn't be found.",id:"embedError.file.notFound"}):401===e.statusCode||403===e.statusCode?(0,c.jsx)(m.FormattedMessage,{id:"embedError.file.permissionDenied",defaultMessage:"Permission denied."}):(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This file couldn't be loaded.",id:"embedError.file.serverError"}):"embed"===t?"unsupported_content_type"===e.type?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This embed format ({extension}) can't be played on this device.",id:"embedError.embed.unsupportedContentType",values:{extension:e.extension||x()}}):"offline"===e.type?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"Go online to view this embed",id:"embedError.embed.offline"}):"unknown"===e.type||"invalid_protocol"===e.type||"invalid_url"===e.type||"document_locked"===e.type?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This embed couldn't be loaded.",id:"embedError.embed.unknown"}):404===e.statusCode?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This embed couldn't be found.",id:"embedError.embed.notFound"}):401===e.statusCode||403===e.statusCode?(0,c.jsx)(m.FormattedMessage,{id:"embedError.embed.permissionDenied",defaultMessage:"Permission denied."}):(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This embed couldn't be loaded.",id:"embedError.embed.serverError"}):"pdf"===t?"document_locked"===e.type?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This PDF is locked",id:"embedError.pdf.locked"}):(0,c.jsx)(m.FormattedMessage,{defaultMessage:"This embed couldn't be loaded.",id:"embedError.embed.unknown"}):void(0,f.t1)(t)}(n,a);return(0,o.useEffect)((()=>{h.QU(u,{embedType:a,embedErrorType:n.type})}),[u,n.type,a]),(0,c.jsxs)("div",{style:p,children:[k(a,n.type)({fill:d.lightTextColor,width:b,height:b,margin:y}),(0,c.jsxs)(w.Z,{isSecondaryColor:!0,isMultiline:!s,style:{margin:y},children:[(0,c.jsx)("div",{style:{display:s?"inline-block":"block",marginRight:s?"14px":void 0},children:_}),"offline"!==n.type&&(0,c.jsx)(S.Z,{style:{display:"inline",pointerEvents:"auto",cursor:"auto",borderBottom:`1px solid ${d.lightTextColor}`},href:"document_locked"===n.type?void 0:M(a),external:!0,onClick:()=>{v.Fs(u,{from:"embed_error"}),null==l||l()},children:"document_locked"===n.type?(0,c.jsx)(m.FormattedMessage,{defaultMessage:"Unlock Document",id:"embedError.unlock"}):(0,c.jsx)(m.FormattedMessage,{defaultMessage:"Learn more",id:"embedError.learnMore"})})]}),!s&&"http"===n.type&&(0,c.jsx)(w.Z,{isSmall:!0,isSecondaryColor:!0,children:T(n)}),!s&&"unknown"===n.type&&n.source&&(0,c.jsx)(w.Z,{isSmall:!0,isSecondaryColor:!0,children:g.Qc(n.source).hostname})]})}},86329:(e,t,n)=>{n.d(t,{Z:()=>g});n(67294);var o=n(86628),i=n(24405),r=n(37810),a=n(33767),s=n(77907),l=n(77080),c=n(68709),d=n(64921),u=n(68785),p=n(32854),m=n(40148),f=n(85893);const g=function(e){let{isLoading:t,file:n,name:r,size:a,progressPercent:s,style:u,iconSvg:p,onClick:g,disabled:b,right:y,shouldHideRight:_,isInComment:S,children:w}=e;const k=(0,i.Fg)(),I=(0,o.VK)((()=>l.default.checkGate("comments_density_image_handling")),[])&&S;return t?(0,f.jsx)(h,{file:n,name:r,size:a,progressPercent:s,style:u,iconSvg:p,isInComment:S}):(0,f.jsx)(c.p,{allowSelectionWithin:!1,style:{...v(k),...I?{background:k.surface.wash,borderRadius:12,overflow:"hidden"}:{}},children:(0,f.jsx)(d.Z,{onClick:g,disabled:b,hoveredStyle:I?{background:k.surface.wash}:{},children:(0,f.jsx)(m.ZP,{style:{background:void 0,...u},iconSvg:p,right:y,shouldHideRight:_,isInComment:S,children:w})})})};function h(e){let{file:t,name:n,size:c,progressPercent:d,style:g,iconSvg:h,isInComment:v}=e;const b=(0,i.Fg)(),y=(0,o.VK)((()=>l.default.checkGate("comments_density_image_handling")),[])&&v,{value:_}=(0,s.useDependency)(a.Av);let S;if(t){if(!_)return null;const e=_.discussionHelpers.formatFileSize(c);S=(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{style:y?{fontWeight:r.Z.fontWeight.medium,color:b.text.primary,fontSize:14,lineHeight:"18px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}:{},children:n}),(0,f.jsx)("div",{style:y?{fontSize:12,lineHeight:"15px"}:m.Lw,children:(0,f.jsxs)("div",{style:{display:"flex",alignItems:"center",...y?{gap:4}:{}},children:[(0,f.jsx)("div",{style:y?{color:b.text.secondary}:{},children:e}),(0,f.jsx)("div",{style:y?{color:b.text.tertiary}:{marginLeft:3},children:y?"â€”":" â€“ "}),(0,f.jsx)(u.Z,{style:y?{}:{marginLeft:3,marginRight:3}}),(0,f.jsx)(p.Z,{style:y?{color:b.text.tertiary}:{},percentage:d})]})})]},"FileLoadingSpinner")}else S=(0,f.jsx)("div",{children:(0,f.jsx)(u.Z,{style:{marginLeft:3,marginRight:3}})},"LoadingSpinner");return(0,f.jsx)(m.ZP,{style:{...g,...y?{borderRadius:12,background:b.surface.wash}:{}},iconSvg:h,isInComment:v,children:S})}function v(e){return{background:e.embedPlaceholderBackground,width:"100%",borderRadius:4}}},3702:(e,t,n)=>{n.d(t,{Z:()=>T});var o=n(67294),i=n(13991),r=n(480),a=n(24405),s=n(75e3),l=n(20852),c=n(70203),d=n(9291),u=n(31701),p=n(53965),m=n(37810),f=n(25888),g=n(83631),h=n(18514),v=n(69015),b=n(36488),y=n(16354),_=n(53437),S=n(58297),w=n(22492),k=n(85893);const I={mobilePreview:{padding:"4px 8px",height:80,display:"flex",alignItems:"center",justifyContent:"center"},mobilePreviewValue:{overflow:"auto"},submitButton:{alignSelf:"flex-start"},enterIcon:{height:14,width:14,fill:"currentColor",marginLeft:6,marginTop:2},errorContainer:{color:u.ZP.redWithAlpha(.8),fontSize:12,padding:"8px 10px"}},C=o.forwardRef((function(e,t){const n=(0,o.useRef)(null),i=(0,r.O7)(),{isOpen:s,onDismiss:l,origin:d,originRect:u,originGap:p,popupStyle:m}=e,f=P(i),g=(0,a.yK)((e=>({inputWrapper:{display:"flex",alignItems:"center",padding:"8px 10px",width:"100%",background:e.inputBackground},popup:{width:400,display:"flex",flexDirection:"column"}})),[]);(0,o.useEffect)((()=>{i.KatexStore.loadIfNeeded((()=>[(0,c.qZ6)("")]))}),[i.KatexStore]),(0,o.useImperativeHandle)(t,(()=>({getSelection:()=>{if(!n)return;if(!n.current)return;const e=n.current.getSelection();return"contain"===(null==e?void 0:e.type)?e.selection:void 0}})),[]);const h=(0,k.jsxs)("div",{style:g.inputWrapper,children:[(0,k.jsx)(x,{ref:n,...e}),(0,k.jsx)(R,{error:e.error,disabled:e.disabled,isOpen:e.isOpen,onSubmit:e.onSubmit,onDismiss:e.onDismiss})]});return(0,k.jsx)(_.ZP,{popupType:f,open:s,origin:d,originRect:u,originGap:p,keepFocus:f===_.ZP.PopupType.SlideUp,onDismiss:l,style:{...g.popup,...m},render:()=>(0,k.jsx)(b.Z,{capture:s,allowEsc:!0,render:()=>P(i)===_.ZP.PopupType.SlideUp?(0,k.jsxs)(o.Fragment,{children:[(0,k.jsx)(E,{equationValue:e.equationValue,error:e.error,displayMode:e.displayMode,isOpen:e.isOpen}),h]}):(0,k.jsxs)(o.Fragment,{children:[h,(0,k.jsx)(D,{isOpen:e.isOpen,error:e.error})]})})})})),x=o.forwardRef((function(e,t){const{disabled:n,isOpen:o,equationValue:s,onLeft:c,onRight:d,onDismiss:u,displayMode:f}=e,h=(0,r.O7)(),b=P(h)===_.ZP.PopupType.SlideUp,y=!n&&!b,S=b?{type:v.b.Textarea}:{type:v.b.InlineWrap,onSubmit:t=>A(t,e.isOpen,e.disabled,e.error,e.onSubmit,e.onDismiss)},w=(0,a.yK)((e=>({base:{fontFamily:m.Z.getCompositeFontFamily(i.SP).mono,fontSize:14,marginRight:8,flex:1,wordBreak:"break-word",maxHeight:"50vh",overflow:"auto",..."block"===f&&{minHeight:60},...b&&{height:100}},placeHolder:{color:e.lightTextColor}})),[f,b]);return(0,k.jsx)(v.Z,{ref:t,...S,disabled:n,focus:o,selectAll:y,value:s||"",placeholder:M(e.displayMode),getHtml:t=>function(e,t){return t.highlight(p.AK(e),t.languages[l.PrismLanguages.latex],l.PrismLanguages.latex)}(t,e.Prism),onChange:t=>function(e,t,n,o,i){if(!t)return;n(e,g.by({environment:i,equation:e,displayMode:o}))}(t,e.isOpen,e.onChange,e.displayMode,h),onCancel:u,onLeft:c,onRight:d,placeholderStyle:{...w.base,...w.placeHolder},style:w.base,autoCorrect:"off",autoCapitalize:"off"})})),T=C;function M(e){return"block"===e?"|x| = \\begin{cases}Â Â Â Â Â Â Â Â Â Â Â Â Â \nÂ Â x, &\\quad x \\geq 0 \\\\Â Â Â Â Â Â Â Â Â Â Â \nÂ -x, &\\quad x < 0Â Â Â Â Â Â Â Â Â Â Â Â Â \n\\end{cases}":"E = mc^2"}function P(e){const{device:t}=e,n=t.isPhone&&t.isIOS&&t.isMobileBrowser;return t.isPhone&&!n?_.ZP.PopupType.SlideUp:_.ZP.PopupType.Popup}function A(e,t,n,o,i,r){e.preventDefault&&e.preventDefault(),n||t&&(o||(i(),r()))}function R(e){let{error:t,disabled:n,isOpen:o,onSubmit:i,onDismiss:r}=e;return n?null:(0,k.jsxs)(S.Z,{onClick:e=>A(e,o,n,t,i,r),disabled:n||Boolean(t),style:I.submitButton,children:[(0,k.jsx)(d.FormattedMessage,{defaultMessage:"Done",id:"equationInput.submitButton.label"}),(0,s.U)(I.enterIcon)]})}function D(e){let{isOpen:t,error:n}=e;const o=(0,r.O7)(),i=P(o)===_.ZP.PopupType.Popup,s=(0,a.yK)((e=>({container:{color:u.ZP.redWithAlpha(.8),fontSize:12,padding:"8px 10px",...i&&{boxShadow:`0 -1px ${e.lightDividerColor}`}},label:{fontWeight:600},learnMoreLink:{display:"inline",textDecoration:"underline"}})),[i]);if(!t)return null;if(!n)return null;const l=n.message.replace("KaTeX parse error: ","");return(0,k.jsxs)("div",{role:"alert",style:s.container,children:[(0,k.jsx)("span",{style:s.label,children:(0,k.jsx)(d.FormattedMessage,{defaultMessage:"Invalid equation:",id:"equationInput.inputError.label"})})," ",l,". ",(0,k.jsx)(y.Z,{href:(0,h.UY)("guides.equations"),external:!0,onClick:()=>{f.Fs(o,{from:"equation_input"})},style:s.learnMoreLink,children:(0,k.jsx)(d.FormattedMessage,{defaultMessage:"Learn more",id:"equationInput.inputError.learnMore"})})]})}function E(e){let{equationValue:t,error:n,displayMode:o,isOpen:i}=e;const r=(0,a.Fg)();return t?(0,k.jsx)("div",{style:I.mobilePreview,children:n?(0,k.jsx)(D,{isOpen:i,error:n}):"block"===o?(0,k.jsx)(w.Z,{display:o,equation:t,style:I.mobilePreviewValue,theme:r}):(0,k.jsx)(w.Z,{display:o,equation:t,style:I.mobilePreviewValue,theme:r,index:0,isTemporary:!1})}):null}},22492:(e,t,n)=>{n.d(t,{Z:()=>c});var o=n(67294),i=n(98923),r=n(9291),a=n(83631),s=n(77907),l=n(85893);function c(e){(0,o.useEffect)((()=>{a.bc()}),[]);const t=(0,r.useIntl)();return(0,l.jsx)(s.DependencyConsumer,{dependency:s.deps.katex,children:n=>(0,l.jsx)(i.MW,{intl:t,katex:n,...e})})}},42782:(e,t,n)=>{n.d(t,{Z:()=>v});var o=n(67294),i=n(73935),r=n(480),a=n(98742),s=n(3386),l=n(53437);const c=function(){const[e,t]=o.useState({x:0,y:0});return o.useEffect((()=>{const e=e=>{t({x:e.clientX,y:e.clientY})};return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}}),[]),e};var d=n(85893);function u(e){let{x:t,mouseX:n}=e;return n>t?void 0:-Math.max(t-n,10)+"px"}function p(e){let{x:t,width:n,mouseX:o}=e;return o>t?-Math.max(o-(t+n),10)+"px":void 0}function m(e){let{x:t,width:n,mouseX:o}=e;return o>t?`${Math.max(o-(t+n),10)}px`:`${Math.max(t-o,10)}px`}function f(e){let{x:t,y:n,height:o,mouseX:i,mouseY:r}=e;return i>t?`polygon(0% 0%, 0% 100%, 100% ${100*(r-n)/o}%)`:`polygon(100% 0%, 0% ${100*(r-n)/o}%, 100% 100%)`}function g(e){const{x:t=0,y:n=0,height:o=0,width:i=0}=e.el.getBoundingClientRect()||{},{x:r,y:a}=c(),s={x:t,y:n,height:o,width:i,mouseX:r,mouseY:a},l={right:p(s),left:u(s),height:o,width:m(s),clipPath:f(s)};return(0,d.jsx)("div",{style:{cursor:"pointer",position:"absolute",top:0,...l}})}function h(e,t){let{onClick:n,renderOrigin:c,renderExtension:u,allowOptionalExtensionMenu:p,...m}=e;const{disableDefaultClick:f,onFocus:h,focused:v,openOnFocus:b}=m,y=(0,r.Fy)(),[_,S]=(0,o.useState)(!1),w=(0,o.useRef)(null),k=(0,o.useRef)(null),I=(0,o.useRef)(null),C=(0,o.useRef)(null),x=(0,o.useCallback)((()=>{I.current&&window.clearTimeout(I.current),C.current&&window.clearTimeout(C.current),I.current=null,C.current=null}),[]),T=(0,o.useCallback)((()=>{x(),_||S(!0)}),[_,x]),M=(0,o.useCallback)((()=>{x(),_&&S(!1)}),[_,x]),P=(0,o.useCallback)((e=>{x(),_||(e&&e.preventDefault&&e.preventDefault(),I.current=window.setTimeout(T,120))}),[_,x,T]),A=(0,o.useCallback)((()=>{x(),_&&(C.current=window.setTimeout(M,100))}),[_,M,x]),R=(0,o.useCallback)((e=>{h(),T(),p&&(null==n||n(e),M())}),[h,T,p,n,M]),D=(0,o.useCallback)((()=>{P()}),[P]),E=(0,o.useCallback)((()=>{h(),P()}),[h,P]),B=(0,o.useCallback)((e=>{if(y.isPhone)return;const t=i.findDOMNode(w.current);_&&t&&!t.contains(e.target)&&M()}),[_,M,y.isPhone]),F=(0,o.useCallback)((e=>{13===e.keyCode&&_&&M()}),[_,M]);(0,o.useEffect)((()=>{if(!Boolean(f))return window.addEventListener("click",B),()=>{window.removeEventListener("click",B)}}),[f,B]),(0,o.useEffect)((()=>(window.addEventListener("keydown",F),()=>{window.removeEventListener("keydown",F)})),[F]);const O=(0,o.useRef)(v);(0,o.useEffect)((()=>{b&&!O.current&&v?P():!v&&O.current&&A(),O.current=v}),[v,b,P,A,y.isMobile]);const Z={...(0,a.Z)({onMouseEnter:D,onClick:R},m),showExtensionArrow:!0};return(0,d.jsx)(s.Z,{debugName:"ExtensionMenuItem",capture:v,onEnter:_?void 0:P,onRight:P,onLeft:_?A:void 0,onEsc:_?A:void 0,children:(0,d.jsx)(l.ZP,{popupType:y.isPhone?l.ZP.PopupType.SlideUp:l.ZP.PopupType.Popup,open:_,origin:c(Z,t),placementToOrigin:l.ZP.Placement.Right,alignmentToOrigin:l.ZP.Alignment.Center,originGap:0,disableMouseCapture:!0,preventBlockRenderQueueOnEnter:!0,preventScaleTransition:!y.isPhone,preventCaptureEsc:!0,ref:w,render:()=>(0,d.jsxs)(d.Fragment,{children:[k.current&&(0,d.jsx)(g,{el:k.current}),(0,d.jsx)("div",{ref:k,children:u({onMouseEnter:E},{close:A})})]}),style:{overflow:"visible"},trapFocus:!0})})}const v=o.forwardRef(h)},19987:(e,t,n)=>{n.d(t,{Z:()=>J});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(77657),l=n(42853),c=n(56666),d=n(44495),u=n(60291),p=n(54497),m=n(90965),f=n(9291),g=n(97466),h=n(31701),v=n(37810),b=n(57549),y=n(89475),_=n(42858),S=n(13447),w=n(61202),k=(n(95477),n(70764)),I=n(41232),C=n(33929),x=n(77907),T=n(80444),M=n(30874),P=n(31194),A=n(1634),R=n(64921),D=n(31945),E=n(51077),B=n(89728),F=(n(57658),n(74155)),O=n(37612),Z=n(893),V=n(47307),U=n(12714),L=n(60709),j=n(18514),N=n(52275),z=n(78140),q=n(32163),W=n(72495),H=n(85893);const K=(0,f.defineMessages)({copiedDebuggingInfo:{id:"externalObjectBlock.errorDropdown.copiedDebuggingInfo",defaultMessage:"Copied to clipboard."}});function G(e){const{state:t,store:n,onUpdate:o,onReplace:l,onAuthenticate:c,onRemove:d,description:p,statusCode:m,errorDescription:g,isInlineMenu:v}=e,{userHasBotForIntegration:y,pattern:_,integration:S,botIds:w,originalUrl:k}=t,I=(0,i.Fy)(),C=(0,i.O7)(),x=(0,a.yK)((e=>({menuIcon:{fill:e.regularIconColor,width:16},redThemeColor:(0,h.fi)("red",e)})),[]),M=(0,r.VK)((()=>{var e;return Boolean(null===(e=T.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit())}),[]),P=(0,r.VK)((()=>n.isExternalObjectInstanceBlockStore()),[n]),A=(0,r.VK)((()=>n.isExternalObjectInstancePageBlockStore()),[n]);let R;R=I.isMobile?{menuType:L.og.ActionSheet}:{menuType:L.og.Popup,minWidth:220};const D={key:"learn",render:e=>(0,H.jsx)(N.Z,{title:(0,H.jsx)(f.FormattedMessage,{defaultMessage:"Learn more about this error",id:"unfurling.errorOptions.learnMore.title"}),icon:(0,F.u)(x.menuIcon),...e}),action:()=>{V.showDialog({items:[{label:(0,H.jsx)(f.FormattedMessage,{id:"externalObjectInstanceBlockErrorDropdown.dialogItem.reviewGuide",defaultMessage:"View guide"}),color:"blue",onAccept:()=>{U.D({environment:C,url:(0,j.UY)("guides.unfurling")}),b.SC(C,{integrationId:S.id,entity:null==_?void 0:_.name,statusCode:m})}},{label:(0,H.jsx)(f.FormattedMessage,{id:"externalObjectInstanceBlockErrorDropdown.dialogItem.copyDebugData",defaultMessage:"Copy debugging information"}),color:void 0,onAccept:()=>{const e={statusCode:m,integrationId:S.id,botIds:w,url:k,debugMessage:g};Z.RD({environment:C,stringValue:JSON.stringify(e,null,2),copiedMessage:K.copiedDebuggingInfo})}}],showCancel:!0,keepFocus:!1,message:p})}},B={key:"remove",render:e=>(0,H.jsx)(N.Z,{title:(0,H.jsx)(f.FormattedMessage,{defaultMessage:"Remove",id:"unfurling.errorOptions.removeAction.title"}),style:{color:x.redThemeColor.color},icon:(0,O.y)({fill:x.redThemeColor.fill,width:16}),...e}),action:()=>{null==d||d()}},G={key:"replace",render:e=>(0,H.jsx)(N.Z,{title:(0,H.jsx)(f.FormattedMessage,{defaultMessage:"Change URL",id:"unfurling.errorOptions.replace.title"}),icon:(0,u.b)(x.menuIcon),...e}),action:()=>{l()}},$={key:"update",render:e=>(0,H.jsx)(N.Z,{title:(0,H.jsx)(f.FormattedMessage,{defaultMessage:"Try again",id:"unfurling.errorOptions.tryAgainAction.title"}),icon:(0,u.b)(x.menuIcon),...e}),action:()=>{null==o||o()}},Q={key:"authenticate",render:e=>(0,H.jsx)(N.Z,{title:y?401===m?(0,H.jsx)(f.FormattedMessage,{defaultMessage:"Re-authenticate account",id:"unfurling.errorOptions.authenticateAction.reAuthenticate.title"}):v?(0,H.jsx)(f.FormattedMessage,{defaultMessage:"Connect a different account",id:"unfurling.errorOptions.authenticateAction.alreadyAuthenticatedCompact.title"}):(0,H.jsx)(f.FormattedMessage,{defaultMessage:"Connect a different {integration} account",id:"unfurling.errorOptions.authenticateAction.alreadyAuthenticated.title",values:{integration:S.name}}):(0,H.jsx)(f.FormattedMessage,{defaultMessage:"Connect {integration} account",id:"unfurling.errorOptions.authenticateAction.notAuthenticated.title",values:{integration:S.name}}),icon:(0,H.jsx)(E.Z,{type:"image_url",imageURL:S.icon,size:16}),...e}),action:()=>{null==c||c()}},Y=[D];return M&&("error"===t.type?Y.push(G):("placeholder"===t.type?Y.push(G):Y.push($),(P||A&&[s.f3,s.mQ].includes(S.id))&&Y.push(Q))),d&&Y.push(B),(0,H.jsx)(z.Z,{...R,children:(0,H.jsx)(q.Z,{type:q.i.Vertical,initialFocus:v?void 0:0,sections:[{key:0,render:e=>(0,H.jsx)(W.Z,{...e,disableDesktopPadding:v,title:(0,H.jsx)(f.FormattedMessage,{defaultMessage:"Try these options",id:"unfurling.errorOptions.menuTitle"})}),items:Y}]})})}function $(e){const t=(0,r.VK)((()=>{var t;return e.isCollectionView()?null===(t=e.getCollectionViewCollectionStore())||void 0===t||null===(t=t.getFormat().error)||void 0===t?void 0:t.status_code:e.getFormatStore().getKeyStore("error").getKeyStore("status_code").getValue()}),[e]),n=(0,r.VK)((()=>{let t;var n;e.isCollectionView()?t=null===(n=e.getCollectionViewCollectionStore())||void 0===n?void 0:n.getFormat().bot_id:t=e.getFormat().bot_id;const o=M.Z.bots.state.find((e=>e.id===t));if(o)return(0,s.s9)(o.integration_id)}),[e]),{message:i,description:a}=o.useMemo((()=>(0,k.xt)(t,n)),[t,n]);return{statusCode:t,message:i,description:a}}function Q(e){const{onAuthenticate:t,onReplace:n,onUpdate:o,state:i,store:r,onRemove:s,style:c}=e,d=(0,a.yK)((e=>({orangeThemeColor:(0,h.fi)("orange",e),dropdownIcon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),{statusCode:u,message:m,description:f}=$(r);return(0,H.jsx)(D.ZP,{popupType:D.Z4.Popup,originGap:4,renderOrigin:e=>(0,H.jsxs)(B.Z,{style:c,icon:e=>(0,p.t)({...e,fill:d.orangeThemeColor.fill}),...e,children:[(0,H.jsx)("span",{children:C.default.formatMessage(m)}),(0,l.i)(d.dropdownIcon)]}),render:e=>(0,H.jsx)(G,{state:i,store:r,onUpdate:o?()=>{o(),e.close()}:void 0,onAuthenticate:t?()=>{t(),e.close()}:void 0,onReplace:()=>{n(),e.close()},onRemove:s?()=>{s(),e.close()}:void 0,statusCode:u,errorDescription:f.description,description:C.default.formatMessage(f,{integrationName:i.integration.name,statusCode:u})})})}function Y(e){const{onAuthenticate:t,onReplace:n,onUpdate:o,state:i,store:r,onRemove:s}=e,l=(0,a.yK)((e=>({orangeThemeColor:(0,h.fi)("orange",e)})),[]),{statusCode:c,message:d,description:u}=$(r);return(0,H.jsxs)("div",{style:{alignSelf:"stretch"},children:[(0,H.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:v.Z.fontSize.UIRegular.desktop,fontWeight:v.Z.fontWeight.medium,marginBottom:4},children:[(0,p.t)({width:18,height:18,marginRight:6,fill:l.orangeThemeColor.fill}),(0,H.jsx)("span",{children:C.default.formatMessage(d)})]}),(0,H.jsx)("div",{style:{margin:"0 -14px"},children:(0,H.jsx)(G,{state:i,store:r,onUpdate:o,onAuthenticate:t,onReplace:n,onRemove:s,statusCode:c,errorDescription:u.description,description:C.default.formatMessage(u,{integrationName:i.integration.name,statusCode:c}),isInlineMenu:!0})})]})}const J=function(e){let{store:t,canEdit:n,forceActionForUIDoc:o,postActionCallback:s,openPlaceholderMenu:l,buttonStyle:c,isHoverPreview:d,renderDefaultAction:u}=e;const p=(0,a.Fg)(),h=(0,i.O7)(),v=(0,r.VK)((()=>(0,I._l)({store:t,isInDarkMode:X(h),canEdit:n,currentUserId:h.currentUser.id,showAction:o})),[t,h,n,o]),y=(0,r.VK)((()=>X(h)),[h]),w=(0,r.VK)((()=>{var e;return h.currentUser.id?null===(e=T.default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceUserStore(h.currentUser.id):void 0}),[h]),C=(0,r.VK)((()=>Boolean(null==w?void 0:w.isMember())),[w]),x=(0,r.VK)((()=>Boolean(null==w?void 0:w.isWorkspaceOwner())),[w]),M=(0,r.VK)((()=>{var e;return null===(e=T.default.state.currentSpaceStore)||void 0===e?void 0:e.getBotSettingsStore().getValue()}),[]);if(!v)return null;const{integration:P,action:A}=v,{r:R,g:D,b:F}=P.accentColor,O=`rgba(${R},${D},${F},${y?.6:1})`,Z=x||(0,m.hU)({spaceBotSettings:M,integrationId:P.id,env:"production"}),V={state:v,store:t,onUpdate:()=>{ne({from:"external_object_instance_block_error_dropdown"},t,h,s)},onAuthenticate:()=>{ie({from:"external_object_instance_block_error_dropdown"},h,t,v,s)},onReplace:()=>{null==l||l()}},U={...V,onRemove:()=>{!function(e,t,n,o){var i;S.createAndCommit({userAction:"ExternalObjectInstanceAction.handleRemove",environment:e,perform:n=>{_.Cl({environment:e,blocks:[t],transaction:n})}}),b.oQ(e,{integrationId:n.integration.id,entity:null===(i=n.pattern)||void 0===i?void 0:i.name}),null==o||o()}(h,t,v,s)}};return(0,H.jsxs)(H.Fragment,{children:["authenticate"===A&&(0,k.sw)(h)&&C&&Z&&(0,H.jsx)(B.Z,{icon:e=>(0,H.jsx)(E.Z,{type:"image_url",imageURL:P.accentIcon,size:20,style:{...e,width:16,height:16,marginRight:8,marginLeft:2}}),onClick:()=>ie({from:"external_object_instance_block"},h,t,v,s),style:{...ee(p,c),background:O,fontSize:14,height:32,paddingRight:12,color:y?p.regularTextColor:p.regularInvertedTextColor},hoveredStyle:{background:(0,g._j)(O,.4)},pressedStyle:{background:(0,g._j)(O,.9)},children:(0,H.jsx)(f.FormattedMessage,{defaultMessage:"Connect to {integration} to update",id:"unfurling.authenticateButton.title",values:{integration:v.integration.name}})}),"update"===A&&(0,H.jsx)(oe,{store:t,postActionCallback:s,buttonStyle:c,isHoverPreview:d}),"error"===A&&(d?(0,H.jsx)(Y,{...V}):(0,H.jsx)(Q,{...U,style:ee(p,c)})),!A&&u?(0,H.jsx)(te,{renderDefaultAction:u,buttonStyle:c,store:t}):null]})};function X(e){return"dark"===e.ThemeStore.state.mode}function ee(e,t){return{marginRight:4,color:e.mediumTextColor,...t}}function te(e){let{renderDefaultAction:t,buttonStyle:n,store:o}=e;const r=(0,a.Fg)(),s=(0,i.O7)(),{isMobile:l}=s.device;return(0,H.jsx)(D.ZP,{popupType:l?D.Z4.SlideUp:D.Z4.Popup,renderOrigin:e=>(0,H.jsx)(R.Z,{...e,mobileFeedback:l,style:{display:"flex",alignItems:"center",justifyContent:"center",width:l?36:28,height:l?36:28,borderRadius:4,flexShrink:0,opacity:"shown"===t?1:0,...ee(r,n)},children:(0,c.o)({width:l?18:14,color:r.mediumIconColor})}),placementToOrigin:P.Iw.Bottom,render:e=>(0,H.jsx)(x.LazyExternalObjectInstanceBlockMenu,{titleForReloadMenuOption:(0,H.jsx)(f.FormattedMessage,{id:"linkPreview.reload",defaultMessage:"Reload preview"}),store:o,onAccept:()=>e.close(),extraSecondaryItemKey:"preview_to_mention"})})}function ne(e,t,n,o){var i;const{from:r}=e,a=null===(i=T.default.state.currentSpaceStore)||void 0===i?void 0:i.id;a&&(w.qK({environment:n,from:r,store:t,spaceId:a,bypassCache:"external_object_instance_block_error_dropdown"===r}),null==o||o())}function oe(e){let{store:t,postActionCallback:n,buttonStyle:o,isHoverPreview:r}=e;const s=(0,a.Fg)(),l=(0,i.O7)(),c=(0,H.jsx)(B.Z,{onClick:()=>ne({from:"external_object_instance_block"},t,l,n),style:ee(s,o),icon:e=>(0,u.b)({...e}),children:(0,H.jsx)(f.FormattedMessage,{defaultMessage:"Update",id:"unfurling.updateButton.title"})});return r?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:v.Z.fontSize.UIRegular.desktop,marginBottom:4},children:[(0,d.D)({width:18,height:18,marginRight:6}),(0,H.jsx)("span",{children:(0,H.jsx)(f.FormattedMessage,{defaultMessage:"This link preview is out-of-date.",id:"unfurling.updateButton.header"})})]}),c]}):c}function ie(e,t,n,o,i){var r;const{from:a}=e,s=o.originalUrl,{currentSpaceStore:l}=T.default.state;if(!l)return;const c=null===(r=(0,I.GQ)(s,l.id))||void 0===r?void 0:r.integration;c&&s&&(y.hM({environment:t,integration:c,spaceId:l.id,unfurlUrl:s,externalObjectInstanceBlockId:n.id,from:a}),A.Z.reset(),null==i||i())}},14562:(e,t,n)=>{n.d(t,{Z:()=>A});var o=n(67294),i=n(24405),r=n(76725),a=n(44876),s=n(31701),l=n(53965),c=n(1898),d=n(37810),u=n(36610),p=n(61202),m=n(95645),f=n(41232),g=n(6398),h=n(68859),v=n(49085);class b extends v.default{getInitialState(){return{error:!1,loading:!1}}}const y=b;var _=n(68709),S=n(51077),w=n(12981),k=n(84076),I=n(68785),C=n(81865),x=n(27016),T=n(19987),M=n(85893);class P extends m.Z{constructor(){super(...arguments),this.origin=o.createRef(),this.storeTypes={externalObjectTokenStore:y,blockResizerStore:h.Z},this.state={isHovered:!1},this.stateStore=this.createComputedStore((()=>{return(0,f._l)({store:this.props.store,isInDarkMode:(e=this.environment,"dark"===e.ThemeStore.state.mode),canEdit:this.canEdit(),currentUserId:this.environment.currentUser.id,showAction:this.props.forceActionForUIDoc});var e}),!0),this.handleMouseEnter=()=>{this.setState({isHovered:!0})},this.handleMouseLeave=()=>{this.setState({isHovered:!1})}}renderPersisted(){const e=this.stateStore.state;if(!e)return this.renderShimmerState();const t=(0,f.y6)(this.props.store);if("error"===e.type&&(null==t||!t.integration_id))return this.renderShimmerState();const{renderConfig:n}=e;return(0,M.jsx)(_.p,{allowSelectionWithin:!0,children:n.previewAttributes&&(0,c.Of)(n.previewAttributes)?this.renderEmbedPreview({attributes:n.previewAttributes,state:e}):this.renderLinkBox(e)})}renderLinkBox(e){var t;const{originalUrl:n,renderConfig:o,integration:i,updating:s}=e,{store:l}=this.props,p=l.getFormat(),m="placeholder"===e.type,h="error"===e.type,v=this.state.isHovered||this.environment.device.isMobile,b=n&&(0,f.pI)(n,l.pointer.spaceId);return u.K9(this.environment,{integrationName:i.name,integrationId:i.id,botId:(null==p?void 0:p.bot_id)||"",externalObjectId:(null==p?void 0:p.external_object_id)||""}),(0,M.jsxs)(k.Z,{ref:this.origin,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,style:{flexGrow:1,minWidth:0,...(m||h)&&{background:this.theme.embedPlaceholderBackground}},innerStyle:this.getStyle({hasPreview:!(!Boolean(o.previewAttributes)||!o.previewAttributes)&&(0,c.Of)(o.previewAttributes)}),...m||h?{onClick:()=>{const e=this.getPlaceholderNode();e&&O(e,this.environment,this.props.store,this.stores.externalObjectTokenStore,this.stateStore)}}:{href:b,external:!0},children:[(0,M.jsx)("div",{style:{display:"flex",alignSelf:"start",height:32,width:32,marginRight:12,marginLeft:4,marginTop:3,marginBottom:3,position:"relative"},children:(0,M.jsx)(E,{renderConfig:o,integrationIcon:i.icon})}),(0,M.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",flexGrow:1,flexShrink:1,overflow:"hidden"},children:[(0,M.jsxs)("div",{style:{display:"flex",alignItems:"baseline",fontSize:14},children:[(0,r.Z)((null===(t=o.headerAttributes)||void 0===t?void 0:t.map(((e,t)=>{return(0,M.jsx)(g.ox,{...e,store:this.props.store,style:0===t?(n=this.theme,{fontWeight:d.Z.fontWeight.medium,...d.Z.textOverflowStyle,color:n.regularTextColor}):{}},`attribute-${t}`);var n})))||[],(e=>(0,M.jsx)("span",{style:{marginRight:6}},`spacer-${e}`))),(s||this.stores.externalObjectTokenStore.state.loading)&&(0,M.jsx)(I.Z,{style:{marginLeft:6}})]}),o.bodyAttribute&&((0,a.O0)(o.bodyAttribute)?(0,M.jsx)(g.t9,{attribute:o.bodyAttribute}):(0,M.jsx)(g.hx,{attribute:o.bodyAttribute,store:this.props.store})),(0,M.jsxs)("div",{style:{display:"flex",alignItems:"center",color:this.theme.mediumTextColor,fontSize:12},children:[o.subheaderIcon&&(0,M.jsx)(F,{attribute:o.subheaderIcon}),o.subheaderAttributes&&(0,r.Z)(o.subheaderAttributes.map((e=>(0,M.jsx)(R,{attributeConfig:e,store:this.props.store},e.attribute.id))),(e=>(0,M.jsx)("span",{style:{marginLeft:3,marginRight:3},children:"â€¢"},e)))]})]}),(0,M.jsx)(T.Z,{canEdit:this.canEdit(),forceActionForUIDoc:this.props.forceActionForUIDoc,store:this.props.store,renderDefaultAction:v?"shown":"invisible",buttonStyle:o.bodyAttribute?{alignSelf:"flex-start",marginTop:4}:{},openPlaceholderMenu:()=>{const e=this.getPlaceholderNode();e&&O(e,this.environment,this.props.store,this.stores.externalObjectTokenStore,this.stateStore)}})]})}renderShimmerState(){var e;return(0,M.jsxs)(k.Z,{href:null===(e=this.stateStore.state)||void 0===e?void 0:e.originalUrl,external:!0,style:{flexGrow:1,minWidth:0},innerStyle:this.getStyle(),children:[(0,M.jsx)(B,{style:{width:38,height:38}}),(0,M.jsxs)("div",{style:{display:"flex",flexDirection:"column",flexGrow:1},children:[(0,M.jsx)(B,{style:{width:"50%",height:14,margin:4}}),(0,M.jsx)(B,{style:{width:"40%",height:12,margin:4}})]})]})}renderEmbedPreview(e){const{attributes:t,state:n}=e,{integration:o}=n,i=t[0],{values:r,mimeType:a}=i,s=r[0];let l;"image/*"===a?l="image":"audio/*"===a?l="audio":"video/*"===a?l="video":"application/pdf"===a?l="pdf":"text/html"===a?l="embed":(0,c.t1)(a);const d="image"===l||"pdf"===l||"embed"===l,p=this.props.store,m=p.getFormat();return u.K9(this.environment,{integrationName:o.name,integrationId:o.id,botId:(null==m?void 0:m.bot_id)||"",externalObjectId:(null==m?void 0:m.external_object_id)||""}),p.isExternalObjectInstanceBlockStore()?(0,M.jsx)("div",{style:{overflow:"hidden",borderRadius:6,border:`1px solid ${this.theme.tableDividerColor}`,borderBottom:void 0,position:"relative"},children:(0,M.jsx)(x.ZP,{store:p,source:s,showExpandButton:d,mediaType:l,...(0,f.Xg)()?{disabled:!1,preserveScale:"image"===l,blockResizerStore:this.stores.blockResizerStore}:{disabled:!0,preserveScale:!0,disableActions:!0,..."image"===l&&{centerWrappedContent:!0}},contentBelowSource:this.renderLinkBox(e.state)})}):void 0}handleCreated(){const e=this.getPlaceholderNode();e&&O(e,this.environment,this.props.store,this.stores.externalObjectTokenStore,this.stateStore)}getPlaceholderNode(){var e,t;if("placeholder"===(null===(e=this.stateStore.state)||void 0===e?void 0:e.type)||"error"===(null===(t=this.stateStore.state)||void 0===t?void 0:t.type)){const e=this.origin.current;if(e&&e instanceof Element)return e}}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{hasPreview:t}=e;return{display:"flex",alignItems:"center",border:`1px solid ${this.theme.tableDividerColor}`,borderRadius:t?"0px 0px 4px 4px":4,borderLeft:t?"none":`1px solid ${this.theme.tableDividerColor}`,borderRight:t?"none":`1px solid ${this.theme.tableDividerColor}`,padding:"8px 12px",...this.getBlockColorStyle(),...this.props.style}}}const A=P;function R(e){let{attributeConfig:t,store:n}=e;return(0,M.jsx)(g.ox,{...t,store:n})}function D(e){return{filter:`\n            drop-shadow(0px 0px 1px ${e.contentBackground})\n            drop-shadow(0px 0px 1px ${e.contentBackground})\n            drop-shadow(0px 0px 1px ${e.contentBackground})\n        `}}function E(e){let{renderConfig:t,integrationIcon:n}=e;const o=(0,i.Fg)(),r=l.mN(t.icons||[],(e=>`${e.type}:${e.values[0].toString()}`));return r.length>=2?(0,M.jsxs)("div",{style:{width:32,height:32},children:[(0,M.jsx)(g.lf,{attribute:r[0],isSmall:!0}),(0,M.jsx)(g.lf,{attribute:r[1],isSmall:!0,style:{position:"absolute",bottom:0,right:2}}),(0,M.jsx)(S.Z,{type:"image_url",imageURL:n,size:16,style:{position:"absolute",bottom:-3,right:-3},imageStyle:D(o)})]}):1===r.length?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(g.lf,{attribute:r[0],isSmall:!1}),(0,M.jsx)(S.Z,{type:"image_url",imageURL:n,size:16,style:{position:"absolute",bottom:-2,right:-2},imageStyle:D(o)})]}):(0,M.jsx)(S.Z,{type:"image_url",imageURL:n,size:38})}function B(e){let{style:t}=e;const n=(0,i.Fg)();return(0,M.jsx)("div",{style:{overflow:"hidden",position:"relative",background:n.selectLightGray[30],...t},children:(0,M.jsx)("div",{style:{position:"absolute",height:"100%",width:"100%",zIndex:1,animation:"shimmer 1s infinite",background:`linear-gradient(to right, ${n.selectLightGray[30]} 0%, ${n.selectLightGray[50]} 20%, ${n.selectLightGray[30]} 40%, ${n.selectLightGray[30]} 100%)`}})})}function F(e){let{attribute:t}=e;const n=(0,i.Fg)();if((0,a.li)(t)){const e=t.values[0];return(0,M.jsx)(C.Z,{isAuthenticated:!1,url:e,width:32,render:(e,t)=>(0,M.jsx)(w.Z,{src:t,height:12,placeholderLoadedStyle:{width:12,height:12,marginRight:4}})})}if((0,a.hW)(t)){const e=t.values[0],o=e?`rgb(${e.r},${e.g},${e.b})`:"gray",{colorName:i,shade:r}=(0,s.lL)(o);return(0,M.jsx)("div",{style:{width:12,height:12,marginRight:4,background:n.accentColors[i][r],borderRadius:4,flexShrink:0}})}return null}function O(e,t,n,o,i){var r;const a=(0,f.y6)(n);p.os({originRect:e.getBoundingClientRect(),environment:t,externalObjectInstanceBlockStore:n,placeholderIntegrationId:null==a?void 0:a.integration_id,integration:null===(r=i.state)||void 0===r?void 0:r.integration,externalObjectTokenStore:o})}},69721:(e,t,n)=>{n.d(t,{S:()=>F,Z:()=>O});var o=n(67294),i=n(480),r=n(86628),a=n(49271),s=n(43593),l=n(50066),c=n(70203),d=n(9291),u=n(53965),p=n(26249),m=n(37810),f=n(57549),g=n(31781),h=n(62365),v=n(27153),b=n(24677),y=n(98104),_=n(13447),S=n(33767),w=n(73819),k=n(77080),I=n(27411),C=n(13966),x=n(91893),T=n(23864),M=n(64921),P=n(64369),A=n(86329),R=n(78454),D=n(85893);const E=(0,d.defineMessages)({fileTitle:{defaultMessage:"File",id:"fileBlock.fileTab.title"},embedButtonText:{defaultMessage:"Embed link",id:"fileBlock.embedButton.label"},embedFilePrompt:{defaultMessage:"Paste a file linkâ€¦",id:"fileBlock.linkPrompt.placeholder"},embedCaption:{defaultMessage:"Works with links of PDFs, Google Drive, Google Maps, CodePenâ€¦",id:"fileBlock.linkPrompt.caption"}});function B(e,t){var n;const a=(0,r.VK)((()=>k.default.checkGate("comments_density_image_handling")),[])&&Boolean(e.commentProps),p=(0,d.useIntl)(),m=(0,i.O7)(),M=(0,i.Fy)(),P=(0,o.useRef)(null),R=(0,o.useId)(),[B,O]=(0,o.useState)(!1),Z=(0,w.PE)(e.store,e.disabled),V=(0,w.rv)(e.store),U=(0,r.VK)((()=>{const t=e.store.getProperties(),n=t&&t.source,o=c.QaF(n),{display_source:i}=e.store.getFormat();return i||o}),[e.store]),L=(0,r.VK)((()=>I.default.getKeyState(I.default.getBlockKey(e.store.id))),[e.store.id]),j=M.isMobile||B,N=(0,r.VK)((()=>e.store.getProperties()),[e.store]),z=(0,o.useMemo)((()=>c.Jcv(N&&N.title)),[N]),q=(0,o.useMemo)((()=>c.Jcv(N&&N.size)),[N]),W=j&&Z&&(0,D.jsx)(C.Z,{style:{marginRight:4},store:e.store,fadeIn:!0}),H=(0,o.useCallback)((()=>{const t=e.store.getPropertyStore("caption");b.eP({environment:m,store:e.store}),y.NX({store:t})}),[m,e.store]),K=(0,o.useCallback)((t=>{_.createAndCommit({userAction:"FileBlock.handleUpload",environment:m,perform:t=>{h.v({environment:m,store:e.store,source:void 0,name:void 0,size:void 0,transaction:t})}}),f.re(m,{source:"upload",file:t.name}),h.c({environment:m,store:e.store,file:t})}),[m,e.store]),G=(0,o.useCallback)((()=>{const t=P.current;if(Z&&t){const n=t.getBoundingClientRect();v.$(m,{originRect:n,originGap:0,isSmallWidth:!0,showArrow:!0,title:p.formatMessage(E.fileTitle),currentTab:"file",tabs:[{type:"file",fileUpload:!0,imageUpload:M.isAndroid,videoUpload:M.isAndroid,onUpload:K},{type:"embed",buttonText:p.formatMessage(E.embedButtonText),inputPlaceholder:p.formatMessage(E.embedFilePrompt),caption:p.formatMessage(E.embedCaption),onChange:t=>{v.Z(),_.createAndCommit({userAction:"FileBlock.handleOpenMenu",environment:m,perform:n=>{h.v({environment:m,store:e.store,source:t,name:void 0,size:void 0,transaction:n})}}),f.re(m,{file:t,source:"embed"}),f.bO(m,{pastedText:t,source:"file_block_menu"})}}]})}}),[Z,M.isAndroid,m,K,p,e.store]),$=(0,o.useCallback)((()=>{g.qL(m,{store:e.store,from:"embedded_block_click"})}),[m,e.store]),Q=(0,o.useMemo)((()=>({flexGrow:1,minWidth:0,borderRadius:4,...u.CE(V,["fontSize","lineHeight"])})),[V]),Y=(0,D.jsxs)("div",{role:"figure","aria-labelledby":R,ref:P,children:[(0,D.jsxs)("div",{onMouseMove:()=>O(!0),onMouseLeave:()=>O(!1),style:{display:"flex"},children:[a?(0,D.jsx)(S.tG,{title:s.rF({title:z,source:U}),source:U,size:q,store:e.store,onClick:$,showBlockActionMenuButton:!(null!==(n=e.commentProps)&&void 0!==n&&n.shouldHideBlockActionMenu)??!1}):(0,D.jsx)(F,{title:z,url:U,size:q,onClick:$,right:W,style:Q}),(0,D.jsx)(T.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]}),(0,D.jsx)(x.Z,{store:e.store,captionAriaId:R,disabled:e.disabled})]}),J=(0,D.jsxs)("div",{onMouseMove:()=>O(!0),onMouseLeave:()=>O(!1),style:{display:"flex"},ref:P,children:[(0,D.jsx)(A.Z,{disabled:e.disabled,iconSvg:l.R,shouldHideRight:!j,right:Z&&(0,D.jsx)(C.Z,{store:e.store,fadeIn:!1}),isLoading:Boolean(L),progressPercent:L?L.progressPercent:0,file:L?L.file:void 0,name:L?L.name:void 0,size:L?L.size:void 0,onClick:G,children:(0,D.jsx)(d.FormattedMessage,{defaultMessage:"Upload or embed a file",id:"fileBlock.uploadOrEmbed.placeholder"})}),(0,D.jsx)(T.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]}),X=U?Y:J;return(0,w.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"file",getNode:()=>P.current,getBlockStore:()=>e.store,caption:H,handleCreated:G,edit:G,activate:G,replace:G})),[H,G,e.store]),X)}function F(e){const{style:t,right:n,title:o,url:i,size:r,onClick:c}=e,d={paddingTop:a.ZD.paddingTop,paddingBottom:a.ZD.paddingBottom,paddingLeft:a.ZD.paddingLeft};return(0,D.jsx)(M.Z,{style:t,onClick:c,children:(0,D.jsx)(R.ZP,{style:d,left:(0,l.R)(),leftStyle:{width:"1.35em",height:"1.35em"},alignment:R.v2.Center,right:n,children:(0,D.jsxs)("div",{style:{display:"flex",alignItems:"baseline"},children:[(0,D.jsx)("div",{style:{...m.Z.textOverflowStyle},children:s.rF({title:o,source:i})}),r&&(0,D.jsx)(P.Z,{isSmall:!0,style:{marginLeft:6,whiteSpace:"nowrap"},children:r})]})})})}const O=o.memo(o.forwardRef(B),p.Z)},65453:(e,t,n)=>{n.d(t,{Z:()=>_});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(49271),l=n(76490),c=n(9291),d=n(26249),u=n(35328),p=n(73819),m=n(45131),f=n(23864),g=n(65187),h=n(17377),v=n(85893);const b=(0,c.defineMessages)({placeholder:{defaultMessage:"Heading 1",id:"header1Block.placeholder"}});function y(e,t){const n=(0,c.useIntl)(),d=(0,i.O7)(),y=(0,i.Fy)(),_=(0,o.useRef)(null),S=(0,p.rv)(e.store),w=(0,p.Iy)(e.store),k=(0,r.VK)((()=>e.store.getBlockTitleStore()),[e.store]),I=(0,r.VK)((()=>m.Z.isOpen(e.store.id)&&!e.hideContent),[e.hideContent,e.store.id]),C=(0,a.yK)((e=>{const t=(y.isMobile?1.5:l.eV)*l.u9,n=y.isMobile?1.5:l.eV;return{root:{display:"flex",width:"100%",...S},toggle:{height:`${t}em`,marginTop:3},headerText:{...s.ZD,...(0,l.DK)({fontSizeValue:n,fontFamily:w})},headerTextPlaceholder:{WebkitTextFillColor:e.headerBlockPlaceholderTextColor}}}),[S,y.isMobile,w]);return(0,p.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"header",getNode:()=>_.current,getBlockStore:()=>e.store,activate(){u.th(d,e.store,e.hideContent)}})),[d,e.hideContent,e.store]),(0,v.jsx)("div",{ref:_,style:{...C.root,...e.style},children:(0,v.jsxs)(h.Z,{store:e.store,toggleStyle:C.toggle,childrenStyleWhenToggleable:{display:"flex"},hideContent:e.hideContent,disabled:e.disabled,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag,children:[(0,v.jsx)(g.Z,{tagName:"h2",disabled:e.disabled,store:k,placeholder:n.formatMessage(b.placeholder),placeholderStyle:C.headerTextPlaceholder,style:C.headerText,pasteBehavior:"block",legacyTransclusionParent:e.legacyTransclusionParent,inPageFind:{type:"block_match"}}),(0,v.jsx)(f.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store,recursivelyLoadAllDiscussions:!I})]})}))}const _=o.memo(o.forwardRef(y),d.Z)},83182:(e,t,n)=>{n.d(t,{Z:()=>u});n(67294);var o=n(480),i=n(86628),r=n(24405),a=n(84169),s=n(25888),l=n(52275),c=n(16354),d=n(85893);function u(e){const t=(0,o.O7)();return(0,d.jsx)(c.Z,{href:e.href,external:!0,onClick:()=>s.Fs(t,{from:e.analyticsFrom}),children:(0,d.jsx)(l.Z,{icon:!e.left&&(0,d.jsx)(m,{left:e.left}),title:(0,d.jsx)(p,{title:e.title,left:e.left}),focused:!1})})}function p(e){const t=(0,o.O7)(),n=(0,i.VK)((()=>t.device.isPhone),[t]),a=(0,r.yK)((e=>({title:{fontSize:n?14:12,verticalAlign:1,color:e.lightTextColor}})),[n]);return e.left?(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,d.jsx)("span",{style:{...a.title,marginRight:"auto"},children:e.left}),(0,d.jsx)(m,{left:e.left}),(0,d.jsx)("span",{style:a.title,children:e.title})]}):(0,d.jsx)("span",{style:a.title,children:e.title})}function m(e){let{left:t}=e;const n=(0,r.Fg)(),i=(0,o.MO)();return(0,a.m)({width:i?16:14,fill:n.lightIconColor,marginRight:t?6:0})}},74523:(e,t,n)=>{n.d(t,{Z:()=>m});var o=n(67294),i=n(480),r=n(24405),a=n(84169),s=n(25888),l=n(73063),c=n(16354),d=n(89728),u=n(85893);function p(e){let{title:t,href:n,analyticsFrom:p,shouldShrink:m,style:f,buttonStyle:g,isBlue:h,onClick:v,onFocus:b,onBlur:y,onMouseDown:_,onMouseEnter:S,onMouseLeave:w}=e;const k=(0,i.O7)(),I={onFocus:b,onBlur:y,onMouseDown:_,onMouseEnter:S,onMouseLeave:w},C=(0,o.useCallback)((()=>{void 0!==v&&v(),s.Fs(k,{from:p})}),[p,k,v]),x=(0,r.yK)((()=>({link:{display:"flex",marginLeft:-6,...f}})),[f]);return(0,u.jsx)(c.Z,{style:x.link,className:"notion-print-ignore",href:n,external:!0,onClick:C,...I,children:t?(0,u.jsx)(d.Z,{icon:a.m,isSmall:!0,isBlue:h,isLightGray:!h,shouldShrink:m,style:g,children:t}):(0,u.jsx)(l.Z,{icon:a.m,isBlue:h,style:g,...I})})}const m=o.memo(p)},33626:(e,t,n)=>{n.d(t,{Z:()=>S});n(82801);var o=n(67294),i=n(480),r=n(88464),a=n(24405),s=n(26198),l=n(63085),c=n(12534),d=n(86628),u=n(77080);var p=n(55367),m=n(80796),f=n(69784),g=n(25777),h=n(85893);const v={position:"absolute",left:0,top:0,width:"100%",height:"100%",borderRadius:1};function b(e,t){const n=(0,o.useRef)(null),[i,r]=(0,o.useState)(!1),a=(0,o.useCallback)((()=>{document.activeElement&&document.activeElement===n.current&&document.activeElement.blur()}),[]);(0,o.useEffect)((()=>{a()}));const s=(0,o.useCallback)((()=>{const e=p.ZP.state.isDragging,t=m.Z.state.isDragging,n=f.default.state.isActive;r(e||t||n)}),[]);return(0,h.jsx)("div",{ref:t,style:e.style,onMouseMove:s,onMouseEnter:s,onMouseLeave:a,children:(0,h.jsx)("div",{style:(0,l.kl)(e),children:(0,h.jsx)(y,{ref:n,...e,disabled:i})})})}const y=o.forwardRef((function(e,t){const{background:n,disabled:i,onContentLoadTimeout:r,renderPreview:s,allow:p,source:m}=e,[f,b]=(0,o.useState)(!1),[y,S]=(0,o.useState)(!1);var w;const k="on"===(w="embed-previews",(0,d.VK)((()=>u.default.getGroup(w)),[w])),I=(0,o.useCallback)((e=>{e.preventDefault(),(0,c.ZP)({event:e,context:c.Af.EditorClick,callback:()=>{S(!0)}})}),[]),C=(0,o.useCallback)((()=>{b(!0)}),[]),x=(0,a.yK)((e=>({iframe:{...v,pointerEvents:i?"none":"auto",backgroundColor:n?e.contentBackground:"none"}})),[n,i]);if(function(e,t,n){if(!window.__webViewTerminatedWhileAppActive&&!t)return!1;return!e&&Boolean(n)}(y,k,s))return(0,h.jsx)("div",{style:{...x.iframe,backgroundColor:"none"},onMouseDown:I,children:null==s?void 0:s()});const T=(0,l.I$)(m);return(0,h.jsx)(g.Z,{innerStyle:{height:"100%",width:"100%"},loaded:f,style:v,spinnerSize:"1em",showSpinnerTimeout:500,children:T&&(0,h.jsx)(_,{ref:t,sourceUrl:T,wrapperStyle:{...x.iframe,backgroundColor:"none"},style:x.iframe,allow:p,onLoad:C,onContentLoadTimeout:r})})})),_=o.forwardRef((function(e,t){const{sourceUrl:n,style:a,allow:l,onLoad:c,onContentLoadTimeout:d,wrapperStyle:p}=e,m=(0,i.O7)(),[f,g]=(0,s.jo)(),v=(0,o.useRef)(void 0),b=(0,r.Z)(t,v),y=(0,o.useRef)(void 0),_=m.device.isElectron?"allow-scripts allow-popups allow-forms allow-same-origin":"allow-scripts allow-popups allow-top-navigation-by-user-activation allow-forms allow-same-origin allow-storage-access-by-user-activation allow-popups-to-escape-sandbox",S=(0,o.useCallback)((()=>{if(u.default.checkGate("embed_block_fallback")){let t;try{t=Boolean(v.current&&v.current.contentWindow&&"about:blank"!==v.current.contentWindow.location.href)}catch(e){if(e instanceof DOMException)return;throw e}t||null==d||d()}}),[d]),w=(0,o.useCallback)((()=>{c(),S()}),[S,c]);return(0,o.useEffect)((()=>(y.current=setTimeout(S,7e3),()=>{clearTimeout(y.current)})),[S]),(0,h.jsx)("div",{ref:f,style:p,children:g&&(0,h.jsx)("iframe",{ref:b,style:a,src:n,frameBorder:"0",onLoad:()=>{clearTimeout(y.current),w()},sandbox:_,allowFullScreen:!0,allow:l})})})),S=o.forwardRef(b)},42402:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var o=n(31701),i=n(16354),r=n(85893);const a={red:"notion-link",purple:"notion-link-ai-version",blue:"notion-link-blue"};const s=function(e){let{href:t,external:n,disableHover:s,onClick:l,onMouseDown:c,onMouseEnter:d,onMouseLeave:u,disableUnderline:p,style:m,hoverColor:f="red",children:g,color:h}=e;const v={display:"inline",textDecoration:"underline",color:h??o.ZP.inherit},b=f?a[f]:a.red;return(0,r.jsx)(i.Z,{href:t,external:n,style:{...v,...m,...p&&{textDecoration:"none"}},onClick:l,className:s?void 0:b,onMouseDown:c,onMouseEnter:d,onMouseLeave:u,children:g})}},83785:(e,t,n)=>{n.d(t,{Z:()=>g});n(67294);var o=n(83355),i=n(68626),r=n(52629),a=n(37850),s=n(12457),l=n(88632),c=n(49085);class d extends c.default{getInitialState(){return{loaded:!1}}}const u=d;var p=n(68785),m=n(85893);class f extends o.Z{constructor(){super(...arguments),this.storeTypes={store:u}}didMount(){!async function(e,t){let n=1e3;for(;;)try{const n=await e();t.setState({loaded:!0,result:n});break}catch(o){i.log({level:"warning",from:"LazyLoader",type:"fetchError",error:(0,r.Ui)(o),data:{miscDataToConvertToString:{waitMs:n}}}),await a.Vs(n),await l.Z.waitUntil((()=>l.Z.state.online)),n=Math.min(2*n,3e4)}}(this.props.fetch,this.stores.store)}renderComponent(){return(0,m.jsx)(s.Z,{show:!this.stores.store.state.loaded,showDelay:300,showHold:0,render:e=>this.stores.store.state.loaded?(this.props.willRender&&this.props.willRender(),this.props.render(this.stores.store.state.result)):this.props.loading?this.props.loading(e):e?(0,m.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,m.jsx)(p.Z,{})}):void 0})}}f.displayName="LazyLoader";const g=f},55217:(e,t,n)=>{n.d(t,{Z:()=>be});n(57658);var o=n(67294),i=n(83355),r=n(27531),a=n(41432),s=n(21202),l=n(53965),c=n(7032),d=n(1898),u=n(13084),p=n(13447),m=n(98165),f=n(46654),g=n(23883),h=n(6258),v=n(99757),b=n(45697),y=n.n(b),_=n(45060),S=n(606),w=n(18844),k=n(75246),I=n(19584),C=n(3022),x=n(94419),T=n(64964),M=n(1742),P=n(10906),A=n(92650),R=n(27105),D=n(19037),E=n(28020),B=n(78175),F=n(41232),O=n(78429),Z=n(50627),V=n(17504),U=n(65598),L=n(73959),j=n(35328),N=n(49427),z=n(24646),q=n(44534),W=n(68859),H=n(4926),K=n(77080),G=n(88923),$=n(26664),Q=n(27724),Y=n(45131),J=n(51247),X=n(9672),ee=n(53223),te=n(23063),ne=n(45952),oe=n(79954),ie=n(5595),re=n(85893);const ae=5*I.C0,se=4,le=4,ce={quote:le,code:le,header:le,bookmark:le,external_object_instance:le,file:void 0,video:le,embed:le,tweet:le,drive:le,audio:le,gist:le,maps:le,framer:le,invision:le,figma:le,loom:le,typeform:le,mixpanel:le,codepen:le,equation:le,pdf:le,image:le,sub_header:void 0,sub_sub_header:void 0,page:void 0,collection_view:void 0,collection_view_page:void 0,column_list:void 0,column:void 0,personal_home_page:void 0,breadcrumb:void 0,text:void 0,bulleted_list:void 0,numbered_list:void 0,to_do:void 0,toggle:void 0,factory:void 0,copy_indicator:void 0,divider:void 0,link_to_collection:void 0,link_to_page:void 0,alias:void 0,transclusion_container:1,transclusion_reference:1,callout:le,table_of_contents:le,whimsical:le,miro:le,abstract:le,sketch:le,excalidraw:le,replit:le,hex:le,deepnote:le,table:1,table_row:void 0,tab:le,external_object_instance_page:le,button:void 0,ai_block:1,drawing:le},de={quote:se,code:se,bookmark:se,external_object_instance:se,file:void 0,video:se,embed:se,tweet:se,audio:se,drive:se,gist:se,maps:se,framer:se,invision:se,figma:se,loom:se,typeform:se,codepen:se,equation:se,pdf:se,header:"2em",sub_header:"1.4em",sub_sub_header:"1em",image:se,page:void 0,personal_home_page:void 0,collection_view:void 0,collection_view_page:void 0,column_list:void 0,column:void 0,breadcrumb:void 0,text:void 0,bulleted_list:void 0,numbered_list:void 0,to_do:void 0,toggle:void 0,factory:void 0,copy_indicator:void 0,divider:void 0,link_to_collection:void 0,link_to_page:void 0,alias:void 0,transclusion_container:1,transclusion_reference:1,callout:se,table_of_contents:se,whimsical:se,miro:se,abstract:se,mixpanel:se,sketch:se,excalidraw:se,replit:se,table:1,table_row:void 0,tab:se,hex:se,deepnote:se,external_object_instance_page:se,button:void 0,ai_block:1,drawing:se},ue={left:"flex-start",center:"center",right:"flex-end"};class pe extends i.Z{constructor(){super(...arguments),this.legacyTransclusionTimeout=void 0,this.blockRef=o.createRef(),this.storeTypes={blockResizerStore:W.Z},this.renderPreventSidebar=()=>{const{isInlineCollectionView:e}=this.renderStateStore.state;return e?this.renderSelectable():(0,V.Z)(this.renderSelectable)},this.renderSelectable=e=>{const{store:t,canEditList:n,isFirstItem:o,isLastItem:i}=this.props,{canDropOnto:r,canDropLeftRight:a,shouldShowParentHalo:s,showHoverMenu:l,canDrag:c,canSelect:d,shouldShowSelectionHalo:u,isSimpleTable:p,showCommentMenu:m,preventBackgroundDrag:f,shouldDisableHoverMenuDrag:g,disableForceTouch:h,canTriggerContextMenu:v}=this.renderStateStore.state;return(0,re.jsx)(oe.Z,{style:this.getStyle.state,store:t,canSelect:d,canEditText:this.canEdit(),shouldShowHalo:u,shouldShowParentHalo:s,canDrag:c,canDropAbove:n&&o,canDropBelow:n,canDropLeft:a,canDropRight:a,canDropOnto:n&&r,isLastItem:i,canNativeDropAbove:n&&o,canNativeDropBelow:n,canNativeDropLeft:a,canNativeDropRight:a,onSelectableDrop:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDrop,onNativeDrop:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleNativeDrop,canTriggerContextMenu:v,onInsertBelow:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleInsertBelow,onInsertAbove:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleInsertAbove,canInsertAbove:n,canInsertBelow:n,onEditText:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleEditText,onEnter:this.handleEnter,onRemove:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleRemove,showBlockMenuInput:!0,shouldShowHoverMenu:l,shouldDisableHoverMenuDrag:g,disableForceTouch:h,shouldShowCommentMenu:m,shouldShowDropZone:!p,isListContainer:!0,preventBackgroundDrag:f,analyticsName:"page_content",...e,children:this.renderBlock()})},this.handleEnter=e=>{this.blockRef.current&&this.blockRef.current.edit?this.blockRef.current.edit():u.Bm({environment:this.environment,targetStore:this.props.store,targetParentStore:this.props.listStore,isAtStartOfLine:!1,isClick:!1,transaction:e.transaction})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDrop=e=>{!function(e,t,n,o){const{droppedDirection:i,droppedStores:r,duplicate:a}=e;if((0,R.iG)(n,r))return void T.oV({label:(0,R.s8)(n)});p.createAndCommit({userAction:"ListItemBlock.handleDrop",environment:o,perform:e=>{u.LQ({environment:o,targetParentStore:t,targetStore:n,droppedDirection:i,droppedStores:r,duplicate:a,transaction:e})}})}(e,this.props.listStore,this.props.store,this.environment)},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleNativeDrop=e=>{!function(e,t,n,o){const{files:i,droppedDirection:r}=e;p.createAndCommit({userAction:"ListItemBlock.handleNativeDrop",environment:o,perform:e=>u.uQ({environment:o,files:i,targetParentStore:t,targetStore:n,droppedDirection:r,transaction:e})})}(e,this.props.listStore,this.props.store,this.environment)},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleInsertBelow=e=>function(e,t,n){const{insertStores:o,transaction:i}=e;return l.d9(o).reverse().map((e=>x.BE({parent:t,insert:e,after:n,transaction:i}).child))}(e,this.props.listStore,this.props.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleInsertAbove=e=>function(e,t,n){const{insertStores:o,transaction:i}=e;return l.d9(o).reverse().map((e=>x.Vt({parent:t,insert:e,before:n,transaction:i}).child))}(e,this.props.listStore,this.props.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleEditText=e=>{!function(e,t,n,o){u.DC({environment:o,targetStore:t,targetParentStore:n,isAtStartOfLine:e.isAtStartOfLine,isAtStartOfContainer:e.isAtStartOfContainer,isClick:e.isClick,transaction:e.transaction})}(e,this.props.store,this.props.listStore,this.environment)},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleRemove=e=>{!function(e,t,n){const{transaction:o}=e,i=t.getRecordStoreUIParent();i&&(i.table!==s.iU&&i.table!==k.bx&&i.table!==w.Xj||!i.valueIs($.i)||(M.uO(n,"user_flow_delete_block",o,"ListItemBlock.handleRemove"),x.Od({parent:i,childToRemove:t,transaction:o})))}(e,this.props.store,this.environment)},this.legacyTransclusionParentStore=this.createComputedStore((()=>{if(!this.isLegacyTransclusionStore.state)return;const e=this.props.listStore.getRecordStoreAtRootPath();return(0,U.OY)(e)?e:void 0})),this.isPageFullWidth=this.createComputedStore((()=>{var e;return null===(e=this.pageContext)||void 0===e?void 0:e.pageStore.isFullWidth()})),this.canEditStore=this.createComputedStore((()=>{const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return!this.props.disabled&&(!(0,f.YF)(e)&&this.props.store.canEdit())})),this.isLegacyTransclusionStore=this.createComputedStore((()=>{const e=this.props.store.getParentId();return Boolean(e&&this.props.listStore.id!==e)})),this.isReadOnlyBlockInReadWritePageStore=this.createComputedStore((()=>{const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return this.props.canEditList&&!D.OOI({environment:this.environment,blocks:[this.props.store],publicEditMode:e})})),this.renderStateStore=this.createComputedStore((()=>{const{device:e}=this.environment,{store:t,canEditList:n,disableSelection:o,disableHoverMenu:i,disableCommentMenu:r}=this.props,l=t.getFormat(),c=t.getType(),{dragging:d,temporaryFullWidth:u}=this.stores.blockResizerStore.state,p=(0,X.h)(this.props.store),m=d?u:l.block_full_width,g=c===a.Ti.page||c===a.Ti.collectionViewPage||l.alias_pointer&&(0,S.$O)(l.alias_pointer,s.iU)||c&&(0,j._A)(c,l)&&!Y.Z.isOpen(t.id),h=Boolean(c&&(0,a.dM)(c)),v=c===a.Ti.table,b=c===a.Ti.columnList,y=p===ee.DZ,_=y,w=fe(this.props.store)&&!b&&!v&&n&&!e.isPhone,k=this.pageContext&&this.pageContext.publicEditModeStore.state,I=(0,f.BZ)(k),C=y&&t.getCollectionStore();let x=y;if(C){void 0===C.getKeyStore("version").getValue()&&(x=!1)}const T=!o&&t.canRead()&&!v&&!this.isReadOnlyBlockInReadWritePageStore.state&&!x,M=!I&&T&&!y&&!v,P=M,A=!(I||i||b||y||v||(c===a.Ti.transclusionContainer||c===a.Ti.transclusionReference||c===a.Ti.aiBlock)&&function(e){return Q.default.state.stores.some((t=>t!==e&&e.uiContains(t)))}(this.props.store)),R=!r&&("comment_only"===t.getRole()||"comment"===(null==k?void 0:k.permission))&&!n&&!b&&!h&&this.environment.currentUser.isLoggedIn()&&!v,D=v?q.g$.getNumberOfUnresolvedComments({simpleTableStore:t,environment:this.environment,includeInline:!this.marginCommentsVisible.state}):0,E=n&&!b&&!this.props.disableDrag,B=Boolean(this.props.store.findRecordStoreUIAncestor((e=>e===G.default.peekTarget.state)).ancestor),F=c&&(0,a.OY)(c)&&!t.getProperties().source,O="drawing"===c&&(0,L.iZ)(t),Z=l.block_alignment,V=n&&!b&&!t.inMemoryRecordCache.isSyntheticAssistantData;return{type:c,isFullWidth:m,canDropOnto:g,canDropLeftRight:w,shouldShowParentHalo:P,showHoverMenu:A,canDrag:E,canSelect:T,shouldShowSelectionHalo:M,showCommentMenu:R,numSimpleTableComments:D,isInlineCollectionView:y,isSimpleTable:v,isInPeekRenderer:B,isMediaWithoutSource:F,preventBackgroundDrag:_,disableForceTouch:O,shouldDisableHoverMenuDrag:this.isReadOnlyBlockInReadWritePageStore.state,alignStyle:Z,canTriggerContextMenu:V}}),!0,"renderStateStore"),this.blockRendererStore=this.createComputedStore((()=>(0,X.h)(this.props.store))),this.appRenderState=this.createComputedStore((()=>E.h1(this.environment))),this.getStyle=this.createComputedStore((()=>{const{device:e}=this.environment,{store:t}=this.props,{type:n,isInPeekRenderer:o,isFullWidth:i,isInlineCollectionView:r,isSimpleTable:s,numSimpleTableComments:l,isMediaWithoutSource:c,alignStyle:d}=this.renderStateStore.state,u={};if(this.externalObjectStateStore.state){"image/*"!==this.externalObjectStateStore.state&&(u.width="100%")}else u.width="100%";if(u.maxWidth=this.getFullWidth(),(e.isMobile&&!i||this.isInColumnList()||!fe(this.props.store))&&(u.maxWidth="100%"),d&&!i&&!e.isPhone&&ue[d]?u.alignSelf=ue[d]:fe(this.props.store)&&n&&a.ib[n]?u.alignSelf="center":n&&a.Ok[n]&&(u.alignSelf="flex-start"),u.marginTop=this.props.isFirstItem?2:1,u.marginBottom=this.props.isLastItem?0:1,c?u.marginTop=se:n&&de[n]&&(u.marginTop=de[n]),c&&!this.props.isLastItem?u.marginBottom=le:!this.props.isLastItem&&n&&ce[n]&&(u.marginBottom=ce[n]),(r||s&&0===l)&&(fe(this.props.store)||e.isPhone)){const e=this.getFullWidth();u.maxWidth=o?`calc(100vw - ${2*G.PeekModeOuterPadding-H.Z.state}px)`:(0,P.Ks)(t)&&!this.isPageFullWidth.state?Z.zL:e,u.width=(0,P.Ks)(t)&&!this.isPageFullWidth.state?Z.zL:e,u.alignSelf="center"}return fe(this.props.store)&&this.marginCommentsVisible.state&&r&&(u.zIndex=1),(0,O.H)()&&this.isLegacyTransclusionStore.state&&(u.border="3px dashed deeppink"),u})),this.externalObjectStateStore=this.createComputedStore((()=>{if((0,F.Xg)()&&this.props.store.isExternalObjectInstanceBlockStore()){var e;const t=(0,F._l)({store:this.props.store,canEdit:this.canEdit(),currentUserId:this.environment.currentUser.id,isInDarkMode:"dark"===this.environment.ThemeStore.state.mode,showAction:void 0});return(null==t?void 0:t.renderConfig.previewAttributes)&&(null===(e=t.renderConfig.previewAttributes[0])||void 0===e?void 0:e.mimeType)}}),!0),this.marginCommentsVisible=this.createComputedStore((()=>(0,A.fg)(this.environment,this.props.store))),this.sidePeekWidth=this.createComputedStore((()=>(0,z.vJ)(this.environment)))}UNSAFE_willMount(e){super.UNSAFE_willMount(e),this.isCopyIndicatorWithoutPendingTransaction=(0,E.hq)(e.store)}didMount(){this.isLegacyTransclusionStore.state&&(this.legacyTransclusionTimeout=window.setTimeout((()=>{this.legacyTransclusionTimeout=void 0,this.isLegacyTransclusionStore.state&&(C.vk(this.environment,{block_type:this.props.store.getType()}),(0,_.XY)("Found a potential legacy transclusion--a block's parent is not its rendered parent!",[["block",this.props.store],["block parent id = ",this.props.store.getParentId()],["rendered parent id = ",this.props.listStore.id]]))}),ae))}willUnmount(){"number"==typeof this.legacyTransclusionTimeout&&(window.clearTimeout(this.legacyTransclusionTimeout),this.legacyTransclusionTimeout=void 0)}renderComponent(){if(!this.isCopyIndicatorWithoutPendingTransaction||this.renderStateStore.state.type!==a.Ti.copyIndicator)return function(e,t,n){const o=n.state.type;return!!o&&(Boolean(a.Ok[o])||t.isType("column_list")&&(0,B.Po)(t,e)||t.isType("external_object_instance")&&(0,F.Xg)())}(this.environment,this.props.store,this.renderStateStore)?(0,re.jsx)(te.Z,{isVisible:!0,animationStyle:this.getResizeAnimationStyle(),render:()=>this.renderPreventSidebar()}):this.renderPreventSidebar()}renderBlock(){const{renderItem:e,disabled:t,store:n,disableHoverMenu:o,disableDrag:i,disableCommentMenu:r,numberedListCounterStore:a,bulletedListFormatStore:s}=this.props,l=this.blockRendererStore.state;return!m.Pj(n)&&K.default.checkGate("hide_orphan_blocks")?null:e?e(n):l?(0,re.jsx)(l,{ref:this.blockRef,store:this.props.store,disabled:t,isFirstItem:this.props.isFirstItem,isLastItem:this.props.isLastItem,blockResizerStore:this.stores.blockResizerStore,disableCommentMenu:r,numberedListCounterStore:a,bulletedListFormatStore:s,disableHoverMenu:o,disableDrag:i,legacyTransclusionParent:this.legacyTransclusionParentStore.state}):void 0}isInColumnList(){return this.context.isInColumnList}canEdit(){return this.canEditStore.state}getResizeAnimationStyle(){const{type:e}=this.renderStateStore.state;if(e&&(0,ne.x)({environment:this.environment,type:e}))return{width:"100%"};const{dragging:t,temporaryWidth:n,temporaryFullWidth:o,temporaryPageWidth:i}=this.stores.blockResizerStore.state,{block_width:r,block_full_width:a,block_page_width:s}=this.props.store.getFormat(),l=t?n:r,c=t?i:s;return{width:(t?o:a)?this.getFullWidth():c?"100%":l}}getFullWidth(){const{device:e}=this.environment,{isInPeekRenderer:t}=this.renderStateStore.state,n=this.environment.WindowSizeStore.state.width,o=(0,z.ll)(this.environment,t)-this.sidePeekWidth.state,i=n-H.Z.state-o;if(r=this.props.store,Boolean(r.inMemoryRecordCache.snapshotData)&&!e.isPhone)return n*(ie.rp/100)-ie.mD-H.Z.state;if(N.Z.isBlockInTemplate(this.props.store)&&!e.isPhone)return n*(J.E2/100)-J.dm-H.Z.state;if(this.isInColumnList()||!fe(this.props.store))return"100%";if(t)return G.default.getPeekModeWidth(n)-H.Z.state;if((0,z.Jr)(this.environment)){let n=i;const{state:{shouldShowSidebar:o}}=this.appRenderState;return e.isMobile&&!e.isTablet||!o||(n-=(0,z.Wk)(this.environment)),!this.renderStateStore.state.isInlineCollectionView&&this.marginCommentsVisible.state&&(this.isPageFullWidth.state?n-=A.QB:n-=2*(0,A.gC)(this.environment,t,(0,P.Ks)(this.props.store))),function(e,t,n){const o=n.state.type;return!!o&&(a.GP[o]||t.isType("column_list")&&(0,B.Po)(t,e)&&t.getFormat().block_full_width)}(this.environment,this.props.store,this.renderStateStore)||(n-=2*(0,E.ui)(this.environment)),n}return i;var r}}pe.displayName="ListItemBlock",pe.contextTypes={...i.w,isInColumnList:y().any};const me=pe;function fe(e){return e.isRootOrDirectChild()}const ge="emptyDroppableKey",he="placeholder";class ve extends i.Z{constructor(){super(...arguments),this.renderItem=(e,t,n)=>e===ge?(0,re.jsx)(o.Fragment,{children:this.renderEmptyDroppable()},e):e===he?(0,re.jsx)(o.Fragment,{children:this.props.emptyPlaceholder},e):(0,re.jsx)(o.Fragment,{children:this.renderChild(e,t,n)},e),this.bulletedListFormatStore=this.createComputedStore((()=>{var e;const t=this.itemKeysStore.state,n=null===(e=this.props.bulletedListFormatStore)||void 0===e?void 0:e.getState().depth,o="number"==typeof n?n+1:0,i=new Map;let r;for(const s of t){const e=ye(s,this.props.store);r=e.getType()===a.Ti.bulletedList?e.getFormat().bullet_list_format||r:void 0,r&&i.set(s,r)}return{depth:o,blockIdFormats:i}})),this.numberedListCounterStore=this.createComputedStore((()=>{var e;const t=this.itemKeysStore.state,n=[],o=t.length?t[0]:void 0,i=o?ye(o,this.props.store):void 0,r=null==i?void 0:i.getParentId(),s=null===(e=this.props.numberedListCounterStore)||void 0===e?void 0:e.state.numberedListBlockIdsWithFormat.find((e=>e.id===r)),l=null==s?void 0:s.format;let c=void 0===(null==s?void 0:s.depth)?0:(null==s?void 0:s.depth)+1,u=l,p=0;for(const m of t)if(m!==ge&&m!==he){const e=ye(m,this.props.store),t=e.getType(),o=e.getFormat();if(u=(null==o?void 0:o.list_format)??u,t===a.Ti.numberedList){let e=o.list_start_index;(0,d.$K)(e)&&0!==p&&(e=void 0),p=(0,d.$K)(e)?e:p+1,n.push({id:m,format:u,depth:c||0,index:p})}else u=void 0,n.push({id:void 0,format:u,depth:0,index:p}),c=0,p=0}return{depth:c||0,numberedListBlockIdsWithFormat:n}})),this.canEditStore=this.createComputedStore((()=>{const e=(0,m.n3)(this.props.store)&&this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,f.YF)(e)&&this.props.store.canEdit()})),this.itemKeysStore=this.createComputedStore((()=>{const e=this.props.store.getValue()||[];let t=e;const n=function(e){const{limitParents:t}=g.Z.state,n=e.id;let o;return e.findRecordStoreUIAncestor((e=>{const i=t.get(e);return!(!i||!i.hasOwnProperty(n))&&(o=i[n],!0)})),o}(this.props.store),o=this.canEdit(),i=0===e.length;return void 0!==n&&(t=l.tP(t,0,n)),o&&i&&t.push(ge),o&&i&&this.props.emptyPlaceholder&&t.push(he),t}))}renderComponent(){if(!this.props.disableContent){var e;const t=null===(e=this.context.restrictedContentContext)||void 0===e?void 0:e.state;return t?this.itemKeysStore.state.reduce(((e,n,o,i)=>(t.indexOf(n)>=0&&e.push(this.renderItem(n,o,i)),e)),[]):this.itemKeysStore.state.map(this.renderItem)}}renderChild(e,t,n){const{disabled:o}=this.props,i=ye(e,this.props.store),r=l.qr(n,(e=>(0,c.e)(e)));return(0,re.jsx)(me,{store:i,renderItem:this.props.renderItem,listStore:this.props.store,isFirstItem:0===t,isLastItem:t===r,disabled:o,disableLayout:this.props.disableLayout,canEditList:this.canEdit(),disableSelection:this.props.disableSelection,disableHoverMenu:this.props.disableHoverMenu,disableCommentMenu:this.props.disableCommentMenu,disableDrag:this.props.disableDrag,numberedListCounterStore:this.numberedListCounterStore,bulletedListFormatStore:this.bulletedListFormatStore})}renderEmptyDroppable(){const e=h.G.createChildStore(this.props.store,{table:s.iU,id:this.props.store.id}),t=this.canEdit();return(0,re.jsx)(oe.Z,{store:e,canDropBelow:t,canNativeDropBelow:t,onSelectableDrop:e=>function(e,t,n){const{droppedDirection:o,droppedStores:i,duplicate:r}=e;p.createAndCommit({userAction:"List.handleEmptyDrop",environment:n,perform:e=>{u.LQ({environment:n,targetParentStore:t,targetStore:void 0,droppedDirection:o,droppedStores:i,duplicate:r,transaction:e})}})}(e,this.props.store,this.environment),onNativeDrop:e=>function(e,t,n){const{files:o,droppedDirection:i}=e;p.createAndCommit({userAction:"List.handleEmptyNativeDrop",environment:n,perform:e=>{u.uQ({environment:n,files:o,targetParentStore:t,targetStore:void 0,droppedDirection:i,transaction:e})}})}(e,this.props.store,this.environment),style:this.props.emptyDroppableStyle,analyticsName:"page_content",shouldShowDropZone:!0})}canEdit(){return!this.props.disabled&&(!v.n.state&&this.canEditStore.state)}}ve.displayName="List",ve.contextTypes={...r.J,...i.w};const be=ve;function ye(e,t){return h.G.createChildStore(t,{table:s.iU,id:e})}},78454:(e,t,n)=>{n.d(t,{LK:()=>b,R8:()=>y,ZP:()=>x,v2:()=>c});var o=n(67294),i=n(49271),r=n(19584),a=n(89086),s=n(68709),l=n(85893);let c=function(e){return e[e.Start=0]="Start",e[e.Center=1]="Center",e[e.End=2]="End",e}({});const{Start:d,Center:u,End:p}=c,m=o.forwardRef((function(e,t){return(0,l.jsxs)("div",{onClick:e.onClick,onMouseMove:e.onMouseMove,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onMouseDown:e.onMouseDown,style:S(e),ref:t,children:[e.left&&f(e),e.children&&(0,l.jsx)("div",{style:C(e),children:e.children}),e.right&&g(e)]})}));function f(e){return(0,l.jsx)(s.p,{...(0,a.td)("start"),allowSelectionWithin:!1,style:k(e),children:e.left})}function g(e){return(0,l.jsx)(s.p,{...(0,a.td)("end"),allowSelectionWithin:!1,style:I(e),children:e.right})}const h=4,v=2,b=24,y={...i.ZD,textAlign:"left"},_={[d]:"flex-start",[u]:"center",[p]:"flex-end"};function S(e){return{display:"flex",alignItems:r.z4(e.alignment)?_[c.Start]:_[e.alignment],width:"100%",...e.style}}function w(e){const t={display:"flex",alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0};return(e.leftRightMinHeight||r.z4(e.leftRightMinHeight))&&(t.minHeight=`calc(1.5em + ${i.ZD.paddingTop}px + ${i.ZD.paddingTop}px)`),t}function k(e){return{marginRight:v,width:b,...w(e),...e.leftStyle}}function I(e){return{marginLeft:h,...w(e),...e.rightStyle}}function C(e){return{flexGrow:1,flexShrink:1,flexBasis:0,minWidth:1,...e.childrenStyle}}const x=m},40148:(e,t,n)=>{n.d(t,{Lw:()=>u,ZP:()=>p});var o=n(67294),i=n(13991),r=n(6740),a=n(86628),s=n(24405),l=n(37810),c=n(77080),d=n(85893);const u={fontSize:12,paddingTop:2,paddingBottom:2};function p(e){const[t,n]=(0,o.useState)(!1),u=(0,a.VK)((()=>c.default.checkGate("comments_density_image_handling")),[])&&e.isInComment,p=(0,s.yK)((n=>({root:{width:"100%",fontSize:14,fontFamily:l.Z.getCompositeFontFamily(i.SP).sans,color:n.mediumTextColor,borderRadius:4,background:n.embedPlaceholderBackground,position:"relative",...e.style},right:{position:"absolute",top:4,right:4,transition:"opacity 200ms ease-in",opacity:e.shouldHideRight&&!t?0:1},inner:{padding:12,paddingRight:36,display:"flex",alignItems:"center",textAlign:"left",width:"100%",overflow:"hidden",...u?{padding:"8px 10px 10px 8px",paddingRight:10,gap:10}:{}},iconContainer:u?{background:n.tint.regular,height:32,width:32,borderRadius:6,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0}:{},icon:{width:25,height:25,flexShrink:0,marginRight:12,fill:n.mediumIconColor,...e.iconStyle},children:u?{color:n.text.secondary}:{}})),[e.style,e.shouldHideRight,e.iconStyle,t,u]);return(0,d.jsxs)("div",{style:p.root,onFocus:e=>{const t=e.target;t instanceof HTMLElement&&(0,r.E)(t)&&n(!0)},onBlur:()=>n(!1),children:[(0,d.jsxs)("div",{style:p.inner,children:[(0,d.jsx)("div",{style:p.iconContainer,children:e.iconSvg(p.icon)}),(0,d.jsx)("div",{style:{...l.Z.textOverflowStyle,...p.children},children:e.children})]}),e.right&&(0,d.jsx)("div",{style:p.right,children:e.right})]})}},65085:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(67294),i=n(24405),r=n(42402),a=n(85893);function s(e){const{children:t,maxLines:n,onMore:r,onLess:s}=e,c=(0,o.useRef)(null),d=(0,o.useRef)(null),u=(0,o.useRef)(null),[p,m]=(0,o.useState)(!1),[f,g]=(0,o.useState)(!n),[h,v]=(0,o.useState)(0),[b,y]=(0,o.useState)(0);(0,o.useEffect)((()=>{if(p){var e;const t=null===(e=d.current)||void 0===e?void 0:e.getClientRects()[0];v((null==t?void 0:t.height)??0),y((null==t?void 0:t.width)??0)}}),[p]);const _=(0,o.useCallback)((()=>{c.current&&m(c.current.scrollHeight>c.current.clientHeight+5)}),[]);(0,o.useEffect)((()=>{!f&&n&&_()}),[f,n,_]),(0,o.useEffect)((()=>{if(u.current){const e=new MutationObserver((()=>{f||_()})),t=new ResizeObserver((()=>{f||_()}));return t.observe(u.current),e.observe(u.current,{childList:!0,subtree:!0}),()=>{t.disconnect(),e.disconnect()}}}),[f,_]);const S=(0,o.useCallback)((e=>{r?r(e):(e.preventDefault(),e.stopPropagation(),g(!0))}),[r]),w=(0,o.useCallback)((e=>{s?s(e):(e.preventDefault(),e.stopPropagation(),g(!1))}),[s]),k=(0,o.useMemo)((()=>(0,a.jsx)(l,{style:{position:"absolute",right:0,bottom:0},onClick:S,children:(0,a.jsx)("div",{ref:d,children:e.moreElement})})),[e.moreElement,S]),I=(0,o.useMemo)((()=>(0,a.jsx)(l,{onClick:w,children:e.lessElement})),[e.lessElement,w]),C=(0,i.yK)((e=>({base:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:f?void 0:n},clamped:{WebkitMaskPosition:"right bottom",WebkitMask:`linear-gradient(0deg,transparent 0,transparent ${h}px,#000 ${h}px),\n\t\t\t\t\t\t\t linear-gradient(270deg,transparent 0,transparent ${b}px,#000 ${2*b}px)`}})),[n,f,h,b]);return(0,a.jsxs)("div",{style:{position:"relative"},children:[(0,a.jsxs)("div",{ref:c,style:{...C.base,...p&&!f&&C.clamped,...e.style},children:[(0,a.jsx)("div",{ref:u,children:t}),p&&f&&I]}),p&&!f&&k]})}function l(e){let{onClick:t,style:n,children:o}=e;return(0,a.jsx)(r.Z,{disableUnderline:!0,style:n,onClick:e=>{t(e)},children:o})}},54321:(e,t,n)=>{n.d(t,{Z:()=>S});var o=n(67294),i=n(86628),r=n(24405),a=n(49271),s=n(9291),l=n(26249),c=n(73819),d=n(23864),u=n(55217),p=n(78454),m=n(22491),f=n(99445),g=n(85893);function h(e){const{rank:t,index:n,listFormat:o}=e;if("numbers"===o)return{index:n,listFormat:o};if("letters"===o)return{index:(0,f.yt)(n),listFormat:o};if("roman"===o)return{index:(0,f.bW)(n),listFormat:o};{const e=t%3;return 0===e?{index:n,listFormat:"numbers"}:1===e?{index:(0,f.yt)(n),listFormat:"letters"}:{index:(0,f.bW)(n),listFormat:"roman"}}}const v=function(e){const t=(0,i.VK)((()=>{if(!e.numberedListCounterStore)return h({rank:0,index:1,listFormat:void 0});const t=e.numberedListCounterStore.state.numberedListBlockIdsWithFormat.find((t=>t.id===e.store.id));return h({rank:(null==t?void 0:t.depth)||0,index:(null==t?void 0:t.index)||0,listFormat:null==t?void 0:t.format})}),[e.numberedListCounterStore,e.store.id]);if("roman"===t.listFormat){const e=t.index;return(0,g.jsx)("span",{...(0,m.iv)({pseudoBefore:{content:`"${e}."`},textAlign:"left",width:(0,f.A8)(e),whiteSpace:"nowrap"})})}{const e=t.index.toString().length;let n=24;return 3===e?n=32:4===e?n=42:e>4&&(n="unset"),(0,g.jsx)("span",{...(0,m.iv)({pseudoBefore:{content:`"${t.index}."`},width:n,textAlign:"center",whiteSpace:"nowrap"})})}};var b=n(65187);const y=(0,s.defineMessages)({listPlaceholder:{defaultMessage:"List",id:"numberedListBlock.placeholder.label"}});function _(e,t){const n=(0,s.useIntl)(),l=o.useRef(null),m=(0,i.VK)((()=>e.store.getBlockTitleStore()),[e.store]),f=(0,i.VK)((()=>e.store.getContentStore()),[e.store]),h=(0,c.rv)(e.store),_=(0,r.yK)((()=>({root:{paddingLeft:a.ZD.paddingLeft,...h,...e.style}})),[h,e.style]),S=(0,g.jsxs)(p.ZP,{style:_.root,left:(0,g.jsx)(v,{store:e.store,numberedListCounterStore:e.numberedListCounterStore}),leftStyle:{width:"unset"},childrenStyle:{display:"flex",flexDirection:"column"},ref:l,children:[(0,g.jsxs)("div",{style:{display:"flex"},children:[(0,g.jsx)(b.Z,{style:p.R8,disabled:e.disabled,store:m,placeholder:n.formatMessage(y.listPlaceholder),pasteBehavior:"block",legacyTransclusionParent:e.legacyTransclusionParent,inPageFind:{type:"block_match"}}),(0,g.jsx)(d.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]}),!e.hideContent&&(0,g.jsx)(u.Z,{disabled:e.disabled,store:f,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag,numberedListCounterStore:e.numberedListCounterStore})]});return(0,c.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"numbered_list",getNode:()=>l.current,getBlockStore:()=>e.store})),[e.store]),S)}const S=o.memo(o.forwardRef(_),l.Z)},45952:(e,t,n)=>{n.d(t,{Z:()=>v,x:()=>g});var o=n(67294),i=n(480),r=n(86628),a=n(87292),s=n(9291),l=n(26249),c=n(73819),d=n(68859),u=n(27016),p=n(69721),m=n(85893);const f=(0,s.defineMessages)({embedButtonText:{defaultMessage:"Embed PDF",id:"pdfBlock.embeds.button.label"}});function g(e){const{type:t,environment:n}=e;return"pdf"===t&&n.device.isMobile}function h(e,t){const n=(0,i.O7)(),l=(0,s.useIntl)(),h=(0,o.useRef)(null),v=(0,r.qz)(e.blockResizerStore,d.Z),b=(0,r.VK)((()=>{const t=e.store.getType();return t&&g({environment:n,type:t})}),[n,e.store])?(0,m.jsx)(p.Z,{store:e.store,disabled:e.disabled}):(0,m.jsx)(u.ZP,{...e,blockResizerStore:v,ref:h,store:e.store,iconSvg:a.B,mediaMenuCurrentTab:"file",mediaMenuTabs:[{type:"file",fileUpload:!0},{type:"embed"}],mediaMenuEmbedCaption:(0,m.jsx)(s.FormattedMessage,{defaultMessage:"Embed a PDF file",id:"pdfBlock.embeds.caption"}),embedButtonText:l.formatMessage(f.embedButtonText),urlInputPlaceholder:"https://...",children:(0,m.jsx)(s.FormattedMessage,{defaultMessage:"Embed a PDF",id:"pdfBlock.placeholder"})});return(0,c.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"pdf",getNode:()=>{const e=h.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),b)}const v=o.memo(o.forwardRef(h),l.Z)},15950:(e,t,n)=>{n.d(t,{Z:()=>O});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(43593),l=n(17755),c=n(59054),d=n(31701),u=n(53965),p=n(54642),m=n(31781),f=n(24677),g=n(95477),h=n(24098),v=n(98742),b=n(18514),y=n(77907),_=n(34859),S=n(4926),w=n(24042),k=n(53730),I=n(68785),C=n(53336),x=n(43145),T=n(24047),M=n(85893);const P={position:"absolute",top:"calc(50% - 9px)",left:"calc(50% - 9px)",width:18,height:18},A=200,R=8,D=16,E={PASSWORD_REQUIRED:1,INVALID_PASSWORD:2};function B(e){const{value:t}=(0,y.useDependency)(y.deps.reactPDF),n=(0,i.O7)(),{device:l}=n,[c,p]=(0,o.useState)(null),[m,g]=(0,o.useState)({ready:!1,pages:0,showPages:0}),[w,k]=(0,o.useState)(e.width),{showPages:B,pages:F}=m,O=(0,a.yK)((()=>({scroller:{position:"relative",height:e.height,maxHeight:l.isMobile?"75vh":void 0,background:d.ZP.uiExtraLightGray,paddingTop:R,paddingBottom:R,paddingLeft:D,paddingRight:D,overflow:"visible"},lockIcon:{width:18,height:18,paddingRight:4},passwordContainer:{minWidth:80}})),[l.isMobile,e.height]);function Z(){f.ZH(n)}(0,o.useEffect)((()=>{const t=setTimeout((()=>{k(e.width)}),1e3);return()=>clearTimeout(t)}),[e.width]);const V=(0,r.VK)((()=>Math.min(window.innerWidth,w)-2*D-S.Z.state),[w]);function U(e,t){const n=parseInt(t,10);if(n===E.INVALID_PASSWORD){e(prompt("Invalid password. Please try again.")??"")}else p({status:"required",onPassword:e,reason:n})}function L(){if(!c)return;const e=prompt("Enter the password to open this PDF file.");c.onPassword(e??"")}function j(e){e&&e._pdfInfo&&(g({...m,pages:e._pdfInfo.numPages,showPages:1}),p(null))}function N(){g({...m,ready:!0})}function z(e){e<A&&m.ready&&B<F&&g({...m,ready:!1,showPages:B+1})}const{source:q}=e,W=(0,r.VK)((()=>(0,s.x$)(q)&&!(0,b.Sr)(n)),[q,n]);if(!t)return null;const{Document:H,Page:K}=t,G=Boolean(c);return(0,M.jsx)(h.Z,{capture:!0,render:e=>(0,M.jsxs)(C.Z,{type:_.Z.All,style:O.scroller,...(0,v.Z)(e,{onMouseDown:Z}),children:[G&&(0,M.jsx)("div",{style:O.passwordContainer,children:(0,M.jsx)(T.ZP,{family:"pdf",error:{type:"document_locked"},onClickLink:L})}),q&&(0,M.jsx)(H,{file:q,loading:G?(0,M.jsx)("div",{}):(0,M.jsx)(I.Z,{style:P}),onPassword:U,onLoadSuccess:j,options:{cMapUrl:"/notion-assets/cmaps/",cMapPacked:!0,withCredentials:W},children:u.w6(m.showPages).map((e=>(0,M.jsx)(K,{pageNumber:e+1,width:V,loading:"",renderAnnotationLayer:!1,renderInteractiveForms:!1,onRenderSuccess:N},e+1)))}),(0,M.jsx)(x.Z,{onChange:z})]})})}function F(e){const{contentWrapStyle:t,width:n,height:o,blockLocation:r,source:a}=e,d=e.store.pointer,u=(0,i.O7)(),[{value:f}]=(0,c.r5)((async()=>{if(await k.transactionQueue.awaitRecordTransaction(d),(0,s.E$)(a,[g.default.secureFileS3.url,g.default.secureFileS3V2.url])){const e=u.device;return await p.getSignedFileUrl(u,{url:a,permissionRecord:d,useS3Url:e.isIOS&&e.isMobileNative},Boolean(w.Z.state.isNotionProtocolBugFixed))}return(0,l.EK)({url:a,permissionRecord:d,baseUrl:g.default.domainBaseUrl,fullyQualified:!1,userId:u.currentUser.id})}),[u,d,a]);return(0,M.jsx)("div",{style:t,children:(0,M.jsx)(B,{source:f,width:n||500,height:o||(m.qC(r)?240:500)})})}const O={render:e=>(0,M.jsx)(F,{...e}),embedGhost:!0,resizable:!0}},24813:(e,t,n)=>{n.d(t,{Z:()=>D});var o=n(67294),i=n(480),r=n(97511),a=n(86628),s=n(24405),l=n(15145),c=n(49271),d=n(39567),u=n(38585),p=n(9291),m=n(37810),f=n(3297),g=n(9953),h=n(13447),v=n(84210),b=n(98165),y=n(46654),_=n(5971),S=n(4023),w=n(88923),k=n(13966),I=n(84076),C=n(31278),x=n(76798),T=n(26388),M=n(78454),P=n(85893);const A={paddingTop:c.ZD.paddingTop,paddingBottom:c.ZD.paddingBottom,paddingLeft:c.ZD.paddingLeft};function R(e,t){const n=(0,i.O7)(),{store:r,onClick:c}=e,[d,u]=(0,o.useState)(!1),p=(0,_.E)("enable_deleted_page_indicator"),g=(0,a.VK)((()=>{const e=b.wf(r);return p&&e}),[p,r]);(0,o.useEffect)((()=>{const{RouterStore:e,currentUser:t}=n,{route:o}=e.state;"page"===o.name&&o.shouldDuplicate&&f.nM({currentUserId:null==t?void 0:t.id,blockId:o.blockId})}),[n]);const h=(0,s.yK)((t=>({title:{fontWeight:m.Z.fontWeight.medium,lineHeight:1.3,borderBottom:e.disableUnderline?"none":`1px solid ${t.darkDividerColor}`,...g&&{color:t.mediumTextColor}}})),[e.disableUnderline,g]),y=(0,o.useCallback)((()=>u(!0)),[]),k=(0,o.useCallback)((()=>u(!1)),[]),C=(0,a.VK)((()=>(0,v.Hu)({store:r,fullyQualified:!1,pageVisitSource:l.tY.LinkInPage})),[r]),T=(0,a.VK)((()=>(0,v.Hu)({store:e.store,openInSidePeek:!0,fullyQualified:!1,pageVisitSource:l.tY.PeekOpen})),[e.store]),R=(0,a.VK)((()=>w.default.isSidePeekOpen()),[]);return(0,P.jsx)(I.Z,{ref:t,href:C,altHref:T,forceAltHref:R,external:!1,onClick:c,style:{borderRadius:4,...e.style},children:(0,P.jsx)(M.ZP,{childrenStyle:A,alignment:S.v.Center,right:(0,P.jsx)(F,{aliasStore:e.aliasStore,disabled:e.disabled,store:e.store,hovered:d}),onMouseMove:y,onMouseLeave:k,children:(0,P.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,P.jsx)(Z,{store:e.store,disabled:e.disabled,isAlias:e.isAlias,showDeletedPageIndicator:g}),(0,P.jsx)(x.Z,{store:r,style:h.title})]})})})}const D=o.forwardRef(R);function E(e){let{isAlias:t}=e;return t?(0,P.jsx)("div",{children:(0,d.Y)({position:"absolute",width:"50%",height:"50%",right:0,bottom:0})}):null}function B(e,t,n){const o=n&&n.publicEditModeStore.state;return!(0,y.YF)(o)&&(e.canEdit()&&!t)}function F(e){let{aliasStore:t,store:n,disabled:o,hovered:s}=e;const l=(0,r.l)(),c=(0,i.O7)(),{device:d}=c;return(0,a.VK)((()=>B(n,o,l)&&(s||d.isMobile)),[d.isMobile,o,s,l,n])?(0,P.jsx)(k.Z,{store:t??n,tooltipContent:(0,P.jsx)(p.FormattedMessage,{defaultMessage:"Rename, delete, and moreâ€¦",id:"page.blockActionMenu.tooltip"}),style:{marginRight:4},fadeIn:!0}):(0,P.jsx)("div",{style:{width:28}})}function O(e){let{store:t,disabled:n}=e;const o=(0,r.l)(),s=(0,i.O7)(),l=(0,a.VK)((()=>t.getIcon()),[t]),c=(0,a.VK)((()=>t.getRole()),[t]),d=(0,a.VK)((()=>t.isEmptyPage()),[t]),u=(0,a.VK)((()=>t.getType()),[t]),m=(0,a.VK)((()=>B(t,n,o)),[n,o,t]);return(0,P.jsx)(T.ZP,{renderTooltip:()=>(0,P.jsx)(p.FormattedMessage,{defaultMessage:"Change icon",id:"page.changeIcon.tooltip"}),placement:S.u.Top,disableTooltip:n||!m,render:e=>n||!m?(0,P.jsx)(C.Z,{disabled:!0,icon:l,isEmptyPage:d,role:c,size:22,style:{width:"100%",height:"100%"},...e,largeIcon:!0}):(0,P.jsx)(C.Z,{disabled:!1,bucket:"secure",store:t,icon:l,role:c,isEmptyPage:d,size:22,style:{width:"100%",height:"100%"},iconLoggingData:{recordTable:t.table,source:"subpage",block_type:u},onChange:e=>function(e,t,n){const o=t.getIconStore();o&&h.createAndCommit({userAction:"Page.handleRecordIconChange",environment:n,perform:t=>{g.sO({store:o,value:e,transaction:t})}})}(e,t,s),...e,largeIcon:!0})})}function Z(e){let{showDeletedPageIndicator:t,store:n,disabled:o,isAlias:r}=e;const a=(0,s.Fg)(),l=(0,i.O7)();if(t){const e=l.device.isSafari||l.device.isIOS;return(0,u.tr)({isSafariOrIOS:e,theme:a})}return(0,P.jsxs)("div",{style:{position:"relative",width:24,height:24,marginRight:4},children:[(0,P.jsx)(O,{store:n,disabled:o}),(0,P.jsx)(E,{isAlias:r})]})}},4382:(e,t,n)=>{n.d(t,{Z:()=>T});var o=n(67294),i=n(73935),r=n(480),a=n(86628),s=n(15145),l=n(26249),c=n(26189),d=n(66324),u=n(75754),p=n(993),m=n(32741),f=n(66213),g=n(14976),h=n(83105),v=n(84210),b=n(73819),y=n(46735),_=n(22294),S=n(72014),w=n(88923),k=n(68709),I=n(24813),C=n(85893);function x(e,t){const n=(0,r.O7)(),l=(0,o.useContext)(f.ZO),x=(0,o.useRef)(null),T=(0,o.useRef)(null),M=(0,b.PE)(e.store,e.disabled),P=(0,b.rv)(e.store),A=(0,o.useCallback)((()=>{d.Se(n),c.SK(n,{page_visit_id:S.$g.getCurrentPageVisitId(),mentioned_page_id:e.store.id,source_type:"page_block",hover_preview_enabled:!0,is_navigable_block:e.store.isNavigableBlock()}),y.Z.recordVisit({id:e.store.id,systemBlockType:e.store.getSystemBlockTypeStore().getValue(),type:h.vu.Link,currentUserId:n.currentUser.id})}),[n,e.store]),R=(0,o.useCallback)((()=>{if(!T||!T.current)return;const t=i.findDOMNode(T.current);return(0,g.We)(e.store,t)}),[e.store]),D=(0,o.useCallback)((t=>{const o=R(),i=e.store.getTitleStore();i&&o&&p.Nh({environment:n,event:t,interactiveToken:o,store:i,canEdit:M})}),[M,n,R,e.store]),E=(0,o.useCallback)((t=>{const o=R(),i=e.store.getTitleStore();i&&o&&p.Zl({environment:n,event:t,interactiveToken:o,store:i,canEdit:M})}),[M,n,R,e.store]),B=(0,o.useCallback)((()=>{if(l){const t=(0,v.ZP)({store:e.store,pageVisitSource:s.tY.Create});l(t)}else u._c({environment:n,store:e.store,visitType:h.vu.Link,openInSidePeek:w.default.isSidePeekOpen(),pageVisitSource:s.tY.Create})}),[n,l,e.store]);(0,o.useEffect)((()=>()=>{m.qA(e.store.getTitleStore())}),[e.store]);const F=(0,a.VK)((()=>e.store.recordStoreParentDiffersFromPersistedParent()),[e.store]);return(0,b.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"page",getNode:()=>x.current,getBlockStore:()=>e.store,activate:B,handleCreated(){B(),_.Z.setKeyboardMode(!1)}})),[B,e.store]),(0,C.jsx)(k.p,{allowSelectionWithin:!1,onMouseOver:D,onMouseOut:E,ref:x,children:(0,C.jsx)(I.Z,{ref:T,store:e.store,style:{...P,...e.style},isAlias:F,disabled:e.disabled,onClick:A})}))}const T=o.memo(o.forwardRef(x),l.Z)},35541:(e,t,n)=>{n.d(t,{u:()=>A});n(67294);var o=n(480),i=n(86628),r=n(24405),a=n(41892),s=n(70203),l=n(1898),c=n(41393),d=n(59175),u=n(21914),p=n(7825),m=n(38376),f=n(51077),g=n(12981),h=n(36596),v=n(65453),b=n(54321),y=n(4382),_=n(16472),S=n(99571),w=n(51704),k=n(17970),I=n(6684),C=n(4859),x=n(25157),T=n(91497),M=n(85893);let P;function A(e){const{store:t,restrictedBlockIds:n,tableRenderMode:o}=e,i=t.getType();if(i){if(!P||n){const e={text:k.Z,page:y.Z,collection_view_page:c.Z,bulleted_list:p.Z,numbered_list:b.Z,toggle:C.ZP,quote:_.ZP,to_do:I.Z,header:v.Z,sub_header:S.Z,sub_sub_header:w.Z,callout:m.Z,transclusion_container:x.Z,transclusion_reference:T.Z,alias:u.Z},t=(0,l.Yd)({abstract:!0,audio:!0,code:!0,codepen:!0,deepnote:!0,drive:!0,equation:!0,excalidraw:!0,figma:!0,file:!0,framer:!0,gist:!0,hex:!0,invision:!0,loom:!0,maps:!0,miro:!0,mixpanel:!0,pdf:!0,replit:!0,sketch:!0,tweet:!0,typeform:!0,video:!0,whimsical:!0}),i=Object.keys(t).reduce(((e,t)=>(e[t]=R,e)),{}),r={collection_view:E,table:"image"===o?E:D(n)};P={...e,...i,...r,copy_indicator:void 0,personal_home_page:void 0,button:void 0,image:void 0,link_to_page:void 0,link_to_collection:void 0,table_row:void 0,external_object_instance_page:void 0,external_object_instance:void 0,bookmark:void 0,table_of_contents:void 0,tab:void 0,column_list:void 0,column:void 0,embed:void 0,drawing:void 0,divider:void 0,breadcrumb:void 0,factory:void 0,ai_block:void 0}}return P[i]}}function R(e){let{store:t}=e;const[n,o]=(0,i.VK)((()=>{var e;const n=t.getType(),o=null===(e=t.getTitleStore())||void 0===e?void 0:e.getValue();return[n,s.QaF(o)]}),[t]),l=(0,r.yK)((e=>({card:{display:"flex",padding:10,borderRadius:6,boxShadow:e.inputBoxShadow,marginBottom:6,gap:10},shimmer:{backgroundColor:e.largeShimmerColor,width:150,borderRadius:6}})),[]),c=function(e){const t=e&&B[e];if("string"==typeof t)return t;return a.Z.images.icons.unknownTypePng}(n);return(0,M.jsxs)("div",{style:l.card,children:[(0,M.jsx)(f.Z,{type:"image_url",imageURL:c,size:25,imageStyle:{marginLeft:4,marginRight:4}}),o.length>0?(0,M.jsx)("span",{children:o}):(0,M.jsx)(h.Z,{emphasized:!0,style:l.shimmer})]})}function D(e){return t=>{let{store:n,...o}=t;const{tableStore:r,isPartialTable:a}=(0,i.VK)((()=>{if(n.isType("table"))return{tableStore:n,isPartialTable:!1};const e=n.getParentBlockStore();return e&&e.isType("table")?{tableStore:e,isPartialTable:!0}:{tableStore:void 0,isPartialTable:!1}}),[n]);return r?(0,M.jsx)(d.Z,{...o,store:r,showRowIds:a?e:void 0}):null}}function E(e){let{store:t}=e;const n=(0,o.O7)(),s="collection_view"===(0,i.VK)((()=>t.getType()),[t]),l=(0,r.yK)((e=>({image:{width:"100%",borderRadius:4,border:`1px solid ${e.lightDividerColor}`},container:{marginBottom:6}})),[]),c=(0,i.VK)((()=>"dark"===n.ThemeStore.state.mode),[n.ThemeStore]),d=c?a.Z.images.blockRendererCovers.collectionTableDarkPng:a.Z.images.blockRendererCovers.collectionTableLightPng,u=c?a.Z.images.blockRendererCovers.plainTableDarkPng:a.Z.images.blockRendererCovers.plainTableLightPng;return(0,M.jsx)("div",{style:l.container,children:(0,M.jsx)(g.Z,{src:s?d:u,style:l.image})})}const B={equation:a.Z.images.blocks.texPng,audio:a.Z.images.blocks.audioPng,file:a.Z.images.blocks.filePng,pdf:a.Z.images.blocks.pdfPng,code:a.Z.images.blocks.codePng,video:a.Z.images.blocks.videoPng,abstract:a.Z.images.blocks.abstractPng,codepen:a.Z.images.blocks.codepenPng,deepnote:a.Z.images.blocks.deepnotePng,drive:a.Z.images.blocks.drivePng,excalidraw:a.Z.images.blocks.excalidrawPng,figma:a.Z.images.externalIntegrations.figmaIconPng,framer:a.Z.images.blocks.framerPng,gist:a.Z.images.blocks.githubPng,hex:a.Z.images.blocks.hexPng,invision:a.Z.images.blocks.invisionPng,loom:a.Z.images.blocks.loomPng,maps:a.Z.images.blocks.mapsPng,miro:a.Z.images.blocks.miroPng,mixpanel:a.Z.images.blocks.mixpanelPng,replit:a.Z.images.blocks.replitPng,sketch:a.Z.images.blocks.sketchPng,typeform:a.Z.images.blocks.typeformPng,tweet:a.Z.images.blocks.twitterPng,whimsical:a.Z.images.blocks.whimsicalPng}},32469:(e,t,n)=>{n.d(t,{Z:()=>c});n(67294);var o=n(90199),i=n(9291),r=n(31701),a=n(37810),s=n(26388),l=n(85893);const c=function(e){let{style:t}=e;return(0,l.jsx)(s.ZP,{renderTooltip:()=>(0,l.jsx)(i.FormattedMessage,{defaultMessage:"Only you can see this page",id:"privatePageBadge.tooltip"}),render:e=>(0,l.jsx)("div",{style:{display:"flex",alignItems:"flex-start",...t||{}},...e,children:(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,l.jsx)("div",{style:{flexShrink:0,marginTop:-1,marginRight:4,fill:r.ZP.red},children:(0,o.b)({width:12})}),(0,l.jsx)("span",{style:{fontSize:12,fontWeight:a.Z.fontWeight.semibold,color:r.ZP.red},children:(0,l.jsx)(i.FormattedMessage,{defaultMessage:"Private",id:"privatePageBadge.label"})})]})})})}},16472:(e,t,n)=>{n.d(t,{NE:()=>v,ZP:()=>_,nr:()=>b});var o=n(67294),i=n(86628),r=n(24405),a=n(49271),s=n(9291),l=n(26249),c=n(33929),d=n(73819),u=n(23864),p=n(4029),m=n(55217),f=n(65187),g=n(85893);const h=(0,s.defineMessages)({emptyPlaceholder:{defaultMessage:"Empty quote",id:"quoteBlock.emptyQuote.placeholder"}}),v=3,b=14;function y(e,t){let{disabled:n,disableCommentMenu:s,disableDrag:l,disableHoverMenu:y,hideContent:_,store:S,style:w}=e;const k=(0,o.useRef)(null),I=(0,d.rv)(S),C=(0,i.VK)((()=>{var e;return null===(e=S.getFormat())||void 0===e?void 0:e.quote_size}),[S]),x=(0,i.VK)((()=>S.getBlockTitleStore()),[S]),T=(0,i.VK)((()=>S.getContentStore()),[S]),M=(0,r.yK)((()=>({root:{margin:0,fontSize:"large"===C?"1.2em":"1em",...a.ZD,...I,display:"flex",...w},padding:{paddingLeft:a.ZD.paddingLeft,paddingRight:a.ZD.paddingRight},innerStyle:{borderLeft:`${v}px solid currentColor`,paddingLeft:b,paddingRight:b,width:"100%"}})),[I,C,w]),{blockInsetRight:P}=(0,o.useContext)(p.a),A=(0,g.jsxs)("blockquote",{style:M.root,ref:k,children:[(0,g.jsxs)("div",{style:M.innerStyle,children:[(0,g.jsx)(f.Z,{style:M.padding,placeholderStyle:{left:b,width:"auto",right:b},disabled:n,store:x,placeholder:c.default.formatMessage(h.emptyPlaceholder),pasteBehavior:"block",inPageFind:{type:"block_match"}}),!_&&(0,g.jsx)(p.a.Provider,{value:{blockInsetRight:P+b},children:(0,g.jsx)(m.Z,{disabled:n,store:T,disableCommentMenu:s,disableHoverMenu:y,disableDrag:l})})]}),(0,g.jsx)(u.Z,{disableCommentMenu:s,hideContent:_,store:S})]});return(0,d.ez)(S,t,(0,o.useMemo)((()=>({renderedType:"quote",getNode:()=>k.current,getBlockStore:()=>S})),[S]),A)}const _=o.memo(o.forwardRef(y),l.Z)},79954:(e,t,n)=>{n.d(t,{Z:()=>q});var o=n(67294),i=n(83355),r=n(480),a=n(24405),s=n(14577),l=n(51454),c=n(31701),d=n(19584),u=n(6404),p=n(42239),m=n(87420),f=n(52989),g=n(24677),h=n(13447),v=n(10906),b=n(11368),y=n(84064),_=n(43250),S=n(12534),w=n(98742),k=n(39500),I=n(45162),C=n(73959),x=n(89224),T=n(89086),M=n(95802),P=n(55367),A=n(10084),R=n(80796),D=n(20144),E=n(69784),B=n(49085);class F extends B.default{getInitialState(){return{shouldShowSelectionHalo:!1,shouldShowDropParentHalo:!1,shouldShowDropZone:!1,shouldShowDropZoneHint:!1,forceRenderSelectionHalo:!1,showActionIsInFlight:!1}}}const O=F;var Z=n(27724),V=n(24666),U=n(23063),L=n(6685),j=n(85893);const N=4;class z extends i.Z{constructor(){super(...arguments),this.lastDropZoneHintIndex=void 0,this.selectableDivRef=o.createRef(),this.storeTypes={draggableStore:A.Z,selectableStore:O},this.computedStore=this.createComputedStore((()=>{const e=function(e){const t=P.ZP.state;if(!t.isDragging)return;const{currentHintDropZones:n}=t;if(n)return n.findIndex((t=>t.type===P.Dl.Selectable&&t.store===e))}(this.props.store);!d.z4(e)&&e>=0&&(this.lastDropZoneHintIndex=e);const t=function(e,t,n){const{device:o}=t;if(!n||!(0,C.Mn)(o))return!1;if(Y.state!==Z.SelectionPhase.Selected)return!1;const{stores:i}=Z.default.state;if(i.indexOf(e)>=0&&!P.ZP.state.isDragging)return!0;return!1}(this.props.store,this.environment,this.props.shouldShowHalo),n=function(e,t){if(!t)return!1;const n=P.ZP.state;if(!n.isDragging)return!1;const{currentParentStore:o,currentHintDropZones:i,currentDropZone:r}=n;if(r&&r.type===P.Dl.DropTarget)return!1;return i.some((e=>e.direction===P.vh.Left||e.direction===P.vh.Right))?Boolean(r&&r.store===e):o===e}(this.props.store,Boolean(this.props.shouldShowHalo)),o=function(e,t){const n=P.ZP.state;if(!n.isDragging)return;const{currentDropZone:o}=n;if(o&&o.type===P.Dl.Selectable&&o.store===e&&t)return o.direction}(this.props.store,Boolean(this.props.shouldShowDropZone)),i=function(e,t){const n=P.ZP.state;if(!n.isDragging)return;const{currentHintDropZones:o}=n;if(o&&t){const t=o.find((t=>t.type===P.Dl.Selectable&&t.store===e));if(t)return t.direction}}(this.props.store,Boolean(this.props.shouldShowDropZone)),r=this.lastDropZoneHintIndex,a=this.stores.draggableStore.state.dragging,s=this.stores.draggableStore.hasDragged(),l=this.stores.draggableStore.state.initiator,c=this.stores.selectableStore.state,u=this.props.store.getType()||"unknown";return{isDragging:a,initiator:l,hasDragged:s,shouldShowSelectionHalo:t||c.forceRenderSelectionHalo||Boolean(this.props.shouldForceRenderSelectionHalo),shouldShowDropParentHalo:n,currentDropZone:o,dropZoneHint:i,dropZoneHintIndex:r,shouldRenderSelectionHalo:t||c.shouldShowSelectionHalo||c.forceRenderSelectionHalo||Boolean(this.props.shouldForceRenderSelectionHalo),shouldRenderDropParentHalo:n||c.shouldShowDropParentHalo,shouldRenderDropZoneHint:!d.z4(i)||c.shouldShowDropZoneHint,shouldRenderDropZone:!d.z4(o)||c.shouldShowDropZone,propStoreType:u,showActionIsInFlight:c.showActionIsInFlight}}))}get registries(){return[M.C]}getNode(){return this.props.nodeRef?this.props.nodeRef.current:this.selectableDivRef.current}getContextClosestSelectable(){var e;return null===(e=this.context.selectable)||void 0===e?void 0:e.closestSelectable}getContextSelectableContainer(){var e;return null===(e=this.context.selectable)||void 0===e?void 0:e.selectableContainer}getContextVerticalScroller(){var e;return null===(e=this.context.scrollerContext)||void 0===e?void 0:e.verticalScroller}getContextHorizontalScroller(){var e;return null===(e=this.context.scrollerContext)||void 0===e?void 0:e.horizontalScroller}renderComponent(){var e;const{isDragging:t,initiator:n,hasDragged:o,shouldShowDropParentHalo:i,shouldShowSelectionHalo:r,currentDropZone:a,dropZoneHint:s,dropZoneHintIndex:l,shouldRenderSelectionHalo:c,shouldRenderDropParentHalo:d,shouldRenderDropZoneHint:p,shouldRenderDropZone:f,propStoreType:b,showActionIsInFlight:M}=this.computedStore.state,P=c||d||p||f,A=`${_.euV} notion-${b}-block`,R=this.renderDraggable((e=>(0,j.jsxs)("div",{ref:this.selectableDivRef,style:J({isPositionRelative:P,isDragging:t,hasDragged:o,initiator:n,showActionIsInFlight:M},this.theme,this.props.canDrag,this.props.style),"data-block-id":this.props.store.id,className:this.props.className?`${A} ${this.props.className}`:A,...(0,w.Z)(e||{},{onDoubleClick:e=>function(e,t,n){t||(0,S.ZP)({event:e,context:S.Af.EditorDoubleClick,callback:()=>{n&&n(e)}})}(e,this.props.canSelect,this.props.onDoubleClick),onContextMenu:e=>function(e,t,n,o,i,r,a){const{device:s}=n;if(s.isAndroid){const n=V.default.state,o=(0,C.mh)(t),i=o&&"empty"!==n.mode&&(0,I.r)(n.multiSelection,o);if("editing"!==n.mode||!i)return x.isExpanded(x.get())||e.preventDefault(),e.stopPropagation(),!1}if(o){const o=(0,v.fm)(t);(0,S.ZP)({event:e,context:S.Af.EditorContextMenu,callback:()=>{e.preventDefault(),g.Ys({environment:n,store:t}),u.Qn({environment:n,stores:i||Z.default.state.stores,left:e.clientX,top:e.clientY,actionSectionGroupKey:r||"default",showInput:Boolean(a),analyticsFrom:"content_block_menu",optionalAnalyticsProperties:{collectionContextStore:o}})}})}}(e,this.props.store,this.environment,this.props.canTriggerContextMenu,this.props.contextMenuAndDragStores,this.props.actionSectionGroupKey,this.props.showBlockMenuInput),onMouseOver:e=>function(e,t,n){n&&(0,S.ZP)({event:e,context:S.Af.EditorMouseOver,callback:()=>{D.Z.setState({...D.Z.state,hoveredStore:t,lastHoveredStore:t})}})}(e,this.props.store,this.props.canSelect),onMouseOut:()=>{return e=this.props.store,void(D.Z.state.hoveredStore===e&&D.Z.setState({...D.Z.state,hoveredStore:void 0}));var e},onClick:e=>function(e,t,n,o,i,r){(0,S.ZP)({event:e,context:S.Af.EditorClick,callback:()=>{var a;if(null!==(a=Z.default.getDefaultContainerFromTarget(e.target))&&void 0!==a&&a.isPeekRenderer()||m.E5(n),(0,C.Mn)(n.device))k.X9()||!o||t.isInlineCollectionView()||g.Ys({environment:n,store:t,toggle:g.ji(n),selectBetween:g.OS()});else if(i){const t=(0,T.Rb)(e.target);t&&h.createAndCommit({userAction:"Selectable.handleClick",environment:n,perform:e=>{i({isAtStartOfLine:"start"===t,isClick:!0,transaction:e})}})}r&&r(e)}})}(e,this.props.store,this.environment,this.props.canSelect,this.props.onEditText,this.props.onClick),onMouseMove:this.props.onMouseMove,onMouseDown:this.props.onMouseDown,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave}),children:[this.props.children,c&&(0,j.jsx)(W,{selectableStore:this.stores.selectableStore,style:this.props.haloStyle,isVisible:r}),d&&(0,j.jsx)(H,{selectableStore:this.stores.selectableStore,isVisible:i}),p&&(0,j.jsx)(Q,{selectableStore:this.stores.selectableStore,direction:s,index:l,aboveDropZoneMargin:this.props.aboveDropZoneMargin,belowDropZoneMargin:this.props.belowDropZoneMargin,dropzoneGap:this.props.dropzoneGap}),f&&(0,j.jsx)($,{selectableStore:this.stores.selectableStore,direction:a,aboveDropZoneMargin:this.props.aboveDropZoneMargin,belowDropZoneMargin:this.props.belowDropZoneMargin,dropzoneGap:this.props.dropzoneGap})]})));return(0,j.jsx)(y.ld,{value:{selectableContainer:null===(e=this.context.selectable)||void 0===e?void 0:e.selectableContainer,closestSelectable:this},children:R})}displaySelectionHalo(e){this.stores.selectableStore.state.forceRenderSelectionHalo||(this.stores.selectableStore.update((e=>({...e,forceRenderSelectionHalo:!0}))),window.setTimeout((()=>{this.stores.selectableStore.update((e=>({...e,forceRenderSelectionHalo:!1})))}),e))}renderDraggable(e){const{device:t}=this.environment;return this.props.canDrag?(0,j.jsx)(L.Z,{draggableStore:this.stores.draggableStore,forceTouch:t.isMobile&&!this.props.disableForceTouch,touchDragOnly:this.props.touchDragOnly,onDraggableDragStart:e=>function(e,t,n,o){const{mobileNative:i}=t;n&&(e.preventDefault(),i&&i.buzz());o&&o(e)}(e,this.environment,this.props.canDrag,this.props.onDraggableDragStart),onDraggableDragMove:e=>function(e,t,n,o,i,r,a,s,l){const{device:c}=n;o&&!i?P.ZP.state.isDragging?p.td(n,{currentX:e.currentX,currentY:e.currentY}):k.X9()&&(g.Ys({environment:n,store:t,toggle:g.ji(n),selectBetween:g.OS()}),p.f$(n,{startX:e.startX,startY:e.startY,stores:r||Z.default.state.stores,isNativeDrag:!1,getGhostElement:a})):E.default.state.isActive||c.isPhone||f.AI({environment:n,target:e.target,startX:e.startX,startY:e.startY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!s});l&&l(e)}(e,this.props.store,this.environment,this.props.canDrag,this.props.preventBackgroundDrag,this.props.contextMenuAndDragStores,this.props.getGhostElement,this.props.disableScrollToRevealHorizontal,this.props.onDraggableDragMove),onDraggableDragEnd:e=>function(e,t,n,o,i){const{device:r}=n;r.isMobile&&R.Z.state.isDragging&&e.preventDefault();o&&P.ZP.state.isDragging&&p.fX({environment:n,shiftKey:e.shiftKey,optionKey:e.optionKey,commandKey:e.commandKey,analyticsFrom:t});i&&i(e)}(e,this.props.analyticsName,this.environment,this.props.canDrag,this.props.onDraggableDragEnd),onDraggableDragCancel:e=>function(e,t,n,o){n&&P.ZP.state.isDragging&&(p.cQ(t),g.ZH(t));o&&o(e)}(e,this.environment,this.props.canDrag,this.props.onDraggableDragCancel),disableHorizontalEdgeScroll:this.props.disableHorizontalDragEdgeScroll,render:e}):e(void 0)}}z.displayName="Selectable",z.contextTypes={...b.I3,...y.Tf,...i.w};const q=z;function W(e){return(0,j.jsx)(U.Z,{isVisible:e.isVisible,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},onAnimationStart:()=>{e.selectableStore.setState({...e.selectableStore.state,shouldShowSelectionHalo:!0})},onAnimationEnd:()=>{e.isVisible||e.selectableStore.setState({...e.selectableStore.state,shouldShowSelectionHalo:!1})},render:()=>(0,j.jsx)("div",{className:_.No6,style:{position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,background:c.ZP.blueWithAlpha(.14),zIndex:l.py,borderRadius:4,...e.style}})},"halo")}function H(e){return(0,j.jsx)(U.Z,{isVisible:e.isVisible,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},onAnimationStart:()=>{e.selectableStore.setState({...e.selectableStore.state,shouldShowDropParentHalo:!0})},onAnimationEnd:()=>{e.isVisible||e.selectableStore.setState({...e.selectableStore.state,shouldShowDropParentHalo:!1})},render:()=>(0,j.jsx)("div",{className:_.No6,style:{position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,background:c.ZP.blueWithAlpha(.07),borderRadius:4}})},"parent")}function K(e,t,n){if(void 0===n)return{};const o=e.isMobile?3:2;return n===P.vh.Above||n===P.vh.Below?{position:"relative",left:-o,width:o,height:N,background:t.contentBackground,transform:"translateZ(100px)"}:{position:"relative",top:-o,width:N,height:o,background:t.contentBackground,transform:"translateZ(100px)"}}function G(e,t,n,o,i){const r={position:"absolute",pointerEvents:"none",background:c.ZP.blueWithAlpha(.43),zIndex:l.S1-t};if(e===P.vh.Onto)r.left=0,r.top=0,r.right=0,r.bottom=0,r.background=c.ZP.blueWithAlpha(.14);else if(e===P.vh.Above||e===P.vh.Below){const t=4;r.left=0,r.right=0,e===P.vh.Above?(r.top=-t,n&&(r.top-=n)):(r.bottom=-t,o&&(r.bottom-=o)),r.height=N}else{const t=8;r.top=0,r.bottom=0,e===P.vh.Left?r.left=i?-i:-t:r.right=i?-i:-t,r.width=N}return r}function $(e){const t=(0,r.Fy)(),n=(0,a.Fg)(),o=void 0!==e.direction;return(0,j.jsx)(U.Z,{isVisible:o,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},onAnimationStart:()=>{e.selectableStore.setState({...e.selectableStore.state,shouldShowDropZone:!0})},onAnimationEnd:()=>{o||e.selectableStore.setState({...e.selectableStore.state,shouldShowDropZone:!1})},render:()=>(0,j.jsx)("div",{style:G(e.direction,0,e.aboveDropZoneMargin,e.belowDropZoneMargin,e.dropzoneGap),children:e.direction!==P.vh.Onto&&(0,j.jsx)("div",{style:K(t,n,e.direction)})})},"dropZone")}function Q(e){const t=(0,r.Fy)(),n=(0,a.Fg)(),o=!d.z4(e.direction);return(0,j.jsx)(U.Z,{isVisible:o,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},onAnimationStart:()=>{e.selectableStore.setState({...e.selectableStore.state,shouldShowDropZoneHint:!0})},onAnimationEnd:()=>{o||e.selectableStore.setState({...e.selectableStore.state,shouldShowDropZoneHint:!1})},render:()=>(0,j.jsx)("div",{style:G(e.direction,(e.index||0)+1,e.aboveDropZoneMargin,e.belowDropZoneMargin,e.dropzoneGap),children:(0,j.jsx)("div",{style:K(t,n,e.direction)})})},"hint")}const Y=new s.Z((()=>Z.default.state.phase),{debugName:"SelectionPhaseStore"});function J(e,t,n,o){const{isPositionRelative:i,isDragging:r,hasDragged:a,showActionIsInFlight:s,initiator:l}=e,c={};return"touch"===l&&(c.transition="transform 200ms ease-out",n&&r&&!a&&(c.boxShadow=t.mediumBoxShadow,c.transform="scale(1.05)",c.borderRadius=3)),i&&(c.position="relative"),s&&(c.opacity=.5),{...c,...o}}},23189:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var o=n(24405),i=n(31701),r=n(37810),a=n(85893);const s=function(e){const t=(0,o.Fg)(),{divider:n,large:s,block:l,children:c,hasMarginTop:d,small:u,style:p,smallMarginBottom:m,isCritical:f}=e,g="full"===n;return(0,a.jsx)("div",{style:{borderBottom:g?`1px solid ${t.regularDividerColor}`:0,marginBottom:g?16:m?2:8,marginTop:d?16:0,paddingBottom:g?12:0,fontSize:g?16:s?14:u?12:14,fontWeight:g?r.Z.fontWeight.medium:400,width:l?"100%":"auto",color:f?i.ZP.red:t.regularTextColor,...p},children:c})}},13490:(e,t,n)=>{n.d(t,{Z:()=>r});n(67294);var o=n(24405),i=n(85893);const r=function(e){const t=(0,o.yK)((t=>{const{hasMarginTop:n}=e,o={display:"block",marginBottom:4,fontSize:12,color:t.mediumTextColor};return n&&(o.marginTop=14),{style:o}}),[e]),{forId:n,children:r,style:a}=e;return(0,i.jsx)("label",{style:{...t.style,...a},htmlFor:n,children:r})}},35021:(e,t,n)=>{n.d(t,{Z:()=>p});var o=n(67294),i=n(480),r=n(43593),a=n(54642),s=n(95477),l=n(23586),c=n(24042),d=n(53730),u=n(85893);function p(e){const t=(0,i.O7)(),n=(0,o.useCallback)((async e=>r.E$(e.url,[s.default.secureFileS3.url,s.default.secureFileS3V2.url])?(e.permissionRecord&&await d.transactionQueue.awaitRecordTransaction(e.permissionRecord),a.getSignedFileUrl(t,e,Boolean(c.Z.state.isNotionProtocolBugFixed))):e.url),[t]);return(0,u.jsx)(l.Z,{request:{url:e.url,permissionRecord:e.permissionRecord,useS3Url:e.useS3Url},performRequest:n,render:e.render})}},6854:(e,t,n)=>{n.d(t,{Pn:()=>b,ow:()=>y,wr:()=>_});var o=n(67294),i=n(480),r=n(24405),a=n(15145),s=n(1436),l=n(55863),c=n(9291),d=n(52423),u=n(75754),p=n(64964),m=(n(84076),n(89728)),f=n(73744),g=n(83105),h=n(85893);const v=(0,c.defineMessages)({open:{defaultMessage:"Open",id:"automations.buttonTrigger.open"},undo:{defaultMessage:"Undo",id:"automations.buttonTrigger.undo"}});function b(e){const t=(0,r.Fg)();return(0,h.jsx)(m.Z,{...e,style:{color:t.regularInvertedTextColor,fontWeight:500,height:void 0,marginLeft:0,...e.style}})}function y(e){const{onUndo:t}=e,n=(0,i.O7)();return(0,h.jsx)(b,{onClick:()=>{d.Yw(n,!0),p.rN(),null==t||t()},children:(0,h.jsx)(c.FormattedMessage,{defaultMessage:"Undo",id:"snackbar.undo.title"})})}function _(e){const{blockStoreToOpen:t,performUndo:n}=e,d=(0,i.O7)(),p=(0,r.yK)((e=>({icon:{fill:e.regularInvertedTextColor},wrap:{display:"flex",columnGap:8}})),[]),m=(0,o.useMemo)((()=>t?e=>{u._c({environment:d,openInNew:(0,f.DJ)(e),store:t,visitType:g.vu.Link,pageVisitSource:a.tY.ButtonAutomation})}:void 0),[t,d]);return(0,h.jsxs)("div",{style:p.wrap,children:[m&&(0,h.jsx)(b,{onClick:m,icon:e=>(0,s.g)({...e,...p.icon,width:16,height:16}),style:{paddingRight:0},children:(0,h.jsx)(c.FormattedMessage,{...v.open})}),n&&(0,h.jsx)(b,{onClick:n,icon:e=>(0,l.s)({...e,...p.icon,marginTop:-2,width:16,height:16}),children:(0,h.jsx)(c.FormattedMessage,{...v.undo})})]})}},99571:(e,t,n)=>{n.d(t,{Z:()=>y});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(49271),l=n(76490),c=n(9291),d=n(26249),u=n(35328),p=n(73819),m=n(23864),f=n(65187),g=n(17377),h=n(85893);const v=(0,c.defineMessages)({placeholder:{defaultMessage:"Heading 2",id:"subheaderBlock.placeholder"}});function b(e,t){const n=(0,c.useIntl)(),d=(0,i.O7)(),b=(0,i.Fy)(),y=(0,o.useRef)(null),_=(0,p.rv)(e.store),S=(0,p.Iy)(e.store),w=(0,r.VK)((()=>e.store.getBlockTitleStore()),[e.store]),k=(0,a.yK)((e=>{const t=(b.isMobile?1.25:l.Lh)*l.u9,n=b.isMobile?1.25:l.Lh;return{root:{display:"flex",width:"100%",..._},toggle:{height:`${t}em`,marginTop:b.isMobile?1:s.ZD.paddingTop,marginBottom:s.ZD.paddingBottom},headerText:{...s.ZD,...(0,l.HV)({fontSizeValue:n,fontFamily:S})},headerTextPlaceholder:{WebkitTextFillColor:e.headerBlockPlaceholderTextColor}}}),[_,b.isMobile,S]);return(0,p.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"sub_header",getNode:()=>y.current,getBlockStore:()=>e.store,activate(){u.th(d,e.store,e.hideContent)}})),[d,e.hideContent,e.store]),(0,h.jsx)("div",{ref:y,style:{...k.root,...e.style},children:(0,h.jsxs)(g.Z,{store:e.store,toggleStyle:k.toggle,childrenStyleWhenToggleable:{display:"flex"},hideContent:e.hideContent,disabled:e.disabled,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag,children:[(0,h.jsx)(f.Z,{tagName:"h3",disabled:e.disabled,store:w,placeholder:n.formatMessage(v.placeholder),placeholderStyle:k.headerTextPlaceholder,style:k.headerText,pasteBehavior:"block",legacyTransclusionParent:e.legacyTransclusionParent,inPageFind:{type:"block_match"}}),(0,h.jsx)(m.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]})}))}const y=o.memo(o.forwardRef(b),d.Z)},51704:(e,t,n)=>{n.d(t,{Z:()=>y});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(49271),l=n(76490),c=n(9291),d=n(26249),u=n(35328),p=n(73819),m=n(23864),f=n(65187),g=n(17377),h=n(85893);const v=(0,c.defineMessages)({placeholder:{defaultMessage:"Heading 3",id:"subsubheaderBlock.placeholder"}});function b(e,t){const n=(0,c.useIntl)(),d=(0,i.O7)(),b=(0,i.Fy)(),y=(0,o.useRef)(null),_=(0,p.rv)(e.store),S=(0,p.Iy)(e.store),w=(0,r.VK)((()=>e.store.getBlockTitleStore()),[e.store]),k=(0,a.yK)((e=>{const t=(b.isMobile?1.17:l.C)*l.u9,n=b.isMobile?1.17:l.C;return{root:{display:"flex",width:"100%",..._},toggle:{height:`${t}em`,marginTop:b.isMobile?1:s.ZD.paddingTop,marginBottom:s.ZD.paddingBottom},headerText:{...s.ZD,...(0,l.Jr)({fontSizeValue:n,fontFamily:S})},headerTextPlaceholder:{WebkitTextFillColor:e.headerBlockPlaceholderTextColor}}}),[_,b.isMobile,S]);return(0,p.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"sub_sub_header",getNode:()=>y.current,getBlockStore:()=>e.store,activate(){u.th(d,e.store,e.hideContent)}})),[d,e.hideContent,e.store]),(0,h.jsx)("div",{ref:y,style:{...k.root,...e.style},children:(0,h.jsxs)(g.Z,{store:e.store,toggleStyle:k.toggle,childrenStyleWhenToggleable:{display:"flex"},hideContent:e.hideContent,disabled:e.disabled,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag,children:[(0,h.jsx)(f.Z,{tagName:"h4",disabled:e.disabled,store:w,placeholder:n.formatMessage(v.placeholder),placeholderStyle:k.headerTextPlaceholder,style:k.headerText,pasteBehavior:"block",legacyTransclusionParent:e.legacyTransclusionParent,inPageFind:{type:"block_match"}}),(0,h.jsx)(m.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]})}))}const y=o.memo(o.forwardRef(b),d.Z)},40235:(e,t,n)=>{n.d(t,{Z:()=>d});n(67294);var o=n(24405),i=n(37810),r=n(64369),a=n(85893);const s={height:32,width:"100%"},l={paddingTop:8,paddingBottom:8},c={fontWeight:i.Z.fontWeight.regular,textAlign:"left",paddingTop:8,paddingBottom:8};const d=function(e){let{columns:t,rows:n,cellStyle:i,tableStyle:d,hideHeader:m}=e;const f=(0,o.Fg)();return(0,a.jsxs)("table",{style:{...u(f),...d},children:[!m&&(0,a.jsx)("thead",{children:(0,a.jsx)("tr",{style:s,children:t.map((e=>(0,a.jsx)("th",{style:{...c,...e.style},children:(0,a.jsx)(r.Z,{isSmall:!0,children:e.header})},e.key)))})}),(0,a.jsx)("tbody",{children:n.map((e=>(0,a.jsx)("tr",{style:p(f),children:e.columns.map(((e,n)=>{const o=t[n];return(0,a.jsx)("td",{style:{...l,...i},children:e},o.key)}))},e.key)))})]})};function u(e){return{width:"100%",fontSize:13,borderTop:`1px solid ${e.regularDividerColor}`,borderBottom:`1px solid ${e.regularDividerColor}`}}function p(e){return{width:"100%",borderTop:`1px solid ${e.regularDividerColor}`}}},65187:(e,t,n)=>{n.d(t,{Z:()=>fe});var o=n(67294),i=n(83355),r=n(1302),a=n(41432),s=n(22491),l=n(53877),c=n(42875),d=n(62193),u=n(49143),p=n(6746),m=n(21202),f=n(23867),g=n(70203),h=n(9291),v=n(31701),b=n(53965),y=n(19584),_=n(36610),S=n(893),w=n(65770),k=n(993),I=n(98724),C=n(94887),x=n(74284),T=n(17269),M=n(98104),P=n(32741),A=n(13447),R=n(1742),D=n(92022),E=n(48514),B=n(60682),F=n(49117),O=n(14976),Z=n(19124),V=n(62619),U=n(73203),L=n(33929),j=n(68056),N=n(45162),z=n(73959),q=n(89086),W=n(66638),H=n(77907),K=n(5162),G=n(98180),$=n(8949),Q=n(16772),Y=n(807),J=n(66949),X=n(77080),ee=n(69316),te=n(52689),ne=n(23178),oe=n(19111),ie=n(6258),re=n(10743),ae=n(99757),se=n(24666),le=n(29595),ce=n(93262),de=n(42402),ue=n(85893);const pe=(0,h.defineMessages)({typeTextPlaceholder:{defaultMessage:"Press â€˜/â€™ for commandsâ€¦",id:"text.commandsMenuNotOpen.placeholder"},horizon1Placeholder:{defaultMessage:"Write something, or press 'space' for AI, 'â€‰/â€‰' for commandsâ€¦",id:"text.horizon1.placeholder"},typeAiTextPlaceholder:{defaultMessage:"Press â€˜spaceâ€™ for AI, â€˜/â€™ for commandsâ€¦",id:"text.commandsMenuNotOpen.placeholder.ai"},typeTextAiPlaceholder:{defaultMessage:"Press â€˜/â€™ for commands, â€˜spaceâ€™ for AIâ€¦",id:"text.commandsMenuNotOpen.placeholder.textAi"},filterPlaceholder:{defaultMessage:"Type to filterâ€¦",id:"text.commandsMenuOpen.placeholder"},nativeMABFilterInsert:{defaultMessage:"Insert",id:"text.nativeMABFilter.insert"},nativeMABFilterTurnInto:{defaultMessage:"Turn into",id:"text.nativeMABFilter.turnInto"}});class me extends i.Z{constructor(e){super(e),this.editor=null,this.mergeEditorRefs=(0,d.sH)(),this.triggeredAnalytics=!1,this.reminderTimers={},this.renderContentContainer=(e,t)=>(0,ue.jsx)(le.Z,{...this.classNameAndStyleStore.state,onBlur:this.props.onBlur,onFocus:this.props.onFocus,getDisabled:this.getDisabled,spellCheck:!this.canExclusivelyComment(),getHtml:this.getHtml,getSelection:this.getContainerSelection,onMutation:this.handleMutation,onCompositionStart:()=>{return e=this.props.onChange,t=this.environment,M.z9(t,!0),void(e&&e());var e,t},onCompositionEnd:this.handleCompositionEnd,onSelect:t,placeholder:this.getCurrentPlaceholder(),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,suppressNewlineEvents:!0,disableContentEditableWhenNotEditingTextOnMobile:!0,id:this.props.id,tagName:this.props.tagName,...e,ref:this.mergeEditorRefs(this.handleEditorRef,e.leafRef)}),this.handleEditorRef=e=>{this.editor=e},this.isSpaceComposition=()=>{if(!this.shouldRenderInteractiveAiPlaceholder.state)return!1;const e=g.eeV(this.getTextValue());return 1===e.length&&("ã€€"===e[0]||" "===e[0])},this.handleCompositionEnd=()=>{M.z9(this.environment,!1),(0,N.Aw)(this.environment)&&k.g2({environment:this.environment,store:this.props.store,usingMultiSelection:!0}),this.props.onChange&&this.props.onChange(),this.isSpaceComposition()?(0,D.toggleInitialPrompt)({from:"spacebar",environment:this.environment}):A.createAndCommit({userAction:"Text.runAllFiltersAfterCompositionEnd",environment:this.environment,perform:e=>{this.props.disableFilters||T.G({environment:this.environment,store:this.props.store,editorMode:this.getEditorMode(),transaction:e})}})},this.handleDelete=e=>{if(!this.canEditStore.state)return;if(this.editor&&this.editor.isComposing)return;this.logTypingLag("typing_delete");const{store:t}=this.props,n=se.default.state;if("editing"===n.mode){const o=n.multiSelection;if(o.start.store===t){const t=this.getEditorMode();A.createAndCommit({userAction:"Text.handleDelete",environment:this.environment,perform:n=>{C.as({environment:this.environment,multiSelection:o,deleteForwards:!0,transaction:n,event:e,editorMode:t})}})}}he(),this.props.onChange&&this.props.onChange()},this.handleForwardDeleteAtEndOfLine=e=>{if(!this.canEditStore.state)return;if(this.editor&&this.editor.isComposing)return;const{store:t}=this.props,n=se.default.state;if("editing"!==n.mode)return;const o=n.multiSelection;(0,j.iG)(o)&&(0,q.J_)(t,{startIndex:o.start.index,endIndex:o.end.index})&&this.handleDelete(e)},this.handleBackspace=e=>{if(!this.canEditStore.state||this.editor&&this.editor.isComposing)return;this.logTypingLag("typing_backspace");const{store:t}=this.props,n=se.default.state;if("editing"===n.mode){const o=n.multiSelection;if(o.start.store===t){if(C.YV({device:this.environment.device,event:e,multiSelection:o}))return;const t=this.getEditorMode();A.createAndCommit({userAction:"Text.handleBackspace",environment:this.environment,perform:n=>{C.as({environment:this.environment,multiSelection:o,deleteForwards:!1,transaction:n,event:e,editorMode:t})}})}}he(),this.props.onChange&&this.props.onChange(e)},this.handleEnter=e=>{if(!this.canEditStore.state)return;if(this.logTypingLag("typing_enter"),V.IL(e),this.editor&&this.editor.isComposing)return;const t=se.default.state;if("editing"===t.mode)if(this.props.onEnter)this.props.onEnter(e);else{const{multiSelection:e}=t;A.createAndCommit({userAction:"Text.handleEnter",environment:this.environment,perform:t=>{x.IO({environment:this.environment,editorMode:this.getEditorMode(),multiSelection:e,transaction:t})}}),he()}this.props.onChange&&this.props.onChange(e)},this.handleShiftEnter=e=>{if(!this.canEditStore.state)return;if(this.editor&&this.editor.isComposing)return;const t=se.default.state;if("editing"===t.mode){const{device:n}=this.environment;if(!("shiftKey"in e)||e.shiftKey&&!n.isIOS){if(this.props.disableShiftEnter)return;A.createAndCommit({userAction:"Text.handleShiftEnter",environment:this.environment,perform:e=>{k.hJ({environment:this.environment,editorMode:this.getEditorMode(),string:"\n",multiSelection:t.multiSelection,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e})}}),this.props.onChange&&this.props.onChange(e)}else this.handleEnter(e)}},this.handleTab=e=>{if(this.canEditStore.state){if(this.logTypingLag("typing_tab"),this.props.onTab){this.props.onTab(e)||e.preventDefault()}else{e.preventDefault();const t=(0,z.sQ)(this.props.store);t&&(A.createAndCommit({userAction:"Text.handleTab",environment:this.environment,perform:e=>{k.n2({environment:this.environment,closestSelectable:t,shiftKey:!1,transaction:e})}}),he())}this.props.onChange&&this.props.onChange()}},this.handleUntab=e=>{if(this.canEditStore.state){if(this.logTypingLag("typing_untab"),this.props.onUntab){this.props.onUntab(e)||e.preventDefault()}else{e.preventDefault();const t=(0,z.sQ)(this.props.store);t&&(A.createAndCommit({userAction:"Text.handleUntab",environment:this.environment,perform:e=>{k.n2({environment:this.environment,closestSelectable:t,shiftKey:!0,transaction:e})}}),he())}this.props.onChange&&this.props.onChange()}},this.handleAnnotation=(e,t)=>{this.canEditStore.state&&(t.preventDefault(),I.aS({environment:this.environment,annotation:e}),he(),this.props.onChange&&this.props.onChange(),_.du(this.environment,{type:g.J7s(e)}))},this.handleToggleHighlight=e=>this.handleAnnotation(["h",te.Z.state.color],e),this.handleToggleBold=e=>this.handleAnnotation(["b"],e),this.handleToggleItalics=e=>this.handleAnnotation(["i"],e),this.handleToggleStrike=e=>this.handleAnnotation(["s"],e),this.handleToggleUnderline=e=>this.handleAnnotation(["_"],e),this.handleToggleCode=e=>this.handleAnnotation(["c"],e),this.handleClick=e=>{this.handleClickActions(e),this.props.onClick&&this.props.onClick(e)},this.handleContextMenu=e=>{const t=this.parentBlockStore.state;t&&O.li({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,parentStore:t,canEdit:this.canEditStore.state})},this.handleMouseOver=e=>{O.vO({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,parentStore:this.props.parentStore,canEdit:this.canEditStore.state})},this.handleMouseOut=e=>{O.kV({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,parentStore:this.props.parentStore,canEdit:this.canEditStore.state})},this.handleCut=e=>{if(this.canEditStore.state){if(this.props.onCut)return this.props.onCut(e),void he();S.by({environment:this.environment,event:e,markdownLinkifyIt:this.props.markdownLinkifyIt}),he(),this.props.onChange&&this.props.onChange()}else e.preventDefault()},this.handlePaste=e=>{this.canEditStore.state&&(A.createAndCommit({userAction:"Text.handlePaste",environment:this.environment,perform:t=>{S.v({environment:this.environment,event:e,disableEmbedMenu:Boolean(this.props.disableEmbedMenu),transaction:t,onPasteFiles:this.props.onPasteFiles||S.AL,markdownLinkifyIt:this.props.markdownLinkifyIt,tinyMceMicrosoftWordPasteFilter:this.props.tinyMceMicrosoftWordPasteFilter})}}),he(),this.props.onChange&&this.props.onChange())},this.handleKeyPress=e=>{if(" "===e.key&&!e.shiftKey&&!e.ctrlKey&&!e.altKey&&this.isEmpty()&&(this.shouldRenderInteractiveAiPlaceholder.state||this.isHorizon1PlaceholderEnabled.state))return e.preventDefault(),void(0,D.toggleInitialPrompt)({from:"spacebar",environment:this.environment});this.canEditStore.state||e.metaKey&&"c"===e.key||e.preventDefault()},this.handleCopy=e=>{!function(e,t,n,o){if(t)return void t(e);S.JG({environment:o,event:e,markdownLinkifyIt:n})}(e,this.props.onCopy,this.props.markdownLinkifyIt,this.environment)},this.handleMoveUp=e=>{!function(e,t){e.preventDefault(),A.createAndCommit({userAction:"Text.handleMoveUp",environment:t,perform:e=>{k.fs({environment:t,transaction:e,direction:"up"})}})}(e,this.environment)},this.handleMoveDown=e=>{var t;t=this.environment,A.createAndCommit({userAction:"Text.handleMoveDown",environment:t,perform:e=>{k.fs({environment:t,transaction:e,direction:"down"})}})},this.aiTextPlaceholderMessage=this.createComputedStore((()=>"on"===X.default.getEligibleGroup({experimentId:"prioritize_slash_menu_block_placeholder",defaultGroup:"control"})?L.default.formatMessage(pe.typeTextAiPlaceholder):L.default.formatMessage(pe.typeAiTextPlaceholder)),!1,"aiTextPlaceholderMessageStore"),this.canEditStore=this.createComputedStore((()=>{if(this.props.disabled)return!1;if(ae.n.state)return!1;const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return(!this.props.isDiscussionInput||null==e||!e.hasPublicPermission||"view"!==e.permission)&&(!(!this.props.isDiscussionInput&&null!=e&&e.hasPublicPermission&&"edit"!==e.permission)&&this.props.store.canEdit())}),!1,"canEditStore"),this.getDisabled=()=>!this.canEditStore.state,this.getHtml=()=>{var e;let t=this.getTextValue(),n=!1;if(this.props.canTruncate&&void 0!==this.props.maxChars){g.eeV(t).length>this.props.maxChars&&(t=g.KU1(this.getTextValue(),0,this.props.maxChars),n=!0)}const i=O.IY({environment:this.environment,textValue:t&&{value:t,spaceId:(0,f.C)(this.props.store.pointer.spaceId)},parentStore:this.props.parentStore||this.props.store,disableHover:!1,disableStyleAnnotations:Boolean(this.props.disableStyleAnnotations),disableInsertedDeletedAnnotations:Boolean(this.props.disableInsertedDeletedAnnotations),disableDateStyleAnnotations:Boolean(this.disabledMentionTypes.state.date),disabled:!this.canEditStore.state,theme:this.theme,emojiType:(0,B.e_)(this.environment),katex:this.environment.KatexStore.getKatex(),parentBlockId:ve(this.props.store),renderedPageBlockId:null===(e=this.pageContext)||void 0===e?void 0:e.pageStore.id,formulaValueTypes:[]}),r=(0,ue.jsxs)(o.Fragment,{children:[i,n&&(a=this.theme,(0,ue.jsxs)(de.Z,{disableUnderline:!0,style:{color:a.mediumTextColor},onClick:e=>{e.preventDefault(),e.stopPropagation()},children:["â€¦",(0,ue.jsx)("span",{children:(0,ue.jsx)(h.FormattedMessage,{id:"text.truncated.showMoreLabel",defaultMessage:"more"})})]}))]});var a;return p.Z.renderToStaticMarkup(r)},this.clearBrowserSelection=()=>{var e;null===(e=this.getEditorNode())||void 0===e||e.blur()},this.getTextValue=()=>O.Rl({store:this.props.store,textValue:this.getTextValueHelper()}),this.getTextValueHelper=()=>{var e,t;if(this.isNewDiscussionMenuTarget.state)return O.Gj({store:this.props.store});if(this.isInlineEquationOverlayTarget.state)return O.PY({store:this.props.store,equationStore:J.Z});if(this.isMentionMenuTarget.state)return O.Ob({store:this.props.store,mentionMenuState:this.isMentionMenuTarget.state});if(this.isMobileNativeSlashMenuTarget.state)return O.R9({store:this.props.store,slashMenuState:this.isMobileNativeSlashMenuTarget.state,hint:L.default.formatMessage(this.isMobileNativeSlashMenuTarget.state.isAddMenu?pe.nativeMABFilterInsert:pe.nativeMABFilterTurnInto)});if(this.linkingMenuSelectionStore.state)return O.So({store:this.props.store,selection:this.linkingMenuSelectionStore.state});if(null!==(e=this.findAndReplaceStore.state)&&void 0!==e&&e.open&&this.props.inPageFind&&"none"!==(null===(t=this.props.inPageFind)||void 0===t?void 0:t.type)&&!this.props.store.inMemoryRecordCache.isSyntheticAssistantData){return O.cD({textValue:this.props.store.getValue(),blockId:this.props.store.id,textProps:this.props.inPageFind})}if(this.isCompletionPopupTarget.state)return O.fm({store:this.props.store,temporaryAnnotation:g.GKr.TemporarySelection,multiSelection:ge()});const n=this.pageAnnotationBlockMenuStore.state;if(n)return n;if(this.isEditing.state){const e=se.default.state;if("editing"===e.mode){const t=(0,j.QY)(e.multiSelection);if(t)return O.xX({store:this.props.store,selection:t.selection})}}return this.props.store.getValue()},this.parentBlockStore=this.createComputedStore((()=>{const{store:e}=this.props;if(e.pointer.table===m.iU)return ie.G.createChildStore(e,e.pointer)}),!1,"parentBlockStore"),this.isEditing=this.createComputedStore((()=>(0,q.J5)(this.props.store)),!1,"isEditing"),this.isSelectionEndpoint=this.createComputedStore((()=>(0,q.Gq)(this.props.store)),!1,"isSelectionEndpoint"),this.isCompletionsEnabledStore=this.createComputedStore((()=>{var e;const t=null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state;return(0,Z.GD)(t)}),!1,"isCompletionsEnabledStore"),this.shouldRenderInteractiveAiPlaceholder=this.createComputedStore((()=>{if(this.isHorizon1PlaceholderEnabled.state)return!1;if(this.environment.device.isMobile||this.environment.device.isMobileNative)return!1;if(this.props.disabled)return!1;if(!this.isCompletionsEnabledStore.state)return!1;const e=this.parentBlockStore.state,t=e&&e.getType();return Boolean(t&&(0,a.hD)(t))&&"contains-selection"===this.isEditing.state&&!(e&&(0,F.td)(e))}),!1,"shouldRenderInteractiveAiPlaceholder"),this.isHorizon1PlaceholderEnabled=this.createComputedStore((()=>!!this.isCompletionsEnabledStore.state&&(0,U.r)()),!1,"isHorizon1PlaceholderEnabled"),this.isNewDiscussionMenuTarget=this.createComputedStore((()=>{const e=E.Z.state;return e.open&&"inline"===e.type&&Boolean((0,N.r)(e.multiSelection,this.props.store))}),!1,"isNewDiscussionMenuTarget"),this.isCompletionPopupTarget=this.createComputedStore((()=>{const e=ge();if(!e)return!1;const t=Q.default.state;if("assistantCompletionPopup"===t.type){const e=G.Z.getSessionContext(t.sessionId);if(e&&(e.getCombinedSteps().length>0||e.getAllPendingOperations().length>0))return!1}return Boolean((0,N.r)(e,this.props.store))}),!1,"isCompletionPopupTarget"),this.isInlineEquationOverlayTarget=this.createComputedStore((()=>{var e;return J.Z.isOpen()&&(null===(e=(0,j.QY)(J.Z.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store)===this.props.store}),!1,"isInlineEquationOverlayTarget"),this.isMentionMenuTarget=this.createComputedStore((()=>{const e=oe.Z.state;return!!e.open&&(e.textStore===this.props.store&&e)}),!1,"isMentionMenuTarget"),this.isMobileNativeSlashMenuTarget=this.createComputedStore((()=>{if(!(0,K.Y)("supportsNativeMobileDynamicActionBar"))return!1;const e=re.Z.state;return!!e.open&&e}),!1,"isMobileNativeSlashMenuTarget"),this.linkingMenuSelectionStore=this.createComputedStore((()=>{const e=ne.Z.state;if(!e.open)return!1;if(!e.focusLinkInput&&!e.focusTitleInput)return!1;if(!this.isEditing.state)return!1;const t=(0,j.QY)(e.savedTextSelectionState.multiSelection);return!!t&&t.selection}),!1,"linkingMenuSelectionStore"),this.findAndReplaceStore=this.createComputedStore((()=>{const e=ee.Z.state;return e.open&&e.findQuery.length>0?e:void 0})),this.pageAnnotationBlockMenuStore=this.createComputedStore((()=>{const e=$.Z.state;if(!e.isActive)return;const{clickedPageAnnotation:t}=e;if(!t)return;const{parentStore:n,pageAnnotation:o}=t;if(n!==this.parentBlockStore.state)return;const i=this.props.store.getValue();return i?null==i?void 0:i.map((e=>g.km_(e)?[e[0],e[1].flatMap((e=>g.STW(e)&&e===o?[o,g.EPB()]:[e]))]:e)):void 0}),!1,"pageAnnotationBlockMenuStore"),this.disabledMentionTypes=this.createComputedStore((()=>(0,u.lU)(this.props.disabledMentionTypes)),!0),this.getContainerSelection=()=>{const e=Boolean(this.linkingMenuSelectionStore.state);if((0,N.Aw)(this.environment)&&this.isSelectionEndpoint.state){if(e)return;return(0,q.HE)(this.props.store)}if(this.isEditing.state&&!e){const{store:e}=this.props,t=se.default.state;if("editing"===t.mode){const n=(0,N.xI)("Text",t.multiSelection);if(n){const{selection:t}=n,o=e.getValue(),i=g.eeV(o).length;return{type:"contain",selection:{startIndex:Math.min(t.startIndex,i),endIndex:Math.min(t.endIndex,i)}}}}}},this.getEndSelection=()=>{const e=g.eeV(this.getTextValue());return{startIndex:e.length,endIndex:e.length}},this.classNameAndStyleStore=this.createComputedStore((()=>(0,s.iv)(this.getStyle(),this.props.className)),!1,"classNameAndStyleStore"),this.handleMutation=this.handleMutation.bind(this)}UNSAFE_willMountOrUpdate(){this.createReminderTimers(),this.environment.KatexStore.loadIfNeeded(this.getTextValue)}willUnmount(){this.clearReminderTimers(),P.qA(this.props.store)}isComposing(){return this.editor&&this.editor.isComposing}createReminderTimers(){const e=this.getTextValue(),t=g.nai(e),n=b.oA(t.map((e=>{const t=(0,l.KR)(e,(0,c.r)());return null==t?void 0:t.toMillis()}))),o=Date.now();for(const i of n){const e=i-o;e>0&&e<y.A0&&(i in this.reminderTimers||(this.reminderTimers[i]=setTimeout(this.enqueueForceUpdate,e)))}for(const i in this.reminderTimers)n.includes(parseInt(i))||(clearTimeout(this.reminderTimers[i]),delete this.reminderTimers[i])}clearReminderTimers(){for(const e in this.reminderTimers)clearTimeout(this.reminderTimers[e]),delete this.reminderTimers[e]}renderComponent(){const{disableInsertText:e,disableStyleAnnotations:t,disableSelectAllBlocks:n,disableSelectionDrag:o,disableDrag:i,disabled:r}=this.props;return(0,ue.jsx)(ce.Z,{...this.props,clearBrowserSelection:this.clearBrowserSelection,getEndSelection:this.getEndSelection,canInsertText:!r&&!e,onClick:this.handleClick,onContextMenu:this.handleContextMenu,onDelete:this.handleDelete,onDeleteToEndOfLine:this.handleForwardDeleteAtEndOfLine,onDeleteNextWord:this.handleForwardDeleteAtEndOfLine,onBackspace:this.handleBackspace,onEnter:this.handleEnter,onShiftEnter:this.handleShiftEnter,onTab:this.handleTab,onUntab:this.handleUntab,onToggleHighlight:this.handleToggleHighlight,onToggleBold:this.handleToggleBold,onToggleItalics:this.handleToggleItalics,onToggleStrike:this.handleToggleStrike,onToggleUnderline:this.handleToggleUnderline,onToggleCode:this.handleToggleCode,onCopy:this.handleCopy,onCut:this.handleCut,onPaste:this.handlePaste,onKeyPress:this.handleKeyPress,onMoveUp:this.handleMoveUp,onMoveDown:this.handleMoveDown,render:this.renderContentContainer,disableStyleAnnotations:t,canSelectAllBlocks:!n,canSelectionDrag:!o,disableDrag:i,topBottomPadding:9})}getCurrentPlaceholder(){const{device:e}=this.environment;if(this.shouldRenderInteractiveAiPlaceholder.state)return this.aiTextPlaceholderMessage.state;if(this.props.placeholder)return this.props.placeholder;if(this.props.disabled)return" ";if(!this.props.disableSlashCommands&&"contains-selection"===this.isEditing.state&&this.canEditStore.state){if(re.Z.state.open)return L.default.formatMessage(pe.filterPlaceholder);if(!e.isMobile)return this.isHorizon1PlaceholderEnabled.state?L.default.formatMessage(pe.horizon1Placeholder):L.default.formatMessage(pe.typeTextPlaceholder)}return" "}handleMutation(e){if(this.logTypingLag("typing_lag"),!this.canEditStore.state)return;(0,N.Aw)(this.environment)?A.createAndCommit({userAction:"Text.handleMutation",environment:this.environment,perform:t=>{let n=this.props.store;const{multiSelection:o}=e;if(o&&!(0,j.qS)(o))n=o.start.store;else if(this.props.legacyTransclusionParent&&!e.insertedLine&&!e.isComposing&&!e.deletedLine){const e=w.Z({environment:this.environment,store:n,parentStore:this.props.legacyTransclusionParent,transaction:t});e&&(n=e)}if(k.YV({environment:this.environment,store:n,newValue:e.newValue,editorMode:this.getEditorMode(),disableMentions:Boolean(this.props.disableMentions),disabledMentionTypes:this.disabledMentionTypes.state,disableSlashCommands:Boolean(this.props.disableSlashCommands),disableEmojiCommands:Boolean(this.props.disableEmojiCommands),disableFilters:this.props.disableFilters||e.isComposing,transaction:t,multiSelection:o}),e.insertedLine){const e="editing"===se.default.state.mode&&se.default.state.multiSelection;e&&x.IO({environment:this.environment,editorMode:this.getEditorMode(),multiSelection:e,transaction:t})}this.props.trackEditsToUserFlow&&!t.isEmpty()&&R.uO(this.environment,this.props.trackEditsToUserFlow,t)}}):A.createAndCommit({userAction:"Text.handleMutation",environment:this.environment,perform:t=>{k.aS({environment:this.environment,store:this.props.store,editorMode:this.getEditorMode(),newValue:e.newValue,disableMentions:Boolean(this.props.disableMentions),disabledMentionTypes:this.disabledMentionTypes.state,disableSlashCommands:Boolean(this.props.disableSlashCommands),disableEmojiCommands:Boolean(this.props.disableEmojiCommands),disableFilters:this.props.disableFilters||e.isComposing,transaction:t})}});const{store:t}=this.props,n=this.parentBlockStore.state;if(n){if(n.getType()){const e=n.getSchema()||{};if("properties"===t.path[0]&&t.path[1]){e[t.path[1]]&&!this.triggeredAnalytics&&(this.triggeredAnalytics=!0)}}}this.props.onChange&&this.props.onChange()}getEditorMode(){var e,t;return this.props.isDiscussionInput?"default":null!==(e=this.pageContext)&&void 0!==e&&e.pageStore?Y.Z.getMode(null===(t=this.pageContext)||void 0===t?void 0:t.pageStore):"default"}handleClickActions(e){O.SD({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,parentStore:this.props.parentStore,canEdit:this.canEditStore.state,disableEquationInteraction:this.props.disableEquationInteraction})}canExclusivelyComment(){return e=this.props.disabled,t=this.props.store,!e&&t.canComment()&&!this.canEditStore.state;var e,t}focus(){this.isEditing.state||M.NX({store:this.props.store})}getEditorNode(){var e;return(null===(e=this.editor)||void 0===e?void 0:e.getNode())||void 0}isEmpty(){return 0===g.lzi(this.getTextValue()).length}logTypingLag(e){const t=!this.props.disabled&&"inline"===this.props.pasteBehavior;(0,W.u)({type:e,environment:this.environment,blockStore:this.parentBlockStore.state,store:this.props.store,isInCollectionView:t})}getStyle(){const{device:e}=this.environment;let t={maxWidth:"100%",width:"100%",whiteSpace:"pre-wrap",wordBreak:"break-word",caretColor:this.canExclusivelyComment()?v.ZP.transparent:this.theme.regularTextColor,...this.props.style};return this.isEmpty()&&(t.minHeight="1em",t={...t,color:this.theme.regularTextColor,WebkitTextFillColor:this.theme.lightTextColor,...this.props.placeholderStyle}),e.isMobile&&this.canEditStore.state&&(this.isEditing.state?t.WebkitUserModify="read-write-plaintext-only":(t.userSelect="none",t.WebkitUserSelect="none",t.whenFocusedEditable={userSelect:"text",WebkitUserSelect:"text",WebkitUserModify:"read-write-plaintext-only"})),t}}me.displayName="Text";const fe=o.forwardRef((function(e,t){const{value:n}=(0,H.useDependency)(H.deps.markdownLinkifyIt),{value:o}=(0,H.useDependency)(H.deps.tinyMceMicrosoftWordPasteFilter);return(0,ue.jsx)(me,{...e,ref:t,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o})}));function ge(){const e=Q.default.state;return("closedWithContext"===e.type||"completionPopup"===e.type&&"initialPromptForAIBlock"!==e.stage||"assistantCompletionPopup"===e.type)&&"textSelection"===e.context.type?e.context.textSelection:void 0}function he(){r.default.flush()}function ve(e){if(e.table===m.iU)return e.id;const{ancestor:t}=e.findRecordStoreUIAncestor((e=>{let{table:t}=e;return t===m.iU}));return t?t.id:void 0}},17970:(e,t,n)=>{n.d(t,{Z:()=>g});var o=n(67294),i=n(86628),r=n(24405),a=n(49271),s=n(26249),l=n(73819),c=n(77080),d=n(23864),u=n(55217),p=n(65187),m=n(85893);function f(e,t){let{disabled:n,disableCommentMenu:s,disableHoverMenu:f,disableDrag:g,hideContent:v,legacyTransclusionParent:b,store:y,style:_}=e;const S=(0,i.VK)((()=>y.getBlockTitleStore()),[y]),w=(0,i.VK)((()=>y.getContentStore()),[y]),k=(0,o.useRef)(null),I=(0,i.VK)((()=>w.getValue()||[]),[w]),C=(0,i.VK)((()=>{if(!c.default.checkGate("text_align"))return{};const{block_alignment:e}=y.getFormat();switch(e){case"right":case"center":return{textAlign:y.getFormat().block_alignment};default:return{textAlign:"left"}}}),[y]),x=(0,i.VK)((()=>{if(!c.default.checkGate("text_align"))return{};const{block_alignment:e}=y.getFormat();switch(e){case"center":return{textAlign:"left",paddingLeft:"50%"};case"right":return{textAlign:"right"};default:return{textAlign:"left"}}}),[y]),T=(0,l.rv)(y),M=(0,r.yK)((()=>({root:{...C,...T,..._}})),[C,T,_]),P=I.length>0?(0,m.jsx)("div",{style:h,children:(0,m.jsx)(u.Z,{disabled:n,store:w,disableCommentMenu:s,disableHoverMenu:f,disableDrag:g})}):(0,m.jsx)(u.Z,{disabled:!0,store:w}),A=(0,m.jsxs)("div",{style:M.root,ref:k,children:[(0,m.jsxs)("div",{style:{display:"flex"},children:[(0,m.jsx)(p.Z,{style:a.ZD,placeholderStyle:x,disabled:n,store:S,pasteBehavior:"block",legacyTransclusionParent:b,trackEditsToUserFlow:"user_flow_edit_block",inPageFind:{type:"block_match"}}),(0,m.jsx)(d.Z,{disableCommentMenu:s,hideContent:v,store:y})]}),!v&&P]});return(0,l.ez)(y,t,(0,o.useMemo)((()=>({renderedType:"text",getBlockStore:()=>y,getNode:()=>k.current})),[y]),A)}const g=o.memo(o.forwardRef(f),s.Z),h={paddingLeft:"1.5em",display:"flex",flexDirection:"column"}},6684:(e,t,n)=>{n.d(t,{Z:()=>I});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(49271),l=n(80951),c=n(9291),d=n(53965),u=n(26249),p=n(95982),m=n(13447),f=n(73819),g=n(27724),h=n(23864),v=n(60458),b=n(55217),y=n(78454),_=n(65187),S=n(85893);const w=(0,c.defineMessages)({placeholder:{defaultMessage:"To-do",id:"todoBlock.placeholder"}});function k(e,t){const n=(0,c.useIntl)(),u=(0,i.Fy)(),k=(0,i.O7)(),I=(0,o.useRef)(null),C=(0,o.useId)(),x=(0,f.PE)(e.store,e.disabled),T=(0,f.rv)(e.store),M=(0,r.VK)((()=>e.store.getBlockTitleStore()),[e.store]),P=(0,r.VK)((()=>e.store.getContentStore()),[e.store]),A=(0,r.VK)((()=>{const t=e.store.getProperties();return!!t&&l.Ml(t.checked)}),[e.store]),R=(0,o.useCallback)((()=>{if(x){let t;t=d.q9(g.default.state.stores,e.store)?g.default.state.stores:[e.store],k.mobileNative&&k.mobileNative.buzz(),A?m.createAndCommit({userAction:"TodoBlock.toggleChecked",environment:k,perform:e=>{p.c({environment:k,blocks:t,transaction:e})}}):m.createAndCommit({userAction:"TodoBlock.toggleChecked",environment:k,perform:e=>{p.B({environment:k,blocks:t,transaction:e})}})}}),[x,k,A,e.store]),D=(0,a.yK)((e=>({root:{paddingLeft:s.ZD.paddingLeft,...T},title:{...y.R8,width:void 0,flexGrow:1,...A&&{textDecoration:"line-through",textDecorationColor:e.strikethroughLineColor,opacity:1,color:e.mediumTextColor}}})),[T,A]),E=(0,S.jsxs)(y.ZP,{style:{...D.root,...e.style},left:(0,S.jsx)(v.Z,{"aria-labelledby":C,checked:A,onClick:R,disabled:!x,size:16,fill:T.color,tapArea:u.isMobile?{size:30}:void 0}),childrenStyle:{display:"flex",flexDirection:"column"},ref:I,children:[(0,S.jsxs)("div",{style:{display:"flex"},children:[(0,S.jsx)(_.Z,{id:C,style:D.title,disabled:e.disabled,store:M,placeholder:n.formatMessage(w.placeholder),pasteBehavior:"block",legacyTransclusionParent:e.legacyTransclusionParent,inPageFind:{type:"block_match"}}),(0,S.jsx)(h.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]}),!e.hideContent&&(0,S.jsx)(b.Z,{disabled:e.disabled,store:P,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag})]});return(0,f.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"to_do",getNode:()=>I.current,getBlockStore:()=>e.store,activate:R})),[e.store,R]),E)}const I=o.memo(o.forwardRef(k),u.Z)},4859:(e,t,n)=>{n.d(t,{J9:()=>A,ZP:()=>P,kA:()=>R});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(49271),l=n(9291),c=n(53965),d=n(26249),u=n(36610),p=n(29373),m=n(13447),f=n(28020),g=n(52315),h=n(73819),v=n(27724),b=n(45131),y=n(23864),_=n(64921),S=n(25777),w=n(55217),k=n(78454),I=n(65187),C=n(5210),x=n(85893);const T=(0,l.defineMessages)({placeholder:{defaultMessage:"Toggle",id:"toggleBlock.placeholder"}});function M(e,t){const n=(0,i.O7)(),d=(0,l.useIntl)(),M=(0,o.useRef)(!0);(0,o.useLayoutEffect)((()=>{M.current&&(M.current=!1,p.nz({blockId:e.store.id,currentUserId:n.currentUser.id}),e.store.isDefaultRecordCache()&&p.LO(n,e.store.pointer))}));const P=(0,o.useRef)(null),A=(0,r.VK)((()=>e.store.getBlockTitleStore()),[e.store]),R=(0,r.VK)((()=>e.store.getContentStore()),[e.store]),D=(0,r.VK)((()=>b.Z.isOpen(e.store.id)&&!e.hideContent),[e.hideContent,e.store.id]),E=(0,r.VK)((()=>!e.store.hasContent()),[e.store]),B=(0,o.useId)(),F=(0,o.useId)(),O=(0,r.VK)((()=>g.b(e.store)||!e.store.isDefaultRecordCache()),[e.store]),Z=(0,o.useCallback)((()=>{let t;t=c.q9(v.default.state.stores,e.store)?v.default.state.stores:[e.store];const o=!D;for(const e of t)p.rd({blockId:e.id,state:o,currentUserId:n.currentUser.id});u.jR(n,{is_toggled:o})}),[n,D,e.store]),V=(0,o.useCallback)((()=>{m.createAndCommit({userAction:"ToggleBlock.handlePlaceholderClick",environment:n,perform:t=>{p.ls({environment:n,store:e.store,transaction:t})}})}),[n,e.store]),U=(0,o.useCallback)((e=>{if(e.shiftKey){const e=f.np();e&&p.X_(n,e)}else Z()}),[n,Z]),L=(0,h.rv)(e.store),j=(0,a.yK)((t=>({root:{paddingLeft:s.ZD.paddingLeft,...L,...e.style},placeholderButton:{fontSize:"inherit",width:"100%",borderRadius:4,caretColor:t.lightTextColor,...s.ZD,marginTop:2},placeholderText:{color:t.lightTextColor}})),[L,e.style]),N=(0,x.jsx)(_.Z,{style:j.placeholderButton,onClick:V,disabled:e.disabled,children:(0,x.jsx)("span",{style:j.placeholderText,children:(0,x.jsx)(l.FormattedMessage,{defaultMessage:"Empty toggle. Click or drop blocks inside.",id:"toggleBlock.emptyBlock.placeholderText"})})}),z=(0,x.jsxs)(k.ZP,{style:j.root,left:(0,x.jsx)(C.Z,{"aria-describedby":B,"aria-controls":F,isSidebar:!1,open:D,fill:!E,onClick:U,tapArea:n.device.isMobile?{size:30}:void 0}),leftStyle:{paddingRight:2},ref:P,children:[(0,x.jsxs)("div",{style:{display:"flex"},children:[(0,x.jsx)(I.Z,{id:B,style:k.R8,disabled:e.disabled,store:A,placeholder:d.formatMessage(T.placeholder),pasteBehavior:"block",inPageFind:{type:"block_match"},legacyTransclusionParent:e.legacyTransclusionParent}),(0,x.jsx)(y.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store,recursivelyLoadAllDiscussions:!D})]}),D?(0,x.jsx)(S.Z,{id:F,loaded:O,spinnerSize:"1em",showSpinnerTimeout:500,innerStyle:{display:"flex",flexDirection:"column",width:"100%"},style:{display:"flex"},children:(0,x.jsx)(w.Z,{store:R,emptyPlaceholder:N,disabled:e.disabled,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag})}):(0,x.jsx)(w.Z,{store:R,disabled:e.disabled,disableContent:!0})]});return(0,h.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"toggle",getNode:()=>P.current,getBlockStore:()=>e.store,activate(){Z()}})),[e.store,Z]),z)}const P=o.memo(o.forwardRef(M),d.Z);function A(){return{display:"flex"}}function R(){return{display:"flex",flexDirection:"column",width:"100%"}}},5210:(e,t,n)=>{n.d(t,{Z:()=>m,q:()=>u});var o=n(67294),i=n(480),r=n(24405),a=n(17693),s=n(91),l=n(9291),c=n(64921),d=n(85893);function u(e){let{isSidebar:t,isMobile:n}=e;return t&&!n?20:24}const p=(0,l.defineMessages)({open:{defaultMessage:"Open",id:"toggleButton.open"},close:{defaultMessage:"Close",id:"toggleButton.close"}}),m=o.memo((function(e){const t=(0,i.Fy)(),n=(0,l.useIntl)(),m=(0,o.useMemo)((()=>u({isSidebar:e.isSidebar,isMobile:t.isMobile})),[t.isMobile,e.isSidebar]),f=(0,r.yK)((()=>{const n=e.color||"inherit",o="chevron"===e.icon?`rotateZ(${e.open?0:-90}deg)`:`rotateZ(${e.open?180:90}deg)`,i="chevron"===e.icon,r=i&&t.isMobile;return{button:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",width:m,height:m,borderRadius:4,...e.style},arrow:{width:r?14:i?12:"0.6875em",height:r?14:i?12:"0.6875em",transition:"transform 200ms ease-out",transform:o,fill:n,opacity:e.fill?1:.5}}}),[t.isMobile,e.color,e.fill,e.icon,e.open,e.style,m]),g=(0,o.useMemo)((()=>"chevron"===e.icon?(0,a.A)(f.arrow):(0,s.L)(f.arrow)),[e.icon,f.arrow]);return(0,d.jsxs)(c.Z,{ariaLabel:e.open?n.formatMessage(p.close):n.formatMessage(p.open),"aria-describedby":e["aria-describedby"],"aria-expanded":e.open,"aria-controls":e.open?e["aria-controls"]:void 0,style:f.button,onClick:e.onClick,onMouseDown:e.onMouseDown,disabled:e.disabled,allowShiftClick:!0,children:[e.tapArea&&(0,d.jsx)("div",{style:{position:"absolute",opacity:0,width:e.tapArea.size,height:e.tapArea.size,top:-(e.tapArea.size-m)/2,left:-(e.tapArea.size-m)/2}}),g]})}))},85567:(e,t,n)=>{n.d(t,{Z:()=>v});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(84619),l=n(19525),c=n(97466),d=n(31701),u=n(37810),p=n(43224),m=n(4023),f=n(64921),g=n(26388),h=n(85893);const v=function(e){let{format:t,isSingle:n,showRemoveButton:l,shouldShrink:u,isRound:v,disabled:b,disabledFeedback:y,color:_,backgroundColor:w,style:k,shouldWrap:I,showFullValueTooltip:C,tooltip:x,tooltipPlacement:T,value:M,isStrikedThrough:P,showColoredDot:A,onClickRemove:R,onClick:D}=e;const E=(0,a.Fg)(),B=(0,i.O7)(),F=(0,o.useRef)(null),O=(0,r.VK)((()=>function(e,t,n,o,i,r,a,l,c,u,p,m,f){const{height:g,fontSize:h,paddingLeft:v,margin:b}=(0,s.e1)(n),{ThemeStore:y}=e,_=a?v+1:v;return{display:o?"inline-flex":"flex",alignItems:"center",flexShrink:o||r?1:0,minWidth:0,maxWidth:"100%",height:g,borderRadius:a?g/2:3,paddingLeft:_,paddingRight:i?0:a?_+2:_,fontSize:h,lineHeight:"120%",opacity:l&&c?.4:void 0,color:u||("light"===y.state.mode?t.regularTextColor:d.ZP.whiteWithAlpha(.7)),background:p||t.legacyDefaultSelectColor,margin:o?0:b,...f&&{height:void 0,paddingTop:4,paddingBottom:4},...m}}(B,E,t,n,l,u,v,b,y,_,w,k,I)),[B,E,t,n,l,u,v,b,y,_,w,k,I]);if(C||void 0!==x)return(0,h.jsx)(g.ZP,{placement:T??m.u.Right,renderTooltip:e=>(0,h.jsxs)("div",{...e,style:p.F6,children:[C&&(0,h.jsx)("div",{children:M}),void 0!==x&&(0,h.jsx)("div",{style:{color:C?E.mediumInvertedTextColor:void 0},children:x})]}),originGap:20,textWrap:!0,render:e=>(0,h.jsx)("div",{style:O,...e,onMouseEnter:t=>{(function(e,t){return Boolean(t&&e.current&&e.current.offsetWidth<e.current.scrollWidth)}(F,C)||void 0!==x)&&e.onMouseEnter&&e.onMouseEnter(t)},children:(0,h.jsx)(S,{ref:F,format:t,shouldWrap:I,isStrikedThrough:P,showColoredDot:A,value:M,showRemoveButton:l,onClickRemove:R,disabled:b})})});if(D){const e=w?{background:(0,c._j)(w,1)}:void 0,n=w?{background:(0,c._j)(w,2)}:void 0;return(0,h.jsx)(f.Z,{style:O,hoveredStyle:e,pressedStyle:n,onClick:D,children:(0,h.jsx)(S,{format:t,shouldWrap:I,isStrikedThrough:P,showColoredDot:A,value:M,showRemoveButton:l,onClickRemove:R,disabled:b})})}return(0,h.jsx)("div",{style:O,children:(0,h.jsx)(S,{format:t,shouldWrap:I,isStrikedThrough:P,showColoredDot:A,value:M,showRemoveButton:l,onClickRemove:R,disabled:b})})};function b(e){let{format:t,showRemoveButton:n,onClickRemove:o,disabled:i}=e;const r=function(e){switch(e){case s.lo.Large:return 10;case s.lo.ExtraSmall:case s.lo.Small:case s.lo.Medium:case s.lo.Inline:default:return 8}}(t),{height:a}=(0,s.e1)(t),c={display:"flex",alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0,marginLeft:2,marginRight:2};return n?(0,h.jsx)(f.Z,{onClick:o,style:{...c,width:a,height:a},disabled:i,disabledFeedback:!1,mobileFeedback:!0,className:"notion-token-remove-button",children:(0,l.b)({width:r,height:r,opacity:.5})}):null}function y(e,t,n){const o=(0,s.Nv)(t),i="default"===e?"gray":e;return void 0===i?{}:{marginRight:5,borderRadius:99,height:o,width:o,backgroundColor:"light"===n.mode?n.accentColors[i][400]:n.accentColors[i][700],display:"inline-flex",flexShrink:0}}function _(e){let{showColoredDot:t,format:n}=e;const o=(0,a.Fg)();return t?(0,h.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,h.jsx)("div",{style:y(t,n,o)})}):null}const S=o.forwardRef((function(e,t){let{format:n,shouldWrap:o,isStrikedThrough:i,showColoredDot:r,value:a,showRemoveButton:l,onClickRemove:c,disabled:d}=e;const{height:p}=(0,s.e1)(n);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{style:{...o?{overflowWrap:"anywhere"}:u.Z.textOverflowStyle,textDecoration:i?"line-through":void 0,display:"inline-flex",alignItems:"center",height:p,lineHeight:`${p}px`},children:[(0,h.jsx)(_,{showColoredDot:r,format:n}),(0,h.jsx)("span",{style:{...u.Z.textOverflowStyle},ref:t,children:a})]}),(0,h.jsx)(b,{format:n,showRemoveButton:l,onClickRemove:c,disabled:d})]})}))},25157:(e,t,n)=>{n.d(t,{Z:()=>_e});var o=n(94184),i=n.n(o),r=n(67294),a=n(13991),s=n(86628),l=n(24405),c=n(49085),d=n(15145),u=n(41432),p=n(9999),m=n(42853),f=n(61061),g=n(44495),h=n(54497),v=n(87479),b=n(72141),y=n(51454),_=n(9291),S=n(31701),w=n(1898),k=n(37810),I=n(893),C=n(47307),x=n(24677),T=n(64964),M=n(98104),P=n(29373),A=n(13447),R=n(95477),D=n(95645),E=n(97978),B=n(80365),F=n(84210),O=n(12534),Z=n(87290),V=n(33929),U=n(60709),L=n(39500),j=n(46654),N=n(18514),z=n(89224),q=n(61766),W=n(88632),H=n(55367),K=n(80796),G=n(77080),$=n(22294),Q=n(88923),Y=n(6258),J=n(69784),X=n(49557),ee=n(77933),te=n(480),ne=n(23867),oe=n(80444);const ie=function(e){const t=(0,te.O7)(),n=(0,s.VK)(re,[]);return(0,r.useEffect)((()=>{if(!n)return t.LocalBacklinkStore.initializeBacklinks({block:{id:e.store.pointer.id,spaceId:(0,ne.C)(e.store.pointer.spaceId)},currentUserId:t.currentUser.id,environment:t}),()=>{t.LocalBacklinkStore.destroyBacklinks(e.store.id,t)}}),[t,n,e.store.id,e.store.pointer.id,e.store.pointer.spaceId]),null};function re(){const{mainEditorCurrentBlockStore:e}=oe.default.state;return Boolean(e&&"15776535-3f2c-4705-bd45-474e5ba8b46c"===e.id)}var ae=n(13966),se=n(23063),le=n(64921),ce=n(31945),de=n(84076),ue=n(78140),pe=n(76798),me=n(72495),fe=n(83182),ge=n(29551),he=n(55217),ve=n(85893);const be=(0,_.defineMessages)({copySuccessMessage:{defaultMessage:"Copied! Now paste in any page to sync content.",id:"transclusionContainerBlock.actions.copySuccessMessage"}});class ye extends D.Z{constructor(){super(...arguments),this.storeTypes={hoveredStore:c.default.createClass(!1),haloShouldBeVisibleStore:c.default.createClass(!1),actionBarShouldBeVisibleStore:c.default.createClass(!1),backlinksIndicatorButtonPopupStore:q.Z},this.fakeSelectionTrapRef=r.createRef(),this.renderActionBarContent=()=>{const e=this.numberOfBacklinks.state,t=W.Z.state.online,n=this.hasDifferingReadPermissionsFromSource.state,{isDesktop:o}=this.environment.device;return(0,ve.jsxs)("div",{style:(i=this.theme,{position:"absolute",zIndex:y.t8,top:-40,right:-2,borderRadius:6,height:32,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",fontFamily:k.Z.getCompositeFontFamily(a.SP).sans,background:i.popoverBackground,boxShadow:i.mediumBoxShadow}),children:[t&&(0,ve.jsx)(ce.ZP,{popupType:ce.Z4.Popup,onClick:()=>{return e=this.props.store,t=this.environment,n=this.props.referenceStore,x.Z5({environment:t,stores:[Ie(e,n)]}),void function(e,t){E.j(e,"transclusion_container_open_backlinks",t)}(t,{from:"action_bar"});var e,t,n},originGap:4,renderOrigin:t=>(0,ve.jsxs)(le.Z,{style:Ce(this.theme),...t,children:[e>0?(0,ve.jsx)(_.FormattedMessage,{defaultMessage:"Editing in {icon} {numberOfBacklinks, plural, one {{numberOfBacklinks} other page} other {{numberOfBacklinks} other pages}}",id:"transclusionContainerBlock.editingMultiple",values:{icon:(0,p.J)({width:14,transform:"rotate(180deg)",marginLeft:4,marginRight:4}),numberOfBacklinks:e}}):(0,ve.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.editingOriginal",defaultMessage:"Editing original"}),n&&(0,h.t)({width:14,fill:(0,S.fi)("orange",this.theme).fill,marginLeft:6}),(0,m.i)({width:10,fill:this.theme.mediumIconColor,marginLeft:4})]}),render:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderBacklinksMenu}),o&&(0,ve.jsx)(le.Z,{style:Ce(this.theme),onClick:this.handleCopyClick,children:(0,ve.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.copy",defaultMessage:"Copy and sync"})}),(0,ve.jsx)(ae.Z,{store:Ie(this.props.store,this.props.referenceStore),fadeIn:!1,style:{width:30,height:void 0},iconStyle:{marginTop:1,fill:this.theme.regularTextColor}})]});var i},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderBacklinksMenu=()=>(0,ve.jsx)(Re,{store:this.props.store,hasDifferingReadPermissionsFromSourceStore:this.hasDifferingReadPermissionsFromSource}),this.handleCopyClick=()=>{x.Z5({environment:this.environment,stores:[Ie(this.props.store,this.props.referenceStore)]});const e=this.fakeSelectionTrapRef.current;var t;e&&this.environment.device.isSafari?(z.setOnNode(e,this.environment.device),I.f4(),z.clear(this.environment)):I.f4(),t=this.environment,E.j(t,"transclusion_container_copy_button"),T.oV({label:V.default.formatMessage(be.copySuccessMessage),helpUrl:(0,N.UY)("guides.transclusions")})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseEnter=()=>{return e=this.stores.hoveredStore,t=this.disableTransclusionUI,void(K.Z.state.isDragging||J.default.state.isActive||t.state||e.setState(!0));var e,t},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave=()=>{return e=this.stores.hoveredStore,t=this.disableTransclusionUI,void(K.Z.state.isDragging||J.default.state.isActive||t.state||e.setState(!1));var e,t},this.currentState=this.createComputedStore((()=>{const e=Ie(this.props.store,this.props.referenceStore);return(0,Z.B)(e,this.stores.hoveredStore.state)})),this.showActionBar=this.createComputedStore((()=>{const e=this.currentState.state;return!(e!==Z.x.Selected&&e!==Z.x.SelectedDescendant||X.Z.state.isActive||H.ZP.state.isDragging||J.default.state.isActive||$.Z.state.isKeyboardMode)})),this.numberOfBacklinks=this.createComputedStore((()=>{const e=(0,B.L)(this.props.store,this.environment);return e.backlinks.length+e.inaccessibleBacklinkCount})),this.isReferenceStoreOnTrashedPage=this.createComputedStore((()=>{const{referenceStore:e}=this.props;return!(!e||!e.pathIsDead()||!G.default.checkGate("prevent_edits_trash"))})),this.disableTransclusionUI=this.createComputedStore((()=>{if(R.default.isAdminMode)return!1;const{disabled:e}=this.props;if(e&&!this.isReferenceStoreOnTrashedPage.state)return!0;const t=Ie(this.props.store,this.props.referenceStore);if(!t.canEdit())return!0;const n=t.findRecordStoreUIAncestor((e=>e!==t&&e instanceof Y.G&&e.getType()===u.Ti.transclusionContainer));return Boolean(n.ancestor)})),this.hasDifferingReadPermissionsFromSource=this.createComputedStore((()=>{const{store:e,referenceStore:t}=this.props;if(!t||!e.canEdit()||!t.canEdit())return!1;const n=(0,j.YO)(e).map((e=>{let{permissionItem:t}=e;return t})),o=(0,j.YO)(t).map((e=>{let{permissionItem:t}=e;return t})),i=(0,v.L2)(n,o).created.find((e=>!(0,b.FB)(e)));return Boolean(i)}))}handleCreated(){this.stores.hoveredStore.setState(!1),x.ZH({device:this.environment.device});const{store:e}=this.props,t=e.getContentStores()[0];t&&t.getType()===u.Ti.text&&(x.eP({environment:this.environment,store:t}),M.N_({store:t.getBlockTitleStore()}))}async canRemoveBlock(){const e=this.numberOfBacklinks.state;if(0===e)return{canRemove:!0,canUndo:!0};const t=await Se({header:(0,ve.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.remove.header",defaultMessage:"Delete original?"}),text:(0,ve.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.remove.text",defaultMessage:"These blocks are synced in {numberOfBacklinks, plural, one {{numberOfBacklinks} other page} other {{numberOfBacklinks} other pages}}. If you delete the original, the blocks will no longer be synced.",values:{numberOfBacklinks:e}}),acceptLabel:(0,ve.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.remove.confirm",defaultMessage:"Delete and unsync copies"})});return{canRemove:t,canUndo:t}}async confirmUnsyncTransclusionReference(){return 0===this.numberOfBacklinks.state||Se({header:(0,ve.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionReference.header",defaultMessage:"Unsync this?"}),text:(0,ve.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionReference.text",defaultMessage:"The selected blocks will no longer be synced with the original."}),acceptLabel:(0,ve.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionReference.confirm",defaultMessage:"Unsync"})})}async confirmUnsyncTransclusionContainer(){const e=this.numberOfBacklinks.state;return 0===e||Se({header:(0,ve.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionContainer.header",defaultMessage:"Unsync all?"}),text:(0,ve.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionContainer.text",defaultMessage:"{numberOfBacklinks, plural, one {{numberOfBacklinks} other page} other {{numberOfBacklinks} other pages}} will no longer sync with these blocks.",values:{numberOfBacklinks:e}}),acceptLabel:(0,ve.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionContainer.confirm",defaultMessage:"Unsync all"})})}renderPersisted(){const{store:e}=this.props,{device:t}=this.environment,n=this.disableTransclusionUI.state,o=Boolean(this.props.referenceStore);if(e.pathIsDead()&&o)return(0,ve.jsx)(xe,{store:this.props.store,blockType:"transclusion_container"});if(n)return(0,ve.jsx)(he.Z,{disabled:this.props.disabled,disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,store:this.props.store.getContentStore()});{const n=this.currentState.state,o=n!==Z.x.Default||this.stores.haloShouldBeVisibleStore.state||this.stores.actionBarShouldBeVisibleStore.state,r=this.showActionBar.state,a=!e.hasContent();return this.hasDifferingReadPermissionsFromSource.state,(0,ve.jsxs)("div",{className:i().transclusionBlock,style:{display:"flex"},children:[(0,ve.jsx)("span",{ref:this.fakeSelectionTrapRef,style:{height:"1px",width:"1px"}}),(0,ve.jsxs)("div",{style:{display:"flex",flexDirection:"column",position:o?"relative":void 0,paddingTop:3,paddingBottom:3,width:"100%"},onMouseLeave:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave,onMouseEnter:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseEnter,onClick:a?e=>function(e,t,n){(0,O.ZP)({event:e,context:O.Af.EditorClick,callback:()=>{(0,L.uG)(e)||A.createAndCommit({userAction:"TransclusionContainerBlock.handleEmptyClick",environment:n,perform:e=>{P.ls({environment:n,store:t,transaction:e})}})}})}(e,this.props.store,this.environment):void 0,children:[(0,ve.jsx)(he.Z,{disabled:this.props.disabled,store:this.props.store.getContentStore(),emptyPlaceholder:(0,ve.jsx)(Me,{}),disableHoverMenu:this.props.disableHoverMenu||n!==Z.x.SelectedDescendant||this.isReferenceStoreOnTrashedPage.state,disableDrag:t.isMobile}),(0,ve.jsx)(ie,{store:e},e.id),o&&(0,ve.jsx)(Ae,{haloShouldBeVisibleStore:this.stores.haloShouldBeVisibleStore,state:n}),o&&this.renderActionBar(r)]})]})}}renderActionBar(e){return(0,ve.jsx)(se.Z,{isVisible:e,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},onAnimationStart:()=>{this.stores.actionBarShouldBeVisibleStore.setState(!0)},onAnimationEnd:()=>{e||this.stores.actionBarShouldBeVisibleStore.setState(!1)},render:this.renderActionBarContent})}}const _e=ye;function Se(e){const{header:t,text:n,acceptLabel:o}=e;return new Promise((e=>{C.showDialog({showCancel:!0,keepFocus:!1,message:(0,ve.jsxs)("div",{children:[(0,ve.jsx)("div",{style:{fontWeight:k.Z.fontWeight.semibold},children:t}),n]}),items:[{label:o,color:"red",onAccept:()=>{e(!0)}}],handleCancel:()=>{e(!1)}})}))}function we(){return(0,ve.jsx)(_.FormattedMessage,{defaultMessage:"Learn more about Synced blocks",id:"transclusionContainerBlock.learnMoreLabel"})}function ke(){return(0,ve.jsx)(me.Z,{topBorder:!0,children:(0,ve.jsx)(fe.Z,{title:(0,ve.jsx)(we,{}),href:(0,N.UY)("guides.transclusions"),analyticsFrom:"transclusion_container_block"})})}function Ie(e,t){return t||e}function Ce(e){return{display:"flex",alignItems:"center",padding:"0 8px",borderRight:`1px solid ${S.ZP.whiteWithAlpha(.2)}`,boxShadow:`1px 0 0 ${e.regularDividerColor}`,marginRight:1}}function xe(e){let{store:t,blockType:n}=e;const o=(0,l.Fg)(),i=(0,s.VK)((()=>(0,F.ZP)({store:t,fullyQualified:!1,pageVisitSource:d.tY.LinkInPage})),[t]),r=(0,s.VK)((()=>(0,F.ZP)({store:t,openInSidePeek:!0,fullyQualified:!1,pageVisitSource:d.tY.PeekOpen})),[t]),a=(0,s.VK)((()=>Q.default.isSidePeekOpen()),[]),c=(0,ve.jsx)(de.Z,{href:i,altHref:r,forceAltHref:a,external:!1,inline:!0,underline:!0,children:(0,ve.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.deletedContainerBanner.viewDeletedPage",defaultMessage:"View deleted page"})});return(0,ve.jsxs)(ge.gq,{style:{color:o.text.secondary,background:o.accentColors.gray[30],padding:"16px 16px 16px 12px",borderRadius:4},alignItems:"center",children:[(0,g.D)({width:24,height:24,flexShrink:0,marginRight:10,padding:2}),(0,ve.jsx)("div",{style:{fontSize:14},children:(0,ve.jsx)(Te,{pageLink:c,blockType:n})})]})}function Te(e){const{pageLink:t,blockType:n}=e;return n===u.Ti.collectionView?(0,ve.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.deletedContainerBanner.syncedContentPageDeleted.collection",defaultMessage:"The original database has been deleted and cannot be edited. {pageLink}",values:{pageLink:t}}):n===u.Ti.transclusionContainer?(0,ve.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.deletedContainerBanner.syncedContentPageDeleted.syncedBlock",defaultMessage:"The page with the original synced block has been deleted. {pageLink}",values:{pageLink:t}}):void(0,w.t1)(n)}function Me(){const e=(0,l.Fg)();return(0,ve.jsx)("div",{style:{caretColor:e.lightTextColor,color:e.lightTextColor,paddingTop:4,paddingBottom:4},children:(0,ve.jsx)(_.FormattedMessage,{defaultMessage:"Click or drag blocks here, then paste in another page to sync content.",id:"transclusionContainerBlock.emptyEditingPlaceholder"})})}function Pe(){const e=(0,l.Fg)();return(0,ve.jsx)("div",{className:i().transclusionBlockHalo,style:{position:"absolute",left:-6,right:-6,top:-3,bottom:-3,pointerEvents:"none",borderRadius:8,border:`2px solid ${e.transclusionBorderColor}`}})}function Ae(e){let{state:t,haloShouldBeVisibleStore:n}=e;const o=t!==Z.x.Default;return(0,ve.jsx)(se.Z,{isVisible:o,enterAnimationStyle:{opacity:0},animationStyle:{opacity:t===Z.x.Hovered?.45:1,scale:1},exitAnimationStyle:{opacity:0},onAnimationStart:()=>{n.setState(!0)},onAnimationEnd:()=>{o||n.setState(!1)},render:()=>(0,ve.jsx)(Pe,{})})}function Re(e){let{store:t,hasDifferingReadPermissionsFromSourceStore:n}=e;const o=(0,l.Fg)(),i={menuType:U.og.Popup,width:400},r=(0,s.VK)((()=>n.state),[n]),a=(0,s.VK)((()=>t.getNavigableBlockStore()),[t]),c=(0,s.VK)((()=>a&&(0,F.ZP)({store:a,fullyQualified:!1,pageVisitSource:d.tY.Breadcrumb})),[a]),u=r&&a?(0,ve.jsx)(de.Z,{underline:!0,inline:!0,href:c,style:{color:o.mediumTextColor},children:(0,ve.jsx)(pe.Z,{store:a,style:{display:"inline"},shouldWrap:!0,maxLength:30})}):void 0;return(0,ve.jsxs)(ue.Z,{...i,children:[r&&a&&(0,ve.jsx)(me.Z,{style:{background:o.sidebarSecondaryBackground},children:(0,ve.jsxs)("div",{style:{display:"flex",fontSize:12,padding:"6px 16px"},children:[(0,f.B)({width:16,marginTop:6,marginRight:8,color:o.regularIconColor}),(0,ve.jsx)("div",{style:{flexGrow:1,minWidth:0},children:(0,ve.jsx)("span",{style:{overflowWrap:"break-word"},children:(0,ve.jsx)(_.FormattedMessage,{defaultMessage:"Viewership permissions on this page are different from the original page <page></page>. Some members might not have access.",id:"transclusionContainerBlock.differingPermissionsWarning",values:{page:()=>u}})})})]})}),(0,ve.jsx)(me.Z,{topBorder:r,children:(0,ve.jsx)(ee.Z,{type:"transclusion_container",store:t,originalTransclusionStore:t,disableArrow:!0})}),(0,ve.jsx)(ke,{})]})}},91497:(e,t,n)=>{n.d(t,{Z:()=>u});var o=n(67294),i=n(86628),r=n(9291),a=n(26249),s=n(73819),l=n(25157),c=n(85893);function d(e,t){const n=(0,r.useIntl)(),a=(0,o.useRef)(null),d=(0,i.VK)((()=>e.store.getTransclusionReferenceTargetStore()),[e.store]),u=(0,i.VK)((()=>d&&d.canRead()),[d]);return(0,s.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"transclusion_reference",getNode:()=>{const e=a.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),void 0!==d&&u?(0,c.jsx)(l.Z,{store:d,disabled:e.disabled,intl:n,referenceStore:e.store,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,ref:a}):null)}const u=o.memo(o.forwardRef(d),a.Z)},9672:(e,t,n)=>{n.d(t,{h:()=>os});var o=n(41393),i=n(44534),r=n(67294),a=n(86628),s=n(45238),l=n(85893);const c=(0,s.IU)("abstract",{viewBox:"0 0 32 32",svg:(0,l.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 16C0 3.199 3.199 0 16 0s16 3.199 16 16-3.199 16-16 16S0 28.801 0 16zm9.976 7.71a6.128 6.128 0 003.398 1.043 6.14 6.14 0 006.146-6.127 6.126 6.126 0 10-9.544 5.085zm11.521.79h3.004v-17H7.499v2.997h13.998V24.5zm-5-5.874a3.123 3.123 0 11-6.246 0 3.123 3.123 0 016.246 0z"})});var d=n(9291),u=n(26249),p=n(73819),m=n(68859),f=n(27016);const g=(0,d.defineMessages)({embedButtonText:{defaultMessage:"Embed Abstract",id:"abstractBlock.embeds.button.label"}});function h(e,t){const n=(0,d.useIntl)(),o=(0,r.useRef)(null),i=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"abstract",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:i,ref:o,store:e.store,iconSvg:c,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with Abstract links with public access enabled",id:"abstractBlock.embeds.caption"}),embedButtonText:n.formatMessage(g.embedButtonText),urlInputPlaceholder:"https://abstract.com/â€¦",children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed Abstract",id:"abstractBlock.placeholder"})}))}const v=r.memo(r.forwardRef(h),u.Z);var b=n(13991),y=n(480),_=n(97511),S=n(24405),w=n(42853),k=n(11751),I=n(51454),C=n(31701),x=n(37810),T=n(10910),M=n(72899),P=n(43250),A=n(14976),R=n(19124),D=n(87290),E=n(33929),B=n(16402),F=n(77907),O=n(28267),Z=n(16772),V=n(55367),U=n(80796),L=n(22294),j=n(69784),N=n(49557),z=n(68709),q=n(23063),W=n(64921),H=n(73420),K=n(63296),G=n(55217),$=n(65187);const Q=(0,d.defineMessages)({summarize:{id:"aiBlock.summarize",defaultMessage:"Summarize this page with AI"},findActionItems:{id:"aiBlock.findActionItems",defaultMessage:"Find action items on this page with AI"},helpMeWrite:{id:"aiBlock.helpMeWrite",defaultMessage:"Tell the AI what to writeâ€¦"},summarizeMeetingTranscript:{id:"aiBlock.summarizeMeetingTranscript",defaultMessage:"Summarize this meeting with any action items and decisions taken"}}),Y=r.forwardRef((function(e,t){const{store:n,disabled:o,disableHoverMenu:i,ai:{completionActions:s,completionInitialPromptActions:c}}=e,u=(0,y.O7)(),m=(0,y.Fy)(),f=(0,p.PE)(n,o),g=(0,_.l)(),[h,v]=(0,r.useState)(!1),[M,F]=(0,r.useState)(!1),[Y,J]=(0,r.useState)(!1),[X,ee]=(0,r.useState)(!1),te=(0,r.useRef)(null),ne=(0,S.yK)((e=>({actionBar:{position:"absolute",zIndex:I.t8,top:-40,right:-2,borderRadius:6,height:32,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",fontFamily:x.Z.getCompositeFontFamily(b.SP).sans,background:e.popoverBackground,boxShadow:e.mediumBoxShadow},actionButton:{display:"flex",alignItems:"center",padding:"0 8px",borderRight:`1px solid ${C.ZP.whiteWithAlpha(.2)}`,boxShadow:`1px 0 0 ${e.regularDividerColor}`,marginRight:1},icon:{fill:e.accentColors.purple[300],width:21,height:21,position:"relative",top:5},haloContent:{position:"absolute",left:-6,right:-6,top:-3,bottom:-3,pointerEvents:"none",borderRadius:8,border:`2px solid ${e.aiBlockBorderColor}`}})),[]),oe=(0,S.Fg)(),ie=(0,O.X)(te),re=!ie||ie.width<400,ae=(0,a.VK)((()=>!n.hasContent()),[n]),se=(0,a.VK)((()=>ae?D.x.Hovered:(0,D.B)(n,M)),[ae,M,n]),le=se!==D.x.Default||Y||X,ce=(0,a.VK)((()=>"completionPopup"===Z.default.state.type&&"results"===Z.default.state.stage&&Z.default.state.loading),[]),de=(0,a.VK)((()=>{const e=(0,R.z1)(),t=e.summarize,o=n.getFormat().ai_prompt_key;if(!o)return t;const i=e[o];return i||t}),[n]),ue=(0,a.VK)((()=>n.getBlockTitleStore()),[n]),pe=(0,a.VK)((()=>ue.getValue()),[ue]),me=(0,a.VK)((()=>{const e=pe;if(e)return{prompt:(0,A.Xh)(e,n)}}),[pe,n]),fe=(0,a.VK)((()=>n.getFormat().ai_last_edited),[n]),ge=(0,a.VK)((()=>{const e=g&&g.publicEditModeStore.state;return!(0,R.GD)(e)||(!!h||(!(n.canEdit()&&!n.isNonEditableState())||"helpMeWrite"===de.key&&(null==me||!me.prompt)))}),[h,n,de.key,null==me?void 0:me.prompt,g]),he=(0,a.VK)((()=>!(se!==D.x.Selected&&se!==D.x.SelectedDescendant||N.Z.state.isActive||V.ZP.state.isDragging||j.default.state.isActive||L.Z.state.isKeyboardMode)),[se]),ve=(0,r.useCallback)((()=>{U.Z.state.isDragging||j.default.state.isActive||F(!0)}),[]),be=(0,r.useCallback)((()=>{U.Z.state.isDragging||j.default.state.isActive||F(!1)}),[]),ye=(0,r.useCallback)((()=>{T.RL(u,{type:"generate",prompt_key:de.key}),v(!0),s.triggerCompletionForAiBlock({environment:u,store:n,prompt:de,additionalContext:me}).then((()=>{v(!1)}))}),[s,u,n,de,me]),_e=(0,r.useCallback)((()=>{T.RL(u,{type:"edit_prompt"}),c.showInitialPromptForAIBlock({environment:u,store:n,originRef:te,prompt:null==me?void 0:me.prompt,clientPrompt:de})}),[c,u,n,de,null==me?void 0:me.prompt]),Se=(0,r.useCallback)((()=>{c.showInitialPromptForAIBlock({environment:u,store:n,originRef:te,prompt:null==me?void 0:me.prompt,clientPrompt:de})}),[c,u,n,de,null==me?void 0:me.prompt]),we=()=>(0,l.jsx)("div",{style:ne.haloContent}),ke=()=>{const e=se!==D.x.Default;return(0,l.jsx)(q.Z,{isVisible:e,enterAnimationStyle:{opacity:0,scale:.995},animationStyle:{opacity:se===D.x.Hovered?.45:1,scale:1},exitAnimationStyle:{opacity:0,scale:.995},onAnimationStart:()=>{J(!0)},onAnimationEnd:()=>{e||J(!1)},render:we})},Ie=()=>(0,l.jsxs)("div",{style:ne.actionBar,children:[(0,l.jsxs)(W.Z,{style:{...ne.actionButton,display:"flex",gap:4},onClick:_e,disabled:ge,children:[(0,k.t)({width:16,height:16,fill:oe.accentColors.purple[400]}),(0,l.jsx)("span",{style:{color:oe.accentColors.purple[500],fontWeight:500},children:(0,l.jsx)(d.FormattedMessage,{id:"aiBlock.generated",defaultMessage:"Generated by AI"})}),fe?(0,l.jsx)("span",{style:{color:oe.accentColors.purple[300]},children:(0,B.IS)(fe,{useLowercase:!0,useCompactFormat:!0,roundDownYears:!0})}):null,ge?null:(0,w.i)({width:10,marginLeft:4,fill:oe.lightIconColor})]}),(0,l.jsx)(W.Z,{onClick:ye,disabled:ge,style:{...ne.actionButton,opacity:ge?.5:1,cursor:ge?"not-allowed":"pointer"},children:h?(0,l.jsx)(d.FormattedMessage,{id:"aiBlockBlock.update.loading",defaultMessage:"Updatingâ€¦"}):(0,l.jsx)(d.FormattedMessage,{id:"aiBlockBlock.update",defaultMessage:"Update"})})]}),Ce=(0,l.jsx)("div",{className:P.zov,style:{display:"flex"},ref:te,children:(0,l.jsx)("div",{style:{position:le?"relative":void 0,paddingTop:3,paddingBottom:3,width:"100%",marginTop:4,marginBottom:4},onMouseLeave:be,onMouseEnter:ve,children:ae?(0,l.jsxs)(z.p,{allowSelectionWithin:!0,children:[(0,l.jsxs)(H.X2,{justifyContent:"space-between",padding:8,gap:8,wrap:re?"wrap":"initial",children:[(0,l.jsxs)(H.X2,{gap:12,alignItems:"baseline",grow:1,children:[(null===(xe=de.svg)||void 0===xe?void 0:xe.call(de,ne.icon))??(0,k.t)(ne.icon),"helpMeWrite"===de.key?(0,l.jsx)($.Z,{onFocus:Se,disabled:!f,store:ue,placeholder:E.default.formatMessage(Q.helpMeWrite),pasteBehavior:"block",style:{flexGrow:1,flexBasis:0},onEnter:ye,inPageFind:{type:"block_match"}}):"helpMeWrite"===de.key?(null==me?void 0:me.prompt)||E.default.formatMessage(Q.helpMeWrite):Q[de.key]?E.default.formatMessage(Q[de.key]):void 0]}),(0,l.jsx)(K.Z,{disabled:ge,onClick:ye,style:{fontWeight:500,color:oe.accentColors.purple[500],opacity:ge?.5:1,cursor:ge?"not-allowed":"pointer"},children:h?(0,l.jsx)(d.FormattedMessage,{id:"aiBlock.generate.loading.label",defaultMessage:"Generatingâ€¦"}):(0,l.jsx)(d.FormattedMessage,{id:"aiBlock.generate.label",defaultMessage:"Generate"})})]}),ke()]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(G.Z,{disabled:o,store:n.getContentStore(),disableHoverMenu:i||se!==D.x.SelectedDescendant,disableDrag:m.isMobile}),le&&ke(),!ce&&le&&(0,l.jsx)(q.Z,{isVisible:he,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},onAnimationStart:()=>{ee(!0)},onAnimationEnd:()=>{he||ee(!1)},render:Ie})]})})});var xe;return(0,p.ez)(n,t,(0,r.useMemo)((()=>({renderedType:"ai_block",getBlockStore:()=>n,getNode:()=>te.current})),[n]),Ce)}));const J=r.memo(r.forwardRef((function(e,t){const{value:n}=(0,F.useDependency)(M.E0);return n?(0,l.jsx)(Y,{...e,ai:n,ref:t}):null})),u.Z);var X=n(21914),ee=n(12436);const te=(0,d.defineMessages)({embedButtonText:{defaultMessage:"Embed audio",id:"audioBlock.embedAudio.button.label"}});function ne(e,t){const n=(0,d.useIntl)(),o=(0,r.useRef)(null),i=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"audio",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:i,ref:o,store:e.store,iconSvg:ee.l,mediaMenuCurrentTab:"file",mediaMenuTabs:[{type:"file",fileUpload:!0},{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with .MP3s, .WAVs, and .OGGs",id:"audioBlock.embed.caption"}),embedButtonText:n.formatMessage(te.embedButtonText),urlInputPlaceholder:"https://â€¦",children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Add an audio file",id:"audioBlock.placeholder"})}))}const oe=r.memo(r.forwardRef(ne),u.Z);var ie=n(83096),re=n(30845),ae=n(23210),se=n(70203),le=n(18265),ce=n(19584),de=n(57549),ue=n(48948),pe=n(47307),me=n(27153),fe=n(12714),ge=n(24677),he=n(98104),ve=n(13966),be=n(91893),ye=n(23864),_e=n(12981),Se=n(84076),we=n(68785),ke=n(81865),Ie=n(64369),Ce=n(86329),xe=n(35021);const Te={width:16,height:16,minWidth:16,marginRight:6},Me={flexGrow:4,flexShrink:1,flexBasis:180,padding:14,paddingTop:12,overflow:"hidden",textAlign:"left"},Pe=2*ce.hM,Ae=(0,d.defineMessages)({linkPlaceholder:{defaultMessage:"Paste in https://â€¦",id:"bookmarkBlock.editBookmark.linkPlaceholder"},bookmarkTitle:{defaultMessage:"Bookmark",id:"bookmarkBlock.bookmark.title"},errorMessage:{defaultMessage:"Please enter a valid link",id:"bookmarkBlock.invalidLinkError.message"}});function Re(e,t){const{store:n}=e,o=(0,r.useRef)(null),i=(0,y.O7)(),s=(0,y.Fy)(),c=(0,p.PE)(e.store,e.disabled),u=(0,a.VK)((()=>n.getProperties()),[n]),[m,f]=(0,r.useState)(!1),g=s.isMobile||m,h=(0,r.useCallback)((()=>{const e=n.getPropertyStore("caption");ge.eP({environment:i,store:n}),he.NX({store:e})}),[i,n]),v=(0,r.useCallback)((e=>(de.bO(i,{pastedText:e,source:"bookmark_block_menu"}),ue.K({environment:i,store:n,url:e}))),[i,n]),b=(0,r.useCallback)((()=>{const e=se.QaF((null==u?void 0:u.link)??[]);e&&fe.D({environment:i,url:e})}),[i,u]),_=(0,r.useCallback)((e=>v(e)),[v]),S=(0,r.useCallback)((()=>{const e=o.current;if(c){if(!(e&&e instanceof Element))return;const t=e.getBoundingClientRect();me.$(i,{originRect:t,originGap:0,isSmallWidth:!0,showArrow:!0,title:E.default.formatMessage(Ae.bookmarkTitle),currentTab:"embed",tabs:[{type:"embed",caption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Create a visual bookmark from a link.",id:"bookmarkBlock.visualBookmark.prompt"}),buttonText:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Create bookmark",id:"bookmarkBlock.visualBookmark.create"}),inputPlaceholder:E.default.formatMessage(Ae.linkPlaceholder),onChange:e=>{const t=ae.D(e);re.B(t,"url")?(me.Z(),_(t)):pe.showErrorMessage(E.default.formatMessage(Ae.errorMessage))}}]})}}),[c,i,_]),w=null!=u&&u.link?(0,l.jsx)(Fe,{ref:o,store:n,canEdit:c,showActionButton:g,setHover:f,hideContent:e.hideContent,disableCommentMenu:e.disableCommentMenu,disabled:e.disabled}):(0,l.jsx)(Be,{ref:o,store:e.store,hideContent:e.hideContent,disableCommentMenu:e.disableCommentMenu,canEdit:c,disabled:e.disabled,showActionButton:g,onClick:S,setHover:f});return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"bookmark",getBlockStore:()=>n,getNode:()=>o.current,handleCreated:S,edit:S,caption:h,embed:v,activate:b})),[b,h,v,S,n]),w)}const De=r.memo(r.forwardRef(Re),u.Z);function Ee(e){let{imageURL:t,store:n}=e;const o={display:"block",width:"100%",height:"100%",objectFit:"cover"};return(0,l.jsx)("div",{style:{flexGrow:1,flexShrink:1,flexBasis:180,display:"block",position:"relative"},children:(0,l.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0},children:(0,l.jsx)(ke.Z,{url:t,isAuthenticated:!0,permissionRecord:n.pointer,width:250,render:(e,t)=>t&&(0,l.jsx)(_e.Z,{style:o,src:t})})})})}const Be=r.forwardRef((function(e,t){const{store:n,hideContent:o,disableCommentMenu:i,canEdit:r,disabled:a,showActionButton:s,onClick:c,setHover:u}=e;return(0,l.jsxs)(z.p,{ref:t,allowSelectionWithin:!1,onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),style:{display:"flex"},children:[(0,l.jsx)(Ce.Z,{iconSvg:ie.Q,disabled:a,shouldHideRight:!s,right:r&&(0,l.jsx)(ve.Z,{store:e.store,fadeIn:!1}),onClick:c,isLoading:!1,progressPercent:0,children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Add a web bookmark",id:"bookmarkBlock.addWebBookmark.placeholder"})}),(0,l.jsx)(ye.Z,{disableCommentMenu:i,hideContent:o,store:n})]})})),Fe=r.forwardRef((function(e,t){const{store:n,setHover:o,showActionButton:i,canEdit:s}=e,c=(0,y.O7)(),u=(0,r.useId)(),m=(0,p.rv)(n),g=(0,a.VK)((()=>n.getProperties()),[n]),h=(0,a.VK)((()=>n.getFormat()),[n]),v=se.Jcv(null==g?void 0:g.description),b=h.bookmark_cover,_=h.bookmark_icon,w=h.bookmark_loading_ttl,k=w?w-Date.now()-Pe:0,[I,x]=(0,r.useState)(k>0),T=(0,r.useCallback)((()=>o(!0)),[o]),M=(0,r.useCallback)((()=>o(!1)),[o]);(0,r.useEffect)((()=>{let e;return k>0&&(e=setTimeout((()=>{x(!1)}),k+1e3)),()=>clearTimeout(e)}),[I,k]);const P=(0,S.yK)((e=>({content:{display:"flex",flexWrap:"wrap-reverse",alignItems:"stretch",textAlign:"left",overflow:"hidden",border:`1px solid ${e.darkDividerColor}`,borderRadius:4,position:"relative",...m},loadingLabel:{minHeight:24,marginBottom:2,display:"inline-flex",alignItems:"center",color:e.mediumTextColor},link:{color:e.regularTextColor},menuButton:{position:"absolute",top:4,right:4,background:(0,f.M1)(c)}})),[m,c]),A=se.Jcv(null==g?void 0:g.link);let R=se.Jcv(null==g?void 0:g.title);if(A===R||!R){const e=le.Qc(A);e.hostname&&(R=e.hostname)}return(0,l.jsxs)(z.p,{role:"figure",ref:t,"aria-labelledby":u,allowSelectionWithin:!0,children:[(0,l.jsxs)("div",{style:{display:"flex"},children:[(0,l.jsx)(xe.Z,{permissionRecord:n.pointer,url:A,render:(t,n)=>(0,l.jsxs)(Se.Z,{href:n,external:!0,style:{flexGrow:1,minWidth:0},innerStyle:P.content,onMouseMove:T,onMouseLeave:M,children:[(0,l.jsxs)("div",{style:Me,children:[I?(0,l.jsxs)(Ie.Z,{style:P.loadingLabel,children:[(0,l.jsx)(we.Z,{style:{marginRight:8}})," ",(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Fetching preview",id:"bookmarkBlock.loadWhileFetching.message"})]}):(0,l.jsx)(Ie.Z,{style:{minHeight:24,marginBottom:2},children:R}),v&&(0,l.jsx)(Ie.Z,{isSmall:!0,isMultiline:!0,style:{height:32,overflow:"hidden"},children:v}),(0,l.jsxs)("div",{style:{display:"flex",marginTop:6},children:[_&&_.length>0&&(0,l.jsx)(ke.Z,{url:_,isAuthenticated:!0,permissionRecord:e.store.pointer,render:(e,t)=>t&&(0,l.jsx)("img",{src:t,style:Te})}),(0,l.jsx)(Ie.Z,{style:P.link,isSmall:!0,children:A})]})]}),b&&(0,l.jsx)(Ee,{store:e.store,imageURL:b}),i&&s&&(0,l.jsx)(ve.Z,{store:e.store,style:P.menuButton,iconStyle:{fill:C.ZP.white},fadeIn:!0})]})}),(0,l.jsx)(ye.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]}),(0,l.jsx)(be.Z,{store:e.store,captionAriaId:u,disabled:e.disabled})]})}));var Oe=n(49271),Ze=n(3043);function Ve(e,t){const n=(0,r.useRef)(null),o=(0,y.Fy)(),i=(0,p.PE)(e.store,e.disabled),s=(0,a.VK)((()=>e.store.getNavigableBlockStore()),[e.store]),c=s?(0,l.jsxs)(z.p,{allowSelectionWithin:!0,style:{display:"flex",paddingTop:Oe.ZD.paddingTop,paddingBottom:Oe.ZD.paddingBottom},ref:n,children:[(0,l.jsx)(Ze.l2,{showCurrentPageControls:!1,ancestorMaxWidth:200,currentPageMaxWidth:300,store:s,maxAncestorCount:3,isMobile:o.isMobile,style:{flexGrow:1,minWidth:0,fontSize:"inherit"}}),o.isMobile&&i&&(0,l.jsx)(ve.Z,{store:e.store,fadeIn:!0,style:{marginTop:2,marginRight:4}}),(0,l.jsx)(ye.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]}):null;return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"breadcrumb",getNode:()=>n.current,getBlockStore:()=>e.store})),[e.store]),c)}const Ue=r.memo(r.forwardRef(Ve),u.Z);var Le=n(7825),je=n(27755),Ne=n(38376),ze=n(6740),qe=n(17397),We=n(99036),He=n(80951),Ke=n(19233),Ge=n(23867),$e=n(83960),Qe=n(75553),Ye=n(893),Je=n(62385);function Xe(e){const t=(0,y.O7)(),n=(0,y.Fy)(),o=(0,S.Fg)(),i=(0,p.PE)(e.store,e.disabled),a=(0,r.useCallback)((()=>{const n=se.Jcv(e.store.getBlockTitleStore().getValue());Ye.RD({environment:t,stringValue:n,copiedMessage:Ye.tq.copiedCodeToClipboard})}),[t,e.store]),s={height:25,background:o.codeBlockButtonBackground,color:o.regularTextColor,fontWeight:x.Z.fontWeight.regular,padding:"4px 6px",fontSize:11.5};return(0,l.jsxs)("div",{style:{color:o.mediumTextColor,display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,marginTop:4,marginRight:4},children:[!n.isMobile&&(0,l.jsxs)(Je.Z,{onClick:a,style:{...s,borderTopRightRadius:0,borderBottomRightRadius:0},children:[(0,Qe.U)({height:16,width:16,paddingRight:4}),(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Copy",id:"codeBlock.copyToClipboard.button"})]}),!n.isMobile&&i&&(0,l.jsx)(Je.Z,{onClick:e.handleEditCaption,style:{...s,marginLeft:1,marginRight:1,borderRadius:0},children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Caption",id:"codeBlock.caption.button"})}),i&&(0,l.jsx)(ve.Z,{style:{height:25,background:o.codeBlockButtonBackground,borderTopLeftRadius:n.isMobile?3:0,borderBottomLeftRadius:n.isMobile?3:0,paddingLeft:8,paddingRight:8},store:e.store,fadeIn:!1})]})}var et=n(1898),tt=n(3124);const nt=(0,s.IU)("codePreviewOnly",{viewBox:"0 0 24 20",svg:(0,l.jsx)("path",{d:"M2.608 11.906h1.21v1.032c0 1.463.766 2.215 2.243 2.215h9.33c1.477 0 2.243-.758 2.243-2.215V6.444c0-1.463-.766-2.221-2.242-2.221H14.12V3.197c0-1.463-.772-2.221-2.242-2.221h-9.27C1.132.976.366 1.734.366 3.197v6.494c0 1.457.766 2.215 2.242 2.215zm.082-1.34c-.635 0-.984-.328-.984-.99v-6.27c0-.662.349-.99.984-.99h9.106c.629 0 .984.328.984.99v.917H6.06c-1.476 0-2.242.758-2.242 2.221v4.122H2.69zm3.453 3.254c-.636 0-.985-.335-.985-.998V6.561c0-.664.349-.998.985-.998h9.167c.628 0 .984.334.984.998v6.261c0 .663-.356.998-.984.998H6.143zm2.713-1.77c0 .307.335.437.595.287l3.972-2.324a.372.372 0 00-.007-.643L9.451 7.046c-.26-.15-.595-.027-.595.287v4.717z"})}),ot=(0,s.IU)("splitView",{viewBox:"0 0 24 20",svg:(0,l.jsx)("path",{d:"M13.456 11.143V2.864c0-1.476-.766-2.242-2.222-2.242H2.915C1.452.622.693 1.388.693 2.864v8.278c0 1.477.76 2.243 2.222 2.243h8.32c1.462 0 2.221-.766 2.221-2.242zm-1.34-.083c0 .636-.335.985-.998.985H3.024c-.663 0-.99-.349-.99-.985V7.663h10.082v3.397zM2.033 2.946c0-.629.328-.984.991-.984h8.094c.663 0 .998.355.998.984v3.405H2.033V2.946z"})});var it=n(42274),rt=n(72495),at=n(62967);const st=(0,d.defineMessages)({showCodePreviewSection:{id:"action.codePreviewSection.name",defaultMessage:"Show in block"}}),lt=(0,at.cN)({key:"show code",displayName:at.RE.showOnlyCodeFormat,analyticsName:at.RE.showOnlyCodeFormat.defaultMessage,svg:tt._,validators:[],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;it.pZ({environment:n,blocks:t,previewFormat:"code"})}}),ct=(0,at.cN)({key:"show preview on code block",displayName:at.RE.showCodePreviewFormat,analyticsName:at.RE.showCodePreviewFormat.defaultMessage,svg:nt,validators:[],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;it.pZ({environment:n,blocks:t,previewFormat:"preview"})}}),dt=(0,at.cN)({key:"show code and preview",displayName:at.RE.showSplitViewFormat,analyticsName:at.RE.showSplitViewFormat.defaultMessage,svg:ot,validators:[],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;it.pZ({environment:n,blocks:t,previewFormat:"split_view"})}}),ut=[{key:"code preview actions block",render:e=>(0,l.jsx)(rt.Z,{isTitleUppercase:!1,...e}),title:E.default.formatMessage(st.showCodePreviewSection),actions:[lt,ct,dt]}];var pt=n(60709),mt=n(61766),ft=n(31194),gt=n(95477),ht=n(77080),vt=(n(21703),n(66673)),bt=n(57347),yt=n(7032);const _t="\n---\n";var St=n(42402),wt=n(29551);const kt=(()=>{try{return"true"===new URLSearchParams(window.location.search).get("disableMermaid")}catch(e){return!1}})();function It(e){const{mermaidAPI:t,source:n}=e,o=(0,r.useRef)(null),i=(0,r.useRef)(`mermaid-${(0,yt.ZP)()}`),[a,s]=(0,r.useState)(),c=(0,S.yK)((e=>({diagram:(0,wt.xk)({alignContent:"center",justifyContent:"center"})})),[]),d=function(e){switch(e){case"dark":return"dark";case"light":return"neutral";default:(0,et.t1)(e)}}((0,S.Fg)().mode),u=(0,r.useMemo)((()=>function(e){const{source:t,theme:n}=e,o=`%%{init: {'theme':'${n}'}}%%\n`;return t.startsWith("---\n")&&t.includes(_t)?t.replace(_t,`${_t}${o}`):`${o}${t}`}({source:n,theme:d})),[n,d]);return(0,r.useLayoutEffect)((()=>{if(!t)return;let e=!1;try{t.render(i.current,u).then((t=>{const n=t.svg,i=t.bindFunctions;if(e)return;if(!o.current)return;o.current.innerHTML=n;const r=o.current.firstChild;r&&r instanceof SVGSVGElement&&r.removeAttribute("height");try{i&&i(o.current),s(void 0)}catch(a){s((0,bt.t)(a))}}),(e=>{s((0,bt.t)(e))}))}catch(n){s((0,bt.t)(n))}return()=>{e=!0}}),[u,t]),(0,l.jsxs)(l.Fragment,{children:[a&&(0,l.jsx)(Ct,{error:a}),(0,l.jsx)("div",{style:c.diagram,ref:o})]})}function Ct(e){const{error:t}=e,n=(0,S.yK)((e=>({label:{color:e.errorText,marginBottom:4,whiteSpace:"pre-wrap"}})),[]);return"str"in t?(0,l.jsx)("div",{children:(0,l.jsxs)(Ie.Z,{isMultiline:!0,style:n.label,children:[t.str,(0,l.jsx)("div",{children:(0,l.jsx)(St.Z,{external:!0,href:"https://mermaid-js.github.io/mermaid/#/examples",children:(0,l.jsx)(d.FormattedMessage,{id:"mermaidRenderer.error.seeMermaidExamples",defaultMessage:"See Mermaid examples"})})})]})}):(0,l.jsx)(Ie.Z,{isMultiline:!0,style:n.label,children:(0,l.jsx)(d.FormattedMessage,{id:"mermaidRenderer.error.unknownError",defaultMessage:"Syntax error in Mermaid diagram: {error}",values:{error:`${t.name}: ${t.message}`}})})}function xt(e){const t=(0,a.VK)((()=>e.store.getBlockTitleStore()),[e.store]),n="code"===e.currentCodePreviewFormat,o=(0,r.useMemo)((()=>Mt(e.currentLanguage)),[e.currentLanguage]),i=(0,a.VK)((()=>t.getValue()),[t]);if(n||!i||!o)return null;const s=o.component;return(0,l.jsx)("div",{style:At(e.currentCodePreviewFormat),children:(0,l.jsx)(s,{source:A.Xh(i,t)})})}const Tt={Mermaid:{component:function(e){const{source:t}=e,n=(0,vt.Kt)(t,300,Object.is),o=(0,F.useDependency)(F.deps.mermaidAPI),i=kt?new Error("Mermaid is disabled because 'disableMermaid=true' was in the query string when the page loaded. Reload the page to re-enable Mermaid."):o.error;return(0,l.jsx)("div",{children:i?(0,l.jsx)(Ct,{error:i}):(0,l.jsx)(It,{mermaidAPI:o.value,source:n})})},gate:()=>"on"===ht.default.getGroup("mermaid")}};function Mt(e){const t=Tt[e];if(t&&t.gate())return t}function Pt(e){return Boolean(Mt(e))}function At(e){switch(e){case"split_view":return{padding:16,flexGrow:1,flexShrink:0};case"preview":return{padding:16,paddingTop:40,alignSelf:"center",flexGrow:1,flexShrink:0};case"code":return{};default:(0,et.t1)(e)}}var Rt=n(48019),Dt=n(31945),Et=n(78140);function Bt(e){const t=(0,y.O7)(),n=(0,y.Fy)(),o=(0,S.Fg)(),i=(0,p.PE)(e.store,e.disabled),s=(0,a.qz)(void 0,mt.Z),c=(0,r.useCallback)((o=>{const i=(0,l.jsx)(Rt.Z,{context:{blocks:[e.store],environment:t,publicEditMode:void 0},sections:ut,initialFocus:["code","preview","split_view"].findIndex((t=>t===e.currentCodePreviewFormat)),onAccept:o.close});let r;return r=n.isMobile?{menuType:pt.og.ActionSheet}:{menuType:pt.og.Popup,width:167,maxHeight:"50vh"},(0,l.jsx)(Et.Z,{...r,children:i})}),[n.isMobile,t,e.currentCodePreviewFormat,e.store]);return Pt(e.currentLanguage)?(0,l.jsx)(Dt.ZP,{popupType:n.isMobile?Dt.Z4.SlideUp:Dt.Z4.Popup,renderOrigin:t=>(0,l.jsxs)(Je.Z,{disabled:!i,style:{marginRight:5},...t,children:[Ft(e.currentCodePreviewFormat),i&&(0,w.i)({width:10,marginLeft:4,fill:o.lightIconColor})]}),buttonPopupStore:s,placementToOrigin:ft.Iw.Bottom,render:c}):null}function Ft(e){let t;switch(e){case"split_view":t=at.RE.showSplitViewFormat;break;case"preview":t=at.RE.showCodePreviewFormat;break;case"code":t=at.RE.showOnlyCodeFormat;break;default:(0,et.t1)(e)}return(0,l.jsx)(d.FormattedMessage,{...t})}var Ot=n(15157),Zt=n(13447),Vt=n(52275),Ut=n(68894);function Lt(e){const t=(0,d.useIntl)(),n=(0,y.O7)(),o=(0,y.Fy)(),i=(0,S.Fg)(),s=(0,p.PE)(e.store,e.disabled),[c,u]=(0,r.useState)(""),m=(0,a.qz)(void 0,mt.Z),f=(0,r.useCallback)((e=>{u(e.target.value)}),[]),g=(0,r.useCallback)((()=>{u("")}),[]),h=(0,r.useCallback)((t=>{Zt.createAndCommit({userAction:"CodeBlock.setPersistedLanguage",environment:n,perform:n=>{it.E5({blocks:[e.store],language:t,transaction:n})}}),Ot.Z.set({userId:n.currentUser.id,key:$e.T.localLanguagePreferenceKey,value:t})}),[n,e.store]),v=(0,r.useCallback)((i=>{const r=qe.X0.filter((e=>"Java/C/C++/C#"!==e)),a=[{key:0,render:e=>(0,l.jsx)(rt.Z,{...e}),actions:r.map((e=>{const t={key:e,displayName:e,analyticsName:e,searchName:e,render:t=>(0,l.jsx)(Vt.Z,{title:e,...t}),action:()=>{h(e),i.close()},closeParentMenu:!0};return t}))}],s=(0,l.jsx)(Rt.Z,{filter:c,context:{blocks:[],environment:n,publicEditMode:void 0},sections:a,initialFocus:c?0:r.findIndex((t=>t===e.currentLanguage))}),u=(0,l.jsx)(rt.Z,{isInput:!0,children:(0,l.jsx)(Ut.ZP,{value:c,onChange:f,focus:!o.isMobile||void 0,placeholder:t.formatMessage(at.RE.searchPlaceholder),focusAfterAnimation:!0})});let p;return p=o.isMobile?{menuType:pt.og.Modal,title:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Language",id:"codeBlock.mobileLanguageMenu.title"}),right:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Done",id:"codeBlock.mobileLanguageMenu.doneButton.label"}),onClickRight:i.close,header:u}:{menuType:pt.og.Popup,width:240,maxHeight:"50vh",header:u},(0,l.jsx)(Et.Z,{...p,children:s})}),[e.currentLanguage,o.isMobile,n,f,t,c,h]);return(0,l.jsx)(Dt.ZP,{popupType:o.isMobile?Dt.Z4.SlideUp:Dt.Z4.Popup,renderOrigin:t=>(0,l.jsxs)(Je.Z,{disabled:!s,style:{marginRight:5},...t,children:[e.currentLanguage,s&&(0,w.i)({width:10,marginLeft:4,fill:i.lightIconColor})]}),buttonPopupStore:m,placementToOrigin:ft.Iw.Bottom,render:v,onClose:g})}var jt=n(28385);const Nt="opacity 300ms ease-in";function zt(e,t){const n=(0,y.O7)(),{isMobile:o}=(0,y.Fy)(),i=(0,r.useId)(),s=(0,r.useRef)(null),{store:c,disabled:d}=e,u=(0,a.VK)((()=>{const e=c.getProperties()||{},t=He.Sj(e.language,We.fG);return t&&(0,qe.L9)(t)?t:$e.T.defaultLanguage}),[c]),m=Ke.W[u],f=(0,a.VK)((()=>Pt(u)?c.getFormat().code_preview_format??"split_view":$e.T.defaultCodePreviewFormat),[u,c]),g=(0,a.VK)((()=>c.getFormat().code_wrap),[c]),h=(0,a.VK)((()=>c.getBlockTitleStore()),[c]),[v,b]=(0,r.useState)(!1),[_,w]=(0,r.useState)(!1),k=(0,a.VK)((()=>L.Z.state.isKeyboardMode),[]),I=(0,S.yK)((t=>({wrapper:{flexGrow:1,borderRadius:4,textAlign:"left",position:"relative",background:t.codeBlockBackground,minWidth:0,width:"100%",...e.style},languageSelector:{position:"absolute",top:8,left:8,zIndex:1,color:t.mediumTextColor,display:"flex",alignItems:"center",justifyContent:"flex-end",opacity:v||_||o?1:0,transition:Nt},header:{position:"absolute",top:3,right:1,zIndex:1,color:t.mediumTextColor,display:"flex",alignItems:"center",justifyContent:"flex-end",height:25,fontSize:11.5,opacity:o||_||!k&&v?1:0,transition:Nt},captionContainer:{background:t.contentBackground,paddingRight:105}})),[_,v,k,o,e.style]),C=(0,r.useCallback)((()=>{const e=c.getPropertyStore("caption");ge.eP({environment:n,store:c}),he.NX({store:e})}),[n,c]),x=(0,r.useCallback)((e=>{const t=e.target;t instanceof HTMLElement&&(0,ze.E)(t)&&w(!0)}),[]),T=(0,r.useCallback)((e=>{w(!1)}),[]),M=(0,r.useCallback)((()=>{b(!0)}),[]),P=(0,r.useCallback)((()=>{b(!1)}),[]),A=(0,l.jsxs)("div",{ref:s,style:{display:"flex"},children:[(0,l.jsxs)(z.p,{role:"figure","aria-labelledby":i,allowSelectionWithin:!0,style:I.wrapper,onMouseMove:M,onMouseLeave:P,children:[(0,l.jsxs)("div",{onFocus:x,onBlur:T,style:I.languageSelector,children:[(0,l.jsx)(Lt,{disabled:e.disabled,store:e.store,currentLanguage:u}),(0,l.jsx)(Bt,{disabled:e.disabled,store:e.store,currentLanguage:u,currentCodePreviewFormat:f})]}),(0,l.jsx)("div",{onFocus:x,onBlur:T,style:I.header,children:(0,l.jsx)(Xe,{store:e.store,disabled:e.disabled,handleEditCaption:C})}),(0,l.jsxs)("div",{children:[Wt(u,f)&&(0,l.jsx)(jt.Z,{store:h,blockStore:c,language:m,disabled:d,codeWrap:Boolean(g),isQuickFind:Boolean(e.isQuickFind),parentSpaceId:(0,Ge.C)(c.pointer.spaceId)}),(0,l.jsx)(xt,{store:c,disabled:d,currentCodePreviewFormat:f,currentLanguage:u})]}),(0,l.jsx)("div",{style:I.captionContainer,children:(0,l.jsx)(be.Z,{store:e.store,captionAriaId:i,disabled:e.disabled})})]}),(0,l.jsx)(ye.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store}),"â€‹"]});return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"code",getBlockStore:()=>c,getNode:()=>s.current,caption:C})),[C,c]),A)}const qt=r.memo(r.forwardRef(zt),u.Z);function Wt(e,t){return!Pt(e)||"preview"!==t}const Ht=(0,s.IU)("codepen",{viewBox:"0 0 40 40",svg:(0,l.jsx)("path",{d:"M39.9834,13.7071 C39.8236,12.6665 38.6647,12.1063 37.8655,11.586 C36.4269,10.6255 35.0283,9.70502 33.5897,8.74452 C30.1931,6.46334 26.7564,4.18216 23.3598,1.90098 C22.5606,1.38071 21.7613,0.820424 20.9621,0.300155 C20.4027,-0.100052 19.6434,-0.100052 19.044,0.300155 C16.7663,1.82094 14.4485,3.38175 12.1708,4.90253 L2.10066,11.626 C1.22152,12.1863 0.0626603,12.7466 0.0226996,13.9472 C-0.0172612,15.2679 0.0226996,16.6286 0.0226996,17.9493 L0.0226996,24.3526 C0.0226996,25.5132 -0.217065,26.8739 0.861875,27.5943 C3.41936,29.3552 6.01681,31.036 8.61426,32.7569 C11.8111,34.878 15.008,37.0391 18.2048,39.1602 C19.084,39.7606 19.9631,40.4009 21.0421,39.6805 C21.9611,39.0802 22.8403,38.4799 23.7594,37.8796 C27.3159,35.5184 30.8724,33.1171 34.4289,30.7559 L38.385,28.1145 C38.6248,27.9544 38.9045,27.7944 39.1443,27.5943 C39.7037,27.1941 39.9435,26.6338 39.9435,25.9534 L39.9435,14.9477 C39.9834,14.5075 40.0234,14.1073 39.9834,13.7071 C39.9834,13.7871 39.9834,13.6671 39.9834,13.7071 Z M21.7214,4.94255 L35.1882,13.9472 L29.194,17.9893 L21.7214,12.9867 L21.7214,4.94255 Z M18.2848,4.94255 L18.2848,12.9467 L10.8521,17.9493 L4.81799,13.9472 L18.2848,4.94255 Z M3.45932,17.1489 L7.73512,20.0304 L3.45932,22.9118 L3.45932,17.1489 Z M18.2848,35.1182 L4.81799,26.1135 L10.8121,22.0714 L18.2448,27.074 L18.2448,35.1182 L18.2848,35.1182 Z M20.0031,24.1125 L13.929,20.0304 L20.0031,15.9482 L26.0771,20.0304 L20.0031,24.1125 Z M21.7214,35.1182 L21.7214,27.114 L29.1541,22.1114 L35.1482,26.1535 L21.7214,35.1182 Z M36.5468,22.9118 L32.271,20.0304 L36.5868,17.1489 L36.5468,22.9118 Z"})});function Kt(e,t){const n=(0,r.useRef)(null),o=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"codepen",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:o,ref:n,store:e.store,iconSvg:Ht,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with any public CodePen linkâ€¦",id:"codepenBlock.embed.caption"}),children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed CodePen",id:"codepenBlock.placeholder"})}))}const Gt=r.memo(r.forwardRef(Kt),u.Z);var $t=n(53223),Qt=n(1302),Yt=n(53965),Jt=n(13084),Xt=n(52989),en=n(78175),tn=n(12534),nn=n(39500),on=n(50628),rn=n(28651),an=n(96049);const sn={width:46,handleWidth:4};function ln(e){const t=(0,a.qz)(e.mouseStore,rn.Z),{showHandle:n,onMouseDown:o,onTouchStart:i,onContextMenu:s,onDoubleClick:c}=e,d=(0,y.O7)(),u=(0,a.VK)((()=>n&&(t.state.mouseEntered||d.device.isMobile&&an.Z.state)),[n,t,d.device]),p=(0,r.useCallback)((()=>{t.setState({...t.state,mouseEntered:!1}),an.Z.removeListener(p)}),[t]),m=(0,r.useCallback)((()=>{an.Z.removeListener(p),an.Z.state||t.setState({...t.state,mouseEntered:!0})}),[p,t]),f=(0,r.useCallback)((()=>{an.Z.state?an.Z.addListener(p):t.setState({...t.state,mouseEntered:!1})}),[p,t]),g=(0,S.yK)((e=>{const t={position:"relative",width:sn.width,flexGrow:0,flexShrink:0,transition:"opacity 200ms ease-out",opacity:0};return{base:t,hovered:{...t,opacity:1,cursor:"col-resize"},handle:{position:"absolute",top:0,bottom:0,left:sn.width/2-sn.handleWidth/2,width:sn.handleWidth,height:"100%",background:e.darkDividerColor}}}),[]),h=u?g.hovered:g.base;return(0,l.jsx)("div",{style:h,onDoubleClick:c,onMouseDown:o,onTouchStart:i,onContextMenu:s,onMouseEnter:m,onMouseLeave:f,children:n&&(0,l.jsx)("div",{style:g.handle})})}const cn=r.memo(ln);var dn=n(79954);function un(e,t){const{ratio:n,store:o,isLastItem:i,disabled:s,numColumns:c}=e,d=(0,y.O7)(),u=(0,r.useRef)(!1),m=(0,p.PE)(o,s),f=r.useRef(null),g=(0,a.VK)((()=>1===o.getContentLength()),[o]),h=(0,a.VK)((()=>{const e={width:"100%"};return c>1&&(e.width=`calc((100% - ${sn.width*(c-1)}px) * ${n})`),(0,en.zE)(o,d)||(e.width="100%"),e}),[d,c,n,o]),v=e=>{(0,en.zE)(o,d)&&(0,tn.ZP)({event:e,context:tn.Af.EditorMouseDown,callback:()=>{u.current=!0,e.preventDefault(),Xt.AI({environment:d,target:e.target,startX:e.clientX,startY:e.clientY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!1})}})},b=e=>{if(u.current&&!nn.uG(e)){const{clientX:t,clientY:n,target:o}=e;Qt.default.afterNextFlush((()=>{he.J9(d,{x:t,y:n,target:o instanceof Element?o:void 0}),u.current=!1}))}},_=(0,l.jsx)(q.Z,{isVisible:!0,animationStyle:h,render:()=>(0,l.jsx)("div",{ref:f,style:fn(e.store,d),onMouseDown:v,onMouseUp:b,onClick:t=>function(e,t,n){if(on.Z.hasBeenUpdatedSince(e.timeStamp))return;if(t.canEdit()){const{clientX:o,clientY:i,target:r}=e;Qt.default.afterNextFlush((()=>{Zt.createAndCommit({userAction:"Column.handleClick",environment:n,perform:e=>{he.LG(n,{x:o,y:i,target:r instanceof Element?r:void 0},t,e)}})}))}}(t,e.store,d),children:(0,l.jsx)(dn.Z,{store:o,canDropLeft:m&&(0,en.zE)(e.store,d),canDropRight:i&&m&&(0,en.zE)(e.store,d),onSelectableDrop:t=>function(e,t,n,o){const{droppedDirection:i,droppedStores:r,duplicate:a}=e;Zt.createAndCommit({userAction:"Column.handleDrop",environment:o,perform:e=>{Jt.LQ({environment:o,droppedDirection:i,droppedStores:r,targetParentStore:t.getContentStore(),targetStore:n,duplicate:a,transaction:e})}})}(t,e.columnListStore,e.store,d),analyticsName:"column",style:{display:"flex",flexDirection:"column"},shouldShowDropZone:!0,isListContainer:!0,children:(0,l.jsx)(G.Z,{store:o.getContentStore(),disabled:s,disableLayout:g,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag})})})});return(0,p.ez)(o,t,(0,r.useMemo)((()=>({renderedType:"column",getBlockStore:()=>o,getNode:()=>f.current})),[o]),_)}const pn=r.memo(r.forwardRef(un),u.Z),mn=12;function fn(e,t){const n={paddingTop:mn,paddingBottom:mn};return(0,en.zE)(e,t)&&Yt.f0(n,{flexGrow:0,flexShrink:0}),n}n(57658);var gn=n(45697),hn=n.n(gn),vn=n(83355),bn=n(41432),yn=n(96802),_n=n(95645),Sn=n(49085);class wn extends Sn.default{getInitialState(){return{dragging:!1}}}const kn=wn;var In=n(23883),Cn=n(70518),xn=n(12137),Tn=n(58202),Mn=n(36610);function Pn(e){const{columnListStore:t}=e;t.setState({dragging:!1})}function An(e){const{columnListBlockStore:t,diffX:n,columnListStore:o,leftColumn:i,rightColumn:r}=e;if(o.state.dragging){const{leftColumnStartWidth:e}=o.state,a=(0,xn.Z)(o.state.leftColumnStartRatio,0,1),{rightColumnStartWidth:s}=o.state,l=(0,xn.Z)(o.state.rightColumnStartRatio,0,1),c=e+s,d=a+l,u=(0,xn.Z)(e+n,0,c),p=(0,xn.Z)(s-n,0,c),m=d*(u/c),f=d*(p/c);if(0===u&&0===p)return o.setState({...o.state,temporaryRatios:{}}),{leftColumnNewRatio:a,rightColumnNewRatio:l};{const e=1/(8*t.getContentLength());let n=Math.round(m/e)*e,s=f+(m-n);return n<e&&(n=e,s=a+l-e),s<e&&(s=e,n=l+a-e),o.setState({...o.state,temporaryRatios:{[i.id]:n,[r.id]:s}}),{leftColumnNewRatio:n,rightColumnNewRatio:s}}}}var Rn=n(6685);function Dn(e){const t=(0,a.qz)(e.mouseStore,rn.Z),{canDrag:n,columnList:o,leftColumn:i,rightColumn:s,columnListStore:c}=e,d=(0,y.O7)(),u=(0,r.useCallback)((e=>{n&&(e.preventDefault(),function(e){const{environment:t,columnListStore:n,leftColumn:o,rightColumn:i}=e,r=Tn.R.getRect(o),a=Tn.R.getRect(i);r&&a&&(n.setState({dragging:!0,temporaryRatios:{},leftColumnStartWidth:r.width,leftColumnStartRatio:o.getColumnRatio(),rightColumnStartWidth:a.width,rightColumnStartRatio:i.getColumnRatio()}),ge.ZH(t),he.ZH(t))}({environment:d,columnListStore:c,leftColumn:i,rightColumn:s}),ge.ZH(d),he.sD())}),[n,d,i,c,s]),p=(0,r.useCallback)((e=>{n&&An({columnListBlockStore:o,columnListStore:c,leftColumn:i,rightColumn:s,diffX:e.diffX})}),[n,o,c,i,s]),m=(0,r.useCallback)((e=>{Zt.createAndCommit({userAction:"ColumnDivider.handleDragEnd",environment:d,perform:t=>{n&&function(e){const{environment:t,columnListStore:n,transaction:o,leftColumn:i,rightColumn:r}=e,a=An(e);if(a){const{leftColumnNewRatio:e,rightColumnNewRatio:s}=a;yn.FH({stores:[i],update:{column_ratio:e},transaction:o}),yn.FH({stores:[r],update:{column_ratio:s},transaction:o}),n.state.dragging&&n.setState({...n.state,temporaryRatios:{}}),Mn.wy(t)}}({environment:d,columnListBlockStore:o,columnListStore:c,leftColumn:i,rightColumn:s,diffX:e.diffX,transaction:t})}}),Pn({columnListStore:c})}),[n,o,c,d,i,s]),f=(0,r.useCallback)((()=>{Pn({columnListStore:c})}),[c]),g=(0,r.useCallback)((()=>{Zt.createAndCommit({userAction:"ColumnDivider.handleDoubleClick",environment:d,perform:e=>{n&&function(e){const{columnListBlockStore:t,transaction:n,environment:o}=e,i=1/t.getContentLength();yn.FH({stores:t.getContentStores(),update:{column_ratio:i},transaction:n}),Mn.n2(o)}({environment:d,columnListBlockStore:o,transaction:e})}})}),[n,o,d]);return n?(0,l.jsx)(Rn.Z,{allowDragWhileTextEditing:!0,onDraggableDragStart:u,onDraggableDragMove:p,onDraggableDragEnd:m,onDraggableDragCancel:f,disableHorizontalEdgeScroll:!0,disableVerticalEdgeScroll:!0,render:e=>(0,l.jsx)(cn,{showHandle:!0,mouseStore:t,onDoubleClick:g,...e})}):(0,l.jsx)(cn,{mouseStore:t,showHandle:!1})}const En=r.memo(Dn),Bn={display:"flex",position:"relative",flexGrow:1};class Fn extends _n.Z{constructor(){super(...arguments),this.storeTypes={columnListStore:kn,blockResizerStore:m.Z},this.getChildrenLimit=this.createComputedStore((()=>{const{limitParents:e}=In.Z.state;let t;return this.props.store.findRecordStoreUIAncestor((n=>{const o=e.get(n);return!!o&&(t=o[this.props.store.id],!0)})),t})),this.isColumnListResizableStore=this.createComputedStore((()=>this.props.store.canEdit()&&(0,en.Po)(this.props.store,this.environment)))}getChildContext(){return{...this.context,isInColumnList:!0}}renderPersisted(){const{disabled:e}=this.props,t=this.stores.columnListStore.state,n=this.getChildrenLimit.state;let o=this.props.store.getContentStores();Yt.hj(n)&&(o=Yt.tP(o,0,n));let i=o.map(((e,n)=>{let o;return o=t.dragging&&t.temporaryRatios.hasOwnProperty(e.id)?t.temporaryRatios[e.id]:e.getColumnRatio(),o}));const r=Yt.Sm(i);i=Yt.UI(i,(e=>e/r));const a=[];return o.forEach(((t,n)=>{const r=0===n,s=n===o.length-1;a.push((0,l.jsx)(pn,{store:t,isFirstItem:r,isLastItem:s,numColumns:o.length,ratio:i[n],disabled:e,columnListStore:this.props.store},t.id)),s||a.push((0,l.jsx)(En,{canDrag:this.canEdit(),columnList:this.props.store,leftColumn:t,rightColumn:o[n+1],columnListStore:this.stores.columnListStore},`divider${t.id}`))})),this.renderContainer(a)}renderContainer(e){return this.isColumnListResizableStore.state?(0,l.jsx)("div",{style:Ln(this.props.store,this.stores.blockResizerStore),children:(0,l.jsxs)("div",{style:Bn,children:[(0,l.jsx)(Cn.ZP,{disabled:!this.canEdit(),blockResizerStore:this.stores.blockResizerStore,resizeComponent:this,resizerType:Cn.IS.Horizontal,resizerAlignment:Cn.bZ.Left,preserveScale:!0,resizeHorizontally:!0,resizeVertically:!1,store:this.props.store,children:(0,l.jsx)("div",{style:Zn("left"),children:(0,l.jsx)(cn,{onDoubleClick:()=>Un(this.props.store,this.environment),showHandle:this.canEdit()})})},"divider-left-edge"),e,(0,l.jsx)(Cn.ZP,{disabled:!this.canEdit(),resizeComponent:this,resizerType:Cn.IS.Horizontal,resizerAlignment:Cn.bZ.Right,preserveScale:!0,resizeHorizontally:!0,resizeVertically:!1,store:this.props.store,blockResizerStore:this.stores.blockResizerStore,children:(0,l.jsx)("div",{style:Zn("right"),children:(0,l.jsx)(cn,{onDoubleClick:()=>Un(this.props.store,this.environment),showHandle:this.canEdit()})})},"divider-right-edge")]})}):(0,l.jsx)("div",{style:Vn(this.props.store,this.environment),children:e})}handleCreated(){const{store:e}=this.props,t=e.getContentStores()[0];if(t&&t.getType()===bn.Ti.column){const e=t.getContentStores()[0];e&&e.getType()===bn.Ti.text&&(ge.eP({environment:this.environment,store:e}),he.N_({store:e.getBlockTitleStore()}))}}}Fn.contextTypes=vn.w,Fn.childContextTypes={isInColumnList:hn().any,...vn.w};const On=Fn;function Zn(e){return{display:"flex",position:"absolute",top:0,bottom:0,right:"left"===e?"100%":"auto",left:"right"===e?"100%":"auto"}}function Vn(e,t){const n={display:"flex"};return(0,en.zE)(e,t)||(n.display="block"),n}function Un(e,t){Zt.createAndCommit({userAction:"ColumnList.handleResizeDoubleClick",environment:t,perform:t=>{if(e.canEdit()){const n=!e.getFormat().block_full_width;yn.FH({stores:[e],transaction:t,update:{block_full_width:n}})}}})}function Ln(e,t){const n={position:"relative",transition:"padding 0.2s linear"},o=Boolean(e.getFormat().block_full_width);return(o&&t.state.dragging?t.state.temporaryFullWidth:o)&&(n.paddingLeft=sn.width,n.paddingRight=sn.width),n}var jn=n(91948);function Nn(e,t){const n=r.useRef(null),o=(0,S.yK)((()=>({root:{minHeight:"1.5em",display:"flex",alignItems:"center"},wrapper:{...Oe.ZD},progressBar:{flex:1,margin:"0 8px"}})),[]);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"copy_indicator",getNode:()=>n.current,getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(z.p,{allowSelectionWithin:!1,style:o.wrapper,ref:n,children:(0,l.jsxs)("div",{style:o.root,children:[(0,l.jsx)(we.Z,{}),(0,l.jsx)("div",{style:o.progressBar,children:(0,l.jsx)(jn.Z,{targetRecordId:e.store.id})})]})}))}const zn=r.memo(r.forwardRef(Nn),u.Z),qn=(0,s.IU)("deepnote",{viewBox:"0 0 92 92",svg:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("path",{fill:"#fff",d:"M0 0h92v92H0z"}),(0,l.jsx)("path",{fill:"#0265B4",fillRule:"evenodd",d:"M20 73h22.153l12.461-4.673-4.673-18.346-14.365 1.558L20 73z",clipRule:"evenodd"}),(0,l.jsx)("path",{fill:"#002868",fillRule:"evenodd",d:"M42.153 73s7.004-3.695 8.3-10.242c1.296-6.546-5.1-11.22-14.876-11.22 0-.172 8.582-12.114 8.582-12.114l20.84.605-4.622 24.407-8.628 6.74L42.153 73z",clipRule:"evenodd"}),(0,l.jsx)("path",{fill:"#3793EF",fillRule:"evenodd",d:"M20 44.615l17.307-25.614s.424.004 1.385 0c6.784-.03 34.268 1.315 34.268 25.467 0 27.57-30.807 28.53-30.807 28.53s12.865-2.463 12.865-14.687-11.619-13.696-19.095-13.696H20z",clipRule:"evenodd"})]})}),Wn=(0,d.defineMessages)({embedButtonText:{defaultMessage:"Embed Deepnote",id:"deepnoteBlock.embeds.button.label"}});function Hn(e,t){const n=(0,d.useIntl)(),o=(0,r.useRef)(null),i=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"deepnote",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:i,ref:o,store:e.store,iconSvg:qn,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with Deepnote blocks with public links",id:"deepnoteBlock.embeds.caption"}),embedButtonText:n.formatMessage(Wn.embedButtonText),urlInputPlaceholder:"https://deepnote.com/â€¦",children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed Deepnote",id:"deepnoteBlock.placeholder"})}))}const Kn=r.memo(r.forwardRef(Hn),u.Z);var Gn=n(6404),$n=n(27724),Qn=n(61519);function Yn(e,t){let{store:n}=e;const o=(0,y.Fy)(),i=(0,y.O7)(),a=(0,r.useRef)(null),s=(0,S.yK)((e=>({root:{color:e.darkDividerColor,pointerEvents:"auto"}})),[]),c=(0,r.useCallback)((e=>{o.isMobile&&(ge.Ys({environment:i,store:n}),Gn.Qn({environment:i,stores:$n.default.state.stores,left:e.clientX,top:e.clientY,actionSectionGroupKey:"default",showInput:!0,analyticsFrom:"content_block_menu"}))}),[o.isMobile,i,n]);return(0,p.ez)(n,t,(0,r.useMemo)((()=>({renderedType:"divider",getNode:()=>a.current,getBlockStore:()=>n,handleCreated(){Zt.createAndCommit({userAction:"DividerBlock.handleCreated",environment:i,perform:e=>Jt.Bm({environment:i,targetStore:n,targetParentStore:n.getRecordStoreUIParent(),isAtStartOfLine:!1,isClick:!1,transaction:e})})}})),[i,n]),(0,l.jsx)(Qn.Z,{className:P.QSt,size:13,style:s.root,onClick:c,ref:a}))}const Jn=r.memo(r.forwardRef(Yn),u.Z);var Xn=n(4708);function eo(e,t){const n=(0,r.useRef)(null),o=(0,y.Fy)(),i=(0,y.O7)(),a=(0,Xn.A3)()?{source:"https://www.notion.so/product/drawing"}:{};return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"drawing",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store,handleCreated(){he.ZH({device:o}),ge.Z5({environment:i,stores:[e.store],phase:$n.SelectionPhase.Editing})}})),[o,i,e.store]),(0,l.jsx)(f.ZP,{...e,...a,ref:n,mediaMenuTabs:[],disableMediaMenu:!0,preserveScale:!1,showURLInput:!1}))}const to=r.memo(r.forwardRef(eo),u.Z);var no=n(73935),oo=n(53150),io=n(7057);const ro=(0,s.IU)("googleDrive",{viewBox:"0 0 512 512",svg:(0,l.jsxs)("g",{children:[" ",(0,l.jsx)("path",{d:"M175.5,44.9c2.6,0,4.5,0,6.5,0c50.5,0,101,0.1,151.5-0.2c5.5,0,8.5,2,11,6.4c10.7,19,21.5,38,32.3,56.9   c13.2,23.2,26.5,46.4,39.8,69.5c14.8,25.9,29.8,51.6,44.6,77.5c11.9,20.7,23.6,41.6,35.4,62.4c1.5,2.6,5,5.2,3.5,7.8  c-0.8,1.4-5.6,0.6-8.5,0.6c-28.8-0.3-57.6-0.4-86.4-1.2c-19.7-0.6-39.3-0.3-58.9-0.8c-5.6-0.1-11.3-0.6-16.9-0.7   c-2.3,0-3.1-1.2-4-2.9c-9.7-17.9-19.4-35.7-29.2-53.6c-10.4-19.1-20.8-38.2-31.3-57.4c-11.5-21.2-23-42.4-34.5-63.5   c-11.6-21.3-23.3-42.6-34.9-64C188.7,69.7,182.3,57.6,175.5,44.9z"})," ",(0,l.jsx)("path",{d:"M97.1,474c1.6-6.5,5.5-10.8,8.3-15.6c14.5-25.3,29.3-50.3,43.9-75.5c8.6-14.9,17.1-29.8,25.5-44.8   c1.4-2.5,3.1-3.2,5.6-3.2c27.6,0.4,55.3,0.3,82.9,1.3c16.7,0.6,33.3,0.4,49.9,0.8c20.1,0.4,40.3,0.2,60.4,1.2  c13.8,0.6,27.6,0.4,41.4,0.7c29.3,0.5,58.6,0.8,87.9,1.2c1.4,0,3.2-0.7,4,1.1c0.5,1.3-0.4,2.4-1.2,3.6   c-10.4,16.3-20.8,32.7-31.2,49.1c-10.6,16.7-21.1,33.5-31.6,50.2c-5.3,8.4-10.6,16.7-15.6,25.2c-2.3,3.9-4.9,6.2-9.8,5.7   c-5.4-0.6-11-0.7-16.4-0.7c-99.3-0.1-198.6-0.2-297.9-0.3C101.3,474,99.4,474,97.1,474z"})," ",(0,l.jsx)("path",{d:"M9.8,326.3c1.1-5.3,4.5-9.5,7.1-14c14.3-25.7,28.9-51.2,43.3-76.8c9.7-17.1,19.5-34.3,29.2-51.4   c12.9-22.8,25.7-45.7,38.6-68.5c10.7-18.9,21.6-37.8,32.4-56.7c4.7-8.2,5.1-8.4,9.3-0.6c8.3,15.6,16.7,31.1,24.8,46.8  c6.1,11.9,12.6,23.7,18.9,35.5c7.2,13.6,14.5,27.2,21.7,40.7c2.2,4.2,4.3,8.6,6.8,12.7c1.3,2.1,0.9,3.4-0.3,5.4   c-16.2,27.3-32.2,54.7-48.4,81.9c-14,23.6-28.3,47-42.3,70.6c-16.4,27.5-32.6,55.1-49,82.6c-6.6,11.2-13.3,22.4-20,33.6   c-0.6,1.1-0.8,2.8-2.5,2.7c-1.6-0.1-2-1.7-2.6-2.8c-3.7-7.6-7.3-15.2-10.9-22.8c-6.9-14.7-13.9-29.3-20.9-44   c-9-18.8-18-37.5-27-56.3c-2.3-4.8-4.5-9.6-6.8-14.3C10.6,329.2,9.7,328,9.8,326.3z"})," "]})});var ao=n(91584),so=n(993),lo=n(68422),co=n(63085),uo=n(28415);class po extends Sn.default{getInitialState(){return{error:!1,loading:!1}}}const mo=po,fo={display:"block",width:"100%",height:"100%",objectFit:"cover",objectPosition:"top"},go={position:"absolute",top:0,left:0,right:0,bottom:0},ho={display:"block",position:"relative",width:"100%",paddingBottom:"55%"},vo=(0,d.defineMessages)({menuTitle:{defaultMessage:"Embed",id:"googleDriveBlock.mediaMenuActions.embedTab.title"}});class bo extends _n.Z{constructor(){super(...arguments),this.captionAriaId=(0,oo.Z)(),this.storeTypes={mouseStore:rn.Z,driveStore:mo},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseEnter=e=>{return t=this.stores.mouseStore,void(U.Z.state.isDragging||j.default.state.isActive||t.setState({...t.state,mouseEntered:!0}));var t},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave=e=>{return t=this.stores.mouseStore,void(U.Z.state.isDragging||j.default.state.isActive||t.setState({...t.state,mouseEntered:!1}));var t},this.openMenu=()=>{const{device:e}=this.environment;if(this.canEdit()){const t=no.findDOMNode(this);if(t&&t instanceof Element){const n=t.getBoundingClientRect();me.$(this.environment,{originRect:n,originGap:0,isSmallWidth:!1,showArrow:!0,currentTab:e.isMobile?"embed":"drive",tabs:this.mediaPickerTabs(),title:E.default.formatMessage(vo.menuTitle),popupWidth:320,maxHeight:420})}}}}handleCreated(){this.openMenu()}didMount(){super.didMount();const e=this.props.store.getFormat();e&&e.drive_properties&&e.drive_properties.file_id&&e.drive_status&&e.drive_status.last_fetched+5*ce.hM<Date.now()&&ao.WO(this.environment,{id:this.props.store.id,spaceId:(0,Ge.C)(this.props.store.pointer.spaceId)})}renderPersisted(){const e=this.props.store.getProperties(),t=this.props.store.getFormat();return t&&t.drive_properties&&t.drive_status?this.renderBlock(t.drive_properties):e&&e.source?(0,l.jsx)(Po,{...this.props}):this.renderPlaceholder()}renderBlock(e){const t=e.url;return(0,l.jsxs)("div",{role:"figure","aria-labelledby":this.captionAriaId,children:[(0,l.jsxs)("div",{style:{display:"flex"},children:[(0,l.jsxs)(Se.Z,{href:t,external:!0,style:(n=this.theme,{display:"flex",flexDirection:"column",width:"100%",border:`1px solid ${n.darkDividerColor}`,borderRadius:4,position:"relative"}),onMouseLeave:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave,onMouseEnter:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseEnter,children:[(0,l.jsx)(Mo,{store:this.props.store,driveStore:this.stores.driveStore,fileData:e}),(0,l.jsx)(To,{fileData:e}),Ao(this.environment,this.stores.mouseStore)&&this.canEdit()&&(0,l.jsx)(wo,{store:this.props.store})]}),(0,l.jsx)(ye.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]}),(0,l.jsx)(be.Z,{store:this.props.store,captionAriaId:this.captionAriaId,disabled:this.props.disabled})]});var n}renderPlaceholder(){const{disabled:e}=this.props,t=this.props.store.getFormat().drive_status,n=!(!t||!t.authed);return(0,l.jsxs)("div",{onMouseEnter:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseEnter,onMouseLeave:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave,style:{display:"flex"},children:[(0,l.jsx)(Ce.Z,{iconSvg:ro,disabled:e,shouldHideRight:!Ao(this.environment,this.stores.mouseStore),right:this.canEdit()&&(0,l.jsx)(ve.Z,{store:this.props.store,fadeIn:!1}),onClick:this.openMenu,isLoading:this.stores.driveStore.state.loading,progressPercent:0,children:n?(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Choose a file to embed from Google Drive",id:"googleDriveBlock.placeholder.authenticated"}):(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Connect Google Drive to Notion to embed a file",id:"googleDriveBlock.placeholder.notAuthenticated"})}),(0,l.jsx)(ye.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})}async initializeGoogleDriveBlockFromUrl(e){const t=co.id(e);if(!t)return void _o(e,this.props.store,this.environment);const n=await ao.Ui({environment:this.environment,store:this.props.store,fileId:t});n&&n.auth_error&&(ao.cR(this.environment,{onSuccess:e=>{Ro(t,e,this.environment,this.props.store,this.stores.driveStore)},onFailure:()=>{_o(e,this.props.store,this.environment)}}),So("url_embed",this.environment))}mediaPickerTabs(){const{device:e}=this.environment,t=[];return t.push({type:"embed",caption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with any file in your Google Drive",id:"googleDriveBlock.embedTab.caption"}),buttonText:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed Google Drive file",id:"googleDriveBlock.embedTab.embedButton.label"}),onChange:e=>{me.Z(),this.initializeGoogleDriveBlockFromUrl(e)}}),e.isMobile||t.push({type:"drive",title:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Browse Google Drive",id:"googleDriveBlock.mediaPicker.googleDriveTab.title"}),onSelect:async e=>{if(me.Z(),e&&e.token)Do(e.token,this.environment,this.props.store,this.stores.driveStore),de.uu(this.environment);else{const e=await ao.qN(this.environment);e&&e.token&&Do(e.token,this.environment,this.props.store,this.stores.driveStore),So("drive_file_picker",this.environment)}}}),t}}const yo=bo;function _o(e,t,n){Zt.createAndCommit({userAction:"DriveBlock.convertToTextBlock",environment:n,perform:o=>{so.sO({environment:t.environment,editorMode:"default",store:t.getBlockTitleStore(),value:[se.V3y(e,[se.edl(e)])],transaction:o}),lo.Cj({environment:n,blocks:[t],blockType:"text",transaction:o})}})}function So(e,t){de.SO(t,{integration_name:"google",from:e})}function wo(e){let{store:t}=e;const n=(0,y.O7)();return(0,l.jsx)(ve.Z,{store:t,style:{position:"absolute",top:4,right:4,background:(0,f.M1)(n)},iconStyle:{fill:C.ZP.white},fadeIn:!0})}function ko(e){return{...ho,paddingBottom:"20%",minHeight:80,background:e.embedPlaceholderBackground}}function Io(e){return{width:"100%",minHeight:60,padding:14,paddingTop:12,overflow:"hidden",borderTop:`1px solid ${e.darkDividerColor}`}}function Co(e){return{fontSize:12,lineHeight:1.3,color:e.mediumTextColor,maxHeight:32,overflow:"hidden"}}function xo(e){let{fileData:t}=e;const n=(0,S.Fg)(),o=t.user_name||t.modified_time?(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Last modified {hasUserName, select, true {by {userName}} other {}} {hasLastModifiedTime, select, true {{lastModifiedTime}} other {}}",id:"googleDriveBlock.pageDescription",values:{hasUserName:Boolean(t.user_name),userName:t.user_name,hasLastModifiedTime:Boolean(t.modified_time),lastModifiedTime:t.modified_time&&(0,io.tv)(t.modified_time,b.SP)}}):void 0;return(0,l.jsxs)("div",{style:Co(n),children:[t.trashed&&(0,l.jsx)(d.FormattedMessage,{defaultMessage:"This file is in trash.",id:"googleDriveBlock.pageDeleted.caption"}),o]})}function To(e){let{fileData:t}=e;const n=(0,S.Fg)(),o=t.title,i=t.url,r=le.Qc(i).hostname;return(0,l.jsxs)("div",{style:Io(n),children:[o&&(0,l.jsx)(Ie.Z,{style:{marginBottom:2},children:o}),(0,l.jsx)(xo,{fileData:t}),(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:6},children:[t.icon&&(0,l.jsx)("div",{style:(a=t.icon,{flexShrink:0,backgroundImage:`url(${a})`,backgroundSize:"cover",width:16,height:16,marginRight:6})}),(0,l.jsx)(Ie.Z,{style:{color:n.regularTextColor},isSmall:!0,children:r})]})]});var a}function Mo(e){let{fileData:t,store:n,driveStore:o}=e;const i=(0,S.Fg)(),r=(0,a.qz)(o,mo),s=t.thumbnail,c=(0,a.VK)((()=>r.state.error),[r]);return s&&!c?(0,l.jsx)("div",{style:ho,children:(0,l.jsx)("div",{style:go,children:(0,l.jsx)(ke.Z,{url:s,width:1e3,isAuthenticated:!0,permissionRecord:n.pointer,render:(e,n)=>{if(n){const e=le.SK(n,{v:t.version});return(0,l.jsx)("img",{src:e,style:fo,onError:e=>{r.setState({error:!0,loading:!1})}})}e&&r.setState({error:!0,loading:!1})}})})}):(0,l.jsx)("div",{style:ko(i)})}function Po(e){return(0,l.jsx)(f.ZP,{...e,iconSvg:ro,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with Google Docs, Google Sheetsâ€¦",id:"googleDriveBlock.legacyLinkInput.caption"}),children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed a file from Google Drive",id:"googleDriveBlock.legacy.placeholder"})})}function Ao(e,t){const{device:n}=e;return n.isMobile||t.state.mouseEntered}async function Ro(e,t,n,o,i){i.setState({loading:!0,error:!1});const r=await ao.Ui({environment:n,store:o,fileId:e,token:t});i.setState({loading:!1,error:!r||!!r.auth_error})}function Do(e,t,n,o){uo.vE({environment:t,accessToken:e.accessToken,callback:i=>{Ro(i,e,t,n,o)}})}const Eo=(0,s.IU)("tex",{viewBox:"0 0 32 21",svg:(0,l.jsxs)("g",{children:[" ",(0,l.jsxs)("g",{id:"d7fc5246-3c04-467c-8f25-6c129c5642ac","data-name":"tex",children:[" ",(0,l.jsxs)("g",{id:"ec363c67-067d-4da0-8c27-f8d029e068bd","data-name":"E",children:[" ",(0,l.jsx)("path",{id:"e1948427-1829-4c96-a9f4-14a99a3d5b97","data-name":"path0 fill",d:"M497.33,497.82c-1.2,0-2.11-.06-3-0.06a0.5,0.5,0,0,0-.55.27c0,0.15.17,0.23,0.57,0.32a1.08,1.08,0,0,1,1.06,1.23c0,0.55,0,1,0,3.32s-0.08,4.43-.13,5.21c-0.08,1-.42,1.2-1.39,1.41a0.59,0.59,0,0,0-.53.32c0,0.21.23,0.25,0.59,0.25,0.7,0,1.08-.09,2.13-0.09,2.76,0,6,.13,6.21.13a0.7,0.7,0,0,0,.36-0.21,14.63,14.63,0,0,0,.68-2.07c0-.21,0-0.53-0.15-0.53a0.78,0.78,0,0,0-.48.55,2.41,2.41,0,0,1-1.54,1.41,9,9,0,0,1-1.8.15,10.57,10.57,0,0,1-1.69-.13,0.74,0.74,0,0,1-.38-0.44,7,7,0,0,1-.15-1.56c0-.78,0-2.49.06-2.93a0.26,0.26,0,0,1,.17-0.17c0.53,0,1.29,0,1.9,0,1.06,0.06,1.18.13,1.44,1a0.52,0.52,0,0,0,.32.4c0.15,0,.23-0.19.23-0.53s-0.06-.68-0.06-1.2,0-.84.06-1.35c0-.17,0-0.46-0.17-0.46a0.54,0.54,0,0,0-.36.42c-0.34.87-.38,0.93-2.09,0.93h-1.27a0.18,0.18,0,0,1-.17-0.17c0-.44,0-3.84.08-4.29a0.5,0.5,0,0,1,.27-0.55,21.09,21.09,0,0,1,2.7.1,1.4,1.4,0,0,1,1.25,1.31,0.54,0.54,0,0,0,.3.47,0.46,0.46,0,0,0,.3-0.51c0-.38,0-1.08,0-1.84a0.28,0.28,0,0,0-.17-0.23,14.12,14.12,0,0,1-1.75.08h-2.81Z",transform:"translate(-484.44 -490.06)"})," "]})," ",(0,l.jsxs)("g",{id:"8dfbf0a9-85f0-49da-99d8-6229354b9534","data-name":"T",children:[" ",(0,l.jsx)("path",{id:"8602b8e9-f5d6-42d3-88c6-0649b350ce04","data-name":"path1 fill",d:"M490.48,490.82c-2.18,0-3.91-.06-4.39-0.11a1.32,1.32,0,0,1-.68-0.34,0.85,0.85,0,0,0-.3-0.3,0.39,0.39,0,0,0-.28.32,19.85,19.85,0,0,1-.38,2.55,0.4,0.4,0,0,0,.23.42c0.08,0,.19,0,0.38-0.42a5.64,5.64,0,0,1,.61-1,1.72,1.72,0,0,1,1.35-.44c0.32,0,1.94,0,2.3.09a0.26,0.26,0,0,1,.17.25v2.26c0,1.46-.09,5.3-0.13,6.44-0.06,1.41-.11,1.71-1.41,2a0.47,0.47,0,0,0-.38.34c0,0.11.19,0.23,0.57,0.23s1.33-.13,2.22-0.13,2.13,0.1,2.28.1,0.53,0,.53-0.25a0.65,0.65,0,0,0-.49-0.34c-1.22-.25-1.31-0.53-1.39-1.33s-0.1-2.6-.1-4.81c0-1.63,0-3.61,0-4.5a0.35,0.35,0,0,1,.15-0.25c0.29-.06,2.26-0.06,2.6,0,1.12,0.06,1.37.15,1.5,1.16,0.06,0.48.15,0.61,0.28,0.61a0.43,0.43,0,0,0,.32-0.38,11.69,11.69,0,0,1,.42-2.2c0.1-.27,0-0.44-0.09-0.44a0.72,0.72,0,0,0-.28.13,2.49,2.49,0,0,1-1.33.32C494,490.8,491.49,490.82,490.48,490.82Z",transform:"translate(-484.44 -490.06)"})," "]})," ",(0,l.jsxs)("g",{id:"88168da7-a35d-4a6e-af2a-2bab78b9d062","data-name":"X",children:[" ",(0,l.jsx)("path",{id:"f33958e3-fb20-476c-b2a8-674ffe821a96","data-name":"path2 fill",d:"M504,491a0.52,0.52,0,0,0,.51.36,3,3,0,0,1,1.84,1.14,53.54,53.54,0,0,1,3,4.73,0.22,0.22,0,0,1-.06.27c-1.14,1.58-2.22,2.87-3,3.72a4.47,4.47,0,0,1-2.22,1.27c-0.51.1-.7,0.27-0.7,0.44s0.15,0.21.51,0.21,1.2-.1,2-0.1c0.61,0,1.48.06,2,.06,0.25,0,.46-0.08.46-0.27a0.53,0.53,0,0,0-.46-0.32c-0.74-.27-1-0.47-0.17-1.82,0.53-.78,1.44-2,2.05-2.72a0.15,0.15,0,0,1,.19,0c0.23,0.21,2.09,3.17,2.53,4a0.26,0.26,0,0,1-.08.34,3.18,3.18,0,0,1-.68.23c-0.32.11-.42,0.19-0.42,0.34s0.11,0.25.47,0.25,1-.08,1.58-0.08c1.12,0,2.17.11,2.79,0.11,0.42,0,.57-0.09.57-0.25a0.49,0.49,0,0,0-.44-0.36,3.37,3.37,0,0,1-2.34-1.73c-0.49-.67-2.7-4-2.83-4.31a0.45,0.45,0,0,1,0-.23c0.91-1.27,2.17-2.7,2.85-3.52a3.79,3.79,0,0,1,2.38-1.41,0.5,0.5,0,0,0,.44-0.34,0.44,0.44,0,0,0-.46-0.21c-0.44,0-1.56.06-2,.06s-1.12,0-1.69,0c-0.36,0-.53.1-0.53,0.25a0.49,0.49,0,0,0,.48.34c0.67,0.13,1,.34.72,0.89a32.86,32.86,0,0,1-2.53,3.44,0.14,0.14,0,0,1-.19,0,33.44,33.44,0,0,1-2.3-3.63c-0.21-.38,0-0.59.34-0.68s0.46-.21.46-0.36a0.43,0.43,0,0,0-.47-0.21c-0.55,0-.91,0-1.63,0s-2-.1-2.39-0.1S504,490.84,504,491Z",transform:"translate(-484.44 -490.06)"})," "]})," "]})," "]})});var Bo=n(83631),Fo=n(3702),Oo=n(22492),Zo=n(40148);class Vo extends _n.Z{constructor(){super(...arguments),this.storeTypes={mouseStore:rn.Z,focusStore:Sn.default.createClass(!1),buttonPopupStore:mt.Z},this.renderOrigin=()=>{const{device:e}=this.environment,{store:t}=this.props,n=Lo(this.props.store);let o,i={};n?o=(0,l.jsx)(Oo.Z,{display:"block",equation:n,style:this.getContainerStyle(!1),errorStyle:this.getContainerStyle(!0),theme:this.theme}):(o=(0,l.jsx)(Zo.ZP,{iconSvg:Eo,iconStyle:{width:28,height:28,marginRight:8},style:{background:void 0},children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Add a TeX equation",id:"equationBlock.empty.placeholder"})},"button"),i={background:this.theme.sidebarBackground});const r=e.isMobile||this.stores.mouseStore.state.mouseEntered||this.stores.focusStore.state;return(0,l.jsxs)(W.Z,{onMouseMove:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseMove,onMouseLeave:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave,onClick:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleOpen,style:{position:"relative",width:"100%",borderRadius:4,...i},children:[o,this.canEdit()&&(0,l.jsx)(ve.Z,{onFocus:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleFocus,onBlur:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleBlur,store:t,tooltipContent:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Rename, delete, and moreâ€¦",id:"equationBlock.actions.tooltip"}),style:{position:"absolute",top:4,right:4,color:this.theme.mediumTextColor,opacity:r?1:0},fadeIn:!1})]})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleOpen=()=>jo(this.stores.buttonPopupStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleClose=()=>No(this.environment,this.props.store,this.stores.buttonPopupStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseMove=e=>{var t;(t=this.stores.mouseStore).setState({...t.state,mouseEntered:!0})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave=e=>{var t;(t=this.stores.mouseStore).setState({...t.state,mouseEntered:!1})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleFocus=e=>function(e,t){const n=e.target;n instanceof HTMLElement&&(0,ze.E)(n)&&t.setState(!0)}(e,this.stores.focusStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleBlur=()=>{this.stores.focusStore.setState(!1)}}handleCreated(){jo(this.stores.buttonPopupStore)}edit(){jo(this.stores.buttonPopupStore)}activate(){this.stores.buttonPopupStore.state.open?No(this.environment,this.props.store,this.stores.buttonPopupStore):jo(this.stores.buttonPopupStore)}renderPersisted(){const e=Lo(this.props.store),t=this.stores.buttonPopupStore.state.open?{isOpen:!0,equationValue:e,error:Bo.by({environment:this.environment,equation:e,displayMode:"block"})}:{isOpen:!1,equationValue:void 0,error:void 0},n=!this.canEdit(),o=this.renderOrigin();return(0,l.jsxs)(z.p,{allowSelectionWithin:!0,style:{display:"flex",position:"relative"},children:[(0,l.jsx)(F.DependencyConsumer,{dependency:F.deps.prismjs,children:e=>(0,l.jsx)(Fo.Z,{...t,Prism:e,displayMode:"block",disabled:n,origin:o,onDismiss:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleClose,onChange:e=>function(e,t,n){Zt.createAndCommit({userAction:"EquationBlock.handleChange",environment:n,perform:o=>{so.sO({environment:n,editorMode:"default",store:t.getBlockTitleStore(),value:se.TPx(e),transaction:o})}})}(e,this.props.store,this.environment),onSubmit:()=>{return e=this.props.store,t=this.environment,void Mn.Py(t,{equation:Lo(e)});var e,t}})}),(0,l.jsx)(ye.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})}getContainerStyle(e){const t={display:"flex",padding:"4px 8px",width:"100%"};return Lo(this.props.store)?(t.flexDirection="column",t.overflow="auto"):t.color=C.ZP.contentPlaceholder,e&&(t.background=this.theme.equationErrorPlaceholderBackground),{...t,...this.getBlockColorStyle()}}}const Uo=Vo;function Lo(e){const t=e.getBlockTitleStore().getValue();return se.Jcv(t)}function jo(e){e.setState({...e.state,open:!0})}function No(e,t,n){n.setState({...n.state,open:!1}),ge.Ys({environment:e,store:t})}const zo=(0,s.IU)("excalidraw",{viewBox:"0 0 32 32",svg:(0,l.jsxs)("g",{children:[(0,l.jsx)("path",{d:"m14.2933 1.41174c-.8308.66246-2.1108 1.78526-3.1214 2.75088l-.7972.75228.146.98807c.0786.53895.2246 1.59439.3144 2.33544.101.74105.2021 1.43719.2358 1.53825.0449.13473 0 .2021-.1235.2021-.2134 0-.2246-.05614.3593 1.79654.2133.7073.4154 1.3586.4379 1.4259.0224.0786.1122.1123.2133.0786.1011-.0449.1572-.1347.1235-.2133-.0337-.0898.0225-.1797.1123-.2133.1235-.045.1123-.1348-.0786-.4604-.3032-.5053-1.0779-4.81685-1.1228-6.20913-.0337-.98807-.0337-.9993.3817-1.5607.4043-.55018 1.3362-1.38105 2.7734-2.43649.4042-.30316.8084-.64.9207-.75228.1684-.20211.247-.14597 1.6617 1.35859.8197.86456 1.7292 1.75158 2.0211 1.97614l.5389.40422-.4154.87579c-.2246.47157-1.134 2.29052-2.0323 4.01966-1.8751 3.6379-1.4933 3.2898-3.6716 3.3235l-1.4147.0112-.4716.539c-.494.5726-.5614.7859-.3256 1.1452.0898.1235.1572.3257.1572.4492 0 .2021.0786.2358.5277.2582.2807.0112.539.0449.5726.0786.0337.0337.0786.7298.1123 1.5495l.0449 1.4821-.7522 1.6168c-1.2464 2.6948-1.74039 3.9299-1.74039 4.3341 0 .2133.04491.3929.08982.3929.11227 0 .11227-.0112 4.68207-9.5438 2.1221-4.4239 4.132-8.5895 4.4688-9.27441.3369-.68491.64-1.31369.6625-1.40351.0224-.10105-.7523-.87579-1.9874-1.96491-1.1116-.98807-2.0884-1.88632-2.1782-1.98737-.2583-.314389-.64-.213336-1.325.33684zm.3818 12.91226c-.5165.9993-.539 1.0106-1.9537 1.0779-1.2463.0674-1.2688.0562-1.2688-.1796 0-.1348-.0449-.3144-.101-.4042-.0674-.1011-.0225-.2807.1347-.5278l.247-.3817h1.1228c.6176-.0112 1.325-.0562 1.572-.1011s.4603-.0673.4828-.0561c.0224.0112-.0898.2695-.2358.5726zm-.9432 1.7965c-.0898.2358-.3256.7298-.5165 1.1004-.3143.6287-.348.6512-.4266.393-.0449-.1572-.0786-.6176-.0898-1.033-.0113-.8197-.0337-.8084.9094-.8646l.3032-.0112z"}),(0,l.jsx)("path",{d:"m14.6302 4.08401c-.2021.14597-.2583.29193-.2583.66246 0 .43789.0337.50526.3369.62877s.3817.11228.7298-.12351c.4604-.31439.4716-.39298.1348-.89824-.292-.4379-.5839-.51649-.9432-.26948zm.64.40421c.1796.31439.0674.55018-.2695.55018-.3031 0-.4379-.30316-.2695-.60632.1348-.24701.393-.22456.539.05614z"}),(0,l.jsx)("path",{d:"m21.6702 6.61034c0 .05614-.0674.11228-.146.11228-.0674 0-.2582.31439-.4042.69614-.4491 1.16772-4.9404 10.04914-4.9516 9.76844 0-.146-.0673-.247-.1796-.247-.1572 0-.1797.0898-.1123.5277.0674.5053.0224.6175-1.5719 3.7165-.8983 1.7628-1.8639 3.6042-2.1446 4.0982-.2919.5165-.5165 1.0779-.5389 1.3137-.0337.4042.0112.4604.988 1.3025.5614.494 1.28 1.1115 1.5944 1.3922 1.4147 1.2913 2.0772 1.8078 2.2569 1.7741.2694-.0449 4.435-4.4127 4.4463-4.6597 0-.1122-.2021-1.8189-.4492-3.7951-.4266-3.3684-.8308-7.3094-.7859-7.6912.0337-.2358-.1348-1.4259-.2583-1.9424-.101-.4043-.0561-.5727.7523-2.4141.4716-1.0891 1.0891-2.42524 1.3586-2.96419.2583-.53894.4828-1.01052.4828-1.04421 0-.03368-.0786-.05614-.1684-.05614s-.1684.04492-.1684.11228zm-2.5825 8.38736c.1235.786.3705 2.6723.5502 4.1881.3481 2.7845.7523 5.8723.8646 6.6582.0673.393.0224.4716-.7074 1.28-1.2688 1.426-2.6162 2.8295-3.0765 3.1888l-.4267.3368-2.1894-2.0435c-2.0211-1.8638-2.1895-2.0547-2.066-2.2793.0674-.1235.64-1.1677 1.2688-2.3129.6287-1.1453 1.4596-2.6723 1.8414-3.3909.3929-.7299.7522-1.3586.8196-1.3923.0786-.0449.1011 1.0891.0786 3.5032-.0449 3.6042-.0337 3.6154.3256 3.5368.0449 0 .0786-1.819.0786-4.0309v-4.0196l1.179-2.3579c.6512-1.3025 1.1901-2.3467 1.2126-2.3355.0225.0113.1347.6737.247 1.4709z"})]})}),qo=(0,d.defineMessages)({embedButtonText:{defaultMessage:"Embed Excalidraw",id:"excalidrawBlock.embeds.button.label"}});function Wo(e,t){const n=(0,d.useIntl)(),o=(0,r.useRef)(null),i=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"excalidraw",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:i,ref:o,store:e.store,iconSvg:zo,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with Excalidraw whiteboards.",id:"excalidrawBlock.embeds.caption"}),embedButtonText:n.formatMessage(qo.embedButtonText),urlInputPlaceholder:"https://excalidraw.com/â€¦",children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed Excalidraw",id:"excalidrawBlock.placeholder"})}))}const Ho=r.memo(r.forwardRef(Wo),u.Z);var Ko=n(14562),Go=n(13797),$o=n(47453),Qo=n(81193),Yo=n(95802),Jo=n(26664),Xo=n(54532),ei=n(42858);var ti=n(52315);class ni extends Sn.default{getInitialState(){return{open:!1}}}const oi=ni;var ii=n(6258),ri=n(81023),ai=n(58297),si=n(23189),li=n(13490);const ci=function(e){let{store:t,origin:n,title:o,properties:i}=e;const s=(0,S.Fg)(),c=(0,a.qz)(t,oi),u=(0,r.useCallback)((()=>{c.setState({...c.state,open:!1})}),[c]);return(0,a.VK)((()=>c.state.open),[c])?(0,l.jsxs)("div",{style:{flexGrow:1,minWidth:0},children:[n,(0,l.jsxs)("div",{style:{position:"relative",boxShadow:`inset 0 0 0 1px ${s.regularDividerColor}`,padding:12,borderRadius:4,overflow:"hidden"},children:[(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(si.Z,{style:{flex:1,marginRight:16,marginBottom:0},children:o}),(0,l.jsx)(ai.Z,{onClick:u,children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Close",id:"factoryBlock.configureMenu.closeButton.label"})})]}),i.map(((e,t)=>(0,l.jsx)(di,{args:e},t)))]})]}):n};function di(e){let{args:t}=e;const{title:n,subtitle:o,value:i}=t,r=(0,S.Fg)();return(0,l.jsxs)("div",{children:[(0,l.jsx)(Qn.Z,{size:36}),(0,l.jsx)(li.Z,{children:n}),(0,l.jsx)(Ie.Z,{isSmall:!0,children:o}),(0,l.jsx)("div",{style:{marginTop:8,padding:6,background:r.sidebarBackground,borderRadius:4},children:i})]})}var ui=n(15201),pi=n(73063),mi=n(89728),fi=n(26388);const gi={pointerEvents:"none",...x.Z.textOverflowStyle},hi=(0,d.defineMessages)({addNewItem:{defaultMessage:"Add a new item",id:"factoryBlock.newItem.button.label"},buttonPlaceholder:{defaultMessage:"Add a new item",id:"factoryBlock.newItem.button.placeholder"}});class vi extends _n.Z{constructor(){super(...arguments),this.storeTypes={configurableStore:oi,mouseStore:rn.Z},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseMove=()=>{var e;(e=this.stores.mouseStore).setState({...e.state,mouseEntered:!0})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave=()=>{var e;(e=this.stores.mouseStore).setState({...e.state,mouseEntered:!1})},this.handleButtonClick=()=>{this.canEdit()&&ri.M_(this.environment)&&Zt.createAndCommit({userAction:"FactoryBlock.handleButtonClick",environment:this.environment,perform:e=>{!function(e){const{store:t,transaction:n,environment:o}=e,i=t.getRecordStoreUIParent();let r=!1;i&&i.valueIs(Jo.i)&&Yt.YM(i.getValue())!==t.id&&Yt.Z$(i.getValue())===t.id&&(r=!0);const a=t.getContentStores().filter((e=>e.isDefined()));r||a.reverse();const s=Yo.C.findSelectableFromStore(t),l=[],c=Promise.all(a.map((e=>new Promise((i=>{const a=e.getModel(),c=!a||!a.isTemplateVariableContainerBlock(),[d,u]=Xo.Qi({environment:o,stores:[e],transaction:n,addCopyName:!1,deepCopyTransclusionContainers:!1,resolveTemplateVariables:c,targetSpaceId:(0,Ge.C)(e.pointer.spaceId),baseUrl:gt.default.domainBaseUrl,publicDomainName:gt.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:t.useCrdt()}),p=d[0];u.then((e=>{e&&pe.showErrorMessage(e),i()})),s&&(r?s.props.onInsertAbove&&s.props.canInsertAbove&&l.push(s.props.onInsertAbove({insertStores:[p],transaction:n})[0]):s.props.onInsertBelow&&s.props.canInsertBelow&&l.push(s.props.onInsertBelow({insertStores:[p],transaction:n})[0]))})))));r||l.reverse(),ge.Z5({environment:o,stores:l}),c.then((()=>{Qt.default.afterNextFlush((()=>{ei.DV({environment:o,insertedStores:l,isCreated:!0})}))}))}({environment:this.environment,store:this.props.store,transaction:e})}})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleToggleConfigure=()=>yi(this.environment,this.stores.configurableStore)}UNSAFE_willMountOrUpdate(e){super.UNSAFE_willMountOrUpdate(e),ti.b(e.store)}handleCreated(){this.configure()}activate(){this.handleButtonClick()}configure(){this.stores.configurableStore.setState({...this.stores.configurableStore.state,open:!0})}renderPersisted(){const e=this.getDisabled();return(0,l.jsxs)(z.p,{allowSelectionWithin:!0,style:{display:"flex"},children:[(0,l.jsx)(ci,{title:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Configure template button",id:"factoryBlock.configureButton.label"}),origin:this.renderFactory(),store:this.stores.configurableStore,properties:[{title:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Button name",id:"factoryBlock.buttonName.title"}),subtitle:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"What should this button be called?",id:"factoryBlock.buttonName.subtitle"}),value:(0,l.jsx)($.Z,{disabled:e,store:(t=this.props.store,ii.G.createChildStore(t,t.pointer).getBlockTitleStore()),placeholder:E.default.formatMessage(hi.addNewItem),onEnter:Yt.yR,pasteBehavior:"inline",inPageFind:{type:"none"}})},{title:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Template",id:"factoryBlock.templateArea.title"}),subtitle:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Drop blocks here that you want to duplicate whenever the button is clicked.",id:"factoryBlock.templateArea.subtitle."}),value:(0,l.jsx)(ui.O,{displayName:"FactoryBlockContent",disabled:e,children:(0,l.jsx)(G.Z,{disabled:e,store:this.props.store.getContentStore(),emptyPlaceholder:(0,l.jsx)("div",{style:{caretColor:this.theme.regularTextColor,color:this.theme.regularTextColor},children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Empty. Drop blocks hereâ€¦",id:"factoryBlock.emptyTemplate.placeholder"})}),disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,disableDrag:this.props.disableDrag})})}]}),(0,l.jsx)(ye.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]});var t}renderFactory(){const{device:e}=this.environment,t=this.getDisabled();return(0,l.jsxs)(mi.Z,{icon:$o.R,isGray:!0,isLarge:!0,style:{fontSize:"inherit",width:"100%"},shouldShrink:!0,onClick:this.handleButtonClick,onMouseMove:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseMove,onMouseLeave:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave,disabled:t,children:[(0,l.jsx)($.Z,{disabled:!0,store:this.props.store.getBlockTitleStore(),placeholder:E.default.formatMessage(hi.buttonPlaceholder),style:gi,placeholderStyle:(n=this.theme,{width:"100%",display:"block",caretColor:n.regularTextColor,color:n.regularTextColor,...x.Z.textOverflowStyle}),inPageFind:{type:"none"}}),!t&&(e.isMobile||this.stores.mouseStore.state.mouseEntered)&&(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center"},className:P.JiD,children:[!e.isMobile&&(0,l.jsx)(_i,{configurableStore:this.stores.configurableStore}),(0,l.jsx)(ve.Z,{tooltipContent:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"More actionsâ€¦",id:"factoryBlock.moreActions.button.label"}),store:this.props.store,fadeIn:!0})]})]});var n}getDisabled(){return this.props.disabled||!this.canEdit()}}const bi=vi;function yi(e,t){t.state.open?t.setState({...t.state,open:!1}):(Qo.PE(e,{from:"gear_button"}),t.setState({...t.state,open:!0}))}function _i(e){let{configurableStore:t}=e;const n=(0,y.O7)(),o=(0,r.useCallback)((()=>yi(n,t)),[n,t]);return(0,l.jsx)(fi.ZP,{renderTooltip:()=>(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Configure template",id:"factoryBlock.configureTemplate.button.label"}),delayThreshold:300,render:e=>(0,l.jsx)(pi.Z,{icon:Go.F,onClick:o,...e})})}const Si=(0,s.IU)("figma",{viewBox:"0 0 36 55",svg:(0,l.jsx)("path",{d:"M19.5,27.5 C19.5,23.08142 23.08142,19.5 27.5,19.5 C31.9186,19.5 35.5,23.08142 35.5,27.5 C35.5,31.9186 31.9186,35.5 27.5,35.5 C23.08142,35.5 19.5,31.9186 19.5,27.5 Z M0.5,46.5 C0.5,42.08142 4.08142,38.5 8.5,38.5 L16.5,38.5 L16.5,46.5 C16.5,50.9186 12.9186,54.5 8.5,54.5 C4.08142,54.5 0.5,50.9186 0.5,46.5 Z M19.5,16.5 L19.5,0.5 L27.5,0.5 C31.9186,0.5 35.5,4.08142 35.5,8.5 C35.5,12.9186 31.9186,16.5 27.5,16.5 L19.5,16.5 Z M8.5,16.5 C4.08142,16.5 0.5,12.9186 0.5,8.5 C0.5,4.08142 4.08142,0.5 8.5,0.5 L16.5,0.5 L16.5,16.5 L8.5,16.5 Z M8.5,35.5 C4.08142,35.5 0.5,31.9186 0.5,27.5 C0.5,23.08142 4.08142,19.5 8.5,19.5 L16.5,19.5 L16.5,35.5 L8.5,35.5 Z"})});function wi(e,t){const n=(0,r.useRef)(null),o=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"figma",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,ref:n,blockResizerStore:o,store:e.store,iconSvg:Si,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with any public Figma shareable link",id:"figmaBlock.caption"}),children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed Figma",id:"figmaBlock.placeholder"})}))}const ki=r.memo(r.forwardRef(wi),u.Z);var Ii=n(69721);const Ci=(0,s.IU)("framer",{viewBox:"0 0 32 32",svg:(0,l.jsx)("g",{children:(0,l.jsx)("path",{d:"m9 6h14v7h-7zm0 7h7l7 7h-14zm0 7h7v7z"})})}),xi=(0,d.defineMessages)({embedButtonText:{defaultMessage:"Embed Framer",id:"framerBlock.embedFramer.button.label"}});function Ti(e,t){const n=(0,d.useIntl)(),o=(0,r.useRef)(null),i=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"framer",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:i,ref:o,store:e.store,iconSvg:Ci,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with Framer prototypes",id:"framerBlock.linkInput.caption"}),embedButtonText:n.formatMessage(xi.embedButtonText),urlInputPlaceholder:"https://framer.com/â€¦",children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed a Framer prototype",id:"framerBlock.placeholder"})}))}const Mi=r.memo(r.forwardRef(Ti),u.Z);var Pi=n(69578);const Ai=(0,d.defineMessages)({embedButtonText:{defaultMessage:"Embed Gist",id:"gistBlock.embedButton.label"}});function Ri(e,t){const n=(0,d.useIntl)(),o=(0,r.useRef)(null),i=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"gist",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:i,ref:o,store:e.store,iconSvg:Pi.f,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with links to Gists on GitHub",id:"gistBlock.linkInput.caption"}),embedButtonText:n.formatMessage(Ai.embedButtonText),urlInputPlaceholder:"https://gist.github.com/â€¦",children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed a Gist",id:"gistBlock.placeholder"})}))}const Di=r.memo(r.forwardRef(Ri),u.Z);var Ei=n(65453);const Bi=(0,s.IU)("hex",{viewBox:"0 0 92 92",svg:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("path",{fill:"#fff",d:"M0 0h92v92H0z"}),(0,l.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M25.8 34v8.368h-2.4V34H15v24h8.4V46h2.4v12h8.4V34h-8.4Zm10.7995 24h19.2v-9.6h-8.4v6h-2.4V46h10.8V34h-19.2v24Zm8.4-15.6v-4.8h2.4v4.8h-2.4Zm24.0007 0V34h8.4v6l-3.6 4.2 3.6 4.2V58h-8.4V45.968h-2.4V58h-8.4v-9.6l3.6-4.2-3.6-4.2v-6h8.4v8.4h2.4Z",fill:"#473982"})]})}),Fi=(0,d.defineMessages)({embedButtonText:{defaultMessage:"Embed Hex",id:"hexBlock.embeds.button.label"}});function Oi(e,t){const n=(0,d.useIntl)(),o=(0,r.useRef)(null),i=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"hex",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:i,ref:o,store:e.store,iconSvg:Bi,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with Hex cell links with public access.",id:"hexBlock.embeds.caption"}),embedButtonText:n.formatMessage(Fi.embedButtonText),urlInputPlaceholder:"https://hex.tech/â€¦",children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed Hex",id:"hexBlock.placeholder"})}))}const Zi=r.memo(r.forwardRef(Oi),u.Z),Vi=(0,s.IU)("picture",{viewBox:"0 0 30 30",svg:(0,l.jsx)("path",{d:"M1,4v22h28V4H1z M27,24H3V6h24V24z M18,10l-5,6l-2-2l-6,8h20L18,10z M11.216,17.045l1.918,1.918l4.576-5.491L21.518,20H9 L11.216,17.045z M7,12c1.104,0,2-0.896,2-2S8.104,8,7,8s-2,0.896-2,2S5.896,12,7,12z"})}),Ui=(0,d.defineMessages)({urlPlaceholder:{defaultMessage:"Paste the image linkâ€¦",id:"imageBlock.linkInput.placeholder"},embedButtonText:{defaultMessage:"Embed image",id:"imageBlock.embedImage.button.label"}});function Li(e,t){const n=(0,d.useIntl)(),o=(0,r.useRef)(null),i=(0,a.qz)(e.blockResizerStore,m.Z),s=(0,a.VK)((()=>{const e=[{type:"file",imageUpload:!0},{type:"embed"},{type:"unsplash"}];return ht.default.checkGate("enable_giphy_feature_gate")&&e.push({type:"giphy"}),e}),[]);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"image",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:i,ref:o,store:e.store,urlInputPlaceholder:n.formatMessage(Ui.urlPlaceholder),iconSvg:Vi,preserveScale:!0,mediaMenuCurrentTab:"file",mediaMenuTabs:s,mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with any image from the web",id:"imageBlock.linkInput.caption"}),embedButtonText:n.formatMessage(Ui.embedButtonText),popupWidth:540,maxHeight:420,children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Add an image",id:"imageBlock.placeholder"})}))}const ji=r.memo(r.forwardRef(Li),u.Z),Ni=(0,s.IU)("invision",{viewBox:"0 0 215 182",svg:(0,l.jsxs)("g",{stroke:"none",strokeWidth:"1",children:[" ",(0,l.jsxs)("g",{transform:"translate(0.000000, -222.000000)",children:[" ",(0,l.jsxs)("g",{children:[" ",(0,l.jsx)("path",{d:"M98.9196618,401.249534 L67.23738,401.249534 C69.0283748,394.069758 70.787323,387.019973 72.4415558,380.387695 C68.8636285,384.425558 65.4170469,389.032134 61.2582199,392.866884 C50.6503674,402.647395 38.1012175,405.941417 24.0797327,402.23079 C13.9819165,399.55829 7.92421985,391.917675 6.61663119,381.562133 C5.46837247,372.464529 7.41824578,363.782628 9.57890401,355.080416 C13.7219334,338.391847 17.8017725,321.687933 21.9028255,304.989434 C22.0454551,304.409889 22.1339216,303.817254 22.2995706,302.96283 L-0.0003,302.96283 C2.30975824,294.403698 4.53721769,286.151943 6.78995327,277.806756 L60.5229552,277.806756 C60.3491817,278.642223 60.2273147,279.357627 60.0512844,280.059943 C53.0231647,308.023022 45.9535198,335.97572 39.0057421,363.95911 C38.1427426,367.435481 37.6331576,371.059899 37.479244,374.638277 C37.2535643,379.877659 40.2013936,382.783512 45.4935844,382.824134 C53.5440336,382.885068 60.4588621,379.769784 66.3955944,374.554776 C72.743064,368.979131 77.1564578,362.201967 79.1663619,353.808936 C83.0828089,337.452117 87.2971531,321.167064 91.379249,304.850416 C91.5232327,304.276286 91.5715282,303.678686 91.6933952,302.909569 L69.2513464,302.909569 C69.6155936,301.479211 69.9089773,300.269116 70.2316994,299.067145 C71.9843286,292.540938 73.758623,286.020597 75.4882328,279.488522 C75.7789084,278.389461 76.0555918,277.645621 77.5008451,277.651037 C92.8448135,277.709714 108.18833,277.692562 123.531847,277.702492 C123.75166,277.702492 123.97102,277.781931 124.411096,277.867238 C122.458966,286.803255 120.511801,295.717606 118.565087,304.631958 C118.656261,304.671226 118.747887,304.710043 118.838611,304.749311 C120.277996,302.605804 121.639297,300.404524 123.17076,298.328721 C129.752485,289.408051 137.659853,281.997178 148.043831,277.728671 C168.022811,269.515732 188.005402,280.685076 192.142563,302.283534 C193.975534,311.851454 193.064691,321.305631 190.553778,330.628914 C187.175803,343.16994 183.622249,355.664024 180.318748,368.224458 C179.661569,370.722733 179.467484,373.448493 179.624106,376.035235 C179.988804,382.073072 185.463796,384.737899 190.442292,381.268749 C192.360119,379.932273 194.120421,378.060937 195.308399,376.052387 C197.438816,372.450086 199.08989,368.563429 200.922861,364.787355 C201.278532,364.054347 201.552056,363.281168 201.937066,362.346854 C206.06836,363.936993 210.106223,365.491476 214.381049,367.137584 C210.178891,380.337594 205.268551,393.058261 192.248181,399.864312 C181.021966,405.732889 169.389528,405.395272 158.535233,398.5987 C151.013326,393.889214 148.484358,386.186312 148.027131,377.697592 C147.620005,370.133709 149.656088,362.968376 151.693976,355.800786 C154.30148,346.629159 157.031754,337.485517 159.315182,328.232646 C160.272516,324.353211 160.657977,320.20973 160.534756,316.210233 C160.26394,307.425422 153.949871,301.479211 145.147908,301.094201 C135.701404,300.681207 128.636273,304.704626 123.601357,312.562796 C119.514296,318.940958 117.721496,326.162711 115.917863,333.384916 C110.367494,355.603993 104.804488,377.819911 99.2455434,400.036731 C99.157077,400.390597 99.0564238,400.741303 98.9196618,401.249534 Z M28.7006165,241.023028 C28.6658618,230.356047 37.1446512,221.982425 47.9637399,222.000028 C58.6717942,222.017631 67.1365914,230.335285 67.169992,240.873176 C67.2033927,251.467488 58.5991253,259.984192 47.8874602,259.958916 C37.2349231,259.934091 28.7349198,251.545573 28.7006165,241.023028 Z"})," "]})," "]})," "]})}),zi=(0,d.defineMessages)({embedButtonText:{defaultMessage:"Embed Invision",id:"invisionBlock.embeds.button.label"}});function qi(e,t){const n=(0,d.useIntl)(),o=(0,r.useRef)(null),i=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"invision",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:i,ref:o,store:e.store,iconSvg:Ni,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with Invision projects",id:"invisionBlock.embeds.caption"}),embedButtonText:n.formatMessage(zi.embedButtonText),urlInputPlaceholder:"https://invis.io/â€¦",children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed an Invision project",id:"invisionBlock.placeholder"})}))}const Wi=r.memo(r.forwardRef(qi),u.Z);var Hi=n(23586),Ki=n(68056),Gi=n(75822),$i=n(80444);class Qi extends Sn.default{getInitialState(){return{query:""}}}const Yi=Qi;var Ji=n(24666),Xi=n(3386),er=n(6287),tr=n(72711),nr=n(69454),or=n(32163),ir=n(43765),rr=n(11470),ar=n(75987),sr=n(36488),lr=n(74194),cr=n(53437);class dr extends vn.Z{constructor(){super(...arguments),this.storeTypes={store:Yi},this.handleQueryUpdateDebounced=void 0,this.handleInputChange=e=>{const t=e.target.value;this.stores.store.setState({...this.stores.store.state,query:t}),this.handleQueryUpdateDebounced(t)},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleQueryUpdate=e=>function(e,t,n){n&&n({query:e,autocompleteStore:t})}(e,this.stores.store,this.props.onQueryUpdate)}get registries(){return[ar.Z]}UNSAFE_willMount(e){super.UNSAFE_willMount(e),this.handleQueryUpdateDebounced=Yt.Ds(this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleQueryUpdate,this.props.queryUpdateDebounce)}renderComponent(){const{device:e}=this.environment;return(0,l.jsx)(cr.ZP,{popupType:e.isPhone?cr.ZP.PopupType.SlideUp:cr.ZP.PopupType.Popup,open:this.props.isOpen,origin:this.renderInput(),placementToOrigin:cr.ZP.Placement.Bottom,alignmentToOrigin:cr.ZP.Alignment.Start,originGap:4,disableDarkOverlayBackground:e.isPhone,onDismiss:this.props.onBgClick,render:this.props.renderPopup,preventCaptureEsc:this.props.preventCaptureEsc,disableMouseCapture:this.props.disableMouseCapture,style:this.props.popupStyle})}renderInput(){const e=this.props.isOpen;return(0,l.jsx)(sr.Z,{capture:e,allowMenuList:!0,render:e=>(0,l.jsx)(z.p,{allowSelectionWithin:!0,...e,children:(0,l.jsx)(lr.Z,{style:this.props.inputStyle,format:void 0!==this.props.format?this.props.format:lr.B.Transparent,value:this.stores.store.state.query,onClick:this.props.onInputClick,onFocus:this.props.onInputFocus,onBlur:this.props.onInputBlur,onChange:this.handleInputChange,placeholder:this.props.inputPlaceholder,focus:this.props.focus})})})}}dr.displayName="InlineAutocomplete";const ur=dr;const pr=(0,d.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a databaseâ€¦",id:"linkToCollectionBlock.input.placeholder"}});function mr(e){const t=(0,d.useIntl)(),n=(0,y.O7)(),o=(0,y.Fy)(),i=(0,r.useRef)(!1),a=(0,r.useCallback)((()=>{const t=(e.results||[]).map((t=>{const o=ii.NW.createChildStore(e.store,{table:er.vF,id:t});return{key:t,render:e=>(0,l.jsx)(rr.Z,{...e,store:o}),action:()=>{i.current||(i.current=!0,Zt.createAndCommit({userAction:"LinkToCollectionBlock.menuListItem",environment:n,perform:t=>{const i=tr.Y_({environment:n,store:e.store,collectionStore:o,collectionViewStore:void 0,transaction:t});i&&ge.Z5({environment:n,stores:[i]})}}))}}}));let r,a;return r=e.results&&0===t.length?(0,l.jsx)(rt.Z,{title:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Select a database",id:"linkToCollectionBlock.menuItem.noResults.title"}),loading:!e.ready,children:(0,l.jsx)(ir.Z,{title:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"No results",id:"linkToCollectionBlock.menuItem.noResults.label"})})}):(0,l.jsx)(or.Z,{type:or.i.Vertical,initialFocus:0,sections:[{key:0,render:t=>(0,l.jsx)(rt.Z,{...t,title:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Select a database",id:"linkToCollectionBlock.menuItem.showResults.title"}),loading:!e.ready}),items:t}]}),a=o.isPhone?{menuType:pt.og.ActionSheet,disableBottomPadding:!0,maxHeight:`calc(70vh - ${nr.Z.estimatedNativeWebBottomOverlap()}px)`}:{menuType:pt.og.Popup,width:460,maxHeight:o.isPhone?"30vh":"40vh"},(0,l.jsx)(Et.Z,{...a,children:r})}),[o.isPhone,n,e.ready,e.results,e.store]),s=(0,r.useCallback)((()=>{he.ZH(n),i.current||(i.current=!0,Zt.createAndCommit({userAction:"LinkToCollectionBlock.handleBlur",environment:n,perform:t=>{ei.Od({store:e.store,transaction:t})}}))}),[n,e.store]);return(0,l.jsx)(ur,{loading:!e.ready,isOpen:!0,store:e.autocompleteStore,queryUpdateDebounce:Gi.vp,inputPlaceholder:t.formatMessage(pr.inputPlaceholder),focus:!0,inputStyle:{...fr(),borderBottom:void 0},onBgClick:s,renderPopup:a})}function fr(){return{lineHeight:1.3}}function gr(e,t){const n=(0,y.O7)(),o=(0,r.useRef)(null),i=(0,a.qz)(void 0,Yi),{query:s}=(0,a.VK)((()=>i.state),[i]),c=(0,a.VK)((()=>{const t=Ji.default.state;return Boolean("editing"===t.mode&&(0,Ki.qS)(t.multiSelection)&&t.multiSelection.start.store.id===e.store.id)}),[e.store.id]);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"link_to_collection",getNode:()=>o.current,getBlockStore:()=>e.store,handleCreated(){ge.$Y({environment:n,phase:$n.SelectionPhase.Editing}),he.Z5({store:e.store,selection:void 0})}})),[n,e.store]),c?(0,l.jsx)(Hi.Z,{request:s,performRequest:t=>async function(e,t,n){if(t.isDefaultRecordCache()){const t=await F.deps.searchActions.loader(),{currentSpaceStore:o}=$i.default.state;return(await t.searchCollections(n,{query:e,limit:20,source:"link_to_collection_block",spaceStore:o,searchSessionId:void 0})).results}return[]}(t,e.store,n),debounce:Gi.vp,render:(t,n,o)=>(0,l.jsx)(Xi.Z,{debugName:"LinkToCollectionBlock",capture:c,children:(0,l.jsx)(mr,{store:e.store,results:n,ready:o,autocompleteStore:i})})}):null)}const hr=r.memo(r.forwardRef(gr),u.Z);var vr=n(72141),br=n(21202),yr=n(61045),_r=n(28020),Sr=n(46654);const wr=(0,d.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a pageâ€¦",id:"linkToPageBlock.searchPlaceholder"}});function kr(e){const t=(0,d.useIntl)(),n=(0,y.O7)(),o=(0,y.Fy)(),i=(0,a.VK)((()=>nr.Z.estimatedNativeWebBottomOverlap()),[]),s=(0,r.useRef)(!1),c=(0,r.useCallback)((()=>{const t=(e.results||[]).map((t=>{const o=ii.G.createChildStore(e.store,{table:br.iU,id:t});return{key:t,render:e=>(0,l.jsx)(rr.Z,{...e,store:o}),action:()=>{s.current||(s.current=!0,Zt.createAndCommit({userAction:"LinkToPageBlock.menuListItem",environment:n,perform:t=>{const i=tr.hc({environment:n,store:e.store,targetStore:o,transaction:t});i&&ge.Z5({environment:n,stores:[i]})}}))}}}));let r,a;return r=e.results&&0===t.length?(0,l.jsx)(rt.Z,{title:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Select a page",id:"linkToPageBlock.selectPrompt"}),loading:!e.ready,children:(0,l.jsx)(ir.Z,{title:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"No results",id:"linkToPageBlock.noSearchResults"})})}):(0,l.jsx)(or.Z,{type:or.i.Vertical,initialFocus:0,sections:[{key:0,render:t=>(0,l.jsx)(rt.Z,{...t,title:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Select a page",id:"linkToPageBlock.selectPrompt.withContents"}),loading:!e.ready}),items:t}]}),a=o.isPhone?{menuType:pt.og.ActionSheet,disableBottomPadding:!0,maxHeight:`calc(70vh - ${i}px)`}:{menuType:pt.og.Popup,width:460,maxHeight:o.isMobile?"30vh":"40vh"},(0,l.jsx)(Et.Z,{...a,children:r})}),[o.isMobile,o.isPhone,n,i,e.ready,e.results,e.store]),u=(0,r.useCallback)((()=>{he.ZH(n),s.current||(s.current=!0,Zt.createAndCommit({userAction:"LinkToPageBlock.handleBlur",environment:n,perform:t=>{ei.Od({store:e.store,transaction:t})}}))}),[n,e.store]);return(0,l.jsx)(ur,{loading:!e.ready,isOpen:!0,store:e.autocompleteStore,queryUpdateDebounce:Gi.vp,inputPlaceholder:t.formatMessage(wr.inputPlaceholder),focus:!0,inputStyle:{...Ir(),borderBottom:void 0},onBgClick:u,renderPopup:c})}function Ir(){return{lineHeight:1.3}}function Cr(e,t){const n=(0,y.Fy)(),o=(0,y.O7)(),i=(0,r.useRef)(null),s=(0,a.qz)(void 0,Yi),{query:c}=(0,a.VK)((()=>s.state),[s]),d=(0,a.VK)((()=>{const t=Ji.default.state;return Boolean("editing"===t.mode&&(0,Ki.qS)(t.multiSelection)&&t.multiSelection.start.store.id===e.store.id)}),[e.store]);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"link_to_page",getNode:()=>i.current,getBlockStore:()=>e.store,handleCreated(){ge.$Y({environment:o,phase:$n.SelectionPhase.Editing}),he.Z5({store:e.store,selection:void 0}),n.isMobile&&nr.Z.onShow((()=>yr.hQ(o)))}})),[n.isMobile,o,e.store]),d?(0,l.jsx)(Hi.Z,{request:c,performRequest:t=>async function(e,t,n){const{currentSpaceStore:o,mainEditorCurrentBlockStore:i}=$i.default.state,r=(0,Sr.YO)(t).find((e=>{let{permissionItem:t}=e;return(0,vr.$D)(t)}));if(t.isDefaultRecordCache()&&(o||r)){if(!e)return r&&!o&&i?[i.id]:_r._u(n).map((e=>e.id));{const t=await F.deps.searchActions.loader();if(o){return(await t.searchPageIds({environment:n,query:e,limit:20,spaceId:o.id,requireEditPermissions:!1,excludeTemplates:!1,source:"link_to_page_block",boostRecentlyViewedPages:!0})).results}if(r&&r.from.table===br.iU){return(await t.searchPageIdsInAncestor({environment:n,query:e,limit:20,ancestorId:r.from.blockId,excludeTemplates:!1,source:"link_to_page_block"})).results}}}return[]}(t,e.store,o),debounce:Gi.vp,render:(t,n,o)=>(0,l.jsx)(Xi.Z,{debugName:"LinkToPageBlock",capture:d,children:(0,l.jsx)(kr,{store:e.store,results:n,ready:o,autocompleteStore:s})})}):null)}const xr=r.memo(r.forwardRef(Cr),u.Z),Tr=(0,s.IU)("loom",{viewBox:"0 0 190 190",svg:(0,l.jsx)("path",{d:"M189.611 84.2622H134.166L182.184 56.539L171.639 38.2692L123.621 65.9923L151.338 17.9781L133.068 7.42678L105.351 55.4409V0H84.2598V55.4462L56.5322 7.42678L38.2681 17.9728L65.9904 65.987L17.9723 38.2692L7.42658 56.5337L55.4447 84.2569H0V105.349H55.4394L7.42658 133.072L17.9723 151.342L65.9851 123.624L38.2628 171.638L56.5322 182.184L84.2545 134.165V189.611H105.346V134.17L133.063 182.184L151.332 171.638L123.61 123.619L171.628 151.342L182.174 133.072L134.161 105.354H189.6V84.2622H189.611ZM94.8055 123.491C78.9021 123.491 66.0116 110.601 66.0116 94.6968C66.0116 78.7929 78.9021 65.9021 94.8055 65.9021C110.709 65.9021 123.599 78.7929 123.599 94.6968C123.599 110.601 110.709 123.491 94.8055 123.491Z"})});function Mr(e,t){const n=(0,r.useRef)(null),o=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"loom",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:o,ref:n,store:e.store,iconSvg:Tr,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with any Loom shareable link",id:"loomBlock.embed.caption"}),children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed Loom",id:"loomBlock.placeholder"})}))}const Pr=r.memo(r.forwardRef(Mr),u.Z),Ar=(0,s.IU)("maps",{viewBox:"0 0 160 164",svg:(0,l.jsxs)("g",{children:[" ",(0,l.jsx)("polyline",{points:"16 163.155 76.159 103 136.314 163.155 16 163.155"})," ",(0,l.jsx)("path",{d:"M91.1523093,12 C89.1061243,15.5558234 87.6020864,19.4206238 86.7688642,23.441 C84.8448642,33.084 86.5958642,43.241 91.3038642,51.836 C91.8382207,52.8588753 92.3925227,53.8704894 92.9644441,54.8718184 L0,147.839 L0,24.942 C0,17.799 5.796,12 12.942,12 L91.1523093,12 L91.1523093,12 Z M27.8186945,28.8787927 C20.9826945,31.9947927 15.9026945,38.8067927 15.1686945,46.3227927 C13.7376945,56.9777927 21.5856945,67.7337927 32.0706945,69.9057927 C40.5536945,71.9007927 50.5746945,68.4527927 54.8196945,60.5497927 C57.5256945,56.1347927 57.8816945,50.7917927 57.3626945,45.7587927 C50.5816945,45.0857927 43.5296945,45.6577927 36.6486945,45.4797927 C36.5946945,48.0237927 36.6096945,50.5677927 36.7256945,53.1037927 C40.8396945,53.0417927 44.9526945,53.0807927 49.0736945,53.0727927 C47.8296945,58.9497927 41.9446945,62.9007927 36.0456945,62.2127927 C27.0296945,62.0967927 20.6586945,51.4727927 24.4936945,43.3927927 C27.4236945,35.1807927 39.1766945,32.2347927 45.4326945,38.4437927 C47.4426945,36.5027927 49.4526945,34.5547927 51.4096945,32.5597927 C45.1536945,26.7907927 35.5196945,25.3527927 27.8186945,28.8787927 Z"})," ",(0,l.jsx)("path",{d:"M124.80036,20.6120969 C120.325021,21.6105482 116.569675,25.5689693 116.191987,30.2012296 C115.721991,34.5142624 118.24735,38.8911407 122.112695,40.7949674 C126.304191,43.0118678 131.806442,42.332644 135.307176,39.1288306 C138.574835,36.2380909 139.764822,31.2458343 138.057917,27.2058756 C136.037937,22.1505427 130.041845,19.2713414 124.80036,20.6120969 Z M129.322621,0 C138.754833,0.539994477 147.978584,5.14840888 153.696218,12.7298698 C157.440026,17.5182824 159.529236,23.4620677 160,29.4989291 L160,31.7396754 C159.779233,43.4418634 152.290848,53.047919 145.807068,62.1501336 C138.528681,72.435413 131.801058,83.6445291 129.937231,96.3213226 C129.438005,98.4697621 129.034302,102.445875 127.470333,102.445875 C124.80036,102.3677 123.210376,86.842958 120.185792,80.3707165 C116.755058,72.8300244 111.978183,66.0154787 107.125156,59.3463161 C104.17134,55.3471262 101.384446,51.2079378 99.0798538,46.7964445 C95.4583524,40.1849736 94.1114431,32.3719766 95.591428,24.9543602 C96.8052617,19.097497 99.8698458,13.6698602 104.112879,9.47298004 C109.830513,3.88303721 117.561972,0.499225663 125.538045,0 L129.322621,0 Z"})," ",(0,l.jsx)("path",{d:"M151.652474,72 L151.652474,148.672145 C135.535571,132.464045 127.553192,124.419378 127.705338,124.538145 C131.041338,123.277145 130.263338,119.369145 130.912338,116.576145 C133.335338,100.096145 142.081338,85.5241452 151.543338,72.1531452 C151.579693,72.102109 151.616072,72.0510607 151.652474,72 Z"})," ",(0,l.jsx)("path",{d:"M106.040648,74 L92,88.0399478 L125.952845,121.992793 C123.906994,113.374953 121.723258,103.970177 117.61803,95.9459594 C114.174293,88.3766869 110.811044,80.7912134 106.040648,74 Z"})," "]})}),Rr=(0,d.defineMessages)({embedButtonText:{defaultMessage:"Embed Map",id:"googleMapsBlock.embedButton.label"}});function Dr(e,t){const n=(0,d.useIntl)(),o=(0,r.useRef)(null),i=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"maps",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:i,ref:o,store:e.store,iconSvg:Ar,urlInputPlaceholder:"https://www.google.com/mapsâ€¦",embedButtonText:n.formatMessage(Rr.embedButtonText),mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with places on Google Maps",id:"googleMapsBlock.embed.caption"}),children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed a Google Map",id:"googleMapsBlock.placeholder"})}))}const Er=r.memo(r.forwardRef(Dr),u.Z),Br=(0,s.IU)("miro",{viewBox:"0 0 32 32",svg:(0,l.jsx)("path",{d:"M13.75 20.895l1.761.359v-7.82l-1.76.344v7.117zm4.604-4.28v4.28l1.761.359V16.88c0-.993.56-1.441 1.432-1.607l1.015-.186v-1.835l-1.015.164c-1.935.44-3.193 1.073-3.193 3.197zm-7.446-.256c0-2.313-1.539-3.085-2.777-3.068-.984.014-1.785.423-2.265 1.047-.478-.685-1.325-1.068-2.016-1.068-.85 0-1.597.373-2.09.97v-.806L0 13.778v7.117l1.76.359v-4.895c0-.776.568-1.328 1.418-1.328.836 0 1.403.552 1.403 1.328v4.536l1.76.359v-4.895c0-.776.568-1.328 1.404-1.328.835 0 1.402.552 1.402 1.328v4.536l1.76.359v-4.895h.001zm17.176 5.059c2.356 0 3.916-1.636 3.916-4.081 0-2.446-1.56-4.067-3.916-4.067-2.446 0-4.082 1.62-4.082 4.067 0 2.445 1.636 4.08 4.082 4.08zm0-1.65c-1.366 0-2.281-.976-2.281-2.431 0-1.456.915-2.416 2.281-2.416 1.275 0 2.115.96 2.115 2.416 0 1.455-.84 2.43-2.115 2.43zm-13.416-7.552c.641 0 1.065-.445 1.065-1.11S15.31 10 14.668 10c-.665 0-1.11.44-1.11 1.106 0 .665.445 1.11 1.11 1.11"})}),Fr=(0,d.defineMessages)({embedButtonText:{defaultMessage:"Embed Miro",id:"miroBlock.embeds.button.label"}});function Or(e,t){const n=(0,d.useIntl)(),o=(0,r.useRef)(null),i=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"miro",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:i,ref:o,store:e.store,iconSvg:Br,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with Miro links with public access enabled",id:"miroBlock.embeds.caption"}),embedButtonText:n.formatMessage(Fr.embedButtonText),urlInputPlaceholder:"https://miro.com/app/board/â€¦",children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed Miro",id:"miroBlock.placeholder"})}))}const Zr=r.memo(r.forwardRef(Or),u.Z),Vr=(0,s.IU)("mixpanel",{viewBox:"0 0 101 106",svg:(0,l.jsx)("g",{children:(0,l.jsx)("path",{d:"M31.008 41.412h13.385c-3.342-2.09-4.593-5.021-6.272-10.454l-5.022-18.613C30.803 3.982 28.918.005 19.714.005H.484v5.022H3.21c5.639 0 6.273 2.091 7.952 8.364l4.387 16.315c2.297 7.952 5.861 11.706 15.476 11.706h-.016zm30.968 0h13.37c9.614 0 12.956-3.77 15.27-11.706l4.387-16.315c1.679-6.273 2.502-8.364 7.952-8.364h2.724V.006H86.655c-9.41 0-11.294 3.77-13.385 12.34l-5.02 18.611c-1.68 5.639-2.93 8.363-6.273 10.454zM44.393 58.963h17.584l-.001-17.55H44.393v17.55zM.484 100.369h19.23c9.204 0 11.088-3.976 13.385-12.34l5.022-18.611c1.679-5.434 2.93-8.364 6.272-10.455H31.008c-9.615 0-13.179 3.77-15.475 11.706l-4.388 16.315c-1.68 6.273-2.297 8.364-7.952 8.364H.484v5.021zm86.14 0h19.023v-5.021h-2.724c-5.433 0-6.273-2.091-7.952-8.364L90.583 70.67c-2.296-7.952-5.639-11.706-15.27-11.706H61.976c3.343 2.091 4.546 4.816 6.225 10.455l5.022 18.612c2.09 8.57 3.975 12.339 13.385 12.339h.015z"})})}),Ur=(0,d.defineMessages)({embedButtonText:{defaultMessage:"Embed Mixpanel",id:"mixpanelBlock.embeds.button.label"}});function Lr(e,t){const n=(0,d.useIntl)(),o=(0,r.useRef)(null),i=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"mixpanel",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:i,ref:o,store:e.store,iconSvg:Vr,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with Mixpanel projects",id:"mixpanelBlock.embeds.caption"}),embedButtonText:n.formatMessage(Ur.embedButtonText),urlInputPlaceholder:"https://mixpanel.com/â€¦",children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed a Mixpanel project",id:"mixpanelBlock.placeholder"})}))}const jr=r.memo(r.forwardRef(Lr),u.Z);var Nr=n(54321),zr=n(4382),qr=n(45952),Wr=n(16472);const Hr=(0,s.IU)("replit",{viewBox:"0 0 793.8 871.5",svg:(0,l.jsx)("g",{children:(0,l.jsx)("path",{d:"M396.9 356.1H227.2c-16.6 0-30-13.4-30-30v-99.8c0-16.6 13.4-30 30-30h139.7c16.6 0 30 13.4 30 30v129.8zm169.7 159.7H396.9V356.1h169.7c16.5 0 29.9 13.4 29.9 29.9v99.8c0 16.6-13.4 30-29.9 30zM366.9 675.6H227.2c-16.5 0-29.9-13.4-29.9-29.9v-99.8c0-16.5 13.4-29.9 29.9-29.9h169.7v129.8c0 16.3-13.4 29.8-30 29.8z"})})}),Kr=(0,d.defineMessages)({embedButtonText:{defaultMessage:"Embed a repl",id:"replitBlock.embeds.button.label"}});function Gr(e,t){const n=(0,d.useIntl)(),o=(0,r.useRef)(null),i=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"replit",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:i,ref:o,store:e.store,iconSvg:Hr,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with Replit.",id:"replitBlock.embeds.caption"}),embedButtonText:n.formatMessage(Kr.embedButtonText),urlInputPlaceholder:"https://replit.com/â€¦",children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed a repl",id:"replitBlock.placeholder"})}))}const $r=r.memo(r.forwardRef(Gr),u.Z),Qr=(0,s.IU)("sketch",{viewBox:"0 0 46 46",svg:(0,l.jsx)("g",{fillRule:"evenodd",children:(0,l.jsx)("path",{d:"M23.0831783 10.0045301l8.1450351.8960958c.2099814.0231017.4008968.1324906.5270123.3019626l6.0917147 8.1859511c.2137793.2872733.1982297.6847539-.0373384.9544486L23.4296391 36.806161c-.2072579.2372831-.5676296.2616233-.8049127.0543654l-.0543655-.0543654L8.19039805 20.3429882c-.23556813-.2696947-.25111774-.6671753-.03733843-.9544486l6.09171468-8.1859511c.1261155-.169472.3170309-.2788609.5270123-.3019626l8.1450351-.8960958a.76060447.76060447 0 01.1663566 0zm2.0141776 2.4229231c-.0693405-.0648437-.1764661-.0687976-.2504897-.0092454-.081512.0655766-.0939018.1841651-.0276733.2648747l3.8573181 4.7007387c.055083.0671271.085151.1509825.085151.2374739 0 .207984-.1702805.3765884-.3803321.3765884H17.6186701c-.0873512 0-.1720402-.0297721-.2398346-.0843129-.163024-.1311532-.1878035-.3683301-.0553465-.5297494l3.8573181-4.7007387c.0601442-.073295.0561509-.1793661-.0093373-.2480242-.0721132-.0756035-.1924706-.0790085-.2688257-.0076051l-5.750016 5.3771171c-.0774384.0724164-.1819972.1093609-.2882425.1018466-.2095178-.0148182-.3672335-.1950067-.352268-.4024622l.2753824-3.8174045c.0064096-.0888512-.0509385-.1699933-.1374402-.1944648-.1009848-.0285688-.206239.0293302-.2350918.129321L13.1553109 17.98681c-.0869135.3012032-.3194364.539875-.62031.6367138l-2.76499194.8899366c-.07834118.0252148-.13137885.0975058-.13137885.1790711 0 .1039921.08514024.1882942.19016605.1882942h2.66553224c.3250892 0 .6276464.1644528.8021788.4360184L20.3459621 31.28552c.0777639.1209976.2347663.165079.3651002.1025088.1417556-.0680534.2009545-.2370061.1322245-.3773663l-5.0526479-10.3185107c-.0376144-.0768161-.0571558-.1610746-.0571558-.2464434 0-.3119761.2554207-.5648827.5704981-.5648827h13.3920376c.0862174 0 .1713136.0193492.2488932.0565933.2835111.1361069.401909.4740123.2644491.7547328l-5.0526479 10.3185107c-.0631922.129051-.0186726.2845081.1035279.3615065.1329093.0837462.3092182.0449521.3937968-.086649l7.0494549-10.9686759c.1745324-.2715656.4770896-.4360184.8021788-.4360184h2.5849257c.0818532 0 .1545231-.0518618.1804073-.1287503.0332121-.0986555-.0206353-.2052903-.1202715-.2381755l-2.6912281-.888246c-.2977515-.0982735-.5273437-.3357047-.6135671-.6345159l-1.2609059-4.3697316c-.0247148-.0856502-.1066636-.1424338-.196398-.1360873-.1047589.0074091-.1836168.0975033-.176134.2012311l.2753824 3.8174045c.0075889.1051994-.0297228.2087291-.1028592.2854053-.1442263.1512071-.3849411.158017-.5376513.0152103z"})})}),Yr=(0,d.defineMessages)({embedButtonText:{defaultMessage:"Embed Sketch",id:"sketchBlock.embeds.button.label"}});function Jr(e,t){const n=(0,d.useIntl)(),o=(0,r.useRef)(null),i=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"sketch",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:i,ref:o,store:e.store,iconSvg:Qr,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with Sketch links with Public Link Access enabled",id:"sketchBlock.embeds.caption"}),embedButtonText:n.formatMessage(Yr.embedButtonText),urlInputPlaceholder:"https://sketch.com/â€¦",children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed Sketch",id:"sketchBlock.placeholder"})}))}const Xr=r.memo(r.forwardRef(Jr),u.Z);var ea=n(99571),ta=n(51704),na=n(15690),oa=n(25777),ia=n(33709),ra=n(94419),aa=n(52771),sa=n(92120),la=n(98165),ca=n(34859),da=n(79131),ua=n(31278),pa=n(76798),ma=n(53336);function fa(e){const t=(0,d.useIntl)(),n=(0,y.O7)(),o=(0,S.Fg)(),i=(0,S.yK)((e=>({baseStyle:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},mobileStyle:ya(e),desktopStyle:ba(e),scrollerOverlayStyle:_a(e)})),[]),a=(0,r.useRef)(null);return(0,l.jsxs)(z.p,{allowSelectionWithin:!0,style:{...n.device.isMobile?i.mobileStyle:i.desktopStyle,...i.baseStyle},children:[(0,l.jsx)(ma.Z,{role:"tablist","aria-label":t.formatMessage(va.tabListLabel),type:ca.Z.X,ref:a,showLeftRightOverlay:!0,rightOverlayStyle:i.scrollerOverlayStyle,children:(0,l.jsx)(da.ZP,{disabled:e.disabled,direction:"horizontal",keys:e.tabs.map((e=>e.id)),renderKey:(t,n)=>(0,l.jsx)(ga,{index:n,...e}),onDrop:(t,o)=>function(e){const{environment:t,parentStore:n,onDropArgs:o,newTabs:i}=e;Zt.createAndCommit({userAction:"TabBlockMenu.handleTabReorder",environment:t,perform:e=>{const{key:t,endPosition:r}=o,a=n.getContentStores().find((e=>e.id===t)),s=i[r-1],l=n.getContentStores().find((e=>e.id===s));if(a){const t=n;ra.HP({parent:t.getContentStore(),after:l,current:a,transaction:e})}}})}({environment:n,newTabs:t,parentStore:e.parentStore,onDropArgs:o}),disableHorizontalEdgeScroll:!1})}),!e.disabled&&(0,l.jsx)(mi.Z,{"aria-label":t.formatMessage(va.addTab),style:{height:28,width:28,marginTop:6,display:"flex",justifyContent:"center"},onClick:()=>{!function(e,t,n){const{performResult:o}=Zt.createAndCommit({userAction:"TabBlockMenu.newTab",environment:e,perform:n=>na.gG({environment:e,store:t,transaction:n})}),i=()=>{const e=t.getContentStores(),n=e[e.length-1];aa.$({blockStore:o,renderDelete:!0,originRect:n?Yo.C.getRectFromStore(n):void 0})};n.current?n.current.scrollToRight({animate:!0,animationCallback:()=>{i()}}):i()}(n,e.parentStore,a)},children:(0,$o.R)({fill:o.mediumIconColor,width:16,height:16})})]})}function ga(e){const t=(0,y.O7)(),n=(0,d.useIntl)(),{index:o,parentStore:i,selectedIndex:r,tabs:s}=e,c=s[o],u=(0,S.yK)((e=>({selectedTab:{...{paddingTop:6,paddingBottom:12,whiteSpace:"nowrap",minWidth:0,flexShrink:0,fontWeight:500},position:"relative"},tab:{paddingTop:6,paddingBottom:12,whiteSpace:"nowrap",minWidth:0,flexShrink:0,fontWeight:500},border:Sa(e)})),[]),p=(0,a.VK)((()=>{const e=sa.Z.getFirstSelectedDiscussionId();if(!e)return!1;const t=ii.jQ.createChildStore(c,{table:ia.qF,id:e,spaceId:c.getSpaceId()});return(0,la.qA)(t).map((e=>e.id)).includes(c.id)}),[c]),{device:m}=t,f=r===o,g=o===s.length-1,h=0===o,v=s.length;return(0,l.jsx)(dn.Z,{store:c,analyticsName:"tab",canSelect:!0,canDrag:!1,canDropBelow:!1,canDropLeft:!h,canDropAbove:!1,canNativeDropBelow:!1,canNativeDropLeft:!h,canNativeDropRight:!g,canDropOnto:!0,dropzoneShouldNeverUseOrigin:!0,dropzoneMustBeWithinHorizontalBound:!0,canInsertAbove:!h,canDropRight:!g,canInsertBelow:!g,shouldShowHalo:!0,shouldShowDropZone:!0,shouldShowParentHalo:!0,dropzoneGap:10,onSelectableDrop:e=>{const{droppedDirection:n,droppedStores:o,duplicate:i}=e;Zt.createAndCommit({userAction:"TabBlockMenu.dropOntoTab",environment:t,perform:e=>{Jt.LQ({environment:t,targetParentStore:c.getContentStore(),targetStore:c,droppedDirection:n,droppedStores:o,duplicate:i,transaction:e})}})},onRemove:()=>{!function(e){const{environment:t,parentStore:n,tabStore:o,index:i}=e;Zt.createAndCommit({userAction:"TabBlockMenu.handleRemoveTab",environment:t,perform:e=>{const r=n.getContentStores();if(1===r.length){const t=n.getRecordStoreUIParent();"block"!==(null==t?void 0:t.table)&&"space"!==(null==t?void 0:t.table)||null==t||!t.valueIs(Jo.i)||ra.Od({parent:t,childToRemove:n,transaction:e})}else{const e=i<r.length-1?r[i+1]:r[i-1];na.x2({store:n,id:e.id,currentUserId:t.currentUser.id})}ra.Od({parent:n.getContentStore(),childToRemove:o,transaction:e})}})}({environment:t,parentStore:i,tabStore:c,index:o})},children:(0,l.jsxs)("div",{style:{...f?u.selectedTab:u.tab},children:[(0,l.jsxs)(mi.Z,{role:"tab","aria-selected":f,"aria-controls":f?e.contentAriaId:void 0,"aria-posinset":o+1,"aria-setsize":v,id:f?e.selectedTabAriaId:void 0,style:{fontSize:16},onClick:()=>function(e,t,n){if(e.onChange(t),n&&!e.disabled){const n=e.parentStore.getContentStores()[t];aa.$({blockStore:n,renderDelete:!0})}}(e,o,f),disabled:e.readOnly,mobileFeedback:m.isMobile,hovered:p,isGray:!f,children:[(0,l.jsx)(ha,{store:c}),(0,l.jsx)(pa.Z,{store:c,placeholder:n.formatMessage(va.untitledTab)})]}),f&&(0,l.jsx)("div",{style:u.border})]},o)},o)}function ha(e){const{store:t}=e,{icon:n,isEmptyPage:o}=(0,a.VK)((()=>({icon:t.hasIcon()&&t.getIcon(),isEmptyPage:t.isEmptyPage()})),[t]);return n?(0,l.jsx)(ua.Z,{disabled:!0,icon:n,isEmptyPage:o,size:20,style:{marginRight:6}}):null}const va=(0,d.defineMessages)({untitledTab:{id:"tabMenuBlock.title.placeholder",defaultMessage:"Untitled"},addTab:{id:"tabMenuBlock.addTab",defaultMessage:"Add tab"},tabListLabel:{defaultMessage:"Tab block",id:"tabBlockMenu.tabListLabel"}});function ba(e){return{display:"flex",fontSize:14,width:"100%",paddingLeft:8,paddingRight:8,boxShadow:`0 1px 0 ${e.regularDividerColor}`,position:"relative",zIndex:1}}function ya(e){return{display:"flex",fontSize:16,width:"100%",paddingTop:2,paddingLeft:16,paddingRight:16,boxShadow:`0 1px 0 ${e.regularDividerColor}`,position:"relative",zIndex:2,height:44,background:e.popoverBackground}}function _a(e){return{background:e.regularDividerColor,right:28,opacity:1,marginTop:6,marginBottom:12,width:1}}function Sa(e){return{borderBottom:`2px solid ${e.regularTextColor}`,position:"absolute",bottom:0,left:0,right:0}}class wa extends _n.Z{constructor(){super(...arguments),this.contentAriaId=(0,oo.Z)(),this.selectedTabAriaId=(0,oo.Z)(),this.storeTypes={shouldShowBottomBorder:Sn.default.createClass(!1)},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseMove=e=>function(e,t,n){const o=e.currentTarget.getBoundingClientRect();n.setState(Ia(o,e.clientY,t))}(e,this.props.disabled,this.stores.shouldShowBottomBorder),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseEnter=e=>function(e,t,n){const o=e.currentTarget.getBoundingClientRect();n.setState(Ia(o,e.clientY,t))}(e,this.props.disabled,this.stores.shouldShowBottomBorder),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave=()=>{this.stores.shouldShowBottomBorder.setState(!1)}}handleCreated(){this.stores.shouldShowBottomBorder.setState(!1)}UNSAFE_willMount(e){const t=this.environment.currentUser.id;na.nz({blockId:this.props.store.id,currentUserId:t})}renderPersisted(){return(0,l.jsxs)("div",{style:this.getStyle(),children:[(0,l.jsxs)("div",{onMouseMove:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseMove,onMouseEnter:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseEnter,onMouseLeave:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave,children:[(0,l.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:this.renderTabs()}),this.renderCurrentTab()]}),(0,l.jsx)(ye.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store,hideIfSidebarOrMarginCommentsVisible:!0})]})}renderCurrentTab(){const e=ti.b(this.props.store);return(0,l.jsx)("div",{role:"tabpanel",id:this.contentAriaId,"aria-labelledby":this.selectedTabAriaId,style:{position:"relative"},children:(0,l.jsx)(oa.Z,{loaded:e,spinnerSize:"1em",showSpinnerTimeout:500,innerStyle:{display:"flex",flexDirection:"column"},children:this.renderLoadedContent()})})}renderLoadedContent(){const e=function(e){const t=na.jL(e),n=e.getContentStores();return n.length>t?n[t]:n[0]}(this.props.store);return e?(0,l.jsx)(dn.Z,{store:e,analyticsName:"page_content",canSelect:!1,canDrag:!1,isListContainer:!0,style:{display:"flex",flexDirection:"column"},children:(0,l.jsx)(G.Z,{store:e.getContentStore(),disabled:this.props.disabled,disableContent:!1,emptyPlaceholder:this.renderPlaceHolder(e)})},e.id):null}renderPlaceHolder(e){return(0,l.jsx)(W.Z,{style:(t=this.theme,{fontSize:"inherit",width:"100%",borderRadius:4,caretColor:t.lightTextColor,...Oe.ZD,marginTop:2}),onClick:()=>function(e,t){Zt.createAndCommit({userAction:"TabBlock.handlePlaceholderClick",environment:t,perform:n=>{na.ls({environment:t,store:e,transaction:n})}})}(e,this.environment),disabled:!this.canEdit(),children:(0,l.jsx)("span",{style:{color:this.theme.lightTextColor},children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Empty tab. Click or drop blocks inside.",id:"tabBlock.emptyBlock.placeholderText"})})});var t}renderTabs(){return(0,l.jsx)(fa,{contentAriaId:this.contentAriaId,selectedTabAriaId:this.selectedTabAriaId,disabled:!this.canEdit(),parentStore:this.props.store,tabs:this.props.store.getContentStores(),selectedIndex:na.jL(this.props.store),onChange:e=>function(e,t,n){na.a({store:t,index:e,currentUserId:n.currentUser.id})}(e,this.props.store,this.environment)})}getStyle(){return{paddingLeft:Oe.ZD.paddingLeft,flex:1,...Ca(this.theme,this.stores.shouldShowBottomBorder),...this.getBlockColorStyle(),...this.props.style}}}const ka=wa;function Ia(e,t,n){return!n&&(!!U.Z.state.isDragging||(!!j.default.state.isActive||t<=e.bottom+20&&t>=e.bottom-20))}function Ca(e,t){return t.state?{boxShadow:`0 1px 0 ${e.regularDividerColor}`}:{}}var xa=n(85031),Ta=n(25888),Ma=n(18514),Pa=n(28662),Aa=n(89579),Ra=n(78454);function Da(e,t){const n=(0,y.O7)(),o=(0,y.Fy)(),i=(0,r.useRef)(null),a=(0,p.PE)(e.store,e.disabled),s=e.disabled||!a,{navigableAncestor:c,headerStores:u}=(0,Pa.m)({parentStore:e.store}),m=(0,S.yK)((e=>({root:{position:"relative"},placeholder:{...Fa,paddingTop:Oe.ZD.paddingTop,paddingBottom:Oe.ZD.paddingBottom,color:e.lightTextColor,...!s&&o.isMobile&&{marginRight:36}},actionMenuButton:{position:"absolute",top:3,right:6}})),[o.isMobile,s]),f=(0,l.jsx)("div",{style:m.placeholder,children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Add headings to create a table of contents. <linktohelpbutton>Learn more</linktohelpbutton>.",id:"tableOfContentsBlock.placeholder",values:{linktohelpbutton:e=>(0,l.jsx)(St.Z,{href:(0,Ma.UY)("guides.tableOfContents"),external:!0,onClick:()=>Ta.Fs(n,{from:"table_of_contents_placeholder"}),children:e})}})}),g=(0,l.jsxs)(z.p,{allowSelectionWithin:!0,style:m.root,ref:i,children:[u.map((t=>(0,l.jsx)(Ba,{headerStore:t,index:u.indexOf(t),headerStores:u,store:e.store,navigableAncestor:c,style:e.style},t.id))),0===u.length&&f,!s&&o.isMobile&&(0,l.jsx)(ve.Z,{style:m.actionMenuButton,tooltipContent:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"More actionsâ€¦",id:"tableOfContentsBlock.mobileActionMenu.button.label"}),store:e.store,fadeIn:!1})]});return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"table_of_contents",getNode:()=>i.current,getBlockStore:()=>e.store})),[e.store]),g)}const Ea=r.memo(r.forwardRef(Da),u.Z);function Ba(e){const t=(0,a.VK)((()=>xa.y({headerBlockId:e.headerStore.id,headerBlockIds:e.headerStores.map((e=>e.id)),index:e.index,getRecordModel:e.store.getRecordModel})),[e.headerStore.id,e.headerStores,e.index,e.store.getRecordModel]),n=(0,p.rv)(e.store),o=(0,S.yK)((()=>({container:n,innerHeader:{...Fa,display:"flex",alignItems:"center",marginLeft:Ra.LK*t,paddingTop:2*Oe.ZD.paddingTop,paddingBottom:2*Oe.ZD.paddingBottom}})),[n,t]),i=(0,Aa.R)({scrollToBlockId:e.headerStore.id,pageStore:e.navigableAncestor});return e.navigableAncestor?(0,l.jsx)("div",{style:{...o.container,...e.style},children:(0,l.jsx)(Se.Z,{href:i.href,external:!1,children:(0,l.jsx)("div",{style:o.innerHeader,children:(0,l.jsx)(pa.Z,{store:e.headerStore,shouldWrap:!1,underline:!0})})})}):null}const Fa={paddingRight:Oe.ZD.paddingRight,paddingLeft:Oe.ZD.paddingLeft,fontSize:14,lineHeight:1.3};var Oa=n(17970),Za=n(6684),Va=n(4859),Ua=n(25157),La=n(91497);const ja=(0,s.IU)("twitter",{viewBox:"0 0 2400 2452",svg:(0,l.jsx)("path",{d:"M5.3 7.7c4.6 6.6 920.6 1339.9 928.8 1351.9l2.9 4.2-463.2 538.3C219.1 2198.2 8.2 2443.3 5.2 2446.7l-5.4 6.3h211.8l409.5-476c225.2-261.8 409.6-476 409.9-476 .3 0 147.7 214.2 327.5 476l327 476h714.6l-2.9-4.3c-1.6-2.3-220-320.1-485.2-706.2-265.3-386.1-482.4-702.7-482.4-703.6-.1-.8 200.4-234.6 445.4-519.4C2120 234.7 2320.7 1.3 2320.8.8c.2-.4-47.1-.8-105.1-.8h-105.5l-387.4 450.2c-213 247.6-387.7 450.3-388.3 450.4-.5.2-140.2-202.4-310.4-450.1L714.7 0H-.1l5.4 7.7zm669 239c283.8 405.9 1434.5 2052.1 1435.1 2053 .6 1-32 1.3-161.7 1.3h-162.5l-341-487.7C1256.7 1545 920 1063.4 696.1 743.1 472.2 422.8 289 160.4 289 159.9s68.3-.9 162-.9h161.9l61.4 87.7z"})}),Na=(0,d.defineMessages)({embedButtonText:{defaultMessage:"Embed Tweet",id:"tweetBlock.embedTweet.button.label"}});function za(e,t){const n=(0,d.useIntl)(),o=(0,r.useRef)(null),i=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"tweet",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:i,ref:o,store:e.store,iconSvg:ja,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with links to Tweets",id:"tweetBlock.linkInput.caption"}),embedButtonText:n.formatMessage(Na.embedButtonText),urlInputPlaceholder:"https://twitter.com/â€¦ or https://x.com/",children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed a Tweet from X",id:"tweetBlock.placeholder"})}))}const qa=r.memo(r.forwardRef(za),u.Z),Wa=(0,s.IU)("typeform",{viewBox:"0 0 30 31",svg:(0,l.jsx)("path",{d:"M15.027 30.53c-4.294-.036-8.467-2.247-11.47-5.222C.553 22.333-.09 19.78.009 15.654.107 11.53 1.2 7.81 4.047 4.68 6.895 1.55 10.121.11 14.25.006c4.129-.103 7.291 1.046 10.44 4.156 3.15 3.11 5.242 7.127 5.31 11.392.067 4.266-1.978 6.94-4.972 9.936-2.994 2.995-5.706 5.077-10 5.04zm-4.891-19.66h3.818v10.304h1.903V10.87h3.818V9.071h-9.54v1.798z"})});function Ha(e,t){const n=(0,r.useRef)(null),o=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"typeform",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:o,ref:n,store:e.store,iconSvg:Wa,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with any public Typeform link",id:"typeformBlock.embed.caption"}),children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed Typeform",id:"typeformBlock.placeholder"})}))}const Ka=r.memo(r.forwardRef(Ha),u.Z),Ga=(0,s.IU)("video",{viewBox:"0 0 30 30",svg:(0,l.jsx)("path",{d:"M2,2v26h26V2H2z M26,6h-2V4h2V6z M22,14H8V4h14V14z M6,10H4V8h2V10z M6,12v2H4v-2H6z M6,16v2H4v-2H6z M6,20v2H4v-2H6z M8,16 h14v10H8V16z M24,20h2v2h-2V20z M24,18v-2h2v2H24z M24,14v-2h2v2H24z M24,10V8h2v2H24z M6,4v2H4V4H6z M4,24h2v2H4V24z M24,26v-2h2v2 H24z"})}),$a=(0,d.defineMessages)({urlPlaceholder:{defaultMessage:"Paste the video linkâ€¦",id:"videoBlock.linkInput.placeholder"},embedButtonText:{defaultMessage:"Embed video",id:"videoBlock.embedVideo.button.label"}});function Qa(e,t){const n=(0,d.useIntl)(),o=(0,r.useRef)(null),i=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"video",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:i,ref:o,store:e.store,iconSvg:Ga,preserveScale:!0,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"},{type:"file",videoUpload:!0}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with YouTube, Vimeo, and more",id:"videoBlock.linkInput.caption"}),embedButtonText:n.formatMessage($a.embedButtonText),urlInputPlaceholder:n.formatMessage($a.urlPlaceholder),children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed or upload a video",id:"videoBlock.placeholder"})}))}const Ya=r.memo(r.forwardRef(Qa),u.Z),Ja=(0,s.IU)("whimsical",{viewBox:"0 0 32 32",svg:(0,l.jsxs)("g",{children:[(0,l.jsx)("path",{opacity:".8",fillRule:"evenodd",clipRule:"evenodd",d:"M12.807 9.772a.497.497 0 00-.705 0L5.76 16.146a.502.502 0 000 .708l6.343 6.374c.195.195.51.195.705 0l6.343-6.374a.503.503 0 000-.708l-6.343-6.374zm.352-2.479a.993.993 0 00-1.41 0l-8.457 8.499a1.005 1.005 0 000 1.416l8.458 8.499a.993.993 0 001.41 0l8.457-8.499c.39-.391.39-1.025 0-1.416l-8.458-8.499z",fill:"#A7A6A2"}),(0,l.jsx)("mask",{id:"a",maskUnits:"userSpaceOnUse",x:"3",y:"7",width:"19",height:"19",children:(0,l.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.807 9.772a.497.497 0 00-.705 0L5.76 16.146a.502.502 0 000 .708l6.343 6.374c.195.195.51.195.705 0l6.343-6.374a.503.503 0 000-.708l-6.343-6.374zm.352-2.479a.993.993 0 00-1.41 0l-8.457 8.499a1.005 1.005 0 000 1.416l8.458 8.499a.993.993 0 001.41 0l8.457-8.499c.39-.391.39-1.025 0-1.416l-8.458-8.499z",fill:"#fff"})}),(0,l.jsx)("g",{filter:"url(#filter0_d)",mask:"url(#a)",children:(0,l.jsx)("path",{d:"M18.84 7.293a.993.993 0 011.41 0l8.458 8.499c.39.39.39 1.025 0 1.416l-8.458 8.499a.993.993 0 01-1.41 0l-8.457-8.499a1.005 1.005 0 010-1.416l8.457-8.499z",fill:"#000",fillOpacity:".01"})}),(0,l.jsx)("path",{d:"M18.84 7.293a.993.993 0 011.41 0l8.458 8.499c.39.39.39 1.025 0 1.416l-8.458 8.499a.993.993 0 01-1.41 0l-8.457-8.499a1.005 1.005 0 010-1.416l8.457-8.499z",fill:"#A7A6A2"}),(0,l.jsx)("defs",{children:(0,l.jsxs)("filter",{id:"filter0_d",x:"8.055",y:"4.964",width:"22.98",height:"23.071",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,l.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,l.jsx)("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,l.jsx)("feOffset",{}),(0,l.jsx)("feGaussianBlur",{stdDeviation:"1.018"}),(0,l.jsx)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.6 0"}),(0,l.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow"}),(0,l.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow",result:"shape"})]})})]})}),Xa=(0,d.defineMessages)({embedButtonText:{defaultMessage:"Embed Whimsical",id:"whimsicalBlock.embeds.button.label"}});function es(e,t){const n=(0,d.useIntl)(),o=(0,r.useRef)(null),i=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"whimsical",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,ref:o,store:e.store,iconSvg:Ja,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Works with Whimsical links with Public Link Access enabled",id:"whimsicalBlock.embeds.caption"}),embedButtonText:n.formatMessage(Xa.embedButtonText),urlInputPlaceholder:"https://whimsical.com/â€¦",blockResizerStore:i,children:(0,l.jsx)(d.FormattedMessage,{defaultMessage:"Embed Whimsical",id:"whimsicalBlock.placeholder"})}))}const ts=r.memo(r.forwardRef(es),u.Z);let ns;function os(e){const t=e.getType();if(t)return"collection_view"===t&&e.recordStoreParentDiffersFromPersistedParent()?o.Z:(ns||(ns={text:Oa.Z,image:ji,video:Ya,bookmark:De,drive:yo,audio:oe,tweet:qa,gist:Di,maps:Er,framer:Mi,invision:Wi,file:Ii.Z,page:zr.Z,to_do:Za.Z,toggle:Va.ZP,bulleted_list:Le.Z,numbered_list:Nr.Z,code:qt,factory:bi,button:je.Z,divider:Jn,column_list:On,copy_indicator:zn,embed:f.ZP,breadcrumb:Ue,equation:Uo,header:Ei.Z,sub_header:ea.Z,sub_sub_header:ta.Z,quote:Wr.ZP,collection_view:$t.DZ,collection_view_page:o.Z,link_to_page:xr,link_to_collection:hr,figma:ki,loom:Pr,codepen:Gt,typeform:Ka,column:pn,pdf:qr.Z,callout:Ne.Z,table_of_contents:Ea,whimsical:ts,miro:Zr,abstract:v,sketch:Xr,excalidraw:Ho,alias:X.Z,transclusion_container:Ua.Z,transclusion_reference:La.Z,replit:$r,external_object_instance:Ko.Z,table:i.Wv,table_row:i.fZ,tab:ka,hex:Zi,deepnote:Kn,mixpanel:jr,external_object_instance_page:Ko.Z,ai_block:J,drawing:to,personal_home_page:void 0}),ns[t])}},59557:(e,t,n)=>{n.d(t,{N:()=>d});var o=n(67294),i=n(480),r=n(86628),a=n(1898),s=n(13447),l=n(37181),c=n(80444);function d(e){const{blockStore:t}=e,n=(0,i.O7)(),d=(0,r.VK)((()=>c.default.state.currentUserSettingsStore),[]),u=(0,r.VK)((()=>{var e;return(0,a.$K)(null===(e=t.getModel())||void 0===e?void 0:e.getProperty("title"))}),[t]),p=(0,o.useCallback)((()=>{d&&s.createAndCommit({userAction:"FactoryButtonDeprecation.updateUserSettings",environment:n,perform:e=>{l.d2({userSettingsStore:d,transaction:e,data:{dismissed_factory_button_deprecation_banner:!0}})}})}),[d,n]),m=(0,o.useCallback)((()=>{if(!d)return;d.getSettingsStore().getKeyStore("seen_factory_button_deprecation_badge").getValue()||s.createAndCommit({userAction:"FactoryButtonDeprecation.updateUserSettings",environment:n,perform:e=>{l.d2({userSettingsStore:d,transaction:e,data:{seen_factory_button_deprecation_badge:!0}})}})}),[d,n]);return{showFactoryButtonDeprecationBadge:(0,r.VK)((()=>u&&!Boolean(null==d?void 0:d.getSettingsStore().getKeyStore("seen_factory_button_deprecation_badge").getValue())),[d,u]),showFactoryButtonDeprecationBanner:(0,r.VK)((()=>u&&!Boolean(null==d?void 0:d.getSettingsStore().getKeyStore("dismissed_factory_button_deprecation_banner").getValue())),[d,u]),handleDismissFactoryButtonMigrationBanner:p,setHasSeenFactoryButtonDeprecationBadge:m}}},29551:(e,t,n)=>{n.d(t,{Ht:()=>c,Vg:()=>d,gq:()=>l,xk:()=>a});n(67294);var o=n(6258),i=n(85893);function r(e){const{style:t,row:n,column:o,reverse:i,inline:r,...a}=e,s={display:r?"inline-flex":"flex"};return o?s.flexDirection=i?"column-reverse":"column":n?s.flexDirection=i?"row-reverse":"row":i&&(s.flexDirection="row-reverse"),Object.assign(s,a,t)}function a(){return r({...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},row:!0})}function s(){return r({...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},column:!0})}function l(e){const{children:t,className:n,...o}=e;return(0,i.jsx)("div",{className:n,style:a(o),children:t})}function c(e){const{children:t,className:n,...o}=e;return(0,i.jsx)("div",{className:n,style:s(o),children:t})}function d(e){let{environment:t,pageBlockStore:n,pathToBlockId:i}=e;const r=new o.ST({environment:t,pointer:n.pointer,path:i}).getValue();return new o.G(t,{table:"block",spaceId:n.getSpaceId(),id:r})}},5595:(e,t,n)=>{n.d(t,{_Y:()=>i,mD:()=>o,rp:()=>r});const o=240,i=80,r=80},17377:(e,t,n)=>{n.d(t,{Z:()=>S});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(49271),l=n(9291),c=n(29373),d=n(13447),u=n(52315),p=n(35328),m=n(45131),f=n(64921),g=n(25777),h=n(55217),v=n(78454),b=n(4859),y=n(5210),_=n(85893);function S(e){const t=(0,i.O7)(),n=(0,a.Fg)(),S=(0,o.useRef)(!0);(0,o.useLayoutEffect)((()=>{S.current&&(S.current=!1,c.nz({blockId:e.store.id,currentUserId:t.currentUser.id}),e.store.isDefaultRecordCache()&&c.LO(t,e.store.pointer))}));const w=(0,r.VK)((()=>e.store.getContentStore()),[e.store]),k=(0,r.VK)((()=>m.Z.isOpen(e.store.id)&&!e.hideContent),[e.hideContent,e.store.id]),I=(0,r.VK)((()=>!e.store.hasContent()),[e.store]),C=(0,o.useId)(),x=(0,o.useId)(),T=(0,r.VK)((()=>u.b(e.store)||!e.store.isDefaultRecordCache()),[e.store]),M=(0,o.useCallback)((()=>{p.th(t,e.store,e.hideContent)}),[t,e.hideContent,e.store]),P=(0,r.VK)((()=>p.fn(e.store)),[e.store]),A=(0,r.VK)((()=>{var t;return null===(t=e.store.getFormat())||void 0===t?void 0:t.toggleable}),[e.store]),R=(0,o.useCallback)((()=>{d.createAndCommit({userAction:"FormatToggleable.handlePlaceholderClick",environment:t,perform:n=>{c.ls({environment:t,store:e.store,transaction:n})}})}),[t,e.store]),D=(0,_.jsx)(f.Z,{style:{fontSize:"inherit",width:"100%",borderRadius:4,caretColor:n.lightTextColor,...s.ZD,marginTop:2},onClick:R,disabled:e.disabled,children:(0,_.jsx)("span",{style:{color:n.lightTextColor},children:(0,_.jsx)(l.FormattedMessage,{defaultMessage:"Empty toggle. Click or drop blocks inside.",id:"toggleBlockFormat.emptyBlock.placeholderText"})})}),E=(0,_.jsx)(y.Z,{"aria-describedby":C,"aria-controls":x,isSidebar:!1,open:k,fill:!I,onClick:M,tapArea:t.device.isMobile?{size:30}:void 0}),B=k?(0,_.jsx)(g.Z,{id:x,loaded:T,spinnerSize:"1em",showSpinnerTimeout:500,innerStyle:(0,b.kA)(),style:(0,b.J9)(),children:(0,_.jsx)(h.Z,{store:w,emptyPlaceholder:P?D:void 0,disabled:e.disabled,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag})}):(0,_.jsx)(h.Z,{store:w,disabled:e.disabled,disableContent:!0});return P?(0,_.jsxs)(v.ZP,{style:{paddingLeft:s.ZD.paddingLeft},left:E,leftStyle:{paddingRight:2,...e.toggleStyle},children:[(0,_.jsx)("div",{id:C,style:e.childrenStyleWhenToggleable,children:e.children}),B]}):A?(0,_.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,_.jsx)("div",{style:e.childrenStyleWhenToggleable,children:e.children}),B]}):(0,_.jsx)(_.Fragment,{children:e.children})}},26198:(e,t,n)=>{n.d(t,{Lr:()=>a,jo:()=>l,uf:()=>r});var o=n(67294),i=n(67381);const r={track(e,t){t(!0)},untrack(e){}},a=(0,i.Q)({modernContextDefaultValue:r,displayName:"IFrameManagerContext",legacyContextKey:"iFrameManagerContext"}),s=(a.legacyPropTypes,a.context);function l(){const e=(0,o.useContext)(s),[t,n]=(0,o.useState)(!1),i=(0,o.useRef)(null);return[(0,o.useCallback)((t=>{i.current&&(e.untrack(i.current),i.current=null),t&&(i.current=t,e.track(t,n))}),[e]),t]}},66213:(e,t,n)=>{n.d(t,{LF:()=>i,ZO:()=>a,wK:()=>r});const o=(0,n(67381).Q)({modernContextDefaultValue:void 0,displayName:"OverrideLinkClickContext",legacyContextKey:"overrideLinkClick"}),i=o.Provider,r=o.legacyPropTypes,a=o.context},11368:(e,t,n)=>{n.d(t,{I3:()=>r,Ue:()=>a,zR:()=>i});const o=(0,n(67381).Q)({displayName:"ScrollerContext",legacyContextKey:"scrollerContext",modernContextDefaultValue:void 0}),i=o.Provider,r=o.legacyPropTypes,a=o.context},84064:(e,t,n)=>{n.d(t,{Tf:()=>s,aT:()=>a,ld:()=>l});const o={selectableContainer:void 0,closestSelectable:void 0},i="selectable",r=(0,n(67381).Q)({modernContextDefaultValue:o,displayName:i,legacyContextKey:i}),a=r.context,s=r.legacyPropTypes,l=r.Provider},68350:(e,t,n)=>{n.d(t,{U:()=>i});var o=n(82798);class i{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;this.value=e,this.textInstanceId=t;const n=i.overrides.get(t);n&&e>n&&this.updateOverride()}get(){return i.overrides.get(this.textInstanceId)??this.value}set(e){const t=this.get();(0,o.T)(e>=t),this.value=e,this.updateOverride()}updateOverride(){i.overrides.set(this.textInstanceId,this.value)}static TEST_ONLY__clearOverrides(){this.overrides.clear()}}i.overrides=new Map},78791:(e,t,n)=>{n.d(t,{Cf:()=>f,Wc:()=>g,tE:()=>m});var o=n(41432),i=n(15095),r=n(59730),a=n(70203),s=n(82798),l=n(993),c=n(13447),d=n(65598),u=n(73959),p=n(27105);function m(e){const{transaction:t,targetStore:n,block:o}=e,i=(0,s.TO)(o.getTextSliceTree()),a=(0,u.sQ)(n);if(!a||!p.Ls({store:n,blockStore:a}))throw new r.p8("Previous block should exist and use CRDT");const l=(0,s.TO)(a.getTextSliceTree()).getLastTextSliceTreeInPreOrderTraversal(),d=i.getOperationsForSplitForMerge();(0,s.T)(0===d.textSliceTreesToMove.length,"Root nodes should have no siblings to move"),c.applyCrdtTextOperation({transaction:t,store:o,operation:{command:"splitText",pointer:o.pointer,path:[],args:d.splitOp},invertedOperation:void 0});const m=d.splitOp.textInstanceId,f=d.splitOp.id;c.applyCrdtTextOperation({transaction:t,store:o,operation:{command:"moveTextSlice",pointer:o.pointer,path:[],args:{textInstanceId:m,textSliceStartItemId:f,targetBlockId:a.id,targetTextInstanceId:l.getTextSlice().textInstanceId,targetTextSliceEndItemId:l.getTextSlice().getEndItem().id,isMerge:!0}},invertedOperation:{command:"invertedMoveTextSlice",pointer:o.pointer,path:[],args:{textInstanceId:m,textSliceStartItemId:f,targetTextInstanceId:m,targetTextSliceEndItemId:d.splitOp.id}}})}function f(e){const{environment:t,transaction:n,multiSelection:i,removedBlocks:r,movedBlocks:a,editorMode:c}=e,u=i.start.store;function f(e){if(a.has(e))return;const r=e.getModel();if(null==r||!r.isType(o.wL))return;const d=e.getBlockTitleStore();(0,s.T)(p.FX(d)),d!==i.end.store&&(l.pe({environment:t,transaction:n,selection:{startIndex:0,endIndex:1/0},store:d,editorMode:c}),m({transaction:n,block:e,targetStore:u}))}(0,s.T)(p.FX(u));for(const o of r){f(o);for(const e of(0,d.MI)({blockStore:o,traverseTransclusionReferences:!1}))f(e)}}function g(e){const{sourceBlockStore:t,targetBlockStore:n,splitAtGraphemeIndex:o,transaction:r,moveIntoNewBlock:l}=e;(0,s.T)(t.useCrdt()&&n.useCrdt());const d=t.getBlockTitleStore().getValue(),u=new i.W3(a.eeV(d)).getStringStartIndex(o),p=(0,s.TO)(t.getTextSliceTree()).getOperationsForSplitAtIndex(u);!function(e){const{blockStore:t,splitInfo:n,transaction:o}=e,i=n.textSliceTreesToMove,r="splitWithinNode"===n.type?n.textSliceTreeToSplit:n.newTextSliceTree;for(const a of i){const e=t.id,n=r.getTextSlice().textInstanceId,i=r.getTextSlice().getEndItem().id;c.applyCrdtTextOperation({transaction:o,store:t,operation:{command:"moveTextSlice",pointer:t.pointer,path:[],args:{textInstanceId:a.getTextSlice().textInstanceId,textSliceStartItemId:a.getTextSlice().getStartItem().id,targetBlockId:e,targetTextInstanceId:n,targetTextSliceEndItemId:i}},invertedOperation:void 0})}}({blockStore:t,splitInfo:p,transaction:r}),l?function(e){const{sourceBlockStore:t,targetBlockStore:n,splitInfo:o,transaction:i}=e;if("splitNodeEnd"===o.type){const e=o.newTextSliceTree,r=e.getTextSlice().textInstanceId,a=e.getTextSlice().getStartItem().id,s=o.previousTextSliceTree.getTextSlice();c.applyCrdtTextOperation({transaction:i,store:t,operation:{command:"moveTextSliceIntoBlock",path:[],pointer:t.pointer,args:{textInstanceId:r,textSliceStartItemId:a,targetBlockId:n.id}},invertedOperation:{command:"invertedMoveTextSlice",path:[],pointer:t.pointer,args:{textInstanceId:r,textSliceStartItemId:a,targetTextInstanceId:s.textInstanceId,targetTextSliceEndItemId:s.getEndItem().id}}})}else{const e=o.splitOp,{textInstanceId:r}=e;c.applyCrdtTextOperation({transaction:i,store:t,operation:{command:"splitTextIntoBlock",pointer:t.pointer,path:[],args:{...e,targetBlockId:n.id}},invertedOperation:{command:"invertedMoveTextSlice",pointer:t.pointer,path:[],args:{textInstanceId:r,textSliceStartItemId:e.id,targetTextInstanceId:r,targetTextSliceEndItemId:e.id}}})}}({sourceBlockStore:t,targetBlockStore:n,splitInfo:p,transaction:r}):function(e){const{sourceBlockStore:t,targetBlockStore:n,splitInfo:o,transaction:i}=e;let r,a,l,d;if("splitNodeEnd"===o.type){const e=o.newTextSliceTree;r=e.getTextSlice().textInstanceId,a=e.getTextSlice().getStartItem().id;const t=o.previousTextSliceTree.getTextSlice();l=t.textInstanceId,d=t.getEndItem().id}else c.applyCrdtTextOperation({transaction:i,store:t,operation:{command:"splitText",pointer:t.pointer,path:[],args:o.splitOp},invertedOperation:void 0}),r=o.splitOp.textInstanceId,a=o.splitOp.id,l=o.splitOp.textInstanceId,d=o.splitOp.id;const u=(0,s.TO)(n.getTextSliceTree()).getLastTextSliceTreeInPreOrderTraversal();c.applyCrdtTextOperation({transaction:i,store:t,operation:{command:"moveTextSlice",path:[],pointer:t.pointer,args:{textInstanceId:r,textSliceStartItemId:a,targetBlockId:n.id,targetTextInstanceId:u.getTextSlice().textInstanceId,targetTextSliceEndItemId:u.getTextSlice().getEndItem().id}},invertedOperation:{command:"invertedMoveTextSlice",path:[],pointer:t.pointer,args:{textInstanceId:r,textSliceStartItemId:a,targetTextInstanceId:l,targetTextSliceEndItemId:d}}})}({sourceBlockStore:t,targetBlockStore:n,splitInfo:p,transaction:r})}},21100:(e,t,n)=>{n.d(t,{b:()=>r});var o=n(9953),i=n(993);function r(e){const{environment:t,editorMode:n,store:r,properties:a,transaction:s}=e;"title"in a&&i.sO({environment:t,editorMode:n,store:r.getBlockTitleStore(),value:a.title??void 0,transaction:s});const{title:l,...c}=a;Object.keys(c).length>0&&o.sW({store:r.getPropertiesStore(),data:c,transaction:s})}},27105:(e,t,n)=>{n.d(t,{FX:()=>l,Ls:()=>c,S9:()=>v,SL:()=>g,Sy:()=>f,be:()=>p,dy:()=>m,iG:()=>d,s8:()=>u,tO:()=>y});n(19056);var o=n(59730),i=n(21202),r=n(73959),a=n(77080),s=n(6258);n(68350);function l(e){if(!e.isTable(i.iU))return!1;const t=(0,r.sQ)(e);return!!t&&(t.useCrdt()&&t.getBlockTitleStore()===e)}function c(e){const{store:t,blockStore:n}=e;return n.useCrdt()&&n.getBlockTitleStore()===t}function d(e,t){return e.useCrdt()!==t.some((e=>e.useCrdt()))}function u(e){return e.useCrdt()?"Cannot move a non-CRDT block into a CRDT parent":"Cannot move a CRDT block into a non-CRDT parent"}function p(e){const{parentStore:t,childStore:n}=e,i=t.getRecordStoreAtRootPath(),r=n.getRecordStoreAtRootPath();if(i instanceof s.G&&r instanceof s.G&&d(i,[r]))throw new o.p8("A CRDT block cannot be parented to a non-CRDT block or vice versa!")}function m(e){return h({invertDefault:!1,...e})}function f(e){const{event:t,...n}=e;return h({invertDefault:"click"===(null==t?void 0:t.type)&&"altKey"in t&&t.altKey,...n})}function g(e){const{event:t,...n}=e;return h({invertDefault:"click"===(null==t?void 0:t.type)&&t.altKey,...n})}function h(e){const{invertDefault:t,contextualDefault:n}=e;if(!a.default.checkGate("enable_text_crdt_client"))return!1;const o="source"in e&&(a.default.checkGate("enable_default_create_crdt_page")&&a.default.getConfigKey("default_create_crdt_page_config",e.source))||n;return o&&!t||!o&&t}function v(e){return a.default.checkGate("enable_text_crdt_client")&&a.default.checkGate("enable_default_create_crdt_page")&&a.default.getConfigKey("default_create_crdt_page_config",e)}function b(e){switch(e){case"space-private-pages":return"private";case"collection":return"collection_unknown_view";case"space":return"space";case"team":return"team"}}function y(e){const{event:t,type:n,parentStore:o}=e;return"page"===n?o instanceof s.G&&o.useCrdt():g({event:t,source:b(n)})}},95645:(e,t,n)=>{n.d(t,{Z:()=>f});var o=n(83355),i=n(13991),r=n(31701),a=n(37810),s=n(92650),l=n(46654),c=n(65598),d=n(58202),u=n(6258),p=n(99757);class m extends o.Z{constructor(){super(...arguments),this.renderedType="block",this.getBlockStore=()=>this.props.store,this.canEditComputedStore=this.createComputedStore((()=>{if(this.props.disabled)return!1;if(p.n.state)return!1;const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,l.YF)(e)&&this.props.store.canEdit()})),this.marginCommentsVisible=this.createComputedStore((()=>(0,s.fg)(this.environment,this.props.store))),this.rootStorePageFont=this.createComputedStore((()=>{const e=this.props.store.getRecordStoreUIRoot();if(!(e instanceof u.G))return;const t=e.getFormatStore().getKeyStore("page_font").getValue();return a.Z.getHeaderFontFamily({pageFont:t,locale:i.SP})}))}get registries(){return[d.R]}canEdit(){return this.canEditComputedStore.state}canEditCollection(){if(this.props.disabled)return!1;if(p.n.state)return!1;const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,l.YF)(e)&&this.props.store.canEditCollection()}canComment(){return!this.props.disabled&&(!p.n.state&&this.props.store.canComment())}canAdmin(){return!this.props.disabled&&(!p.n.state&&this.props.store.canAdmin())}canView(){const{store:e}=this.props;return e.canRead()}isRootOrDirectChild(){return this.props.store.isRootOrDirectChild()}renderComponent(){const{store:e}=this.props;if(e)return e?(0,c.SJ)(e)?void 0:this.renderPersisted():void 0}renderPersisted(){}getBlockColorStyle(){const e=this.props.store.getFormat().block_color||"default";return(0,r.fi)(e,this.theme)}}m.displayName="Block";const f=m},24098:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(86628),i=n(26344);function r(e){let{capture:t,render:n}=e;const r=(0,i.Z)(t);return(0,o.VK)((()=>n(r)),[r,n])}},24039:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(67294),i=n(1302),r=n(65686);function a(e){let{children:t,...n}=e;return function(e){let{capture:t,preventType:n}=e;(0,o.useEffect)((()=>{if(t){const e={preventType:n};return i.default.afterNextFlush((()=>{r.Z.state.capturingAreas.add(e),r.Z.emit()})),()=>{i.default.afterNextFlush((()=>{r.Z.state.capturingAreas.delete(e),r.Z.emit()}))}}}),[t,n])}(n),t}},99768:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(86628),i=n(35622);function r(e){let{capture:t,render:n}=e;const r=(0,i.Z)(t);return(0,o.VK)((()=>n(r)),[r,n])}},23586:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(83355),i=n(53965),r=n(85844),a=n(72087);class s extends o.Z{constructor(){super(...arguments),this.debounce=void 0,this.throttle=void 0,this.interval=void 0,this.browserInterval=void 0,this.requestCounter=0,this.storeTypes={requestStore:a.Z},this.handlePageVisibilityChange=()=>{r.Z.state.isVisible?this.interval||this.setRequestInterval():this.clearRequestInterval()},this.performRequest=async()=>new Promise(((e,t)=>{const{requestStore:n}=this.stores,{performRequest:o}=this.props,{request:i}=n.state;this.requestCounter++;const r=this.requestCounter;this.stores.requestStore.setState({...this.stores.requestStore.state,ready:!1,loading:!0}),o(i).then((t=>{this.requestCounter===r&&n.setState({...n.state,error:void 0,result:t,ready:!0,loading:!1}),e()})).catch((e=>{console.error(e),this.requestCounter===r&&n.setState({...n.state,error:e,result:void 0,ready:!0,loading:!1}),t(e)}))})),this.performRequestDebouncedWrapped=()=>{this.stores.requestStore.setState({...this.stores.requestStore.state,ready:!1,loading:!0}),this.performRequestDebounced()},this.performRequestDebounced=this.performRequest}async fetch(){return this.performRequest()}UNSAFE_willMount(e){super.UNSAFE_willMount(e),r.Z.addListener(this.handlePageVisibilityChange)}UNSAFE_willMountOrUpdate(e){super.UNSAFE_willMountOrUpdate(e);const{requestStore:t}=this.stores,{request:n,debounce:o,throttle:r,interval:a}=e;o!==this.debounce&&(this.debounce=o,this.performRequestDebounced=o?i.Ds(this.performRequest,o):this.performRequest),r!==this.throttle&&(this.throttle=r,this.performRequestDebounced=r?i.P2(this.performRequest,r):this.performRequest),a!==this.interval&&(this.interval=a,this.clearRequestInterval(),this.setRequestInterval()),i.Xy(n,t.state.request)||(t.setState({...t.state,request:n}),0!==this.requestCounter||e.performFirstRequestAsync?this.performRequestDebouncedWrapped():this.performRequest()),t.refresh=this.performRequest}willUnmount(){super.willUnmount(),r.Z.removeListener(this.handlePageVisibilityChange),this.clearRequestInterval()}shouldComponentUpdate(e){return!0}renderComponent(){const{requestStore:e}=this.stores,{render:t}=this.props,{error:n,result:o,ready:i}=e.state;return this.handlePageVisibilityChange(),t(n,o,i)}clearRequestInterval(){this.browserInterval&&(clearInterval(this.browserInterval),this.browserInterval=null)}setRequestInterval(){this.props.interval&&(this.browserInterval=setInterval(this.performRequest,this.props.interval))}}s.displayName="Request";const l=s},12457:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(83355),i=n(49085);class r extends o.Z{constructor(){super(...arguments),this.storeTypes={shown:i.default.createClass(!1)},this.showTimerId=void 0,this.hideTimerId=void 0}didMountOrUpdate(){this.props.show?(this.hideTimerId&&clearTimeout(this.hideTimerId),this.hideTimerId=void 0):(this.showTimerId&&clearTimeout(this.showTimerId),this.showTimerId=void 0),!this.props.show||this.stores.shown.state||this.showTimerId?this.props.show||!this.stores.shown.state||this.hideTimerId||(0===this.props.showHold?this.stores.shown.setState(!1):this.setupHideTimer()):0===this.props.showDelay?(this.stores.shown.setState(!0),0!==this.props.showHold&&this.setupHideTimer()):this.showTimerId=window.setTimeout((()=>{this.showTimerId=void 0,this.stores.shown.setState(!0),0!==this.props.showHold&&this.setupHideTimer()}),this.props.showDelay)}renderComponent(){return this.props.render(this.stores.shown.state)}setupHideTimer(){this.hideTimerId=window.setTimeout((()=>{this.hideTimerId=void 0,!this.props.show&&this.stores.shown.state&&this.stores.shown.setState(!1)}),this.props.showHold)}}r.displayName="Throttled";const a=r},28651:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{mouseEntered:!1,mousePressed:!1}}enter(){this.setState({...this.state,mouseEntered:!0})}exit(){this.setState({...this.state,mouseEntered:!1})}}const r=i},17277:(e,t,n)=>{n.d(t,{L:()=>o});const o=(0,n(7032).ZP)()},11059:(e,t,n)=>{n.d(t,{Z:()=>c});n(67294);var o=n(480),i=n(86628),r=n(22377),a=n(60682),s=n(24990),l=n(85893);const c=function(e){let{char:t,size:n,sprite:c}=e;const d=(0,o.O7)(),u=(0,i.VK)((()=>c||(0,a.e_)(d)),[d,c]),p=(0,i.VK)((()=>s.Z.state),[]);return(0,l.jsx)(r.Z,{char:t,size:n,type:u,emojiData:p})}},72187:(e,t,n)=>{n.d(t,{$P:()=>b,FZ:()=>f,II:()=>a,IQ:()=>o,Nm:()=>r,PS:()=>m,T8:()=>l,VJ:()=>v,WB:()=>c,fG:()=>h,jo:()=>u,kX:()=>p,mz:()=>d,pq:()=>s,qJ:()=>y,tg:()=>i,vP:()=>g});const o=12,i=9,r=2,a=12,s=16,l=32,c=24,d=44,u=32,p=356,m=12,f=l*o+2*m,g=9,h=f,v=270,b=10,y=2},60682:(e,t,n)=>{n.d(t,{e_:()=>a,kw:()=>s,sg:()=>l});var o=n(480),i=n(86628),r=n(80444);function a(e){const{device:t}=e;return t.isAndroid&&t.browserVersion.startsWith("73.")&&t.browserName.startsWith("Chrome")||t.isAndroid?"google":t.isWindows||t.isLinux?"twitter":"raw"}function s(){const e=(0,o.O7)();return(0,i.VK)((()=>a(e)),[e])}function l(){var e;return null===(e=r.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.emoji_picker_skin_tone}},24990:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(24502);class r extends o.default{getInitialState(){return{positionalEmojiData:{},emojiByName:{},emojiByCategory:{},emojiByColorRaw:{},emojiByColorProcessed:{}}}async waitUntilLoaded(){await(0,i.M)()}}const a=new r},69783:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},21830:(e,t,n)=>{n.d(t,{XH:()=>y,pz:()=>h,qv:()=>g,vZ:()=>p,zp:()=>f});n(21703);var o=n(37599),i=n(92595),r=n(68626),a=n(9291),s=n(57347),l=n(52629),c=n(37850),d=n(19584),u=n(33929);const p="NotionTransactionTimeout",m=(0,a.defineMessages)({ReloadAllTabs:{defaultMessage:"Try closing and re-opening all Notion tabs or windows. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.errorFixes.reloadAllTabs"},ReloadThisTab:{defaultMessage:"Try reloading Notion. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.errorFixes.reloadThisTab"},AppProfileCorrupted:{defaultMessage:"Notion's local storage may be damaged. See (?) > Help & documentation > Reset Notion. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.errorFixes.helpAndSupportPrompt"},FirefoxProfileCorrupted:{defaultMessage:"Your Firefox profile may be damaged. Visit https://firefox-storage-test.glitch.me/ to diagnose. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.errorFixes.firefoxSettingsDamaged"},ChromeProfileCorrupted:{defaultMessage:"Your Chrome profile may be damaged. If you changed any chrome://flags then please reset them, then restart your browser. If issues persist, try making a new Chrome user. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.errorFixes.chromeSettingsDamaged"},ChromeIndexedDBBucketError:{defaultMessage:"Your Chrome profile may be damaged. For a more consistent experience download the Notion desktop app: https://notion.so/desktop",id:"localDatabase.errorFixes.chromeUpgradeCorruptedSettings"},noDiskSpace:{defaultMessage:"No disk space remaining. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.erroMessages.noDiskSpaceRemaining"},noDiskSpaceBrowserLimit:{defaultMessage:"No disk space remaining. Your browser settings may restrict the storage Notion can use. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.erroMessages.noDiskSpaceRemainingBrowserLimit"}});function f(e){return e}function g(e){return Promise.all(e)}class h{constructor(e,t,n,o){this.databaseName=void 0,this.databaseVersion=void 0,this.debugLogger=new r.BatchedLogger({from:"IndexedDBWrapper",type:"BulkDebug",level:"info",maxLength:100,logToConsole:false}),this.latestTransactionId=0,this.openDbCallbacks=void 0,this.db=void 0,this.getDBPromise=void 0,this.environment=e,this.databaseName=t,this.databaseVersion=n,this.openDbCallbacks=o}async reset(){try{return await(0,o.Lj)(this.databaseName),{value:void 0}}catch(e){return{error:v({environment:this.environment,error:(0,s.t)(e),details:`Failed to reset database ${this.databaseName}`,closed:!1,aborted:!1})}}finally{this.teardown()}}async startTransaction(e,t){const n="startTransaction";let o,i=0;const r=`${e.name}.${this.latestTransactionId++}`;do{try{const s=`${r} attempt #${i+1}`;if(this.debugLogInfo(n,`${s} starting`),o=await this.startTransactionAttempt({...e,name:r},t),!o.error){this.debugLogInfo(n,`${s} succeeded`);break}const l=`${s} errored, type=${o.error.type}`;if(!o.error.closed){this.debugLogInfo(n,`${l}, closed=false`);break}if(this.debugLogInfo(n,`${l}, closed=true`),this.db)try{this.db.close()}catch(a){this.debugLogInfo(n,`db.close() threw ${a}`)}if(this.teardown(),4===i)break;await c.Vs(250)}catch(a){return{error:a}}i++}while(i<5);return o}async startTransactionAttempt(e,t){const{storeNames:n,name:o,mode:i,timeoutMs:a}=e,c=`${o} failed`,d="startTransactionAttempt",u=await this.getDB();if(u.error)return u;const p=u.value,m=[];let f;try{f=p.transaction(n,i);const e=Date.now(),t=window.setTimeout((()=>{const t=Date.now()-e,n=`${o} has not completed after ${t} ms, which may prevent other transactions from running.`;this.debugLogInfo(d,n),r.log({from:"IndexedDBWrapper",type:"LongRunningTransactionWarning",level:"warning",data:{message:n,miscDataToConvertToString:{transactionLog:m}}})}),h.longRunningTimeoutMs);f.addEventListener("complete",(function(){window.clearTimeout(t)}));const a=e=>{e.stopPropagation(),window.clearTimeout(t)};f.addEventListener("error",a),f.addEventListener("abort",a)}catch(b){const e=(0,s.t)(b);return{error:v({environment:this.environment,details:`Failed to create ${i} transaction on ${this.databaseName}.${n}`,error:e,aborted:!0,closed:"InvalidStateError"===e.name})}}const g=await this.runTransaction(f,t,o,a,(e=>{r.pushWithMaxLength(m,e,100)}));if("error"in g||g.abort){this.debugLogInfo(d,`${o} command returned failed/aborted status`);try{f.abort()}catch(y){this.debugLogInfo(d,`transaction.abort() threw ${y}`)}return f.done.catch((e=>{e&&r.log({from:"IndexedDBWrapper",type:"TransactionFailure",level:"error",error:(0,l.Ui)(v({environment:this.environment,details:c,error:e,aborted:!0,closed:!1}))})})),g}if(this.debugLogInfo(d,`${o} command returned successful status`),"readwrite"===i)try{await f.done}catch(y){return{error:v({environment:this.environment,error:(0,s.t)(y),details:`In await transaction.done: ${c}`,aborted:null===y,closed:!1})}}else f.done.catch((e=>{r.log({from:"IndexedDBWrapper",type:"ReadOnlyTransactonFailureIgnored",level:"error",error:(0,l.Ui)(v({environment:this.environment,error:e,details:c,aborted:null===e,closed:!1}))})}));return{value:g.value}}freezeListener(){Boolean(this.db)&&(this.debugLogInfo("freezeListener"),r.log({level:"warning",from:"IndexedDBWrapper",type:"document.freeze",data:{dbName:this.databaseName,dbVersion:this.databaseVersion}}))}teardown(){this.debugLogInfo("teardown"),this.db=void 0,this.getDBPromise=void 0,document.removeEventListener("freeze",this.freezeListener)}debugLogInfo(e,t){this.debugLogger.log({from:"IndexedDBWrapper",level:"info",type:e,data:{message:t}})}async initDB(){try{this.debugLogInfo("initDB","Starting openDB()");const e=await(0,o.X3)(this.databaseName,this.databaseVersion,this.openDbCallbacks);return this.debugLogInfo("initDB","Completed openDB()"),document.addEventListener("freeze",this.freezeListener),e.addEventListener("close",(e=>{r.log({level:"warning",from:"IndexedDBWrapper",type:"db.onclose",data:{dbName:this.databaseName,dbVersion:this.databaseVersion},error:(0,l.Ui)(b(e))}),this.teardown()})),e.addEventListener("abort",(e=>{r.log({level:"warning",from:"IndexedDBWrapper",type:"db.onabort",data:{dbName:this.databaseName,dbVersion:this.databaseVersion}})})),e.addEventListener("error",(e=>{r.log({level:"error",from:"IndexedDBWrapper",type:"db.onerror",data:{dbName:this.databaseName,dbVersion:this.databaseVersion},error:(0,l.Ui)(b(e))})})),e.addEventListener("versionchange",(()=>{r.log({level:"warning",from:"IndexedDBWrapper",type:"db.onversionchange",data:{dbName:this.databaseName,dbVersion:this.databaseVersion}}),e.close(),this.teardown()})),{value:e}}catch(e){return{error:v({environment:this.environment,details:"Unable to initialize database",error:(0,s.t)(e),aborted:!1,closed:!1})}}}async getDB(){let e=this.db;if(!e){this.getDBPromise||(this.getDBPromise=this.initDB().then((e=>(e.error?this.teardown():(this.db=e.value,this.getDBPromise=void 0),e)),(e=>(this.teardown(),{error:{type:"InitDBException",message:"An unexpected error occurred trying to create the database.",details:"Exception in initDB",error:e,closed:!1,aborted:!1}}))));const t=await this.getDBPromise;if(t&&t.error)return t;e=t.value}return{value:e}}async runTransaction(e,t,n,o,i){try{const r=Date.now(),a=t(e,(e=>{this.debugLogInfo("runTransaction",`${n} command: ${e}`),i(e)}));if(void 0!==o&&o>=0){const e=await c.aM(a,o);if(e.timeout){const e=Date.now()-r,t=new Error(`Timeout after ${e}ms: exceeded limit ${o}ms by ${e-o}ms`);throw t.name=p,this.debugLogInfo("runTransaction",`${n} ${t.name}: ${t.message}`),this.debugLogger.flush(),t}return e.result}i("Awaiting commandResultPromise.");const s=await a;return i("Done awaiting commandResultPromise."),s}catch(r){return{error:v({environment:this.environment,error:(0,s.t)(r),details:`In runTransaction catch: ${n} failed`,closed:!1,aborted:!1})}}}}function v(e){const{environment:t,error:n,details:o,closed:i,aborted:r}=e;if(n){if(n.name===p)return{type:p,details:o,message:`Storage operation did not complete. ${u.default.formatMessage(m.ReloadAllTabs)}`,error:n,closed:!1,aborted:!1};if("TimeoutError"===n.name&&"Transaction timed out due to inactivity."===n.message)return{type:"TransactionTimeout",details:o,message:`IndexedDB access attempt timed out. ${u.default.formatMessage(m.ReloadThisTab)}`,error:n,closed:i,aborted:r};if("VersionError"===n.name)return{type:"OutdatedSchemaVersion",details:o,message:`This tab is running an outdated version of Notion. ${u.default.formatMessage(m.ReloadThisTab)}`,error:n,closed:i,aborted:r};if("UnknownError"===n.name&&"Internal error opening backing store for indexedDB.open."===n.message)return{type:"ChromeUnknownInternalError",details:o,message:`Cannot open IndexedDB. ${t.device.isNative?u.default.formatMessage(m.AppProfileCorrupted):u.default.formatMessage(m.ChromeProfileCorrupted)}`,error:n,closed:i,aborted:r};if(t.device.isBrowser&&"UnknownError"===n.name&&"Internal error retrieving bucket data directory."===n.message)return{type:"ChromeUnknownInternalError",details:o,message:u.default.formatMessage(m.ChromeIndexedDBBucketError),error:n,closed:i,aborted:r};if("SecurityError"===n.name&&"IDBFactory.open() called in an invalid security context"===n.message)return{type:"SafariIframeSecurityError",details:o,message:"Cannot access IndexedDB in an iframe in your browser. Try opening Notion in a new window or use a different browser.",error:n,closed:i,aborted:r};if("UnknownError"===n.name&&"Connection to Indexed Database server lost. Refresh the page to try again"===n.message)return{type:"SafariIndexedDatabaseServerLost",details:o,message:`Cannot access IndexedDB due to a bug in Safari/WebKit. ${u.default.formatMessage(m.ReloadThisTab)}`,error:n,closed:i,aborted:r};if("InvalidStateError"===n.name&&"A mutation operation was attempted on a database that did not allow mutations."===n.message)return{type:"FirefoxPrivateBrowsing",details:o,message:"Firefox does not allow IndexedDB in Private Browsing. Try opening Notion in a normal window.",error:n,closed:i,aborted:r};if("NotFoundError"===n.name&&"The operation failed because the requested database object could not be found. For example, an object store did not exist but was being opened."===n.message)return{type:"FirefoxObjectStoreNotFound",details:o,message:`An IndexedDB object store does not exist. ${u.default.formatMessage(m.ReloadAllTabs)} ${u.default.formatMessage(m.FirefoxProfileCorrupted)}`,error:n,closed:!0,aborted:r};if("QuotaExceededError"===n.name){let e=u.default.formatMessage(m.noDiskSpace);return t.device.isBrowser&&(e=u.default.formatMessage(m.noDiskSpaceBrowserLimit)),{type:"QuotaFull",details:o,message:e,error:n,closed:i,aborted:r}}if(window.navigator.userAgent.includes("WindowsWechat")&&"AbortError"===n.name&&"Version change transaction was aborted in upgradeneeded event handler."===n.message)return{type:"UnsupportedWechat",details:o,message:"This device or application is unsupported.",error:n,closed:i,aborted:r}}return{type:"UnknownIndexedDBError",details:o,message:`An unknown IndexedDB error occurred. ${u.default.formatMessage(m.ReloadThisTab)}`,error:n||new Error("createIndexedDBError: error was falsy"),closed:i,aborted:r}}function b(e){if(e&&e.target&&"error"in e.target){const t=e.target.error;if(!t)return;return`${t.name}: ${t.message}`}}function y(e,t){if(e.stack)return e;try{const n=new Error(`${e.message} (${t})`);throw n.name=e.name,n}catch(n){return e.stack=(0,s.t)(n).stack,e}}h.longRunningTimeoutMs=5*d.hM,(0,i.exposeDebugValue)("idbUnwrap",o.Wg)},3932:(e,t,n)=>{n.d(t,{Y:()=>r});var o=n(45953),i=n(7032);class r{constructor(e){this.id=(0,i.ZP)(),this.spaceId=void 0,this.userId=void 0,this.committed=!1,this.isLocal=!1,this.useSudoMode=void 0,this.deadlockWarningTimeout=void 0,this.operations=[],this.stores=[],this.initialRecordMap=o.PF.create(),this.invertedOperations=[],this.postPerformAssertions=[],this.preEnqueueActions=[],this.postEnqueueActions=[],this.postSubmitCallbacks=[],this.postCancelCallbacks=[],this.userAction=void 0,this.userFlow=void 0,this.tags=void 0;const{spaceId:t,userId:n,deadlockTimeoutMs:r,onDeadlockWarning:a}=e;t&&n&&(this.spaceId=t,this.userId=n),a&&(this.deadlockWarningTimeout=window.setTimeout(a,r))}isEmpty(){return 0===this.operations.length}annotateWithUserAction(e){this.userAction=e}getUserActionForAnalyticsPurposesOnly(){return this.userAction}annotateWithUserFlow(e){this.userFlow=e}getUserFlowForAnalyticsPurposesOnly(){return this.userFlow}annotateWithDebugTag(e){this.tags||(this.tags=new Set),this.tags.add(e)}copyDebugTagsFrom(e){if(e.tags)for(const t of e.tags)this.annotateWithDebugTag(t)}getDebugTagsForAnalyticsPurposesOnly(){if(this.tags)return Array.from(this.tags)}cancelDeadlockWarning(){void 0!==this.deadlockWarningTimeout&&(window.clearTimeout(this.deadlockWarningTimeout),this.deadlockWarningTimeout=void 0)}done(e){this.cancelDeadlockWarning();for(const t of this.postSubmitCallbacks)t(e)}}},2414:(e,t,n)=>{n.d(t,{h:()=>i});var o=n(37850);class i{constructor(e){this.SCALE=1.5,this.MAX=15,this.waitable=new o.a6,this.failures=0,this.observer=e}getDelay(e){return Math.min(this.MAX,Math.pow(this.SCALE,e))}reset(){var e;this.waitable.trigger(),this.waitable=new o.a6,this.failures=0,null===(e=this.observer)||void 0===e||e.onReset()}async backOffOnFailure(e,t){var n;const i=this.failures;this.failures++;const r=e*this.getDelay(i)-e;null===(n=this.observer)||void 0===n||n.onBackoff(r,t),await this.waitable.wait(e,r),this.waitable=new o.a6}getFailures(){return this.failures}}},63037:(e,t,n)=>{n.d(t,{CE:()=>s,Os:()=>i,Ud:()=>r,V_:()=>a,xd:()=>l});var o=n(19584);function i(e,t){t.startsWith("offline -")?t="offline":t.startsWith("mobileNativeError -")&&(t="mobileNativeError");const n=e[t]||0;e[t]=n+1,e._total+=1}const r=1*o.C0,a=.5*o.C0,s=10*o.C0,l=5*o.C0},68204:(e,t,n)=>{n.d(t,{E$:()=>s,L1:()=>c,RP:()=>l,sG:()=>a,vG:()=>d});n(57658);var o=n(58573),i=n(53965);const r=25;function a(e){const{sections:t,context:n,query:a}=e;let s=a.trim().toLowerCase();if(s.startsWith("/")&&(s=s.slice(1)),!s)return c(t,n);const l=function(e){return e.map((e=>({...e,actions:e.actions.map((t=>{const n=t.searchName||t.displayName||"",o=[n,e.searchTitle||e.title||"",n].join(" ");return{...t,searchName:o}}))})))}(c(function(e,t){const n=[];for(const o of e){const e={...o,actions:[]};for(const i of o.actions)if(i.subActions){if(i.collapseSubActionsIntoParent){for(const n of i.subActions(t))for(const t of n.actions)e.actions.push(t);continue}const r=i.subActions(t).map((e=>({...e,key:`${o.key} ${i.key} ${e.key}`,title:e.title||i.displayName,searchTitle:[i.searchName||i.displayName,e.searchTitle||e.title].filter(Boolean).join(" ")})));for(const e of r)n.push(e)}else e.actions.push(i);e.actions.length&&n.push(e)}return n}(t,n),n)),d=[],u=new Map;for(const o of l)for(const e of o.actions)u.set(e,o),d.push(e);const p=(0,o.ZP)(s,d,(e=>e.searchName||""),{minThreshold:r,getSortScore:e=>-e.score*(e.original.sortScoreMultiplier??1)}),m=new Set(p),f=d.filter((e=>Boolean(e.alwaysShowInSearch)&&!m.has(e))),g=f.filter((e=>"start"===e.alwaysShowInSearch)),h=f.filter((e=>"end"===e.alwaysShowInSearch)),v=i.vM([...g,...p,...h],(e=>{const t=u.get(e);if(t)return t.title})),b=[];for(const o of Object.keys(v)){const e=v[o],t=u.get(e[0]);t&&b.push({...t,actions:e})}return b}function s(e,t){if(!t)return e;let n=0;const o=[];for(const i of e){if(n>=t)break;const e=i.actions.slice(0,t-n);e.length>0&&(n+=e.length,o.push({...i,actions:e}))}return o}function l(e,t){const n=[];for(const o of e){const e=o.actions.filter(t);e.length>0&&n.push({...o,actions:e})}return n}function c(e,t){return l(e,(e=>d(e,t)))}function d(e,t){if(e.validators){return e.validators.every((e=>e(t)))}return!0}},19037:(e,t,n)=>{n.d(t,{S4z:()=>cn,xDy:()=>he,AKv:()=>wn,j2U:()=>Cn,XQy:()=>pt,Eok:()=>ut,v_H:()=>In,wFS:()=>it,rol:()=>at,WCc:()=>bn,sRS:()=>Yt,O4s:()=>Qt,_Jj:()=>rn,cWe:()=>Jt,nWT:()=>Re,zzA:()=>Pe,RFc:()=>Ae,U4I:()=>Kt,Jji:()=>go,U_8:()=>Ie,eot:()=>xe,OOI:()=>Dn,J5S:()=>ke,k5s:()=>Ce,iBZ:()=>fo,KEd:()=>we,MaU:()=>Se,NWv:()=>Ut,vyP:()=>Lt,Zk8:()=>An,ITt:()=>mt,FSO:()=>qe,YBx:()=>dt,iJI:()=>Vt,TKz:()=>Zt,IC9:()=>ao,Zuh:()=>ho,xks:()=>Oe,NZn:()=>Fe,ryx:()=>Be,KbU:()=>Mn,Jlb:()=>Pn,Khw:()=>jt,T29:()=>Nt,lrK:()=>co,OTA:()=>Hn,W3A:()=>$n,p4X:()=>Gn,zOn:()=>Yn,l$5:()=>Xe,OOd:()=>$e,z22:()=>Kn,EJd:()=>Qn,W5_:()=>qn,y9X:()=>kn,iKo:()=>ln,_Tt:()=>Ct,lA5:()=>He,b47:()=>Ke,DtP:()=>yt,k6d:()=>On,CJE:()=>Xt,UI7:()=>an,W2t:()=>Je,fy9:()=>Xn,EYw:()=>Ne,xwj:()=>At,YGm:()=>Et,f7f:()=>Rt,dM3:()=>Ot,p5B:()=>ro,zX6:()=>tt,YO6:()=>_n,OOv:()=>sn,Vfv:()=>We,uY7:()=>gn,VBw:()=>Ye,P5O:()=>oo,muB:()=>ot,FYR:()=>nt,DaG:()=>Wt,ROK:()=>Tn,daU:()=>ft,ar_:()=>gt,VcC:()=>so,Rrp:()=>et,QLY:()=>lt,K5G:()=>Te,LHu:()=>Me,$H4:()=>Ge,J8b:()=>ct,MpE:()=>un,Mgm:()=>Ft,nJQ:()=>$t,gnQ:()=>bt,US8:()=>Wn,Vc5:()=>Dt,KJz:()=>yn,NnH:()=>pn,vjj:()=>Bt,OXD:()=>lo,ESL:()=>ze,OPg:()=>je,wTx:()=>Bn,GzT:()=>st,szW:()=>_e,HBU:()=>io,p1d:()=>Ue,b1c:()=>en,jlf:()=>Tt,V5r:()=>vt,Cjo:()=>Qe,Iay:()=>xn,tqC:()=>St,Fxc:()=>_t,_z:()=>Le,ECq:()=>ye,q4$:()=>vn,tYA:()=>kt,DFt:()=>fn,_Tv:()=>Sn,KHO:()=>Gt,vdd:()=>tn,YZb:()=>It,Id2:()=>Nn,$I3:()=>Pt,lvA:()=>dn,vM3:()=>Jn,Ggh:()=>Mt,FXl:()=>Ze,hrD:()=>xt,Mnk:()=>wt,ATo:()=>uo,lPL:()=>mo,Xa0:()=>De,FOc:()=>po,_nA:()=>zn,U7o:()=>be,j61:()=>vo,plk:()=>eo,c2G:()=>Ee,STD:()=>bo,$cr:()=>Fn,P99:()=>rt,EDF:()=>ht,OFQ:()=>Un,YPq:()=>Vn,urk:()=>Ln,Rd2:()=>jn,tJc:()=>Zn,DUX:()=>zt,ffD:()=>ve,or:()=>ge,Txk:()=>mn,eMw:()=>Rn,uqO:()=>En,cFU:()=>hn,jp9:()=>no,KSG:()=>to,QYD:()=>qt,KLp:()=>Ht,zl0:()=>on});var o=n(41432),i=n(50475),r=n(80951),a=n(42509),s=n(43593),l=n(74181),c=n(87479),d=n(72141);const u=["TypeScript","JavaScript","GraphQL","HTML","CSS","Scss","JSON","XML","Rust"];var p=n(21202),m=n(6287),f=n(70279),g=n(75246),h=n(29369),v=n(90965),b=n(64684),y=n(70203),_=n(53965),S=n(19584),w=n(10906),k=n(95477),I=n(69783),C=n(28020),x=n(78429),T=n(75770),M=n(85957),P=n(46654),A=n(18514),R=n(95697),D=n(53824),E=n(94841),B=n(58202),F=n(81844),O=n(40134),Z=n(44534),V=n(63208),U=n(80444),L=n(16772),j=n(88632),N=n(807),z=n(24042),q=n(64233),W=n(77080),H=n(19111),K=n(88923),G=n(83212),$=n(81236),Q=n(6258),Y=(n(49557),n(55320)),J=n(27724),X=n(10743),ee=n(99757),te=n(24666),ne=n(35057),oe=n(49117),ie=n(77181),re=n(11599),ae=n(92783),se=n(68056),le=n(35026),ce=n(98165),de=n(59139),ue=n(28187),pe=n(48779),me=n(89086),fe=n(85644);function ge(e){return t=>e.some((e=>e(t)))}function he(e){return t=>e.every((e=>e(t)))}function ve(e){return t=>!e(t)}function be(e){return e.blocks&&1===e.blocks.length}function ye(e){return e.blocks&&e.blocks.length>1}function _e(e){return!!(0,x.H)()&&e.blocks.every((e=>{const t=e.getParentId(),n=e.recordStoreUIParentStore,o=null==n?void 0:n.id;return t&&o&&t!==o}))}function Se(e){return e.blocks.every((t=>{const n=t.recordStoreUIParentStore;if(!n)return!1;const o=e.publicEditMode?e.publicEditMode:(0,ce.n3)(n)&&G.Z.getMode(e.environment,n);return!P.YF(o)&&n.canEdit()}))}function we(e){const{environment:t}=e;return e.blocks.every((e=>P.KE({environment:t,block:e})))}function ke(e){return!ee.n.state&&e.blocks.every((t=>"suggest"!==N.Z.getMode(t)&&(!P.YF(e.publicEditMode)&&t.canEdit())))}function Ie(e){return!ee.n.state&&e.blocks.every((t=>{if(P.YF(e.publicEditMode))return!1;const n=re.$0();return n?n.canEditCollection():t.canEdit()}))}function Ce(e){return!ee.n.state&&e.blocks.every((t=>!P.YF(e.publicEditMode)&&(t.isCollectionView()?t.canEditCollection():t.canEdit())))}function xe(e){let{environment:t,publicEditMode:n,blocks:o}=e;if(ee.n.state)return!1;const{id:i}=t.currentUser;return!!i&&(!P.YF(n)&&o.every((e=>{const n=(0,P.WE)({userId:i,store:e}).filter((t=>{let{type:n,role:o}=t;if(!o)return!1;const i=e.isCollectionView()||e.isTemplate()?d.D7(o):d.J5(o);return"public_permission"!==n&&i}));return n.length>0&&P.KE({environment:t,block:e})})))}function Te(e){if(e.blocks&&1===e.blocks.length){const[n]=e.blocks;if(n.isCollectionView()){var t;const e=null===(t=n.getCollectionViewCollectionStore())||void 0===t?void 0:t.getValue();if(e)return(0,a.Gq)(e)||(0,a.Ev)(e)||(0,a.OY)(e)}}return!1}function Me(e){if(e.blocks&&1===e.blocks.length){const[n]=e.blocks;if(n.isCollectionView()){var t;const e=null===(t=n.getCollectionViewCollectionStore())||void 0===t?void 0:t.getValue();if(e)return(0,a.Ev)(e)}}return!1}function Pe(e){return!ee.n.state&&e.blocks.every((e=>e.canAdmin()))}function Ae(e){return!ee.n.state&&e.blocks.every((e=>e.canComment()))}function Re(e){return e.blocks.some((e=>Boolean(B.R.findBlockFromStoreWithMethod(e,"activate"))))}function De(e){return e.blocks.every((e=>e.isRestricted()))}function Ee(e){const{currentSpaceStore:t}=U.default.state,{currentUser:n}=e.environment;return void 0!==n.id&&Boolean(null==t?void 0:t.getSpaceUserStore(n.id).isWorkspaceOwner())}function Be(){const e=C.np();return!e||!e.isLocked()}function Fe(){const e=C.np(),t=W.default.checkGate("prevent_edits_trash");return!e||(!t||!e.pathIsDead())}function Oe(){return Ve(C.np())}function Ze(e){return e.blocks.some((e=>Ve(e)))}function Ve(e){if(!e)return!1;return!!e.getAssociatedCollectionStore()}function Ue(e){return e.blocks.length>0&&e.blocks.some((e=>e.isLocked()))}function Le(e){return e.blocks.length>0}function je(e){return e.blocks.some((e=>{const t=C.np();return!!(t&&t.isNonEditableState()&&t.uiContains(e)&&t!==e)}))}function Ne(e){return!!W.default.checkGate("prevent_edits_trash")&&e.blocks.some((e=>{const t=e.getModel();if(!t)return!1;const n=t.getParentTable();if(n!==m.vF)return!1;const o={id:t.parent_id,table:n,spaceId:t.space_id};return Q.NW.createChildStore(e,o).isNonEditableState()}))}function ze(e){return e.blocks.some((e=>{const{mainEditorCurrentBlockStore:t}=U.default.state;return Boolean(t&&t.isCollectionView()&&t.isNonEditableState()&&t.uiContains(e)&&t!==e)}))}function qe(e){return e.blocks.every((e=>{const t=e.getType();return Boolean(t&&(0,o.XD)(t)&&!(0,o.S9)(t))}))}function We(e){var t;const n=null===(t=U.default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.id;if(e.blocks[0]){const t=e.blocks[0].getType(),i=e.blocks[0].id;return Boolean(t&&i===n&&(0,o.XD)(t))}return!1}function He(e){return e.blocks.every((e=>{const t=e.getRecordStoreUIParent();return Boolean(t&&e.isDefined()&&e.getParentId()!==t.id)}))}function Ke(e){return e.blocks.every((e=>{const t=e.getRecordStoreUIParent();return Boolean(t&&t.canEdit()&&e.isDefined()&&e.getParentId()!==t.id)}))}function Ge(e){if(e.blocks){const t=e.blocks[0];return Boolean(t&&t.isDefined()&&t.getType()===o.Ti.file&&t.getProperties().source)}return!1}function $e(e){if(!e.blocks)return!1;const t=e.blocks[0],n=t&&t.getProperties().source;if(!n)return!1;const o=r.zB(n);return!!o&&s.E$(o,[k.default.secureFileS3.url,k.default.secureFileS3V2.url])}function Qe(e){if(e.blocks){const t=e.blocks[0];if(t.isType(o.Ok))return Boolean(t.getProperties())}return!1}function Ye(e){if(e.blocks){const t=e.blocks[0],n=t&&t.getType();return Boolean(n&&(0,o.VB)(n))}return!1}function Je(e){if(e.blocks){const t=e.blocks[0].getModel();return Boolean(null==t?void 0:t.isType(o.oe))}return!1}function Xe(e){return t=>{if(t.blocks){const n=t.blocks[0];return Boolean(n&&n.getProperties()[e])}return!1}}Xe("source");function et(e){if(!be(e))return!1;const t=e.blocks&&e.blocks[0];if(t){const e=t.getType();return Boolean(e&&(0,o.XD)(e)&&t.isEmptyTitle())}return!1}function tt(e){if(e.blocks){const t=e.blocks[0],n=null==t?void 0:t.getModel();return Boolean(null==n?void 0:n.isType(o.f4))}return!1}function nt(e){if(e.blocks){const t=e.blocks[0];if(t.pathIsDead()&&W.default.checkGate("prevent_edits_trash"))return!1;if(t&&t.getType()===o.Ti.transclusionReference){const e=t.getTransclusionReferenceTargetStore();return Boolean(e&&e.canEdit())}return!1}return!1}function ot(e){if(e.blocks){const t=e.blocks[0];return(!t.pathIsDead()||!W.default.checkGate("prevent_edits_trash"))&&t.getType()===o.Ti.transclusionContainer}return!1}function it(e){return e.blocks.every((e=>{const t=e.getModel(),n=e.getRecordStoreUIParent();return Boolean(t&&t.isType(o.Zi)&&t.getType()!==o.Ti.transclusionContainer&&e.getParentTable()!==m.vF&&n&&n.id===e.getParentId())}))}function rt(e){return t=>t.blocks&&t.blocks[0]&&_.mf(t.blocks[0].getType)&&t.blocks[0].getType()===e}function at(e){return t=>_.yW(t.blocks,(t=>t&&_.mf(t.getType)&&t.getType()===e))}function st(e){const t=e.blocks[0],{language:n}=t.getProperties(),o=(0,y.QaF)(n);return u.includes(o)}function lt(e){return()=>W.default.checkGate(e)}function ct(e){return t=>{if(1!==t.blocks.length)return!1;const n=t.blocks[0],o=n.getParentBlockStore(),i=null==o?void 0:o.getContentStores(),r=null==i?void 0:i.map((t=>t.getType()===e));if(!r||0===(null==r?void 0:r.length))return!1;const a=null==i?void 0:i.map((e=>e.id)).indexOf(n.id);return void 0!==a&&(0===a||!r[a-1])}}function dt(e){return e.blocks.every((e=>{const t=null==e?void 0:e.getModel();return Boolean((null==t?void 0:t.isType(o.Zj))&&e.getParentTable()!==m.vF)}))}function ut(e){const t=C.RM();return!!t&&e.blocks.every((e=>t.uiContains(e)&&t.id!==e.id))}function pt(e){const t=e.blocks[0],n=null==t?void 0:t.getRecordStoreUIRoot();return!!n&&e.blocks.every((e=>n.uiContains(e)&&n.id!==e.id))}function mt(e){return e.blocks.every((e=>{const t=B.R.findBlockFromStoreWithMethod(e,"canRenderFullScreen");return Boolean(t&&t.canRenderFullScreen())}))}function ft(e){let{environment:{device:t}}=e;return t.isElectron}function gt(){return Boolean(z.Z.state.isElectronHandlingZoom)}function ht(e){let{environment:{device:t}}=e;return t.isWindows}function vt(e){let{environment:{device:t}}=e;return t.isMac}function bt(e){let{environment:{device:t}}=e;return t.isIOS}function yt(e){let{environment:{device:t}}=e;return t.isAndroid}function _t(e){let{environment:{device:t}}=e;return t.isMobileNative}function St(e){let{environment:{device:t}}=e;return t.isMobile}function wt(e){let{environment:{device:t}}=e;return t.isPhone}function kt(e){let{environment:{device:t}}=e;return t.isNative}function It(e){let{environment:{device:t}}=e;return!t.isMobile}function Ct(){return k.default.isAdminMode}function xt(){const e=C.np();return(0,E.WE)(e)}function Tt(e){let{environment:t}=e;return Boolean(t.currentUser.isLoggedIn()||t.publicDomainUserId)}function Mt(){return j.Z.state.online}function Pt(e){return!e.blocks.every((t=>{const n=t.inMemoryRecordCache===e.environment.defaultRecordCache.inMemoryRecordCache,o=t.inMemoryRecordCache.cacheFallbacks.has(e.environment.defaultRecordCache.inMemoryRecordCache);return n||o}))}function At(e){return e.blocks.some((e=>e.isTemplate()))}function Rt(e){return e.blocks.some((e=>e.isCollectionViewPageWithContent()))}function Dt(e){return e.blocks.every((()=>!function(){const e=C.np();return null==e?void 0:e.isCollectionViewPageWithContent()}()||Cn("page",!1)(e)))}function Et(e){if(e.blocks&&1===e.blocks.length){const[t]=e.blocks;return t.isCollectionView()}return!1}function Bt(e){if(e.blocks&&1===e.blocks.length){const[t]=e.blocks;return t.isType(o.Ti.collectionView)}return!1}function Ft(e){if(e.blocks&&1===e.blocks.length){const[t]=e.blocks;return t.isType(o.Ti.collectionViewPage)}return!1}function Ot(e){return t=>{if(t.blocks&&1===t.blocks.length){const[n]=t.blocks,o=B.R.findCollectionViewBlockFromStore(n);return!!o&&o.collectionContextStore.getViewType()===e}return!1}}function Zt(e){if(e.blocks&&1===e.blocks.length){const[t]=e.blocks;return 1===t.getCollectionViewStores().length}return!1}function Vt(e){if(e.blocks&&1===e.blocks.length){const[t]=e.blocks,n=t.getCollectionViewCollectionStore();if(!n)return!1;const o=n.getSchema();return Object.values(o).map((e=>null==e?void 0:e.type)).every((e=>e&&Z.g$.isPropertyTypeConvertableToSimpleTable[e]))}return!0}function Ut(e){return A.NW(e.environment)}function Lt(e){return A.vy(e.environment)}function jt(){return q.Z.state.open}function Nt(){return I.Z.state.open}function zt(){return H.Z.state.open}function qt(){return X.Z.state.open}function Wt(){return"editing"===te.default.state.mode}function Ht(){return"empty"!==te.default.state.mode&&!(0,se.iG)(te.default.state.multiSelection)}function Kt(){return!((0,me.J6)(y.GKr.User)||(0,me.J6)(y.GKr.Bot)||(0,me.J6)(y.GKr.Date)||(0,me.J6)(y.GKr.Page))}function Gt(){return J.default.state.stores.length>0}function $t(e){const t=U.default.state.currentSpaceStore;return(0,pe.Cx)(t)}function Qt(e){return e.blocks.every((e=>Boolean(F.Z.findOutlinerItemFromStore(e))))}function Yt(e){return e.blocks.every((e=>{const t=F.Z.findOutlinerItemFromStore(e);return Boolean(t&&t.isTopLevelItem&&"bookmarks"===t.type)}))}function Jt(e){return e.blocks.every((e=>{const t=F.Z.findOutlinerItemFromStore(e);return Boolean(t&&t.isTopLevelItem&&"shared"===t.type)}))}function Xt(e){const t=e.blocks[0];if(!t)return!1;const n=t.getParentBlockStore();return!!n&&n.isNonEditableState()}function en(e){return!tn(e)}function tn(e){if(!(0,R.bq)())return!0;const t=e.blocks[0];if(t){if(t.getParentTable()===h.e0){const n=(0,ce.VP)(t);if(!n||!(0,le.si)({teamStore:n,environment:e.environment}))return!1}}return!0}function nn(e){if(!e)return;const t=e.getParentPointer(),n=e.getRecordStoreUIParent();return(null==t?void 0:t.table)===h.e0&&n?Q.zX.createChildStore(n,t):nn(e.getParentBlockStore())}function on(e){const{id:t}=e.environment.currentUser;return!!t&&e.blocks.every((e=>{const n=e.getPermissionItems();return(0,c.ws)(n,t)}))}function rn(e){return e.blocks.every((e=>{const t=F.Z.findOutlinerItemFromStore(e);return Boolean(t&&t.isTopLevelItem)}))}function an(e){const{currentSpaceViewStore:t}=U.default.state,n=e.blocks[0];return Boolean(t&&n&&(0,ae.Z)({spaceViewStore:t,pageId:n.id}))}function sn(e){const t=C.np();return e.blocks[0]&&e.blocks[0]===t}function ln(e){return e.blocks.every((t=>Boolean(P.IJ(e.environment,t))))}function cn(e){return e.blocks.every((e=>P.S4(e)))}function dn(e){return Boolean(U.default.state.mainEditorCurrentBlockStore)}function un(e){const t=e.environment.RouterStore.state.route;return Boolean("chat"===t.name)}function pn(e){return M.Tx()&&e.blocks[0]&&e.blocks[0]===K.default.peekTarget.state}function mn(e){return M.Tx()}function fn(e){return e.blocks.every((e=>{const t=null==e?void 0:e.getType();return Boolean(t&&(0,o.S9)(t))}))}function gn(e){return e.blocks.some((e=>e.pathIsDead()))}function hn(e){const t=e.blocks[0];return!!t&&(!!k.default.isAdminMode||!!t.canEdit()&&!e.environment.device.isMobile)}function vn(e){return 1===e.blocks.length&&(0,C.qG)(e.blocks[0].id)}function bn(e){return!e.blocks.some((e=>{const t=null==e?void 0:e.getSystemBlockTypeStore().getValue();return(0,i.u7)(t)}))}function yn(e){var t;if(1!==e.blocks.length)return!1;const n=e.blocks[0],o=w.fm(n),i=null==o||null===(t=o.collectionViewBlockStore())||void 0===t?void 0:t.id;return!(!o||!i)&&Boolean(C.qG(i)&&o.isCompactView.state)}function _n(e){return e.blocks.some((e=>{e.useCrdt()}))}function Sn(e){return e.blocks.every((e=>{const t=e.getType(),n=e.getFormat();return Boolean(t&&(0,o._T)(t,n))}))}function wn(e){return e.blocks.every((e=>Boolean(e.findRecordStoreUIAncestor((e=>e instanceof Q.Xr||e instanceof Q.G&&e.isCollectionView())).ancestor)))}function kn(e){let{blocks:t}=e;return t.length>0&&(0,ie.bX)(t[0])}function In(e){let{blocks:t}=e;return w.v_(t)}function Cn(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return n=>n.blocks.every((n=>{const o=w.fm(n,t),i=null==o?void 0:o.collectionViewStore();return(null==i?void 0:i.getType())===e}))}function xn(){const{currentSpaceStore:e}=U.default.state;return Boolean(e&&e.canRead())}function Tn(){const{currentSpaceStore:e}=U.default.state;return Boolean(e&&e.canEdit())}function Mn(e){if(k.default.isAdminMode)return!0;if(e.blocks.some((e=>{const t=(0,O.B)({blockId:e.id,setting:"disableExport"});return Boolean(null==t?void 0:t.disabled)})))return!1;if($t()&&!Pe(e))return!1;const t=function(e){let{environment:t}=e;const{currentSpaceStore:n}=U.default.state;if(!n)return!1;const o=$.Z.getData(t,{spaceId:n.id});return n.isDefined()?!n.getDisableExport():o?!o.disableExport:Ct()}(e),{environment:n,blocks:o}=e;return o.every((e=>{const o=(0,ce.VP)(e);return o?(!n.currentUser.id||!(0,b.s8)({team:{membership:o.getRawMembership()},userId:n.currentUser.id}))&&!o.getDisableExport():t}))}function Pn(){const{currentSpaceStore:e}=U.default.state;return!!e&&!e.getDisableMoveToSpace()}function An(e){return!ee.n.state&&(!!e.blocks.every((e=>e.canEdit()))&&!!ln(e))}function Rn(e){return e.blocks.every((t=>{var n;return"edit"===(null===(n=G.Z.getMode(e.environment,t))||void 0===n?void 0:n.permission)}))}function Dn(e){if(!Se(e))return!1;const t=e.blocks.filter((e=>{const t=e.recordStoreUIParentStore,n=e.getParentStore();return t&&n&&t.id===n.id}));return 0===t.length||ke({...e,blocks:t})}function En(e){let{environment:t}=e;const n=(0,C.k_)(t).state;return Boolean(n&&n.showSharedOverflowButton)}function Bn(e){let{blocks:t}=e;return t.some((e=>Boolean(e.findRecordStoreUIAncestor((e=>e instanceof Q.G&&e.isTransclusionType())).ancestor)))}function Fn(e){let{environment:t}=e;return"on"===W.default.getGroup("lucy-in-the-sky-with-tab-blocks")}function On(e){let{blocks:t}=e;if(!t||0===t.length)return!1;const n=t[0].getType(),i=t[0].getFormat();return Boolean(i.block_width)&&!Boolean(i.block_page_width)&&!Boolean(i.block_full_width)&&Boolean(n&&(0,o._7)(n))}function Zn(e){var t;let{blocks:n}=e;return Boolean(null===(t=(0,ue.Jk)(n[0]))||void 0===t||null===(t=t.slackIntegrationStore)||void 0===t?void 0:t.isReady())}function Vn(){var e;const{currentSpaceStore:t}=U.default.state,n=null==t||null===(e=t.getBotSettingsStore())||void 0===e?void 0:e.getValue();return!(0,v.CJ)(n)||Boolean((null==n?void 0:n.integration_approval_statuses)&&n.integration_approval_statuses[l.T0])}function Un(e){var t;let{blocks:n}=e;const{slackIntegrationStore:o}=(0,ue.Jk)(n[0]);return Boolean(o.isReady()&&!(null!=o&&null!==(t=o.getKeyStore("enabled"))&&void 0!==t&&t.getValue()))}function Ln(e){var t;let{blocks:n}=e;const{blockStore:o,slackIntegrationStore:i}=(0,ue.Jk)(n[0]);return Boolean(i.isReady()&&(null==i||null===(t=i.getKeyStore("enabled"))||void 0===t?void 0:t.getValue())&&o.id!==n[0].id)}function jn(e){var t;let{blocks:n}=e;const{blockStore:o,slackIntegrationStore:i}=(0,ue.Jk)(n[0]);return Boolean(i.isReady()&&(null==i||null===(t=i.getKeyStore("enabled"))||void 0===t?void 0:t.getValue())&&o.id===n[0].id)}function Nn(e){var t;let{blocks:n}=e;return(null===(t=n[0])||void 0===t?void 0:t.getSpaceId())!==g.N3}function zn(e){return 1===e.blocks.length&&e.blocks[0].getType()===o.Ti.table}function qn(e){const t=V.Z.state;return t.isActive&&1===e.blocks.length&&e.blocks[0]===t.simpleTableStore}function Wn(e){let{blocks:t}=e;return t.some((e=>Boolean(e.isImmediateColumnChild())))}function Hn(e){const t=V.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n}=t;return Z.g$.getNumberOfColumns(n)>1}function Kn(e){const t=V.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:o}=t,i=0===o.start.row&&o.end.row===Z.g$.getNumberOfRows(n)-1,r=0<=o.start.col&&o.start.col<=o.end.col&&o.start.col<=Z.g$.getNumberOfColumns(n)-1;return"column"===o.type&&r&&i}function Gn(e){const t=V.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:o}=t,i=0===o.start.row&&o.end.row===Z.g$.getNumberOfRows(n)-1,r=0===o.start.col&&0===o.end.col;return"column"===o.type&&r&&i}function $n(e){const t=V.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n}=t;return Z.g$.getNumberOfRows(n)>1}function Qn(e){const t=V.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:o}=t,i=0===o.start.col&&o.end.col===Z.g$.getNumberOfColumns(n)-1,r=0<=o.start.row&&o.start.row<=o.end.row&&o.start.row<=Z.g$.getNumberOfRows(n)-1;return"row"===o.type&&r&&i}function Yn(e){const t=V.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:o}=t,i=0===o.start.col&&o.end.col===Z.g$.getNumberOfColumns(n)-1,r=0===o.start.row&&0===o.end.row;return"row"===o.type&&r&&i}function Jn(e){let{environment:t}=e;return(0,ne.QM)()}function Xn(e){if(1!==e.blocks.length)return!1;const t=e.blocks[0].getParentStore();return!(!t||t.table!==p.iU)&&t.isType(o.Ti.tab)}function eo(e){const t=e.blocks[0];return Boolean(t&&t.isCollectionView()&&t.getCollectionViewSourceCollectionStore())}function to(e){if(!be(e))return!1;const t=e.blocks[0];return(0,fe.z)(t)}function no(e){return function(e){let{environment:t,blocks:n}=e;if(!(0,R.bq)())return!1;if(!T.lQ({environment:t,blocks:n}))return!1;const o=t.currentUser.id,{currentSpaceStore:i}=U.default.state;if(!o||null==i||!i.isDefined())return!1;if(!R.Xq({environment:t,spaceStore:i}))return!1;for(const a of n){var r;if(!a.isPageBlock())return!1;if("team"!==(null===(r=F.Z.findOutlinerItemFromStore(a))||void 0===r?void 0:r.type))return!1;const e=nn(a);if(null==e||!e.isOwner(o))return!1}return!0}(e)&&It(e)}function oo(){const{currentSpaceStore:e}=U.default.state,t=null==e?void 0:e.getBotSettingsStore().getValue();return!(0,v.CJ)(t)||Boolean((null==t?void 0:t.integration_approval_statuses)&&t.integration_approval_statuses[l._o])}function io(e){return Boolean(e.blocks[0].getFormat().is_placeholder)}function ro(e){var t;return Boolean((null===(t=e.blocks[0].getFormat().alias_pointer)||void 0===t?void 0:t.table)===f.x_)}function ao(){const e=C.np();if(!e||!e.hasContent())return!1;if(1===e.getContentLength()){const t=e.getContentStores()[0].getTitleStore();if(X.Z.state.open&&X.Z.state.textStore===t)return!1;if(L.default.isEditingEmptyBlock())return!1}return!0}function so(){return Boolean(z.Z.state.isElectronUsingCommandNumber)}function lo(e){return e.blocks.some(oe.td)}function co(e){return e.blocks.every((e=>{const t=null==e?void 0:e.getModel();return Boolean(null==t?void 0:t.isType(o.Nn))}))}function uo(){return Y.default.state.open}function po(e){return(0,de.rd)(e.environment)}function mo(e){const{environment:t}=e,{device:n}=t,o="quickSearch"===t.RouterStore.state.route.name;return n.isElectron&&o}function fo(e){return e.blocks.some((e=>{const t=e.getAssociatedCollectionStore();return!(!t||t.isPageTreeCollection())&&t.canEditCollection()}))}function go(e){const t=e.blocks[0];return t.isType("image")&&(0,D.f)(t.getOriginalImageSource())}function ho(){const e=C.np();return"page"===(null==e?void 0:e.getType())}function vo(e){return 1===e.blocks.length&&e.blocks[0].isDictatableBlock()}function bo(e){const t=e.blocks[0];return t.isType("copy_indicator")&&Date.now()-t.getCreatedTime()>S.A0}},97978:(e,t,n)=>{n.d(t,{NM:()=>he,ls:()=>Ze,mc:()=>Se,Cd:()=>We,of:()=>Te,Ts:()=>Ae,eR:()=>Re,cG:()=>Le,TA:()=>Ce,nZ:()=>Oe,nB:()=>qe,oT:()=>Ve,fK:()=>fe,$A:()=>ge,Jq:()=>ve,pH:()=>Ee,Ug:()=>ze,ci:()=>He,j:()=>_e,UG:()=>Ie,lu:()=>ke,kB:()=>xe,oP:()=>ye,Zf:()=>be});var o=n(1302),i=n(82496),r=n(72933),a=n(1898);const s="v2";function l(e){let t=[];if(e.length>0){if(t=e.filter((e=>{let{code:t}=e;return(0,r.Qh)(t)})),0===t.length)return"en-US";const n=t[0].quality,o=t.filter((e=>{let{quality:t}=e;return t===n}));let i=o.find((e=>"en"===e.code));return i||(i=o[0]),function(e){let t=(0,a.qg)(r.vi,e.code)?r.vi[e.code]:r.vi.en;return"es"===e.code?t="ES"===e.region?"es-ES":"es-LA":"zh"===e.code&&(t="TW"===e.region||"HK"===e.region?"zh-TW":"zh-CN"),t}(i)}return"en-US"}function c(e){const t=function(e){return l(i.parse(e))}(e);return`${s}/${t}`}var d=n(15145),u=n(53504),p=n(33728),m=n(55632),f=n(68626),g=n(15157),h=n(9852),v=n(47425),b=n(64684),y=n(7250),_=n(53965),S=n(76870),w=n(7032),k=n(18265),I=n(54642),C=(n(95477),n(28020)),x=n(33929),T=n(75538),M=n(12252),P=n(58455),A=n(80444),R=n(77080),D=n(88893),E=n(88280),B=(n(57658),n(93214));const F="not_defined";let O=function(e){return e.BASE_SPACE_DATA="base_space_data",e.SPACE_MEMBER_DATA="space_member_data",e.SPACE_NONMEMBER_DATA="space_nonmember_data",e.SPACE_DATA_NOT_LOADED="space_data_not_loaded",e}({});var Z=n(72141),V=n(62992),U=n(73123),L=n(37850),j=n(98165),N=n(85957),z=n(51),q=n(88923),W=n(81236),H=n(6258),K=n(87956),G=n(35057),$=n(99334),Q=n(12955),Y=n(74503),J=n(57491);const X="__mobileNativeSessionInfo";var ee=n(46654),te=n(48779);async function ne(e,t,n){const o=await Te(e),{preboot:i,dontWait:r}=n||{};r||i||await async function(e){e.currentUser.isLoggedIn()&&A.default.state.mainEditorCurrentBlockStore&&(await A.default.waitUntil((()=>Boolean(A.default.state.mainEditorCurrentBlockStore&&A.default.state.mainEditorCurrentBlockStore.isReady))),A.default.state.currentSpaceStore&&await E.subscriptionDataStoreInstance.waitUntilLoaded());P.default.shouldRefresh(e.currentUser.id)&&await Ee(e)}(e);const a=r?void 0:await le(e),s=Re(),{currentUserStore:l,currentSpaceStore:c}=A.default.state,d=(0,J.getMobileNativeDeviceInfo)(),u=window[X]??{},p=await(0,Y.getDesktopDeviceInfo)(),m=await async function(e,t){const n=await(0,Q.hasPermissionForThirdPartyService)("amplitude",e),o=(0,B.l$)(t);return{is_user_consent_to_track:n,tid:o}}(e,t),f=(null==a?void 0:a.space_id)||void 0;return{data:{...ae(),...o,...a,...re(),...Ae(),...se(),...ie(),...oe({userId:null==l?void 0:l.id,spaceId:null==c?void 0:c.id}),...p,...d,...u,...s,...m,...ue(),...(g={spaceId:f,userId:Ve(),deviceId:o.device_id,eventName:t},{unique_event_marker:de(g)})},spaceId:null==a?void 0:a.space_id};var g}function oe(e){const{userId:t,spaceId:n}=e;if(!t||!n)return;const o=We({userId:t,spaceId:n});return o?{notion_session_id:o.id,notion_session_start_ts:o.sessionStartTime,tab_id:(0,h.c$)(),tab_count:(0,$.K)()}:void 0}function ie(){const e=K.Z.state;if(e)return{queryId:e.queryId}}function re(){const e=q.default.state,t=N.mH(),n=C.np();if(n){const o=ee.YO(n).map((e=>{let{permissionItem:t}=e;return t})),i=o.find((e=>"public_permission"===e.type)),r=o.find((e=>"space_permission"===e.type)),s=o.filter((e=>"user_permission"===e.type&&(0,Z.rz)(e.role))),l=o.filter((e=>"user_permission"===e.type&&(0,Z.J5)(e.role))),c=function(e){const t=j.uJ(e),n=[],o=_.xH(t.map((e=>{if(e instanceof H.zX)return;const t=e.getCopiedFromPointer();return t&&V.J(t)&&n.push(t.id),n})).filter(a.$K));return o}(n),d=Boolean(c)&&c.length>0,u=e.open?void 0:A.default.state.currentCollectionViewStore,{publicPageData:p}=z.Z.state,m=n.getCopiedFromPointer();let f;return f=o.some(Z.gG)?"deleted_from_trash":n.pathIsDead()?"in_trash":"live",{page_id:n.id,page_public_role:i?i.role:F,page_space_role:r?r.role:F,page_all_collaborator_count:l.length+s.length,page_editor_collaborator_count:l.length,page_read_only_collaborator_count:s.length,page_content_count:n.getContentLength(),page_current_user_role:n.getRole(),page_is_peek:t,page_copied_from:m?(0,w.F9)(m.id):void 0,page_is_notion_template:!!m&&V.J(m),page_is_template:n.isTemplate(),page_is_prepopulated:d,page_prepopulated_template_ids:c,page_is_database:n.isCollectionView(),page_view_type:u?u.getType():void 0,page_user_has_explicit_access:p?p.userHasExplicitAccess:F,page_deletion_status:f}}}function ae(){const{currentSpaceViewStore:e}=A.default.state;return e&&e.isDefined()?{notify_desktop:e.getNotifyDesktop(),notify_email:e.getNotifyEmail(),notify_mobile:e.getNotifyMobile(),notify_email_digest:e.getNotifyEmailDigest()}:{}}function se(){const{mainEditorCurrentBlockStore:e}=A.default.state;if(e){const t=j.VP(e);if(t)return{team_id:(0,w.cj)(t.id)}}return{}}async function le(e){var t;await(0,L.OI)(2e3,Promise.all([E.subscriptionDataStoreInstance.waitUntilLoaded(),z.Z.waitUntilLoaded()]));const n=E.subscriptionDataStoreInstance.state,{currentUserStore:o,currentSpaceStore:i}=A.default.state,{publicPageData:r}=z.Z.state,a=(0,C.zj)(),s=a?(0,w.F9)(a):void 0,{mainEditorCurrentBlockStore:l}=A.default.state,c=null!=i&&i.isDefined()?{id:null==i?void 0:i.id,settings:null==i?void 0:i.getSettings(),email_domains:null==i?void 0:i.getEmailDomains(),plan_type:null==i?void 0:i.getPlanType(),initial_use_cases:null==i?void 0:i.getInitialUseCases(),invite_link_enabled:null==i?void 0:i.getInviteLinkEnabled(),created_by_id:null==i?void 0:i.getCreatedById(),created_time:i.getCreatedTime()}:void 0,d=(null==i?void 0:i.id)||(null==r?void 0:r.spaceId)||(null==l?void 0:l.getSpaceId()),u=Boolean(null==c||null===(t=c.settings)||void 0===t?void 0:t.is_teams_enabled),{currentUserRootStore:p}=A.default.state,m=p&&p.isReady()?_.jj(p.getSpaceViewStores().map((e=>e.getSpaceId()))).length:void 0;if(d&&o&&i&&n){const t=W.Z.getData(e,{spaceId:d}),o=D.YK(n),r=D.CM(n).length||0,a=D.su(n),l=D.lk(n),p=n.hasPaidNonzero,f=t?t.domain:void 0,g=c&&c.email_domains?c.email_domains:void 0,h=D.zl(e,n),v=(0,te.Ib)(t),b=(0,te.ww)(t),y=_.hj(h)&&!Number.isNaN(h)&&h!==1/0?h:0;return{space_analytics_data_type:O.SPACE_MEMBER_DATA,subscription_tier:(0,G.zt)(),page_id:s,space_id:(0,w.F9)(d),space_is_subscribed:o,space_visible_total:r,space_visible_members:a,space_visible_guests:l,space_visible_members_bucketized:(0,U.aT)(a),space_block_usage:D.Lz(e,n),space_block_usage_over_limit:D.Ln(e,n),space_role:i.getRole(),space_block_usage_percent:y,space_timeline_view_usage:D._9(n)?n.timelineViewUsage:void 0,space_created_time:v,available_credit:0,space_domain:f,space_email_domains:g,space_has_paid_nonzero:p,space_plan_type:b,space_initial_use_cases:c?c.initial_use_cases:void 0,space_invite_link_enabled:null==c?void 0:c.invite_link_enabled,space_created_by:null!=c&&c.created_by_id?(0,w.F9)(c.created_by_id):void 0,teams_is_enabled:u,current_space_view_count:m}}if(r){const t=r.spaceId?W.Z.getData(e,{spaceId:r.spaceId}):void 0,n=(0,te.Ib)(t),o=(0,te.ww)(t);return{space_analytics_data_type:O.SPACE_NONMEMBER_DATA,space_id:d?(0,w.F9)(d):void 0,space_domain:r.spaceDomain,page_id:s,subscription_tier:(0,G.zt)(),space_created_time:n,space_plan_type:o,space_invite_link_enabled:null==c?void 0:c.invite_link_enabled,space_created_by:null!=c&&c.created_by_id?(0,w.F9)(c.created_by_id):void 0,teams_is_enabled:u,current_space_view_count:m}}return c?{space_analytics_data_type:O.BASE_SPACE_DATA,space_id:(0,w.F9)(c.id),space_created_time:c.created_time,space_plan_type:c.plan_type,space_invite_link_enabled:c.invite_link_enabled,space_created_by:c.created_by_id?(0,w.F9)(c.created_by_id):void 0,teams_is_enabled:u,current_space_view_count:m}:{space_analytics_data_type:O.SPACE_DATA_NOT_LOADED,space_id:null!=i&&i.id?(0,w.F9)(null==i?void 0:i.id):void 0,current_space_view_count:m}}const ce={};function de(e){const{spaceId:t,userId:n,deviceId:o,eventName:i}=e,r=(0,w.Ul)(`${t}:${n}:${o}:${i}`),a=ce[r],s=Date.now();if(!a)return ce[r]=s,!0;const l=new Date(a),c=new Date(s);return l.getUTCDate()!==c.getUTCDate()?(ce[r]=s,!0):void 0}function ue(){let e;return R.default.state.isLoaded&&(e=R.default.getStatsigExperimentsMap()),{experiments:e,experimentStoreLoaded:R.default.state.isLoaded}}var pe=n(36867);const me=18e5;async function fe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=P.default.verboseAnalytics;if(await m.fK({traits:e}),t)for(const n of e)console.log("track:%c identify","font-weight: bold;",n)}async function ge(e){const{environment:t,userId:n,traits:o,skipIntercom:i}=e,r=P.default.shouldRefresh(n)?await Ee(t):P.default.state,a=function(e){const t=Re();if(!t.user_id)return;const{user_id:n,email:o,name:i,...r}=e;return{...r,user_id:t.user_id,email:t.email,name:t.name}}(o);if(!a)return void f.rateLimitedLog({level:"warning",from:"analyticsHelpers",type:"noCleanAnalyticsUser"});const s=(0,w.F9)(a.user_id);if(!i){var l;const e=x.default.getIntl(),t=null===(l=A.default.state.currentUserStore)||void 0===l?void 0:l.getFullName(e);y.$A({userId:s,userName:t,traits:a,settings:r})}if(null!=r&&r.isLoggingEnabled){const e=C.VU().map(w.F9),n=await le(t),o=await Te(t),i=await async function(e){if(await(0,Q.hasPermissionForThirdPartyService)("mutiny",e)){const t="mutiny.user.token",n=await(0,Q.getCookie)(e,t)||window.localStorage.getItem(t);if(n)return{mutinyVisitorId:n}}return{}}(t),{accept_language_raw:r,accept_language_preference:l}=o,c=(0,u.Z)({accept_language_raw:r,accept_language_preference:l},"ignore-class-instances"),d={...o,...i,space_has_paid_nonzero:!(!n||!("space_has_paid_nonzero"in n))&&n.space_has_paid_nonzero,integrations:{All:!0}},p={...a,user_email:a.email,...c,...d};m.$A({userId:s,traits:p,spaceIds:e})}P.default.verboseAnalytics&&console.log("identify:",JSON.stringify(o))}async function he(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P.default.verboseAnalytics;await m.HX(),e&&console.log("deidentify user")}async function ve(e){const t=await le(e);if(P.default.state.isIntercomEnabled){const e=await async function(e){const{currentUserRootStore:t,currentUserStore:n}=A.default.state;if(n&&t&&e){await Promise.all([t.load(),n.load()]);const o=t.getSpaceViewStores();await Promise.all(o.map((e=>e.load())));const i=_.oA(o.map((e=>e.getSpaceStore())));return await Promise.all(i.map((e=>e.load()))),_.oA(i.map((t=>{const o=t.isDefined()?{id:t.id,plan_type:t.getPlanType(),beta_enabled:t.getBetaEnabled()}:void 0;if(o){const i=(0,w.F9)(o.id);if(i===e.space_id){const i=E.subscriptionDataStoreInstance.state,r=D.XX(i),a={id:e.space_id,name:Fe(n,o.plan_type),size:(0,te.jv)(t).length,is_subscribed:"space_is_subscribed"in e&&e.space_is_subscribed,is_beta:Boolean(o.beta_enabled)};return r&&(a.plan=r.plan),"space_data_not_loaded"!==e.space_analytics_data_type&&e.space_created_time&&(a.company_created_at=e.space_created_time),a}return{id:i,name:Fe(n,o.plan_type),size:(0,te.jv)(t).length}}})))}return[]}(t);y.Jq({companiesData:e})}t&&P.default.state.isLoggingEnabled&&m.Jq({spaceId:t.space_id,spaceData:t})}async function be(e,t){if(!e.currentUser.id)return;const n=(0,w.F9)(e.currentUser.id);return ge({environment:e,userId:n,traits:{...t,user_id:n},skipIntercom:!0})}async function ye(e,t,n){const{eventName:o,eventProperties:i}=t;await _e(e,o,i,n)}async function _e(e,t,n,o){try{const r=P.default.verboseAnalytics;0;const{data:a,spaceId:s}=await ne(e,t,o);!function(e,t,n){if(!n)return;for(const[o,i]of Object.entries(n))t[o]!==i&&f.log({level:"info",from:"analyticsHelpers",type:"forceOverrideMismatch",data:{eventName:e,miscDataToConvertToString:{forceOverrideKey:o,forceOverrideValue:i,autoTrackedValue:t[o]}}})}(t,a,null==o?void 0:o.forceOverrideAutomaticEventData);const l=(0,u.Z)(_.Xh({...n,...a,...null==o?void 0:o.forceOverrideAutomaticEventData}),"ignore-class-instances");y.j({eventName:t,eventData:l});const c={eventName:t,eventData:{...d.ni(l),__context:{locale:a.preferred_locale,page:{referrer:window.document.referrer,search:window.location.search}},sharedUUID:(0,w.ZP)()},spaceId:s};var i;if(m.j(c),r&&console.log(`track:%c ${t}`,"font-weight: bold;",n),e.device.isMobileNative&&R.default.checkGate("debug_analytics"))null===(i=e.mobileNative)||void 0===i||i.debugLog(`ðŸ¦ analytic event: ${t} | ${JSON.stringify(n)}`)}catch(r){f.log({level:"error",from:"analyticsHelpers",type:"track",data:{eventName:t,miscDataToConvertToString:{e:r}}})}}function Se(e){return{trackEvent:t=>{_e(e,t.eventName,t.properties)}}}const we={};function ke(e,t,n,o,i,r){const a=we[n],s=Date.now();return(!a||s-a>1e3*o)&&(we[n]=s,_e(e,t,i,r),!0)}function Ie(e,t,n,o){(0,S.lB)(n)&&_e(e,t,o)}async function Ce(e,t){await o.default.afterNextFlush();const n=R.default.getConfigKey("event_trail_events",e);if("object"==typeof n&&"number"==typeof n.sampleRate)return(0,S.aw)(n.sampleRate);if("number"==typeof(null==t?void 0:t.defaultSampleRateOverride))return(0,S.aw)(t.defaultSampleRateOverride);const i=R.default.getConfigKey("event_trail_events","defaultSampleRate");return"number"==typeof i?(0,S.aw)(i):!(null==t||!t.shouldSendIfStatsigNotInitialized)}async function xe(e){const{environment:t,eventName:n,eventProperties:o,options:i}=e;if(await Ce(n,i))return _e(t,n,o,i)}async function Te(e){var t,n,o,i;const{device:r,RouterStore:a}=e,s=null===(t=a.getState())||void 0===t||null===(t=t.route)||void 0===t?void 0:t.name,l=await Le(e),{pathname:c,...d}=(0,k.nx)(null===(n=document.location)||void 0===n?void 0:n.href,(0,h.x6)())||{},{width:u,height:p}=e.WindowSizeStore.state,m={app_version:r.version,desktop_app_version:r.desktopAppVersion,mobile_app_version:r.mobileAppVersion,is_desktop_app_or_browser:!r.isMobile,is_desktop:r.isElectron,is_mobile:r.isMobile,is_tablet:r.isTablet,is_react_native:r.isMobileNative,is_ios:r.isIOS,is_logged_in:Ue(e),deviceType:r.os,device_type:r.deviceType,device_os:r.os,platform:r.platform,browser:r.browserName,browser_version:r.browserVersion,browser_version_bucketized:Pe(r.browserVersion,r.browserName),dnt:r.doNotTrackEnabled,device_id:l&&(0,w.F9)(l),tags:(0,h.mM)(),host:null===(o=document.location)||void 0===o?void 0:o.host,route_name:s,notion_top_level_domain:null===(i=document.location)||void 0===i||null===(i=i.host)||void 0===i||null===(i=i.split(".notion."))||void 0===i?void 0:i[1],referrer:document.referrer||"none",accept_language_raw:je(),accept_language_preference:Ne(),...d,windowWidth:u,windowHeight:p,isActive:M.Z.state.active,is_foreground:document.hasFocus(),fired_during_onboarding:T.default.state.isOnboarding};return{..._.GM(m,_.o8),appSource:"client"}}const Me=new Set(["Safari","Mobile Safari"]);function Pe(e,t){const n=e.split(".");return Me.has(t)?n.slice(0,2).join("."):n[0]}function Ae(){const{currentUserSettingsStore:e}=A.default.state;if(e&&e.isDefined()){let n={};const o=e.getSettings();return o&&(n={user_persona:o.persona,user_source:o.source,user_use_case:o.use_case,time_zone:o.time_zone,time_zone_region:"string"==typeof o.time_zone?(t=o.time_zone,"N/A"===t?t:t.split("/")[0]):void 0,locale:o.locale,preferred_locale:o.preferred_locale,signup_time:o.signup_time,used_desktop_web_app:o.used_desktop_web_app,used_mobile_web_app:o.used_mobile_web_app,used_mac_app:o.used_mac_app,used_windows_app:o.used_windows_app,used_ios_app:o.used_ios_app,used_android_app:o.used_android_app,user_session_count:(0,pe.g)(e.id)}),_.GM(n,_.o8)}var t}function Re(){const e={user_id:Ve(),user_email:P.default.state.user_email,email:P.default.state.user_email,name:P.default.state.user_name};return _.GM(e,_.o8)}const De=new Map;async function Ee(e){const t=e.currentUser.id;if(t){if(!De.has(t)){const n=Be(e,{loggedIn:!0});De.set(t,n),n.then((()=>{De.delete(t)})).catch((e=>{throw De.delete(t),e}))}return De.get(t)}return Be(e,{loggedIn:!1})}async function Be(e,t){t.loggedIn&&await A.default.waitUntilRendered();const n=await I.getUserAnalyticsSettings(e,{});if("success"!==n.type)return void f.log({level:"warning",from:"analyticsHelpers",type:"fetchAnalyticsSettings",data:{miscDataToConvertToString:{response:n}}});const o=n.data;return P.default.setState(o),o}function Fe(e,t){const n=e.getEmail();return n&&"team"===t?(0,p.Gd)(n):n||void 0}function Oe(e){return e.map((e=>(0,te.cD)(e))).filter(a.lm).some((e=>v.QM(e)))}function Ze(e){const t=e.map((e=>(0,te.cD)(e))),n=new Set(_.oA(t));return n.has("enterprise")?"enterprise":n.has("business")?"business":n.has("plus")?"plus":n.has("personal")?"personal_pro":n.has("team_free")?"team_free":n.has("personal_free")?"personal_free":n.has("free")?"free":"none"}function Ve(){const e=P.default.state.user_id;return e?(0,w.F9)(e):void 0}function Ue(e){const t=function(e){var t;return(null==e||null===(t=e.currentUser)||void 0===t?void 0:t.id)||e.publicDomainUserId}(e);return Boolean(t)}async function Le(e){const t=await(0,Q.getBrowserId)(e);return t&&(0,w.F9)(t)}function je(){return R.default.getAcceptLanguageHeader()}function Ne(){return c(je()||"")}function ze(){return"on"===R.default.getEligibleGroup({experimentId:"zendesk",defaultGroup:"unassigned"})}function qe(e){var t;const n=e.id,o=e.isDefined()?{membership:e.getMembers(),settings:e.getSettingsStore().getValue(),is_default:e.isDefault(),description:e.getDescription(),icon:e.getIcon(),team_pages:e.getTeamPagesStore().getValue()}:void 0;if(!o||!o.settings)return{team_id:(0,w.cj)(n),no_team_value:!0};const i=o.membership||[];return{team_id:(0,w.cj)(n),team_current_size:i.length,team_current_num_users:i.filter((e=>"user"===e.entity_type)).length,team_current_num_groups:i.filter((e=>"group"===e.entity_type)).length,team_access_level:(0,b.B5)(o.settings),team_is_default:o.is_default,team_has_description:Boolean(o.description),team_has_icon:Boolean(o.icon),team_top_pages:(null===(t=o.team_pages)||void 0===t?void 0:t.length)??0}}function We(e){const t=g.Z.get({userId:e.userId,key:`${e.spaceId}:analytics_session`});if(!(t&&Date.now()-t.lastFocusedTime>me))return t}function He(e){g.Z.set({userId:e.userId,key:`${e.spaceId}:analytics_session`,value:e.session})}},28020:(e,t,n)=>{n.d(t,{AK:()=>xe,B7:()=>ie,CP:()=>ye,Fv:()=>ee,JE:()=>Se,RF:()=>ae,RM:()=>re,VU:()=>ke,VV:()=>we,Xb:()=>pe,YO:()=>se,Zy:()=>Te,_H:()=>oe,_u:()=>me,h1:()=>de,hq:()=>fe,k_:()=>ge,kw:()=>he,np:()=>te,o:()=>Ie,p5:()=>Me,qG:()=>le,qQ:()=>_e,rq:()=>Pe,tu:()=>ue,ui:()=>be,wU:()=>Ce,yn:()=>ve,zj:()=>ne});var o=n(14577),i=n(41432),r=n(53877),a=n(72141),s=n(99405),l=(n(21202),n(23867)),c=n(19889),d=n(53965),u=n(10906),p=n(95477),m=n(53323),f=n(50627),g=n(94841),h=n(49427),v=n(34859),b=n(51),y=n(80444),_=n(80641),S=n(33784),w=n(55367),k=n(64233),I=n(69316),C=n(21051),x=n(3418),T=n(42653),M=n(94416),P=n(48863),A=n(22294),R=n(19111),D=n(53730),E=n(19671),B=n(13023),F=n(88923),O=n(6258),Z=n(69784),V=n(13105),U=n(82187),L=n(55320),j=n(27724),N=n(10743),z=n(24666),q=n(16194),W=n(56203),H=n(35026),K=n(85957),G=n(46654),$=n(65598),Q=n(18514),Y=n(77546),J=n(48779),X=n(95697);function ee(){if(y.default.state.mainEditorCurrentBlockStore)return{id:y.default.state.mainEditorCurrentBlockStore.id,spaceId:(0,l.C)(y.default.state.mainEditorCurrentBlockStore.pointer.spaceId)}}function te(){const e=F.default.state,t=K.mH();return e.open&&t?e.target:y.default.state.mainEditorCurrentBlockStore}function ne(){if(y.default.state.mainEditorCurrentBlockStore)return y.default.state.mainEditorCurrentBlockStore.id}function oe(){return K.Tx()?B.Z:E.Z}function ie(e){let t;return y.default.state.currentUserStore?t=y.default.state.currentUserStore:e.currentUser.id&&(t=new O.U6(e,{table:c.KJ,id:e.currentUser.id})),t}function re(){const e=j.default.getCurrentRootStore();if(e&&e instanceof O.G)return e}function ae(){const e=j.default.getCurrentRootStore();if(e&&e instanceof O.G)return e;const{currentSpaceStore:t}=y.default.state;return t||void 0}function se(e){return!e&&(0,g.WE)(y.default.state.mainEditorCurrentBlockStore)}function le(e){return"myTasks"===(0,g.G)({blockOrCollectionId:e})}const ce=new V.P({debugName:"getAppRenderState",memoizeRecursion:!0,deepEquals:!1,compute:function(e){var t;const{mainEditorCurrentBlockStore:n,initialized:o}=y.default.state,i=e.currentUser.isLoggedIn(),r=e.RouterStore.state.route,l=Boolean(n&&n.canRead()&&n.isDefined()),c=Boolean(n&&n.canEdit()&&n.isDefined()),d=Boolean(n&&(0,$.Oh)(n)),u=n&&l&&(0,G.IJ)(e,n),p=Boolean(u),m=u&&(0,a.J5)(u.permissionItem.role),f=c&&!m,h=(null==n||null===(t=n.getModel())||void 0===t?void 0:t.isNonverifiedContentClassification())&&!(n&&_.Z.bypassedPage(n.id))&&!f,{publicPageData:v}=b.Z.state,S=!o||!d,w=Boolean(n&&n.isReady()&&!l),k=(0,g.WE)(n),I=Boolean((0,s.HK)(r)&&(!(0,s.wO)(r)&&!n||w&&!k||h||(null==v?void 0:v.requireInterstitial)||(null==v?void 0:v.requireLogin)&&!i)),C=w&&k;return{shouldShowSidebar:function(){if((0,Q.Sr)(e))return Boolean(null==v?void 0:v.template);const t="quickSearch"===r.name;return Boolean(!t&&!I&&i&&(S||(0,s.wO)(r)||l&&(c&&!p||d&&!p)&&!h&&!(null!=v&&v.requireInterstitial)))}(),shouldShowFrame:!I,shouldShowError:I,shouldRedirectFromHome:C}}});function de(e){return ce.getStateFor(e)}const ue=new o.Z((()=>{const{mainEditorCurrentBlockStore:e}=y.default.state,t=e&&e.isCollectionView();return A.Z.state.isKeyboardMode&&!q.Z.state&&!U.Z.isActive()&&!t&&!L.default.state.open&&!M.Z.state.open&&!I.Z.state.open&&!(0,m.n)()&&0===C.Z.state.banners.length}),{debugName:"appHelpers.shouldHideTopbarStore"});function pe(e){const{currentSpaceViewStore:t}=y.default.state;if(t){return d.G0(t.getWorkspacePages(),(0,J.KA)(e,t),t.getPrivatePages(e)).filter((e=>e.isNavigableBlock()))}return[]}function me(e){const{currentSpaceViewStore:t}=y.default.state;return t?d.mN([...t.getBookmarkedPages(),...t.getWorkspacePages(),...(0,J.KA)(e,t),...t.getPrivatePages(e)],"id"):[]}function fe(e){return e.getType()===i.Ti.copyIndicator&&!D.transactionQueue.isPendingTransactionForRecord(e.pointer)}const ge=d.HP((e=>new o.Z((()=>function(e){const{currentSpaceStore:t,currentSpaceViewStore:n,currentUserRootStore:o,currentUserSettingsStore:i}=y.default.state;if(!(n&&o&&t&&i))return;const r=(0,H._v)(e),a=(0,J.jv)(t),s=n.getBookmarkedPages(),l=n.getWorkspacePages(),c=n.getTeamsStores(),{allPagesStores:d,visiblePagesStores:u}=(0,J._o)({environment:e,spaceViewStore:n,userSettingsStore:i,type:"shared"}).state,{allPagesStores:p,visiblePagesStores:m}=(0,J._o)({environment:e,spaceViewStore:n,userSettingsStore:i,type:"private"}).state,f=n.getPrivatePages(e),g=(0,J.Cx)(t),h=1===a.length&&0===l.length&&"personal"===t.getPlanType(),v=s.length>0,b=!g&&!(0,X.bq)()&&l.length>0,_=d.length>0,S=i.hasUserPinnedToOutliner({spaceId:t.id,type:"shared"}),w=(0,X.bq)();return{isGuest:g,isPersonalSpace:h,showBookmarksSection:v,showWorkspaceSection:b,showSharedSection:_,showPrivateSection:!g,showOnlyPrivateSection:!(v||b||_||w),showSharedOverflowButton:d.length>J.G$||S,showPrivateOverflowButton:r&&p.length>J.G$,stickTemplateItemsToBottom:s.length+d.length+l.length+f.length>=8,allSharedPagesStores:d,allPrivatePagesStores:p,visibleSharedPagesStores:u,visiblePrivatePagesStores:m,showTeamSection:w,userJoinedTeamsStores:c}}(e)),{useDeepEqual:!0,debugName:"sidebarStateStore"}))),he=new o.Z((()=>A.Z.state.isKeyboardMode||Z.default.state.isActive||w.ZP.state.isDragging||N.Z.state.open||R.Z.state.open||k.Z.state.open||P.Z.state.open||x.Z.hasOpenMouseCapturePopup()||E.Z.state.isOpen&&!F.default.isCenterPeekOpen()||B.Z.state.isOpen||S.Z.state.open||T.Z.state.isPinned||W.Z.state.isHovered),{debugName:"menuIsOpenStore"}),ve=new o.Z((()=>{const{currentSpaceViewStore:e,currentUserStore:t}=y.default.state,n=new Set;if(!e||!t)return n;for(const o of e.getTeamsStores()){o.isMemberOrGuest(t.id)&&n.add(o.id)}return n}),{useDeepEqual:!0,debugName:"userTeamsInCurrentSpace"});function be(e){return e.device.isPhone?24:96}function ye(e){return be(e)}function _e(e){const t=j.default.getCurrentDefaultContainer(),n=f.zL-2*be(e);if(t){const e=h.Z.find((e=>e.props.store===t.props.store));if(e){const t=e.getContentInnerWidth();if(t)return Math.min(n,t)}}return n}function Se(){const e=te(),t=z.default.state;if("editing"!==t.mode)return!1;const n=t.multiSelection.start.store;return e&&e.id===n.id&&n.path.includes("title")||!1}function we(){const e=z.default.state;if("editing"!==e.mode)return!1;const t=e.multiSelection.start.store,n="collection"===t.table;return t.path.includes("name")&&n||!1}function ke(){const{currentUserRootStore:e}=y.default.state;if(e){const t=e.getSpaceViewStores();return d.oA(t.map((e=>e.getSpaceId())))}return[]}function Ie(e){return d.mN(e.getSpaceViewStores(),(e=>e.getSpaceId())).filter((e=>{const t=e.getSpaceStore();return e.isDefined()&&t&&t.canEdit()}))}async function Ce(e){await e.load();const t=e.getSpaceViewStores();await Promise.all(t.map((async e=>{await e.load();const t=e.getSpaceStore();t&&await t.load()})))}const xe=new o.Z((function(){const{currentUserSettingsStore:e}=y.default.state,t=(0,r.aN)();if(e){const n=e.getSettings();return void 0===(null==n?void 0:n.start_day_of_week)?t:null==n?void 0:n.start_day_of_week}return t}),{debugName:"userSettingsStartOfWeek"});function Te(e){const{environment:t,store:n}=e;return n.isCollectionView()?(0,Y.eA)(t)?v.Z.All:v.Z.Y:!(0,u.en)(n)&&F.default.isSidePeekOpen()?v.Z.All:v.Z.Y}function Me(e){const{isFullScreen:t,environment:n}=e;return t&&(0,Y.eA)(n)?v.Z.None:v.Z.X}function Pe(){p.default.isAdminMode||console.log("%c\n\tnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\n\tnnnn                         nnnn\n\tnnnnnnn                          nnnn\n\tnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\n\tnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\n\tnnnnnnnn                           nnn\n\tnnnnnnnn    nnnnnnnn     nnnnnnn   nnn\n\tnnnnnnnn      nnnnnnn      nnn     nnn\n\tnnnnnnnn      nnnnnnnn     nnn     nnn\n\tnnnnnnnn      nnnnnnnnnn   nnn     nnn\n\tnnnnnnnn      nnn nnnnnnn  nnn     nnn\n\tnnnnnnnn      nnn  nnnnnnnnnnn     nnn\n\tnnnnnnnn      nnn   nnnnnnnnnn     nnn\n\tnnnnnnnn      nnn     nnnnnnnn     nnn\n\tnnnnnnnn      nnn      nnnnnnn     nnn\n\tnnnnnnnn    nnnnnnnn    nnnnnn     nnn\n\t  nnnnnn                           nnn\n\t\tnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\t\tWe're hiring!\n\t\t  nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\t\tnotion.so/careers\n\t\t\t\t ","font-family: monospace")}},91924:(e,t,n)=>{n.d(t,{HU:()=>u,IJ:()=>c,Q7:()=>l,eC:()=>d,k2:()=>p});var o=n(35061),i=n(3303),r=n(95477),a=n(77080),s=n(18514);function l(e){return!!e.device.isMobileNative&&(e.device.isIOS&&"on"===a.default.getEligibleGroup({experimentId:"ios_3rd_party_login_with_external_browser",defaultGroup:"control"})||e.device.isAndroid&&"on"===a.default.getEligibleGroup({experimentId:"android_3rd_party_login_with_external_browser",defaultGroup:"control"}))}function c(e){const{device:t}=e,n=l(e);if(t.isMobileNative){return{redirectToAuth:!1,callbackType:n?"nativeredirect":"native"}}if(t.isElectron){return{redirectToAuth:!1,callbackType:"nativeredirect"}}return{redirectToAuth:!0,callbackType:"redirect"}}function d(e){const{device:t}=e,n=l(e);if(t.isMobileNative){return{redirectToAuth:!1,callbackType:n?"nativeredirect":"native"}}if(t.isElectron){return{redirectToAuth:!1,callbackType:"nativeredirect"}}if(t.isMobileBrowser||(0,s.Sr)(e)){return{redirectToAuth:!0,callbackType:"redirect"}}return{redirectToAuth:!0,callbackType:"popup"}}async function u(e,t,n){if(e.device.isHttpApp){const e=await fetch(t);return(await e.json()).url}{const e=await fetch(i.NV({httpUrl:t,protocol:r.default.protocol,includePort:n}));return(await e.json()).url}}function p(e){return i.jP({url:o.tu[e],isLocalHost:"local"===e})}},80365:(e,t,n)=>{n.d(t,{L:()=>m});var o=n(66897),i=n(36576),r=n(21202),a=n(70279),s=n(23867),l=n(19889),c=n(53965),d=n(1898),u=n(6258);function p(e,t){const n=c.oA(e.map((e=>function(e,t){if("comment_mention"===e.mentioned_from.type){const n=u.t1.createChildStore(t,{table:a.x_,id:e.mentioned_from.comment_id,spaceId:(0,s.C)(void 0)});if(!n.isDefined())return;const o=u.t1.createChildStore(t,n.getParentPointer());if(!o.isDefined())return;const i=u.G.createChildStore(t,{table:r.iU,id:o.getParentId()}),l=i.getNavigableBlockStore();if(!l)return;return i.id===l.id?{backlinkStore:l,timestamp:n.getLastEditedTime()}:{backlinkStore:l,scrollToBlockId:i.id,discussionId:o.id,timestamp:n.getLastEditedTime()}}if("reference"===e.mentioned_from.type){const n=u.G.createChildStore(t,{table:r.iU,id:e.mentioned_from.parent_block_id}).getNavigableBlockStore();if(!n)return;const o=n.getLastEditedTime();return{backlinkStore:n,scrollToBlockId:e.block_id,timestamp:o||0}}if("property_mention"===e.mentioned_from.type){const{block_id:n}=e.mentioned_from,o=u.G.createChildStore(t,{table:r.iU,id:n});if(!o.isDefined())return;const i=o.getNavigableBlockStore();if(!i)return;return i.id===o.id?{backlinkStore:i,timestamp:o.getLastEditedTime()}:{backlinkStore:i,scrollToBlockId:o.id,timestamp:o.getLastEditedTime()}}if("collection_reference"===e.mentioned_from.type){const{block_id:n}=e.mentioned_from,o=u.G.createChildStore(t,{table:r.iU,id:n});if(!o.isDefined())return;const i=o.getNavigableBlockStore();if(!i)return;return i.id===o.id?{backlinkStore:i,timestamp:o.getLastEditedTime()}:{backlinkStore:i,scrollToBlockId:o.id,timestamp:o.getLastEditedTime()}}if("alias"===e.mentioned_from.type||"transclusion_reference"===e.mentioned_from.type){const n=u.G.createChildStore(t,{table:r.iU,id:e.mentioned_from.pointer.id}),o=n.getNavigableBlockStore();if(!o)return;return{backlinkStore:o,scrollToBlockId:n.id,timestamp:o.getLastEditedTime()}}(0,d.t1)(e.mentioned_from)}(e,t)))),o=c.vM(n,(e=>{let{backlinkStore:t}=e;return t.id})),i=Object.values(o).map((e=>c.MR(e,(e=>e.discussionId?2:e.scrollToBlockId?1:0))[0]));return i.sort(((e,t)=>t.timestamp-e.timestamp)),i}function m(e,t){const{id:n}=t.currentUser;let r;if(n){const t=e.getRecordValue({table:l.KJ,id:n});t&&(r=(0,o.dp)(t))}const a=t.LocalBacklinkStore.getBacklinkState({blockId:e.id,currentUserId:t.currentUser.id}),s=(0,i.sU)({actor:r,blockId:e.id,backlinks:a.backlinks,getRecordModel:e.getRecordModel});return 0===s.length?{backlinks:[],inaccessibleBacklinkCount:a.inaccessibleBacklinkCount}:{backlinks:p(s,e),inaccessibleBacklinkCount:a.inaccessibleBacklinkCount}}},42:(e,t,n)=>{n.d(t,{Fr:()=>j,Jy:()=>B,S7:()=>O,UG:()=>U,W_:()=>I,Yu:()=>A,ZW:()=>V,_Z:()=>E,ax:()=>w,iC:()=>R,iD:()=>L,n_:()=>F,sU:()=>D,sw:()=>S});var o=n(30120),i=n(7289),r=n(99036),a=n(80951),s=n(42613),l=n(53877),c=n(42875),d=n(45953),u=n(21202),p=n(6287),m=n(70203),f=n(9291),g=n(53965),h=n(7032),v=n(15828),b=n(1898),y=n(33929);const _=(0,f.defineMessages)({addNewTodoTitle:{defaultMessage:"Add a new to-do",id:"blockTemplates.templateButton.addNewTodoTitle"}});function S(){return d.Ao.create({block:{root:{id:"root",version:27,type:"factory",properties:{title:[[y.default.formatMessage(_.addNewTodoTitle)]]},content:["to_do"]},to_do:{id:"to_do",version:4,type:"to_do",parent_table:"block",parent_id:"root",alive:!0}}})}function w(){return d.Ao.create({block:{root:{id:"root",version:0,type:"button",format:{automation_id:"automation"}}},automation:{automation:{id:"automation",parent_id:"root",parent_table:u.iU,alive:!0,status:"active",trigger:{id:(0,h.ZP)(),type:"button"},action_ids:[],properties:{name:""}}}})}const k=(0,f.defineMessages)({namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.table.namePropertyTitle"},tagsPropertyTitle:{defaultMessage:"Tags",id:"blockTemplates.table.tagsPropertyTitle"}});function I(e){const{isInline:t,name:n}=e,o=(0,v.ZP)();return d.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:p.vF,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0}},collection_view:{view:{id:"view",version:0,type:"table",format:{collection_pointer:{table:p.vF,id:"collection"},table_properties:[{property:"title",visible:!0,width:276},{property:o,visible:!0}],table_wrap:!0},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,m.TPx)(n):void 0,schema:{title:{name:y.default.formatMessage(k.namePropertyTitle),type:"title"},[o]:{name:y.default.formatMessage(k.tagsPropertyTitle),type:"multi_select"}},format:{collection_page_properties:[{property:o,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}const C=(0,f.defineMessages)({viewTitle:{defaultMessage:"Board view",id:"blockTemplates.board.viewTitle"},namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.board.namePropertyTitle"},assignPropertyTitle:{defaultMessage:"Assign",id:"blockTemplates.board.assignPropertyTitle"},statusPropertyTitle:{defaultMessage:"Status",id:"blockTemplates.board.statusPropertyTitle"},card1Title:{defaultMessage:"Card 1",id:"blockTemplates.board.card1Title"},card2Title:{defaultMessage:"Card 2",id:"blockTemplates.board.card2Title"},card3Title:{defaultMessage:"Card 3",id:"blockTemplates.board.card3Title"}});const x=(0,f.defineMessages)({viewTitle:{defaultMessage:"Calendar view",id:"blockTemplates.calendar.viewTitle"},namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.calendar.namePropertyTitle"},datePropertyTitle:{defaultMessage:"Date",id:"blockTemplates.calendar.datePropertyTitle"},tagsPropertyTitle:{defaultMessage:"Tags",id:"blockTemplates.calendar.tagsPropertyTitle"}});const T=(0,f.defineMessages)({viewTitle:{defaultMessage:"Timeline view",id:"blockTemplates.timeline.viewTitle"},datePropertyTitle:{defaultMessage:"Date",id:"blockTemplates.timeline.datePropertyTitle"}});const M=(0,f.defineMessages)({viewTitle:{defaultMessage:"Gallery view",id:"blockTemplates.gallery.viewTitle"},namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.gallery.namePropertyTitle"},tagsPropertyTitle:{defaultMessage:"Tags",id:"blockTemplates.gallery.tagsPropertyTitle"},createdPropertyTitle:{defaultMessage:"Created",id:"blockTemplates.gallery.createdPropertyTitle"},page1Title:{defaultMessage:"Page 1",id:"blockTemplates.gallery.page1Title"},page2Title:{defaultMessage:"Page 2",id:"blockTemplates.gallery.page2Title"},page3Title:{defaultMessage:"Page 3",id:"blockTemplates.gallery.page3Title"},page1TodoTitle:{defaultMessage:"To-do",id:"blockTemplates.gallery.page1TodoTitle"},page1CompletedTodoTitle:{defaultMessage:"Completed To-do",id:"blockTemplates.gallery.page1CompletedTodoTitle"}});const P=(0,f.defineMessages)({viewTitle:{defaultMessage:"List view",id:"blockTemplates.list.viewTitle"},namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.list.namePropertyTitle"},tagsPropertyTitle:{defaultMessage:"Tags",id:"blockTemplates.list.tagsPropertyTitle"},createdPropertyTitle:{defaultMessage:"Created",id:"blockTemplates.list.createdPropertyTitle"},page1Title:{defaultMessage:"Page 1",id:"blockTemplates.list.page1Title"},page2Title:{defaultMessage:"Page 2",id:"blockTemplates.list.page2Title"},page3Title:{defaultMessage:"Page 3",id:"blockTemplates.list.page3Title"}});function A(e){const{environment:t,isInline:n,viewType:u,name:f}=e;return"table"===u?I({environment:t,isInline:n,name:f}):"board"===u?function(e){const{isInline:t,name:n}=e,o=(0,v.ZP)(),i=(0,v.ZP)();return d.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:p.vF,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(C.card1Title)]]}},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(C.card2Title)]]}},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(C.card3Title)]]}}},collection_view:{view:{id:"view",version:0,type:"board",name:y.default.formatMessage(C.viewTitle),query2:{aggregations:[{aggregator:"count"}]},format:{collection_pointer:{table:p.vF,id:"collection"},board_columns_by:{property:o,type:"status",groupBy:"group",sort:{type:"ascending"}},board_columns:[{property:o,value:{type:"status",value:{type:"by_group",group:s.G1}}},{property:o,value:{type:"status",value:{type:"by_group",group:s.Ho}}},{property:o,value:{type:"status",value:{type:"by_group",group:s.RW}}}],board_properties:[{property:o,visible:!1},{property:i,visible:!0}]},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,m.TPx)(n):void 0,schema:{title:{name:y.default.formatMessage(C.namePropertyTitle),type:"title"},[i]:{name:y.default.formatMessage(C.assignPropertyTitle),type:"person"},[o]:(0,r.I4)(y.default.formatMessage(C.statusPropertyTitle),y.default.getIntl())},format:{collection_page_properties:[{property:o,visible:!0},{property:i,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:f}):"calendar"===u?function(e){const{isInline:t,name:n}=e,o=(0,v.ZP)(),i=(0,v.ZP)();return d.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:p.vF,id:"collection"}},view_ids:["view"],alive:!0}},collection_view:{view:{id:"view",version:0,type:"calendar",name:y.default.formatMessage(x.viewTitle),format:{collection_pointer:{table:p.vF,id:"collection"}},query2:{calendar_by:o},parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,m.TPx)(n):void 0,schema:{title:{name:y.default.formatMessage(x.namePropertyTitle),type:"title"},[o]:{name:y.default.formatMessage(x.datePropertyTitle),type:"date"},[i]:{name:y.default.formatMessage(x.tagsPropertyTitle),type:"multi_select"}},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:f}):"list"===u?function(e){const{isInline:t,name:n}=e,o=(0,v.ZP)(),i=(0,v.ZP)();return d.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:p.vF,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(P.page1Title)]]}},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(P.page2Title)]]}},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(P.page3Title)]]}}},collection_view:{view:{id:"view",version:0,type:"list",name:y.default.formatMessage(P.viewTitle),query2:{aggregations:[{aggregator:"count"}]},format:{collection_pointer:{table:p.vF,id:"collection"},list_properties:[{property:o,visible:!0}]},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,m.TPx)(n):void 0,schema:{title:{name:y.default.formatMessage(P.namePropertyTitle),type:"title"},[o]:{name:y.default.formatMessage(P.tagsPropertyTitle),type:"multi_select",options:[]},[i]:{name:y.default.formatMessage(P.createdPropertyTitle),type:"created_time"}},format:{collection_page_properties:[{property:i,visible:!0},{property:o,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:f}):"gallery"===u?function(e){const{isInline:t,name:n}=e,o=(0,v.ZP)(),i=(0,v.ZP)();return d.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:p.vF,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(M.page1Title)]]},content:["to_do_1","to_do_2"]},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(M.page2Title)]]}},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(M.page3Title)]]}},to_do_1:{id:"to_do_1",type:"to_do",parent_id:"item_1",parent_table:"block",alive:!0,properties:{title:[[y.default.formatMessage(M.page1TodoTitle)]]}},to_do_2:{id:"to_do_2",type:"to_do",parent_id:"item_1",parent_table:"block",alive:!0,properties:{title:[[y.default.formatMessage(M.page1CompletedTodoTitle)]],checked:[["Yes"]]}}},collection_view:{view:{id:"view",version:0,type:"gallery",name:y.default.formatMessage(M.viewTitle),query2:{aggregations:[{aggregator:"count"}]},format:{collection_pointer:{table:p.vF,id:"collection"},gallery_cover:{type:"page_content"}},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,m.TPx)(n):void 0,schema:{title:{name:y.default.formatMessage(M.namePropertyTitle),type:"title"},[o]:{name:y.default.formatMessage(M.tagsPropertyTitle),type:"multi_select",options:[]},[i]:{name:y.default.formatMessage(M.createdPropertyTitle),type:"created_time"}},format:{collection_page_properties:[{property:i,visible:!0},{property:o,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:f}):"timeline"===u?function(e){const{isInline:t,name:n}=e,i=(0,v.ZP)(),s=(0,v.ZP)(),u=(0,v.ZP)();return d.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:p.vF,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",properties:{title:[[y.default.formatMessage(C.card1Title)]],[i]:(0,a.d7)((0,l.fZ)(o.ou.now().minus({days:5}).startOf("day").valueOf(),o.ou.now().minus({days:1}).startOf("day").valueOf(),(0,c.r)()))},alive:!0},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",properties:{title:[[y.default.formatMessage(C.card2Title)]],[i]:(0,a.d7)((0,l.fZ)(o.ou.now().minus({days:3}).startOf("day").valueOf(),o.ou.now().plus({days:1}).startOf("day").valueOf(),(0,c.r)()))},alive:!0},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",properties:{title:[[y.default.formatMessage(C.card3Title)]],[i]:(0,a.d7)((0,l.fZ)(o.ou.now().minus({days:1}).startOf("day").valueOf(),o.ou.now().plus({days:3}).startOf("day").valueOf(),(0,c.r)()))},alive:!0}},collection_view:{view:{id:"view",version:0,type:"timeline",name:y.default.formatMessage(T.viewTitle),format:{collection_pointer:{table:p.vF,id:"collection"},timeline_show_table:!t,timeline_properties:[{property:"title",visible:!0}],timeline_table_properties:[{property:"title",visible:!0,width:280},{property:i,visible:!1,width:180},{property:s,visible:!1,width:180},{property:u,visible:!1,width:180}]},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,m.TPx)(n):void 0,schema:{title:{name:y.default.formatMessage(C.namePropertyTitle),type:"title"},[i]:{name:y.default.formatMessage(T.datePropertyTitle),type:"date"},[s]:{name:y.default.formatMessage(C.assignPropertyTitle),type:"person"},[u]:(0,r.I4)(y.default.formatMessage(C.statusPropertyTitle),y.default.getIntl())},format:{collection_page_properties:[{property:i,visible:!0},{property:s,visible:!0},{property:u,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:f}):"page"!==u?"chart"===u?function(e){const{isInline:t,name:n}=e,o=(0,v.ZP)(),r={title:{name:y.default.formatMessage(k.namePropertyTitle),type:"title"},[o]:{name:y.default.formatMessage(k.tagsPropertyTitle),type:"multi_select"}};return d.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:p.vF,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0}},collection_view:{view:{id:"view",version:0,type:"chart",format:{collection_pointer:{table:p.vF,id:"collection"},chart_config:(0,i.K0)({collectionSchema:r})},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,m.TPx)(n):void 0,schema:r,format:{collection_page_properties:[{property:o,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:f}):void(0,b.t1)(u):void 0}function R(e){const{isInline:t,viewType:n,chartType:o}=e;return d.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",view_ids:["view"],alive:!0}},collection_view:{view:{id:"view",version:0,type:n,parent_id:"root",parent_table:"block",alive:!0,format:o?{chart_config:{type:"placeholder",placeHolderType:o}}:{}}}})}function D(e){const{isInline:t,viewType:n,integrationId:o}=e;return d.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:p.vF,id:"collection"}},view_ids:["view"],alive:!0}},collection:{collection:{id:"collection",name:void 0,schema:{},format:{is_placeholder:!0,integration_id:o},parent_id:"root",parent_table:"block",alive:!0}},collection_view:{view:{id:"view",version:0,type:n,format:{collection_pointer:{table:p.vF,id:"collection"}},parent_id:"root",parent_table:"block",alive:!0}}})}function E(){return d.Ao.create({block:{root:{id:"root",type:"transclusion_container",content:["empty_text"],alive:!0},empty_text:{id:"empty_text",type:"text",parent_id:"root",parent_table:"block",alive:!0}}})}function B(e){return d.Ao.create({block:{root:{id:"root",type:"ai_block",content:[],alive:!0,format:{ai_prompt_key:e}}}})}function F(e){const t=g.DZ(e,(e=>`column${e+1}`));return d.Ao.create({block:{root:{id:"root",type:"column_list",content:t,alive:!0},...Object.assign({},...t.map((t=>{const n=`${t}_text`;return{[t]:{id:t,type:"column",parent_id:"root",parent_table:"block",content:[n],alive:!0,format:{column_ratio:1/e}},[n]:{id:n,type:"text",parent_id:t,parent_table:"block",alive:!0}}})))}})}function O(){const e=[(0,v.ZP)(),(0,v.ZP)()];return d.Ao.create({block:{root:{id:"root",type:"table",content:["row_1","row_2","row_3"],alive:!0,format:{table_block_column_order:e}},row_1:{id:"row_1",type:"table_row",parent_id:"root",parent_table:"block",alive:!0},row_2:{id:"row_2",type:"table_row",parent_id:"root",parent_table:"block",alive:!0},row_3:{id:"row_3",type:"table_row",parent_id:"root",parent_table:"block",alive:!0}}})}const Z=(0,f.defineMessages)({tab1Title:{defaultMessage:"Tab 1",id:"blockTemplates.list.tab1Title"},tab2Title:{defaultMessage:"Tab 2",id:"blockTemplates.list.tab2Title"},tab3Title:{defaultMessage:"Tab 3",id:"blockTemplates.list.tab3Title"}});function V(){return d.Ao.create({block:{root:{id:"root",type:"tab",alive:!0,content:["tab1","tab2","tab3"]},tab1:{id:"tab1",parent_id:"root",parent_table:"block",type:"text",alive:!0,properties:{title:[[y.default.formatMessage(Z.tab1Title)]]}},tab2:{id:"tab2",parent_id:"root",parent_table:"block",type:"text",alive:!0,properties:{title:[[y.default.formatMessage(Z.tab2Title)]]}},tab3:{id:"tab3",parent_id:"root",parent_table:"block",type:"text",alive:!0,properties:{title:[[y.default.formatMessage(Z.tab3Title)]]}}}})}function U(e){return d.Ao.create({[u.iU]:{root:{id:"root",type:e,format:{toggleable:!0}}}})}function L(e,t){return d.Ao.create({[u.iU]:{root:{id:"root",type:"code",properties:{title:m.TPx(t),language:m.TPx(e)}}}})}function j(){return d.Ao.create({[u.iU]:{root:{id:"root",type:"drawing",format:{drawing_value:void 0,block_page_width:!0,block_height:480}}}})}},43250:(e,t,n)=>{n.d(t,{$Ot:()=>T,$ji:()=>on,A_D:()=>B,Apy:()=>fn,Aur:()=>Tt,B8p:()=>F,BEs:()=>Te,BKn:()=>Ke,BaY:()=>$e,C18:()=>We,CZG:()=>be,C_N:()=>rn,Cjq:()=>_t,D$4:()=>ut,Dkf:()=>Jt,EGJ:()=>Lt,Ep8:()=>y,F4o:()=>De,FJA:()=>K,FLq:()=>It,FSd:()=>et,FoE:()=>he,G6g:()=>le,GNl:()=>$,GZn:()=>Cn,GbT:()=>j,Gcz:()=>Zt,GfL:()=>Q,HKr:()=>ie,HwD:()=>an,I2F:()=>ne,I9j:()=>at,IAq:()=>Ct,Iiy:()=>hn,IpQ:()=>me,J2F:()=>Mt,JR_:()=>Vt,JUE:()=>ze,J_U:()=>it,JiD:()=>r,JkF:()=>Me,K3y:()=>L,K4T:()=>qt,KA2:()=>te,KLh:()=>U,LoZ:()=>se,MD7:()=>V,MU2:()=>Be,M_0:()=>gn,Mdu:()=>qe,Mfh:()=>ke,Mpz:()=>xt,MsS:()=>p,N7t:()=>ge,NFf:()=>ve,Nn$:()=>b,No6:()=>x,OE$:()=>yn,OK_:()=>f,Oau:()=>z,PBs:()=>h,QS0:()=>P,QSt:()=>o,Qcf:()=>I,Qgj:()=>vt,Quo:()=>d,RG3:()=>Ve,RIA:()=>nn,S94:()=>G,S9A:()=>wn,TAd:()=>Ge,TFu:()=>dn,TYv:()=>He,U9U:()=>Mn,UBk:()=>O,Uhm:()=>yt,Uwd:()=>Ue,V6y:()=>Rt,VMO:()=>Bt,Voi:()=>kt,Wh_:()=>M,Wiy:()=>A,Wy1:()=>bt,Wyp:()=>nt,Xgx:()=>mt,Xj_:()=>m,Xjk:()=>In,Xsh:()=>st,Y6l:()=>je,YHn:()=>J,YOJ:()=>xn,YPt:()=>S,Z87:()=>St,ZHw:()=>D,ZmO:()=>X,Zp2:()=>cn,_so:()=>At,a6i:()=>pe,aL4:()=>Fe,afv:()=>Y,aiP:()=>a,alX:()=>i,b_f:()=>W,blN:()=>Ae,boI:()=>tt,c7X:()=>jt,cFM:()=>ct,dXl:()=>Sn,euV:()=>C,exn:()=>we,f0e:()=>mn,f8P:()=>ce,fHd:()=>w,fOh:()=>_n,fe0:()=>xe,gGc:()=>ee,gec:()=>gt,gjL:()=>oe,gug:()=>c,hBn:()=>v,hEP:()=>un,hHI:()=>ot,hKO:()=>fe,hzx:()=>re,i25:()=>Pt,irE:()=>Wt,j35:()=>Ee,jWx:()=>Le,kDE:()=>Kt,kUP:()=>Et,l24:()=>Re,lIT:()=>R,lmr:()=>Tn,mJW:()=>_,mSZ:()=>E,mWS:()=>Ot,myM:()=>pt,nM$:()=>Nt,nU_:()=>ye,o4s:()=>$t,ok8:()=>rt,ovr:()=>Gt,p0b:()=>N,p1Q:()=>k,p4m:()=>de,pMC:()=>l,pg$:()=>ln,q1J:()=>Pe,qSF:()=>Xe,qnV:()=>vn,qr0:()=>Qe,qxR:()=>Ne,rG8:()=>Je,rIE:()=>Ze,rIj:()=>dt,rIs:()=>sn,rKl:()=>s,rTm:()=>en,rVO:()=>tn,rcG:()=>_e,rli:()=>Ie,s$o:()=>lt,sbt:()=>zt,sqL:()=>Ht,srZ:()=>q,tQh:()=>H,tfM:()=>Dt,ulv:()=>kn,vvn:()=>wt,wFE:()=>ae,wG0:()=>pn,wKH:()=>g,wXs:()=>Ut,wlU:()=>Z,wnm:()=>ft,x2W:()=>ht,x4y:()=>u,x9t:()=>Yt,xvU:()=>Xt,y4j:()=>bn,yNE:()=>Oe,ykc:()=>Se,zYS:()=>Ce,z_z:()=>Qt,zar:()=>Ye,zov:()=>ue,zwY:()=>Ft});const o="notion-cursor-default",i="hidden",r="notion-fadein",a="notion-mobile",s="notion-fadein-fast",l="notion-desktop-drag-area",c="notion-front-page",d="analytics-scroll-point",u="notion-login",p="notion-light-theme",m="notion-dark-theme",f="notion-scroller",g="vertical",h="horizontal",v="ignore-scrolling-container",b="notion-history-modal",y="notion-block-resizer",_="notion-overlay-container",S="notion-default-overlay-container",w="notion-page-template-modal",k="notion-peek-renderer",I="notion-text-action-menu",C="notion-selectable",x="notion-selectable-halo",T="notion-selectable-hover-menu-item",M="notion-focusable-within",P="notion-page-content",A="notion-frame",R="notion-topbar",D="notion-topbar-mobile",E="notion-topbar-more-button",B="notion-topbar-action-buttons",F="notion-share-menu",O="notion-share-menu-publish-tab",Z="notion-share-menu-publish-button",V="notion-topbar-share-menu",U="notion-updates-menu",L="notion-topbar-updates-button",j="notion-topbar-favorite-button",N="notion-topbar-comments-button",z="notion-search-menu",q="notion-embed-menu",W="notion-unfurling-menu",H="notion-media-menu",K="notion-invite",G="notion-record-icon",$="notion-calendar-header-days",Q="notion-board-group",Y="notion-block-permission-settings-workspace-access",J="notion-block-permission-settings-team-access",X="notion-block-permission-settings-team-access",ee="notion-block-permission-settings-group-access",te="notion-page-view-discussion",ne="notion-updates-button-mentions",oe="notion-updates-button-all-updates",ie="notion-updates-button-archive",re="notion-discussion-input-edit-existing-comment",ae="notion-discussion-input",se="notion-discussion-reply-menu",le="notion-comment-overflow-menu",ce="notion-shimmer",de="notion-link",ue="ai-block",pe="notion-sharing-permission-role-select",me="notion-sharing-permission-expiration-timestamp",fe="notion-language-picker",ge="notion-cookie-selector",he="notion-activity-section-icon",ve="notion-activity-section-header",be="notion-activity-section-time",ye="notion-activity-section-children",_e="notion-sidebar",Se="notion-sidebar-mobile",we="notion-open-sidebar",ke="notion-close-sidebar",Ie="notion-sidebar-switcher",Ce="notion-space-settings",xe="notion-outliner-bookmarks",Te="notion-outliner-workspace",Me="notion-outliner-shared",Pe="notion-outliner-private",Ae="notion-outliner-offline",Re="notion-outliner-team",De="notion-outliner-bookmarks-header",Ee="notion-outliner-workspace-header",Be="notion-outliner-shared-header",Fe="notion-outliner-private-header",Oe="notion-outliner-offline-header",Ze="notion-outliner-team-header",Ve="notion-outliner-joined-team-header",Ue="notion-outliner-unjoined-team-header",Le="notion-outliner-search-team-header",je="notion-outliner-public-page-template-includes-header",Ne="notion-outliner-team-context-menu-button",ze="notion-outliner-team-heading-context-menu-button",qe="notion-outliner-team-context-menu",We="notion-updates-menu",He="notion-sidebar-trash-menu",Ke="notion-password-modal",Ge="notion-scim-table-revoke-button",$e="notion-subscription-checkout-title",Qe="notion-subscription-checkout-description",Ye="notion-update-sidebar",Je="notion-update-sidebar-tab-comments-segmented-control",Xe="notion-update-sidebar-tab-comments-filter-control",et="notion-update-sidebar-tab-comments-filter-button-open",tt="notion-update-sidebar-tab-comments-filter-button-resolved",nt="notion-update-sidebar-tab-comments-suggestions-dropdown-control",ot="notion-update-sidebar-tab-comments-suggestions-dropdown-button-comments-and-suggestions",it="notion-update-sidebar-tab-comments-suggestions-dropdown-button-comments",rt="notion-update-sidebar-tab-comments-suggestions-dropdown-button-suggestions",at="notion-update-sidebar-tab-comments-header",st="notion-update-sidebar-tab-comments-comments-scroller",lt="notion-update-sidebar-tab-comments-discussion-item",ct="notion-update-sidebar-tab-updates-header",dt="notion-team-settings-modal",ut="notion-add-members-modal",pt="notion-new-team",mt="notion-use-case-onboarding-profile",ft="notion-use-case-onboarding-persona-survey",gt="notion-workspace-choose",ht="notion-workspace-plan-choose",vt="notion-workspace-create",bt="notion-workspace-invite",yt="notion-onboarding-error",_t="notion-onboarding-popup",St="notion-onboarding-button",wt="notion-onboarding-plan-type-personal",kt="notion-onboarding-plan-type-team",It="notion-onboarding-plan-type-school",Ct="notion-onboarding-persona-survey-persona",xt="notion-onboarding-persona-survey-role",Tt="notion-onboarding-persona-survey-companysize",Mt="notion-onboarding-persona-survey-usecases",Pt="notion-onboarding-timed-trial-upsell",At="notion-table-view",Rt="notion-table-view-add-column",Dt="notion-table-view-add-row",Et="notion-table-view-header-row",Bt="notion-table-view-header-cell",Ft="notion-table-view-row",Ot="notion-table-view-cell",Zt="notion-table-view-empty-placeholder",Vt="notion-table-view-drag-and-fill-handle",Ut="notion-table-view-frozen-column-repositioner",Lt="notion-board-view",jt="notion-calendar-view",Nt="notion-list-view",zt="notion-gallery-view",qt="notion-collection-item",Wt="notion-calendar-view-day",Ht="notion-collection-view-item-add",Kt="notion-timeline-view",Gt="notion-timeline-item",$t="notion-timeline-item-row",Qt="notion-timeline-item-properties",Yt="notion-collection-view-body",Jt="notion-view-settings-sidebar",Xt="notion-collection-edit-view",en="notion-collection-view-tab-button",tn="notion-collection-add-view",nn="notion-collection-automation-edit-view",on="notion-template-picker-item",rn="notion-template-picker-item-action-menu",an="draggable-ghost-section",sn="developer-integrations-container",ln="developer-integrations-list",cn="developer-integration-create",dn="developer-integration-view",un="developer-integration-lab",pn="developer-integration-not-found",mn="notion-table-row-selector",fn="notion-table-column-selector",gn="notion-table-row",hn="notion-table-cell",vn="notion-table-cell-text",bn="notion-table-selection-overlay",yn="notion-table-tbody-selectable",_n="notion-table-content",Sn="notion-temporary-comment",wn="notion-margin-discussion-item",kn="search-query-result-item",In="search-result-body-section-title",Cn="search-result-mobile-body-scroller",xn="notion-completions-feedback-popup",Tn="notion-help-button",Mn="notion-ai-button"},47853:(e,t,n)=>{n.d(t,{D:()=>r});var o=n(13991),i=n(25666);function r(e){return i.D(e,o.SP)}},49117:(e,t,n)=>{n.d(t,{$5:()=>C,Gb:()=>w,Rr:()=>x,pZ:()=>y,pt:()=>_,td:()=>k,uV:()=>I});var o=n(14577),i=n(59786),r=n(81730),a=n(7445),s=n(86433),l=n(1274),c=n(35102),d=n(42875),u=n(59753),p=n(87479),m=n(98963),f=n(40470),g=n(1898),h=n(77080),v=n(6258),b=n(35057);const y=30;function _(e){const{context:t}=e,{automationStore:n}=t,o=e.automationValue??n.getValue();if(!o)return{error:new r.MO("Missing automation record")};const i=u.kk.fromValue(m.cv,o),a=n.getActionStores().map((e=>e.getModel())).filter(g.$K),l=t.parentRecordStore.getRecordModel,p=t.parentRecordStore.loadRecordModel,f={automationModel:i,actionModels:a,handleDataRequest:(0,c.yf)(l,p),intl:t.intl,getRecordModel:l,loadRecordModel:p,userTimeZone:(0,d.r)()};let h;if("button_property"===t.type){const e=t.collectionContextStore.collectionStore();if(!e)return{error:new r.MO("Missing collectionContextStore")};h={...f,collectionPointer:e.getSpaceShardedPointer(),contextType:t.type}}else if("button_block"===t.type){const e=t.pageStore.getAssociatedCollectionStore();h={...f,collectionPointer:null==e?void 0:e.getSpaceShardedPointer(),contextType:t.type}}else"event"===t.type?h={...f,collectionPointer:t.parentPointer,contextType:t.type}:"recurrence"===t.type||"assistant"===t.type?h={...f,contextType:t.type}:(0,g.t1)(t);return(0,s.rS)(h)}const S=new WeakMap;function w(e){const t=S.get(e.automationStore);if(t)return t;{const t=new o.Z((()=>function(e){const t=e.automationStore.getModel();if(!t)return{executionPermissionStatus:"unknown",typecheckResult:void 0};const n=e.automationStore.getActionStores().map((e=>e.getModel()));if(!n.every((0,g.AO)((e=>(0,g.$K)(e)?{true:e}:{false:e}))))return{executionPermissionStatus:"insufficient",typecheckResult:void 0};const o=_({context:e});if(f.x.isFail(o))return{executionPermissionStatus:"unknown",typecheckResult:o};const r={automationModel:t};for(const s of n){const t=(0,i.z)(s.getType()).getExecutionDependencies(r,s),n=(0,a.TD)({getRecordModel:e.parentRecordStore.getRecordModel,permissions:t,typecheckContextValues:o.value.valueTypes});for(const i of n){const t=(0,v.Kv)(e.parentRecordStore,i.pointer).getRole();if(!t||(0,p.gr)(t,i.minimumRole))return{executionPermissionStatus:"insufficient",typecheckResult:o}}}return{executionPermissionStatus:"sufficient",typecheckResult:o}}(e)),{debugName:"buttonAutomationAnalysisCachedStore"});return S.set(e.automationStore,t),t}}function k(e){return Boolean(e.findRecordStoreUIAncestor((e=>e instanceof v.zq&&e.isType("duplicate_blocks"))).ancestor)}function I(e,t){const n=e.getModel(),o=e.getActionStores(),i=o.filter((e=>e.isDefined())).map((e=>e.getModel())).filter(g.$K);if(n&&i.length===o.length)return{checkExperimentGate:e=>h.default.checkGate(e),checkExperimentGroup:e=>Promise.resolve(h.default.getGroup(e)),checkSubscribed:()=>Promise.resolve((0,b.sX)()),automation:n,automationActions:i,contextType:t,checkType:"canAddAction"}}function C(e){if(!e)return{editPermissionStatus:"unknown",reason:"missing_automation_context"};const{automationStore:t}=e,n=t.getValue(),o=t.getModel();if(!o||!n)return{editPermissionStatus:"unknown",reason:"missing_automation_model"};const r=t.getActionStores().map((e=>e.getModel()));if(!r.every((0,g.AO)((e=>(0,g.$K)(e)?{true:e}:{false:e}))))return{editPermissionStatus:"unknown",reason:"missing_automation_action_model"};const s=_({context:e});if(f.x.isFail(s))return{editPermissionStatus:"unknown",reason:"typecheck_error"};const c=r.length>0&&r.some((e=>!e.isType("slack_notification")));if(o.isType("event")&&c&&!(0,b.sX)())return{editPermissionStatus:"insufficient",reason:"free_workspace"};const d={automationModel:o},u=r.filter((e=>e.isType("slack_notification")));for(const l of u){const t=(0,i.z)(l.getType()).getExecutionDependencies(d,l),n=(0,a.TD)({getRecordModel:e.parentRecordStore.getRecordModel,permissions:t,typecheckContextValues:s.value.valueTypes});for(const o of n){const t=(0,v.Kv)(e.parentRecordStore,o.pointer).getRole();if(!t||(0,p.gr)(t,o.minimumRole))return{actionId:l.id,editPermissionStatus:"insufficient",reason:"missing_permissions"}}}const m=(0,l.fz)({automationValue:n,actionValues:t.getActionStores().map((e=>({config:e.getConfig(),type:e.getType()})))});for(const i of m){const e=t.getRecordRole(i.pointer);if(!e||(0,p.gr)(e,i.minimumRequiredRole))return{editPermissionStatus:"insufficient",reason:"missing_permissions"}}return{editPermissionStatus:"sufficient"}}function x(e){const{contextType:t,environment:n}=e,{device:o}=n,i=o.isIOS&&o.isMobileNative;return"event"===t&&!i}},97004:(e,t,n)=>{n.d(t,{CN:()=>P,Gz:()=>M,H_:()=>_,IX:()=>A,Me:()=>x,Mj:()=>C,Nq:()=>k,OC:()=>b,Pi:()=>T,RL:()=>S,Zh:()=>w,m1:()=>R,mu:()=>B,qd:()=>y,tJ:()=>D,yU:()=>I,ze:()=>E});n(57658);var o=n(76205),i=n(99036),r=n(43690),a=n(10070),s=n(53504),l=n(93824),c=n(42875),d=n(53965),u=n(1898),p=n(40663),m=n(77080),f=n(28020),g=n(17335),h=n(77181),v=n(33929);const b="notion://database/hide_subitems_filter";function y(e){const{schema:t,filters:n,getRecordModel:i}=e,r=[];for(const o of Object.keys(t)){const e=_({property:o,schema:t,getRecordModel:i});e&&r.push(e)}const a=r.filter((e=>!n.find((t=>(0,o.aN)(t.filter)&&t.filter.property===e.property))));return d.MR(a,(e=>{const n=t[e.property];return(null==n?void 0:n.name)||""}))}function _(e){const{property:t,schema:n,getRecordModel:i}=e,r=(0,g.zZ)({property:t,schema:n,getRecordModel:i});if((0,o.a_)(r)?!(0,o.mv)(r.subfilter):!(0,o.mv)(r))return{property:t,filter:r}}function S(e){var t;const{collectionContextStore:n,applySubitemFilter:r,filterOutHideSubitemsQuickFilter:a}=e;let s=n.currentPropertyFiltersStore.state;const l=n.currentCombinatorFilterStore.state,c=r&&n.currentSubitemFormatStoreForUiDisplay.state,u=n.normalizedSchemaStore.state,p=c&&u[c.property],f=p&&"relation"===p.type&&(0,i.F0)(p)===(null===(t=n.collectionStore())||void 0===t?void 0:t.id)&&p.property,g=f?{property:f,filter:{operator:"is_empty"}}:void 0;a&&m.default.checkGate("collection_subitem_new_show_hide_options")&&(s=s.filter((e=>e.id!==b)));const h=(0,o.OH)({propertyFilters:s,combinatorFilter:l,schema:u});return d.oA([g,...h])}function w(e,t){var n,i;const a=e.collectionViewStore();if(!a)return{combinatorFilter:void 0,filters:{moveOps:[],removed:[],updated:[],moved:[],added:[]},sorts:void 0};const c="persisted"===t?a.getQueryStore().getKeyStore("sort").getValue()||[]:(null===(n=e.normalizedQueryStore.state)||void 0===n?void 0:n.sort)||[],u=e.currentSortsStore.state,p="persisted"===t?a.getQueryStore().getKeyStore("filter").getValue():null===(i=e.normalizedQueryStore.state)||void 0===i?void 0:i.filter,m=e.currentCombinatorFilterStore.state,f="persisted"===t?a.getPropertyFiltersStore().getValue()||[]:function(e){const t=e.normalizedSchemaStore.state,n=e.normalizedFormatStore.state.property_filters||[];return d.oA(n.filter((n=>{const i=(0,r.dN)(n.filter,t),a=e.collectionViewBlockStore();if(t[n.filter.property]&&i&&(0,o.J5)(t,n.filter.property,i.filter,null==a?void 0:a.getRecordModel))return i&&{id:n.id,filter:i}})))}(e),g=e.currentPropertyFiltersStore.state,h=f.map((e=>e.id)),v=g.map((e=>e.id)),{beforeOps:b,removeOps:y}=(0,l.q)(h,v),_=Array.from(y).filter((e=>!v.includes(e))),S=Object.keys(b).map((e=>({id:e,beforeId:b[e]}))),w=S.filter((e=>{let{id:t}=e;return h.includes(t)})).map((e=>{let{id:t}=e;return t})),k=S.filter((e=>{let{id:t}=e;return!h.includes(t)})).map((e=>{let{id:t}=e;return t})),I=g.filter((e=>f.find((t=>{if(e.id!==t.id)return!1;const n=d.Xh(t),o=d.Xh(e);return!d.Xy((0,s.Z)(o,"ignore-class-instances"),(0,s.Z)(n,"ignore-class-instances"))})))).map((e=>e.id));return{combinatorFilter:d.Xy(p,m)?void 0:{value:m},filters:{moveOps:S,removed:_,updated:I,moved:w,added:k},sorts:d.Xy(c,u)?void 0:{value:u}}}function k(e){const t=e.localStateDiffStore.state;return Boolean(t.filters.moved.length>0||t.filters.added.length>0||t.filters.removed.length>0||t.filters.updated.length>0||void 0!==t.combinatorFilter||void 0!==t.sorts)}function I(e){const t=e.localStateDiffStore.state;return Boolean(t.filters.moved.length>0||t.filters.added.length>0||t.filters.removed.length>0||t.filters.updated.length>0||void 0!==t.combinatorFilter)}function C(e){const t=e.localStateDiffStore.state;return Boolean(void 0!==t.sorts)}function x(e){return{property:(0,i.uS)(e),filter:{operator:"string_contains",value:{type:"exact",value:void 0}}}}function T(e){const t=e.currentCombinatorFilterStore.state,n=e.currentPropertyFiltersStore.state.filter((e=>!B(e.id))).map((e=>e.filter)),o=[...(null==t?void 0:t.filters)||[],...n];return{...t,filters:o,operator:"and"}}function M(e,t){const n=e.currentCombinatorFilterStore.state,o=e.currentPropertyFiltersStore.state.filter((e=>e.id!==t.id)),i=[...(null==n?void 0:n.filters)||[],t.filter];return{combinatorFilter:{operator:"and",...n,filters:i},propertyFilters:o}}function P(e,t,n,o){let i=n.filter((e=>"is_group"===e.type)).map((t=>e.find((e=>e.name===t.value)))).filter(u.$K),r=n.filter((e=>"is_option"===e.type)).map((e=>t.find((t=>t.value===e.value)))).filter(u.$K);for(const a of e){const e=a.optionIds??[];if(i.some((e=>e.id===a.id)))r=r.filter((t=>!e.includes(t.id)));else if(e.length>0){const t=r.filter((t=>!e.includes(t.id)));t.length+e.length===r.length&&(r=t,i=[...i,a])}}if("is_option"===o.type){const n=t.find((e=>e.value===o.value));if(!n)return;const a=r.filter((e=>e.id!==n.id));if(a.length<r.length)r=a;else{const o=e.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(n.id)})),a=i.find((e=>e.id===(null==o?void 0:o.id)));if(a){const e=t.filter((e=>{var t;return(null===(t=a.optionIds)||void 0===t?void 0:t.includes(e.id))&&e.id!==n.id}));i=i.filter((e=>e.id!==a.id)),r=[...r,...e]}else{r=[...r,n];const e=(null==o?void 0:o.optionIds)??[];if(o&&e.length>0){const t=r.filter((t=>!e.includes(t.id)));t.length+e.length===r.length&&(r=t,i=[...i,o])}}}}else if("is_group"===o.type){const t=e.find((e=>e.name===o.value));if(!t)return;const n=i.filter((e=>e.id!==t.id));if(n.length<i.length)i=n;else{const e=t.optionIds??[];i=[...i,t],r=r.filter((t=>!e.includes(t.id)))}}else(0,u.t1)(o.type);return[...i.map((e=>({type:"is_group",value:e.name}))),...r.map((e=>({type:"is_option",value:e.value})))]}function A(e){const{group:t,options:n,filterValues:o}=e,i=o.some((e=>"is_group"===e.type&&e.value===t.name)),r=n.filter((e=>{var n;return null===(n=t.optionIds)||void 0===n?void 0:n.includes(e.id)})),a=new Map;for(const d of r){const e=o.some((e=>"is_option"===e.type&&e.value===d.value))||i;a.set(d.id,e)}const s=Array.from(a.values()),l=s.some((e=>e)),c=s.every((e=>e))&&s.length>0;return{groupCheckState:!(!i&&!c)||!!l&&"partial",optionCheckedInfo:a}}function R(e){var t;const{collectionStore:n,collectionContextStore:i,environment:r}=e,s=i.relativeVariableStore.state,l=i.currentPropertyFiltersStore.state,d=i.currentCombinatorFilterStore.state,u=l.filter((e=>!(0,o.Oo)(e.filter))).map((e=>e.filter));if(0===u.length&&!d)return;const p=null==n?void 0:n.getModel(),m=null===(t=i.collectionViewStore())||void 0===t?void 0:t.getCollectionSource(),g=i.normalizedSchemaStore.state,h={schema:p&&m?(0,a.Hs)(m.type,g,p):g,userId:r.currentUser.id,userTimeZone:(0,c.r)(),userStartOfWeek:f.AK.state,intl:v.default.getIntl(),relativeVariableResult:s};return{filter:{filters:d?[...u,d]:u,operator:"and"},propertyMapping:void 0,context:h}}function D(e,t,n){const{property:o}=t,r=e[o];if(!(r&&"rollup"===r.type&&r.relation_property&&r.target_property))return r;{const t=e[r.relation_property];if(t&&(0,i.p_)(t)){const e=(0,i.j0)(t);if(e){const t=n.getRecordModel(e);if(!t)return;const o=t.getNormalizedSchema();if(o){const e=o[r.target_property];if(e&&"rollup"!==e.type)return e}}}}}function E(e,t){const n=e.collectionViewStore(),i=e.currentSubitemFormatStoreForUiDisplay.state,r=null==n?void 0:n.getType(),a=S({collectionContextStore:e,applySubitemFilter:t&&Boolean(i)&&!(r&&(0,h.Av)(r)),filterOutHideSubitemsQuickFilter:!t});return(0,o.kk)(a)}function B(e){return(0,p.EE)(e)||e===b}},4708:(e,t,n)=>{n.d(t,{$t:()=>D,A3:()=>y,B9:()=>_,En:()=>I,F$:()=>g,MC:()=>E,Mo:()=>C,Nm:()=>M,Or:()=>u,Rv:()=>p,VI:()=>B,Ye:()=>d,fJ:()=>w,gp:()=>m,kG:()=>k,kS:()=>F,m_:()=>R,p1:()=>c,s$:()=>b,u3:()=>v,u9:()=>A,uD:()=>S,uR:()=>T,wE:()=>h,wd:()=>P,wf:()=>x,zq:()=>f});n(13991);var o=n(12174),i=(n(95477),n(77080)),r=n(88893),a=n(35057),s=n(48779),l=n(95697);function c(){return r.ye()&&"on"===i.default.getEligibleGroup({experimentId:"request_membership",defaultGroup:"control"})}function d(e){return r.ye()&&!(0,a.wP)()&&"on"===i.default.getEligibleGroup({experimentId:"guest_membership_request",defaultGroup:"control"})}function u(){return b()}function p(){return(0,a.Mk)()}function m(e){let{currentSpaceStore:t}=e;return!!(0,s.Q9)(t)&&"on"===i.default.getEligibleGroup({experimentId:"share_modal_placeholder",defaultGroup:"control"})}function f(e){return!e.device.isMobile}function g(){return(0,l.bq)()&&"on"===i.default.getEligibleGroup({experimentId:"teamspace_guests",defaultGroup:"control"})}function h(e){return!e.device.isMobile&&i.default.checkGate("space_settings_people_section")}function v(){return(0,l.bq)()&&"on"===i.default.getEligibleGroup({experimentId:"teams_invite_link",defaultGroup:"control"})}function b(){return(0,l.bq)()&&"on"===i.default.getEligibleGroup({experimentId:"team_invite_link_ms2",defaultGroup:"control"})}function y(){return i.default.checkGate("drawing_block")}function _(){return i.default.checkGate("team_add_app_template_tooltip")}function S(){return i.default.getEligibleGroup({experimentId:"share_modal_autofill_email",defaultGroup:"control"})}function w(){return"on"===i.default.getEligibleGroup({experimentId:"share_modal_pending_invite_status_ui",defaultGroup:"control"})}function k(e){if(!(0,s.Fn)(e))return"control";return(0,l.$)(e)?"control":i.default.getEligibleGroup({experimentId:"share_modal_guest_member_confirmation",defaultGroup:"control"})??"control"}function I(){return!1}function C(){return i.default.checkGate("recover_user_content_in_product")}function x(){return i.default.checkGate("sites_domains_settings_section")}function T(){return i.default.checkGate("sites_create_multiple_domains")}function M(){return i.default.checkGate("sites_public_domain_double_write")}function P(){return i.default.checkGate("guest_invite_requests")}function A(){const e=i.default.getEligibleGroup({experimentId:"move_settings_and_members",defaultGroup:"control"})??"control";return o.eo.includes(e)?e:"control"}function R(){if((0,a.QM)())return"control";const e=i.default.getEligibleGroup({experimentId:"page_access_followups",defaultGroup:"control"})??"control";return o.rn.includes(e)?e:"control"}function D(){return"on"===i.default.getEligibleGroup({experimentId:"grant_access_via_mentions",defaultGroup:"control"})}function E(){return"on"===i.default.getEligibleGroup({experimentId:"move_inbox_top_right",defaultGroup:"control"})}function B(e){return!e.device.isMobile&&i.default.checkGate("truncate_private")}function F(e){return!!e.device.isMobileNative&&"on"===i.default.getEligibleGroup({experimentId:"mobile_horizon1_quick_capture",defaultGroup:"control"})}},14976:(e,t,n)=>{n.d(t,{Dn:()=>ae,Gj:()=>pe,IY:()=>G,Ob:()=>ve,PY:()=>ge,Qb:()=>ne,R9:()=>be,Rl:()=>_e,SD:()=>se,So:()=>ye,TQ:()=>we,Ut:()=>oe,We:()=>ke,Xh:()=>$,bD:()=>K,cD:()=>me,fm:()=>fe,kV:()=>de,li:()=>le,lw:()=>ie,n$:()=>ee,vO:()=>ce,x9:()=>te,xX:()=>he});var o=n(22377),i=n(15095),r=n(42875),a=n(82883),s=n(21202),l=n(70203),c=n(38585),d=n(53965),u=n(19584),p=n(993),m=n(84084),f=n(32741),g=n(48514),h=n(95477),v=n(17277),b=n(24990),y=n(33929),_=n(68056),S=n(77080),w=n(30874),k=n(69316),I=n(6258),C=n(24666),x=n(46150),T=n(41056),M=n(62619),P=n(83631),A=n(49394),R=n(45162),D=n(70219),E=n(65598),B=n(31352),F=n(89224);function O(e){return M.kK(e)&&e.classList.contains(c.Eu)}function Z(e){return M.kK(e)&&e.classList.contains(c.tL)}function V(e){return function(e){const t=M.sh(e,(e=>(0,P.Xu)(e)||(0,x.eD)(e)));if(t&&O(t))return t}(e)||L(e)||function(e){const t=M.sh(e,(e=>Z(e)||(0,x.eD)(e)));if(t&&Z(t))return t}(e)}function U(e){return M.kK(e)&&e.classList.contains(o.P)}function L(e){const t=M.sh(e,(e=>(0,P.Xu)(e)||(0,x.eD)(e)));if(t&&(0,P.Xu)(t))return t}function j(e){return M.kK(e)&&e.classList.contains(c.mb)}function N(e){if(j(e))return!0;try{return j(e.parentNode)}catch(t){return!1}}function z(e){try{const t=M.sh(e,(e=>Boolean(e.getAttribute&&e.getAttribute("contenteditable"))||(0,x.eD)(e)));return t&&t.isContentEditable}catch(t){return!1}}function q(e){return M.kK(e)&&e.classList.contains(c.$A)}function W(e,t){if(e===t.container){if(M.Gs(e)){const n=e.textContent||"";return(0,i.p4)(n.substring(0,t.offset)).length}{const n=Array.from(e.childNodes).slice(0,t.offset).map((e=>J(Q(e)))).join("");return(0,i.p4)(n).length}}let n=0;for(const o of Array.from(e.childNodes)){if(o.contains(t.container))return n+W(o,t);n+=(0,i.p4)(J(Q(o))).length}return n}function H(e,t){const n=(0,x.X1)(e);if(!n)return 0;const o=function(e,t){const n=V(e);if(n){const e=n.parentNode,o=Array.from(e.childNodes).indexOf(n);return{container:e,offset:0===t?o:o+1}}if(j(e)||j(e.parentNode))return{container:e,offset:(e.textContent||" ").length-1};return{container:e,offset:t}}(e,t);return W(n,o)}function K(e,t){if(0===t)return!(e.childNodes.length>0)||O(e.childNodes[0])||U(e.childNodes[0])||(0,P.Xu)(e.childNodes[0])||Z(e.childNodes[0])||q(e.childNodes[0])?{container:e,offset:0}:{container:e.childNodes[0],offset:0};const n=d.cx(e.childNodes,q),o=n>=0?n-1:e.childNodes.length-1;let r=t;for(let a=0;a<=o;a++){const t=e.childNodes[a],n=J(Q(t)),s=(0,i.p4)(n).length;if(a===o?r-s<=0:r-s<0){if(O(t)||(0,P.Xu)(t)||U(t)||j(t)||Z(t)){const e=M.oG(t.parentNode,t);return{container:t.parentNode,offset:e}}if(t.nodeType===Node.TEXT_NODE){return{container:t,offset:d.tP((0,i.p4)(n),0,r).join("").length}}return K(t,r)}r-=s}return{container:e,offset:0}}function G(e){const{environment:t,textValue:n,parentStore:o,disableHover:i,disableStyleAnnotations:a,disableInsertedDeletedAnnotations:s,disableDateStyleAnnotations:l,disabled:d,emojiType:u,highlightDiscussionId:p,renderedPageBlockId:m,parentBlockId:f,theme:g,katex:_,disableLinks:k,formulaValueTypes:I,stopLinkPropagation:C,linkTargetBlank:x}=e,{device:M,currentUser:P}=t,A=S.default.checkGate("enable_deleted_page_indicator");return c.IY({textValue:n,getRecordModel:o.getRecordModel,getRecordRole:o.getRecordRole,disableHover:i,disableStyleAnnotations:a,disableInsertedDeletedAnnotations:s,disableDateStyleAnnotations:l,disableLinks:k||!1,userTimeZone:(0,r.r)(),disabled:d,isAndroid:M.isAndroid,isSafariOrIOS:M.isSafari||M.isIOS,isWindows:M.isWindows,showEmojiInline:M.isWindows,emojiType:u,highlightDiscussionId:p,theme:g,intl:y.default.getIntl(),renderedPageBlockId:m,parentBlockId:f,katex:_,isClient:!0,baseUrl:h.default.domainBaseUrl,publicDomainName:h.default.publicDomainName,currentUserId:P.id,overwriteBaseUrlFromSpaceId:(0,D.b)(t),externalIntegrations:w.Z.integrations.state,formulaValueTypes:I,enableDeletedPageIndicator:A,stopLinkPropagation:C,linkTargetBlank:x,emojiData:b.Z.state,getToday:T.H,isMobileNative:M.isMobileNative,isMobileNativeExternalLinkFixEnabled:S.default.checkGate("mobile_native_external_link_fix"),displayInUserTimezone:S.default.checkGate("display_date_in_user_timezone"),dictationId:v.L})}function $(e,t){return(0,a.X)({textValue:e,getRecordModel:t.getRecordModel,userTimeZone:(0,r.r)(),intl:y.default.getIntl()})}function Q(e){let t="";if(O(e))t+=l.qyI;else if((0,P.Xu)(e))t=l.fuX;else if(U(e))t+=e.alt;else if(function(e){return M.kK(e)&&"br"===e.tagName.toLowerCase()}(e))t+="\n";else if(M.Gs(e))t+=e.textContent;else if(Z(e));else for(const n of Array.from(e.childNodes))t+=Q(n);return t}const Y=new RegExp(c.U3,"g");function J(e){return e.replace(Y,"")}const X={[l.qyI]:{deleteEndToken:new RegExp(`${l.qyI}$`,"g"),deleteToken:new RegExp(`(${l.qyI})([^${c.U3}])`,"g"),existingToken:new RegExp(`${l.qyI}${c.U3}`,"g")},[l.fuX]:{deleteEndToken:new RegExp(`${l.fuX}$`,"g"),deleteToken:new RegExp(`(${l.fuX})([^${c.U3}])`,"g"),existingToken:new RegExp(`${l.fuX}${c.U3}`,"g")}};function ee(e,t){if(!t)return"";let n=Q(t);if(e.device.isAndroid)for(const[o,i]of Object.entries(X))n=n.replace(i.deleteEndToken,"").replace(i.deleteToken,"$2").replace(i.existingToken,o);return"\n"===n[n.length-1]&&(n=n.substring(0,n.length-1)),n}function te(e,t,n){if(!e)return!1;let o=n,i=t;for(;i!==e&&!q(i);){const{parentNode:e}=i;if(!e)break;o=M.oG(e,i),i=e}if(q(i))return o>0;const r=d.cx(e.childNodes,q);return!(r<0)&&(i===e&&o>r)}function ne(e,t){const n=(0,x.X1)(e);if(!n)return;const o=H(e,t),i=V(e);return{index:o,forceEmit:Boolean(i),afterEndOfLine:te(n,e,t)}}function oe(e,t){if(t||(t=F.get()),t){const e=H(t.startContainer,t.startOffset),n=H(t.endContainer,t.endOffset),o=V(t.startContainer)||V(t.endContainer);return{selection:{startIndex:e,endIndex:n},forceEmitSelectionStore:Boolean(o)}}}function ie(e,t,n){const o=K(e,t),i=K(e,n);return F.rangeFromContainerOffsets({start:o,end:i})}function re(e,t,n,o){if(e===n&&t===o)return!0;if(N(e)!==N(n))return!1;if(L(e)!==L(n))return!1;const i=(0,x.X1)(e),r=(0,x.X1)(n);if(i!==r)return!1;if(H(e,t)!==H(n,o))return!1;return te(i,e,t)===te(r,n,o)}function ae(e,t){return!e&&!t||!(!e||!t)&&(e.startOffset===t.startOffset&&e.endOffset===t.endOffset&&e.startContainer===t.startContainer&&e.endContainer===t.endContainer||z(e.startContainer)&&z(t.startContainer)&&re(e.startContainer,e.startOffset,t.startContainer,t.startOffset)&&re(e.endContainer,e.endOffset,t.endContainer,t.endOffset))}function se(e){const{environment:t,event:n,textValue:o,editorNode:i,store:r,canEdit:a,disableEquationInteraction:s}=e,l=ue({event:n,textValue:o,editorNode:i});(t.device.isFirefox||"editing"!==C.default.state.mode||C.default.isEmptySelection()||l&&(0,P.Xu)(l.node))&&l&&(s&&(0,P.Xu)(l.node)||p.VO({environment:t,event:n,interactiveToken:l,store:r,canEdit:a}))}function le(e){const{environment:t,event:n,textValue:o,editorNode:i,store:r,parentStore:a,canEdit:s}=e,l=ue({event:n,textValue:o,editorNode:i});l&&p.ON({environment:t,event:n,interactiveToken:l,store:r,parentStore:a,canEdit:s})}function ce(e){const{environment:t,event:n,textValue:o,editorNode:i,store:r,canEdit:a}=e,s=ue({event:n,textValue:o,editorNode:i});s&&p.Nh({environment:t,event:n,interactiveToken:s,store:r,canEdit:a})}function de(e){const{environment:t,event:n,textValue:o,editorNode:i,store:r,canEdit:a}=e;if(n.target===i)return void f.lY({relatedNode:i});const s=ue({event:n,textValue:o,editorNode:i});s&&p.Zl({environment:t,event:n,interactiveToken:s,store:r,canEdit:a})}function ue(e){const{event:t,textValue:n,editorNode:o}=e,i=M.sh(t.target,(e=>Boolean(e.getAttribute&&e.getAttribute("data-token-index"))));if(i&&null!=o&&o.contains(i)){const e=i.getAttribute("data-token-index");if(e){const t=parseInt(e,10);if(n){const e=n[t];if(e)return{textValue:n,tokenIndex:t,textToken:e,node:i}}}}}function pe(e){return fe({store:e.store,temporaryAnnotation:l.GKr.TemporaryComment,multiSelection:g.Z.state.open&&"inline"===g.Z.state.type?g.Z.state.multiSelection:void 0})}function me(e){const{blockId:t,textProps:n}=e;let{textValue:o}=e;if(!o||"none"===n.type)return o;const{currentFocusedResult:i,findQuery:r}=k.Z.state;if(!r||0===r.length)return o;return(0,A.ub)({textValue:o,find:r,intl:y.default.getIntl()}).forEach(((e,r)=>{let{selection:a}=e,s=!1;if("block_match"===n.type){s="block"===(null==i?void 0:i.type)&&t===(null==i?void 0:i.id)&&d.Xy(a,i.selection)}else if("collection_child_page"===n.type){s="inline_collection_child_page"===(null==i?void 0:i.type)&&(null==i?void 0:i.propertyId)===n.propertyId&&d.Xy(a,i.selection)&&i.id===t}const c=s?l.GKr.TemporarySelectedFindHighlight:l.GKr.TemporaryFindHighlight;o=l.aSf({textValue:o,selection:a,annotation:[c]})})),o}function fe(e){const{store:t,temporaryAnnotation:n,multiSelection:o}=e,i=t.getValue();if(o){const e=(0,R.L5)(o).find((e=>{let{store:n}=e;return n===t}));if(e){const{selection:t}=e;return l.aSf({textValue:i,selection:t,annotation:[n]})}}return i}function ge(e){const{store:t,equationStore:n}=e;if(!n.isOpen())return;const o=(0,_.QY)(n.state.savedTextSelectionState.multiSelection);if(!o)return;const{store:i,selection:r}=o;if(t!==i)return;const a=i.getValue(),s=r.startIndex===r.endIndex?a:l._QS(a,r.startIndex,r.endIndex),c=P.qZ({equationState:n.state,isTemporary:!0});return c?l.P$X(s,[c],r.startIndex):void 0}function he(e){const{store:t,selection:n}=e,o=t.getValue();if(n.startIndex+1!==n.endIndex)return o;const i=l.b1T(o,n.startIndex);if(!i||!l.eOb(i))return o;const r=n.startIndex===n.endIndex?o:l._QS(o,n.startIndex,n.endIndex),a=(0,u.uh)(i[1],l.rIb),s=[i[0],[...a,l.EPB()]];return l.P$X(r,[s],n.startIndex)}function ve(e){const{store:t,mentionMenuState:n}=e,o=t.getValue();if(n.textStore!==t)return o;const i=n.temporaryInputData.state;if(!i)return o;const r=(0,B.O2)(t,n.oldTextValue,i.prefix);if(r&&r.prefix){const{tokensBeforeRange:e,tokensInsideRange:t,tokensAfterRange:n}=l.xrQ(o,r.prefix.startIndex,r.filter.endIndex),a=l.QaF(t);return[...e,l.V3y(a,[l.mF$(i)]),...n]}return o}function be(e){const{store:t,slashMenuState:n,hint:o}=e,i=t.getValue();if(n.textStore!==t)return i;if(n.filter.length>0)return i;const r=(0,B.O2)(t,n.oldTextValue,m.pZ());if(r&&r.prefix){const{tokensBeforeRange:e,tokensInsideRange:t,tokensAfterRange:n}=l.xrQ(i,r.prefix.startIndex,r.filter.endIndex),a=l.QaF(t);return[...e,l.V3y(a,[l.rB1({hint:o})]),...n]}return i}function ye(e){const{store:t,selection:n}=e,o=t.getValue(),{tokensBeforeRange:i,tokensInsideRange:r,tokensAfterRange:a}=l.xrQ(o,n.startIndex,n.endIndex),s=l.QaF(r);return[...i,l.V3y(s,[[l.GKr.TemporarySelection]]),...a]}function _e(e){let{store:t,textValue:n}=e;if(!n)return n;if(t.table!==s.iU)return n;const o=I.G.createChildStore(t,{table:t.table,id:t.id});if(o.isInsideCollection()||o.isType("callout")||o.isType("code"))return n;let i=n;return(0,E.bB)((0,E.yJ)(o)).unresolved.forEach((e=>{const t=["m",e.id];i=l.aSf({textValue:i,annotation:t,selection:{startIndex:0,endIndex:1/0}})})),i}function Se(e){if(e.nodeType===Node.TEXT_NODE)return e;if(M.kK(e)&&"false"===e.getAttribute("contentEditable"))return e;let t;const n=M.kd(e);return n.forEach((e=>{null!==e.textContent&&e.textContent.indexOf("\n")>=0&&(t=e)})),t||(n.length>0?n[n.length-1]:e)}function we(e){const t=F.get();if(!t)return;const n=t.startContainer,o=(0,x.X1)(n),i=null==o?void 0:o.childNodes,r=!F.isExpanded(t);if(i&&(i.length>1||r)){const r=(0,x.g4)(n,o),g=d.cx(i,(e=>e===r));let h,v,b=!0,y=n,_=t.startOffset;if(0===_)for(let e=g-1;b&&e>=0;e--){const t=Se(i[e]);if(t.nodeType===Node.TEXT_NODE){var a;const e=null===(a=t.textContent)||void 0===a?void 0:a.lastIndexOf("\n");var s,l;if(void 0!==e&&e>=0)null!==(s=t.textContent)&&void 0!==s&&s.length&&e+1<(null===(l=t.textContent)||void 0===l?void 0:l.length)&&(y=t,_=e+1),b=!1;else y=t,_=0}else y=t,_=0}b=!0;for(let e=g;b&&e<i.length;e++){const t=Se(i[e]);if(t.nodeType===Node.TEXT_NODE){let e;var c,u,p,m;if(y===t)e=null===(c=t.textContent)||void 0===c?void 0:c.indexOf("\n",_);else e=null===(u=t.textContent)||void 0===u?void 0:u.indexOf("\n");if(void 0!==e&&e>=0)h=t,v=e+1===(null===(p=t.textContent)||void 0===p?void 0:p.length)?e:e+1,b=!1;else h=t,v=(null===(m=t.textContent)||void 0===m?void 0:m.length)||0}else{var f;h=t,v=(null===(f=t.textContent)||void 0===f?void 0:f.length)||0}}if(y&&h){const t=F.rangeFromContainerOffsets({start:{container:y,offset:_},end:{container:h,offset:v||0}});F.set(t,e)}}}function ke(e,t){const n=l.$0A(e.id,e.getSpaceId()),o=l.YCD(n);return{textValue:[o],tokenIndex:0,textToken:o,node:t}}},70764:(e,t,n)=>{n.d(t,{NP:()=>s,QS:()=>f,mO:()=>c,sw:()=>m,xt:()=>p});var o=n(20270),i=n(9291),r=(n(95477),n(77080)),a=n(30874);function s(e){const t=a.Z.state;return t.loaded?t.bots.filter((t=>t.integration_id===e)):[]}const l=(0,i.defineMessages)({invalidRequest:{id:"unfurlingHelpers.authenticatedErrorDescription.invalidRequest",defaultMessage:"The authentication request is invalid. Please contact support if issue persists."},unauthorizedClient:{id:"unfurlingHelpers.unauthorizedClient.",defaultMessage:"The client is not authorized to request an authorization code using this method. Please contact support if issue persists."},accessDenied:{id:"unfurlingHelpers.authenticatedErrorDescription.accessDenied",defaultMessage:"The resource owner or authorization server denied the request. Check with your organization or resource owner to ensure OAuth installation is enabled."},unsupportedResponseType:{id:"unfurlingHelpers.authenticatedErrorDescription.unsupportedResponseType",defaultMessage:"The authorization server does not support obtaining an authorization code using this method. Please contact support if issue persists."},invalidScope:{id:"unfurlingHelpers.authenticatedErrorDescription.invalidScope",defaultMessage:"The requested scope is invalid. Please contact support if issue persists."},serverError:{id:"unfurlingHelpers.authenticatedErrorDescription.serverError",defaultMessage:"The authorization server encountered an unexpected condition that prevented it from fulfilling the request. Please contact support if issue persists."},temporarilyUnavailable:{id:"unfurlingHelpers.authenticatedErrorDescription.temporarilyUnavailable",defaultMessage:"The authorization server is currently unable to handle the request due to a temporary overloading or maintenance of the server. Please contact support if issue persists."},githubAppRequestAccessUnsupported:{id:"unfurlingHelpers.authenticatedErrorDescription.githubAppRequestAccessUnsupported",defaultMessage:"Request Access is not supported. You must be both a Github Admin and Notion Workspace Admin to connect the two apps."},unknownError:{id:"unfurlingHelpers.authenticatedErrorDescription.unknownError",defaultMessage:"The authorization server responded with an unknown error (`{value}`). Please contact support if issue persists."}});function c(e){return"invalid_request"===e?l.invalidRequest:"unauthorized_client"===e?l.unauthorizedClient:"access_denied"===e?l.accessDenied:"unsupported_response_type"===e?l.unsupportedResponseType:"invalid_scope"===e?l.invalidScope:"server_error"===e?l.serverError:"temporarily_unavailable"===e?l.temporarilyUnavailable:"github_app_request_access_unsupported"===e?l.githubAppRequestAccessUnsupported:l.unknownError}const d=(0,i.defineMessages)({unknownError:{id:"unfurlingHelpers.unfurlResponseError.unknownError",defaultMessage:"Can't load preview"},accessDenied:{id:"unfurlingHelpers.unfurlResponseError.accessDenied",defaultMessage:"Access denied"},reAuthenticate:{id:"unfurlingHelpers.unfurlResponseError.reAuthenticate",defaultMessage:"Re-authentication necessary"},notFound:{id:"unfurlingHelpers.unfurlResponseError.notFound",defaultMessage:"Content not found"},unprocessableEntity:{id:"unfurlingHelpers.unfurlResponseError.unprocessableEntity",defaultMessage:"Unrecognized URL"},rateLimited:{id:"unfurlingHelpers.unfurlResponseError.rateLimited",defaultMessage:"Too many requests"},serverError:{id:"unfurlingHelpers.unfurlResponseError.serverError",defaultMessage:"Can't load preview"},invalidRequest:{id:"unfurlingHelpers.unfurlResponseError.invalidRequest",defaultMessage:"Can't load preview"},authRefresh:{id:"unfurlingHelpers.unfurlResponseError.authRefresh",defaultMessage:"Fetching Preview"},githubNotAcceptable:{id:"unfurlingHelpers.unfurlResponseError.githubNotAcceptable",defaultMessage:"Need owner role"},jiraNotAcceptable:{id:"unfurlingHelpers.unfurlResponseError.jiraNotAcceptable",defaultMessage:"Synced in another workspace"},notAcceptable:{id:"unfurlingHelpers.unfurlResponseError.notAcceptable",defaultMessage:"Not Acceptable"},databaseSyncLimit:{id:"unfurlingHelpers.unfurlResponseError.databaseSyncLimit",defaultMessage:"Synced Database limit reached"}}),u=(0,i.defineMessages)({unknownError:{id:"unfurlingHelpers.unfurlResponseErrorDescription.unknownError",defaultMessage:'There was an error trying to get information for this resource. Received error code "{statusCode}".'},accessDenied:{id:"unfurlingHelpers.unfurlResponseErrorDescription.accessDenied",defaultMessage:"You do not have appropriate permission to access this resource."},reAuthenticate:{id:"unfurlingHelpers.unfurlResponseErrorDescription.reAuthenticate",defaultMessage:"You need to re-authenticate your account to access this resource."},notFound:{id:"unfurlingHelpers.unfurlResponseErrorDescription.notFound",defaultMessage:"The resource information for this link could not be found. It may no longer exist or you may not have appropriate permission to access it."},unprocessableEntity:{id:"unfurlingHelpers.unfurlResponseErrorDescription.unprocessableEntity",defaultMessage:"This url is not currently embedable by this integration."},rateLimited:{id:"unfurlingHelpers.unfurlResponseErrorDescription.rateLimited",defaultMessage:'"{integrationName}" received too many requests for you or your organization. Please wait a few minutes and try again.'},serverError:{id:"unfurlingHelpers.unfurlResponseErrorDescription.serverError",defaultMessage:'Oh no! Seems like there was a "{integrationName}" server error. Received error code "{statusCode}".'},invalidRequest:{id:"unfurlingHelpers.unfurlResponseErrorDescription.invalidRequest",defaultMessage:'There was an error trying to get information for this resource. Received error code "{statusCode}".'},authRefresh:{id:"unfurlingHelpers.unfurlResponseErrorDescription.authRefresh",defaultMessage:"Fetching Preview via Login Update, please wait."},githubNotAcceptable:{id:"unfurlingHelpers.unfurlResponseErrorDescription.githubNotAcceptable",defaultMessage:"You do not have appropriate permission to sync this resource. You need to have an owner role."},jiraNotAcceptable:{id:"unfurlingHelpers.unfurlResponseErrorDescription.jiraNotAcceptable",defaultMessage:"You have synced this resource in another workspace."},notAcceptable:{id:"unfurlingHelpers.unfurlResponseErrorDescription.notAcceptable",defaultMessage:"You do not have appropriate permission to sync this resource. You need to have an owner role."},databaseSyncLimit:{id:"unfurlingHelpers.unfurlResponseErrorDescription.databaseSyncLimit",defaultMessage:"Your workspace has hit the Synced Database limit."}});function p(e,t){return void 0===e?{message:d.unknownError,description:u.unknownError}:401===e?{message:d.reAuthenticate,description:u.reAuthenticate}:439===e?{message:d.authRefresh,description:u.authRefresh}:403===e?{message:d.accessDenied,description:u.accessDenied}:404===e?{message:d.notFound,description:u.notFound}:422===e?{message:d.unprocessableEntity,description:u.unprocessableEntity}:429===e?{message:d.rateLimited,description:u.rateLimited}:406===e?"jira"===t?{message:d.jiraNotAcceptable,description:u.jiraNotAcceptable}:"github"===t?{message:d.githubNotAcceptable,description:u.githubNotAcceptable}:{message:d.notAcceptable,description:u.notAcceptable}:417===e?{message:d.databaseSyncLimit,description:u.databaseSyncLimit}:(0,o.Ms)(e)?{message:d.serverError,description:u.serverError}:{message:d.invalidRequest,description:u.invalidRequest}}function m(e){return!e.device.isMobileBrowser}function f(){return"on"===r.default.getGroup("beta-developers-external")}},15010:(e,t,n)=>{n.d(t,{JF:()=>a,QZ:()=>r,WD:()=>l,e2:()=>s});n(92996);var o=n(44317),i=(n(40663),n(80444));function r(){const{currentUserSettingsStore:e,currentSpaceStore:t}=i.default.state,n=(null==e?void 0:e.getSettings())||{},o=null==t?void 0:t.getPlanType();return"professional"===n.domain_type&&"team"===o}function a(){const{currentUserSettingsStore:e}=i.default.state;return((null==e?void 0:e.getSettings())||{}).domain_type}function s(e){const t=e.getSettings(),n=null==t?void 0:t.signup_time;return n?(0,o.O5)(n):null}function l(e){const{currentUserSettingsStore:t}=i.default.state;if(t&&t.id===e.currentUser.id)return t}},56518:(e,t,n)=>{n.d(t,{Ef:()=>k,FQ:()=>I,Gp:()=>v,IU:()=>f,Li:()=>g,X4:()=>y,ZI:()=>S,ax:()=>w,nZ:()=>b,tt:()=>h,xF:()=>m});var o=n(15145),i=n(1800),r=n(42875),a=n(25718),s=n(482),l=n(74446),c=n(21202),d=n(1898),u=n(95477),p=n(33929);const m="paste";function f(e){let t,n;const o=new Set,i=new Set;for(const r of e){const e=r.getParentBlockStore();if(e&&"column"===e.getType()){o.add(e.id),i.add(r.id);const a=e.getParentBlockStore();if(a&&"column_list"===a.getType()){n=a.getSpaceId();const e=a.id;if(void 0===t&&(t=e),t!==e)return}}}if(t&&o.size>1&&n)return{columnListId:t,columnIds:o,blockIds:i,spaceId:n}}function g(e,t){if(!e.clipboardData)return;const n=e.clipboardData.getData("text/html");e.clipboardData.setData("text/html",`${n}${v(t)}`)}function h(e){if(!e.clipboardData)return;return b(e.clipboardData.getData("text/html"))}function v(e){return`\x3c!-- notionvc: ${e} --\x3e`}function b(e){const t=e.match(/\<\!-- notionvc\: ([0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}) --\>$/i);return t?t[1]:void 0}function y(e){const{blockValues:t,rootBlock:n,getRecordValue:o,isWindows:i,markdownSerializationOptions:r,markdownLinkifyIt:s}=e;let l=a.on(t,{...w({rootBlock:n,getRecordValue:o}),transformAnnotation:null==r?void 0:r.transformAnnotation,transformBlockMapping:null==r?void 0:r.transformBlockMapping});const c={markdown:void 0,html:void 0};if(l){l=l.replaceAll(_,"$1"),c.markdown=S(i,l);const e=s&&a.c8({...s,markdown:l});e&&(c.html=S(i,e))}return c}const _=/\[(https?:\/\/[^\])]+)\]\(\1\)/g;function S(e,t){return e?t.split("\r\n").reduce(((e,t)=>[...e,...t.split("\n")]),[]).join("\r\n"):t}function w(e){const{rootBlock:t,getRecordValue:n}=e;return{root:t,navigableBlockId:t.id,renderParentBlockId:void 0,blockId:t.id,userTimeZone:(0,r.r)(),intl:p.default.getIntl(),getRecordValue:n,numberedListCache:{},bulletedListCache:{},getRecordsWithParent:()=>[],getExportedPathToFile:e=>{let{toFileURI:t}=e;return t},getExportedRenderAsset:e=>{let{toFileURI:t}=e;return t},getExportedPathToPage:e=>{let{toPageId:t}=e;return(0,i.Z)({pageId:t,pageValue:n({table:c.iU,id:t}),baseUrl:u.default.domainBaseUrl,pageVisitSource:o.tY.Export})},baseUrl:u.default.domainBaseUrl,publicDomainName:u.default.publicDomainName,resultCache:new Map}}function k(e){const{rootBlock:t,clipboardData:n,isWindows:o,fallbackGetRecordValue:i,markdownSerializationOptions:r,markdownLinkifyIt:a}=e,{tree:s,blockSelection:c}=n,u=l.mF.tryUntilFound(...c.blocks.map((e=>e.blockSubtree&&l.mF.fromRecordMap(e.blockSubtree))).filter(d.$K),i),p=s.value,m=c.blocks.map((e=>u({...p,id:e.blockId}))).filter(d.$K);return y({rootBlock:t,getRecordValue:u,blockValues:m,isWindows:o,markdownSerializationOptions:r,markdownLinkifyIt:a})}function I(e){const t=e.pointerPath[e.pointerPath.length-1];return[s.op.set({pointer:t,path:e.attributePath,args:e.copiedText})]}},75079:(e,t,n)=>{n.d(t,{Pn:()=>l,Pp:()=>f,Y5:()=>p,ZO:()=>d,vS:()=>c,yr:()=>m});var o=n(43690),i=n(82138),r=n(58421),a=n(77080),s=n(77144);function l(e,t){const n=null==e?void 0:e.collectionViewBlockStore(),o=null==e?void 0:e.collectionStore(),i=null==e?void 0:e.collectionViewStore(),a=null==e?void 0:e.filtersBarOpenStore.state,s=null==i?void 0:i.getType(),l=(null==e?void 0:e.settingsStore)&&(0,r.n)(null==e?void 0:e.settingsStore),c=null==n?void 0:n.id;return{view_type:s,context_type:null==e?void 0:e.contextType,is_compact_view:null==e?void 0:e.isCompactView.state,settings_menu:null!=e&&e.settingsStore.state.open&&l?l.type:void 0,collection_id:t||(null==o?void 0:o.id),collection_view_id:null==i?void 0:i.id,collection_view_block_id:c,filters_bar_open:a,is_in_wiki:null==n?void 0:n.isCollectionViewPageWithContent(),personal_home_type:null==e?void 0:e.getPageVisitSourceOverride(),database_visit_id:null==e?void 0:e.visitSessionId}}function c(e,t){var n,i,r,a,s,l,c;if(!e)return{view_type:"missing_context_store",row_count_category:"missing_context_store",column_count_category:"missing_context_store",has_relation_column:"missing_context_store",has_rollup_column:"missing_context_store",has_formula_column:"missing_context_store",is_client_mode_enabled:"missing_context_store",tracking_source:void 0,collection_view_block_id:"missing_context_store",collection_view_id:"missing_context_store",collection_id:"missing_context_store",collection_type:"missing_context_store",has_groups:"missing_context_store",has_aggregations:"missing_context_store",database_visit_id:"missing_context_store"};const p=e.isClientModeEnabled.state,m=(null===(n=e.collectionViewBlockStore())||void 0===n?void 0:n.id)||"missing",f=(null===(i=e.collectionViewStore())||void 0===i?void 0:i.id)||"missing",g=(null===(r=e.collectionStore())||void 0===r?void 0:r.id)||"missing",h=null===(a=e.collectionViewStore())||void 0===a?void 0:a.getCollectionSource(),v=null===(s=e.collectionStore())||void 0===s?void 0:s.getSchema();if(!v)return{view_type:"missing_schema",row_count_category:"missing_schema",column_count_category:"missing_schema",has_relation_column:"missing_schema",has_rollup_column:"missing_schema",has_formula_column:"missing_schema",is_client_mode_enabled:p,tracking_source:t,collection_view_block_id:m,collection_view_id:f,collection_id:g,collection_type:(null==h?void 0:h.type)||"missing",has_groups:"missing_schema",has_aggregations:"missing_schema",database_visit_id:e.visitSessionId};const{has_relation_column:b,has_rollup_column:y,has_formula_column:_}=function(e){const t="missing_schema";if(void 0===e)return{has_relation_column:t,has_rollup_column:t,has_formula_column:t};let n=!1,o=!1,i=!1;for(const r of Object.values(e))if("relation"===(null==r?void 0:r.type)&&(n=!0),"rollup"===(null==r?void 0:r.type)&&(o=!0),"formula"===(null==r?void 0:r.type)&&(i=!0),n&&o&&i)break;return{has_relation_column:n,has_rollup_column:o,has_formula_column:i}}(v),S=null===(l=e.remoteRequestStore.state)||void 0===l?void 0:l.loader;let w="missing",k="missing";return S&&(w=o.LU(S),k=o.sn(S)),{view_type:e.getViewType()||"unknown",row_count_category:d(null===(c=e.remoteResult.state)||void 0===c?void 0:c.sizeHint),column_count_category:u(v),has_relation_column:b,has_rollup_column:y,has_formula_column:_,is_client_mode_enabled:p,tracking_source:t,collection_view_block_id:m,collection_view_id:f,collection_id:g,collection_type:(null==h?void 0:h.type)||"missing",has_groups:w,has_aggregations:k,database_visit_id:e.visitSessionId}}function d(e){return void 0===e?"unknown":e<=100?"0-100":e<=200?"100-200":e<=300?"200-300":e<=400?"300-400":e<=500?"400-500":e<=600?"500-600":e<=700?"600-700":e<=800?"700-800":e<=900?"800-900":e<=1e3?"900-1000":"1001_or_more"}function u(e){const t=Object.keys(e).length;return t<=10?"0-10":t<=20?"10-20":t<=50?"20-50":"51_or_more"}function p(e){const{from:t,collectionContextStore:n,sizeHintAtStart:o}=e,i=c(n),{row_count_category:r,...a}=i;return{...a,from:t,property_type:"property_type"in e?e.property_type:void 0,did_trigger_fetch:n?n.isLoading.state:"missing_context_store",row_count_category:d(o)}}function m(e){const{collectionContextStore:t,is_native_drop:n,is_empty:o}=e;return{...c(t),is_native_drop:n,is_empty:o}}function f(e){var t;const{environment:n,collectionContextStore:r,visibleItemsCount:l}=e,d=c(r),u=r.remoteResult.state?o.aW({result:r.remoteResult.state}).length:0,p=0===u?void 0:l/u;return{...d,percentage_of_remote_result_visible:void 0===p?"empty_remote_result":0===p?"0":p<=.25?"0-25":p<=.5?"25-50":p<=.75?"50-75":p<1?"75-100":1===p?"100":"greater_than_100",wasm_sqlite_initialized:s.Z.state.metricData.state.wasm_sqlite_initialized,did_prefetch:"hit-match"===(null===(t=n.prefetchCache)||void 0===t||null===(t=t.getPrefetchAnalytic("queryCollection"))||void 0===t?void 0:t.type),split_aggregation_experiment:a.default.getEligibleGroup({experimentId:"collection_split_aggregation_v3",defaultGroup:"unassigned"}),is_mobile_background_launch:(0,i.Z)()}}},17335:(e,t,n)=>{n.d(t,{$7:()=>_,D0:()=>k,Fc:()=>S,HL:()=>x,IF:()=>A,KV:()=>G,Qz:()=>$,SW:()=>Y,Sb:()=>w,Sj:()=>y,WC:()=>v,_T:()=>R,cq:()=>B,ip:()=>T,li:()=>W,qh:()=>z,rn:()=>m,x:()=>C,xe:()=>J,zZ:()=>g});var o=n(2032),i=n(76205),r=n(34299),a=n(35102),s=n(4308),l=n(9291),c=n(53965),d=n(1898),u=n(33929);const p={text:{operator:"string_contains",value:{type:"exact",value:void 0}},relation:{operator:"relation_contains",value:{type:"exact",value:void 0}},url:{operator:"string_contains",value:{type:"exact",value:void 0}},checkbox:{operator:"checkbox_is",value:{type:"exact",value:void 0}},created_by:{operator:"person_contains",value:{type:"exact",value:void 0}},last_edited_by:{operator:"person_contains",value:{type:"exact",value:void 0}},select:{operator:"enum_is",value:{type:"exact",value:void 0}},multi_select:{operator:"enum_contains",value:{type:"exact",value:void 0}},status:{operator:"status_is",value:{type:"is_group",value:void 0}},person:{operator:"person_contains",value:{type:"exact",value:void 0}},number:{operator:"number_equals",value:{type:"exact",value:void 0}},auto_increment_id:{operator:"number_equals",value:{type:"exact",value:void 0}},date:{operator:"date_is_relative_to",value:{type:"relative",value:"surrounding",unit:"week"}},created_time:{operator:"date_is",value:{type:"exact",value:void 0}},last_edited_time:{operator:"date_is",value:{type:"exact",value:void 0}},last_visited_time:{operator:"date_is",value:{type:"exact",value:void 0}},email:{operator:"string_contains",value:{type:"exact",value:void 0}},phone_number:{operator:"string_contains",value:{type:"exact",value:void 0}},title:{operator:"string_contains",value:{type:"exact",value:void 0}},file:{operator:"is_empty"},location:{operator:"location_is",value:{type:"exact",value:void 0}},verification:{operator:"verification_is",value:{type:"exact",value:void 0}}};function m(e){return p[e]}function f(e){return"v2"===e.version?function(e){if(!e.formula2)return{operator:"is_empty"};const t=e.formula2.result_type;if("array"===t.type){const e=(0,a.B8)(t.of);return"array"===e.type||"function"===e.type?{operator:"is_empty"}:"block"===e.type||"unknown"===e.type?{operator:"any",subfilter:m("text")}:{operator:"any",subfilter:m(e.type)}}if("unknown"===t.type||"block"===t.type)return m("text");return m(t.type)}(e):function(e){return e.formula&&e.formula.result_type?m(e.formula.result_type):{operator:"is_empty"}}(e)}function g(e){const{property:t,schema:n}=e,a=n[t];if(!a||"button"===a.type)return{operator:"is_empty"};if("formula"===a.type)return f(a);if("rollup"===a.type){if(a.aggregation&&"show_unique"!==a.aggregation){return m((0,o.W6)((0,o.gu)(a.aggregation)))}{const t=(0,r.gT)(e);if(!t){return{operator:"any",subfilter:{operator:"is_empty"}}}if("rollup"===t.targetPropertySchema.type){return{operator:"any",subfilter:{operator:"is_empty"}}}if("formula"===t.targetPropertySchema.type){const e=f(t.targetPropertySchema);if((0,i.a_)(e))return e;return{operator:"any",subfilter:e}}if("button"===t.targetPropertySchema.type)return{operator:"is_empty"};return{operator:"any",subfilter:m(t.targetPropertySchema.type)}}}return m(a.type)}const h=(0,l.defineMessages)({date_is_within:{defaultMessage:"Is between",id:"collectionFilterMenuHelpers.operator.dateIsWithin"},date_is_relative_to:{defaultMessage:"Is relative to today",id:"collectionFilterMenuHelpers.operator.dateIsRelativeTo"},is_empty:{defaultMessage:"Is empty",id:"collectionFilterMenuHelpers.operator.isEmpty"},is_not_empty:{defaultMessage:"Is not empty",id:"collectionFilterMenuHelpers.operator.isNotEmpty"},string_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.stringIs"},string_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.stringIsNot"},string_contains:{defaultMessage:"Contains",id:"collectionFilterMenuHelpers.operator.stringContains"},string_does_not_contain:{defaultMessage:"Does not contain",id:"collectionFilterMenuHelpers.operator.stringDoesNotContain"},string_starts_with:{defaultMessage:"Starts with",id:"collectionFilterMenuHelpers.operator.stringStartsWith"},string_ends_with:{defaultMessage:"Ends with",id:"collectionFilterMenuHelpers.operator.stringEndsWith"},checkbox_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.checkboxIs"},checkbox_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.checkboxIsNot"},enum_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.enumIs"},enum_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.enumIsNot"},enum_contains:{defaultMessage:"Contains",id:"collectionFilterMenuHelpers.operator.enumContains"},enum_does_not_contain:{defaultMessage:"Does not contain",id:"collectionFilterMenuHelpers.operator.enumDoesNotContain"},status_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.statusIs"},status_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.statusIsNot"},person_contains:{defaultMessage:"Contains",id:"collectionFilterMenuHelpers.operator.personContains"},person_does_not_contain:{defaultMessage:"Does not contain",id:"collectionFilterMenuHelpers.operator.personDoesNotContain"},relation_contains:{defaultMessage:"Contains",id:"collectionFilterMenuHelpers.operator.relationContains"},relation_does_not_contain:{defaultMessage:"Does not contain",id:"collectionFilterMenuHelpers.operator.relationDoesNotContain"},location_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.locationIs"},location_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.locationIsNot"},number_equals:{defaultMessage:"=",id:"collectionFilterMenuHelpers.operator.numberEquals"},number_does_not_equal:{defaultMessage:"â‰ ",id:"collectionFilterMenuHelpers.operator.numberDoesNotEqual"},number_greater_than:{defaultMessage:">",id:"collectionFilterMenuHelpers.operator.numberGreaterThan"},number_less_than:{defaultMessage:"<",id:"collectionFilterMenuHelpers.operator.numberLessThan"},number_greater_than_or_equal_to:{defaultMessage:"â‰¥",id:"collectionFilterMenuHelpers.operator.numberGreaterThanOrEqualTo"},number_less_than_or_equal_to:{defaultMessage:"â‰¤",id:"collectionFilterMenuHelpers.operator.numberLessThanOrEqualTo"},date_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.dateIs"},date_is_before:{defaultMessage:"Is before",id:"collectionFilterMenuHelpers.operator.dateIsBefore"},date_is_after:{defaultMessage:"Is after",id:"collectionFilterMenuHelpers.operator.dateIsAfter"},date_is_on_or_before:{defaultMessage:"Is on or before",id:"collectionFilterMenuHelpers.operator.dateIsOnOrBefore"},date_is_on_or_after:{defaultMessage:"Is on or after",id:"collectionFilterMenuHelpers.operator.dateIsOnOrAfter"},any:{defaultMessage:"Any",id:"collectionFilterMenuHelpers.operator.any"},none:{defaultMessage:"None",id:"collectionFilterMenuHelpers.operator.none"},every:{defaultMessage:"Every",id:"collectionFilterMenuHelpers.operator.every"},string_has_no_alphabet_prefix:{defaultMessage:"(Not used)",id:"collectionFilterMenuHelpers.operator.stringHasNoAlphabetPrefix"},verification_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.verificationStateIs"},verification_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.verificationStateIsNot"}});function v(e){return u.default.formatMessage(h[e])}const b=(0,l.defineMessages)({today:{defaultMessage:"Today",id:"collectionFilterMenuHelpers.relativeDates.today"},tomorrow:{defaultMessage:"Tomorrow",id:"collectionFilterMenuHelpers.relativeDates.tomorrow"},yesterday:{defaultMessage:"Yesterday",id:"collectionFilterMenuHelpers.relativeDates.yesterday"},one_week_ago:{defaultMessage:"One week ago",id:"collectionFilterMenuHelpers.relativeDates.oneWeekAgo"},one_week_from_now:{defaultMessage:"One week from now",id:"collectionFilterMenuHelpers.relativeDates.oneWeekFromNow"},one_month_ago:{defaultMessage:"One month ago",id:"collectionFilterMenuHelpers.relativeDates.oneMonthAgo"},one_month_from_now:{defaultMessage:"One month from now",id:"collectionFilterMenuHelpers.relativeDates.oneMonthFromNow"}}),y=(0,l.defineMessages)({past:{defaultMessage:"Past",id:"collectionFilterMenuHelpers.relativeDates.past"},future:{defaultMessage:"Next",id:"collectionFilterMenuHelpers.relativeDates.next"}}),_=(0,l.defineMessages)({direction:{defaultMessage:"Direction",id:"collectionFilterMenuHelpers.relativeDates.direction"},unit:{defaultMessage:"Unit",id:"collectionFilterMenuHelpers.relativeDates.unit"}}),S=(0,l.defineMessages)({this:{defaultMessage:"This",id:"collectionFilterMenuHelpers.relativedates.this"}}),w=(0,l.defineMessages)({day:{defaultMessage:"day",id:"collectionFilterMenuHelpers.relativeDates.day"},week:{defaultMessage:"week",id:"collectionFilterMenuHelpers.relativeDates.week"},month:{defaultMessage:"month",id:"collectionFilterMenuHelpers.relativeDates.month"},year:{defaultMessage:"year",id:"collectionFilterMenuHelpers.relativeDates.year"}}),k=(0,l.defineMessages)({day:{defaultMessage:"days",id:"collectionFilterMenuHelpers.relativeDates.days"},week:{defaultMessage:"weeks",id:"collectionFilterMenuHelpers.relativeDates.weeks"},month:{defaultMessage:"months",id:"collectionFilterMenuHelpers.relativeDates.months"},year:{defaultMessage:"years",id:"collectionFilterMenuHelpers.relativeDates.years"}}),I=(0,l.defineMessages)({exactDate:{defaultMessage:"Custom date",id:"collectionFilterMenuHelpers.relativeDates.exactDate"},exactDateRange:{defaultMessage:"Exact dates",id:"collectionFilterMenuHelpers.relativeDates.exactDateRange"}});function C(e){return"exact"===e.type?u.default.formatMessage(I.exactDate):u.default.formatMessage(b[e.value])}const x=(0,l.defineMessages)({custom:{defaultMessage:"Relative range",id:"collectionFilterMenuHelpers.relativeDates.range"},surrounding:{defaultMessage:"Surrounding range",id:"collectionFilterMenuHelpers.relativeDates.customRange"},this_week:{defaultMessage:"This week",id:"collectionFilterMenuHelpers.relativeDates.thisWeek"},the_past_week:{defaultMessage:"The past week",id:"collectionFilterMenuHelpers.relativeDates.thePastWeek"},the_past_month:{defaultMessage:"The past month",id:"collectionFilterMenuHelpers.relativeDates.thePastMonth"},the_past_year:{defaultMessage:"The past year",id:"collectionFilterMenuHelpers.relativeDates.thePastYear"},the_next_week:{defaultMessage:"The next week",id:"collectionFilterMenuHelpers.relativeDates.theNextWeek"},the_next_month:{defaultMessage:"The next month",id:"collectionFilterMenuHelpers.relativeDates.theNextMonth"},the_next_year:{defaultMessage:"The next year",id:"collectionFilterMenuHelpers.relativeDates.theNextYear"}});function T(e){return"custom"===e.value?function(e){const t=u.default.formatMessage(y[e.direction]),n=1===e.count?u.default.formatMessage(w[e.unit]):u.default.formatMessage(k[e.unit]);return 1===e.count?`${t} ${n}`:`${t} ${e.count} ${n}`}(e):"surrounding"===e.value?function(e){const t=u.default.formatMessage(w[e.unit]);return`${u.default.formatMessage(S.this)} ${t}`}(e):"exact"===e.type?u.default.formatMessage(I.exactDateRange):"relative"===e.type?u.default.formatMessage(x[e.value]):void(0,d.t1)(e)}const M=(0,l.defineMessages)({start_date:{defaultMessage:"Start date",id:"collectionFilterMenuHelpers.dateFilterModes.start_date"},end_date:{defaultMessage:"End date",id:"collectionFilterMenuHelpers.dateFilterModes.end_date"}}),P=(0,l.defineMessages)({start_date:{defaultMessage:"For date ranges, filters on the start date. For individual dates, filters on the date.",id:"collectionFilterMenuHelpers.dateFilterModesTooltip.start_date"},end_date:{defaultMessage:"For date ranges, filters on the end date. For individual dates, filters on the date.",id:"collectionFilterMenuHelpers.dateFilterModesTooltip.end_date"}});function A(e){return u.default.formatMessage(M[e])}function R(e){return u.default.formatMessage(P[e])}const D=(0,l.defineMessages)({and:{defaultMessage:"And",id:"collectionFilterMenuHelpers.combinatorOperators.and"},or:{defaultMessage:"Or",id:"collectionFilterMenuHelpers.combinatorOperators.or"}}),E=(0,l.defineMessages)({checked:{defaultMessage:"Checked",id:"collectionFilterMenuHelpers.checkbox.checked"},unchecked:{defaultMessage:"Unchecked",id:"collectionFilterMenuHelpers.checkbox.unchecked"}});function B(e){return e.value?u.default.formatMessage(s.A3(e.value)):""}function F(e){let{filter:t,schema:n}=e;return N({filter:t.subfilter,schema:n})}function O(e){let{filter:t}=e;return C(t.value)}function Z(e){let{filter:t}=e;return T(t.value)}function V(e){let{filter:t}=e;return`"${t.value.value||""}"`}function U(e){let{filter:t}=e;return void 0===t.value.value?void 0:t.value.value.toString()}function L(e){let{filter:t}=e;return function(e){const t=e.value?E.checked:E.unchecked;return u.default.formatMessage(t)}(t.value)}const j={is_empty:()=>{},is_not_empty:()=>{},string_is:V,string_is_not:V,string_contains:V,string_does_not_contain:V,string_starts_with:V,string_ends_with:V,checkbox_is:L,checkbox_is_not:L,enum_is:V,enum_is_not:V,enum_contains:V,enum_does_not_contain:V,status_is:V,status_is_not:V,relation_contains:()=>{},relation_does_not_contain:()=>{},person_contains:()=>{},person_does_not_contain:()=>{},location_is:()=>{},location_is_not:()=>{},number_equals:U,number_does_not_equal:U,number_greater_than:U,number_less_than:U,number_greater_than_or_equal_to:U,number_less_than_or_equal_to:U,date_is:O,date_is_before:O,date_is_after:O,date_is_on_or_before:O,date_is_on_or_after:O,date_is_within:Z,date_is_relative_to:Z,any:F,none:F,every:F,string_has_no_alphabet_prefix:()=>{},verification_is:V,verification_is_not:V};function N(e){const{filter:t}=e,n=v(t.operator),o=j[t.operator](e);return c.oA([n,o]).join(" ")}function z(e){const{filter:t,schema:n}=e;if((0,i.vA)(t)){const e=t.filters||[],o=c.oA(e.map((e=>{const t=z({filter:e,schema:n});if(t)return(0,i.vA)(e)?`(${t})`:t}))),r=u.default.formatMessage(D[t.operator]);return o.join(` ${r} `)}if((0,i.aN)(t)){const e=n[t.property];if(!e)return;const o=t.filter,i=e.name,r=N({filter:o,schema:n});return c.oA([i,r]).join(" ")}}const q={text:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:"string_has_no_alphabet_prefix"===e.operator?{operator:t}:{operator:t,value:e.value}},number:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},checkbox:function(e,t){return{operator:t,value:e.value}},select:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},multi_select:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},status:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"is_option",value:void 0}}:{operator:t,value:e.value}},relation:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},person:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},date:function(e,t,n){if((0,i._N)(t))return{operator:t};const o=(0,i.mv)(e)?void 0:e.use_end;return"date_is_within"===t?"date_is_within"!==e.operator?{operator:t,value:{type:"exact",value:void 0},use_end:o}:e:"date_is_relative_to"===t?"date_is_relative_to"!==e.operator?{operator:t,value:{type:"relative",value:"surrounding",unit:"week"},use_end:o}:e:(0,i.TQ)(e)?"combinator"===n?{operator:t,value:{type:"relative",value:"today"},use_end:o}:{operator:t,value:{type:"exact",value:void 0},use_end:o}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value,use_end:o}},file:function(e,t){return{operator:t}},location:function(e,t){return{operator:t,value:e.value}},verification:function(e,t){return{operator:t,value:e.value}}};function W(e,t,n,o){return(0,q[e])(t,n,o)}const H=(0,l.defineMessages)({and:{defaultMessage:"And",id:"database.filterOperators.and"},or:{defaultMessage:"Or",id:"database.filterOperators.or"}}),K=(0,l.defineMessages)({and:{defaultMessage:"All filters must match",id:"database.filterOperators.andCaption"},or:{defaultMessage:"At least one filter must match",id:"database.filterOperators.orCaption"}});function G(e,t){return"and"===e?t.formatMessage(H.and):t.formatMessage(H.or)}function $(e,t){return"and"===e?t.formatMessage(K.and):t.formatMessage(K.or)}const Q=(0,l.defineMessages)({any:{defaultMessage:"Any",id:"database.filterOperators.any"},every:{defaultMessage:"Every",id:"database.filterOperators.every"},none:{defaultMessage:"None",id:"database.filterOperators.none"}});function Y(e,t){return"any"===e?t.formatMessage(Q.any):"every"===e?t.formatMessage(Q.every):t.formatMessage(Q.none)}const J=(0,l.defineMessages)({number:{id:"collectionFilterMenuFilter.filterOperators.number.order",defaultMessage:"{operator}{operatorValue}"},text:{id:"collectionFilterMenuFilter.filterOperators.text.order",defaultMessage:"{operator}{operatorValue}"},checkbox:{id:"collectionFilterMenuFilter.filterOperators.checkbox.order",defaultMessage:"{operator}{operatorValue}"},select:{id:"collectionFilterMenuFilter.filterOperators.select.order",defaultMessage:"{operator}{operatorValue}"},multi_select:{id:"collectionFilterMenuFilter.filterOperators.multi_select.order",defaultMessage:"{operator}{operatorValue}"},status:{id:"collectionFilterMenuFilter.filterOperators.status.order",defaultMessage:"{operator}{operatorValue}"},relation:{id:"collectionFilterMenuFilter.filterOperators.relation.order",defaultMessage:"{operator}{operatorValue}"},location:{id:"collectionFilterMenuFilter.filterOperators.location.order",defaultMessage:"{operator}{operatorValue}"},person:{id:"collectionFilterMenuFilter.filterOperators.person.order",defaultMessage:"{operator}{operatorValue}"},date:{id:"collectionFilterMenuFilter.filterOperators.date.order",defaultMessage:"{operator}{operatorValue}"},file:{id:"collectionFilterMenuFilter.filterOperators.file.order",defaultMessage:"{operator}{operatorValue}"},verification:{id:"collectionFilterMenuFilter.filterOperators.verification.order",defaultMessage:"{operator}{operatorValue}"}})},92918:(e,t,n)=>{n.d(t,{Cz:()=>R,F6:()=>Z,II:()=>B,XD:()=>S,_1:()=>F,ar:()=>P,ej:()=>T,ew:()=>k,fZ:()=>C,h6:()=>E,hJ:()=>O,kW:()=>w,nX:()=>I,nr:()=>M,qW:()=>A,xg:()=>x});n(57658);var o=n(92996),i=n(35011),r=n(14714),a=n(99036),s=n(97058),l=n(7057),c=n(53877),d=n(38297),u=n(42875),p=n(23512),m=n(9291),f=n(31701),g=n(53965),h=n(1898),v=n(77080),b=n(65183),y=n(26991),_=n(29376);const S=10,w=10,k=50,I=(0,m.defineMessages)({unsupportedGroupAction:{id:"collectionGroupHelpers.unsupportedGroupAction",defaultMessage:"Selected group is not available for this task."},emptyGroupLabel:{id:"database.boardView.uncategorizedColumnTitle",defaultMessage:"No {name}"},today:{id:"database.collectionGroupValue.dateGroup.today",defaultMessage:"Today"},yesterday:{id:"database.collectionGroupValue.dateGroup.yesterday",defaultMessage:"Yesterday"},last_7_days:{id:"database.collectionGroupValue.dateGroup.last7Days",defaultMessage:"Last 7 days"},last_30_days:{id:"database.collectionGroupValue.dateGroup.last_30Days",defaultMessage:"Last 30 days"},tomorrow:{id:"database.collectionGroupValue.dateGroup.tomorrow",defaultMessage:"Tomorrow"},next_7_days:{id:"database.collectionGroupValue.dateGroup.next7Days",defaultMessage:"Next 7 days"},next_30_days:{id:"database.collectionGroupValue.dateGroup.next30Days",defaultMessage:"Next 30 days"},week_differingStartAndEndYear:{id:"database.collectionGroupValue.dateGroup.week.differingStartAndEndYear",defaultMessage:"Week of {startMonth} {startDay} {startYear} - {endMonth} {endDay} {endYear}"},week_differingStartAndEndMonth:{id:"database.collectionGroupValue.dateGroup.week.differingStartAndEndMonth",defaultMessage:"Week of {startMonth} {startDay} - {endMonth} {endDay} {startYear}"},week_sameStartAndEndMonth:{id:"database.collectionGroupValue.dateGroup.week.sameStartAndEndMonth",defaultMessage:"Week of {startMonth} {startDay}-{endDay} {startYear}"},out_of_range:{id:"database.collectionGroupValue.numberGroup.outOfRange",defaultMessage:"Out of range"},range:{id:"database.collectionGroupValue.numberGroup.range",defaultMessage:"{start} to {end}"}});function C(e){let{intl:t,value:n}=e;if("today"===n.type)return t.formatMessage(I.today);if("yesterday"===n.type)return t.formatMessage(I.yesterday);if("last_7_days"===n.type)return t.formatMessage(I.last_7_days);if("last_30_days"===n.type)return t.formatMessage(I.last_30_days);if("tomorrow"===n.type)return t.formatMessage(I.tomorrow);if("next_7_days"===n.type)return t.formatMessage(I.next_7_days);if("next_30_days"===n.type)return t.formatMessage(I.next_30_days);if("day"===n.type){const e=(0,c.NK)(n.range,(0,u.r)(),t.locale);return(0,l.ZW)(e.start,"medium")}if("week"===n.type){const e=(0,c.NK)(n.range,(0,u.r)(),t.locale),o=(0,l.ZW)(e.start,"month_short"),i=(0,l.ZW)(e.start,"day"),r=e.start.year,a=(0,l.ZW)(e.end,"month_short"),s=(0,l.ZW)(e.end,"day"),d=e.end.year;return r!==d?t.formatMessage(I.week_differingStartAndEndYear,{startMonth:o,startDay:i,endMonth:a,endDay:s,startYear:r,endYear:d}):o!==a?t.formatMessage(I.week_differingStartAndEndMonth,{startMonth:o,startDay:i,endMonth:a,endDay:s,startYear:r}):t.formatMessage(I.week_sameStartAndEndMonth,{startMonth:o,startDay:i,endDay:s,startYear:r})}if("month"===n.type){const e=(0,c.NK)(n.range,(0,u.r)(),t.locale);return(0,l.ZW)(e.start,"month_year_short")}if("year"===n.type){return(0,c.NK)(n.range,(0,u.r)(),t.locale).start.year.toString()}(0,h.t1)(n)}function x(e){let{intl:t,value:n,format:o}=e;if("out_of_range"===n.type)return t.formatMessage(I.out_of_range);if("range"===n.type){const e=p.uf(n.start,o,t),i=p.uf(n.end,o,t);return t.formatMessage(I.range,{start:e,end:i})}if("unique"===n.type){return p.uf(n.value,o,t)}(0,h.t1)(n)}function T(e){const{groupBy:t,schema:n,format:o,filter:i,groupsFormatKey:a,limit:s}=e,l=n[t.property];if(!l||!(0,r.LG)(l))return;const c=o[a]||[],d=c.reduce(((e,t)=>(0,r.eF)(t)?e+1:e),0);return{type:"groups",groupBy:t,filter:i,groupSortPreference:c.map((e=>e.value)),limit:s+d}}function M(e,t,n){const o=e.filter((e=>!(0,r.ZH)(e,t))),i=o.filter((e=>!(0,r.eF)(e))),a=o.filter((e=>(0,r.eF)(e)));return[...i.slice(0,n-1),t,...i.slice(n-1),...a]}function P(e,t){const n=e.filter((e=>!(0,r.ZH)(e,t))),o=n.filter((e=>!(0,r.eF)(e))),i=n.filter((e=>(0,r.eF)(e)));return[...o,t,...i]}function A(e){return!e.device.isPhone&&(e.isFullScreen||e.isRootChild)}function R(e){const{schema:t,groupBy:n,schemaGroups:a,reducerResults:l,relativeVariableResult:c,getRecordModel:d,viewAppConfigUri:u,allowedCollectionStores:p}=e;if(!n)return[];const m=t[n.property];if(!m||!(0,r.LG)(m))return[];const f=new Set(p.map((e=>e.id))),h=[...e.formatGroups,...a&&!l?a.map((e=>({property:n.property,value:e}))):[]];let v;if("manual"===(0,r.mu)(n).type){if(v=h,l)for(const{value:e}of l){const t={property:n.property,value:e};v.push(t)}u===o.sV&&(v=(0,s.gd)(v,e.formatGroups.map((e=>e.value))))}else{const e=new Map;for(const t of h)e.set((0,r.mD)(t),t);v=l?l.map((t=>{let{value:o}=t;return e.get((0,r.Hd)(o))||{property:n.property,value:o}})):[];for(const t of h)v.push(t)}if(l){if(n.hideEmptyGroups){const e=new Set,t=new Set;for(const n of l){const o=(0,r.Hd)(n.value);0===n.total?t.add(o):e.add(o)}v=v.map((n=>{const o=(0,r.mD)(n);if(t.has(o))return{...n,emptyHidden:!0};if(e.has(o)){const e={...n};return delete e.emptyHidden,e}return n}))}else v=v.map((e=>{if(e.emptyHidden){const t={...e};return delete t.emptyHidden,t}return e}));v=u===o.sV&&n.property===o.Es.TaskToSprintRelation?v.map((e=>"relation"===e.value.type&&(0,r.t2)(e.value.value)||void 0===e.value||void 0===e.value.value?e:{...e,hiddenByDefault:!0})):v.map((e=>{if(e.hiddenByDefault){const t={...e};return delete t.hiddenByDefault,t}return e}))}const y=v.filter((e=>{if(e.property!==n.property)return!1;const t=e.value;if(t.type!==m.type)return!1;if(void 0===t.value)return!(0,b.Dt)(m);if("formula"===m.type){const t=(0,i.mm)(m);if(!m.formula&&!m.formula2||"unknown"===t)return!1;if("formula"!==e.value.type||"formula"!==n.type)return!1;const o=e.value.value;if(!o)return!0;if("block"===t&&"text"===o.type)return!0;if(o.type!==t)return!1;const a=n.groupBy;return"relation"===a.type?function(e,t,n){if(!e||!e.value)return!0;if("relation"!==t.type||"relation"!==e.type)return!1;if((0,r.t2)(e.value))return!1;const o=n(e.value);return null==o?void 0:o.alive}(o,{...a,property:n.property},d):D({groupValue:o,groupBy:{property:n.property,...a},getRecordModel:d,relativeVariableResult:c})}return!("location"===t.type&&t.value&&!f.has(t.value.id))&&D({groupValue:t,groupBy:n,getRecordModel:d,relativeVariableResult:c,propertySchema:m})}));return g.mN(y,(e=>(0,r.mD)(e)))}function D(e){const{groupValue:t,groupBy:n,getRecordModel:o,relativeVariableResult:i,propertySchema:a}=e;if(!t.value)return!0;const s=n.type;if("formula"===s)return!1;if("select"===s){if("select"!==(null==a?void 0:a.type))return!1;return(a.options??[]).some((e=>e.value===t.value))}if("multi_select"===s){if("multi_select"!==(null==a?void 0:a.type))return!1;return(a.options??[]).some((e=>e.value===t.value))}if("status"===s){if("status"!==(null==a?void 0:a.type))return!1;const e=a.options??[],o=a.groups??[];if("status"!==t.type)return!1;const{value:i}=t;return"by_group"===i.type?("status"!==s||"group"===n.groupBy)&&o.some((e=>e.name===i.group)):"by_option"===i.type&&(("status"!==s||"option"===n.groupBy)&&e.some((e=>e.value===i.option)))}return(0,r.A1)(s)?function(e,t){if(!e||!e.value)return!0;if(!(0,r.ib)(t)||!(0,r.Mc)(e)||!t.groupBy)return!1;const n=e.value.type;if("relative"===t.groupBy)return"today"===n||"yesterday"===n||"last_7_days"===n||"last_30_days"===n||"tomorrow"===n||"next_7_days"===n||"next_30_days"===n||"month"===n;if("day"===t.groupBy)return"day"===n;if("week"===t.groupBy)return"week"===n;if("month"===t.groupBy)return"month"===n;if("year"===t.groupBy)return"year"===n;(0,h.t1)(t.groupBy)}(t,n):(0,r.HB)(s)?function(e,t){if(!e||!e.value)return!0;if(!(0,r.aB)(t)||!(0,r.R7)(e)||!t.groupBy)return!1;const n=e.value.type;if("alphabet_prefix"===t.groupBy)return"alphabet_prefix"===n||"other"===n;if("exact"===t.groupBy)return"exact"===n;(0,h.t1)(t.groupBy)}(t,n):"number"===s?function(e,t){if(!e||!e.value)return!0;if("number"!==t.type||"number"!==e.type)return!1;const n=e.value;if("out_of_range"===n.type)return n.start===t.start&&n.end===t.end;if("range"===n.type){const e=(0,r.n6)(n.start,t.start,t.end,t.size);return e&&"range"===e.type&&e.start===n.start}if("unique"===n.type){const e=(0,r.n6)(n.value,t.start,t.end,t.size,t.groupBy);return e&&"unique"===e.type&&e.value===n.value}(0,h.t1)(n)}(t,n):"relation"===s?"relation"===(null==a?void 0:a.type)&&function(e,t,n,o,i){var a;if(!t||!t.value)return!0;if("relation"!==n.type||"relation"!==t.type)return!1;if((0,r.t2)(t.value)){var s,l;const n=e.collection_pointer&&o(e.collection_pointer);if(!i||!n)return!1;const r=null==n||null===(s=n.getFormat())||void 0===s?void 0:s.app_config_uri,a=null===(l=i[n.id])||void 0===l?void 0:l[t.value.value.variable],c=null==n?void 0:n.getSchema();return(0,y.Sh)(c,r)&&a}const c=o(t.value);if(!c)return!1;const u=(0,d.ky)({block:c,getRecordModel:o});if(i&&u){if((0,r.qQ)({relativeVariableValues:i[null==u?void 0:u.id],pointer:c.pointer}).length>0)return!1}return Boolean(c.alive&&((null==u?void 0:u.id)===e.collection_id||(null==u?void 0:u.id)===(null===(a=e.collection_pointer)||void 0===a?void 0:a.id)))}(a,t,n,o,i):"location"===s?function(e,t,n){if(!e||!e.value)return!0;if("location"!==t.type||"location"!==e.type)return!1;const o=n(e.value);return Boolean(o)}(t,n,o):!(!(0,r.pd)(s)&&"checkbox"!==s)||void(0,h.t1)(s)}function E(e){var t;const n=null===(t=e.board_columns_by)||void 0===t?void 0:t.disableBoardColorColumns;return void 0===n||n}function B(e){const{environment:t,groupFormat:n,schema:i,format:s,theme:l,useDarkerColors:c,ignoreDisableColorColumns:d}=e,u=!d&&E(s);if(!s.collection_group_by&&u)return;const p=c?f.bw:f.aH;if(n){const e=i[n.property];if(e&&!u){const i=n.value;if((0,a.cu)(e)){const t=(e.options||[]).find((e=>e.value===i.value));return p(l,null==t?void 0:t.color)}if("status"===e.type&&"status"===i.type){var m,g;let t;if("by_group"===(null===(m=i.value)||void 0===m?void 0:m.type)){var h;const n=i.value.group;t=null===(h=e.groups)||void 0===h||null===(h=h.find((e=>e.name===n)))||void 0===h?void 0:h.color}else if("by_option"===(null===(g=i.value)||void 0===g?void 0:g.type)){var v;const n=i.value.option;t=null===(v=e.options)||void 0===v||null===(v=v.find((e=>e.value===n)))||void 0===v?void 0:v.color}return p(l,t)}if("relation"===e.type&&"relation"===i.type&&(0,r.t2)(i.value)){const n=(0,_.gO)(e,t),r=(0,_.uJ)(e,t),a=null==n?void 0:n.getPropertyMapping(),s=null==a?void 0:a[o.b0.StatusV2],c=r&&s&&r[s];if(c&&"status"===c.type){var b;const e=i.value.value.variable,t=null===(b=c.options)||void 0===b||null===(b=b.find((t=>t.id===e)))||void 0===b?void 0:b.color;if(t)return p(l,t)}}}}return p(l,"default")}function F(e){return!("board"===e.viewType&&"board_columns_by"===e.groupByKey)&&"chart"!==e.viewType}function O(){return v.default.checkGate("collection_groups_functional")}function Z(e){const{stores:t,collectionContextStore:n}=e,o=n.collectionStoresStore.state.map((e=>e.id));return"collectionTypedView"===n.contextType?t.filter((e=>{const t=e.getAssociatedCollectionStore();return t&&o.includes(t.id)})):t}},65183:(e,t,n)=>{n.d(t,{yZ:()=>P,_W:()=>Q,dN:()=>Y,Sb:()=>$,_Y:()=>N,DL:()=>L,oy:()=>j,Km:()=>z,sN:()=>V,Bh:()=>O,aW:()=>U,r_:()=>J,W3:()=>K,TP:()=>G,k4:()=>X,JI:()=>q,K8:()=>W,Dt:()=>ne,Rb:()=>B,Cg:()=>te,SO:()=>R,Tr:()=>D});var o=n(41432),i=n(98953),r=n(99036),a=n(80951),s=n(35013),l=n(21321),c=n(69628),d=n(17948),u=(n(67294),n(45238)),p=n(85893);const m=(0,u.IU)("collectionPieChart",{viewBox:"0 0 18 17",svg:(0,p.jsx)("path",{d:"M9 16.4297C4.58594 16.4297 0.929688 12.7812 0.929688 8.35938C0.929688 3.94531 4.57812 0.289062 8.99219 0.289062C13.4141 0.289062 17.0703 3.94531 17.0703 8.35938C17.0703 12.7812 13.4141 16.4297 9 16.4297ZM9 14.8438C10.5469 14.8438 11.9688 14.3047 13.0781 13.4062L8.59375 9.03125C8.44531 8.88281 8.38281 8.73438 8.38281 8.52344V1.90625C5.07812 2.21094 2.52344 4.96875 2.52344 8.35938C2.52344 11.9531 5.40625 14.8438 9 14.8438ZM9.625 7.57031L14.4375 4.8125C13.3828 3.21094 11.6484 2.10156 9.625 1.90625V7.57031ZM10.1406 8.71094L13.9922 12.5078C14.9219 11.3828 15.4844 9.9375 15.4844 8.35938C15.4844 7.49219 15.3125 6.67188 15.0078 5.92188L10.1406 8.71094Z"})});var f=n(42696),g=n(10405),h=n(19889),v=n(3791),b=n(9291),y=n(53965),_=n(33929),S=n(80444),w=n(77080),k=n(83212),I=n(6258),C=n(88280),x=n(19124),T=n(37034),M=n(95697);const P=32,A=(0,b.defineMessages)({title:{defaultMessage:"Title",id:"database.propertyTypeName.title"},text:{defaultMessage:"Text",id:"database.propertyTypeName.text"},number:{defaultMessage:"Number",id:"database.propertyTypeName.number"},url:{defaultMessage:"URL",id:"database.propertyTypeName.url"},select:{defaultMessage:"Select",id:"database.propertyTypeName.select"},multi_select:{defaultMessage:"Multi-select",id:"database.propertyTypeName.multi_select"},status:{defaultMessage:"Status",id:"database.propertyTypeName.status"},person:{defaultMessage:"Person",id:"database.propertyTypeName.person"},email:{defaultMessage:"Email",id:"database.propertyTypeName.email"},phone_number:{defaultMessage:"Phone",id:"database.propertyTypeName.phone_number"},date:{defaultMessage:"Date",id:"database.propertyTypeName.date"},file:{defaultMessage:"Files & media",id:"database.propertyTypeName.file"},checkbox:{defaultMessage:"Checkbox",id:"database.propertyTypeName.checkbox"},formula:{defaultMessage:"Formula",id:"database.propertyTypeName.formula"},relation:{defaultMessage:"Relation",id:"database.propertyTypeName.relation"},rollup:{defaultMessage:"Rollup",id:"database.propertyTypeName.rollup"},created_time:{defaultMessage:"Created time",id:"database.propertyTypeName.created_time"},created_by:{defaultMessage:"Created by",id:"database.propertyTypeName.created_by"},last_edited_time:{defaultMessage:"Last edited time",id:"database.propertyTypeName.last_edited_time"},last_edited_by:{defaultMessage:"Last edited by",id:"database.propertyTypeName.last_edited_by"},last_visited_time:{defaultMessage:"Last visited time",id:"database.propertyTypeName.last_visited_time"},button:{defaultMessage:"Button",id:"database.propertyTypeName.button"},auto_increment_id:{defaultMessage:"ID",id:"database.propertyTypeName.auto_increment_id"},location:{defaultMessage:"Location",id:"database.propertyTypeName.location"},verification:{defaultMessage:"Verification",id:"database.propertyTypeName.verification"},ai_summary:{defaultMessage:"AI summary",id:"database.propertyTypeName.text.summarizeWithAi"},ai_custom_prompt:{defaultMessage:"AI custom autofill",id:"database.propertyTypeName.text.customPromptWithAI"},ai_extract:{defaultMessage:"AI key info",id:"database.propertyTypeName.text.extractInfoWithAI"},ai_translate:{defaultMessage:"AI translation",id:"database.propertyTypeName.text.translateWithAI"},ai_keywords:{defaultMessage:"AI keywords",id:"database.propertyTypeName.text.keywordsWithAI"}}),R={title:_.default.formatMessage(A.title),text:_.default.formatMessage(A.text),number:_.default.formatMessage(A.number),url:_.default.formatMessage(A.url),select:_.default.formatMessage(A.select),multi_select:_.default.formatMessage(A.multi_select),status:_.default.formatMessage(A.status),person:_.default.formatMessage(A.person),email:_.default.formatMessage(A.email),phone_number:_.default.formatMessage(A.phone_number),date:_.default.formatMessage(A.date),file:_.default.formatMessage(A.file),checkbox:_.default.formatMessage(A.checkbox),formula:_.default.formatMessage(A.formula),relation:_.default.formatMessage(A.relation),rollup:_.default.formatMessage(A.rollup),created_time:_.default.formatMessage(A.created_time),created_by:_.default.formatMessage(A.created_by),last_edited_time:_.default.formatMessage(A.last_edited_time),last_edited_by:_.default.formatMessage(A.last_edited_by),last_visited_time:_.default.formatMessage(A.last_visited_time),button:_.default.formatMessage(A.button),auto_increment_id:_.default.formatMessage(A.auto_increment_id),location:_.default.formatMessage(A.location),verification:_.default.formatMessage(A.verification),ai_summary:_.default.formatMessage(A.ai_summary),ai_custom_prompt:_.default.formatMessage(A.ai_custom_prompt),ai_extract:_.default.formatMessage(A.ai_extract),ai_translate:_.default.formatMessage(A.ai_translate),ai_keywords:_.default.formatMessage(A.ai_keywords)};(0,b.defineMessages)({text:{defaultMessage:"A single line of text.",id:"database.propertyTypeDescription.text"},number:{defaultMessage:"A number, with options to format as currency, percent, and more.",id:"database.propertyTypeDescription.number"},url:{defaultMessage:"A link to a page on the web.",id:"database.propertyTypeDescription.url"},select:{defaultMessage:"Select from a list of options.",id:"database.propertyTypeDescription.select"},multi_select:{defaultMessage:"Tag with values from a list of options.",id:"database.propertyTypeDescription.multi_select"},status:{defaultMessage:"Tag with a list of custom options with groups",id:"database.propertyTypeDescription.status"},person:{defaultMessage:"Reference a person on your team.",id:"database.propertyTypeDescription.person"},email:{defaultMessage:"Reference an email address.",id:"database.propertyTypeDescription.email"},phone_number:{defaultMessage:"Reference a phone number.",id:"database.propertyTypeDescription.phone_number"},date:{defaultMessage:"A date, with options to format and include time.",id:"database.propertyTypeDescription.date"},file:{defaultMessage:"Upload files and images.",id:"database.propertyTypeDescription.file"},checkbox:{defaultMessage:"Track status with a single checkbox.",id:"database.propertyTypeDescription.checkbox"},formula:{defaultMessage:"Compute a formula using other properties of a page.",id:"database.propertyTypeDescription.formula"},relation:{defaultMessage:"Allow pages in this database to reference pages in another.",id:"database.propertyTypeDescription.relation"},rollup:{defaultMessage:"Display and summarize data from a relation.",id:"database.propertyTypeDescription.rollup"},created_time:{defaultMessage:"Reference the date and time a page was created.",id:"database.propertyTypeDescription.created_time"},created_by:{defaultMessage:"Reference the person that created a page.",id:"database.propertyTypeDescription.created_by"},last_edited_time:{defaultMessage:"Reference the date and time a page was last edited.",id:"database.propertyTypeDescription.last_edited_time"},last_edited_by:{defaultMessage:"Reference the person that last edited a page.",id:"database.propertyTypeDescription.last_edited_by"},last_visited_time:{defaultMessage:"Reference the date and time a page was last visited by you.",id:"database.propertyTypeDescription.last_visited_time"},button:{defaultMessage:"A clickable button that can be configured to perform any action.",id:"database.propertyTypeDescription.button"},auto_increment_id:{defaultMessage:"An auto-increment ID.",id:"database.propertyTypeDescription.auto_increment_id"},location:{defaultMessage:"A location.",id:"database.propertyTypeDescription.location"},verification:{defaultMessage:"Verified status.",id:"database.propertyTypeDescription.verification"}});const D=["text","number","select","multi_select","status","date","person","file","checkbox","url","email","phone_number","formula","relation","rollup","created_time","created_by","last_edited_time","last_edited_by","button","auto_increment_id","verification"],E=["select","multi_select","status","person","date","created_time","created_by","last_edited_time","last_edited_by"];function B(e){return E.includes(e.type)}const F=(0,b.defineMessages)({tableDisplayName:{defaultMessage:"Table",id:"collectionHelpers.table.displayName"},boardDisplayName:{defaultMessage:"Board",id:"collectionHelpers.board.displayName"},calendarDisplayName:{defaultMessage:"Calendar",id:"collectionHelpers.calendar.displayName"},listDisplayName:{defaultMessage:"List",id:"collectionHelpers.list.displayName"},galleryDisplayName:{defaultMessage:"Gallery",id:"collectionHelpers.gallery.displayName"},timelineDisplayName:{defaultMessage:"Timeline",id:"collectionHelpers.timline.displayName"},pageDisplayName:{defaultMessage:"Page",id:"collectionHelpers.page.displayName"},chartDisplayName:{defaultMessage:"Chart",id:"collectionHelpers.chart.displayName"}}),O={table:_.default.formatMessage(F.tableDisplayName),board:_.default.formatMessage(F.boardDisplayName),calendar:_.default.formatMessage(F.calendarDisplayName),list:_.default.formatMessage(F.listDisplayName),gallery:_.default.formatMessage(F.galleryDisplayName),timeline:_.default.formatMessage(F.timelineDisplayName),page:_.default.formatMessage(F.pageDisplayName),chart:_.default.formatMessage(F.chartDisplayName)},Z=(0,b.defineMessages)({table:{defaultMessage:"Table with types to store and view any kind of structured data",id:"collectionHelpers.table.caption"},board:{defaultMessage:"Kanban board, great for project planning and bug tracking",id:"collectionHelpers.board.caption"},calendar:{defaultMessage:"Month view, for event planning and scheduling",id:"collectionHelpers.calendar.caption"},list:{defaultMessage:"A simplified page view, great for bookmarks and notes",id:"collectionHelpers.list.caption"},gallery:{defaultMessage:"Grid of cards, use for mood boards, index cards, and recipes",id:"collectionHelpers.gallery.caption"},timeline:{defaultMessage:"A timeline view, great for project scheduling and planning",id:"collectionHelpers.timeline.caption"},page:{defaultMessage:"A page view for organizing pages hierarchically, great for documents and wikis",id:"collectionHelpers.page.caption"},chart:{defaultMessage:"Visualize your data with various chart types",id:"collectionHelpers.chart.caption"}}),V={table:_.default.formatMessage(Z.table),board:_.default.formatMessage(Z.board),calendar:_.default.formatMessage(Z.calendar),list:_.default.formatMessage(Z.list),gallery:_.default.formatMessage(Z.gallery),timeline:_.default.formatMessage(Z.timeline),page:_.default.formatMessage(Z.page),chart:_.default.formatMessage(Z.chart)},U={table:f.t,board:s.i,calendar:l.N,list:d.O,gallery:c.n,timeline:g._,page:d.O,chart:m},L={table:void 0,board:"board_cover",calendar:void 0,list:void 0,gallery:"gallery_cover",timeline:void 0,page:void 0,chart:void 0},j={table:void 0,board:"board_cover_size",calendar:void 0,list:void 0,gallery:"gallery_cover_size",timeline:void 0,page:void 0,chart:void 0},N={table:void 0,board:"board_cover_aspect",calendar:void 0,list:void 0,gallery:"gallery_cover_aspect",timeline:void 0,page:void 0,chart:void 0},z={table:!0,board:!1,calendar:!1,list:!0,gallery:!0,timeline:!0,page:!1,chart:!0};function q(e){const t=e.getType(),n=e.getTitleStore();return t&&(0,o.dM)(t)&&n?n:e.getBlockTitleStore()}function W(e,t){let n=[];switch(t){case"gallery":e&&e.gallery_properties&&(n=e.gallery_properties);break;case"board":e&&e.board_properties&&(n=e.board_properties)}const o=n.find((e=>{let{property:t}=e;return"title"===t}));return!!o&&Boolean(o.visible)}const H=["text","number","select","multi_select","status","date","person","file","checkbox","url","email","phone_number","formula","relation","rollup","created_time","created_by","last_edited_time","last_edited_by","button","auto_increment_id","location","verification"];function K(e){let{collectionContextStore:t,environment:n}=e;const o=t.collectionStore();if(!o)return[];if(o.isTypedCollection())return[];const i=k.Z.getMode(n,o);return(0,x.mX)(n,i,o)?["ai_summary","ai_custom_prompt","ai_translate",(0,x.KZ)()?"ai_keywords":"ai_extract"]:[]}function G(e){return H.filter((t=>{if("location"===t&&(!(0,M.QI)()||"collectionTypedView"!==e.contextType))return!1;if("verification"===t){const t=e.collectionViewBlockStore(),n=null==t?void 0:t.getSchema();if(null==t||!t.isCollectionViewPageWithContent())return!1;if(!n||function(e,t){for(const o in e){var n;if((null===(n=e[o])||void 0===n?void 0:n.type)===t)return!0}return!1}(n,"verification"))return!1}return!0}))}function $(e){let{propertySchema:t,property:n,blockStores:o,collectionSchema:s}=e;return!(0===o.length||!(0,a.GL)(t))&&((0,r.iE)(t)?o.every((e=>Q(t,e,s))):!(0,r.ZY)(t.type)&&!(0,i.w)(n))}function Q(e,t,n){const o=e.verifier_property;if(!o)return!1;const i=t.getPropertyValue(o),r=(0,a.DW)({textValue:i,propertySchema:n[o],blockCreatorPointer:t.getCreatedByPointer()}),s=S.default.state.currentUserRootStore;return!!s&&r.some((e=>e.id===s.id&&e.table===h.KJ))}function Y(e){let{targetCollectionStore:t,propertySchema:n,pointer:o}=e;if(!(Boolean(n.property)&&w.default.checkGate("collections_relation_picker_require_edit_perms")))return!0;return I.G.createChildStore(t,o).canEdit()}function J(e){const{collectionStore:t,environment:n,intl:o,queryForFilter:i}=e;if(""===i)return!0;return(0,T.vU)({environment:n,intl:o,store:t}).toUpperCase().includes(i.toUpperCase())}function X(){var e;const t=(null===(e=C.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,v.de)(t)}function ee(e,t){for(const n of t)void 0===e[n]&&delete e[n]}function te(e){const t=y.Xh(e.loader);if(ee(t,["sort","reducerDependencies","searchQuery","upwardTraversalRelation","vectorSearch","filter"]),t.reducers)for(const n of Object.values(t.reducers))switch(n.type){case"results":ee(n,["filter","searchQuery","loadContentCover"]);break;case"groups":ee(n,["filter"]);break;case"aggregation":ee(n,["filter"]),void 0===n.aggregation.property&&ee(n.aggregation,["property"])}return{collectionView:e.collectionView,source:e.source,loader:t,aggregationStatus:e.aggregationStatus}}function ne(e){return"status"===e.type&&void 0!==e.defaultOption||"person"===e.type&&void 0!==e.default}},48543:(e,t,n)=>{n.d(t,{LQ:()=>u,Ls:()=>l,RI:()=>p,RO:()=>m});var o=n(17683),i=n(31490),r=n(32240),a=n(9291),s=n(33929);const l={table:"side_peek",board:"side_peek",calendar:"center_peek",list:"side_peek",gallery:"center_peek",timeline:"side_peek",page:"side_peek",chart:"side_peek"},c=(0,a.defineMessages)({side_peek:{defaultMessage:"Side peek",id:"database.viewPropertiesMenu.peekMode.sidePeek"},center_peek:{defaultMessage:"Center peek",id:"database.viewPropertiesMenu.peekMode.centerPeek"},full_page:{defaultMessage:"Full page",id:"database.viewPropertiesMenu.peekMode.fullPage"}}),d=(0,a.defineMessages)({side_peek:{defaultMessage:"Open pages on the side. Keeps the view behind interactive.",id:"database.viewPropertiesMenu.peekMode.description.sidePeek"},center_peek:{defaultMessage:"Open pages in a focused, centered modal.",id:"database.viewPropertiesMenu.peekMode.description.centerPeek"},full_page:{defaultMessage:"Open pages in full page.",id:"database.viewPropertiesMenu.peekMode.description.fullPage"}});function u(e){switch(e){case"side_peek":return s.default.formatMessage(c.side_peek);case"center_peek":return s.default.formatMessage(c.center_peek);case"full_page":return s.default.formatMessage(c.full_page)}}function p(e){switch(e){case"side_peek":return s.default.formatMessage(d.side_peek);case"center_peek":return s.default.formatMessage(d.center_peek);case"full_page":return s.default.formatMessage(d.full_page)}}function m(e){switch(e){case"side_peek":return r.y;case"center_peek":return o.Q;case"full_page":return i.M}}},77181:(e,t,n)=>{n.d(t,{A7:()=>A,Af:()=>E,Av:()=>k,CJ:()=>C,Cr:()=>Y,EK:()=>W,F0:()=>S,Hw:()=>_,JR:()=>U,Kg:()=>$,Ll:()=>N,Ns:()=>R,SM:()=>D,T2:()=>H,bX:()=>I,dI:()=>x,fd:()=>V,g0:()=>L,gY:()=>y,kC:()=>M,kG:()=>j,ko:()=>z,ls:()=>Q,nK:()=>K,qb:()=>G,uU:()=>O,vJ:()=>q,wI:()=>J,wf:()=>w,xb:()=>T,yU:()=>F,yr:()=>P,zV:()=>B});n(57658);var o=n(41432),i=n(76205),r=n(99036),a=n(80951),s=n(60246),l=n(42875),c=n(95371),d=n(53965),u=n(10906),p=n(58202),m=n(95802),f=n(77556),g=n(77080),h=n(6258),v=n(28020),b=n(33929);const y=4,_=24,S=10;function w(e){var t;const n=null===(t=e.collectionStore())||void 0===t?void 0:t.getFormat().subitem_property,o=e.collectionStore();if(!o||!o.getSchema()||!n)return;const i=o.getSchema()[n];if(!i||"relation"!==i.type||r.F0(i)!==o.id)return;const a=i.property;if(!a)return;const s=o.getSchema()[a];return s&&"relation"===s.type?{property:n,inverse:a}:void 0}function k(e){return"table"===e||"timeline"===e||"list"===e}function I(e){var t;const n=(0,u.fm)(e),o=null==n||null===(t=n.collectionViewStore())||void 0===t?void 0:t.getType();return Boolean((null==n?void 0:n.currentSubitemFormatStoreForUiDisplay.state)&&o&&k(o))}function C(e){const{store:t,subitemFormat:n,propertySchema:o}=e,i=t.getPropertyValue(n.property),r=(0,a.rq)(i),s=t.getRecordModel;return a.j$({relationValue:r,propertySchema:o,getRecordModel:s})}function x(e){const{store:t,subitemFormat:n,originAction:o}=e,i=t.getPropertyValue(n.property),r=(0,a.rq)(i),s=t.getRecordModel;return a.kc({relationValue:r,getRecordModel:s,originAction:o})}function T(e){const{store:t,subitemFormat:n,propertySchema:o}=e,i=t.getPropertyValue(n.inverse),r=(0,a.rq)(i),s=t.getRecordModel;return a.j$({relationValue:r,propertySchema:o,getRecordModel:s})}function M(e){const{store:t,collectionStore:n,collectionContextStore:o,subitemFormat:r,subitemPathKey:a,propertyFilters:s,combinatorFilter:c,currentUserId:d}=e,u=n.getSchema()[r.property];if(!u||"relation"!==u.type)return[];const p=C({store:t,subitemFormat:r,propertySchema:u});if(0===p.length)return[];let m=p.filter((e=>!a.includes(e.id))).map((e=>h.G.createChildStore(t,e)));const f=o.relativeVariableStore.state,g={schema:o.normalizedSchemaStore.state,userId:d,userTimeZone:(0,l.r)(),userStartOfWeek:v.AK.state,intl:b.default.getIntl(),relativeVariableResult:f},y=new Map;if(s&&s.length>0||c){const e=(0,i.q)({filter:{filters:c?[...s.filter((e=>!(0,i.Oo)(e.filter))).map((e=>e.filter)),c]:s.filter((e=>!(0,i.Oo)(e.filter))).map((e=>e.filter)),operator:"and"},propertyMapping:void 0,context:g});m=m.filter((t=>Z({blockStore:t,compiledFilter:e,subitemFormat:r,propertySchema:u,visitedIds:new Set,resultCache:y})))}return m}function P(e,t){var n,o;const i=e.currentSubitemFormatStoreForUiDisplay.state;if(!i)return new c.DG([]);const a=e.collectionStore();if(!a)return new c.DG([]);const u=e.currentSortsStore.state,p=a.getRecordModel,m=g.default.checkGate("better_database_text_sorts"),f=s.$m({userTimeZone:(0,l.r)(),intl:b.default.getIntl(),userSorts:u,userId:e.getCurrentUserId(),apiSorts:[],schema:e.normalizedSchemaStore.state,useImprovedSort:m}),h=e.normalizedSchemaStore.state[i.property],v=h&&"relation"===h.type&&r.F0(h)===(null===(n=e.collectionStore())||void 0===n?void 0:n.id)&&h.property,y=null===(o=e.collectionViewStore())||void 0===o?void 0:o.getType(),_=!v||y&&k(y)?void 0:{property:v,filter:{operator:"is_empty"}},S=[..._&&v?[{id:v,filter:_}]:[],...e.currentPropertyFiltersStore.state],w=e.currentCombinatorFilterStore.state,I=e.subitemExpandedStore.state,C=d.xH(e.groupsStore.getAllGroupStates().map((e=>e.resultsStore.state)));return new c.DG(C.map((n=>{const o=D(n);return(0,c.MW)(o,(n=>{let{store:o,pathKey:r}=n;const l=I.get(r);if(!l)return{value:{store:o,pathKey:r},children:[]};const c=function(e){const{store:t,collectionStore:n,collectionContextStore:o,subitemFormat:i,querySorts:r,limit:a,subitemPathKey:l,propertyFilters:c,combinatorFilter:u,currentUserId:p,getRecordModel:m}=e,f=M({store:t,collectionStore:n,collectionContextStore:o,subitemFormat:i,subitemPathKey:l,propertyFilters:c,combinatorFilter:u,currentUserId:p});if(!f)return[];const h=g.default.checkGate("better_database_text_sorts"),v=new s.EO([...r,...s.Xm(f.map((e=>e.id))??[])],h),b=new Map;f.forEach((e=>{v.updateBlock({block:e.getModel(),schema:n.getSchema(),propertyMapping:void 0,getRecordModel:m,resultCache:b})}));const y=f.map((e=>e.id))??[],_=s.Qx(y,v),S={};return _.forEach(((e,t)=>{S[e]=t})),d.MR(f,(e=>S[e.id])).slice(0,a)}({store:o,collectionStore:a,collectionContextStore:e,subitemFormat:i,querySorts:f,limit:l.limit,subitemPathKey:r,propertyFilters:S,combinatorFilter:w,currentUserId:t,getRecordModel:p}).map((e=>({store:e,pathKey:B(r,e)})));return{value:{store:o,pathKey:r},children:c}}))})))}function A(e,t){const n=e?[e]:[],o=t.groupsStore.getGroupState(n);if(!o)return[];const i=o.resultsStore.state;if(!t.currentSubitemFormatStoreForUiDisplay.state)return i;const r=[],a=t.subitemTreeStore.state;for(const s of a.children)F({results:r,tree:s});return r}function R(e){return(0,c.CY)(e.children[e.children.length-1])}function D(e){return{store:e,pathKey:E([e.pointer])}}function E(e){return e.map((e=>e.id)).join(",")}function B(e,t){return e?`${e},${t.id}`:t.id}function F(e){const{results:t,tree:n}=e;t.push(n.value.store);for(const o of n.children)F({results:t,tree:o})}function O(e){var t,n;const{block:o,collectionContextStore:i}=e,s=null==i||null===(t=i.currentSubitemFormatStoreForUiDisplay.state)||void 0===t?void 0:t.inverse;if(!s)return!1;const l=i.normalizedSchemaStore.state[s];if(!l||!(0,r.p_)(l))return!1;const c=null===(n=i.collectionViewBlockStore())||void 0===n?void 0:n.getRecordModel;if(!c)return!1;return(0,a.Ds)({block:o,propertySchema:l,getRecordModel:c}).length>0}function Z(e){const{blockStore:t,compiledFilter:n,subitemFormat:o,propertySchema:i,visitedIds:r,resultCache:a}=e;r.add(t.id);const s=t.getModel();if(!s)return!1;if(n({block:s,getRecordModel:t.getRecordModel,propertyMapping:void 0,resultCache:a}))return!0;const l=C({store:t,subitemFormat:o,propertySchema:i});return 0!==l.length&&l.map((e=>h.G.createChildStore(t,e))).filter((e=>!r.has(e.id))).some((e=>Z({blockStore:e,compiledFilter:n,subitemFormat:o,propertySchema:i,visitedIds:r,resultCache:a})))}async function V(e){const{blockStore:t,compiledFilter:n,subitemFormat:o,propertySchema:i,subitemExpandedStore:r,pathKey:s,forceStoresToLoad:l,visitedIds:c}=e;if(await t.load(),c.has(t.id))return;c.add(t.id);const d=l?await async function(e){const{store:t,subitemFormat:n,propertySchema:o}=e,i=t.getPropertyValue(n.property),r=(0,a.rq)(i);await Promise.all(r.map((e=>h.G.createChildStore(t,e).load())));const s=t.getRecordModel;return a.j$({relationValue:r,propertySchema:o,getRecordModel:s})}({store:t,subitemFormat:o,propertySchema:i}):C({store:t,subitemFormat:o,propertySchema:i});if(0===d.length)return;r.state.set(s,{isExpanded:!0,limit:20});const u=new Map;for(const a of d){const e=h.G.createChildStore(t,a),d=e.getModel();if(!d)continue;n({block:d,getRecordModel:e.getRecordModel,propertyMapping:void 0,resultCache:u})||await V({blockStore:e,compiledFilter:n,subitemFormat:o,propertySchema:i,subitemExpandedStore:r,pathKey:B(s,e),forceStoresToLoad:l,visitedIds:c})}}function U(e){if(!e.collectionStore())return;const t=e.currentSubitemFormatStoreForCollection.state,n=e.normalizedSchemaStore.state,o=(null==t?void 0:t.inverse)&&n[t.inverse],i=(null==t?void 0:t.property)&&n[t.property];if(!(i&&(0,r.p_)(i)&&o&&(0,r.p_)(o)))return;const a=o.property,s=i.property;return a&&s?{childRelationProperty:a,parentRelationProperty:s,childRelationSchema:o,parentRelationSchema:i,subitemFormat:t}:void 0}function L(e){const t=(0,u.fm)(e);if(t)return U(t)}function j(e,t){const n=N(e,t);if(n)return U(n)}function N(e,t){if(!e)return;if(!(e.isType(o.Ti.collectionViewPage)||e.isType(o.Ti.page)))return;const n=e.getAssociatedCollectionStore();if(!n)return;const i=new f.Z(t);return i.setContext({type:"collectionPage",collectionViewBlockStore:void 0,collectionStore:n}),i}function z(e){const t=e.getFormat().subitem_property;if(!t)return;const n=e.getSchema()[t];if(!n||"relation"!==n.type)return;const o=n.property;return o?{property:t,inverse:o}:void 0}function q(e,t){if(!e.isType("page"))return!1;if(!t)return!1;return!!t.collectionStore()&&Boolean(t.currentSubitemFormatStoreForCollection.state)}function W(e){var t,n;const{blockId:o,collectionContextStore:i}=e,r=null===(t=i.currentSubitemFormatStoreForCollection)||void 0===t?void 0:t.state,a=null==r?void 0:r.inverse;if(!r||!a)return!1;const s=e.blockStore??(null===(n=p.R.findBlockFromId(o))||void 0===n?void 0:n.getBlockStore());if(!s)return!1;const l=s.getSchema();if(!l)return!1;const c=l[a];return!(!c||"relation"!==c.type)&&T({store:s,subitemFormat:r,propertySchema:c}).length>0}function H(e){let{blocks:t,parentRelationProperty:n,parentRelationSchema:o,collectionViewBlockStore:i}=e;const r=new Set;for(const a of t)r.add(a.id);return d.xH(t.map((e=>{const t=(e=>{const t=e.getPropertyValue(n);return a.j$({relationValue:a.rq(t),propertySchema:o,getRecordModel:e.getRecordModel})})(e),s=t.map((e=>e.id));if(0===t.length)return[h.G.createChildStore(i,e.pointer)];return m.C.findAllSelectablesFromIds(s.filter((e=>!r.has(e)))).map((e=>e.props.store)).map((t=>h.G.createChildStore(t,e.pointer)))})))}function K(e,t){const n=e.subitemTreeStore,o=(0,c.DY)(n.state.children,(e=>e.value.store===t)),i=o?E(o.map((e=>e.value.store))):"";return e.subitemExpandedStore.state.get(i)}function G(e,t){const n=$(e,t);return e.filter(((e,t)=>n.includes(t)))}function $(e,t){const n=new Set;e.forEach((e=>{n.add(e.pointer.id)}));const o=[];return e.forEach(((e,i)=>{const r=e.getPropertyValue(t.inverse);a.rq(r).some((e=>n.has(e.id)))||o.push(i)})),o}function Q(e){var t;let{collectionContextStore:n}=e;return w(n)&&g.default.checkGate("collection_subitem_new_show_hide_options")&&"flattened"===(null===(t=n.collectionViewStore())||void 0===t?void 0:t.getFormat().subitem_display_mode)}function Y(e){let{collectionContextStore:t,blockId:n,blockStore:o}=e;return Q({collectionContextStore:t})&&W({blockId:n,collectionContextStore:t,blockStore:o})}function J(e){let{collectionContextStore:t,blockStore:n}=e;return function(e){var t;let{collectionContextStore:n}=e;return w(n)&&g.default.checkGate("collection_subitem_new_show_hide_options")&&"hidden"===(null===(t=n.collectionViewStore())||void 0===t?void 0:t.getFormat().subitem_display_mode)}({collectionContextStore:t})&&function(e){var t;const{collectionContextStore:n,blockStore:o}=e,i=null===(t=n.currentSubitemFormatStoreForCollection)||void 0===t?void 0:t.state,r=null==i?void 0:i.property;if(!i||!r)return!1;const a=o.getSchema();if(!a)return!1;const s=a[r];return!(!s||"relation"!==s.type)&&C({store:o,subitemFormat:i,propertySchema:s}).length>0}({collectionContextStore:t,blockStore:n})}},43224:(e,t,n)=>{n.d(t,{F6:()=>i,aB:()=>a,pT:()=>r});var o=n(9291);const i={maxWidth:280,width:"max-content",overflowWrap:"break-word",textWrap:"wrap",whiteSpace:"pre-line"},r=280,a=(0,o.defineMessages)({addPropertyDescriptionTooltip:{id:"database.viewSettings.propertyTab.description.addDescriptionTooltip",defaultMessage:"Add property description"},editPropertyDescriptionTooltip:{id:"database.viewSettings.propertyTab.description.editDescriptionTooltip",defaultMessage:"Edit property description"}})},26991:(e,t,n)=>{n.d(t,{As:()=>p,Sh:()=>u,iL:()=>m,ki:()=>g,qf:()=>f});var o=n(76205),i=n(30823),r=n(99036),a=n(96367),s=n(21202),l=n(6287),c=n(6258),d=n(29376);function u(e,t){return(0,a.oN)(e,t)}function p(e,t,n,o){const i=e.relativeVariableStore.state;if(i){const e=i[n.id],r=null==e?void 0:e[t];if(r){return c.G.createChildStore(o,{table:s.iU,id:r,spaceId:n.spaceId})}}}function m(e){var t;const{blockStore:n,collectionId:r,appConfigUri:s,variable:l,schema:c}=e;if((null===(t=n.getAssociatedCollectionStore())||void 0===t?void 0:t.id)!==r)return!1;const d=a.qB[s][l].reducer,u=d.getProperty(),p=c[u],m=n.getPropertyValue(u),f=d.getPropertyFilter(c,l);return!!(0,o.CA)({filter:f,filterType:"status",relativeVariableValues:void 0})((0,i.yK)({propertySchema:p,propertyValue:m}))}function f(e,t,n){if((0,o.e)(t.filter)){if(((0,o.vR)(t.filter)?(0,o.YO)(t.filter):[]).some((e=>"relative"===e.type)))return function(e,t,n){const o=n.getSchema()[t];return!(!o||!(0,r.p_)(o))&&(0,a.oN)((0,d.uJ)(o,e),(0,d.ke)(o,n))}(e,t.property,n)}return!0}function g(e,t,n){return!!e&&Object.values(e).some((e=>{if("groups"===e.type&&"relation"===e.groupBy.type){const o=e.groupBy.property,i=t[o];if(i.collection_pointer){const e=c.NW.createChildStore(n,{table:l.vF,id:i.collection_pointer.id}),t=e.getFormat().app_config_uri;return t&&a.qB[t]&&e.isDefined()&&(0,a.oN)(e.getSchema(),t)}}return!1}))}},78175:(e,t,n)=>{n.d(t,{Po:()=>l,hF:()=>a,zE:()=>s});var o=n(10906),i=(n(95477),n(77080)),r=n(88923);function a(e){let t=e;for(;t&&(!t||!t.isNavigableBlock());){if("column"===t.getType())return!0;t=t.getParentBlockStore()}return!1}function s(e,t){const{device:n}=t;if(n.isPhone)return!1;if((0,o.en)(e)){return r.default.getSidePeekWidth(t.WindowSizeStore.state.width)>=r.sidePeekNoColumnWidth}return!0}function l(e,t){return!t.device.isMobile&&("on"===i.default.getGroup("columns-full-width")&&(e.isType("column_list")&&e.isChildOfRecordStoreUIRoot()&&s(e,t)&&!(null!==(n=e.getParentBlockStore())&&void 0!==n&&n.isFullWidth())&&!(0,o.en)(e)));var n}},78663:(e,t,n)=>{n.d(t,{$W:()=>m,FD:()=>g,Fu:()=>h,Xc:()=>f});var o=n(53965),i=n(1898),r=n(57819),a=n(30793),s=n(28685),l=n(6258),c=n(27724),d=n(24666),u=n(33929),p=n(73959);function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.default.getIntl();if("helpMeEdit"===e.key||"helpMeDraft"===e.key||"helpMeWrite"===e.key){var n;const o=null===(n=e.steps)||void 0===n?void 0:n[0],i="text"===(null==o?void 0:o.type)&&o.prefilledValue;return i?t.formatMessage({id:"completionPopup.prefilledValue",defaultMessage:"Write about {prefilledValue} "},{prefilledValue:i}):""}if(!(0,a.TE)(e.key))return"";switch(e.key){case"brainstormIdeas":return t.formatMessage({id:"completionPopup.brainStorm.prefilledValue",defaultMessage:"Brainstorm ideas on "});case"blogPost":return t.formatMessage({id:"completionPopup.blogPost.prefilledValue",defaultMessage:"Write a blog post about "});case"outline":return t.formatMessage({id:"completionPopup.outline.prefilledValue",defaultMessage:"Write an outline about "});case"socialMediaPost":return t.formatMessage({id:"completionPopup.socialMediaPost.prefilledValue",defaultMessage:"Write a social media post about "});case"pressRelease":return t.formatMessage({id:"completionPopup.pressRelease.prefilledValue",defaultMessage:"Write a press release about "});case"creativeStory":return t.formatMessage({id:"completionPopup.creativeStory.prefilledValue",defaultMessage:"Write a creative story about "});case"essay":return t.formatMessage({id:"completionPopup.essay.prefilledValue",defaultMessage:"Write an essay about "});case"poem":return t.formatMessage({id:"completionPopup.poem.prefilledValue",defaultMessage:"Write a poem about "});case"todoList":return t.formatMessage({id:"completionPopup.todoList.prefilledValue",defaultMessage:"Write a todo list about "});case"meetingAgenda":return t.formatMessage({id:"completionPopup.meetingAgenda.prefilledValue",defaultMessage:"Write a meeting agenda about "});case"prosConsList":return t.formatMessage({id:"completionPopup.prosConsList.prefilledValue",defaultMessage:"Write a pros and cons list about "});case"jobDescription":return t.formatMessage({id:"completionPopup.jobDescription.prefilledValue",defaultMessage:"Write a job description about "});case"salesEmail":return t.formatMessage({id:"completionPopup.salesEmail.prefilledValue",defaultMessage:"Write a sales email about "});case"recruitingEmail":return t.formatMessage({id:"completionPopup.recruitingEmail.prefilledValue",defaultMessage:"Write a recruiting email about "});default:(0,i.t1)(e.key)}}function f(){const{stores:e}=c.default.state,t=e[0],n=o.Z$(e),i=t?t.getRecordStoreUIRoot():void 0;if(i&&i instanceof l.G&&n){return{type:"blockSelection",stores:e,currentPage:i,origin:n,scrollerStore:(0,r.Dj)(i)}}}function g(){const e=d.default.state;if("editing"!==e.mode)return;const t=e.multiSelection,n=t.start.store,o=n.getRecordStoreUIRoot(),i=s.E.findNodeFromStore(n),a=(0,p.sQ)(n),c=null==a?void 0:a.getRecordStoreUIParent(),u=(0,r.Dj)(o),m=a&&a instanceof l.G&&a!==o?a:void 0,f=m??i;if(!(o&&o instanceof l.G&&f))return;return{type:"cursor",textSelection:t,currentPage:o,currentBlock:m,origin:f,currentParent:c,scrollerStore:u,isPageTitle:o.id===n.id}}function h(){const{stores:e}=c.default.state,t=d.default.state,n="empty"!==t.mode?t.multiSelection:void 0,o="empty"!==t.mode?t.multiSelection.start.store:void 0,i=o?o.getRecordStoreUIRoot():void 0;if(n&&i&&i instanceof l.G){const t=(0,p.sQ)(n.end.store),o=null==t?void 0:t.getRecordStoreUIParent(),a=(0,r.Dj)(i);if(t&&o){return{type:"textSelection",stores:e,textSelection:n,currentPage:i,origin:t,endBlock:t,endBlockParent:o,scrollerStore:a}}}}},43455:(e,t,n)=>{n.d(t,{$A:()=>_,Ie:()=>C,KF:()=>b,N9:()=>I});n(57658);var o=n(40591),i=n.n(o),r=n(41432),a=n(19531),s=n(22808),l=n(25718),c=n(19889),d=n(70203),u=n(7928),p=n(33929),m=n(83089);const f=!1;function g(){if(f){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log("completionMarkdownHelpers:",...t)}}function h(e,t){return(0,u.Nz)(e,t).replace(/ /g,"")}function v(e,t){const{getRecordValue:n,intl:o}=t;let i;if(d.IWo(e)){const t=d.zEN(e);i=`@${h(o,n({table:c.KJ,id:t}))}`}else if(d.fpG(e)){i=d.zyO(e).start_date}return i&&g(`Transforming annotation for completion: ${i}`),i}function b(){let e=0,t=0;function n(n){e+=1,e>t&&(t=e);try{return l.Lk(n)}finally{e-=1}}function o(){return":".repeat(t-e+2)}return{transformAnnotation:v,transformBlockMapping:{callout(e){var t;const{block:i,exportArgs:r}=e,a=l.WB({block:i,exportArgs:r}),c=null===(t=i.format)||void 0===t?void 0:t.page_icon,d=(0,s.Z)(c)?c:"",u=n(e),p=o();return{text:`${p} aside ${d}\n\n${a}`.trim(),breakLines:!0,children:u,suffix:p}},toggle(e){const{block:t,exportArgs:i}=e,r=l.WB({block:t,exportArgs:i}),a=n(e),s=o();return{text:`${s} â–¶ ${r}\n\n`.trim(),breakLines:!0,children:a,suffix:s}}}}}const y=(0,m.V9)({unicode:()=>/@\p{Letter}+/gu,fallback:/@[A-Za-z]+/g});async function _(e,t,n){const o=e.matchAll(y),i=[];for(const r of o){const e=r[0].slice(1);if(void 0===n.get(e)){const o=async()=>{const o=await S(t,e);o?(g(`Found user result for mention "${e}": ${o.email}`),n.set(e,o)):(g(`Found no user result for mention "${e}".`),n.set(e,null))};i.push(o())}}await Promise.all(i)}async function S(e,t){const n=await e(t),o=p.default.getIntl();let i;for(const r of n){if(h(o,r)===t){if(i)return;i=r}}return i}function w(e){const{md:t,name:n,regex:o,createTokens:i}=e,{arrayReplaceAt:r}=t.utils;function a(e,t,r){let a=0;const s=[];if(e.replace(o,(function(o){const l=Array.from(arguments);let c=l.length-1;"string"!=typeof l[c]&&(c-=1);const d=l[c],u=l[c-1];if(u>0&&(0,m.D_)(d[u-1]))return"";if(u+o.length<d.length&&(0,m.D_)(d[u+o.length]))return"";const p=i(o,t);if(!p)return"";if(u>a){const t=new r("text","",0);t.content=e.slice(a,u),s.push(t)}for(const{type:e,attrs:t,tag:i,level:a,content:m}of p){const o=new r(e,"",0);if(t)for(const[e,n]of Object.entries(t))o.attrPush([e,n]);i&&(o.tag=i,o.markup=n),void 0!==a&&(o.level=a),m&&(o.content=m),s.push(o)}return a=u+o.length,""})),a<e.length){const t=new r("text","",0);t.content=e.slice(a),s.push(t)}return s}t.core.ruler.after("linkify",n,(e=>{let t=0;const n=e.tokens;for(let i=0;i<n.length;i++){const s=n[i].children;if("inline"===n[i].type&&s)for(let l=s.length-1;l>=0;l--){const c=s[l];"link_open"!==c.type&&"link_close"!==c.type||"auto"===c.info&&(t-=c.nesting),"text"===c.type&&0===t&&o.test(c.content)&&(n[i].children=r(s,l,a(c.content,c.level,e.Token)))}}return!0}))}function k(e){return t=>{!function(e){w({md:e,name:"date_mentions",regex:/20\d\d-\d\d-\d\d/g,createTokens:(e,t)=>[{type:"date_mention_open",tag:"time",attrs:{datetime:e,[a.KD.dateFormat]:"relative"},level:t+1},{type:"text",content:e},{type:"date_mention_close",tag:"/time",level:t}]})}(t),function(e,t){w({md:e,name:"user_mentions",regex:y,createTokens(e,n){const o=e.slice(1),i=t.get(o);if(i)return[{type:"user_mention_open",tag:"a",level:n+1,attrs:{[a.KD[d.GKr.User]]:i.id}},{type:"text",content:e},{type:"user_mention_close",tag:"/a",level:n}]}})}(t,e),function(e){const t=/^aside\s+(.*)$/,n={validate:e=>Boolean(e.trim().match(t)),render(n,o){if(1===n[o].nesting){const i=n[o].info.trim().match(t);let l=(null==i?void 0:i[1])??"";(0,s.Z)(l)||(l="");const c="gray_background",d=function(e,t){const n=[];for(const[o,i]of t)n.push(`${o}="${e.utils.escapeHtml(i)}"`);return n.join(" ")}(e,[[a.KD[r.Ti.callout],""],[a.KD.calloutBackground,c],[a.KD.calloutIcon,l]]);return`<div ${d}>`}return"</div>"}};e.use(i(),"callout_block",n)}(t),function(e){const t=/^â–¶\s+(.*)$/,n={validate:e=>Boolean(e.trim().match(t)),render(n,o){if(1===n[o].nesting){const i=n[o].info.trim().match(t),r=(null==i?void 0:i[1])??"";return`<details><summary>${e.utils.escapeHtml(r)}</summary>`}return"</details>"}};e.use(i(),"toggle_block",n)}(t)}}function I(e){return{plugin:k(e)}}function C(e){return/\[.+\]\([^)]*$/.test(e)}},19124:(e,t,n)=>{n.d(t,{AC:()=>R,G9:()=>S,GD:()=>I,Gw:()=>D,It:()=>b,KZ:()=>M,RT:()=>x,Zt:()=>C,eL:()=>y,kL:()=>P,lV:()=>E,mX:()=>A,q:()=>T,qB:()=>_,z1:()=>w});var o=n(94568),i=n(38823),r=n(52897),a=n(12970),s=n(91856),l=n(11751),c=n(9291),d=n(31701),u=n(53965),p=(n(95477),n(80444)),m=n(21273),f=n(77080),g=n(83212),h=n(48779);const v=(0,c.defineMessages)({helpMeWrite:{defaultMessage:"Ask AI to write...",id:"id.completions.helpMeWrite"},helpMeWritePlaceholder:{defaultMessage:'What would you like to write about?\nFor example, "5 reasons why we should hire a dedicated designer"',id:"id.completions.helpMeWritePlaceholder"},helpMeDraftPlaceholder:{defaultMessage:'What would you like to write about?\nFor example, "article about the benefits of learning a new language"',id:"id.completions.helpMeDraftPlaceholder"},summarize:{defaultMessage:"Summarize",id:"id.completions.summarize"},findActionItems:{defaultMessage:"Find action items",id:"id.completions.findActionItems"},summarizeMeetingTranscript:{id:"id.completions.summarizeMeetingTranscript",defaultMessage:"Summarize meeting"}}),b={key:"helpMeWrite",category:"writeWithAI",name:v.helpMeWrite,svg:l.t,svgFill:d.FN.light.purple[400],requiresContent:!0,steps:[{key:"prompt",name:v.helpMeWritePlaceholder,placeholder:v.helpMeWritePlaceholder,type:"text"}]},y={key:"helpMeDraft",category:"draftWithAI",name:v.helpMeWrite,svg:l.t,svgFill:d.FN.light.purple[400],requiresNoContent:!0,steps:[{key:"prompt",name:v.helpMeDraftPlaceholder,placeholder:v.helpMeDraftPlaceholder,type:"text"}]};function _(e){const{customPrompt:t,isPageEmpty:n}=e;return{key:n?"helpMeDraft":"helpMeWrite",category:"writeWithAI",name:v.helpMeWrite,svg:r.d,svgFill:d.FN.light.purple[400],steps:[{key:"prompt",name:v.helpMeWritePlaceholder,placeholder:v.helpMeWritePlaceholder,type:"text",prefilledValue:t}]}}function S(){return[{key:"summarize",category:"extractFromContent",name:v.summarize,svg:s.Y,svgFill:d.FN.light.purple[400]},{key:"findActionItems",category:"extractFromContent",name:v.findActionItems,svg:a.O,svgFill:d.FN.light.purple[400]},b]}function w(){return u.KX(S(),"key")}function k(){const e=p.default.state.currentSpaceStore;return!!e&&e.isAiEnabledOnSpace()}function I(e){if(f.default.checkGate("disable_ai_big_red_button"))return!1;const t=p.default.state.currentSpaceStore;if((0,h.Cx)(t))return!1;const n=null==t?void 0:t.canRead();return!(e&&e.hasPublicPermission&&!n)&&k()}function C(e){return k()}function x(e,t){return I(e)&&t.canEdit()}function T(){return f.default.checkGate("autotag_ambient_trigger")&&f.default.checkGate("autotag_ambient_trigger_space")}function M(){return f.default.checkGate("autofill_tags")}function P(){return I(void 0)&&f.default.checkGate("enable_ai_suggested_properties")}function A(e,t,n){return I(t)&&n.canEditCollection()}function R(e){m.Z.setState(new i.m9({getEligibleGroup:e=>f.default.getEligibleGroup({experimentId:e}),isAiEnabled:()=>{const t=p.default.state.mainEditorCurrentBlockStore;return I(t&&g.Z.getMode(e,t))},getIsWorkspaceVectorEmbeddingsComplete:()=>{var e;return(null===(e=p.default.state.currentSpaceStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.embedding_index_is_live)??!1},getCanWorkspaceUseVectorEmbeddingsCollectionIdFilter:()=>{var e;return(null===(e=p.default.state.currentSpaceStore)||void 0===e?void 0:e.getSettingsStore().getKeyStore("embedding_index_generation").getValue())===i.v4},checkGate:e=>f.default.checkGate(e)}))}function D(){var e;return(null===(e=p.default.state.currentSpaceStore)||void 0===e?void 0:e.id)===o.vj}function E(){return!1}},72340:(e,t,n)=>{n.d(t,{$6:()=>a,CN:()=>i,SL:()=>s,Tc:()=>r});var o=n(77080);const i=5;function r(e){return"on"===o.default.getEligibleGroup({experimentId:"parallel_confluence_importer_via_api",defaultGroup:"control"})}function a(e){return o.default.getEligibleGroup({experimentId:"special_case_confluence_file_size",defaultGroup:i.toString()})}function s(e){return"on"===o.default.getEligibleGroup({experimentId:"migrate_confluence_into_teamspace",defaultGroup:"control"})}},53323:(e,t,n)=>{n.d(t,{L:()=>s,n:()=>l});var o=n(19584),i=n(88632),r=n(99757);const a=1*o.hM;function s(){var e;if(i.Z.state.online){if(null!==(e=r.Z.state.connectionError)&&void 0!==e&&e.startTime){var t;if(Date.now()-(null===(t=r.Z.state.connectionError)||void 0===t?void 0:t.startTime)<a)return}return r.Z.state.connectionError}}function l(){return Boolean(s())}},46150:(e,t,n)=>{n.d(t,{C7:()=>h,D1:()=>_,G0:()=>m,GF:()=>r,GZ:()=>s,HM:()=>d,Hd:()=>g,X1:()=>b,_F:()=>u,d_:()=>c,eD:()=>f,g4:()=>y,xp:()=>S});var o=n(62619);const i="data-content-editable-leaf",r={[i]:!0},a="data-content-editable-root",s={[a]:!0},l="data-content-editable-root-tiny-selection-trap",c={[l]:!0},d="data-content-editable-selecting",u="data-content-editable-composing",p="data-content-editable-void",m={[p]:!0};function f(e){return o.kK(e)&&e.hasAttribute(i)}function g(e){return o.kK(e)&&e.hasAttribute(l)}function h(e){return Boolean(o.kK(e)&&e.querySelector(`[${i}]`))}function v(e){return o.kK(e)&&e.hasAttribute(a)}function b(e){return o.sh(e,f)}function y(e,t){return e.parentElement===t?e:o.sh(e,(e=>e.parentElement===t))||e}function _(e,t){if(!e||!t)return!1;const n=S(e),o=S(t);return Boolean(n&&n===o)}function S(e){const t=o.sh(e,(e=>v(e)||function(e){return o.kK(e)&&e.hasAttribute(p)}(e)));if(t&&v(t))return t}},40959:(e,t,n)=>{n.d(t,{Hc:()=>P,MU:()=>x,O5:()=>A,tg:()=>M});var o=n(1302),i=n(41892),r=n(41432),a=n(45953),s=n(21202),l=n(9291),c=n(98104),d=n(33929),u=n(95802),p=n(77080),m=n(92083),f=n(19037),g=n(42),h=n(4708),v=n(78175),b=n(19124),y=n(8989),_=n(56335),S=n(68056),w=n(5749),k=n(73959),I=n(89086);const C=(0,l.defineMessages)({textTitle:{id:"newBlock.text.title",defaultMessage:"Text"},textDescription:{id:"newBlock.text.description",defaultMessage:"Just start writing with plain text."},textKeywords:{id:"newBlock.text.fuzzySearchKeywords",defaultMessage:"Plain Text"},pageTitle:{id:"newBlock.page.title",defaultMessage:"Page"},pageDescription:{id:"newBlock.page.description",defaultMessage:"Embed a sub-page inside this page."},pageKeywords:{id:"newBlock.page.fuzzySearchKeywords",defaultMessage:"Page"},linkToPageTitle:{id:"newBlock.linkToPage.title",defaultMessage:"Link to page"},linkToPageDescription:{id:"newBlock.linkToPage.description",defaultMessage:"Link to an existing page."},linkToPageKeywords:{id:"newBlock.linkToPage.fuzzySearchKeywords",defaultMessage:"Link to page ltp"},linkedDatabaseDescription:{id:"newBlock.linkToCollection.description",defaultMessage:"Add an existing database to this page."},transclusionContainerTitle:{id:"newBlock.transclusionContainer.title",defaultMessage:"Synced block"},transclusionContainerDescription:{id:"newBlock.transclusionContainer.description",defaultMessage:"Sync content across pages."},transclusionContainerKeywords:{id:"newBlock.transclusionContainer.fuzzySearchKeywords",defaultMessage:"Create synced block reference transclusion portal block embed group"},toDoTitle:{id:"newBlock.toDo.title",defaultMessage:"To-do list"},toDoDescription:{id:"newBlock.toDo.description",defaultMessage:"Track tasks with a to-do list."},toDoKeywords:{id:"newBlock.toDo.fuzzySearchKeywords",defaultMessage:"Todo To-Do Checkbox List"},headerTitle:{id:"newBlock.header.title",defaultMessage:"Heading 1"},headerDescription:{id:"newBlock.header.description",defaultMessage:"Big section heading."},headerKeywords:{id:"newBlock.header.fuzzySearchKeywords",defaultMessage:"Heading 1 # h1"},subHeaderTitle:{id:"newBlock.subHeader.title",defaultMessage:"Heading 2"},subHeaderDescription:{id:"newBlock.subHeader.description",defaultMessage:"Medium section heading."},subHeaderKeywords:{id:"newBlock.subHeader.fuzzySearchKeywords",defaultMessage:"sub heading 2 ## h2 two"},subSubHeaderTitle:{id:"newBlock.subSubHeader.title",defaultMessage:"Heading 3"},subSubHeaderDescription:{id:"newBlock.subSubHeader.description",defaultMessage:"Small section heading."},subSubHeaderKeywords:{id:"newBlock.subSubHeader.fuzzySearchKeywords",defaultMessage:"subsub heading 3 ### h3 three"},imageTitle:{id:"newBlock.image.title",defaultMessage:"Image"},imageDescription:{id:"newBlock.image.description",defaultMessage:"Upload or embed with a link."},imageKeywords:{id:"newBlock.image.fuzzySearchKeywords",defaultMessage:"Image Picture Gif Giphy"},bookmarkTitle:{id:"newBlock.bookmark.title",defaultMessage:"Web bookmark"},bookmarkDescription:{id:"newBlock.bookmark.description",defaultMessage:"Save a link as a visual bookmark."},bookmarkKeywords:{id:"newBlock.bookmark.fuzzySearchKeywords",defaultMessage:"Web Link Bookmark"},dividerTitle:{id:"newBlock.divider.title",defaultMessage:"Divider"},dividerDescription:{id:"newBlock.divider.description",defaultMessage:"Visually divide blocks."},dividerKeywords:{id:"newBlock.divider.fuzzySearchKeywords",defaultMessage:"Horizontal Rule Divider line section separator --- â€”-"},codeTitle:{id:"newBlock.code.title",defaultMessage:"Code"},codeDescription:{id:"newBlock.code.description",defaultMessage:"Capture a code snippet."},codeKeywords:{id:"newBlock.code.fuzzySearchKeywords",defaultMessage:"Code ```"},quoteTitle:{id:"newBlock.quote.title",defaultMessage:"Quote"},quoteDescription:{id:"newBlock.quote.description",defaultMessage:"Capture a quote."},quoteKeywords:{id:"newBlock.quote.fuzzySearchKeywords",defaultMessage:"Quote"},bulletedListTitle:{id:"newBlock.bulletedList.title",defaultMessage:"Bulleted list"},bulletedListDescription:{id:"newBlock.bulletedList.description",defaultMessage:"Create a simple bulleted list."},bulletedListKeywords:{id:"newBlock.bulletedList.fuzzySearchKeywords",defaultMessage:"Bulleted Unordered List"},numberedListTitle:{id:"newBlock.numberedList.title",defaultMessage:"Numbered list"},numberedListDescription:{id:"newBlock.numberedList.description",defaultMessage:"Create a list with numbering."},numberedListKeywords:{id:"newBlock.numberedList.fuzzySearchKeywords",defaultMessage:"Numbered Ordered List"},toggleTitle:{id:"newBlock.toggle.title",defaultMessage:"Toggle list"},toggleDescription:{id:"newBlock.toggle.description",defaultMessage:"Toggles can hide and show content inside."},toggleKeywords:{id:"newBlock.toggle.fuzzySearchKeywords",defaultMessage:"Toggle list expand collapse details"},fileTitle:{id:"newBlock.file.title",defaultMessage:"File"},fileDescription:{id:"newBlock.file.description",defaultMessage:"Upload or embed with a link."},fileKeywords:{id:"newBlock.file.fuzzySearchKeywords",defaultMessage:"File upload attach"},videoTitle:{id:"newBlock.video.title",defaultMessage:"Video"},videoDescription:{id:"newBlock.video.description",defaultMessage:"Embed from YouTube, Vimeo..."},videoKeywords:{id:"newBlock.video.fuzzySearchKeywords",defaultMessage:"Video"},audioTitle:{id:"newBlock.audio.title",defaultMessage:"Audio"},audioDescription:{id:"newBlock.audio.description",defaultMessage:"Embed from SoundCloud, Spotify..."},audioKeywords:{id:"newBlock.audio.fuzzySearchKeywords",defaultMessage:"Audio Sound Music"},embedTitle:{id:"newBlock.embed.title",defaultMessage:"Embed"},embedDescription:{id:"newBlock.embed.description",defaultMessage:"For PDFs, Google Maps, and more."},embedKeywords:{id:"newBlock.embed.fuzzySearchKeywords",defaultMessage:"Embed iFrame"},driveTitle:{id:"newBlock.drive.title",defaultMessage:"Google Drive"},driveDescription:{id:"newBlock.drive.description",defaultMessage:"Embed a Google Doc, Google Sheet..."},driveKeywords:{id:"newBlock.drive.fuzzySearchKeywords",defaultMessage:"Google Drive"},figmaTitle:{id:"newBlock.figma.title",defaultMessage:"Figma"},figmaDescription:{id:"newBlock.figma.description",defaultMessage:"Embed a Figma file."},figmaKeywords:{id:"newBlock.figma.fuzzySearchKeywords",defaultMessage:"Figma"},loomTitle:{id:"newBlock.loom.title",defaultMessage:"Loom"},loomDescription:{id:"newBlock.loom.description",defaultMessage:"Embed a Loom recording."},loomKeywords:{id:"newBlock.loom.fuzzySearchKeywords",defaultMessage:"Loom"},typeformTitle:{id:"newBlock.typeform.title",defaultMessage:"Typeform"},typeformDescription:{id:"newBlock.typeform.description",defaultMessage:"Embed a Typeform."},typeformKeywords:{id:"newBlock.typeform.fuzzySearchKeywords",defaultMessage:"Typeform"},codepenTitle:{id:"newBlock.codepen.title",defaultMessage:"CodePen"},codepenDescription:{id:"newBlock.codepen.description",defaultMessage:"Embed a CodePen."},codepenKeywords:{id:"newBlock.codepen.fuzzySearchKeywords",defaultMessage:"CodePen"},tweetTitle:{id:"newBlock.tweet.title",defaultMessage:"Tweet"},tweetDescription:{id:"newBlock.tweet.description",defaultMessage:"Embed a Tweet."},tweetKeywords:{id:"newBlock.tweet.fuzzySearchKeywords",defaultMessage:"Tweet"},gistTitle:{id:"newBlock.gist.title",defaultMessage:"GitHub Gist"},gistDescription:{id:"newBlock.gist.description",defaultMessage:"Embed a Gist from GitHub."},gistKeywords:{id:"newBlock.gist.fuzzySearchKeywords",defaultMessage:"GitHub Gist"},mapsTitle:{id:"newBlock.maps.title",defaultMessage:"Google Maps"},mapsDescription:{id:"newBlock.maps.description",defaultMessage:"Embed a Google Map."},mapsKeywords:{id:"newBlock.maps.fuzzySearchKeywords",defaultMessage:"Google Maps"},framerTitle:{id:"newBlock.framer.title",defaultMessage:"Framer"},framerDescription:{id:"newBlock.framer.description",defaultMessage:"Embed a Framer prototype."},framerKeywords:{id:"newBlock.framer.fuzzySearchKeywords",defaultMessage:"Framer"},invisionTitle:{id:"newBlock.invision.title",defaultMessage:"Invision"},invisionDescription:{id:"newBlock.invision.description",defaultMessage:"Embed an Invision project."},invisionKeywords:{id:"newBlock.invision.fuzzySearchKeywords",defaultMessage:"Invision"},mixpanelTitle:{id:"newBlock.mixpanel.title",defaultMessage:"Mixpanel"},mixpanelDescription:{id:"newBlock.mixpanel.description",defaultMessage:"Embed a Mixpanel project."},mixpanelKeywords:{id:"newBlock.mixpanel.fuzzySearchKeywords",defaultMessage:"Mixpanel"},equationTitle:{id:"newBlock.equation.title",defaultMessage:"Block equation"},equationDescription:{id:"newBlock.equation.description",defaultMessage:"Display a standalone math equation."},equationKeywords:{id:"newBlock.equation.fuzzySearchKeywords",defaultMessage:"LaTeX Math Block Equation $$ Formula"},pdfTitle:{id:"newBlock.pdf.title",defaultMessage:"PDF"},pdfDescription:{id:"newBlock.pdf.description",defaultMessage:"Embed a PDF."},pdfKeywords:{id:"newBlock.pdf.fuzzySearchKeywords",defaultMessage:"PDF"},factoryTitle:{id:"newBlock.factory.title",defaultMessage:"Template button"},factoryDescription:{id:"newBlock.factory.description",defaultMessage:"Duplicate blocks with a click."},factoryKeywords:{id:"newBlock.factory.fuzzySearchKeywords",defaultMessage:"Template Duplicate Button"},buttonTitle:{id:"newBlock.button.title",defaultMessage:"Button"},buttonDescription:{id:"newBlock.button.description",defaultMessage:"Run custom automations with a click."},buttonKeywords:{id:"newBlock.button.fuzzySearchKeywords",defaultMessage:"Button automation template duplicate"},breadcrumbTitle:{id:"newBlock.breadcrumb.title",defaultMessage:"Breadcrumb"},breadcrumbDescription:{id:"newBlock.breadcrumb.description",defaultMessage:"Show the current page location."},breadcrumbKeywords:{id:"newBlock.breadcrumb.fuzzySearchKeywords",defaultMessage:"Breadcrumb"},calloutTitle:{id:"newBlock.callout.title",defaultMessage:"Callout"},calloutDescription:{id:"newBlock.callout.description",defaultMessage:"Make writing stand out."},calloutKeywords:{id:"newBlock.callout.fuzzySearchKeywords",defaultMessage:"Callout"},table_of_contentsTitle:{id:"newBlock.tableOfContents.title",defaultMessage:"Table of contents"},table_of_contentsDescription:{id:"newBlock.tableOfContents.description",defaultMessage:"Show an outline of your page."},table_of_contentsKeywords:{id:"newBlock.tableOfContents.fuzzySearchKeywords",defaultMessage:"TOC Table of Contents"},whimsicalTitle:{id:"newBlock.whimsical.title",defaultMessage:"Whimsical"},whimsicalDescription:{id:"newBlock.whimsical.description",defaultMessage:"Embed a Whimsical board."},whimsicalKeywords:{id:"newBlock.whimsical.fuzzySearchKeywords",defaultMessage:"Whimsical"},hexTitle:{id:"newBlock.hex.title",defaultMessage:"Hex"},hexDescription:{id:"newBlock.hex.description",defaultMessage:"Embed a Hex cell."},hexKeywords:{id:"newBlock.hex.fuzzySearchKeywords",defaultMessage:"Hex"},deepnoteTitle:{id:"newBlock.deepnote.title",defaultMessage:"Deepnote"},deepnoteDescription:{id:"newBlock.deepnote.description",defaultMessage:"Embed a Deepnote block."},deepnoteKeywords:{id:"newBlock.deepnote.fuzzySearchKeywords",defaultMessage:"Deepnote"},miroTitle:{id:"newBlock.miro.title",defaultMessage:"Miro"},miroDescription:{id:"newBlock.miro.description",defaultMessage:"Embed a Miro board."},miroKeywords:{id:"newBlock.miro.fuzzySearchKeywords",defaultMessage:"Miro"},abstractTitle:{id:"newBlock.abstract.title",defaultMessage:"Abstract"},abstractDescription:{id:"newBlock.abstract.description",defaultMessage:"Embed an Abstract project."},abstractKeywords:{id:"newBlock.abstract.fuzzySearchKeywords",defaultMessage:"Abstract"},sketchTitle:{id:"newBlock.sketch.title",defaultMessage:"Sketch"},sketchDescription:{id:"newBlock.sketch.description",defaultMessage:"Embed a Sketch document."},sketchKeywords:{id:"newBlock.sketch.fuzzySearchKeywords",defaultMessage:"Sketch"},excalidrawTitle:{id:"newBlock.excalidraw.title",defaultMessage:"Excalidraw"},excalidrawDescription:{id:"newBlock.excalidraw.description",defaultMessage:"Embed an Excalidraw whiteboard."},excalidrawKeywords:{id:"newBlock.excalidraw.fuzzySearchKeywords",defaultMessage:"Excalidraw"},replitTitle:{id:"newBlock.replit.title",defaultMessage:"Replit"},replitDescription:{id:"newBlock.replit.description",defaultMessage:"Embed a repl."},replitKeywords:{id:"newBlock.replit.fuzzySearchKeywords",defaultMessage:"Replit"},databaseTitle:{id:"newBlock.database.title",defaultMessage:"Database"},databaseDescription:{id:"newBlock.database.description",defaultMessage:"Create a new database."},inlineTimelineDatabaseTitle:{id:"newBlock.inlineTimelineDatabase.title",defaultMessage:"Timeline database - Inline"},inlineTimelineDatabaseDescription:{id:"newBlock.inlineTimelineDatabase.description",defaultMessage:"Add a Timeline database to this page."},inlineTimelineDatabaseKeywords:{id:"newBlock.inlineTimelineDatabase.fuzzySearchKeywords",defaultMessage:"Timeline database - Inline"},fullPageTableDatabaseTitle:{id:"newBlock.fullPageTableDatabase.title",defaultMessage:"Table database - Full page"},fullPageTableDatabaseDescription:{id:"newBlock.fullPageTableDatabase.description",defaultMessage:"Add a Table database as a sub-page."},fullPageTableDatabaseKeywords:{id:"newBlock.fullPageTableDatabase.fuzzySearchKeywords",defaultMessage:"Table database - Full page"},fullPageBoardDatabaseTitle:{id:"newBlock.fullPageBoardDatabase.title",defaultMessage:"Board database - Full page"},fullPageBoardDatabaseDescription:{id:"newBlock.fullPageBoardDatabase.description",defaultMessage:"Add a Board database as a sub-page."},fullPageBoardDatabaseKeywords:{id:"newBlock.fullPageBoardDatabase.fuzzySearchKeywords",defaultMessage:"Board database - Full page"},fullPageGalleryDatabaseTitle:{id:"newBlock.fullPageGalleryDatabase.title",defaultMessage:"Gallery database - Full page"},fullPageGalleryDatabaseDescription:{id:"newBlock.fullPageGalleryDatabase.description",defaultMessage:"Add a Gallery database as a sub-page."},fullPageGalleryDatabaseKeywords:{id:"newBlock.fullPageGalleryDatabase.fuzzySearchKeywords",defaultMessage:"Gallery database - Full page"},fullPageListDatabaseTitle:{id:"newBlock.fullPageListDatabase.title",defaultMessage:"List database - Full page"},fullPageListDatabaseDescription:{id:"newBlock.fullPageListDatabase.description",defaultMessage:"Add a List database as a sub-page."},fullPageListDatabaseKeywords:{id:"newBlock.fullPageListDatabase.fuzzySearchKeywords",defaultMessage:"List database - Full page"},fullPageCalendarDatabaseTitle:{id:"newBlock.fullPageCalendarDatabase.title",defaultMessage:"Calendar database - Full page"},fullPageCalendarDatabaseDescription:{id:"newBlock.fullPageCalendarDatabase.description",defaultMessage:"Add a Calendar database as a sub-page."},fullPageCalendarDatabaseKeywords:{id:"newBlock.fullPageCalendarDatabase.fuzzySearchKeywords",defaultMessage:"Calendar database - Full page"},fullPageTimelineDatabaseTitle:{id:"newBlock.fullPageTimelineDatabase.title",defaultMessage:"Timeline database - Full page"},fullPageTimelineDatabaseDescription:{id:"newBlock.fullPageTimelineDatabase.description",defaultMessage:"Add a Timeline database as a sub-page."},fullPageTimelineDatabaseKeywords:{id:"newBlock.fullPageTimelineDatabase.fuzzySearchKeywords",defaultMessage:"Timeline database - Full page"},simpleTableTitle:{id:"newBlock.simple_table.title",defaultMessage:"Table"},simpleTableDescription:{id:"newBlock.simple_table.description",defaultMessage:"Add simple tabular content to your page."},simpleTableKeywords:{id:"newBlock.simple_table.fuzzySearchKeywords",defaultMessage:"Table"},tabTitle:{id:"newBlock.tab.title",defaultMessage:"Tabs"},tabDescription:{id:"newBlock.tab.description",defaultMessage:"Organize content in tabs."},tabKeywords:{id:"newBlock.tab.keywords",defaultMessage:"tab tabs tabbed switch toggle"},toggleFormatHeaderTitle:{id:"newBlock.toggleFormatHeader.title",defaultMessage:"Toggle heading 1"},toggleFormatHeaderDescription:{id:"newBlock.toggleFormatHeader.description",defaultMessage:"Hide content inside a large heading."},toggleFormatHeaderKeywords:{id:"newBlock.toggleFormatHeader.fuzzySearchKeywords",defaultMessage:"toggle heading expand 1 # h1"},toggleFormatSubHeaderTitle:{id:"newBlock.toggleFormatSubHeader.title",defaultMessage:"Toggle heading 2"},toggleFormatSubHeaderDescription:{id:"newBlock.toggleFormatSubHeader.description",defaultMessage:"Hide content inside a medium heading."},toggleFormatSubHeaderKeywords:{id:"newBlock.toggleFormatSubHeader.fuzzySearchKeywords",defaultMessage:"toggle sub heading expand 2 ## h2 two"},toggleFormatSubSubHeaderTitle:{id:"newBlock.toggleFormatSubSubHeader.title",defaultMessage:"Toggle heading 3"},toggleFormatSubSubHeaderDescription:{id:"newBlock.toggleFormatSubSubHeader.description",defaultMessage:"Hide content inside a small heading."},toggleFormatSubSubHeaderKeywords:{id:"newBlock.toggleFormatSubSubHeader.fuzzySearchKeywords",defaultMessage:"toggle subsub heading expand 3 ### h3 three"},columnListTitle:{id:"newBlock.columnList.title",defaultMessage:"Columns"},columnListDescription:{id:"newBlock.columnList.description",defaultMessage:"Create columns of blocks."},columnListKeywords:{id:"newBlock.columnList.fuzzySearchKeywords",defaultMessage:"Create col column columns block vertical"},column2Title:{id:"newBlock.column2.title",defaultMessage:"2 columns"},column2Description:{id:"newBlock.column2.description",defaultMessage:"Create 2 columns of blocks."},column2Keywords:{id:"newBlock.column2.fuzzySearchKeywords",defaultMessage:"Create col c2 col2 columns block vertical 2col two"},column3Title:{id:"newBlock.column3.title",defaultMessage:"3 columns"},column3Description:{id:"newBlock.column3.description",defaultMessage:"Create 3 columns of blocks."},column3Keywords:{id:"newBlock.column3.fuzzySearchKeywords",defaultMessage:"c3 col3 column3 columns 3col three"},column4Title:{id:"newBlock.column4.title",defaultMessage:"4 columns"},column4Description:{id:"newBlock.column4.description",defaultMessage:"Create 4 columns of blocks."},column4Keywords:{id:"newBlock.column4.fuzzySearchKeywords",defaultMessage:"c4 col4 column4 columns 4col four"},column5Title:{id:"newBlock.column5.title",defaultMessage:"5 columns"},column5Description:{id:"newBlock.column5.description",defaultMessage:"Create 5 columns of blocks."},column5Keywords:{id:"newBlock.column5.fuzzySearchKeywords",defaultMessage:"c5 col5 column5 columns 5col five"},mermaidCodeTitle:{id:"newBlock.mermaidCode.title",defaultMessage:"Code - Mermaid"},mermaidCodeDescription:{id:"newBlock.mermaidCode.description",defaultMessage:"Create a diagram by writing code."},mermaidCodeKeywords:{id:"newBlock.mermaidCode.fuzzySearchKeywords",defaultMessage:"mermaid diagram graphviz flowchart code"},aiSummaryBlockTitle:{id:"newBlock.aiSummaryBlock.title",defaultMessage:"Summary"},aiSummaryBlockDescription:{id:"newBlock.aiSummaryBlock.description",defaultMessage:"Generate a summary for the current page."},aiSummaryKeywords:{id:"newBlock.aiSummaryBlock.fuzzySearchKeywords",defaultMessage:"summary ai"},aiActionItemsBlockTitle:{id:"newBlock.aiActionItemsBlock.title",defaultMessage:"Action items"},aiActionItemsDescription:{id:"newBlock.aiActionItemsBlock.description",defaultMessage:"Extract action items from current page."},aiActionItemsKeywords:{id:"newBlock.aiActionItemsBlock.fuzzySearchKeywords",defaultMessage:"find action items ai"},aiFreePromptBlockTitle:{id:"newBlock.aiFreePromptBlock.title",defaultMessage:"Custom AI Block"},aiFreePromptDescription:{id:"newBlock.aiFreePromptBlock.description",defaultMessage:"Generate content from any instruction."},aiFreePromptKeywords:{id:"newBlock.aiFreePromptBlock.fuzzySearchKeywords",defaultMessage:"ask help question prompt ai custom block content"},drawingTitle:{id:"newBlock.drawing.title",defaultMessage:"Drawing"},drawingDescription:{id:"newBlock.drawing.description",defaultMessage:"Draw and diagram on an infinite canvas."},drawingKeywords:{id:"newBlock.drawing.fuzzySearchKeywords",defaultMessage:"drawing diagram canvas illustration draw sketch tldraw doodle mindmap architecture paint pen"},aiSectionBlockTitle:{id:"newBlock.aiSection.title",defaultMessage:"AI Section"},aiSectionKeywords:{id:"newBlock.aiSection.fuzzySearchKeywords",defaultMessage:"ai section heading meeting note summary action items"},asanaImportTitle:{id:"newBlock.asanaImport.import",defaultMessage:"Asana"},asanaImportDescription:{id:"newBlock.asanaImport.description",defaultMessage:"Bring projects and tasks form Asana into Notion."},asanaImportKeywords:{id:"newBlock.asanaImport.fuzzySearchKeywords",defaultMessage:"Asana Projects Tasks Import"},confluenceApiImportTitle:{id:"newBlock.confluenceApiImport.import",defaultMessage:"Confluence"},confluenceApiImportDescription:{id:"newBlock.confluenceApiImport.description",defaultMessage:"Bring documents from Confluence via API into Notion."},confluenceApiImportKeywords:{id:"newBlock.confluenceApiImport.fuzzySearchKeywords",defaultMessage:"Confluence"},googleDocsImportTitle:{id:"newBlock.googleDocsImport.import",defaultMessage:"Google Docs"},googleDocsImportDescription:{id:"newBlock.googleDocsImport.description",defaultMessage:"Bring documents from Google Docs into Notion."},googleDocsImportKeywords:{id:"newBlock.googleDocsImport.fuzzySearchKeywords",defaultMessage:"Google Docs Import"},dropboxPaperImportTitle:{id:"newBlock.dropboxPaperImport.import",defaultMessage:"Dropbox Paper"},dropboxPaperImportDescription:{id:"newBlock.dropboxPaperImport.description",defaultMessage:"Bring documents from Dropbox Paper into Notion."},dropboxPaperImportKeywords:{id:"newBlock.dropboxPaperImport.fuzzySearchKeywords",defaultMessage:"Dropbox Paper Import"},evernoteImportTitle:{id:"newBlock.evernoteImport.import",defaultMessage:"Evernote"},evernoteImportDescription:{id:"newBlock.evernoteImport.description",defaultMessage:"Bring notes from Evernote into Notion."},evernoteImportKeywords:{id:"newBlock.evernoteImport.fuzzySearchKeywords",defaultMessage:"Evernote Import"},wordImportTitle:{id:"newBlock.wordImport.import",defaultMessage:"Word"},wordImportDescription:{id:"newBlock.wordImport.description",defaultMessage:"Bring documents from Microsoft Word into Notion."},wordImportKeywords:{id:"newBlock.wordImport.fuzzySearchKeywords",defaultMessage:"Word Import"},workflowyImportTitle:{id:"newBlock.workflowyImport.import",defaultMessage:"Workflowy"},workflowyImportDescription:{id:"newBlock.workflowyImport.description",defaultMessage:"Bring documents from Workflowy into Notion."},workflowyImportKeywords:{id:"newBlock.workflowyImport.fuzzySearchKeywords",defaultMessage:"Workflowy Import"},mondayImportTitle:{id:"newBlock.mondayImport.import",defaultMessage:"Monday"},mondayImportDescription:{id:"newBlock.mondayImport.description",defaultMessage:"Bring projects & tasks from Monday into Notion."},mondayImportKeywords:{id:"newBlock.mondayImport.fuzzySearchKeywords",defaultMessage:"Monday Import"},trelloImportTitle:{id:"newBlock.trelloImport.import",defaultMessage:"Trello"},trelloImportDescription:{id:"newBlock.trelloImport.description",defaultMessage:"Bring projects & tasks from Trello into Notion."},trelloImportKeywords:{id:"newBlock.trelloImport.fuzzySearchKeywords",defaultMessage:"Trello Import"},quipImportTitle:{id:"newBlock.quipImport.import",defaultMessage:"Quip"},quipImportDescription:{id:"newBlock.quipImport.description",defaultMessage:"Bring documents from Quip into Notion."},quipImportKeywords:{id:"newBlock.quipImport.fuzzySearchKeywords",defaultMessage:"Quip Import"},csvImportTitle:{id:"newBlock.csvImport.import",defaultMessage:"CSV"},csvImportDescription:{id:"newBlock.csvImport.description",defaultMessage:"Bring data from CSV into Notion."},csvImportKeywords:{id:"newBlock.csvImport.fuzzySearchKeywords",defaultMessage:"CSV Import"},genericImportTitle:{id:"newBlock.genericImport.import",defaultMessage:"ZIP"},genericImportDescription:{id:"newBlock.genericImport.description",defaultMessage:"Bring data from other tools into Notion."},genericImportKeywords:{id:"newBlock.genericImport.fuzzySearchKeywords",defaultMessage:"Generic Universal Zip Import"},htmlImportTitle:{id:"newBlock.htmlImport.import",defaultMessage:"HTML"},htmlImportDescription:{id:"newBlock.htmlImport.description",defaultMessage:"Bring data from HTML into Notion."},htmlImportKeywords:{id:"newBlock.htmlImport.fuzzySearchKeywords",defaultMessage:"HTML Import"},markdownImportTitle:{id:"newBlock.markdownImport.import",defaultMessage:"Text and Markdown"},markdownImportDescription:{id:"newBlock.markdownImport.description",defaultMessage:"Bring data from text and markdown into Notion."},markdownImportKeywords:{id:"newBlock.markdownImport.fuzzySearchKeywords",defaultMessage:"Text Markdown Import"},pdfImportTitle:{id:"newBlock.pdfImport.import",defaultMessage:"PDF"},pdfImportDescription:{id:"newBlock.pdfImport.description",defaultMessage:"Bring data from PDF into Notion."},pdfImportKeywords:{id:"newBlock.pdfImport.fuzzySearchKeywords",defaultMessage:"PDF Import"}});function x(e){const{key:t,displayName:n,fuzzySearchKeywords:o,blockType:i,thumbnail:r,tooltipPhoto:l,description:c,createTemplate:u,shouldShow:p,badge:m,postCreateCallback:f,collectionViewType:g,isToggleable:h}=e,v=d.default.formatMessage(o),b=v!==o.defaultMessage?`${v} ${o.defaultMessage}`:v;return{key:t,displayName:d.default.formatMessage(n),analyticsName:n.defaultMessage,searchName:b,thumbnail:r,tooltipPhoto:l,description:c?d.default.formatMessage(c):void 0,templateRootBlockId:"root",blockType:i,createTemplate:u||(()=>a.Ao.create({[s.iU]:{root:{id:"root",type:i}}})),shouldShow:p,badge:m,postCreateCallback:f,collectionViewType:g,isToggleable:h}}function T(e){const{key:t,displayName:n,fuzzySearchKeywords:o,thumbnail:i,tooltipPhoto:r,description:a,shouldShow:s,badge:l,postCreateCallback:c,collectionViewType:u,isToggleable:p,action:m}=e,f=d.default.formatMessage(o),g=f!==o.defaultMessage?`${f} ${o.defaultMessage}`:f;return{key:t,displayName:d.default.formatMessage(n),analyticsName:n.defaultMessage,searchName:g,thumbnail:i,tooltipPhoto:r,description:a?d.default.formatMessage(a):void 0,templateRootBlockId:"root",shouldShow:s,badge:l,postCreateCallback:c,collectionViewType:u,isToggleable:p,action:m}}const M={[r.tD.asanaImport]:T({key:r.tD.asanaImport,displayName:C.asanaImportTitle,fuzzySearchKeywords:C.asanaImportKeywords,thumbnail:i.Z.images.import.asanaPng,description:C.asanaImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"asana",openedFrom:"slash_command"})},shouldShow:e=>D()}),[r.tD.confluenceApiImport]:T({key:r.tD.confluenceApiImport,displayName:C.confluenceApiImportTitle,fuzzySearchKeywords:C.confluenceApiImportKeywords,thumbnail:i.Z.images.import.confluencePng,description:C.confluenceApiImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"confluenceApi",openedFrom:"slash_command"})},shouldShow:e=>D()}),[r.tD.googleDocsImport]:T({key:r.tD.googleDocsImport,displayName:C.googleDocsImportTitle,fuzzySearchKeywords:C.googleDocsImportKeywords,thumbnail:i.Z.images.import.googleDocsPng,description:C.googleDocsImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"gdocs",openedFrom:"slash_command"})},shouldShow:e=>D()}),[r.tD.dropboxPaperImport]:T({key:r.tD.dropboxPaperImport,displayName:C.dropboxPaperImportTitle,fuzzySearchKeywords:C.dropboxPaperImportKeywords,thumbnail:i.Z.images.import.dropboxPaperPng,description:C.dropboxPaperImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"dropbox",openedFrom:"slash_command"})},shouldShow:e=>D()}),[r.tD.evernoteImport]:T({key:r.tD.evernoteImport,displayName:C.evernoteImportTitle,fuzzySearchKeywords:C.evernoteImportKeywords,thumbnail:i.Z.images.import.evernotePng,description:C.evernoteImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"evernote",openedFrom:"slash_command"})},shouldShow:e=>D()}),[r.tD.mondayImport]:T({key:r.tD.mondayImport,displayName:C.mondayImportTitle,fuzzySearchKeywords:C.mondayImportKeywords,thumbnail:i.Z.images.import.mondayPng,description:C.mondayImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"monday",openedFrom:"slash_command"})},shouldShow:e=>D()&&(0,_.d)()}),[r.tD.quipImport]:T({key:r.tD.quipImport,displayName:C.quipImportTitle,fuzzySearchKeywords:C.quipImportKeywords,thumbnail:i.Z.images.import.quipPng,description:C.quipImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"quip",openedFrom:"slash_command"})},shouldShow:e=>D()}),[r.tD.trelloImport]:T({key:r.tD.trelloImport,displayName:C.trelloImportTitle,fuzzySearchKeywords:C.trelloImportKeywords,thumbnail:i.Z.images.import.trelloPng,description:C.trelloImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"trello",openedFrom:"slash_command"})},shouldShow:e=>D()}),[r.tD.workflowyImport]:T({key:r.tD.workflowyImport,displayName:C.workflowyImportTitle,fuzzySearchKeywords:C.workflowyImportKeywords,thumbnail:i.Z.images.import.workflowyPng,description:C.workflowyImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"workflowy",openedFrom:"slash_command"})},shouldShow:e=>D()}),[r.tD.wordImport]:T({key:r.tD.wordImport,displayName:C.wordImportTitle,fuzzySearchKeywords:C.wordImportKeywords,thumbnail:i.Z.images.import.wordPng,description:C.wordImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"docx",openedFrom:"slash_command"})},shouldShow:e=>D()}),[r.tD.csvImport]:T({key:r.tD.csvImport,displayName:C.csvImportTitle,fuzzySearchKeywords:C.csvImportKeywords,thumbnail:i.Z.images.import.csvPng,description:C.csvImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"csv",openedFrom:"slash_command"})},shouldShow:e=>D()}),[r.tD.htmlImport]:T({key:r.tD.htmlImport,displayName:C.htmlImportTitle,fuzzySearchKeywords:C.htmlImportKeywords,thumbnail:i.Z.images.import.htmlPng,description:C.htmlImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"html",openedFrom:"slash_command"})},shouldShow:e=>D()}),[r.tD.markdownImport]:T({key:r.tD.markdownImport,displayName:C.markdownImportTitle,fuzzySearchKeywords:C.markdownImportKeywords,thumbnail:i.Z.images.import.textPng,description:C.markdownImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"markdown",openedFrom:"slash_command"})},shouldShow:e=>D()}),[r.tD.genericImport]:T({key:r.tD.genericImport,displayName:C.genericImportTitle,fuzzySearchKeywords:C.genericImportKeywords,thumbnail:i.Z.images.import.importPng,description:C.genericImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"genericImporter",openedFrom:"slash_command"})},shouldShow:e=>D()&&(0,y.tt)()}),[r.tD.pdfImport]:T({key:r.tD.pdfImport,displayName:C.pdfImportTitle,fuzzySearchKeywords:C.pdfImportKeywords,thumbnail:"",description:C.pdfImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"pdf",openedFrom:"slash_command"})},shouldShow:e=>D()&&(0,w.n)()})},P={[r.Ti.text]:x({key:r.Ti.text,blockType:r.Ti.text,displayName:C.textTitle,fuzzySearchKeywords:C.textKeywords,thumbnail:i.Z.images.blocks.textPng,description:C.textDescription,tooltipPhoto:i.Z.images.tooltips.blocks.textPng}),[r.Ti.page]:x({key:r.Ti.page,blockType:r.Ti.page,displayName:C.pageTitle,fuzzySearchKeywords:C.pageKeywords,thumbnail:i.Z.images.blocks.pagePng,description:C.pageDescription,tooltipPhoto:i.Z.images.tooltips.blocks.pagePng}),[r.Ti.linkToPage]:x({key:r.Ti.linkToPage,blockType:r.Ti.linkToPage,displayName:C.linkToPageTitle,fuzzySearchKeywords:C.linkToPageKeywords,thumbnail:i.Z.images.blocks.linkPng,description:C.linkToPageDescription,tooltipPhoto:i.Z.images.tooltips.blocks.linkToPagePng}),[r.Ti.transclusionContainer]:x({key:r.Ti.transclusionContainer,blockType:r.Ti.transclusionContainer,displayName:C.transclusionContainerTitle,fuzzySearchKeywords:C.transclusionContainerKeywords,thumbnail:i.Z.images.blocks.transclusionPng,description:C.transclusionContainerDescription,tooltipPhoto:i.Z.images.tooltips.blocks.transclusionPng,shouldShow:e=>!(0,f.wTx)(e),createTemplate:e=>g._Z()}),[r.Ti.toDo]:x({key:r.Ti.toDo,blockType:r.Ti.toDo,displayName:C.toDoTitle,fuzzySearchKeywords:C.toDoKeywords,thumbnail:i.Z.images.blocks.toDoPng,description:C.toDoDescription,tooltipPhoto:i.Z.images.tooltips.blocks.toDoListPng}),[r.Ti.header]:x({key:r.Ti.header,blockType:r.Ti.header,displayName:C.headerTitle,fuzzySearchKeywords:C.headerKeywords,thumbnail:i.Z.images.blocks.headerPng,description:C.headerDescription,tooltipPhoto:i.Z.images.tooltips.blocks.headerPng}),[r.Ti.subHeader]:x({key:r.Ti.subHeader,blockType:r.Ti.subHeader,displayName:C.subHeaderTitle,fuzzySearchKeywords:C.subHeaderKeywords,thumbnail:i.Z.images.blocks.subheaderPng,description:C.subHeaderDescription,tooltipPhoto:i.Z.images.tooltips.blocks.subHeaderPng}),[r.Ti.subSubHeader]:x({key:r.Ti.subSubHeader,blockType:r.Ti.subSubHeader,displayName:C.subSubHeaderTitle,fuzzySearchKeywords:C.subSubHeaderKeywords,thumbnail:i.Z.images.blocks.subsubheaderPng,description:C.subSubHeaderDescription,tooltipPhoto:i.Z.images.tooltips.blocks.subsubheaderPng}),[r.Ti.image]:x({key:r.Ti.image,blockType:r.Ti.image,displayName:C.imageTitle,fuzzySearchKeywords:C.imageKeywords,description:C.imageDescription,tooltipPhoto:i.Z.images.tooltips.blocks.imagePng,thumbnail:i.Z.images.blocks.imagePng}),[r.Ti.bookmark]:x({key:r.Ti.bookmark,blockType:r.Ti.bookmark,displayName:C.bookmarkTitle,fuzzySearchKeywords:C.bookmarkKeywords,thumbnail:i.Z.images.blocks.webBookmarkPng,description:C.bookmarkDescription,tooltipPhoto:i.Z.images.tooltips.blocks.webBookmarkPng}),[r.Ti.divider]:x({key:r.Ti.divider,blockType:r.Ti.divider,displayName:C.dividerTitle,fuzzySearchKeywords:C.dividerKeywords,thumbnail:i.Z.images.blocks.dividerPng,description:C.dividerDescription,tooltipPhoto:i.Z.images.tooltips.blocks.dividerPng}),[r.Ti.code]:x({key:r.Ti.code,blockType:r.Ti.code,displayName:C.codeTitle,fuzzySearchKeywords:C.codeKeywords,thumbnail:i.Z.images.blocks.codePng,description:C.codeDescription,tooltipPhoto:i.Z.images.tooltips.blocks.codePng}),[r.Ti.quote]:x({key:r.Ti.quote,blockType:r.Ti.quote,displayName:C.quoteTitle,fuzzySearchKeywords:C.quoteKeywords,thumbnail:i.Z.images.blocks.quotePng,description:C.quoteDescription,tooltipPhoto:i.Z.images.tooltips.blocks.quotePng}),[r.Ti.bulletedList]:x({key:r.Ti.bulletedList,blockType:r.Ti.bulletedList,displayName:C.bulletedListTitle,fuzzySearchKeywords:C.bulletedListKeywords,thumbnail:i.Z.images.blocks.bulletedListPng,description:C.bulletedListDescription,tooltipPhoto:i.Z.images.tooltips.blocks.bulletedListPng}),[r.Ti.numberedList]:x({key:r.Ti.numberedList,blockType:r.Ti.numberedList,displayName:C.numberedListTitle,fuzzySearchKeywords:C.numberedListKeywords,thumbnail:i.Z.images.blocks.numberedListPng,description:C.numberedListDescription,tooltipPhoto:i.Z.images.tooltips.blocks.numberedListPng}),[r.Ti.toggle]:x({key:r.Ti.toggle,blockType:r.Ti.toggle,displayName:C.toggleTitle,fuzzySearchKeywords:C.toggleKeywords,thumbnail:i.Z.images.blocks.togglePng,description:C.toggleDescription,tooltipPhoto:i.Z.images.tooltips.blocks.toggleListPng,isToggleable:!0}),[r.Ti.file]:x({key:r.Ti.file,blockType:r.Ti.file,displayName:C.fileTitle,fuzzySearchKeywords:C.fileKeywords,thumbnail:i.Z.images.blocks.filePng,tooltipPhoto:i.Z.images.tooltips.blocks.filePng,description:C.fileDescription}),[r.Ti.video]:x({key:r.Ti.video,blockType:r.Ti.video,displayName:C.videoTitle,fuzzySearchKeywords:C.videoKeywords,thumbnail:i.Z.images.blocks.videoPng,tooltipPhoto:i.Z.images.tooltips.blocks.videoPng,description:C.videoDescription}),[r.Ti.audio]:x({key:r.Ti.audio,blockType:r.Ti.audio,displayName:C.audioTitle,fuzzySearchKeywords:C.audioKeywords,thumbnail:i.Z.images.blocks.audioPng,description:C.audioDescription}),[r.Ti.embed]:x({key:r.Ti.embed,blockType:r.Ti.embed,displayName:C.embedTitle,fuzzySearchKeywords:C.embedKeywords,thumbnail:i.Z.images.blocks.embedPng,description:C.embedDescription}),[r.Ti.drive]:x({key:r.Ti.drive,blockType:r.Ti.drive,displayName:C.driveTitle,fuzzySearchKeywords:C.driveKeywords,thumbnail:i.Z.images.blocks.drivePng,description:C.driveDescription,shouldShow:e=>(0,f.P5O)()}),[r.Ti.figma]:x({key:r.Ti.figma,blockType:r.Ti.figma,displayName:C.figmaTitle,fuzzySearchKeywords:C.figmaKeywords,thumbnail:i.Z.images.blocks.figmaPng,description:C.figmaDescription}),[r.Ti.loom]:x({key:r.Ti.loom,blockType:r.Ti.loom,displayName:C.loomTitle,fuzzySearchKeywords:C.loomKeywords,thumbnail:i.Z.images.blocks.loomPng,description:C.loomDescription}),[r.Ti.typeform]:x({key:r.Ti.typeform,blockType:r.Ti.typeform,displayName:C.typeformTitle,fuzzySearchKeywords:C.typeformKeywords,thumbnail:i.Z.images.blocks.typeformPng,description:C.typeformDescription}),[r.Ti.codepen]:x({key:r.Ti.codepen,blockType:r.Ti.codepen,displayName:C.codepenTitle,fuzzySearchKeywords:C.codepenKeywords,thumbnail:i.Z.images.blocks.codepenPng,description:C.codepenDescription}),[r.Ti.tweet]:x({key:r.Ti.tweet,blockType:r.Ti.tweet,displayName:C.tweetTitle,fuzzySearchKeywords:C.tweetKeywords,thumbnail:i.Z.images.blocks.twitterPng,description:C.tweetDescription}),[r.Ti.gist]:x({key:r.Ti.gist,blockType:r.Ti.gist,displayName:C.gistTitle,fuzzySearchKeywords:C.gistKeywords,thumbnail:i.Z.images.blocks.githubPng,description:C.gistDescription}),[r.Ti.maps]:x({key:r.Ti.maps,blockType:r.Ti.maps,displayName:C.mapsTitle,fuzzySearchKeywords:C.mapsKeywords,thumbnail:i.Z.images.blocks.mapsPng,description:C.mapsDescription}),[r.Ti.framer]:x({key:r.Ti.framer,blockType:r.Ti.framer,displayName:C.framerTitle,fuzzySearchKeywords:C.framerKeywords,thumbnail:i.Z.images.blocks.framerPng,description:C.framerDescription}),[r.Ti.invision]:x({key:r.Ti.invision,blockType:r.Ti.invision,displayName:C.invisionTitle,fuzzySearchKeywords:C.invisionKeywords,thumbnail:i.Z.images.blocks.invisionPng,description:C.invisionDescription}),[r.Ti.equation]:x({key:r.Ti.equation,blockType:r.Ti.equation,displayName:C.equationTitle,fuzzySearchKeywords:C.equationKeywords,thumbnail:i.Z.images.blocks.texPng,tooltipPhoto:i.Z.images.tooltips.blocks.mathPng,description:C.equationDescription}),[r.Ti.pdf]:x({key:r.Ti.pdf,blockType:r.Ti.pdf,displayName:C.pdfTitle,fuzzySearchKeywords:C.pdfKeywords,thumbnail:i.Z.images.blocks.pdfPng,description:C.pdfDescription}),[r.Ti.factory]:x({displayName:C.factoryTitle,fuzzySearchKeywords:C.factoryKeywords,thumbnail:i.Z.images.blocks.templateButtonPng,key:r.Ti.factory,blockType:r.Ti.factory,description:C.factoryDescription,tooltipPhoto:i.Z.images.tooltips.blocks.templateButtonPng,createTemplate:g.sw,shouldShow:()=>!1}),[r.Ti.button]:x({displayName:C.buttonTitle,fuzzySearchKeywords:C.buttonKeywords,thumbnail:i.Z.images.blocks.templateButtonPng,key:r.Ti.button,blockType:r.Ti.button,description:C.buttonDescription,tooltipPhoto:i.Z.images.tooltips.blocks.templateButtonPng,createTemplate:g.ax}),[r.Ti.breadcrumb]:x({displayName:C.breadcrumbTitle,thumbnail:i.Z.images.blocks.breadcrumbPng,tooltipPhoto:i.Z.images.tooltips.blocks.breadcrumbPng,description:C.breadcrumbDescription,fuzzySearchKeywords:C.breadcrumbKeywords,key:r.Ti.breadcrumb,blockType:r.Ti.breadcrumb}),[r.Ti.callout]:x({key:r.Ti.callout,blockType:r.Ti.callout,displayName:C.calloutTitle,thumbnail:i.Z.images.blocks.calloutPng,description:C.calloutDescription,fuzzySearchKeywords:C.calloutKeywords,tooltipPhoto:i.Z.images.tooltips.blocks.calloutPng}),[r.Ti.tableOfContents]:x({displayName:C.table_of_contentsTitle,fuzzySearchKeywords:C.table_of_contentsKeywords,thumbnail:i.Z.images.blocks.tableOfContentsPng,tooltipPhoto:i.Z.images.tooltips.blocks.tableOfContentsPng,description:C.table_of_contentsDescription,key:r.Ti.tableOfContents,blockType:r.Ti.tableOfContents}),[r.Ti.whimsical]:x({key:r.Ti.whimsical,blockType:r.Ti.whimsical,displayName:C.whimsicalTitle,fuzzySearchKeywords:C.whimsicalKeywords,thumbnail:i.Z.images.blocks.whimsicalPng,description:C.whimsicalDescription}),[r.Ti.mixpanel]:x({key:r.Ti.mixpanel,blockType:r.Ti.mixpanel,displayName:C.mixpanelTitle,fuzzySearchKeywords:C.mixpanelKeywords,thumbnail:i.Z.images.blocks.mixpanelPng,description:C.mixpanelDescription}),[r.Ti.miro]:x({key:r.Ti.miro,blockType:r.Ti.miro,displayName:C.miroTitle,fuzzySearchKeywords:C.miroKeywords,thumbnail:i.Z.images.blocks.miroPng,description:C.miroDescription}),[r.Ti.abstract]:x({key:r.Ti.abstract,blockType:r.Ti.abstract,displayName:C.abstractTitle,thumbnail:i.Z.images.blocks.abstractPng,description:C.abstractDescription,fuzzySearchKeywords:C.abstractKeywords}),[r.Ti.sketch]:x({key:r.Ti.sketch,blockType:r.Ti.sketch,displayName:C.sketchTitle,thumbnail:i.Z.images.blocks.sketchPng,description:C.sketchDescription,fuzzySearchKeywords:C.sketchKeywords}),[r.Ti.excalidraw]:x({key:r.Ti.excalidraw,blockType:r.Ti.excalidraw,displayName:C.excalidrawTitle,thumbnail:i.Z.images.blocks.excalidrawPng,description:C.excalidrawDescription,fuzzySearchKeywords:C.excalidrawKeywords}),[r.Ti.replit]:x({key:r.Ti.replit,blockType:r.Ti.replit,displayName:C.replitTitle,thumbnail:i.Z.images.blocks.replitPng,description:C.replitDescription,fuzzySearchKeywords:C.replitKeywords}),[r.Ti.table]:x({key:r.Ti.table,blockType:r.Ti.table,displayName:C.simpleTableTitle,thumbnail:i.Z.images.blocks.simpleTablePng,description:C.simpleTableDescription,fuzzySearchKeywords:C.simpleTableKeywords,tooltipPhoto:i.Z.images.tooltips.blocks.simpleTablePng,createTemplate:()=>g.S7()}),[r.Ti.tab]:x({key:r.Ti.tab,blockType:r.Ti.tab,displayName:C.tabTitle,thumbnail:i.Z.images.blocks.tabsPng,tooltipPhoto:i.Z.images.tooltips.blocks.tabsPng,description:C.tabDescription,fuzzySearchKeywords:C.tabKeywords,createTemplate:()=>g.ZW(),shouldShow:e=>(0,f.$cr)(e)}),[r.Ti.hex]:x({key:r.Ti.hex,blockType:r.Ti.hex,displayName:C.hexTitle,thumbnail:i.Z.images.blocks.hexPng,description:C.hexDescription,fuzzySearchKeywords:C.hexKeywords}),[r.Ti.deepnote]:x({key:r.Ti.deepnote,blockType:r.Ti.deepnote,displayName:C.deepnoteTitle,thumbnail:i.Z.images.blocks.deepnotePng,description:C.deepnoteDescription,fuzzySearchKeywords:C.deepnoteKeywords}),[r.MF.toggleFormatHeaderBlock]:x({key:r.MF.toggleFormatHeaderBlock,blockType:r.Ti.header,displayName:C.toggleFormatHeaderTitle,fuzzySearchKeywords:C.toggleFormatHeaderKeywords,thumbnail:i.Z.images.blocks.toggleHeading1Png,description:C.toggleFormatHeaderDescription,tooltipPhoto:i.Z.images.tooltips.blocks.toggleH1Png,createTemplate:()=>g.UG(r.Ti.header),isToggleable:!0}),[r.MF.toggleFormatSubHeaderBlock]:x({key:r.MF.toggleFormatSubHeaderBlock,blockType:r.Ti.subHeader,displayName:C.toggleFormatSubHeaderTitle,fuzzySearchKeywords:C.toggleFormatSubHeaderKeywords,thumbnail:i.Z.images.blocks.toggleHeading2Png,description:C.toggleFormatSubHeaderDescription,tooltipPhoto:i.Z.images.tooltips.blocks.toggleH2Png,createTemplate:()=>g.UG(r.Ti.subHeader),isToggleable:!0}),[r.MF.toggleFormatSubSubHeaderBlock]:x({key:r.MF.toggleFormatSubSubHeaderBlock,blockType:r.Ti.subSubHeader,displayName:C.toggleFormatSubSubHeaderTitle,fuzzySearchKeywords:C.toggleFormatSubSubHeaderKeywords,thumbnail:i.Z.images.blocks.toggleHeading3Png,description:C.toggleFormatSubSubHeaderDescription,tooltipPhoto:i.Z.images.tooltips.blocks.toggleH3Png,createTemplate:()=>g.UG(r.Ti.subSubHeader),isToggleable:!0}),[r.Ti.columnList]:x({key:r.Ti.columnList,blockType:r.Ti.columnList,displayName:C.columnListTitle,fuzzySearchKeywords:C.columnListKeywords,thumbnail:i.Z.images.blocks.columnListPng,description:C.columnListDescription,tooltipPhoto:i.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>g.n_(2),shouldShow:e=>!e.environment.device.isPhone}),[r.MF.column2Block]:x({key:r.MF.column2Block,blockType:r.Ti.columnList,displayName:C.column2Title,fuzzySearchKeywords:C.column2Keywords,thumbnail:i.Z.images.blocks.columnListPng,description:C.column2Description,tooltipPhoto:i.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>g.n_(2),shouldShow:e=>!e.environment.device.isPhone&&!e.blocks.some(v.hF)}),[r.MF.column3Block]:x({key:r.MF.column3Block,blockType:r.Ti.columnList,displayName:C.column3Title,fuzzySearchKeywords:C.column3Keywords,thumbnail:i.Z.images.blocks.columnListPng,description:C.column3Description,tooltipPhoto:i.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>g.n_(3),shouldShow:e=>!e.environment.device.isPhone&&!e.blocks.some(v.hF)}),[r.MF.column4Block]:x({key:r.MF.column4Block,blockType:r.Ti.columnList,displayName:C.column4Title,fuzzySearchKeywords:C.column4Keywords,thumbnail:i.Z.images.blocks.columnListPng,description:C.column4Description,tooltipPhoto:i.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>g.n_(4),shouldShow:e=>!e.environment.device.isPhone&&!e.blocks.some(v.hF)}),[r.MF.column5Block]:x({key:r.MF.column5Block,blockType:r.Ti.columnList,displayName:C.column5Title,fuzzySearchKeywords:C.column5Keywords,thumbnail:i.Z.images.blocks.columnListPng,description:C.column5Description,tooltipPhoto:i.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>g.n_(5),shouldShow:e=>!e.environment.device.isPhone&&!e.blocks.some(v.hF)}),[r.MF.mermaidCodeBlock]:x({key:r.MF.mermaidCodeBlock,blockType:r.Ti.code,displayName:C.mermaidCodeTitle,fuzzySearchKeywords:C.mermaidCodeKeywords,thumbnail:i.Z.images.blocks.codePng,description:C.mermaidCodeDescription,tooltipPhoto:i.Z.images.tooltips.blocks.codePng,createTemplate:()=>g.iD("Mermaid","graph TD\n  Mermaid --\x3e Diagram"),postCreateCallback:e=>{o.default.afterNextFlush((()=>{o.default.afterNextFlush((()=>{const t=u.C.find((t=>t.props.store.id===e.id)),n=null==t?void 0:t.props.store,o=n&&(0,k.mh)(n);if(o){var i;const e=(0,S.TD)({store:o,selection:{startIndex:0,endIndex:(null===(i=(0,I.x0)(o))||void 0===i?void 0:i.endIndex)??0}});c.NA({multiSelection:e})}}))}))}}),[r.MF.aiSummaryBlock]:x({key:r.MF.aiSummaryBlock,blockType:r.Ti.aiBlock,displayName:C.aiSummaryBlockTitle,fuzzySearchKeywords:C.aiSummaryKeywords,thumbnail:i.Z.images.blocks.tableOfContentsPng,description:C.aiSummaryBlockDescription,badge:"ai",createTemplate:()=>g.Jy("summarize"),shouldShow:e=>!e.environment.device.isPhone&&R(e)}),[r.MF.aiActionItemsBlock]:x({key:r.MF.aiActionItemsBlock,blockType:r.Ti.aiBlock,displayName:C.aiActionItemsBlockTitle,fuzzySearchKeywords:C.aiActionItemsKeywords,thumbnail:i.Z.images.blocks.bulletedListPng,description:C.aiActionItemsDescription,badge:"ai",createTemplate:()=>g.Jy("findActionItems"),shouldShow:e=>!e.environment.device.isPhone&&R(e)}),[r.MF.aiFreePromptBlock]:x({key:r.MF.aiFreePromptBlock,blockType:r.Ti.aiBlock,displayName:C.aiFreePromptBlockTitle,fuzzySearchKeywords:C.aiFreePromptKeywords,thumbnail:i.Z.images.blocks.calloutPng,description:C.aiFreePromptDescription,badge:"ai",createTemplate:()=>g.Jy("helpMeWrite"),shouldShow:e=>!e.environment.device.isPhone&&R(e)}),[r.Ti.drawing]:x({key:r.Ti.drawing,blockType:r.Ti.drawing,displayName:C.drawingTitle,fuzzySearchKeywords:C.drawingKeywords,thumbnail:i.Z.images.externalIntegrations.acmeIconPng,description:C.drawingDescription,shouldShow:e=>(0,h.A3)(),createTemplate:()=>g.Fr()})},A=(P[r.Ti.callout],P[r.Ti.toggle],[r.MF.aiSummaryBlock,r.MF.aiActionItemsBlock,r.MF.aiFreePromptBlock]);function R(e){let{publicEditMode:t}=e;return(0,b.GD)(t)}function D(){return"on"===p.default.getEligibleGroup({experimentId:"slash_command_import",defaultGroup:"control"})}},11599:(e,t,n)=>{n.d(t,{$0:()=>d,A$:()=>l,ab:()=>s,dy:()=>c,kq:()=>p,p1:()=>u});var o=n(80951),i=n(80444),r=n(88923);function a(){const e=d(),{mainEditorCurrentBlockStore:t}=i.default.state,n=r.default.state.open&&r.default.state.target||t;return e||n}function s(e,t){const n=a(),o=null==n?void 0:n.getFormat(),i=e&&e[t],r=(null==o?void 0:o.collection_page_sections)||[];if(!i){if("backlinks"===t)return"section_collapsed";if("comments"===t)return"section_show";if("margin_comments"===t)return"inline";if(r&&r.filter((e=>e.section===t))){const e=r.find((e=>e.section===t));if(e)return e.visibility}return"inline"}return i}function l(e,t){const n=a();if(!n)return!1;return s(n.getFormat().page_section_visibility,e)===t}function c(e){const t=a();if(!t)return!0;return"section_show"===s(t.getFormat().page_section_visibility,e)}function d(){const{mainEditorCurrentBlockStore:e}=i.default.state,t=r.default.state.open&&r.default.state.target||e;return null==t?void 0:t.getAssociatedCollectionStore()}function u(){const e=d();if(!e)return!1;const t=e.getParentBlockStore();return Boolean(t&&(t.isLocked()||t.isNavigableAncestorNonEditableState()))}function p(e){const{propertySchema:t}=e,{type:n}=t,i=(0,o.eb)(t);return!(["created_time","created_by","last_edited_time","last_edited_by"].includes(n)||i)}},41056:(e,t,n)=>{n.d(t,{H:()=>a,u:()=>s});var o=n(49085),i=n(53877);const r=new Map;function a(e){if(!r.has(e)){const t=o.default.createValue((()=>(0,i.Uu)(e)));r.set(e,t)}return r.get(e).state}function s(){for(const[e,t]of r){const n=(0,i.Uu)(e);t.state.equals(n)||t.setState(n)}}},21969:(e,t,n)=>{n.d(t,{H:()=>a,W:()=>r});var o=n(80310),i=n(18265);function r(e){const t=(0,i.Qc)(e);return t.query[o.JF]="true",(0,i.bf)({url:(0,i.WU)(t),query:t.query,hash:t.hash||void 0})}function a(e){const t=(0,i.Qc)((0,i.T1)(e));return t.query[o.f6]="true",(0,i.bf)({url:(0,i.WU)(t),query:t.query,hash:t.hash||void 0})}},74503:(e,t,n)=>{async function o(){const e={};if(!window.__isElectron)return{};const t=window.__desktopDeviceInfo;if(t)e.desktopOsVersion=t.os,e.desktopKernelVersion=t.kernel,e.desktopElectronVersion=t.electron,e.desktopChromiumVersion=t.chromium,e.desktopArch=t.arch,e.desktopPlatform=t.platform;else{const t=["architecture","fullVersionList","platformVersion"],o=await navigator.userAgentData.getHighEntropyValues(t);e.desktopArch="arm"===(n=o.architecture)?"arm64":n,e.desktopOsVersion=o.platformVersion,e.desktopPlatform=window.__platform;const i=navigator.userAgent.match(/Chrome\/([\d.]+)/);e.desktopChromiumVersion=i?i[1]:"Unknown";const r=navigator.userAgent.match(/Electron\/([\d.]+)/);e.desktopElectronVersion=r?r[1]:"Unknown"}var n;return e}n.r(t),n.d(t,{getDesktopDeviceInfo:()=>o})},71776:(e,t,n)=>{n.d(t,{$Z:()=>s,GU:()=>r,OS:()=>l,cr:()=>a});n(57658);var o=n(77420),i=n(9844);function r(e){const{ids:t,table:n,userStore:o}=e,i=[];for(const r of t){const e=o.getRecordModel({id:r,table:n});e&&i.push(e)}return a(i)}function a(e){return e.slice().sort(((e,t)=>t.created_at-e.created_at))}const s=["all","internal","public"],l={[o.cZ]:"internal",[i.K2]:"public"}},25898:(e,t,n)=>{function o(e,t,n,o){return Math.sqrt((e-n)*(e-n)+(t-o)*(t-o))}n.d(t,{Z:()=>o})},62619:(e,t,n)=>{n.d(t,{Gs:()=>a,IL:()=>p,OW:()=>u,UG:()=>r,kA:()=>m,kK:()=>s,kd:()=>c,oG:()=>d,r3:()=>f,sh:()=>l});n(57658);var o=n(15095),i=n(53965);function r(e){try{return Boolean(e&&void 0!==e.nodeType)}catch(t){return!1}}function a(e){return r(e)&&e.nodeType===Node.TEXT_NODE}function s(e){return r(e)&&e.nodeType===Node.ELEMENT_NODE}function l(e,t){for(;r(e)&&!t(e);)e=e.parentNode;return e}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(r(e)){for(const n of o.p4(e.childNodes))a(n)?t.push(n):n.childNodes&&c(n,t);return t}return[]}function d(e,t){return r(e)&&r(t)?i.cx(e.childNodes,(e=>e===t)):-1}const u=function(){if("undefined"==typeof window)return!0;if(window.InputEvent&&"function"==typeof window.InputEvent.prototype.getTargetRanges)return!0;const e=window.document.createElement("div");return e.contentEditable="true","onbeforeinput"in e}();function p(e){!u&&e.preventDefault&&e.preventDefault()}function m(e){return"inputType"in e}function f(e,t){return e!==t&&e.contains(t)}},43045:(e,t,n)=>{let o;n.d(t,{N:()=>a});let i=!1;function r(){i||(i=!0,window.requestAnimationFrame((()=>{i=!1,(o||(o=document.createElement("div"),o.style.position="fixed",o.style.top="-9999px",o.style.left="-9999px",o.style.zIndex="-9999",document.body.appendChild(o)),o).style.height=`${Math.random()}px`})))}function a(){const e=window.getSelection();e&&e.anchorNode&&r()}},63085:(e,t,n)=>{n.d(t,{bf:()=>S,kl:()=>k,NX:()=>_,sj:()=>y,W4:()=>m,id:()=>g,cJ:()=>h,I$:()=>w,YG:()=>b});n(21703);var o=n(80951),i=n(68626);n(57658);var r=n(37850),a=n(18265),s=n(95477),l=n(77080),c=n(79947);const d=3,u=1e4;async function p(e){const{environment:t,sourceURL:n}=e;let o;o=`https://embed.notion.co/api/iframely?key=${s.default.iframely_prod.key}&url=${n}`;const a={environment:t,method:"GET",url:o,format:"json"},{result:l}=await r.W(d,u,(()=>(0,c.ZP)(a)));if(l&&"success"===l.type)return function(e){const t=e;return Object.keys(e).forEach((n=>{if("meta"===n&&(e[n].title&&(t.title=e[n].title),e[n].description&&(t.description=e[n].description),e[n].site&&(t.provider_name=e[n].site)),"url"===n&&(t.url=e[n]),"links"===n){if(e[n].thumbnail&&e[n].thumbnail.length>0){t.images=[];const o={width:Number,height:Number,url:String};o.width=e[n].thumbnail[0].media&&e[n].thumbnail[0].media.width?e[n].thumbnail[0].media.width:480,o.height=e[n].thumbnail[0].media&&e[n].thumbnail[0].media.height?e[n].thumbnail[0].media.height:1080,o.url=e[n].thumbnail[0]&&e[n].thumbnail[0].href?e[n].thumbnail[0].href:"",t.images.push(o)}e[n].icon&&e[n].icon.length>0&&(t.favicon_url=e[n].icon[0].href)}})),t}(l.data);i.log({level:"error",from:"embedHelpers",type:"getExtractedData",error:null==l?void 0:l.error,data:{miscDataToConvertToString:{provider:"iframely"}}})}async function m(e,t){const n=encodeURIComponent(t.trim());return"on"===l.default.getEligibleGroup({experimentId:"iframely_switch",defaultGroup:"control"})?await p({environment:e,sourceURL:n}):await async function(e,t){const n={environment:e,method:"GET",url:`https://api.embed.ly/1/extract?key=${s.default.embedly.key}&url=${t}`,format:"json"},{result:o}=await r.W(d,u,(()=>(0,c.ZP)(n)));if(o&&"success"===o.type)return o.data;i.log({level:"error",from:"embedHelpers",type:"getExtractedData",error:null==o?void 0:o.error,data:{miscDataToConvertToString:{provider:"embedly"}}})}(e,n)}const f=/(\/d\/|id=)([-\w]{25,})/;function g(e){const t=e.match(f);if(t&&!(t.length<3))return t[2]}function h(e){return o.zB(e.store.getProperties().source)||e.source}const v=new Set(["http:","https:","blob:","data:"]);function b(e){const t=new URL(e,s.default.domainBaseUrl).protocol;return v.has(t)}function y(e){if(e&&e instanceof S)return{type:"invalid_protocol",protocol:e.protocol}}function _(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.protocol;const n=w(e);if(!n)return{type:"invalid_url",source:e};const o=new URL(n).protocol;return"https:"===t&&"http:"===o?{type:"invalid_protocol",protocol:o}:void 0}class S extends Error{constructor(e){const t=new URL(e,s.default.domainBaseUrl).protocol;super(`Invalid URL protocol: "${t}"`),this.name=void 0,this.protocol=void 0,this.protocol=t,this.name="InvalidUrlProtocolError"}}function w(e){let t=a.yn(e);if(t||e.includes(":")||(t=a.yn(`https:${e}`)),t&&new URL(t).origin!==location.origin)return t}function k(e){const{aspectRatio:t,isFullWidth:n,isFullHeight:o,preserveScale:i,height:r}=e,a={position:"relative",display:"flex",justifyContent:"center",width:"100%",minHeight:100};return o?(a.height="100%",a.position=void 0):n||!i?a.height=r:(a.height=0,a.paddingBottom=100*(t||.75)+"%"),a}},83631:(e,t,n)=>{n.d(t,{D9:()=>b,JT:()=>k,Jf:()=>I,ND:()=>y,TJ:()=>S,Xu:()=>_,bc:()=>v,by:()=>w,nk:()=>C,qZ:()=>x});var o=n(41892),i=n(98923),r=n(15095),a=n(65454),s=n(70203),l=n(38585),c=n(53965),d=n(1898),u=n(19584),p=n(36610),m=n(62619),f=n(68056),g=n(89224),h=n(89086);function v(){return(0,a.ZP)(o.Z.katex.katexMinCss,{resourceType:a._g.Stylesheet})}function b(e){const{source:t,currentEquationToken:n,selectedText:o}=e;return"rich_text_menu"===t?n?{type:"edit",source:t}:{type:"create",source:t,selection:!0}:"input_keyboard_shortcut"===t?n?{type:"edit",source:t}:{type:"create",source:t,selection:Boolean(o)}:"slash_menu"===t?{type:"create",source:t,selection:!1}:"click_token"===t||"arrow_keys"===t?{type:"edit",source:t}:"text_filter"===t?{type:"create",source:t,selection:!0}:void(0,d.t1)(t)}function y(e){const{environment:t,equation:n,from:o}=e;p.iA(t,{equation:n,equationNewlineCount:n.split("\n").length-1,equationBackslashCount:n.split("\\").length-1,equationLength:r.p4(n).length,from:o})}function _(e){return m.kK(e)&&e.classList.contains(l.et)}function S(e){const{selection:t,environment:n}=e,o=g.getRect(t);if(!o){return m.sh(t.startContainer,m.kK).getBoundingClientRect()}if(n.device.isChrome){const e=t.startContainer.childNodes[t.startOffset];return e&&_(e)?e.getBoundingClientRect():m.kK(t.startContainer)?new DOMRect(o.left,o.top,o.width,t.startContainer.getBoundingClientRect().height):new DOMRect(o.left,o.top,o.width,22)}return o}function w(e){const{environment:t,equation:n,displayMode:o}=e,r=t.KatexStore.getKatex();return r&&(0,i.CY)({katex:r,equation:n,options:{displayMode:"block"===o}}).error}function k(e){if("editing"!==e.mode)return;const t=(0,f.QY)(e.multiSelection);if(!t)return;const{store:n,selection:o}=t,{tokensBeforeRange:i,tokensInsideRange:r}=s.xrQ(n.getValue(),o.startIndex,o.endIndex);let a=c.Sm(i.map(s.J1x));for(const l of r){const e=s.J1x(l),t={startIndex:a,endIndex:a+e};if(s.YrK(l))return{token:l,position:t};a+=e}}function I(e){let t=e;for(let n=0;n<2;n+=1){const e=/^\$(.*)\$$/m.exec(t);if(!e||!e[1])break;t=e[1]}return t}function C(e){const t=(0,f.QY)(e.multiSelection);if(!t)return[];const{selection:n,store:o}=t,i=o.getValue();if(!i)return[];const r=h.wd(n)&&n.startIndex>0?[n.startIndex-1]:[n.startIndex];return h.oc(r,i)[0]||[]}function x(e){const{equationState:t,isTemporary:n}=e,o=t.editingToken?u.uh(s.hDy(t.editingToken),(e=>s.kuv(e)||s.QVC(e))):u.uh(t.annotations,(e=>s.kuv(e)||s.QVC(e)||s.ZAl(e))),i=c.oA([n&&s.W9d(),...o]);return s.qZ6(t.value,i)}},73744:(e,t,n)=>{n.d(t,{DJ:()=>a,ZV:()=>r,lj:()=>i});let o=!1;try{const e=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("test",(()=>{}),e)}catch(s){}function i(e,t,n,i){o?e.addEventListener(t,n,{passive:!0,capture:Boolean(i)}):e.addEventListener(t,n,Boolean(i))}function r(e,t,n,o){e.removeEventListener(t,n,Boolean(o))}function a(e){if(void 0!==e)return"shiftKey"in e&&"altKey"in e&&e.shiftKey&&e.altKey?"window":"metaKey"in e&&e.metaKey||"ctrlKey"in e&&e.ctrlKey?"tab":void 0}},41232:(e,t,n)=>{n.d(t,{GQ:()=>f,Ue:()=>m,Xg:()=>b,_F:()=>h,_l:()=>g,o$:()=>y,pI:()=>v,y6:()=>p});var o=n(17215),i=n(78601),r=n(2864),a=n(44876),s=n(1898),l=n(80444),c=n(77080),d=n(30874),u=n(40671);function p(e){if(e.isCollectionView()){var t,n;if(null===(t=e.getCollectionViewCollectionStore())||void 0===t||!t.isSyncedCollection())return;return null===(n=e.getCollectionViewCollectionStore())||void 0===n?void 0:n.getFormat()}return e.getFormat()}function m(e,t){const n=d.Z.state;if(!e||!n.loaded)return[];const o=(0,a.ny)({url:e,integrations:d.Z.integrations.state,currentSpaceId:t});return"success"!==o.type?[]:n.bots.filter((e=>e.integration_id===o.integration.id))}function f(e,t){if(!e)return;const n=(0,a.ny)({url:e,integrations:d.Z.integrations.state,currentSpaceId:t});return"success"===n.type?n:void 0}function g(e){const{store:t,isInDarkMode:n}=e,i=p(t);if(null!=i&&i.is_placeholder||null!=i&&i.error){const e=d.Z.integrations.state.find((e=>{let{id:t}=e;return i.integration_id===t}));if(e){const t=d.Z.bots.state.filter((t=>t.integration_id===e.id)).map((e=>{let{id:t}=e;return t})),{icon:s,dark_icon:c,accent_color:u,accent_icon:p}=e.info,m=n&&c?c:s;if(!m||!u||!p)return;const f=i.original_url;let g;if(f){var r;const t=(0,a.ny)({url:f,integrations:[e],currentSpaceId:null===(r=l.default.state.currentSpaceStore)||void 0===r?void 0:r.id});"success"===t.type&&(g=t.pattern)}return{type:null!=i&&i.is_placeholder?"placeholder":"error",userHasBotForIntegration:t.length>0,renderConfig:{headerAttributes:[{formatter:o.V1.placeholder,attribute:{id:"title",name:"Title",type:"inline",values:[e.name],format:{type:"title"}}}]},action:f&&!g?"error":void 0,updating:!1,originalUrl:f,pattern:g,integration:{id:e.id,icon:m,name:e.name,accentColor:u,accentIcon:p},botIds:t}}}return h({...e,getRenderFn:e=>e.block})}function h(e){var t;const{store:n,isInDarkMode:o,canEdit:r,currentUserId:c,showAction:d,getRenderFn:g}=e,h=p(n);if(!h||h.is_placeholder)return;if(void 0===h.external_object_id&&void 0!==h.uri)return;const v=h.original_url||h.uri;if(!n.isDefined())return;const b=f(v,n.getSpaceId()??(null===(t=l.default.state.currentSpaceStore)||void 0===t?void 0:t.id));if(!v||!b)return;const y=m(v,n.getSpaceId()),_=y.length>0,S=n.getExternalObjectSubInstanceStores(),w=S.map((e=>e.getFormat())).filter(s.$K);if(w.length!==S.length)return;const{integration:k,pattern:I}=b,{icon:C,dark_icon:x,accent_color:T,accent_icon:M}=k.info,P=o&&x?x:C;if(!P||!T||!M)return;const A=(0,i.U)(I.name),R=(0,a.Tf)({url:v,integration:k}),D=g(A)({integrationIcon:P,root:h,relations:w,parsedAttributes:R});if(!D)return;const E=u.Z.state.updatingUrls.has(v),B=Date.now(),F=Boolean(n.getCreatedById()!==c&&n.getCreatedTime()&&B-n.getCreatedTime()<6e4);let O;return!E&&r&&c&&(d?O=d:h.error?O="error":(null==h||!h.stale)&&h.attributes||F||(O=_?"update":"authenticate")),{type:"active",renderConfig:D,action:O,updating:E,originalUrl:v,integration:{id:k.id,icon:P,name:k.name,accentColor:T,accentIcon:M},pattern:I,userHasBotForIntegration:_,botIds:y.map((e=>{let{id:t}=e;return t}))}}function v(e,t){if(!t)return e;const n=f(e,t);return"success"!==(null==n?void 0:n.type)?e:(0,r.l)({url:e,integration:n.integration,pattern:n.pattern})}function b(){return"on"===c.default.getEligibleGroup({experimentId:"link_preview_resizing",defaultGroup:"control"})}function y(){return"on"===c.default.getEligibleGroup({experimentId:"link_preview_resizing_api",defaultGroup:"control"})}},6398:(e,t,n)=>{n.d(t,{hx:()=>U,lf:()=>O,ox:()=>B,r4:()=>F,t9:()=>Z});var o=n(67294),i=n(13991),r=n(480),a=n(86628),s=n(24405),l=n(6906),c=n(17397),d=n(84619),u=n(7057),p=n(53877),m=n(42875),f=n(19233),g=n(44876),h=n(9291),v=n(31701),b=n(1898),y=n(37810),_=n(62896),S=n(51077),w=n(56496),k=n(12981),I=n(81865),C=n(65085),x=n(85567),T=n(60682),M=n(77907),P=n(14976),A=n(33929),R=n(85893);function D(e){const{title:t,color:n,icon:o}=e,i=(0,s.Fg)(),r=n?(0,v.MJ)(`rgb(${n.r},${n.g},${n.b})`):void 0,a=(0,v.KR)(i,r);return(0,R.jsx)(x.Z,{format:d.lo.Medium,value:o?(0,R.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,R.jsx)(I.Z,{isAuthenticated:!1,url:o,width:32,render:(e,t)=>(0,R.jsx)(k.Z,{src:t,height:12,placeholderLoadedStyle:{width:12,height:12,marginRight:4}})}),(0,R.jsx)(_.Z,{children:(0,l.Z)(t)})]}):(0,R.jsx)(_.Z,{children:(0,l.Z)(t)}),showRemoveButton:!1,color:a.textColor,backgroundColor:a.backgroundColor,isSingle:!0,style:{display:"flex",whiteSpace:"break-spaces",flex:"0 0 auto"}})}function E(e){var t,n,o;const{uri:i,store:r,...s}=e,l=(0,a.VK)((()=>{const e=r.getExternalObjectSubInstanceStores().find((e=>{const t=e.getKeyStore("format").getKeyStore("uri").getValue();return t&&t===i}));if(e)return e.getFormat()}),[r,i]);if(!l)return null;const c=null===(t=l.attributes)||void 0===t?void 0:t.find(g.Id),d=null===(n=l.attributes)||void 0===n?void 0:n.find(g.li),u=null===(o=l.attributes)||void 0===o?void 0:o.find(g.hW);return c?u?(0,R.jsx)(D,{title:c.values[0],color:u.values[0],icon:null==d?void 0:d.values[0]}):c?(0,R.jsxs)("span",{style:{display:"flex",alignItems:"center"},children:[d&&(0,R.jsx)(S.Z,{type:"image_url",imageURL:d.values[0],size:16,style:{marginRight:4},imageStyle:s.avatarStyle}),(0,R.jsx)(B,{attribute:c,store:r,...s})]},i):null:null}function B(e){const{attribute:t,formatter:n,store:o,style:i,avatarStyle:r}=e,a=(0,s.Fg)();if((0,g.Id)(t)){var l;const e=t.values[0];if("enum"===(null===(l=t.format)||void 0===l?void 0:l.type)){const{color:n}=t.format;return(0,R.jsx)(D,{title:e,color:n})}{const t=e.replace(/[\r\n]/g,"").trim(),o=n?A.default.formatMessage(n,{value:t}):t;return(0,R.jsx)("div",{spellCheck:!1,style:{whiteSpace:"nowrap",color:a.mediumTextColor,...i},children:o})}}if((0,g.OM)(t))return(0,R.jsx)(E,{uri:t.values[0],store:o,style:i,avatarStyle:r});if((0,g.Gc)(t))return(0,R.jsx)(F,{attribute:t,formatter:e.formatter,style:e.style,dateStyle:"relative"});if((0,g.An)(t)){const e=t.values[0];return(0,R.jsx)("div",{style:{color:a.mediumTextColor,fontSize:12,...i},children:n?A.default.formatMessage(n,{value:e}):String(e)})}return null}function F(e){const{attribute:t,formatter:n,style:o,dateStyle:r}=e,a=(0,h.useIntl)(),l=(0,s.Fg)(),c=t.values[0];let d;if("datetimerange"===c.type)d=(0,u.ZV)({allowRelativeDates:!1,displayInUserTimezone:!0,intl:a,value:c});else{const e=(0,p.uO)(c,(0,m.r)());r&&"relative"!==r?"exact_time"===r?d=(0,u.Yx)(e,"medium_with_time",i.SP):"exact_date"===r?d=(0,u.Yx)(e,"medium",i.SP):(0,b.t1)(r):d=(0,u.tv)(e,i.SP)}const f=n?A.default.formatMessage(n,{value:d}):d;return(0,R.jsx)("div",{style:{color:l.mediumTextColor,fontSize:12,whiteSpace:"nowrap",...o},children:f})}function O(e){const t=(0,s.Fg)(),{attribute:n,isSmall:o}=e,i=o?22:34,r={...e.style,borderRadius:i,boxShadow:t.avatarBoxShadow};return(0,g.li)(n)?(0,R.jsx)(S.Z,{type:"image_url",imageURL:n.values[0],size:i,imageStyle:r}):(0,g.Id)(n)?(0,R.jsx)("div",{style:{...r,borderRadius:i,overflow:"hidden",boxShadow:t.avatarBoxShadow,height:30,width:30},children:(0,R.jsx)(w.Z,{size:i,title:n.values[0]})}):null}function Z(e){var t;const{attribute:n}=e,{value:r}=(0,M.useDependency)(M.deps.prismjs),a=o.useRef(null),l=(0,s.yK)((e=>({text:{flexGrow:1,flexShrink:1,textAlign:"left",fontFamily:y.Z.getCompositeFontFamily(i.SP).githubMono,fontSize:"85%",tabSize:2,minHeight:"1em"},buttons:{fontWeight:y.Z.fontWeight.medium}})),[]);return o.useEffect((()=>{var e;r&&a.current&&(a.current.innerHTML=function(e,t,n){if(n&&(0,c.L9)(n)){const o=f.W[n];return e.highlight(t,e.languages[o],n)}return`<code>${t}</code>`}(r,n.values[0],null===(e=n.format)||void 0===e?void 0:e.language))}),[r,null===(t=n.format)||void 0===t?void 0:t.language,n.values]),r?(0,R.jsx)("div",{style:{marginRight:4,marginBottom:4,width:"100%"},children:(0,R.jsx)(C.Z,{moreElement:(0,R.jsxs)(R.Fragment,{children:["â€¦","Â ",(0,R.jsx)("span",{style:{...l.text,...l.buttons},children:(0,R.jsx)(h.FormattedMessage,{id:"externalObjectInstance.bodyAttribute.moreLabel",defaultMessage:"more"})})]}),lessElement:(0,R.jsx)(R.Fragment,{children:(0,R.jsx)("span",{style:{...l.text,...l.buttons},children:(0,R.jsx)(h.FormattedMessage,{id:"externalObjectInstance.bodyAttribute.showLessLabel",defaultMessage:"show less"})})}),maxLines:8,children:(0,R.jsx)("div",{spellCheck:!1,style:l.text,ref:a})})}):null}function V(e){const{attribute:t,store:n}=e,o=(0,s.Fg)(),i=(0,r.O7)(),l=(0,a.VK)((()=>(0,g.Id)(t)?t.values[0]:(0,P.IY)({environment:i,textValue:{value:t.values,spaceId:n.id},disableHover:!0,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableLinks:!1,disabled:!1,katex:i.KatexStore.getKatex(),parentStore:n,emojiType:(0,T.e_)(i),formulaValueTypes:[],theme:o})),[i,n,o,t]);return(0,R.jsx)("div",{children:l})}function U(e){const t=(0,s.yK)((e=>({text:{color:e.regularTextColor,fontSize:12,lineHeight:1.45},buttons:{fontWeight:y.Z.fontWeight.medium}})),[]);return(0,R.jsx)("div",{style:{marginRight:4,marginBottom:4,width:"100%"},children:(0,R.jsx)(C.Z,{moreElement:(0,R.jsxs)(R.Fragment,{children:["â€¦","Â ",(0,R.jsx)("span",{style:{...t.text,...t.buttons},children:(0,R.jsx)(h.FormattedMessage,{id:"externalObjectInstance.bodyAttribute.moreLabel",defaultMessage:"more"})})]}),lessElement:(0,R.jsx)(R.Fragment,{children:(0,R.jsx)("span",{style:{...t.text,...t.buttons},children:(0,R.jsx)(h.FormattedMessage,{id:"externalObjectInstance.bodyAttribute.showLessLabel",defaultMessage:"show less"})})}),maxLines:3,children:(0,R.jsx)("div",{spellCheck:!1,style:t.text,children:(0,R.jsx)(V,{attribute:e.attribute,store:e.store})})})})}},69988:(e,t,n)=>{n.d(t,{LX:()=>c,Vu:()=>d,XT:()=>p,ZP:()=>m,fe:()=>u,il:()=>l});n(57658);var o=n(92338),i=n(53965),r=n(19584);function a(e){const t=[];let n=!1,i=e;for(;""!==i;){const e=n?o.dK:o.Um,r=i.indexOf(e);if(-1===r)return t.push(s(i,!1)),t;const a=i.substring(0,r),l=i.slice(r+e.length);""!==a&&t.push(s(a,n)),i=l,n=!n}return t}function s(e,t){return t?[e,"highlight"]:[e]}function l(e){return 2===e.length&&"highlight"===e[1]}function c(e){return e[0]}function d(e){return e.reduce(((e,t)=>{if(0===e.length)return[t];const n=e[e.length-1];return l(n)===l(t)?[...e.slice(0,e.length-1),s(c(n)+c(t),l(t))]:[...e,t]}),[])}function u(e){if(!e)return[];let t=a(e);t.some((e=>l(e)&&1===c(e).length))&&(t=d(t));const n=t.filter(l).map(c);return i.jj(n)}function p(e){const{text:t,patterns:n,uniqueTokenHighlighterContext:o}=e,a=i.jj(n.filter((e=>e.length>0)));if(0===a.length)return[s(t,!1)];const l=i.MR(a,(e=>-e.length)).map(i.hr);return function(e,t,n){const o=(0,r.uO)(t,e);if(0===o.length)return[s(e,!1)];let i=0;const a=[];for(let r=0;r<o.length;r++){const t=o[r];if(!t)continue;let l;void 0===n||!n.has(t[0].toLowerCase())?(void 0!==n&&n.add(t[0].toLowerCase()),i!==t.index&&a.push(s(e.slice(i,t.index),!1)),a.push(s(t[0],!0)),l=t.index+t[0].length):l=i;o[r+1]||l===e.length||a.push(s(e.slice(l),!1)),i=l}return a}(t,new RegExp(l.join("|"),"ig"),o)}const m=a},44486:(e,t,n)=>{n.d(t,{W:()=>r});var o=n(41432),i=n(6258);function r(e){return e.findRecordStoreUIAncestor((e=>e instanceof i.G&&e.getType()===o.Ti.factory)).ancestor}},79897:(e,t,n)=>{n.d(t,{A3:()=>c,rf:()=>l});var o=n(67294),i=n(53965),r=n(80444),a=n(81236),s=n(48779);function l(e){const{currentUserRootStore:t}=r.default.state,n=null==t?void 0:t.getSpaceViewStores(),o=i.oA(null==n?void 0:n.map((e=>e.getSpaceId()))).map((t=>a.Z.getData(e,{spaceId:t}))),l=function(e){const t=e.map((e=>(0,s.cD)(e))),n=new Set(i.oA(t));return n.has("enterprise")?"enterprise":n.has("business")?"business":n.has("plus")?"plus":n.has("team_free")?"team_free":n.has("student")?"student":n.has("personal")?"personal":n.has("personal_free")?"personal_free":(n.has("free"),"free")}(o);return{userHighestPlanType:l,isSalesAssistedPlan:i.hX(o,{subscriptionTier:l}).some((e=>{if("none"!==(null==e?void 0:e.role)&&!0===(null==e?void 0:e.is_sales_assisted))return!0}))}}function c(){const[e,t]=(0,o.useState)(!1);return(0,o.useEffect)((()=>{function e(e){var n,o;"forethoughtWidgetOpened"===(null==e||null===(n=e.data)||void 0===n?void 0:n.event)?t(!0):"forethoughtWidgetClosed"===(null==e||null===(o=e.data)||void 0===o?void 0:o.event)&&t(!1)}return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}})),e}},8304:(e,t,n)=>{n.d(t,{A1:()=>a,M5:()=>r,sY:()=>i});var o=n(42875);const i=(0,n(9291).defineMessages)({whereToDuplicate:{id:"forkPageModal.title",defaultMessage:"Where would you like to add {blockTitle}?"},selectWorkspace:{id:"forkPageModal.selectWorkspace",defaultMessage:"Select a workspace"},untitledBlockRecordTitle:{defaultMessage:"Untitled",id:"forkPageActions.untitledBlockRecordTitle"},untitledSpaceRecordTitle:{defaultMessage:"Untitled",id:"forkPageActions.untitledSpaceRecordTitle"},loadingStateDisplayText:{defaultMessage:"Duplicating {blockTitle} to {spaceTitle}â€¦",id:"forkPageActions.loadingStateDisplayText"}});function r(e,t){var n;const r=null==e||null===(n=e.getModel())||void 0===n?void 0:n.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:(0,o.r)(),intl:t});return r||t.formatMessage(i.untitledBlockRecordTitle)}function a(e,t){var n;const o=null==e||null===(n=e.getModel())||void 0===n?void 0:n.getRenderTitleWithEmoji({placeholder:t.formatMessage(i.untitledSpaceRecordTitle)});return o||t.formatMessage(i.untitledSpaceRecordTitle)}},19306:(e,t,n)=>{n.d(t,{W:()=>a});var o=n(9291),i=n(33929);const r=(0,o.defineMessages)({twoItems:{id:"formatSettings.twoItems",defaultMessage:"{item1} and {item2}"},threeOrMoreItems:{id:"formatSettings.threeOrMoreItems",defaultMessage:"{item1}, and {numberOfOther} others"},twoItemsWithAmpersand:{id:"formatSettings.twoItems.withAmpersand",defaultMessage:"{item1} & {item2}"},threeOrMoreItemsWithRemoveComma:{id:"formatSettings.threeOrMoreItems.withRemoveComma",defaultMessage:"{item1} and {numberOfOther} others"},threeOrMoreItemsWithAmpersand:{id:"formatSettings.threeOrMoreItems.withAmpersand",defaultMessage:"{item1}, & {numberOfOther} others"},threeOrMoreItemsWithAmpersandAndRemoveComma:{id:"formatSettings.threeOrMoreItems.withAmpersandAndRemoveComma",defaultMessage:"{item1} & {numberOfOther} others"}});function a(e,t){const{removeComma:n,useAmpersand:o}=t||{};if(0===e.length)return"";const a=e[0];if(1===e.length)return a;const s=e[1];if(2===e.length)return o?i.default.formatMessage(r.twoItemsWithAmpersand,{item1:a,item2:s}):i.default.formatMessage(r.twoItems,{item1:a,item2:s});const l=e.length-1;return o?n?i.default.formatMessage(r.threeOrMoreItemsWithAmpersandAndRemoveComma,{item1:a,numberOfOther:l}):i.default.formatMessage(r.threeOrMoreItemsWithAmpersand,{item1:a,numberOfOther:l}):i.default.formatMessage(r.threeOrMoreItems,{item1:a,numberOfOther:l})}},83105:(e,t,n)=>{n.d(t,{_R:()=>d,uP:()=>l,vu:()=>s});n(57658);var o=n(30120),i=n(18201),r=n(53965),a=n(1898);let s=function(e){return e.Default="Default",e.Link="Link",e.Favorite="Favorite",e.Search="Search",e}({});const l=3,c={BONUS:{DEFAULT:100,LINK:120,SEARCH:200,FAVORITE:140},BONUS_NORMALIZER:100,TIME_BUCKETS:[{days:4,weight:100},{days:14,weight:70},{days:31,weight:50},{days:90,weight:30}],DEFAULT_BUCKET_WEIGHT:10};class d{constructor(e){var t=this;this.maxStoredVisits=void 0,this.visits=void 0,this.recordVisit=e=>{const{id:t,type:n,timestampForTestingOnly:o}=e,i=this.createVisit(n,o),a=this.visits.get(t);if(a.error)return;const s=a.value||this.createVisitCacheEntry();var l,c,d;s.totalVisits+=1,s.recentVisits=(l=s.recentVisits,c=i,d=this.maxStoredVisits,[...(0,r.pm)(l,d-1),c]),this.visits.set(t,s)},this.getVisits=e=>{const t=this.visits.get(e);if(!t.error)return t.value},this.getVisitedIds=()=>{const e=this.visits.keys();return e.error?[]:e.value},this.getFrecencyScore=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();const i=t.getVisits(e);if(!i)return d.UNVISITED_FRECENCY_SCORE;const{totalVisits:l,recentVisits:u}=i;if(0===l||0===u.length)return d.UNVISITED_FRECENCY_SCORE;const p=u.map((e=>{const{type:t,timestamp:i}=e,r=function(e){const{BONUS:t}=c;switch(e){case s.Default:return t.DEFAULT;case s.Link:return t.LINK;case s.Favorite:return t.FAVORITE;case s.Search:return t.SEARCH;default:(0,a.t1)(e)}}(t),l=function(e,t){const{TIME_BUCKETS:n,DEFAULT_BUCKET_WEIGHT:i}=c,r=o.ou.fromMillis(e).diff(o.ou.fromMillis(t),"days").get("days");return r<=n[0].days?n[0].weight:r<=n[1].days?n[1].weight:r<=n[2].days?n[2].weight:r<=n[3].days?n[3].weight:i}(n,i);return l*(r/c.BONUS_NORMALIZER)})),m=(0,r.Sm)(p)/p.length;return Math.ceil(l*m)};const{maxBlocks:n,maxStoredVisits:l,store:u,version:p}=e;this.maxStoredVisits=l,this.visits=new i.Z({prefix:e.prefix||"FrecencyStore",maxSize:n,store:u,version:p})}initialize(){this.visits.updateVersionAndGC()}sortFrecencyHighToLow(e){const{items:t,now:n,recordFrecency:o}=e;return(0,r.MR)(t,(e=>{const t="number"==typeof e.score?e.score:1,i=this.getFrecencyScore(e.id,n);o&&(e.frecencyScore=i);const r=e.personalizationBoost??1;return-1*t*Math.max(i,r)}))}createVisitCacheEntry(){return{totalVisits:0,recentVisits:[]}}createVisit(e,t){return{type:e,timestamp:"number"==typeof t?t:Date.now()}}clear(){const e=[];this.visits.scan((t=>e.push(t)));for(const t of e)this.visits.remove(t)}}d.UNVISITED_FRECENCY_SCORE=1},8989:(e,t,n)=>{n.d(t,{RT:()=>a,bk:()=>s,tt:()=>r});var o=n(77080),i=n(72340);function r(){return"on"===o.default.getEligibleGroup({experimentId:"generic_importer",defaultGroup:"control"})}function a(){return o.default.checkGate("zip_importer_enabled")}function s(e){const t=o.default.getEligibleGroup({experimentId:"special_case_generic_file_size",defaultGroup:i.CN.toString()});return Number(t)}},84210:(e,t,n)=>{n.d(t,{Hu:()=>p,ZP:()=>m});var o=n(1800),i=n(15157),r=n(63306),a=n(70096),s=(n(18265),n(95477)),l=n(80444),c=n(77556),d=n(88923),u=n(98165);function p(e){e={fullyQualified:!0,...e};const{store:t,collectionViewId:n,showMoveTo:p,saveParent:m,duplicate:f,getSpaceDomain:g,pageVisitSource:h,queryId:v}=e;let b;if(n)b=n;else if(t&&t.isCollectionView()){const e=i.Z.get({userId:t.environment.currentUser.id,key:c.Z.getLocalViewPreferenceKey(t.id)});if(e)b=e;else{const e=t.getCollectionViewsStore().getValue();e&&(b=e[0])}}const y=(t.getSpaceId()&&t.getSpaceStore())??l.default.state.currentSpaceStore,_=(0,u.fJ)(t),S=(0,r.$t)(_),w=t.environment.RouterStore.state.route,k=e.preferPublicLink||("page"===w.name||"space"===w.name)&&(w.requestedOnPublicDomain||w.requestedOnExternalDomain),I=k&&S?(null==y?void 0:y.getPublicContentDomain())||(null==g?void 0:g()):null==y?void 0:y.getEditDomain();let C=s.default.domainBaseUrl;const x=k&&S&&I;x&&(C=(0,o.P)({publicDomainName:s.default.publicDomainName,domainBaseUrl:s.default.domainBaseUrl,spaceDomain:I}));let T=t,M=e.scrollToBlockId;if(t.isReady()&&!t.isNavigableBlock()){const e=(0,u.Dg)(t);e&&(T=e,M=t.id)}const P=l.default.state.mainEditorCurrentBlockStore;let A,R,D;return P&&e.openInSidePeek?(A=P,R=T.id,D=(0,d.getUrlParamFromPeekMode)(a.R)):(A=T,R=e.peekViewBlockId,D=e.peekMode),(0,o.Z)({pageId:A.id,pageModel:A.getModel(),pageVisitSource:h,queryId:v,scrollToBlockId:M,peekViewBlockId:R,peekMode:D,collectionViewId:b,discussionId:e.discussionId,spaceDomain:x?void 0:I,baseUrl:e.fullyQualified||k?C:void 0,showMoveTo:p,saveParent:m,duplicate:f,templateGalleryItem:e.templateGalleryItem,projectManagementLaunch:e.projectManagementLaunch})}const m=p},87078:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(15723);const i=function(){const e=document.documentElement;return new o.iL(0,0,e.clientWidth,e.clientHeight)}},28415:(e,t,n)=>{n.d(t,{I2:()=>p,qH:()=>u,vE:()=>c});var o=n(65454),i=n(99405),r=n(57549),a=n(47839),s=n(95477),l=n(77080);async function c(e){const{environment:t,accessToken:n}=e;if(r.D6(t,{from:e.from}),t.device.isElectron){const t=await a.openGoogleDrivePickerPopup({url:(0,i.zN)(s.default.domainBaseUrl,{token:n,viewType:e.viewType})});if(!t)return;"integration"in e?e.callback(!1,t.url):e.callback(t.id)}else await(0,o.ZP)("https://apis.google.com/js/api.js"),"integration"in e?window.gapi.load("picker",(()=>d({environment:t,accessToken:n,callback:e.callback,integration:e.integration,viewType:e.viewType}))):window.gapi.load("picker",(()=>d({environment:t,accessToken:n,callback:e.callback,viewType:e.viewType})))}function d(e){const{environment:t,accessToken:n}=e,o=`${window.location.protocol}//${window.location.host}`;(new window.google.picker.PickerBuilder).enableFeature(window.google.picker.Feature.SUPPORT_DRIVES).setOAuthToken(n).hideTitleBar().addView(new window.google.picker.DocsView(e.viewType)).setOrigin(o).setCallback((n=>{if(n.action===window.google.picker.Action.PICKED&&n.docs&&n.docs.length>0){const o=n.docs[0];"integration"in e?e.callback(!1,o.url):e.callback(o.id),r.D6(t,{from:"link_preview_placeholder"})}})).build().setVisible(!0)}function u(){return"on"===l.default.getEligibleGroup({experimentId:"google_external_integration_file_picker",defaultGroup:"control"})}function p(){return l.default.checkGate("google_doc_importer")}},12534:(e,t,n)=>{n.d(t,{$0:()=>a,Af:()=>o,Wi:()=>s,ZP:()=>l});let o=function(e){return e[e.ButtonMouseDown=0]="ButtonMouseDown",e[e.EditorMouseDown=1]="EditorMouseDown",e[e.EditorMouseUp=2]="EditorMouseUp",e[e.EditorClick=3]="EditorClick",e[e.MenuListClick=4]="MenuListClick",e[e.EditorContextMenu=5]="EditorContextMenu",e[e.EditorMouseOver=6]="EditorMouseOver",e[e.EditorHoverMouseMove=7]="EditorHoverMouseMove",e[e.EditorDropMouseMove=8]="EditorDropMouseMove",e[e.EditorDoubleClick=9]="EditorDoubleClick",e[e.SidebarMouseMove=10]="SidebarMouseMove",e[e.ManageTeamsRowClick=11]="ManageTeamsRowClick",e[e.MobileTap=12]="MobileTap",e[e.CollectionSettingsClick=13]="CollectionSettingsClick",e[e.BaseTableRowClick=14]="BaseTableRowClick",e[e.NotificationClick=15]="NotificationClick",e[e.CollectionAutomationSettingsClick=16]="CollectionAutomationSettingsClick",e[e.PageTitleClick=17]="PageTitleClick",e[e.AssistantGroupedEditClick=18]="AssistantGroupedEditClick",e}({});const i={};function r(e){const t=i[e.context],n=e.event.nativeEvent||e.event;if(t!==n){var o;i[e.context]=n;"unhandled"===(null===(o=e.callback)||void 0===o?void 0:o.call(e))&&(i[e.context]=t)}}function a(e){r({event:e,context:o.EditorMouseDown,callback:()=>{}})}function s(e){r({event:e,context:o.EditorClick,callback:()=>{}})}const l=r},73203:(e,t,n)=>{n.d(t,{r:()=>i});var o=n(77080);function i(){return"variant_b"===o.default.getEligibleGroup({experimentId:"horizon_1_new_page_experience",defaultGroup:"control"})}},87290:(e,t,n)=>{n.d(t,{B:()=>l,x:()=>s});var o=n(55367),i=n(22294),r=n(86486),a=n(27724);let s=function(e){return e[e.Default=0]="Default",e[e.Hovered=1]="Hovered",e[e.Selected=2]="Selected",e[e.SelectedDescendant=3]="SelectedDescendant",e}({});function l(e,t){var n;const l=a.default.state.stores,c=r.default.state;if(1===l.length&&l.includes(e))return s.Selected;if(l.length>0&&l.every((t=>e.uiContains(t))))return s.SelectedDescendant;const d=o.ZP.state;return d&&d.isDragging&&d.currentParentStore&&e.uiContains(d.currentParentStore)||d&&d.isDragging&&d.currentDropZone&&d.currentDropZone.type===o.Dl.Selectable&&null!==(n=d.currentDropZone)&&void 0!==n&&n.store&&e.uiContains(d.currentDropZone.store)||c.isOpen&&c.currentStore===e||t&&!i.Z.state.isKeyboardMode?s.Hovered:s.Default}},49394:(e,t,n)=>{n.d(t,{Je:()=>u,ub:()=>d});n(57658);var o=n(70203),i=n(38585),r=n(53965),a=n(80444),s=n(26842),l=n(95256),c=n(20454);function d(e){const{find:t,textValue:n,intl:d}=e,u=(0,o.Oqk)({textValue:n,substring:t,ignoreCase:!0}).map((e=>({selection:e,allowReplace:!0}))),p=function(e){const{textValue:t,find:n,intl:i}=e,s=(0,o.P0m)(t),d=a.default.state.currentUserStore;if(0===s.length||!d)return[];const u=s.map((e=>{let t,{pointer:o,selection:r}=e;if("notion_user"===o.table)t=c.U.createChildStore(d,o);else{if("bot"!==o.table)return void o.table;t=l.Q.createChildStore(d,o)}if(t.getDisplayName(i).toLowerCase().includes(n.toLowerCase()))return r}));return r.oA(u)}({textValue:n,intl:d,find:t}).map((e=>({selection:e,allowReplace:!1}))),m=(0,o.Un8)({textValue:n,find:t,intl:d}).map((e=>({selection:e,allowReplace:!1}))),f=function(e){const{find:t,textValue:n}=e,l=(0,o.HC)(n),c=a.default.state.currentSpaceStore;if(!c)return[];const d=l.map((e=>{let{pointer:n,selection:r}=e;const a=s.G.createChildStore(c,n);if((0,o.QaF)(a.getTitleValue()).substring(0,i.l0).toLowerCase().includes(t.toLowerCase()))return r}));return r.oA(d)}({textValue:n,find:t}).map((e=>({selection:e,allowReplace:!1})));return[...u,...p,...f,...m]}function u(e){const{block:t,find:n,intl:o}=e,i=[];if("table_row"!==t.getType())return[];const a=t.getProperties();return r.oA(Object.values(a)).forEach((e=>{const t=d({find:n,intl:o,textValue:e});t.length>0&&i.push(...t)})),i}},45023:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(27537),i=n.n(o),r=n(53965);const a=function e(t,n,o){if(Array.isArray(o))return o.some((o=>e(t,n,o)));{const e=o.toLowerCase().split("+");if(t.device.isWindows||t.device.isLinux){if((r.q9(e,"command")||r.q9(e,"ctrl"))!==n.ctrlKey)return!1}else{if(r.q9(e,"command")!==n.metaKey)return!1;if(r.q9(e,"ctrl")!==n.ctrlKey)return!1}return r.q9(e,"shift")===n.shiftKey&&(r.q9(e,"alt")===n.altKey&&r.yW(e,(e=>{if("command"===e||"shift"===e||"ctrl"===e||"alt"===e)return!0;const t="code:";if(e.startsWith(t)&&n.code){const t=e.substr(5);return n.code.toLowerCase()===t}return i()(n.keyCode)===e})))}}},92783:(e,t,n)=>{n.d(t,{Z:()=>o});const o=function(e){const{spaceViewStore:t,pageId:n}=e;return!(!t||!n)&&-1!==t.getBookmarkedPageIds().indexOf(n)}},28314:(e,t,n)=>{n.d(t,{lF:()=>a,yA:()=>i});var o=n(49085);function i(){return r}const r={shift:!1,option:!1,control:!1,command:!1},a=o.default.createValue(r);function s(e){r.shift=Boolean(e.shiftKey),r.option=Boolean(e.altKey),r.control=Boolean(e.ctrlKey),r.command=Boolean(e.metaKey),a.emit()}window.addEventListener("keydown",s),window.addEventListener("keyup",s),window.addEventListener("focus",(function(e){r.shift=!1,r.option=!1,r.control=!1,r.command=!1,a.emit()}))},78429:(e,t,n)=>{n.d(t,{H:()=>r});var o=n(95477),i=n(77080);function r(){return o.default.isAdminMode||"on"===i.default.getEligibleGroup({experimentId:"highlight_legacy_transclusions",defaultGroup:"control"})}},48709:(e,t,n)=>{n.d(t,{FV:()=>c,Fs:()=>m,Ts:()=>f,ZG:()=>p,cX:()=>d,dY:()=>h,hy:()=>u,uP:()=>g});var o=n(99405),i=n(70203),r=n(18265),a=n(95477),s=n(23178);function l(e,t){const n=s.Z.state;n.open&&n.focusLinkInput!==e&&s.Z.setState({...n,focusLinkInput:e,url:t?"":n.url})}function c(){l(!0),p(!1)}function d(){l(!1)}function u(){l(!1,!0)}function p(e){const t=s.Z.state;t.open&&t.focusTitleInput!==e&&s.Z.setState({...t,focusTitleInput:e})}function m(e){const{editingToken:t}=e;if(!t)return;const n=i.hDy(t),o=i.rlz(n);return o?i.zW$(o):void 0}function f(e){if(!e)return;const t=i.hDy(e);return i.rlz(t)?i.WiV(e):void 0}function g(e){return e.url||""}function h(e){const t=i.rOz(e);if(t&&"url"===t.type){const e=(0,o.Wj)({url:t.href,baseUrl:a.default.domainBaseUrl,publicDomainName:a.default.publicDomainName,isMobile:!1,protocol:void 0,currentUrl:void 0});return"page"===e.name?{type:"notion",url:t.href,notionPage:e}:{type:"web",url:t.href}}const n=(0,r.yn)(e);if(n)return{type:"other",url:n}}},27383:(e,t,n)=>{n.d(t,{y:()=>i});function o(e){return e.teamId?`${e.collectionViewId}-${e.teamId}`:e.collectionViewId}const i=new class{constructor(){this.cache=new Map,this._locallyMutatedTasksDatabase=!1}get locallyMutatedTasksDatabase(){return this._locallyMutatedTasksDatabase}set locallyMutatedTasksDatabase(e){this._locallyMutatedTasksDatabase=e}get(e){const t=o(e);return this.cache.get(t)}set(e,t){const n=o(e);for(this.cache.delete(n),this.cache.set(n,t);this.cache.size>25;){const e=this.cache.keys().next().value;this.cache.delete(e)}}}},28125:(e,t,n)=>{n.d(t,{S:()=>s,k:()=>a});var o=n(13991),i=n(77080),r=n(12955);function a(e){const{mobileNative:t}=e;if(t){const n=Boolean(t.sqliteConnection),o=r.canSetCookie(e);return n&&o}return!0}function s(e){return"en-US"===o.SP&&(e.device.isElectron&&i.default.checkGate("desktop_app_signup_hide_passcode")||e.device.isMobileNative&&e.device.isIOS&&i.default.checkGate("ios_app_signup_hide_passcode"))}},60709:(e,t,n)=>{n.d(t,{Xp:()=>s,mw:()=>l,og:()=>i,qW:()=>c});var o=n(67381);let i=function(e){return e[e.Modal=0]="Modal",e[e.ActionSheet=1]="ActionSheet",e[e.Popup=2]="Popup",e}({});const r="menu",a=(0,o.Q)({modernContextDefaultValue:{menuType:void 0},displayName:r,legacyContextKey:r}),s=a.context,l=a.legacyPropTypes,c=a.Provider},85818:(e,t,n)=>{n.d(t,{$6:()=>a,Ds:()=>i,_K:()=>r,tM:()=>s});var o=n(53965);function i(e,t){let n=0;for(let o=0;o<t.length;o+=1){const i=t[o];if(e>n+i.items.length-1){n+=i.items.length;continue}const r=e-n,a=i.items[r];if(!a)return;return{item:a,index:{section:o,indexLocal:r}}}}function r(e,t){const n=t[e.section];if(!n)return;const o=n.items[e.indexLocal];return o||void 0}function a(e,t){return o.Sm(t.slice(0,e.section).map((e=>e.items.length)))+e.indexLocal}function s(e){return e.reduce(((e,t)=>e+t.items.length),0)}},98742:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(77744),i=n(53965);function r(e,t){const n={...e};return Object.keys(t).forEach((r=>{const a=t[r],s=e[r];s&&r.startsWith("on")&&i.mf(a)?n[r]=function(){s(...arguments),a(...arguments)}:s&&("ref"===r||r.endsWith("Ref"))&&a?n[r]=(0,o.lq)(s,a):s||(n[r]=a||s)})),n}},64496:(e,t,n)=>{n.d(t,{_3:()=>s,fP:()=>a,qE:()=>r});var o=n(5162);const i="__mobileExperimentCache";function r(){return window[i]}function a(e,t,n){if(n)return t&&n.userExperiments?n.userExperiments[t]:{experimentsBySpace:{},experimentsWithoutSpace:n.deviceExperiments,isLoaded:!0,userId:void 0,deviceId:e,test:!1}}function s(e){return(0,o.Y)("supportsMobileExperimentCache")}},52533:(e,t,n)=>{n.d(t,{S$:()=>a,Y2:()=>r,nd:()=>i});var o=n(11342);n(1898),n(95477);let i=function(e){return e[e.Bottom=0]="Bottom",e[e.Floating=1]="Floating",e}({});function r(e){const{environment:t}=e;return!t.device.isIOS&&!t.device.isAndroid}function a(e){const{environment:t}=e;if(!t.device.isIOS)return!1;if(!t.mobileNative||!t.mobileNative.api.openUpgradeModal)return!1;{if(!t.device.mobileAppVersion)return!1;const e=o.parseVersion(t.device.mobileAppVersion),n=o.parseVersion("0.4.165");if(!e||!n)return!1;return!o.isLessThanVersion(e,n)}}},56335:(e,t,n)=>{n.d(t,{d:()=>i});var o=n(77080);function i(){return"on"===o.default.getEligibleGroup({experimentId:"monday_importer",defaultGroup:"control"})}},39500:(e,t,n)=>{n.d(t,{N9:()=>s,Nf:()=>l,Vc:()=>i,X9:()=>c,uG:()=>d});var o=n(30583);const i={mouse:6,finger:0,stylus:6},r=3,a=4;function s(e){return e.button===r||e.button===a}function l(e){return e&&"stylus"===e.touchType?"stylus":"finger"}function c(){return o.IL.moved}function d(e){return!!e.isTrusted&&c()}},75770:(e,t,n)=>{n.d(t,{lQ:()=>F,hD:()=>B,cJ:()=>Z,HE:()=>D,uw:()=>O,EC:()=>P,ah:()=>A,vz:()=>E,ru:()=>V,ed:()=>U});n(21703),n(67294);var o=n(41432),i=n(53877),r=n(69246),a=n(21202),s=n(6287),l=n(75246),c=n(29369),d=n(9291),u=n(1898),p=n(47307),m=n(74523),f=n(80444),g=n(55367),h=n(6258),v=n(99757),b=n(33929),y=n(35026),_=n(98165),S=n(46654),w=n(18514),k=n(48779),I=n(85644),C=n(37810),x=n(85893);async function T(){return p.confirmUserAction({message:(0,x.jsx)("span",{children:(0,x.jsx)(d.FormattedMessage,{defaultMessage:"Are you sure you want to make this page private? <boldtext>Only you will be able to access it.</boldtext>",id:"confirmDialog.movePageToPrivate.message",values:{boldtext:e=>(0,x.jsx)("span",{style:{fontWeight:C.Z.fontWeight.semibold},children:e})}})}),acceptLabel:(0,x.jsx)(d.FormattedMessage,{defaultMessage:"Move to private",id:"confirmDialog.movePageToPrivate.confirmButton.label"})})}const M=(0,d.defineMessages)({privateDestinationName:{id:"moveToHelpers.destinationName.private",defaultMessage:"Private"},numPagesDescriptorString:{id:"moveToHelpers.movePageDescriptorString",defaultMessage:"{numPagesMoved, plural, one {# page} other {# pages}}"},numPagesWithSubitemsDescriptorString:{id:"moveToHelpers.movePagesWithSubitemsDescriptorString",defaultMessage:"{numPagesMoved, plural, one {# page} other {# pages}} and {numSubitemsMoved, plural, one {# sub-item} other {# sub-items}}"},numBlocksDescriptorString:{id:"moveToHelpers.moveBlocksDescriptorString",defaultMessage:"{numBlocksMoved, plural, one {# block} other {# blocks}}"},bookmarksDestinationName:{id:"moveToHelpers.destinationName.favorites",defaultMessage:"Favorites"},movedMessagesWithDestinationToast:{id:"moveToHelpers.afterBulkMoveCompleteToastMessageWithDestination",defaultMessage:"Moved {pageDescriptor} to {destinationName}"},movedToDestinationShortToast:{id:"moveToHelpers.afterMoveCompleteOnMobileToastMessageWithDestination",defaultMessage:"Moved to {destinationName}"},movedMessagesToast:{id:"moveToHelpers.afterBulkMoveCompleteToastMessage",defaultMessage:"Moved {pageDescriptor}"}});function P(e){const{movedItems:t,numSubitems:n}=e;if(!(t.filter((e=>e.isNavigableBlock())).length===t.length))return b.default.formatMessage(M.numBlocksDescriptorString,{numBlocksMoved:t.length});if(1===t.length){const e=R(t[0]);if(e)return e}return n?b.default.formatMessage(M.numPagesWithSubitemsDescriptorString,{numPagesMoved:t.length-n,numSubitemsMoved:n}):b.default.formatMessage(M.numPagesDescriptorString,{numPagesMoved:t.length})}function A(e){const{environment:t,movedItems:n,moveToLocation:o,numSubitems:i}=e,r=P({movedItems:n,numSubitems:i}),a=function(e){const{environment:t,moveToLocation:n}=e,{currentSpaceStore:o}=f.default.getState();if(void 0===n||void 0===o)return;switch(n.type){case"moveToBlock":return R(n.blockStore);case"moveToCollection":return R(n.collectionStore);case"moveToCurrentWorkspace":return(0,k.rn)(t,o);case"moveToPrivatePages":return b.default.formatMessage(M.privateDestinationName);case"moveToTeam":return R(n.teamStore);case"moveToOtherWorkspace":return(0,k.rn)(t,n.spaceStore);case"moveToBookmarks":case"moveToShared":return;default:(0,u.t1)(n)}}({environment:t,moveToLocation:o});return a?t.device.isPhone?b.default.formatMessage(M.movedToDestinationShortToast,{destinationName:a}):b.default.formatMessage(M.movedMessagesWithDestinationToast,{pageDescriptor:r,destinationName:a}):b.default.formatMessage(M.movedMessagesToast,{pageDescriptor:r})}function R(e){var t;const n=b.default.getIntl();if(e)return null===(t=e.getModel())||void 0===t?void 0:t.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:i.x7,intl:n})}function D(e,t){const{currentSpaceStore:n}=f.default.getState(),o=("space"===e.type?e.id:e.spaceId)??(null==n?void 0:n.id);if(void 0===n||void 0===o)return;const i=function(e){var t;const{currentUserRootStore:n,currentSpaceStore:o}=f.default.state;return(null==o?void 0:o.id)===e?o:null==n||null===(t=n.getSpaceViewStores())||void 0===t||null===(t=t.find((t=>{var n;return(null===(n=t.getSpaceStore())||void 0===n?void 0:n.id)===e})))||void 0===t?void 0:t.getSpaceStore()}(o);if(i){if(i.id!==n.id)return{type:"moveToOtherWorkspace",spaceStore:i,targetParentId:"space-private-pages"!==e.type?e.id:i.id};switch(e.type){case"page":{const t=f.default.state.mainEditorCurrentBlockStore;if(!t)return;return{type:"moveToBlock",blockStore:h.G.createChildStore(t,{table:a.iU,id:e.id})}}case"collection":return{type:"moveToCollection",collectionStore:h.NW.createChildStore(i,{table:s.vF,id:e.id})};case"space":return{type:"moveToCurrentWorkspace"};case"space-private-pages":return{type:"moveToPrivatePages"};case"team":return{type:"moveToTeam",teamStore:h.zX.createChildStore(i,{table:c.e0,id:e.id})};default:(0,u.t1)(e)}}}function E(e){const{droppedDirection:t,targetStore:n,outlinerSectionType:o}=e,{currentSpaceStore:i}=f.default.getState();if(!i||!o)return;let a=n;if("block"===(null==n?void 0:n.table)&&t!==g.vh.Onto){if("bookmarks"===o)return{type:"moveToBookmarks"};if("shared"===o)return{type:"moveToShared"};a=null==n?void 0:n.getParentStore()}if(void 0===a)return;if(i.id===a.id)return function(e){switch(e){case"workspace":return{type:"moveToCurrentWorkspace"};case"bookmarks":return{type:"moveToBookmarks"};case"private":return{type:"moveToPrivatePages"};case"shared":return{type:"moveToShared"};case"team":case r.kg:case r.PT:case r.cz:case r.mu:case r.g$:return;default:(0,u.t1)(e)}}(o);switch(a.table){case"block":return{type:"moveToBlock",blockStore:a};case"team":return{type:"moveToTeam",teamStore:a}}}function B(e){let{environment:t,blocks:n}=e;if(v.n.state)return{canMoveBlocks:!1,reason:{key:"unknown"}};for(const o of n){if(o.getParentTable()===c.e0){const e=(0,_.VP)(o);if(!e||!(0,y.si)({teamStore:e,environment:t}))return{canMoveBlocks:!1,reason:{key:"lockedTopLevelTeamPage"}}}if(!o.canAdmin())return{canMoveBlocks:!1,reason:{key:"needsFullAccess"}};if(!S.KE({environment:t,block:o})){const e=o.getParentStore();return{canMoveBlocks:!1,reason:{key:"needsEditAccessOnParent",parentStore:e instanceof h.G?e:void 0}}}}return{canMoveBlocks:!0}}function F(e){let{environment:t,blocks:n}=e;return B({environment:t,blocks:n}).canMoveBlocks}function O(e){const{type:t}=e,{mainEditorCurrentBlockStore:n,currentSpaceStore:o}=f.default.state;if(!o)throw new Error("currentSpaceStore not found");const i=n||o;if("space"!==t&&e.spaceId&&e.spaceId!==o.id)return h.H2.createChildStore(i,{table:l.bx,id:e.spaceId});switch(t){case"space-private-pages":return h.H2.createChildStore(i,{table:l.bx,id:o.id});case"space":return h.H2.createChildStore(i,{table:l.bx,id:e.id});case"page":return h.G.createChildStore(i,{table:a.iU,id:e.id});case"collection":return h.NW.createChildStore(i,{table:s.vF,id:e.id});case"team":return h.zX.createChildStore(o,{table:c.e0,id:e.id,spaceId:o.id});default:(0,u.t1)(t)}}async function Z(){return await p.confirmUserAction({message:(0,x.jsx)("b",{children:(0,x.jsx)(d.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmTitle",defaultMessage:"Some content and settings may be broken on the duplicated page."})}),description:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{style:{marginBottom:8},children:(0,x.jsx)(d.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmDescription1",defaultMessage:"This may include: links, relations, permissions, page history, and more."})}),(0,x.jsx)(d.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmDescription2",defaultMessage:"This page will remain unchanged in the current workspace, and a duplicate version will be created in the workspace you have chosen."}),(0,x.jsx)(m.Z,{title:(0,x.jsx)("div",{children:(0,x.jsx)(d.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmHelpLink",defaultMessage:"Learn more"})}),href:(0,w.UY)("guides.duplicateToSpace"),analyticsFrom:"move_to_confirm_duplicate_to_space",style:{marginTop:12}})]}),acceptLabel:(0,x.jsx)(d.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmAcceptLabel",defaultMessage:"I understand, duplicate"})})}function V(e){let{targets:t,destination:n,direction:i,draggingOutlinerType:r}=e;if(i===g.vh.Onto&&t.some((e=>e.id===n.id)))return!0;const a=void 0!==(0,_._A)(n);return!(!t.some((e=>(0,I.A)(e)))||!a)||!("bookmarks"===r||!function(e){let{targets:t,destination:n,direction:i}=e;const r=t.some((e=>e.isCollectionView()||!e.isType(o.Zi)));if(!r)return!1;if(n.isCollectionView()&&!(0,I.A)(n)){if(i===g.vh.Onto)return!0;if(!n.getRecordStoreUIParent())return!0}const a=n.getAssociatedCollectionStore();if(i!==g.vh.Onto&&a&&!a.isPageTreeCollection())return!0;return!1}({targets:t,destination:n,direction:i}))}async function U(e){const t=function(e){const{from:t,environment:n}=e;if("moveTo"===t){const{moveToValue:t}=e.moveToArgs;return D(t)}if("dragAndDrop"===t){const{destination:t,direction:o,destinationOutlinerType:i}=e.dropArgs;return E({targetStore:t,droppedDirection:o,outlinerSectionType:i,environment:n})}}(e),n=await async function(e){const{blocks:t,environment:n,moveToLocation:o,from:i}=e;if(!o||"moveToOtherWorkspace"===o.type||"moveToBookmarks"===o.type)return{confirmed:!0,shouldClearPagePermissions:!1};const r="moveToPrivatePages"===o.type,a="moveTo"===i?e.moveToArgs.destination:e.dropArgs.destination,s=a&&L({stores:[a],environment:n});if(!r&&!s)return{confirmed:!0,shouldClearPagePermissions:!1};if(!L({stores:t,environment:n})){return await T()?{confirmed:!0,shouldClearPagePermissions:!0}:{confirmed:!1}}if(!r)return{confirmed:!0,shouldClearPagePermissions:!1};const l=n.currentUser.id;if(t.some((e=>{const t=e.getPermissionItems();return 0!==t.length&&(1!==t.length||"user_permission"!==t[0].type||t[0].user_id!==l)}))){return await T()?{confirmed:!0,shouldClearPagePermissions:!0}:{confirmed:!1}}return{confirmed:!0,shouldClearPagePermissions:!1}}({...e,moveToLocation:t});if(!n.confirmed)return{confirmed:!1};const{shouldClearPagePermissions:o}=n;return{confirmed:!0,shouldClearPagePermissions:o}}function L(e){const{stores:t,environment:n}=e,{currentSpaceStore:o}=f.default.state;if(!o)return!1;for(const i of t){const e=(0,_.u3)(i);if(!((null==e?void 0:e.table)===a.iU&&e.isTopLevelPrivatePage({spaceStore:o,environment:n})))return!1}return!0}},44499:(e,t,n)=>{n.d(t,{Hn:()=>f,XQ:()=>p,Xk:()=>u,qB:()=>m});n(57658);var o=n(92996),i=n(41432),r=n(21202),a=n(6287),s=n(55367),l=n(42330),c=n(6258),d=n(75770);function u(e,t){return!(!e.isNavigableBlock()&&e.getType()!==i.Ti.alias)&&(!e.isLinkedCollectionView()&&(!e.getMovedStore().getValue()&&!(0,d.ru)({targets:t,destination:e,direction:s.vh.Onto})))}function p(e){let{recentPageResults:t,blockResults:n,suggestedPages:o}=e;const i=new Set;for(const r of o){const e=r instanceof c.NW?r.getParentId():r.id;e&&i.add(e)}return[...t.filter((e=>!i.has(e.blockId))),...n.filter((e=>!i.has(e.blockId)))]}function m(e){const t=[];for(const o of e){const e=o.getParentPointer();if(e)if(e.table===r.iU)t.push(e.id);else if(e.table===a.vF){var n;const e=null===(n=o.getAssociatedCollectionStore())||void 0===n?void 0:n.getParentPointer();e&&e.table===r.iU&&t.push(e.id)}}return t}function f(){const e=l.ZP.getTargetsDatabaseType();return l.ZP.getVariant()===o.ii&&e&&e!==o.GZ}},68056:(e,t,n)=>{n.d(t,{NV:()=>u,QY:()=>m,TD:()=>f,_v:()=>a,e6:()=>p,iG:()=>c,k_:()=>s,ko:()=>d,qS:()=>l,yt:()=>h});var o=n(1898),i=n(89086);function r(e,t){return e.store===t.store&&e.index===t.index}function a(e,t){return!e&&!t||!(!e||!t)&&(r(e.start,t.start)&&r(e.end,t.end))}function s(e){return{start:{...e.start},end:{...e.end}}}function l(e){return!e||e.start.store===e.end.store}function c(e){return l(e)&&e.start.index===e.end.index}function d(e){return 0===e.start.index&&c(e)}function u(e){return c(e)&&(0,i.J_)(e.start.store,{startIndex:e.start.index,endIndex:e.end.index})}function p(e,t){const n=[e.start.store,e.end.store];return n.includes(t.start.store)||n.includes(t.end.store)}function m(e){if(e)return l(e)?{store:e.start.store,selection:{startIndex:e.start.index,endIndex:e.end.index}}:void 0}function f(e){const{store:t,selection:n}=e;if(t&&n)return{start:{store:t,index:n.startIndex},end:{store:t,index:n.endIndex}}}const g=(0,o.AO)((e=>e&&"object"==typeof e&&"store"in e&&"index"in e?{true:e}:{false:e})),h=(0,o.AO)((e=>{if("object"==typeof e&&e&&"start"in e&&"end"in e){const{start:t,end:n}=e;if(g(t)&&g(n))return{true:e}}return{false:e}}))},45162:(e,t,n)=>{n.d(t,{$r:()=>O,Aw:()=>V,L5:()=>C,Nj:()=>D,W9:()=>A,Zb:()=>T,fx:()=>B,r:()=>I,ri:()=>U,tp:()=>R,uZ:()=>Z,xI:()=>w});n(21703);var o=n(55010),i=n(45060),r=n(41432),a=n(92595),s=n(68626),l=n(73597),c=n(70842),d=n(28685),u=n(5162),p=n(26842),m=n(14976),f=n(46150),g=n(68056),h=n(69645),v=n(73959),b=n(89224),y=n(89086);const _=!1;function S(){if(_){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.warn("multiTextSelectionHelpers:",...t)}}function w(e,t){const n=(0,g.QY)(t);return n||s.rateLimitedLog({from:"multiTextSelectionHelpers",type:"TODO",level:"warning",data:{name:e,message:e}}),n}const k={startIndex:0,endIndex:1/0};function I(e,t){const{start:n,end:i}=e;if((0,g.qS)(e))return n.store===t?"contained-within":void 0;if(n.store===t)return"starts-at";if(i.store===t)return"ends-at";const r=d.E.findNodeFromStore(n.store),a=d.E.findNodeFromStore(i.store),s=d.E.findNodeFromStore(t);return r&&a&&s&&1===(0,o.Z)(s,r)&&-1===(0,o.Z)(s,a)?"covers":void 0}function C(e){const{start:t,end:n}=e,o=(0,g.QY)(e);if(o){const e=d.E.findEditableWithStore(o.store);if(e){return[{editable:e,...o}]}return[]}const i=x(t),r=x(n);if(!i||!r){const e=i||r;if(!e)return[];return[{editable:e.editable,store:e.position.store,selection:{startIndex:e.position.index,endIndex:e.position.index}}]}const a=(0,y.yR)(i.editable).filter((e=>{var t,n,o;return(null===(t=e.contentEditableContext)||void 0===t?void 0:t.id)===(null===(n=i.editable.contentEditableContext)||void 0===n?void 0:n.id)&&(null===(o=e.getNode())||void 0===o?void 0:o.isConnected)})),s=a.findIndex((e=>e.props.store.id===i.editable.props.store.id)),l=a.findIndex((e=>e.props.store.id===r.editable.props.store.id));if(-1===s){throw Object.assign(new Error("Start editable not found in DOM order array"),i)}if(-1===l){throw Object.assign(new Error("End editable not found in DOM order array"),r)}if(!(s<=l))throw new Error(`Start (index ${s}) must be before end (index ${l}) in DOM`);const c=a.slice(s,l+1);return c.map(((e,t)=>{if(0===t){const{position:t}=i;return{editable:e,store:e.props.store,selection:{startIndex:t.index,endIndex:1/0}}}if(t===c.length-1){const{position:t}=r;return{editable:e,store:e.props.store,selection:{startIndex:0,endIndex:t.index}}}return{editable:e,store:e.props.store,selection:k}}))}function x(e){const t=d.E.findEditableWithStore(e.store);if(t)return{editable:t,position:e}}function T(e){var t;const{range:n,contentEditableLeafRegistry:o,allowInvisibleEndSelection:i,constraintToContentEditableRootNode:r,avoidEdgesOfContentEditableRoot:a}=e;if(!n)return;if(r&&r!==(0,f.xp)(n.commonAncestorContainer))return;if(a&&(0,f.Hd)(n.commonAncestorContainer))return void S("not snapping - range is at edge of content editable root");let s,l=!1,c=o.getParentContentEditableLeaf(n.startContainer);c||(s??=o.getByDOMOrder(),c=(0,b.snapContainerOffsetToNode)({nodesInDomOrder:s,containerOffset:{container:n.startContainer,offset:n.startOffset},snapTowards:"end"}),l=!0,S("snapped start",n.startContainer,n.startOffset,"to",c));let d=o.getParentContentEditableLeaf(n.endContainer);if(!d||!i&&d&&0===n.endOffset&&n.endContainer===d.node&&d.node!==(null===(t=c)||void 0===t?void 0:t.node)){s??=o.getByDOMOrder();const e=s.findIndex((e=>{var t;let{node:n}=e;return n===(null===(t=c)||void 0===t?void 0:t.node)})),t=-1!==e?s.slice(e):s,r=d&&!i?t.filter((e=>{var t;let{node:n}=e;return n!==(null===(t=d)||void 0===t?void 0:t.node)})):t;d=(0,b.snapContainerOffsetToNode)({nodesInDomOrder:r,containerOffset:{container:n.endContainer,offset:n.endOffset},snapTowards:"start"}),l=!0,S("snapped end",n.endContainer,n.endOffset,"inside",t,"to",d)}if(!c||!d){const e=c??d;if(!e)return;return{start:e,end:e,forceEmit:!0}}return{start:c,end:d,forceEmit:l}}function M(e){const t=e.getTitleStore();if(t){if(d.E.findNodeFromStore(t))return t}}function P(e){for(const t of e){const e=M(t);if(e&&t.getType()!==r.Ti.code)return{blockStore:t,titleStore:e}}}function A(e){const t=P(e);if(!t)return;const n=function(e){return P([...e].reverse())}(e);if(!n)return;const o=(0,h.dq)({includeNonSelectableListContainer:!1,root:t.blockStore.getHighestContentBlockUIAncestor()});if(!o)return;const i=(0,h.Ib)(n.blockStore,o);if(!i)return;let r;for(const a of(0,l.JK)(i)){const e=a.value.store.getTitleStore();if(e){const t=(0,y.x0)(e);t&&(r={store:e,index:t.endIndex})}}if(!r)return;return{start:{store:t.titleStore,index:0},end:r}}function R(e){var t;const{multiSelection:n,filterCommonAncestors:o,focus:i}=e;if((0,g.qS)(n)){var a;let e=(0,v.sQ)(n.start.store);if((null===(a=e)||void 0===a?void 0:a.getType())===r.Ti.tableRow){var s;const t=null===(s=e.getRecordStoreUIParent())||void 0===s?void 0:s.recordStoreUIParentStore;t&&t instanceof p.G&&(e=t)}if(!e)return;return{stores:[e]}}const c=D({multiSelection:n,includeNonSelectable:!1});if(!c)return;const d=o?(0,l.tL)(c.treeRange):(0,l.bu)(c.treeRange),u=Array.from(d),m=u[0],f=null==m||null===(t=m.value.component)||void 0===t||null===(t=t.contentEditableContext)||void 0===t?void 0:t.id,h=u.filter((e=>{var t;return(null===(t=e.value.component)||void 0===t||null===(t=t.contentEditableContext)||void 0===t?void 0:t.id)===f||e.value.store.getType()===r.Ti.table})).map((e=>e.value.store));return{stores:h,pivot:"end"===i||i===n.end||void 0===i&&!(0,b.selectionIsBackwards)()?h[h.length-1]:h[0]}}function D(e){const{multiSelection:t,includeNonSelectable:n}=e,o=(0,v.sQ)(t.start.store),i=(0,v.sQ)(t.end.store);if(!o||!i)return;const r=o.getHighestContentBlockUIAncestor(),a=(0,h.dq)({includeNonSelectableListContainer:n,root:r});if(!a)return;const s=(0,h.v5)(o,[a]),l=(0,h.v5)(i,[a]);if(!s||!l)return;const d=c.T.fromNearestCommonAncestor(s,l);return d?{tree:a,treeRange:d}:void 0}function E(e){const{leafNode:t,rangeContainer:n,defaultEndIndex:i}=e;S("Range outside of leaf, attempting to recover",t,n);const r=(0,o.Z)(t,n);let a=0;if(-1===r)a=i;else{if(1!==r)throw new Error("Invalid relativeStartPosition. index should not be inside leaf");a=0}return{index:a,forceEmit:!0,afterEndOfLine:!1}}function B(e){var t,n,o,i;const{range:r,contentEditableLeafRegistry:a,allowInvisibleEndSelection:s,avoidEdgesOfContentEditableRoot:l}=e;if(!r)return;let c,u,p=!1;if(a&&a.hasMembers()){const e=T({range:r,contentEditableLeafRegistry:a,allowInvisibleEndSelection:s,constraintToContentEditableRootNode:void 0,avoidEdgesOfContentEditableRoot:l});e&&(c=e.start.node,u=e.end.node,p||=e.forceEmit),S("getMultiTextSelectionFromRange: snapped to leafs",e,r)}else c=(0,f.X1)(r.startContainer),u=(0,f.X1)(r.endContainer),S("getMultiTextSelectionFromRange: found parent leafs",c,u,r);const g=c?d.E.find((e=>{var t;return(null===(t=e.getContentEditableLeaf())||void 0===t?void 0:t.getNode())===c})):void 0,h=u?d.E.find((e=>{var t;return(null===(t=e.getContentEditableLeaf())||void 0===t?void 0:t.getNode())===u})):void 0;if(!g||!h)return void S("getMultiTextSelectionFromRange: missing editable",{startMissing:!g,endMissing:!h});const v=!r.collapsed,b=g.props.store;let _=h.props.store;const{startContainer:w,endContainer:k}=r,I=(null===(t=(n=h.props).getEndSelection)||void 0===t?void 0:t.call(n).endIndex)??0,C=(null===(o=c)||void 0===o?void 0:o.contains(r.startContainer))&&(0,m.Qb)(r.startContainer,r.startOffset)||E({leafNode:c,rangeContainer:w,defaultEndIndex:I});let x=(null===(i=u)||void 0===i?void 0:i.contains(r.endContainer))&&(0,m.Qb)(r.endContainer,r.endOffset)||E({leafNode:u,rangeContainer:k,defaultEndIndex:I});if(v&&x.afterEndOfLine){const e=(0,y.hn)(_);e&&(S("end after EOL",r.endContainer,r.endOffset),_=e,x={index:0,forceEmit:!0,afterEndOfLine:!1})}return{multiSelection:{start:{store:b,index:C.index},end:{store:_,index:x.index}},forceEmit:p||C.forceEmit||x.forceEmit}}function F(e,t){if(!e&&!t)return 0;if(!t)return-1;if(!e)return 1;if(e.store===t.store)return e.index-t.index;const n=d.E.findNodeFromStore(e.store),i=d.E.findNodeFromStore(t.store);return(0,o.Z)(n,i)}function O(e,t){const[n,o]=[e,t].sort(F);return{start:n,end:o}}function Z(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,b.selectionIsBackwards)())?{focus:e.start,anchor:e.end}:{focus:e.end,anchor:e.start}}function V(e){return e.device.isAndroid?(0,u.Y)("supportsAlwaysMultiTextSelectionBehavior")?"always":"gesture":e.device.isIOS||e.device.isElectron||e.device.isSafari||e.device.isChrome?"always":void 0}function U(e){return e.isChrome&&96===parseInt(e.browserVersion,10)}(0,a.exposeDebugValue)("multiTextSelectionToBlockSelection",R),(0,i.Rw)({canFormat:e=>(0,g.yt)(e),header(e){const{table:t,tr:n,td:o,object:r,CONTAINER_STYLE:a}=i.TI,s=d.E.findNodeFromStore(e.start.store),l=d.E.findNodeFromStore(e.end.store);return t(a,n({},o({},"start:"),o({},r(e.start.index)," in"),o({},r(e.start.store)),o({},r(s))),n({},o({},"end:"),o({},r(e.end.index)," in"),o({},r(e.end.store)),o({},r(l))))},hasBody:e=>!1,body:e=>null})},99445:(e,t,n)=>{n.d(t,{A8:()=>f,UF:()=>l,bW:()=>s,yk:()=>r,yt:()=>i});n(57658);var o=n(15095);function i(e){if(0===e)return"a";let t=0,n=0,o="";for(;e>0;)t=(e-1)/26,n=(e-1)%26,e=Math.floor(t),o=String.fromCharCode(97+n)+o;return o}function r(e){let t=0,n=0;const o=e.split("").reverse();for(const i of o){t+=(i.charCodeAt(0)-96)*26**n,n+=1}return t}const a={"mÌ„":1e6,"dÌ„":5e5,"cÌ„":1e5,"lÌ„":5e4,"xÌ„":1e4,"vÌ„":5e3,m:1e3,cm:900,d:500,cd:400,c:100,xc:90,l:50,xl:40,x:10,ix:9,v:5,iv:4,i:1};function s(e){let t="";if(0===e)return"0";for(const n in a){const o=Math.floor(e/a[n]);if(o>=0)for(let e=0;e<o;e++)t+=n;e%=a[n]}return t}function l(e){const t=o.p4(e);let n,i,r,s,l=0;for(let o=0;o<t.length;o++){if(n=t[o],i=n?a[n]:void 0,r=t[o+1],s=r?a[r]:void 0,!i)return-1;s&&i<s?l-=i:l+=i}return l}const c=4.44,d={i:3.64,v:8.36,x:8.08,l:3.73,c:8.64,d:9.52,m:13.61,"mÌ„":13.61,"dÌ„":9.52,"cÌ„":8.64,"lÌ„":3.73,"xÌ„":8.08,"vÌ„":8.36};function u(e){const t=o.p4(e);let n=0;for(const o of t)n+=d[o];return n+c}const p=[24],m=14;function f(e){const t=l(e);if(t<=p.length)return p[t-1];let n=p[p.length-1];for(let o=p.length+1;o<=t;o++){const e=u(s(o));e>n&&(n=e+m),p.push(n)}return n}},45950:(e,t,n)=>{n.d(t,{Dx:()=>p,Ye:()=>u,ne:()=>m,yY:()=>d});n(21703),n(57658);var o=n(59753),i=n(45953),r=n(33361),a=n(21202),s=n(53965),l=n(18245),c=n(77080);async function d(e){const{environment:t,recordPointers:n,recurFn:a,recordIsRequired:s}=e,l=i.PF.create();return await r.uf({recordPointers:n,recordMap:l,recurFn:(e,t)=>a(e,t),loadRecordModel:async e=>{const n=t.defaultRecordCache.inMemoryRecordCache.getModelAndRole({pointer:e,userId:t.currentUser.id});if(n)return n;const i=t.defaultRecordCache.persistedRecordCache;if(i){const n=await i.get(e,t.currentUser.id);if(n)return{model:o.kk.fromValue(e.table,n.value),role:n.role}}if(s(e))throw new Error(`Failed to load a required record: ${e.table}, ${e.id}, ${e.spaceId}.`)}}),l}async function u(e){const{environment:t}=e,n=e.environment.currentUser.id;if(e.inMemoryRecordCache)return e.inMemoryRecordCache.getModelAndRole({pointer:e.pointer,userId:n});let i=t.defaultRecordCache.inMemoryRecordCache.getModelAndRole({pointer:e.pointer,userId:n});if(void 0!==i)return i;if(e.useInMemoryCacheOnly)return;if(e.prefetchPromise&&"pending"===e.prefetchPromise.state.status&&(await e.prefetchPromise.wrappedPromise,i=t.defaultRecordCache.inMemoryRecordCache.getModelAndRole({pointer:e.pointer,userId:n}),void 0!==i))return i;const{persistedRecordCache:r}=e.environment.defaultRecordCache;if(r){e.isRacingWithAnotherRequest&&await r.waitForInitialize();const t=await r.get(e.pointer,n);if(t)return{model:o.kk.fromValue(e.pointer.table,t.value),role:t.role}}}async function p(e){const{parent:t,inMemoryRecordCache:n,environment:i}=e,r=[],s=e.environment.currentUser.id,l=e.environment.defaultRecordCache.persistedRecordCache;if(l&&n===i.defaultRecordCache.inMemoryRecordCache){return(await l.getBlocksWithParent({parent:t,userId:s})).map((e=>({model:o.kk.fromValue(a.iU,e.value),role:e.role})))}return n.forEachRecord(s,(e=>{let{model:n,role:o}=e;n.table===a.iU&&n.parent_table===t.table&&n.parent_id===t.id&&r.push({model:n,role:o})})),r}async function m(e){const{environment:t,inMemoryRecordCache:n}=e,i=o.kk.fromCollection(e.collection);if(!i)return[];const r=i.pointer;if(!i.isPageTreeCollection()){const e=l.default.mark("collections.get_local_pages_in_collection"),o=p({environment:t,parent:r,inMemoryRecordCache:n});return l.default.measure(e,{environment:t}),o}const u=i.getRootPagePointer(),m=c.default.checkGate("wiki_perf_improvement_local_enabled"),f=l.default.mark("collections.get_local_pages_in_collection_wiki"),g=m?await async function(e){const{rootPagePointer:t,environment:n}=e,o=[],i=(e,n)=>e.table!==a.iU?[]:(e.pointer.id===t.id||"page"!==e.type&&"collection_view_page"!==e.type||o.push({model:e,role:n}),e.getContentIds().map((t=>({table:a.iU,id:t,spaceId:e.spaceId}))));return await d({environment:n,recordPointers:[t],recurFn:i,recordIsRequired:()=>!1}),o}({environment:t,rootPagePointer:u}):await async function(e){const{rootPagePointer:t,environment:n,inMemoryRecordCache:o}=e;let i=[t];const r=[];for(;i.length>0;){const e=i.map((e=>p({environment:n,parent:e,inMemoryRecordCache:o}))),t=(await Promise.all(e)).flat();for(const n of t){var a;const e=null==n||null===(a=n.model)||void 0===a?void 0:a.type;"page"!==e&&"collection_view_page"!==e||r.push(n)}i=s.oA(t.map((e=>{var t;return null===(t=e.model)||void 0===t?void 0:t.pointer})))}return r}({environment:t,rootPagePointer:u,inMemoryRecordCache:n});return l.default.measure(f,{environment:t,data:{status:m?"v2":"v1"}}),g}},35026:(e,t,n)=>{n.d(t,{BY:()=>Z,EE:()=>R,N:()=>E,P4:()=>D,Pl:()=>P,Ps:()=>F,Q2:()=>x,Yz:()=>B,_v:()=>U,jz:()=>V,l6:()=>I,si:()=>A,vs:()=>C});n(57658),n(30541);var o=n(15145),i=n(41432),r=n(53877),a=n(42875),s=n(15157),l=n(69246),c=n(21202),d=n(70279),u=n(29369),p=n(70203),m=n(9291),f=n(53965),g=n(1898),h=n(69254),v=n(6258),b=n(13105),y=n(4708),_=n(33929),S=n(75770);const w=new Set([i.Ti.page,i.Ti.collectionView,i.Ti.collectionViewPage,i.Ti.alias]),k=new Set([i.Ti.factory]);function I(e){const{allPages:t,state:n,intl:o}=e,{query:i}=n;return t.map((e=>{if(!e.isDefined())return;const t=e.getLastEditedTime()||e.getCreatedTime();if(!t)return;const n=e.getLastEditedByPointer()??e.getCreatedByPointer();return(0,l.fY)({block:e.getModel(),query:i,getRecordModel:e.getRecordModel,userTimeZone:(0,a.r)(),intl:o})?{blockId:e.id,timestamp:t,authorPointer:n}:void 0})).filter(g.$K)}function C(e){const{pageItems:t}=e;return f.MR(t,(e=>{let{timestamp:t}=e;return t})).reverse()}function x(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w;const o=[],i=new Set,r=[e];for(;r.length>0;){const a=r.shift();if(i.has(a.id))continue;i.add(a.id);const s=M(a,e,t,n);o.push(...s.outlinerItems),r.unshift(...s.subtree)}return o}const T=new b.P({debugName:"getOutlinerItemsStoresInSubtreePageMentions",memoizeRecursion:!1,deepEquals:!1,compute(e){var t;const n=null===(t=e.getTitleStore())||void 0===t?void 0:t.getValue(),o=p.cCA(n);return e.getRecordStoreArray(e,o).filter((t=>t.getParentId()===e.id)).concat(e.getContentStores())}});function M(e,t,n,o){var r;const a=e.getType();if(a&&n.has(a)||(null===(r=e.getModel())||void 0===r||null===(r=r.getAliasTargetPointer())||void 0===r?void 0:r.table)===d.x_)return{outlinerItems:[],subtree:[]};if(a&&e!==t&&o.has(a))return{outlinerItems:[e],subtree:[]};const s=e.getType()===i.Ti.transclusionReference?e.getTransclusionReferenceTargetStore():e;if(!s)return{outlinerItems:[],subtree:[]};return{outlinerItems:[],subtree:T.getStateFor(s)}}function P(e){let{environment:t,draggingStores:n,parentStore:o,currentSpaceStore:i}=e;if(!t.currentUser.id)return!1;if(!n.every((e=>e.isNavigableBlock())))return!1;if(!(0,S.lQ)({environment:t,blocks:n}))return!1;if((null==o?void 0:o.table)===u.e0){return A({environment:t,teamStore:v.zX.createChildStore(i,{table:u.e0,id:o.id,spaceId:i.id})})}return!0}function A(e){let{environment:t,teamStore:n}=e;const o=t.currentUser.id;if(!n.isDefined())return!1;return!(n.getDisableTeamPageEdits()&&o&&!n.isOwner(o))&&n.canAddOrRemoveTopLevelPages()}function R(e){let{typeWithTeam:t,sidebarState:n,currentSpaceViewStore:o,environment:i}=e;switch(t.type){case"team":return t.teamStore.getTeamPagesStores();case"bookmarks":return o.getBookmarkedPages();case"workspace":return o.getWorkspacePages();case"shared":return n.visibleSharedPagesStores;case"private":return n.visiblePrivatePagesStores;default:(0,g.t1)(t)}}function D(e){let{typeWithTeam:t,currentSpaceStore:n,currentSpaceViewStore:o}=e;switch(t.type){case"team":return t.teamStore.getTeamPagesStore();case"bookmarks":return o.getBookmarkedPagesStore();case"workspace":return n.getPagesStore();case"shared":return o.getSharedPagesStore();case"private":return o.getPrivatePagesStore();default:(0,g.t1)(t)}}function E(e){switch(e){case"bookmarks":return o.tY.SidebarBookmark;case"workspace":return o.tY.SidebarWorkspace;case"shared":return o.tY.SidebarShared;case"private":return o.tY.SidebarPrivate;case"team":return o.tY.SidebarTeam;case"teamSidebar":case"teamBrowserSearch":case"teamBrowserUnjoinedTeams":case"teamBrowserJoinedTeams":return o.tY.SidebarTeamBrowser;case l.g$:return o.tY.SidebarPublicPageTemplateIncludes;default:(0,g.t1)(e)}}function B(e){return x(v.G.createChildStore(e,{table:c.iU,id:e.id}),k,w)}function F(e){const{store:t,toOpen:n,environment:o,isTopLevelItem:i}=e;i&&s.Z.set({userId:o.currentUser.id,key:`Outliner-${t.id}`,value:n})}const O=(0,m.defineMessages)({updatedToday:{id:"sharedWithMePopover.updatedTodaySection.label",defaultMessage:"Updated today"},today:{id:"sharedWithMePopover.todaySection.label",defaultMessage:"Today"},updatedPastWeek:{id:"sharedWithMePopover.updatedPastWeekSection.label",defaultMessage:"Updated in the past week"},pastWeek:{id:"sharedWithMePopover.pastWeekSection.label",defaultMessage:"Past week"},updatedEarlier:{id:"sharedWithMePopover.updatedEarlierSection.label",defaultMessage:"Updated earlier"},earlier:{id:"sharedWithMePopover.earlierSection.label",defaultMessage:"Earlier"}});function Z(e){const{section:t,isFirst:n}=e;switch(t){case"today":return n?_.default.formatMessage(O.updatedToday):_.default.formatMessage(O.today);case"past-week":return n?_.default.formatMessage(O.updatedPastWeek):_.default.formatMessage(O.pastWeek);case"earlier":return n?_.default.formatMessage(O.updatedEarlier):_.default.formatMessage(O.earlier);default:throw(0,g.t1)(t)}}function V(e){const t="today",n="past-week",o="earlier",i=(0,r.Uu)((0,a.r)()),s=i.valueOf(),l=i.minus({week:1}).valueOf(),c=f.vM(e,(e=>{let{timestamp:i}=e;return i>s?t:i>l?n:o}));let d=-1;return f.oA([t,n,o].map((e=>{const t=c[e];if(t&&0!==t.length)return{key:e,pages:t.map((e=>(d+=1,{...e,index:d})))}})))}function U(e){const t=h.Z.getSortOption("private");switch(t){case"manual":return!1;case"lastEdited":return(0,y.VI)(e);default:(0,g.t1)(t)}}},50627:(e,t,n)=>{n.d(t,{CX:()=>p,OZ:()=>h,RH:()=>v,a_:()=>u,du:()=>f,kC:()=>m,mO:()=>g,y6:()=>d,zL:()=>c});var o=n(41432),i=n(6695),r=n(77546),a=n(82136),s=n(88923),l=n(28020);const c=900;function d(e){const t=e.getAssociatedCollectionStore();if(!t)return;const n=e.getSchema(),o=t.getFormat();return i.iB(o,n,void 0,i.j5.Collection)}function u(e){if(e.isCollectionView()){const t=e.getCollectionViewSourceCollectionStore();return!!t&&t.isSyncedCollection()}return e.isType(o.Ti.externalObjectInstancePage)}function p(e){return!e.hasContent()&&(!e.isCollectionView()||e.isType("collection_view_page")&&e.isCollectionViewPageWithContent())}function m(e,t){const n={width:"100%",display:"flex",flexDirection:"column",alignItems:"center",flexShrink:0,flexGrow:0};return e.isCollectionView()&&(e.isNonEditableState()&&(n.cursor="default"),r.eA(t)&&(n.position="sticky",n.left=0)),n}function f(e,t,n){return g(e,t,n)?"100%":c}function g(e,t,n){if(t===a.S.CollectionPageView)return!0;const{device:o}=n,{isPhone:i}=o,r=e.isFullWidth(),s=e.isCollectionView(),l=h(t);return r&&!i||s||l||i}function h(e){return e===a.S.PeekView}function v(e,t){if(e===a.S.PeekView){const e=s.default.getPeekMode();return s.PeekModePadding.horizontal[e]}return(0,l.ui)(t)}},78873:(e,t,n)=>{n.d(t,{E:()=>s,c:()=>l});var o=n(54642),i=n(97799),r=n(69503),a=n(92083);function s(e){const{environment:t,onSubmit:n,onCancel:o}=e;t.device.isMobile?i.Z.setState({open:!0}):a.Z.setState({open:!0,openedFrom:"login",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0}),r.Z.setState({open:!0,setNewPassword:!0,password:"",repeatPassword:"",isSet:!1,onSubmit:n,onCancel:o})}async function l(e){const{environment:t,userEmail:n}=e,i=await o.getLoginOptions(t,{email:n});if("failed"===i.type)return{error:i.error};const r=i.data;return{value:{isSamlEnforced:"required"===r.samlSignIn,didLogInWithSaml:"available"===r.samlSignIn&&r.hasAccount&&"saml"===r.lastLoginMethod,hasPassword:"required"!==r.samlSignIn&&r.hasAccount&&r.passwordSignIn}}}},98165:(e,t,n)=>{n.d(t,{D0:()=>H,Dg:()=>O,Eb:()=>R,KU:()=>L,Om:()=>E,Pj:()=>V,RC:()=>G,VP:()=>U,_A:()=>j,e3:()=>q,fJ:()=>A,fl:()=>N,n3:()=>W,oZ:()=>K,qA:()=>P,s:()=>D,u3:()=>Z,uJ:()=>B,wf:()=>F,yI:()=>z});n(57658);var o=n(41432),i=n(63306),r=n(72141),a=n(73360),s=n(74446),l=n(45953),c=n(606),d=n(98963),u=n(18844),p=n(21202),m=n(6287),f=n(70279),g=n(33709),h=n(91644),v=n(75246),b=n(29369),y=n(53965),_=n(1898),S=n(80444),w=n(6258),k=n(13105),I=n(65598);function C(e,t){const{table:n,id:o,spaceId:i}=t,r=i||e.pointer.spaceId;if(n===m.vF)return w.NW.createChildStore(e,{table:m.vF,id:o});if(n===v.bx)return w.H2.createChildStore(e,{table:v.bx,id:o});if(n===p.iU)return w.G.createChildStore(e,{table:p.iU,id:o});if(n===f.x_){if(r)return w.T5.createChildStore(e,{table:f.x_,id:o,spaceId:r})}else if(n===g.qF){if(r)return w.jQ.createChildStore(e,{table:g.qF,id:o,spaceId:r})}else if(n===b.e0){if(r)return w.zX.createChildStore(e,{table:b.e0,id:o,spaceId:r})}else if(n===u.Xj){if(r)return w.zq.createChildStore(e,{table:u.Xj,id:o,spaceId:r})}else if(n===d.cv&&r)return w.Mz.createChildStore(e,{table:d.cv,id:o,spaceId:r})}function x(e){const t=S.default.state.mainEditorCurrentBlockStore;return t?t.inMemoryRecordCache!==e.inMemoryRecordCache?e:t:e}function T(e){const t=x(e);return((n=e)instanceof w.G||n instanceof w.H2||n instanceof w.NW||n instanceof w.T5||n instanceof w.jQ||n instanceof w.zX||n instanceof w.zq||n instanceof w.Mz)&&e.getRecordStoreUIParent()===t?e:C(t,e.pointer);var n}const M=new k.P({debugName:"getPathStores",memoizeRecursion:!0,deepEquals:!1,compute:function(e,t){const n=e.getValue();if(!n||!(0,a.oK)(n))return[e];const o=c.dr.getParentPointerFromRecordWithParent(n),i=C(x(e),o);return i?[e].concat(t(i)):[e]}});function P(e){const t=T(e);return t?M.getStateFor(t):[]}function A(e){return y.oA(P(e).map((e=>{if("space"===e.table){if(!(0,I.Mm)(e))return;return e.getModel()}if("block"===e.table){const{pointer:t}=e,n=(0,w.Vh)(e,t,"alive").getValue(),o=(0,w.Vh)(e,t,"parent_id").getValue(),i=(0,w.Vh)(e,t,"type").getValue();if(void 0!==n&&void 0!==o&&void 0!==i)return e.getModel()}else if(e.table===b.e0){const{pointer:t}=e;if(!(0,w.Vh)(e,t,"settings").getValue())return;return e.getModel()}})))}function R(e){const{store:t,teamPermissionItems:n}=e,o=l.Ak.create(),i=V(t)||S.default.state.currentSpaceStore;return i&&n.forEach((e=>{const t=w.zX.createChildStore(i,{table:b.e0,id:e.team_id,spaceId:i.id});o.setModel({id:t.id,table:b.e0,spaceId:i.id},t.getModel())})),o}async function D(e){const t=[];return await i.ne(e.pointer,s.zF.fromMonomorphicFunctionUnsafe((async n=>{let o;if(n.table===m.vF?o=w.NW.createChildStore(e,n):n.table===v.bx?o=w.H2.createChildStore(e,n):n.table===p.iU?o=w.G.createChildStore(e,n):n.table===f.x_?o=w.T5.createChildStore(e,n):n.table===g.qF&&(o=w.jQ.createChildStore(e,n)),o)return t.push(o),await o.load(),o.getValue()}))),t}function E(e){const t=w.t1.fromV1(e);if(t instanceof w.G||t instanceof w.NW){const e=t.getParentTable(),n=t.getParentId();if(e&&n){if(e===m.vF)return w.NW.createChildStore(t,{table:m.vF,id:n});if(e===v.bx)return w.H2.createChildStore(t,{table:v.bx,id:n});if(e===p.iU)return w.G.createChildStore(t,{table:p.iU,id:n});if(e===f.x_)return w.T5.createChildStore(t,{table:f.x_,id:n,spaceId:t.getSpaceId()});if(e===b.e0)return w.zX.createChildStore(t,{table:b.e0,id:n});if(e===u.Xj)return w.zq.createChildStore(t,{table:u.Xj,id:n,spaceId:t.getSpaceId()});if(e===h.AT)return w.Vf.createChildStore(t,{table:h.AT,id:n,spaceId:t.getSpaceId()});(0,_.t1)(e)}}}function B(e){return P(e).filter((e=>{if(!e.canRead())return!1;if(e instanceof w.G){const t=e.getType();return t&&(0,o.S9)(t)}return e instanceof w.zX}))}function F(e){const t=P(e).find((e=>{let t;return(e instanceof w.G||e instanceof w.NW)&&(t=e.getAlive()),!1===t}));return Boolean(t)}function O(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=B(e)[t];return n instanceof w.zX?O(n,t+1):n}function Z(e){const t=B(e);return t[t.length-1]}function V(e){return P(e).find((e=>e.table===v.bx))}function U(e){const t=P(e);return t.find((e=>e.table===b.e0))}function L(e){return e.find((e=>e.table===b.e0))}function j(e){return P(e).find((e=>{var t;return e.table===p.iU&&(null===(t=e.getCollectionStore())||void 0===t?void 0:t.isPageTreeCollection())}))}function N(e){for(const t of e)if((t instanceof w.G||t instanceof w.NW)&&(!t.isDefined()||!t.getAlive()))return!1;return!0}function z(e){for(const t of e)if(t instanceof w.G||t instanceof w.NW){if(!t.isDefined())continue;if(!t.getAlive())return!0}return!1}function q(e){for(const t of e)if(t instanceof w.G){if(!t.isDefined())continue;const e=t.getMovedStore().getValue();if(void 0!==e)return{store:t,moved:e}}}function W(e){return"block"===e.table||"space"===e.table||"collection"===e.table||"comment"===e.table||"discussion"===e.table}function H(e){const t=P(e).find((e=>{if(e.table===b.e0)return Boolean(e.getArchivedBy())}));return Boolean(t)}function K(e){const t=P(e);for(const n of t)if(n.table===v.bx)return n.getSettings().space_request}function G(e){const{environment:t,store:n}=e,o=t.currentUser.id;if(!o)return!1;const i=P(n),a=i.every((e=>Boolean(e.isReady())));if(!a)return;const s=!i.some((e=>Boolean(e instanceof w.G&&!e.isDefined())));if(!s)return!1;const l=i.some((e=>{if(e instanceof w.G){const t=(e.getPermissionItemsStore().getValue()||[]).find((e=>(0,r.$D)(e)||(0,r.hV)(e)||(0,r.ix)(e)||(0,r.RI)(e)||(0,r.ZQ)(e)||(0,r.jg)(e)&&e.user_id!==o));return Boolean(t)}return e instanceof w.zX}));return!l}},5749:(e,t,n)=>{n.d(t,{n:()=>i});var o=n(77080);function i(){return"on"===o.default.getEligibleGroup({experimentId:"pdf_importer",defaultGroup:"control"})}},85957:(e,t,n)=>{n.d(t,{PQ:()=>d,Tx:()=>s,mH:()=>l,wq:()=>c});var o=n(24646),i=n(4926),r=n(88923),a=n(27724);function s(){return r.default.isCenterPeekOpen()||a.default.isInPeekRenderer()}function l(){const e=r.default.state;return e.open&&(s()||e.isOpening)}function c(e){return Boolean(e.findRecordStoreUIAncestor((e=>e===r.default.peekTarget.state)).ancestor)}function d(e){const t=i.Z.state;return r.default.isSidePeekOpen()?(0,o.vJ)(e):r.default.isCenterPeekOpen()?Math.min(e.WindowSizeStore.state.width-2*r.PeekModeOuterPadding,r.CenterPeekModeOuterWidth+t):0}},46654:(e,t,n)=>{n.d(t,{S4:()=>q,Z9:()=>Q,KE:()=>te,uY:()=>le,zT:()=>de,Dt:()=>re,WE:()=>se,aG:()=>ue,YO:()=>N,rc:()=>ie,r_:()=>J,BZ:()=>ee,YF:()=>X,Oc:()=>W,JI:()=>K,UK:()=>H,yi:()=>G,mU:()=>oe,U7:()=>ne,IJ:()=>z,Xu:()=>$,SO:()=>Y});n(67635),n(57658);var o=n(66897),i=n(68626),r=n(59753),a=n(63306),s=n(1898),l=n(91627),c=n(54368),d=n(21202),u=n(77420),p=n(75246),m=n(65635),f=n(47969),g=n(29369),h=n(19889);class v{constructor(e){this.agentPointer=void 0,this.logErrorFn=void 0;const{agentPointer:t,logErrorFn:n}=e;this.agentPointer=t,this.logErrorFn=n}getActorPointer(){return this.agentPointer}getSpaceRole(e){return"none"}getTeamRole(e){return"none"}getGroupRole(e){return"none"}}n(21703);function b(e){const{undecoratedGetRecordModel:t,logErrorFn:n,from:o}=e;return r.om.fromMonomorphicFunctionUnsafe((e=>{const i=t(e);return void 0===i&&n({from:o,type:"NecessaryRecordWasNotProvided",error:new Error(`${o} needed the following record: ${e.table}/${e.id}, but it was not provided`),data:e}),i}),t.getRecordValue)}class y{logIfUnexpectedSpace(e){this.relevantEntities.relevantSpaceIds.has(e)||this.logErrorFn({from:"BotActorMembership",type:"NonRelevantSpaceRequested",error:new Error(`Space role was requested for ${e}, which was not a pre-determined "relevant" space id`),data:{spaceId:e}})}constructor(e){this.botPointer=void 0,this.getRecordModel=void 0,this.logErrorFn=void 0,this.memoizedSpaceRoles=void 0,this.relevantEntities=void 0;const{botPointer:t,getRecordModel:n,logErrorFn:o,relevantEntities:i}=e;this.botPointer=t,this.logErrorFn=o,this.getRecordModel=b({undecoratedGetRecordModel:n,logErrorFn:o,from:"BotActorMembership"}),this.memoizedSpaceRoles={},this.relevantEntities=i}getActorPointer(){return this.botPointer}getSpaceRole(e){this.logIfUnexpectedSpace(e);const t=this.memoizedSpaceRoles[e];if(void 0!==t)return t;const n=this.getRecordModel((0,m.HY)({botId:this.botPointer.id,spaceId:e})),o=void 0===n?"none":n.membership_type;return this.memoizedSpaceRoles[e]=o,this.memoizedSpaceRoles[e]}getTeamRole(e){return"none"}getGroupRole(e){return"none"}}var _=n(64684);class S{logIfUnexpectedSpace(e){this.relevantEntities.relevantSpaceIds.has(e)||this.logErrorFn({from:"UserActorMembership",type:"NonRelevantSpaceRequested",error:new Error(`Space role was requested for ${e}, which was not a pre-determined "relevant" space id`),data:{spaceId:e}})}logIfUnexpectedTeam(e){const{teamId:t,spaceId:n}=e;this.relevantEntities.relevantTeamIds.has(t)||this.logErrorFn({from:"UserActorMembership",type:"NonRelevantTeamRequested",error:new Error(`Team role was requested for ${t}, which was not a pre-determined "relevant" team id`),data:{teamId:t,spaceId:n}})}logIfUnexpectedGroup(e){const{groupId:t}=e;this.relevantEntities.relevantGroupIds.has(t)||this.logErrorFn({from:"UserActorMembership",type:"NonRelevantGroupRequested",error:new Error(`Group role was requested for ${t}, which was not a pre-determined "relevant" group id`),data:e})}constructor(e){this.userPointer=void 0,this.getRecordModel=void 0,this.logErrorFn=void 0,this.relevantEntities=void 0,this.memoizedSpaceRoles=void 0,this.memoizedTeamRoles=void 0,this.memoizedSpaceToGroupMembership=void 0;const{userPointer:t,getRecordModel:n,logErrorFn:o,relevantEntities:i}=e;this.userPointer=t,this.getRecordModel=b({undecoratedGetRecordModel:n,logErrorFn:o,from:"UserActorMembership"}),this.logErrorFn=o,this.relevantEntities=i,this.memoizedSpaceRoles={},this.memoizedTeamRoles={},this.memoizedSpaceToGroupMembership={}}getActorPointer(){return this.userPointer}getSpaceRole(e){this.logIfUnexpectedSpace(e);const t=this.memoizedSpaceRoles[e];if(void 0!==t)return t;const n=this.getRecordModel((0,f.v8)({userId:this.userPointer.id,spaceId:e})),o=void 0===n?"none":n.membership_type;return this.memoizedSpaceRoles[e]=o,this.memoizedSpaceRoles[e]}getTeamRole(e){const{teamId:t,spaceId:n}=e;this.logIfUnexpectedTeam({teamId:t,spaceId:n});const o=this.memoizedTeamRoles[t];if(void 0!==o)return o;const i=this.getRecordModel({table:g.e0,id:t,spaceId:n});if(void 0===i)return this.memoizedTeamRoles[t]="none",this.memoizedTeamRoles[t];const r=[];if(i.isDefault()){"none"!==this.getSpaceRole(i.getSpaceId())&&r.push("member")}i.getRawMembership().forEach((e=>{if("user"===e.entity_type)e.user_id===this.userPointer.id&&r.push(e.type);else if("group"===e.entity_type)if("member"===e.type){"none"!==this.getGroupRole({spaceId:i.getSpaceId(),groupId:e.group_id})&&r.push(e.type)}else(0,s.t1)(e);else(0,s.t1)(e)}));const a=(0,_.uG)(...r);return this.memoizedTeamRoles[t]=a,this.memoizedTeamRoles[t]}getGroupRole(e){const{groupId:t,spaceId:n}=e;this.logIfUnexpectedGroup({groupId:t,spaceId:n});const o=this.getGroupMembershipForSpace(n)[t];if(void 0===o){const e="UserActorMembership";return this.logErrorFn({from:e,type:"NecessaryRecordWasNotProvided",error:new Error(`${e} needed the following (group:${t}, space:${n}, but it was not found`),data:{table:"group",groupId:t,spaceId:n}}),"none"}return o}getGroupMembershipForSpace(e){if(void 0!==this.memoizedSpaceToGroupMembership[e])return this.memoizedSpaceToGroupMembership[e];const t={};this.memoizedSpaceToGroupMembership[e]=t;const n=this.getRecordModel({id:e,table:p.bx});return n?(n.getPermissionGroups().forEach((e=>{var n;null!==(n=e.user_ids)&&void 0!==n&&n.includes(this.userPointer.id)?t[e.id]="member":t[e.id]="none"})),t):t}}let w;w=Symbol.iterator;class k{constructor(e){this.userActorMemberships=void 0,this.botActorMemberships=void 0,this.agentActorMemberships=void 0;const{logErrorFn:t,relevantEntities:n,getRecordModel:o,actorPointers:i}=e;this.userActorMemberships={},this.botActorMemberships={},this.agentActorMemberships={};for(const r of i)r.table===h.KJ?this.userActorMemberships[r.id]=new S({userPointer:r,relevantEntities:n,logErrorFn:t,getRecordModel:o}):r.table===u.cZ?this.botActorMemberships[r.id]=new y({botPointer:r,relevantEntities:n,logErrorFn:t,getRecordModel:o}):r.table===c.y0?this.agentActorMemberships[r.id]=new v({agentPointer:r,logErrorFn:t}):(0,s.t1)(r)}getActorMembership(e){return e.table===h.KJ?this.userActorMemberships[e.id]:e.table===u.cZ?this.botActorMemberships[e.id]:e.table===c.y0?this.agentActorMemberships[e.id]:void(0,s.t1)(e)}*[w](){yield*Object.values(this.userActorMemberships),yield*Object.values(this.botActorMemberships),yield*Object.values(this.agentActorMemberships)}}var I=n(72141);function C(e){const t=new Set,n=new Set,o=new Set,i=e=>{e.forEach((e=>{if((0,I.hV)(e))o.add(e.group_id);else if((0,I.fG)(e)||(0,I.bm)(e))n.add(e.team_id);else if(!((0,I.jg)(e)||(0,I.FB)(e)||!(0,I.C2)(e)||(0,I.$D)(e)||(0,I.e_)(e)||(0,I.ix)(e)||(0,I.Ix)(e)||(0,I.KK)(e)))throw(0,s.t1)(e)}))};for(const{pointer:r,model:a}of e)if(void 0!==r.spaceId&&t.add(r.spaceId),r.table===p.bx)t.add(r.id);else if(r.table===g.e0){if(n.add(r.id),void 0!==a){const e=a;t.add(e.getSpaceId()),e.getRawMembership().forEach((e=>{"group"===e.entity_type&&o.add(e.group_id)}));i(e.getPermissionItems());const n=e.getParentPointer();n.table===p.bx&&void 0!==n.id&&t.add(n.id)}}else if(r.table===f.WU){const{spaceId:e}=(0,f.KQ)(r.id);t.add(e)}else if(r.table===m.Zx){const{spaceId:e}=(0,m.td)(r.id);t.add(e)}else if(r.table===d.iU&&void 0!==a){const e=a;t.add(e.getSpaceId()),i(e.getPermissionItems())}return{relevantSpaceIds:t,relevantTeamIds:n,relevantGroupIds:o}}var x=n(87479),T=n(45953),M=n(53965),P=n(7032),A=n(80444),R=n(55899),D=n(83212),E=n(6258),B=n(88893),F=n(35057),O=n(88280),Z=n(28020),V=n(98165),U=n(65598),L=n(48779),j=n(95697);function N(e){const t=V.fJ(e),n=x.KJ(t);return x.YO(n)}function z(e,t){const{id:n}=e.currentUser;if((0,L.C)()&&(0,L.Fn)(e))return;let i;if(n){const e=t.getRecordValue({table:h.KJ,id:n});e&&(i=(0,o.dp)(e))}const r=V.qA(t).map((e=>e.getModel())).filter(s.$K);return x.IJ({actor:i,ancestors:r})}function q(e){return N(e).map((e=>{let{permissionItem:t}=e;return t})).some((t=>I.$D(t)&&I.YX(t.role)&&(void 0===t.allow_duplicate||!0===t.allow_duplicate)&&(!e.isTypedCollectionViewBlock()||e.isCollectionViewPageWithContent())))}function W(e){return N(e).map((e=>{let{permissionItem:t}=e;return t})).some((e=>I.$D(e)))}function H(e){return N(e).map((e=>{let{permissionItem:t}=e;return t})).some((e=>I.ix(e)))}async function K(e){const{currentUserRootStore:t}=A.default.state;if(!t)return!1;if(!(0,P.e)(e))return!1;const n=E.G.createChildStore(t,{table:d.iU,id:e});return await n.load(),W(n)}function G(e,t){let n;if(n=t instanceof E.H2?(0,L.jv)(t):N(t).map((e=>{let{permissionItem:t}=e;return t})),1===n.length){const[t]=n;return"user_permission"===t.type&&I.zz(t.role)&&t.user_id===e.currentUser.id}return!1}function $(e){const{subscriptionData:t,newGuestIds:n}=e;if(!t)return!1;const o=(0,F.c4)(t);if(void 0===o)return!1;const i=B.ND(t).map((e=>e.userId)),r=B.hn(t).map((e=>e.userId)),a=new Set([...i,...n]);for(const l of r)a.delete(l);const s=Math.max(o,i.length);return a.size>s}function Q(e){if(!e)return!1;const t=(0,F.c4)(e);if(void 0===t)return!0;return B.ND(e).map((e=>e.userId)).length<t}function Y(e){const{store:t,permissionItems:n}=e;if(t instanceof E.H2)return!1;const o=O.subscriptionDataStoreInstance.state;if(!o)return!1;return $({subscriptionData:o,newGuestIds:n.filter(I.jg).filter((e=>"none"!==e.role)).map((e=>e.user_id))})}function J(e){return{editor:"Full access",read_and_write:"Can edit",comment_only:"Can comment",reader:"Can read",none:"No access"}[e]}function X(e){return!!e&&(e.hasPublicPermission&&"edit"!==e.permission)}function ee(e){return!!e&&(e.hasPublicPermission&&"view"===e.permission)}function te(e){let{environment:t,block:n}=e;const o=n.getParentStore();if(!o)return!1;return!X(V.n3(o)&&D.Z.getMode(t,o))&&o.canEdit()}function ne(){const{currentSpaceStore:e}=A.default.state;return"enterprise"===(null==e?void 0:e.getSubscriptionTier())}async function oe(e,t){const n=new Set;var o;if((0,U.Y)(e))null===(o=e.getPermissionItems())||void 0===o||o.forEach((e=>{I.jg(e)&&n.add(e.user_id)}));else if(e instanceof E.G)e.getPermissionItems().forEach((e=>{I.jg(e)&&n.add(e.user_id)}));else if(e instanceof E.H2){const o=t.filter(R.fZ).map((t=>e.getSpaceUserStore(t.value.id)));for(const e of o)await e.load(),e.isDefined()&&e.isMember()&&n.add(e.getUserId())}else(0,s.t1)(e);return t.filter((e=>"existingUser"!==e.type||!n.has(e.value.id)))}function ie(e){const t=(0,Z.np)();if(!t||!e)return;const n=re({userId:e,store:t}).role;return n&&!x.oF(n)?n:void 0}function re(e){let{userId:t,store:n}=e;return se({userId:t,store:n})[0]}function ae(e){const{explicitTeamsRecordMap:t,actorPointers:n,getRecordModelFnFallback:o,logErrorFn:a}=e,s=e.ancestorsRecordMap?e.ancestorsRecordMap:T.Ak.create(),c=r.om.fromRecordMap(s),d=r.om.fromRecordMap(t),u=r.om.tryUntilFound(c,d,o),p=new l.X(n),m=function(e){const{recordMap:t,actorPointers:n,logErrorFn:o,getRecordModelFnWithMaybeMissingRecords:i}=e,r=C(t);return new k({getRecordModel:i,actorPointers:n,logErrorFn:o,relevantEntities:r})}({recordMap:s,getRecordModelFnWithMaybeMissingRecords:u,actorPointers:p,logErrorFn:a??(e=>{const{from:t,type:n,error:o,data:r}=e;i.log({level:"error",from:t,type:n,error:{name:o.name,message:o.message,stack:o.stack},data:{miscDataToConvertToString:r}})})});return{ancestorsRecordMap:s,explicitTeamsRecordMap:t,actorPointersSet:p,actorMemberships:m,temporarySpacesForSpaceUserValues:void 0,type:"loaded_permissions_context"}}function se(e){let{userId:t,store:n}=e;const o=a.DW(n.pointer,n.getRecordModel),i=V.Pj(n)||A.default.state.currentSpaceStore,r=i&&i.isDefined()&&!o.findLast(x.zX)?[...o,i.getModel()]:o,s=T.Ak.create();r.forEach((e=>{s.setModel(e.pointer,e)}));const l=N(n),c=V.VP(n),d=l.filter((e=>{let{permissionItem:t}=e;return(I.zU(t)||I.LW(t))&&t.team_id!==(null==c?void 0:c.id)})).map((e=>e.permissionItem)),u=V.Eb({store:n,teamPermissionItems:d}),p={table:h.KJ,id:t},m=ae({actorPointers:[p],explicitTeamsRecordMap:u,ancestorsRecordMap:s,getRecordModelFnFallback:n.getRecordModel}),f=x.qY({actorPointer:p,ancestors:r,permissionsContext:m}).map((e=>e.permissionItem));if(0===f.length)return[{type:"user_permission",role:"none",user_id:t}];const g=M.oA(f.map((e=>e.role))),v=x.nl(...g);return f.filter((e=>e.role===v)).sort(ce)}function le(e){let{userId:t,store:n}=e;const o=a.DW(n.pointer,n.getRecordModel),i=V.Pj(n)||A.default.state.currentSpaceStore,r=i&&i.isDefined()&&!o.findLast(x.zX)?[...o,i.getModel()]:o,s=T.Ak.create();r.forEach((e=>{s.setModel(e.pointer,e)}));const l=N(n),c=V.VP(n),u=l.filter((e=>{let{permissionItem:t}=e;return(I.zU(t)||I.LW(t))&&t.team_id!==(null==c?void 0:c.id)})).map((e=>e.permissionItem)),p=V.Eb({store:n,teamPermissionItems:u}),m={table:h.KJ,id:t},f=ae({actorPointers:[m],explicitTeamsRecordMap:p,ancestorsRecordMap:s,getRecordModelFnFallback:n.getRecordModel}),v=x.qY({actorPointer:m,ancestors:r,permissionsContext:f}),b=[...v];v.find((e=>"user_permission"===e.permissionItem.type))||b.push({permissionItem:{type:"user_permission",role:"none",user_id:t},from:{table:d.iU,blockId:n.id}});const y=O.subscriptionDataStoreInstance.state,_=new Set(y?B.ND(y).map((e=>e.userId)):[]);if(null!=_&&_.has(t))return b.sort(((e,t)=>ce(e.permissionItem,t.permissionItem))).reverse().sort(((e,t)=>I.xm[t.permissionItem.role??"none"]-I.xm[e.permissionItem.role??"none"]));!v.find((e=>"explicit_team_permission"===e.permissionItem.type&&e.permissionItem.team_id===(null==c?void 0:c.id)))&&c&&(0,j.AL)({teamStore:c,spaceStore:i,userId:t})&&b.push({permissionItem:{type:"explicit_team_permission",role:"none",team_id:c.id},from:{table:g.e0,teamId:c.id}});!v.find((e=>"explicit_team_owner_permission"===e.permissionItem.type&&e.permissionItem.team_id===(null==c?void 0:c.id)))&&c&&c.isOwner(t)&&b.push({permissionItem:{type:"explicit_team_owner_permission",role:"none",team_id:c.id},from:{table:g.e0,teamId:c.id}});return v.find((e=>"space_permission"===e.permissionItem.type))||b.push({permissionItem:{type:"space_permission",role:"none"},from:{table:d.iU,blockId:n.id}}),b.sort(((e,t)=>ce(e.permissionItem,t.permissionItem))).reverse().sort(((e,t)=>I.xm[t.permissionItem.role??"none"]-I.xm[e.permissionItem.role??"none"]))}function ce(e,t){const n=I.jg(e),o=I.jg(t);if(n||o)return n&&o?0:n?-1:1;const i=I.hV(e),r=I.hV(t);if(i||r)return i&&r?0:i?-1:1;const a=I.Lq(e),s=I.Lq(t);return a||s?a&&s?0:a?-1:1:0}function de(e){const{botStore:t,addPermission:n}=e,o=n?x.uH(t.getCapabilities()):"none",i=t.getParentId(),r=t.getParentTable();let a={type:"bot_permission",bot_id:t.id,role:o};return i&&r&&(a={type:"bot_permission",bot_id:t.id,role:o,parent_id:i,parent_table:r}),a}function ue(e){const t=r.kk.isAnyModel(e)?e.getPermissionItems():e.permissions;return M.oA((t||[]).map((e=>{if((0,I.jg)(e)&&(0,I.Jy)(e.role))return{userId:e.user_id,role:e.role}})))}},45101:(e,t,n)=>{n.d(t,{Aw:()=>x,Bu:()=>A,DF:()=>R,Ji:()=>U,NN:()=>P,Nd:()=>T,OA:()=>O,ZK:()=>V,Zp:()=>D,a_:()=>F,cm:()=>M,fR:()=>N,gQ:()=>L,t0:()=>j,xT:()=>B,z5:()=>E});n(57658),n(67294);var o=n(15070),i=n(72141),r=n(21202),a=n(75246),s=n(7928),l=n(9291),c=n(31701),d=n(7032),u=n(1898),p=n(37810),m=n(91219),f=n(47307),g=n(80444),h=n(29677),v=n(6258),b=n(88893),y=n(35057),_=n(88280),S=n(28020),w=n(33929),k=n(65598),I=n(16639),C=n(85893);async function x(e){let{environment:t,permissionsInviteStoreState:n,from:o}=e;const i=(0,C.jsx)(l.FormattedMessage,{id:"permissionsInvite.closeInviteDialog.confirmationMessage",defaultMessage:"Your changes have not been saved. Discard changes?"}),r=(0,C.jsx)(l.FormattedMessage,{id:"permissionsInvite.closeInviteDialog.confirmationButton.label",defaultMessage:"Yes"}),a=(0,C.jsx)(l.FormattedMessage,{id:"permissionsInvite.closeInviteDialog.cancelButton.label",defaultMessage:"Cancel"});if(n.inviteTargets.length>0){const e=await f.confirmUserAction({message:i,acceptLabel:r,cancelLabel:a});return m.q_(t,{...F(t,n),from:o,discard_changes:e}),!e}return!1}function T(e){const{target:t,permissionsInviteStore:n}=e;return n.state.inviteTargets.find((e=>"newUser"===t.type?"newUser"===e.type&&t.value.email===e.value.email:e.type===t.type&&e.value.id===t.value.id))}function M(e){const{targetStore:t,permissionsInviteStore:n,userTarget:o}=e;return!!T({permissionsInviteStore:n,target:o})||"existingUser"===o.type&&D({target:o,store:t})}function P(e){const{targetStore:t,permissionsInviteStore:n,currentInviteActors:i}=e;if(!i)return{inviteUsers:[],inviteGroups:[],inviteBots:[]};const r=i.inviteUsers.filter((e=>!M({targetStore:t,permissionsInviteStore:n,userTarget:e})));return{inviteBots:i.inviteBots.filter((e=>!(!e.value.alive||T({permissionsInviteStore:n,target:e})||!(0,o.oA)(e.value)&&!(0,o.c9)(e.value))&&!D({target:e,store:t}))),inviteGroups:i.inviteGroups.filter((e=>!T({permissionsInviteStore:n,target:e})&&!D({target:e,store:t}))),inviteUsers:r,importedContacts:i.importedContacts}}function A(e,t){if(!e||!t||0===e.length||0===t.length)return t;const n=new Set(e.map((e=>e.value.email.toLowerCase())));return t.filter((e=>!n.has(e.value.email.toLowerCase())))}function R(e){const{intl:t,target:n}=e;switch(n.type){case"newUser":return n.value.email;case"existingUser":return(0,s.Nz)(t,n.value);case"bot":return(0,o.Mh)(n.value);case"group":return(0,I.kF)({intl:t,group:n.value});default:(0,u.t1)(n)}}function D(e){const{target:t,store:n}=e;return!!n.isDefined()&&((0,k.Y)(n)?n.getMembers().filter((e=>{switch(t.type){case"existingUser":return"user"===e.entity_type&&t.value.id===e.user_id;case"group":return"group"===e.entity_type&&t.value.id===e.group_id}})).length>0:n instanceof v.G?n.getPermissionItems().some((e=>{switch(t.type){case"existingUser":return(0,i.jg)(e)&&e.user_id===t.value.id;case"bot":return(0,i.FB)(e)&&e.bot_id===t.value.id;case"group":return(0,i.hV)(e)&&e.group_id===t.value.id;case"newUser":return!1;default:return(0,u.t1)(t)}})):n instanceof v.H2?"existingUser"===t.type?Boolean(n.getSpaceUserStore(t.value.id).isMember()):"bot"===t.type&&Boolean(n.getSpaceBotStore(t.value.id).isMember()):void(0,u.t1)(n))}function E(e){const{environment:t,permissionsInviteStore:n,store:o,renderInShareModal:i}=e;n.setState({modalOpen:!i,tokenQuery:"",inviteTargets:[],inviteRole:B(e),isInviteTargetsEmpty:!0,table:(0,k.Mm)(o)?a.bx:r.iU,flowId:(0,d.ZP)(),inputFocus:"invitee",emailMessage:""}),(0,k.Mm)(o)?m.$z(t):m.Mq(t,{...F(t,e.permissionsInviteStore.state)})}function B(e){const{store:t,isSubscribed:n}=e;return(0,k.Mm)(t)?n?"read_and_write":"editor":(0,y.Mk)()?"editor":"read_and_write"}function F(e,t){var n;const{isInviteTargetsEmpty:o,inviteRole:i,flowId:r}=t,a=(0,S.np)(),s=null==a?void 0:a.getRole(),l=null===(n=g.default.state.currentSpaceStore)||void 0===n?void 0:n.getRole(),{inviteTargets:c,emailMessage:d}=t,u=(0,y.zt)(),p={invite_flow_id:r,user_count:0,is_bot:!1,invite_message_length:(null==d?void 0:d.length)??0,...s&&{page_current_user_role:s},...l&&{space_role:l},...u&&{subscription_tier:u}};if(o)return p;if(0===c.length)return p;if(function(e){return e.length>0&&"bot"===e[0].type}(c))return{...p,is_bot:!0};const m=c.filter(h.cl).length,f=c.filter(h.fZ).length+m;return{...p,role:i,user_count:f,new_user_count:m}}function O(e){return"newUser"===e.type||"existingUser"===e.type&&("none"===e.spaceRole||"not_in_space"===e.spaceRole)}const Z=(0,l.defineMessages)({workspaceOwnerTooltip:{id:"inviteUserModal.userRole.workspaceOwnerBadge.tooltip",defaultMessage:"{ userNameAndEmail} is a workspace owner in this workspace"},workspaceOwnerBadge:{id:"inviteUserModal.userRole.workspaceOwnerBadge.label",defaultMessage:"Workspace Owner"},adminTooltip:{id:"inviteUserModal.userRole.adminBadge.tooltip",defaultMessage:"{ userNameAndEmail} is an admin in this workspace"},adminBadge:{id:"inviteUserModal.userRole.adminBadge.label",defaultMessage:"Admin"},membershipAdminTooltip:{id:"inviteUserModal.userRole.membershipAdminBadge.tooltip",defaultMessage:"{ userNameAndEmail} is a membership admin in this workspace"},membershipAdminBadge:{id:"inviteUserModal.userRole.membershipAdminBadge.label",defaultMessage:"Membership admin"},memberTooltip:{id:"inviteUserModal.userRole.memberBadge.tooltip",defaultMessage:"{ userNameAndEmail} is a member in this workspace"},memberBadge:{id:"inviteUserModal.userRole.memberBadge.label",defaultMessage:"Member"},guestTooltip:{id:"inviteUserModal.userRole.guest.tooltip",defaultMessage:"{ userNameAndEmail} is a guest in this workspace"},guestBadge:{id:"inviteUserModal.userRole.guestBadge.label",defaultMessage:"Guest"}});function V(e){const{environment:t,customStyle:n}=e,{device:o}=t;return{display:"inline-flex",height:18,textTransform:"uppercase",fontSize:10,marginBottom:2,fontWeight:p.Z.fontWeight.medium,letterSpacing:1,color:c.ZP.uiLightGray,border:`1px solid ${c.ZP.uiLightGray}`,minWidth:70,alignItems:"center",justifyContent:"center",paddingTop:o.isAndroid?2:1,paddingBottom:1,paddingLeft:3,paddingRight:3,borderRadius:4,...n}}function U(e){const{role:t,intl:n,nameOrEmail:o}=e,i=o||n.formatMessage({id:"userTypeTooltip.generalPerson",defaultMessage:"This person"});switch(t){case"editor":return{tooltip:n.formatMessage(Z.workspaceOwnerTooltip,{userNameAndEmail:i}),userRoleBadge:n.formatMessage(Z.workspaceOwnerBadge)};case"membership_admin":return{tooltip:n.formatMessage(Z.membershipAdminTooltip,{userNameAndEmail:i}),userRoleBadge:n.formatMessage(Z.membershipAdminBadge)};case"read_and_write":return{tooltip:n.formatMessage(Z.memberTooltip,{userNameAndEmail:i}),userRoleBadge:n.formatMessage(Z.memberBadge)};case"none":return{tooltip:n.formatMessage(Z.guestTooltip,{userNameAndEmail:i}),userRoleBadge:n.formatMessage(Z.guestBadge)};default:(0,u.t1)(t)}}function L(e){return O(e)?"rgba(246, 192, 80, 0.26)":void 0}function j(e){var t;const{inviteTargets:n,recordStore:o,canEditSpaceMembership:i}=e;if(0===n.length)return null;if(!o)return null;const{inviteTargetGuests:r,inviteTargetMembers:a}=function(e){const t=[],n=[];return e.forEach((e=>{O(e)?t.push(e):n.push(e)})),{inviteTargetGuests:t,inviteTargetMembers:n}}(n),s=i?[...a,...r]:a,c=i?[]:r,d=w.default.getIntl(),u=(0,k.OY)(o)?null===(t=o.getBlockTitleStore())||void 0===t?void 0:t.getValue():o.getName();return i||0===c.length?(0,C.jsx)(l.FormattedMessage,{id:"permissionsInvite.inviteConfirmationToast.usersAddedMessage",defaultMessage:"{numberOfTargets, plural, one {Added {targetName} to {recordName}} other {Added {numberOfTargets} people to {recordName}}}",values:{numberOfTargets:s.length,targetName:R({intl:d,target:s[0]}),recordName:u}}):0===s.length?(0,C.jsx)(l.FormattedMessage,{id:"permissionsInvite.inviteConfirmationToast.inviteRequestedMessage",defaultMessage:"{numberOfTargets, plural, one {Requested {targetName} for approval} other {Requested {numberOfTargets} invites for approval}}",values:{numberOfTargets:c.length,targetName:R({intl:d,target:c[0]})}}):(0,C.jsx)(l.FormattedMessage,{id:"permissionsInvite.inviteConfirmationToast.userAddedAndRequestedText",defaultMessage:"{numberOfAddedTargets, plural, one {Added {addedTargetName}} other {Added {numberOfAddedTargets} people}} & {numberOfRequestedTargets, plural, one {requested {requestedTargetName} for approval} other {requested {numberOfRequestedTargets} people for approval}}",values:{numberOfAddedTargets:s.length,addedTargetName:R({intl:d,target:s[0]}),numberOfRequestedTargets:c.length,requestedTargetName:R({intl:d,target:c[0]})}})}function N(e){if("existingUser"!==e.type)return;const t=_.subscriptionDataStoreInstance.state,n=(t?b.CM(t):[]).find((t=>t.userId===e.value.id));return n?n.role:"not_in_space"}},13273:(e,t,n)=>{n.d(t,{Xt:()=>r,al:()=>l,jM:()=>s,yT:()=>a});var o=n(43250),i=n(62619);function r(e){const{menuElement:t,clickedElement:n}=e;return t!==n&&!t.contains(n)&&(!n.classList.contains("notion-link")&&!(n.closest(`.${o.mJW}`)&&!n.closest(`.${o.p1Q}`)&&!n.closest(`.${o.Nn$}`)&&!n.closest(`.${o.fHd}`)))}function a(e){if((0,i.sh)(e,(e=>e.classList&&(e.classList.contains(o.p1Q)||e.classList.contains(o.Nn$)||e.classList.contains(o.fHd)))))return!1;const t=(0,i.sh)(e,(e=>e.classList&&e.classList.contains(o.mJW)));return Boolean(t)}function s(e){const t=(0,i.sh)(e,(e=>e.classList&&e.classList.contains(o.Dkf)));return Boolean(t)}function l(e){const t=(0,i.sh)(e,(e=>e.classList&&e.classList.contains(o.RIA)));return Boolean(t)}},17504:(e,t,n)=>{n.d(t,{V:()=>r,Z:()=>a});var o=n(74948),i=n(12534);function r(e){(0,i.ZP)({event:e,context:i.Af.SidebarMouseMove,callback:()=>{o.close()}})}const a=function(e){return e({onMouseMove:r})}},55227:(e,t,n)=>{n.d(t,{g7:()=>a,kF:()=>l});n(57658);var o=n(70203),i=n(53965),r=n(62619);function a(e){let t="";const n=document.createElement("div");n.innerHTML=e;const o=r.kd(n);for(const r of o){const e=i.YU(r.data);if(null!==r.parentElement&&r.parentElement!==n){t+=`<span class="${s({parent:r.parentElement,root:n}).join(" ")}">${e}</span>`}else t+=e}return t}function s(e){const{parent:t,root:n}=e,o=new Set;let i=t;for(;i&&i!==n;)i.classList.forEach((e=>{o.add(e)})),i=i.parentElement??void 0;return Array.from(o)}function l(e,t){const n={text:c(e),syntax:c(t)},i=function(e){let t=0;return e.reduce(((e,n)=>(e.push([t,n]),t+=n,e)),[])}(function(e,t){const n=e.slice(),o=t.slice(),i=[];let r=0,a=0;for(;r<n.length&&a<o.length;){const e=n[r],t=o[a];e===t?(i.push(e),r+=1,a+=1):e<t?(i.push(e),r+=1,o[a]-=e):(i.push(t),n[r]-=t,a+=1)}return i}(n.text,n.syntax)),r={text:0,syntax:0},a={text:0,syntax:0},s=[],l=e.map(o.WiV).join("");for(const[o,c]of i){const e=o+c,i=t[r.syntax],u={value:l.substring(o,e),textTokenIndex:r.text,classNames:(d=i,d&&d[1])};s.push(u);const p=n.text[r.text],m=n.syntax[r.syntax];e>=a.text+p&&(r.text+=1,a.text+=p),e>=a.syntax+m&&(r.syntax+=1,a.syntax+=m)}var d;return s}function c(e){return e.map((e=>e[0].length))}},70219:(e,t,n)=>{n.d(t,{b:()=>r});var o=n(95477),i=n(81236);function r(e){return t=>{const{RouterStore:n}=e;if("page"!==n.state.route.name||!n.state.route.requestedOnPublicDomain)return;const r=i.Z.getData(e,{spaceId:t}),a=(null==r?void 0:r.domain)||n.state.route;return`${window.location.protocol}//${a}.${o.default.publicDomainName}`}}},58239:(e,t,n)=>{n.d(t,{ZT:()=>c,lX:()=>a,rq:()=>s});var o=n(15157),i=n(21202),r=n(75246);async function a(e){let{currentUserId:t,spaceStore:n}=e;const i=o.Z.get({userId:t,key:l(n.id)});return u(n,n.loadRecordModel,i)}function s(e){let{currentUserId:t,spaceId:n,value:i}=e;o.Z.set({userId:t,key:l(n),value:i})}function l(e){return`quickAddParent3:${e}`}function c(e){let{currentUserId:t,spaceId:n,parent:i,databaseType:r}=e;o.Z.set({userId:t,key:d(n,r),value:i})}function d(e,t){return`quickAddTypedParent:${e}:${t||"default"}`}async function u(e,t,n){let o;if(n)if("page"===n.type){await t({table:i.iU,id:n.id})&&(o=n)}else if("space"===n.type){await t({table:r.bx,id:n.id})&&(o=n)}return o||{type:"space-private-pages",spaceId:e.id}}},15447:(e,t,n)=>{n.d(t,{Od:()=>g,Wk:()=>b,X4:()=>p,_5:()=>v,_k:()=>h,h_:()=>f,rw:()=>m});n(57658);var o=n(14577),i=n(53965),r=n(54642),a=n(18245),s=n(80444),l=n(77080),c=n(69327),d=n(29026);const u=1e3,p=new o.Z((()=>{const{currentSpaceStore:e}=s.default.state;if(!e)return[];return c.Z.getWithoutSubscribing(e.id).slice(0,u).filter((e=>!e.store.pathIsDead()))}),{debugName:"recentAlivePagesStore"});function m(e,t){if("object"==typeof t&&t){const{spaceId:e,blockId:n,visitedAt:o}=t.userPageVisit||{};if(!e||!n||!o)return;!function(e){let{spaceId:t,pageId:n,visitedAt:o}=e;const i=c.Z.getWithoutSubscribing(t),r={pageId:n,visitedAt:o},a=function(e){let{newRecentPage:t,currentRecentPages:n}=e;const o=n.filter((e=>e.pageId!==t.pageId)),i=o;let r=0;for(;r<o.length;r++)if(t.visitedAt>=o[r].visitedAt){i.splice(r,0,t);break}r===o.length&&i.push(t);return i}({newRecentPage:r,currentRecentPages:i});c.Z.set(t,a),p.recompute()}({spaceId:e,pageId:n,visitedAt:o})}}async function f(e){let{environment:t,userId:n,spaceId:o}=e;const s=l.default.getGroup("search-more-recent-pages-in-local"),d="lazy-";let u;s.startsWith(d)&&(u=i.o5(s.slice(5))||void 0);const m=s.startsWith(d),f=a.default.mark("load_global_recent_pages_initial_load"),g=a.default.mark("load_global_recent_pages");async function h(e,i){const l=await r.getRecentPageVisits(t,{userId:n,spaceId:o,limit:e},n);"success"===l.type&&(a.default.measure(i,{environment:t,data:{experiment_group:s}}),c.Z.set(o,l.data.pages.map((e=>({pageId:e.id,visitedAt:e.visitedAt}))))),p.recompute()}m?(h(u,g),await h(void 0,f)):await h(u,g)}async function g(e,t){var n,o;let{environment:i,userId:a,spaceId:s}=t;if(c.Z.getWithoutSubscribing(s).length>u)return!1;const l=await r.getRecentPageVisits(i,{userId:a,spaceId:s,beforeTimestamp:e,limit:d.Xv},a);if("success"!==l.type||l.data.pages.length<=0)return!1;const m=l.data.pages.map((e=>({pageId:e.id,visitedAt:e.visitedAt}))),f=null===(n=c.Z.get(s))||void 0===n?void 0:n.length;c.Z.mergeRecentPages(m,s);const g=null===(o=c.Z.get(s))||void 0===o?void 0:o.length;return p.recompute(),f!==g}const h=["today","yesterday","past_week","past_30_days","older"];function v(e){const t=Date.now(),n=864e5,o=t-e,i=new Date(e).getDay(),r=new Date(t).getDay(),a=new Date(t);a.setDate(a.getDate()-1);const s=a.getDay();return i===r&&o<=n?"today":i===s&&o<=1728e5?"yesterday":o<=6048e5?"past_week":o<=2592e6?"past_30_days":"older"}function b(e){return null==e?void 0:e.map((e=>({visitedAt:e.visitedAt,pageId:e.pageId}))).sort(((e,t)=>t.visitedAt-e.visitedAt)).slice(0,50)}},44133:(e,t,n)=>{n.r(t),n.d(t,{getDebugSourcesForIdsInOperations:()=>c,setBlockIdDebugSource:()=>s,setupRecordCacheDebugging:()=>a});var o=n(39593);let i=!1;const r=new(n.n(o)())({max:1e4});function a(e){e.isMobile||(i=!0)}function s(e,t){i&&(r.has(e)||r.set(e,t))}const l=/[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}/g;function c(e,t){const n={blocks:{},isIdSourceCacheFull:r.itemCount===r.max},o=JSON.stringify(t),i=new Set(Array.from(o.matchAll(l)).map((e=>e[0])));for(const s of i){var a;let t=!1;const o={},i=r.get(s);i&&(t=!0,o.debugSource=i);const l=e.defaultRecordCache.inMemoryRecordCache.getRecord({pointer:{table:"block",id:s},userId:e.currentUser.id});null!=l&&null!==(a=l.value)&&void 0!==a&&a.type&&(t=!0,o.blockType=l.value.type),t&&(n.blocks[s]=o)}return n}},65598:(e,t,n)=>{n.d(t,{D4:()=>V,De:()=>J,GP:()=>q,HK:()=>U,M1:()=>Q,MI:()=>x,Mm:()=>K,No:()=>W,OY:()=>_,Oh:()=>$,PF:()=>O,SJ:()=>k,Sd:()=>T,Xp:()=>B,Y:()=>y,ak:()=>Z,al:()=>A,bB:()=>E,bQ:()=>N,c3:()=>F,dv:()=>P,dz:()=>Y,ig:()=>j,le:()=>L,mY:()=>D,sl:()=>H,vV:()=>R,x8:()=>w,yJ:()=>S,zP:()=>z});var o=n(92595),i=n(68626),r=n(606),a=n(70921),s=n(21202),l=n(70279),c=n(33709),d=n(75246),u=n(29369),p=n(70203),m=n(53965),f=n(1898),g=n(6258),h=n(13105),v=n(98165);const b=128;function y(e){return e.table===u.e0}function _(e){return e.table===s.iU}function S(e){return A(e,{recursivelyLoadAllDiscussions:!1}).filter(J)}function w(e){return(0,g.Vh)(e,e.pointer,"discussions")}function k(e){let t=0;return e.findRecordStoreUIAncestor((n=>(n!==e&&e.id&&n.id===e.id&&n.table===e.table&&m.Xy(e.path,n.path)&&t++,!1))),t>1}const I=new h.P({debugName:"recursiveChildBlocks",memoizeRecursion:!0,deepEquals:!1,compute:function(e,t){if(k(e))return[];return e.getContentStores().map((e=>{switch(e.getType()){case"page":return;case"transclusion_reference":return e.getTransclusionReferenceTargetStore();default:return e}})).filter(f.$K).flatMap((e=>[e,...t(e)]))}}),C=new h.P({debugName:"recursiveWihTransclusionChildBlocks",memoizeRecursion:!0,deepEquals:!1,compute:function(e,t){if(k(e))return[];return e.getContentStores().map((e=>{if("page"!==e.getType())return e})).filter(f.$K).flatMap((e=>[e,...t(e)]))}});function x(e){const{blockStore:t,traverseTransclusionReferences:n}=e;return n?I.getStateFor(t):C.getStateFor(t)}function*T(e){const{blockStores:t,traverseTransclusionReferences:n}=e;for(const o of t){yield o;for(const e of x({blockStore:o,traverseTransclusionReferences:n}))yield e}}const M=new h.P({debugName:"loadedDiscussionStores",memoizeRecursion:!1,deepEquals:!1,compute:function(e){const t=w(e),n=((null==t?void 0:t.getValue())||[]).map((t=>g.t1.createChildStore(e,r.dr.fromPointerLike({table:c.qF,id:t,spaceId:e.pointer.spaceId}))));return n.reverse(),n}});function P(e){return e.table===l.x_}function A(e,t){const n=t.excludeSelf?[]:[e],o=null!=t&&t.recursivelyLoadAllDiscussions?[...n,...I.getStateFor(e)]:n,i=new Set;return o.flatMap(M.getStateFor).filter((e=>!!(null!=t&&t.includeLoadingDiscussions||e.isDefined())&&(!i.has(e.id)&&(i.add(e.id),!0))))}function R(e,t){return E(A(e,t)).unresolved}function D(e,t){return E(A(e,t)).resolved}function E(e){const t=e.filter((e=>e.isDefined())),[n,o]=m.uK(t,(e=>e.getResolved()));return{resolved:n,unresolved:o}}function B(e,t){return(Array.isArray(e)?e:R(e,t)).reduce(((e,n)=>{const o=n.getModel();return o?t.onlyIncludeBlockLevelDiscussions&&!J(n)?e:e+(o.getComments()||[]).length:e}),0)}function F(e,t){return(Array.isArray(e)?e:R(e,t)).reduce(((e,n)=>{const o=n.getModel();return o?t.onlyIncludeBlockLevelDiscussions&&!J(n)?e:{comments:e.comments+(o.getComments()||[]).length,reactions:e.reactions+g.bh.getUserVisibleReactions(n).length}:e}),{comments:0,reactions:0})}function O(e){if("text"!==e.getType())return!1;const t=e.getBlockTitleStore().getValue();return(!t||!t.length)&&(!e.hasContent()&&0===function(e,t){return R(e,t).length}(e,{recursivelyLoadAllDiscussions:!1}))}function Z(e){return(0,g.Vh)(e,e.pointer,"comments")}function V(e){if(!e)return[];const t=Z(e);return(t.getValue()||[]).map((e=>g.T5.createChildStore(t,{table:l.x_,id:e,spaceId:t.pointer.spaceId})))}function U(e){if(e.isDefined())return g.t1.createChildStore(e,e.getParentPointer())}function L(e){const t=j(e);return(t.getValue()||[]).map((n=>g.G.createChildStore(t,r.dr.fromPointerLike({table:s.iU,id:n,spaceId:e.pointer.spaceId}))))}function j(e){return(0,g.Vh)(e,e.pointer,"content")}function N(e){return(0,g.Vh)(e,e.pointer,"last_edited_time")}function z(e){return(0,g.Vh)(e,e.pointer,"text")}function q(e){if(e.isDefined())return g.t1.createChildStore(e,e.getParentPointer())}function W(e,t,n){return g.t1.createChildStore(e,{table:a.TY,id:t,spaceId:n})}function H(e){if(e.isDefined())return W(e,e.getActivityId(),e.getSpaceId())}function K(e){return e.table===d.bx}(0,o.exposeDebugValue)("getDiscussionStores",A);const G=m.P2((e=>{i.log(e)}),500);function $(e){let t=e,n=0;for(;t;){if(!t.isReady())return!1;if(n>=b)return G({level:"error",from:"recordStoreHelpers",type:"areAncestorsLoaded",data:{message:"max depth reached",miscDataToConvertToString:{maxDepth:b,id:e.id,table:e.table,currentStoreId:t.id,currentTable:t.table}}}),!1;n+=1,t=(0,v.Om)(t)}return!0}async function Q(e){let t=e,n=0;for(;t;){if(t.isReady()||await t.load(),n>=b)return G({level:"error",from:"recordStoreHelpers",type:"loadAncestors",data:{message:"max depth reached",miscDataToConvertToString:{maxDepth:b,id:e.id,table:e.table,currentStoreId:t.id,currentTable:t.table}}}),!1;n+=1,t=(0,v.Om)(t)}}function Y(e){return e.table===s.iU&&m.Xy(e.path,["content"])}function J(e){if(!e.isDefined())return!1;if("suggestion"===e.getType())return!1;const t=e.getContext();if(!t)return!0;return function(e){return 0===p.llS(e).length}(p.VP_(t,(t=>!p.xw5(t)||p.h19(t)===e.id)))}},37034:(e,t,n)=>{n.d(t,{JL:()=>p,NO:()=>m,V:()=>f,vU:()=>g});var o=n(17215),i=n(42875),r=n(82883),a=n(13493),s=n(1898),l=n(10906),c=n(6258),d=n(65183),u=n(48779);const p=(0,s.AO)((e=>e instanceof c.G||e instanceof c.H2||e instanceof c.NW||e instanceof c.Xr||e instanceof c.zX?{true:e}:{false:e}));function m(e,t){if(e.isDefined())return e.getModel().getEmptyTitlePlaceholder({getRecordModel:e.getRecordModel,userTimeZone:(0,i.r)(),intl:t})}function f(e,t,n,a){if(e instanceof c.zX)return e.getName();if(e instanceof c.H2)return(0,u.rn)(n,e);if(e instanceof c.Xr){const t=e.getName();if(t)return t;const n=e.getType();return n?d.Bh[n]:void 0}if("none"===e.getRole())return o.x(t);if(!e.isDefined())return;const s=e instanceof c.G?e.getTitleValue():e.getName();return(0,r.X)({textValue:s,getRecordModel:e.getRecordModel,userTimeZone:(0,i.r)(),intl:t,disableInsertedAnnotations:a})}function g(e){const{environment:t,intl:n,untitledFallback:i,store:r}=e,s=i?n.formatMessage(i):function(e,t){if(e.table===a.np){const n=e.getType();if(n&&"page"!==n&&l.b1[n])return t.formatMessage(l.b1[n])}return o.Q2(t)}(r,n);return f(r,n,t,!1)||m(r,n)||s}},81166:(e,t,n)=>{n.d(t,{Bq:()=>I,l7:()=>f,W3:()=>g,uM:()=>k,qi:()=>y,Gt:()=>b,cn:()=>C,OH:()=>_,g3:()=>S,K9:()=>w,vi:()=>x,nB:()=>v,Tq:()=>h,dH:()=>m});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("dateInterval",{viewBox:"0 0 20 20",svg:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("path",{d:"M4.345 10.359l1.832 1.36c.191.146.378.182.56.11.183-.074.274-.226.274-.459v-.847H8.96a.52.52 0 00.54-.533.513.513 0 00-.157-.376.521.521 0 00-.383-.158H7.01V8.63c0-.246-.093-.4-.28-.465-.186-.068-.371-.034-.553.103L4.345 9.64a.43.43 0 00-.185.362c0 .146.062.264.185.356zm11.31 0l-1.832 1.36c-.191.146-.378.182-.56.11-.183-.074-.274-.226-.274-.459v-.847H11.04a.533.533 0 01-.383-.15.521.521 0 01-.157-.383c0-.146.052-.272.157-.376a.521.521 0 01.383-.158h1.95V8.63c0-.246.093-.4.28-.465.186-.068.371-.034.553.103l1.832 1.374a.43.43 0 01.185.362.423.423 0 01-.185.356zM3.378 15.16c.183 0 .33-.051.445-.16a.553.553 0 00.17-.42V5.449a.592.592 0 00-.17-.438.601.601 0 00-.445-.17.592.592 0 00-.437.17.592.592 0 00-.171.438v9.132c0 .173.057.31.17.42s.26.16.438.16zm13.24 0c.183 0 .33-.051.445-.16a.552.552 0 00.17-.42V5.447a.592.592 0 00-.17-.437.6.6 0 00-.445-.17.592.592 0 00-.437.17.593.593 0 00-.171.437v9.132c0 .173.057.31.17.42.115.11.26.16.438.16z"})})}),a=(0,o.IU)("hand",{viewBox:"0 0 28 28",svg:(0,i.jsx)("path",{d:"M13.6572 23.1553C16.918 23.1553 19.1943 21.415 20.416 17.9873L21.9893 13.584C22.1035 13.2588 22.1562 12.9512 22.1562 12.6611C22.1562 11.6592 21.4092 10.9209 20.416 10.9209C19.7832 10.9209 19.2119 11.2812 18.9131 11.9668L18.4385 13.1182C18.4209 13.1533 18.4033 13.1709 18.3682 13.1709C18.3242 13.1709 18.3066 13.1445 18.3066 13.1006V6.35059C18.3066 5.23438 17.5771 4.51367 16.4961 4.51367C16.1621 4.51367 15.8545 4.61914 15.6172 4.82129C15.4414 3.93359 14.8174 3.38867 13.9121 3.38867C13.0332 3.38867 12.3916 3.94238 12.207 4.80371C11.9873 4.61035 11.7061 4.51367 11.4072 4.51367C10.3965 4.51367 9.70215 5.2168 9.70215 6.2627V7.08008C9.48242 6.86914 9.16602 6.75488 8.83203 6.75488C7.82129 6.75488 7.10938 7.51074 7.10938 8.58301V16.2822C7.10938 20.5361 9.72852 23.1553 13.6572 23.1553ZM13.6133 21.6523C10.4668 21.6523 8.54199 19.6484 8.54199 16.124V8.75C8.54199 8.41602 8.75293 8.1875 9.06934 8.1875C9.39453 8.1875 9.62305 8.41602 9.62305 8.75V13.2764C9.62305 13.6543 9.93066 13.918 10.2822 13.918C10.6426 13.918 10.9502 13.6543 10.9502 13.2764V6.48242C10.9502 6.14844 11.1611 5.91992 11.4863 5.91992C11.8027 5.91992 12.04 6.14844 12.04 6.48242V12.8105C12.04 13.1885 12.3389 13.4609 12.6904 13.4609C13.0508 13.4609 13.3584 13.1885 13.3584 12.8105V5.36621C13.3584 5.04102 13.5869 4.79492 13.9033 4.79492C14.2197 4.79492 14.4482 5.04102 14.4482 5.36621V12.7051C14.4482 13.0654 14.7383 13.3467 15.0986 13.3467C15.4678 13.3467 15.7666 13.0654 15.7666 12.7051V6.48242C15.7666 6.14844 15.9863 5.91992 16.3115 5.91992C16.6279 5.91992 16.8564 6.14844 16.8564 6.48242V15.2451C16.8564 15.7549 17.1816 16.0449 17.6035 16.0361C17.9551 16.0361 18.2715 15.8779 18.4824 15.4121L19.748 12.5732C19.8975 12.2305 20.1963 12.125 20.4688 12.2217C20.7676 12.3359 20.8643 12.626 20.7236 13.0039L19.0889 17.5127C17.999 20.501 16.1621 21.6523 13.6133 21.6523Z"})}),s=(0,o.IU)("overlap",{viewBox:"0 0 20 20",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M4.917 14.496h1.729v-1.1H4.93c-.342 0-.604-.091-.786-.274-.182-.182-.273-.45-.273-.806V5.52c0-.356.09-.625.273-.807.182-.182.444-.273.786-.273h6.83c.336 0 .596.09.779.273.186.182.28.451.28.807v1.497h1.1V5.459c0-.702-.18-1.23-.54-1.586-.355-.355-.888-.533-1.6-.533H4.918c-.716 0-1.254.178-1.614.533-.355.351-.533.88-.533 1.586v6.918c0 .707.178 1.237.533 1.593.36.35.898.526 1.614.526zm3.315 3.165h6.863c.711 0 1.244-.177 1.6-.533.36-.355.54-.884.54-1.586V8.624c0-.702-.18-1.23-.54-1.586-.356-.355-.889-.533-1.6-.533H8.232c-.716 0-1.253.178-1.613.533-.356.351-.534.88-.534 1.586v6.918c0 .707.178 1.235.534 1.586.36.356.897.533 1.613.533zm.014-1.1c-.342 0-.604-.091-.787-.274-.182-.182-.273-.45-.273-.806V8.686c0-.356.091-.625.273-.807.183-.182.445-.273.787-.273h6.829c.337 0 .597.09.779.273.187.182.28.451.28.807v6.795c0 .355-.093.624-.28.806-.182.183-.442.274-.78.274H8.247z"}),(0,i.jsx)("path",{d:"M13.976 12.448l-1.832 1.36c-.192.147-.379.183-.561.11-.182-.073-.273-.225-.273-.458v-.848H9.7a.533.533 0 01-.383-.15.521.521 0 01-.157-.383c0-.145.053-.27.157-.376s.233-.157.383-.157h1.61v-.827c0-.246.093-.401.28-.465.187-.068.371-.034.554.103l1.832 1.374a.43.43 0 01.184.362.423.423 0 01-.184.356z"})]})});var l=n(9291),c=n(1898),d=n(51592);const u=(0,l.defineMessages)({dependenciesPropertySelectDefaultOptionCaption:{id:"database.viewSettings.relationFeatures.dependencies.propertySelectPopup.default.caption",defaultMessage:"This property will be used for dependencies in new views, and will set date shifting behavior across all views."},deleteDependenciesAcceptModalTitle:{id:"collectionSettings.relationFeatures.deleteDependenciesAcceptModal.title",defaultMessage:"Turn off dependencies?"},dependenciesMenuTitle:{id:"database.viewSettings.dependenciesTab.title",defaultMessage:"Dependencies"},dateShiftingSectionCaption:{id:"collectionSettings.dependenciesView.dateShiftingSection.caption",defaultMessage:"Automatic date shifting"},datePropertyPickerTitle:{id:"database.viewSettings.relationFeatures.datePropertyPicker.title",defaultMessage:"Shift using"},startDate:{id:"database.viewSettings.relationFeatures.datePropertyPicker.startDate",defaultMessage:"Start date"},endDate:{id:"database.viewSettings.relationFeatures.datePropertyPicker.endDate",defaultMessage:"End date"},advancedSettings:{id:"database.viewSettings.dependenciesAdvancedSettingsTab.title",defaultMessage:"Advanced settings"},newDateProperty:{id:"collectionSettings.dependenciesFeature.newDateProperty.name",defaultMessage:"Date"},doNotShiftButton:{id:"collectionSettings.dependenciesView.dateShiftingButton.doNotShift.label",defaultMessage:"Do not automatically shift"},consumeGapButton:{id:"collectionSettings.dependenciesView.dateShiftingButton.consumeGap.label",defaultMessage:"Shift only when dates overlap"},avoidWeekendsSwitcherTitle:{id:"collectionSettings.dependenciesView.dateShiftingSection.avoidWeekends.switcher.title",defaultMessage:"Avoid weekends"},hideDependenciesInView:{id:"CollectionSettingsViewRelationFeatures.hideDependenciesInView",defaultMessage:"Hide dependencies in view"},showDependenciesInView:{id:"CollectionSettingsViewRelationFeatures.showDependenciesInView",defaultMessage:"Show dependencies in view"},turnOnDependenciesButton:{id:"collectionSettings.dependenciesView.turnOnDependenciesButton.label",defaultMessage:"Turn on dependencies"},turnOffDependenciesButton:{id:"database.viewSettings.relationsPropertyTab.removeDependenciesButton.title",defaultMessage:"Turn off dependencies"},dateShiftSuccess:{id:"collectionDateActions.dateShiftSuccess",defaultMessage:"Shifted the dates of {numDependenciesUpdated, plural, one {1 dependent {item}} other {{numDependenciesUpdated} dependent {items}}}"},dateShiftSomeNotUpdatedDueToPermissions:{id:"collectionDateActions.dateShiftSomeNotUpdatedDueToPermissions",defaultMessage:"Shifted the dates of {numDependenciesUpdated, plural, one {1 dependent {item}} other {{numDependenciesUpdated} dependent {items}}}. Others could not be shifted because you do not have permission"},dateShiftAllNotUpdatedDueToPermissions:{id:"collectionDateActions.dateShiftAllNotUpdatedDueToPermissions",defaultMessage:"The dates of dependent {items} could not be shifted because you do not have permission"},shiftingNotApplicableNoShiftingMessage:{id:"CollectionSettingsViewRelationFeatures.shiftingNotApplicableNoShiftingMessage",defaultMessage:"The dates of dependent {items} in this view will not automatically shift. To change the date shifting behavior, update the default relation property in Advanced settings."},shiftingNotApplicableConsumeGapMessage:{id:"CollectionSettingsViewRelationFeatures.shiftingNotApplicableConsumeGapMessage",defaultMessage:"The dates of dependent {items} in this view will shift when {item} dates overlap. To change the date shifting behavior, update the default relation property in Advanced settings."},shiftingNotApplicablePreserveGapMessage:{id:"CollectionSettingsViewRelationFeatures.shiftingNotApplicablePreserveGapMessage",defaultMessage:"The dates of dependent {items} in this view will shift maintaining the time between {items}. To change the date shifting behavior, update the default relation property in Advanced settings."},preserveGapButton:{id:"collectionSettings.dependenciesView.dateShiftingButton.preserveGap.label",defaultMessage:"Shift & maintain time between {items}"},avoidWeekendsSwitcherCaption:{id:"collectionSettings.dependenciesView.dateShiftingSection.avoidWeekends.switcher.description",defaultMessage:"Prevent shifted {items} from starting or ending on weekends"},dependenciesMenuDescription:{id:"database.viewSettings.relationsPropertyTab.dependencies.description",defaultMessage:"Use dependencies to show {items} that are blocking â€” or blocked by â€” other {items}."},dependenciesPropertyPickerCaption:{id:"database.viewSettings.relationsPropertyTab.dependencies.relationPropertyPicker.caption",defaultMessage:"Choose the relation property that represents the {items} that are blocked. We use â€œBlockingâ€ as our default."}}),p=(0,l.defineMessages)({hideSubitemsInView:{id:"CollectionSettingsViewRelationFeatures.hideSubitemsInView",defaultMessage:"Hide sub-{items} in view"},showSubitemsInView:{id:"CollectionSettingsViewRelationFeatures.showSubitemsInView",defaultMessage:"Show sub-{items} in view"},turnOnSubItemsButton:{id:"collectionSettings.subitemsView.turnOnSubitemsButton.label",defaultMessage:"Turn on sub-{items}"},turnOffSubItemsButton:{id:"database.viewSettings.relationsPropertyTab.removeSubItemsButton.title",defaultMessage:"Turn off sub-{items}"},subItemsMenuTitle:{id:"database.viewSettings.subItemsTab.title",defaultMessage:"Sub-{items}"},subItemsMenuDescription:{id:"database.viewSettings.relationsPropertyTab.subitems.description",defaultMessage:"Use sub-{items} to break large {items} into smaller, more manageable chunks."},deleteSubItemsAcceptModalTitle:{id:"collectionSettings.relationFeatures.deleteSubItemsAcceptModal.title",defaultMessage:"Turn off sub-{items}?"},subItemsPropertyPickerCaption:{id:"database.viewSettings.relationsPropertyTab.subitems.relationPropertyPicker.caption",defaultMessage:"Choose the relation property that represents the sub-{items}. We use â€œSub-{item}â€ as our default."},subItemsPropertySelectDefaultOptionCaption:{id:"database.viewSettings.relationFeatures.subitems.propertySelectPopup.default.caption",defaultMessage:"This property will be used for sub-{items} in new views."},toggleNestingOnTitleMenuItemTooltip:{id:"database.viewSettings.relationFeatures.subitems.toggleNestingOnTitleMenuItemTooltip.default.caption",defaultMessage:"Whether nesting and the toggle button should always be on the title column or the left-most column. Only relevant for table views"}}),m=(0,l.defineMessages)({relationFeatureShownMessage:{id:"database.viewSettings.mainTab.feature.shown",defaultMessage:"Shown"},relationFeatureOnMessage:{id:"database.viewSettings.mainTab.feature.on",defaultMessage:"On"},relationFeatureOffMessage:{id:"database.viewSettings.mainTab.feature.off",defaultMessage:"Off"},relationFeatureHiddenMessage:{id:"database.viewSettings.mainTab.relationFeatureHidden",defaultMessage:"Hidden"},turnOffAndDelete:{id:"collectionSettings.relationFeatures.turnOffFeatureAllViewsButton.label",defaultMessage:"Turn off & delete properties"},turnOffFeature:{id:"collectionSettings.relationFeatures.turnOffFeatureWithoutDeleteButton.label",defaultMessage:"Turn off & keep properties"},turnOffFeatureDeletedProperties:{id:"collectionSettings.relationFeatures.turnOffFeature.deletedProperties.description",defaultMessage:"This will also delete the properties <span>{propertyName}</span> and <span>{inversePropertyName}</span>."},...u,...p});function f(e){return"consume_gap"===e?s:"preserve_gap"===e?r:a}function g(e){let t;return t="consume_gap"===e.dateShiftingMode?m.consumeGapButton:"preserve_gap"===e.dateShiftingMode?m.preserveGapButton:m.doNotShiftButton,{...t,values:{items:(0,d.Q_)(e.databaseType,!0)}}}function h(e){let t;return"timeline_arrows_by"===e.feature?t=m.turnOnDependenciesButton:"subitem"===e.feature?t=m.turnOnSubItemsButton:(0,c.t1)(e.feature),{...t,values:{items:(0,d.Q_)(e.databaseType,!0)}}}function v(e){let t;return"timeline_arrows_by"===e.feature?t=m.turnOffDependenciesButton:"subitem"===e.feature?t=m.turnOffSubItemsButton:(0,c.t1)(e.feature),{...t,values:{items:(0,d.Q_)(e.databaseType,!0)}}}function b(e){let t;return"timeline_arrows_by"===e.feature?t=m.dependenciesMenuTitle:"subitem"===e.feature?t=m.subItemsMenuTitle:(0,c.t1)(e.feature),{...t,values:{items:(0,d.Q_)(e.databaseType,!0)}}}function y(e){let t;return"timeline_arrows_by"===e.feature?t=m.dependenciesMenuDescription:"subitem"===e.feature?t=m.subItemsMenuDescription:(0,c.t1)(e.feature),{...t,values:{items:(0,d.Q_)(e.databaseType,!0)}}}function _(e){let t;return"timeline_arrows_by"===e.feature?t=m.deleteDependenciesAcceptModalTitle:"subitem"===e.feature?t=m.deleteSubItemsAcceptModalTitle:(0,c.t1)(e.feature),{...t,values:{items:(0,d.Q_)(e.databaseType,!0)}}}function S(e){let t;return"timeline_arrows_by"===e.feature?t=m.dependenciesPropertyPickerCaption:"subitem"===e.feature?t=m.subItemsPropertyPickerCaption:(0,c.t1)(e.feature),{...t,values:{item:(0,d.sN)(e.databaseType,!0),items:(0,d.Q_)(e.databaseType,!0)}}}function w(e){let t;return"timeline_arrows_by"===e.feature?t=m.dependenciesPropertySelectDefaultOptionCaption:"subitem"===e.feature?t=m.subItemsPropertySelectDefaultOptionCaption:(0,c.t1)(e.feature),{...t,values:{item:(0,d.sN)(e.databaseType,!0),items:(0,d.Q_)(e.databaseType,!0)}}}function k(e){let t;return(0,c.$K)(e.currentDateShiftConfig)?"preserve_gap"===e.currentDateShiftConfig.mode?t=m.shiftingNotApplicablePreserveGapMessage:"consume_gap"===e.currentDateShiftConfig.mode?t=m.shiftingNotApplicableConsumeGapMessage:(0,c.t1)(e.currentDateShiftConfig.mode):t=m.shiftingNotApplicableNoShiftingMessage,{...t,values:{items:(0,d.Q_)(e.databaseType,!0)}}}function I(e){return{...m.avoidWeekendsSwitcherCaption,values:{items:(0,d.Q_)(e,!0)}}}function C(e){const{feature:t,isOn:n,databaseType:o}=e;let i;return"timeline_arrows_by"===t?i=n?m.hideDependenciesInView:m.showDependenciesInView:"subitem"===t?i=n?m.showSubitemsInView:m.hideSubitemsInView:(0,c.t1)(t),{...i,values:{items:(0,d.Q_)(o,!0)}}}function x(e){const t={numDependenciesUpdated:e.result.numDependenciesUpdated,item:(0,d.sN)(e.databaseType,!0),items:(0,d.Q_)(e.databaseType,!0)};return e.result.numCouldNotUpdateDueToPermissions>0?e.result.numDependenciesUpdated>0?{message:{...m.dateShiftSomeNotUpdatedDueToPermissions,values:t},canUndo:!0}:{message:{...m.dateShiftAllNotUpdatedDueToPermissions,values:{}},canUndo:!1}:e.result.numDependenciesUpdated>0?{message:{...m.dateShiftSuccess,values:t},canUndo:!0}:void 0}},29376:(e,t,n)=>{n.d(t,{BI:()=>y,DB:()=>E,KV:()=>g,Mu:()=>f,NA:()=>M,ND:()=>P,OP:()=>h,Pi:()=>v,U1:()=>x,ZI:()=>C,aI:()=>k,gO:()=>D,gZ:()=>S,ke:()=>A,m8:()=>I,ny:()=>_,pR:()=>b,rj:()=>w,uJ:()=>R});n(57658);var o=n(99036),i=n(95200),r=n(77657),a=n(6695),s=n(42875),l=n(22808),c=n(59753),d=n(1898),u=n(51592),p=(n(4430),n(10906)),m=n(6258);const f=32;function g(e,t){return e.normalizedSchemaStore.state[t]}function h(e,t,n){const i=g(e,t);if(!i||"relation"!==i.type||!i.property)return!1;const r=e.collectionStore(),a=n.getSchema();return o.$u({propertySchema:i,sourceCollectionId:null==r?void 0:r.id,property:t,targetCollectionSchema:a})}function v(e){const t=(0,d.qP)(e).find((e=>{let[t,n]=e;if(n&&(0,o.NK)(n))return n.connectedRelation.integration_id===r.U9}));if(t&&t[1]&&(0,o.NK)(t[1]))return t[1]}function b(e){return Boolean(v(e))}function y(e,t){if(!e)return!1;const n=e[t];return Boolean(n&&(0,o.NK)(n)&&n.connectedRelation.integration_id===r.U9)}function _(e,t){if("relation"!==(null==t?void 0:t.type))return;const n=null==t?void 0:t.collection_pointer,o=e.collectionViewBlockStore();return n&&o?m.NW.createChildStore(o,n):void 0}function S(e){return p.eD({collectionStore:e,collectionViewBlockStore:e.getParentBlockStore(),checkNavigableAncestorLocked:!1})}function w(e){const{inverseName:t,collectionStore:n,propertySchema:o,intl:i,targetCollectionStore:r,from:a}=e;return t||(n.isDefined()&&o?k(i,{sourceCollection:n.getModel(),isSelfRelation:n.id===r.id,targetCollectionStore:r,createUnique:!0,from:a}):"")}function k(e,t){var n;const{sourceCollection:o,isSelfRelation:r,targetCollectionStore:a,createUnique:d,from:p}=t,m=c.kk.fromCollection(o),f=e.formatMessage({id:"relationHelpers.autoInverseRelation.untitledDatabase",defaultMessage:"Untitled Database"}),g=null===(n=m.getRenderIcon({}))||void 0===n?void 0:n.icon,h=m.getRenderTitle({getRecordModel:a.getRecordModel,userTimeZone:(0,s.r)(),intl:e})||f,v=m.getDatabaseType();let b;if(r)if("subitem"===p){const t=(0,u.sN)(v,!0);b=e.formatMessage({defaultMessage:"Parent {item}",id:"relationHelpers.autoSelfRelationInverseToggle.typedName"},{item:t})}else b="timeline_arrows_by"===p?e.formatMessage({defaultMessage:"Blocked by",id:"relationHelpers.autoSelfRelationInverseArrow.name"},{sourceCollectionName:h}):e.formatMessage({defaultMessage:"Related back to {sourceCollectionName}",id:"relationHelpers.autoSelfRelationInverse.name"},{sourceCollectionName:h});else b=g&&(0,l.Z)(g)?e.formatMessage({defaultMessage:"{sourceCollectionIcon} {sourceCollectionName}",id:"relationHelpers.autoInverseRelationWithIcon.name"},{sourceCollectionIcon:g,sourceCollectionName:h}):e.formatMessage({defaultMessage:"{sourceCollectionName}",id:"relationHelpers.autoInverseRelationSimple.name"},{sourceCollectionName:h});const y=a.getSchema();return y&&d?(0,i.Z)(b,(e=>!Object.values(y).find((t=>Boolean(t&&t.name===e))))):b}function I(e,t){var n,o;const{targetCollectionStore:r,isSelfRelation:a,sourceSchema:c,createUnique:d,from:p}=t,m=null===(n=r.getModel())||void 0===n||null===(n=n.getRenderIcon({}))||void 0===n?void 0:n.icon,f=e.formatMessage({id:"relationHelpers.autoInverseRelation.untitledDatabase",defaultMessage:"Untitled Database"}),g=(null===(o=r.getModel())||void 0===o?void 0:o.getRenderTitle({getRecordModel:r.getRecordModel,userTimeZone:(0,s.r)(),intl:e}))||f,h=r.getDatabaseType();let v;if(a)if("subitem"===p){const t=(0,u.sN)(h,!0);v=e.formatMessage({defaultMessage:"Sub-{item}",id:"relationHelpers.autoSelfRelationNest.typedName"},{item:t})}else v="timeline_arrows_by"===p?e.formatMessage({defaultMessage:"Blocking",id:"relationHelpers.autoSelfRelationTimelineArrow.name"},{targetCollectionName:g}):e.formatMessage({defaultMessage:"Related {targetCollectionName}",id:"relationHelpers.autoSelfRelation.name"},{targetCollectionName:g});else v=m&&(0,l.Z)(m)?e.formatMessage({defaultMessage:"{targetCollectionIcon} {targetCollectionName}",id:"relationHelpers.autoRelationWithIcon.name"},{targetCollectionIcon:m,targetCollectionName:g}):e.formatMessage({defaultMessage:"{targetCollectionName}",id:"relationHelpers.autoRelation.name"},{targetCollectionName:g});const b=Object.values(c);return d?(0,i.Z)(v,(e=>!b.find((t=>Boolean(t&&t.name===e))))):v}function C(e){const t=a.iB(e.getFormat(),e.getSchema(),void 0,a.j5.Relation);return t?t.collection_relation_options??{}:{}}function x(e){var t;const{collectionStore:n,property:o}=e;return(null===(t=C(n)[o])||void 0===t?void 0:t.related_properties)??[]}function T(e,t){return Object.entries(t).map((n=>{let[i,r]=n;if(!r||!(0,o.p_)(r))return;const a=(0,o.j0)(r),s=e.collectionStore();if(!a||a.id!==(null==s?void 0:s.pointer.id)||!s||!h(e,i,s))return;const l=r.property;if(!l)return;const c=t[l];if(!c||"relation"!==c.type)return;const d=(0,o.j0)(c);return d&&d.id===(null==s?void 0:s.pointer.id)?{propertyID:i,inversePropertyID:l}:void 0})).filter(d.$K)}function M(e,t){return T(e,t).map((e=>e.propertyID))}function P(e,t){const n=T(e,t),o=new Set,i=[];for(const{propertyID:r,inversePropertyID:a}of n)o.has(r)||o.has(a)||(i.push([r,a]),o.add(r),o.add(a));return i}function A(e,t){const n=(0,o.j0)(e);if(!n)return;const i=m.NW.createChildStore(t,n);return i?null==i?void 0:i.getFormat().app_config_uri:void 0}function R(e,t){const n=(0,o.j0)(e);if(!n)return;const i=new m.NW(t,n);return i?null==i?void 0:i.getSchema():void 0}function D(e,t){const n=(0,o.j0)(e);if(!n)return;const i=new m.NW(t,n);return i||void 0}function E(e){var t;if(e.patternName)return null===(t=e.integration.info)||void 0===t||null===(t=t.original_url_patterns)||void 0===t?void 0:t.filter((t=>{var n;return t.name===e.patternName&&(null===(n=t.additional_types)||void 0===n?void 0:n.connectedRelation)})).find((t=>{let{regex:n}=t;return new RegExp(n).test(e.url)}))}},77546:(e,t,n)=>{n.d(t,{Ez:()=>f,Gf:()=>v,Oc:()=>u,SD:()=>s,VW:()=>l,Wr:()=>p,eA:()=>h,hI:()=>d,xH:()=>c});n(57658);var o=n(69454),i=n(43250);const r=8,a={auto:!0,scroll:!0};function s(e){return e&&e instanceof HTMLElement?e:e&&e.parentElement?e.parentElement:void 0}function l(e){const t=s(e);if(t)return g(t,i.wKH)}function c(e){const t=s(e);if(t)return g(t,i.PBs)}function d(e){let t=e;const n=[];do{const e=window.getComputedStyle(t);e&&(e.overflow&&a[e.overflow]||e.overflowY&&a[e.overflowY]||e.overflowX&&a[e.overflowX])&&n.push(t),t=t.parentElement}while(t);return n}function u(e){const{el:t,windowHeight:n}=e,i=e.minEdgeDist??r,a=l(t);if(!a||!a.getBoundingClientRect)return;const s=t.getBoundingClientRect(),c=a.getBoundingClientRect(),d=n-o.Z.estimatedNativeWebBottomOverlap(),u=Math.min(c.bottom,d);s.top<c.top?a.scrollTop=a.scrollTop-(c.top-s.top)-i:s.bottom>u&&(a.scrollTop=a.scrollTop+(s.bottom-u)+i)}function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{edgeDist:0,animate:!1};const n=l(e),{animate:o,edgeDist:i}=t;if(!n||!n.getBoundingClientRect)return;const r=e.getBoundingClientRect(),a=n.getBoundingClientRect();if(o){const e=500,t=n.scrollTop-(a.top-r.top)-i,o=n.scrollTop,s=t-o,l=16;let c=0;const d=()=>{var t,i,r;c+=l,n.scrollTop=(t=c,i=o,r=s,(t/=e/2)<1?r/2*t*t+i:-r/2*(--t*(t-2)-1)+i),c<e&&requestAnimationFrame(d)};d()}else n.scrollTop=n.scrollTop-(a.top-r.top)-i}function m(e){return e&&e.overflowY&&a[e.overflowY]}function f(e){if(!e)return;let t=e;if(t)do{const e=t.parentElement&&window.getComputedStyle(t.parentElement);if(e&&m(e))return t;t=t.parentElement||void 0}while(t);return document.body}function g(e,t){if(!e)return;let n=e;if(n)do{const e=window.getComputedStyle(n);if((n.classList&&n.classList.contains(i.OK_)&&n.classList.contains(t)||m(e))&&(!n.classList||!n.classList.contains(i.hBn)))return n;n=n.parentElement||void 0}while(n);return document.body}function h(e){return e.device.isDesktop&&!e.device.isSafari}function v(e){return e.device.isDesktop}},45010:(e,t,n)=>{n.d(t,{Z:()=>o});const o={}},59139:(e,t,n)=>{n.d(t,{Qi:()=>l,XP:()=>r,bN:()=>s,rd:()=>a});var o=n(77080),i=n(55320);function r(){return!1}function a(e){return"on"===o.default.getGroup("search-intent-based-grouping-n-side-peek")||s(e)}function s(e){return"quickSearch"===e.RouterStore.state.route.name}function l(e){if(e.device.isMobile)return!1;const t=e.currentUser.id;if(!a(e)||!t)return!1;return!o.default.checkGate("search_toggle_side_peek")||i.default.state.preferSidePeekOpen}},97638:(e,t,n)=>{n.d(t,{AX:()=>z,De:()=>w,FN:()=>k,IV:()=>U,MQ:()=>N,MS:()=>R,Nu:()=>V,VA:()=>I,VD:()=>S,YB:()=>F,_Q:()=>M,b9:()=>B,bC:()=>j,dy:()=>q,g8:()=>L,gC:()=>A,oO:()=>O,p6:()=>C,pG:()=>Z,uL:()=>E,zD:()=>P});n(57658);var o=n(40506),i=n(7057),r=n(53877),a=n(42875),s=n(21202),l=n(92338),c=n(9291),d=n(53965),u=n(54642),p=n(80444),m=n(46735),f=n(43250),g=n(98165),h=n(46654),v=n(15447);function b(e){return Boolean(e&&e.length>0)}function y(e){return Boolean(e.starting||e.ending)}function _(e){return Boolean(e)}const S={requireEditPermissions:_,isDeletedOnly:_,excludeTemplates:_,navigableBlockContentOnly:_,ancestors:b,parentId:function(e){return void 0!==e},createdBy:b,editedBy:b,lastEditedTime:y,createdTime:y,isAdminModeDeletedPageSearch:_,blockTypes:function(e){return Boolean(e&&e.length>0)},inTeams:function(e){return b(l.iY(e))},includePublicPagesWithoutExplicitAccess:_,audience:function(e){return Boolean(e)},dev_excludedPages:b,dev_excludedTeams:b,databaseType:b};function w(e){return e?{requireEditPermissions:S.requireEditPermissions(e.requireEditPermissions),isDeletedOnly:S.isDeletedOnly(e.isDeletedOnly),excludeTemplates:S.excludeTemplates(e.excludeTemplates),navigableBlockContentOnly:S.navigableBlockContentOnly(e.navigableBlockContentOnly),ancestors:S.ancestors(e.ancestors),parentId:S.parentId(e.parentId),createdBy:S.createdBy(e.createdBy),editedBy:S.editedBy(e.editedBy),createdTime:S.createdTime(e.createdTime),lastEditedTime:S.lastEditedTime(e.lastEditedTime),blockTypes:S.blockTypes(e.blockTypes),inTeams:S.inTeams(e.inTeams),dev_excludedPages:S.dev_excludedPages(e.dev_excludedPages),dev_excludedTeams:S.dev_excludedTeams(e.dev_excludedTeams)}:{requireEditPermissions:!1,isDeletedOnly:!1,excludeTemplates:!1,navigableBlockContentOnly:!1,ancestors:!1,parentId:!1,createdBy:!1,editedBy:!1,createdTime:!1,lastEditedTime:!1,blockTypes:!1,inTeams:!1,dev_excludedPages:!1,dev_excludedTeams:!1}}function k(e){const t=w(e);return Object.values(t).some((e=>Boolean(e)))}function I(e){const t=w(e),{navigableBlockContentOnly:n,...o}=t;return Object.values(o).some((e=>Boolean(e)))}function C(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.sF;const a=r.OQ.notionDateToLuxon(e,{locale:t.locale});return(0,i.Cp)(a,n)}function x(e,t){const n=r.OQ.notionDateTimeToLuxon(e,t.locale);return(0,i.ZW)(n,"medium_with_time")}const T=(0,c.defineMessages)({startAndEnd:{defaultMessage:"{startDate} - {endDate}",id:"searchHelpers.betweenStartAndEndDates"},afterStart:{defaultMessage:"After {startDate}",id:"searchHelpers.afterStartDate"},beforeEnd:{defaultMessage:"Before {endDate}",id:"searchHelpers.beforeEndDate"}});function M(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.sF,i="",r="";return e.starting&&(i="date"===e.starting.type?C(e.starting,t,n):x(e.starting,t)),e.ending&&(r="date"===e.ending.type?C(e.ending,t,n):x(e.ending,t)),i&&r?t.formatMessage(T.startAndEnd,{startDate:i,endDate:r}):i?t.formatMessage(T.afterStart,{startDate:i}):t.formatMessage(T.beforeEnd,{endDate:r})}function P(e){return Boolean(e.target&&e.target instanceof HTMLElement&&e.target.classList.contains("rdp-day"))}function A(e){const{input:t,spaceId:n,publicAccessPermissionAncestorBlockId:o,searchSessionId:i,searchSessionFlowNumber:r,source:a,forcedClusterPattern:s,searchExperimentOverrides:c,recentPagesForBoosting:d,forcedBlockIds:u,excludedBlockIds:p}=e,{query:m,limit:f,debug:g}=t;return n?{type:l.n8.BlocksInSpace,query:m.text.trim(),spaceId:n,limit:f,filters:m.filters,sort:m.sort,source:a||"quick_find",debug:g,searchExperimentOverrides:c,searchSessionId:i,searchSessionFlowNumber:r,forcedClusterPattern:s,recentPagesForBoosting:(0,v.Wk)(d),forcedBlockIds:u,excludedBlockIds:p}:o?{type:l.n8.BlocksInAncestor,query:m.text.trim(),ancestorId:o,filters:m.filters,sort:m.sort,limit:f,source:a||"quick_find_public",debug:g,searchExperimentOverrides:c,searchSessionId:i,searchSessionFlowNumber:r,forcedClusterPattern:s,forcedBlockIds:u,excludedBlockIds:p}:void 0}function R(e){const{environment:t}=e,n=A(e);return!!n&&u.search(t,n)}class D{constructor(e){this.startingTimestamp=void 0,this.endingTimestamp=void 0,this.startingTimestamp=e.starting&&r.uO(e.starting,(0,a.r)()),this.endingTimestamp=e.ending&&r.uO(e.ending,(0,a.r)())}matches(e){return void 0!==e&&(!(void 0!==this.startingTimestamp&&e<this.startingTimestamp)&&!(void 0!==this.endingTimestamp&&e>this.endingTimestamp))}}class E{constructor(e){this.filters=void 0,this.activeFilters=void 0,this.ancestorFilterIds=void 0,this.parentFilterId=void 0,this.createdTimeMatcher=void 0,this.lastEditedTimeMatcher=void 0,this.teamFilterIds=void 0,this.dev_notInTeamFilterIds=void 0,this.dev_notInPagesFilterIds=void 0,this.filters=e,this.activeFilters=w(e),this.ancestorFilterIds=new Set(e.ancestors),this.parentFilterId=e.parentId,this.createdTimeMatcher=new D(e.createdTime),this.lastEditedTimeMatcher=new D(e.lastEditedTime),this.teamFilterIds=new Set(l.iY(e.inTeams)??[]),this.dev_notInTeamFilterIds=new Set(e.dev_excludedTeams),this.dev_notInPagesFilterIds=new Set(e.dev_excludedPages)}matches(e){let{blockModel:t,path:n}=e;if(!Boolean(this.activeFilters.isDeletedOnly)!==t.alive)return!1;if(this.activeFilters.excludeTemplates&&t.is_template)return!1;if(this.activeFilters.editedBy){const e=t.last_edited_by_id||t.last_edited_by;if(!e||!this.filters.editedBy.includes(e))return!1}if(this.activeFilters.createdBy){const e=t.created_by_id||t.created_by;if(!e||!this.filters.createdBy.includes(e))return!1}if(this.activeFilters.ancestors&&!n.some((e=>{let{value:t}=e;return this.ancestorFilterIds.has(t.id)})))return!1;if(this.activeFilters.parentId){if(n.length<2)return!1;const[e,{value:{id:t}}]=n;return this.parentFilterId===t}if(this.activeFilters.lastEditedTime&&!this.lastEditedTimeMatcher.matches(t.last_edited_time))return!1;if(this.activeFilters.createdTime&&!this.createdTimeMatcher.matches(t.created_time))return!1;if(this.activeFilters.inTeams){var o;const e=g.KU(n),t=null==e||null===(o=e.value)||void 0===o?void 0:o.id;if(!t||!this.teamFilterIds.has(t))return!1}return!0}}function B(e){if(e&&!e.error)return e.value}function F(e){let{sort:t,unsorted:n,batchSize:o,currentUserId:i}=e;const r=Date.now();if("relevance"!==t.field)return n;const a=d.yo(n,o).map((e=>m.Z.sortFrecencyHighToLow({items:e,now:r,currentUserId:i,recordFrecency:!0})));return d.xH(a)}function O(e){const{localResults:t,serverResults:n}=e;if(t||n){if(t&&n){const o=new Set(t.map((e=>e.id)));function i(e){return(null==e?void 0:e.sources)??[]}return t.map((e=>{const t=(o=e.id,null==n?void 0:n.find((e=>e.id===o)));var o;const r=(null==(a=t)?void 0:a.originalPosition)??e.originalPosition;var a;const s=[...new Set([...e.badges??[],...(null==t?void 0:t.badges)??[]])];return{...e,originalPosition:r,serverEventProperties:(null==t?void 0:t.serverEventProperties)??e.serverEventProperties,sources:[...e.sources,...i(t)],badges:s}})).concat(n.filter((e=>!o.has(e.id))))}return t??n}}function Z(e){var t,n,o,i;const{focusedIndexStore:r,searchActionsStore:a,searchResultStore:s}=e,l=O({localResults:null===(t=s.state.localResults)||void 0===t?void 0:t.results,serverResults:null===(n=s.state.serverResults)||void 0===n?void 0:n.results}),c=null===(o=r.state)||void 0===o?void 0:o.global,d=null===(i=r.state)||void 0===i?void 0:i.local;if(void 0===c||void 0===d)return;const u=a.state.length,p=c<u&&a.state[c];if(p&&"assistant"===p.type)return{type:p.type};const m=c-u;if(!l||l.length<=0||m<0)return;const f=l[m];return f?{type:"page_result",value:{index:{global:c,local:d},selectedResult:f,allSearchResults:l}}:void 0}function V(e){const{existingResults:t,newPageResults:n}=e;if(void 0!==t||void 0!==n){if(t&&n){const e=[...t.results],o=new Set(t.results.map((e=>e.id)));return e.push(...n.results.filter((e=>!(e.sources.includes(l.vp.ElasticsearchRandom)&&e.originalPosition<t.results.length)&&!o.has(e.id)))),{...n,results:e,total:n.total}}return t??n}}function U(e){const{intentBasedGrouping:t,localResults:n,serverResults:o}=e,i=O({localResults:n,serverResults:o})??[],r=i.filter((e=>e.sources.includes(l.vp.ElasticsearchUniqueID))),a=i.filter((e=>!e.sources.includes(l.vp.ElasticsearchUniqueID)));return t?{type:"intent-based-grouping",sections:{uniqueIdSearchResults:r,jumpBackInSearchResults:a.filter((e=>e.sources.includes(l.vp.Local))),serverOnlySearchResults:a.filter((e=>!e.sources.includes(l.vp.Local)))},allSearchResults:i}:r.length>0?{type:"unique-id",sections:{uniqueIdSearchResults:r,nonUniqueIdSearchResults:a},allSearchResults:i}:{type:"all",sections:{allSearchResults:i},allSearchResults:i}}function L(e,t,n){const o=n??(e.device.isMobile?2:3);return t.slice(0,o)}function j(e){const{mainEditorCurrentBlockStore:t}=p.default.state,n=t&&h.IJ(e,t);return{hasPublicAccessPermission:Boolean(n),publicAccessPermissionAncestorBlockId:(null==n?void 0:n.from.table)===s.iU?null==n?void 0:n.from.blockId:void 0}}function N(e){let{environment:t,searchResultsSection:n,modalBodyMenu:o,searchFilterMenu:i,actionItemCount:r}=e;if(!n)return 0;let a=0;if(t.device.isMobile){const e=null==o?void 0:o.getNode();if(e instanceof Element&&null!==i){const t=e.getElementsByClassName(f.GZn)[0];t instanceof Element&&(a=t.clientHeight-i.getClientHeight()+t.scrollTop)}}else a=n.getBoundingClientRect().height+n.scrollTop;let s=0,l=0;const c=n.getElementsByClassName(f.Xjk);for(let u=0;u<c.length;u++){l+=c[u].clientHeight}const d=n.getElementsByClassName(f.ulv);for(let u=0;u<d.length;u++){const e=d[u];if(!(a-l>e.clientHeight/2))break;s+=1,l+=e.clientHeight}return s-r}function z(e){if(void 0===e)return[];return e.map((e=>({id:e.id,score:e.score,sources:e.sources,spaceId:e.spaceId})))}function q(e){var t;if(void 0!==(null==e?void 0:e.highlightBlockId)&&void 0===(null===(t=e.highlight)||void 0===t?void 0:t.title))return e.highlightBlockId}},69645:(e,t,n)=>{n.d(t,{Bj:()=>h,D_:()=>_,Ib:()=>g,XL:()=>y,dq:()=>v,kC:()=>b,v5:()=>f});n(57658);var o=n(55010),i=n(45060),r=n(21202),a=n(95371),s=n(374),l=n(1898),c=n(94419),d=n(95802),u=n(27724),p=n(28020),m=n(62619);function f(e,t){return(0,a.DY)(t,(t=>t.value.store===e))}function g(e,t){const n=f(e,[t]);if(n&&n.length>0)return n[n.length-1]}function h(e){const t=e.container??u.default.getCurrentDefaultContainer();if(!t)return new a.DG([]);const n=[];d.C.forEach((o=>{const i=o.getNode(),r=o.props.store;if(!i)return;if(o.getContextSelectableContainer()!==t)return;(o.props.canSelect||e.includeNonSelectableListContainer&&o.props.isListContainer)&&n.push({node:i,store:r,component:o})}));var i;return(i=n,(0,a.Yc)({values:i,compareOrder:(e,t)=>(0,o.Z)(e.node,t.node),isAncestor:(e,t)=>m.r3(e.node,t.node)}))||new a.DG([])}function v(e){const t=e.root||(0,p.RM)();if(t){const n=h(e);return new a.mp({store:t,node:void 0,component:void 0},n.children)}}function b(e){const{rootStore:t,root:n,target:o}=e,i=(0,a.DY)(n.children,(e=>e===o));if(void 0===i)return;const r=[t];let s=t;for(const a of i){const e=a.value.store;if(!e)return;const t=s.getTransclusionReferenceTargetStore()??s;let n=t.getContentStores();const o=t.getAutomationStore();if(o){const e=o.getActionStores();n=n.concat(e.flatMap((e=>e.getBlockStores())))}const i=n.find((t=>t.id===e.id));if(!i)return;r.push(i),s=i}return r}function y(e){var t;const{treeOperation:n,deleteFrom:o}=e,i=[],a=null===(t=n.deleteFromParent.value.store)||void 0===t?void 0:t.getContentStore(),s=n.deletingChildren.map((e=>e.value.store)).filter(l.$K);for(const l of s){const e=l.getRecordStoreUIParent(),t=e&&e.table===r.iU&&1===e.path.length&&"content"===e.path[0]&&e,n="record-store-parent"===o&&t||a;n&&i.push({parent:n,childToRemove:l})}return i}function _(e){const{transaction:t,treeOperation:n,deleteFrom:o,observer:i}=e;switch(n.operation){case"delete":return void y({treeOperation:n,deleteFrom:o}).forEach((e=>{let{parent:o,childToRemove:r}=e;const a={parent:o,childToRemove:r,transaction:t};c.Od(a),null==i||i.onRemove(n,a)}));case"insert":{var r,a;const e=null===(r=n.insertIntoParent.value.store)||void 0===r?void 0:r.getContentStore(),o=null===(a=n.adjacentSibling)||void 0===a?void 0:a.value.store,i=n.insertChildren.map((e=>e.value.store));("listAfter"===n.direction&&o||"listBefore"===n.direction&&!o)&&i.reverse();for(const r of i)if(e&&r)if("listAfter"===n.direction){const n={insert:r,parent:e,transaction:t,after:o};c.BE(n)}else{const n={insert:r,parent:e,transaction:t,before:o};c.Vt(n)}return}case"move":for(const e of(0,s.Z)(n))_({transaction:t,treeOperation:e,deleteFrom:o,observer:void 0});return void(null==i||i.onMove(n));default:(0,l.t1)(n)}}!function(){const{span:e,object:t,div:n,CONTAINER_STYLE:o}=i.TI;(0,i.Rw)({canFormat:e=>Boolean(e&&e instanceof a.mp),header:(i,r)=>e(o,e({},t(i,{useDefaultFormatter:!0})),n({},t(i.value.store)),i.children.length?n({},t(i.children)):void 0),hasBody:(e,t)=>!1,body:e=>null})}()},73959:(e,t,n)=>{n.d(t,{J2:()=>m,Mn:()=>u,iZ:()=>h,mh:()=>f,sQ:()=>p,sY:()=>v,x7:()=>g});var o=n(41432),i=n(44534),r=n(80444),a=n(55367),s=n(88923),l=n(6258),c=n(27724),d=n(98165);function u(e){return!e.isPhone}function p(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&e instanceof l.G)return e;let t=e;for(;;){if(t=t.getRecordStoreUIParent(),!t)return;if(t&&t instanceof l.G&&t!==e)return t}}function m(e){const t=p(e);if(t)return d.Dg(t)}function f(e){const t=e.getType(),n=e.getModel(),r=e.getProperties();if(t&&n)return t&&(0,o.XD)(t)&&"factory"!==t&&!(0,o.S9)(t)?e.getBlockTitleStore():n.isInlineCollectionView()?e.getTitleStore():n.isType(o.oe)&&r&&r.caption?e.getCaptionStore():t===o.Ti.table?i.g$.getCellTextStore({simpleTableStore:e,rowIndex:0,columnIndex:0}):void 0}function g(e){const t=p(e);if(t)return t&&(t===r.default.state.mainEditorCurrentBlockStore||s.default.state.open&&t===s.default.state.target)}function h(e){const{stores:t,phase:n}=c.default.state;return 1===t.length&&t[0]===e&&n===c.SelectionPhase.Editing}function v(e){const{stores:t,phase:n}=c.default.state,o=new Set(t.map((e=>e.id))),i=d.qA(e),r=o.has(e.id),s=i.some((e=>o.has(e.id))),l=r||s;return!(n!==c.SelectionPhase.Selected||!l||a.ZP.state.isDragging)}},89014:(e,t,n)=>{n.d(t,{u:()=>r,x:()=>i});const o=new Map;function i(e){return o.get(e)}function r(e,t){o.set(e,t)}},41984:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(6287);const i=function(e){return!(e.getParentTable()===o.vF)||e.isTemplate()}},28187:(e,t,n)=>{n.d(t,{F6:()=>m,Jk:()=>d,SG:()=>p,kC:()=>f,oI:()=>g});n(57658);var o=n(77657),i=n(63787),r=n(90965),a=(n(95477),n(80444)),s=n(77080),l=n(6258),c=n(98165);function d(e){const t=c.qA(e),n=[];for(const o of t)"block"===o.table&&n.push({blockStore:o,slackIntegrationStore:(0,l.Kv)(e,{table:i.s_,id:o.id})});for(const{blockStore:o,slackIntegrationStore:i}of n)if(i.isReady()){if(i.getKeyStore("enabled").getValue())return{blockStore:o,slackIntegrationStore:i}}return{blockStore:e,slackIntegrationStore:(0,l.Kv)(e,{table:i.s_,id:e.id})}}function u(){var e;const t=null===(e=a.default.state.currentSpaceStore)||void 0===e?void 0:e.getBotSettingsStore().getValue();return(0,r.hU)({spaceBotSettings:t,integrationId:o.nO,env:"production"})}function p(){return s.default.checkGate("legacy_slack_notifications")}function m(){return!!u()&&"on"===s.default.getGroup("notion-to-slack")}function f(){return!!u()&&"on"===s.default.getGroup("notion-mentions-to-slack")}function g(){return!!u()&&s.default.checkGate("enable_notion_activity_notifications_in_slack")}},48779:(e,t,n)=>{n.d(t,{G$:()=>j,cJ:()=>X,Q6:()=>ge,w3:()=>ee,rg:()=>L,g4:()=>te,a2:()=>q,_o:()=>z,kO:()=>ve,KA:()=>H,Wd:()=>G,ns:()=>Y,XD:()=>J,rn:()=>$,TC:()=>ae,jv:()=>Q,lQ:()=>re,C:()=>le,Fn:()=>se,di:()=>ie,Q9:()=>de,kt:()=>fe,Cx:()=>ne,j9:()=>ce,CV:()=>oe,iX:()=>K,Ib:()=>pe,ww:()=>ue,cD:()=>me,$U:()=>he});n(21703);var o=n(14577),i=n(15145),r=n(44317),a=n(62193),s=n(21202),l=n(75246),c=n(19889),d=n(66079),u=n(28182),p=n(9852),m=n(60949),f=n(53965),g=n(1898),h=n(3297),v=n(94273),b=n(40277),y=n(12321),_=n(65452),S=n(95477),w=n(75538);var k=n(94841),I=n(88310),C=n(80444),x=n(92425),T=n(77080),M=n(81236),P=n(6258),A=n(13105),R=n(29226),D=n(88893),E=n(84210),B=n(33929),F=n(35026),O=n(98165),Z=n(46654),V=n(65598),U=n(95697);async function L(e,t){const n=await async function(e,t){const n=e.currentUser.id,o=t.getSpaceStore();if(await t.load(),o&&n){var i;t.hasRemoteSharedPages()||await _.l({environment:e,spaceId:o.id,userId:n});const r=x.Z.getSharedPagesState({spaceId:o.id,userId:n}),a=(r&&r.currentPageIds?r.currentPageIds:[]).map((e=>P.G.createChildStore(o,{table:s.iU,id:e,spaceId:o.id})));await Promise.all([o.load(),Promise.all(t.getBookmarkedPageStores().map((e=>e.load()))),Promise.all(J(e,o).map((e=>e.load()))),Promise.all(t.getSharedPageStores().map((e=>e.load()))),Promise.all(a.map((e=>e.load())))]);return[...t.getBookmarkedPages(),...t.getWorkspacePages(),...H(e,t),...t.getPrivatePages(e),...(null===(i=t.getTeamsStores())||void 0===i||null===(i=i[0])||void 0===i?void 0:i.getTeamPageStores())||[],...a].filter((t=>!(0,Z.IJ)(e,t)))}}(e,t)??[];return n[0]}const j=7,N=new a.Uw;function z(e){return N.memo((()=>new o.Z((()=>q(e)),{debugName:"pageContextStore"})),[e.environment,e.spaceViewStore,e.userSettingsStore,e.type])}function q(e){const{environment:t,spaceViewStore:n,userSettingsStore:o,type:i}=e,r=(0,F._v)(t),a=n.getSpaceId(),s="shared"===i?H(t,n):function(e,t){const n=t.getPrivatePages(e),o=(0,F._v)(e);if(!o)return n;const i=n.map((e=>{if(!e.isDefined())return;const t=e.getLastEditedTime()||e.getCreatedTime();return t?{store:e,timestamp:t}:void 0})).filter(g.$K);return f.MR(i,(e=>{let{timestamp:t}=e;return t})).reverse().map((e=>e.store))}(t,n);if(!a||"private"===i&&!r)return{allPagesStores:s,visiblePagesStores:s};if(!o.hasUserPinnedToOutliner({type:i,spaceId:a})||"private"===i)return{allPagesStores:s,visiblePagesStores:s.slice(0,j)};const l=new Set(s.map((e=>{let{id:t}=e;return t})));return{allPagesStores:s,visiblePagesStores:n.getPinnedSharedPages().filter((e=>{let{id:t}=e;return l.has(t)}))}}const W=new a.Uw;function H(e,t){const n=e.currentUser.id,o=t.getSpaceStore();if(o&&n){const i=x.Z.getSharedPagesState({spaceId:o.id,userId:n}),r=i&&i.currentPageIds?i.currentPageIds:[],a=W.memo((()=>function(e,t){return new A.P({debugName:"isValidSharedRemotePage",memoizeRecursion:!1,deepEquals:!1,compute:function(n){const o=e.currentUser.id;if(!o)return!1;const i=t.getSpaceUserStore(o),r=(0,O.u3)(n);let a=!1;return r&&((0,V.OY)(r)?a=!(0,U.bq)()&&e.currentUser.id&&t.isDefined()&&n.hasSpacePermission()?Boolean(i.isMember()):r.id!==n.id&&r.canRead():(0,V.Y)(r)&&(a=Boolean(r.isMemberOrGuest(e.currentUser.id))&&r.canRead())),!(!((0,V.Oh)(n)&&n.canRead()&&n.isNavigableBlock()&&n.isSharedPage(t,e))||(0,O.wf)(n)||a)}})}(e,o)),[e,o]),l=f.oA(r.map((e=>{const t=P.G.createChildStore(o.getPagesStore(),{table:s.iU,id:e,spaceId:o.id});if(a.getStateFor(t))return t}))),c=new Set(l.map((e=>e.id)));let d;const u=t.getSharedPageStores(),p=0===u.length;if(p){d=J(e,o).filter((e=>{c.has(e.id)}))}else d=u.filter((e=>!(0,O.wf)(e)&&c.has(e.id)));(0,I.As)({use_legacy_shared_pages_ordering:p&&d.length>0});const m=[...d,...l];return f.mN(m,(e=>e.id))}return[]}async function K(e){const{disableRedirectUrl:t,environment:n}=e;await y.w();const{id:o}=n.currentUser,{url:r,spaceId:a,route:s}=await v.Ie(n),l=a?ee(a):void 0,m=function(e){const{environment:t,lastVisitedUrl:n}=e,o=t.RouterStore.state.initialRoute;if("page"===o.name)return{url:n,isPersonalHomeUrl:!1};return function(e){const{environment:t,lastVisitedUrl:n,lastVisitedSpaceView:o}=e,r=te(t,null==o?void 0:o.getModel());switch(r){case"last_visited_page":return n?{url:n,isPersonalHomeUrl:!1}:void 0;case"first_page":case"chat":return;case"personal_home":if(!o)return;const e=k.Al(o);if(!e)return;return{url:(0,E.ZP)({store:e,preferPublicLink:!1,pageVisitSource:i.tY.DefaultHome}),isPersonalHomeUrl:!0};default:(0,g.t1)(r)}}(e)}({environment:n,lastVisitedUrl:r,lastVisitedSpaceView:l}),_=null==m?void 0:m.url,S=h.qd(o),w=b.th(o),I=p.DD();if(!o)throw new Error("User not logged in.");const C=new P.U6(n,{table:c.KJ,id:o}),x=new P.r9(n,{table:d.dx,id:o}),T=new P.vO(n,{table:u.Sr,id:o}),[M,A]=await Promise.all([C.awaitNonNullValue(),x.awaitNonNullValue(),T.awaitNonNullValue()]),R=!!M&&Boolean(M.onboarding_completed),D=!!M&&Boolean(M.mobile_onboarding_completed),B=function(e,t){const n=(0,d.ao)(e);return n&&n.length>0?P.V9.createChildStore(t,n[0]):void 0}(A,x);B&&await B.load();const F=B?B.getSpaceStore():void 0;if(s&&!t){const e=await b.Jv({environment:n,request:{type:"block-space",...s}}).next();if(e.value){const t=e.value,n="page"===s.name?s.blockId:void 0,o=["read_and_write","comment_only","reader"].includes(t.publicAccessRole);if(t&&!f.xb(t)&&(t.canJoinSpace||t.userHasExplicitAccess||!o))return{userStore:C,userSettingsStore:T,userRootStore:x,firstSpace:F,firstSpaceView:B,lastVisitedSpaceView:l,redirectUrl:_,forkPageBlockId:S,publicAccessPageId:w,oauthAuthorizationParams:I,redirectPageId:n,hasExplicitAccessToRedirectPage:t.userHasExplicitAccess,redirectSpaceName:t.spaceName,redirectSpaceId:t.spaceId,canJoinRedirectSpace:t.canJoinSpace,onboardingCompleted:R,mobileOnboardingCompleted:D,isPersonalHomeRedirect:(null==m?void 0:m.isPersonalHomeUrl)??!1}}}return{userStore:C,userSettingsStore:T,userRootStore:x,firstSpace:F,firstSpaceView:B,lastVisitedSpaceView:l,forkPageBlockId:S,publicAccessPageId:w,oauthAuthorizationParams:I,redirectUrl:void 0,redirectPageId:void 0,hasExplicitAccessToRedirectPage:void 0,redirectSpaceId:void 0,canJoinRedirectSpace:void 0,onboardingCompleted:R,mobileOnboardingCompleted:D,redirectSpaceName:void 0,isPersonalHomeRedirect:!1}}function G(e,t){return P.t1.fromV1(t).getIcon()}function $(e,t){const n=t.getName(),o=B.default.getIntl().formatMessage({defaultMessage:"Untitled workspace",id:"spaceHelpers.getSpaceName.untitledWorkspace.name"});if(n)return n||o;{const n=M.Z.getData(e,{spaceId:t.id});if(n)return n.name||o}return o}function Q(e){return function(e){return(0,P.Vh)(e,{table:l.bx,id:e.id},"permissions")}(e).getValue()||[]}function Y(e,t){const n=e.currentUser.id,o=t.getPagesStore().getValue();if(o&&n){const e=R.Z.getSpaceInaccessiblePages(t.id,n);return e?o.filter((t=>!e.has(t))):o}return[]}function J(e,t){const n=t.getPagesStore();return Y(e,t).map((e=>P.G.createChildStore(n,{table:s.iU,id:e})))}function X(e,t,n){const o=M.Z.getData(e,{spaceId:t}),i=!Boolean(null==o?void 0:o.domainIsAutogenerated),r=f.oA([i&&(null==o?void 0:o.domain),"invite",n]).join("/");return`${S.default.domainBaseUrl}/${r}`}function ee(e){const{currentUserRootStore:t}=C.default.state;return null==t?void 0:t.getSpaceViewStores().find((t=>t.getSpaceId()===e))}function te(e,t){var n;const o=function(e,t){var n,o;if(null!==(n=e.mobileNative)&&void 0!==n&&n.supportsNativeHomeOnPhone())return{setting:"last_visited_page",fromExplicitSetting:!1};const i=null==t||null===(o=t.getSettings())||void 0===o?void 0:o.on_app_start;if((0,g.$K)(i))return{setting:i,fromExplicitSetting:!0};const{isPhone:r,isMobileNative:a}=e.device,s=!(r&&a||function(){const e=C.default.state.spaceTransitionStatus;let t;switch(e){case"joiningOrCreatingSpace":t=!0;break;case"switchingToOrLoadingSpace":case"notTransitioning":t=!1;break;default:(0,g.t1)(e)}return t||w.default.state.isOnboarding}());return{setting:s?"personal_home":"last_visited_page",fromExplicitSetting:!1}}(e,t);if("personal_home"!==o.setting)return o.setting;const i=null==t?void 0:t.getSpaceId(),r=null==t?void 0:t.getUserId(),a=!T.default.isStatsigEnabledAndInitialized()||!i||!r||i!==(null===(n=C.default.state.currentSpaceStore)||void 0===n?void 0:n.id)||r!==e.currentUser.id;let s;return s=o.fromExplicitSetting?a?function(e){var t;const n=null==e||null===(t=e.getPersonalHomeSettings())||void 0===t?void 0:t.home_landing_page_enabled;switch(n){case"home_landing_page_with_default":case"home_landing_page_without_default":return!0;case"no_home_landing_page":case void 0:return!1;default:(0,g.t1)(n)}}(t):(0,U.QI)():a?function(e){var t;const n=null==e||null===(t=e.getPersonalHomeSettings())||void 0===t?void 0:t.home_landing_page_enabled;switch(n){case"home_landing_page_with_default":return!0;case"home_landing_page_without_default":case"no_home_landing_page":case void 0:return!1;default:(0,g.t1)(n)}}(t):(0,U.MS)(),s?"personal_home":"last_visited_page"}function ne(e){return!!e&&!e.canRead()}function oe(e){return!!e&&e.getZeroRetentionEnabled()}function ie(e,t){const n=(0,D.CM)(t)||[],o=e.currentUser.id;for(const i of n)if(i.userId===o&&"none"===i.role&&i.isTeamGuest)return!0;return!1}function re(e){return!!e&&e.canAdmin()}function ae(e){let{spaceStore:t,groupId:n}=e;return((null==t?void 0:t.getPermissionGroups())||[]).find((e=>e.id===n))}function se(e){const t=C.default.state.currentSpaceStore,n=e.currentUser.id;return Boolean(t&&n&&t.getSpaceUserStore(n).isWorkspaceOwner())}function le(){const e=C.default.state.currentSpaceStore;return!(null==e||!e.isDefined())&&"enterprise"===e.getSubscriptionTier()}function ce(e){const t=e.getSubscriptionTier();return"plus"===t||"business"===t||"enterprise"===t}function de(e){const t=function(e){const t=null==e?void 0:e.getCreatedTime();return t?(0,r.O5)(t):null}(e);return null!==t&&t<=7}function ue(e){return(0,g.lm)(e)&&"none"!==e.role?e.planType:void 0}function pe(e){return(0,g.lm)(e)&&"none"!==e.role?e.createdTime:void 0}function me(e){return(0,g.lm)(e)&&"none"!==e.role?e.subscriptionTier:void 0}function fe(e){return T.default.checkGate("guest_invite_requests")&&(null==e?void 0:e.getEnableGuestInviteRequest())}function ge(e){return Boolean(fe(e))&&!Boolean(null==e?void 0:e.canAdmin())}function he(e){return e=e.toLowerCase(),e=T.default.checkGate("sites_domain_validation_allow_custom_hostname")?e.replace(/[^a-z0-9-\.]/g,""):e.replace(/[^a-z0-9-]/g,"")}function ve(){const e="on"===T.default.getEligibleGroup({experimentId:"read_persona_survey_data_from_space",defaultGroup:"control"}),{currentUserSettingsStore:t,currentSpaceStore:n,currentSpaceViewStore:o}=C.default.state;if(e){var i,r,a,s,l;const e=null==n?void 0:n.getSpaceSurveyData(),t=null==o?void 0:o.getUserSurveyData();return{function:null==t||null===(i=t.function)||void 0===i?void 0:i.value,role:(0,m.Bt)(null==t||null===(r=t.role)||void 0===r?void 0:r.value),useCases:null==e||null===(a=e.use_cases)||void 0===a?void 0:a.value,companySize:null==e||null===(s=e.company_size)||void 0===s?void 0:s.value,intent:(null==e||null===(l=e.intent)||void 0===l?void 0:l.value)??("planSelection"in w.default.state?w.default.state.planSelection:void 0)}}var c,d,u,p;return{intent:"planSelection"in w.default.state?w.default.state.planSelection:void 0,function:null==t||null===(c=t.getSettings())||void 0===c?void 0:c.persona,role:null==t||null===(d=t.getSettings())||void 0===d?void 0:d.team_role,useCases:null==t||null===(u=t.getSettings())||void 0===u?void 0:u.use_cases,companySize:null==t||null===(p=t.getSettings())||void 0===p?void 0:p.company_size}}},16639:(e,t,n)=>{n.d(t,{N5:()=>p,kF:()=>c,kQ:()=>d,rm:()=>u});var o=n(72141),i=n(19889),r=n(9291),a=n(53965),s=n(20454);const l=(0,r.defineMessages)({untitledGroupName:{defaultMessage:"Untitled",id:"spaceBasicSettings.spacePermissionsSettings.groupsTab.defaultNewGroupName"}});function c(e){const{intl:t,group:n}=e;return n.name||t.formatMessage(l.untitledGroupName)}function d(e){const{group:t,spaceStore:n}=e;return(t.user_ids||[]).filter((e=>null==n?void 0:n.getSpaceUserStore(e).isMember()))}function u(e){const{group:t,spaceStore:n,limit:o}=e,r=d({group:t,spaceStore:n}),l=r.length;if(!n)return{countRemainingUsers:0,totalNumberMembers:l,limitedUserStores:[]};const c=o?r.slice(0,o):r;return{limitedUserStores:a.oA(r.map((e=>s.U.createChildStore(n,{table:i.KJ,id:e})))),countRemainingUsers:r.length-c.length,totalNumberMembers:l}}function p(e){let{userStores:t,spaceStore:n,intl:i}=e;return a.MR(t,(e=>e.getSearchName(i))).sort(((e,t)=>{if(!n)return 0;const i=n.getSpaceUserStore(e.id).getMembershipTypeAsRoleOrNone(),r=n.getSpaceUserStore(t.id).getMembershipTypeAsRoleOrNone();return i&&r?o.Av.indexOf(r)-o.Av.indexOf(i):0}))}},15517:(e,t,n)=>{n.d(t,{ZL:()=>m,lr:()=>c,mn:()=>p,sK:()=>l});var o=n(68626),i=n(15157),r=n(19584),a=n(30021),s=n(46735);async function l(){if("storage"in navigator&&"estimate"in navigator.storage){const{quota:e,usage:t}=await navigator.storage.estimate();if("number"==typeof e&&"number"==typeof t)return{quota:e,usage:t}}if("webkitPersistentStorage"in navigator){const e=navigator.webkitPersistentStorage;if("queryUsageAndQuota"in e)return new Promise((t=>{e.queryUsageAndQuota(((e,n)=>{t("number"==typeof n&&"number"==typeof e?{usage:e,quota:n}:void 0)}),(()=>t(void 0)))}))}}async function c(){if(navigator.storage&&navigator.storage.persist)try{const e=await navigator.storage.persist();return o.clientLogglyEnvironmentData.isPersistent=e,e}catch(e){console.trace("Persistence is disabled",e)}}const d=.9,u=15*r.js;function p(e){const{quota:t,usage:n}=e;return n/t<=d&&t>=u}function m(e){const t=a.Z.state;e?(s.Z.clearForUser(e),i.Z.clearStorageForUser(e)):localStorage.clear(),a.Z.setState(t)}},75024:(e,t,n)=>{n.d(t,{Dp:()=>s,jy:()=>d,mK:()=>r,pd:()=>l,wK:()=>c,yv:()=>a});var o=n(1898),i=n(37810);const r={listStyleType:"none",padding:0,margin:0};i.Z.fontWeight.regular;function a(e,t){const n="UIRegular"===t?i.Z.fontSize.UIRegular:"UISmall"===t?i.Z.fontSize.UISmall:(0,o.t1)(t);return e.device.isMobile?n.mobile:n.desktop}function s(e,t){const n="UIRegular"===t?i.Z.lineHeight.UIRegular:"UISmall"===t?i.Z.lineHeight.UISmall:(0,o.t1)(t);return e.device.isMobile?n.mobile:n.desktop}function l(e){return{display:"-webkit-box",overflow:"hidden",WebkitBoxOrient:"vertical",WebkitLineClamp:e}}function c(e){let{topLeft:t,topRight:n,bottomLeft:o,bottomRight:i}=e;return[t,n,i,o].map((e=>e?`${e}px`:"0")).join(" ")}const d={position:"absolute",overflow:"hidden",clip:"rect(1px, 1px, 1px, 1px)",whiteSpace:"nowrap",height:1,width:1}},52315:(e,t,n)=>{function o(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.isReady())return!1;if(n[e.id])return!0;if(n[e.id]=!0,r(e,t))return!0;const i=e.getContentStores();let a=!0;for(const r of i)o(r,!1,n)||(a=!1);return a}async function i(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(await e.load(),n[e.id])return;if(n[e.id]=!0,r(e,t))return;const o=e.getContentStores();await Promise.all(o.map((e=>i(e,!1,n))))}function r(e,t){return!(!e.isPageBlock()||t)||!!e.isCollectionView()}n.d(t,{b:()=>o,r:()=>i})},32363:(e,t,n)=>{n.d(t,{ni:()=>u,wY:()=>c});n(67294);var o=n(44876),i=n(9291),r=n(1898),a=n(30874),s=n(33929),l=n(85893);function c(e,t){const n=function(e,t){if(!e)return;const n=(0,o.ny)({url:e,integrations:a.Z.integrations.state,currentSpaceId:t});if("success"!==n.type)return;return n.integration.name}(e),s=function(e,t){if(!e)return;const n=(0,o.ny)({url:e,integrations:a.Z.integrations.state,currentSpaceId:t});if("success"!==n.type)return;if(!n.pattern.collectionItemType)return;switch(n.pattern.collectionItemType){case"project":return(0,l.jsx)(i.FormattedMessage,{defaultMessage:"Project",id:"syncedCollectionIndicators.project.label"});case"pull_request":return(0,l.jsx)(i.FormattedMessage,{defaultMessage:"Pull Requests",id:"syncedCollectionIndicators.pullRequests.label"});case"issue":return(0,l.jsx)(i.FormattedMessage,{defaultMessage:"Issues",id:"syncedCollectionIndicators.issues.label"});case"calendar":return(0,l.jsx)(i.FormattedMessage,{defaultMessage:"Calendar",id:"syncedCollectionIndicators.calendar.label"});case"release":return(0,l.jsx)(i.FormattedMessage,{defaultMessage:"Releases",id:"syncedCollectionIndicators.releases.label"});default:(0,r.t1)(n.pattern.collectionItemType)}}(e,t);return s?n?(0,l.jsx)(i.FormattedMessage,{id:"syncedCollectionIndicators.originalUrlWithIntegration",defaultMessage:"{collectionType} in {integrationName}",values:{integrationName:n,collectionType:s}}):(0,l.jsx)("span",{children:n}):(0,l.jsx)(i.FormattedMessage,{defaultMessage:"Link to original url",id:"syncedCollectionIndicators.originalUrl"})}const d=(0,i.defineMessages)({github_pull:{defaultMessage:"Oauth Pull Request",id:"syncedCollectionIndicators.oauthGithubPullRequest.label"},github_issue:{defaultMessage:"Oauth Issue",id:"syncedCollectionIndicators.oauthGithubIssue.label"},Event:{defaultMessage:"Event",id:"syncedCollectionIndicators.event.label"},figma_file:{defaultMessage:"File",id:"syncedCollectionIndicators.figmaFile.label"},google_drive_file:{defaultMessage:"File",id:"syncedCollectionIndicators.googleDriveFile.label"},zendesk_ticket:{defaultMessage:"Ticket",id:"syncedCollectionIndicators.zendeskTicket.label"}});function u(e){const{pattern:t,integration:n}=e;return`${n.name} ${function(e){switch(e.name){case"Event":return s.default.formatMessage(d.Event);case"figma_file":return s.default.formatMessage(d.figma_file);case"github_pull":return s.default.formatMessage(d.github_pull);case"github_issue":return s.default.formatMessage(d.github_issue);case"google_drive_file":return s.default.formatMessage(d.google_drive_file);case"zendesk_ticket":return s.default.formatMessage(d.zendesk_ticket);default:return e.name}}(t)}`}},78122:(e,t,n)=>{n.d(t,{A8:()=>u,Bj:()=>b,Bt:()=>S,Fy:()=>g,T0:()=>m,Xg:()=>_,ZH:()=>p,hC:()=>y,hL:()=>v,iT:()=>f,wG:()=>h});n(67294);var o=n(9291),i=n(53965),r=n(1898),a=n(86080),s=n(47307),l=n(64369),c=n(95697),d=n(85893);async function u(e){let{isCurrentUser:t,teamName:n,memberName:i}=e;return await s.confirmUserAction({message:t?(0,d.jsx)(o.FormattedMessage,{defaultMessage:"Are you sure you want to leave {teamName}?",id:"teamActions.leaveTeam.confirmDialogMessage.removingYourself",values:{teamName:n}}):(0,d.jsx)(o.FormattedMessage,{id:"teamActions.leaveTeam.confirmDialogMessage.removingSomeoneElse",defaultMessage:"Are you sure you want to remove {memberName} from {teamName}?",values:{memberName:i,teamName:n}}),description:t?(0,d.jsx)(o.FormattedMessage,{id:"teamActions.leaveTeam.confirmDialogDescription.removingYourself",defaultMessage:"You'll no longer see this teamspace in your sidebar and you may lose permissions to the teamspace's pages."}):(0,d.jsx)(o.FormattedMessage,{id:"teamActions.leaveTeam.confirmDialogDescription.removingSomeoneElse",defaultMessage:"This change won't apply to any restricted pages in the teamspace."}),acceptLabel:t?(0,d.jsx)(o.FormattedMessage,{defaultMessage:"Leave Teamspace",id:"teamActions.leaveTeam.confirmDialogAcceptLabel.removingYourself"}):(0,d.jsx)(o.FormattedMessage,{defaultMessage:"Remove",id:"teamActions.leaveTeam.confirmDialogAcceptLabel"}),cancelLabel:(0,d.jsx)(o.FormattedMessage,{id:"teamActions.leaveTeam.confirmDialogCancelLabel.removingSomeoneElse",defaultMessage:"Cancel"})})}function p(){s.showMessage({message:(0,d.jsx)(o.FormattedMessage,{id:"teamActions.leaveTeam.onlyTeamMemberLeftDialogMessage",defaultMessage:"Invite another teamspace owner to leave this teamspace"})})}function m(e){s.showMessage({message:(0,d.jsx)(o.FormattedMessage,{id:"teamActions.leaveTeam.userMembershipFromGroupDialogMessage",defaultMessage:"You can't leave this teamspace because you're a member of {groupNames}.",values:{groupNames:i.oA(e.map((e=>`"${e.name}"`))).join(", ")}})})}function f(e){var t;let{group:n,onAccept:i}=e;s.showDialog({message:n.name?(0,d.jsx)(o.FormattedMessage,{id:"TeamSettings.groups.removeGroupModal.title",defaultMessage:"Are you sure you want to remove {groupName}?",values:{groupName:n.name}}):(0,d.jsx)(o.FormattedMessage,{id:"TeamSettings.groups.removeGroupModal.title.noGroupName",defaultMessage:"Are you sure you want to remove this group?"}),description:(0,d.jsx)(o.FormattedMessage,{id:"TeamSettings.groups.removeGroupModal.description",defaultMessage:"{numGroupMembers} {numGroupMembers, plural, one {member} other {members}} from this group will be removed from this teamspace.",values:{numGroupMembers:(null===(t=n.user_ids)||void 0===t?void 0:t.length)||0}}),showCancel:!0,keepFocus:!1,handleCancel:s.dismissDialog,items:[{label:(0,d.jsx)(o.FormattedMessage,{id:"TeamSettings.groups.removeGroupModal.confirmationButton",defaultMessage:"Remove group"}),color:"red",onAccept:i}]})}async function g(e,t){return await a.b({message:(0,d.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,d.jsx)(o.FormattedMessage,{id:"teamActions.archiveTeam.confirmDialogTitle",defaultMessage:"Are you sure you want to archive this teamspace?"}),(0,d.jsx)(l.Z,{isMultiline:!0,style:{marginTop:8},children:t?(0,d.jsx)(o.FormattedMessage,{id:"teamActions.archiveTeam.transitionToZeroTeams.confirmDialogDescription",defaultMessage:'This is your last default teamspace. Archiving will remove the "Teamspaces" section in your sidebar. Type the teamspace name to confirm.'}):(0,d.jsx)(o.FormattedMessage,{id:"teamActions.archiveTeam.confirmDialogDescription",defaultMessage:"Archiving this teamspace will remove access and hide it in the sidebar for all teamspace members. Type the teamspace name to confirm."})})]}),acceptLabel:(0,d.jsx)(o.FormattedMessage,{id:"teamActions.archiveTeam.confirmDialogAcceptLabel",defaultMessage:"Archive teamspace"}),requiredInputValue:e})}async function h(e){return await s.confirmUserAction({message:(0,d.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:(0,d.jsx)(o.FormattedMessage,{id:"teamActions.movePagesFromArchivedTeam.confirmDialogTitle",defaultMessage:'Would you like to move pages under {teamName} to the "Private" and "Shared" sections in your sidebar?',values:{teamName:e}})}),acceptLabel:(0,d.jsx)(o.FormattedMessage,{id:"teamActions.movePagesFromArchivedTeam.confirmDialogAcceptLabel",defaultMessage:"Move pages"}),cancelLabel:(0,d.jsx)(o.FormattedMessage,{id:"teamActions.movePagesFromArchivedTeam.confirmDialogCancelLabel",defaultMessage:"Proceed without moving pages"})})}async function v(e){let{teamName:t,currentIsDefault:n,accessLevel:i,isDefault:a,numberOfTeamGuests:l}=e;const c=(0,d.jsx)("div",{style:{marginTop:8},children:(0,d.jsx)(o.FormattedMessage,{id:"teamActions.confirmTeamAccessDialog.disableDefaultTeamLabel",defaultMessage:"{teamName} will also no longer be a default teamspace and auto-add workspace members.",values:{teamName:t}})});let u,p;return"private"===i?(u=(0,d.jsx)(o.FormattedMessage,{defaultMessage:"Are you sure you want to make {teamName} private?",id:"teamActions.confirmTeamAccessChangeDialog.privateTeam.titleWithName",values:{teamName:t}}),p=(0,d.jsxs)("div",{children:[(0,d.jsx)(o.FormattedMessage,{id:"teamActions.teamScreen.privateTeam.description",defaultMessage:"Only members will be able to see the teamspace and its content."}),n&&c]})):a?l>0?(u=(0,d.jsx)(o.FormattedMessage,{id:"teamActions.confirmTeamAccessChangeDialog.defaultTeamWithGuests.titleWithName",defaultMessage:"Are you sure you want to make {teamName} a default teamspace?",values:{teamName:t}}),p=(0,d.jsx)(o.FormattedMessage,{id:"teamActions.teamScreen.defaultTeamWithGuests.description",defaultMessage:"Everyone in the workspace and future workspace members will be added to this teamspace. Additionally, {numberOfTeamGuests} teamspace guests will be removed.",values:{numberOfTeamGuests:l}})):(u=(0,d.jsx)(o.FormattedMessage,{id:"teamActions.confirmTeamAccessChangeDialog.defaultTeam.titleWithName",defaultMessage:"Are you sure you want to make {teamName} a default teamspace?",values:{teamName:t}}),p=(0,d.jsx)(o.FormattedMessage,{id:"teamActions.teamScreen.defaultTeam.description",defaultMessage:"Everyone in the workspace and future workspace members will be added to this teamspace."})):"open"===i?(u=(0,d.jsx)(o.FormattedMessage,{defaultMessage:"Are you sure you want to make {teamName} open?",id:"teamActions.confirmTeamAccessChangeDialog.openTeam.titleWithName",values:{teamName:t}}),p=(0,d.jsxs)("div",{children:[!n&&(0,d.jsx)(o.FormattedMessage,{id:"teamActions.teamScreen.openTeam.description",defaultMessage:"Everyone in the workspace will have access to the teamspace and its content."}),n&&c]})):"closed"===i?(u=(0,d.jsx)(o.FormattedMessage,{defaultMessage:"Are you sure you want to make {teamName} closed?",id:"teamActions.confirmTeamAccessChangeDialog.closedTeam.titleWithName",values:{teamName:t}}),p=(0,d.jsxs)("div",{children:[(0,d.jsx)(o.FormattedMessage,{id:"teamActions.teamScreen.closedTeam.description",defaultMessage:"The teamspace will still be discoverable, but joining will be invite-only."}),n&&c]})):(0,r.t1)(i),await s.confirmUserAction({message:u,description:p})}async function b(e){let t;switch(e){case"disable_guests":t=(0,d.jsx)(o.FormattedMessage,{id:"teamSettings.disableGuests.confirmationTitle",defaultMessage:"Are you sure? All page guests in this teamspace will be removed."});break;case"disable_public_access":t=(0,d.jsx)(o.FormattedMessage,{id:"teamSettings.disablePublicPages.confirmationTitle",defaultMessage:"Are you sure? This will remove access for anyone who is not a member or guest of the workspace from all pages in this teamspace."});break;case"disable_export":case"disable_team_page_edits":return!0;default:(0,r.t1)(e)}return await s.confirmUserAction({message:t})}async function y(e){let t;switch(e){case"disable_guests":t=(0,d.jsx)(o.FormattedMessage,{id:"teamSettings.disableGuestsOverride.confirmationTitle",defaultMessage:"Are you sure you want to allow guests on this teamspace? By default, guests are not allowed on teamspaces in this workspace."});break;case"disable_public_access":t=(0,d.jsx)(o.FormattedMessage,{id:"teamSettings.disablePublicPagesOverride.confirmationTitle",defaultMessage:"Are you sure you want to allow teamspace pages to be made public? By default, pages in this workspace cannot be made public."});break;case"disable_export":t=(0,d.jsx)(o.FormattedMessage,{id:"teamSettings.disableExportOverride.confirmationTitle",defaultMessage:"Are you sure you want to allow teamspace pages to be exported? By default, pages in this workspace cannot be exported."});break;case"disable_team_page_edits":return!0;default:(0,r.t1)(e)}return await s.confirmUserAction({message:t,acceptLabel:(0,d.jsx)(o.FormattedMessage,{id:"teamSettings.workspaceSettingOverride.confirmationButtonLabel",defaultMessage:"Override workspace setting"})})}async function _(e){let{environment:t,spaceStore:n,teamName:i}=e;const r=t.currentUser.id;if(!r||!n)return!0;return!(await(0,c.F0)({environment:t,spaceStore:n,currentUserId:r})).some((e=>{var t;return(null===(t=e.getName())||void 0===t?void 0:t.trim())===i.trim()}))||await s.confirmUserAction({message:(0,d.jsx)(o.FormattedMessage,{id:"teamSettings.confirmDuplicateTeamName.message",defaultMessage:"A teamspace with the same name already exists. Are you sure you want to name this teamspace â€œ{teamName}â€?",values:{teamName:i}}),cancelLabel:(0,d.jsx)(o.FormattedMessage,{id:"teamSettings.confirmDuplicateTeamName.cancelLabel",defaultMessage:"Cancel"})})}async function S(){return await s.confirmUserAction({message:(0,d.jsx)(o.FormattedMessage,{id:"teamSettings.setTeamPermissions.ClearCustomTeamPermissionsDialogMessage",defaultMessage:"Raising the permission level for all teamspace members will remove some custom permissions. Are you sure you want to proceed?"}),cancelLabel:(0,d.jsx)(o.FormattedMessage,{id:"teamSettings.setTeamPermissions.cancelLabel",defaultMessage:"Cancel"})})}},21115:(e,t,n)=>{n.d(t,{$$:()=>u,CC:()=>g,JB:()=>h,K9:()=>m,Ke:()=>v,_t:()=>d,e6:()=>p,zs:()=>f});var o=n(9291),i=n(64964),r=n(1310),a=n(19306),s=n(33929);const l=(0,o.defineMessages)({leftTeam:{id:"teamPermissionsActions.leftTeam",defaultMessage:"Left {teamName}"},leftTeamNoName:{id:"teamPermissionsActions.leftTeamNoName",defaultMessage:"Left team"},leftYetStillInTeam:{id:"teamPermissionsActions.leftYetStillInTeam",defaultMessage:"You are still in {hasTeamName, select, true {{teamName}} other {the team}} because you are a member of the following groups: {groupsString}"},removedYetStillInTeam:{id:"teamPermissionsActions.removedYetStillInTeam",defaultMessage:"{hasMemberName, select, true {{memberName}} other {The removed user}} is still in {hasTeamName, select, true {{teamName}} other {the team}} because they are a member of the following groups: {groupsString}"},joinedTeam:{id:"teamPermissionsActions.joinedTeam",defaultMessage:"Joined {teamName}"},joinedTeamUsingAdminPrivileges:{id:"teamPermissionsActions.joinedTeamUsingAdminPrivileges",defaultMessage:"Joined {teamName} using admin privileges"},upgradedSelfToOwner:{id:"teamPermissionsActions.upgradedSelfToOwnerUsingAdminPrivileges",defaultMessage:"Became owner of {teamName} using admin privileges"},archivedTeam:{id:"teamPermissionsActions.archivedTeam",defaultMessage:"Archived {teamName}"},restoredTeam:{id:"teamPermissionsActions.restoredTeam",defaultMessage:"Restored {teamName}"},restoredTeamNoName:{id:"teamPermissionsActions.restoredTeamNoName",defaultMessage:"Restored team"},duplicatedTeam:{id:"teamPermissionsActions.duplicatedTeam",defaultMessage:"Duplicated {teamName}"},duplicatedTeamNoName:{id:"teamPermissionsActions.duplicatedTeamNoName",defaultMessage:"Duplicated teamspace"}});function c(e,t,n){const o=s.default.formatMessage(e,{...t});i.oV({label:o,durationMs:n})}function d(e){return c(l.upgradedSelfToOwner,{teamName:e})}function u(e){let{teamName:t,usingAdminPrivileges:n}=e;return c(n?l.joinedTeamUsingAdminPrivileges:l.joinedTeam,{teamName:t})}function p(e){return e?c(l.leftTeam,{teamName:e}):c(l.leftTeamNoName)}function m(e,t){const n=(0,a.W)(t.flatMap((e=>e.name||[])));c(l.leftYetStillInTeam,{hasTeamName:void 0!==e,teamName:e,groupsString:n},r.JY)}function f(e,t,n){const o=(0,a.W)(n.flatMap((e=>e.name||[])));c(l.removedYetStillInTeam,{hasMemberName:void 0!==e,hasTeamName:void 0!==t,memberName:e,teamName:t,groupsString:o},r.JY)}function g(e){return c(l.archivedTeam,{teamName:e})}function h(e){return e?c(l.restoredTeam,{teamName:e}):c(l.restoredTeamNoName)}function v(e){return e?c(l.duplicatedTeam,{teamName:e}):c(l.duplicatedTeamNoName)}},95697:(e,t,n)=>{n.d(t,{q9:()=>ce,$r:()=>ae,ZN:()=>se,oI:()=>L,Xq:()=>Y,KP:()=>re,W8:()=>de,Pr:()=>J,qX:()=>q,F0:()=>G,sj:()=>W,tu:()=>ge,wP:()=>me,Mf:()=>H,xo:()=>ie,xf:()=>oe,ku:()=>U,AL:()=>ne,MS:()=>F,QI:()=>O,U2:()=>ue,bq:()=>z,Hu:()=>Q,tV:()=>pe,C2:()=>$,dY:()=>fe,$:()=>ee,Gc:()=>N,OX:()=>te});n(57658);var o=n(480),i=n(86628),r=n(14577),a=n(37850);const s=Symbol("unset");class l{constructor(e){this.timeoutMs=void 0,this.fetch=void 0,this.useLastValue=void 0,this.promise=void 0,this.lastFetched=void 0,this.lastValue=void 0,this.changeTrigger=a.UZ();const{timeoutMs:t,fetch:n,useLastValue:o}=e;this.timeoutMs=t,this.fetch=n,this.promise=void 0,this.useLastValue=o,this.lastValue=s}async getWithState(){if(this.isReady()&&this.lastValue!==s)return{value:this.lastValue,state:"cached"};if(this.promise)return{value:await this.promise,state:"cached"};this.promise=this.fetch().catch((e=>{if(this.useLastValue&&this.lastValue!==s)return this.lastValue;throw e}));try{const e=await this.promise;return this.lastFetched=Date.now(),e!==this.lastValue&&(this.changeTrigger.resolve(e),this.changeTrigger=a.UZ()),this.lastValue=e,{value:e,state:"fetched"}}finally{this.promise=void 0}}async get(){const{value:e}=await this.getWithState();return e}isReady(){const e=Date.now();return Boolean(this.lastFetched&&this.lastValue!==s&&this.lastFetched>e-this.timeoutMs)}waitUntilChange(){return this.changeTrigger.promise}}var c=n(68626),d=n(87479),u=n(72141),p=n(45953),m=n(29369),f=n(19889),g=n(64684),h=n(9291),v=n(53965),b=n(1898),y=n(54642),_=n(95477),S=n(38676),w=n(80444),k=n(77080),I=n(45483),C=n(6258),x=n(30397),T=n(88893),M=n(88280),P=n(60396),A=n(28020),R=n(4708),D=n(15010),E=n(46654),B=n(48779);function F(){return!!O()&&(!!k.default.checkGate("sidebar_home_default_landing_gate")&&(!!O("dev_or_beta")||V({requireDefaultStartPageVariant:!0})))}function O(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dev_beta_and_ga";const{currentSpaceStore:t,currentUserStore:n}=w.default.state,o=(null==t?void 0:t.getMemberCountFromPublicSpaceData())||null;if(!n||!t)return!1;const i=null==t?void 0:t.getSpaceUserStore(n.id);if(null==i||!i.isMember())return!1;const r=Z({type:"dev_or_beta"}),a=t.isHomeEnabled();return(r||a||null!==o&&o>1)&&Z({type:e})}function Z(e){let{type:t}=e;switch(t){case"dev_only":return k.default.checkGate("sidebar_home_dev_gate");case"dev_or_beta":return k.default.checkGate("sidebar_home_dev_gate")||k.default.checkGate("sidebar_home_beta_gate");case"dev_beta_and_ga":return k.default.checkGate("sidebar_home_dev_gate")||k.default.checkGate("sidebar_home_beta_gate")||V({requireDefaultStartPageVariant:!1});default:(0,b.t1)(t)}}function V(e){let{requireDefaultStartPageVariant:t}=e;if(!k.default.checkGate("sidebar_home_ga_gate"))return!1;const n=k.default.getGroup("sidebar_home_multiplayer_ga");switch(n){case"control":return!1;case"home":return!t;case"home_with_default":return!0;default:(0,b.t1)(n)}}function U(){return k.default.checkGate("sidebar_pages_hide_toggles")}function L(){return _.default.isAdminMode||!1}const j=v.HP((()=>new r.Z((()=>{const{currentSpaceStore:e}=w.default.state;return!!e&&e.isTeamsEnabled()}),{debugName:"teamsEnabledStore"})));function N(){return(0,i.VK)((()=>j().state),[])}function z(){return j().state}async function q(e){let{environment:t,spaceStore:n,includeArchived:o=!1,currentUserId:i}=e;const r=await y.getTeams(t,{spaceId:n.id,includeArchived:o},i);return"failed"===r.type?(c.rateLimitedLog({from:"teamsHelpers",level:"error",type:"getTeamsFailed"}),[]):r.data.teamIds.map((e=>C.zX.createChildStore(n,{table:m.e0,id:e})))}async function W(e){let{spaceStore:t,currentUserId:n,includeArchived:o,minRoleOnTeamStores:i,environment:r}=e;if(!t||!n)return[];const a=await y.getAllTeamsInSpaceForAdmin(r,{spaceId:t.id,includeArchived:o},n);if("failed"===a.type)return[];const s=a.data.teamIds.map((e=>C.zX.createChildStore(t,{table:m.e0,id:e}))),l=[],c=[];for(const p of s){const e=p.getRole()??"none";(0,d.gr)(e,i)?c.push(p.id):l.push(p)}const u=p.Ak.create(a.data.recordMap);P.Z.initialize({environment:r,userId:n,spaceId:t.id,teamIds:a.data.teamIds,getRecordWithRole:e=>({role:i,value:u.getValue(e)})});const f=c.map((e=>P.Z.createTeamStoreFromCache({environment:r,teamId:e,spaceId:t.id,userId:n}))).filter(b.$K);return[...l,...f]}function H(e){return x.Z.state.teams.filter((t=>t.isMemberOrGuest(e)))}const K=new Map;async function G(e){let{environment:t,spaceStore:n,includeArchived:o=!1,currentUserId:i}=e;const r=`${n.id}:${o}`,a=K.get(r);if(a)return a.get();const s=new l({timeoutMs:3e4,fetch:async()=>q({environment:t,spaceStore:n,includeArchived:o,currentUserId:i}),useLastValue:!0});return K.set(r,s),s.get()}function $(e){return!!e&&"private"===(0,g.B5)(e)}function Q(e){return e&&(0,g.jI)(e)}function Y(e){let{environment:t,spaceStore:n}=e;return!!n&&(!(0,B.Cx)(n)&&((0,B.Fn)(t)||!n.getDisableTeamCreation()))}function J(e){const t=(0,E.YO)(e).map((e=>e.permissionItem)),n=t.find(u.ix),o=(null==n?void 0:n.role)??"none",i=(0,T.Io)().reduce(((e,t)=>(e.add(t.userId),e)),new Set),r=t.filter((e=>!(!(0,u.jg)(e)||!i.has(e.user_id))||!!(0,u.hV)(e))),a=function(e){if(0===e.length)return;return e.reduce(((e,t)=>(0,d.SL)(t,e)?t:e),e[0])}(r.map((e=>e.role)))??"read_and_write";return{accessLevel:"none"===o?"private":"closed",spacePermissionRole:o,teamPermissionRole:(0,d.nl)(a,o),members:r.map((e=>{const{type:t}=e;return"user_permission"===t?{entity_type:"user",type:"member",user_id:e.user_id}:"group_permission"===t?{entity_type:"group",type:"member",group_id:e.group_id}:void(0,b.t1)(t)}))}}function X(e){let{environment:t,currentSpaceStore:n,subscriptionData:o}=e;return!!n&&(!t.device.isMobile&&!n.isTeamsEnabled()&&!(0,T.wY)(o)&&(0,B.lQ)(n))}function ee(e){const{currentSpaceStore:t}=w.default.state;return X({environment:e,currentSpaceStore:t,subscriptionData:M.subscriptionDataStoreInstance.state})}function te(){const e=(0,o.O7)();return(0,i.VK)((()=>{const{currentSpaceStore:t}=w.default.state,n=M.subscriptionDataStoreInstance.state;return X({environment:e,currentSpaceStore:t,subscriptionData:n})}),[e])}function ne(e){let{teamStore:t,spaceStore:n,userId:o}=e;return!!(t.isDefined()&&null!=n&&n.isDefined()&&o)&&(0,g.AL)({team:{is_default:t.isDefault(),membership:t.getMembers()},spaceValue:{permissions:n.getPermissionItems(),permission_groups:n.getPermissionGroups()},userId:o})}function oe(e){let{teamStore:t,spaceStore:n}=e;return null!=n&&n.isDefined()?(0,g.xf)({team:{is_default:t.isDefault(),membership:t.getMembers()},space:n.getModel()}):[]}function ie(){return x.Z.state.teams.flatMap((e=>e.getTeamPages()))}function re(e,t){return e.isDefault()?-1:t.isDefault()?1:0}const ae=["owner","member"],se=["owner","member","team_level_guest"],le=(0,h.defineMessages)({ownerLabel:{id:"teamPermissionsMenu.ownerItem.label",defaultMessage:"Teamspace owner"},ownerCaption:{id:"teamPermissionsMenu.ownerItem.caption",defaultMessage:"Can edit teamspace settings and full access to teamspace pages."},memberLabel:{id:"teamPermissionsMenu.memberItem.label",defaultMessage:"Teamspace member"},memberCaption:{id:"teamPermissionsMenu.memberItem.caption",defaultMessage:"Cannot edit teamspace settings and can access teamspace pages."},guestLabel:{id:"teamPermissionsMenu.guestItem.label",defaultMessage:"Teamspace guest"},guestCaption:{id:"teamPermissionsMenu.guestItem.caption",defaultMessage:"Only has access to invited teamspaces."}}),ce={owner:{label:le.ownerLabel,caption:le.ownerCaption},member:{label:le.memberLabel,caption:le.memberCaption},team_level_guest:{label:le.guestLabel,caption:le.guestCaption}};function de(e){return`${_.default.domainBaseUrl}/team/${e}/join`}function ue(e){var t;return!(null===(t=e.getSettings())||void 0===t||!t.disable_invite_link)}function pe(e){const t=[],n=[];for(const o of e)o.isDefined()&&(void 0===o.getArchivedBy()?n.push(o):t.push(o));return{archivedTeams:t,unarchivedTeams:n}}function me(e){const t=(0,D.WD)(e);if(!t)return!1;const n=t.getKeyStore("settings").getKeyStore("seen_team_add_app_template_tooltip_at").getValue();return void 0!==n&&n>0}function fe(e){let{environment:t,teamId:n}=e;const o=Boolean(S.sidebarExpandedStore.state);return(0,R.B9)()&&w.default.state.inAppCalloutStore.canShow("team_add_app_template_tooltip")&&!me(t)&&0===I.Z.state.openModals.size&&o&&function(e){var t;let{environment:n,teamId:o}=e;const i=((null===(t=(0,A.k_)(n).getState())||void 0===t?void 0:t.userJoinedTeamsStores)??[]).find((e=>{const t=e.getTeamPagesStores().filter((e=>{var t;return Boolean(null===(t=e.getCollectionStore())||void 0===t?void 0:t.getDatabaseType())}));return e.canAddOrRemoveTopLevelPages()&&t.length<2}));return!!i&&i.id===o}({environment:t,teamId:n})}function ge(e){let{currentUserStore:t,currentSpaceStore:n,teamStore:o,members:i}=e;return v.oA(i.map((e=>{const{entity_type:i}=e;return"user"===i?function(e){let{currentUserStore:t,teamStore:n,member:o}=e;if(!t)return;const i=he({teamStore:n,member:o}),r=C.U6.createChildStore(t,{table:f.KJ,id:o.user_id});return{type:"user",memberInfo:o,permissionItem:{type:"user_permission",user_id:o.user_id,role:i},userStore:r}}({currentUserStore:t,teamStore:o,member:e}):"group"===i?function(e){let{currentSpaceStore:t,teamStore:n,member:o}=e;const i=(0,B.TC)({spaceStore:t,groupId:o.group_id});if(!i)return;const r=he({teamStore:n,member:o});return{type:"group",memberInfo:o,permissionItem:{type:"group_permission",group_id:i.id,role:r},permissionGroup:i}}({currentSpaceStore:n,teamStore:o,member:e}):void(0,b.t1)(i)})))}function he(e){let{teamStore:t,member:n}=e;const o=t.getPermissionItems();if(!o)return"none";const i=function(e){let{permissions:t,member:n}=e;const o=null==t?void 0:t.find((e=>(0,u.hV)(e)&&"group"===n.entity_type&&e.group_id===n.group_id||(0,u.jg)(e)&&"user"===n.entity_type&&n.user_id===e.user_id));return null==o?void 0:o.role}({permissions:o,member:n});return i||(0,g.xC)({id:t.id,permissions:t.getPermissionItems()})}},60846:(e,t,n)=>{n.d(t,{D$:()=>l,JZ:()=>c,NL:()=>s,UZ:()=>d});n(21703);var o=n(52027),i=n.n(o),r=n(15095);const a=new(i()),{DIFF_DELETE:s,DIFF_INSERT:l,DIFF_EQUAL:c}=i();function d(e,t){const n=u(e,{count:0,encoding:{},decoding:{}}),o=n.encodedString,i=u(t,n.cypher),r=i.encodedString,s=i.cypher,l=function(e,t){return e.map((e=>{let[n,o]=e;return[n,p(o,t)]}))}(a.diff_main(o,r),s);return l.filter((e=>{let[t,n]=e;return""!==n}))}function u(e,t){const n=r.p4(e).map((e=>{const n=t.encoding[e];if(n)return n;{const n=String.fromCharCode(t.count);return t.count++,t.encoding[e]=n,t.decoding[n]=e,n}}));if(t.count>65535)throw new Error("This string has way too many different characters.");const o=n.join("");return{cypher:t,encodedString:o}}function p(e,t){return e.split("").map((e=>t.decoding[e])).join("")}},31352:(e,t,n)=>{n.d(t,{O2:()=>a,Ye:()=>c,ug:()=>s,zK:()=>l});var o=n(15095),i=n(70203),r=n(53965);function a(e,t,n){const a=e.getValue(),s=i.eeV(t),l=i.eeV(a);if(0===s.length&&0===l.length)return""===n?{filter:{startIndex:0,endIndex:0}}:void 0;const c=r.d9(s).reverse(),d=r.d9(l).reverse(),u=l.findIndex(((e,t)=>e!==s[t])),p=d.findIndex(((e,t)=>e!==c[t]));if(-1===u||-1===p)return;const m=o.p4(n),f={filter:{startIndex:u+(m.length>0?1:0),endIndex:u+l.length-s.length}};if(m.length>0){const e=f.filter.startIndex-m.length,t=f.filter.startIndex;l.slice(e,t).join("")===n&&(f.prefix={startIndex:e,endIndex:t})}return f}function s(e,t){if(!t)return;const n=e.getValue();return i.eeV(n).slice(t.filter.startIndex,t.filter.endIndex).join("")}function l(e,t,n){return s(e,a(e,t,n?"@":""))}function c(e,t,n,o,a){if(void 0===e)return!0;if(t&&0===n&&o>3)return!0;if(1===e.length){const t=r.Z$(e);if(t){if(/\s/g.test(t)){const e=a.getValue();if(e&&1===e.length){const t=i.QaF(e);return!(2===t.length&&t.startsWith("/"))}}}}else if(e.length>=2){return e.endsWith("  ")}return!1}},89224:(e,t,n)=>{n.r(t),n.d(t,{areRangesEqual:()=>E,clear:()=>w,containerOffsetIsBetweenNodes:()=>R,get:()=>v,getIncompleteDOMEndpoint:()=>_,getRect:()=>k,getSelectionRect:()=>I,isExpanded:()=>T,isMouseRightClicking:()=>j,isMouseSelecting:()=>L,rangeFromContainerOffsets:()=>M,rangeFromPoint:()=>C,rangeToContainerOffsets:()=>A,resetMouseRightClicking:()=>N,selectionIsBackwards:()=>Z,set:()=>b,setDOMEndpoint:()=>S,setOnNode:()=>x,snapContainerOffsetToNode:()=>D,startListeners:()=>O,toStaticRange:()=>P});n(21703);var o=n(55010),i=n(45060),r=n(1302),a=n(92595),s=n(68626),l=n(57347),c=n(53965),d=n(15723);const u=!1;new WeakMap;let p;const m=c.HP((()=>window.__isElectron?f:()=>window))();function f(){return!p||window.document.hasFocus()?(g("getWindow(): Returning main window because it has focus."),window):p?(g("getWindow(): Returning focused child window."),p):(g("getWindow(): Returning main window because nothing has focus"),window)}function g(){u&&console.log(...arguments)}var h=n(73744);function v(){const e=m().getSelection();if(e&&e.rangeCount>0){return e.getRangeAt(0)}}function b(e,t){y.reset();const n=window.getSelection();if(n){if(!(t.isFirefox&&parseFloat(t.browserVersion)<92))try{return function(e,t){const{focus:n,anchor:o}=A(t);e.collapse(o.container,o.offset),e.extend(n.container,n.offset)}(n,e)}catch(o){s.log({from:"textSelection",type:"textSelectionSet",level:"error",error:(0,l.t)(o)})}return function(e,t){const n=document.createRange();n.setStart(t.startContainer,t.startOffset),n.setEnd(t.endContainer,t.endOffset),e.removeAllRanges(),e.addRange(n)}(n,e)}}const y=new class{constructor(e){this.state=void 0,this.debugName=e,(0,a.exposeDebugInstance)("endpointLatch",this)}complete(e){if(this.state&&this.state.endpoint!==e.endpoint&&this.state.onlyIfEqual===e.onlyIfEqual){const t="start"===this.state.endpoint?this.state:e,n="end"===this.state.endpoint?this.state:e;return this.state=void 0,{start:t,end:n}}if(this.state){let t=`${this.debugName}: cannot complete latch:`;const n=this.state.endpoint===e.endpoint,o=this.state.onlyIfEqual!==e.onlyIfEqual;n&&(t+=` same endpoint ${e.endpoint}`),o&&(t+=" different tokens"),s.log({level:"warning",from:"EndpointLatch",type:"cannotCompleteLatch",data:{name:this.debugName,message:t,miscDataToConvertToString:{sameEndpoint:n,differentTokens:o}}})}this.state=e}reset(){this.state&&(s.log({level:"warning",from:"EndpointLatch",type:"resetPartialLatch",data:{name:this.debugName,message:`reset latch with endpoint ${this.state.endpoint}`}}),this.state=void 0)}}("domSelection");function _(){return y.state}function S(e,t){const n=y.complete(e);if(!n)return;const{start:o,end:i}=n;b(M({start:o.position,end:i.position}),t)}function w(e){y.reset();const t=window.getSelection();t&&(e.device.isMobile&&e.device.isAndroid?t.collapse(null,void 0):t.removeAllRanges())}function k(e){if(e){if(e.collapsed&&e.getClientRects){const t=c.Go(e.getClientRects()[0]);if(!c.xb(t))return t}else if(e.getBoundingClientRect){const t=c.Go(e.getBoundingClientRect());if(!c.xb(t))return t}if(e.startContainer.nodeType===Node.ELEMENT_NODE){if(0===e.startOffset){const t=e.startContainer.getBoundingClientRect();return new d.iL(t.left,t.top,0,t.height)}const t=e.startContainer.childNodes[e.startOffset-1];if(t&&t.nodeType===Node.ELEMENT_NODE){const e=t.getBoundingClientRect();return new d.iL(e.left,e.top,0,e.height)}const n=e.startContainer.childNodes[e.startOffset];if(n&&n.nodeType===Node.ELEMENT_NODE){const e=n.getBoundingClientRect();return new d.iL(e.left,e.top,0,e.height)}}}}function I(){const e=v();if(e)return k(e)}function C(e,t){if(document.caretRangeFromPoint){return document.caretRangeFromPoint(e,t)??void 0}if(document.caretPositionFromPoint){const n=document.caretPositionFromPoint(e,t),o=document.createRange();return o.setStart(n.offsetNode,n.offset),o.setEnd(n.offsetNode,n.offset),o}throw new Error("Browser does not support method caretRangeFromPoint or caretPositionFromPoint")}function x(e,t){const n=document.createRange();n.selectNode(e),b(n,t)}function T(e){return Boolean(e&&!e.collapsed)}function M(e){const{start:t,end:n}=e,o=document.createRange();if(t.container)try{o.setStart(t.container,t.offset)}catch(i){console.info(i)}if(n.container)try{o.setEnd(n.container,n.offset)}catch(i){console.info(i)}return o}function P(e){if(!e)return;const{startContainer:t,startOffset:n,endContainer:o,endOffset:i,collapsed:r}=e;return{startContainer:t,startOffset:n,endContainer:o,endOffset:i,collapsed:r}}function A(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z();const n={container:e.startContainer,offset:e.startOffset},o={container:e.endContainer,offset:e.endOffset},[i,r]=t?[n,o]:[o,n];return{start:n,end:o,focus:i,anchor:r}}function R(e,t,n){if(!t&&!n)return!1;if(!t&&n){const t=document.createRange();return t.selectNode(n),-1===t.comparePoint(e.container,e.offset)}if(t&&!n){const n=document.createRange();return n.selectNode(t),1===n.comparePoint(e.container,e.offset)}if(t&&n){const o=document.createRange();return o.setStartAfter(t),o.setEndBefore(n),0===o.comparePoint(e.container,e.offset)}return!1}function D(e){const{nodesInDomOrder:t,containerOffset:n,snapTowards:o}=e;for(let i=0;i<=t.length;i++){const e=t[i-1],r=t[i];if(R(n,null==e?void 0:e.node,null==r?void 0:r.node))return"start"===o?e:r}}function E(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset&&e.collapsed===t.collapsed}const B=new class{constructor(){this.currentHasNonEmptySelection=!1,this.currentIsBackwards=void 0,this.mouseDownSelection=void 0}selectionIsBackwards(){return Boolean(this.currentHasNonEmptySelection&&this.currentIsBackwards)}updateSelectionDirection(e,t){if(!e||!t||t.collapsed)return this.currentHasNonEmptySelection=!1,void(this.currentIsBackwards=void 0);if(this.currentHasNonEmptySelection=!0,void 0===this.currentIsBackwards){const n=1===t.startContainer.childNodes.length&&t.startContainer.childNodes[0].TEXT_NODE&&t.startContainer.childNodes[0]===e.startContainer;if(e.startContainer===t.startContainer||n)this.currentIsBackwards=t.startOffset<e.startOffset;else{const n=(0,o.Z)(t.startContainer,e.startContainer);this.currentIsBackwards=-1===n}}}startListeners(){window.addEventListener("mousedown",(()=>{r.default.afterNextFlush((()=>{this.mouseDownSelection=v()}))})),window.addEventListener("mouseup",(()=>{r.default.afterNextFlush((()=>{const e=v();this.updateSelectionDirection(this.mouseDownSelection,e)}))})),window.addEventListener("keydown",(()=>{const e=v();r.default.afterNextFlush((()=>{const t=v();this.updateSelectionDirection(e,t)}))}))}},F=new class{constructor(){this.mouseDown=!1,this.keysDown=0,this.wasBackwards=!1,this.device=void 0,this.debugDrawRects=()=>{const e=v();if(T(e)){const{focus:t,anchor:n}=A(e,this.wasBackwards),o=k(M({start:t,end:t}));o&&(0,i.yX)(o,"FOCUS","red");const r=k(M({start:n,end:n}));r&&(0,i.yX)(r,"ANCHOR","blue")}},this.handleSelectionChange=()=>{var e;(this.mouseDown||this.keysDown||null!==(e=this.device)&&void 0!==e&&e.isAndroid)&&(this.wasBackwards=function(){const e=window.getSelection();if(!e)return!1;const{focusNode:t,focusOffset:n,anchorNode:i,anchorOffset:r}=e;if(t===i)return n<r;return-1===(0,o.Z)(t,i)}())},this.handleKeyDown=()=>{this.keysDown++},this.handleKeyUp=()=>{this.keysDown--},this.handleMouseDown=()=>{this.mouseDown=!0},this.handleMouseUp=()=>{this.mouseDown=!1}}startListeners(e){return this.device=e,document.addEventListener("selectionchange",this.handleSelectionChange),window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp),window.addEventListener("mousedown",this.handleMouseDown),window.addEventListener("mouseup",this.handleMouseUp),()=>{document.removeEventListener("selectionchange",this.handleSelectionChange),window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp),window.removeEventListener("mousedown",this.handleMouseDown),window.removeEventListener("mouseup",this.handleMouseUp)}}};function O(e){B.startListeners(),F.startListeners(e)}function Z(){return B.currentIsBackwards||F.wasBackwards}(0,a.exposeDebugGetter)("selectionIsBackwards",Z);let V=!1,U=!1;function L(){return V}function j(){return U}function N(){return U=!1}(0,h.lj)(window,"mousedown",(e=>{0===e.button?V=!0:2===e.button&&(U=!0)}),!0),(0,h.lj)(window,"mouseup",(e=>{0===e.button?V=!1:2===e.button&&(U=!1)}),!0)},89086:(e,t,n)=>{n.d(t,{Gq:()=>ee,HE:()=>te,J5:()=>X,J6:()=>P,J_:()=>U,Ld:()=>x,Ov:()=>j,P2:()=>B,Q3:()=>G,Rb:()=>w,Rw:()=>O,ST:()=>D,Ts:()=>ie,W8:()=>E,ZZ:()=>J,a6:()=>T,bj:()=>R,dQ:()=>ne,e7:()=>Z,fM:()=>Q,fu:()=>V,fx:()=>K,hn:()=>W,iB:()=>L,k2:()=>M,lV:()=>Y,mK:()=>q,oc:()=>C,qK:()=>oe,qh:()=>$,td:()=>S,wd:()=>k,x0:()=>F,yR:()=>N,yj:()=>A});n(57658);var o=n(55010),i=n(40376),r=n(41432),a=n(15095),s=n(21202),l=n(70203),c=n(95371),d=n(53965),u=n(28685),p=n(95802),m=n(15723),f=n(50628),g=n(27724),h=n(24666),v=n(68056),b=n(45162),y=n(69645);const _="data-text-edit-side";function S(e){return{[_]:e}}function w(e){if(e instanceof HTMLElement){const t=e.closest(`[${_}]`),n=null==t?void 0:t.getAttribute(_);if("start"===n||"end"===n)return n}}function k(e){return e.startIndex===e.endIndex}function I(e){const{startIndex:t}=e;let n;return n=k(e)?[t-1]:function(e){return d.w6(e.startIndex,e.endIndex)}(e),n}function C(e,t){const n=l.lzi(t),o=n.map((e=>a.p4(l.WiV(e))));if(1===e.length&&-1===e[0]){const e=n[0];if(e){return[l.hDy(e).filter((e=>l.$z2(l.J7s(e))))]}return[]}return e.map((e=>{let t=0;const i=o.findIndex((n=>(t+=n.length,t>e))),r=n[i];return r?l.hDy(r):[]}))}function x(e){if("editing"===h.default.state.mode)return T(e,h.default.state.multiSelection,h.default.state.forceExtendAnnotations)}function T(e,t,n){return M([e],t,n)[e]}function M(e,t,n){const o={};if(0===e.length)return o;if((0,v.iG)(t)){for(const t of e){const e=n[t];if(null!=e&&e.extend){const n=e.annotation;o[t]=n}}return o}const i=new Set(e);let r=!0;const a=(0,b.L5)(t);for(const{store:s,selection:c}of a){const e=s.getValue(),t=l.Ulv(e,c),{tokensInsideRange:n}=l.xrQ(e,t.startIndex,t.endIndex);for(const a of n){const e=l.hDy(a);for(const t of i){const n=e.find((e=>l.J7s(e)===t));if(r&&n)o[t]=n;else if(n);else if(delete o[t],i.delete(t),0===i.size)return o}r=!1}}return o}function P(e){const t=h.default.state;if("editing"!==t.mode)return!1;const{multiSelection:n}=t;if((0,v.iG)(n))return!1;const o=(0,b.L5)(n);for(const{store:i,selection:r}of o){const t=i.getValue();if(!t)continue;const n=l.lzi(t);let o=0;for(const i of n){const t=a.p4(l.WiV(i));if(o>=r.startIndex&&o<r.endIndex||o<r.startIndex&&o+t.length>r.startIndex){if(l.hDy(i).some((t=>l.J7s(t)===e)))return!0}o+=t.length}}return!1}function A(e,t){const n=I(e),o=t.getValue()||[];return function(e,t,n){const o=new i.u,r=e[0]||[];for(const i of r)l.ZAl(i)||(l.lFw(i)||l.EqZ(i)?D(t,n.startIndex,l.J7s(i))&&o.add(i):o.add(i));return o}(C(n,o),o,e)}function R(){const e=h.default.state;if("editing"!==e.mode)return new i.u;const{multiSelection:t,forceExtendAnnotations:n}=e,o=(0,b.L5)(t);if(0===o.length)return new i.u;const{store:r,selection:a}=o[0],s=r.getValue(),c=s?l.VrM(s):0,u=A(a.endIndex===1/0?{startIndex:a.startIndex,endIndex:c}:a,r);return d.M6(n,((e,t)=>{e&&(e.extend?u.add(e.annotation):u.remove(e.annotation))})),u}function D(e,t,n){return Boolean(E(e,t,n))}function E(e,t,n){const o=l.b1T(e,t);return l.hDy(o).find((e=>l.J7s(e)===n))}function B(e){const t=F(e);if(t)return{startIndex:0,endIndex:t.endIndex}}function F(e){const t=u.E.findEditableWithStore(e);if(t)return t.props.getEndSelection?t.props.getEndSelection():void 0;{const t=l.eeV(e.getValue());return{startIndex:t.length,endIndex:t.length}}}function O(e){return 0===e.startIndex&&0===e.endIndex}function Z(e,t){return e.store===t&&0===e.index}function V(e,t){return!e&&!t||e&&t&&(e.startIndex===t.startIndex||!e.startIndex&&!t.startIndex)&&(e.endIndex===t.endIndex||!e.endIndex&&!t.endIndex)}function U(e,t){return V(t,F(e))}function L(e,t){var n;return e.store===t&&e.index===(null===(n=F(t))||void 0===n?void 0:n.endIndex)}function j(){const e=g.default.getCurrentDefaultContainer();return u.E.getMembersByDOMOrder({filter:t=>{const n=t.getContextClosestSelectable();if(!n)return!1;const o=n.getContextSelectableContainer();return o&&o===e}})}function N(e){const t=e.getNode(),n=t?g.default.getDefaultContainerFromTarget(t):g.default.getCurrentDefaultContainer();return u.E.getMembersByDOMOrder({filter:e=>{const t=e.getContextClosestSelectable();if(!t)return!1;const o=t.getContextSelectableContainer();return o&&o===n}})}function z(e){return j().filter((e=>!e.props.disabled)).map((e=>e.props.store))}function q(e){const t=z(),n=t.indexOf(e);return-1===n?null:t[n-1]}function W(e){const t=z(),n=t.indexOf(e);return-1===n?null:t[n+1]}function H(e){const t=[];for(const n of e){const e=d.cx(t,(e=>{const t=e[0];return m.Kr(n.rect,t.rect)}));e>=0?t[e].push(n):t.push([n])}return t}function K(e,t,n){const{selectableRectMap:i}=f.Z.state,r=n?g.default.getDefaultContainerFromTarget(n):void 0,a=g.default.getCurrentDefaultContainer(),s=r||a,l=p.C.getMembersByDOMOrder({filter:e=>e.props.canSelect&&e.props.canEditText&&e.getContextSelectableContainer()===s}),c=[];for(const o of l){const e=i.get(o);e&&c.push({selectable:o,rect:e})}const u=c.filter((e=>{let{rect:n}=e;return n.top<=t}));u.reverse();const m=H(u),h=d.UI(m,(e=>e.sort(((e,t)=>-1*(0,o.Z)(e.selectable.getNode(),t.selectable.getNode())))[0])),v=d.F(h,(t=>{let{rect:n}=t;return Math.min(Math.abs(n.left-e),Math.abs(n.right-e))}));if(v)return v;const b=H(c.filter((e=>e.rect.bottom>=t&&u.indexOf(e)<0))),y=d.UI(b,(e=>e.sort(((e,t)=>(0,o.Z)(e.selectable.getNode(),t.selectable.getNode())))[0])),_=d.F(y,(t=>{let{rect:n}=t;return Math.min(Math.abs(n.left-e),Math.abs(n.right-e))}));return _||void 0}function G(e,t){const{selectableRectMap:n}=f.Z.state,o=p.C.getMembersByDOMOrder({filter:e=>e.getContextSelectableContainer()===t});for(let i=o.length-1;i>=0;i--){const t=n.get(o[i]);if(t&&t.bottom>e)return!1}return!0}function $(e,t){const n=(0,y.dq)({includeNonSelectableListContainer:!0});if(!n)return!1;const o=d.Z$((0,c.DY)([n],(e=>e.value.component===t)));if(!o)return!1;const{selectableRectMap:i}=f.Z.state;return!(0,c.Yz)(o,(n=>{const o=n.component&&i.get(n.component);return!!(o&&e<=o.bottom&&n.component!==t)}))}function Q(e,t,n){const o=e.getValue(),i=[],r=n?l.Jcv(o):l.QaF(o),{startIndex:s,endIndex:c}=t,u=a.p4(r),p=d.tP(u,0,s),m=d.qr(p,(e=>"\n"===e));m>=0?i.push(m):i.push(0);for(let a=s;a<c;a++){"\n"===u[a]&&i.push(a)}return i}function Y(e){const{multiSelection:t}=e;return(0,b.L5)(t).map((e=>{let{store:t,selection:n}=e;const o=l.lzi(t.getValue()),i=l.Ulv(o,n),{tokensInsideRange:r}=l.xrQ(o,i.startIndex,i.endIndex);return l.QaF(r)})).join("\n\n")}function J(e){const t=h.default.state;return"empty"!==t.mode&&Boolean((0,b.r)(t.multiSelection,e))}function X(e){const t=h.default.state;return"editing"===t.mode&&(t.multiSelection.start.store===e&&(t.multiSelection.end.store===e?"contains-selection":"contains-selection-start"))}function ee(e){const t=h.default.state;if("editing"!==t.mode)return!1;const{start:n,end:o}=t.multiSelection;return n.store===e||o.store===e}function te(e){const t=h.default.state;if("empty"===t.mode)return;const n=(0,v.QY)(t.multiSelection);if(n)return n.store===e?{type:"contain",selection:l.Ulv(e.getValue(),n.selection)}:void 0;const{start:o,end:i}=t.multiSelection;if(o.store===e){const t=l.eeV(e.getValue()).length;return{type:"start",index:Math.min(o.index,t)}}if(i.store===e){const t=l.eeV(e.getValue()).length;return{type:"end",index:Math.min(i.index,t)}}}function ne(e){if(!(0,v.iG)(e))return!1;const{store:t,index:n}=e.start;return 0===n||"\n"===l.eeV(t.getValue())[n-1]}function oe(){if("editing"!==h.default.state.mode)return!1;const e=(0,v.QY)(h.default.state.multiSelection);if(!e)return!1;if(!e.store.isTable(s.iU))return!1;if(0===g.default.state.stores.length)return!1;return e.store.getRecordStoreAtRootPath().getType()===r.Ti.code&&(h.default.isEditingCaption()?"caption":"body")}function ie(e,t){if(t<0||t>=e.length)return;let n=0;for(let o=0;o<e.length;o++){if(o===t)return{startIndex:n,endIndex:n+l.J1x(e[o])};n+=l.J1x(e[o])}}},17311:(e,t,n)=>{n.d(t,{Z:()=>o});const o={unit:8,borderRadius:4,card:{desktop:{small:{width:180,height:100},medium:{width:260,height:148},large:{width:320,height:180}},mobile:{width:"100%"}},vertical:{micro:2,tiny:4,small:8,medium:12,large:24},horizontal:{micro:2,tiny:4,small:8,medium:12,large:24}}},16402:(e,t,n)=>{n.d(t,{IS:()=>d,gs:()=>m,hH:()=>u,uy:()=>p});var o=n(44317),i=n(9291),r=n(19584),a=n(33929);const s=(0,i.defineMessages)({year:{id:"timeUtils.durationDescriptor.year",defaultMessage:"{numYears, plural, one {{numYears} year ago} other {{numYears} years ago}}"},day:{id:"timeUtils.durationDescriptor.day",defaultMessage:"{numDays, plural, one {{numDays} day ago} other {{numDays} days ago}}"},week:{id:"timeUtils.durationDescriptor.week",defaultMessage:"{numWeeks, plural, one {{numWeeks} week ago} other {{numWeeks} weeks ago}}"},hour:{id:"timeUtils.durationDescriptor.hour",defaultMessage:"{numHours, plural, one {{numHours} hour ago} other {{numHours} hours ago}}"},minute:{id:"timeUtils.durationDescriptor.minute",defaultMessage:"{numMinutes, plural, one {{numMinutes} minute ago} other {{numMinutes} minutes ago}}"},second:{id:"timeUtils.durationDescriptor.second",defaultMessage:"Just now"}}),l=(0,i.defineMessages)({year:{id:"timeUtils.durationDescriptor.ultraCompactYear",defaultMessage:"{numYears}y"},day:{id:"timeUtils.durationDescriptor.ultraCompactDay",defaultMessage:"{numDays}d"},week:{id:"timeUtils.durationDescriptor.ultraCompactWeek",defaultMessage:"{numWeeks}w"},hour:{id:"timeUtils.durationDescriptor.ultraCompactHour",defaultMessage:"{numHours}h"},minute:{id:"timeUtils.durationDescriptor.ultraCompactMinute",defaultMessage:"{numMinutes}m"},second:{id:"timeUtils.durationDescriptor.ultraCompactSeconds",defaultMessage:"Just now"}}),c=(0,i.defineMessages)({year:{id:"timeUtils.durationDescriptor.compactYear",defaultMessage:"{numYears}y ago"},day:{id:"timeUtils.durationDescriptor.compactDay",defaultMessage:"{numDays}d ago"},week:{id:"timeUtils.durationDescriptor.compactWeek",defaultMessage:"{numWeeks}w ago"},hour:{id:"timeUtils.durationDescriptor.compactHour",defaultMessage:"{numHours}h ago"},minute:{id:"timeUtils.durationDescriptor.compactMinute",defaultMessage:"{numMinutes}m ago"},second:{id:"timeUtils.durationDescriptor.compactSecond",defaultMessage:"Just now"}});function d(e){let{useCompactFormat:t,useUltraCompactFormat:n,useLowercase:o,roundDownYears:i,useWeeks:d}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const u=n?l:t?c:s,p=new Date(e),m=a.default.getIntl().locale,f=new Date,g=+f-e;if(g>=r._I&&i){const e=Math.floor(g/r._I);return a.default.formatMessage(u.year,{numYears:e})}if(p.getFullYear()!==f.getFullYear()){const e={year:"numeric",month:"short",day:"numeric"},t={year:"numeric",month:"2-digit",day:"2-digit"};return p.toLocaleDateString(m,n?t:e)}const h=Math.floor(g/r.A0);if(h<28&&h>7&&d){const e=Math.floor(h/7);return a.default.formatMessage(u.week,{numWeeks:e})}if(h>=3)return p.toLocaleDateString(m,{month:"short",day:"numeric"});if(h>=1)return a.default.formatMessage(u.day,{numDays:h});const v=Math.floor(g/r.U6);if(v>=1)return a.default.formatMessage(u.hour,{numHours:v});const b=Math.floor(g/r.hM);return b>=1?a.default.formatMessage(u.minute,{numMinutes:b}):o?a.default.formatMessage(u.second).toLocaleLowerCase():a.default.formatMessage(u.second)}function u(e,t){const n=t-e,i=Math.floor(n/r._I),s=Math.floor(n/r.A0),l=Math.floor(n/r.U6),c=Math.floor(n/r.hM),d=Math.floor(n/r.C0);return i>=1?a.default.formatMessage(o.eG.year,{numYears:i}):s>=1?a.default.formatMessage(o.eG.day,{numDays:s}):l>=1?a.default.formatMessage(o.eG.hour,{numHours:l}):c>=1?a.default.formatMessage(o.eG.minute,{numMinutes:c}):a.default.formatMessage(o.eG.second,{numSeconds:d})}function p(e,t){return new Date(e).toLocaleDateString(a.default.getIntl().locale,{month:"long",year:"numeric",day:"2-digit",hour:"numeric",minute:"2-digit",second:t?void 0:"2-digit"})}function m(e){return new Date(e).toLocaleDateString(a.default.getIntl().locale,{month:"short",year:"numeric",day:"numeric"})}},35328:(e,t,n)=>{n.d(t,{BX:()=>p,JO:()=>c,_A:()=>l,fn:()=>m,ih:()=>s,m1:()=>u,tZ:()=>d,th:()=>f});var o=n(41432),i=n(29373),r=n(27724),a=n(45131);function s(e){return Boolean(o.ZY[e])}function l(e,t){return Boolean("toggle"===e||o.wZ[e]&&(null==t?void 0:t.toggleable))}function c(e){return Boolean(o.wZ[e])}function d(e){return o.ZY[e]}function u(e){return o.wZ[e]}function p(e){return"toggle"===e.getType()||m(e)}function m(e){const t=e.getType(),n=e.getFormat();return Boolean(void 0!==t&&(0,o.eJ)(t,n))}function f(e,t,n){let o;o=r.default.state.stores.includes(t)?r.default.state.stores:[t];const s=!(a.Z.isOpen(t.id)&&!n);for(const r of o)i.rd({blockId:r.id,state:s,currentUserId:e.currentUser.id})}},16861:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(68626);n(95477);const i={provider:void 0,logInvertedTextOperationError(e){const{invertedOperation:t,maybeRemappedInvertedOperation:n,transaction:i,errorCode:r}=e;if(this.provider)return this.provider.logInvertedTextOperationError(e);const a=i.getUserActionForAnalyticsPurposesOnly(),{command:s}=t,l=`Applying inverted text operation "${s}" from transaction "${a}" failed with error "${r}".`;o.log({level:"error",from:"transactionDebugHelpers",type:"crdt:logInvertedTextOperationError",error:{message:l},data:{userAction:a,operation:s,errorName:r}})},isDebuggingEnabled(){return Boolean(this.provider)}}},99341:(e,t,n)=>{n.d(t,{JG:()=>a,Vm:()=>r,_V:()=>l,jQ:()=>s});n(57658);var o=n(77337),i=n(53965);function r(e,t){let{allowSquashing:n}=t;if(0===e.length)return{squashedTasks:[]};const r={squashedTasks:[],userId:e[0].userId};function a(e){var t,a;const s=i.Z$(r.squashedTasks),l=s?s.task:void 0,c=Boolean((null===(t=e.debug)||void 0===t?void 0:t.userFlow)||(null==l||null===(a=l.debug)||void 0===a?void 0:a.userFlow));s&&l&&n&&!c&&function(e,t){function n(e){const t=e.operations.map((e=>e.pointer));return i.sv(t,i.Xy)}const o=n(e),r=n(t);return 1===o.length&&1===r.length&&i.Xy(o,r)}(l,e)?(l.operations=(0,o.Iw)([...l.operations,...e.operations]),s.subTasks.push(e)):r.squashedTasks.push({task:{...e},subTasks:[e]})}for(const o of e){if(r.userId!==o.userId)return r;if(JSON.stringify(i.VS(r.squashedTasks,(e=>e.task.operations))).length>=l)return 0===r.squashedTasks.length&&a(o),r;a(o)}return r}function a(e){const{transaction:t,timestamp:n,callback:o}=e;return{id:t.id,userId:t.userId,spaceId:t.spaceId,debug:{userAction:t.getUserActionForAnalyticsPurposesOnly(),userFlow:t.getUserFlowForAnalyticsPurposesOnly(),tags:t.getDebugTagsForAnalyticsPurposesOnly()},timestamp:n,operations:t.operations,callback:o,useSudoMode:t.useSudoMode}}function s(e){const t=a({transaction:e,timestamp:Date.now(),callback:void 0});return JSON.stringify(t).length>l}const l=1e5},64856:(e,t,n)=>{n.d(t,{AK:()=>a,IJ:()=>c,W$:()=>r,Xv:()=>s,ox:()=>l,wF:()=>d});var o=n(9163),i=n(53965);function r(e,t){return a(d(e,t))}function a(e){return void 0!==e&&(e===o.FW||e===o.lR)}function s(e,t){if(a(t))return;const n=o.eU[e],i=n.steps.findIndex((e=>e.id===t));return-1===i?n.steps[0].id:i===n.steps.length-1?o.FW:n.steps[i+1].id}function l(e,t){const n=d(e,t);if(n&&!a(n))return s(t,n)}function c(e,t){const n=d(e,t);if(n)return function(e,t){const n=o.eU[e];var r;if(a(t))return null===(r=(0,i.Z$)(n.steps))||void 0===r?void 0:r.id;const s=n.steps.findIndex((e=>e.id===t));return-1!==s&&0!==s?n.steps[s-1].id:void 0}(t,n)}function d(e,t){var n;if(!e)return;const i=((null===(n=e.getSettings())||void 0===n?void 0:n.tutorials)||{})[t];return void 0===i?o.eU[t].steps[0].id:i}},66638:(e,t,n)=>{n.d(t,{u:()=>a});var o=n(18245),i=n(88923),r=n(94134);function a(e){const{environment:t,type:n,blockStore:a,store:s,isInCollectionView:l}=e,c=o.default.mark(n),d=null==a?void 0:a.getType(),u=null==a?void 0:a.useCrdt();o.default.measureAfterNextFlush(c,{environment:t,getData:()=>{const e=null==a?void 0:a.getType(),t=a&&"properties"===s.path[0]&&"title"===s.path[1],n=a&&"properties"===s.path[0]&&"caption"===s.path[1];return{table:s.table,block_property:t?"title":n?"caption":void 0,block_type:e,use_crdt:u,block_type_initial:e!==d?d:void 0,peek_mode:i.default.state.mode,is_in_collection_view:l,profiling_tool:r.getProfilingToolForSession()}}})}},83089:(e,t,n)=>{function o(e){const{unicode:t,fallback:n}=e;try{return t()}catch(o){return n}}n.d(t,{D_:()=>r,Ff:()=>i,V9:()=>o});const i=o({unicode:()=>/\p{L}/u,fallback:/[a-zA-Z]/});function r(e){return i.test(e)}},36867:(e,t,n)=>{n.d(t,{_:()=>a,g:()=>s});var o=n(7057),i=n(15157);const r="userSessionCount";function a(e){const t=c(e);if(!t)return void l({userId:e,count:1});const{count:n,updatedAt:i}=t;(0,o.$6)(i,!0)!==(0,o.$6)(Date.now(),!0)&&l({userId:e,count:n+1})}function s(e){if(!e)return 0;const t=c(e);return(null==t?void 0:t.count)||0}function l(e){let{userId:t,count:n}=e;const o={count:n,updatedAt:Date.now()};i.Z.set({userId:t,key:r,value:o})}function c(e){return i.Z.get({userId:e,key:r})}},85644:(e,t,n)=>{function o(e){return e.isType("page")&&!e.isNonEditableState()&&!e.isCollectionView()&&!e.isInsideCollection()&&!e.isAssociatedCollectionAPageTree()&&e.canAdmin()}function i(e){var t;return(null===(t=e.getCollectionStore())||void 0===t?void 0:t.isPageTreeCollection())??!1}n.d(t,{A:()=>i,z:()=>o})},73819:(e,t,n)=>{n.d(t,{Iy:()=>w,PE:()=>_,cR:()=>k,ez:()=>y,rv:()=>S});var o=n(67294),i=n(60177),r=n(64338),a=n(13991),s=(n(480),n(97511)),l=n(33125),c=n(86628),d=n(24405),u=n(31701),p=n(37810),m=(n(92650),n(46654)),f=n(65598),g=n(58202),h=n(77080),v=n(6258),b=n(99757);function y(e,t,n,a){const s=(0,i.Dl)();(0,r.q7)(null==s?void 0:s.domLock),(0,o.useImperativeHandle)(t,(()=>n),[n]),(0,l.c)(g.R,(()=>n),[n]);return e&&!(0,f.SJ)(e)?a:null}function _(e,t){const n=(0,s.l)();return(0,c.VK)((()=>{if(t)return!1;if(b.n.state)return!1;const o=n&&n.publicEditModeStore.state;return!(0,m.YF)(o)&&e.canEdit()}),[t,n,e])}function S(e){const t=(0,d.Fg)();return(0,c.VK)((()=>{const n=e.getFormat().block_color||"default";return(0,u.fi)(n,t)}),[e,t])}function w(e){return(0,c.VK)((()=>{const t=e.getRecordStoreUIRoot();if(!(t instanceof v.G))return;const n=t.getFormatStore().getKeyStore("page_font").getValue();return p.Z.getHeaderFontFamily({pageFont:n,locale:a.SP})}),[e])}function k(e){return(0,c.VK)((()=>Boolean(e&&e.pathIsDead()&&h.default.checkGate("prevent_edits_trash"))),[e])}},28267:(e,t,n)=>{n.d(t,{X:()=>r});var o=n(67294),i=n(77794);function r(e,t){const[n,r]=(0,o.useState)(void 0);return(0,o.useEffect)((()=>{if(!e.current)return;const n=new i.E({throttleMs:t});return n.observe(e.current),n.rect.addListener((e=>{r(e.state)})),()=>{n.destroy()}}),[e,t]),n}},63474:(e,t,n)=>{n.d(t,{D:()=>a});var o=n(67294),i=n(480),r=n(97978);function a(){const e=(0,i.O7)();return(0,o.useMemo)((()=>(0,r.mc)(e)),[e])}},5971:(e,t,n)=>{n.d(t,{E:()=>r});var o=n(86628),i=n(77080);function r(e){return(0,o.VK)((()=>i.default.checkGate(e)),[e])}},26344:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(67294),i=n(53965),r=n(12534);function a(e){return(0,o.useMemo)((()=>({onMouseDown:t=>{e&&(0,r.ZP)({event:t,context:r.Af.EditorMouseDown,callback:i.yR})},onClick:t=>{e&&(0,r.ZP)({event:t,context:r.Af.EditorClick,callback:i.yR})},onDoubleClick:t=>{e&&(0,r.ZP)({event:t,context:r.Af.EditorDoubleClick,callback:i.yR})},onContextMenu:t=>{e&&(0,r.ZP)({event:t,context:r.Af.EditorContextMenu,callback:i.yR})}})),[e])}},35622:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(67294);function i(e){return(0,o.useMemo)((()=>({onMouseDown:t=>{if(e){if(r(t.target))return;r(document.activeElement)&&t.preventDefault()}}})),[e])}function r(e){return e instanceof HTMLElement&&("true"===e.contentEditable||"input"===e.tagName.toLowerCase())}},2551:(e,t,n)=>{n.d(t,{W:()=>i});var o=n(67294);function i(e,t,n){const i=(0,o.useRef)(e),r=(0,o.useRef)(null);(0,o.useEffect)((()=>{i.current=e}),[e]),(0,o.useEffect)((()=>{const e=async()=>{r.current&&(clearTimeout(r.current),r.current=null),n&&(await i.current(),r.current=setTimeout(e,t))};return n&&e(),()=>{r.current&&(clearTimeout(r.current),r.current=null)}}),[n,t])}},35630:(e,t,n)=>{n.d(t,{AS:()=>s,iP:()=>l});var o=n(67294),i=n(480),r=n(86628);const a=(0,o.createContext)(void 0);function s(e){const t=(0,r.VK)((()=>e.state.height),[e]),n=(0,o.useContext)(a)||window;return n!==window?n.innerHeight:t}function l(){const{WindowSizeStore:e}=(0,i.O7)();return(0,r.VK)((()=>{const{width:t,height:n}=e.state;return{width:t,height:n}}),[e])}},53824:(e,t,n)=>{n.d(t,{f:()=>a});var o=n(43593),i=n(95477);const r=["png","jpg","jpeg","webp","heic","heif"];function a(e){if(!e)return!1;const t=o.mD(e);if(!t)return!1;const n=o.E$(e,[i.default.secureFileS3.url,i.default.secureFileS3V2.url]),a=r.includes(t.toLowerCase());return n&&a}},5659:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(92595),i=n(55652),r=n(4408),a=n(45950);const s=(0,o.exposeDebugValue)("offlineDebugger",new class{constructor(){var e=this;this.enableLogging=!1,this.operationLatency={},this.log=function(t){if(e.enableLogging){for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];console.groupCollapsed(t,...o),console.trace(),console.groupEnd()}},this.generateLocalRecordMap=a.yY,this.getLocalRecord=a.Ye,this.getLocalBlocksWithParent=a.Dx}async measure(e,t,n){var o=this;const r=`OFFLINE: ${e}:`;return this.operationLatency[e]||(this.operationLatency[e]=new i.s((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.log(r,...t)}))),this.operationLatency[e].measureErrors(t,"hit","miss",n)}trace(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log("OFFLINE:",...t)}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log("OFFLINE:",...t)}traceMiss(e,t){for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];this.trace(`missed: record ${e}:${t}`,...o)}clearMemory(){r.LK(window.__console.environment)}})},76856:(e,t,n)=>{function o(e,t,n,o,i){const r="y"===i?"scrollTop":"scrollLeft",a=e[r],s=t-a,l=+new Date;let c=!0,d=null;const u=()=>{if(!c)return;window.requestAnimationFrame(u);const i=+new Date,p=Math.floor(function(e,t,n,o){return(e/=o/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t}(i-l,a,s,n));d?d===e[r]?(e[r]=p,d=e[r]):c=!1:(e[r]=p,d=e[r]),i>l+n&&(e[r]=t,c=!1,o&&o())};window.requestAnimationFrame(u)}n.d(t,{Z:()=>o})},75233:(e,t,n)=>{n.d(t,{Z:()=>i});n(21703);var o=n(26263);const i=new class{constructor(){this.pendingEvictions=void 0,this.environmentProvider=void 0,this.environmentProvider=()=>{throw new Error("Environment not ready")},this.pendingEvictions=new Map}getPendingEvictionCount(){return this.pendingEvictions.size}updateEnvironment(e){this.environmentProvider=()=>e}addToPendingEvictions(e,t){const n=(0,o.R)(e),i={...e,timestamp:t};this.pendingEvictions.set(n,i)}removeFromPendingEvictions(e){this.pendingEvictions.delete((0,o.R)(e))}forEachPendingEviction(e){for(const{pointer:t,userId:n,timestamp:o}of this.pendingEvictions.values())e({userId:n,pointer:t,timestamp:o,environment:this.environmentProvider()})}}},79420:(e,t,n)=>{n.d(t,{Z:()=>r});n(21703);var o=n(26263),i=n(21202);const r=new class{constructor(){this.subscribedRecords=void 0,this.pendingUnsubscribeRecords=void 0,this.environmentProvider=void 0,this.environmentProvider=()=>{throw new Error("Environment not ready")},this.subscribedRecords=new Map,this.pendingUnsubscribeRecords=new Map}getPendingUnsubscribeCount(){return this.pendingUnsubscribeRecords.size}updateEnvironment(e){this.environmentProvider=()=>e}getSubscriptionForRecord(e){return this.subscribedRecords.get((0,o.R)(e))}isSubscribedToRecord(e){const t=this.subscribedRecords.get((0,o.R)(e));return Boolean(t)}addToSubscribedRecords(e){const t=(0,o.R)(e),n={...e};this.subscribedRecords.set(t,n)}removeFromSubscribedRecords(e){const t=(0,o.R)(e);this.subscribedRecords.delete(t)}addToPendingUnsubscribeRecords(e,t){const n=(0,o.R)(e),i={...e,timestamp:t};this.pendingUnsubscribeRecords.set(n,i)}removeFromPendingUnsubscribeRecords(e){this.pendingUnsubscribeRecords.delete((0,o.R)(e))}forEachPendingUnsubscribeRecord(e){for(const{pointer:t,userId:n,timestamp:o}of this.pendingUnsubscribeRecords.values())e({userId:n,pointer:t,timestamp:o,environment:this.environmentProvider()})}reset(){this.subscribedRecords=new Map,this.pendingUnsubscribeRecords=new Map}safelyGetEnvironment(){try{return this.environmentProvider()}catch(e){return}}getSubscribedBlockDebuggingData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.safelyGetEnvironment();if(!t)return;const n={loadedBlockTypes:{},loaded:0,notLoaded:0};for(const[o,r]of this.subscribedRecords.entries())if((e||!this.pendingUnsubscribeRecords.has(o))&&r.pointer.table===i.iU){const e=t.defaultRecordCache.inMemoryRecordCache.getRecord(r);if(e&&e.value){const t=e.value.type;t in n.loadedBlockTypes||(n.loadedBlockTypes[t]=0),n.loadedBlockTypes[t]+=1,n.loaded+=1}else n.notLoaded+=1}return n}}},32223:(e,t,n)=>{n.r(t),n.d(t,{isConnected:()=>r.Mb,isConnecting:()=>r.J9,onMobileNativeReceiveRawMessageStoreMessage:()=>r.tD,onMobileNativeUpdateMessageStoreState:()=>r.Ce,resetRecordSubscriptions:()=>a,updateEnvironment:()=>s});var o=n(75233),i=n(79420),r=n(88536);function a(){i.Z.reset()}function s(e){i.Z.updateEnvironment(e),o.Z.updateEnvironment(e)}},88536:(e,t,n)=>{n.d(t,{vj:()=>Fe,mb:()=>V,cO:()=>De,C$:()=>U,EM:()=>ve,ZN:()=>be,Tm:()=>he,gE:()=>ye,Mb:()=>de,J9:()=>ue,id:()=>pe,Ap:()=>Be,tD:()=>Pe,Ce:()=>Me,eg:()=>Oe,Tg:()=>Ce,Ji:()=>Re,Ld:()=>Ve,hd:()=>Ze,r1:()=>Le,L4:()=>Ae,g4:()=>me});n(57658),n(21703);var o=n(68626),i=n(90038),r=n(57347),a=n(37850),s=n(1525);const l=class{constructor(e){this.performRequests=void 0,this.batchSize=void 0,this.maxWorkers=void 0,this.maxDelayMs=void 0,this.timeSource=void 0,this.queue=[],this.workerTasks=new Map,this.nextWorkerId=0,this.currentWorkers=0,this.requestsRunning=0,this.awaitingTimeout=!1,this.dequeue=async()=>{if(this.currentWorkers>=this.maxWorkers||0===this.queue.length)return;const e=this.nextWorkerId;this.nextWorkerId++,this.currentWorkers++;const t=this.queue.splice(0,this.batchSize),n=t.map((e=>e[0]));let o,i;this.workerTasks.set(e,t),this.requestsRunning+=t.length;try{o=await this.performRequests(n)}catch(a){i=(0,r.t)(a)}try{if(i)for(let e=0;e<t.length;e++){t[e][1].reject(i)}else if(o)for(let e=0;e<t.length;e++){const n=t[e],i=o[e];n[1].resolve(i)}}catch(a){}this.currentWorkers--,this.workerTasks.delete(e),this.requestsRunning-=t.length,this.dequeueAfterFilledBatchOrTimeout()};const{performRequests:t,batchSize:n,maxWorkers:o,maxDelayMs:i}=e;this.performRequests=t,this.batchSize=n,this.maxWorkers=o,this.maxDelayMs=i,this.timeSource=s.O}getStats(){return{queue:this.queue.length,running:this.requestsRunning,workers:this.currentWorkers}}updateTimeSource(e){this.timeSource=e}updateBatchSize(e){this.batchSize=e}updateMaxDelayMs(e){this.maxDelayMs=e}updateMaxWorkers(e){this.maxWorkers=e,this.dequeueAfterFilledBatchOrTimeout()}enqueue(e){const t=a.UZ();return this.queue.push([e,t]),this.dequeueAfterFilledBatchOrTimeout(),(0,i.m)({promise:t.promise,canCancel:()=>this.queue.some((e=>e[1]===t)),cancel:e=>{const n=this.queue.findIndex((e=>e[1]===t));n>=0&&(this.queue.splice(n,1),t.reject(e))}})}dequeueAfterFilledBatchOrTimeout(){this.queue.length>=this.batchSize?this.dequeue():this.awaitingTimeout||(this.awaitingTimeout=!0,this.timeSource.setTimeout((()=>{this.awaitingTimeout=!1,this.dequeue()}),this.maxDelayMs))}cancel(){const e=this.workerTasks,t=this.queue;this.workerTasks=new Map,this.queue=[];for(const n of e.values())for(const e of n)e[1].reject(new Error("CanceledTask."));for(const n of t)n[1].reject(new Error("CanceledTask."))}};var c=n(75189),d=n(44615),u=n(12139),p=n(53965),m=n(52629),f=n(76870),g=n(7032),h=n(19584),v=n(63811),b=n(95477),y=n(18245),_=n(5162),S=n(88632);const w=window.location.host.endsWith(b.default.publicDomainName);var k=n(1302),I=n(97978),C=n(77080);function x(e,t){k.default.afterNextFlush((()=>{C.default.checkGate("message_store_client_send_request_metric_enabled")&&I.j(e,"message_store.client.send_request",t)}))}const T=async()=>n.e(7168).then(n.bind(n,14854)),M=!1,P=90*h.C0,A=.5*h.C0,R=30*h.C0,D=3e3,E=10*h.C0,B={versions:!0,collection:!0,activity:!0,notification:!0,teams_in_space:!0,user_page_visit:!0,backlinks:!0,user_content:!0,page_visit:!0,user_shared_pages_in_space:!0,presence:!0,user_joined_teams_in_space:!0,teams_migration_completed_in_space:!0,diagnosticPing:!0,_other:!0};function F(e){const t=e.indexOf("/");if(-1===t)return"_other";const n=e.substring(0,t);return n in B?n:"_other"}function O(e,t){var n;const o=F(t),i=null===(n=(0,d.pz)(t))||void 0===n?void 0:n.table,r=e[o];if(r){if(i){const e=r[i];if(!e)return void Xe(`Warning: "${o}.${i}" has no existing counters!`);r[i]=e-1}r._total-=1,e._total-=1}else Xe(`Warning: "${o}" has no existing counters!`)}function Z(e){return{_id:e,charactersSent:0,requestsSent:0,requestsTimedOut:0,responsesReceivedWithoutHandlers:0,successfulResponsesReceived:0,unsuccessfulResponsesReceived:0,invalidMessagesReceived:0,notificationsReceived:0,messagesReceived:0}}function V(){return{...re}}function U(e){const t=re;if(e._id===t._id)return{charactersSent:t.charactersSent-e.charactersSent,requestsSent:t.requestsSent-e.requestsSent,requestsTimedOut:t.requestsTimedOut-e.requestsTimedOut,responsesReceivedWithoutHandlers:t.responsesReceivedWithoutHandlers-e.responsesReceivedWithoutHandlers,successfulResponsesReceived:t.successfulResponsesReceived-e.successfulResponsesReceived,unsuccessfulResponsesReceived:t.unsuccessfulResponsesReceived-e.unsuccessfulResponsesReceived,invalidMessagesReceived:t.invalidMessagesReceived-e.invalidMessagesReceived,notificationsReceived:t.notificationsReceived-e.notificationsReceived,messagesReceived:t.messagesReceived-e.messagesReceived}}const L=new Map,j=new Map;class N extends Map{isCancelable(e){return Boolean(this.getCancelable(e))}getCancelable(e){const t=this.get(e);if(null!=t&&t.canCancel())return t}}const z=new N,q=new N,W=new Map,H=new Map,K=Date.now();let G={_total:0};const $="messageStoreInternals",Q=new o.BatchedLogger({from:$,type:"BulkDebug",level:"info",maxLength:250,logToConsole:M});let Y,J,X,ee,te=0,ne=0,oe=0,ie=0,re=Z(0),ae=0,se=s.O,le=!1,ce="uninitialized";function de(){return"open"===ce}function ue(){return"uninitialized"===ce||"opening"===ce}const pe=!0;function me(e,t){let n=H.get(e);n||(n={},H.set(e,n)),Object.assign(n,t)}function fe(e){Q.log({level:"info",from:$,type:e})}function ge(){J=function(e){var t;const n=null==e||null===(t=e.socket)||void 0===t||null===(t=t.transport)||void 0===t||null===(t=t.query)||void 0===t?void 0:t.transport;if("websocket"===n||"polling"===n)return n}(this),fe(`ping:${J}`),Y=Date.now(),Xe(`Incoming primus ping received from server via ${J}.`)}function he(){return G}function ve(){return{...je.getStats(),batchSubscribeQueue:ze.getStats(),batchUnsubscribeQueue:qe.getStats()}}function be(e){const{lastOfflineTimestamp:t}=S.Z.getState(),n=ve(),{batchSubscribeQueue:o,batchUnsubscribeQueue:i}=n;return{currentConnectionCounters:re,timeSinceLastIncomingPing:Y&&e-Y,lastIncomingPingTransportType:J,timeSinceLastResponseReceived:X&&e-X,timeSinceLastReadyStateChange:ee&&e-ee,timeSinceLastOffline:t&&e-t,largestMessageSize:ae||void 0,messageStoreRequestsQueued:n.queue,messageStoreRequestsRunning:n.running,batchSubscribeQueue:o,batchUnsubscribeQueue:i,messageStoreConnectionState:ce,uptime:e-K,subscriptionCounters:G,primusEndEventsReceived:ne,primusErrorEventsReceived:oe,connectionResetsDueToFailedRequests:ie}}function ye(){const e=[];j.forEach(((t,n,o)=>{const i=(0,d.pz)(n);i&&t.value&&e.push({id:i.id,table:i.table,version:t.value})}));const t=p.vM(e,(e=>e.table)),n={};return Object.entries(t).map((e=>{let[t,n]=e;const o={};return n.forEach((e=>{o[e.id]=e.version})),{table:t,value:o}})).forEach((e=>{n[e.table]=e.value})),n}function _e(e){switch(Q.log({level:"info",from:$,type:"readyStateChange",data:{message:e}}),ee=Date.now(),e){case"end":ce="closed";break;case"open":ce="open";break;case"opening":ce="opening"}}const Se=p.HP((e=>async function(e){if(w)return;if(Ye(e))return void o.log({level:"warning",from:$,type:"CreatePrimusClientCalledForNativeMessageStoreClient"});te+=1;const{createClient:t}=await T(),n=t({minReconnectDelayMs:4*h.C0,maxReconnectDelayMs:8*h.C0});return n.on("data",$e),n.on("open",(()=>{fe("open"),we(e)})),n.on("reconnected",(e=>{Te(),Q.log({level:"info",from:$,type:"reconnected",data:{message:`Reconnected in ${null==e?void 0:e.duration} ms`}})})),n.on("reconnect",(()=>{fe("reconnect")})),n.on("reconnect scheduled",(e=>{Q.log({level:"info",from:$,type:"reconnect scheduled",data:{message:`Reconnecting in ${null==e?void 0:e.scheduled} ms, attempt ${null==e?void 0:e.attempt} of ${null==e?void 0:e.retries}`}})})),n.on("reconnect timeout",(()=>{fe("reconnect timeout")})),n.on("reconnect failed",(()=>{fe("reconnect failed")})),n.on("timeout",(()=>{fe("timeout")})),n.on("destroy",(()=>{fe("destroy")})),n.on("close",(()=>{fe("close")})),n.on("online",(()=>{fe("online")})),n.on("offline",(()=>{fe("offline")})),n.on("error",(e=>{let t;t="TransportError"===e.type?{level:"info",from:$,type:"primusTransportError",error:(0,m.Ui)(e)}:{level:"error",from:$,type:"unknownPrimusError",error:(0,m.Ui)(e)};(0,f.lB)(1)&&o.rateLimitedLog(t),Q.log(t),oe+=1})),n.on("incoming::ping",ge),n.on("readyStateChange",_e),n.on("end",(()=>{fe("end"),n.off("readyStateChange",_e),ne+=1,async function(e,t){var n,i;o.log({level:"info",from:$,type:"messageStoreEnd",error:{message:`SocketId: ${null==e||null===(n=e.socket)||void 0===n?void 0:n.id} Query:${null==e||null===(i=e.transport)||void 0===i?void 0:i.query}`}}),xe(),se.setTimeout((()=>{void 0!==e&&e.destroy()}),0);const r=await Se(t);if(e!==r)return;Se.cache.clear(),se.setTimeout((()=>{Se(t)}),2*h.C0)}(n,e)})),window.__primusClient=n,n}(e)),(function(){return"primus"}));function we(e){re=Z(re._id+1),L.forEach(((t,n)=>{const i=j.get(n);Ee(n,i?i.version:-1,e).catch((e=>{o.log({level:"warning",from:$,type:"ReconnectSubscriptionError",error:(0,m.Ui)(e)})}))})),M&&function(){const e=Date.now(),t=20;function n(){const o=ve();function i(e){return 0===e.queue&&0===e.running}if(i(o)&&i(o.batchSubscribeQueue)&&i(o.batchUnsubscribeQueue))return Xe(`Queues emptied after ${Date.now()-e} ms`),void(ke=void 0);ke=window.setTimeout(n,t)}ke&&window.clearTimeout(ke);Xe("Starting measurement of time until send queues are empty."),n()}()}let ke,Ie;function Ce(e){if(Ie)throw new Error("Having more than one onRestartMessageStoreConnectionHandler is not currently supported");Ie=e}function xe(){var e;le=!1,ze.cancel(),qe.cancel(),function(){for(const e of W.values())window.clearTimeout(e.timeout);W.clear()}(),z.clear(),q.clear(),We.cancel(),je.cancel(),H.clear(),G={_total:0},null===(e=Ie)||void 0===e||e()}function Te(){xe()}function Me(e,t){if(!Ye(t))return;Xe("onMobileNativeUpdateMessageStoreState",e);const n=!("open"===ce)&&"open"===e;n&&Te(),_e(e),n&&we(t)}function Pe(e,t){if(!Ye(t))return;const n=JSON.parse(e);Xe("onMobileNativeReceiveRawMessageStoreMessage",n),de()||Me("open",t),$e(n)}async function Ae(e){var t;const{key:n,field:o,updates:i,ttl:r,environment:a}=e;await(null===(t=Ge({method:"updateField",request:{key:n,field:o,updates:i,ttl:r},environment:a}))||void 0===t?void 0:t.response)}async function Re(e){var t;const{key:n,field:o,value:i,ttl:r,environment:a}=e;await(null===(t=Ge({method:"setField",request:{key:n,field:o,value:i,ttl:r},environment:a}))||void 0===t?void 0:t.response)}async function De(e){if(w)return{type:"messageStoreDisabled"};const t=(0,g.ZP)(),{environment:n}=e,o=(0,d.JK)(t),i="diagnosticPing",r=a.UZ(),s=e.logToConsole??M,l={};function c(e,t){l[e]=t,s&&console.log(`diagnosticPing ${e}=${t}`)}const p=await a.aM(async function(){var e;const a=performance.now();await Ve(o,((e,t)=>{t&&r.resolve(performance.now())}),i,n);const s=performance.now(),d=s-a;c("registerSubscriptionResponseMs",d);const u=await(null===(e=Ge({method:"diagnosticPing",request:{id:t},environment:n,onRequestSent:()=>{c("diagnosticPingEnqueuedMs",performance.now()-s)}}))||void 0===e?void 0:e.response);if(!u)return{type:"canceled",key:o,...l};const p=function(e){const t=l[e];if(void 0===t)throw new Error(`Assertion failure, expected timing for "${e}" to be defined`);return t}("diagnosticPingEnqueuedMs"),m=u.setValueTime;c("diagnosticPingServerSideSetValueMs",m);const f=performance.now()-s;c("diagnosticPingResponseMs",f);const g=await r.promise-s;c("diagnosticPingNotificationMs",g);const h=performance.now();await Le(o,i,n);const v=performance.now();return{type:"success",key:o,registerSubscriptionResponseMs:d,diagnosticPingEnqueuedMs:p,diagnosticPingServerSideSetValueMs:m,diagnosticPingResponseMs:f,diagnosticPingNotificationMs:g,unregisterSubscriptionResponseMs:v-h,totalMs:v-a}}().catch((e=>(u.rn(e,{from:$,type:"diagnosticPingError",data:{key:o}}),{type:"error",key:o,...l}))),R);return p.timeout?{type:"timeout",key:o,...l}:p.result}async function Ee(e,t,n){pe&&me(e,{latestRegisterSubscriptionRequestTimestamp:Date.now()}),function(e,t){var n;const o=F(t),i=null===(n=(0,d.pz)(t))||void 0===n?void 0:n.table;let r=e[o];if(r||(r={_total:0},e[o]=r),i){const e=r[i]||0;r[i]=e+1}r._total+=1,e._total+=1}(G,e);const o=q.getCancelable(e);if(o)o.cancel(new Error("Cancelled by sendRegisterSubscription()"));else{const o={key:e,version:t},i=ze.enqueueCancelable({request:o,environment:n});if(i){z.set(e,i.asyncQueuePromise);try{await i.response}finally{z.delete(e)}}}pe&&me(e,{latestRegisterSubscriptionResponseTimestamp:Date.now()})}function Be(e){return z.isCancelable(e)}function Fe(e,t){const n=z.getCancelable(e);if(!n)throw new Error(`Assertion failure, subscription request for key ${e} does not exist or is not cancelable`);Ue(e,t)&&(O(G,e),n.cancel(new Error("Cancelled by cancelRegisterSubscription()")),pe&&H.delete(e))}async function Oe(e,t,n){var o;await(null===(o=Ge({method:"registerOnDisconnect",request:{disconnectId:e,operations:t},environment:n}))||void 0===o?void 0:o.response)}async function Ze(e,t){var n;await(null===(n=Ge({method:"unregisterOnDisconnect",request:{disconnectId:e},environment:t}))||void 0===n?void 0:n.response)}async function Ve(e,t,n,o){if(w)return;let i=L.get(e);if(!i||0===i.length)return i=[{listener:t,listenerId:n}],L.set(e,i),void(de()?await Ee(e,-1,o):"uninitialized"!==ce||Ye(o)||await Se(o));if(i.find((e=>e.listenerId===n)))i=[...i.filter((e=>e.listenerId!==n)),{listener:t,listenerId:n}],L.set(e,i);else{i=[...i,{listener:t,listenerId:n}],L.set(e,i);const o=j.get(e);o&&t(e,o.value,o.passThroughData)}}function Ue(e,t){if(w)return!1;const n=L.get(e);if(!n)return!1;const o=n.filter((e=>e.listenerId!==t));return o.length!==n.length&&(0===o.length?(L.delete(e),j.delete(e),!0):(L.set(e,o),!1))}async function Le(e,t,n){Ue(e,t)&&de()&&await async function(e,t){pe&&me(e,{latestUnregisterSubscriptionRequestTimestamp:Date.now()}),O(G,e);const n=z.getCancelable(e);if(n)n.cancel(new Error("Cancelled by sendUnregisterSubscription()"));else{const n={key:e},o=qe.enqueueCancelable({request:n,environment:t});if(o){q.set(e,o.asyncQueuePromise);try{await o.response}finally{q.delete(e)}}}pe&&H.delete(e)}(e,n)}const je=new i.z(20);class Ne{constructor(e,t){this.queue=void 0,this.wrappedPerformRequests=async e=>{const t=e[0].environment;Xe(`Sending a batch of ${e.length} ${this.methodName} requests.`);const n=this.performRequests(t,e.map((e=>e.request)));if(!n)throw new Error("MessageStore is disabled.");const o=await n;if(!o)throw new Error("Request cancelled.");return o},this.methodName=e,this.performRequests=t,this.queue=new l({performRequests:this.wrappedPerformRequests,batchSize:250,maxDelayMs:A,maxWorkers:1})}updateTimeSource(e){this.queue.updateTimeSource(e)}getStats(){return this.queue.getStats()}cancel(){this.queue.cancel()}enqueueCancelable(e){if(w)return;const t=this.queue.enqueue(e),n=t.catch((e=>{Xe(`enqueueCancelable() for ${this.methodName} cancelled (${e.message})`)}));return{asyncQueuePromise:t,response:n}}}const ze=new Ne("registerSubscription",((e,t)=>We.enqueue((async()=>{var n;const o=Ge({method:"registerBatchSubscriptions",request:{subscriptions:t},environment:e});return null===(n=await(null==o?void 0:o.response))||void 0===n?void 0:n.responses})))),qe=new Ne("unregisterSubscription",((e,t)=>We.enqueue((async()=>{var n;const o=Ge({method:"unregisterBatchSubscriptions",request:{keys:t.map((e=>e.key))},environment:e});return null===(n=await(null==o?void 0:o.response))||void 0===n?void 0:n.keys.map((e=>({key:e})))})))),We=new i.z(1);let He;function Ke(){if(!He)return;const{totalRequests:e,requestCounts:t,startTime:n}=He;Xe("checkRequestThroughputForBurstWarning requestCounts =",t),e>D&&o.log({level:"warning",from:$,type:"BurstThroughputExceeded",data:{time:Date.now()-n,totalRequests:e,requestCounts:t}}),He=void 0}function Ge(e){if(w)return;const{method:t,request:n,environment:o}=e,i=y.default.mark("message_store.client.send_request.in_queue_time");x(o,{status:"enqueued",endpoint:t}),pe&&function(e){He||(He={startTime:Date.now(),totalRequests:0,requestCounts:{}},se.setTimeout(Ke,E)),He.totalRequests+=1,He.requestCounts[e]=(He.requestCounts[e]||0)+1}(t);const r=je.enqueue((()=>{var r;const s=(0,g.ZP)();!function(e,t){k.default.afterNextFlush((()=>{C.default.checkGate("message_store_client_send_request_metric_enabled")&&(I.j(e,"message_store.client.send_request.queue_running_size",{value:t.running}),I.j(e,"message_store.client.send_request.queue_backup_size",{value:t.queue}))}))}(o,je.getStats());const l=y.default.mark("message_store.client.send_request.round_trip_time");y.default.measure(i,{environment:o,data:{endpoint:t}});const c=a.UZ(),d=Date.now(),u=pe?window.setTimeout((()=>{"open"===ce&&(re.requestsTimedOut+=1,Q.log({level:"info",from:$,type:"requestTimeout",data:{requestId:s,time:Date.now()-d}}))}),P):void 0;W.set(s,{resolve:c.resolve,reject:c.reject,timeout:u,sendTime:d}),Q.log({level:"info",from:$,type:"requestSent",data:{requestId:s,method:t}});const p={type:`${b.default.messageStore.api}/${t}`,requestId:s,...n};return re.requestsSent+=1,async function(e){const{message:t,environment:n}=e,o=Qe(n),i=JSON.stringify(t);re.charactersSent+=i.length,ae<i.length&&(ae=i.length);if(o)o(i);else{const e=await Se(n);null==e||e.write(t)}}({message:p,environment:o}),null===(r=e.onRequestSent)||void 0===r||r.call(e),c.promise.then((e=>{y.default.measure(l,{environment:o,data:{endpoint:t}}),x(o,{status:"success",endpoint:t})})).catch((e=>{const n=je.getStats();x(o,{status:"failure",endpoint:t,queue_running_size:n.running,queue_backup_size:n.queue})})),c.promise}));return{response:r.catch((e=>{e instanceof Je&&!Ye(o)&&!le?(le=!0,ie+=1,fe("connectionResetDueToFailedRequest"),Se(o).then((e=>{null==e||e.end()})),Xe(`sendRequest() for ${t} returned server error (${e.message}), resetting connection`,n)):Xe(`sendRequest() cancelled or errored for ${t} (${e.message})`,n)})),asyncQueuePromise:r}}function $e(e){re.messagesReceived+=1;const t=(0,v.Gu)(c.yx,e);if(t)return re.invalidMessagesReceived+=1,void o.rateLimitedLog({level:"warning",from:$,type:"ValidationError",data:{miscDataToConvertToString:e},error:(0,m.Ui)(t)});const n=e;if("response"===n.type){var i;const{requestId:e,status:t,result:o}=n,r=W.get(e);if(W.delete(e),Q.log({level:"info",from:$,type:"responseReceived",data:{requestId:e,response:t,time:r&&Date.now()-r.sendTime,internalProcessingTimeMs:null===(i=n.result)||void 0===i?void 0:i.internalProcessingTimeMs}}),!r)return void(re.responsesReceivedWithoutHandlers+=1);X=Date.now(),window.clearTimeout(r.timeout),"ok"===t?(re.successfulResponsesReceived+=1,r.resolve(o)):(re.unsuccessfulResponsesReceived+=1,r.reject(new Je(o)))}else{re.notificationsReceived+=1;const{key:e,value:t,version:i,passThroughData:a}=n,s=L.get(e);if(!s)return;j.set(e,{version:i,value:t,passThroughData:a});for(const{listener:n}of s)try{n(e,t,a)}catch(r){o.log({level:"warning",from:$,type:"ListenerError",error:(0,m.Ui)(r)})}}}function Qe(e){var t;if((0,_.Y)("supportsNativeMessageStore"))return e&&(null===(t=e.mobileNative)||void 0===t?void 0:t.api.sendRawMessageStoreMessage)}function Ye(e){return Boolean(Qe(e))}class Je extends Error{constructor(e){super(e),this.name="FailedMessageStoreRequestError"}}function Xe(){if(M){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.info("messageStoreInternals:",...t)}}},2688:(e,t,n)=>{n.d(t,{ZP:()=>l});var o=n(89101),i=n(41641),r=n(88536);class a{constructor(){this.uniqueIdCounter=0}addListener(e,t,n,o){if((0,i.Z)(e))return n||(n=this.computeNewSubscriptionId()),r.Ld(e,t,n,o),{key:e,subscriptionId:n}}removeListener(e,t){let{key:n,subscriptionId:o}=e;(0,i.Z)(n)&&r.r1(n,o,t)}async updateField(e,t,n,o,i){await r.L4({key:e,field:t,updates:n,ttl:o,environment:i})}async setField(e,t,n,o,i){await r.Ji({key:e,field:t,value:n,ttl:o,environment:i})}async onDisconnect(e,t,n,o){const i=`${n}/${e}`;await r.eg(i,t,o)}async clearOnDisconnect(e,t,n){const o=`${t}/${e}`;await r.hd(o,n)}computeNewSubscriptionId(){return this.uniqueIdCounter+=1,`subscription:${this.uniqueIdCounter}`}}class s{constructor(){this.isQueuingListeners=!0,this.queuedListeners=[],this.defaultMessageDispatcher=new a}addListener(e,t,n,o){return this.isQueuingListeners?(n||(n=this.defaultMessageDispatcher.computeNewSubscriptionId()),this.queuedListeners=[...this.queuedListeners.filter((t=>t.key!==e||t.subscriptionId!==n)),{key:e,listener:t,subscriptionId:n}],{key:e,subscriptionId:n}):this.defaultMessageDispatcher.addListener(e,t,n,o)}removeListener(e,t){let{key:n,subscriptionId:o}=e;this.isQueuingListeners?this.queuedListeners=this.queuedListeners.filter((e=>e.key!==n&&e.subscriptionId!==o)):this.defaultMessageDispatcher.removeListener({key:n,subscriptionId:o},t)}updateField(e,t,n,o,i){return Promise.resolve()}setField(e,t,n,o,i){return Promise.resolve()}onDisconnect(e,t,n,o){return Promise.resolve()}clearOnDisconnect(e,t,n){return Promise.resolve()}stopQueueingSubscriptions(e){this.isQueuingListeners&&(this.queuedListeners.forEach((t=>{this.defaultMessageDispatcher.addListener(t.key,t.listener,t.subscriptionId,e)})),this.queuedListeners=[],this.isQueuingListeners=!1)}}const l=window.location.pathname===o.VP.quickSearch?new s:new a},69151:(e,t,n)=>{n.r(t),n.d(t,{subscribe:()=>P,unsubscribe:()=>B,unsubscribeAfterDelay:()=>Z,unsubscribeForAllUsers:()=>D});n(21703);var o=n(1302),i=n(92595),r=n(68626),a=n(44615),s=n(41641),l=n(19584),c=n(4408),d=(n(95477),n(77080)),u=n(53730),p=(n(57658),n(76870),n(37850),n(7032),n(3022),n(54642),n(79420)),m=n(88536);const f=!1,g=!1,h=60*l.C0,v=15*l.C0;l.C0;class b{constructor(e){this.map=new Map,this.timeoutMs=e}set(e){const{key:t,onTimeout:n,onClear:o,value:i}=e;this.clear(t);const r=window.setTimeout((()=>{this.map.delete(t),null==n||n()}),this.timeoutMs);this.map.set(t,{timeout:r,value:i,onClear:o})}get(e){var t;return null===(t=this.map.get(e))||void 0===t?void 0:t.value}clear(e){const t=this.map.get(e);var n;void 0!==t&&(window.clearTimeout(t.timeout),this.map.delete(e),null===(n=t.onClear)||void 0===n||n.call(t))}has(e){return this.map.has(e)}}const y=new b(h),_=new b(v);var S=n(606),w=n(82798);var k=n(75233),I=n(2688);const C="recordSubscriptionActions";function x(e,t,n){const o=a.pz(t);o?null===n||"number"==typeof n?(m.id&&((0,m.g4)(t,{latestUpdateTimestamp:Date.now()}),function(e){if(f&&g)return;const t=y.get(e);t&&(t.latestUpdate=Date.now()),_.clear(e)}(t)),T({environment:e,pointer:o,version:n})):r.rateLimitedLog({level:"warning",from:"handleRemoteVersionUpdate",type:"ValidationError",data:{key:t,miscDataToConvertToString:{pointer:o,version:n}}}):r.rateLimitedLog({level:"warning",from:"handleRemoteVersionUpdate",type:"ValidationError",data:{key:t,miscDataToConvertToString:{version:n}}})}function T(e){const{environment:t,pointer:n,version:o}=e,i=[void 0,...t.currentUser.loggedInUserIds];for(const r of i){if(p.Z.getSubscriptionForRecord({userId:r,pointer:n})){const i=t.defaultRecordCache.inMemoryRecordCache.getVersion({pointer:n,userId:r});if(u.transactionQueue.isPendingTransactionForRecord(n))return void(d.default.checkGate("defer_remote_version_update_for_pending_tx")&&M.deferUntilTransactionIsDone(e));(null===o||o>i)&&c.bG({environment:t,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,pointer:n,userId:r})}}}const M=new class{constructor(e){this.recordUpdates=new Map,this.handleRemoteVersionUpdateForPointer=e}deferUntilTransactionIsDone(e){const{pointer:t,version:n}=e,o=S.dr.toKey(t).toString(),i=this.recordUpdates.get(o);if(i)null===i.version||(null===n||n>i.version)&&this.recordUpdates.set(o,e);else{if(!u.transactionQueue.isPendingTransactionForRecord(t))throw new Error("Pending transaction must exist for record");this.recordUpdates.set(o,e),u.transactionQueue.awaitRecordTransaction(t).then((()=>{const e=(0,w.TO)(this.recordUpdates.get(o),"Pending record update for key must exist");this.recordUpdates.delete(o),this.handleRemoteVersionUpdateForPointer(e)}))}}}(T);function P(e){const{pointer:t,userId:n,environment:i}=e,r={pointer:t,userId:n};A(t)||(p.Z.removeFromPendingUnsubscribeRecords(r),k.Z.removeFromPendingEvictions(r),p.Z.isSubscribedToRecord(r)||(p.Z.addToSubscribedRecords(r),o.default.afterNextFlush((()=>{const o=i.defaultRecordCache.inMemoryRecordCache.getRecord(r);o?R({record:o,...e}):c.bG({environment:i,inMemoryRecordCache:i.defaultRecordCache.inMemoryRecordCache,userId:n,pointer:t}).then((t=>{R({record:t,...e})}))}))))}function A(e){return!e.id||!e.table||("emptyDroppableKey"===e.id||"placeholder"===e.id)}function R(e){const{environment:t,pointer:n,userId:o,record:i}=e,l={pointer:n,userId:o};if(!p.Z.isSubscribedToRecord(l))return;const c=a.ZS(n);(0,s.Z)(c)&&(n.id&&n.table?I.ZP.addListener(c,((e,n)=>x(t,e,n)),C,t):r.rateLimitedLog({level:"warning",from:"recordSubscriptionActions:subscribe",type:"KeyValidationError",data:{pointer:n,miscDataToConvertToString:{record:i,key:l,versionsKey:c}}}))}function D(e){for(const t of e.environment.currentUser.loggedInUserIds)B({...e,userId:t})}function E(e){const{pointer:t}=e;if(A(t))return!1;if(!p.Z.isSubscribedToRecord(e))return!1;p.Z.removeFromSubscribedRecords(e);const n=a.ZS(t);return!!(0,s.Z)(n)&&(!(!t.id||!t.table)||(r.rateLimitedLog({level:"warning",from:"recordSubscriptionActions:unsubscribe",type:"KeyValidationError",data:{pointer:t,miscDataToConvertToString:{versionsKey:n}}}),!1))}function B(e){const{environment:t}=e;E(e)&&I.ZP.removeListener({key:a.ZS(e.pointer),subscriptionId:C},t)}const F=2*l.hM,O=F;function Z(e){const{pointer:t,environment:n,userId:o}=e;if(A(t))return;if(n.defaultRecordCache.inMemoryRecordCache.hasListener(t))return;const i=a.ZS(t);if((0,m.Ap)(i)){const e={pointer:t,userId:o};return k.Z.addToPendingEvictions(e,Date.now()+O),void(E(e)&&(0,m.vj)(i,C))}p.Z.addToPendingUnsubscribeRecords(e,Date.now()+F)}function V(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];p.Z.forEachPendingUnsubscribeRecord((n=>{let{pointer:o,userId:i,timestamp:r,environment:a}=n;if(r<e){p.Z.removeFromPendingUnsubscribeRecords({pointer:o,userId:i});const e={pointer:o,userId:i};t&&console.log("Unsubscribing and evicting",JSON.stringify(o)),a.defaultRecordCache.inMemoryRecordCache.deleteRecord(e),B({pointer:o,userId:i,environment:a})}})),k.Z.forEachPendingEviction((n=>{let{pointer:o,userId:i,timestamp:r,environment:a}=n;if(r<e){k.Z.removeFromPendingEvictions({pointer:o,userId:i});const e={pointer:o,userId:i};t&&console.log("Evicting",JSON.stringify(o)),a.defaultRecordCache.inMemoryRecordCache.deleteRecord(e)}}))}setInterval((()=>{V(Date.now())}),1e4),(0,i.exposeDebugValue)("forceUnsubscribeAndEvictPendingRecords",(()=>{V(1/0,!0)})),setTimeout((()=>{(0,m.Tg)((()=>{p.Z.forEachPendingUnsubscribeRecord((e=>{let{pointer:t,userId:n,timestamp:o,environment:i}=e;p.Z.removeFromPendingUnsubscribeRecords({pointer:t,userId:n});const r={pointer:t,userId:n};k.Z.addToPendingEvictions(r,o),B({pointer:t,userId:n,environment:i})}))}))}),0)},91948:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var o=n(86628),i=n(85248),r=n(17294),a=n(85893);function s(e){let{targetRecordId:t,style:n}=e;const s=(0,o.VK)((()=>r.Z.state[t]),[t]);if(!s)return null;const{taskStatus:l,completeBlocks:c,totalBlocks:d}=s,u=(()=>{switch(l){case"not_started":case"failure":return;case"success":return 100;case"in_progress":if("number"!=typeof c||"number"!=typeof d)return;if(0===d)return;const e=c/d;return 1===e?99:Math.round(100*e)}})();return"number"!=typeof u?null:(0,a.jsx)(i.k,{percentage:u,style:n})}},98110:(e,t,n)=>{n.d(t,{Z:()=>m});var o=n(67294),i=n(480),r=n(86628),a=n(15145),s=n(9291),l=n(75754),c=n(6854),d=n(73744),u=n(83105),p=n(85893);function m(e){const t=(0,i.O7)(),n=(0,r.VK)((()=>!t.device.isPhone),[t]);return(0,p.jsxs)(p.Fragment,{children:[n&&(0,p.jsx)(f,{...e}),(0,p.jsx)(c.ow,{onUndo:void 0})]})}function f(e){let{moveToLocation:t,movedItems:n}=e;const r=(0,i.O7)(),m=(0,o.useCallback)((e=>{var o;if(t&&"moveToBlock"===t.type)l._c({environment:r,openInNew:d.DJ(e),store:t.blockStore,scrollToBlockId:null===(o=n[0])||void 0===o?void 0:o.id,visitType:u.vu.Link,pageVisitSource:a.tY.Move})}),[r,t,n]);return t&&"moveToBlock"===t.type?(0,p.jsx)(c.Pn,{onClick:m,children:(0,p.jsx)(s.FormattedMessage,{defaultMessage:"Visit",id:"moveToHelpers.afterMoveToast.viewButton"})}):null}},41549:(e,t,n)=>{n.d(t,{$x:()=>s,Fz:()=>l,T6:()=>m,h_:()=>c,mx:()=>p});n(57658);var o=n(19584),i=n(16746),r=n(66353),a=n(50770);function s(e,t){const n=o.vM(e,(e=>{let{notification:t}=e;return t.navigable_block_id??t.id}));return n.forEach(((e,o)=>{const i=[],r=new Set;e.forEach((e=>{const{activity:t}=e;"commented"!==t.type&&i.push(e);const n=t.discussion_id;void 0===n||r.has(n)||(i.push(e),r.add(n))}));const a=i.filter((e=>{let{notification:n}=e;return("mentions"!==t||!n.visited)&&!("archive"===t&&!n.visited)}));0!==a.length?n.set(o,a):n.delete(o)})),n}function l(){const e=r.ZP.state.filter||r.uZ;return r.j5.includes(e)?e:r.uZ}function c(e){const{environment:t,useInboxRedesign:n}=e,o=(0,a.B7)(t);return n&&!("time_grouping"===o||"comment_page_time_grouping"===o)?{fontWeight:void 0}:{}}function d(e,t){const n=void 0===e?new Date:new Date(e);return n.setDate(n.getDate()-t),n.setHours(0,0,0,0),n.getTime()}function u(e,t){const n=void 0===e?new Date:new Date(e),o=n.getDay();return n.setDate(n.getDate()-o-7*t),n.setHours(0,0,0,0),n.getTime()}function p(e){return[{name:"today",cutoffTime:d(e,0)},{name:"this_week",cutoffTime:u(e,0)},{name:"last_week",cutoffTime:u(e,1)},{name:"older"}]}function m(){const{contentType:e,openState:t}=i.Z.state;return"inbox"===e?t:"closed"}},50770:(e,t,n)=>{n.d(t,{B7:()=>d,H7:()=>l,me:()=>c,tO:()=>u,z_:()=>p});n(57658);var o=n(12174),i=n(1898),r=n(5162),a=n(77080);function s(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=a.default.getEligibleGroup({experimentId:"inbox_2_0",defaultGroup:"control",disableExposureLogging:t}),i="on"===n?"page_grouping":n,r=["control"];if(o.mr.forEach((e=>{r.push(e)})),!r.includes(i))return"control";const s=!e.device.isMobile;if("control"!==i)return"form_factor_only_experiment"!==i||s?i:"control";if(!s)return"control";return"on"===a.default.getEligibleGroup({experimentId:"inbox_peek_and_panel_v2",defaultGroup:"control",disableExposureLogging:t})?"form_factor_only_experiment":"control"}function l(e,t){const n=Boolean(null==t?void 0:t.disableExposureLogging);return!!(0,r.Y)("supportsMobileWebInbox2")||"control"!==s(e,n)}function c(e){const t=s(e);switch(t){case"control":return"popup";case"page_grouping":return"panel";case"internal_prototype_peek":case"internal_prototype_time_grouping":case"internal_comment_page_time_grouping":case"form_factor_only_experiment":return"overlay_and_pinning";default:(0,i.t1)(t)}}function d(e){const t=s(e);switch(t){case"control":case"form_factor_only_experiment":return"none";case"page_grouping":case"internal_prototype_peek":return"page_grouping";case"internal_prototype_time_grouping":return"time_grouping";case"internal_comment_page_time_grouping":return"comment_page_time_grouping";default:(0,i.t1)(t)}}function u(e){const t=s(e);switch(t){case"control":case"form_factor_only_experiment":return!1;case"page_grouping":case"internal_prototype_peek":case"internal_prototype_time_grouping":case"internal_comment_page_time_grouping":return!0;default:(0,i.t1)(t)}}function p(e){return"form_factor_only_experiment"===s(e)}},84437:(e,t,n)=>{n.d(t,{B9:()=>w,Bm:()=>x,N$:()=>k,WS:()=>C,fW:()=>y,sT:()=>b,sh:()=>v,tE:()=>I});var o=n(89101),i=n(53965),r=n(7032),a=n(18265),s=n(86615),l=n(54642),c=n(47839),d=n(12714),u=n(13447),p=n(37181),m=n(95477),f=n(97978),g=n(71574),h=n(59110);async function v(e){const{environment:t,spaceStore:n,collectionViewStore:i,from:s}=e;if(!!n&&!(0,g.tE)())return void async function(e){const{environment:t,spaceStore:n,collectionViewStore:i,from:s}=e;if(t.device.isElectron){const e=a.bf({url:`${m.default.domainBaseUrl}${o._j.signup}`,query:{showNotionCalendarModal:"true"}});return void d.D({environment:t,url:e})}const l=await S({environment:t,spaceStore:n,collectionViewStore:i,from:s}),c=(0,r.ZP)(),u=a.bf({url:m.default.calendar.notionAuthUrl,query:{...l,csrf:c}});await(0,g.PQ)({environment:t,csrf:c}),h.Z.setState({isConnectingCalendar:!0}),d.D({environment:t,url:u})}(e);const l=i?m.default.calendar.openNotionDatabaseUrl:m.default.calendar.domainBaseUrl;w({environment:t,url:await b({environment:t,baseUrl:l,spaceStore:n,collectionViewStore:i,from:s})})}async function b(e){const{environment:t,baseUrl:n,spaceStore:o,collectionViewStore:i,from:r}=e,s=await S({environment:t,collectionViewStore:i,spaceStore:o,from:r});return a.bf({url:n,query:s})}async function y(e){const{environment:t,csrf:n,calendarCsrf:o,spaceId:r,integration:a,redirectUri:c,state:d}=e;if(!(await(0,g.Bs)({environment:t,csrf:n})))return void _({environment:t,redirectUri:c,query:i.GM({state:d},i.o8)});const u=await l.createOauthAuthorizationCode(t,{integrationId:a.id,spaceId:r,redirectUri:c,acceptedIntegrationCapabilities:a.capabilities});if("failed"===u.type)return void _({environment:t,redirectUri:c,query:i.GM({state:d},i.o8)});await s.dl(t);const p={code:u.data.code,calendarCsrf:o,state:d};_({environment:t,redirectUri:c,query:i.GM(p,i.o8)})}function _(e){const{environment:t,redirectUri:n,query:o}=e,i=a.bf({url:n,query:o});d.D({environment:t,url:i,targetSelf:!0})}async function S(e){const{environment:t,spaceStore:n,collectionViewStore:o,from:r}=e,a=await(0,f.cG)(t);if(!n&&!o)return{notionDeviceId:a,from:r};const s={env:"production",collection_view_id:null==o?void 0:o.id,workspace_id:null==n?void 0:n.id,notionDeviceId:a,from:r};return i.GM(s,i.o8)}async function w(e){const{environment:t,url:n,targetSelf:o}=e;if(!t.device.isElectron)return d.D({environment:t,url:n,targetSelf:o});const{desktopProtocol:i}=m.default.calendar;if(!(await c.isProtocolRegistered(i)))return d.D({environment:t,url:n,targetSelf:o});const r=n.replace(/^https?:/,`${i}:`);c.openExternalUrl(r)}function k(){h.Z.setState({isForceShowing:!0})}function I(e){const{environment:t,userSettingsStore:n}=e;u.createAndCommit({environment:t,userAction:"NotionCalendarLaunchModal.clickCancel",perform:e=>{p.d2({userSettingsStore:n,transaction:e,data:{notion_calendar_launch_modal_dismissed_at:Date.now(),notion_calendar_launch_modal_phase:"dismissed_modal"}})}})}function C(e,t){const{phase:n,transactionUserAction:o,userSettingsStore:i}=t;u.createAndCommit({environment:e,userAction:o,perform:e=>{p.d2({userSettingsStore:i,transaction:e,data:{notion_calendar_launch_modal_phase:n}})}})}function x(e){const{environment:t,transactionUserAction:n,userSettingsStore:o}=e;u.createAndCommit({environment:t,userAction:n,perform:e=>{p.d2({userSettingsStore:o,transaction:e,data:{seen_open_in_calendar_tooltip:!0}})}})}},71574:(e,t,n)=>{n.d(t,{Bs:()=>g,PQ:()=>f,ZH:()=>u,tE:()=>p});var o=n(77657),i=n(7032),r=n(12955),a=n(18514),s=n(48779),l=n(80444),c=n(77080),d=n(30874);function u(e){var t;const{environment:n,collectionContextType:o}=e;return!!c.default.checkGate("notion_calendar")&&((null===(t=l.default.state.currentSpaceStore)||void 0===t||!t.isNotionCalendarDisabledOnSpace())&&(!n.device.isMobile&&(!(0,a.Sr)(n)&&(!s.Cx(l.default.state.currentSpaceStore)&&("collectionTypedView"!==o&&"collectionVirtualView"!==o)))))}function p(){const{bots:e,externalAuthentications:t}=d.Z,n=e.state.find((e=>e.integration_id===o.Dv));if(!n)return!1;const i=t.state.find((e=>e.parent_id===n.id));return Boolean(i)}const m="notion_calendar_csrf";async function f(e){const{environment:t,csrf:n}=e;await(0,r.setCookie)(t,{name:m,value:n})}async function g(e){const{environment:t,csrf:n}=e,o=await(0,r.getCookie)(t,m),a=!!o&&(0,i.t)(o)&&o===n;return(0,r.removeCookie)(m),a}},59110:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}}const r=new i},55081:(e,t,n)=>{n.d(t,{EV:()=>z,Ex:()=>U,I1:()=>j,Mf:()=>L,Qt:()=>W,VW:()=>q,lp:()=>N,xN:()=>V,yH:()=>Z,zJ:()=>F});n(67294);var o=n(79946),i=n(68626),r=n(59730),a=n(15157),s=n(97213),l=n(89101),c=n(75246),d=n(77858),u=n(19889),p=n(9291),m=n(57347),f=n(38208),g=n(47307),h=n(94273),v=n(92625),b=n(97977),y=n(9953),_=n(8055),S=n(1357),w=n(70782),k=n(64369),I=n(33954),C=n(79947),x=n(33929),T=n(48779),M=n(77907),P=n(74948),A=n(80444),R=n(6258),D=n(10929),E=n(75538),B=n(85893);async function F(e,t){if(!e.currentUser.id)return!1;const n=O(e);return!!D.BB(n)||(t||(t=new R.U6(e,{table:u.KJ,id:e.currentUser.id}),await t.awaitNonNullValue()),!t.getOnboardingCompleted())}function O(e){return{...a.Z.get({userId:e.currentUser.id,key:E.onboardingPreferenceKey}),currentUserId:e.currentUser.id,stageStats:{startedTimeStampMs:Date.now()}}}async function Z(e,t){const{state:n}=E.default;if(n.isLoading||n.isOnboarding||!e.currentUser.id)return;const o=O(e);if(!o.isOnboarding)return;if(D.NT(o)&&t&&(null==t?void 0:t.id)!==o.spaceViewId)return;const{flow:r}=o,a="desktop_join_or_create_space"===r||"mobile_join_or_create_space"===r,s=await D.dD({environment:e,disableRedirects:a});s&&(o.onboardingData=s),E.default.setState(o);const{spaceId:l}=o;if(l&&(e.device.isMobileNative&&i.log({level:"info",from:"onboardingActions",type:"SpaceSwitchingDebug",data:{message:"onboardingActions.restoreOnboardingState setting space",spaceId:l}}),A.default.setState({...A.default.state,currentSpaceStore:new R.H2(e,{table:c.bx,id:l})})),o.isOnboarding&&"spaceViewId"in o&&o.spaceViewId){const t=new R.V9(e,{table:d.zU,id:o.spaceViewId});A.default.setState({...A.default.state,currentSpaceViewStore:t})}H(e,o)}async function V(e){await j(e,{type:"create-or-join"})}function U(e){const{userStore:t,transaction:n}=e;y.sW({store:t,data:{onboarding_completed:!0},transaction:n})}function L(e){const{userStore:t,transaction:n}=e;y.sW({store:t,data:{mobile_onboarding_completed:!0},transaction:n})}async function j(e,t){try{_.c4({environment:e,url:l._j.onboarding});const n=await D.dD({environment:e,disableRedirects:Boolean(t.disableRedirectUrl)||"create-or-join"===t.type}),i=D.Pn(n),r=await M.deps.onboardingStateActions.loader(),a=await r.getInitialState({environment:e,startOnboardingArgs:t,onboardingData:n,redirectData:i});if(a&&a.isOnboarding){"invalid"===i.type&&(a.stage="error"),E.default.setState(a);const t=D.jn(a);f.NG(e,t),f.y6(e,t),H(e,a),a.isNewUser&&(o.I$(),o.j({device:e.device,event:{facebook:{eventName:"CompleteRegistration"},google:{eventName:"registration"}},cookieService:e.cookieService}))}}catch(n){const t=(0,m.t)(n);!function(e,t,n){E.default.setState({...E.default.state,isLoading:!1}),f.Gk(e,{...D.jn(E.default.state),errorMessage:t.message}),i.log({level:"error",from:"onboardingActions",type:"handleError",error:{message:`Found onboarding error: ${t.message}`}});const o=n?async()=>await b.actuallyLogoutAndDeleteMostLocalData({environment:e,logoutOrigin:s.F.OnboardingError}):void 0;g.showMessage({message:t.message,onAccept:o})}(e,t,"WorkspaceCreationError"===t.name&&(0,r.Zw)(t)&&t.data.newUser)}}async function N(e,t){if(t.isOnboarding)try{f.jB(e,D.jn(t));const n=await M.deps.onboardingStateActions.loader();let o=await n.updateAndGetNextState(t,e);o.isOnboarding?(o={...o,stageStats:{startedTimeStampMs:Date.now()}},E.default.setState(o),H(e,o)):E.default.setState(o),f.y6(e,D.jn(o))}catch(n){z(e,(0,m.t)(n))}}async function z(e,t){if(E.default.setState({...E.default.state,isLoading:!1}),i.log({level:"error",from:"onboardingActions",type:"handleOnboardingError",error:{message:`Found onboarding error: ${t.message}`,stack:String(t.stack)}}),v.x(),t instanceof C.Gg&&(0,r.Rp)(t.data.responseBody)&&"UnauthorizedError"===t.data.responseBody.name)return void f.ho(e,{...D.jn(E.default.state),errorMessage:t.message,debugMessage:"UnauthorizedError"});let n;if(t instanceof C.Gg){var o;const e=null==t||null===(o=t.data)||void 0===o||null===(o=o.responseBody)||void 0===o?void 0:o.clientData;e&&(n=(0,I.XN)(x.default.getIntl(),e))}f.ho(e,{...D.jn(E.default.state),errorMessage:t.message,debugMessage:n||"undefined"});await g.confirmUserAction({message:(0,B.jsxs)("div",{children:[(0,B.jsx)(k.Z,{style:{fontSize:17,fontWeight:500,lineHeight:"24px",paddingBottom:8},children:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"Oops, something went wrong.",id:"onboardingActions.onboardingErrorDialog.message"})}),(0,B.jsx)("div",{children:n??t.message})]}),acceptLabel:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"Start over",id:"onboardingActions.onboardingErrorDialog.startOverButton.label"}),cancelLabel:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"Close",id:"onboardingActions.onboardingErrorDialog.closeButton.label"})})&&function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j;const o=E.default.state;D.n0(o)?n(e,{type:"new-user",disableRedirectUrl:!0}):D.y7(o)?n(e,{type:"create-or-join",disableRedirectUrl:!0}):e.device.isMobile?n(e,{type:"mobile-onboarding",disableRedirectUrl:!0}):i.log({level:"error",from:"onboardingActions",type:"handleOnboardingError",error:{message:`Could not redirect onboarding: ${t.message}`,stack:String(t.stack)}})}(e,t)}async function q(e){const{state:t}=E.default;if(D.n0(t)){if(!(await g.confirmUserAction({message:(0,B.jsxs)("div",{style:{display:"block"},children:[(0,B.jsx)("div",{style:{fontWeight:600},children:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"Cancel new account setup?",id:"onboardingActions.closeOnboardingDialog.newUser.title"})}),(0,B.jsx)("div",{children:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"You'll be taken back to the Notion home page.",id:"onboardingActions.closeOnboardingDialog.newUser.subtitle"})})]}),acceptLabel:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"Return to home page",id:"onboardingActions.closeOnboardingDialog.newUser.confirmCloseButton.label"}),cancelLabel:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"Continue setup",id:"onboardingActions.closeOnboardingDialog.newUser.continueButton.label"})})))return;f.jw(e,D.jn(t)),await b.actuallyLogoutAndDeleteMostLocalData({environment:e,logoutOrigin:s.F.OnboardingExit})}else{if(!(await g.confirmUserAction({message:(0,B.jsxs)("div",{style:{display:"block"},children:[(0,B.jsxs)("div",{style:{fontWeight:600},children:[" ",(0,B.jsx)(p.FormattedMessage,{defaultMessage:"Cancel new workspace setup?",id:"onboardingActions.closeOnboardingDialog.existingUser.title"})]}),(0,B.jsx)("div",{style:{wordBreak:"keep-all"},children:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"You'll be taken back to your previous workspace.",id:"onboardingActions.closeOnboardingDialog.existingUser.subtitle"})})]}),acceptLabel:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"Back to previous workspace",id:"onboardingActions.closeOnboardingDialog.existingUser.confirmCloseButton.label"}),cancelLabel:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"Continue setup",id:"onboardingActions.closeOnboardingDialog.existingUser.continueButton.label"})})))return;f.jw(e,D.jn(t));const{mainEditorCurrentBlockStore:o}=A.default.state,r=null==o?void 0:o.getSpaceId(),a=r&&(0,T.w3)(r);if(a){const t=a.getSpaceStore();e.device.isMobileNative&&i.log({level:"info",from:"onboardingActions",type:"SpaceSwitchingDebug",data:{message:"onboardingActions.handleCloseOnboarding set space",spaceId:null==t?void 0:t.id}}),A.default.setState({...A.default.state,currentSpaceStore:t,currentSpaceViewStore:a})}const{url:s,userId:l}=h.Vr(e);let c=e;if(l&&l!==e.currentUser.id&&(c=await w.x({environment:e,newCurrentUserId:l})),s){var n;P.close();const e=()=>{const e={isOnboarding:!1,isLoading:!1,currentUserId:l};E.default.setState(e)};_.c4({environment:c,url:s}),null!==(n=c.mobileNative)&&void 0!==n&&n.supportsNativeHomeOnPhone()?S.d(c,e):e()}}}function W(e){const{state:t}=E.default;f.J7(e,D.jn(t)),E.default.setState({isOnboarding:!1,isLoading:!1,currentUserId:e.currentUser.id})}function H(e,t){if(!t.isOnboarding)return;if(t.isOnboarding){const n=[...t.historicalStages||[],{stageName:t.stage,stageNumber:t.stageNumber,timestamp:Date.now()}];E.default.setState({...t,historicalStages:n.length>20?[{stageName:"truncated",stageNumber:-1,timestamp:Date.now()}]:n}),f.o7(e,"onboarding_stage",{...D.jn(t),historical_stages:n})}}},10929:(e,t,n)=>{n.d(t,{$U:()=>G,At:()=>H,BB:()=>B,Bu:()=>O,Fz:()=>ae,NT:()=>F,Pn:()=>q,SN:()=>K,Vb:()=>re,WX:()=>$,YH:()=>ee,_J:()=>W,bM:()=>ie,bN:()=>Q,bm:()=>oe,dD:()=>V,eW:()=>E,ey:()=>j,fz:()=>R,iF:()=>U,jF:()=>L,jn:()=>z,lr:()=>Z,n0:()=>A,og:()=>X,pd:()=>te,rT:()=>J,tr:()=>M,uO:()=>ne,vA:()=>Y,y7:()=>P});n(21703);var o=n(80994),i=n(33728),r=n(68626),a=n(75246),s=n(60949),l=n(9291),c=n(31701),d=n(53965),u=(n(7032),n(1898)),p=n(37810),m=n(38208),f=n(54642),g=n(97977),h=n(76464),v=n(9953),b=n(29974),y=n(10259),_=n(13447),S=n(97978),w=n(33929),k=n(48779),I=n(80444),C=n(77080),x=n(6258),T=n(75538);function M(e,t){return`/tutorial/${e}${"dark"===t.state.mode?"-dark":""}.png`}function P(e){return e.isOnboarding&&("desktop_join_or_create_space"===e.flow||"mobile_join_or_create_space"===e.flow)}function A(e){return e.isOnboarding&&("desktop_cold_start"===e.flow||"mobile_cold_start"===e.flow||"desktop_joinable_spaces"===e.flow||"mobile_joinable_spaces"===e.flow||"desktop_redirect"===e.flow||"mobile_redirect"===e.flow)}function R(e){const{state:t}=e;return A(t)}const D=(0,l.defineMessages)({personalWorkspaceName:{defaultMessage:"{userName}'s Notion",id:"onboardingHelpers.personalWorkspaceName"}});function E(e,t){return t.formatMessage(D.personalWorkspaceName,{userName:e.trim()})}function B(e){return e.isOnboarding&&Boolean(T.InAppOnboardingStages.find((t=>t===e.stage)))}function F(e){return e.isOnboarding&&(Boolean(T.InAppOnboardingStages.find((t=>t===e.stage)))||"invite"===e.stage)}function O(e){return e.isOnboarding&&"template_optout"===e.stage}function Z(e){const t=e.userStore.getEmail();if(t&&e.isUserDomainJoinable)return(0,i.Gd)(t)}async function V(e){T.default.setState({...T.default.state,isLoading:!0});const{disableRedirects:t,environment:n}=e;r.log({level:"info",from:"onboardingHelpers",type:"loadOnboardingData",data:{message:"initializeOnboardingDataLoad"}});const[i,a,s,l,c,d,p]=await Promise.all([f.getJoinableSpaces(n,{}),(0,k.iX)({environment:n,disableRedirectUrl:t}),f.isUserDomainJoinable(n,{}),f.isEmailEducation(n,{}),f.validateUserCanCreateWorkspace(n,{}),f.getVerifiedEmailDomain(n,{}),f.getGeoIpLocation(n,{})]);r.log({level:"info",from:"onboardingHelpers",type:"loadOnboardingData",data:{message:"completedOnboardingDataLoad",miscDataToConvertToString:{joinableSpacesResponseType:i.type,joinableSpacesResponseStatus:i.status,userRedirectDataId:a.userRootStore.id,isUserDomainJoinableResponseType:s.type,isUserDomainJoinableResponseStatus:s.status,validateUserCanCreateWorkspaceStatus:c.status}}}),T.default.setState({...T.default.state,isLoading:!1});const m={isUserDomainJoinable:"success"===s.type&&s.data.isJoinable,isEducationPlanEligible:"success"===l.type&&l.data.isEligible,canUserCreateSpace:"success"!==c.type||c.data.canUserCreateSpace,isUserUsingVerifiedDomain:"success"===d.type&&(0,u.$K)(d.data.id),...a,countryCode:"success"===p.type&&(0,o.GC)(p.data.countryCodeFromIp)?p.data.countryCodeFromIp:void 0};return"success"===i.type?{joinableSpaceData:i.data,...m}:{joinableSpaceData:{results:[]},...m}}async function U(e){const t=await f.getGeoIpLocation(e,{});return"success"===t.type&&(0,o.GC)(t.data.countryCodeFromIp)?t.data.countryCodeFromIp:void 0}function L(e){if(P(e)){const{userRootStore:t}=e.onboardingData;if("timed_trial_upsell"===e.stage)return!1;const n=t.getSpaceViewPointers();if(n)return n.length>0}return!1}function j(e){const{onboardingData:t,isNewUserFlow:n}=e,{userRootStore:o}=t,{results:i}=t.joinableSpaceData,r=o.getSpaceViewStores().map((e=>e.getSpaceId()));return n?i:i.filter((e=>r.indexOf(e.id)<0))}function N(e){return e.isOnboarding&&"profile"!==e.stage&&"error"!==e.stage}function z(e){var t,n,o;const{currentSpaceStore:i}=I.default.state,{function:r,role:a,companySize:s,intent:l,useCases:c}=(0,k.kO)();return{flow_name:e.isOnboarding?e.flow:"not_defined",flow_id:e.isOnboarding?e.flowId:void 0,stage:e.isOnboarding?e.stage:"not_defined",initial_workspace_type:N(e)?e.spaceJoinOrCreate:void 0,is_new_onboarding:J(e),is_create_or_join:P(e),stage_number:e.isOnboarding?e.stageNumber:void 0,num_of_joinable_spaces:e.isOnboarding&&"workspace_choose"===e.stage?(null===(t=e.joinableSpaces)||void 0===t?void 0:t.length)||0:void 0,historical_stages:e.isOnboarding?e.historicalStages:void 0,selectedPresets:e.isOnboarding&&"workspace_setup"===e.stage?e.selectedPresets:void 0,user_persona:r,user_team_role:a,user_use_cases:c,user_company_size:s,plan_selection:l,plan_type:null==i?void 0:i.getPlanType(),stage_duration_in_ms:e.isOnboarding&&null!==(n=e.stageStats)&&void 0!==n&&n.startedTimeStampMs?Date.now()-(null===(o=e.stageStats)||void 0===o?void 0:o.startedTimeStampMs):void 0,onboarding_templates:void 0}}function q(e){const{redirectSpaceId:t,redirectPageId:n,forkPageBlockId:o,hasExplicitAccessToRedirectPage:i,canJoinRedirectSpace:r,publicAccessPageId:a,oauthAuthorizationParams:s}=e;return s?{type:"oauth_authorization_redirect",...s}:o?{type:"fork_page",pageId:o}:!a||i||r?!t||i||r?t&&n&&i&&!r?{type:"guest_redirect",pageId:n,spaceId:t}:t&&n&&r?{type:"redirect_page",pageId:n,spaceId:t}:t&&r?{type:"redirect_space",spaceId:t}:{type:"getting_started_page"}:{type:"invalid"}:{type:"public_access_page_redirect",pageId:a}}async function W(e,t){const{onboardingData:n,name:o,profilePhoto:i,password:r,emailOptIn:a}=e,s=n.userStore;S.Zf(t,{email_optin_product_tips_and_news:a,email_optin_resources_and_events:a,email_optin_notion_for_startups:a}),_.createAndCommit({userAction:"onboardingHelpers.setProfileData",environment:t,perform:e=>{const t={...i&&{profile_photo:i}};t.name=o,v.sW({store:s,data:t,transaction:e})}});const l=await g.shouldCreatePassword(t)&&!Y();r&&l&&await f.setPassword(t,{newPassword:r,sendEmail:!1})}function H(e){if(!C.default.checkGate("survey_data_writes"))return;const{environment:t,state:n,spaceStore:o,spaceViewStore:i}=e,r=(new Date).getTime();if(i){const e=s.Dh({maybeFunction:n.userPersona,guessedFunctionVersion:4,maybeRole:n.userRole,maybeCategories:n.categories,guessedCategoriesVersion:1,guessedRoleVersion:2,collectedFrom:"onboarding",collectedAt:r});void 0!==e&&y.Q1(t,e,i)}if(o){const e=s.K0({maybeIntent:n.planSelection,guessedIntentVersion:1,maybeCompanySize:n.companySize,guessedCompanySizeVersion:2,maybeUseCases:n.useCases,guessedUseCasesVersion:3,collectedFrom:"onboarding",collectedAt:r});void 0!==e&&b.wg(t,e,o)}}async function K(e,t){const{spaceId:n,onboardingData:o}=e;if(!n)return;const i=x.H2.createChildStore(o.userRootStore,{table:a.bx,id:n});await async function(e,t,n){t.isChecked&&t.joinableUserEmailDomain&&await b.$F({environment:e,emailDomains:[t.joinableUserEmailDomain],spaceStore:n})}(t,e,i);const{emails:r}=e,s=d.jj(r).map((e=>({type:"newUser",value:{email:e},source:"email"})));r.length>0&&(await h.n_({environment:t,store:i,inviteTargets:s,inviteRole:"editor",isOnboarding:!0,invite:{inviteOrigin:"onboarding_invite"}}),m.qJ(t,{...z(e),emails:e.emails,auto_join_space:e.isChecked,is_bulk_invite:e.isBulkInvite}))}function G(e){const{userStore:t}=e,n=w.default.getIntl(),o=t.getFullName(n),i=t.getProfilePhoto()||null;if(o)return{name:o,profilePhoto:i,password:null,prefilled:!0}}const $="inviteCode";function Q(e){return(e.isBulkInvite?e.emailTokens:e.emailInputs.filter((e=>""!==e.sanitizedEmail))).length>0}function Y(){var e;const{currentUserSettingsStore:t}=I.default.state;return t&&t.isReady()&&"email-password"===(null===(e=t.getSettings())||void 0===e?void 0:e.mobile_ads_signup_variant)}function J(e){return e.isOnboarding&&e.isNewUser}function X(e){return e.device.isMobileBrowser}const ee={fontSize:12,color:c.ZP.mediumTextColor,fontWeight:p.Z.fontWeight.medium,lineHeight:"135%",marginTop:20,marginBottom:4},te={marginTop:14,marginBottom:14},ne={marginTop:8,marginBottom:8};function oe(e){return{color:e.mediumTextColor}}const ie={width:60},re={marginTop:14,marginBottom:8,fontSize:16,fontWeight:600},ae={boxShadow:`0 0 0 1px ${c.ZP.red}`}},75538:(e,t,n)=>{n.r(t),n.d(t,{InAppOnboardingStages:()=>a,default:()=>c,onboardingPreferenceKey:()=>s});var o=n(14577),i=n(49085),r=n(15157);const a=["template_optout","workspace_setup"],s="lastOnboardingStateKeyV1";class l extends i.default{setState(e){super.setState(e),function(e){if(e.isOnboarding)if("profile"===e.stage){const{onboardingData:t,isLoading:n,password:o,passwordErrorData:i,currentUserId:a,...l}=e;r.Z.set({userId:a,key:s,value:l})}else{const{onboardingData:t,isLoading:n,currentUserId:o,...i}=e;delete i.password,r.Z.set({userId:o,key:s,value:i})}else{const{currentUserId:t,...n}=e;r.Z.set({userId:t,key:s,value:n})}}(e)}constructor(){super(),this.isOnboarding=new o.Z((()=>this.state.isOnboarding),{debugName:"isOnboarding"});const e={isOnboarding:!1,isLoading:!1,currentUserId:void 0};super.setState(e)}}const c=new l},34017:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isOpen:!1}}}const r=new i},71384:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(49085),i=n(1898),r=n(19584),a=n(54642);class s extends o.default{getInitialState(){return{pageSignals:new Map}}getKey(e,t){return`${e}:${t}`}getPageSignals(e){let{spaceId:t,userId:n}=e;if(!t||!n)return;const o=this.getKey(t,n),i=this.state.pageSignals.get(o);return i||void 0}async updatePageSignals(e){const{spaceId:t,userId:n,blocks:o}=e;if(!t||!n)return;const s=this.getPageSignals(e),c=void 0===s?o:o.filter((e=>!s.hasOwnProperty(e.blockModel.id)));if(c.length>0&&await async function(e){const{spaceId:t,userId:n,blocks:o,environment:s}=e,c=o.map((e=>e.blockModel.id));if(!t||!n||!(0,i.Of)(c))return;const d=await a.getPageSignals(s,{spaceId:t,pageIds:c,includeRecords:!0,signals:[{name:"pageAuthorityV1"}]});if("success"===d.type){const e=c.map((e=>({})));d.data.signals.forEach((t=>{if("success"===t.status){const{name:n,data:o}=t;o.forEach(((t,o)=>{e[o][n]=t}))}}));const o=(0,r.m8)(e.map(((e,t)=>[c[t],e]))),i=l.getKey(t,n);l.update((e=>{const t=e.pageSignals.get(i),n=e.pageSignals.set(i,{...t,...o});return{...e,pageSignals:n}}))}}({...e,blocks:c}),s){const e=Object.keys(s).length+c.length;if(e>2048){const i=e-2048,r=new Set(o.map((e=>e.blockModel.id)));!function(e){const{spaceId:t,userId:n,pageIds:o}=e,i=l.getKey(t,n);l.update((e=>{const t={...e.pageSignals.get(i)};o.forEach((e=>delete t[e]));const n=e.pageSignals.set(i,t);return{...e,pageSignals:n}}))}({spaceId:t,userId:n,pageIds:Object.keys(s).filter((e=>!r.has(e))).slice(0,i)})}}}}const l=new s},77282:(e,t,n)=>{n.d(t,{Z:()=>f});var o=n(16691),i=n(11799),r=n(82798),a=(n(30541),n(21703),n(57658),n(41432)),s=n(33147),l=n(53965),c=n(54843);class d extends s.Z{constructor(e){super(),this.blocks=void 0,this.liveBlocks=void 0,this.rootBlock=void 0,this.detachedRootBlocks=void 0,this.blocks=new Map,this.liveBlocks=new Map,this.rootBlock=this.createBlock(e,"page"),this.detachedRootBlocks=new Map}hasBlock(e){return this.blocks.has(e)}getBlock(e){return(0,r.TO)(this.blocks.get(e))}createBlock(e,t){(0,r.T)(!this.hasBlock(e.id));const n=new u({blockStore:e,tracker:this,reference:t,onCreated:e=>{this.blocks.set(e.getId(),e)}});return n.hasLiveReference()&&this.addLiveBlock(n),n}removeBlock(e){(0,r.T)(this.hasBlock(e)),(0,r.T)(!this.liveBlocks.has(e),"Should not be possible to remove a live block."),this.blocks.delete(e)}getLiveBlocks(){return[...this.liveBlocks.values()]}addLiveBlock(e){(0,r.T)(!this.liveBlocks.has(e.getId())),this.liveBlocks.set(e.getId(),e),this.emit({type:"add_block",blockStore:e.blockStore})}removeLiveBlock(e){this.liveBlocks.delete(e.getId()),this.emit({type:"remove_block",blockId:e.getId()})}destroy(){for(const e of this.blocks.values())e.destroy();this.blocks.clear(),this.liveBlocks.clear(),this.detachedRootBlocks.clear()}getClosestPageAndTransclusionReferenceAncestorIds(e){const t=this.liveBlocks.get(e);return t?t.getClosestPageAndTransclusionReferenceAncestors().map((e=>e.getId())):[]}getPathToBlock(e){const t=this.liveBlocks.get(e);if(!t)return;const n=[];let o=t;for(;o;){n.unshift(o.getId());const e=o.liveReferences.values().next().value;if("page"===e)return n;o=e}throw new Error("Block should have a page ancestor")}}class u{constructor(e){this.tracker=void 0,this.blockStore=void 0,this.liveReferences=void 0,this.detachedReferences=void 0,this.childBlocks=void 0,this.childBlocksList=void 0,this.contentStoreListener=void 0;const{blockStore:t,tracker:n,reference:o,onCreated:i}=e;this.tracker=n,this.blockStore=t,this.liveReferences=new Set,this.detachedReferences=new Set,"page"===o||o.hasLiveReference()?this.liveReferences.add(o):this.detachedReferences.add(o),this.childBlocks=new Map,this.childBlocksList=[],i(this),this.contentStoreListener=()=>this.handleContentStoreChange(),this.blockStore.getKeyStore("type").addListener(this.contentStoreListener),this.blockStore.getContentStore().addListener(this.contentStoreListener),this.blockStore.getFormatStore().getKeyStore("transclusion_reference_pointer").addListener(this.contentStoreListener),this.handleContentStoreChange()}handleContentStoreChange(){const e=[...this.childBlocks.keys()],t=new Map,n=this.blockStore.getType();if(this.liveReferences.has("page")||n&&!(0,a.S9)(n))for(const r of(0,c.y)(this.blockStore))t.set(r.id,r);const o=[...t.keys()],i=l.e5(o,e),s=l.e5(e,o);for(const a of i)if(this.tracker.hasBlock(a)){const e=this.tracker.getBlock(a);e.addReference(this),this.childBlocks.set(a,e)}else{const e=this.tracker.createBlock((0,r.TO)(t.get(a)),this);this.childBlocks.set(a,e)}for(const a of s){const e=(0,r.TO)(this.childBlocks.get(a));this.childBlocks.delete(a),e.removeReference(this)}this.childBlocksList=[...t.keys()].map((e=>(0,r.TO)(this.childBlocks.get(e))))}getId(){return this.blockStore.id}hasLiveReference(){return this.liveReferences.size>0}addReference(e){e.hasLiveReference()?this.addLiveReference(e):this.addDetachedReference(e)}addLiveReference(e){if((0,r.T)(!this.liveReferences.has(e)),this.liveReferences.add(e),1===this.liveReferences.size){this.tracker.addLiveBlock(this);for(const e of this.childBlocks.values())e.updateReference(this)}}addDetachedReference(e){this.detachedReferences.add(e)}removeReference(e){e.hasLiveReference()?this.removeLiveReference(e):this.removeDetachedReference(e)}removeLiveReference(e){if(this.liveReferences.delete(e),this.detachedReferences.add("detached"),this.tracker.detachedRootBlocks.set(this.getId(),this),0===this.liveReferences.size){this.tracker.removeLiveBlock(this);for(const e of this.childBlocks.values())e.updateReference(this)}return this}removeDetachedReference(e){if(this.detachedReferences.delete(e),0===this.liveReferences.size&&0===this.detachedReferences.size){for(const[e,t]of this.childBlocks.entries())this.childBlocks.delete(e),t.removeReference(this);this.tracker.removeBlock(this.getId()),this.destroy()}}updateReference(e){const t=this.hasLiveReference();this.liveReferences.has(e)&&!e.hasLiveReference()?(this.liveReferences.delete(e),this.detachedReferences.add(e)):this.detachedReferences.has(e)&&e.hasLiveReference()&&(this.liveReferences.add(e),this.detachedReferences.delete(e));const n=this.hasLiveReference();if(t!==n){n?this.tracker.addLiveBlock(this):this.tracker.removeLiveBlock(this);for(const e of this.childBlocks.values())e.updateReference(this)}return this}getClosestPageAndTransclusionReferenceAncestors(){if(0===this.liveReferences.size)return[];if(this===this.tracker.rootBlock)return[this];const e=new Set,t=new Set,n=[this];for(;n.length>0;){const o=(0,r.TO)(n.shift());if(t.has(o))continue;const i=o.liveReferences;for(const t of i)"page"===t?e.add(o):"transclusion_reference"===t.blockStore.getType()?e.add(t):n.push(t);t.add(o)}return(0,r.T)(e.size>0),[...e]}destroy(){this.contentStoreListener&&(this.blockStore.getKeyStore("type").removeListener(this.contentStoreListener),this.blockStore.getContentStore().removeListener(this.contentStoreListener),this.blockStore.getFormatStore().getKeyStore("transclusion_reference_pointer").removeListener(this.contentStoreListener),this.contentStoreListener=void 0)}}var p=n(1898);class m{constructor(e){this.blockTextInstanceMap=void 0,this.textInstanceBlockMap=void 0,this.blockTextClocksListenerMap=void 0,this.pageBlockTracker=void 0,this.pageBlockTrackerListener=void 0,this.blockTextInstanceMap=new Map,this.textInstanceBlockMap=new Map,this.blockTextClocksListenerMap=new Map,this.pageBlockTracker=e,this.pageBlockTrackerListener=e=>this.handlePageEvent(e),this.pageBlockTracker.addListener(this.pageBlockTrackerListener);for(const{blockStore:t}of e.getLiveBlocks())this.addBlock(t)}handlePageEvent(e){const t=e.type;switch(t){case"add_block":this.addBlock(e.blockStore);break;case"remove_block":this.removeBlock(e.blockId);break;default:(0,p.t1)(t)}}addBlock(e){const t=e.id;if(this.blockTextClocksListenerMap.has(t))return;const n=e=>{this.handleTextClocksChange(t,e.getValue())};e.getSerializedTextClocksStore().addListener(n),this.blockTextClocksListenerMap.set(t,{blockStore:e,textClocksListener:n});const o=e.getSerializedTextClocksStore().getValue();this.handleTextClocksChange(t,o)}removeBlock(e){this.removeMappingForBlock(e);const{blockStore:t,textClocksListener:n}=(0,r.TO)(this.blockTextClocksListenerMap.get(e));t.getSerializedTextClocksStore().removeListener(n),this.blockTextClocksListenerMap.delete(e)}handleTextClocksChange(e,t){this.removeMappingForBlock(e);const n=t?Object.keys(t):[];for(const o of n)this.addBlockTextInstanceMapping(e,o)}removeMappingForBlock(e){const t=this.blockTextInstanceMap.get(e);if(t)for(const n of t)this.removeBlockTextInstanceMapping(e,n)}addBlockTextInstanceMapping(e,t){const n=this.blockTextInstanceMap.get(e)??new Set;n.add(t),this.blockTextInstanceMap.set(e,n);const o=this.textInstanceBlockMap.get(t)??new Set;o.add(e),this.textInstanceBlockMap.set(t,o)}removeBlockTextInstanceMapping(e,t){const n=(0,r.TO)(this.blockTextInstanceMap.get(e));n.delete(t),0===n.size&&this.blockTextInstanceMap.delete(e);const o=(0,r.TO)(this.textInstanceBlockMap.get(t));o.delete(e),0===o.size&&this.textInstanceBlockMap.delete(t)}getTextInstanceIdsForBlock(e){return this.blockTextInstanceMap.has(e)?[...(0,r.TO)(this.blockTextInstanceMap.get(e))]:[]}getBlockIdsForTextInstance(e){return this.textInstanceBlockMap.has(e)?[...(0,r.TO)(this.textInstanceBlockMap.get(e))]:[]}getBlockIdForTextInstanceItemId(e,t,n){const o=this.getBlockIdsForTextInstance(e);for(const i of o){const o=(0,r.TO)(this.blockTextClocksListenerMap.get(i)).blockStore;if((0,r.TO)(o.getTextSliceTree()).findTextSliceTreeContainingItemWithId(e,t,n))return o.id}}destroy(){for(const e of this.blockTextClocksListenerMap.keys())this.removeBlock(e);this.pageBlockTracker.removeListener(this.pageBlockTrackerListener)}}const f=new class{constructor(){this.pageInfoMap=new i.Z({getKey:e=>(0,o.dn)(e)})}trackPage(e){if(this.pageInfoMap.has(e.pointer))return void(0,r.TO)(this.pageInfoMap.get(e.pointer)).pageStores.add(e);const t=new d(e),n=e.useCrdt()?new m(t):void 0,o=new Set([e]);this.pageInfoMap.set(e.pointer,{pageBlockTracker:t,pageTextInstanceTracker:n,pageStores:o})}untrackPage(e){const t=e.pointer,n=(0,r.TO)(this.pageInfoMap.get(t));var o;(n.pageStores.delete(e),0===n.pageStores.size)&&(n.pageBlockTracker.destroy(),null===(o=n.pageTextInstanceTracker)||void 0===o||o.destroy(),this.pageInfoMap.delete(t))}clear(){for(const[t,n]of this.pageInfoMap){var e;n.pageBlockTracker.destroy(),null===(e=n.pageTextInstanceTracker)||void 0===e||e.destroy(),this.pageInfoMap.delete(t)}}getPageStoreForBlockStore(e){for(const[t,n]of this.pageInfoMap)for(const o of n.pageStores)if(o.uiLocation.contains(e.uiLocation))return o;for(const[t,n]of this.pageInfoMap)for(const o of n.pageStores){const t=this.pageInfoMap.get(o.pointer);if(null!=t&&t.pageBlockTracker&&t.pageBlockTracker.hasBlock(e.pointer.id))return o}}getPageBlockTrackerForPage(e){var t;return null===(t=this.pageInfoMap.get(e))||void 0===t?void 0:t.pageBlockTracker}getPageTextInstanceTrackerForPage(e){var t;return null===(t=this.pageInfoMap.get(e))||void 0===t?void 0:t.pageTextInstanceTracker}}},54843:(e,t,n)=>{n.d(t,{y:()=>i});var o=n(1898);function i(e){const t=e.getType();if(!t)return[];const n=e.getRenderableContentStores();if(n.length>0)return n;switch(t){case"transclusion_reference":const n=e.getTransclusionReferenceTargetStore();return n?[n]:[];case"text":case"page":case"personal_home_page":case"bulleted_list":case"numbered_list":case"toggle":case"quote":case"factory":case"button":case"to_do":case"column_list":case"column":case"embed":case"framer":case"tweet":case"gist":case"drive":case"audio":case"maps":case"invision":case"mixpanel":case"image":case"video":case"file":case"bookmark":case"equation":case"code":case"header":case"sub_header":case"sub_sub_header":case"collection_view":case"collection_view_page":case"breadcrumb":case"copy_indicator":case"divider":case"link_to_page":case"link_to_collection":case"figma":case"loom":case"typeform":case"codepen":case"pdf":case"callout":case"table_of_contents":case"whimsical":case"miro":case"abstract":case"sketch":case"excalidraw":case"replit":case"alias":case"transclusion_container":case"external_object_instance":case"table":case"table_row":case"tab":case"external_object_instance_page":case"hex":case"deepnote":case"ai_block":case"drawing":return[];default:(0,o.t1)(t)}}},18245:(e,t,n)=>{n.r(t),n.d(t,{NotionPerformanceClass_TEST_ONLY:()=>S,default:()=>_});n(57658);var o=n(1302),i=n(5809),r=n(68626),a=n(82138),s=n(12139),l=(n(53965),n(1898)),c=n(97978),d=n(53410),u=n(94134),p=n(85844),m=n(50112),f=n(76870),g=n(77080);const h=Object.entries(m.N);function v(e,t,n){if(!("memory"in(window.performance||{})))return;const o=Math.random();h.forEach((i=>{let[r,a]=i;if(!(r in window.performance.memory))return;const s=g.default.getConfigKey("event_trail_events",a),l=s&&"sampleRatesByMetric"in s&&"object"==typeof s.sampleRatesByMetric&&s.sampleRatesByMetric[t]||0;(0,f.aw)(l,(()=>o))&&function(e,t){const{type:n,bytes:o,data:i}=t;c.j(e,n,{bytes:o,...i})}(e,{type:a,bytes:window.performance.memory[r],data:{collected_during:t,...n}})}))}const b=new Set(["navigation_page_render","navigation_database_render","typing_lag"]);class y{constructor(){this.startTimesByMetricName={},this.lastVisibilityChange=0,p.Z.addListener((()=>{this.lastVisibilityChange=performance.now()}))}mark(e){var t;let n;if(Boolean(null===(t=performance)||void 0===t?void 0:t.mark)){const t=performance.mark(e);if(t)n=t.startTime;else{const t=performance.getEntriesByName(e);n=t[t.length-1].startTime}}else n=performance.now();const o="sentry"===u.getProfilingToolForSession()&&b.has(e)?s.Yr({name:e}):void 0;return this.startTimesByMetricName[e]={startTime:n,sentryTransaction:o},{metricName:e,startTime:n,sentryTransaction:o}}markAllOf(e){if(0===e.length)return;const t=performance.now();for(const n of e)this.startTimesByMetricName[n]={startTime:t,sentryTransaction:"sentry"===u.getProfilingToolForSession()&&b.has(n)?s.Yr({name:n}):void 0}}markEitherOf(e){if(0===e.length)return;const t=performance.now();for(const n of e)this.startTimesByMetricName[n]={startTime:t,sentryTransaction:"sentry"===u.getProfilingToolForSession()&&b.has(n)?s.Yr({name:n}):void 0,allMetricNamesMarked:e}}measure(e,t){this._measure(e,t)}measureAfterNextFlush(e,t){o.default.afterNextFlush((()=>{const n="getData"in t?t.getData():void 0;"getData"in t&&void 0===n||this._measure(e,{...t,data:n})}))}measureFromAppStart(e,t){if((0,a.Z)())return;const n="object"==typeof e?e.metricName:e,o=i.$();"number"==typeof o&&this.measure({metricName:n,startTime:o,..."object"==typeof e?{endTime:e.endTime}:{}},t)}measureFromAppStartAfterNextFlush(e,t){if((0,a.Z)())return;const n="object"==typeof e?e.metricName:e;o.default.afterNextFlush((()=>{const o="getData"in t?t.getData():void 0;if("getData"in t&&void 0===o)return;const r=i.$();"number"==typeof r&&this._measure({metricName:n,startTime:r,..."object"==typeof e?{endTime:e.endTime}:{}},{...t,data:o})}))}_measure(e,t){if("object"==typeof e){const{startTime:n,endTime:o,metricName:i,sentryTransaction:r}=e;this.startTimesByMetricName[i]=void 0;const a=this.getDuration({metricName:i,startTime:n,endTime:o});r&&r.finish(o),this.trackDuration({metricName:i,startTime:n,duration:a,options:t})}else if("string"==typeof e){const n=e,o=this.startTimesByMetricName[n];if(!o)return;const{startTime:i,allMetricNamesMarked:r,sentryTransaction:a}=o;if(r)for(const e of r)this.startTimesByMetricName[e]=void 0;else this.startTimesByMetricName[n]=void 0;const s=this.getDuration({metricName:n,startTime:i});a&&a.finish(),this.trackDuration({metricName:n,startTime:i,duration:s,options:t})}else(0,l.t1)(e)}getDuration(e){const{metricName:t,startTime:n,endTime:o}=e;try{return performance.measure(t,{start:n,..."number"==typeof o?{end:o}:{}}).duration}catch(i){return"number"==typeof o?o-n:performance.now()-n}}async trackDuration(e){const{metricName:t,duration:n,startTime:o,options:i}=e,{environment:a,data:s,preboot:l}=i;if(!document.hidden&&!("number"==typeof this.lastVisibilityChange&&o<this.lastVisibilityChange)&&await c.TA(t,i)){if(a.device.isElectron&&d.C&&d.C.windowIsVisible){if(!(await d.C.windowIsVisible()))return}"navigation_database_render"===t&&n>=6e4&&r.log({level:"info",from:"collections",type:"navigationPageRenderSlow",error:{message:`Got a slow navigation page render that took: ${n/1e3}s`},data:{miscDataToConvertToString:s}}),c.j(a,t,{time:n,...s},{preboot:l}),v(a,t,s)}}}const _=new y;class S extends y{}},30806:(e,t,n)=>{n.d(t,{$X:()=>r,Ai:()=>h,Aq:()=>u,Ay:()=>d,BX:()=>c,PQ:()=>m,SJ:()=>p,cY:()=>l,g8:()=>f,gF:()=>v,lj:()=>s,uD:()=>g,uY:()=>a});var o=n(97978),i=n(24646);function r(e){let{environment:t,from:n}=e;(0,o.j)(t,"open_home",{from:n,...(0,i.UF)({environment:t})})}function a(e){let{environment:t,args:n}=e;(0,o.j)(t,"home_loaded",n)}function s(e){let{environment:t}=e;(0,o.j)(t,"open_home_more_menu",{})}function l(e){const{environment:t,show:n,feature:i,from:r}=e;(0,o.j)(t,"toggle_home_feature",{show:n,feature:i,from:r})}function c(e){let{environment:t,oldValue:n,newValue:i,from:r}=e;(0,o.j)(t,"change_start_page",{old_value:n,new_value:i,from:r})}function d(e){let{environment:t,index:n,teamId:i}=e;(0,o.j)(t,"change_home_trending_source",{source_type:i?"team":"space",selected_index:n,selected_team_id:i})}function u(e){let{environment:t,from:n}=e;(0,o.j)(t,"click_empty_my_tasks",{from:n})}function p(e){let{environment:t,from:n}=e;(0,o.j)(t,"close_task_migration_modal",{from:n})}function m(e,t){(0,o.j)(e,"open_home_tip",t)}function f(e,t){(0,o.j)(e,"check_home_tip",t)}function g(e,t){(0,o.j)(e,"show_completed_home_tips",t)}function h(e,t){(0,o.j)(e,"home_tips_modal_error",t)}function v(e){let{environment:t}=e;(0,o.j)(t,"visit_home_help_page")}},14654:(e,t,n)=>{n.d(t,{ib:()=>s,t3:()=>l});var o=n(15145),i=n(1898),r=n(80444),a=n(94841);function s(e){let{blockOrCollectionId:t}=e;const n=l({blockOrCollectionId:t});switch(n){case"home":return o.tY.PersonalHomePage;case"home_tile_recents":return o.tY.PersonalHomeTileRecents;case"home_tile_trending":return o.tY.PersonalHomeTileTrending;case"home_tile_tips":return o.tY.PersonalHomeTileTips;case"home_tile_tasks":return o.tY.PersonalHomeTileTasks;case"home_tasks":return o.tY.PersonalHomePageTasks;case"home_tile_similar_users":return o.tY.PersonalHomeTileSimilarUsers;case"home_tile_most_visited":return o.tY.PersonalHomeTileMostVisited;case"home_tile_last_edited":return o.tY.PersonalHomeTileLastEdited;case"home_tile_favorites":return o.tY.PersonalHomeTileFavorites;case"home_unknown":return o.tY.PersonalHomeUnknown;case"home_tile_notes":return o.tY.PersonalHomeNotes;case void 0:return;default:(0,i.t1)(n)}}function l(e){let{blockOrCollectionId:t}=e;const n=(0,a.G)({blockOrCollectionId:t}),{mainEditorCurrentBlockStore:o}=r.default.state;if(n)switch(n){case"main":return"home";case"myTasksAssignedToMeCollectionView":case"myTasks":return(0,a.WE)(o)?"home_tile_tasks":"home_tasks";case"trendingCollectionView":return"home_tile_trending";case"similarUsersCollectionView":return"home_tile_similar_users";case"mostVisitedCollectionView":return"home_tile_most_visited";case"lastEditedCollectionView":return"home_tile_last_edited";case"favoritesCollectionView":return"home_tile_favorites";case"trending":case"trendingCollection":case"myTasks":case"similarUsers":case"similarUsersCollection":case"mostVisited":case"mostVisitedCollection":case"lastEdited":case"lastEditedCollection":case"favorites":case"favoritesCollection":return"home_unknown";default:(0,i.t1)(n)}}},94841:(e,t,n)=>{n.d(t,{Al:()=>_,Ep:()=>S,G:()=>v,J2:()=>w,Kj:()=>b,Vj:()=>k,WE:()=>y,_B:()=>I,pr:()=>C,su:()=>x});var o=n(59308),i=n(60310),r=n(70096),a=n(21202),s=n(6287),l=n(13493),c=n(53965),d=n(1898),u=(n(95477),n(18514)),p=n(95697),m=n(80444),f=n(6258);const g=(0,c.HP)(((e,t)=>i.hH({userId:e,spaceId:t})),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return JSON.stringify(t)})),h=(0,c.HP)(((e,t,n)=>{if(!e||!t||!n)return;const[o]=(0,d.qP)(g(t,n)).find((t=>{let[n,o]=t;return o===e}))??[];return o}),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return JSON.stringify(t)}));function v(e){var t,n;let{blockOrCollectionId:o}=e;const i=null===(t=m.default.state.currentUserStore)||void 0===t?void 0:t.id,r=null===(n=m.default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(i&&r&&o)return h(o,i,r)}function b(e){return(0,d.$K)(v({blockOrCollectionId:e}))}function y(e){return!!e&&"main"===v({blockOrCollectionId:e.id})}function _(e){const t=null==e?void 0:e.getParentId(),n=null==e?void 0:e.getSpaceId();if(!t||!n||!e)return;const o=g(t,n).main,i=e.getSpaceStore();return o&&i?f.G.createChildStore(i,{table:a.iU,id:o,spaceId:i.id}):void 0}function S(e){var t,n;const o=null===(t=m.default.state.currentUserStore)||void 0===t?void 0:t.id,i=null===(n=m.default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(o&&i)return g(o,i)[e]}function w(e){const t=m.default.state.currentSpaceStore;if(!t)return;const n=t.id;switch(e){case"main":case"myTasks":case"trending":case"similarUsers":case"mostVisited":case"lastEdited":case"favorites":const o=S(e);return o?f.G.createChildStore(t,{table:a.iU,id:o,spaceId:n}):void 0;case"myTasksAssignedToMeCollectionView":case"similarUsersCollectionView":case"trendingCollectionView":case"mostVisitedCollectionView":case"lastEditedCollectionView":case"favoritesCollectionView":const i=S(e);return i?f.Xr.createChildStore(t,{table:l.np,id:i,spaceId:n}):void 0;case"trendingCollection":case"similarUsersCollection":case"mostVisitedCollection":case"lastEditedCollection":case"favoritesCollection":const r=S(e);return r?f.NW.createChildStore(t,{table:s.vF,id:r,spaceId:n}):void 0;default:(0,d.t1)(e)}}function k(e,t){let n;switch(e){case"table":n=t.table_properties;break;case"board":n=t.board_properties;break;case"calendar":n=t.calendar_properties;break;case"list":n=t.list_properties;break;case"gallery":n=t.gallery_properties;break;case"timeline":n=t.timeline_properties}return{list_properties:(0,p.QI)("dev_only")?n:[{visible:!0,property:"title"},{width:200,visible:!0,property:o.Es.DueDate},{width:200,visible:!0,property:o.Es.Status,statusShowAs:"select"},{width:200,visible:!0,property:o.Es.Location},{visible:!1,property:o.Es.Assign,width:200},{visible:!1,property:o.Es.Reporter,width:200},{visible:!1,property:o.Es.CreatedTime,width:200},{visible:!1,property:o.Es.LastEditedTime,width:200},{visible:!1,property:o.Es.LastEditedBy,width:200}],collection_group_by:void 0,collection_peek_mode:r.l,inline_collection_first_load_limit:{type:"load_limit",limit:20}}}function I(){return{collection_peek_mode:r.l,inline_collection_first_load_limit:{type:"load_limit",limit:20}}}function C(e){var t;if(!(0,p.QI)())return!1;if(e.device.isMobile)return!1;const{currentUserSettingsStore:n,currentSpaceStore:o,currentSpaceViewStore:r}=m.default.state;if(!n||!n.isReady())return!1;const a=n.getSettings();if(!a)return!1;const s=null==o?void 0:o.getSetting("first_invited_member_time");return!(s&&s>i.m_)&&((null==r||null===(t=r.getPersonalHomeSettings())||void 0===t||!t.hide_new_badge)&&!0!==a.seen_personal_home)}const x=(0,u.UY)("guides.taskDatabases")},42092:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(35431),i=n(1898),r=n(62619);class a extends o.Z{containedByAssistantEditCard(e){return Boolean(this.find((t=>{const n=t.getNode();return n instanceof HTMLElement&&(0,r.r3)(n,e)})))}getEditById(e){for(const t of this.members)for(const n of t.getGroups())if("updatedPage"===n.type){if(!n.didCreatePage)for(const t of n.groupedEdits)if(t.editId===e)return t}else"removedPage"===n.type||(0,i.t1)(n)}}const s=new a},58299:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(76796);class i extends o.B{findBlockPropertyValue(e,t,n){return this.find((o=>{const i=o.getProps();return i.store===e&&i.property===t&&(!n||i.format===n)}))}findBlockPropertyValueByBlockId(e,t,n){return this.find((o=>{const i=o.getProps();return i.store.id===e&&i.property===t&&(!n||i.format===n)}))}getRect(e,t){const n=this.findBlockPropertyValue(e,t);if(n){const e=n.getNode();if(e&&e instanceof Element)return e.getBoundingClientRect()}}}const r=new i},58202:(e,t,n)=>{n.d(t,{R:()=>s});var o=n(35431),i=n(92595),r=n(53223);class a extends o.Z{findBlockFromStore(e){return this.find((t=>t.getBlockStore()===e))}findAllBlocksFromStore(e){return this.filter((t=>t.getBlockStore()===e))}findBlockFromStoreWithMethod(e,t){return this.find((n=>n.getBlockStore()===e&&"function"==typeof n[t]))}findBlockFromId(e){return this.find((t=>{const n=t.getBlockStore();return n&&n.id===e}))}findNodeFromStore(e){const t=this.findBlockFromStore(e);if(t)return t.getNode()}getRect(e){const t=this.findNodeFromStore(e);if(t&&t instanceof Element)return t.getBoundingClientRect()}findCollectionViewBlockFromStore(e){return this.find((t=>t.getBlockStore()===e&&(0,r.wA)(t)))}findCollectionViewBlockFromId(e){return this.find((t=>{var n;return Boolean((null===(n=t.getBlockStore())||void 0===n?void 0:n.id)===e&&(0,r.wA)(t))}))}}const s=new a;(0,i.exposeDebugValue)("GlobalBlockRegistry",s)},89574:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{}const r=new i},46351:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{}const r=new i},47372:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{}const r=new i},27406:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(35431),i=n(92595);class r extends o.Z{constructor(){super(...arguments),this.isDropTargetForKey=(e,t)=>e.props.dropTargetKey===t}findDropTargetFromKey(e){return this.find((t=>this.isDropTargetForKey(t,e)))}findDropTargetsFromKey(e){return this.filter((t=>this.isDropTargetForKey(t,e)))}}const a=new r;(0,i.exposeDebugValue)("GlobalDropTargetRegistry",a);const s=a},28685:(e,t,n)=>{n.d(t,{E:()=>r});var o=n(35431);class i extends o.Z{findEditableWithinSelectable(e){return this.find((t=>t.getContextClosestSelectable()===e))}findEditableWithStore(e){return this.find((t=>t.props.store===e))}findNodeFromStore(e){const t=this.findEditableWithStore(e);if(t)return t.getNode()}findStoreFromNode(e){const t=this.find((t=>t.getNode()===e));if(t)return t.props.store}}const r=new i},3994:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(76796);class i extends o.B{shouldPreventMobileAutoScroll(e){const t=this.find((t=>t.capture&&!(t.allowMobileAutoScroll&&e.device.isMobile)));return Boolean(t)}}const r=new i},75987:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{isInlineAutocompleteOpen(){const e=this.find((e=>e.props.isOpen));return Boolean(e)}}const r=new i},81844:(e,t,n)=>{n.d(t,{Z:()=>r});n(57658);var o=n(35431);class i extends o.Z{findOutlinerItemFromStore(e){if(e)return this.find((t=>t.store===e))}findOutlinerItemsFromId(e){const t=[];return this.forEach((n=>{n.store.id===e&&t.push(n)})),t}}const r=new i},49427:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(35431),i=n(85644),r=n(82136);class a extends o.Z{isBlockInFrame(e){const t=e.getRecordStoreUIRoot();return Boolean(this.find((e=>e.props.context===r.S.Frame&&e.props.store===t)))}isBlockInTemplate(e){const t=e.getRecordStoreUIRoot();return Boolean(this.find((e=>e.props.context===r.S.InAppTemplatePreview&&e.props.store===t)))}isBlockInPageSnapshot(e){const t=e.getRecordStoreUIRoot();return Boolean(this.find((e=>e.props.context===r.S.InPageSnapShot&&e.props.store===t)))}isBlockInWiki(e){const t=e.getRecordStoreUIRoot();return Boolean(this.find((e=>(0,i.A)(e.props.store)&&e.props.store===t)))}}const s=new a},64815:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{}const r=new i},16339:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{}const r=new i},95802:(e,t,n)=>{n.d(t,{C:()=>p});n(52262),n(24506);var o=n(35431),i=n(92595),r=n(21202),a=n(53965),s=n(98165),l=n(28685),c=n(6258),d=n(27724);class u extends o.Z{getMembersByDOMOrder(e){let{filter:t}=e;return super.getMembersByDOMOrder({filter:e=>!e.props.isHoverMenu&&t(e)})}findSelectableFromStore(e){return this.find((t=>t.props.store===e))}findScrollToSelectableFromStore(e){return this.find((t=>t.props.store===e&&t.props.canSelect&&!t.props.disableScrollToReveal&&t.getContextSelectableContainer()===d.default.getCurrentDefaultContainer()))}findScrollToSelectablesFromIds(e){return this.filter((t=>e.includes(t.props.store.id)&&t.props.canSelect&&!t.props.disableScrollToReveal&&t.getContextSelectableContainer()===d.default.getCurrentDefaultContainer()))}findNearestScrollToSelectablesFromIds(e,t){return t.map((t=>{const n=c.G.createChildStore(e,{id:t,table:r.iU}),o=(0,s.qA)(n).filter((e=>e.isTable(r.iU)));return this.findScrollToSelectablesFromIds(o.map((e=>e.id))).at(0)}))}findSelectablesFromStore(e){return this.filter((t=>t.props.store===e))}findNodeFromStore(e){const t=this.findSelectableFromStore(e);if(t)return t.getNode()}getRectFromStore(e){const t=this.findNodeFromStore(e);if(t&&t instanceof Element)return t.getBoundingClientRect()}findEditableStoreWithin(e){const t=this.findSelectableFromStore(e);if(t){const e=l.E.findEditableWithinSelectable(t);if(e)return e.props.store}}findSelectablesFromIds(e){const t=d.default.getCurrentDefaultContainer(),n=this.getMembersByDOMOrder({filter:()=>!0});return a.oA(e.map((e=>n.find((n=>{const o=n.props.store,i=n.getContextSelectableContainer();return Boolean(o&&o.id===e&&i===t)})))))}findAllSelectablesFromIds(e){const t=d.default.getCurrentDefaultContainer(),n=this.getMembersByDOMOrder({filter:()=>!0});return a.xH(e.map((e=>n.filter((n=>{const o=n.props.store,i=n.getContextSelectableContainer();return Boolean(o&&o.id===e&&i===t)})))))}findNodeFromBlockId(e){var t;const n=this.findSelectablesFromIds([e]);return null==n||null===(t=n[0])||void 0===t?void 0:t.getNode()}findSelectableFromChildNode(e){const t=this.getMembersByDOMOrder({filter:t=>{var n;return null===(n=t.getNode())||void 0===n?void 0:n.contains(e)}});return t[t.length-1]}}const p=new u;(0,i.exposeDebugValue)("GlobalSelectableRegistry",p)},75822:(e,t,n)=>{n.d(t,{E5:()=>i,rE:()=>r,vp:()=>o});const o=300,i=75,r=225},43759:(e,t,n)=>{n.d(t,{Qu:()=>a,RA:()=>m,U3:()=>p,pv:()=>u});var o=n(58573),i=n(53965),r=n(77907);const a=3,s=5,l=new Set(["a","an","and","are","as","at","be","but","by","for","if","in","is","it","of","on","or","that","the","to","was","will","with"]);function c(e,t,n){return e.length>=a}function d(e,t,n){return e.length>=s&&.2}function u(e){return e.split(/[^\w]+/g).filter((e=>!l.has(e)))}async function p(){const{default:e}=await r.deps.minisearch.loader(),t=new e({fields:["text","id","inits"],storeFields:["block"],searchOptions:{prefix:c,fuzzy:d},tokenize:(e,t)=>e.split(/\s/g),processTerm:(e,t)=>{const n=e.toLowerCase();if(!l.has(e))switch(t){case"text":{const e=u(n).filter((e=>e.length>a));return(0,i.jj)([n,...e])}case"inits":return[...Array(e.length).keys()].slice(0,e.length-a+1).map(((e,t)=>n.slice(t)));default:return n}}});return{index:t,getAllBlocks:()=>t.search(e.wildcard)}}function m(e,t){const n=e.toLowerCase(),i=t.toLowerCase();if(n===i)return o.DF;const r=i.indexOf(n);return 0===r?o.uI:" "===i[r-1]?o.V5:r>-1?o.T6:1}},96820:(e,t,n)=>{n.d(t,{S:()=>F});n(57658);var o=n(1898),i=n(41432),r=n(80951),a=n(59753),s=n(21202),l=n(6287),c=n(70203);const d={indexTimeMs:!0,title:!0,children_contents:!0,children_ids:!0,children_permissions:!0,children_fractional_index:!0,children_types:!0,alive:!0,created_by_id:!0,created_by_table:!0,created_time:!0,format:!0,id:!0,is_template:!0,last_edited_by_id:!0,last_edited_time:!0,parent_table:!0,permissions:!0,space_id:!0,team_id:!0,team_name:!0,team_is_archived:!0,auto_increment_id:!0,type:!0,version:!0,ancestors:!0,audience:!0,db_schema_source_partition:!0,depth:!0,is_path_alive:!0,is_top_level_page:!0,parent_id:!0,path_text:!0,search_permissions:!0,inherited_permissions:!0,parent_page_id:!0,collection_id:!0,parent_collection_id:!0,page_views:!0,unique_page_views:!0,collection_properties:!0,children_last_edited_times:!0,mentions_dictionary:!0},{audience:u,...p}=((0,o.Yd)(d),d);(0,o.Yd)(p);function m(e){const{getRecordValue:t,blockValue:n}=e;let o="";const d={user:new Map},u=a.kk.fromBlock(n),p=a.om.fromGetRecordValueFn(t);if(u.isCollectionView()){const e=function(e){const{getRecordModel:t,model:n}=e,o=n.getRenderFormatPointer(t);if(!o)return;const i=t(o);if(!i)return;if(i.table===s.iU)return(0,r.wS)(i,"title")||[];if(i.table===l.vF)return i.getNormalizedName()}({model:u,getRecordModel:p});e&&e.length>0&&(o=c.Qh7(e,p,d).text)}else if(u.isType("file")){o=`${c.Qh7(u.getProperty("title"),p,d).text} ${c.Qh7(u.getProperty("caption"),p,d).text}`}else if(u.isType("bookmark")){o=`${c.Qh7(u.getProperty("title"),p,d).text} ${c.Qh7(u.getProperty("description"),p,d).text} ${c.Qh7(u.getProperty("caption"),p,d).text}`}else if(u.isType(i.Ok)){const e=u.getProperty("caption");o=c.Qh7(e,p,d).text}else if(u.isType(i.Ti.tableRow)){const e=function(e){const{blockModel:t,getRecordModel:n}=e,o=n({table:s.iU,id:t.getParentId(),spaceId:t.getSpaceId()});return null==o?void 0:o.getFormatValue("table_block_column_order")}({blockModel:u,getRecordModel:p});if(e){o=e.map((e=>c.Qh7(u.getProperty(e),p,d).text)).join(" ")}}else{const e=(0,r.wS)(n,"title");o=c.Qh7(e,p,d).text}return{text:o.trim()||void 0,mentions:d}}var f=n(58203),g=n(63306),h=n(73360),v=n(74446),b=n(45953),y=n(33361),_=n(53965),S=n(28020),w=n(45950),k=n(98165),I=n(48779),C=n(95697),x=n(71384),T=n(77080),M=n(46735),P=n(69327),A=n(6258),R=n(42198),D=n(43759);const E=432e5,B=1e3;async function F(e){const{environment:t,currentSpaceStore:n,currentSpaceViewStore:o,excludeCurrentPage:r}=e,{id:l}=n,c=new Map,d=new Set;function u(e,t){var n;c.has(e)?null===(n=c.get(e))||void 0===n||n.add(t):c.set(e,new Set([t]))}const p=new Map,F=(new Date).getTime();if(o)for(const i of o.getBookmarkedPageIds())u(i,"bookmarkedPage");const O=P.Z.get(l);O&&O.forEach(((e,t)=>{let{pageId:n,visitedAt:o}=e;u(n,"recentVisit"),d.add(n),p.set(n,{index:t,timeSinceLastViewed:F-o})}));const Z=(0,I.ns)(t,n);for(const i of Z)u(i,"spacePage");const V=(0,C.xo)();for(const i of V)u(i,"teamPage");const U=t.currentUser.id;if(o){for(const{id:n}of(0,I.KA)(t,o))u(n,"sharedPage");const e=F-E;t.defaultRecordCache.inMemoryRecordCache.forEachRecord(U,(t=>{let{model:o}=t;if(o.table===s.iU&&l===n.id){const{id:t,last_edited_time:n,last_edited_by_id:r,type:a}=o;(0,i.S9)(a)&&r===U&&n&&n>e&&(u(t,"defaultRecordCache"),d.add(t))}}))}const L=M.Z.getVisitedIds(U);for(const i of L)u(i,"frecencyStore"),d.add(i);const j=U?T.default.getEligibleGroup({experimentId:"search-new-local-recall-v2",parameter:"userSignals",defaultGroup:[]})??[]:[],N=R.default.getUserSignals({spaceId:l,userId:U});var z,q,W,H;j.includes("sim_user_visits")&&(null==N||null===(z=N.similarUserRecentPages)||void 0===z||z.pagesMetadata.forEach(((e,t)=>{u(t,"similarUser1dRecentPages"),d.add(t)})));j.includes("popular_pages")&&(null==N||null===(q=N.topPages7dPageView)||void 0===q||q.forEach(((e,t)=>{u(t,"topPages7dPageView"),d.add(t)})));j.includes("user_edits")&&(null==N||null===(W=N.editedPages1d)||void 0===W||W.forEach(((e,t)=>{u(t,"editedPages1d"),d.add(t)})));j.includes("sim_user_edits")&&(null==N||null===(H=N.similarUsersEditedPages1d)||void 0===H||H.forEach(((e,t)=>{u(t,"similarUsersEditedPages1d"),d.add(t)})));if(r){const e=(0,S.np)();e&&c.delete(e.id)}const K=b.PF.create();await(0,y.uf)({recordPointers:Array.from(c.keys()).map((e=>({table:s.iU,id:e}))),recordMap:K,loadRecordModel:e=>(0,w.Ye)({environment:t,pointer:e}),recurFn:e=>_.oA([(0,h.tz)(e)&&e.getParentPointer(),e.table===s.iU&&e.getCollectionPointer()])});const G=v.mF.fromRecordMapWithRole(K),$=a.om.fromGetRecordValueFn(G),Q=new Array;for(const[i,a]of c.entries()){const e={table:s.iU,id:i};let t,o;if(d.has(i)?(t=A.t1.createChildStore(n,e),o=t.getModel()):o=$(e),!o)continue;const r=(0,g.Wq)(e,K);if(0===r.length)continue;if(o.getSpaceId()!==n.id)continue;const l=(0,f.$B)(m({blockValue:o,getRecordValue:G}).text);if(!l)continue;if(!a)continue;const c=(0,k.KU)(r);if(c&&Boolean(c.value.archived_by))continue;const u=l.substring(0,B).trim(),h=p.get(i);Q.push({blockModel:o,text:u,path:r,source:a,indexInRecentPages:h?h.index:void 0,timeSinceLastViewedMs:h?h.timeSinceLastViewed:void 0,blockStore:t})}const{index:Y,getAllBlocks:J}=await(0,D.U3)(),X=Q.map((e=>({id:e.blockModel.id,text:e.text,inits:e.text.split(" ").map((e=>e[0])).join(""),block:e}))),ee={spaceId:n.id,userId:U,blocks:Q,environment:t},te=Y.addAllAsync(X),ne=x.Z.updatePageSignals(ee);return await Promise.all([te,ne]),{spaceId:n.id,blocks:Y,getAllBlocks:J,recordMap:K}}},75419:(e,t,n)=>{n.d(t,{AP:()=>s,DD:()=>r,TN:()=>a,bP:()=>l});var o=n(1898),i=n(16746);function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"peek";i.Z.setState({...i.Z.state,contentType:e,openState:"opening",mode:t})}function a(){i.Z.setState({...i.Z.state,openState:"closing"})}function s(e){const t=i.Z.isVisible(),n=i.Z.state.contentType;t&&n===e?a():r(e)}function l(){const e=i.Z.state.mode;let t;switch(e){case"peek":t="panel";break;case"panel":t="peek";break;default:(0,o.t1)(e)}return i.Z.setState({...i.Z.state,mode:t}),t}},48276:(e,t,n)=>{n.d(t,{VV:()=>a,l_:()=>r,yj:()=>s});var o=n(28161),i=n(16746);function r(){return o.ZP.getWidth()}function a(){const e=i.Z.state.openState,t=i.Z.state.mode;return"closed"===e||"closing"===e||"peek"===t?0:r()}function s(){return i.Z.isPeekDismissableState()?r():0}},28161:(e,t,n)=>{n.d(t,{ZP:()=>g,o$:()=>c,um:()=>l});var o=n(49085),i=n(54153),r=n(53965),a=n(66353),s=n(16746);const l=320,c=470,d="secondary_sidebar",u={widths:{none:320,inbox:390,private_pages:320}};function p(e){i.Z.set(d,e)}class m extends o.default{getInitialState(){return function(){const e=i.Z.get(d),t=void 0===r.U2(e,["widths","inbox"]),n=r.TS(r.Xh(u),e);if(t){const e=i.Z.get(a.Jr),t=r.U2(e,["width"]);if(void 0!==t){n.widths.inbox=t;try{p(n)}catch{}}}return n}()}getWidth(){const e=s.Z.state.contentType,t=this.state.widths[e];return t<=l?l:t>=c?c:t}setWidth(e){const t=s.Z.state.contentType;this.setState({...this.state,widths:{...this.state.widths,[t]:e}})}}const f=new m;f.addListener((e=>{try{p(e.state)}catch{}}));const g=f},16746:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(1898);class r extends o.default{getInitialState(){return{mode:"peek",openState:"closed",contentType:"none",isResizerHovered:!1,isResizing:!1}}isOpen(){const{openState:e}=this.state;switch(e){case"open":case"opening":return!0;case"closed":case"closing":return!1;default:(0,i.t1)(e)}}isVisible(){const{openState:e}=this.state;switch(e){case"open":case"opening":case"closing":return!0;case"closed":return!1;default:(0,i.t1)(e)}}isTransitioningState(){const{openState:e}=this.state;switch(e){case"opening":case"closing":return!0;case"open":case"closed":return!1;default:(0,i.t1)(e)}}isPeekDismissableState(){return"peek"===this.state.mode&&this.isVisible()}}const a=new r},40134:(e,t,n)=>{n.d(t,{B:()=>i});var o=n(51);function i(e){var t;let{blockId:n,setting:i}=e;const{publicPageData:r}=o.Z.state;if((null==r?void 0:r.pageId)!==n)return;return null===(t=r.securitySettings)||void 0===t?void 0:t[i]}},90335:(e,t,n)=>{n.d(t,{HB:()=>h,Np:()=>g,bQ:()=>f,gi:()=>v,mk:()=>_,pR:()=>b,up:()=>m});var o=n(87479),i=n(72141),r=n(21202),a=n(75246),s=n(29369),l=n(53965),c=n(98165),d=n(46654),u=n(80444),p=n(6258);function m(e){const{store:t,showRestrictedPermissionBanner:n}=e,{canAccessParent:o}=h({store:t});return o&&(n||g({store:t}))}function f(e){const{store:t}=e;if(t.getParentTable()===a.bx)return;const n=(0,c.Om)(t);if(!n)return;const r=(0,o.Wo)((0,c.fJ)(n));for(const o of r)if((0,i.ix)(o))return o}function g(e){const{store:t}=e;if(t.getParentTable()===a.bx)return!1;const n=(0,c.Om)(t),r=n?(0,o.Wo)((0,c.fJ)(n)):[],s=t.getPermissionItems(),l={};for(const i of r)l[(0,o.OC)(i)]=i;for(const a of s){const e=a.role,t=l[(0,o.OC)(a)];if(t){if((0,i.iC)(e)&&(0,i.iC)(t.role)&&(0,o.xO)(e,t.role))return!0;if(i.KF(t)&&!i.KF(a))return!0}else if((0,i.ix)(a)||(0,i.ZQ)(a)||(0,i.RI)(a))return!0}return!1}function h(e){const{store:t}=e,n=(0,c.uJ)(t)[1];return{parentStore:n,canAccessParent:n&&n.canRead()}}function v(e){const{store:t}=e,n=(0,c.uJ)(t),o=n.find((e=>e instanceof p.G&&e.isRestricted())),i=n[n.length-1];return o||i.getParentTable()===a.bx&&i.canRead()}function b(e){const{store:t}=e,n=(0,c.VP)(t),o=u.default.state.currentSpaceStore;return Boolean((null==o?void 0:o.getDisableGuests())||(null==n?void 0:n.getDisableGuests()))}function y(e){const{mostPermissivePermissions:t,store:n,ancestorTeamId:o,type:a}=e;if(!o)return;const s=t.find((e=>{let{permissionItem:t}=e;return t.type===a&&t.team_id===o}));if(s)return s;const l=t.find((e=>{let{permissionItem:t}=e;return i.Le(t)}));return"explicit_team_guest_permission"!==a||l?{permissionItem:{type:a,role:"none",team_id:o},from:(null==l?void 0:l.from)??{table:r.iU,blockId:n.id}}:void 0}function _(e){const{spaceStore:t,store:n}=e,o=(0,d.YO)(n);let a=[];t&&(a=t.getPermissionGroups());const u=c.VP(n),p=function(e){let{mostPermissivePermissions:t,store:n}=e;const o=t.find((e=>{let{permissionItem:t}=e;return i.$D(t)}));return o||{permissionItem:{type:"public_permission",role:"none"},from:{table:r.iU,blockId:n.id}}}({mostPermissivePermissions:o,store:n}),m=function(e){let{mostPermissivePermissions:t,store:n,teamStore:o}=e;const a=t.find((e=>{let{permissionItem:t}=e;return i.ix(t)}));if(a)return a;const l=t.find((e=>i.Le(e.permissionItem)));return{permissionItem:{type:"space_permission",role:"none"},from:null!=l&&l.from||!o||"none"!==o.getSpacePermissionRole()?(null==l?void 0:l.from)??{table:r.iU,blockId:n.id}:{table:s.e0,teamId:o.id}}}({mostPermissivePermissions:o,store:n,teamStore:u}),f=y({mostPermissivePermissions:o,store:n,ancestorTeamId:null==u?void 0:u.id,type:"explicit_team_guest_permission"}),g=y({mostPermissivePermissions:o,store:n,ancestorTeamId:null==u?void 0:u.id,type:"explicit_team_permission"}),h=y({mostPermissivePermissions:o,store:n,ancestorTeamId:null==u?void 0:u.id,type:"explicit_team_owner_permission"});let v=o.filter((e=>{let{permissionItem:t}=e;return i.hV(t)}));v=l.MR(v,(e=>{if(t){return t.getPermissionGroups().findIndex((t=>t.id===e.permissionItem.group_id))}return e.permissionItem.group_id}));let b=o.filter((e=>{let{permissionItem:t}=e;return(i.zU(t)||i.LW(t))&&t.team_id!==(null==u?void 0:u.id)}));const _=new Map;b.forEach(((e,t)=>{let{permissionItem:n}=e;_.has(n.team_id)||_.set(n.team_id,t)})),b=l.MR(b,[e=>{let{permissionItem:t}=e;return _.get(t.team_id)||0},e=>{let{permissionItem:t}=e;return"explicit_team_owner_permission"===t.type?0:1}]);const S=o.filter((e=>{let{permissionItem:t}=e;return i.jg(t)})),w=Boolean(null==u?void 0:u.isDefined()),k="none"!==m.permissionItem.role,I=k||w||S.length>1||S.length&&!i.zz(S[0].permissionItem.role)||v.length||i.YX(m.permissionItem.role);return{showRestrictedPermissionBanner:o.some((e=>i.Le(e.permissionItem)&&e.from.table===r.iU&&e.from.blockId===n.id)),showTeamPermission:w,showSpacePermission:k,mostPermissivePublicItem:p,mostPermissiveAncestorTeamOwnerItem:h,mostPermissiveAncestorTeamMemberItem:g,mostPermissiveAncestorTeamGuestItem:f,mostPermissiveSpaceItem:m,pagePermissionUIModel:{showUserPermissions:I,mostPermissiveGroupPermissions:v,mostPermissiveTeamPermissions:b,mostPermissiveUserPermissions:S,spacePermissionGroups:a},permissionItemsCount:(I?S.length:0)+b.length+v.length+(k?1:0)+(w?1:0)}}},28578:(e,t,n)=>{n.d(t,{Sw:()=>l,T5:()=>s,XF:()=>r,ZP:()=>d,wV:()=>a});var o=n(49085),i=n(7032);let r=function(e){return e.Share="share",e.Publish="publish",e}({}),a=function(e){return e.MainShareMenu="mainShareMenu",e.Invite="invite",e.Publish="publish",e}({}),s=function(e){return e.Notion="notion",e.Slack="slack",e}({}),l=function(e){return e.Search="search",e.Message="message",e}({});class c extends o.default{getInitialState(){return{sessionId:(0,i.ZP)(),display:a.MainShareMenu,tab:r.Share}}}const d=new c},74948:(e,t,n)=>{n.r(t),n.d(t,{AssistantChatHistoryWidthThreshold:()=>ae,OnlyOneSidebarVisibleWidthThreshold:()=>ie,SidePeekCloseLeftSidebarFrameWidthThreshold:()=>re,bookmarkPage:()=>ve,cancelSidebarInitialRenderLog:()=>Be,close:()=>le,closeAssistantChatHistory:()=>Fe,closeAssistantChatHistoryIfTooNarrow:()=>Ze,handleSidebarButtonClick:()=>de,initialize:()=>Pe,leaveBlocks:()=>he,newPageMessages:()=>ke,open:()=>se,openAssistantChatHistoryIfWideEnough:()=>Oe,pinSharedPage:()=>ye,quickAddPage:()=>we,setExpand:()=>ce,setPeekWidth:()=>ge,setUpdateExpand:()=>ue,setUpdateSidebarCommentsMode:()=>Re,setUpdateSidebarCommentsTypeMode:()=>De,setUpdateSidebarTab:()=>Ae,setUpdateWidth:()=>fe,setWidth:()=>me,toggleBothSidebars:()=>Ee,toggleLeftSidebarByWindowSize:()=>pe,unbookmarkPage:()=>be,unpinSharedPage:()=>_e});var o=n(1302),i=n(15145),r=n(23867),a=n(54153),s=n(9291),l=n(952),c=n(66324),d=n(54642),u=n(54564),p=n(98834),m=n(94419),f=n(11302),g=n(17659),h=n(89858),v=n(87420),b=n(9953),y=n(75754),_=n(26999),S=n(8055),w=n(13447),k=n(1742),I=n(37181),C=n(81598),x=n(27105),T=n(73203),M=n(75770),P=n(58239),A=n(18514),R=n(45010),D=n(48779),E=n(18245),B=n(75419),F=n(16746),O=n(5162),Z=n(80444),V=n(8949),U=n(66949),L=n(77080),j=n(3418),N=n(475),z=n(42330),q=n(79689),W=n(88923),H=n(24864),K=n(6258),G=n(69784),$=n(82187),Q=n(62820),Y=n(81023),J=n(24646),X=n(38676),ee=n(97852),te=n(77999),ne=n(36896),oe=n(36391);const ie=1024,re=430,ae=600;function se(e){let{fromElectron:t}=e;X.sidebarOpenStore.state||G.default.state.isActive||U.Z.isOpen()||F.Z.isOpen()||(X.sidebarOpenStore.setState(!0),t&&X.sidebarElectronMousePeekStore.setState(!0))}function le(){!X.sidebarOpenStore.state||N.Z.state.open||Q.Z.state.open||ne.Z.state.open||ee.Z.state.open||V.Z.state.isActive||$.Z.state.clonedBlockStore||X.sidebarResizingStore.state.isResizing||!(0,q.c)()||j.Z.state.namedOpenPopups.has("team_more_actions")||j.Z.state.namedOpenPopups.has("teams_heading_actions")||(X.sidebarMousePeekXStore.setState(0),X.sidebarOpenStore.setState(!1),X.sidebarElectronMousePeekStore.setState(!1))}function ce(e){if((0,O.Y)("supportsNativeHome"))return;"inactive"===te.default.state.type||e.isExpanded||te.default.setState({type:"inactive"});const t=E.default.mark("sidebar.toggle_expanded_lag");X.sidebarExpandedStore.setState(e.isExpanded),Te(),W.default.setSidebarExpandedStoreState(e.isExpanded),e.isExpanded&&e.environment.WindowSizeStore.state.width<ie&&(0,J.Sx)(e.environment)&&ue({environment:e.environment,isExpanded:!1,from:"close_for_space"}),e.isExpanded&&(0,J.$3)(e.environment)<re&&v.xv(e.environment,"sidebar_expand"),e.isExpanded?c.LM(e.environment):c.Qd(e.environment),E.default.measureAfterNextFlush(t,{environment:e.environment,getData:()=>({is_expanded:e.isExpanded,from:e.from})})}function de(e,t,n,o){const r=W.default.state.open,{currentTab:a}=oe.ZP.state,s=a!==n||a===n&&!(0,J.Sx)(e);n===oe.gY.Comments&&(a!==n||!(0,J.Sx)(e))?oe.ZP.setState({...oe.ZP.state,currentTab:n,timeOpenedComments:Date.now()}):oe.ZP.setState({...oe.ZP.state,currentTab:n}),r?(y._c({environment:e,store:t,pageVisitSource:i.tY.Expand}),ue({environment:e,isExpanded:!0,from:o})):ue({environment:e,isExpanded:s,from:o})}function ue(e){var t;const{isExpanded:n,environment:o,from:i}=e;if(n||u.LZ(),n){o.WindowSizeStore.state.width<ie&&(0,J.in)(o)&&ce({environment:o,isExpanded:!1,from:`set_update_expand_${e.from}`}),F.Z.isOpen()&&("inbox"===F.Z.state.contentType?g.qQ({open:!1,environment:o}):B.TN());const t=oe.ZP.state.currentTab,n={origin:W.default.state.open?"peek_view":"page",from:i};t===oe.gY.Comments?c.v$(o,n):t===oe.gY.Updates&&c.ph(o,n)}oe.ZP.setState({...oe.ZP.state,expanded:n,mouseEntered:!!n||oe.ZP.state.mouseEntered,openedOnBlockId:W.default.state.open&&W.default.state.target.id||(null===(t=Z.default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.id),canRender:!0}),Me()}function pe(e){W.default.state.savedSidebarExpandedStoreState&&!X.sidebarExpandedStore.state&&function(e){if(X.sidebarExpandedStore.state||!W.default.state.savedSidebarExpandedStoreState)return;W.default.isSidePeekOpen()&&(0,J.$3)(e)-(0,J.qG)(e)>=re&&X.sidebarExpandedStore.setState(!0)}(e),X.sidebarExpandedStore.state&&function(e){const t=X.sidebarExpandedStore.state&&0===(0,J.Wk)(e),n=t?e.WindowSizeStore.state.width-X.sidebarWidthStore.state-(0,J.ll)(e,!1):(0,J.$3)(e);W.default.isSidePeekOpen()&&W.default.state.savedSidebarExpandedStoreState&&X.sidebarExpandedStore.state&&n<re&&(X.sidebarExpandedStore.setState(!1),W.default.setSidebarExpandedStoreState(!0))}(e)}function me(e){X.sidebarWidthStore.setState(e.width),(0,J.$3)(e.environment)<re&&v.xv(e.environment,"sidebar_expand"),Te()}function fe(e){oe.ZP.setState({...oe.ZP.state,width:e.width}),Me()}function ge(e){W.default.state.open&&W.default.isSidePeekOpen()&&(W.default.setSidePeekWidth(e.width,e.environment.WindowSizeStore.state.width),function(){const{preferredSidePeekWidth:e}=W.default.state,t={width:e};a.Z.set(xe,t)}(),pe(e.environment))}async function he(e){const{blocks:t,transaction:n,environment:o}=e,{currentSpaceViewStore:i}=Z.default.state;if(i)for(const r of t)m.Od({parent:i.getSharedPagesStore(),childToRemove:r,transaction:n});S.CZ({environment:o,blocks:t}),await Promise.all(t.map((e=>d.leaveBlock(o,{block:{id:e.id,spaceId:(0,r.C)(e.pointer.spaceId)}}))))}function ve(e){const{store:t,spaceViewStore:n,transaction:o}=e,i=n.getBookmarkedPagesStore(),r=K.G.createChildStore(i,t.pointer);L.default.checkGate("append_favorites")?m.R3({parent:i,append:r,transaction:o}):m.Ce({parent:i,prepend:r,transaction:o})}function be(e){const{store:t,spaceViewStore:n,transaction:o}=e,i=n.getBookmarkedPagesStore(),r=K.G.createChildStore(i,t.pointer);m.Od({parent:i,childToRemove:r,transaction:o})}function ye(e){const{store:t,spaceViewStore:n,transaction:o}=e;Se(e);const i=n.getSharedPagesStore(),r=K.G.createChildStore(i,t.pointer);m.Ce({parent:i,prepend:r,transaction:o})}function _e(e){const{store:t,spaceViewStore:n,transaction:o}=e;Se(e);const i=n.getSharedPagesStore(),r=K.G.createChildStore(i,t.pointer);m.Od({parent:i,childToRemove:r,transaction:o})}function Se(e){const{environment:t,spaceViewStore:n,userSettingsStore:o,transaction:i}=e,r=n.getSpaceId();if(!r||o.hasUserPinnedToOutliner({spaceId:r,type:"shared"}))return;const{visiblePagesStores:a}=(0,D.a2)({environment:t,spaceViewStore:n,userSettingsStore:o,type:"shared"}),s=a.map((e=>{let{id:t}=e;return t}));b.sW({store:n,data:{shared_pages:s},transaction:i}),I.Nb({userSettingsStore:o,spaceId:r,type:"shared",transaction:i})}async function we(e){const{from:t,environment:n,redirect:r,event:a}=e,{currentSpaceStore:s,currentSpaceViewStore:c}=Z.default.state,d=new k.sA(n,"quickAddPage");if(!(Y.M_(n)&&s&&s.canEdit()&&c))return void d.fail("invalid_state");z.ZP.setState({...z.ZP.state,lastPageId:Z.default.state.mainEditorCurrentBlockStore?Z.default.state.mainEditorCurrentBlockStore.id:void 0});const u=await async function(e){const{newPageTracker:t,quickAddParentOverride:n,environment:o,event:i}=e,{currentSpaceStore:r}=Z.default.state;if(!r)return void t.fail("invalid_state");const a=n||await(0,P.lX)({spaceStore:r,currentUserId:o.currentUser.id}),s=M.uw(a),l=(0,x.tO)({event:i,parentStore:s,type:a.type});if("space-private-pages"===a.type||s.canAdmin()){const e=await w.createAndCommitAsync({environment:o,userAction:"sidebarActions.quickAddPage.directMoveToAdd",waitForServerCommit:!1,perform:async e=>{const n=b.j4({environment:o,type:"page",inMemoryRecordCache:o.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:r.id,tracker:t,useCrdt:l}),i=await f.Ws({environment:o,targets:[n],value:a,transaction:e});if(i&&"collection"===i.table){const t=i.getDefaultTemplatePageStore();t&&p.ob({title:"template",environment:o,store:n,templateStore:t,isKeyboard:!1,isCreateIn:!1,transaction:e,from:"sidebar_actions"})}return{createdPage:n}}});return e.performResult.createdPage}if(!s.canAdmin()&&s.canEdit()){const{performResult:{createdPage:e}}=await w.createAndCommitAsync({environment:o,userAction:"sidebarActions.quickAddPage.moveToAdd",waitForServerCommit:!1,perform:async e=>{const n=b.j4({environment:o,type:"page",inMemoryRecordCache:o.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:r.id,useCrdt:l});return t.track(n.pointer,e),await f.Ws({environment:o,targets:[n],value:{type:"space-private-pages",spaceId:r.id},transaction:e}),{createdPage:n}}});return await w.createAndCommitAsync({environment:o,userAction:"sidebarActions.quickAddPage.moveToMove",waitForServerCommit:!1,perform:async t=>{const n=await f.kj({environment:o,targets:[e],value:a,transaction:t});if(n&&"collection"===n.table){const i=n.getDefaultTemplatePageStore();i&&p.ob({title:"template",environment:o,store:e,templateStore:i,isKeyboard:!1,isCreateIn:!1,transaction:t,from:"sidebar_actions"})}}}),e}t.fail("invalid_state")}({...e,newPageTracker:d,event:a});return u?(n.device.isMobile?(y._c({environment:n,store:u,showMoveTo:!0,saveParent:!0,redirect:r,pageVisitSource:i.tY.SidebarQuickAdd}),le()):(0,T.r)()?(y.sC(n,u),y._c({environment:n,store:u,showMoveTo:!0,saveParent:!0,redirect:r,pageVisitSource:i.tY.SidebarQuickAdd}),le()):_.CH({environment:n,store:u,showMoveTo:!0,saveParent:!0,peekMode:void 0,resultsStore:void 0,collectionContextStore:void 0,pageVisitSource:i.tY.SidebarQuickAdd}),h.Eo({environment:n,spaceViewStore:c,type:"private",newIsHidden:!1,outlinerToggleButtonStore:H.Z,shouldPersistToggleState:!0}),l.W(n,{from:t,type:"page",new_page_id:u.id,creating_block_id:u.id}),o.default.afterNextFlush((()=>{R.Z.SidebarScroller&&R.Z.SidebarScroller.scrollToBottom()})),u):void 0}const ke=(0,s.defineMessages)({label:{id:"sidebar.newPage.button",defaultMessage:"New page"},tooltip:{id:"sidebar.newPage.tooltip",defaultMessage:"Create a new page"}}),Ie="sidebar",Ce="updateSidebar",xe="sidePeek";function Te(){const e={expanded:X.sidebarExpandedStore.state,width:X.sidebarWidthStore.state};a.Z.set(Ie,e)}function Me(){const{expanded:e,width:t,openedOnBlockId:n,currentTab:o,currentSubTab:i}=oe.ZP.state,r={expanded:e,width:t,openedOnBlockId:n,currentTab:o,currentSubTab:i};a.Z.set(Ce,r)}function Pe(){const e=a.Z.get(Ie),t=a.Z.get(Ce),n=a.Z.get(xe);if((0,O.Y)("supportsNativeHome")?(X.sidebarExpandedStore.setState(!1),X.sidebarWidthStore.setState(0)):e?(void 0!==e.expanded&&X.sidebarExpandedStore.setState(e.expanded),void 0!==e.width&&e.width>=X.SidebarMinWidth&&X.sidebarWidthStore.setState(e.width)):(0,A.jt)()||X.sidebarExpandedStore.setState(!1),t){const e=t.width&&t.width>=oe.AO?t.width:oe.AO;oe.ZP.setState({...oe.ZP.state,...t,width:e}),window.innerWidth<ie&&X.sidebarExpandedStore.setState(!1)}n&&W.default.setSidePeekWidth(n.width,window.innerWidth)}function Ae(e){oe.ZP.setState({...oe.ZP.state,currentTab:e})}function Re(e){oe.ZP.setState({...oe.ZP.state,commentsMode:e})}function De(e){oe.ZP.setState({...oe.ZP.state,commentsTypeMode:e})}function Ee(e){(0,J.Sx)(e)||X.sidebarExpandedStore.state?(ce({environment:e,isExpanded:!1,from:"toggle_both_sidebars"}),ue({environment:e,isExpanded:!1,from:"keyboard_default"})):(ue({environment:e,isExpanded:!0,from:"keyboard_default"}),ce({environment:e,isExpanded:!0,from:"toggle_both_sidebars"}))}function Be(){X.sidebarShouldLogInitialRenderStore.setState(!1)}async function Fe(e){const{wasChatHistoryClosedAutomatically:t}=e,{AssistantFullPageStore:n}=await C.L6.loader();n.closeChatHistory({wasChatHistoryClosedAutomatically:t})}async function Oe(e){const{AssistantFullPageStore:t}=await C.L6.loader();if(t.state.isChatHistoryOpen||!t.state.wasChatHistoryClosedAutomatically)return;await(0,J.z5)(e)-J.un>ae&&t.openChatHistory()}async function Ze(e){const{AssistantFullPageStore:t}=await C.L6.loader();if(!t.state.isChatHistoryOpen)return;await(0,J.z5)(e)<ae&&((0,J.in)(e)?X.sidebarExpandedStore.setState(!1):t.closeChatHistory({wasChatHistoryClosedAutomatically:!0}))}},24646:(e,t,n)=>{n.d(t,{$3:()=>x,Bb:()=>F,Fl:()=>j,GD:()=>V,J5:()=>I,Jr:()=>S,Nc:()=>b,Sx:()=>C,U8:()=>O,UF:()=>z,Wk:()=>M,YR:()=>R,_c:()=>_,em:()=>B,in:()=>w,js:()=>E,ll:()=>P,qG:()=>T,un:()=>y,vF:()=>L,vG:()=>U,vJ:()=>A,vK:()=>k,wE:()=>Z,z5:()=>D});var o=n(15157),i=n(80503),r=n(9291),a=n(81598),s=n(28020),l=n(18514),c=n(48779),d=n(48276),u=n(16746),p=n(80444),m=n(88923),f=n(38676),g=n(36391),h=n(21853);const v=320,b=800,y=380;function _(e){return!1}function S(e){return!!e.device.isDesktop||!!e.device.isTablet&&e.WindowSizeStore.isLandscape()}function w(e){return((0,l.Sr)(e)||e.currentUser.isLoggedIn())&&f.sidebarExpandedStore.state}function k(e){return C(e)&&g.ZP.state.currentTab===g.gY.Comments}function I(e){return C(e)&&g.ZP.state.currentTab===g.gY.Updates}function C(e){var t;return(null===(t=p.default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.id)===g.ZP.state.openedOnBlockId&&(e.currentUser.isLoggedIn()&&!e.device.isMobile&&g.ZP.state.expanded||h.Z.state.open)}function x(e){return e.WindowSizeStore.state.width-M(e)-P(e,!1)}function T(e){const{isDesktop:t,isMobile:n,isTablet:o}=e.device,{WindowSizeStore:i}=e,r=i.isLandscape(),a=n&&!o&&r;return t?f.sidebarWidthStore.state:o||a?Math.min(v,.87*e.WindowSizeStore.state.width):.87*e.WindowSizeStore.state.width}function M(e){const{shouldShowSidebar:t}=(0,s.h1)(e),n=w(e);return t&&n&&S(e)?T(e)+d.VV():t&&!n&&u.Z.isOpen()?d.VV():0}function P(e,t){return t&&m.default.state.open?0:function(e){0;if(e.device.isMobile)return 0;if(A(e)>0)return 0;return C(e)?g.ZP.state.width:0}(e)+A(e)}function A(e){return m.default.isSidePeekOpen()?m.default.getSidePeekWidth(e.WindowSizeStore.state.width):0}function R(e){return e.device.isAndroid&&!e.device.isTablet||e.device.isTablet&&e.WindowSizeStore.isPortrait()}async function D(e){const t=M(e)+d.VV()+await async function(){const{AssistantFullPageStore:e}=await a.L6.loader();return e.state.isChatHistoryOpen?y:0}()+A(e);return e.WindowSizeStore.state.width-t}const E=(0,r.defineMessages)({createOrJoinWorkspace:{defaultMessage:"Create or join workspace",id:"sidebarSwitcher.createOrJoinWorkspaceButton.prompt"},personalPlan:{defaultMessage:"Personal Plan",id:"sidebarSwitcher.personalPlan.label"},proPlan:{defaultMessage:"Personal Pro Plan",id:"sidebarSwitcher.proPlan.label"},educationPlan:{defaultMessage:"Personal Pro Plan (Education)",id:"educationPlan.title"},educationPlusPlan:{defaultMessage:"Education Plus Plan",id:"sidebarSwitcher.educationPlusPlan.label"},freePlan:{defaultMessage:"Free Plan",id:"sidebarSwitcher.freePlan.label"},teamTrialPlan:{defaultMessage:"Team Plan (Trial)",id:"teamTrialPlan.title"},teamPlan:{defaultMessage:"Team Plan",id:"teamPlan.title"},plusPlan:{defaultMessage:"Plus Plan",id:"plusPlan.title"},businessPlan:{id:"businessPlan.title",defaultMessage:"Business Plan"},enterprisePlan:{defaultMessage:"Enterprise Plan",id:"sidebarSwitcher.enterprisePlan.label"},legacyPlan:{defaultMessage:"Legacy Plan",id:"sidebarSwitcher.legacyPlan.label"},workspaceSubtitleWithMembers:{id:"sidebarSwitcher.workspaceSubtitleWithMembers.label",defaultMessage:"{planType} Â· {numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} member} other {{numberOfWorkspaceMembers} members}}"},workspaceSubtitleWithoutMembers:{id:"sidebarSwitcher.workspaceSubtitleWithoutMembers.label",defaultMessage:"{planType}"}});function B(e){switch(e){case"team_free":case"personal_free":case"free":return E.freePlan;case"personal":case"plus":return E.plusPlan;case"student":return E.educationPlusPlan;case"business":return E.businessPlan;case"enterprise":return E.enterprisePlan;default:return E.legacyPlan}}function F(e){return e.canRead()&&"copy_indicator"!==e.getType()}function O(e){let{isElectronMac:t,isExpanded:n,isFullScreenDesktop:o}=e;return t&&n&&!o}function Z(e){let{isElectronMac:t,isExpanded:n,isFullScreenDesktop:o,isShowingTabBar:i}=e;return!i&&O({isElectronMac:t,isExpanded:n,isFullScreenDesktop:o})}function V(e){let{isElectronMac:t,isExpanded:n,isFullScreenDesktop:o,isShowingTabBar:i}=e;return n&&!i&&!Z({isElectronMac:t,isExpanded:n,isFullScreenDesktop:o,isShowingTabBar:i})}function U(e){var t;let{environment:n}=e;const o=null===(t=(0,s.k_)(n).state)||void 0===t?void 0:t.showTeamSection,i=p.default.state.currentSpaceStore,r=n.device.isMobile;return!(!o||!i||r)&&!(0,c.Cx)(i)}function L(e){return i.R6(e.device.isElectronMac)+15}function j(e,t){return`${e.id}:${t}`}function N(e){let{environment:t,section:n,isSectionShown:i,spaceViewId:r}=e;if(!i)return null;return!0!==o.Z.get({userId:t.currentUser.id,key:j({id:r},n)})}function z(e){var t;let{environment:n}=e;const o=null===(t=p.default.state.currentSpaceViewStore)||void 0===t?void 0:t.id,i=(0,s.k_)(n).state;if(!o||!i)return{is_sidebar_open:w(n)};const{showBookmarksSection:r,showSharedSection:a,showTeamSection:l,showOnlyPrivateSection:c,showPrivateSection:d}=i;return{is_sidebar_open:w(n),sidebar_state:{is_bookmark_expanded:N({environment:n,isSectionShown:r,section:"bookmarks",spaceViewId:o}),is_team_expanded:N({environment:n,isSectionShown:l,section:"teamSidebar",spaceViewId:o}),is_shared_expanded:N({environment:n,isSectionShown:a,section:"shared",spaceViewId:o}),is_private_expanded:N({environment:n,isSectionShown:d&&!c,section:"private",spaceViewId:o})}}}},88310:(e,t,n)=>{n.d(t,{$L:()=>s,As:()=>c,hV:()=>d,ls:()=>u});var o=n(5809),i=n(53965),r=n(83055);const a={};function s(e){void 0===a[e]&&(a[e]=performance.now())}const l={};function c(e){Object.assign(l,e)}function d(){return l}function u(){const{app_start_to_main_start:e,main_start_to_prefetch_initiated:t,prefetch_initiated_to_render_start:n,render_start_to_render_end:s}=(0,r.IN)().sub_metrics,l=(0,o.$)(),c={app_start_to_await_get_spaces_start:p(l,a.await_get_spaces_start),app_start_to_await_get_spaces_end:p(l,a.await_get_spaces_end),app_start_to_browser_repaint_start:p(l,a.browser_repaint_start),app_start_to_browser_repaint_end:p(l,a.browser_repaint_end)},d=i.GM({app_start_to_main_start:e,main_start_to_prefetch_initiated:t,prefetch_initiated_to_render_start:n,render_start_to_render_end:s,...c},i.o8),u=[e,t,n,s];return u.some(i.o8)||(d.app_start_to_render_end=i.Sm(u)),d}function p(e,t){return void 0===e||void 0===t?void 0:t-e}},68418:(e,t,n)=>{n.d(t,{F:()=>r,Z:()=>s});var o=n(49085),i=n(7032);let r=function(e){return e[e.Team=0]="Team",e[e.Members=1]="Members",e}({});class a extends o.default{getInitialState(){return{open:!1,screen:r.Team,description:"",accessLevel:"open",isDefault:!1,name:"",icon:void 0,flowId:(0,i.ZP)(),pageNumber:1,onClose:void 0}}}const s=new a},97799:(e,t,n)=>{n.d(t,{Y:()=>i,Z:()=>r});var o=n(61766);let i=function(e){return e.Updates="updates",e.Home="home",e}({});const r=new o.Z},55521:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{touching:!1,swiping:!1}}}const r=new i},19034:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(80444);class r extends o.default{getInitialState(){return{results:[]}}getUnreadCountForCurrentSpace(){const{currentSpaceStore:e}=i.default.state,{results:t}=this.state;if(e){const n=t.find((t=>t.spaceId===e.id));if(n)return n.unread}return{mentions:0,following:0,highPriority:0}}getUnreadMentionsCountForOtherSpaces(){const{currentSpaceStore:e}=i.default.state,t=e&&e.id,{results:n}=this.state;let o=0;for(const i of n)i.spaceId!==t&&(o+=i.unread.mentions);return o}getTotalUnreadMentionsCount(){const{results:e}=this.state;let t=0;for(const n of e)t+=n.unread.mentions;return t}}const a=new r},38676:(e,t,n)=>{n.r(t),n.d(t,{SidebarMinWidth:()=>f,sidebarElectronMousePeekStore:()=>h,sidebarExpandedStore:()=>d,sidebarMouseEnterYStore:()=>c,sidebarMouseEnteredStore:()=>u,sidebarMousePeekXStore:()=>l,sidebarOpenStore:()=>a,sidebarResizingStore:()=>p,sidebarShouldLogInitialRenderStore:()=>g,sidebarShowTeamBrowserStore:()=>s,sidebarSizeObserver:()=>m,sidebarWidthStore:()=>r});var o=n(49085),i=n(77794);const r=o.default.createValue(240),a=o.default.createValue(!1),s=o.default.createValue(!1),l=o.default.createValue(0),c=o.default.createValue(0),d=o.default.createValue(!0),u=o.default.createValue(!1),p=o.default.createValue({isResizing:!1,isResizerHovered:!1}),m=new i.E,f=220,g=o.default.createValue(!0),h=o.default.createValue(!1)},97852:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},78861:(e,t,n)=>{n.d(t,{Z:()=>p});var o=n(49085),i=n(19889),r=n(66079),a=n(53965),s=n(19584),l=n(92425),c=n(81236),d=n(6258);class u extends o.default{getInitialState(){return{createType:void 0}}getAllSpaceViewStores(e){return e.currentUser.loggedInUserIds.reduce(((t,n)=>[...t,...this.getSpaceViewStores(e,n)]),[])}hasAtLeastOneTeamPlan(e){return this.getAllSpaceViewStores(e).map((e=>{const t=e.getSpaceStore();if(t)return t.getPlanType()})).some((e=>"team"===e))}getSpaceViewStores(e,t){const n=new d.r9(e,{table:r.dx,id:t},{userId:t}).getSpaceViewStores();return a.mN(n,(e=>e.isDefined()&&e.getSpaceId())).filter((t=>Boolean(t.isDefined())&&Boolean(t.getAlive())&&!this.isSpaceDeleted(e,t)))}isSpaceDeleted(e,t){const n=t.getSpaceId()||"",o=c.Z.getData(e,{spaceId:n});return(0,s.z4)(o)}isGuestWithZeroSharedPages(e){const t=e.getUserRootParentId(),n=e.getSpaceStore();if(!t||!n)return!1;if(n.canRead())return!1;const o=l.Z.getSharedPagesState({spaceId:n.id,userId:t});return 0===((null==o?void 0:o.currentPageIds)??[]).length}getUserEmailAddress(e,t){return new d.U6(e,{table:i.KJ,id:t},{userId:t}).getEmail()}}const p=new u},55838:(e,t,n)=>{n.d(t,{Z:()=>a,a:()=>i});var o=n(49085);let i=function(e){return e[e.General=0]="General",e[e.Members=1]="Members",e[e.Security=2]="Security",e}({});class r extends o.default{getInitialState(){return{open:!1,limitMembers:!0,memberFilterQuery:"",tab:void 0}}getTeamStore(){return this.state.open?this.state.viewingUnjoinedPrivateTeamAsEnterpriseAdmin?this.state.unjoinedPrivateTeamStore:this.state.teamStore:void 0}}const a=new r},77999:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a,orderedTeamSidebarTourSteps:()=>i});var o=n(49085);const i=["welcome","actions","teamspaces","prebuilt_templates","private","explore_templates"];class r extends o.default{getInitialState(){return{type:"inactive"}}}const a=new r},36896:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},44604:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{constructor(){super(...arguments),this.loadMoreOffset=200,this.startLimit=20,this.limitIncrement=20}getInitialState(){return{filter:"",currentTab:"all_pages",loading:!0,limit:this.startLimit,excludePages:new Set}}}const r=new i},36391:(e,t,n)=>{n.d(t,{AO:()=>c,F7:()=>r,IT:()=>a,ZP:()=>p,gY:()=>s,uF:()=>l});var o=n(49085),i=n(92595);let r=function(e){return e[e.Resolved=0]="Resolved",e[e.Unresolved=1]="Unresolved",e}({});const a={comments:"default",suggestions:"suggestion"};let s=function(e){return e[e.Comments=0]="Comments",e[e.Updates=1]="Updates",e[e.AiContext=2]="AiContext",e[e.Info=3]="Info",e}({}),l=function(e){return e[e.Updates=0]="Updates",e[e.Analytics=1]="Analytics",e}({});const c=385;class d extends o.default{getInitialState(){return{width:c,expanded:!1,isResizerHovered:!1,isResizing:!1,mouseEntered:!1,currentTab:s.Comments,currentSubTab:l.Updates,commentsMode:r.Unresolved,commentsTypeMode:"commentsAndSuggestions",isAnimating:!1,canRender:!0}}}const u=new d;(0,i.exposeDebugValue)("UpdateSidebarStore",u);const p=u},21853:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},98794:(e,t,n)=>{n.r(t),n.d(t,{annotateSimpleTableSelection:()=>ie,appendRow:()=>ve,cancelReorder:()=>Pe,clearHover:()=>le,clearSelectedCell:()=>Ve,clearSelection:()=>Y,clearSelectionContents:()=>Ue,completeReorder:()=>Ae,continueReorder:()=>Me,contractColumns:()=>De,contractRows:()=>Fe,deleteColumns:()=>Re,deleteRows:()=>Be,duplicateColumns:()=>be,duplicateRows:()=>ye,expandCellSelection:()=>G,extendColumns:()=>de,extendRows:()=>ge,fitToPage:()=>He,handleDelete:()=>te,handleDuplicate:()=>oe,handleKeypress:()=>ne,handleLeftRightKey:()=>J,handleUpDownKey:()=>ee,hoverCell:()=>re,hoverResizer:()=>se,hoverRowColumn:()=>ae,insertColumnLeft:()=>ce,insertColumnRight:()=>ue,insertRow:()=>he,insertRowAbove:()=>me,insertRowBelow:()=>fe,messages:()=>z,resizeColumn:()=>Ie,selectCell:()=>H,selectCellAndSetCursor:()=>$,selectColumn:()=>W,selectMultiCell:()=>K,selectRow:()=>q,setColor:()=>We,setResizing:()=>we,showResizeBar:()=>Se,startReorder:()=>Te,toggleHeaderColumn:()=>qe,toggleHeaderRow:()=>ze,turnIntoCollection:()=>je,turnIntoSimpleTable:()=>Ne,updateCellSelectionFromTextSelection:()=>Q,updateColumnSelectionOnResize:()=>xe,updateRowSelectionOnResize:()=>Ce});n(57658),n(21703);var o=n(50361),i=n.n(o),r=n(1302),a=n(41432),s=n(90559),l=n(99036),c=n(80951),d=n(21202),u=n(6287),p=n(13493),m=n(23867),f=n(70203),g=n(9291),h=n(7032),v=n(15828),b=n(19584),y=n(952),_=n(54532),S=n(96802),w=n(94419),k=n(19785),I=n(9953),C=n(24677),x=n(993),T=n(98104),M=n(13447),P=n(95477),A=n(21100),R=n(14976),D=n(33929),E=n(65598),B=n(22294),F=n(6258),O=n(27724),Z=n(24666),V=n(27534),U=n(84139),L=n(64359),j=n(5676),N=n(63208);const z=(0,g.defineMessages)({turnIntoCollectionTitle:{defaultMessage:"Title",id:"simpleTableActions.collectionTitle"},turnIntoCollectionColumnTitle:{defaultMessage:"Column {columnIndex}",id:"simpleTableActions.collectionColumnTitle"}});function q(e){const{environment:t,index:n,simpleTableStore:o}=e,i=V.getNumberOfRows(o);if(0===i)return Y(),void T.ZH(t);const r=(0,b.uZ)(n,0,i-1);N.Z.setState({isActive:!0,simpleTableStore:o,selection:{start:{col:0,row:r},end:{col:V.getNumberOfColumns(o)-1,row:r},type:"row"}}),C.Z5({environment:t,stores:[o],phase:O.SelectionPhase.Editing}),T.ZH(t)}function W(e){const{environment:t,index:n,simpleTableStore:o}=e,i=V.getNumberOfColumns(o);if(0===i)return Y(),void T.ZH(t);const r=(0,b.uZ)(n,0,i-1);N.Z.setState({isActive:!0,simpleTableStore:o,selection:{start:{col:r,row:0},end:{col:r,row:V.getNumberOfRows(o)-1},type:"column"}}),C.Z5({environment:t,stores:[o],phase:O.SelectionPhase.Editing}),T.ZH(t)}function H(e){const{environment:t,rowIndex:n,columnIndex:o,simpleTableStore:i}=e;N.Z.setState({isActive:!0,simpleTableStore:i,selection:{start:{col:o,row:n},end:{col:o,row:n},type:"cell"}}),C.Z5({environment:t,stores:[i],phase:O.SelectionPhase.Editing})}function K(e){const{environment:t,start:n,end:o,simpleTableStore:i}=e;N.Z.setState({isActive:!0,simpleTableStore:i,selection:{start:n,end:o,type:"cell"}}),C.Z5({environment:t,stores:[i],phase:O.SelectionPhase.Editing}),T.ZH(t)}function G(e){const{environment:t,rowIndex:n,columnIndex:o,simpleTableStore:i}=e;K({environment:t,start:N.Z.state.isActive?N.Z.state.selection.start:{col:o,row:n},end:{col:o,row:n},simpleTableStore:i})}function $(e){H(e);const t=V.getCellTextStore(e);t&&T.NX({store:t})}function Q(){if("editing"!==Z.default.state.mode)return;const e=V.getSimpleTableCellFromTextSelection();if(!e)return void Y();const{columnIndex:t,rowIndex:n,simpleTableStore:o}=e.getProps(),i=N.Z.state;if(i.isActive){const{start:e,end:r}=i.selection;!(e.col===r.col&&e.row===r.row)||e.col===t&&e.row===n&&i.simpleTableStore===o||H({environment:o.environment,rowIndex:n,columnIndex:t,simpleTableStore:o})}else H({environment:o.environment,rowIndex:n,columnIndex:t,simpleTableStore:o})}function Y(){N.Z.setState({isActive:!1})}function J(e){const{environment:t,direction:n,bypassExistingTextSelection:o,expandSelection:i}=e;if(!o&&V.getSimpleTableCellFromTextSelection())return;const r=N.Z.state;if(r.isActive){const{selection:e,simpleTableStore:a}=r;if(i){const{rowIndex:o,columnIndex:i}=X({selection:e,simpleTableStore:a,direction:n,wrapRow:!1});return void G({environment:t,rowIndex:o,columnIndex:i,simpleTableStore:a})}if(V.isColumnSelected({selection:e,columnIndex:e.start.col,simpleTableStore:a})){const{columnIndex:o}=X({selection:e,simpleTableStore:a,direction:n,wrapRow:!1});W({environment:t,index:o,simpleTableStore:a})}else{const i="editing"===Z.default.state.mode;o&&T.ZH(t);const{rowIndex:r,columnIndex:s}=X({selection:e,simpleTableStore:a,direction:n,wrapRow:!0});if(i)return void $({environment:t,rowIndex:r,columnIndex:s,simpleTableStore:a});H({environment:t,rowIndex:r,columnIndex:s,simpleTableStore:a})}}B.Z.setKeyboardMode(!0)}function X(e){const{selection:t,simpleTableStore:n,direction:o,wrapRow:i}=e,r=V.getNumberOfColumns(n)-1,a=V.getNumberOfRows(n)-1,{col:s,row:l}=t.end;return"right"===o?s===r&&l===a?{columnIndex:r,rowIndex:a}:s===r?i?{columnIndex:0,rowIndex:l+1}:{columnIndex:s,rowIndex:l}:{columnIndex:s+1,rowIndex:l}:0===s&&0===l?{columnIndex:0,rowIndex:0}:0===s?i?{columnIndex:r,rowIndex:l-1}:{columnIndex:s,rowIndex:l}:{columnIndex:s-1,rowIndex:l}}function ee(e){const{environment:t,direction:n,bypassExistingTextSelection:o,expandSelection:i}=e;if(!o&&V.getSimpleTableCellFromTextSelection())return;const r=N.Z.state;if(r.isActive){const{selection:e,simpleTableStore:a}=r,{rowIndex:s,columnIndex:l}=function(e){const{selection:t,simpleTableStore:n,direction:o}=e,i=V.getNumberOfRows(n)-1,{col:r,row:a}=t.end,s="down"===o?Math.min(i,a+1):Math.max(0,a-1);return{columnIndex:r,rowIndex:s}}({selection:e,simpleTableStore:a,direction:n});if(i)return void G({environment:t,rowIndex:s,columnIndex:l,simpleTableStore:a});V.isRowSelected({selection:e,rowIndex:e.start.row,simpleTableStore:a})?q({environment:t,index:s,simpleTableStore:a}):(o&&T.ZH(t),H({environment:t,rowIndex:s,columnIndex:l,simpleTableStore:a}))}B.Z.setKeyboardMode(!0)}function te(e){if(V.getSimpleTableCellFromTextSelection())return;const t=N.Z.state;if(!t.isActive)return;const{environment:n,transaction:o}=e,{selection:i,simpleTableStore:r}=t;if(V.isColumnSelected({selection:i,columnIndex:i.start.col,simpleTableStore:r}))Ue(e),Ee({index:i.start.col,simpleTableStore:r,transaction:o}),W({environment:n,index:i.start.col,simpleTableStore:r});else if(V.isRowSelected({selection:i,rowIndex:i.start.row,simpleTableStore:r})){Oe({rowID:r.getRenderableContentIds()[i.start.row],simpleTableStore:r,transaction:o}),q({environment:n,index:i.start.row,simpleTableStore:r})}else V.isSingleCellSelected(i)?Ve({environment:n,transaction:o}):Ue({environment:n,transaction:o})}function ne(e){if(V.getSimpleTableCellFromTextSelection())return;const t=N.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,i=o.getContentStores()[n.end.row],r=V.getColumnOrder(o);if(!r)return;const{environment:a,editorMode:s,transaction:l,key:c}=e,d=i.getPropertyStore(r[n.end.col]);if(c&&1===c.length){const e=d.getValue(),t=f.TPx(c);x.sO({environment:a,editorMode:s,store:d,value:e?e.concat(t):t,transaction:l}),T.NX({store:d})}}function oe(e){if(V.getSimpleTableCellFromTextSelection())return;const t=N.Z.state;if(!t.isActive)return;const{environment:n,transaction:o}=e,{selection:i,simpleTableStore:r}=t;V.isColumnSelected({selection:i,columnIndex:i.start.col,simpleTableStore:r})?be({transaction:o}):V.isRowSelected({selection:i,rowIndex:i.start.row,simpleTableStore:r})&&ye({environment:n,transaction:o})}function ie(e){const{simpleTableStore:t,annotation:n}=e,o=N.Z.state;if(!o.isActive||o.simpleTableStore!==t)return;const{selection:i}=o,r=[],a=Math.min(i.start.row,i.end.row),s=Math.max(i.start.row,i.end.row),l=Math.min(i.start.col,i.end.col),c=Math.max(i.start.col,i.end.col);for(let p=a;p<=s;p++)for(let e=l;e<=c;e++){const n=V.getCellTextStore({simpleTableStore:t,rowIndex:p,columnIndex:e}),o=null==n?void 0:n.getValue();n&&o&&r.push({textStore:n,textValue:o})}const d=f.J7s(n),u=r.every((e=>{let{textValue:t}=e;return t.every((e=>f.hDy(e).some((e=>f.J7s(e)===d))))}));for(const{textStore:p}of r)x.QT({...e,textStore:p,action:u?"removeAnnotationType":"annotate"})}function re(e){if(ke())return;const{x:t,y:n,simpleTableStore:o}=e;L.Z.setState({isActive:!0,simpleTableStore:o,hover:{x:t,y:n,showResizer:!1,resizing:!1,type:"cell"}})}function ae(e){if(ke())return;const{type:t,simpleTableStore:n,index:o}=e;L.Z.setState({isActive:!0,simpleTableStore:n,hover:{type:t,index:o}})}function se(e){const{simpleTableStore:t,resizer:n}=e;L.Z.setState({isActive:!0,simpleTableStore:t,hover:{type:"resizer",resizer:n}})}function le(){ke()||L.Z.setState({isActive:!1})}function ce(e){const t=N.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,{environment:i,transaction:r}=e;pe({index:n.start.col,simpleTableStore:o,transaction:r}),$({environment:i,rowIndex:0,columnIndex:n.start.col,simpleTableStore:o})}function de(e){const{count:t,simpleTableStore:n,transaction:o}=e;if(t<1)return;const i=V.getNumberOfColumns(n);for(let r=0;r<t;r++)pe({index:i+r,simpleTableStore:n,transaction:o})}function ue(e){const t=N.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,{environment:i,transaction:r}=e;pe({index:n.end.col+1,simpleTableStore:o,transaction:r}),$({environment:i,rowIndex:0,columnIndex:n.end.col+1,simpleTableStore:o})}function pe(e){const{index:t,simpleTableStore:n,transaction:o,columnID:i,format:r}=e,a=V.getColumnOrder(n)||[],s=V.getColumnFormat(n),l=i||(0,v.ZP)(),c=[...a.slice(0,t),l,...a.slice(t)],d=r?{...s,[l]:r}:s;S.FH({stores:[n],update:{table_block_column_order:c,table_block_column_format:d},transaction:o})}function me(e){const t=N.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,{environment:i,transaction:r}=e;he({environment:i,index:n.start.row,simpleTableStore:o,transaction:r}),$({environment:i,rowIndex:n.start.row,columnIndex:0,simpleTableStore:o})}function fe(e){const t=N.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,{environment:i,transaction:r}=e;he({environment:i,index:n.end.row+1,simpleTableStore:o,transaction:r}),$({environment:i,rowIndex:n.end.row+1,columnIndex:0,simpleTableStore:o})}function ge(e){const{environment:t,count:n,simpleTableStore:o,transaction:i,analyticsFrom:r}=e;if(n<1)return;const a=V.getNumberOfRows(o);for(let s=0;s<n;s++)he({environment:t,index:a+s,simpleTableStore:o,transaction:i,analyticsFrom:r})}function he(e){const{environment:t,index:n,simpleTableStore:o,transaction:i,analyticsFrom:r}=e,a=o.getContentStore();if(!(0,E.dz)(a))throw new Error("Block has an invalid parent.");const s=I.j4({environment:t,type:"table_row",properties:{},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:i,spaceId:o.pointer.spaceId,useCrdt:o.useCrdt()}),l=F.G.createChildStore(a,s.pointer);if(r&&y.W(t,{from:r,type:"table_row",creating_block_id:s.id}),n<=0)k.SH({parentStore:a,childStore:l,transaction:i});else{const e=o.getContentStores();k.jG({parentStore:a,childStore:l,transaction:i,after:e[n-1].id})}return l}function ve(e){const{environment:t,simpleTableStore:n,transaction:o}=e,i=n.getContentStore();if(!(0,E.dz)(i))throw new Error("Block has an invalid parent.");const r=I.j4({environment:t,type:"table_row",properties:{},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:o,spaceId:n.pointer.spaceId,useCrdt:n.useCrdt()}),a=F.G.createChildStore(i,r.pointer);return k.jG({parentStore:i,childStore:a,transaction:o}),a}function be(e){const t=N.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,i=V.getColumnOrder(o),r=V.getColumnFormat(o);if(!i)return;const a=i.slice(n.start.col,n.end.col+1);if(!a)return;const s=[],{transaction:l}=e;for(let c=n.start.col;c<=n.end.col;c++){const e=a[c-n.start.col],t=(0,v.ZP)();s.push(t),pe({index:n.end.col+1,simpleTableStore:o,transaction:l,columnID:t,format:r?r[e]:void 0})}for(const c of o.getContentStores())_e({rowStore:c,columnIDs:a,newColumnIDs:s,transaction:l})}function ye(e){const t=N.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,i=o.getRenderableContentIds(),{environment:r,transaction:a}=e;for(let s=n.start.row;s<=n.end.row;s++){const e=F.G.createChildStore(o,{table:d.iU,id:i[s]}),[t]=_.Qi({environment:r,stores:[e],addCopyName:!1,transaction:a,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,targetSpaceId:(0,m.C)(e.pointer.spaceId),baseUrl:P.default.domainBaseUrl,publicDomainName:P.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:o.useCrdt()}),n=t[0];w.BE({parent:o.getContentStore(),insert:n,after:e,transaction:a})}}function _e(e){const{rowStore:t,columnIDs:n,newColumnIDs:o,transaction:i}=e,r={...t.getPropertiesStore().getValue(),...(0,b.m8)(o.map(((e,o)=>[e,t.getPropertyValue(n[o])])))};A.b({environment:t.environment,editorMode:"default",store:t,properties:r,transaction:i})}function Se(e){const t=L.Z.state;if(!t.isActive)return;const{hover:n}=t;"cell"===n.type&&L.Z.setState({...t,hover:{...n,showResizer:e}})}function we(e){const t=L.Z.state;if(!t.isActive)return;const{hover:n}=t;"cell"===n.type&&L.Z.setState({...t,hover:{...n,resizing:e}})}function ke(){const e=L.Z.state;return e.isActive&&"resizing"in e.hover&&e.hover.resizing}function Ie(e){const{tableBlockColumnFormat:t,simpleTableStore:n,transaction:o}=e;S.FH({stores:[n],update:{table_block_column_format:t},transaction:o})}function Ce(e){const t=N.Z.state;if(!t.isActive||"row"!==t.selection.type)return;const{selection:n}=t;N.Z.setState({...t,selection:{...n,end:{col:e,row:n.end.row}}})}function xe(e){const t=N.Z.state;if(!t.isActive||"column"!==t.selection.type)return;const{selection:n}=t;N.Z.setState({...t,selection:{...n,end:{col:n.end.col,row:e}}})}function Te(e){const{environment:t,simpleTableStore:n,id:o,index:i,type:r,rowStore:a,theme:s,selectorStartPx:l,mouseOffsetPx:c}=e;let d=[];"column"===r?(W({environment:t,index:i,simpleTableStore:n}),d=U.Z.findCellsInColumnFromStore(n,o)):(q({environment:t,index:i,simpleTableStore:n}),d=U.Z.findCellsInRowFromStore(a));const u=V.cloneCellsForDragOverlay({cells:d,type:r,theme:s});j.Z.setState({isActive:!0,simpleTableStore:n,source:{id:o,type:r,index:i,draggedCells:u,selectorStartPx:l,mouseOffsetPx:c},destIndex:i,selectorDragPx:l,moved:!1})}function Me(e){const{destIndex:t,selectorDragPx:n}=e,o=j.Z.state;o.isActive&&j.Z.setState({...o,destIndex:t,selectorDragPx:n,moved:!0})}function Pe(){j.Z.reset()}function Ae(e){const{event:t,environment:n,format:o,simpleTableStore:i,transaction:a,type:s,onNoChange:l}=e,c=j.Z.state;if(!c.isActive)return;const{source:d,destIndex:u}=c;d.type===s&&c.simpleTableStore===i&&("column"===s?function(e){const{environment:t,columnOrder:n,source:o,destIndex:i,simpleTableStore:a,transaction:s}=e;if(!n)return;Y();const l=[...n.slice(0,o.index),...n.slice(o.index+1)],c=[...l.slice(0,i),o.id,...l.slice(i)];S.FH({stores:[a],update:{table_block_column_order:c},transaction:s}),r.default.afterNextFlush((()=>{W({environment:t,index:i,simpleTableStore:a})}))}({environment:n,columnOrder:o.table_block_column_order,source:d,destIndex:u,simpleTableStore:i,transaction:a}):function(e){const{environment:t,source:n,destIndex:o,simpleTableStore:i,transaction:a}=e,s=i.getRenderableContentIds(),l=o>n.index?o:o-1;let c=o>0?s[l]:void 0;c===n.id&&(c=s[l+1]);Y();const d=i.getContentStores().find((e=>e.id===n.id)),u=i.getContentStores().find((e=>e.id===c));if(d){const e=i;u?k.jG({parentStore:e,after:u.id,childStore:d,transaction:a}):k.SH({parentStore:e,childStore:d,transaction:a}),r.default.afterNextFlush((()=>{q({environment:t,index:o,simpleTableStore:i})}))}}({environment:n,source:d,destIndex:u,simpleTableStore:i,transaction:a}),d.index===u&&(null==l||l(t)))}function Re(e){const t=N.Z.state;if(!t.isActive)return;Ue(e);const{selection:n,simpleTableStore:o}=t,{environment:i,transaction:r}=e;for(let a=n.start.col;a<=n.end.col;a++)Ee({index:a,simpleTableStore:o,transaction:r});W({environment:i,index:n.start.col,simpleTableStore:o})}function De(e){const{simpleTableStore:t,columnOrder:n,transaction:o}=e;S.FH({stores:[t],update:{table_block_column_order:n},transaction:o})}function Ee(e){const{index:t,simpleTableStore:n,transaction:o}=e,i=V.getColumnOrder(n);if(!i||1===i.length)return;const r=[...i.slice(0,t),...i.slice(t+1)];S.FH({stores:[n],update:{table_block_column_order:r},transaction:o})}function Be(e){const t=N.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,i=o.getRenderableContentIds(),{environment:r,transaction:a}=e;for(let s=n.start.row;s<=n.end.row;s++)Oe({rowID:i[s],simpleTableStore:o,transaction:a});q({environment:r,index:n.start.row,simpleTableStore:o})}function Fe(e){const{simpleTableStore:t,numRowsToDelete:n,transaction:o}=e,i=t.getRenderableContentIds();for(let r=i.length-n;r<i.length;r++)Oe({rowID:i[r],simpleTableStore:t,transaction:o})}function Oe(e){const{rowID:t,simpleTableStore:n,transaction:o}=e,i=n.getContentStore();if(!(0,E.dz)(i))throw new Error("Block has an invalid parent.");if(V.getNumberOfRows(n)<=1)return;const r={table:d.iU,id:t};Ze({rowStore:F.G.createChildStore(i,r),simpleTableStore:n,transaction:o})}function Ze(e){const{rowStore:t,simpleTableStore:n,transaction:o}=e,i=n.getContentStore();k.hr({parentStore:i,childStore:t,transaction:o})}function Ve(e){const t=N.Z.state;if(!t.isActive)return;const{selection:n}=t;if(!V.isSingleCellSelected(n))return;const{environment:o,transaction:i}=e;Ue({environment:o,transaction:i})}function Ue(e){const t=N.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,i=V.getColumnOrder(o);if(!i)return;const r=o.getContentStores(),{environment:a,transaction:s}=e,l=Math.min(n.start.row,n.end.row),c=Math.max(n.start.row,n.end.row),d=Math.min(n.start.col,n.end.col),u=Math.max(n.start.col,n.end.col);for(let p=l;p<=c;p++)Le({rowStore:r[p],startIndex:d,endIndex:u,columnOrder:i,transaction:s});T.ZH(a)}function Le(e){const{rowStore:t,startIndex:n,endIndex:o,columnOrder:i,transaction:r}=e,a=i.slice(n,o+1);if(!a)return;const s=(0,b.m8)(a.map((e=>[e,null])));A.b({environment:t.environment,editorMode:"default",store:t,properties:s,transaction:r})}function je(e){const{environment:t,editorMode:n,simpleTableStore:o,transaction:i}=e,r=V.getColumnOrder(o)||[],s=V.getColumnFormat(o)||{},{headerRow:c}=V.getHeadersEnabled(o),m=o.getContentStores();if(!r.length)return;const f=r[0],g=o.getSpaceId(),v=(0,h.ZP)(),y=(0,h.ZP)(),_=c?m[0]:void 0,S=(0,b.m8)(r.map(((e,t)=>function(e){const{columnID:t,columnIndex:n,titleColumnID:o,headerRowStore:i}=e;let r=t,a="text",s=z.turnIntoCollectionColumnTitle;t===o&&(r="title",a="title",s=z.turnIntoCollectionTitle);const l=D.default.getIntl();return[r,{name:i?R.Xh(i.getPropertyValue(t),i):l.formatMessage(s,{columnIndex:n}),type:a}]}({columnID:e,columnIndex:t,titleColumnID:f,headerRowStore:_})))),w={id:v,version:0,parent_table:d.iU,parent_id:o.id,space_id:g,name:void 0,schema:S,alive:!0},C=I.ae({environment:t,table:"collection",value:w,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:i});I.sW({store:o,data:{type:a.Ti.collectionView,view_ids:[y],collection_id:v},transaction:i}),I.sW({store:o.getFormatStore(),data:{collection_pointer:{table:u.vF,id:v,spaceId:g}},transaction:i}),m.map(((e,r)=>{if(c&&0===r)return void Ze({rowStore:e,simpleTableStore:o,transaction:i});const s=e.getProperties();I.sW({store:e,data:{type:a.Ti.page},transaction:i}),x.sO({environment:t,editorMode:n,store:e.getBlockTitleStore(),value:s[f],transaction:i}),I.sW({store:e.getPropertiesStore(),data:{[f]:void 0},transaction:i}),k.zw({childStore:e,parentStore:C,transaction:i})}));const T={id:y,version:0,type:"table",name:void 0,parent_id:o.id,parent_table:"block",space_id:g,format:{table_properties:r.map((e=>({visible:!0,property:e===f?"title":e,width:s&&e in s?s[e].width:void 0})))},page_sort:m.map((e=>e.id)).slice(0,l.gq),alive:!0},P={table:p.np,id:y,spaceId:g};M.applyOperation({store:(0,F.Kv)(o,P),operation:{pointer:P,command:"set",path:[],args:T},transaction:i})}function Ne(e){var t;const{environment:n,editorMode:o,collectionViewBlockStore:i,pageStores:r,transaction:l}=e,d=i.getCollectionViewSourceCollectionStore();if(!d)return;if(r.length>V.simpleTableTransformPageLimit||r.some((e=>e.hasContent())))return;const[u]=i.getCollectionViewStores(),p=d.getSchema(),m=(u.getFormat().table_properties||[]).filter((e=>e.visible&&e.property in p));if(!m)return;const f=i.getContentStore(),g=(0,v.ZP)();I.sW({store:i,data:{type:a.Ti.table,collection_id:null},transaction:l}),I.sW({store:i.getFormatStore(),data:{table_block_column_order:m.map((e=>"title"===e.property?g:e.property)),table_block_column_format:(0,b.m8)(m.map((e=>["title"===e.property?g:e.property,{width:e.width}]))),table_block_column_header:!0,collection_pointer:null},transaction:l});const h=I.j4({environment:n,type:"table_row",properties:(0,b.m8)(m.map((e=>{const t=e.property,n=t in p?p[t]:void 0;return["title"===t?g:t,n?[[n.name]]:[]]}))),inMemoryRecordCache:n.defaultRecordCache.inMemoryRecordCache,transaction:l,spaceId:i.pointer.spaceId,useCrdt:i.useCrdt()}),y=F.G.createChildStore(f,h.pointer);k.SH({parentStore:f,childStore:y,transaction:l});const _=(0,s.$z)(p),S=_.length>0?null===(t=d.getRecordKeyStore())||void 0===t?void 0:t.getRecordKey():void 0;r.map(((e,t)=>{const i=F.G.createChildStore(f,e.pointer),r=e.getProperties(),d=_.reduce((function(e,t){const n=(0,s.wf)(S,c.ah(r[t]));return e[t]=[[n]],e}),{});I.sW({store:i,data:{type:a.Ti.tableRow},transaction:l}),I.sW({store:i.getPropertiesStore(),data:{...d,[g]:i.getBlockTitleStore().getValue()},transaction:l}),x.sO({environment:n,editorMode:o,store:i.getBlockTitleStore(),value:void 0,transaction:l}),k.jG({parentStore:f,childStore:i,transaction:l})})),I.sW({store:d,data:{alive:!1},transaction:l}),I.sW({store:u,data:{alive:!1},transaction:l})}function ze(e){const{simpleTableStore:t,transaction:n}=e,o=t.getFormat(),i=!Boolean(o.table_block_column_header);S.FH({stores:[t],update:{table_block_column_header:i},transaction:n})}function qe(e){const{simpleTableStore:t,transaction:n}=e,o=t.getFormat(),i=!Boolean(o.table_block_row_header);S.FH({stores:[t],update:{table_block_row_header:i},transaction:n})}function We(e,t,n){const o=N.Z.state;if(!o.isActive)return;const r="default"===t?void 0:t,{selection:a,simpleTableStore:s}=o;if("row"===a.type){const e=s.getContentStores()[a.start.row];S.FH({stores:[e],update:{block_color:r},transaction:n})}if("column"===a.type){const e=V.getColumnOrder(s),t=i()(V.getColumnFormat(s)||{});if(!e)return;const o=e[a.start.col];o in t?t[o].color=r:t[o]={color:r},S.FH({stores:[s],update:{table_block_column_format:t},transaction:n})}O.default.state.phase!==O.SelectionPhase.Selected||e.device.isMobile||C.ZH(e)}function He(e){const{simpleTableStore:t,parentWidth:n,transaction:o}=e,i=V.getColumnOrder(t);if(!i)return;const r=V.getColumnFormat(t),a=(n-18)/i.length,s=(0,b.m8)(i.map((e=>[e,{width:a,color:r&&r[e]?r[e].color:void 0}])));S.FH({stores:[t],update:{table_block_column_format:s},transaction:o})}},59175:(e,t,n)=>{n.d(t,{Z:()=>Ge});var o=n(45697),i=n.n(o),r=n(67294),a=n(83355),s=n(1302),l=n(12137),c=n(1898),d=n(52989),u=n(61045),p=n(10906),m=n(23864),f=n(68709),g=n(53336),h=n(79954),v=n(95645),b=n(43250),y=n(12534),_=n(48779),S=n(24646),w=n(34859),k=n(77794),I=n(98794),C=n(27534);const x=18;var T=n(49085);class M extends T.default{getInitialState(){return{}}setTemporaryFormat(e){this.update((t=>({...t,temporaryFormat:e})))}updateColumnOrder(e){this.update((t=>({...t,temporaryFormat:{...t.temporaryFormat,table_block_column_order:e}})))}}const P=M;var A=n(64359),R=n(5676),D=n(63208),E=n(13991),B=n(480),F=n(86628),O=n(24405),Z=n(45238),V=n(85893);const U=(0,Z.IU)("arrowsOut",{viewBox:"0 0 30 30",svg:(0,V.jsx)("path",{d:"M7.09101 20.6434C7.50813 20.2263 7.49239 19.6124 7.07527 19.1953L6.41418 18.5342L3.51009 15.9449L7.75998 16.0551L12.6237 16.0709C12.8992 16.0787 13.1353 15.9685 13.3242 15.7797C13.7728 15.3311 13.8121 14.7093 13.3714 14.2686C13.1589 14.0561 12.8992 13.938 12.6159 13.938L7.75998 13.9459L3.51009 14.0561L6.42205 11.4589L7.07527 10.8057C7.49239 10.3886 7.52387 9.77473 7.09888 9.34974C6.6739 8.92476 6.06002 8.9405 5.63503 9.36548L1.2671 13.7334C0.464339 14.5362 0.464339 15.4649 1.2671 16.2676L5.63503 20.6356C6.04428 21.0448 6.6739 21.0605 7.09101 20.6434ZM24.3739 20.6592L28.7418 16.2912C29.5446 15.4885 29.5524 14.5519 28.7497 13.7492L24.3818 9.38123C23.9725 8.97198 23.3429 8.95624 22.9179 9.38123C22.5087 9.79047 22.5165 10.4122 22.9336 10.8293L23.5947 11.4904L26.5067 14.0718L22.2489 13.9695L17.3931 13.9459C17.1176 13.938 16.8736 14.0561 16.6847 14.245C16.244 14.6857 16.1968 15.3153 16.6375 15.7561C16.85 15.9685 17.1176 16.0787 17.4009 16.0787L22.2489 16.0787L26.5067 15.9607L23.5947 18.5578L22.9336 19.2189C22.5165 19.636 22.485 20.2499 22.91 20.6749C23.335 21.0999 23.9568 21.0763 24.3739 20.6592Z"})});var L=n(42853),j=n(77734),N=n(73599),z=n(51454),q=n(9291),W=n(31701),H=n(37810),K=n(13447),G=n(13966),$=n(23063),Q=n(64921),Y=n(52275),J=n(31945),X=n(78140),ee=n(32163),te=n(72495),ne=n(24006),oe=n(26388),ie=n(60709),re=n(95802),ae=n(22294),se=n(27724),le=n(29574);function ce(e){var t;const{simpleTableStore:n,rootSizeObserver:o,offset:i,hoverSizeObserver:r}=e,a=(0,B.O7)(),s=(0,O.Fg)(),l=(0,F.VK)((()=>re.C.findScrollToSelectableFromStore(n)),[n]),c=null==l||null===(t=l.getNode())||void 0===t?void 0:t.getBoundingClientRect(),d=(0,F.VK)((()=>o.rect.state.width),[o]),u=(0,F.VK)((()=>r.rect.state.width),[r]),p=(0,F.VK)((()=>Math.min((null==c?void 0:c.width)||0,d,u)+i),[c,d,u,i]);return c?(0,V.jsx)("div",{style:{width:0,position:"absolute",left:p,zIndex:z.t8},onMouseDown:y.$0,children:(0,V.jsx)("div",{style:{position:"relative"},children:(0,V.jsxs)("div",{style:ue(s),children:[(0,V.jsx)(oe.ZP,{placement:oe.ug.Top,render:e=>(0,V.jsx)(Q.Z,{...e,style:pe(s),onClick:()=>{K.createAndCommit({userAction:"SimpleTableActionBar.ActionBarContent",environment:a,perform:e=>{I.fitToPage({simpleTableStore:n,parentWidth:r.rect.state.width,transaction:e})}})},children:U({width:20,fill:s.regularIconColor})}),renderTooltip:()=>(0,V.jsx)(q.FormattedMessage,{defaultMessage:"Fit table to page width",id:"simpleTable.actionBar.fitToPage"})}),(0,V.jsx)(J.ZP,{popupType:J.Z4.Popup,originGap:4,renderOrigin:e=>(0,V.jsxs)(Q.Z,{style:pe(s),...e,children:[(0,V.jsx)(q.FormattedMessage,{id:"simpleTable.actionBar.options",defaultMessage:"Options"}),(0,L.i)({width:10,fill:s.mediumIconColor,marginLeft:4})]}),render:()=>(0,V.jsx)(de,{simpleTableStore:n})}),(0,V.jsx)(G.Z,{store:n,fadeIn:!1,style:{display:"flex",justifyContent:"center",alignSelf:"center",width:30,height:void 0,padding:"9px 8px"},iconStyle:{fill:s.regularTextColor}})]})})}):null}function de(e){const{simpleTableStore:t}=e,n=(0,B.O7)(),o=(0,O.Fg)(),i=[{key:"header row",action:()=>{K.createAndCommit({userAction:"SimpleTableActionBar.menuItems",environment:n,perform:e=>{I.toggleHeaderRow({simpleTableStore:t,transaction:e})}})},render:e=>(0,V.jsx)(Y.Z,{...e,icon:(0,N.f)({width:16,fill:o.regularIconColor}),title:(0,V.jsx)(q.FormattedMessage,{id:"action.columnHeader.title",defaultMessage:"Header row"}),right:(0,V.jsx)(ne.Z,{on:C.getHeadersEnabled(t).headerRow||!1,onClick:e.onClick})})},{key:"header column",action:()=>{K.createAndCommit({userAction:"SimpleTableActionBar.menuItems",environment:n,perform:e=>{I.toggleHeaderColumn({simpleTableStore:t,transaction:e})}})},render:e=>(0,V.jsx)(Y.Z,{...e,icon:(0,j.s)({width:16,fill:o.regularIconColor}),title:(0,V.jsx)(q.FormattedMessage,{id:"SimpleTableActionBar.action.rowHeader.title",defaultMessage:"Header column"}),right:(0,V.jsx)(ne.Z,{on:C.getHeadersEnabled(t).headerColumn||!1,onClick:e.onClick})})}];return(0,V.jsx)(X.Z,{menuType:ie.og.Popup,width:240,maxHeight:n.device.isMobile?70:void 0,children:(0,V.jsx)(ee.Z,{type:ee.i.Vertical,sections:[{key:"appearance section",render:e=>(0,V.jsx)(te.Z,{...e}),items:i}],initialFocus:void 0})})}function ue(e){return{position:"absolute",top:-40,right:0,borderRadius:4,height:32,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",fontFamily:H.Z.getCompositeFontFamily(E.SP).sans,background:e.popoverBackground,boxShadow:e.mediumBoxShadow}}function pe(e){return{display:"flex",alignItems:"center",padding:"0 8px",borderRight:`1px solid ${W.ZP.whiteWithAlpha(.2)}`,boxShadow:`1px 0 0 ${e.regularDividerColor}`}}const me=function(e){const{disabled:t,canEdit:n,simpleTableStore:o}=e,i=(0,F.VK)((()=>{const e=D.Z.state,t=A.Z.state,n=le.Z.state,i=ae.Z.state,r=se.default.state,a=e.isActive&&e.simpleTableStore===o,s=1===r.stores.length&&r.stores[0]===o,l=t.isActive&&t.simpleTableStore===o&&"cell"===t.hover.type&&t.hover.resizing,c=n.isActive&&n.simpleTableStore===o;return(a||s)&&!l&&!c&&!i.isKeyboardMode}),[o]);return t||!n?null:(0,V.jsx)($.Z,{isVisible:i,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,V.jsx)(ce,{...e})})};var fe=n(38007),ge=n(37524),he=n(6685),ve=n(8958),be=n(55367),ye=n(84139),_e=n(24677),Se=n(80402),we=n(98104),ke=n(3386),Ie=n(77907),Ce=n(52689);function xe(e){const{store:t,children:n,selection:o,disabled:i,canEdit:a}=e,s=(0,B.O7)(),l=(0,r.useCallback)((e=>{e.preventDefault&&e.preventDefault(),I.handleLeftRightKey({environment:s,direction:"left",bypassExistingTextSelection:!1,expandSelection:e.shiftKey})}),[s]),c=(0,r.useCallback)((e=>{e.preventDefault&&e.preventDefault(),I.handleLeftRightKey({environment:s,direction:"right",bypassExistingTextSelection:!1,expandSelection:e.shiftKey})}),[s]),d=(0,r.useCallback)((e=>{e.preventDefault&&e.preventDefault(),I.handleUpDownKey({environment:s,direction:"up",bypassExistingTextSelection:!1,expandSelection:e.shiftKey})}),[s]),u=(0,r.useCallback)((e=>{e.preventDefault&&e.preventDefault(),I.handleUpDownKey({environment:s,direction:"down",bypassExistingTextSelection:!1,expandSelection:e.shiftKey})}),[s]),p=(0,r.useCallback)((e=>{e.preventDefault&&e.preventDefault();const t=D.Z.state;if(t.isActive){const{selection:e,simpleTableStore:n}=t;C.isSingleCellSelected(e)&&I.selectCellAndSetCursor({environment:s,rowIndex:e.start.row,columnIndex:e.start.col,simpleTableStore:n})}}),[s]),m=(0,r.useCallback)((e=>{var t;null===(t=e.preventDefault)||void 0===t||t.call(e);const n=D.Z.state;if(!n.isActive)return;const{selection:o,simpleTableStore:i}=n;C.isSingleCellSelected(o)&&o.end.row===C.getNumberOfRows(i)-1&&K.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleShiftEnter",environment:s,perform:e=>{const t=o.end.row+1;I.insertRow({environment:s,transaction:e,index:t,simpleTableStore:i}),I.selectCellAndSetCursor({environment:s,rowIndex:t,columnIndex:o.start.col,simpleTableStore:i})}})}),[s]),f=(0,r.useCallback)((e=>{e.preventDefault&&e.preventDefault();const n=D.Z.state;if(!n.isActive)return;const{selection:o,simpleTableStore:i}=n;C.getSimpleTableCellFromTextSelection()?we.ZH(s):C.isSingleCellSelected(o)?I.selectRow({environment:s,index:o.start.row,simpleTableStore:i}):(I.clearSelection(),_e.Z5({environment:s,stores:[t]}))}),[s,t]),g=(0,r.useCallback)((e=>{K.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleDelete",environment:s,perform:e=>{I.handleDelete({environment:s,transaction:e})}})}),[s]),h=(0,r.useCallback)((e=>{!e.key||e.metaKey||e.ctrlKey||(ae.Z.setKeyboardMode(!0),K.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleKeypress",environment:s,perform:t=>{I.handleKeypress({environment:s,editorMode:"default",transaction:t,key:e.key})}}))}),[s]),{value:v}=(0,Ie.useDependency)(Ie.deps.exportJsxRenderer),b=(0,r.useCallback)((e=>{const t=D.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,i=C.getColumnOrder(o);i&&Se.qn({environment:s,simpleTableStore:o,selection:n,currentRows:o.getContentStores(),columnOrder:i,event:e,exportJsxRenderer:v})}),[s,v]),y=(0,r.useCallback)((e=>{!i&&a&&(b(e),K.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleCut",environment:s,perform:e=>{I.clearSelectionContents({environment:s,transaction:e})}}))}),[s,i,a,b]),{value:_}=(0,Ie.useDependency)(Ie.deps.markdownLinkifyIt),{value:S}=(0,Ie.useDependency)(Ie.deps.tinyMceMicrosoftWordPasteFilter),w=(0,r.useCallback)((e=>{if(i||!a)return;const t=D.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,r=C.getColumnOrder(o);r&&K.createAndCommit({userAction:"SimpleTableSelectionOverlay.handlePaste",environment:s,perform:t=>{Se.j0({environment:s,simpleTableStore:o,selection:n,currentRows:o.getContentStores(),columnOrder:r,event:e,transaction:t,markdownLinkifyIt:_,tinyMceMicrosoftWordPasteFilter:S})}})}),[s,i,a,_,S]),k=(0,r.useCallback)((e=>{e.preventDefault(),K.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleDuplicate",environment:s,perform:e=>{I.handleDuplicate({environment:s,transaction:e})}})}),[s]),x=(0,r.useCallback)(((e,n)=>{!i&&a&&(n.preventDefault(),K.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleAnnotation",environment:s,perform:n=>{I.annotateSimpleTableSelection({environment:s,editorMode:"default",simpleTableStore:t,annotation:e,transaction:n})}}))}),[s,i,a,t]),T=(0,r.useCallback)((e=>x(["h",Ce.Z.state.color],e)),[x]),M=(0,r.useCallback)((e=>x(["b"],e)),[x]),P=(0,r.useCallback)((e=>x(["i"],e)),[x]),A=(0,r.useCallback)((e=>x(["s"],e)),[x]),R=(0,r.useCallback)((e=>x(["_"],e)),[x]),E=(0,r.useCallback)((e=>x(["c"],e)),[x]);return(0,V.jsx)(ke.Z,{debugName:"SimpleTableKeyboardArea",capture:Boolean(o)&&!i&&a,onLeft:l,onRight:c,onUntab:l,onTab:c,onUp:d,onDown:u,onEnter:p,onShiftEnter:m,onEsc:f,onDelete:g,onBackspace:g,onKeypress:h,onCut:y,onCopy:b,onPaste:w,onDuplicate:k,onToggleHighlight:T,onToggleBold:M,onToggleItalics:P,onToggleStrike:A,onToggleUnderline:R,onToggleCode:E,children:n})}var Te=n(6740),Me=n(47453),Pe=n(15828);const Ae=(0,q.defineMessages)({tooltipContent:{id:"simpleTable.resizer.dimensions",defaultMessage:"{num_columns} Ã— {num_rows}"}});const Re=function(e){const t=(0,r.useRef)(null),n=(0,B.O7)(),{store:o,type:i,formatStore:a}=e,[s,l]=(0,r.useState)(!1),c=()=>{K.createAndCommit({userAction:"SimpleTableResizer.handleResizeClick",environment:n,perform:e=>{"row"!==i&&I.extendColumns({count:1,simpleTableStore:o,transaction:e}),"column"!==i&&I.extendRows({environment:n,count:1,simpleTableStore:o,transaction:e,analyticsFrom:"resize_click"})}})},d=(0,F.VK)((()=>Boolean(C.getTableResizeState(o,i))),[o,i]),u=(0,F.VK)((()=>{const e=C.getTableResizeState(o,i);return null==e?void 0:e.tooltipOriginRect}),[o,i]),p=(0,F.VK)((()=>{const e=o.getFormat(),{temporaryFormat:t}=a.state;return(t||e).table_block_column_order}),[a,o]),m=(0,F.VK)((()=>{const t=C.getTableResizeState(e.store);return t?t.rowsDelta:0}),[e.store]),f=(0,F.VK)((()=>{const t=A.Z.state,n=C.getTableResizeState(e.store,e.type);return!ae.Z.state.isKeyboardMode&&(function(e,t,n){if(!e.isActive||e.simpleTableStore!==n)return!1;const{hover:o}=e;if("cell"===o.type){const e=o.y===C.getNumberOfRows(n)-1,i=o.x===C.getNumberOfColumns(n)-1;return"row"===t?e:("column"===t||e)&&i}return"resizer"===o.type&&o.resizer===t}(t,e.type,e.store)||Boolean(n))||s}),[s,e.store,e.type]),g=(0,O.yK)((e=>({button:{height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:d?e.simpleTableSelectionBorder:e.lightDividerColor},plusIcon:{width:12,height:12,fill:d?W.ZP.white:e.mediumIconColor,padding:"auto"},outer:{},inner:{display:"flex",flexDirection:"row"===i?"row":void 0,width:"100%",height:"100%",opacity:f?1:0,pointerEvents:f?void 0:"none",transition:"opacity 150ms ease 50ms"}})),[d,f,i]);return(0,V.jsx)("div",{style:Be(e.type),onFocus:e=>{const t=e.target;t instanceof HTMLElement&&(0,Te.E)(t)&&l(!0)},onBlur:()=>{l(!1)},onMouseEnter:()=>{const{store:t,type:n}=e;I.hoverResizer({simpleTableStore:t,resizer:n})},onMouseLeave:()=>{I.clearHover()},ref:t,children:(0,V.jsx)(he.Z,{onDraggableDragStart:e=>{var n;e.preventDefault();const r=null===(n=t.current)||void 0===n?void 0:n.getBoundingClientRect();le.Z.setState({isActive:!0,simpleTableStore:o,resize:i,rowsDelta:0,columnsDelta:0,tooltipOriginRect:r}),a.setTemporaryFormat(o.getFormat())},onDraggableDragMove:n=>{var r;const s=C.getTableResizeState(o,i);if(!s)return;const l=null===(r=t.current)||void 0===r?void 0:r.getBoundingClientRect();if("row"!==i){const t=n.diffX>0?Math.ceil((n.diffX-30)/120):Math.floor((n.diffX+30)/120);if(t<0&&C.columnsHaveData({simpleTableStore:o,lastN:Math.abs(t)}))return;le.Z.setState({...s,columnsDelta:t,tooltipOriginRect:l});const i=function(t){const{store:n}=e,o=p||[],i=C.getColumnOrder(n)||[];if(t>0){const e=t-(o.length-i.length);if(e>0){const t=[...Array(e).keys()].map((e=>(0,Pe.ZP)()));return[...o,...t]}return o.slice(0,o.length+e)}return i.slice(0,Math.max(1,i.length-Math.abs(t)))}(t);a.updateColumnOrder(i),I.updateRowSelectionOnResize(i.length-1)}if("column"!==i){const e=n.diffY>0?Math.ceil((n.diffY-8)/32):Math.max(-(C.getNumberOfRows(o)-1),Math.floor((n.diffY+8)/32));if(e<0&&C.rowsHaveData({simpleTableStore:o,lastN:Math.abs(e)}))return;le.Z.setState({...s,rowsDelta:e,tooltipOriginRect:l}),I.updateColumnSelectionOnResize(C.getNumberOfRows(o)+e-1)}},onDraggableDragEnd:t=>{const r=C.getNumberOfColumns(o);K.createAndCommit({userAction:"SimpleTableResizer.handleDragEnd",environment:n,perform:e=>{"row"!==i&&p&&(p.length>r?I.extendColumns({count:p.length-r,simpleTableStore:o,transaction:e}):p.length<r&&I.contractColumns({simpleTableStore:o,columnOrder:p,transaction:e})),"column"!==i&&(m>0?I.extendRows({environment:n,count:m,simpleTableStore:o,transaction:e,analyticsFrom:"resize_drag"}):m<0&&I.contractRows({numRowsToDelete:Math.abs(m),simpleTableStore:o,transaction:e}))}}),Ee(e.formatStore)},onDraggableDragCancel:()=>{Ee(e.formatStore)},disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:t=>(0,V.jsx)("div",{style:g.inner,...t,children:(0,V.jsx)(oe.ZP,{renderTooltip:()=>(0,V.jsx)(De,{type:i,isResizing:d,columnOrder:p||[],rowCount:C.getNumberOfRows(o)+m}),placement:oe.ug.Bottom,delayThreshold:0,originRect:u,forceVisibleState:!0===d||void 0,render:t=>(0,V.jsx)(Q.Z,{onClick:c,style:Fe(!0,e.type),hoveredStyle:Fe(!0,e.type),...t,children:(0,V.jsx)("div",{style:g.button,children:(0,Me.R)(g.plusIcon)})})})})})})};function De(e){const t=(0,q.useIntl)(),{type:n,isResizing:o,columnOrder:i,rowCount:r}=e,a=(0,O.yK)((e=>({wrapper:{display:"flex",flexDirection:"column",alignItems:"center",color:e.mediumInvertedTextColor},boldText:{color:e.regularInvertedTextColor}})),[]);if(!o){const e=e=>(0,V.jsx)("b",{style:a.boldText,children:e});return(0,V.jsxs)("div",{style:a.wrapper,children:[(0,V.jsxs)("div",{children:["row"===n&&(0,V.jsx)(q.FormattedMessage,{id:"simpleTable.resizer.tooltipRow",defaultMessage:"<b>Click</b> to add a new row",values:{b:e}}),"column"===n&&(0,V.jsx)(q.FormattedMessage,{id:"simpleTable.resizer.tooltipColumn",defaultMessage:"<b>Click</b> to add a new column",values:{b:e}}),"corner"===n&&(0,V.jsx)(q.FormattedMessage,{id:"simpleTable.resizer.tooltipCorner",defaultMessage:"<b>Click</b> to add a new row and column",values:{b:e}})]}),(0,V.jsxs)("div",{children:["row"===n&&(0,V.jsx)(q.FormattedMessage,{id:"simpleTable.resizer.tooltipSubtitleRow",defaultMessage:"<b>Drag</b> to quickly add or remove rows",values:{b:e}}),"column"===n&&(0,V.jsx)(q.FormattedMessage,{id:"simpleTable.resizer.tooltipSubtitleColumn",defaultMessage:"<b>Drag</b> to quickly add or remove columns",values:{b:e}}),"corner"===n&&(0,V.jsx)(q.FormattedMessage,{id:"simpleTable.resizer.tooltipSubtitleCorner",defaultMessage:"<b>Drag</b> to quickly add or remove rows and columns",values:{b:e}})]})]})}const s=i||[],l=t.formatMessage(Ae.tooltipContent,{num_columns:s.length,num_rows:r});return(0,V.jsx)("div",{children:l})}function Ee(e){e.reset(),le.Z.reset()}function Be(e){const t={position:"absolute",display:"flex"};return"row"===e?{...t,flexDirection:"row",bottom:-x,left:0,right:0}:"column"===e?{...t,right:-x,top:0,bottom:0}:{...t,bottom:-x,right:-x}}function Fe(e,t){const n=e?16:20,o="100%";return"column"===t?{flex:1,width:n,height:o,cursor:"col-resize",borderRadius:4,overflow:"hidden"}:"row"===t?{flex:1,width:o,height:n,cursor:"row-resize",borderRadius:4,overflow:"hidden"}:{flex:1,width:n,height:n,cursor:"nwse-resize",borderRadius:"50%",overflow:"hidden"}}const Oe=9,Ze=26;function Ve(e){const{position:t,onDraggableDragStart:n,onDraggableDragMove:o,onDraggableDragEnd:i,onDraggableDragCancel:r}=e,a=(0,B.Fy)().isMobile?Ze:Oe,s=(0,O.yK)((e=>({tapArea:{position:"absolute",top:"top-left"===t?-a/2:void 0,left:"top-left"===t?-a/2:void 0,bottom:"bottom-right"===t?-a/2:void 0,right:"bottom-right"===t?-a/2:void 0,width:a,height:a,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",pointerEvents:"auto",cursor:"nwse-resize",zIndex:10},dragHandle:{width:Oe,height:Oe,border:`2px solid ${W.ZP.blueWithAlpha(.57)}`,background:e.contentBackground,borderRadius:"50%"}})),[t,a]);return(0,V.jsx)(he.Z,{allowDragWhileTextEditing:!0,onDraggableDragStart:n,onDraggableDragMove:o,onDraggableDragEnd:i,onDraggableDragCancel:r,render:e=>(0,V.jsx)("div",{...e,style:s.tapArea,children:(0,V.jsx)("div",{style:s.dragHandle})})})}const Ue=function(e){const t=(0,B.O7)(),n=(0,r.useRef)(null),o=(0,r.useRef)(void 0),{children:i,store:a,selection:s,formatStore:c,disabled:d,canEdit:u,columnOrder:p}=e,m=(0,F.VK)((()=>{const{disabled:n,canEdit:o}=e,{device:i}=t;return!(n||!o||i.isMobile)&&!(be.ZP.state.isDragging||function(e){const t=A.Z.state;if(!t.isActive)return!1;if(t.simpleTableStore!==e)return!1;if("cell"!==t.hover.type)return!1;return t.hover.resizing}(e.store)||function(e){const t=R.Z.state;return t.isActive&&t.simpleTableStore===e}(e.store))}),[t,e]),f=(0,F.SI)((()=>{if(s&&n.current&&p)return Le({cell:s.start,tableElement:n.current,store:a,columnOrder:p})}),[p,s,a],{useDeepEqual:!0}),g=(0,F.SI)((()=>{if(s&&n.current&&p)return Le({cell:s.end,tableElement:n.current,store:a,columnOrder:p})}),[p,s,a],{useDeepEqual:!0}),h=(0,F.Kw)(f),v=(0,F.Kw)(g);(0,r.useEffect)((()=>{const e=()=>{f.enqueueRecompute(),g.enqueueRecompute()};if(n.current){const t=new MutationObserver(e);return t.observe(n.current,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),()=>t.disconnect()}}),[g,f]);const b=(0,F.VK)((()=>{const t=R.Z.state;if(!t.isActive)return;if(t.simpleTableStore!==e.store)return;if(!n.current)return;const{source:o,selectorDragPx:i,moved:r}=t;if(o.selectorStartPx===i&&!r)return;if(!o.draggedCells[0])return;const a=o.draggedCells[0].rect,s=n.current.getBoundingClientRect(),c="column"===o.type?0:(0,l.Z)(i-s.top,-8,s.height-32);return{left:"column"===o.type?(0,l.Z)(i-s.left,-a.width/3,s.width-2/3*a.width):0,top:c,draggedCells:o.draggedCells,type:o.type}}),[e.store]),y=(0,F.VK)((()=>!e.disabled&&(h&&v||b)),[b,e.disabled,v,h]);return(0,V.jsx)(xe,{store:a,selection:s,disabled:d,canEdit:u,children:(0,V.jsx)(he.Z,{ref:e=>n.current=null==e?void 0:e.getNode(),onDraggableDragStart:t=>{e.canEdit&&(t.shiftKey&&e.selection?o.current=e.selection.start:o.current=We(t.startX,t.startY,e.store))},onDraggableDragMove:n=>{if(!e.canEdit||!o.current)return;const i=o.current,r=We(n.currentX,n.currentY,e.store);(0,ge.bp)(i,r)?I.selectCell({environment:t,rowIndex:i.row,columnIndex:i.col,simpleTableStore:e.store}):I.selectMultiCell({environment:t,start:i,end:r,simpleTableStore:e.store})},render:e=>(0,V.jsxs)("div",{style:{position:s||m?"relative":void 0},...e,children:[i,y&&(0,V.jsxs)("div",{style:{position:"absolute",top:0,left:0,pointerEvents:"none"},children:[(0,V.jsx)(je,{store:a,dragState:b,tableElement:n.current}),h&&v&&(0,V.jsx)(Ne,{startRect:h,endRect:v,dragState:b,canEdit:u,selection:s,store:a})]}),m&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(Re,{store:a,type:"column",formatStore:c},"column"),(0,V.jsx)(Re,{store:a,type:"row",formatStore:c},"row"),(0,V.jsx)(Re,{store:a,type:"corner",formatStore:c},"corner")]})]})})})};function Le(e){const{cell:t,tableElement:n,store:o,columnOrder:i}=e,r=o.getContentStores()[t.row],a=ye.Z.findCellsInRowFromStore(r,o,t.row),s=(l=a,c=i[t.col],null===(d=l.find((e=>e.getProps().columnID===c)))||void 0===d||null===(d=d.getNode())||void 0===d?void 0:d.getBoundingClientRect());var l,c,d;if(!s)return;const u=n.getBoundingClientRect(),p=s.top-u.top,m=s.left-u.left,f=s.width,g=function(e){return Math.max(...e.map((e=>{var t;return(null===(t=e.getNode())||void 0===t||null===(t=t.getBoundingClientRect())||void 0===t?void 0:t.height)||0})))}(a);return new DOMRect(m-2,p-2,f+4,g+4)}function je(e){const{store:t,tableElement:n,dragState:o}=e;if(!o||!n)return null;const i=n.getBoundingClientRect(),{draggedCells:r,type:a,left:s,top:l}=o;for(const c of r)c.rect="column"===a?new DOMRect(0,c.rect.top-i.top,c.rect.width,c.rect.height):new DOMRect(c.rect.left-i.left,0,c.rect.width,c.rect.height);return(0,V.jsx)("div",{style:{position:"absolute",left:s,top:l,zIndex:5},children:(0,V.jsx)(ve.Z,{store:t,ghostElement:r,opacity:.9},"simple_table_drag")})}function Ne(e){const{startRect:t,endRect:n,dragState:o,selection:i,store:a}=e,s=(0,B.O7)(),l=(0,B.Fy)(),c=Math.min(t.left,n.left),d=Math.min(t.top,n.top),u=Math.max(t.right,n.right),p=Math.max(t.top+t.height,n.top+n.height),m=(0,r.useRef)(void 0);function f(e){if(!i)return;const{start:t,end:n}=i;m.current={col:"top-left"===e?Math.max(t.col,n.col):Math.min(t.col,n.col),row:"top-left"===e?Math.max(t.row,n.row):Math.min(t.row,n.row)}}const g=t=>{if(!m.current)return;const n=We(t.currentX,t.currentY,a);I.selectMultiCell({environment:s,start:m.current,end:n,simpleTableStore:e.store})},h=(0,O.yK)((e=>({base:{position:"absolute",left:o&&"column"===o.type?o.left:c+1.5,top:o&&"row"===o.type?o.top:d+1.5,width:u-c-3,height:p-d-3},wrapper:{zIndex:o?4:2,backgroundColor:o?e.contentBackground:void 0,opacity:o?.9:void 0,boxShadow:o?e.mediumBoxShadow:void 0,borderRadius:2},inner:{border:`solid ${e.simpleTableSelectionBorder}`,borderWidth:2,borderRadius:2,zIndex:o?5:3}})),[3,o,p,u,c,d]);return t&&n?(0,V.jsxs)("div",{className:b.y4j,children:[(0,V.jsx)("div",{style:{...h.base,...h.wrapper}}),(0,V.jsx)("div",{style:{...h.base,...h.inner},children:e.canEdit&&(0,V.jsxs)(V.Fragment,{children:[!l.isMobile&&(0,V.jsx)(Ve,{position:"top-left",onDraggableDragStart:()=>f("top-left"),onDraggableDragMove:g}),(0,V.jsx)(Ve,{position:"bottom-right",onDraggableDragStart:()=>f("bottom-right"),onDraggableDragMove:g})]})})]}):null}function ze(e,t){const n=ye.Z.findCellsInRowFromStore(void 0,t,0).sort(((e,t)=>e.getProps().columnIndex-t.getProps().columnIndex));for(let o=0;o<n.length;o++){if(e<=n[o].getNode().getBoundingClientRect().right)return o}return n.length-1}function qe(e,t){const n=ye.Z.findCellsInColumnFromStore(t,0).sort(((e,t)=>e.getProps().rowIndex-t.getProps().rowIndex));for(let o=0;o<n.length;o++){if(e<=n[o].getNode().getBoundingClientRect().bottom)return o}return n.length-1}function We(e,t,n){return{col:ze(e,n),row:qe(t,n)}}const He=x;class Ke extends v.Z{constructor(){super(...arguments),this.storeTypes={formatStore:P},this.rootSizeObserver=new k.E,this.hoverSizeObserver=new k.E,this.nodeRef=r.createRef(),this.handleMount=e=>{e&&this.rootSizeObserver.observe(e)},this.handleHoverMount=e=>{const t=null==e?void 0:e.getNode();t&&this.hoverSizeObserver.observe(t)},this.getSelectableStyle=this.createComputedStore((()=>{const{device:e}=this.environment,t={width:"100%",position:"relative",alignSelf:"center"};return(e.isMobile||this.isInColumnList()||!this.isRootOrDirectChild())&&(t.maxWidth=this.numberOfComments.state?"calc(100% - 40px)":"100%"),t})),this.columnOrder=this.createComputedStore((()=>{const{store:e}=this.props,t=e.getFormat(),{temporaryFormat:n}=this.stores.formatStore.state;return(n||t).table_block_column_order})),this.simpleTableSelection=this.createComputedStore((()=>{const e=D.Z.state,{store:t}=this.props;if(e.isActive&&e.simpleTableStore===t){var n;const o=(null===(n=this.columnOrder.state)||void 0===n?void 0:n.length)||C.getNumberOfColumns(t),i=C.getNumberOfRows(t)+this.numTempRows.state,{selection:r}=e;return{start:{col:(0,l.Z)(r.start.col,0,o-1),row:(0,l.Z)(r.start.row,0,i-1)},end:{col:(0,l.Z)(r.end.col,0,o-1),row:(0,l.Z)(r.end.row,0,i-1)},type:r.type}}}),!0),this.numTempRows=this.createComputedStore((()=>{const e=C.getTableResizeState(this.props.store);return e?e.rowsDelta:0})),this.resizeCursor=this.createComputedStore((()=>{const{store:e}=this.props,t=A.Z.state;if(t.isActive&&t.simpleTableStore===e){const{hover:e}=t;if("cell"===e.type&&e.resizing)return"col-resize"}const n=C.getTableResizeState(e);if(n){if("column"===n.resize)return"col-resize";if("row"===n.resize)return"row-resize";if("corner"===n.resize)return"nwse-resize"}const o=R.Z.state;if(o.isActive&&o.simpleTableStore===e)return"grab"})),this.numberOfBlockComments=this.createComputedStore((()=>C.getNumberOfUnresolvedComments({simpleTableStore:this.props.store,environment:this.environment,includeInline:!1})),!0),this.numberOfComments=this.createComputedStore((()=>C.getNumberOfUnresolvedComments({simpleTableStore:this.props.store,environment:this.environment,includeInline:!0})),!0)}willUnmount(){this.rootSizeObserver.destroy(),this.hoverSizeObserver.destroy()}renderPersisted(){var e,t;const{store:n,disabled:o,disableHoverMenu:i}=this.props,r=this.numberOfComments.state,a=this.numberOfBlockComments.state,s=r>0&&0===a,l=(0,V.jsx)(m.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store,recursivelyLoadAllDiscussions:!this.marginCommentsVisible.state,hideIfSidebarOrMarginCommentsVisible:s}),c=Boolean(l)&&r>0||this.isInColumnList(),p=(0,V.jsx)(g.Z,{type:w.Z.X,preventType:u.Q7(this.environment),style:{flexGrow:1},showLeftRightOverlay:!0,leftOverlayStyle:{left:c?0:-((null===(e=this.getLeftRightPadding())||void 0===e?void 0:e.paddingLeft)||0),top:8,bottom:He},rightOverlayStyle:{top:8,bottom:He},children:this.renderContent(c)}),v=(0,_.Fn)(this.environment),b=!o&&("comment_only"===this.props.store.getRole()||"comment"===(null===(t=this.pageContext)||void 0===t?void 0:t.publicEditModeStore.state.permission))&&this.environment.currentUser.isLoggedIn();return(0,V.jsxs)(f.p,{allowSelectionWithin:!0,style:this.getStyle(),ref:this.handleMount,onMouseDown:e=>function(e,t){const{device:n}=t;n.isMobile||(0,y.ZP)({event:e,context:y.Af.EditorMouseDown,callback:()=>{e.preventDefault(),d.AI({environment:t,target:e.target,startX:e.clientX,startY:e.clientY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!0})}})}(e,this.environment),children:[c?(0,V.jsx)(h.Z,{store:n,shouldShowHoverMenu:!i&&(this.canEdit()||v),shouldShowCommentMenu:b,style:this.getSelectableStyle.state,analyticsName:"page_content",ref:this.handleHoverMount,children:p}):p,l,(0,V.jsx)(me,{disabled:o,canEdit:this.canEdit(),simpleTableStore:n,rootSizeObserver:this.rootSizeObserver,offset:c?0:this.getOffset()||0,hoverSizeObserver:this.hoverSizeObserver})]})}renderContent(e){var t;const{store:n,disabled:o,disableHoverMenu:i}=this.props,r=n.getContentStores(),a=this.columnOrder.state;if(!a)return;const s=this.numTempRows.state,l=s<0?r.length+s:r.length,d=((0,c.$K)(this.props.showRowIds)?r.filter((e=>{var t;return null===(t=this.props.showRowIds)||void 0===t?void 0:t.includes(e.id)})):r).slice(0,l),u=this.simpleTableSelection.state,{device:p}=this.environment,m=!p.isPhone,f=!o&&("comment_only"===this.props.store.getRole()||"comment"===(null===(t=this.pageContext)||void 0===t?void 0:t.publicEditModeStore.state.permission))&&this.environment.currentUser.isLoggedIn(),g=(0,V.jsx)("div",{style:{display:"flex"},children:(0,V.jsx)("div",{style:{paddingTop:8,paddingBottom:He,paddingRight:He},children:(0,V.jsx)(h.Z,{store:n,shouldShowHalo:!0,canSelect:!0,canDropLeft:m,canDropRight:m,canDropAbove:!1,canDropBelow:!1,aboveDropZoneMargin:4,belowDropZoneMargin:4,analyticsName:"page_content",shouldShowDropZone:!0,style:{position:"relative"},className:b.OE$,shouldShowCommentMenu:f,nodeRef:this.nodeRef??void 0,children:(0,V.jsx)(Ue,{store:n,selection:u,columnOrder:a,formatStore:this.stores.formatStore,disabled:o,canEdit:this.canEdit(),children:(0,V.jsx)("table",{children:(0,V.jsxs)("tbody",{ref:this.nodeRef,children:[d.map(((e,t)=>(0,V.jsx)(fe.Z,{rowIndex:t,rowStore:e,store:n,disabled:o,columnOrder:a,selection:u,formatStore:this.stores.formatStore},e.id))),s>0&&void 0===this.props.showRowIds&&[...Array(s).keys()].map(((e,t)=>(0,V.jsx)(fe.Z,{rowIndex:C.getNumberOfRows(n)+t,store:n,rowStore:void 0,disabled:o,columnOrder:a,selection:u,formatStore:this.stores.formatStore},t)))]})})})})})}),v=(0,_.Fn)(this.environment);return(0,V.jsx)("div",{className:b.fOh,style:{cursor:this.resizeCursor.state,...e?{paddingRight:20}:this.getLeftRightPadding()},children:e?g:(0,V.jsx)(h.Z,{store:n,shouldShowCommentMenu:f,shouldShowHoverMenu:!i&&(this.canEdit()||v),style:this.getSelectableStyle.state,analyticsName:"page_content",ref:this.handleHoverMount,children:g})})}handleCreated(){s.default.afterNextFlush((()=>{I.selectCellAndSetCursor({environment:this.environment,rowIndex:0,columnIndex:0,simpleTableStore:this.props.store})}))}getStyle(){const{store:e}=this.props;return{...this.getBlockColorStyle(),...this.props.style,position:"relative",display:"flex",...(0,p.Ks)(e)&&{width:(0,S.$3)(this.environment),position:"sticky",left:0}}}isInColumnList(){return this.context.isInColumnList}getLeftRightPadding(){const{store:e}=this.props;return(0,p.Bs)({environment:this.environment,store:e,isFullScreen:!1,sizeObserver:this.rootSizeObserver})}getOffset(){var e;return null===(e=this.getLeftRightPadding())||void 0===e?void 0:e.paddingLeft}}Ke.contextTypes={...a.w,isInColumnList:i().any};const Ge=Ke},38007:(e,t,n)=>{n.d(t,{Z:()=>ne});var o=n(67294),i=n(86628),r=n(26249),a=n(43250),s=n(78429),l=n(73819),c=n(480),d=n(33125),u=n(24405),p=n(31701),m=n(37810),f=n(893),g=n(80402),h=n(993),v=n(98104),b=n(13447),y=n(65187),_=n(12534),S=n(68056),w=n(77907),k=n(24666),I=n(98794),C=n(27534),x=n(84139),T=n(5676),M=n(63208),P=n(6695),A=n(53965),R=n(44534),D=n(6685),E=n(89224),B=n(64359),F=n(85893);const O=function(e){const t=(0,o.useRef)(),n=(0,c.O7)(),r=(0,i.VK)((()=>Boolean(R.g$.getTableResizeState(e.simpleTableStore))),[e.simpleTableStore]),{columnIndex:s,simpleTableStore:l,columnID:d,getWidth:m,onTemporaryResize:f,onAccept:g,onCancel:h}=e,v=(0,i.VK)((()=>{const e=B.Z.state;return!!e.isActive&&(e.simpleTableStore===l&&("cell"===e.hover.type&&(!r&&(e.hover.x===s&&(e.hover.showResizer||e.hover.resizing)))))}),[s,r,l]),y=(0,u.yK)((e=>({wrapper:{position:"absolute",right:0,width:0,top:0,flexGrow:0,height:"100%",zIndex:1},innerStyle:{position:"absolute",width:3,marginLeft:-1,marginTop:-1,height:"calc(100% + 2px)",transition:"background 150ms ease 50ms",cursor:r?void 0:"col-resize",background:v?e.simpleTableSelectionBorder:p.ZP.blueWithAlpha(0)}})),[r,v]),_=(0,o.useCallback)((e=>{e.preventDefault();const n=R.g$.getColumnFormat(l);t.current=n&&d in n?n[d]:{},t.current.width=m(),I.setResizing(!0)}),[d,m,l]),S=(0,o.useCallback)((e=>{const t=T(e);t&&f(t)}),[f]),w=(0,o.useCallback)((e=>{const t=T(e);t&&g(t),I.setResizing(!1)}),[g]),k=(0,o.useCallback)((()=>{h(),t.current=void 0,I.setResizing(!1)}),[h]),C=(0,o.useCallback)((()=>{const t=x.Z.findCellsInColumnFromStore(e.simpleTableStore,e.columnId),o=A.oA(t.map((e=>{var t;const n=null===(t=e.getNode())||void 0===t?void 0:t.querySelector(`.${a.Iiy}`);if(n)return function(e){const t=window.getComputedStyle(e),n=e.cloneNode(!0),o=n;o.id="notion-table-cell-shadow",Array.from(t).forEach((e=>o.style.setProperty(e,t.getPropertyValue(e),t.getPropertyPriority(e)))),o.style.opacity="0",o.style.width="100%",o.style.pointerEvents="none",document.body.appendChild(n);const i=o.querySelector(`.${a.qnV}`);if(!i)return void o.remove();i.style.width="",i.style.display="inline-block";const r=window.document.createRange();r.selectNode(i);const s=E.getRect(r);return o.remove(),null!=s&&s.width?s.width+X:void 0}(n)})));b.createAndCommit({userAction:"SimpleTableColumnResizer.handleDoubleClick",environment:n,perform:t=>{I.resizeColumn({tableBlockColumnFormat:{...Z(e.format,e.formatStore).table_block_column_format,[e.columnId]:{width:Math.max(...o)}},simpleTableStore:e.simpleTableStore,transaction:t})}})}),[n,e.columnId,e.format,e.formatStore,e.simpleTableStore]);function T(e){var n;if(null!==(n=t.current)&&void 0!==n&&n.width){const n=Math.max(t.current.width+e.diffX,P.lw);return{...t.current,width:n}}}return(0,F.jsx)("div",{style:y.wrapper,onMouseMove:()=>I.showResizeBar(!0),onMouseLeave:()=>I.showResizeBar(!1),children:(0,F.jsx)(D.Z,{onDraggableDragStart:_,onDraggableDragMove:S,onDraggableDragEnd:w,onDraggableDragCancel:k,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:e=>(0,F.jsx)("div",{style:y.innerStyle,onDoubleClick:C,...e})})})};function Z(e,t){const{temporaryFormat:n}=t;return n||e}const V=function(e){const{rowIndex:t,columnIndex:n,simpleTableStore:o}=e,r=(0,i.VK)((()=>{const e=T.Z.state;if(e.isActive&&e.simpleTableStore===o&&e.moved&&e.source.index!==e.destIndex)return{destIndex:e.destIndex,sourceIndex:e.source.index,type:e.source.type}}),[o],{useDeepEqual:!0}),{destIndex:a,sourceIndex:s,type:l}=r||{destIndex:0,sourceIndex:0},c=(0,u.yK)((e=>({sharedStyle:{position:"absolute",flexGrow:0,zIndex:2,background:e.simpleTableSelectionBorder},rowStyle:{top:s>a?0:void 0,bottom:s<a?0:void 0,left:-1,width:"calc(100% + 2px)",height:3},columnStyle:{top:-1,left:s>a?0:void 0,right:s<a?0:void 0,width:3,height:"calc(100% + 2px)"}})),[s,a]);return r?"row"===l&&a===t?(0,F.jsx)("div",{style:{...c.sharedStyle,...c.rowStyle}}):"column"===l&&a===n?(0,F.jsx)("div",{style:{...c.sharedStyle,...c.columnStyle}}):null:null};var U=n(12217),L=n(1898),j=n(36610),N=n(6404),z=n(64921),q=n(8949),W=n(22294),H=n(27724),K=n(35431);class G extends K.Z{findSelectorsOfTypeFromStore(e,t){return this.filter((n=>{const o=n.getProps();return o.simpleTableStore===t&&o.type===e}))}}const $=new G;const Q=function(e){const t=(0,c.O7)(),n=(0,o.useRef)(),r=(0,o.useRef)(null),a=(0,u.Fg)();(0,d.c)($,(()=>({getProps:()=>e,getNode:()=>{var e;return(null===(e=r.current)||void 0===e?void 0:e.getNode())??null}})),[e]);const s=()=>{n.current=void 0,I.cancelReorder()},l=n=>{N.Qn({environment:t,stores:[e.simpleTableStore],left:n.startX,top:n.startY,showInput:!0,actionSectionGroupKey:"simple_table",analyticsFrom:"simple_table_menu"})},p=(0,i.VK)((()=>{const{isMobile:n}=t.device;if(n)return function(e,t,n){const o=M.Z.state;if(!o.isActive)return!1;if(o.simpleTableStore!==e)return!1;const{selection:i}=o;if(C.isSingleCellSelected(i)){if("column"===t)return i.start.col===n;if("row"===t)return i.start.row===n}return!1}(e.simpleTableStore,e.type,e.index);const{isKeyboardMode:o}=W.Z.state;if(o)return!1;const{simpleTableStore:i,type:r,index:a}=e;if(T.Z.state.isActive)return!1;const s=B.Z.state;if(!s.isActive)return!1;if(s.simpleTableStore!==i)return!1;if(C.getTableResizeState(i))return!1;const l=H.default.state;if(l.stores[0]===i&&l.phase===H.SelectionPhase.Selected)return!1;const c=s.hover;return"cell"!==c.type?c.type===r&&c.index===a:"column"===r?c.x===a:"row"===r&&c.y===a}),[t.device,e],{useDeepEqual:!0}),m=e.isSelected||p;return(0,F.jsx)(D.Z,{ref:r,allowDragWhileTextEditing:!0,onDraggableDragStart:m?o=>{var i;const{type:s}=e;o.preventDefault();const l=null===(i=r.current)||void 0===i||null===(i=i.getNode())||void 0===i?void 0:i.parentNode;if(!(l&&l instanceof Element))return;const c=l.getBoundingClientRect();n.current="column"===s?c.x:c.y;const d="column"===s?o.startX-c.x:o.startY-c.y;I.startReorder({...e,environment:t,theme:a,selectorStartPx:n.current,mouseOffsetPx:d})}:void 0,onDraggableDragMove:m?t=>{const{type:o}=e;if(!n.current)return;const i=T.Z.state;if(!i.isActive)return;const r="column"===o?t.diffX:t.diffY;if(0!==r){const t=n.current+r,o=function(e,t,n){const{delta:o,selectorDragPx:i}=e,r=$.findSelectorsOfTypeFromStore(n,t);if(o>0){const e=r.map((e=>{var t;const o=null===(t=e.getNode())||void 0===t?void 0:t.parentNode;if(!(o&&o instanceof Element))return;const i=o.getBoundingClientRect();return"column"===n?null==i?void 0:i.x:null==i?void 0:i.y})).filter(L.$K);e.sort(((e,t)=>e-t));for(let t=e.length-1;t>=0;t--)if(i>e[t])return t;return 0}const a=r.map((e=>{var t;const o=null===(t=e.getNode())||void 0===t?void 0:t.parentNode;if(!(o&&o instanceof Element))return;const i=o.getBoundingClientRect();return"column"===n?i.x+i.width:i.y+i.height})).filter(L.$K);return a.sort(((e,t)=>e-t)),a.filter(L.$K).findIndex((e=>i<e))}({delta:r,selectorDragPx:t+i.source.mouseOffsetPx},e.simpleTableStore,e.type);I.continueReorder({destIndex:o,selectorDragPx:t})}}:void 0,onDraggableDragEnd:m?n=>{const{isMobile:o}=t.device,{simpleTableStore:i,type:r,format:a}=e;b.createAndCommit({userAction:"SimpleTableRowColumnSelector.handleDragEnd",environment:t,perform:e=>{I.completeReorder({event:n,environment:t,simpleTableStore:i,transaction:e,format:a,type:r,onNoChange:o?void 0:l})}}),"row"===r&&j.RO(t,{from:"selection_menu",draggedTypes:["table_row"],asCopy:!1}),s()}:void 0,onDraggableDragCancel:m?()=>{s()}:void 0,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:t=>(0,F.jsx)(Y,{enabled:m,isSelected:e.isSelected,draggableEvents:t,type:e.type,index:e.index,simpleTableStore:e.simpleTableStore})})};function Y(e){const{type:t,enabled:n,isSelected:o,draggableEvents:r}=e,s=(0,c.O7)(),l=(0,i.VK)((()=>T.Z.state.isActive),[],{useDeepEqual:!0}),d=()=>{const{simpleTableStore:t,type:n,index:o}=e;I.hoverRowColumn({type:n,simpleTableStore:t,index:o})},m=()=>{I.clearHover()},f=(0,u.yK)((t=>({base:{opacity:n?1:0,pointerEvents:n?void 0:"none",transition:"opacity 150ms ease",fill:t.lightIconColor,position:"absolute",display:"flex",alignItems:"center",cursor:l?"grab":"pointer",justifyContent:"center",borderRadius:4,background:t.whiteButtonBackground,boxShadow:e.isSelected?void 0:t.lightBoxShadow,zIndex:4},column:{...J(e.isSelected,t),top:-8,left:"calc(50% - 13px)",height:16,width:26,padding:"2px 4px"},row:{...J(e.isSelected,t),top:"calc(50% - 13px)",left:-8,width:16,height:26,padding:"4px 2px"},hovered:{background:t.whiteButtonHoveredBackground,...J(e.isSelected,t)},pressed:{...J(e.isSelected,t,!0)}})),[n,l,e.isSelected]);return(0,F.jsx)(z.Z,{className:"column"===t?a.Apy:a.f0e,style:{...f.base,...f[t]},hoveredStyle:f.hovered,pressedStyle:f.pressed,onClick:t=>function(e,t,n,o,i){const{isMobile:r}=i.device;q.Z.state.isActive||N.Qn({environment:i,stores:[o],left:e.clientX,top:e.clientY,showInput:!0,actionSectionGroupKey:"simple_table",analyticsFrom:"simple_table_menu"});r&&("column"===t?I.selectColumn({environment:i,index:n,simpleTableStore:o}):I.selectRow({environment:i,index:n,simpleTableStore:o}))}(t,e.type,e.index,e.simpleTableStore,s),onTouchStart:d,onTouchEnd:m,onMouseEnter:d,onMouseLeave:m,...r,disallowTabbing:!0,children:(0,U.D)({fill:o?p.ZP.white:void 0,width:14,height:14,transform:"column"===t?"rotate(90deg)":void 0})})}function J(e,t){return e||arguments.length>2&&void 0!==arguments[2]&&arguments[2]?{background:t.simpleTableSelectionBorder}:void 0}const X=1;function ee(e){const t=(0,o.useRef)(null),n=(0,o.useRef)(null),{value:r}=(0,w.useDependency)(w.deps.exportJsxRenderer),{value:s}=(0,w.useDependency)(w.deps.markdownLinkifyIt),{columnID:l,columnIndex:P,simpleTableStore:A,rowIndex:R,store:D,format:E,disabled:B,canEdit:Z,legacyTransclusionParent:U,selection:L}=e,j=(0,c.Fy)(),N=(0,c.O7)(),z=!B&&Z,q=(0,i.VK)((()=>null==D?void 0:D.getPropertyStore(l)),[l,D]);(0,d.c)(x.Z,(()=>({getProps:()=>e,getNode:()=>t.current,getTextStore:()=>q})),[e,q]);const W=(0,i.VK)((()=>e.formatStore.state.temporaryFormat||e.format),[e.format,e.formatStore]),H=e=>{const t=M.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,i=C.getColumnOrder(o);if(!i)return;f.JG({environment:N,event:e,markdownLinkifyIt:s});const a="editing"===k.default.state.mode&&k.default.state.multiSelection;a&&!(0,S.iG)(a)||g.qn({environment:N,simpleTableStore:o,selection:n,currentRows:o.getContentStores(),columnOrder:i,event:e,exportJsxRenderer:r})},K=(0,i.VK)((()=>{if(!D)return!1;const e=T.Z.state;if(!e.isActive||e.simpleTableStore!==A||!e.moved)return!1;const{type:t,id:n}=e.source;return"column"===t?n===l:n===D.id}),[l,A,D]),{headerColumn:G,headerRow:$}=(0,i.VK)((()=>function(e){return C.getHeadersEnabled(e)}(e.simpleTableStore)),[e.simpleTableStore]),{blockColor:Y,columnFormat:J}=(0,i.VK)((()=>({blockColor:null==D?void 0:D.getFormat().block_color,columnFormat:C.getColumnFormat(A)})),[D,A]),ee=(0,u.yK)((e=>{var t,n;const o=function(e){const{columnFormat:t,rowIndex:n,columnIndex:o,columnID:i,theme:r,headerColumn:a,headerRow:s,blockColor:l}=e;let c=l||"default";if(t&&i in t){var d;const e=null===(d=t[i])||void 0===d?void 0:d.color;e&&(c=e)}if(0===n&&s||0===o&&a)return"default"!==c?{...(0,p.fi)(c,r),fontWeight:m.Z.fontWeight.medium}:{background:r.tableHeaderRowColumnBackground,fontWeight:m.Z.fontWeight.medium};return(0,p.fi)(c,r)}({columnFormat:J,rowIndex:R,columnIndex:P,headerColumn:G,headerRow:$,columnID:l,blockColor:Y,theme:e}),i=W.table_block_column_format;return{cell:{...o,border:`${X}px solid ${e.tableDividerColor}`,position:"relative",verticalAlign:"top",textAlign:"start",minWidth:(null==i||null===(t=i[l])||void 0===t?void 0:t.width)??120,maxWidth:(null==i||null===(n=i[l])||void 0===n?void 0:n.width)??240,minHeight:32},contents:{width:"100%",height:"100%",...o},text:{padding:"7px 9px",backgroundColor:"transparent",fontSize:14,lineHeight:"20px"}}}),[Y,J,l,P,W.table_block_column_format,G,$,R]),{isColumnSelected:te,isRowSelected:ne}=(0,i.VK)((()=>L?{isColumnSelected:C.isColumnSelected({selection:L,columnIndex:P,simpleTableStore:A}),isRowSelected:C.isRowSelected({selection:L,rowIndex:R,simpleTableStore:A})}:{isColumnSelected:!1,isRowSelected:!1}),[P,R,L,A]),oe=(0,F.jsxs)(F.Fragment,{children:[K&&(0,F.jsx)("div",{style:ee.contents}),(0,F.jsxs)("div",{className:a.Iiy,style:{visibility:K?"hidden":void 0},children:[D&&0===R&&z&&(0,F.jsx)(Q,{index:P,type:"column",simpleTableStore:A,isSelected:te,id:l,format:E,rowStore:D}),D&&0===P&&z&&(0,F.jsx)(Q,{index:R,type:"row",simpleTableStore:A,isSelected:ne,id:D.id,format:E,rowStore:D}),q?(0,F.jsx)(y.Z,{ref:n,disabled:B,store:q,disableSlashCommands:!0,onClick:t=>{const{rowIndex:n,columnIndex:o,simpleTableStore:i,disabled:r,canEdit:a}=e;r||a&&t.shiftKey&&I.expandCellSelection({environment:N,rowIndex:n,columnIndex:o,simpleTableStore:i})},onEnter:t=>{var o;if(t.preventDefault(),null===(o=n.current)||void 0===o||!o.isComposing())if(j.isMobile){const{disabled:t,canEdit:n}=e;if(t||!n)return;const o=k.default.state;if("editing"===o.mode){const e="default";b.createAndCommit({userAction:"SimpleTableCell.mobileEnter",environment:N,perform:t=>{h.hJ({environment:N,editorMode:e,string:"\n",multiSelection:o.multiSelection,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t})}})}}else{"editing"===k.default.state.mode&&I.handleUpDownKey({environment:N,direction:"down",bypassExistingTextSelection:!0})}},onTab:e=>{e.preventDefault(),I.handleLeftRightKey({environment:N,direction:"right",bypassExistingTextSelection:!0})},onUntab:e=>{e.preventDefault(),I.handleLeftRightKey({environment:N,direction:"left",bypassExistingTextSelection:!0})},onEsc:t=>{e.disabled||(t.preventDefault(),v.ZH(N))},onCut:t=>{const{disabled:n,canEdit:o}=e;if(n||!o)return;H(t);const i="editing"===k.default.state.mode&&k.default.state.multiSelection;i&&!(0,S.iG)(i)?b.createAndCommit({userAction:"SimpleTableCell.handleCut",environment:N,perform:e=>{h.pz({environment:N,multiSelection:i,transaction:e,editorMode:"default"})}}):b.createAndCommit({userAction:"SimpleTableCell.handleCut",environment:N,perform:e=>{I.clearSelectedCell({environment:N,transaction:e})}})},onCopy:H,style:ee.text,pasteBehavior:"inline",className:a.qnV,disableDrag:!0,legacyTransclusionParent:U,inPageFind:{type:"block_match"}}):(0,F.jsx)("div",{style:ee.text,children:"Â "}),!j.isMobile&&z&&(0,F.jsx)(O,{format:e.format,formatStore:e.formatStore,columnId:e.columnID,columnIndex:P,columnID:l,simpleTableStore:A,getWidth:()=>{var e;return(null===(e=t.current)||void 0===e?void 0:e.getBoundingClientRect().width)||0},onTemporaryResize:t=>{const{formatStore:n}=e;n.setTemporaryFormat({...W,table_block_column_format:{...E.table_block_column_format,[l]:t}})},onAccept:()=>{const{simpleTableStore:t,formatStore:n}=e,o=W.table_block_column_format;b.createAndCommit({userAction:"SimpleTableCell.handleColumnResizeAccept",environment:N,perform:e=>{I.resizeColumn({tableBlockColumnFormat:o||{},simpleTableStore:t,transaction:e})}}),n.setTemporaryFormat(void 0)},onCancel:()=>{const{formatStore:t}=e;t.setTemporaryFormat(void 0)}}),!j.isMobile&&z&&(0,F.jsx)(V,{simpleTableStore:A,rowIndex:R,columnIndex:P})]})]}),ie={style:ee.cell,onClick:t=>{const{columnIndex:n,simpleTableStore:o,rowIndex:i,disabled:r,canEdit:a}=e;r||(0,_.ZP)({event:t,context:_.Af.EditorClick,callback:()=>{a&&t.shiftKey?I.expandCellSelection({environment:N,rowIndex:i,columnIndex:n,simpleTableStore:o}):a?I.selectCellAndSetCursor({environment:N,rowIndex:i,columnIndex:n,simpleTableStore:o}):I.selectCell({environment:N,rowIndex:i,columnIndex:n,simpleTableStore:o})}})},onContextMenu:t=>{const{columnIndex:n,simpleTableStore:o,rowIndex:i,disabled:r}=e;r||(0,_.ZP)({event:t,context:_.Af.EditorContextMenu,callback:()=>{I.selectCell({environment:N,rowIndex:i,columnIndex:n,simpleTableStore:o})}})},onMouseEnter:()=>{const{rowIndex:t,columnIndex:n,simpleTableStore:o,disabled:i}=e;i||I.hoverCell({x:n,y:t,simpleTableStore:o})},onMouseLeave:()=>{e.disabled||I.clearHover()}};return $&&0===R?(0,F.jsx)("th",{ref:t,scope:"col",...ie,children:oe}):G&&0===P?(0,F.jsx)("th",{ref:t,scope:"row",...ie,children:oe}):(0,F.jsx)("td",{ref:t,...ie,children:oe})}function te(e,t){let{columnOrder:n,store:r,rowIndex:c,rowStore:d,selection:u,formatStore:p,disabled:m}=e;const f=(0,o.useRef)(null),g=(0,l.PE)(r,m),h=(0,i.VK)((()=>r.getFormat()),[r]),v=(0,i.VK)((()=>Boolean(d)&&d.getParentId()!==r.id),[d,r.id]),b=(0,i.VK)((()=>(0,s.H)()&&v?{border:"3px dashed deeppink"}:{}),[v]);return(0,l.ez)(r,t,(0,o.useMemo)((()=>({renderedType:"table",getNode:()=>f.current,getBlockStore:()=>r})),[r]),n?(0,F.jsx)("tr",{className:a.M_0,style:b,ref:f,children:n.map(((e,t)=>(0,F.jsx)(ee,{disabled:m,canEdit:g,columnID:e,columnIndex:t,rowIndex:c,store:d,simpleTableStore:r,selection:u,formatStore:p,format:h,legacyTransclusionParent:v?r:void 0},e)))}):null)}const ne=o.memo(o.forwardRef(te),r.Z)},27534:(e,t,n)=>{n.r(t),n.d(t,{blockSelectionInSimpleTable:()=>x,cloneCellsForDragOverlay:()=>D,columnsHaveData:()=>Z,getCellTextStore:()=>R,getColumnFormat:()=>I,getColumnOrder:()=>S,getHeadersEnabled:()=>C,getNextEditableStoreForSimpleTable:()=>N,getNumberOfColumns:()=>w,getNumberOfRows:()=>k,getNumberOfUnresolvedComments:()=>F,getPagesInCollectionForSimpleTableTransform:()=>L,getPreviousEditableStoreForSimpleTable:()=>j,getSimpleTableCellFromTextSelection:()=>A,getTableResizeState:()=>E,isColumnSelected:()=>T,isPropertyTypeConvertableToSimpleTable:()=>V,isRowSelected:()=>M,isSingleCellSelected:()=>P,renderCellValueForActivity:()=>B,rowsHaveData:()=>O,simpleTableTransformPageLimit:()=>U});var o=n(42875),i=n(21202),r=n(23867),a=n(31701),s=n(37850),l=n(1898),c=n(54642),d=n(42239),u=n(60682),p=n(43250),m=n(14976),f=n(65598),g=n(89086),h=n(24646),v=n(6258),b=n(24666),y=n(84139),_=n(29574);function S(e){var t;return null===(t=e.getFormat())||void 0===t?void 0:t.table_block_column_order}function w(e){var t;return(null===(t=S(e))||void 0===t?void 0:t.length)||0}function k(e){return e.getContentLength()}function I(e){var t;return null===(t=e.getFormat())||void 0===t?void 0:t.table_block_column_format}function C(e){var t,n;return{headerColumn:null==e||null===(t=e.getFormat())||void 0===t?void 0:t.table_block_row_header,headerRow:null==e||null===(n=e.getFormat())||void 0===n?void 0:n.table_block_column_header}}function x(e){const t=["table","table_row"];return e.map((e=>e.getType())).some((e=>e&&t.includes(e)))}function T(e){const{selection:t,columnIndex:n,simpleTableStore:o}=e,i=t.start.col<=n&&n<=t.end.col;return"column"===t.type&&i&&0===t.start.row&&t.end.row===k(o)-1}function M(e){const{selection:t,rowIndex:n,simpleTableStore:o}=e,i=t.start.row<=n&&n<=t.end.row;return"row"===t.type&&i&&0===t.start.col&&t.end.col===w(o)-1}function P(e){return e.start.col===e.end.col&&e.start.row===e.end.row}function A(){const e="editing"===b.default.state.mode&&b.default.state.multiSelection;if(e)return y.Z.findCellFromTextStore(e.start.store)}function R(e){const{simpleTableStore:t,rowIndex:n,columnIndex:o}=e,i=t.getContentStores()[n];if(!i)return;const r=S(t);if(!r)return;const a=r[o];return a?i.getPropertyStore(a):void 0}function D(e){const{cells:t,type:n,theme:o}=e;return t.map((e=>function(e){const{cell:t,type:n,theme:o}=e,i=t.getNode();if(!i)return;const r=d.eN(t.getNode()),s=r.cloned.querySelector(`.${p.Apy}`),l=r.cloned.querySelector(`.${p.f0e}`);"column"===n?(s&&(s.style.left="calc(50% - 15px)",s.style.fill=a.ZP.white,s.style.background=o.simpleTableSelectionBorder),l&&(l.style.visibility="hidden")):(l&&(l.style.top="calc(50% - 15px)",l.style.left="-7px",l.style.fill=a.ZP.white,l.style.background=o.simpleTableSelectionBorder),s&&(s.style.visibility="hidden"));return{cloned:r.cloned,rect:DOMRect.fromRect(r.rect)}}({cell:e,type:n,theme:o}))).filter(l.$K)}function E(e,t){const n=_.Z.state;if(n.isActive&&n.simpleTableStore===e&&(!t||n.resize===t))return n}function B(e){const{environment:t,cellValue:n,spaceId:o,parentStore:i,theme:r}=e;return m.IY({environment:t,textValue:n?{value:n,spaceId:o}:void 0,parentStore:i,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!0,disableHover:!0,disabled:!0,theme:r,emojiType:(0,u.e_)(t),katex:t.KatexStore.getKatex(),formulaValueTypes:[]})}function F(e){const{simpleTableStore:t,environment:n,includeInline:o}=e;return f.Xp(t,{recursivelyLoadAllDiscussions:o,onlyIncludeBlockLevelDiscussions:(0,h.Sx)(n)})}function O(e){const{simpleTableStore:t,lastN:n}=e,o=t.getContentStores(),i=S(t);if(!o||!i)return!1;for(let r=o.length-1;r>Math.max(o.length-1-n,0);r--){const e=o[r].getProperties();if(e&&i.some((t=>t in e&&e[t])))return!0}return!1}function Z(e){const{simpleTableStore:t,lastN:n}=e,o=t.getContentStores(),i=S(t);if(!o||!i)return!1;const r=i.slice(-n);return o.some((e=>{const t=e.getProperties();return t&&r.some((e=>e in t&&t[e]))}))}const V={title:!0,text:!0,url:!0,email:!0,person:!0,number:!0,date:!0,phone_number:!0,select:!0,multi_select:!0,status:!0,auto_increment_id:!0,file:!1,checkbox:!1,relation:!1,rollup:!1,formula:!1,created_by:!1,created_time:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,button:!1,location:!1,verification:!1},U=200;async function L(e){const{environment:t,collectionViewBlockStore:n}=e,a=n.getCollectionViewSourceCollectionStore();if(!a)return[];const[l]=n.getCollectionViewStores(),d={source:{type:"collection",id:a.id,spaceId:(0,r.C)(a.pointer.spaceId)},collectionView:{id:l.id,spaceId:(0,r.C)(l.pointer.spaceId)},loader:{reducers:{results:{type:"results",limit:U+1,loadContentCover:!1}},searchQuery:void 0,userId:t.currentUser.id,userTimeZone:(0,o.r)()}},u=c.queryCollection(t,d,void 0,{src:"simple_tbl_transform"}),p=await(0,s.OI)(1e4,u);if(!p.timeout){const{result:e}=p;if("success"===e.type){const t=e.data.result.reducerResults.results;return(t&&"results"===t.type?t.blockIds:[]).map((e=>v.G.createChildStore(a,{id:e,table:i.iU})))}}return[]}function j(e){let t;if(0===e.getProps().rowIndex){const n=R({simpleTableStore:e.getProps().simpleTableStore,rowIndex:0,columnIndex:0});n&&(t=(0,g.mK)(n))}else t=R({simpleTableStore:e.getProps().simpleTableStore,rowIndex:e.getProps().rowIndex-1,columnIndex:e.getProps().columnIndex});return t}function N(e){let t;const n=k(e.getProps().simpleTableStore);if(e.getProps().rowIndex===n-1){const o=w(e.getProps().simpleTableStore),i=R({simpleTableStore:e.getProps().simpleTableStore,rowIndex:n-1,columnIndex:o-1});i&&(t=(0,g.hn)(i))}else t=R({simpleTableStore:e.getProps().simpleTableStore,rowIndex:e.getProps().rowIndex+1,columnIndex:e.getProps().columnIndex});return t}},44534:(e,t,n)=>{n.d(t,{HM:()=>i,Wv:()=>r.Z,fZ:()=>a.Z,g$:()=>o});var o=n(27534),i=n(98794),r=n(59175),a=n(38007)},84139:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{findCellsInRowFromStore(e,t,n){return this.filter((o=>{const i=o.getProps();return e?i.store===e:i.simpleTableStore===t&&i.rowIndex===n}))}findCellsInColumnFromStore(e,t){return this.filter((n=>{const o=n.getProps();return o.simpleTableStore===e&&("number"==typeof t&&o.columnIndex===t||"string"==typeof t&&o.columnID===t)}))}findCellFromTextStore(e){return this.find((t=>t.getTextStore()===e))}findCellFromElement(e,t){return this.find((n=>n.getProps().simpleTableStore===t&&n.getNode()===e))}}const r=new i},64359:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(53965);class r extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return i.d9(this.state)}}const a=new r},5676:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(53965);class r extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return i.d9(this.state)}}const a=new r},29574:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(53965);class r extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return i.d9(this.state)}}const a=new r},63208:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(53965);class r extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return i.d9(this.state)}}const a=new r},84693:(e,t,n)=>{n.d(t,{Y3:()=>Z,y6:()=>T,G$:()=>V,lR:()=>F,GF:()=>O,Q6:()=>B});n(21703),n(57658);var o=n(73360),i=n(606),r=n(21202),a=n(80873),s=n(35092),l=n(24681),c=n(53965),d=n(1898);const u={table:r.iU,recordColumnTypes:{id:a.Z.UUID,space_id:a.Z.UUID,version:a.Z.Number,last_version:a.Z.Number,type:a.Z.String,properties:a.Z.JSON,content:a.Z.StringArray,discussions:a.Z.StringArray,view_ids:a.Z.StringArray,collection_id:a.Z.UUID,permissions:a.Z.JSON,created_time:a.Z.Number,last_edited_time:a.Z.Number,copied_from:a.Z.UUID,file_ids:a.Z.StringArray,ignore_block_count:a.Z.Boolean,is_template:a.Z.Boolean,parent_id:a.Z.UUID,parent_table:a.Z.String,alive:a.Z.Boolean,moved:a.Z.JSON,format:a.Z.JSON,created_by:a.Z.UUID,last_edited_by:a.Z.UUID,created_by_table:a.Z.String,created_by_id:a.Z.UUID,last_edited_by_table:a.Z.String,last_edited_by_id:a.Z.UUID,content_classification:a.Z.String},metaColumnTypes:{meta_user_id:a.Z.UUID,meta_last_access_timestamp:a.Z.Number,meta_role:a.Z.String}};const p={table:n(6287).vF,recordColumnTypes:{id:a.Z.UUID,version:a.Z.Number,last_version:a.Z.Number,name:a.Z.JSON,description:a.Z.JSON,icon:a.Z.String,cover:a.Z.String,schema:a.Z.JSON,format:a.Z.JSON,parent_id:a.Z.UUID,parent_table:a.Z.String,alive:a.Z.Boolean,file_ids:a.Z.StringArray,template_pages:a.Z.StringArray,copied_from:a.Z.UUID,migrated:a.Z.Boolean,space_id:a.Z.UUID,deleted_schema:a.Z.JSON},metaColumnTypes:{meta_user_id:a.Z.UUID,meta_role:a.Z.String}};const m={table:n(13493).np,recordColumnTypes:{id:a.Z.UUID,version:a.Z.Number,last_version:a.Z.Number,type:a.Z.String,name:a.Z.String,page_sort:a.Z.UUIDArray,parent_id:a.Z.UUID,parent_table:a.Z.String,alive:a.Z.Boolean,format:a.Z.JSON,query2:a.Z.JSON,space_id:a.Z.UUID},metaColumnTypes:{meta_user_id:a.Z.UUID,meta_role:a.Z.String}};const f={table:n(70279).x_,recordColumnTypes:{id:a.Z.UUID,version:a.Z.Number,last_version:a.Z.Number,parent_id:a.Z.UUID,parent_table:a.Z.String,text:a.Z.JSON,created_time:a.Z.Number,last_edited_time:a.Z.Number,alive:a.Z.Boolean,created_by_table:a.Z.String,created_by_id:a.Z.UUID,space_id:a.Z.UUID,content:a.Z.UUIDArray,reactions:a.Z.UUIDArray},metaColumnTypes:{meta_user_id:a.Z.UUID,meta_role:a.Z.String}};const g={table:n(33709).qF,recordColumnTypes:{id:a.Z.UUID,type:a.Z.String,version:a.Z.Number,last_version:a.Z.Number,parent_id:a.Z.UUID,parent_table:a.Z.String,context:a.Z.JSON,resolved:a.Z.Boolean,comments:a.Z.StringArray,space_id:a.Z.UUID,reactions:a.Z.UUIDArray},metaColumnTypes:{meta_user_id:a.Z.UUID,meta_role:a.Z.String}};const h={table:n(65311).uX,recordColumnTypes:{id:a.Z.UUID,version:a.Z.Number,last_version:a.Z.Number,user_id:a.Z.UUID,activity_id:a.Z.UUID,received:a.Z.Boolean,read:a.Z.Boolean,visited:a.Z.Boolean,emailed:a.Z.Boolean,invalid:a.Z.Boolean,space_id:a.Z.UUID,navigable_block_id:a.Z.UUID,collection_id:a.Z.UUID,discussion_id:a.Z.UUID,type:a.Z.String,end_time:a.Z.String,channel:a.Z.String,archived_at:a.Z.Number},metaColumnTypes:{meta_user_id:a.Z.UUID,meta_role:a.Z.String}};const v={table:n(19889).KJ,recordColumnTypes:{id:a.Z.UUID,version:a.Z.Number,last_version:a.Z.Number,email:a.Z.String,given_name:a.Z.String,family_name:a.Z.String,profile_photo:a.Z.String,onboarding_completed:a.Z.Boolean,mobile_onboarding_completed:a.Z.Boolean,clipper_onboarding_completed:a.Z.Boolean,reverify:a.Z.Boolean,name:a.Z.String,is_banned:a.Z.Boolean,suspended_time:a.Z.Number},metaColumnTypes:{meta_user_id:a.Z.UUID,meta_role:a.Z.String}};const b={table:n(80396).yo,recordColumnTypes:{id:a.Z.UUID,space_id:a.Z.UUID,version:a.Z.Number,last_version:a.Z.Number,created_time:a.Z.Number,parent_id:a.Z.UUID,parent_table:a.Z.String,icon:a.Z.String,actors:a.Z.JSON},metaColumnTypes:{meta_user_id:a.Z.UUID,meta_role:a.Z.String}};const y={table:n(75246).bx,recordColumnTypes:{id:a.Z.UUID,version:a.Z.Number,last_version:a.Z.Number,name:a.Z.String,permissions:a.Z.JSON,permission_groups:a.Z.JSON,email_domains:a.Z.StringArray,pages:a.Z.StringArray,icon:a.Z.String,disable_public_access:a.Z.Boolean,disable_public_access_requests:a.Z.Boolean,disable_guests:a.Z.Boolean,disable_move_to_space:a.Z.Boolean,disable_export:a.Z.Boolean,disable_space_page_edits:a.Z.Boolean,beta_enabled:a.Z.Boolean,created_time:a.Z.Number,last_edited_time:a.Z.Number,deleted_by:a.Z.UUID,created_by_table:a.Z.String,created_by_id:a.Z.UUID,last_edited_by_table:a.Z.String,last_edited_by_id:a.Z.UUID,admin_disable_public_access:a.Z.Boolean,space_pages:a.Z.UUIDArray,plan_type:a.Z.String,invite_link_enabled:a.Z.Boolean,initial_use_cases:a.Z.String,public_home_page:a.Z.String,bot_settings:a.Z.JSON,settings:a.Z.JSON,subscription_tier:a.Z.String,disable_team_creation:a.Z.Boolean,overdue_subscription:a.Z.JSON,short_id:a.Z.Number},metaColumnTypes:{meta_user_id:a.Z.UUID,meta_role:a.Z.String}};const _={table:n(77858).zU,recordColumnTypes:{id:a.Z.UUID,version:a.Z.Number,last_version:a.Z.Number,space_id:a.Z.UUID,bookmarked_pages:a.Z.StringArray,shared_pages:a.Z.StringArray,visited_templates:a.Z.StringArray,sidebar_hidden_templates:a.Z.StringArray,notify_mobile:a.Z.Boolean,notify_desktop:a.Z.Boolean,notify_email:a.Z.Boolean,notify_email_always:a.Z.Boolean,created_getting_started:a.Z.Boolean,parent_id:a.Z.UUID,parent_table:a.Z.String,alive:a.Z.Boolean,created_onboarding_templates:a.Z.Boolean,private_pages:a.Z.UUIDArray,joined:a.Z.Boolean,joined_teams:a.Z.UUIDArray,settings:a.Z.JSON,ai_suggestions:a.Z.JSON,sidebar_order:a.Z.StringArray},metaColumnTypes:{meta_user_id:a.Z.UUID,meta_role:a.Z.String}};const S={table:n(29369).e0,recordColumnTypes:{id:a.Z.UUID,version:a.Z.Number,last_version:a.Z.Number,space_id:a.Z.UUID,name:a.Z.String,description:a.Z.String,icon:a.Z.String,created_time:a.Z.Number,created_by_table:a.Z.String,created_by_id:a.Z.UUID,last_edited_time:a.Z.Number,last_edited_by_table:a.Z.String,last_edited_by_id:a.Z.UUID,archived_by:a.Z.UUID,archived_at:a.Z.Number,team_pages:a.Z.UUIDArray,pinned_pages:a.Z.UUIDArray,parent_id:a.Z.UUID,parent_table:a.Z.String,settings:a.Z.JSON,is_default:a.Z.Boolean,membership:a.Z.JSON,permissions:a.Z.JSON},metaColumnTypes:{meta_user_id:a.Z.UUID,meta_role:a.Z.String}};const w={table:n(66079).dx,recordColumnTypes:{id:a.Z.UUID,version:a.Z.Number,last_version:a.Z.Number,space_views:a.Z.StringArray,space_view_pointers:a.Z.JSON,left_spaces:a.Z.StringArray,deleted_email:a.Z.String},metaColumnTypes:{meta_user_id:a.Z.UUID,meta_role:a.Z.String}};const k={table:n(28182).Sr,recordColumnTypes:{id:a.Z.UUID,version:a.Z.Number,last_version:a.Z.Number,settings:a.Z.JSON},metaColumnTypes:{meta_user_id:a.Z.UUID,meta_role:a.Z.String}},I=[u,y,_,w,v,m,p,S,k,h,f,g,b],C=new Set(I.map((e=>e.table))),x=Object.keys({record_table:!0,record_id:!0,record_value:!0,space_id:!0,timestamp:!0,parent_table:!0,parent_id:!0,importance:!0,user_id:!0});async function T(e,t){await(0,s.G$)({connection:e,statements:[{sql:"\n\t\t\t\tUPDATE records SET user_id = ? WHERE user_id is null\n\t\t\t\t",args:[t]}],queryName:"backfillRecordsWithUserId"})}function M(e){const t=c.vM(e.records,(e=>e.pointer.table)),n=[];return Object.entries(t).forEach((t=>{let[o,i]=t;const r=I.find((e=>e.table===o));if(!r)return;const a=(0,d.Yd)(r.recordColumnTypes),l=(0,d.Yd)(r.metaColumnTypes),u=[...a,...l];c.yo(i,Math.floor(s.mz/u.length)).forEach((t=>{const i=`(${u.join(",")})`,r=Array(t.length).fill(`(${"?, ".repeat(u.length-1)}?)`).join(",");let s;s=e.maybeStaleRecords&&u.includes("version")?`INSERT INTO ${o} ${i} VALUES ${r}`.concat("ON CONFLICT (id, meta_user_id) DO UPDATE SET").concat("\n").concat(u.map((e=>`${e} = excluded.${e}`)).join(",")).concat("\n").concat(`WHERE excluded.version > ${o}.version`):`INSERT OR REPLACE INTO ${o} ${i} VALUES ${r}`;const p=c.xH(t.map((e=>{let{value:t,timestamp:n,userId:o}=e;if(!t)return[];const i=t.value;if(!i)return[];const r=a.map((e=>function(e){if(null==e)return null;if("string"==typeof e||"number"==typeof e)return e;if("boolean"==typeof e)return e?1:0;return JSON.stringify(e)}((0,d.qg)(i,e)?i[e]:void 0))),s=l.map((e=>{switch(e){case"meta_user_id":return o;case"meta_role":return t.role;case"meta_last_access_timestamp":return n;default:throw new Error(`Unknown meta column ${e}`)}}));return r.concat(s)})));n.push({sql:s,args:p})}))})),n}function P(e){const[t,n]=c.uK(e.records,(e=>U(e))),i=M({records:t,maybeStaleRecords:e.maybeStaleRecords}),r=function(e){const{records:t,maybeStaleRecords:n}=e;return c.yo(t,Math.floor(s.mz/x.length)).map((e=>{let t=`\n\t\t\tINSERT INTO records\n\t\t\t(\n\t\t\t\trecord_table,\n\t\t\t\trecord_id,\n\t\t\t\trecord_value,\n\t\t\t\ttimestamp,\n\t\t\t\tparent_table,\n\t\t\t\tparent_id,\n\t\t\t\timportance,\n\t\t\t\tuser_id,\n\t\t\t\tspace_id\n\t\t\t)\n\t\t\tVALUES ${Array(e.length).fill("(?, ?, ?, ?, ?, ?, ?, ?, ?)").join(",")}`;return t=n?t.concat("\n\t\t\t\tON CONFLICT (record_table, record_id, user_id) DO UPDATE SET\n\t\t\t\t\trecord_value =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.record_value\n\t\t\t\t\t\tELSE records.record_value\n\t\t\t\t\t\tEND,\n\t\t\t\t\ttimestamp =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.timestamp\n\t\t\t\t\t\tELSE records.timestamp\n\t\t\t\t\t\tEND,\n\t\t\t\t\tparent_table =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.parent_table\n\t\t\t\t\t\tELSE records.parent_table\n\t\t\t\t\t\tEND,\n\t\t\t\t\tparent_id =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.parent_id\n\t\t\t\t\t\tELSE records.parent_id\n\t\t\t\t\t\tEND,\n\t\t\t\t\timportance =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.importance\n\t\t\t\t\t\tELSE records.importance\n\t\t\t\t\t\tEND,\n\t\t\t\t\tuser_id =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.user_id\n\t\t\t\t\t\tELSE excluded.user_id\n\t\t\t\t\t\tEND,\n\t\t\t\t\t-- space_id never changes.\n\t\t\t\t\tspace_id = COALESCE(records.space_id, excluded.space_id)"):t.concat("\n\t\t\t\tON CONFLICT (record_table, record_id, user_id) DO UPDATE SET\n\t\t\t\t\trecord_value = excluded.record_value,\n\t\t\t\t\ttimestamp = excluded.timestamp,\n\t\t\t\t\tparent_table = excluded.parent_table,\n\t\t\t\t\tparent_id = excluded.parent_id,\n\t\t\t\t\timportance = excluded.importance,\n\t\t\t\t\tuser_id = excluded.user_id,\n\t\t\t\t\t-- space_id never changes.\n\t\t\t\t\tspace_id = COALESCE(records.space_id, excluded.space_id)"),{sql:t,args:c.xH(e.map((e=>{let{pointer:t,value:n,timestamp:i,importance:r,userId:a}=e,l=null,c=null;return n&&n.value&&(0,o.oK)(n.value)&&(l=n.value.parent_id,c=n.value.parent_table),[t.table,t.id,(0,s.gI)(n),i,c,l,"number"==typeof r?r:null,a,t.spaceId||null]})))}}))}({records:n,maybeStaleRecords:e.maybeStaleRecords});return[...A(t),...R(n.filter((e=>C.has(e.pointer.table)))),...i,...r]}function A(e){return c.yo(e,Math.floor(s.mz/(2*e.length))).map((e=>{const t=l.v.or(e.map((e=>l.v`(records.record_id = ${e.pointer.id} AND records.user_id = ${e.userId})`)));return l.v`DELETE FROM records WHERE ${t}`.asWrite()}))}function R(e){const t=c.vM(e,(e=>e.pointer.table)),n=[];return Object.entries(t).forEach((e=>{let[t,o]=e;c.yo(o,Math.floor(s.mz/(2*o.length))).forEach((e=>{const o=l.v.or(e.map((e=>l.v`(id = ${e.pointer.id} AND meta_user_id = ${e.userId})`)));n.push(l.v`DELETE FROM ${l.v.ident(t)} WHERE ${o}`.asWrite())}))})),n}async function D(e,t){if(0===t.length)return[];const n=c.vM(t,(e=>e.pointer.table)),o=[];Object.entries(n).forEach((t=>{let[n,r]=t;const a=I.find((e=>e.table===n));if(!a)return;const l=Array(r.length).fill("(id = ? AND meta_user_id = ?)").join(" OR "),d=c.VS(r,(e=>{let{pointer:{table:t,id:n},userId:o}=e;return[n,o]}));o.push(async function(){const[t]=await(0,s.G$)({connection:e,statements:[{sql:`\n\t\t\t\tSELECT * FROM ${n}\n\t\t\t\tWHERE ${l}`,args:d,getData:!0}],queryName:"getRecordsFromSeparateTables"});return t.data.map((e=>function(e,t,n){return{pointer:i.dr.fromPointerLike({table:e,id:t.id,spaceId:t.space_id||void 0}),value:{role:t.meta_role,value:E(t,n)},timestamp:t.meta_last_access_timestamp,importance:0,userId:t.meta_user_id}}(n,e,a)))}())}));const r=await Promise.all(o);return c.xH(r)}function E(e,t){const n={};return(0,d.Yd)(t.recordColumnTypes).forEach((o=>{const i=t.recordColumnTypes[o];if(null!==e[o])switch(i){case a.Z.UUID:case a.Z.String:case a.Z.Number:n[o]=e[o];break;case a.Z.StringArray:case a.Z.JSON:n[o]=JSON.parse(e[o]);break;case a.Z.XML:n[o]=e[o];break;case a.Z.UUIDArray:n[o]=JSON.parse(e[o]);break;case a.Z.Boolean:n[o]=1===e[o];break;case a.Z.CIDR:n[o]=e[o];break;case a.Z.NumberArray:n[o]=JSON.parse(e[o]);break;default:(0,d.t1)(i)}})),n}async function B(e,t){const[n,o]=c.uK(t,(e=>C.has(e.pointer.table))),r=await D(e,n),a=new Set(r.map((e=>i.P2.toKey({pointer:e.pointer,userId:e.userId})))),l=n.filter((e=>!a.has(i.P2.toKey(e)))),d=await async function(e,t){if(0===t.length)return[];const n=Array(t.length).fill("(record_table = ? AND record_id = ? AND user_id = ?)").join(" OR "),o=c.VS(t,(e=>{let{pointer:{table:t,id:n},userId:o}=e;return[t,n,o]})),[r]=await(0,s.G$)({connection:e,statements:[{sql:`\n\t\t\t\tSELECT * FROM records\n\t\t\t\tWHERE ${n}`,args:o,getData:!0}],queryName:"getRecordsFromRecordsTable"});return r.data.map((e=>({pointer:i.dr.fromPointerLike({table:e.record_table,id:e.record_id,spaceId:e.space_id||void 0}),value:JSON.parse(e.record_value),timestamp:e.timestamp,importance:"number"==typeof e.importance?e.importance:void 0,userId:e.user_id})))}(e,o.concat(l)),u=d.filter((e=>!U(e)));return r.concat(u)}async function F(e,t){const n=l.v`
  SELECT * FROM block
  WHERE parent_table = ${t.parent.table}
  AND parent_id = ${t.parent.id}
  AND meta_user_id = ${t.userId}
  `.asRead(),o=l.v`
  UPDATE block
  SET meta_last_access_timestamp = ${t.timestamp}
  WHERE parent_table = ${t.parent.table}
  AND parent_id = ${t.parent.id}
  AND meta_user_id = ${t.userId}
  `.asWrite(),[a]=await(0,s.G$)({connection:e,statements:[n,o],queryName:"getBlocksWithParent"});return a.data.map((e=>({pointer:i.dr.fromPointerLike({table:r.iU,id:e.id,spaceId:e.space_id||void 0}),value:{role:e.meta_role,value:E(e,u)},userId:t.userId})))}async function O(e,t){const n=l.v`
    WITH RECURSIVE page_blocks AS (
      SELECT * FROM block
      WHERE id = ${t.page.id}
      AND meta_user_id = ${t.userId}

      UNION

      SELECT block.*
      FROM
        block INDEXED BY block_parent_id,
        page_blocks
      WHERE
      (
        page_blocks.id = ${t.page.id}
        OR page_blocks.type NOT IN ('page', 'toggle')
      )
      AND block.parent_table = 'block'
      AND block.parent_id = page_blocks.id
      AND block.meta_user_id = ${t.userId}
    )
    SELECT * FROM page_blocks
    `,o=await n.all(e,"getPageBlocksByParent");return 0===o.length?[]:o.map((e=>({pointer:i.dr.fromPointerLike({table:r.iU,id:e.id,spaceId:e.space_id||void 0}),value:{role:e.meta_role,value:E(e,u)},userId:t.userId})))}async function Z(e,t,n){const o=n.filter((e=>"set"===e.type&&!e.maybeStaleRecord)),i=n.filter((e=>"set"===e.type&&e.maybeStaleRecord)),a=n.filter((e=>{let{type:t}=e;return"access"===t})),c=n.filter((e=>{let{type:t}=e;return"delete"===t})),d=[];if(a.forEach((e=>{const t=e.record.pointer.table;U(e.record)?t===r.iU&&d.push(l.v`
	        UPDATE block
	        SET meta_last_access_timestamp = ${e.record.timestamp}
	        WHERE id = ${e.record.pointer.id}
	        AND meta_user_id = ${e.record.userId}
	        `.asWrite()):d.push({sql:"UPDATE records\n          SET timestamp = ?\n          WHERE record_table = ?\n          AND record_id = ?\n          AND user_id = ?",args:[e.record.timestamp,t,e.record.pointer.id,e.record.userId]})})),o.length>0||i.length>0){if(o.length>0){const e=o.map((e=>e.record));d.push(...P({records:e,maybeStaleRecords:!1}))}if(i.length>0){const e=i.map((e=>e.record));d.push(...P({records:e,maybeStaleRecords:!0}))}d.push(l.v`
			DELETE FROM records
			WHERE rowid IN (
				SELECT rowid FROM records
				ORDER BY importance DESC, timestamp DESC
				LIMIT -1
				OFFSET ${t}
			)
			`.asWrite()),d.push(l.v`
			DELETE FROM block
			WHERE rowid in (
				SELECT rowid FROM block
				ORDER BY meta_last_access_timestamp DESC
				LIMIT -1
				OFFSET ${t}
			)
			`.asWrite())}if(c.length>0){const e=c.map((e=>e.record));d.push(...function(e){const t=R(e.filter((e=>C.has(e.pointer.table)))),n=A(e);return t.concat(n)}(e))}0!==d.length&&await(0,s.G$)({connection:e,statements:d,queryName:"applyRecordCacheOperations"})}async function V(e){await async function(e){const t=[];C.forEach((e=>{t.push(l.v`DELETE FROM ${l.v.ident(e)}`.asWrite())})),await(0,s.G$)({connection:e,statements:t,queryName:"deleteAllCachedRecordsFromSeparateTables"})}(e),await async function(e){await(0,s.sf)({connection:e,sql:"DELETE FROM records",queryName:"deleteAllCachedRecordsFromRecordsTable"})}(e)}function U(e){return C.has(e.pointer.table)&&void 0!==e.value&&void 0!==e.value.value}},4023:(e,t,n)=>{n.d(t,{u:()=>o,v:()=>i});let o=function(e){return e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Center=4]="Center",e}({}),i=function(e){return e[e.Start=0]="Start",e[e.Center=1]="Center",e[e.End=2]="End",e}({})},70726:(e,t,n)=>{n.d(t,{Z:()=>i});var o=function(e){return e[e.Preview=0]="Preview",e[e.Mention=1]="Mention",e[e.Link=2]="Link",e}(o||{});const i=o},34859:(e,t,n)=>{n.d(t,{Z:()=>i});var o=function(e){return e[e.All=0]="All",e[e.X=1]="X",e[e.Y=2]="Y",e[e.None=3]="None",e}(o||{});const i=o},83960:(e,t,n)=>{n.d(t,{T:()=>o,l:()=>i});const o={localLanguagePreferenceKey:"CodeBlockDefaultLanguage",localCodeWrapPreferenceKey:"CodeBlockDefaultCodeWrap",defaultLanguage:"JavaScript",defaultCodePreviewFormat:"code"},i={localSizePreferenceKey:"QuoteBlockDefaultSize"}},96198:(e,t,n)=>{n.d(t,{O:()=>o});const o=44},15723:(e,t,n)=>{n.d(t,{Ep:()=>a,Kr:()=>u,MU:()=>f,TF:()=>l,bM:()=>r,dQ:()=>p,iL:()=>i,jn:()=>m,kK:()=>d,kL:()=>c,uh:()=>s});var o=n(53965);class i{static from(e){return new i(e.left,e.top,e.width,e.height)}constructor(e,t,n,o){this.x=e,this.y=t,this.width=n,this.height=o,this.top=this.height<0?this.y+this.height:this.y,this.bottom=this.height<0?this.y:this.y+this.height,this.left=this.width<0?this.x+this.width:this.x,this.right=this.width<0?this.x:this.x+this.width}toJSON(){return{...this}}}const r=new i(0,0,0,0);function a(e){return Boolean(e&&(o.hj(e.top)||o.hj(e.left)))}function s(e,t,n){return e.left<=t&&t<=e.right&&e.top<=n&&n<=e.bottom}function l(e,t){return e.left<=t.left&&e.right>=t.right}function c(e,t){return e.top<=t.top&&e.bottom>=t.bottom}function d(e,t){return!(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)}function u(e,t){return!(e.right<=t.left||t.right<=e.left)}function p(e,t){return!(e.bottom<=t.top||t.bottom<=e.top)}function m(e,t){return new i(e.left-t,e.top-t,e.width+2*t,e.height+2*t)}function f(e){const t=e.top+e.height/2,n=e.left+e.width/2;return new i(n,t,0,0)}},12252:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(53965);class r extends o.default{constructor(){super(...arguments),this.pause=()=>{this.setState({active:!1,onActive:[]})},this.resume=()=>{this.state.onActive.map((e=>e())),this.setState({active:!0,onActive:[]})}}getInitialState(){return{active:!0,onActive:[]}}whenActive(e){this.state.active?e():this.setState({...this.state,onActive:i.jj([...this.state.onActive,e])})}}const a=new r},41747:(e,t,n)=>{n.d(t,{G:()=>a,Z:()=>c});var o=n(49085),i=n(92595),r=n(7032);const a={by_topic:{label:"by Topic",topicType:"contextSuggestions"}};class s extends o.default{getInitialState(){return{subTab:"by_topic",loadingState:{type:"loaded",pageId:void 0},topics:[],initialSuggestions:[]}}getSubTab(){return this.state.subTab}setSubTab(e){this.update((t=>({...t,subTab:e})))}createTopicCard(e){this.update((t=>({...t,topics:[...t.topics,{clientId:(0,r.ZP)(),title:e,loadingState:"initial",isExpanded:!0}]})))}setGroupIsExpanded(e,t){this.update((n=>({...n,initialSuggestions:n.initialSuggestions.map((n=>n.clientId===e?{...n,isExpanded:t}:n))})))}getTopicByClientId(e){return this.state.topics.find((t=>t.clientId===e))}setTopicIsExpanded(e,t){this.update((n=>({...n,topics:n.topics.map((n=>n.clientId===e?{...n,isExpanded:t}:n))})))}setTopicLoading(e,t){this.update((n=>({...n,topics:n.topics.map((n=>n.clientId===e?{...n,loadingState:t,clientId:e}:n))})))}setTopic(e,t){this.update((n=>({...n,topics:n.topics.map((n=>n.clientId===e?{...t,clientId:e}:n))})))}}const l=new s,c=l;(0,i.exposeDebugValue)("AiContextStore",l)},80736:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{loaded:!1,loading:!1}}}const r=new i},85305:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},58455:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});var o=n(49085),i=n(7032),r=n(95477);class a extends o.default{constructor(){super(...arguments),this.verboseAnalytics=r.default.isAdminMode||false}getInitialState(){return{isLoaded:!1,isLoggingEnabled:!1,isAmplitudeEnabled:!1,isSegmentEnabled:!1,isZendeskEnabled:!1,isIntercomEnabled:!1,intercomAppId:void 0,intercomUserHash:void 0,noIntercomUserId:!1,isSprigEnabled:!1,zendeskToken:void 0}}shouldRefresh(e){return!this.state.isLoaded||Boolean(e)!==Boolean(this.state.user_id)||Boolean(e&&this.state.user_id&&(0,i.cj)(this.state.user_id)!==(0,i.cj)(e))}}const s=new a},51:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state.publicPageData)))}}const r=new i},80148:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{}const r=new i},92425:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}getSharedPagesState(e){const{userId:t,spaceId:n}=e;let o=this.state[t];o||(o={},this.state[t]=o);return o[n]}setSharedPagesState(e){const{userId:t,spaceId:n,state:o}=e;let i=this.state[t];i||(i={},this.state[t]=i),i[n]=o,this.emit()}}const r=new i},30021:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(53809),i=n(30548);const r=new o.D({key:"appearanceSettingStorageKey",namespace:i.$p,important:!0,trackingType:"necessary"})},21273:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(49085),i=n(38823),r=n(76870),a=(n(95477),n(77080));class s extends o.default{getInitialState(){return new i.m9({getEligibleGroup:()=>"control",isAiEnabled:()=>!1,getIsWorkspaceVectorEmbeddingsComplete:()=>!1,getCanWorkspaceUseVectorEmbeddingsCollectionIdFilter:()=>!1,checkGate:()=>!1})}isAiEnabled(){return this.state.isAiEnabled()}isContextEnabled(){return this.state.isContextEnabled()}isMobileWebExperienceEnabled(){return this.modeIsAtMost("beta")}isAssistantExperienceQna(){return this.state.isAssistantExperienceQna()}isQnaRightSideDeeplinkEnabled(){return this.isMode("beta")||this.isMode("alpha")||this.isMode("development")}isEphemeralViewDatabaseQueryingEnabled(){return this.modeIsAtMost("development")}isQnATooltipsVisible(e,t){if(!t||!t.isReady())return!1;if(e.isMobile)return!1;const n=t.getSettings();return!!n&&"tooltip"===n.ai_qna_intro_onboarding_phase}shouldDisableForMobileBrowser(e){return e.isMobileBrowser&&!this.isMobileWebExperienceEnabled()}shouldShowSearchMenuItemAskAI(e){return this.modeIsAtMost("beta")&&!this.shouldDisableForMobileBrowser(e)}shouldShowAssistantInCorner(e){return!(e.isMobileNative&&e.isPhone)&&(this.modeIsAtMost("beta")&&!this.shouldDisableForMobileBrowser(e))}isShowingAssistantInsteadOfHelpCenterInBottomRight(){return this.modeIsAtMost("beta")}isShowingQNAOnMobile(){return this.modeIsAtMost("beta")}showAiQnaOnboardingModalForBetaLaunch(){return this.modeIsAtMost("beta")}showSearchAiFeatures(){return this.modeIsAtMost("beta")}showRemindersToUseQnA(){return this.state.showRemindersToUseQnA()}showScopedSearch(){return this.modeIsAtMost("alpha")}canScopeToPublicWorkspace(){return this.showScopedSearch()&&this.modeIsAtMost("exploratory")}canScopeToDatabases(){return this.showScopedSearch()&&this.state.canUseDatabaseScopedSearch()}canSeeWaitlistModal(){return!!this.isAiEnabled()&&(!(this.state.isWorkspaceVectorEmbeddingsComplete()&&!this.state.isQnAExplicitlyDisabled())&&!this.state.isQnAExplicitlyDisabled())}shouldShowAssistantUpsellInCorner(e){return!(e.isMobileNative&&e.isPhone)&&(!!this.isAiEnabled()&&(!this.state.isQnAExplicitlyDisabled()&&(this.isMode("control")&&!this.shouldDisableForMobileBrowser(e))))}showAtMentionMenu(){return this.modeIsAtMost("development")}showCustomSkills(){return this.modeIsAtMost("exploratory")}shouldShowSuggestedQuestions(){return this.modeIsAtMost("beta")}shouldShowGroupedEdits(){return this.modeIsAtMost("development")}shouldEnablePageTitleDiffs(){return this.modeIsAtMost("development")}isSuggestedQuestionsExperimentOn(){return!1}isQnaPageSuggestedQuestionRemindersEnabledForUser(){return"on"===a.default.getEligibleGroup({experimentId:"qna_show_page_suggested_questions",defaultGroup:"unassigned"})}isQnaAbandonedSearchReminderEnabledForUser(){const e=a.default.getConfigKey("qna_ai_reminders","abandonedSearchReminderProbability");return(0,r.aw)(e)&&"on"===a.default.getEligibleGroup({experimentId:"qna_abandoned_search_reminders",defaultGroup:"unassigned"})}isInPageFindQnaOptionEnabledForUser(){return this.modeIsAtMost("development")}shouldAttributeChangesToAI(){return this.modeIsAtMost("wild_west")}isXMLAssistantEnabled(){return this.state.isXMLAssistantEnabled()}shouldLoadPagesFromHumanInput(){return this.modeIsAtMost("exploratory")}canUseSkills(){return this.isXMLAssistantEnabled()&&this.modeIsAtMost("exploratory")}isFullPageAssistantChatEnabled(e){return this.modeIsAtMost("development")&&!e.isMobile}isFullPageAssistantInStartOptions(){return this.isMode("development")||this.isMode("exploratory")}isJSAssistantEnabled(){return!1}isSlackQnaEnabled(){return!1}isAssistantInWriterEnabled(e){return!1}isChatHistoryEnabled(){return this.state.isChatHistoryEnabled()}isBlockCitationsEnabled(){return this.state.isBlockCitationsEnabled()}isAiContextSuggestionsEnabled(){return this.modeIsAtMost("development")}showDevSuggestionFeedbackButton(){return this.isMode("development")||this.isMode("exploratory")}showSuggestionDebugger(){return this.isMode("exploratory")}isQnaShowLargeRemindersEnabledForUser(){return this.state.isQnaShowLargeRemindersEnabledForUser()}isQnaShowAssistantOriginInputEnabledForUser(){return this.state.isQnaShowAssistantOriginInputEnabledForUser()}shouldTrackInferenceAnalytics(){return this.isAssistantExperienceQna()||this.isXMLAssistantEnabled()}getMode(){return this.state.getMode()}isMode(e){return this.state.isMode(e)}modeIsAtMost(e){return this.state.modeIsAtMost(e)}}const l=new s},62740:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(49085),i=n(92595),r=n(42092);class a extends o.default{getInitialState(){return{edits:[],hoveredEditId:void 0}}getHoveredEdit(){if(this.state.hoveredEditId)return r.Z.getEditById(this.state.hoveredEditId)}}const s=new a,l=s;(0,i.exposeDebugValue)("AssistantHoverStore",s)},98180:(e,t,n)=>{n.d(t,{Z:()=>c});n(21703);var o=n(49085),i=n(41154),r=n(92595);const a=10*n(19584).hM;class s extends o.default{constructor(){super(...arguments),this.nextSessionId=void 0}getInitialState(){return{activeAiSessionId:void 0,sessions:{},lastSessionInitializedUnixEpochTime:Date.now()}}clearAllSessions(){this.reset()}getActiveSessionId(){return this.state.activeAiSessionId}getNextSessionId(){return this.nextSessionId||(this.nextSessionId=(0,i.Oy)()),this.nextSessionId}getNextSessionIdAndIncrement(){const e=this.getNextSessionId();return this.nextSessionId=(0,i.Oy)(),e}getActiveSession(){const e=this.state.activeAiSessionId;if(e)return this.state.sessions[e]}getActiveAssistantConfigurationStore(){var e;return null===(e=this.getActiveSession())||void 0===e?void 0:e.assistantConfigurationStore}getActiveAssistantConfigurationState(){var e;return null===(e=this.getActiveAssistantConfigurationStore())||void 0===e?void 0:e.state}getSessionContext(e){return this.state.sessions[e]}getSessionContextOrThrow(e){const t=this.getSessionContext(e);if(!t)throw new Error("No assistant context for given session");return t}setActiveSessionId(e){this.update((t=>({...t,activeAiSessionId:e})))}setNewActiveSession(e){const{sessionId:t,context:n}=e;this.update((e=>({...e,activeAiSessionId:t,sessions:{...e.sessions,[t]:n},lastSessionInitializedUnixEpochTime:Date.now()})))}addNewSession(e){const{sessionId:t,context:n}=e;this.update((e=>({...e,sessions:{...e.sessions,[t]:n}})))}endCurrentSession(){this.update((e=>({...e,activeAiSessionId:void 0})))}setLastSessionInitializedUnixEpochTime(){this.update((e=>({...e,lastSessionInitializedUnixEpochTime:Date.now()})))}wasActiveSessionLastOpenedOutsideOfHistorySavedWindow(){const e=this.state.lastSessionInitializedUnixEpochTime;return!e||Date.now()-e>=a}}const l=new s,c=l;(0,r.exposeDebugValue)("AssistantRegistryStore",l),(0,r.exposeDebugValue)("getTranscript",(()=>{var e;const t=(null===(e=l.getActiveSession())||void 0===e?void 0:e.evaluator.getTranscript())??[];return JSON.stringify(t)}))},8297:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{banners:[]}}}const r=i},24229:(e,t,n)=>{n.d(t,{Z:()=>d,u:()=>s});var o=n(49085),i=n(92595),r=n(49427),a=n(15723);let s=function(e){return e[e.Open=0]="Open",e[e.Resolved=1]="Resolved",e[e.NewThread=2]="NewThread",e}({});class l extends o.default{getInitialState(){return{open:!1,rect:a.bM,recursivelyLoadAllDiscussions:!1}}getFramePageFirstSelectedDiscussionId(){var e;return this.state.open&&r.Z.isBlockInFrame(this.state.blockStore)?null===(e=this.state.discussionIds)||void 0===e?void 0:e[0]:void 0}}const c=new l;(0,i.exposeDebugValue)("BlockDiscussionMenuStore",c);const d=c},8949:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isActive:!1}}}const r=new i},61207:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},58484:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isOpen:!1}}}const r=i},68859:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{dragging:!1}}}const r=i},61766:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=i},17746:(e,t,n)=>{n.d(t,{Z:()=>s,t:()=>r});var o=n(49085),i=n(15157);let r=function(e){return e[e.Left=0]="Left",e[e.Right=1]="Right",e}({});class a extends o.default{getInitialState(){return{dayStoreMap:new Map,isDragging:!1,startingMonth:0}}static getLocalViewPreferenceKey(e){return`CalendarView:${e}`}static getLocalPreferences(e){let{collectionViewId:t,currentUserId:n}=e;return i.Z.get({userId:n,key:a.getLocalViewPreferenceKey(t)})}static getLocalDateRangeStart(e){let{collectionViewId:t,currentUserId:n}=e;const o=this.getLocalPreferences({collectionViewId:t,currentUserId:n});return o&&o.dateRangeStart?o.dateRangeStart:Date.now()}static setLocalDateRangeStart(e){let{collectionViewId:t,dateRangeStart:n,currentUserId:o}=e;const r=this.getLocalPreferences({collectionViewId:t,currentUserId:o})||{},s=a.getLocalViewPreferenceKey(t),l={...r,dateRangeStart:n};i.Z.set({userId:o,key:s,value:l})}static clearLocalDateRangeStart(e){let{collectionViewId:t,currentUserId:n}=e;const o=a.getLocalViewPreferenceKey(t);i.Z.remove({userId:n,key:o})}}const s=a},4926:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n(49085).default.createValue(0)},87143:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{active:!1,stringValue:""}}}const r=new i},77556:(e,t,n)=>{n.d(t,{Z:()=>z});n(57658);var o=n(14577),i=n(49085),r=n(92996),a=n(41432),s=n(76205),l=n(14714),c=n(99036),d=n(43690),u=n(10070),p=n(28155),m=n(33147),f=n(6695),g=n(96367),h=n(21202),v=n(6287),b=n(31701),y=n(53965),_=n(7032),S=n(1898),w=n(23924),k=n(4430),I=n(75330),C=n(10906),x=n(97978),T=n(28020),M=n(97004),P=n(75079),A=n(92918),R=n(26991),D=n(77181),E=n(33929),B=n(98165);class F{constructor(e){this.supportsLongTask=void 0,this.entriesObserved=void 0,this.observer=void 0,this.observing=!1,this.supportsLongTask=PerformanceObserver.supportedEntryTypes.includes("longtask"),this.entriesObserved=[],this.observer=new PerformanceObserver((t=>{this.entriesObserved.push(...t.getEntries()),e&&e(t,this.observer)}))}observe(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.supportsLongTask&&(this.observer.observe({type:"longtask",buffered:e}),this.observing=!0)}get isObserving(){return this.observing}disconnect(){this.observer.disconnect(),this.observing=!1}takeRecords(){const e=this.entriesObserved;return this.entriesObserved=[],e}}var O=n(94841),Z=n(77080),V=n(6258);class U extends i.default{constructor(e){super(),this.collectionContextStore=e}getInitialState(){return new Map}getGroupState(e){const t=Array.isArray(e)?e:void 0!==e?[e]:[],n=(0,l.KW)(t),r=this.state.get(n);if(r)return r;const a=function(e,t){const n=i.default.createValue(void 0),r=e.collectionViewBlockStore();if(!r)return;let a;Z.default.checkGate("collection_group_ui_parent")?a=r:t.length>0?(a=r.clone(),a.setRecordStoreUIParent(r)):a=r;const s=C.bd(e),l=new o.Z((()=>{const e=n.state;return(e&&"results"===e.type?e.blockIds:[]).map((e=>V.G.createChildStore(a,{id:e,table:h.iU})))}),{debugName:"resultsStore"});return{groupsPointer:t,groupUiParentStore:a,reducerResultStore:n,resultsStore:l,currentLimit:i.default.createValue(s),toggleStateStore:i.default.createValue(!1)}}(this.collectionContextStore,t);return a?(this.state.set(n,a),this.emit(),a):void 0}getAllGroupStates(){return[...this.state.values()]}anyGroupHasResults(){for(const e of this.state.values())if(e.reducerResultStore.state)return!0;return!1}anyGroupHasNonEmptyResults(){for(const t of this.state.values()){var e;if(null!==(e=t.reducerResultStore.state)&&void 0!==e&&null!==(e=e.blockIds)&&void 0!==e&&e.length)return!0}return!1}anySpecifiedGroupHasResults(e){for(const t of e){const e=this.getGroupState(t);if(null!=e&&e.reducerResultStore.state)return!0}return!1}resetAllLimits(){const e=C.bd(this.collectionContextStore);for(const t of this.state.values())t.currentLimit.setState(e)}setLimitIfGreater(e,t){const n=this.getGroupState(e),o=null==n?void 0:n.currentLimit;o&&t>o.state&&o.setState(t)}incrementLimit(e){const{isFullScreen:t,currentResultCount:n,groupsPointer:o,incrementLimitsInRelatedGroups:i}=e,r=this.collectionContextStore.collectionViewStore();if(!r)return;const a=this.getGroupState(o);if(!a)return;const s=i?[...this.state.values()].filter((e=>1===o.length?1===e.groupsPointer.length:2===o.length&&(0,l.ZH)(o[0],e.groupsPointer[0]))):[a];for(const l of s){const e=l.currentLimit,o=e.state+C.NG({collectionViewStore:r,isFullScreen:t,currentResultCount:n});e.setState(o)}}}class L extends i.default{getInitialState(){return{hasLocalUpdates:!1,blockIds:new Set}}addLocalChange(e){for(const t of e)this.state.blockIds.add(t);this.state.hasLocalUpdates=!0,this.emit()}resetWithRemote(){const e=this.getInitialState();for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];e.blockIds=new Set(...n),this.setState(e)}}var j=n(83212);class N{static getLocalViewPreferenceKey(e){return`${N.PREFERENCE_KEY_PREFIX}${e}`}constructor(e){this.context=i.default.createValue(void 0),this.reducers=i.default.createValue({}),this.reducerDependencies=new Map,this.resultSet=new L,this.remoteResult=i.default.createValue(void 0),this.remoteCollectionIds=i.default.createValue([]),this.lastRemoteRequest=i.default.createValue(void 0),this.searchOpen=i.default.createValue(!1),this.searchQuery=i.default.createValue(""),this.isLoading=i.default.createValue(!1),this.isLoaded=i.default.createValue(!1),this.loadingDetails=i.default.createValue({type:"load_general"}),this.wasCreatedThisSession=i.default.createValue(!1),this.isFullScreen=i.default.createValue(!1),this.isRootChild=i.default.createValue(!1),this.isInPeekRenderer=i.default.createValue(!1),this.relativeVariables=i.default.createValue({}),this.groupsStore=new U(this),this.groupsLimit=i.default.createValue(A.XD),this.boardColumnsLimitStore=i.default.createValue(A.XD),this.settingsStore=i.default.createValue({open:!1,stack:[]}),this.filtersBarOpen=i.default.createValue(void 0),this.temporaryState=i.default.createValue({}),this.filterBarItemSettingsStoreMap=new Map,this.frozoneStore=i.default.createValue({isScrolled:!1,scrollerWidth:void 0,scrollerLeftOffset:void 0,frozenIndex:void 0,tryShowHiddenFrozenColumn:!1}),this.filterBarSortSettingsStore=i.default.createValue({open:!1,stack:[]}),this.filterBarCombinatorFilterSettingsStore=i.default.createValue({open:!1,stack:[]}),this.filterOptionsItemSettingsStoreMap=new Map,this.filterOptionsCombinatorFilterSettingsStore=i.default.createValue({open:!1,stack:[]}),this.dateRangeStart=i.default.createValue(Date.now()),this.dateRangeEnd=i.default.createValue(Date.now()),this.calendarByMenuOpen=i.default.createValue(!1),this.timelineByMenuOpen=i.default.createValue(!1),this.subitemExpandedStore=i.default.createValue(new Map),this.numberChildrenReceived=i.default.createValue(0),this.numberChildrenUnfurled=i.default.createValue(0),this.renderEmitter=new m.Z,this.remoteRequestStoreCallback=void 0,this.localResultStoreCallback=void 0,this.updateCounter=0,this.isClientModeEnabled=i.default.createValue(!1),this.isViewSpecificClientModeEnabled=i.default.createValue(!1),this.asyncAggregationStatus=i.default.createValue({calculating:!1,aggregation:void 0,changingType:!1}),this.infiniteScrollLongTaskObserver=new F,this.visitSessionId=(0,_.ZP)(),this.collectionStoresStore=new o.Z((()=>{const e=this.collectionViewBlockStore();if(!e)return[];const t=this.collectionStore();return t?[t]:this.remoteCollectionIds.state.map((t=>V.NW.createChildStore(e,{table:v.vF,id:t})))}),{debugName:"collectionStoresStore"}),this.localResultStore=new o.Z((()=>I.pi(this.environment,this)),{useDeepEqual:!0,debugName:"localResultStore"}),this.isEmptyStore=new o.Z((()=>{var e;const t=this.reducers.state;if(this.isLoading.state||this.shouldShowSpinner.state||y.xb(t))return!1;const n=this.localResultStore.state,o=this.remoteResult.state,i=this.wasCreatedThisSession.state;if(!n&&o&&0===this.collectionStoresStore.state.length)return!0;if(this.collectionStoresStore.state.length>0&&"calendar"===this.getViewType())return!1;if((0,p.nx)(null===(e=this.collectionViewStore())||void 0===e?void 0:e.getCollectionSource())&&o){if(Object.values(o.reducerResults).every((e=>"results"===e.type&&0===e.blockIds.length)))return!0}if(!n||"reducer"!==n.type||!o||"reducer"!==o.type)return!1;const r=Object.values(n.reducerResults).filter((e=>"results"===e.type)),a=Object.values(o.reducerResults).filter((e=>"results"===e.type));return!(!i&&0===a.length)&&(0!==r.length&&r.every((e=>"results"===e.type&&0===e.blockIds.length)))}),{debugName:"isEmptyStore"}),this.remoteRequestStore=new o.Z((()=>I.oh(this.environment,this)),{debugName:"remoteRequestStore"}),this.normalizedFormatStore=new o.Z((()=>{const e=this.collectionViewBlockStore(),t=this.collectionViewStore(),n=null==t?void 0:t.getType(),o=this.normalizedQueryStore.state,i=this.normalizedSchemaStore.state,r=null==t?void 0:t.getNormalizedFormat(i);if(!(e&&t&&n&&o&&r))return{};const a=Z.default.checkGate("home_compact_view");return(0,T.qG)(e.id)&&this.isCompactView.state&&!a?{...r,...(0,O.Vj)(n,r)}:a&&this.isInHomeWidget.state?{...r,...(0,O._B)()}:r}),{useDeepEqual:!0,debugName:"normalizedFormatStore"}),this.normalizedSchemaStore=new o.Z((()=>{const e=this.context.state;switch(null==e?void 0:e.type){case"collectionTypedView":const t=e.databaseType===r.iS?(0,r.uV)(E.default.getIntl()):{};if(!this.collectionViewBlockStore())return t;const n=this.collectionStoresStore.state;if(0===n.length)return t;const o=(0,u.jf)({schemas:[...n.map(w.gD),t],onlyPropertyIds:Object.keys(t),prioritizeLooserLimitRule:!0});return o.error?t:o.value;case"collectionVirtualView":case"collectionView":case"collectionPage":case"collectionViewBlock":case void 0:const i=this.collectionStore();return i?i.getSchema():c.Kc(E.default.getIntl());default:(0,S.t1)(e)}}),{useDeepEqual:!0,debugName:"normalizedSchemaStore"}),this.normalizedDeletedSchemaStore=new o.Z((()=>{const e=this.collectionStore();return e?e.getDeletedSchema():c.Kc(E.default.getIntl())}),{useDeepEqual:!0,debugName:"normalizedDeletedSchemaStore"}),this.normalizedQueryStore=new o.Z((()=>{const e=this.collectionViewStore();if(e){const t=e.getType();if(t){const n=this.normalizedSchemaStore.state;return(0,d.Qo)({type:t,query2:e.getQueryStore().getValue()},n)}}}),{useDeepEqual:!0,debugName:"normalizedQueryStore"}),this.subitemTreeStore=new o.Z((()=>(0,D.yr)(this,this.environment.currentUser.id)),{debugName:"subitemTreeStore"}),this.shouldShowSpinner=new o.Z((()=>{var e,t,n,o;if(!this.isLoading.state)return!1;const i=null===(e=this.lastRemoteRequest.state)||void 0===e?void 0:e.loader,r=null===(t=this.remoteRequestStore.state)||void 0===t?void 0:t.loader;if(!y.Xy(null==i?void 0:i.filter,null==r?void 0:r.filter))return!0;if(!y.Xy(null==i?void 0:i.sort,null==r?void 0:r.sort))return!0;if(!y.Xy(null==i?void 0:i.searchQuery,null==r?void 0:r.searchQuery))return!0;if(!y.Xy(null===(n=this.lastRemoteRequest.state)||void 0===n?void 0:n.source,null===(o=this.remoteRequestStore.state)||void 0===o?void 0:o.source))return!0;const a=(null==i?void 0:i.reducers)||{},s=(null==r?void 0:r.reducers)||{};for(const l in s){const e=s[l],t=a[l];if(!y.Xy(e,t))return!0}return!1}),{debugName:"shouldShowSpinner"}),this.shouldShowSource=new o.Z((()=>{const e=this.collectionViewBlockStore(),t=this.collectionViewStore(),n=this.collectionStore();if(!e||!t||!n)return!1;return!(e.getCollectionViewSourceCollectionStore()&&this.isFullScreen.state||t.getFormat().hide_linked_collection_name)}),{debugName:"shouldShowSource"}),this.isCompactView=new o.Z((()=>{if(this.isFullScreen.state)return!1;const e=this.collectionViewBlockStore(),t=this.collectionViewStore();if(!e||!t)return!1;const n=Z.default.checkGate("collections_compact_view");return t.isCompactView()&&(n||this.isInHomeWidget.state||t.getIsUnlisted())}),{debugName:"isCompactView"}),this.isUnlistedView=new o.Z((()=>{var e;return(null===(e=this.collectionViewStore())||void 0===e?void 0:e.getIsUnlisted())??!1}),{debugName:"isUnlistedView"}),this.isInHomeWidget=new o.Z((()=>(0,T.YO)(this.isInPeekRenderer.state)),{debugName:"isInHomeWidget"}),this.permissionScopes=new o.Z((()=>{const e=this.collectionStore(),t=this.collectionViewStore(),n=this.collectionViewBlockStore(),o=this.isFullScreen.state,i=C.eD({collectionStore:e,collectionViewBlockStore:n,checkNavigableAncestorLocked:!o}),r=Z.default.checkGate("prevent_edits_trash"),a=Boolean(null==e?void 0:e.isNonEditableState()),s=Boolean(null==n?void 0:n.isNonEditableState()),l=Boolean(null==n?void 0:n.isLocked()),c=Boolean(null==e?void 0:e.isSyncedCollection()),d=r?a||s:l;if(!t||!n)return{canConfigureCollection:i,canConfigureBlock:Boolean((null==n?void 0:n.canEditCollection())&&!n.isNonEditableState()),canEditContent:Boolean((null==n?void 0:n.canEditCollection())||(null==n?void 0:n.canEditContentOnly())),isLocked:d,isSyncedCollection:c};const u=!o&&n.isNavigableAncestorNonEditableState(),p=Boolean(n.inMemoryRecordCache.snapshotData),m=j.Z.getMode(this.environment,n);if(u||p||"comment"===(null==m?void 0:m.permission)||"view"===(null==m?void 0:m.permission))return{canConfigureCollection:i,canConfigureBlock:!1,canEditContent:!1,isLocked:d,isSyncedCollection:c};const f=n.canEditCollection(),g=null==e?void 0:e.getParentBlockStore(),h=Boolean(null==g?void 0:g.pathIsDead()),v=n.pathIsDead(),b=r?Boolean(e&&e.canEdit()&&!(h||v)):Boolean(e&&e.canEdit());return{canConfigureCollection:i,canConfigureBlock:Boolean(f&&!s),canEditContent:b,isLocked:d,isSyncedCollection:c}}),{debugName:"permissionScopes"}),this.filtersBarOpenStore=new o.Z((()=>{if(this.environment.device.isPhone)return!0;const e=this.filtersBarOpen.state;if(void 0!==e)return e;return this.currentPropertyFiltersStore.state.some((e=>{const t=e.filter;return(0,s.Oo)(t)}))||(0,M.Nq)(this)}),{debugName:"filtersBarOpenStore"}),this.localStateDiffStore=new o.Z((()=>(0,M.Zh)(this,"normalized")),{useDeepEqual:!0,debugName:"localStateDiffStore"}),this.currentCombinatorFilterStore=new o.Z((()=>{var e;const t=this.temporaryState.state.combinatorFilter;return t?t.value:null===(e=this.normalizedQueryStore.state)||void 0===e?void 0:e.filter}),{useDeepEqual:!0,debugName:"currentCombinatorFilterStore"}),this.currentSubitemFormatStoreForUiDisplay=new o.Z((()=>{var e,t;const n=null===(e=this.collectionViewStore())||void 0===e?void 0:e.getFormat().subitem_display_mode;if("flattened"===n||"hidden"===n)return;const o=(0,D.wf)(this),i=null===(t=this.collectionViewStore())||void 0===t?void 0:t.getType(),r=(0,M.RL)({collectionContextStore:this,applySubitemFilter:!1,filterOutHideSubitemsQuickFilter:!1}),a=(0,s.kk)(r);return a&&(0,s.SH)(a,(e=>!!(0,s.aN)(e)&&(e.property===(null==o?void 0:o.property)||e.property===(null==o?void 0:o.inverse))))&&i&&!(0,D.Av)(i)?void 0:o}),{useDeepEqual:!0,debugName:"currentSubitemFormatStoreForUiDisplay"}),this.currentSubitemFormatStoreForCollection=new o.Z((()=>(0,D.wf)(this)),{useDeepEqual:!0,debugName:"currentSubitemFormatStoreForCollection"}),this.currentArrowsByFormatStore=new o.Z((()=>(0,k.H5)(this)),{useDeepEqual:!0,debugName:"currentArrowsByFormatStore"}),this.currentPropertyFiltersStore=new o.Z((()=>{const e=this.normalizedSchemaStore.state,t=this.temporaryState.state.propertyFilters;return(t?t.value||[]:this.normalizedFormatStore.state.property_filters||[]).map((t=>{const n=(0,d.dN)(t.filter,e),o=this.collectionViewBlockStore();if(e[t.filter.property]&&n&&(0,s.J5)(e,t.filter.property,n.filter,null==o?void 0:o.getRecordModel))return n&&{id:t.id,filter:n}})).filter(S.$K)}),{useDeepEqual:!0,debugName:"currentPropertyFiltersStore"}),this.currentSortsStore=new o.Z((()=>{var e;const t=this.temporaryState.state.sorts;return t?t.value||[]:(null===(e=this.normalizedQueryStore.state)||void 0===e?void 0:e.sort)||[]}),{useDeepEqual:!0,debugName:"currentSortsStore"}),this.blockIsPrivateStore=new o.Z((()=>{const e=this.collectionViewBlockStore();if(e)return(0,B.RC)({environment:this.environment,store:e})}),{debugName:"blockIsPrivateStore"}),this.inheritedBlockColorStore=new o.Z((()=>{const e=this.collectionViewBlockStore(),{ThemeModeStore:t}=this.environment;if(!e)return;const n=e.findRecordStoreUIAncestor((e=>Boolean(e instanceof V.G&&e.getRecordStoreUIParent()&&e.getFormat().block_color&&!e.isCollectionView()))).ancestor;if(n&&n instanceof V.G){const e=n.getType(),o=n.getFormat().block_color;if(o){const n=(0,b.gh)({theme:t.state});return e===a.Ti.callout?(0,b.x7)(o,n):(0,b.fi)(o,n)}}}),{useDeepEqual:!0,debugName:"inheritedBlockColorStore"}),this.defaultPageTemplateStore=new o.Z((()=>{var e,t;const n=this.collectionStore(),o=this.collectionViewStore(),i=y.oA([null==o||null===(e=o.getFormat())||void 0===e?void 0:e.collection_view_default_template,null==n||null===(t=n.getFormat())||void 0===t?void 0:t.collection_default_template]),r=null==n?void 0:n.getTemplatePageStores();for(const a of i){if("empty"===a)return;const e=null==r?void 0:r.find((e=>e.id===a.template_page_id));if(null!=e&&e.getAlive())return e}}),{debugName:"defaultPageTemplateStore"}),this.relativeVariableStore=new o.Z((()=>{const e=this.context.state;if(!e)return;const t=e.collectionViewBlockStore;if(!t)return;const n={},o=this.relativeVariables.state;for(const[i,r]of(0,S.qP)(o)){const e=V.NW.createChildStore(t,{id:i,table:v.vF}),o=e.getSchema(),a=null==e?void 0:e.getFormat().app_config_uri;if(a&&(0,g.oN)(o,a)){n[i]={};for(const[t,s]of(0,S.qP)(r)){const r=V.G.createChildStore(e,{id:s,table:h.iU});r.isDefined()&&((0,R.iL)({blockStore:r,collectionId:i,appConfigUri:a,variable:t,schema:o})&&(n[i][t]=s))}}}return n}),{useDeepEqual:!0,debugName:"relativeVariableStore"}),this.relativeVariablesAreStale=new o.Z((()=>{const e=this.context.state;if(!e)return!1;const t=e.collectionViewBlockStore;if(!t)return!1;const n=this.relativeVariables.state;for(const[o,i]of(0,S.qP)(n)){const e=V.NW.createChildStore(t,{id:o,table:v.vF}),n=e.getSchema(),r=null==e?void 0:e.getFormat().app_config_uri;if(r&&(0,g.oN)(n,r))for(const[t,a]of(0,S.qP)(i)){const i=V.G.createChildStore(e,{id:a,table:h.iU});if(i.isDefined()&&!(0,R.iL)({blockStore:i,collectionId:o,appConfigUri:r,variable:t,schema:n}))return!0}}return!1}),{debugName:"relativeVariablesAreStale"}),this.aliveAutomationCount=new o.Z((()=>{const e=this.collectionStore();if(!e)return 0;const t=e.getAutomationStores();let n=0;for(const o of t)(o.isTriggerType("notification_event")||o.isTriggerType("event"))&&o.getAlive()&&(n+=1);return n}),{debugName:"aliceAutomationCount"}),this.aliveSlackAutomationCount=new o.Z((()=>{const e=this.collectionStore();if(!e)return 0;const t=e.getAutomationStores();let n=0;for(const o of t)o.isTriggerType("notification_event")&&o.getAlive()&&(n+=1);return n}),{debugName:"aliveSlackAutomationCount"}),this.getCompleteSprintButtonContext=new o.Z((()=>{var e,t;if((null===(e=this.collectionViewStore())||void 0===e?void 0:e.getFormatStore().getKeyStore("app_config_uri").getValue())!==r.g3)return;const n=this.sprintSettingsContextStore.state;if(!n||!n.sprintCollectionStore)return;if(!n.automationContext)return;const{sprintCollectionStore:o,taskCollectionStore:i,automationContext:a}=n,s=this.getAutomationCollectionValue(i),l=this.getAutomationCollectionValue(o),c=null==l||null===(t=l.format)||void 0===t?void 0:t.app_config_uri,d=o.getSchema();return c&&g.qB[c]&&(0,g.oN)(d,c)&&s&&l?{...n,sprintCollectionStore:o,taskCollectionValue:s,sprintCollectionValue:l,sprintCollectionSchema:d,automationContext:a}:void 0}),{useDeepEqual:!0,debugName:"getCompleteSprintButtonContext"}),this.sprintSettingsContextStore=new o.Z((()=>{const e=(()=>{const e=this.collectionStore(),t=this.collectionViewBlockStore();if(!t||!e)return;const n=e.getParentBlockStore();if(!n||!Boolean(n.pathIsAccessibleAndAlive()))return;const o=e.getDatabaseType();if(o!==r.p$&&o!==r.iS)return;let i,a,s,l;if(o===r.iS){var d;i=e,a=n;const o=null===(d=i.getFormatStore().getKeyStore("app_uri_map").getValue())||void 0===d?void 0:d[r.Es.TaskToSprintRelation];if(!o)return{currentCollectionViewBlockStore:t,taskCollectionStore:i,taskCollectionViewBlockStore:a,sprintCollectionStore:void 0,sprintCollectionViewBlockStore:void 0,automationContext:void 0};const u=i.getSchemaStore().getKeyStore(o).getValue();if(!u||!c.p_(u))return;const p=c.j0(u);if(!p)return{currentCollectionViewBlockStore:t,taskCollectionStore:i,taskCollectionViewBlockStore:a,sprintCollectionStore:void 0,sprintCollectionViewBlockStore:void 0,automationContext:void 0};if(s=V.NW.createChildStore(t,p),l=s.getParentBlockStore(),!l)return{currentCollectionViewBlockStore:t,taskCollectionStore:i,taskCollectionViewBlockStore:a,sprintCollectionStore:void 0,sprintCollectionViewBlockStore:void 0,automationContext:void 0};if(s.getDatabaseType()!==r.p$)return}else if(o===r.p$){var u;s=e,l=n;const o=null===(u=s.getFormatStore().getKeyStore("app_uri_map").getValue())||void 0===u?void 0:u[r.b0.SprintToTaskRelation];if(!o)return;const d=s.getSchemaStore().getKeyStore(o).getValue();if(!d||!c.p_(d))return;const p=c.j0(d);if(!p)return;if(i=V.NW.createChildStore(t,p),a=i.getParentBlockStore(),i.getDatabaseType()!==r.iS||!a)return}else(0,S.t1)(o);if(s.getAutomationStores().some((e=>!e.isDefined())))return{currentCollectionViewBlockStore:t,taskCollectionStore:i,taskCollectionViewBlockStore:a,sprintCollectionStore:void 0,sprintCollectionViewBlockStore:void 0,automationContext:void 0};const p=s?y.Ps(y.oA(s.getAutomationStores().map((e=>{if(!Boolean(e.getAlive()))return;const t=e.getActionStores();return e.isTriggerType("recurrence")&&1===t.length&&Boolean(t[0].getAlive())&&t[0].isType("complete_sprint")?{automationStore:e,automationActionStore:t[0]}:void 0})))):void 0;return Boolean(i.getAlive())&&a.pathIsAccessibleAndAlive()?Boolean(s.getAlive())&&l.pathIsAccessibleAndAlive()?{currentCollectionViewBlockStore:t,taskCollectionStore:i,taskCollectionViewBlockStore:a,sprintCollectionStore:s,sprintCollectionViewBlockStore:l,automationContext:p}:{currentCollectionViewBlockStore:t,taskCollectionStore:i,taskCollectionViewBlockStore:a,sprintCollectionStore:void 0,sprintCollectionViewBlockStore:void 0,automationContext:void 0}:void 0})(),t=(e=>{var t;if(!e)return;if(!e.taskCollectionViewBlockStore.canEditCollection())return{canEdit:!1};const n=e.sprintCollectionViewBlockStore,o=Boolean(null===(t=e.sprintCollectionViewBlockStore)||void 0===t?void 0:t.canEditCollection());return n&&!o?{canEdit:!1}:!e.sprintCollectionViewBlockStore||o&&!e.automationContext?{canEdit:!0,sprintsEnabled:!1}:o&&e.automationContext?{canEdit:!0,sprintsEnabled:!0}:void 0})(e);return e&&t?{...e,permissionsContext:t}:void 0}),{useDeepEqual:!0,debugName:"sprintSettingsContextStore"}),this.initialDatabaseItemsVisibleTracker=void 0,this.onItemMount=()=>{var e;null===(e=this.initialDatabaseItemsVisibleTracker)||void 0===e||e.handleItemMount(),this.trackInfiniteScrollLongTasksDebounced()},this.trackInfiniteScrollLongTasksDebounced=y.Ds(this.trackInfiniteScrollLongTasks,1e3),this.environment=e}setContext(e){this.context.setState(e)}get contextType(){var e;return null===(e=this.context.state)||void 0===e?void 0:e.type}get databaseType(){const e=this.context.state;if(e){if("collectionTypedView"===e.type)return e.databaseType;if("collectionView"===e.type){const t=e.collectionStore;return null==t?void 0:t.getDatabaseType()}}}collectionViewStore(){const e=this.context.state,t=null==e?void 0:e.type;if(t)switch(t){case"collectionTypedView":case"collectionView":case"collectionVirtualView":return e.collectionViewStore;case"collectionPage":case"collectionViewBlock":return;default:(0,S.t1)(t)}}collectionStore(){const e=this.context.state;if(e&&"collectionTypedView"!==e.type)return"collectionVirtualView"===e.type||"collectionView"===(null==e?void 0:e.type)||"collectionPage"===(null==e?void 0:e.type)?e.collectionStore:void("collectionViewBlock"!==(null==e?void 0:e.type)&&(0,S.t1)(e))}hasSingleCollection(){switch(this.contextType){case"collectionTypedView":case"collectionVirtualView":return!1;case"collectionPage":case"collectionViewBlock":case"collectionView":case void 0:return!0;default:(0,S.t1)(this.contextType)}}collectionViewBlockStore(){const e=this.context.state;return null==e?void 0:e.collectionViewBlockStore}formatStore(){const e=this.context.state;if(e)return"collectionPage"===e.type?e.collectionStore:"collectionView"===e.type||"collectionTypedView"===e.type||"collectionVirtualView"===e.type?e.collectionViewStore:void("collectionViewBlock"!==e.type&&(0,S.t1)(e))}getPropertyFormatKey(){const e=this.context.state;if("collectionPage"===(null==e?void 0:e.type))return"collection_page_properties";if("collectionView"===(null==e?void 0:e.type)||"collectionTypedView"===(null==e?void 0:e.type)){const t=e.collectionViewStore.getType();if(!t)return;return f.oz(t)}}getPropertyFormat(e){var t;const n=null===(t=this.formatStore())||void 0===t?void 0:t.getFormat(),o=null==this?void 0:this.getPropertyFormatKey();if(!n||!o)return;return(n[o]??[]).find((t=>t.property===e))}createUpdateCounter(){return this.updateCounter++,this.updateCounter}shouldUpdate(e){return this.updateCounter===e}getCurrentUserId(){return this.environment.currentUser.id}getViewType(){const e=this.collectionViewStore();if(null!=e&&e.isDefined())return e.getType();const t=this.context.state;return"collectionPage"===(null==t?void 0:t.type)?"page":void 0}currentViewHasSort(){const e=this.normalizedQueryStore.state;return Boolean(e&&e.sort&&e.sort.length>0)}resetLoadingState(){this.isLoading.setState(!1),this.loadingDetails.reset()}getCollectionViewBlockSourceState(){const e=this.collectionViewBlockStore();if(!e)return"uninitialized";if(e.getCollectionViewSourceCollectionStore())return"source";return e.getCollectionViewStores().some((e=>Boolean(e.getCollectionStore())))?"linked":"uninitialized"}getFilterBarItemSettingsStore(e){let t=this.filterBarItemSettingsStoreMap.get(e.id);return t||(t=i.default.createValue({open:!1,stack:[]}),this.filterBarItemSettingsStoreMap.set(e.id,t)),t}getFilterOptionsItemSettingsStore(e){let t=this.filterOptionsItemSettingsStoreMap.get(e.id);return t||(t=i.default.createValue({open:!1,stack:[]}),this.filterOptionsItemSettingsStoreMap.set(e.id,t)),t}viewIsFlushToTopbar(){if(!this.collectionStore())return!1;if(this.shouldShowSource.state)return!1;if(this.filtersBarOpenStore.state)return!1;return void 0===this.getCompleteSprintButtonContext.state}shouldAllowNewItemCreation(e){const t=this.permissionScopes.state,n="collectionTypedView"===this.contextType;return!t.isSyncedCollection&&(t.canEditContent||n&&(null==e?void 0:e.overrideAllowForTypedViews))}shouldShowPageIcon(){var e;return(null===(e=this.collectionViewStore())||void 0===e?void 0:e.shouldShowPageIcon())??!0}getAutomationCollectionValue(e){if(e.isDefined())return{id:e.id,space_id:e.getSpaceId(),schema:e.getSchema(),format:e.getFormat()}}async trackInfiniteScrollLongTasks(){if(!this.infiniteScrollLongTaskObserver.isObserving)return;this.infiniteScrollLongTaskObserver.disconnect();const e=this.infiniteScrollLongTaskObserver.takeRecords();if(!(await x.TA("collections.infinite_scroll_long_tasks.max_duration")))return;const t=e.reduce(((e,t)=>(e.entryCount++,e.maxDuration=Math.max(e.maxDuration,t.duration),e)),{maxDuration:0,entryCount:0}),n=P.Pn(this);x.j(this.environment,"collections.infinite_scroll_long_tasks.count",{count:t.entryCount,...n}),t.entryCount>0&&x.j(this.environment,"collections.infinite_scroll_long_tasks.max_duration",{time:t.maxDuration,...n})}getPageVisitSourceOverride(){var e;switch(null===(e=this.context.state)||void 0===e?void 0:e.type){case"collectionTypedView":case"collectionVirtualView":return this.context.state.pageVisitSourceOverride;case"collectionPage":case"collectionView":case"collectionViewBlock":case void 0:return;default:(0,S.t1)(this.context.state)}}resultsInViewOrder(e){var t;const n=this.collectionViewBlockStore(),o=this.collectionViewStore(),i=this.collectionStoresStore.state;if(!n||!o||!i.length)return[];const r=this.normalizedFormatStore.state,a="board"===this.getViewType()?{groupByKey:"board_columns_by",groupsFormatKey:"board_columns"}:{groupByKey:"collection_group_by",groupsFormatKey:"collection_groups"},s=this.normalizedSchemaStore.state,c=r[a.groupByKey],d=(0,S.$K)(c)?(0,l.Qq)({schema:s,groupBy:c}):[],u=Object.values((null===(t=this.localResultStore.state)||void 0===t?void 0:t.reducerResults)??{}).find((e=>"groups"===e.type)),p=(0,A.Cz)({getRecordModel:n.getRecordModel,schema:s,groupBy:c,formatGroups:r[a.groupsFormatKey]??[],schemaGroups:d,reducerResults:(null==u?void 0:u.results)??[],relativeVariableResult:this.relativeVariableStore.state,viewAppConfigUri:o.getFormat().app_config_uri,allowedCollectionStores:i});let m,f;if(0===p.length){const e=this.localResultStore.state;if(e){const t=Object.values(e.reducerResults).find((e=>"results"===e.type));m=((null==t?void 0:t.blockIds)??[]).map((e=>V.G.createChildStore(o,{table:"block",id:e})))}else m=[]}else{m=[];for(const e of p){const t=this.groupsStore.getGroupState(e),n=null==t?void 0:t.resultsStore.state;m.push(...n??[])}}if(m=y.mN(m,(e=>e.id)),this.currentSubitemFormatStoreForUiDisplay.state){f=[];const t=this.subitemTreeStore.state;for(const n of m){if(void 0!==e&&f.length>=e)break;const o=t.children.find((e=>e.value.store.id===n.id));if(o){const e=[];(0,D.yU)({results:e,tree:o}),f.push(...e)}}}else f=m;return void 0!==e?f.slice(0,e):f}collectionStoreResultsInViewOrder(){if("collectionTypedView"!==this.contextType){const e=this.collectionStore();return e?[e]:[]}const e=this.resultsInViewOrder(void 0);return y.oA(y.mN(e.map((e=>e.getAssociatedCollectionStore())),"id"))}}N.PREFERENCE_KEY_PREFIX="CollectionView:",N.incrementScrollOffset=600;const z=N},58421:(e,t,n)=>{n.d(t,{n:()=>i});var o=n(53965);function i(e){const t=e.state;return o.Z$(t.stack)}},6776:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(53965);class r extends o.default{getInitialState(){return{editMode:void 0,store:void 0}}cloneState(){return i.d9(this.state)}}const a=new r},19511:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(53965);class r extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return i.d9(this.state)}}const a=new r},16772:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});n(21703);var o=n(49085),i=n(92595),r=n(12139);class a extends o.default{constructor(){super(...arguments),this.lastUpdater=0}getInitialState(){return{type:"closed"}}setState(e){if("completionPopup"===this.state.type&&"results"===this.state.stage&&("completionPopup"!==e.type||"results"!==e.stage)){const{inMemoryRecordCache:e,context:t}=this.state;if(e.cacheUsingThisInstanceAsAnOverride){const n=`CompletionsStore transitioning away from completionPopup results while inMemoryRecord cache is still overriding ${e.cacheUsingThisInstanceAsAnOverride===t.currentPage.inMemoryRecordCache?"page's in-memory cache":"an unknown cache"}!`;r.rn(new Error(n),{from:"CompletionsStore",type:"dangerousStateTransition"})}}super.setState(e)}createUpdater(){const e=++this.lastUpdater;return t=>{if(e===this.lastUpdater)return t()}}invalidateLastUpdater(){this.lastUpdater+=1}resetStore(e){const{environment:t}=e;this.invalidateLastUpdater();const n=this.state;"completionPopup"!==n.type&&"assistantCompletionPopup"!==n.type||("completionPopup"===n.type&&"initialPromptForAIBlock"!==n.stage&&"initialPrompt"!==n.stage&&t.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(n.inMemoryRecordCache),this.setState({type:"closed"}))}getExistingSessionId(){return"closed"!==this.state.type?this.state.sessionId:void 0}isEditingEmptyBlock(){var e;const t=this.state;return Boolean(("completionPopup"===t.type||"assistantCompletionPopup"===t.type)&&"initialPrompt"===t.stage&&"cursor"===t.context.type&&(null===(e=t.context.currentBlock)||void 0===e?void 0:e.isEmptyEditableBlock()))}}const s=new a;(0,i.exposeDebugValue)("CompletionsStore",s);const l=s},72371:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(14577),i=n(49085),r=n(92595);class a extends i.default{constructor(){super(...arguments),this.integrations=new o.Z((()=>{const e=this.state;return e.loaded?e.integrations:[]}),{debugName:"ComplianceIntegrationStore.integrations"}),this.webhookSubscriptions=new o.Z((()=>{const e=this.state;return e.loaded?e.webhookSubscriptions:[]}),{debugName:"ComplianceIntegrationStore.webhookSubscriptions"})}getInitialState(){return{loaded:!1,loading:!1}}}const s=new a;(0,r.exposeDebugValue)("ComplianceIntegrationStore",s);const l=s},81700:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},80641:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{bypassedPageIds:new Set}}bypassedPage(e){return this.state.bypassedPageIds.has(e)}bypassPage(e){this.state.bypassedPageIds.add(e),this.emit()}}const r=new i},61893:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(86658),r=n(12955);class a extends o.default{getInitialState(){return{permission:i.UE}}getId(){return this.getState().id}getPermission(){return this.getState().permission}setPermission(e){this.setState({...this.state,permission:e})}async setCookieConsent(e,t){this.setState(t),await(0,r.setCookieConsentCookie)(e,t)}clearCookieConsent(){this.reset(),(0,r.removeCookieConsentCookie)()}}const s=new a},45293:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},56681:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{pageId:void 0,lastInteractionTimes:{}}}}const r=new i},28748:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},30581:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{constructor(){super(...arguments),this.containerDomNodeStore=o.default.createValue(null)}getInitialState(){return{overlays:new Set}}}const r=new i},55367:(e,t,n)=>{n.d(t,{Dl:()=>r,ZP:()=>s,vh:()=>i});var o=n(49085);let i=function(e){return e[e.Above=0]="Above",e[e.Below=1]="Below",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Onto=4]="Onto",e}({}),r=function(e){return e[e.Selectable=0]="Selectable",e[e.DropTarget=1]="DropTarget",e}({});class a extends o.default{getInitialState(){return{isDragging:!1}}}const s=new a},45452:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isDragging:!1,willDrag:!1}}}const r=i},10084:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(53965);class r extends o.default{getInitialState(){return{initiator:"none",dragging:!1,waiting:!1}}hasDragged(){return this.state.dragging&&!i.Xy(this.state.startingPoint,this.state.currentPoint)}}const a=r},80796:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{initiator:"none",isDragging:!1,disableVerticalEdgeScroll:!1,disableHorizontalEdgeScroll:!1}}}const r=new i},12211:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{dropTargetRectMap:new Map}}}const a=new r;(0,i.exposeDebugValue)("GlobalDropTargetRectStore",a);const s=a},807:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(77080);class r extends o.default{getInitialState(){return{blockStoreMode:{}}}getMode(e){if(!i.default.checkGate("human_suggested_edits"))return"default";let t=e.id;if(!e.isNavigableBlock()){const n=e.getNavigableBlockStore();n&&(t=n.id)}return this.state.blockStoreMode[t]??"default"}}const a=new r},24042:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isTabsFeatureEnabled:!1}}}const r=new i},64233:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},66949:(e,t,n)=>{n.d(t,{P:()=>r,Z:()=>l});var o=n(49085),i=n(92595);let r=function(e){return e.Forward="Forward",e.Backward="Backward",e}({});class a extends o.default{getInitialState(){return{open:!1}}isOpen(){if(this.state.open){this.state;return!0}return!1}}const s=new a;i.exposeDebugValue("EquationAnnotationStore",s);const l=s},77080:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b,localExperimentsV2Key:()=>h});var o=n(14577),i=n(49085);var r=n(12174),a=n(68626),s=n(15157),l=n(97715),c=n(34886),d=n(53965),u=n(1898),p=n(95477),m=n(64496),f=n(80444),g=n(7339);const h="experimentsSettingsV2";class v extends i.default{getInitialState(){return{isLoaded:!1}}updateState(e,t){!e.test&&this.state.isLoaded&&this.state.test||(this.setState(e),(0,m._3)(t)||s.Z.set({userId:e.userId,key:h,value:e}))}setState(e){super.setState(e)}getExperimentsForCurrentSpace(){if(!this.state.isLoaded)return[];if(this.state.test)return this.state.experiments;const e=f.default.state.currentSpaceStore;return e&&this.state.experimentsBySpace[e.id]||this.state.experimentsWithoutSpace}getGroup(e){if(r.TS.has(e))return l.Le;let t;if(this.state.isLoaded){const n=this.getExperimentsForCurrentSpace().find((t=>t.experimentId===e));if(!n)return l.Le;t=n.group}return t||l.Le}getExperimentsMap(){const e={};return this.state.isLoaded&&this.getExperimentsForCurrentSpace().forEach((t=>{e[t.experimentId]=t.group})),e}getExperiments(){const e={};return this.state.isLoaded&&this.getExperimentsForCurrentSpace().forEach((t=>{e[t.experimentId]=t})),Object.values(e)}getUsedNonControlExperimentsMap(){const e={};return this.state.isLoaded&&this.getExperimentsForCurrentSpace().forEach((t=>{"control"!==t.group&&(0,r.DP)(t.experimentId)&&(e[t.experimentId]=t.group)})),e}getAcceptLanguageHeader(){if(this.state.isLoaded)return this.state.acceptLanguageHeader}}const b=new class extends v{constructor(){super(),this.statsigExposureCacheForAnalytics={},this.computedStoreMap=new Map,this.isStatsigEnabled()&&g.C.addListener((()=>{this.recomputeAllGroupStores()}))}isStatsigEnabled(){var e;return Boolean(null===(e=p.default.statsig)||void 0===e?void 0:e.apiKey)}isStatsigEnabledAndInitialized(){return this.isStatsigEnabled()&&g.C.isInitialized()}isLoaded(){return this.state.isLoaded}getGroup(e,t){if(!(0,r.YY)(e)){return this.createComputedGroupStore(`group-${e}`,(()=>super.getGroup(e))).state.group||l.Le}return this.getEligibleGroup({experimentId:e,defaultGroup:l.Le,disableExposureLogging:null==t?void 0:t.disableExposureLogging})}getEligibleGroup(e){const{experimentId:t,defaultGroup:n,parameter:o=g.Z,disableExposureLogging:i=!1}=e,r=o===g.Z;this.state.isLoaded;const a=`eligible-group-${t}-${o}`;return this.createComputedGroupStore(a,(()=>{if(!this.isStatsigEnabledAndInitialized())return;const e=this.validateGroupIsString(g.C.getGroup(t,i));return void 0!==e&&(this.statsigExposureCacheForAnalytics[`statsig-${t}`]=e),r?e:g.C.getGroup(t,i,o,n)})).state.group??n}manuallyLogExperimentExposure(e){g.C.manuallyLogExperimentExposure(e)}checkGate(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.getFeatureGateOverrideForBrowserTest(e);if((0,u.$K)(n))return n;const o=this.getFeatureGateOverrideForUnitTest(e);if((0,u.$K)(o))return o;return this.createComputedGateStore(e,(()=>{if(!this.isStatsigEnabledAndInitialized())return!1;const n=g.C.checkGate(e,t);return this.statsigExposureCacheForAnalytics[`statsig-${e}`]=n,n})).state.gate}getConfigKey(e,t,n){const o=r.LI[e][t];return this.createComputedDynamicConfigKeyStore(e,t,(()=>{var i;return this.isStatsigEnabledAndInitialized()&&(null===(i=g.C.getConfig(e,n))||void 0===i?void 0:i.get(String(t),o))||o})).state.value}logEvent(e,t,n){return this.isStatsigEnabledAndInitialized()?g.C.logEvent(e,t,(0,c.R)(n)):(a.log({level:"error",from:"ExperimentStore.ts",type:"statsigIsNotInitialized",data:{miscDataToConvertToString:{eventName:e,value:t,metadata:(0,c.R)(n),isStatsigEnabled:this.isStatsigEnabled(),isInitialized:g.C.isInitialized()}}}),!1)}getExperimentsMap(){return{...super.getExperimentsMap(),...this.statsigExposureCacheForAnalytics}}getStatsigExperimentsMap(){return this.statsigExposureCacheForAnalytics}updateState(e,t){(void 0===e.userId||this.state.isLoaded&&this.state.userId!==e.userId)&&(this.statsigExposureCacheForAnalytics={}),super.updateState(e,t)}reset(){super.reset(),this.statsigExposureCacheForAnalytics={},this.recomputeAllGroupStores()}async waitUntilStatsigReady(){this.isStatsigEnabled()&&await g.C.waitUntil((()=>g.C.state.ready))}createComputedGroupStore(e,t){return this.createComputedStore(e,(()=>({group:t(),lastUpdatedMinute:(new Date).getMinutes()})))}createComputedGateStore(e,t){return this.createComputedStore(`gate-${e}`,(()=>({gate:t(),lastUpdatedMinute:(new Date).getMinutes()})))}createComputedDynamicConfigKeyStore(e,t,n){return this.createComputedStore(`config-${e}-${String(t)}`,(()=>({value:n(),lastUpdatedMinute:(new Date).getMinutes()})))}createComputedStore(e,t){const n=(new Date).getMinutes();let i=this.computedStoreMap.get(e);return i?i.state.lastUpdatedMinute!==n&&i.setShouldRecompute():(i=new o.Z(t,{debugName:`ExperimentStore.${e}`}),i.addListener(d.yR),this.computedStoreMap.set(e,i)),i}recomputeAllGroupStores(){this.computedStoreMap.forEach((e=>{e.enqueueRecompute()}))}getFeatureGateOverrideForBrowserTest(e){}getFeatureGateOverrideForUnitTest(e){}validateGroupIsString(e){return"string"==typeof e?e:void 0}}},30874:(e,t,n)=>{n.d(t,{Z:()=>u});var o=n(14577),i=n(49085),r=n(92595),a=n(45953),s=n(77420),l=n(9844);class c extends i.default{constructor(){super(...arguments),this.integrations=new o.Z((()=>{const e=this.state;return e.loaded?e.integrations:[]}),{debugName:"ExternalIntegrationStore.integrations"}),this.bots=new o.Z((()=>{const e=this.state;return e.loaded?e.bots:[]}),{debugName:"ExternalIntegrationStore.bots"}),this.externalAuthentications=new o.Z((()=>{const e=this.state;return e.loaded?e.externalAuthentications:[]}),{debugName:"ExternalIntegrationStore.externalAuthentications"}),this.completeSlackAuthentications=new o.Z((()=>{const e=this.state;return e.loaded?e.completeSlackAuthentications:[]}),{debugName:"ExternalIntegrationStore.completeSlackAuthentications"})}getInitialState(){return{loaded:!1,loading:!1}}getIntegrationsAsRecordMap(){const e=a.Ak.create();return this.integrations.state.forEach((t=>e.setValue({table:l.K2,id:t.id},t))),e}getBotsAsRecordMap(){const e=a.Ak.create();return this.bots.state.forEach((t=>e.setValue({table:s.cZ,id:t.id},t))),e}}const d=new c;(0,r.exposeDebugValue)("ExternalIntegrationStore",d);const u=d},79167:(e,t,n)=>{n.d(t,{Z:()=>g});var o=n(49085),i=n(41432),r=n(77657),a=n(45953),s=n(21202),l=n(77420),c=n(6287),d=n(53965),u=n(1898),p=n(19584),m=n(30874);class f extends o.default{getInitialState(){return{externalObjectInstanceBlockPointersMap:{},externalCollectionInstancePointersMap:{}}}addFromRecordMapWithRoleJson(e){this.addFromRecordMapWithRole(a.PF.create(e))}addFromRecordMapWithRole(e){const t=e.getByTable(c.vF).filter((e=>{var t;let{value:n}=e;return null==n||null===(t=n.value)||void 0===t||null===(t=t.format)||void 0===t?void 0:t.external_object_id})).map((e=>{let{value:t}=e;return(null==t?void 0:t.value)&&{id:t.value.id,table:c.vF,spaceId:t.value.space_id}})).filter(u.$K),n=m.Z.getBotsAsRecordMap(),o=e.getByTable(s.iU).filter((e=>{let{value:t}=e;if(!(t&&t.value&&t.value.format&&t.value.format.external_object_id))return!1;if(t.value.type!==i.Ti.externalObjectInstancePage&&t.value.type!==i.Ti.externalObjectInstance)return!1;const o=t.value.format.bot_id;if(!o)return!1;if(!0===m.Z.state.loaded){const e=n.getValue({table:l.cZ,id:o});if(e&&e.integration_id&&e.integration_id===r.U9)return!1}return!0})).map((e=>{let{value:t}=e;return null==t?void 0:t.value})).filter(u.$K),a=d.oA(o.map((e=>{if(e.type===i.Ti.externalObjectInstancePage&&e.parent_table===c.vF)return{id:e.parent_id,table:e.parent_table,spaceId:e.space_id}}))),f=(0,p.m8)(o.map((e=>{const t={id:e.id,table:s.iU,spaceId:e.space_id};return[e.id,t]}))),g=(0,p.m8)([...t,...a].map((e=>[e.id,e])));this.setState({externalObjectInstanceBlockPointersMap:{...this.state.externalObjectInstanceBlockPointersMap,...f},externalCollectionInstancePointersMap:{...this.state.externalCollectionInstancePointersMap,...g}})}reset(){this.setState({externalObjectInstanceBlockPointersMap:{},externalCollectionInstancePointersMap:{}})}isEmpty(){return 0===Object.keys(this.state.externalCollectionInstancePointersMap).length&&0===Object.keys(this.state.externalObjectInstanceBlockPointersMap).length}}const g=new f},51444:(e,t,n)=>{n.d(t,{X:()=>a,q:()=>r});var o=n(49085),i=n(15157);class r{constructor(e,t){this.nextVersion=1,this.keyFn=void 0,this.promiseMap=void 0,this.versionMap=void 0,this.store=void 0,this.fetchFn=void 0,this.fetch=async(e,t,n)=>{const o=this.keyFn(t),i=this.nextVersion++;this.versionMap[o]=i;const r=await this.fetchFn(e,t,n);return this.versionMap[o]!==i?this.promiseMap[o]:(this.store.state.dataMap[o]=r,this.store.emit(),r)},this.store=new o.default,this.store.setState({dataMap:{}}),this.promiseMap={},this.versionMap={},this.fetchFn=t,this.keyFn=e}getInitialState(){return{dataMap:{}}}getData(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=this.keyFn(t);return n&&(this.promiseMap[o]=void 0),this.promiseMap[o]??=this.fetch(e,t,n),this.store.state.dataMap[o]}awaitData(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=this.keyFn(t);return n&&(this.promiseMap[o]=void 0),this.promiseMap[o]??=this.fetch(e,t,n),this.promiseMap[o]}resetData(e,t){const n=this.keyFn(t);if(this.promiseMap[n]){const o=this.fetch(e,t,!0);return this.promiseMap[n]=o,o.then((()=>{}))}return Promise.resolve(void 0)}TEST_ONLY__setData(e,t){const n=this.keyFn(e);this.promiseMap[n]=Promise.resolve(t),this.store.state.dataMap[n]=t,this.store.emit()}TEST_ONLY__addListener(e){this.store.addListener(e)}}async function a(e){let{environment:t,namespace:n,key:o,getValue:r,forceRefetch:a}=e;const s=t.currentUser.id,l=`{${n}}:${o}`;a&&i.Z.set({userId:t.currentUser.id,key:l,value:null});const c=i.Z.get({userId:s,key:l});if(c)return c;const d=await r();return i.Z.set({userId:t.currentUser.id,key:l,value:d}),d??void 0}},83279:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isLoading:!1,progressPercent:0}}}const r=i},69316:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1,findQuery:"",focused:!1,currentFocusedResult:void 0,shouldSelectAllInput:!1,showReplaceInput:!1}}isOpen(){return this.state.open}hasFindQuery(){return this.state.findQuery.length>0}isFocused(){return this.state.focused}}const r=new i},89256:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},21051:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(8297).Z)},17903:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(92595);const i=new(n(45589).Z);(0,o.exposeDebugValue)("FrameScrollerStore",i);const r=i},46735:(e,t,n)=>{n.d(t,{Z:()=>c});var o=n(50475),i=n(92595),r=n(83105),a=n(80444);const s=new class{constructor(){this.frecencyStore=void 0,this.spaceId=void 0,this.userId=void 0}get(e){const{currentSpaceStore:t}=a.default.state,n=t&&t.id;return void 0===n||void 0===e?(this.userId=void 0,this.spaceId=void 0,void(this.frecencyStore=void 0)):(this.spaceId===n&&this.userId===e||(this.spaceId=n,this.userId=e,this.frecencyStore=new r._R({store:localStorage,prefix:`BlockFrecency:${e}:${n}`,maxBlocks:100,maxStoredVisits:10,version:r.uP}),this.frecencyStore.initialize()),this.frecencyStore)}};const l={lazyFrecencyStore:s,recordVisit:function(e){const{id:t,type:n,timestampForTestingOnly:i,currentUserId:r,systemBlockType:a}=e;if((0,o.EW)(a))return;const l=s.get(r);return l?l.recordVisit({id:t,type:n,timestampForTestingOnly:i}):void 0},sortFrecencyHighToLow:function(e){const{currentUserId:t,items:n,now:o,recordFrecency:i}=e,r=s.get(t);return r?r.sortFrecencyHighToLow({items:n,now:o,recordFrecency:i}):n},getVisitedIds:function(e){const t=s.get(e);return t?t.getVisitedIds():[]},clearForUser:function(e){for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t);n&&n.startsWith(`BlockFrecency:${e}`)&&localStorage.removeItem(n)}}};(0,i.exposeDebugValue)("FrecencyStore",l);const c=l},38302:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{isOpen:!1,backgroundAnimationComplete:!0,fullscreenNodeAnimationComplete:!0,startScrollTop:0,skipAnimations:!1,isSaving:!1,zoomScale:1,panStartPosition:{x:0,y:0},panOffset:{x:0,y:0}}}}const a=new r;(0,i.exposeDebugValue)("GlobalFullScreenStore",a);const s=a},81258:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},73796:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},27411:(e,t,n)=>{n.r(t),n.d(t,{GlobalFileUploadStore:()=>i,default:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}getKeyState(e){return this.state[e]}setKeyState(e,t){const n=this.state;let o;if(t){var i;const a=t.file.type.indexOf("image")>=0;var r;if(t.file!==(null===(i=n[e])||void 0===i?void 0:i.file)&&a)o=null===(r=n[e])||void 0===r?void 0:r.dataURL,t.dataURL=URL.createObjectURL(t.file);n[e]={...t,dataURL:t.dataURL}}else{var a;o=null===(a=n[e])||void 0===a?void 0:a.dataURL,delete n[e]}if(o){const e=o;setTimeout((()=>{URL.revokeObjectURL(e)}),1e3)}this.emit()}isUploading(){const e=this.state,t=Object.keys(e);for(const n of t){if(e[n])return!0}return!1}getBlockKey(e){return e}}const r=new i},96049:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(14577),i=n(55367),r=n(80796),a=n(69784),s=n(59238);const l=new o.Z((()=>r.Z.state.isDragging||i.ZP.state.isDragging||s.Z.state.isDragging||a.default.state.isActive),{debugName:"GlobalIsDraggingStore"})},45483:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{openModals:new Set}}}const a=new r,s=a;(0,i.exposeDebugValue)("GlobalModalStore",a)},3418:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{openPopups:new Set,namedOpenPopups:new Set}}hasOpenPopups(){const{openPopups:e,namedOpenPopups:t}=this.getState();return e.size>0||t.size>0}hasOpenMobileSlideUps(){const{openPopups:e,namedOpenPopups:t}=this.getState();if(t.size>0)return!0;for(const n of e){if(n.props.hidesMobileNativeBottomBar)return!0;if(n.isSlideUp(n.props)&&!n.props.preventSlideUpTransition)return!0}return!1}hasOpenMouseCapturePopup(){const{openPopups:e}=this.state;return e.size>0&&Array.from(e.values()).some((e=>!e.props.disableMouseCapture))}closeAll(){for(const n of this.state.openPopups){var e,t;null===(e=(t=n.props).onDismiss)||void 0===e||e.call(t,null)}}addNamedPopup(e){this.state.namedOpenPopups.add(e),this.emit()}removeNamedPopup(e){this.state.namedOpenPopups.delete(e),this.emit()}}const r=new i},69327:(e,t,n)=>{n.d(t,{Z:()=>f});var o=n(18466),i=n(49085),r=n(44615),a=n(21202),s=n(53965),l=n(19584),c=n(15447),d=n(2688),u=n(80444),p=n(6258);class m extends i.default{constructor(){super(...arguments),this.userPageVisitListenerReference=void 0,this.recentPageRefreshTimer=void 0,this.isInitialized=!1,this.reinitializeState=async(e,t,n)=>{this.cleanup(e),await(0,c.h_)({environment:e,userId:t,spaceId:n}),this.isInitialized=!0;const o=5*l.hM;this.recentPageRefreshTimer=window.setTimeout((()=>{(0,c.h_)({environment:e,userId:t,spaceId:n})}),o),this.userPageVisitListenerReference=d.ZP.addListener((0,r.Ns)(t),s.P2(((e,n)=>(0,c.rw)(t,n)),100),void 0,e)}}getInitialState(){return{recentPages:new Map}}cleanup(e){this.userPageVisitListenerReference&&(d.ZP.removeListener(this.userPageVisitListenerReference,e),this.userPageVisitListenerReference=void 0),this.recentPageRefreshTimer&&(clearTimeout(this.recentPageRefreshTimer),this.recentPageRefreshTimer=void 0)}getRecentPagesWithStores(e,t){const n=u.default.state.currentSpaceStore;return n?t.map((t=>({...t,store:p.G.createChildStore(n.getPagesStore(),{table:a.iU,id:t.pageId,spaceId:e})}))):[]}set(e,t){const n=this.getRecentPagesWithStores(e,t);this.update((t=>(t.recentPages.set(e,n),t))),this.emit()}get(e){return this.state.recentPages.get(e)}getWithoutSubscribing(e){return o.Z.withListenerIgnored((()=>this.get(e)))||[]}mergeRecentPages(e,t){const n=this.getRecentPagesWithStores(t,e),o=(this.state.recentPages.get(t)??[]).concat(n),i=s.mN(o,"pageId");this.set(t,i)}}const f=new m},7844:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},475:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},52689:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(54153);const r="currentHighlightColor";class a extends o.default{getInitialState(){return{color:Boolean(localStorage)&&i.Z.get(r)||"yellow_background"}}setHighlightColor(e){i.Z.set(r,e),this.setState({color:e})}}const s=new a},42653:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isPinned:!1}}}const r=new i},20144:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}}const r=new i},65686:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(34859);class r extends o.default{getInitialState(){return{capturingAreas:new Set}}getPreventScrollType(){let e=!1,t=!1,n=!1;return this.state.capturingAreas.forEach((o=>{o.preventType===i.Z.All?e=!0:o.preventType===i.Z.X?t=!0:o.preventType===i.Z.Y&&(n=!0)})),e||t&&n?i.Z.All:t?i.Z.X:n?i.Z.Y:i.Z.None}}const a=new r},41577:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{loaded:!1,error:!1}}}const r=i},64424:(e,t,n)=>{n.d(t,{Z:()=>c});var o=n(49085),i=n(18970),r=n(1898),a=n(77907),s=n(85529);class l extends o.default{getInitialState(){return{open:!1}}openModal(e){const{originalSource:t,blockStore:n}=e,o="uploading"===s.Z.getStatus(n.id)&&s.Z.getMetadataByBlockId(n.id)||{...i.Wm,...n.getImageEditMetadata()};this.setState({open:!0,blockStore:n,originalSource:t,editMetadata:o,isImageLoaded:!1,saveButtonLoading:!1,imageRef:void 0,cropAspect:"Circle"===o.mask?1:void 0,fixedAspectSelection:void 0,aspectSelectionFlipped:!1})}setSaveButtonLoading(e){this.state.open&&this.setState({...this.state,saveButtonLoading:e})}closeModal(e){var t;null==e||null===(t=e.onClose)||void 0===t||t.call(e),this.setState({open:!1})}getEditMetadata(){return this.state.open&&this.state.editMetadata||i.Wm}getIsImageLoaded(){return!!this.state.open&&this.state.isImageLoaded}setIsImageLoaded(e){this.state.open&&this.setState({...this.state,isImageLoaded:!0,imageRef:e})}setCrop(e){if(this.state.open){const t={...this.state.editMetadata,crop:e};this.setState({...this.state,editMetadata:t})}}setMask(e){if(this.state.open)switch(this.setState({...this.state,fixedAspectSelection:void 0,aspectSelectionFlipped:!1}),e){case"None":return void this.setFreeform();case"Circle":return void this.setCircleMask();default:(0,r.t1)(e)}}async setFixedAspectRatio(e,t){if(!this.state.open)return;const{width:n,height:o}=i.V3[e],r=t?o/n:n/o,a=this.state.editMetadata,s=await this.getAspectCrop(a,r);s&&this.setState({...this.state,cropAspect:r,editMetadata:{...a,crop:s,mask:"None"},fixedAspectSelection:e,aspectSelectionFlipped:t})}setFreeform(){if(!this.state.open)return;const e=this.state.editMetadata;this.setState({...this.state,cropAspect:void 0,editMetadata:{...e,mask:"None"}})}async setCircleMask(){if(!this.state.open)return;const e=this.state.editMetadata,t=await this.getAspectCrop(e,1);t&&this.setState({...this.state,cropAspect:1,editMetadata:{crop:t,mask:"Circle"}})}async getAspectCrop(e,t){if(this.state.open){var n;const o=null===(n=this.state.imageRef)||void 0===n?void 0:n.current,i=null==e?void 0:e.crop;if(!o||!i)return;const{makeAspectCrop:r}=await a.deps.imageEdit.loader();return r(i,t,o.width,o.height)}}}const c=new l},85529:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{images:{}}}getMetadataByBlockId(e){if(!this.hasKey(e))return;return this.state.images[e].editMetadata}setStatusPending(e,t){const n={editMetadata:t,editStatus:"pending"};this.setState({images:{...this.state.images,[e]:n}})}getStatus(e){if(!this.hasKey(e))return"completed";return this.state.images[e].editStatus}setStatusDrawing(e){if(!this.hasKey(e))return;const t={...this.state.images[e],editStatus:"drawing"};this.setState({images:{...this.state.images,[e]:t}})}setStatusUploading(e,t){if(!this.hasKey(e))return;const n={...this.state.images[e],editStatus:"uploading",dataURL:t};this.setState({images:{...this.state.images,[e]:n}})}setStatusCompleted(e){if(!this.hasKey(e))return;const t=this.state.images[e];if("uploading"!==t.editStatus)return;const n={...t,editStatus:"completed"};this.setState({images:{...this.state.images,[e]:n}})}setStatusError(e){if(!this.hasKey(e))return!1;const t={...this.state.images[e],editStatus:"error"};this.setState({images:{...this.state.images,[e]:t}})}getDataURL(e){if(!this.hasKey(e))return;const t=this.state.images[e];return"uploading"===t.editStatus||"completed"===t.editStatus?t.dataURL:void 0}hasKey(e){return this.state.images.hasOwnProperty(e)}}const r=new i},94416:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},95424:(e,t,n)=>{n.d(t,{H:()=>a});var o=n(92595),i=n(54153),r=n(19584);class a{static getNumber(e){const t=i.Z.get(e);if("number"==typeof t&&!isNaN(t))return t}static getLatest(){return this.getNumber(this.LAST_TIMEOUT_STORAGE_KEY)}static trackPersistently(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();i.Z.set(this.LAST_TIMEOUT_STORAGE_KEY,e);const t=this.getTotal()??0;i.Z.set(this.TOTAL_TIMEOUTS_STORAGE_KEY,t+1)}static getTotal(){return this.getNumber(this.TOTAL_TIMEOUTS_STORAGE_KEY)}static clear(){i.Z.remove(this.LAST_TIMEOUT_STORAGE_KEY),i.Z.remove(this.TOTAL_TIMEOUTS_STORAGE_KEY)}static hasOccurredRecently(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();const t=this.getLatest();return"number"==typeof t&&e-t<this.RECENT_TIME_WINDOW_MS}}a.LAST_TIMEOUT_STORAGE_KEY="latestNotionTransactionTimeout",a.TOTAL_TIMEOUTS_STORAGE_KEY="totalNotionTransactionTimeouts",a.RECENT_TIME_WINDOW_MS=7*r.A0,(0,o.exposeDebugValue)("IndexedDBTimeoutTracker",a)},96826:(e,t,n)=>{n.d(t,{Z:()=>k});var o,i=n(54064),r=n(68626),a=n(606),s=n(12139),l=n(53965),c=n(52629),d=n(37850),u=n(19584),p=(n(95477),n(21830)),m=n(15517),f=n(2414),g=n(63037),h=n(88632),v=n(77080),b=n(99757),y=n(26634),_=n(9425);class S{constructor(e){this.debug=!1,this.shouldStopLooping=!1,this.attemptedToClaimSessions=!1,this.isProcessingTask=!1,this.lastTaskTimestamp=0,this.events=new i.Z,this.waiter=void 0,this.transactionBackoffController=new f.h(y._W),this.retryReasonCounters={_total:0},this.errorCounts={},this.startTime=Date.now(),this.disableStorageManagerEstimate=!1,this.dependencies=void 0,this.transactionStore=void 0,this.sessionId=void 0,this.debugLogger=void 0,this.enableHeartbeatTimeout=void 0;const{dependencies:t,transactionStore:n,sessionId:o,debugLogger:a,enableHeartbeatTimeout:s}=e;this.dependencies=t,this.transactionStore=n,this.sessionId=o,this.debugLogger=a,this.enableHeartbeatTimeout=s,r.clientLogglyEnvironmentData.idbSessionId=this.sessionId,this.disableStorageManagerEstimate=v.default.checkGate("disable_storage_manager_estimate",!0),this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"createdIndexedDBTransactionQueue",data:{sessionId:this.sessionId}})}startLoop(){setTimeout((()=>{this.heartbeatLoop()}),1),setTimeout((()=>{this.txLoop()}),1),setTimeout((()=>{this.healthcheckLoop()}),1)}stopLoop(){this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"stopLoop",data:{message:"Stopping loop."}}),this.shouldStopLooping=!0}hasAttemptedToClaimSessions(){return this.attemptedToClaimSessions}logEmptyTaskForDebugging(e){this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"logEmptyTaskForDebugging",data:{message:`Task created by ${e} was empty.`}})}async enqueueTask(e){const t=await this.transactionStore.saveTask(this.sessionId,e,this.getIndexedDBTimeoutMs());if(this.lastTaskTimestamp=Math.max(e.timestamp,this.lastTaskTimestamp),t.error)throw this.incrementErrors(t.error,"enqueueTask"),this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"enqueueTask",error:(0,c.Ui)(t.error)}),t.error;this.clearErrors("enqueueTask"),this.getWaitable(!1).trigger()}unpause(){this.transactionBackoffController.reset(),this.getWaitable(!1).trigger()}pause(){}getLastTaskTimestamp(){return this.lastTaskTimestamp}hasTasks(){return!!this.transactionStore&&this.transactionStore.hasTasks()}async hasTasksForUser(e){const t=await this.transactionStore.hasTasksForUser(e,this.getIndexedDBTimeoutMs());return t.error?(this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.hasTasksForUser",error:(0,c.Ui)(t.error)}),!1):t.value}async anySessionHasTasks(){const e=await this.transactionStore.anySessionHasTasks(this.getIndexedDBTimeoutMs());return e.error?(this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.anySessionHasTasks",error:(0,c.Ui)(e.error)}),!1):e.value}async drain(){return this.hasTasks()||this.isProcessingTask?new Promise((e=>{this.events.addOnceListener("drain",e)})):void 0}async awaitRecordTransaction(e){this.isPendingTransactionForRecord(e)&&await this.drain()}isPendingTransactionForRecord(e){return this.hasTask((t=>t.operations.some((t=>(0,a.qo)(t.pointer,e)))))}async reset(){await this.transactionStore.reset()}async clearForUser(e){await this.transactionStore.clearTasksForUser(e)}async checkObjectStores(){return await this.transactionStore.checkObjectStores()}async getTotalNumberOfTasks(){const e=await this.transactionStore.getTotalNumberOfTasks(this.getIndexedDBTimeoutMs());return e.error?(r.log({level:"error",from:"IndexedDBTransactionQueue",type:"getTotalNumberOfTasks",error:(0,c.Ui)(e.error)}),0):e.value}startSyncing(){h.Z.setState({...h.Z.state,syncing:!0})}updateDependencies(e){this.dependencies=e}DEV_ONLY_deadlockDb(e){return this.transactionStore.DEV_ONLY_deadlockDb(e)}debugLog(){if(this.debug){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log("IndexedDBTransactionQueue:",...t)}}async wait(e,t){await this.getWaitable(!1).wait(e,t),this.getWaitable(!0)}async txLoop(){for(;!this.shouldStopLooping;)try{await this.txLoopIteration(),this.clearErrors("txLoop")}catch(e){this.incrementErrors(e,"txLoop"),(0,g.Os)(this.retryReasonCounters,"txLoopException"),this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"txLoopIteration",error:(0,c.Ui)(e)}),s.IE(e),await d.Vs(15e3)}}async txLoopIteration(){const e=await this.getTasks();if(!e)return this.events.emit("drain"),void(await this.wait(...this.getMinMaxLoopDelay(!1)));const{tasks:t,sessionId:n}=e;if(0===t.length){const e=await this.transactionStore.deleteSession({currentSessionId:this.sessionId,sessionId:n});return void(e.error&&(this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.deleteSession",data:{sessionId:n},error:(0,c.Ui)(e.error)})))}this.startSyncing(),this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"handleSubmitTransactionAttempt",data:{message:`for session ${n}: attempt submitTransaction with ${t.length} tasks`,sessionId:n,taskIds:w(t)}}),await this.useSaveTransactionsApi(t,n);const o=this.hasTasks();o||(this.doneSyncing(),this.events.emit("drain")),await this.wait(...this.getMinMaxLoopDelay(o))}getMinMaxLoopDelay(e){const[t,n]=(0,_.Z)()?[g.xd,g.CE]:[g.V_,g.Ud];return Boolean(e)?[t,t]:[t,n]}async useSaveTransactionsApi(e,t){const n=await this.dependencies.handleSaveTransactions(e);if(n.error){const{savedTasks:e,failedTasks:o,message:i,retryDelay:a,retryReason:s}=n.error;s?(0,g.Os)(this.retryReasonCounters,s):this.retryReasonCounters={_total:0},e.length>0&&(this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"handlePartialSaveTransactionsSuccess",data:{message:`for session ${t}: will delete ${e.length} saved tasks`,taskIds:w(e),sessionId:t}}),await this.cleanupTasks(e,void 0)),o.length>0?(this.debugLogger.flush(),r.log({level:"warning",from:"IndexedDBTransactionQueue",type:"handleSaveTransactionsError",data:{message:`for session ${t}: ${i}`,taskIds:w(o),sessionId:t},error:(0,c.Ui)(n.error)}),await this.cleanupTasks(o,n.error)):this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"handleSaveTransactionsRetryableError",data:{message:`for session ${t}: ${i}`,sessionId:t}}),a>0?await this.transactionBackoffController.backOffOnFailure(a-g.V_,n.error.retryReason):this.transactionBackoffController.reset()}else{const e=n.value;this.retryReasonCounters={_total:0},this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"handleSaveTransactionsSuccess",data:{message:`for session ${t}: will delete ${e.length} saved tasks`,taskIds:w(e),sessionId:t}}),await this.cleanupTasks(e,void 0),this.transactionBackoffController.reset()}}incrementErrors(e,t){this.debugLog("incrementErrors",e,t),void 0===this.errorCounts[t]?this.errorCounts[t]=1:this.errorCounts[t]+=1;const n=l.Fp(Object.values(this.errorCounts))||0;this.errorCounts[t]===S.maxErrors+1&&(this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:`maxErrors.${t}`,error:(0,c.Ui)(e)})),n>S.maxErrors&&b.Z.setState({...b.Z.state,transactionQueueError:e}),e.type===p.vZ&&this.events.emit("timeout")}clearErrors(e){this.errorCounts[e]&&delete this.errorCounts[e];(l.Fp(Object.values(this.errorCounts))||0)<=S.maxErrors&&b.Z.setState({...b.Z.state,transactionQueueError:void 0})}async heartbeatLoop(){for(;!this.shouldStopLooping;)try{await this.heartbeat(),await d.Vs(S.heartbeatInterval)}catch(e){this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"heartbeatLoopIteration",error:(0,c.Ui)(e)}),await d.Vs(S.heartbeatInterval)}}async heartbeat(){const e=this.enableHeartbeatTimeout?this.getIndexedDBTimeoutMs():void 0;{this.debugLog("heartbeat");const t=await this.transactionStore.heartbeat({currentSessionId:this.sessionId,isActive:!0,timeoutMs:e});if(t.error)return this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.heartbeat",error:(0,c.Ui)(t.error)}),void this.incrementErrors(t.error,"heartbeat");this.clearErrors("heartbeat")}{const t=Date.now()-S.claimSessionDelay,n=await this.transactionStore.claimSessions({currentSessionId:this.sessionId,staleSessionTimeoutMs:t,transactionTimeoutMs:e});if(n.error)return this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.claimSessions",error:(0,c.Ui)(n.error)}),void(n.error.type===p.vZ&&this.incrementErrors(n.error,"claimSessions"));this.clearErrors("claimSessions"),this.attemptedToClaimSessions=!0}this.checkStorageQuota()}async checkStorageQuota(){if(this.disableStorageManagerEstimate)return;const e=await(0,m.sK)();e&&(r.clientLogglyEnvironmentData.storageQuotaEstimate=e.quota,r.clientLogglyEnvironmentData.storageUsageEstimate=e.usage,b.Z.setState({...b.Z.state,storageUsageEstimate:e}))}doneSyncing(){h.Z.setState({...h.Z.state,syncing:!1})}hasTask(e){return this.transactionStore.hasTask(e)}async getTasks(){const e="on"===this.dependencies.getExperimentGroup("sort_indexeddb_tasks_by_index"),t=await this.transactionStore.getTasks(this.sessionId,e);if(t.error)throw t.error;return t.value}async cleanupTasks(e,t){for(const i of e)if(i.callback)try{i.callback(t)}catch(o){this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"cleanupTask",data:{taskId:i.id},error:(0,c.Ui)(o)})}const n=await this.transactionStore.deleteTasks(e);n.error&&(this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.deleteTasks",error:(0,c.Ui)(n.error)}))}getWaitable(e){return this.waiter&&!e||(this.waiter=new d.a6),this.waiter}async healthcheckLoop(){for(;!this.shouldStopLooping;){try{var e;const t=await this.transactionStore.getTotalNumberOfTasks(S.defaultIndexedDBTimeoutMs),n={queue_type:"IndexedDBTransactionQueue",uptime:Date.now()-this.startTime,queue_size:t.error?void 0:t.value,error_type:null===(e=t.error)||void 0===e?void 0:e.type,is_considered_online:h.Z.state.online,retry_reasons:this.retryReasonCounters};(n.queue_size&&n.queue_size>S.transactionSizeHealthcheckThreshold||n.error_type)&&(this.debugLogger.flush(),r.log({level:"info",from:"IndexedDBTransactionQueue",type:"transactionSizeHealthcheck",data:{miscDataToConvertToString:n}}),this.dependencies.handleHealthcheck(n))}catch(t){this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"healthcheckLoopIteration",error:(0,c.Ui)(t)}),s.IE(t)}await d.Vs(S.healthcheckInterval)}}getIndexedDBTimeoutMs(){if("on"===this.dependencies.getExperimentGroup("indexeddb-transaction-timeout-v2"))return S.defaultIndexedDBTimeoutMs}}function w(e){return e.map((e=>{var t;return null!==(t=e.debug)&&void 0!==t&&t.userAction?`${e.id} (${e.debug.userAction})`:e.id}))}o=S,S.heartbeatInterval=2.5*u.C0,S.claimSessionDelay=5*o.heartbeatInterval,S.healthcheckInterval=15*u.hM,S.transactionSizeHealthcheckThreshold=1e3,S.defaultIndexedDBTimeoutMs=180*u.C0,S.maxErrors=5;const k=S},50619:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(68626),i=n(82798),r=n(96826),a=n(99757);class s{constructor(e,t){this.activeQueue=void 0,this.inMemoryTransactionQueue=void 0,this.handleIndexedDbTimeout=()=>{const e=(0,i.R9)(this.activeQueue,r.Z);e.hasTasks()||(e.stopLoop(),e.events.removeListener("timeout",this.handleIndexedDbTimeout),a.Z.reset(),this.inMemoryTransactionQueue.startLoop(),this.activeQueue=this.inMemoryTransactionQueue,o.log({level:"warning",from:"IndexedDBWithInMemoryFallbackTransactionQueue",type:"handleIndexedDbTimeout",data:{message:"IndexedDB timeout occurred while the transaction queue is empty. Switching over to InMemoryTransactionQueue."}}))},this.activeQueue=e,this.inMemoryTransactionQueue=t,e.events.addListener("timeout",this.handleIndexedDbTimeout)}startLoop(){this.activeQueue.startLoop()}logEmptyTaskForDebugging(e){var t,n;null===(t=(n=this.activeQueue).logEmptyTaskForDebugging)||void 0===t||t.call(n,e)}enqueueTask(e){return this.activeQueue.enqueueTask(e)}unpause(){this.activeQueue.unpause()}pause(){this.activeQueue.pause()}getLastTaskTimestamp(){return this.activeQueue.getLastTaskTimestamp()}hasTasks(){return this.activeQueue.hasTasks()}anySessionHasTasks(){return this.activeQueue.anySessionHasTasks()}getTotalNumberOfTasks(){return this.activeQueue.getTotalNumberOfTasks()}hasTasksForUser(e){return this.activeQueue.hasTasksForUser(e)}drain(){return this.activeQueue.drain()}awaitRecordTransaction(e){return this.activeQueue.awaitRecordTransaction(e)}isPendingTransactionForRecord(e){return this.activeQueue.isPendingTransactionForRecord(e)}reset(){return this.activeQueue.reset()}clearForUser(e){return this.activeQueue.clearForUser(e)}updateDependencies(e){this.activeQueue.updateDependencies(e),this.inMemoryTransactionQueue!==this.activeQueue&&this.inMemoryTransactionQueue.updateDependencies(e)}getIndexedDBTransactionQueue(){if(this.activeQueue instanceof r.Z)return this.activeQueue}}},64113:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{focused:!1}}}const r=i},48863:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},55899:(e,t,n)=>{n.d(t,{KU:()=>r,ZP:()=>s,fZ:()=>i});var o=n(49085);function i(e){return"existingUser"===e.type}function r(e){return"newUser"===e.type&&"email"!==e.source}class a extends o.default{getInitialState(){return{tokenQuery:"",inviteTargets:[]}}}const s=a},21039:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{open:!1,loading:!1,adminTokenError:!1,site:void 0,flowId:void 0,botId:void 0}}}const a=new r,s=a;(0,i.exposeDebugValue)("jiraImportStore",a)},22294:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isEnabled:!0,isKeyboardMode:!1}}setEnabled(e){this.setState({...this.state,isEnabled:e})}setKeyboardMode(e){this.state.isEnabled&&this.setState({isEnabled:!0,isKeyboardMode:e})}}const r=new i},23178:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},23883:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{limitParents:new WeakMap}}setLimitParents(e,t){this.state.limitParents.set(e,t),this.emit()}removeLimitParents(e){this.state.limitParents.delete(e),this.emit()}}const r=new i},31104:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},37598:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}getEditedBlocksForCollection(e){const t=this.state[e];if(t)return t;{const t=new Set;return this.state[e]=t,t}}setEditedBlock(e,t){this.getEditedBlocksForCollection(e).add(t),this.emit()}}const r=new i},84166:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{}const r=new i},91390:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isActive:!1}}}const r=new i},19111:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(72087);class r extends o.default{getInitialState(){return{open:!1,sessionId:void 0,userRequestStore:new i.Z,botRequestStore:new i.Z,pageRequestStore:new i.Z,mentionTypes:{page:!1,heading:!1,createPage:!1,user:!1,inviteUserToWorkspace:!1,inviteUserToPage:!1,bot:!1,date:!1,reminder:!1,templateVariable:!1,group:!1}}}}const a=new r},74510:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{numServerRequests:0,numLocalRequests:0}}}const r=new i},29798:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{focus:{section:void 0,indexLocal:void 0,indexGlobal:void 0,isInitialized:!1}}}setState(e){super.setState({...e,focus:{...e.focus,isInitialized:!0}})}update(e){this.setState(e({...this.state}))}unsetFocus(){this.setState({...this.state,focus:{section:void 0,indexLocal:void 0,indexGlobal:void 0}})}}const r=i},69454:(e,t,n)=>{n.d(t,{Z:()=>c,i:()=>s});var o=n(49085),i=n(53965),r=n(5162),a=n(3418);let s=function(e){return e[e.willHide=0]="willHide",e[e.hidden=1]="hidden",e[e.willShow=2]="willShow",e[e.shown=3]="shown",e}({});class l extends o.default{constructor(){var e;super(...arguments),e=this,this.updateKeyboardPhaseDebounced=i.Ds(((e,t)=>{this.setState({...this.state,phase:e,estimatedKeyboardWebViewOverlap:t})}),300),this.updateKeyboardPhase=(e,t,n)=>{if(!(0,r.Y)("supportsAlwaysMultiTextSelectionBehavior")){const{device:o,RouterStore:i}=e,r="page"===i.state.route.name,a=o.isAndroid&&o.isMobileNative;if(r&&a)return void this.updateKeyboardPhaseDebounced(t,n)}this.setState({...this.state,phase:t,estimatedKeyboardWebViewOverlap:n})},this.updateShouldResizeWebview=function(t,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"v2";const{mobileNative:i}=t;switch(o){case"v1":const t=null==i?void 0:i.api.setShouldResizeWebView;t&&t(n);break;case"v2":const o=null==i?void 0:i.api.setShouldResizeWebViewV2;(0,r.Y)("supportsWebViewResizingOnSelection")&&o&&(e.setState({...e.state,shouldResizeWebView:n}),o(n).then((t=>{t.length>0&&e.setState({...e.state,shouldResizeWebView:t[0]})})))}},this.mobileNativeBottomPadding=e=>this.estimatedNativeWebBottomOverlapInternal(e),this.estimatedNativeWebBottomOverlap=()=>this.estimatedNativeWebBottomOverlapInternal(void 0),this.estimatedNativeWebBottomOverlapInternal=e=>{const t=(null==e?void 0:e.WindowSizeStore.state.paddingBottom)??0;if((0,r.Y)("supportsNativeBottomBarOverlappingWebView")){const n=a.Z.hasOpenMobileSlideUps()?t:t+48;return Math.max(this.estimatedKeyboardWebViewOverlap(e),n)}return this.estimatedKeyboardWebViewOverlap(e)},this.estimatedKeyboardWebViewOverlap=e=>{let t;return t=(0,r.Y)("supportsFixedSizeWebView")?(0,r.Y)("supportsWebViewResizingOnSelection")&&this.state.shouldResizeWebView?0:this.state.estimatedKeyboardWebViewOverlap:0,t>0?t:(null==e?void 0:e.WindowSizeStore.state.paddingBottom)??0}}getInitialState(){return{phase:s.hidden,estimatedKeyboardWebViewOverlap:0,shouldResizeWebView:!1}}async onShow(e){await this.waitUntil((()=>this.state.phase===s.shown)),e()}async onHide(e){await this.waitUntil((()=>this.state.phase===s.hidden)),e()}}const c=new l},17294:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}}const r=new i},42330:(e,t,n)=>{n.d(t,{ZP:()=>s,o1:()=>i,rJ:()=>a});var o=n(49085);const i=["page","space","team","space-private-pages"];class r extends o.default{getInitialState(){return{isOpen:!1,lastPageId:void 0}}getVariant(){if(this.state.isOpen)return this.state.variant}getTargetsDatabaseType(){if(this.state.isOpen)return a(this.state.targets)}}function a(e){var t;if(0===e.length)return;const n=null===(t=e[0].getAssociatedCollectionStore())||void 0===t?void 0:t.getDatabaseType();if(n){for(const t of e){var o;if(n!==(null===(o=t.getAssociatedCollectionStore())||void 0===o?void 0:o.getDatabaseType()))return}return n}}const s=new r},53730:(e,t,n)=>{n.r(t),n.d(t,{TEST_ONLY__setTransactionQueue:()=>oe,isIndexedDbGracefulFallbackToInMemoryEnabled:()=>X,setupTransactionQueue:()=>ne,transactionQueue:()=>te});n(57658),n(21703);var o=n(36769),i=n(68626),r=n(57347),a=n(53965),s=n(52629),l=n(37850),c=n(7032),d=n(19584),u=n(482),p=n(1898),m=n(99757),f=n(21830);const g="Transaction",h="bySessionId",v="byTimestamp",b="byId",y="byUserId",_="Session",S="bySessionId",w="byUpdatedAt",k="byOwnerSessionId";const I=45*d.C0;class C{constructor(e,t){this.db=void 0,this.debugLogger=void 0,this.runOptimizedScans=!0,this.activeTasks=new Map,this.ownedSessionIds=new Set,this.db=new f.pz(t,"TransactionStore",2,{upgrade(e,t,n,o){if(t<1&&function(e){const t=e.createObjectStore(_,{keyPath:p.MN("index"),autoIncrement:!0});t.createIndex(w,p.MN("updatedAt"),{unique:!1}),t.createIndex(k,p.MN("ownerSessionId"),{unique:!1}),t.createIndex(S,p.MN("sessionId"),{unique:!0});const n=e.createObjectStore(g,{keyPath:p.MN("index"),autoIncrement:!0});n.createIndex(v,p.MN("timestamp"),{unique:!1}),n.createIndex(h,[p.MN("sessionId"),p.MN("timestamp")],{unique:!1}),n.createIndex(b,p.MN("id"),{unique:!0})}(e),t<2){o.objectStore(g).createIndex(y,p.MN("userId"))}}}),this.debugLogger=e,this.runOptimizedScans=!t.device.isEdgeHTML}async DEV_ONLY_deadlockDb(e){throw new Error("This function is only available in development builds.")}async heartbeat(e){const{currentSessionId:t,isActive:n,timeoutMs:o}=e,r=n?[_,g]:[_],a=await this.db.startTransaction({storeNames:r,mode:"readwrite",name:"IndexedDBTransactionStore.heartbeat",timeoutMs:o},(async(e,o)=>{const r=new Set,a=e.objectStore(_);let l=await a.index(k).openCursor(t);o("Obtained session cursor.");let c=0;for(;l;){c+=1;const e=l.value;e.sessionId!==t&&r.add(e.sessionId);const n={...e,updatedAt:Date.now()};l.update(n),l=await l.continue()}if(o(`Finished processing ${c} sessions.`),n){const t=e.objectStore(g).index(b),n=Date.now()-I;o(`Processing ${this.activeTasks.size} active tasks.`),this.activeTasks.forEach((async e=>{if(e.timestamp>=n)return;if(!(await t.get(e.id))){if(e.callback)try{e.callback(void 0)}catch(o){this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionStore",type:"activeTaskGarbageCollectCleanupError",error:(0,s.Ui)(o)})}this.debugLogger.flush(),i.log({level:"warning",from:"IndexedDBTransactionStore",type:"activeTaskGarbageCollect",data:{miscDataToConvertToString:{task:e,expireTime:n}}}),this.activeTasks.delete(e.id)}}))}return{value:r}}));return a.error?a:(this.ownedSessionIds=a.value,{value:void 0})}async claimSessions(e){const{currentSessionId:t,staleSessionTimeoutMs:n,transactionTimeoutMs:o}=e,i=await this.db.startTransaction({storeNames:[_],mode:"readwrite",name:"IndexedDBTransactionStore.claimSessions",timeoutMs:o},(async(e,o)=>{const i=[],r=e.objectStore(_);let a=await r.index(w).openCursor(IDBKeyRange.upperBound(n));for(o("Obtained session cursor.");a;){const e=a.value,n={...e,ownerSessionId:t,updatedAt:Date.now()};i.push(e.sessionId),o(`Taking ownership of session ${e.sessionId}.`);const r=Date.now()-e.updatedAt;this.debugLogger.log({from:"IndexedDBTransactionStore",level:"debug",type:"claimSession",data:{message:`claimed ${e.sessionId} updated ${r}ms ago`,sessionId:e.sessionId,sinceLastUpdate:r}}),a.update(n),a=await a.continue()}return{value:i}}));if(i.error)return i;for(const r of i.value)this.ownedSessionIds.add(r);return{value:void 0}}getTasks(e,t){return this.db.startTransaction({storeNames:[_,g],mode:"readonly",name:"IndexedDBTransactionStore.getTasks",timeoutMs:void 0},(async(n,o)=>{let i;const r=[],a=n.objectStore(_);let s=await a.index(k).openCursor(e);for(o("Obtained session cursor.");s;){const e=s.value;r.push(e),s=await s.continue()}if(o(`Found ${r.length} owned sessions.`),0===r.length)return{value:void 0};r.sort(((e,t)=>e.index-t.index));const l=r[0].sessionId,c=[];let d=await this.createTransactionCursor(n,l);for(;d;){const e=d.value;(0,u.dj)(e.operations);const t=this.activeTasks.get(e.id);e.sessionId===l&&c.push({...e,callback:t&&t.callback}),d=await d.continue()}return o(`Found ${c.length} tasks.`),i={sessionId:l,tasks:c},t?i.tasks.sort(((e,t)=>e.index&&t.index?e.index-t.index:e.timestamp-t.timestamp)):i.tasks.sort(((e,t)=>e.timestamp-t.timestamp)),{value:i}}))}saveTask(e,t,n){const o={id:t.id,userId:t.userId,spaceId:t.spaceId,sessionId:e,timestamp:t.timestamp,debug:t.debug,operations:t.operations,useSudoMode:t.useSudoMode};return m.Z.setOrIncTotal(this.activeTasks.size+1),this.activeTasks.set(o.id,t),this.db.startTransaction({storeNames:[_,g],mode:"readwrite",name:"IndexedDBTransactionStore.saveTask",timeoutMs:n},(async(t,n)=>{const i=t.objectStore(_),a=await i.index(S).get(e);if(n("Obtained session cursor."),!a){const t={sessionId:e,updatedAt:Date.now(),ownerSessionId:e};n(`Adding session ${t.sessionId}.`);try{await i.add(t)}catch(s){throw(0,f.XH)((0,r.t)(s),`session ${t.sessionId}`)}}try{await t.objectStore(g).add(o)}catch(s){throw(0,f.XH)((0,r.t)(s),`task ${o.id}`)}return this.debugLogger.log({from:"IndexedDBTransactionStore",type:"saveTask",level:"debug",data:{message:`create task ${o.id} in ${a?"existing":"NEW"} session ${e}`,sessionId:e,taskId:o.id,isNewSession:!Boolean(a)}}),{value:void 0}}))}async deleteSession(e){const{currentSessionId:t,sessionId:n}=e,o=await this.db.startTransaction({storeNames:[_,g],mode:"readwrite",name:"IndexedDBTransactionStore.deleteSession",timeoutMs:void 0},(async(e,o)=>{let i=await this.createTransactionCursor(e,n);for(o("Obtained transaction cursor.");i;){if(i.value.sessionId===n)return{value:`Attempt to delete non-empty session: has task ${i.value.id}`,abort:!0};i=await i.continue()}const r=e.objectStore(_),a=await r.index(S).get(n);if(!a)return{value:"Session is missing",abort:!0};const s=a;return s.ownerSessionId!==t?{value:`Attempt to delete another tab's session: owned by ${s.ownerSessionId}`,abort:!0}:(r.delete(s.index),{value:void 0})}));return o.error?o:o.value?{error:{type:"LogicalError",message:o.value,userDetails:"Could not perform an operation due to a logical error."}}:{value:void 0}}hasTasks(){return this.activeTasks.size>0||this.ownedSessionIds.size>0}getTotalNumberOfTasks(e){return this.db.startTransaction({storeNames:[g],mode:"readonly",name:"IndexedDBTransactionStore.getTotalNumberOfTasks",timeoutMs:e},(async e=>{const t=e.objectStore(g);return{value:await t.count()}}))}getTotalNumberOfTasksForUser(e,t){return this.db.startTransaction({storeNames:[g],mode:"readonly",name:"IndexedDBTransactionStore.getTotalNumberOfTasksForUser",timeoutMs:t},(async t=>{const n=t.objectStore(g).index(y);return{value:await n.count(e)}}))}async anySessionHasTasks(e){const t=await this.getTotalNumberOfTasks(e);return t.error?t:{value:t.value>0}}async hasTasksForUser(e,t){const n=await this.getTotalNumberOfTasksForUser(e,t);return n.error?n:{value:n.value>0}}hasTask(e){for(const[,t]of this.activeTasks)if(e(t))return!0;return!1}async deleteTasks(e){const t=await this.db.startTransaction({storeNames:[g,_],mode:"readwrite",name:"IndexedDBTransactionStore.deleteTasks",timeoutMs:void 0},(async(t,n)=>{const o=[],r=[],a=new Set,s=t.objectStore(g),l=s.index(b),c=t.objectStore(_);await(0,f.qv)(e.map((0,f.zp)((async e=>{o.push(e.id);const t=await l.openCursor(e.id);if(n(`Obtained transaction cursor for task ${e.id}.`),t){a.add(t.value.sessionId),await t.delete(),n(`Deleted task ${e.id}.`);const o=String(e.id);this.debugLogger.log({from:"IndexedDBTransactionStore",type:"deleteTasksDeleteTask",level:"debug",data:{message:`delete task ${e.id}`,taskId:o}})}else this.debugLogger.flush(),i.log({from:"IndexedDBTransactionStore",type:"deleteTasksTaskNotExist",level:"warning",data:{message:`could not delete task not stored in indexeddb ${e.id}`,taskId:e.id}})}))));const d=s.index(h);return a.forEach((async e=>{let n=0;if(this.runOptimizedScans)n=await d.count(this.getTransactionRange(e));else{let o=await this.createTransactionCursor(t,e);for(;o;){if(o.value.sessionId===e){n++;break}o=await o.continue()}}if(0===n){const t=await c.index(S).openCursor(e);t&&(r.push(t.value.sessionId),t.delete(),this.debugLogger.log({from:"IndexedDBTransactionStore",type:"deleteTasksDeleteSession",level:"debug",data:{message:`delete empty session ${e}`,sessionId:e}}))}})),{value:{deletedTaskIds:o,deletedSessionIds:r}}}));if(t.error)return t;const{deletedTaskIds:n,deletedSessionIds:o}=t.value;for(const i of n)this.activeTasks.delete(i);for(const i of o)this.ownedSessionIds.delete(i);return m.Z.updateRemaining(this.activeTasks.size),{value:void 0}}async checkObjectStores(){const e="IndexedDBTransactionStore.checkObjectStores",t=this.db.startTransaction({storeNames:["Session"],mode:"readonly",name:`${e}: read from Session object store`,timeoutMs:void 0},(async()=>Promise.resolve({value:"created IndexedDB transaction"}))),n=this.db.startTransaction({storeNames:["Transaction"],mode:"readonly",name:`${e}: read from Transaction object store`,timeoutMs:void 0},(async()=>Promise.resolve({value:"created IndexedDB transaction"}))),[o,i]=await Promise.all([t,n]);return{session:o,transaction:i}}async reset(){await this.db.reset(),this.activeTasks.clear(),this.ownedSessionIds.clear(),m.Z.updateRemaining(0)}async clearTasksForUser(e){const t=await this.db.startTransaction({storeNames:[g],mode:"readwrite",name:"IndexedDBTransactionStore.clearTasksForUser",timeoutMs:void 0},(async(t,n)=>{const o=[],i=t.objectStore(g);let r=await i.index(y).openCursor(IDBKeyRange.only(e));for(n("Obtained transaction cursor.");r;)o.push(r.value.id),await r.delete(),r=await r.continue();return{value:{deletedTaskIds:o}}}));if(t.error)return t;const{deletedTaskIds:n}=t.value;for(const o of n)this.activeTasks.delete(o);m.Z.updateRemaining(this.activeTasks.size)}getTransactionRange(e){return IDBKeyRange.bound([e,0],[e,Number.MAX_VALUE],!0,!0)}createTransactionCursor(e,t){const n=e.objectStore("Transaction");return this.runOptimizedScans?n.index(h).openCursor(this.getTransactionRange(t),"next"):n.openCursor()}}var x=n(15517),T=n(97448),M=n(54064),P=n(606),A=n(12139),R=n(63037),D=n(88632),E=n(26634),B=n(35092),F=n(24681);const O="NativeBackedTransactionQueue";class Z{constructor(e,t,n){this.lastTaskTimestamp=0,this.tasks=new Map,this.sessionId="00000000-0000-0000-0000-000000000000",this.events=new M.Z,this.retryReasonCounters={_total:0},this.startTime=Date.now(),this.debugLogger=new i.BatchedLogger({from:O,type:"BulkDebug",level:"info",maxLength:250}),this.connection=e,this.dependencies=t,i.log({from:O,level:"debug",type:"NativeBackedTransactionQueueCreated"}),n.subscribeToUpdateTransactionState((e=>this.updateTransactionState(e)))}async enqueueTask(e){this.lastTaskTimestamp=Math.max(e.timestamp,this.lastTaskTimestamp);const t=0===this.tasks.size;var n;(this.tasks.set(e.id,{...e,sessionId:this.sessionId}),this.hasTooManyOperations(e))&&i.log({from:O,type:"enqueueTask",level:"warning",data:{message:`enqueing task with operation count > ${Z.operationCountWarningThreshold}`,sessionId:this.sessionId,taskId:e.id,isNewSession:t,userAction:null===(n=e.debug)||void 0===n?void 0:n.userAction,miscDataToConvertToString:{operationsCount:e.operations.length}}});const o=JSON.stringify(e.operations).length;var r;this.stringifiedOperationSizeIsTooLarge(o)&&i.log({from:O,type:"enqueueTask",level:"warning",data:{message:`enqueing task with stringified operation count > ${Z.stringifiedOperationSizeByteThreshold} bytes`,sessionId:this.sessionId,taskId:e.id,isNewSession:t,userAction:null===(r=e.debug)||void 0===r?void 0:r.userAction,miscDataToConvertToString:{operationsCount:e.operations.length,stringifiedOperationsSize:o}}});await async function(e,t){await F.v`
		INSERT OR REPLACE INTO transactions (
		    id,
		    user_id,
		    space_id,
		    operations,
		    timestamp,
			debug
		)
		VALUES (
		    ${t.id},
		    ${t.userId||null},
		    ${t.spaceId||null},
		    ${JSON.stringify(t.operations)},
		    ${t.timestamp},
			${t.debug?JSON.stringify(t.debug):null}
		)
	`.run(e)}(this.connection,e),this.debugLogger.log({from:O,type:"enqueueTask",level:"debug",data:{message:`save task ${e.id} in memory (${this.tasks.size} total now)`,sessionId:this.sessionId,taskId:e.id,isNewSession:t}})}startLoop(){this.dependencies.timeSource.setTimeout((()=>this.healthcheckLoop()),1)}unpause(){}pause(){}getLastTaskTimestamp(){return this.lastTaskTimestamp}hasTasks(){return this.tasks.size>0}async hasTasksForUser(e){const t=await async function(e,t){return(await(0,B.gU)({connection:e,sql:"SELECT COUNT(*) AS count FROM transactions WHERE user_id = ?",args:[t]}))[0].count}(this.connection,e);return t>0}async getTotalNumberOfTasks(){return await async function(e){return(await(0,B.gU)({connection:e,sql:"SELECT COUNT(*) AS count FROM transactions"}))[0].count}(this.connection)}async anySessionHasTasks(){return await this.getTotalNumberOfTasks()>0}async reset(){await async function(e){await F.v`DELETE FROM transactions`.run(e)}(this.connection),this.tasks.clear()}async clearForUser(e){const t=await async function(e,t){const[n]=await(0,B.G$)({connection:e,statements:[{sql:"SELECT * FROM transactions WHERE user_id = ?",args:[t],getData:!0},{sql:"DELETE FROM transactions WHERE user_id = ?",args:[t]}],queryName:"deleteTransactionsForUser"});return n.data.map((e=>e.id))}(this.connection,e);for(const n of t)this.tasks.delete(n)}updateDependencies(e){this.dependencies=e}async awaitRecordTransaction(e){this.isPendingTransactionForRecord(e)&&await this.drain()}isPendingTransactionForRecord(e){return Array.from(this.tasks.values()).some((t=>t.operations.some((t=>(0,P.qo)(t.pointer,e)))))}hasTooManyOperations(e){return e.operations.length>=Z.operationCountWarningThreshold}stringifiedOperationSizeIsTooLarge(e){return e>=Z.stringifiedOperationSizeByteThreshold}async drain(){return this.tasks.size>0?new Promise((e=>{this.events.addOnceListener("drain",e)})):void 0}async healthcheckLoop(){for(;;){try{const e=await this.getTotalNumberOfTasks();e>Z.transactionSizeHealthcheckThreshold&&(this.debugLogger.flush(),i.log({level:"info",from:"NativeBackedSqliteTransactionQueue",type:"transactionSizeHealthcheck",data:{miscDataToConvertToString:{queueSize:e}}}),this.dependencies.handleHealthcheck({queue_type:"NativeBackedSqliteTransactionQueue",uptime:Date.now()-this.startTime,queue_size:e,error_type:void 0,is_considered_online:D.Z.state.online,retry_reasons:this.retryReasonCounters}))}catch(e){this.debugLogger.flush(),i.log({level:"error",from:"NativeBackedSqliteTransactionQueue",type:"healthcheckLoopIteration",error:(0,s.Ui)(e)}),A.IE(e)}await l.Vs(Z.healthcheckInterval,this.dependencies.timeSource)}}updateTransactionState(e){(e.syncing||this.hasTasks())&&D.Z.setState({...D.Z.state,syncing:!0});let t=[],n=[];if(e.saveTransactionResult)if(e.saveTransactionResult.error){const{retryReason:o}=e.saveTransactionResult.error;o?(0,R.Os)(this.retryReasonCounters,o):this.retryReasonCounters={_total:0},t=e.saveTransactionResult.error.savedTasks.map((e=>this.tasks.get(e.id))).filter(p.$K),n=e.saveTransactionResult.error.failedTasks.map((e=>this.tasks.get(e.id))).filter(p.$K),(0,E.o)({backoffEstimate:void 0,retryReason:o})}else this.retryReasonCounters={_total:0},t=e.saveTransactionResult.value.map((e=>this.tasks.get(e.id))).filter(p.$K),n=[],(0,E.Om)();t.forEach((e=>{if(e.callback)try{e.callback(void 0)}catch(t){this.debugLogger.flush(),i.log({level:"error",from:"NativeBackedTransactionQueue",type:"updateTransactionStateSavedTask",data:{taskId:e.id},error:(0,s.Ui)(t)})}this.tasks.delete(e.id)})),n.forEach((e=>{if(e.callback)try{e.callback(new Error(`Failed to save transaction with id: ${e.id}`))}catch(t){this.debugLogger.flush(),i.log({level:"error",from:"NativeBackedTransactionQueue",type:"updateTransactionStateFailedTask",data:{taskId:e.id},error:(0,s.Ui)(t)})}this.tasks.delete(e.id),this.dependencies.rollbackTask(e)})),e.syncing||this.hasTasks()||(D.Z.setState({...D.Z.state,syncing:!1}),this.events.emit("drain"))}}Z.healthcheckInterval=5*d.hM,Z.transactionSizeHealthcheckThreshold=1e3,Z.operationCountWarningThreshold=500,Z.stringifiedOperationSizeByteThreshold=1e5;var V=n(77080),U=n(95424),L=n(82798),j=n(96826);class N{constructor(e,t){this.activeQueue=void 0,this.inMemoryTransactionQueue=void 0,this.indexedDBDrainListener=void 0,this.debugLogger=void 0,this.activeQueue=e,this.inMemoryTransactionQueue=t,this.indexedDBDrainListener=()=>this.handleIndexedDBQueueDrain(),this.debugLogger=new i.BatchedLogger({from:"IndexedDBToInMemoryTransactionQueue",type:"BulkDebug",level:"info",maxLength:250}),setTimeout((()=>{this.activeQueue instanceof j.Z&&(this.debugLogger.log({level:"error",from:"IndexedDBToInMemoryTransactionQueue",type:"constructor",data:{message:"IndexedDBTransactionQueue has not drained after 5 minutes."}}),this.debugLogger.flush())}),5*d.hM)}startLoop(){if(this.activeQueue instanceof j.Z){this.activeQueue.events.addListener("drain",this.indexedDBDrainListener)}this.activeQueue.startLoop()}handleIndexedDBQueueDrain(){const e=(0,L.R9)(this.activeQueue,j.Z);e.hasAttemptedToClaimSessions()&&(e.stopLoop(),e.events.removeListener("drain",this.indexedDBDrainListener),this.inMemoryTransactionQueue.startLoop(),this.activeQueue=this.inMemoryTransactionQueue,this.debugLogger.log({level:"info",from:"IndexedDBToInMemoryTransactionQueue",type:"constructor",data:{message:"Switching over from IndexedDBTransactionQueue to InMemoryTransactionQueue."}}))}logEmptyTaskForDebugging(e){var t,n;null===(t=(n=this.activeQueue).logEmptyTaskForDebugging)||void 0===t||t.call(n,e)}enqueueTask(e){return this.activeQueue.enqueueTask(e)}unpause(){this.activeQueue.unpause()}pause(){this.activeQueue.pause()}getLastTaskTimestamp(){return this.activeQueue.getLastTaskTimestamp()}hasTasks(){return this.activeQueue.hasTasks()}anySessionHasTasks(){return this.activeQueue.anySessionHasTasks()}getTotalNumberOfTasks(){return this.activeQueue.getTotalNumberOfTasks()}hasTasksForUser(e){return this.activeQueue.hasTasksForUser(e)}drain(){return this.activeQueue.drain()}awaitRecordTransaction(e){return this.activeQueue.awaitRecordTransaction(e)}isPendingTransactionForRecord(e){return this.activeQueue.isPendingTransactionForRecord(e)}reset(){return this.activeQueue.reset()}clearForUser(e){return this.activeQueue.clearForUser(e)}updateDependencies(e){this.activeQueue.updateDependencies(e),this.inMemoryTransactionQueue!==this.activeQueue&&this.inMemoryTransactionQueue.updateDependencies(e)}}var z=n(50619),q=n(2414),W=n(9425);const H="InMemoryTransactionQueue";class K{constructor(e){this.isProcessingTask=!1,this.lastTaskTimestamp=0,this.tasks=new Map,this.events=new M.Z,this.waiter=void 0,this.transactionBackoffController=new q.h(E._W),this.sessionId="00000000-0000-0000-0000-000000000000",this.retryReasonCounters={_total:0},this.startTime=Date.now(),this.debugLogger=new i.BatchedLogger({from:H,type:"BulkDebug",level:"info",maxLength:250}),this.dependencies=e}startLoop(){this.dependencies.timeSource.setTimeout((()=>this.txLoop()),1),this.dependencies.timeSource.setTimeout((()=>this.healthcheckLoop()),1)}enqueueTask(e){this.lastTaskTimestamp=Math.max(e.timestamp,this.lastTaskTimestamp);const t=0===this.tasks.size;return this.tasks.set(e.id,{...e,sessionId:this.sessionId}),m.Z.setOrIncTotal(this.tasks.size),this.debugLogger.log({from:H,type:"saveTask",level:"debug",data:{message:`save task ${e.id} in memory (${this.tasks.size} total now)`,sessionId:this.sessionId,taskId:e.id,isNewSession:t}}),this.getWaitable(!1).trigger(),Promise.resolve()}unpause(){this.transactionBackoffController.reset(),this.getWaitable(!1).trigger()}pause(){}getLastTaskTimestamp(){return this.lastTaskTimestamp}hasTasks(){return this.tasks.size>0}async hasTasksForUser(e){return Promise.resolve(Array.from(this.tasks.values()).some((t=>t.userId===e)))}updateDependencies(e){this.dependencies=e}async getTotalNumberOfTasks(){return Promise.resolve(this.tasks.size)}async anySessionHasTasks(){return Promise.resolve(this.hasTasks())}async drain(){return this.hasTasks()||this.isProcessingTask?new Promise((e=>{this.events.addOnceListener("drain",e)})):void 0}async awaitRecordTransaction(e){this.isPendingTransactionForRecord(e)&&await this.drain()}isPendingTransactionForRecord(e){return Array.from(this.tasks.values()).some((t=>t.operations.some((t=>(0,P.qo)(t.pointer,e)))))}async reset(){return this.tasks=new Map,m.Z.updateRemaining(0),Promise.resolve()}async clearForUser(e){const t=Array.from(this.tasks.values()).filter((t=>t.userId===e));for(const n of t)this.tasks.delete(n.id);return m.Z.updateRemaining(this.tasks.size),Promise.resolve()}async txLoop(){for(;;)try{await this.txLoopIteration()}catch(e){(0,R.Os)(this.retryReasonCounters,"txLoopException"),this.debugLogger.flush(),i.log({level:"error",from:H,type:"txLoopIteration",error:(0,s.Ui)(e)}),A.IE(e),await l.Vs(15e3,this.dependencies.timeSource)}}async txLoopIteration(){const e=this.hasTasks();e||(this.doneSyncing(),this.events.emit("drain"));const[t,n]=(0,W.Z)()?[R.xd,R.CE]:[R.V_,R.Ud];await this.wait(t,e?t:n);const o=Array.from(this.tasks.values()),r=Array.from(o).sort(((e,t)=>e.timestamp-t.timestamp));if(0===r.length)return;const a=[];for(let i=0;i<r.length;i++)r[i]!==o[i]&&a.push(i);a.length>0&&i.log({from:H,level:"warning",type:"TasksNotOrdered",data:{miscDataToConvertToString:{unsortedTaskIds:o.map((e=>e.id)),mismatch:a},taskIds:r.map((e=>e.id))}}),this.startSyncing(),await this.useSaveTransactionsApi(r)}async useSaveTransactionsApi(e){const t=await this.dependencies.handleSaveTransactions(e);if(t.error){const{savedTasks:e,failedTasks:o,message:r,retryDelay:a,retryReason:l}=t.error;var n;if(l?(0,R.Os)(this.retryReasonCounters,l):this.retryReasonCounters={_total:0},e.length>0&&(this.debugLogger.log({level:"debug",from:H,type:"handlePartialSaveTransactionsSuccess",data:{message:`will delete ${e.length} saved tasks`,taskIds:e.map((e=>e.id))}}),await this.cleanupTasks(e,void 0)),o.length>0?(this.debugLogger.flush(),i.log({level:"warning",from:H,type:"handleSaveTransactionsError",data:{message:r,taskIds:o.map((e=>e.id))},error:(0,s.Ui)(t.error)}),await this.cleanupTasks(o,t.error)):this.debugLogger.log({level:"debug",from:H,type:"handleSaveTransactionsRetryableError",data:{message:r}}),a>0)await this.transactionBackoffController.backOffOnFailure(a-R.V_,null===(n=t.error)||void 0===n?void 0:n.retryReason);else this.transactionBackoffController.reset()}else{const e=t.value;this.retryReasonCounters={_total:0},this.debugLogger.log({level:"debug",from:H,type:"handleSaveTransactionsSuccess",data:{message:`will clean up ${e.length} submitted tasks`,taskIds:e.map((e=>e.id))}}),this.transactionBackoffController.reset(),await this.cleanupTasks(e,void 0)}}async cleanupTasks(e,t){for(const o of e)if(o.callback)try{o.callback(t)}catch(n){this.debugLogger.flush(),i.log({level:"error",from:"InMemoryTransactionQueue",type:"cleanupTask",data:{taskId:o.id},error:(0,s.Ui)(n)})}for(const o of e)this.debugLogger.log({from:H,type:"deleteTasksDeleteTask",level:"debug",data:{message:`delete task ${o.id}`,taskId:o.id}}),this.tasks.delete(o.id);return m.Z.updateRemaining(this.tasks.size),Promise.resolve()}getWaitable(e){return this.waiter&&!e||(this.waiter=new l.a6(this.dependencies.timeSource)),this.waiter}async wait(e,t){await this.getWaitable(!1).wait(e,t),this.getWaitable(!0)}startSyncing(){D.Z.setState({...D.Z.state,syncing:!0})}doneSyncing(){D.Z.setState({...D.Z.state,syncing:!1})}async healthcheckLoop(){for(;;){try{const e=await this.getTotalNumberOfTasks();if(e>K.transactionSizeHealthcheckThreshold){const t={queue_type:"InMemoryTransactionQueue",uptime:Date.now()-this.startTime,queue_size:e,error_type:void 0,is_considered_online:D.Z.state.online,retry_reasons:this.retryReasonCounters};this.debugLogger.flush(),i.log({level:"info",from:"InMemoryTransactionQueue",type:"transactionSizeHealthcheck",data:{miscDataToConvertToString:{queueSize:e}}}),this.dependencies.handleHealthcheck(t)}}catch(e){this.debugLogger.flush(),i.log({level:"error",from:"InMemoryTransactionQueue",type:"healthcheckLoopIteration",error:(0,s.Ui)(e)}),A.IE(e)}await l.Vs(K.healthcheckInterval,this.dependencies.timeSource)}}}K.healthcheckInterval=15*d.hM,K.transactionSizeHealthcheckThreshold=1e3;const G=K;var $=n(68026);const Q="FeatureFlagTransactionQueue",Y="00000000-0000-0000-0000-000000000000";async function J(e){if(!window.indexedDB)return{available:!1,message:"The IndexedDB API is missing or disabled on this platform."};if(e.device.isFirefox){const e="FirefoxFeatureCheck";if(!(await new Promise((t=>{const n=window.indexedDB.open(e);n.onerror=()=>t(!1),n.onsuccess=()=>{t(!0),window.indexedDB.deleteDatabase(e)}}))))return{available:!1,message:"IndexedDB is disabled in Firefox Private Browsing."}}if(e.device.isChrome&&parseInt(e.device.browserVersion,10)>=99){const e="Chrome99FeatureCheck";let n=!1;try{if(n=await new Promise((t=>{const n=window.indexedDB.open(e);n.onerror=()=>t(!1),n.onsuccess=()=>{t(!0),window.indexedDB.deleteDatabase(e)}})),!n)return{available:!1,message:"IndexedDB is unstable in Chrome 99."}}catch(t){return{available:!1,message:(0,r.t)(t).message}}}return X()&&U.H.hasOccurredRecently()?{available:!1,message:"A NotionTransactionTimeout has happened recently, avoiding use of IndexedDB.",previousTimeouts:U.H.getTotal()}:{available:!0}}const X=a.HP((()=>"on"===(0,T.fastGetGroup)("indexeddb_graceful_fallback_to_in_memory_queue")));async function ee(e){const t=new $.TransactionQueueDependenciesImpl(e);async function n(){const n=await J(e);if(!n.available)return i.log({from:Q,level:"warning",type:"preferIndexedDBUnavailable",data:{previousTimeouts:n.previousTimeouts,miscDataToConvertToString:{message:n.message,userAgent:navigator.userAgent}}}),o();i.log({from:Q,type:"preferIndexedDB",level:"info"});const r=function(e,t){const n="react-native"===e.device.platform?Y:(0,c.ZP)(),o=new i.BatchedLogger({from:"IndexedDBTransactionQueue",type:"BulkDebug",level:"info",maxLength:250}),r=new C(o,e);return new j.Z({dependencies:t,transactionStore:r,sessionId:n,debugLogger:o,enableHeartbeatTimeout:X()})}(e,t),l=await(0,x.sK)();if(l&&!(0,x.mn)(l)){let e=!1;try{e=await r.anySessionHasTasks(),i.log({from:Q,type:"indexedDBStorageVeryFull",level:"warning",data:{storage:{hasTasks:e,...l}}})}catch(d){i.log({from:Q,level:"error",type:"indexedDBStorageReadError",data:{storage:l},error:(0,s.Ui)(d)})}if(!e)return new G(t)}if(e.device.isFirefox)try{const e=await r.checkObjectStores(),n=a.oA([e.transaction,e.session].map((e=>e.error)));if(n.length>0){const o=[];return e.transaction.error&&o.push("Transaction"),e.session.error&&o.push("Session"),i.log({from:Q,level:"error",type:"FirefoxHealthCheckFailed",error:{miscErrorString:(0,s.LK)(n)},data:{message:`Can't read ${o}. Using InMemoryTransactionQueue instead.`}}),new G(t)}}catch(d){return i.log({from:Q,level:"error",type:"indexedDBHealthCheckError",error:(0,s.Ui)(d)}),new G(t)}return X()?(r.events.addListener("timeout",(()=>{U.H.trackPersistently()})),new z.Z(r,new G(t))):r}function o(){return i.log({from:Q,type:"preferInMemory",level:"info"}),new G(t)}const{device:r,mobileNative:u}=e;if(r.isBrowser&&r.isDesktop){if(r.isChrome||r.isFirefox)return n();if(r.isSafari){if(parseInt(r.browserVersion,10)<17)return n();const e=(0,T.fastGetGroup)("safari_17_transaction_queue")??V.default.getGroup("safari_17_transaction_queue");if("force_in_memory"===e)return i.log({from:Q,type:"Safari17.forceInMemoryTransactionQueue",level:"info"}),o();const t=await n();if(t instanceof j.Z){if("prefer_indexed_db"===e)return i.log({from:Q,type:"Safari17.usingIndexedDBTransactionQueue",level:"info"}),t;if((await l.OI(15*d.C0,t.anySessionHasTasks())).result)return i.log({from:Q,type:"Safari17.usingIndexedDBToInMemoryTransactionQueue",level:"info"}),new N(t,o())}return i.log({from:Q,type:"Safari17.usingInMemoryTransactionQueue",level:"info"}),o()}return o()}return r.isBrowser&&r.isMobile?o():r.isElectron?n():r.isMobileNative&&u&&u.sqliteConnection?new Z(u.sqliteConnection,t,u):o()}(0,o.exposeDebugEnvironmentValue)("getIndexedDBAvailability",(e=>()=>J(e)));let te=new class{constructor(e,t){this.getActiveQueueName=void 0,this.queues=void 0,this.createQueues=void 0,this.getActiveQueueName=e,this.createQueues=t}getQueues(){const e=this.queues?this.queues:this.createQueues();return this.queues=e,e}applyToAllQueues(e){return Object.values(this.getQueues()).map(e)}applyToActiveQueue(e){return e(this.getQueues()[this.getActiveQueueName()])}startLoop(){this.applyToAllQueues((e=>e.startLoop()))}enqueueTask(e){return this.applyToActiveQueue((t=>t.enqueueTask(e)))}unpause(){this.applyToAllQueues((e=>e.unpause()))}pause(){this.applyToAllQueues((e=>e.pause()))}getLastTaskTimestamp(){return this.applyToActiveQueue((e=>e.getLastTaskTimestamp()))}hasTasks(){return this.applyToAllQueues((e=>e.hasTasks())).some(Boolean)}async hasTasksForUser(e){return(await Promise.all(this.applyToAllQueues((t=>t.hasTasksForUser(e))))).some((e=>e))}updateDependencies(e){this.applyToAllQueues((t=>t.updateDependencies(e)))}async anySessionHasTasks(){for(const e of this.applyToAllQueues((e=>e.anySessionHasTasks())))if(await e)return!0;return!1}async getTotalNumberOfTasks(){return a.Sm(await Promise.all(this.applyToAllQueues((e=>e.getTotalNumberOfTasks()))))}async drain(){await Promise.all(this.applyToAllQueues((e=>e.drain())))}awaitRecordTransaction(e){return this.applyToActiveQueue((t=>t.awaitRecordTransaction(e)))}isPendingTransactionForRecord(e){return this.applyToAllQueues((t=>t.isPendingTransactionForRecord(e))).some(Boolean)}async reset(){await Promise.all(this.applyToAllQueues((e=>e.reset())))}async clearForUser(e){await Promise.all(this.applyToAllQueues((t=>t.clearForUser(e))))}}((()=>"error"),(()=>{throw new Error("Need to await setupTransactionQueue")}));async function ne(e){return te=await ee(e),te}function oe(e){te=e}},66353:(e,t,n)=>{n.d(t,{Jr:()=>l,ZP:()=>d,j5:()=>a,uZ:()=>r});var o=n(49085),i=n(54153);const r="unread_and_read",a=["unread_and_read","unread_only","archived_only","all_updates"],s={filter:r},l="notification_inbox_panel";const c=o.default.createValue(function(){const e=i.Z.get(l);return{...s,...e}}());c.addListener((e=>{try{t=e.state,i.Z.set(l,t)}catch{}var t}));const d=c},45946:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(53809),i=n(30548);const r=new o.D({key:"openInDesktopApp",namespace:i.$p,important:!0,trackingType:"necessary"})},64970:(e,t,n)=>{n.d(t,{m:()=>o});const o=n(49085).default.createValue(!1)},69254:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(53809),i=n(30548);const r={sortOption:{private:"lastEdited"}};class a extends o.D{setSortOption(e,t){this.setState({sortOption:{...(this.state||r).sortOption,[e]:t}})}getSortOption(e){return(this.state||r).sortOption[e]||"manual"}}const s=new a({key:"OutlinerDropdownMenuStore",namespace:i.$p,important:!0,trackingType:"necessary"})},70704:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isHidden:!1}}}const r=i},79689:(e,t,n)=>{n.d(t,{L:()=>r,c:()=>a});var o=n(49085);const i=new Map;function r(e){const t=i.get(e);if(t)return t;{const t=o.default.createValue(!1);return i.set(e,t),t}}function a(){const e=Array.from(i.entries());return 0===e.length||e.every((e=>!e[1].state))}},19671:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(58484).Z)},93220:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{ready:!1,initialRequestCompleted:!1,loading:!1,endOfResultsReached:!1,error:void 0,currentCursor:void 0,currentChunkNumber:void 0}}}const r=i},80123:(e,t,n)=>{n.d(t,{Y:()=>r,t:()=>a});var o=n(77907);const i={startedNavigatingAt:void 0,navigatingFrom:void 0,navigatingTo:void 0,switchingView:void 0};function r(e,t){i.startedNavigatingAt=Date.now(),e.blockId&&e.blockId&&(i.navigatingFrom=e.collectionViewId?"collection":"page",i.navigatingTo=t.collectionViewId?"collection":"page",i.switchingView=e.blockId===t.blockId&&e.collectionViewId!==t.collectionViewId)}function a(){return{cvb_bundle_loaded:s(),navigating_from:i.navigatingFrom,navigating_to:i.navigatingTo,switching_view:i.switchingView}}function s(){const e=o.deps.CollectionViewBlock.loadingDetails.loadedAt;return!!e&&(i.startedNavigatingAt?i.startedNavigatingAt<e:void 0)}},85526:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{forceShowProperties:!1,searchOpen:!1,searchQuery:""}}}const r=new i},94896:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{pages:new Set}}setStatus(e,t){t?this.state.pages.add(e):this.state.pages.delete(e),this.emit()}}const r=new i},82136:(e,t,n)=>{n.d(t,{S:()=>i,Z:()=>a});var o=n(49085);let i=function(e){return e[e.Frame=0]="Frame",e[e.PeekView=1]="PeekView",e[e.InAppTemplatePreview=2]="InAppTemplatePreview",e[e.InPageSnapShot=3]="InPageSnapShot",e[e.CollectionPageView=4]="CollectionPageView",e}({});class r extends o.default{getInitialState(){return{forceDiscussionOpen:!1}}}const a=r},85844:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isVisible:!0}}}const r=new i},72014:(e,t,n)=>{n.d(t,{$g:()=>a,jx:()=>s});var o=n(49085),i=n(7032);class r extends o.default{getInitialState(){}initializeNewPageVisitId(){this.setState((0,i.ZP)())}getCurrentPageVisitId(){return this.getState()}}const a=new r,s=new r},69503:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1,hasPassword:!1}}isSetNewPasswordModal(){const e=this.state;return!0===e.setNewPassword&&!1===e.isSet}isPasswordSetModal(){const e=this.state;return!0===e.setNewPassword&&!0===e.isSet}isRemovePasswordModal(){const e=this.state;return!0===e.removePassword&&!1===e.isSuccess}isRemovePasswordSuccessModal(){const e=this.state;return!0===e.removePassword&&!0===e.isSuccess}isVerifyIdentityWithMfaModal(){return!0===this.state.verifyIdentity}isPasswordModalClosed(){return!this.state.open}}const r=new i},91551:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(8297).Z)},13023:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(58484).Z)},88923:(e,t,n)=>{n.r(t),n.d(t,{CenterPeekModeOuterWidth:()=>l,PeekModeOuterPadding:()=>s,PeekModePadding:()=>a,default:()=>h,getPeekModeFromCollectionPeekModeFormat:()=>d,getPeekModeFromUrlParam:()=>c,getUrlParamFromPeekMode:()=>u,sidePeekInitialMaxWidth:()=>p,sidePeekMinWidth:()=>f,sidePeekNoColumnWidth:()=>m});var o=n(14577),i=n(49085),r=n(70096);const a={horizontal:{center_peek:126,side_peek:48}},s=72,l=708+2*a.horizontal[r.l];function c(e){switch(e){case"s":return r.R;case"c":return r.l}}function d(e){switch(e){case"side_peek":return r.R;case"center_peek":return r.l}}function u(e){switch(e){case r.R:return"s";case r.l:return"c"}}const p=980,m=640,f=430;class g extends i.default{constructor(){super(...arguments),this.isSidePeekOpening=new o.Z((()=>this.state.open&&this.isSidePeekOpen()&&this.state.isOpening),{debugName:"isSidePeekOpening"}),this.isSidePeekClosing=new o.Z((()=>this.state.open&&this.state.isClosing),{debugName:"isSidePeekClosing"}),this.peekTarget=new o.Z((()=>this.state.open?this.state.target:void 0),{debugName:"peekTarget"})}getInitialState(){return{open:!1,mode:r.l,preferredSidePeekWidth:0,savedSidebarExpandedStoreState:!1}}getCollectionModeFormat(){switch(this.state.mode){case r.R:return"side_peek";case r.l:return"center_peek"}}getPeekMode(){return this.state.open?this.state.mode:r.R}getPeekModeWidth(e){return this.isCenterPeekOpen()?l:this.getSidePeekWidth(e)}getSidePeekWidth(e){const t=Math.min(e/2,p),n=this.state.preferredSidePeekWidth||t;return Math.min(Math.max(n,f),e)}setSidePeekWidth(e,t){const n=Math.min(Math.max(e,f),t);this.setState({...this.state,preferredSidePeekWidth:n})}isCenterPeekOpen(){return this.state.open&&this.state.mode===r.l}isSidePeekOpen(){return this.state.open&&this.state.mode===r.R&&!this.state.isClosing}setSidebarExpandedStoreState(e){this.setState({...this.state,savedSidebarExpandedStoreState:e})}}const h=new g},98452:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},99332:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},24612:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},42057:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(92595),i=n(45589);const r=(0,o.exposeDebugValue)("PeekViewScrollerStore",new i.Z)},29677:(e,t,n)=>{n.d(t,{Db:()=>a,cl:()=>i,fZ:()=>o,ow:()=>r});n(49085),n(21202);function o(e){return"existingUser"===e.type}function i(e){return"newUser"===e.type}function r(e){const t=e.inviteTargets[0];return!(!t||"bot"!==t.type)}function a(e){return e.inviteTargets.every((e=>"existingUser"===e.type||"newUser"===e.type||"group"===e.type))}},31194:(e,t,n)=>{n.d(t,{FJ:()=>m,Iw:()=>u,ZP:()=>g,lU:()=>p});var o=n(49085),i=n(4023),r=n(15723);const{Top:a,Bottom:s,Left:l,Right:c,Center:d}=i.u,u=i.u,p=i.v;function m(e){switch(e){case a:return s;case s:return a;case l:return c;case c:return l;case d:return d}}class f extends o.default{getInitialState(){return{open:!1,placementFlipped:!1,offsetX:0,offsetY:0,originRect:r.bM}}}const g=f},24864:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(70704).Z)},83212:(e,t,n)=>{n.d(t,{Z:()=>l,m:()=>a});var o=n(49085),i=n(72141),r=n(46654);const a={disabled:{hasPublicPermission:!1},view:{hasPublicPermission:!0,permission:"view"},comment:{hasPublicPermission:!0,permission:"comment"},edit:{hasPublicPermission:!0,permission:"edit"}};Object.freeze(a),Object.freeze(a.disabled),Object.freeze(a.view),Object.freeze(a.comment),Object.freeze(a.edit);class s extends o.default{getInitialState(){return{editing:!1,commenting:!1}}getMode(e,t){const n=this.getModeType(e,t)||"disabled";return a[n]}getModeType(e,t){if(!t.isDefaultRecordCache()||!(0,r.IJ)(e,t))return;const n=t.getRole(),o=!n||(0,i.J5)(n),a=!n||(0,i.RF)(n),s=e.currentUser.isLoggedIn();return o&&s&&this.state.editing?"edit":a&&s?"comment":"view"}}const l=new s},81236:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(92595),i=n(51444);const r=new i.q((e=>{let{spaceId:t}=e;return t}),(async function(e,t){let{spaceId:o}=t,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=await Promise.resolve().then(n.bind(n,54642));return(0,i.X)({environment:e,namespace:"PublicSpaceData",key:o,forceRefetch:r,getValue:async()=>{const t=await a.getPublicSpaceData(e,{type:"space-ids",spaceIds:[o]});return"success"===t.type?t.data.results[0]??void 0:void 0}})}));o.exposeDebugValue("PublicSpaceDataStore",r);const a=r},40061:(e,t,n)=>{n.d(t,{Z:()=>d});var o=n(92595),i=n(18201),r=n(80444);const a=new class{constructor(){this.recentlyMentionedPagesStore=void 0,this.spaceId=void 0,this.userId=void 0}get(e){const{currentSpaceStore:t}=r.default.state,n=t&&t.id;return void 0===n||void 0===e?(this.userId=void 0,this.spaceId=void 0,void(this.recentlyMentionedPagesStore=void 0)):(this.spaceId===n&&this.userId===e||(this.spaceId=n,this.userId=e,this.recentlyMentionedPagesStore=new s({maxPages:50,prefix:`RecentlyMentioned:${e}:${n}`,store:localStorage,version:l}),this.recentlyMentionedPagesStore.initialize()),this.recentlyMentionedPagesStore)}};class s{constructor(e){this.mentions=void 0;const{maxPages:t,prefix:n,store:o,version:r}=e;this.mentions=new i.Z({maxSize:t,prefix:n,store:o,version:r})}initialize(){this.mentions.updateVersionAndGC()}recordMention(e,t){this.mentions.set(e,t)}getMentionedIds(){const e=this.mentions.entries();if(e.error)return[];const t=Date.now()-864e5;return Array.from(e.value).filter((e=>{let[n,o]=e;return o>=t})).map((e=>{let[t,n]=e;return t}))}}const l=1,c={lazyRecentlyMentionedPagesStore:a,recordMention:function(e){const{id:t,timestamp:n,currentUserId:o}=e,i=a.get(o);if(i)return i.recordMention(t,n)},getMentionedIds:function(e){const t=a.get(e);return t?t.getMentionedIds():[]}};(0,o.exposeDebugValue)("RecentlyMentionedPagesStore",c);const d=c},69784:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isActive:!1}}}const r=new i},13105:(e,t,n)=>{n.d(t,{P:()=>r});var o=n(14577),i=n(92595);class r{constructor(e){this.memo=new WeakMap,this.debugName=void 0,this.hits=0,this.misses=0,this.getStateFor=e=>this.computeMemo(e),this.computeMemo=e=>{let t=this.memo.get(e);return t?this.hits++:(this.misses++,t=new o.Z((()=>this.options.compute(e,this.options.memoizeRecursion?this.computeMemo:this.computeNonMemo)),{debugName:this.debugName}),this.memo.set(e,t)),t.getState()},this.computeNonMemo=e=>this.options.compute(e,this.computeNonMemo),this.options=e,this.debugName=`RecursiveComputedStore.${e.debugName}`,(0,i.exposeDebugInstance)(this.debugName,this)}}},64951:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}isActive(){return Boolean(this.state.blockStore)}}const r=new i},82187:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}isActive(){return Boolean(this.state.clonedBlockStore)}}const r=new i},72087:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{ready:!1,loading:!1}}}const r=i},91681:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isResizing:!1}}}const r=new i},70354:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u,groupIntervalMs:()=>c});var o=n(49085),i=n(11799),r=n(82798),a=n(53965),s=n(1898);class l{constructor(){this.idMap=new i.Z({getKey:e=>{let{textInstanceId:t,opId:n}=e;return`${t},${n[0]},${n[1]}`}})}remapIdsForReinsertedText(e,t){(0,r.T)(t.args.textInstanceId===e.args.textInstanceId),(0,r.T)(a.Xy(t.args.originId,e.args.originId)),(0,r.T)(t.args.content.length===e.args.deletedIds.length);const n=t.args.id,o=t.args.content;for(let i=0;i<o.length;i++)this.addMapping({textInstanceId:e.args.textInstanceId,opId:e.args.deletedIds[i]},{textInstanceId:t.args.textInstanceId,opId:[n[0],n[1]+i]})}addMapping(e,t){(0,r.T)(!this.idMap.has(e)),(0,r.T)(!this.idMap.has(t)),(0,r.T)(e.textInstanceId===t.textInstanceId,"IDs can only be remapped within the same text instance"),this.idMap.set(e,t)}getMappedId(e){let t,n=e;for(;n=this.idMap.get(n);)t=n;return t}getInvertedTextOperationWithMaybeRemappedIds(e){switch(e.command){case"invertedInsertText":{var t,n;const o=null===(t=this.getMappedId({textInstanceId:e.args.textInstanceId,opId:e.args.startId}))||void 0===t?void 0:t.opId,i=null===(n=this.getMappedId({textInstanceId:e.args.textInstanceId,opId:e.args.endId}))||void 0===n?void 0:n.opId;return o||i?{...e,args:{...e.args,startId:o??e.args.startId,endId:i??e.args.endId}}:e}case"invertedAddAnnotation":case"invertedRemoveAnnotation":{var o,i;const t=null===(o=this.getMappedId({textInstanceId:e.args.startTextInstanceId,opId:e.args.startId}))||void 0===o?void 0:o.opId,n=null===(i=this.getMappedId({textInstanceId:e.args.endTextInstanceId,opId:e.args.endId}))||void 0===i?void 0:i.opId;if("invertedAddAnnotation"===e.command)return t||n?{...e,args:{...e.args,startId:t??e.args.startId,endId:n??e.args.endId}}:e;if("invertedRemoveAnnotation"===e.command)return t||n?{...e,args:{...e.args,startId:t??e.args.startId,endId:n??e.args.endId}}:e;(0,s.t1)(e);break}case"invertedDeleteText":{var r;const t=null===(r=this.getMappedId({textInstanceId:e.args.textInstanceId,opId:e.args.originId}))||void 0===r?void 0:r.opId;return t?{...e,args:{...e.args,originId:t??e.args.originId}}:e}case"invertedMoveTextSlice":return e;default:(0,s.t1)(e)}}}const c=700;class d extends o.default{getInitialState(){return{undoStack:[],redoStack:[],invertedTextOperationIdMapper:new l}}}const u=new d},49557:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{isActive:!1,isAnimatingClosed:!1,top:0,left:0}}}const a=(0,i.exposeDebugValue)("RichTextMenuStore",new r)},4935:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},45589:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isScrolling:!1,scrollTop:0,scrollHeight:0,scrollLeft:0,scrollWidth:0,clientWidth:0}}}const r=i},32470:(e,t,n)=>{n.d(t,{BJ:()=>m,ZP:()=>h,gq:()=>g,lO:()=>f,v_:()=>p});var o=n(49085),i=n(15157),r=n(53772),a=n(53965),s=n(95477);const l="SearchDebugStorePersistenceKey";class c extends o.default{setState(e){super.setState(e),function(e){let{newState:t,key:n}=e;i.Z.set({userId:"global",key:n,value:t})}({newState:e,key:this.getPersistenceKey()})}setStateWithoutPersisting(e){super.setState(e)}reloadFromDisk(){const e=i.Z.get({userId:"global",key:this.getPersistenceKey()});super.setState({...this.getInitialState(),...e})}}class d extends c{constructor(e){super(),this.column=void 0,this.getPersistenceKey=()=>`${l}:${this.column}`,this.updateForcedClusterPattern=e=>{this.setState({...this.state,forcedClusterPattern:e})},this.updateForcedBlockIds=e=>{this.setState({...this.state,forcedBlockIds:e})},this.column=e}getInitialState(){return{forcedClusterPattern:void 0,forcedBlockIds:void 0,searchExperimentOverrides:{},visible:!0}}hasDebugOverrides(){return!a.xb(this.state.forcedClusterPattern)||!a.xb(this.state.searchExperimentOverrides)||!a.xb(this.state.forcedBlockIds)}}const u=new class extends c{constructor(){super(...arguments),this.getPersistenceKey=()=>l}getInitialState(){return{showDebugInfo:!1,debug:void 0}}getDebugLevel(){return this.state.debug??(this.state.showDebugInfo?"explain":void 0)}},p=new d("left"),m=new d("right");function f(){u.reloadFromDisk(),p.reloadFromDisk(),m.reloadFromDisk()}function g(e){let{device:t}=e;return(0,r.x)(s.default)&&!t.isMobile&&(p.hasDebugOverrides()||m.hasDebugOverrides()||p.state.forcedClusterPattern||m.state.forcedClusterPattern)&&m.state.visible}const h=u},55320:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1,openAsPage:!1,openedTimeMs:void 0,sessionId:void 0,isPublicPageSearch:!1,preferSidePeekOpen:!0}}closeAndResetMetricsState(){this.update((e=>({...e,open:!1,openAsPage:!1,openedTimeMs:void 0,sessionId:void 0})))}isOpen(){return this.state.open||this.state.openAsPage}}const r=new i},87956:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){}}const r=new i},29026:(e,t,n)=>{n.d(t,{Xv:()=>l,ZP:()=>u});var o=n(49085),i=n(15157),r=n(94804),a=n(92338),s=n(80444);const l=20;let c=function(e){return e.Default="Default",e.Results="Results",e}({});class d extends o.default{constructor(){super(...arguments),this.resetQuery=e=>{let{resetFilters:t}=e;this.setState({...this.state,query:{...this.state.query,text:"",...t&&{filters:(0,a.u4)()}},limit:l,source:"quick_find_input_change"})},this.resetFilters=()=>{this.update((e=>({...e,query:{...e.query,filters:(0,a.u4)()}})))},this.updateFilters=e=>{const t=this.state.query.filters,n=(0,a.jl)(t,e);this.setState({...this.state,query:{...this.state.query,filters:n},limit:l,source:"quick_find_filters"})},this.setIsAnyPopupOpen=e=>{this.update((t=>({...t,isPopupOpen:e})))},this.expandFilterBar=()=>{this.updateFilterBarVisibilityState(!0)},this.collapseFilterBar=()=>{this.updateFilterBarVisibilityState(!1)},this.updateFilterBarVisibilityState=e=>{var t;const n=null===(t=s.default.state.currentUserStore)||void 0===t?void 0:t.id;n&&(i.Z.set({userId:n,key:r.rE,value:e}),this.update((t=>({...t,filterBar:{...t.filterBar,show:e}}))))},this.updateQueryText=e=>{this.setState({...this.state,query:{...this.state.query,text:e},limit:l,source:"quick_find_input_change"})},this.switchToSearchPane=()=>{this.setState({...this.state,mode:"search"})}}getInitialState(){return{mode:"search",isSidePeekPanelOpen:!1,isDebugSidebarOpen:!1,query:{text:"",filters:(0,a.u4)(),sort:{field:"relevance"}},limit:l,source:"quick_find",hasScrolled:!1,filterBar:{order:["titleToggle","personFilter","teamsFilter","pageFilter","dateFilter","dev_notInPageFilter","dev_notInTeamFilter"],show:!0},isPopupOpen:!1}}updateFilterOrder(e){this.setState({...this.state,filterBar:{...this.state.filterBar,order:e}})}hasQuery(){return Boolean(this.state.query.text)}isDebugSidebarOpen(){return this.state.isDebugSidebarOpen}}d.Mode=c;const u=new d},86486:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isOpen:!1}}}const r=new i},50628:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{selectableRectMap:new Map,selectableContainerRectMap:new Map,selectableElementRectMap:new Map,lastUpdate:0}}hasBeenUpdatedSince(e){return this.state.lastUpdate>e}}const a=new r;(0,i.exposeDebugValue)("SelectableRectStore",a);const s=a},27724:(e,t,n)=>{n.r(t),n.d(t,{SelectionPhase:()=>c,default:()=>u});var o=n(49085),i=n(1898),r=n(16339),a=n(95802),s=n(88923),l=n(6258);let c=function(e){return e[e.Selected=0]="Selected",e[e.Editing=1]="Editing",e}({});class d extends o.default{getInitialState(){return{stores:[],phase:c.Selected}}cloneState(){return{stores:[...this.state.stores],phase:this.state.phase}}getEditing(){if(this.state.phase===c.Editing)return this.state.stores[0]}isSelected(){return this.state.stores.length>0&&this.state.phase===c.Selected}getNodes(){return this.state.stores.map((e=>a.C.findNodeFromStore(e)||void 0)).filter(i.$K)}getCurrentRootStore(){var e,t;const n=null===(e=this.getCurrentDefaultContainer())||void 0===e?void 0:e.props.store;return n&&n instanceof l.G?n:null===(t=this.getDefaultContainer())||void 0===t||null===(t=t.props)||void 0===t?void 0:t.store}getCurrentRecordCache(){const e=this.getCurrentRootStore();if(e)return e.inMemoryRecordCache}getDefaultContainerFromTarget(e){return r.Z.find((t=>{const n=t.getNode();return Boolean(n&&n.contains(e))}))}getCurrentDefaultContainer(){const e=this.state.anchorContainer;return e||this.getDefaultContainer()}getDefaultContainer(){const e=this.state.defaultContainerStack;if(e&&e.length>0)return e[e.length-1]}isInPeekRenderer(){if(this.state.anchorContainer)return Boolean(this.state.anchorContainer.isPeekRenderer());{var e;const t=Boolean(null===(e=this.state.anchor)||void 0===e?void 0:e.isPageBlock()),n=s.default.state.open&&this.state.anchor===s.default.state.target;return t&&n}}}const u=new d},77794:(e,t,n)=>{n.d(t,{E:()=>a});var o=n(49085),i=n(53965),r=n(15723);class a{constructor(e){this.rect=o.default.createValue(r.bM),this.el=void 0,this.resizeObserver=void 0,this.options=void 0,this.recomputeThrottled=void 0,this.recompute=()=>{var e;const t=(null===(e=this.el)||void 0===e?void 0:e.getBoundingClientRect())??r.bM;return this.rect.setState(t),t},this.options=e||{},this.options.throttleMs&&(this.recomputeThrottled=i.P2(this.recompute,this.options.throttleMs))}observe(e){this.el=e,"undefined"!=typeof ResizeObserver&&(this.resizeObserver=new ResizeObserver(this.getRecomputeFn()),this.resizeObserver.observe(this.el)),this.recompute()}destroy(){this.resizeObserver&&this.resizeObserver.disconnect()}getRecomputeFn(){return this.recomputeThrottled||this.recompute}}},10743:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},1310:(e,t,n)=>{n.d(t,{JY:()=>r,Ty:()=>i,ZP:()=>s});var o=n(49085);const i=5e3,r=1e4;class a extends o.default{getInitialState(){return{currentItem:void 0,shouldReset:!0}}}const s=new a},64404:(e,t,n)=>{n.d(t,{Q:()=>i,Z:()=>a});var o=n(49085);let i=function(e){return e.Members="members",e.Groups="groups",e.Guests="guests",e.Reprovisioning="reprovisioning",e.Requests="requests",e}({});class r extends o.default{getInitialState(){return{currentTab:i.Members,limitMembers:!0,limitGuests:!0,limitTeamGuests:!0,membersFilter:"",guestsFilter:"",teamGuestsFilter:"",groupsFilter:"",groupNameInputValue:"",upsellModalOpen:!1,sorts:{members:{group:"members",by:"role",asc:!1},guests:void 0,team_guests:void 0}}}}const a=r},92083:(e,t,n)=>{n.d(t,{R:()=>i,Z:()=>a});var o=n(49085);let i=function(e){return e[e.OpenInDesktopApp=0]="OpenInDesktopApp",e[e.TwoStepVerification=1]="TwoStepVerification",e}({});class r extends o.default{getInitialState(){return{open:!1,currentTab:"settings",defaultSubtab:void 0,highlightedSetting:void 0,openedFrom:void 0}}}const a=new r},27242:(e,t,n)=>{n.d(t,{U:()=>i,Z:()=>a});var o=n(49085);let i=function(e){return e.CurrentSpace="current-space",e.TargetSpace="domain-claim-upgrade-team-plan-workspace",e}({});class r extends o.default{getInitialState(){return{open:!1,type:i.CurrentSpace}}closeWithSuccess(){this.setState({open:!1,succeeded:!0})}closeWithFailure(){this.setState({open:!1,succeeded:!1})}open(e){const{subscriptionTier:t,addOnFeature:n,billingInterval:o,coupon:r,isTrial:a,sessionId:s}=e;this.setState({open:!0,temporaryBillingInterval:o,temporaryAddress:{name:"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""},appliedPromo:void 0,error:void 0,subscriptionTier:t,vatApplicable:!1,calculatingTax:!1,payButtonState:"enabled",type:i.CurrentSpace,addOnFeature:n,onlyShowAddOn:void 0!==n,sessionId:s,coupon:r,isTrial:a})}setAddressField(e){this.state.open&&this.setState({...this.state,temporaryAddress:{...this.state.temporaryAddress,...e},taxCalculationError:void 0})}setValidationErrorState(e,t){const n=this.state;if(!n.open)return;const o=n.validationErrors??{};o[e]=t,this.setState({...n,validationErrors:o})}clearValidationErrorState(e){const t=this.state;t.open&&t.validationErrors&&e in t.validationErrors&&(delete t.validationErrors[e],this.setState({...t}))}}const a=new r},9209:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},99757:(e,t,n)=>{n.d(t,{Z:()=>l,n:()=>s});var o=n(14577),i=n(49085);class r extends i.default{constructor(){super(...arguments),this.updateRemaining=e=>{this.state.remainingPending!==e&&(0===e?this.setState({...this.state,totalPending:0,remainingPending:0}):this.setState({...this.state,remainingPending:e}))}}getInitialState(){return{totalPending:0,remainingPending:0,transactionQueueError:void 0,storageUsageEstimate:void 0,connectionError:void 0}}percentComplete(e){if(this.state.totalPending>0){const t=1-this.state.remainingPending/this.state.totalPending;return e.formatNumber(t,{style:"percent",maximumFractionDigits:0})}return e.formatNumber(1,{style:"percent"})}setOrIncTotal(e){this.state.totalPending>e?this.setState({...this.state,totalPending:this.state.totalPending+1}):this.setState({...this.state,totalPending:e})}}const a=new r,s=new o.Z((()=>Boolean(a.state.transactionQueueError)),{debugName:"transactionQueueUnhealthyStore"}),l=a},26634:(e,t,n)=>{n.d(t,{Om:()=>i,_W:()=>a,o:()=>r});var o=n(99757);function i(){o.Z.setState({...o.Z.state,connectionError:void 0})}function r(e){const{connectionError:t}=o.Z.state,n=Date.now(),i=void 0===e.backoffEstimate?void 0:e.backoffEstimate+n;o.Z.setState({...o.Z.state,connectionError:{startTime:(null==t?void 0:t.startTime)??n,numAttempts:t?t.numAttempts+1:1,approximateBackoffDelayEndTime:i,retryReason:e.retryReason??(null==t?void 0:t.retryReason)}})}const a={onReset:i,onBackoff(e,t){r({backoffEstimate:e,retryReason:t})}}},42185:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n(49085).default.createValue(void 0)},30397:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{teams:[],lastEmitData:{value:"no value saved yet",spaceId:void 0,userId:void 0}}}shouldRefetchTeamsInSpace(e){let{currentUserId:t,currentSpaceId:n,emitValue:o}=e;const{spaceId:i,userId:r,value:a}=this.state.lastEmitData;return n!==i||(t!==r||o!==a)}}const r=new i},24666:(e,t,n)=>{n.r(t),n.d(t,{TextSelectionStore:()=>l,default:()=>c});var o=n(14577),i=n(49085),r=n(53965),a=n(26249),s=n(68056);class l extends i.default{constructor(){super(...arguments),this.isEditingStore=new o.Z((()=>"editing"===this.state.mode),{debugName:"isEditingStore"}),this.isExpandedStore=new o.Z((()=>"empty"!==this.state.mode&&!(0,s.iG)(this.state.multiSelection)),{debugName:"isExpandedStore"})}getInitialState(){return{mode:"empty"}}setState(e){if("empty"===e.mode||"empty"===this.instanceState.mode)return super.setState(e);if(!(0,a.Z)(this.instanceState,e)){const{savedSelectionXPosition:t,...n}=this.instanceState,{savedSelectionXPosition:o,...i}=e;this.instanceState=e,(0,a.Z)(n,i)||this.emit()}}cloneState(){return"editing"===this.state.mode?{mode:"editing",multiSelection:(0,s.k_)(this.state.multiSelection),savedSelectionXPosition:this.state.savedSelectionXPosition,forceExtendAnnotations:r.Xh(this.state.forceExtendAnnotations)}:"readOnly"===this.state.mode?{mode:"readOnly",multiSelection:(0,s.k_)(this.state.multiSelection),savedSelectionXPosition:this.state.savedSelectionXPosition}:{mode:"empty"}}isEmptySelection(){if("empty"===this.state.mode)return!0;const{multiSelection:e}=this.state;return(0,s.iG)(e)}isEditingComment(){return"editing"===this.state.mode&&("comment"===this.state.multiSelection.start.store.table||"comment"===this.state.multiSelection.end.store.table)}isEditingCaption(){return"editing"===this.state.mode&&(r.Xy(this.state.multiSelection.start.store.path,["properties","caption"])||r.Xy(this.state.multiSelection.end.store.path,["properties","caption"]))}hasSelection(){return"empty"!==this.state.mode}isEditingEmptyBlock(){return!("empty"===this.state.mode||!this.isEmptySelection())&&!this.state.multiSelection.start.store.isDefined()}}const c=new l},45131:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}setOpen(e,t){this.setState({...this.state,[e]:t})}toggle(e){this.setState({...this.state,[e]:!this.isOpen(e)})}isOpen(e){return!!this.state[e]}}const r=new i},48588:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){}}const a=new r;(0,i.exposeDebugValue)("TokenHoverStore",a);const s=a},58948:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{focused:!1,hovered:!1}}}const r=i},16194:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n(49085).default.createValue(!1)},52258:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},66708:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},77503:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},59238:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isDragging:!1}}}const r=new i},68026:(e,t,n)=>{n.r(t),n.d(t,{TransactionQueueDependenciesImpl:()=>V});var o=n(68626),i=n(52629),r=n(1525),a=n(3022),s=(n(21703),n(57658),n(92595)),l=n(59730),c=n(45605),d=n(9291),u=n(53965),p=n(37850),m=n(7032),f=n(1898),g=n(54642),h=n(47307),v=n(77080),b=n(56518),y=n(33954),_=n(79947),S=n(33929),w=n(44133),k=n(482),I=n(4408);async function C(e,t){const n=u.mN(t.operations.flatMap((e=>[e.pointer,...(0,k.SH)(e)?e.additionalUpdatedPointers??[]:[]])),(e=>e.id));await Promise.all(n.map((n=>I.HB({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:n,userId:t.userId}))))}var x=n(99341);let T=0;const M=(0,d.defineMessages)({requestTooLarge:{id:"transactionHelpers.requestTooLargeError.message",defaultMessage:"Sorry, that request was too large."},requestTooLargeTryImportInstead:{id:"transactionHelpers.requestTooLargeError.message.tryImportInstead",defaultMessage:"Sorry, that request was too large. Try import instead?"}});let P=!1;(0,s.exposeDebugValue)("toggleTransactionQueue",(()=>{P=!P,console.info(P?"Transactions paused":"Transactions resumed")}));let A=0;(0,s.exposeDebugValue)("setTransactionQueueApiLatencyMs",(e=>{A=e,0===e?console.info("Disabling saveTransactions API latency simulation."):console.info(`Simulating saveTransactions API latency of ${e} ms.`)}));class R extends Error{constructor(e){super(e.message),this.retryDelay=void 0,this.retryReason=void 0,this.savedTasks=void 0,this.failedTasks=void 0,this.clientData=void 0,this.name="HandleSaveTransactionsError",this.retryDelay=e.retryDelay,this.retryReason=e.retryReason,this.savedTasks=e.savedTasks,this.failedTasks=e.failedTasks,this.clientData=e.clientData}}function D(e){if(1===e.subTasks.length)return e.task.debug;const t=new Map;for(const o of e.subTasks){var n;const e=null===(n=o.debug)||void 0===n?void 0:n.userAction;if(e){const n=t.get(e)??0;t.set(e,n+1)}}return{...e.task.debug,tags:(0,c.G)(e.subTasks),squashedUserActions:Object.fromEntries(t)}}async function E(e){if(P)return{value:[]};const{environment:t,tasks:n}=e,r=function(e,t){const n=new Set(t.map((e=>e.timestamp))),o=t.length-n.size;return o>0&&a.LA(e,{collision_count:o}),o}(t,n),{userId:s,squashedTasks:c}=x.Vm(n,{allowSquashing:!0}),d=c.map((e=>({id:e.task.id,spaceId:e.task.spaceId,debug:D(e),operations:e.task.operations,inSudoMode:e.task.useSudoMode}))),k=(0,m.ZP)(),I=v.default.checkGate("client_http_gzip")?"gzip":void 0,C=await g.saveTransactions(t,{requestId:k,transactions:d},s,void 0,void 0,void 0,I);if(A>0&&(console.info(`saveTransactions returned; simulating ${A}ms extra latency.`),await(0,p.Vs)(A)),"success"===C.type)return T=0,{value:c.flatMap((e=>e.subTasks))};const E="Notion is unavailable, please try again later."===C.error.message;if(!E&&!C.error.data.offline||Math.random()<.01){const e=[...new Set(d.map((e=>e.spaceId??"NO_SPACE_ID")))];o.log({level:"error",from:"transactionActions",type:"ClientTransactionError",error:{miscErrorString:(0,i.LK)(C)},data:{requestId:k,miscDataToConvertToString:{transactions:d},userId:t.currentUser.id,spaceIds:e}})}if(413===C.status){let e,n,i=0;c.forEach((t=>{var o,r;null!==(o=t.task.debug)&&void 0!==o&&o.userAction&&(e=t.task.debug.userAction),null!==(r=t.task.debug)&&void 0!==r&&r.userFlow&&(n=t.task.debug.userFlow),i+=t.subTasks.length})),o.log({level:"error",from:"transactionActions",type:"ClientTransaction413Error",data:{totalTaskCount:i,userId:t.currentUser.id,requestId:k,userAction:e,userFlow:n}});const r=JSON.stringify(d);a.F4(t,{totalTaskCount:i,payloadLength:r.length,userAction:e});const s=Math.ceil(r.length/x._V);for(let a=0;a<s;a++)o.log({level:"error",from:"transactionActions",type:"ClientTransaction413ErrorRecovery",data:{userId:t.currentUser.id,totalTaskCount:i,requestId:k,miscDataToConvertToString:{chunkTotal:s,chunkIndex:a,operationChunk:r.slice(a*x._V,(a+1)*x._V)}}});h.showErrorMessage(S.default.formatMessage(e===b.xF?M.requestTooLargeTryImportInstead:M.requestTooLarge))}const V=e=>{const n=T;if(e.failedTasks.length>0&&(T+=1),!E&&!C.error.data.offline){var s,l,c;const d=e.failedTasks.length>0?e.failedTasks[0]:void 0;d&&"space_not_found_in_record_path"===(null===(s=e.clientData)||void 0===s?void 0:s.type)&&o.log({level:"error",from:"transactionActions",type:"ClientTransactionSpaceNotFoundError",error:(0,i.Ui)(e),data:{userId:t.currentUser.id,requestId:k,miscDataToConvertToString:(0,w.getDebugSourcesForIdsInOperations)(t,d.operations)}}),a.mc(t,{status:C.status,message:(0,_.pO)(C),previous_consecutive_rollbacks:n,saved_tasks:e.savedTasks.length,failed_tasks:e.failedTasks.length,first_failed_task_user_action:null==d||null===(l=d.debug)||void 0===l?void 0:l.userAction,first_failed_task_debug_tags:null==d||null===(c=d.debug)||void 0===c?void 0:c.tags,will_retry:e.retryDelay>0,retry_reason:e.retryReason,timestamp_collision_count:r})}return{error:e}};if((0,l.Rp)(C.body)){if((0,l.oE)(C.body.clientData)){const{errors:e}=C.body.clientData,n=e[0],o=c.findIndex((e=>e.task.id===n.id));if(o<0)return F(t,k,n),V(new R({message:n.name,clientData:n.clientData,retryDelay:0,retryReason:void 0,savedTasks:[],failedTasks:[]}));const i=c.slice(0,o),r=i.flatMap((e=>e.subTasks)),a=[],s=[],l=[];let d=o,u=0,p=0;for(const f of e){const e=c[d];f.id===e.task.id?(f.retryable?(s.push({error:f,squashedTask:e}),p+=1):(u+=1,await B(t,e.task,k),e.subTasks.forEach((e=>a.push(e))),l.push({error:f,squashedTask:e})),d++):F(t,k,f)}const m=[`${i.length} successful`,u>0?`${u} failed unretryable (data loss)`:void 0,p>0?`${p} retryable`:void 0].filter(f.$K).join(", "),g=[`API error for ${c.length} transactions: ${m}.`,O(l,"unretryable"),O(s,"retryable")].filter(f.$K).join(" ");let h,v=0;return s.length>0&&(v=2e3,h=s[0].error.name),V(new R({savedTasks:r,failedTasks:a,message:g,retryDelay:v,retryReason:h,clientData:n.clientData}))}if(u.q9(Z,C.status))return await Promise.all(c.map((e=>B(t,e.task,k)))),V(new R({savedTasks:[],failedTasks:c.flatMap((e=>e.subTasks)),message:(0,y.wf)(S.default.getIntl(),C),retryDelay:0,retryReason:void 0}))}let U=`http${C.status}`;return C.error.data.offline?U="offline":E&&(U="notionUnavailable"),V(new R({savedTasks:[],failedTasks:[],message:(0,y.wf)(S.default.getIntl(),C),retryDelay:5e3,retryReason:U}))}async function B(e,t,n){try{await C(e,t)}catch(r){o.log({level:"error",from:"transactionActions",type:"ClientTransactionCleanupError",error:(0,i.Ui)(r),data:{userId:e.currentUser.id,requestId:n}})}}function F(e,t,n){o.log({level:"error",from:"transactionActions",type:"ClientTransactionNotFoundError",error:(0,i.Ui)(n),data:{userId:e.currentUser.id,requestId:t}})}function O(e,t){if(e.length>0){var n;const{error:o,squashedTask:{task:i}}=e[0];return`First ${t} error: ${o.name} for transaction ${i.id} created by ${null===(n=i.debug)||void 0===n?void 0:n.userAction}.`}}const Z=[400,413];class V{constructor(e){this.timeSource=r.O,this.environment=e}getExperimentGroup(e){return v.default.getGroup(e)}handleSaveTransactions(e){return E({environment:this.environment,tasks:e})}handleHealthcheck(e){a.h2(this.environment,e)}async rollbackTask(e){try{await C(this.environment,e)}catch(t){o.log({level:"error",from:"TransactionQueueDependencies",type:"ClientTransactionCleanupError",error:(0,i.Ui)(t),data:{userId:this.environment.currentUser.id}})}}}},9425:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(88893),i=n(88280),r=n(77080);function a(){const e=i.subscriptionDataStoreInstance.state;return!(!e||(0,o.CM)(e).length>1)&&r.default.checkGate("optimize_single_workspace")}},1634:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},80064:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},40671:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{updatingUrls:new Set}}add(e){this.state.updatingUrls.add(e),this.emit()}delete(e){this.state.updatingUrls.delete(e),this.emit()}}const r=new i},85703:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(92595);const i=new(n(51444).q)((e=>{let{spaceId:t}=e;return t}),(async(e,t)=>{let{spaceId:o}=t;const i=await Promise.resolve().then(n.bind(n,54642)),r=await i.getInvoiceData(e,{spaceId:o,type:"upcoming"});return"success"===r.type?r.data.invoiceData:void 0}));o.exposeDebugValue("UpcomingInvoiceStore",i);const r=i},62820:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},4761:(e,t,n)=>{n.d(t,{ZP:()=>l,g0:()=>a,n_:()=>c});var o=n(49085),i=n(7032),r=n(1898);function a(e){return"mentions"===e||"allPages"!==e&&"archive"!==e&&void(0,r.t1)(e)}class s extends o.default{getInitialState(){return{currentTab:"mentions",isCurrentTabEmpty:!0,containsBothReadAndUnreadNotifications:!1,containsUnreadNotifications:!1,loadingId:void 0,sessionId:void 0,showOnlyUnreadNotifications:!1,unreadNotificationIds:[]}}startSession(){let{forceRestart:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(void 0===this.state.sessionId||e)&&this.setState({...this.state,sessionId:(0,i.ZP)()})}endSession(){this.setState({...this.state,sessionId:void 0})}startLoading(){const e=Math.random().toString();return this.setState({...this.state,loadingId:e}),e}endLoading(e){e===this.state.loadingId&&this.setState({...this.state,loadingId:void 0})}isFilteredToUnreadOnly(){if("mentions"===this.state.currentTab)return this.state.showOnlyUnreadNotifications}}const l=new s,c=o.default.createValue(!0)},29226:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(37850);class r extends o.default{getInitialState(){return{readyPromise:(0,i.UZ)(),localSpaceInaccessiblePages:void 0,remoteSpaceInaccessiblePages:void 0}}getSpaceInaccessiblePages(e,t){const n=this.state;return n.remoteSpaceInaccessiblePages&&n.remoteSpaceInaccessiblePages[t]?n.remoteSpaceInaccessiblePages[t][e]:n.localSpaceInaccessiblePages&&n.localSpaceInaccessiblePages[t]?n.localSpaceInaccessiblePages[t][e]:void 0}}const a=new r},76117:(e,t,n)=>{n.d(t,{p:()=>r});var o=n(49085);class i extends o.default{getInitialState(){}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state)))}}const r=new i},17963:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{pageMap:{}}}setStatus(e,t){const{pageMap:n}=this.state;t?n[e]=!0:delete n[e],this.emit()}}const r=new i},33759:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(85974).Z)},89403:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}}const r=new i},85974:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{loginType:"email",email:"",password:"",hasAccount:!1,showPassword:!1,signUpLinkSent:!1,hiddenPasscode:!1,forceAdminSamlLogin:!1}}isGoogle(){return"google"===this.state.loginType}isEmail(){return"email"===this.state.loginType}isReverifying(){return"reverify"===this.state.loginType}isTemporaryPasscode(){return"temporary"===this.state.loginType}isExclusiveLoginLinkTemporaryPasscode(){return"temporary"===this.state.loginType&&Boolean(this.state.hiddenPasscode)}isPassword(){return"password"===this.state.loginType}isForgotPassword(){return"forgot"===this.state.loginType}isPasswordResetSent(){return"reset"===this.state.loginType}isSaml(){return"saml"===this.state.loginType}isMfa(){return"mfa"===this.state.loginType}}const r=i},7339:(e,t,n)=>{n.d(t,{C:()=>w,Z:()=>y});n(21703);var o=n(30120),i=n(41351),r=n.n(i),a=n(49085),s=n(68626),l=n(90965),c=n(34886),d=n(57347),u=n(52629),p=n(1898),m=n(97978),f=n(12955),g=n(48779),h=n(97448),v=n(35057),b=n(80444);const y="group";class _ extends a.default{constructor(){super(...arguments),this.environment=void 0}getInitialState(){return{currentUserId:void 0,currentSpaceId:void 0,ready:!1}}isInitialized(){return h.StatsigInitializer.isComplete}async initialize(e){const t=Date.now();this.environment=e;const{userId:n,spaceId:o}=S(e);if(this.isInitialized()&&void 0!==n)await this.updateUserAndSpace(e);else try{this.setStateBeforeInitOrUpdate(n,o),await this.confirmInitializeDidSucceed(),await this.updateStatsigUserWithAllKnownFields({environment:e,stage:"initialize"}),this.setStateAfterInitOrUpdate(n,o),this.trackMetric("statsig_client_init_success")}catch(i){this.logError("initialize",i,{nextUserId:n}),this.trackMetric("statsig_client_init_error")}finally{this.trackMetric("statsig_client_init_duration",{time:Date.now()-t})}}async updateUserAndSpace(e){const{userId:t,spaceId:n}=S(e);this.state.currentUserId===t&&this.state.currentSpaceId===n||(this.setStateBeforeInitOrUpdate(t,n),await this.updateStatsigUserWithAllKnownFields({environment:e,stage:"updateUserAndSpace"}),this.setStateAfterInitOrUpdate(t,n))}async confirmInitializeDidSucceed(){if(!h.StatsigInitializer.initializePromise)throw new Error("`statsig.initialize` was not called on app bootstrap");if(await h.StatsigInitializer.initializePromise,h.StatsigInitializer.error)throw h.StatsigInitializer.error}async updateStatsigUserWithAllKnownFields(e){let{environment:t,stage:n}=e;const o=Date.now();try{const e=await this.createStatsigUser(t);await r().updateUser(e),this.trackMetric("statsig_client_update_user_success")}catch(i){this.logError("updateUser",i,{nextUserId:t.currentUser.id,err:(0,d.t)(i).message,stage:n}),this.trackMetric("statsig_client_update_user_error")}finally{this.trackMetric("statsig_client_update_user_duration",{time:Date.now()-o})}}setStateBeforeInitOrUpdate(e,t){super.setState({currentUserId:e,currentSpaceId:t,ready:!1})}setStateAfterInitOrUpdate(e,t){const{currentSpaceId:n,currentUserId:o}=super.getState();n===t&&o===e&&super.setState({currentUserId:e,currentSpaceId:t,ready:!0})}getGroup(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y,o=arguments.length>3?arguments[3]:void 0;const i=Date.now();if(!this.isInitialized())return;let a;try{return a=t?r().getExperimentWithExposureLoggingDisabled(e):r().getExperiment(e),this.trackMetric("statsig_client_get_group_success",{experiment_id:e}),a.get(n,o)}catch(s){this.trackMetric("statsig_client_get_group_error",{experiment_id:e}),this.logError("getGroup",s,{experimentId:e,expConfig:JSON.stringify(a)})}finally{this.trackMetric("statsig_client_get_group_duration",{time:Date.now()-i})}}manuallyLogExperimentExposure(e){r().manuallyLogExperimentExposure(e)}checkGate(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Date.now();if(!this.isInitialized())return!1;let o;try{return o=t?r().checkGateWithExposureLoggingDisabled(e):r().checkGate(e),this.trackMetric("statsig_client_check_gate_success",{gate_name:e}),o}catch(i){const t=i instanceof Error?i.message:void 0;return this.logError("checkGate",i,{gateName:e,...t&&{errorMessage:t}}),this.trackMetric("statsig_client_check_gate_error",{gate_name:e}),!1}finally{this.trackMetric("statsig_client_check_gate_duration",{time:Date.now()-n})}}getConfig(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Date.now();if(!this.isInitialized())return;let o;try{return o=t?r().getConfig(e):r().getConfigWithExposureLoggingDisabled(e),this.trackMetric("statsig_client_get_config_success",{config_name:e}),o}catch(i){const t=i instanceof Error?i.message:void 0;return this.logError("getConfig",i,{dynamicConfigName:e,...t&&{errorMessage:t}}),void this.trackMetric("statsig_client_get_config_error",{config_name:e})}finally{this.trackMetric("statsig_client_get_config_duration",{time:Date.now()-n})}}logEvent(e,t,n){const o=Date.now();if(!this.isInitialized())return!1;try{return r().logEvent(e,t,n),this.trackMetric("statsig_client_log_event_success",{event_name:e}),!0}catch(i){const o=i instanceof Error?i.message:void 0;return this.logError("logEvent",i,{eventName:e,value:String(t),...n,...o&&{errorMessage:o}}),this.trackMetric("statsig_client_log_event_error",{event_name:e}),!1}finally{this.trackMetric("statsig_client_log_event_duration",{time:Date.now()-o})}}getLocalOverride(e){if(!this.isInitialized())return;const t=r().getAllOverrides().configs[e];return null==t?void 0:t[y]}updateLocalOverrideConfig(e,t){this.isInitialized()&&(r().overrideConfig(e,{[y]:t}),super.emit())}updateLocalOverrideGate(e,t){this.isInitialized()&&(r().overrideGate(e,"true"===t),super.emit())}removeAllLocalOverrides(){if(!this.isInitialized())return;const e=r().getAllOverrides();(0,p.Yd)(e.configs).forEach((e=>r().removeConfigOverride(e))),(0,p.Yd)(e.gates).forEach((e=>r().removeGateOverride(e))),super.emit()}async createStatsigUser(e){var t,n,i;const{device:r}=e,{currentUserSettingsStore:a,currentSpaceStore:s}=b.default.getState(),{userId:d,userEmail:u,spaceId:p}=S(e),m=await f.getBrowserId(e),y=await f.getExperimentDeviceId(e),{function:_,role:w,companySize:k,useCases:I}=(0,g.kO)();return(0,h.createStatsigUser)({userId:d,device:r,spaceId:p,userEmail:u,deviceId:y,browserId:m,locale:null==a||null===(t=a.getSettings())||void 0===t?void 0:t.preferred_locale,spaceMemberCount:(0,c.F)((0,l.t5)(null==s?void 0:s.getPermissionItems())),spaceCreatedTime:null==s?void 0:s.getCreatedTime(),spaceCreatedDate:null!=s&&s.getCreatedTime()?o.ou.fromMillis(null==s?void 0:s.getCreatedTime()).toFormat("yyyy-MM-dd"):void 0,subscriptionTier:(0,v.zt)(),planType:null==s?void 0:s.getPlanType(),signupTime:null==a||null===(n=a.getSettings())||void 0===n?void 0:n.signup_time,domainType:null==a||null===(i=a.getSettings())||void 0===i?void 0:i.domain_type,persona:_,teamRole:w,useCases:I,companySize:k})}logError(e,t,n){s.log({level:"error",from:"statsig",type:e,error:(0,u.Ui)(t),data:{miscDataToConvertToString:{...n,...this.state}}})}trackMetric(e,t){this.environment&&e.endsWith("_error")&&m.j(this.environment,e,t)}}function S(e){const{currentUser:t}=e,{currentSpaceStore:n,currentUserStore:o}=b.default.getState(),i=t.id,r=null==o?void 0:o.getEmail();return{userId:i,spaceId:null==n?void 0:n.id,userEmail:r}}const w=new _},57118:(e,t,n)=>{n.d(t,{n:()=>l});var o=n(33929),i=n(80444),r=n(73796),a=n(70060),s=n(30221);function l(e){const t=(0,a.j9)(),n=o.default.getIntl(),{currentUserStore:l}=i.default.state,c=null!=l&&l.isDefined()?l.getModel():void 0;t?s.Z.setState({open:!0,userModel:c,initialQuestion:e}):r.Z.setState({open:!0,email:null==c?void 0:c.getEmail(),name:null==c?void 0:c.getDisplayName(n),question:e})}},22616:(e,t,n)=>{n.d(t,{Zz:()=>s,aQ:()=>c,yD:()=>l});n(21703);var o=n(64793),i=n(12139),r=n(54642),a=(n(95477),n(70060),n(33493));async function s(e){const{environment:t,spaceId:n}=e;if("init"!==a.Z.state.status)return;a.Z.didStartLoading();const s=await r.listPrices(t,{spaceId:n});if("success"!==s.type)return void a.Z.resetExceptSelectedCurrencyCode();const l=s.data.prices;l&&0!==l.length||i.IE(new Error("Received empty price list")),a.Z.setPrices(l.map((e=>new o.tA(e))))}function l(e){a.Z.availableCurrencyCodes.includes(e)&&a.Z.update((t=>({...t,selectedCurrencyCode:e})))}async function c(e){let{environment:t,spaceId:n}=e;return await s({environment:t,spaceId:n}),a.Z.state.prices}},81023:(e,t,n)=>{n.d(t,{EO:()=>le,$B:()=>fe,Fp:()=>we,KD:()=>Te,sv:()=>xe,I0:()=>Se,Xb:()=>ke,bi:()=>he,zb:()=>be,y3:()=>se,OR:()=>ge,TV:()=>ae,Mg:()=>re,r7:()=>me,M_:()=>_e});n(21703);var o=n(30120),i=(n(67294),n(41892),n(68626)),r=(n(65454),n(15157)),a=n(9182),s=n(26929),l=n(2438),c=n(9291),d=n(53965),u=n(7032),p=n(86572),m=n(54642),f=n(35253),g=n(47307),h=n(92625),v=n(97977),b=n(72899),y=n(91754),_=(n(95477),n(15010)),S=n(33929),w=n(78873),k=n(95697),I=n(80444),C=n(80148),x=n(77080),T=n(21051),M=n(53730),P=n(81236),A=n(6258),R=n(92083),D=n(27242),E=n(9209),B=n(85703),F=n(76117),O=n(70060),Z=n(28517),V=n(60027),U=n(42198),L=n(22616),j=n(5682),N=n(58333),z=n(88893),q=n(35057),W=n(62142),H=n(33493),K=n(88280),G=n(44615),$=n(2688);async function Q(e){const{environment:t,spaceId:n}=e,o=(0,G.TA)({spaceId:n});if(!X||X!==o){let n;!function(e){J&&$.ZP.removeListener(J,e)}(t);const i=(t,o)=>{void 0!==n&&n!==o&&Y(e),n=o},r=d.P2(i,5e3);J=$.ZP.addListener(o,r,void 0,t),X=o;if(!C.Z.state.visible_banners)return Y(e)}}async function Y(e){const{environment:t,spaceId:n}=e,o=await m.getSubscriptionBanner(t,{spaceId:n});var i;"success"===o.type&&((null===(i=I.default.state.currentSpaceStore)||void 0===i?void 0:i.id)===n&&C.Z.setState({visible_banners:o.data.bannerIds}))}let J,X;var ee=n(64891),te=n(85893);const ne="SubscriptionData";let oe;const ie=(0,c.defineMessages)({updatingSubscription:{id:"subscriptionSettings.updatingSubscriptionMessage",defaultMessage:"Updating your subscriptionâ€¦"},updatingPaymentMethod:{id:"subscriptionSettings.updatingPaymentMethodMessage",defaultMessage:"Updating your payment methodâ€¦"},verifyingEligibility:{id:"subscriptionSettings.verifyingEligibilityMessage",defaultMessage:"Verifying eligibilityâ€¦"},personalFree:{id:"subscriptionSettings.personalFreeMessage",defaultMessage:"You are now subscribed to Notionâ€™s Personal Pro Plan for free."},educationPlusFree:{id:"subscriptionSettings.educationPlusFreeMessage",defaultMessage:"You are now subscribed to Notion's Education plan for free"},finishingUp:{id:"subscription.upgrade.finishing",defaultMessage:"Finishing up..."}});async function re(e){const{from:t,environment:n,spaceStore:o,billingEmail:i,paymentData:r,vatId:s,coupon:l,customerName:c,businessName:d,addressLine1:u,addressZip:v,addressCity:b,addressState:y,addressCountry:S,promoCodeId:w,useTestClock:k,sessionId:I,inAppOffer:C,desiredState:x,trialData:M}=e;f.Js({bannerStore:T.Z}),h.j({message:ie.updatingSubscription});const P=K.subscriptionDataStoreInstance.state;if(!P)throw new Error("Subscription data not loaded.");const A=await L.aQ({environment:n,spaceId:o.id}),R=(0,j.P)(A,P),D=(0,a.iv)(R),{plan:E,addOns:B,isTrial:F}=(0,N.ug)(D,x),O=await m.updateSubscription(n,{spaceId:o.id,plan:E,addOns:B,billingEmail:i,stripeToken:Ie(r),paymentMethodId:Ce(r),vatId:s,coupon:l,customerName:c,businessName:d,addressLine1:u,addressZip:v,addressCity:b,addressState:y,addressCountry:S,promoCodeId:w,useTestClock:k,modalSessionId:I,inAppOffer:C,isTrial:F,clientVersion:n.device.version,trialData:M});if(h.x(),"failed"===O.type)throw g.showError(O),new Error("An error occurred while updating subscription");await pe({environment:n,spaceStore:o,newDefaultTeamId:O.data.newDefaultTeamId});const Z=K.subscriptionDataStoreInstance.state,U=o.id,z=o.getPlanType(),q=(0,j.P)(A,Z);if(function(e){var t;let{environment:n,context:o,oldData:i,newData:r,desiredState:s}=e;const l=(0,a.F6)(i.subscription),c=(0,a.zt)(i.subscription),d=(0,a.xi)(i.subscription),u=(0,a.Hw)(i.subscription),m=(0,a.bs)(i.subscription),f=i.email,g=(0,a.F6)(s),h=(0,a.zt)(s),v=(0,a.xi)(s),b=(0,a.Hw)(s),y=(0,a.bs)(s),S=Boolean(null==s?void 0:s.trialEnd),w=r.email,k=i.subscription,I=!(0,a.YK)(k)&&(0,a.YK)(s),C=(0,a.YK)(k)&&(0,a.YK)(s),x=(0,a.YK)(k)&&!(0,a.YK)(s);I&&g?p.k6(n,{plan:g,credit_amount:0}):C?p.wl(n,{billing_email_changed:f!==w,plan_changed:g!==l,plan_current:g,plan_old:l,currency_code:y,billing_address_changed:!1}):x&&l&&p.rx(n,{plan:l});p._j(n,{from:o.from,action:x?"cancel":"update",spaceId:o.spaceId,isMmOrEnt:o.isMmOrEnt,planType:o.planType,addressCountry:null===(t=r.address)||void 0===t?void 0:t.country,oldSubscriptionTier:c,newSubscriptionTier:h,oldCurrency:m,newCurrency:y,oldPriceId:l,newPriceId:g,oldAddOns:d,newAddOns:v,oldBillingInterval:u,newBillingInterval:b,creditAmount:0,isProfessionalTeamUser:(0,_.QZ)(),isTrial:S,trialData:o.trialData})}({environment:n,context:{spaceId:U,planType:z,from:t,isMmOrEnt:await(0,V.n)(n),trialData:M},oldData:R,newData:q,desiredState:x}),!Z)throw new Error("Subscription data not loaded.");return O.data}async function ae(e){const{environment:t,spaceStore:n,paymentMethodId:o}=e;h.j({message:ie.updatingPaymentMethod});const i=await m.updatePaymentMethod(t,{spaceId:n.id,paymentMethodId:o});if(h.x(),"failed"!==i.type)return await he(t),i.data;g.showError(i)}async function se(e){const{environment:t,spaceStore:n,address:o}=e;f.Js({bannerStore:T.Z}),h.j({message:ie.updatingSubscription});const i=await m.updateSubscription(t,{spaceId:n.id,customerName:o.name,businessName:o.businessName,addressLine1:o.addressLine1,addressLine2:o.addressLine2,addressZip:o.zipCode,addressCity:o.city,addressState:o.state,addressCountry:o.country});if("failed"===i.type)throw h.x(),g.showError(i),i.error;p.wl(t,{billing_email_changed:!1,plan_changed:!1,billing_address_changed:!0}),await ve(t),await he(t),h.x()}async function le(e){const{environment:t,spaceStore:n,planType:o,from:i}=e,r=K.subscriptionDataStoreInstance.state;if(!r)throw new Error("Subscription data not loaded.");f.Js({bannerStore:T.Z}),h.j({message:ie.updatingSubscription});const a=ce(t,r),s=r.addOns,c=z.XX(r),d=null==c?void 0:c.plan,u=await L.aQ({environment:t,spaceId:n.id}),v=d?(0,l.qH)(u,d):void 0,b=await m.cancelSubscription(t,{spaceId:n.id,planType:o,cancelImmediately:e.cancelImmediately});if("failed"===b.type)return h.x(),void g.showError(b);const y=z.XX(r);let S;"subscribed_admin"===r.type&&y&&(S=!0,p.rx(t,{plan:y.plan})),await pe({environment:t,spaceStore:n,newDefaultTeamId:void 0});const w=K.subscriptionDataStoreInstance.state;if(!w)throw new Error("Subscription data not loaded.");return p._j(t,{from:i,action:"cancel",spaceId:n.id,oldSubscriptionTier:a,newSubscriptionTier:ce(t,w),oldPriceId:de(r,y),oldCurrency:ue(r),newCurrency:ue(w),oldAddOns:s.map((e=>e.feature)),oldBillingInterval:v,newBillingInterval:void 0,isCancelSubscription:S,isProfessionalTeamUser:(0,_.QZ)()}),h.x(),!0}function ce(e,t){const n=(0,q.zt)();if(!t)return n;return(0,z.DH)(t)?"free":n}function de(e,t){if(!e)return;return(0,z.DH)(e)||null==t?void 0:t.plan}function ue(e){if(e)return"currencyCode"in e?e.currencyCode:void 0}async function pe(e){let{environment:t,newDefaultTeamId:n,spaceStore:o}=e;if(await he(t),await ve(t),H.Z.reset(),(0,k.bq)()&&t.currentUser.id&&void 0!==n){await Z.m({userId:t.currentUser.id,spaceId:o.id,environment:t});const e=A.zX.createChildStore(o,{table:"team",id:n,spaceId:o.id});await e.load()}}async function me(e){const{environment:t,spaceStore:n,code:o}=e;h.j({message:ie.verifyingEligibility});const i=K.subscriptionDataStoreInstance.state;if(!i)throw new Error("Subscription data not loaded.");const r=await m.updateSubscriptionToEducationPlan(t,{spaceId:n.id,code:o});"failed"===r.type?g.showError(r):r.data.isEligible?ye(i,t):E.Z.setState({open:!0,handlePromoCode:async e=>{h.j({message:ie.updatingSubscription});const o=await m.updateSubscriptionToEducationPlan(t,{spaceId:n.id,code:e});"failed"===o.type?g.showError(o):o.data.isEligible?ye(i,t):g.showErrorMessage((0,te.jsx)(c.FormattedMessage,{id:"subscriptionSettings.invalidPromoCodeError.message",defaultMessage:"This promo code is not valid."})),h.x()}}),h.x()}function fe(){oe&&oe.close()}async function ge(e){const{environment:t,spaceId:n,isNewlyCreatedSpace:o}=e,i=K.subscriptionDataStoreInstance.spaceId;if(!t.currentUser.isLoggedIn()||i&&i===n)await K.subscriptionDataStoreInstance.waitUntilLoaded();else if(C.Z.setState({}),Q({environment:t,spaceId:n}),o){const e={type:"unsubscribed_admin",users:[],bots:[],joinedMemberIds:[],blockUsage:0,hasPaidNonzero:!1,accountBalance:0,timelineViewUsage:0,inviteLinkCode:"",userSimilarity:{},spaceUsers:[],members:[],customerData:void 0,revenueCatEnabled:!1,addOns:[],currencyCode:void 0};K.subscriptionDataStoreInstance.setState(e),K.subscriptionDataStoreInstance.spaceId=n,F.p.setState(e.userSimilarity),he(t)}else he(t)}async function he(e){var t;const n=null===(t=I.default.state.currentSpaceStore)||void 0===t?void 0:t.id,o=e.currentUser.id;if(!n)throw new Error("No spaceId.");{const t=`${ne}:${n}:v2`,a=r.Z.get({userId:o,key:t});a&&(K.subscriptionDataStoreInstance.setState(a),K.subscriptionDataStoreInstance.spaceId=n,F.p.setState(a.userSimilarity)),await async function(e){let{environment:t,spaceId:n,currentUserId:o,localKey:a}=e;o&&U.default.initializeAndLoadAllUserSignals({environment:t,userId:o,spaceId:n});await M.transactionQueue.drain();const[s,l]=await Promise.all([m.getSubscriptionData(t,{spaceId:n}),m.getVisibleUsers(t,{spaceId:n})]);if("success"===s.type&&"success"===l.type){var c;const e={...s.data,...l.data};r.Z.set({userId:o,key:a,value:e}),(null===(c=I.default.state.currentSpaceStore)||void 0===c?void 0:c.id)===n&&(K.subscriptionDataStoreInstance.setState(e),K.subscriptionDataStoreInstance.spaceId=n,F.p.setState(e.userSimilarity),z.YK(e)&&p.jw(t))}else i.log({level:"error",from:"subscriptionActions",type:"fetchSubscriptionDataFailed",data:{miscDataToConvertToString:{getSubscriptionDataResponseType:s.type,getSubscriptionDataResponseStatus:s.status,getVisibleUserResponseType:l.type,getVisibleUserResponseStatus:l.status}}});await Promise.all([P.Z.awaitData(t,{spaceId:n},!0),b.E0.loader().then((e=>{let{completionActions:o}=e;return o.updateAiEligibility(t,n)}))])}({environment:e,spaceId:n,currentUserId:o,localKey:t})}}function ve(e){var t;const n=null===(t=I.default.state.currentSpaceStore)||void 0===t?void 0:t.id;if(!n)throw new Error("No spaceId.");return B.Z.resetData(e,{spaceId:n})}async function be(e,t){const n=I.default.state.currentSpaceStore;if(!n)return;const o=await m.getBillingHistory(e,{spaceId:n.id,limit:t.state.billingEventsLimit});"success"===o.type&&t.update((e=>({...e,billingEvents:o.data.events})))}async function ye(e,t){await he(t),await ve(t),H.Z.reset();const n=()=>{g.showMessage({message:S.default.formatMessage(ie.educationPlusFree)}),R.Z.setState({...R.Z.state,currentTab:"billing",defaultSubtab:void 0});const n=z.XX(e);p.jh(t,{plan:"student_free",old_plan:n?n.plan:void 0})};await v.shouldCreatePassword(t)?w.E({environment:t,onSubmit:n,onCancel:n}):n()}function _e(e){const t=K.subscriptionDataStoreInstance.state;if(e.device.isMobileNative&&e.device.isIOS)return!0;if(e.device.isMobileNative&&e.device.isAndroid&&!x.default.checkGate("android_native_blocks"))return!0;if(t){if((0,O.du)())return!0;if(z.Ln(e,t))return p.lj(e),function(e){if((0,O.du)())return;f.Bw({id:"SubscriptionEditingBlocker",bannerStore:T.Z,styleKey:y.v.Red,contentKey:"over_free_block_limit"})}(),!1;z.XZ(e,t)&&p.z2(e)}if((0,O.e0)()){var n;const e=I.default.state.currentSpaceStore,t=null==e?void 0:e.getOverdueSubscription(),i=C.Z.state.visible_banners,r=z.aS(K.subscriptionDataStoreInstance.state),a=null==r||null===(n=r.testClock)||void 0===n?void 0:n.frozen_time,l=a?o.ou.fromSeconds(a):o.ou.now(),{paymentStatus:c}=s.cS({now:l,overdueSubscription:t});if("unpaid"===c)return!1;if(e&&i&&i.length>0){const t=i[0];if("uncollectible_unpaid"===A.$I.createChildStore(e,{id:t,table:"subscription_banner",spaceId:e.id}).getBannerKey())return!1}}return f.qL({bannerStore:T.Z,id:"SubscriptionEditingBlocker"}),!0}function Se(e,t){const{subscriptionTier:n,from:o,addOnFeature:i,coupon:r,isTrial:a}=t,s=(0,u.ZP)();p.Lc(e,{subscriptionTier:n,from:o,addOnFeature:i,currency_code:H.Z.state.selectedCurrencyCode,isTrial:a,modal_id:s});const l=i||a||!O.F4()?"month":"year";D.Z.open({subscriptionTier:n,billingInterval:l,addOnFeature:i,coupon:r,isTrial:a,sessionId:s})}function we(e){const t=D.Z.state;t.open&&(p.LY(e,{modal_id:t.sessionId}),D.Z.setState({open:!1}))}function ke(e){W.Z.open(e)}function Ie(e){return"stripeToken"===(null==e?void 0:e.type)?e.value:void 0}function Ce(e){return"paymentMethodId"===(null==e?void 0:e.type)?e.value:void 0}async function xe(e){const{environment:t,product:n,spaceStore:o,spaceSubscriptionPlansStore:i,data:r,from:s,pageSection:l,churnState:c}=e,u=await L.aQ({environment:t,spaceId:o.id}),p=(0,j.P)(u,r),m=p.subscription;if(!m||!z.MM(r))return void Se(t,{subscriptionTier:n,from:s});const f=(0,O.bU)()?(0,a.Lg)(p):(0,a.iv)(p),g=(0,a.bs)(m),h=(0,a.Hw)(f),v=(0,a.Hw)(m),b=h??v,y=(0,a.Pc)(f),_=(0,a.Pc)(m),S=y??_;let w;if("free"===n)w=(0,N.t4)(f,"plan");else{if(!(g&&b&&S))throw new Error("Trying to update plan on a subscription with no items");{const e={product:n,currency:g,interval:b,quantity:S};w=(0,N.dP)(u,f,e)}}if(!d.Xy(f,w)){if((0,N._D)(f,w)){let e=c;if(e||(e=await async function(e){const{spaceSubscriptionPlansStore:t,product:n}=e;let o="churn_by_end_of_billing_period";t&&(o=await new Promise((e=>{t.setState({...t.state,churnType:n,churnSurveyModalOpen:!0,onAccept:t=>{e(t?"churn_immediately":"churn_by_end_of_billing_period")},onClose:()=>e("no_churn")})})));return o}({spaceSubscriptionPlansStore:i,product:n})),"no_churn"===e)return;return 0===w.items.length?await le({environment:t,spaceStore:o,planType:"personal",from:s,cancelImmediately:"churn_immediately"===e}):await re({environment:t,spaceStore:o,desiredState:w,from:s})}return ee.af({environment:t,from:s,view:"plans",temporarySubscriptionTier:n,billingInterval:b,pageSection:l})}}async function Te(e){h.j({message:ie.finishingUp});const{paymentIntentData:t,stripe:n,onSuccess:o,onFailure:i}=e,r=t.paymentIntentClientSecret;let a=t.paymentIntentStatus;if(r&&"requires_action"===a){const{paymentIntent:e,error:t}=await n.handleNextAction({clientSecret:r});e?a=e.status:null!=t&&t.payment_intent&&(a=t.payment_intent.status)}"succeeded"===a||"processing"===a?null==o||o():s.Ym({status:a})&&(null==i||i()),h.x()}},40469:(e,t,n)=>{n.d(t,{SP:()=>v,W_:()=>f,l_:()=>g,nf:()=>h});var o=n(19234),i=n(31919),r=n(47425),a=n(54642),s=n(27242),l=n(88893),c=n(63423),d=n(62142),u=n(33493),p=n(25692),m=n(88280);async function f(e){const t=s.Z.state,n=m.subscriptionDataStoreInstance.state;if(!t.open||!n)return;const i=t.temporaryAddress;if(!(0,o.A)(i))return;s.Z.update((e=>({...e,calculatingTax:!0})));const{planAmount:r,promoInfo:c,accountBalance:d}=(0,l.uN)({promo:t.appliedPromo,currencyCode:u.Z.selectedCurrencyCode,data:n,addOnFeature:t.addOnFeature,onlyShowAddOn:t.onlyShowAddOn,subscriptionTier:t.subscriptionTier,taxAmount:t.taxAmount,calculatingTax:t.calculatingTax,billingInterval:t.temporaryBillingInterval??"year",coupon:t.coupon}),p=Math.max(0,r-c.amount+d),f=await a.calculateTax(e,{address:i,price:p,vatId:t.vatApplicable?t.temporaryVatCode:void 0,customerId:"subscribed_admin"===n.type?n.customerData.stripe.customerId:void 0});if("failed"===f.type)s.Z.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})));else{const e=f.data;e.valid?s.Z.update((t=>({...t,taxAmount:e.taxAmount,calculatingTax:!1,taxCalculationError:void 0}))):s.Z.update((t=>({...t,taxAmount:void 0,calculatingTax:!1,taxCalculationError:e.error})))}}async function g(e){var t;const n=d.Z.state,r=m.subscriptionDataStoreInstance.state;if(!n.open||!r)return;const s=n.temporaryAddress;if(!(0,o.A)(s))return;d.Z.update((e=>({...e,calculatingTax:!0})));const l=(null===(t=n.totalUpgradeCost)||void 0===t?void 0:t.amount)||0,c=await a.calculateTax(e,{address:s,price:l,vatId:n.vatApplicable?n.temporaryVatCode:void 0,customerId:"subscribed_admin"===r.type?r.customerData.stripe.customerId:void 0});if("failed"===c.type)d.Z.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})));else{const e=c.data;e.valid?d.Z.update((t=>({...t,taxAmount:i.n.fromValue({amount:e.taxAmount,currencyCode:u.Z.selectedCurrencyCode}),calculatingTax:!1,taxCalculationError:void 0}))):d.Z.update((t=>({...t,taxAmount:void 0,calculatingTax:!1,taxCalculationError:e.error})))}}async function h(e){const{environment:t,priceForTaxCalculation:n,address:o,customerId:i,vatId:r}=e,s=c.Z.state,l=await a.calculateTax(t,{address:o,customerId:i,vatId:r,price:n});if("failed"===l.type);else{const e=l.data;e.valid&&s.open&&c.Z.update((t=>({...t,tax:Math.max(0,e.taxAmount)})))}}async function v(e){var t;const n=p.Z.state,i=m.subscriptionDataStoreInstance.state;if(!n.open||!i)return;if("subscribed_admin"!==i.type&&"unsubscribed_admin"!==i.type)return;const s=null===(t=i.customerData)||void 0===t?void 0:t.stripe;if(!s)return;const c=s.address;if(!c||!(0,o.A)(c))return;p.Z.update((e=>({...e,calculatingTax:!0})));const d=n.temporarySubscriptionTier??n.subscriptionTier,f=(0,r.QM)(d)&&n.addOnFeature?"month":"year",g=n.temporaryBillingInterval??n.billingInterval??f,h=!(0,r.QM)(d)&&Boolean(n.addOnFeature),{payAmount:v}=(0,l.uN)({promo:void 0,currencyCode:u.Z.selectedCurrencyCode,data:i,addOnFeature:n.addOnFeature,onlyShowAddOn:h,subscriptionTier:d,taxAmount:n.taxAmount,calculatingTax:n.calculatingTax,billingInterval:g,coupon:n.coupon}),b=await a.calculateTax(e,{address:c,price:v.amount,vatId:s.vatId,customerId:s.customerId});if("failed"===b.type)return void p.Z.update((e=>({...e,taxAmount:void 0,calculatingTax:!1,taxCalculationError:b.error})));const y=b.data;y.valid?p.Z.update((e=>({...e,taxAmount:y.taxAmount,calculatingTax:!1}))):p.Z.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})))}},64891:(e,t,n)=>{n.d(t,{Mg:()=>P,OT:()=>M,Zo:()=>R,af:()=>C,bX:()=>T,cM:()=>x,y5:()=>A});var o=n(9182),i=n(7032),r=n(86572),a=n(54642),s=n(47307),l=n(92625),c=n(91376),d=n(64964),u=n(80444),p=n(70060),m=n(5682),f=n(40670),g=n(58333),h=n(88893),v=n(35057),b=n(87598),y=n(33493),_=n(25692),S=n(88280),w=n(22616),k=n(81023),I=n(40469);function C(e){const{environment:t,from:n,view:o,temporarySubscriptionTier:a,temporaryBillingInterval:s,billingInterval:l,addOnFeature:c,pageSection:d,onSuccess:u}=e,p=(0,i.ZP)();r.YT(t,{from:n,pageSection:d,view:o,modal_id:p,currency_code:y.Z.selectedCurrencyCode}),_.Z.setState({open:!0,modalId:p,view:o,subscriptionTier:(0,v.zt)(),temporarySubscriptionTier:a,billingInterval:l,temporaryBillingInterval:s,calculatingTax:!1,isExpandedView:!1,addOnFeature:c,onSuccess:u}),I.SP(t)}function x(e){const t=_.Z.state;t.open&&(r.q7(e,{state:t}),_.Z.setState({open:!1}))}function T(e){const t=_.Z.state;t.open&&(r.y$(e,{state:t}),_.Z.setState({...t,isExpandedView:!0}))}function M(e){const t=_.Z.state;t.open&&(r.k1(e,{state:t}),_.Z.setState({...t,isExpandedView:!1}))}async function P(e,t,n){const i=u.default.state.currentSpaceStore;if(!i)return;const a=_.Z.state;if(!a.open)return;r.nd(e,{state:a});const{view:s,onSuccess:l}=a,c=S.subscriptionDataStoreInstance.state,v=await w.aQ({spaceId:i.id,environment:e}),b=(0,m.P)(v,c),I=(0,p.bU)()?(0,o.Lg)(b):(0,o.iv)(b),C=a.temporarySubscriptionTier,T=a.addOnFeature,M=a.temporaryBillingInterval??"year",P=(0,o.Hw)(I)??a.billingInterval??"year",A=y.Z.selectedCurrencyCode,R=c?(0,h.su)(c):1;let D,E=I;if("add_ons"===s&&T){const e={product:T,interval:P,currency:A,quantity:R};E=(0,g.dP)(v,E,e),D=f.aQ({addOnFeature:T})}else if("billing_interval"===s)E=(0,g.Zl)(v,E,M),D=f.Nj({billingInterval:M});else{if("plans"!==s||!C)return void x(e);{const e={product:C,interval:P,currency:A,quantity:R};E=(0,g.dP)(v,E,e),D=f.s6({newTier:C})}}const B=await k.Mg({environment:e,from:"space_settings-plans_tab",spaceStore:i,desiredState:E,inAppOffer:n});await k.KD({paymentIntentData:B,stripe:t,onSuccess:l}),x(e),D&&d.oV(D)}async function A(e){var t;const{environment:n,customerData:i}=e,r=u.default.state.currentSpaceStore;if(!r)return;const l=await w.aQ({spaceId:r.id,environment:n}),c=(0,m.P)(l,i);if(null===(t=c.subscription)||void 0===t||!t.pending)return s.showErrorMessage((0,f.iS)());if(!r)return s.showErrorMessage((0,f.iS)());const p=(0,f.dY)(i);let g;if(i.willCancelAt){const e=(0,o.iv)(c);await k.Mg({environment:n,from:"space_settings-billing_tab",spaceStore:r,desiredState:e}),g={type:"success"}}else{if(!p)return s.showErrorMessage((0,f.iS)());g=await a.releaseSubscriptionSchedule(n,{id:p})}return"success"===g.type?(d.oV({label:(0,f.UW)()}),await k.bi(n)):s.showErrorMessage((0,f.iS)())}async function R(e){const t=u.default.state.currentSpaceStore;t&&(l.j({message:b.z.cancellingTrial}),await k.EO({environment:e,spaceStore:t,planType:t.getPlanType()??"personal",from:"space_settings-plans_tab"}),l.x(),c.r$({currentTab:"billing"}))}},5682:(e,t,n)=>{n.d(t,{P:()=>s});n(21703);var o=n(30120),i=n(53965),r=n(1898),a=n(88893);function s(e,t){var n;const i=c(t),a=null==i?void 0:i.customerId,s=null==i||null===(n=i.testClock)||void 0===n?void 0:n.frozen_time,d=s?o.ou.fromSeconds(s):o.ou.now(),u=null==i?void 0:i.billingEmail,p=null==i?void 0:i.address,m=function(e,t,n){if(!n)return;const i=n.subscriptionId,a="trialEnd"in n?n.trialEnd:void 0,s=a&&a>t.toSeconds()?o.ou.fromSeconds(a):void 0,c="periodEnd"in n?n.periodEnd??0:0,d=o.ou.fromSeconds(c),u=function(e,t,n){var i;if(n.willCancelAt){return{items:[],startDate:o.ou.fromMillis(n.willCancelAt)}}if("trialEnd"in n&&n.trialEnd){return{items:l(e,n),startDate:o.ou.fromSeconds(n.trialEnd)}}if(!(0,r.$K)(n.schedule))return;const a=(null==n||null===(i=n.schedule)||void 0===i?void 0:i.phases)??[],s=a.find((e=>o.ou.fromSeconds(e.start_date)>t));if(!(0,r.$K)(s))return;const c=s.items.map((t=>{const n=e.find((e=>e.externalId===t.price.id));if(!n)throw new Error(`Unable to find price for priceId: ${t.price.id}`);return{quantity:t.quantity,price:n}}));return{items:c,startDate:o.ou.fromSeconds(s.start_date)}}(e,t,n),p=l(e,n);if(!n.isSubscribed&&0===p.length)return;return{externalId:i,trialEnd:s,currentPeriodEnd:d,items:p,pending:u}}(e,d,i);return{externalId:a,now:d,email:u,address:p,subscription:m}}function l(e,t){const n=t.quantity??1,o="plan"in t?t.plan:void 0,r=o?e.find((e=>e.externalId===o)):void 0,a=r?{price:r,quantity:n}:void 0;if(o&&!a)throw new Error(`Unable to find price for plan priceId: ${o}`);return t.addOns.map((t=>{const o=e.find((e=>e.externalId===t.priceId));if(!o)throw new Error(`Unable to find price for addOn priceId: ${t.priceId}`);return{price:o,quantity:n}})).concat((0,i.oA)([a]))}function c(e){return(0,r.$K)(e)?"type"in e?(0,a.aS)(e):e:void 0}},40670:(e,t,n)=>{n.d(t,{Nj:()=>M,Tg:()=>w,UW:()=>_,YZ:()=>C,Z_:()=>k,aQ:()=>P,dY:()=>S,iS:()=>y,rO:()=>I,s6:()=>T});n(57658),n(67294);var o=n(13991),i=n(7057),r=n(36591),a=n(9182),s=n(47425),l=n(9291),c=n(1898),d=n(33929),u=n(88893),p=n(85893);const m=(0,l.defineMessages)({cancellationError:{id:"midtermSubscriptionHelpers.cancellationFailed",defaultMessage:"There was an error attempting to cancel your pending changes. Please try again."},unableToCancelError:{id:"midtermSubscriptionHelpers.unableToCancel",defaultMessage:"We cannot cancel your scheduled changes right now. Please contact support for more help."},cancellationSuccess:{id:"midtermSubscriptionHelpers.cancellationSucceeded",defaultMessage:"Pending changes have been canceled"},invalidSubscriptionId:{id:"midtermSubscriptionHelpers.invalidSubscriptionId",defaultMessage:"Unable to cancel your pending changes. Something was wrong with your pending subscription changes."}});function f(e){return(0,s.QM)(e)?"free":(0,s.iJ)(e)?"education":(0,s.Aw)(e)?"singlePlayerPlus":(0,s.eR)(e)?"plus":(0,s.NG)(e)?"business":(0,u.gG)(e)?"enterprise":"legacy"}const g=(0,l.defineMessages)({personalFreePlan:{defaultMessage:"Personal Plan",id:"personalFreePlan.title"},personalFree:{defaultMessage:"Personal",id:"personalFree.title"},teamTrialPlan:{defaultMessage:"Team Plan (Trial)",id:"teamTrialPlan.title"},freePlan:{defaultMessage:"Free Plan",id:"freePlan.title"},free:{defaultMessage:"Free",id:"free.title"},personalPlan:{defaultMessage:"Personal Pro Plan",id:"personalPlan.label"},personal:{defaultMessage:"Personal Pro",id:"personal.label"},singlePlayerPlusPlan:{defaultMessage:"Plus Plan with a 1-member limit",id:"singlePlayerPlusPlan.title"},educationPlan:{defaultMessage:"Personal Pro Plan (Education)",id:"personalEducationPlan.title"},educationPlusPlan:{defaultMessage:"Education Plus Plan",id:"educationPlusPlan.title"},teamPlan:{defaultMessage:"Team Plan",id:"teamPlan.title"},team:{defaultMessage:"Team",id:"team.title"},plusPlan:{defaultMessage:"Plus Plan",id:"plusPlan.title"},plus:{defaultMessage:"Plus",id:"plus.title"},businessPlan:{id:"businessPlan.title",defaultMessage:"Business Plan"},business:{id:"business.title",defaultMessage:"Business"},enterprisePlan:{defaultMessage:"Enterprise Plan",id:"enterprisePlan.label"},enterprise:{defaultMessage:"Enterprise",id:"enterprise.label"},legacyPlan:{defaultMessage:"Legacy Plan",id:"legacyPlan.label"}}),h={free:{planTitle:g.freePlan},singlePlayerPlus:{planTitle:g.plusPlan},education:{planTitle:g.educationPlusPlan},plus:{planTitle:g.plusPlan},business:{planTitle:g.businessPlan},enterprise:{planTitle:g.enterprisePlan},legacy:{planTitle:g.legacyPlan}},v=(0,l.defineMessages)({notionAI:{defaultMessage:"Notion AI",id:"notionAI.title"},removeAI:{defaultMessage:"Remove AI",id:"notionAI.remove.title"}}),b=(0,l.defineMessages)({month:{defaultMessage:"Monthly billing",id:"billingInterval.monthly"},year:{defaultMessage:"Annual billing",id:"billingInterval.annual"}});function y(){return d.default.formatMessage(m.unableToCancelError)}function _(){return d.default.formatMessage(m.cancellationSuccess)}function S(e){var t;return null===(t=e.schedule)||void 0===t?void 0:t.id}function w(e){const t=function(e){var t;const n=null==e||null===(t=e.subscription)||void 0===t?void 0:t.pending;if(!n)return;const o=(0,a.iv)(e),i=(0,a.Lg)(e);return{oldTier:(0,a.zt)(o)??"free",newTier:(0,a.zt)(i)??"free",oldAddOn:(0,a.xi)(o)[0],newAddOn:(0,a.xi)(i)[0],oldInterval:(0,a.Hw)(o),newInterval:(0,a.Hw)(i),phaseOneEndDate:n.startDate}}(e),n=[];if(!t)return{scheduledChanges:n,periodEndDate:null};const{newTier:o,oldTier:i,oldAddOn:r,newAddOn:s,oldInterval:l,newInterval:c,phaseOneEndDate:u}=t;return i!==o&&n.push(function(e,t){const n=f(e),o=d.default.formatMessage(h[n].planTitle);if(!t)return"";const i=f(t);return`${o} â†’ ${d.default.formatMessage(h[i].planTitle)}`}(i,o)),r!==s&&n.push(function(e,t){return`${d.default.formatMessage(e?v.notionAI:v.removeAI)} â†’ ${d.default.formatMessage(t?v.notionAI:v.removeAI)}`}(r,s)),l!==c&&n.push(function(e,t){return e&&t?`${d.default.formatMessage("month"===e?b.month:b.year)} â†’ ${d.default.formatMessage("month"===t?b.month:b.year)}`:""}(l,c)),{scheduledChanges:n,periodEndDate:u}}function k(e,t,n){return"billing_interval"===e&&"year"===t&&"month"===n}function I(e,t,n){return"plans"===e||"add_ons"===e||"billing_interval"===e&&"month"===t&&"year"===n}function C(e,t){if(!e)return;const n=(0,a.iv)(e).items,o=(0,a.Lg)(e).items;var i;return(0,a.dK)(n,o).some((e=>{let[n,o]=e;return(0,a.tw)(n??o)===t&&n&&!o}))?null===(i=e.subscription)||void 0===i||null===(i=i.pending)||void 0===i?void 0:i.startDate:void 0}function x(e){return(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,r.e)({width:12}),e.children]})}function T(e){const{newTier:t}=e;switch(t){case"plus":return{label:(0,p.jsx)(x,{children:(0,p.jsx)(l.FormattedMessage,{id:"midtermChangeHelpers.snackbar.upgradePlan.plus",defaultMessage:"You have successfully upgraded to the Plus plan"})})};case"business":return{label:(0,p.jsx)(x,{children:(0,p.jsx)(l.FormattedMessage,{id:"midtermChangeHelpers.snackbar.upgradePlan.business",defaultMessage:"You have successfully upgraded to the Business plan"})})};case"enterprise":return{label:(0,p.jsx)(x,{children:(0,p.jsx)(l.FormattedMessage,{id:"midtermChangeHelpers.snackbar.upgradePlan.enterprise",defaultMessage:"You have successfully upgraded to the Enterprise plan"})})};case"student":return{label:(0,p.jsx)(x,{children:(0,p.jsx)(l.FormattedMessage,{id:"midtermChangeHelpers.snackbar.upgradePlan.student",defaultMessage:"You have successfully upgraded to the Student plan"})})};case"free":case"personal":case"personal_free":case"team_free":return;default:(0,c.t1)(t)}}function M(e){const{billingInterval:t,effectiveDateEpochMs:n}=e,r=n?(0,i.Yx)(n,"medium",o.SP):void 0;return r?{label:(0,p.jsx)(l.FormattedMessage,{id:"midtermChangeHelpers.snackbar.billingInterval.future",defaultMessage:"{billingInterval, select, year {Yearly} other {Monthly}} billling will be effective {date}",values:{billingInterval:t,date:r}})}:{label:(0,p.jsx)(x,{children:(0,p.jsx)(l.FormattedMessage,{id:"midtermChangeHelpers.snackbar.billingInterval.success",defaultMessage:"You have successfully changed to {billingInterval, select, year {yearly} other {monthly}} billing",values:{billingInterval:t}})})}}function P(e){const{addOnFeature:t}=e;if("ai"===t)return{label:(0,p.jsx)(x,{children:(0,p.jsx)(l.FormattedMessage,{id:"midtermChangeHelpers.snackbar.purchaseAddOn.ai",defaultMessage:"You have successfully added Notion AI"})})};(0,c.t1)(t)}},70060:(e,t,n)=>{n.d(t,{Ax:()=>u,F4:()=>T,G2:()=>A,Gb:()=>d,Gr:()=>h,Gz:()=>L,IC:()=>M,Pw:()=>B,R$:()=>O,XA:()=>F,bP:()=>E,bQ:()=>k,bU:()=>Z,du:()=>g,e0:()=>P,fQ:()=>y,fX:()=>D,fc:()=>U,fw:()=>b,i4:()=>I,j9:()=>S,nz:()=>v,oP:()=>_,px:()=>w,rq:()=>x,rs:()=>j,uO:()=>V,xN:()=>C,zS:()=>R});var o=n(44317),i=n(47425),r=n(80444),a=n(77080),s=n(88280),l=n(88893),c=n(35057);function d(){const e=s.subscriptionDataStoreInstance.state;return!((0,l.YK)(e)&&!(0,l.vS)(e))&&Boolean(a.default.checkGate("ai_annual"))}function u(){return Boolean("on"===a.default.getGroup("ai_annual_default"))}const p=7,m=-1;function f(){const{currentSpaceStore:e}=r.default.state,t=null==e?void 0:e.getSettings().first_invited_member_time;return t?(0,o.O5)(t):null}function g(){const e=f();return null!==e&&(!(null!==e&&e>p)&&"on"===a.default.getEligibleGroup({experimentId:"block_limit_delay",defaultGroup:"control"}))}function h(){return Boolean("on"===a.default.getEligibleGroup({experimentId:"hide_block_limit_counter",defaultGroup:"unassigned"}))}function v(){var e;const{currentSpaceStore:t}=r.default.state;return!(null==t||null===(e=t.getSettings())||void 0===e||!e.exposed_to_hide_block_limit_counter)&&h()}function b(){var e;const t=null===(e=r.default.state.currentSpaceStore)||void 0===e?void 0:e.getSettings();return null!=t&&t.seen_block_limit_reduction_v2&&"on"===a.default.getEligibleGroup({experimentId:"block_limit_reduction"})?"decrease":null!=t&&t.seen_block_limit_increase&&"on"===a.default.getEligibleGroup({experimentId:"block_limit_increase"})?"increase":"normal"}function y(){const e=f();return null!==e&&p-e>0?p-e:m}function _(){return Boolean("on"===a.default.getGroup("churn_nudge"))}function S(){return Boolean(a.default.checkGate("new_contact_sales_modal"))}function w(e,t){var n;if(e.device.isMobile)return!1;const o=s.subscriptionDataStoreInstance.state;if(!o)return!1;if(("subscribed_admin"===o.type||"unsubscribed_admin"===o.type)&&null!==(n=o.customerData)&&void 0!==n&&n.stripe&&Boolean(o.customerData.stripe.promo))return!1;const r=t??(0,c.zt)();return!!((0,i.mq)(r)&&(0,l.su)(o)<100&&Boolean("on"===a.default.getGroup("largesse")))}function k(){return Boolean("on"===a.default.getGroup("mobile_web_subscriptions"))}function I(){return!!(C()||!(0,l.DB)(s.subscriptionDataStoreInstance.state)&&(0,c.QM)())&&Boolean("on"===a.default.getGroup("plans_page_refresh"))}function C(){return Boolean(a.default.checkGate("plans_page_refresh_m_1_5"))}function x(){return Boolean(a.default.checkGate("sepa_debit"))}function T(){return Boolean("on"===a.default.getGroup("subscription_default_annual"))}function M(){const e=a.default.getGroup("subscription_payment_status");return Boolean("on"===e||"message_only"===e)}function P(){return Boolean("on"===a.default.getGroup("subscription_payment_status"))}function A(){return Boolean(a.default.checkGate("test_clocks"))}function R(e,t){switch(e){case"affiliates":return function(e){return!e.device.isMobile&&Boolean(a.default.checkGate("tt_affiliates"))}(t);case"marketing":return function(e){return!e.device.isMobile&&Boolean(a.default.checkGate("tt_marketing"))}(t);case"upwork":return function(e){return!e.device.isMobile&&Boolean(a.default.checkGate("tt_upwork"))}(t);case"plus":case"business":return!0}}function D(){return Boolean(a.default.checkGate("advanced_security_in_enterprise"))}function E(e){return!e.device.isMobile&&Boolean("on"===a.default.getGroup("checkout_name_required"))}function B(e){return!e.device.isMobile&&Boolean("on"===a.default.getGroup("checkout_refresh"))}function F(e){return!e.device.isMobile&&Boolean("on"===a.default.getGroup("upsell_to_plans_page"))}function O(){return Boolean("on"===a.default.getGroup("upsell_colors"))}function Z(){return Boolean(a.default.checkGate("use_mp2_update_subscription_path",!0))}function V(){const e=Z(),t=Boolean(a.default.checkGate("can_remove_plan_without_removing_addon",!0));return e&&t}function U(){return Boolean(a.default.checkGate("low_guest_limit"))}function L(){return Boolean("on"===a.default.getGroup("guest_limit_policy"))}function j(){return Boolean("on"===a.default.getGroup("internal_domain_guests_in_settings"))}},58333:(e,t,n)=>{n.d(t,{AI:()=>u,Zl:()=>c,_D:()=>l,dP:()=>p,t4:()=>d,ug:()=>s});n(21703);var o=n(9182),i=n(47425),r=n(19584),a=n(70060);function s(e,t){if(!t)return{plan:void 0,addOns:[],isTrial:void 0};const n=e.items.find((e=>"plan"===(0,o.tw)(e))),i=e.items.filter((e=>"plan"!==(0,o.tw)(e))),r=t.items.find((e=>"plan"===(0,o.tw)(e))),s=t.items.filter((e=>"plan"!==(0,o.tw)(e))),l=n&&!r&&s.length>0,c=(0,a.uO)();if(l&&!c)throw new Error("Cancelling plan while updating addOns is not support by api.updateSubscription");return{isTrial:Boolean(t.trialEnd),plan:null==r?void 0:r.price.externalId,addOns:m(i,s).map((e=>{let[t,n]=e;return{isCancellation:!n,priceId:(n??t).price.externalId}}))}}function l(e,t){return m(e.items,t.items).some((e=>{let[t,n]=e;return function(e,t){if(!e)return!1;if(!t)return!0;const n=(0,o.H6)(e),r=(0,o.H6)(t);if(!n||!r)return!1;return i.rC[n]>i.rC[r]}(t,n)}))}function c(e,t,n){let{trialEnd:o,items:i}=t;return{trialEnd:o,items:i.map((t=>{const o=t.price.product,i=t.price.unitAmount.currencyCode,r=f(e,{interval:n,product:o,currency:i});return{...t,price:r}}))}}function d(e,t){const n=(0,a.uO)();if("plan"===t&&!n)return{...e,items:[]};const i=e.items.filter((e=>(0,o.tw)(e)!==t));return{...e,items:i}}function u(e,t){const n=e.items.filter((e=>(0,o.tw)(e)!==(0,o.tw)(t)));return{...e,items:n.concat([t])}}function p(e,t,n){const{quantity:i,product:r,interval:a,currency:s}=n,l=function(e){if("personal_free"===e||"team_free"===e)return"free";return e}(r),c=t.items.filter((e=>(0,o.tw)(e)!==(0,o.h_)(l))),d={quantity:i,price:f(e,{interval:a,product:l,currency:s})};return{...t,items:c.concat([d])}}function m(e,t){return(0,r.UV)(e,(e=>(0,o.tw)(e)),t,(e=>(0,o.tw)(e)))}function f(e,t){let{interval:n,product:o,currency:i}=t;return function(e,t){if(null==e)throw new Error(t);return e}(e.find((e=>e.product===o&&e.billingInterval===n&&e.unitAmount.currencyValue.currencyCode===i)),`Unable to find price with interval: ${n}, product: ${o}, currency: ${i}`)}},88893:(e,t,n)=>{n.d(t,{A7:()=>me,AX:()=>X,AY:()=>C,Bu:()=>V,CM:()=>he,DB:()=>Z,DH:()=>F,Et:()=>K,Fu:()=>Se,GD:()=>J,GJ:()=>P,Gh:()=>W,Io:()=>ge,KU:()=>M,Ln:()=>ye,Lz:()=>$,M9:()=>ee,MM:()=>H,Md:()=>Q,ND:()=>le,NM:()=>re,NW:()=>oe,Nf:()=>xe,Ns:()=>fe,Q6:()=>ve,SX:()=>z,Tj:()=>k,VF:()=>I,XX:()=>x,XZ:()=>q,YK:()=>O,_9:()=>be,aS:()=>T,cA:()=>ae,gG:()=>D,hn:()=>de,lk:()=>ce,lo:()=>ne,m_:()=>_e,o9:()=>we,pu:()=>Y,qF:()=>U,qX:()=>pe,qb:()=>N,ri:()=>B,su:()=>ue,t1:()=>Ie,uN:()=>ie,vS:()=>R,wY:()=>E,wl:()=>A,xP:()=>w,xR:()=>G,y$:()=>ke,ye:()=>j,zl:()=>se});n(57658),n(67294);var o=n(72141),i=n(60897),r=n(90965),a=n(3791),s=n(31919),l=n(2438),c=n(47425),d=n(9291),u=n(53965),p=n(1898),m=n(95477),f=n(52533),g=n(80444),h=n(81236),v=(n(27242),n(88280)),b=n(70060),y=n(33941),_=n(35057),S=n(85893);const w=.75,k=.9,I=1;function C(e){var t;if(P(e))return null===(t=e.customerData)||void 0===t||null===(t=t.stripe)||void 0===t?void 0:t.paymentMethodTrustLevel}function x(e){if(e&&"subscribed_admin"===e.type&&function(e){return void 0!==e.billing}(e.customerData.stripe))return e.customerData.stripe}function T(e){var t;if(P(e))return null===(t=e.customerData)||void 0===t?void 0:t.stripe}function M(e){const t=T(e);return null==t?void 0:t.customerId}function P(e){return"subscribed_admin"===(null==e?void 0:e.type)||"unsubscribed_admin"===(null==e?void 0:e.type)}function A(e){return e&&function(e){const t=x(e);if(t)return t.productId}(e)===m.default.pricing.student.productId}function R(e){const t=x(e),n=t?t.plan:void 0;return Boolean(n&&i.Du.includes(n))}function D(e){return e.startsWith("enterprise")}function E(e){return Boolean(e&&"subscribed_admin"===e.type&&e.customerData&&"revenueCat"===e.customerData.activeSubscriptionPlatform&&e.customerData.revenueCat&&!0===e.customerData.revenueCat.isSubscribed)}function B(e){return"verifying"===C(e)}function F(e){const t=x(e);return t&&"number"==typeof t.canceledAt&&"number"==typeof t.willCancelAt}function O(e){return Boolean(e&&"unsubscribed_admin"!==e.type&&"unsubscribed_member"!==e.type&&"unsubscribed_guest"!==e.type)}function Z(e){return!!e&&(O(e)||(0,a.E3)(e.addOns))}function V(e){return!O(e)}function U(e){return!Ce(e,["personal","student","personal_free"])}function L(e){return(0,_.QM)()}function j(){return(0,_.mq)()}function N(e,t){return t===(0,_.zt)()}function z(e,t){return se(e,t)>=w}function q(e,t){return se(e,t)>=w}async function W(e){const{environment:t,userRootStore:n}=e;if(!n)return;const o=n.getAdminSpaceIds().map((async e=>{const n=await h.Z.awaitData(t,{spaceId:e});return n&&n.productId})),i=await Promise.all(o);return u.oA(i)}function H(e){var t;const n="subscribed_admin"===(null==e?void 0:e.type)||"unsubscribed_admin"===(null==e?void 0:e.type)?null===(t=e.customerData)||void 0===t?void 0:t.stripe:void 0;return Boolean(null==n?void 0:n.paymentMethodType)}function K(e){const t=x(e);return"unsubscribed_admin"===e.type||"unsubscribed_member"===e.type?e.accountBalance:t?t.accountBalance:0}function G(e){const{environment:t,userRootStore:n}=e;if(!n)return;const o=n.getAdminSpaceIds().map((e=>{const n=h.Z.getData(t,{spaceId:e});return n&&n.productId}));return u.oA(o)}function $(e,t){const n=ue(t)>1;return V(t)&&L()&&n?t.blockUsage:0}function Q(e,t){const{currentUserStore:n}=g.default.state,o=x(t),i=null!=n&&n.isDefined()?n.getEmail():void 0;return e.temporaryBillingEmail||("subscribed_admin"===t.type&&o?o.billingEmail:void 0)||i}function Y(){const e=v.subscriptionDataStoreInstance.state,{currentUserStore:t}=g.default.state,n=null!=t&&t.isDefined()?null==t?void 0:t.getEmail():void 0;if(!e)return n;const o=x(e);return"subscribed_admin"===e.type&&null!=o&&o.billing?o.billingEmail:n}function J(e){return e||"month"}function X(e){var t;return(null===(t=x(e))||void 0===t?void 0:t.interval)??"year"}function ee(e){return!!(0,_.QM)()&&((0,f.S$)({environment:e})?"personal":"plus")}function te(e){const{memberCount:t,subscriptionTier:n,addOnFeature:o,isAddOnFeature:i,billingInterval:r,coupon:a}=e,s=function(e){const{subscriptionTier:t,addOnFeature:n,isAddOnFeature:o}=e;if(!m.default.pricing)return;if(o&&void 0!==n)return m.default.pricing[n].productId;const i=m.default.pricing[t];if("productId"in i)return i.productId}({subscriptionTier:n,addOnFeature:o,isAddOnFeature:i});let l,c,d;return s===m.default.pricing.ai.productId?(l=m.default.pricing.ai.yearlyPricePerMember,c=m.default.pricing.ai.monthlyPricePerMember,"ai_fifty_percent"===a&&(l-=4800,c-=500),d="year"===r?l*t:c*t):s===m.default.pricing.personal.productId?(l=m.default.pricing.personal.yearlyPrice,c=m.default.pricing.personal.monthlyPrice,d="year"===r?l:c):s===m.default.pricing.plus.productId?(l=m.default.pricing.plus.yearlyPricePerMember,c=m.default.pricing.plus.monthlyPricePerMember,d="year"===r?l*t:c*t):s===m.default.pricing.business.productId?(l=m.default.pricing.business.yearlyPricePerMember,c=m.default.pricing.business.monthlyPricePerMember,d="year"===r?l*t:c*t):(l=m.default.pricing.enterprise.yearlyPricePerMember,c=m.default.pricing.enterprise.monthlyPricePerMember,d="year"===r?l*t:c*t),{yearlyUnitPrice:l,monthlyUnitPrice:c,planAmount:d}}function ne(e){var t;if(e&&e.isLoaded)return null===(t=e.result)||void 0===t||null===(t=t.getMonthlyUnitCost())||void 0===t?void 0:t.toMoneyValue()}function oe(e){const t=v.subscriptionDataStoreInstance.state;return e===m.default.pricing.personal.productId||E(t)?"personal":e===m.default.pricing.student.productId?"personal_education":e===m.default.pricing.plus.productId?"plus":e===m.default.pricing.business.productId?"business":e===m.default.pricing.enterprise.productId?"enterprise":e===m.default.pricing.ai.productId?"ai":"legacy"}function ie(e){const{subscriptionTier:t,currencyCode:n,promo:o,data:i,onlyShowAddOn:r,calculatingTax:a,taxAmount:c,addOnFeature:u,billingInterval:p,coupon:m}=e,f=ue(i),g=Math.min(0,K(i));let h=0,v=0,b=0;const y=void 0!==u;if(!r){const e=te({subscriptionTier:t,memberCount:f,isAddOnFeature:!1,billingInterval:p});h+=e.yearlyUnitPrice,v+=e.monthlyUnitPrice,b+=e.planAmount}if(y){const e=te({subscriptionTier:t,memberCount:f,isAddOnFeature:!0,addOnFeature:u,billingInterval:p,coupon:m});h+=e.yearlyUnitPrice,v+=e.monthlyUnitPrice,b+=e.planAmount}const _=(0,l.uN)(b,o),w=s.n.fromValue({amount:b-_.amount+g+(c&&!a?c:0),currencyCode:n}).zeroIfNegative(),k=[{type:"standard",name:(0,S.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.lineItems.subTotal",defaultMessage:"Subtotal"}),price:s.n.fromValue({amount:b,currencyCode:n})}];return k.push({type:a?"calculating":"standard",name:(0,S.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.lineItems.taxIfApplicable.title",defaultMessage:"Tax if applicable"}),price:s.n.fromValue({amount:b,currencyCode:n})}),0!==_.amount&&k.push({type:"promotion",name:(0,S.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.lineItems.promo",defaultMessage:"Coupon"}),price:s.n.fromValue({amount:_.amount,currencyCode:n}),subtitle:_.monthsRemaining?(0,S.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.lineItems.promo.subtitle",defaultMessage:"Valid for {durationInMonths} months",values:{durationInMonths:_.monthsRemaining}}):void 0}),g<0&&k.push({type:"promotion",name:(0,S.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.lineItems.balance",defaultMessage:"Balance"}),price:s.n.fromValue({amount:-g,currencyCode:n})}),{yearlyUnitPrice:h,monthlyUnitPrice:v,planAmount:b,payAmount:w,accountBalance:g,lineItems:k,promoInfo:_}}function re(e){return"bots"in e?e.bots:[]}function ae(e,t){if((0,b.du)()&&ye(e,t)){const e=(0,b.fQ)(),t=0===e?(0,S.jsx)(d.FormattedMessage,{id:"subscriptionSettings.subscriptionStatus.gracePeriodBlockLimitToday",defaultMessage:"to upgrade today"}):(0,S.jsx)(d.FormattedMessage,{id:"subscriptionSettings.subscriptionStatus.gracePeriodBlockLimitNumDays",defaultMessage:"{remainingDays, plural, one {1 day to upgrade} other {{remainingDays} days to upgrade}}",values:{remainingDays:e}});return(0,S.jsx)(d.FormattedMessage,{id:"subscriptionSettings.subscriptionStatus.gracePeriodBlockLimit",defaultMessage:"You've hit Notion's trial block limit, and you have {remainingDaysMessage} before we limit new content creation.",values:{remainingDaysMessage:t}})}return(0,S.jsx)(d.FormattedMessage,{id:"subscriptionSettings.subscriptionStatus.reachedFreeBlockLimit",defaultMessage:"This workspace has used {usedBlocks} of its {freeBlockLimit} block storage limit ({utilizationPercentage}).",values:{usedBlocks:$(0,t),freeBlockLimit:(0,c.v5)((0,b.fw)()),utilizationPercentage:(0,S.jsx)(d.FormattedNumber,{value:se(e,t),style:"percent",maximumSignificantDigits:2,maximumFractionDigits:0})}})}function se(e,t){return $(0,t)/(0,c.v5)((0,b.fw)())}function le(e){return he(e).filter(r.du)}function ce(e){return le(e).length}function de(e){return he(e).filter((e=>(0,o.Jy)(e.role)))}function ue(e){return de(e).length}function pe(){const e=v.subscriptionDataStoreInstance.state;return e?ue(e):1}function me(){const e=v.subscriptionDataStoreInstance.state;return e?le(e):[]}function fe(){const e=pe();return e<=99?"SMB":e<=1999?"Mid-Market":"Enterprise"}function ge(){const e=v.subscriptionDataStoreInstance.state;return e?de(e):[]}function he(e){return"visibleUsers"in e?e.visibleUsers:e.users}function ve(e){return Boolean(e&&"subscribed_admin"===e.type&&e.customerData&&e.customerData.stripe.isSubscribed&&i.Sf.includes(e.customerData.stripe.plan))}function be(e){return"unsubscribed_member"===e.type||"unsubscribed_admin"===e.type||"subscribed_member"===e.type||"subscribed_admin"===e.type||"subscribed_membership_admin"===e.type}function ye(e,t){return $(0,t)>=(0,c.v5)((0,b.fw)())}function _e(e){return c.wP(e)?"setup_enterprise_trial":c.NG(e)?"setup_business_trial":void 0}function Se(e){return!1}function we(e){return c.QM(e)}function ke(e){return!L()}function Ie(e,t){switch(e){case"personal_free":case"team_free":case"free":return t.formatMessage(y.a.free);case"personal":return t.formatMessage(y.a.personal);case"student":return t.formatMessage(y.a.educationPlus);case"plus":return t.formatMessage(y.a.plus);case"business":return t.formatMessage(y.a.business);case"enterprise":return t.formatMessage(y.a.enterprise);default:(0,p.t1)(e)}}function Ce(e,t){const n=(0,_.zt)();return!!n&&t.includes(n)}function xe(e){const{subscriptionData:t,spaceStore:n}=e;return!E(t)&&((null==n?void 0:n.canAdmin())??!1)}},33941:(e,t,n)=>{n.d(t,{D:()=>r,a:()=>i});var o=n(9291);const i=(0,o.defineMessages)({ai:{defaultMessage:"AI",id:"ai.title"},personalFreePlan:{defaultMessage:"Personal Plan",id:"personalFreePlan.title"},personalFree:{defaultMessage:"Personal",id:"personalFree.title"},teamTrialPlan:{defaultMessage:"Team Plan (Trial)",id:"teamTrialPlan.title"},freePlan:{defaultMessage:"Free Plan",id:"freePlan.title"},free:{defaultMessage:"Free",id:"free.title"},personalPlan:{defaultMessage:"Personal Pro Plan",id:"personalPlan.label"},personal:{defaultMessage:"Personal Pro",id:"personal.label"},personalForIos:{defaultMessage:"iOS Personal Pro",id:"personal.ios.label"},singlePlayerPlusPlan:{defaultMessage:"Plus Plan with a 1-member limit",id:"singlePlayerPlusPlan.title"},educationPlan:{defaultMessage:"Personal Pro Plan (Education)",id:"personalEducationPlan.title"},educationPlusPlan:{defaultMessage:"Education Plus Plan",id:"educationPlusPlan.title"},educationPlus:{defaultMessage:"Education Plus",id:"educationPlus.title"},teamPlan:{defaultMessage:"Team Plan",id:"teamPlan.title"},team:{defaultMessage:"Team",id:"team.title"},plusPlan:{defaultMessage:"Plus Plan",id:"plusPlan.title"},plus:{defaultMessage:"Plus",id:"plus.title"},businessPlan:{id:"businessPlan.title",defaultMessage:"Business Plan"},business:{id:"business.title",defaultMessage:"Business"},enterprisePlan:{defaultMessage:"Enterprise Plan",id:"enterprisePlan.label"},enterprise:{defaultMessage:"Enterprise",id:"enterprise.label"},legacyPlan:{defaultMessage:"Legacy Plan",id:"legacyPlan.label"}}),r=(0,o.defineMessages)({ai:{defaultMessage:"Notion AI",id:"spaceSubscriptionUpgradeModal.orderSummary.ai.addOn"},personal:{defaultMessage:"Plus plan with a 1-member limit",id:"spaceSubscriptionUpgradeModal.orderSummary.singlePlayerPlusPlan"},plus:{defaultMessage:"Plus plan",id:"spaceSubscriptionUpgradeModal.orderSummary.plusPlan"},business:{defaultMessage:"Business plan",id:"spaceSubscriptionUpgradeModal.orderSummary.businessPlan"},enterprise:{defaultMessage:"Enterprise plan",id:"spaceSubscriptionUpgradeModal.orderSummary.enterprisePlan"}})},35057:(e,t,n)=>{n.d(t,{Aw:()=>m,Mk:()=>u,QM:()=>d,Rs:()=>l,c4:()=>h,iJ:()=>f,mq:()=>p,p4:()=>g,sX:()=>s,wP:()=>c,zt:()=>a});var o=n(47425),i=n(88280),r=n(70060);function a(){var e;return o.O9(null===(e=i.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.subscriptionTier)}function s(){return o.sX(a())}function l(){return o.Rs(a())}function c(){return o.wP(a())}function d(){return o.QM(a())}function u(){return o.Mk(a())}function p(){return o.mq(a())}function m(){return o.Aw(a())}function f(){return o.iJ(a())}function g(e){return o.eZ(a(),e)}function h(e){return e?(0,r.fc)()?o.lu:o.kE(e.subscriptionTier??"free"):0}},87598:(e,t,n)=>{n.d(t,{z:()=>o});const o=(0,n(9291).defineMessages)({cancellingTrial:{defaultMessage:"Cancelling your trial.",id:"cancelTrial.error.message"},cancellationConfirmationMessage:{defaultMessage:"Are you sure you want to cancel your trial?",id:"cancelTrial.confirmation.message"},yes:{defaultMessage:"Yes, cancel my trial",id:"cancelTrial.yes.confirmation.message"}})},63423:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},62142:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(7032),r=n(27242);class a extends o.default{getInitialState(){return{open:!1,succeeded:!1}}close(){this.setState({open:!1,succeeded:!1})}closeWithSuccess(){this.setState({open:!1,succeeded:!0})}open(e){this.setState({open:!0,temporaryBillingInterval:"month",temporaryAddress:{name:"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""},appliedPromo:void 0,error:void 0,vatApplicable:!1,calculatingTax:!1,payButtonState:"disabled",subscriptionTier:"enterprise",targetPlan:void 0,targetSpace:e,totalUpgradeCost:void 0,onlyShowAddOn:!1,sessionId:(0,i.ZP)(),type:r.U.TargetSpace})}setAddressField(e){this.state.open&&this.setState({...this.state,temporaryAddress:{...this.state.temporaryAddress,...e},taxCalculationError:void 0})}}const s=new a},30221:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n(49085).default.createValue({open:!1})},33493:(e,t,n)=>{n.d(t,{Z:()=>d});n(21703);var o=n(49085),i=n(92595),r=n(64793),a=n(12139),s=n(80444),l=n(22616);class c extends o.default{constructor(){var e;let t,n;super(),e=this;const o=()=>{if("ready"!==this.state.status)return;const e=this.state.prices.map((e=>{const t=Math.floor(100*Math.random()),n=Math.floor(e.unitAmount.amount/100);return new r.tA({external_id:e.externalId,product:e.product,billing_interval:e.billingInterval,currency:e.currencyCode,state:e.state,regions:e.regions,unit_amount:100*n+t})}));this.setPrices(e)};(0,i.exposeDebugValue)("randomizePrices",(function(){let i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if("ready"!==e.state.status)return;i!==Boolean(n)&&(n&&(clearInterval(n),n=void 0),i?(t=e.state.prices,n=setInterval(o,1e3),o()):t&&e.setPrices(t))}))}getInitialState(){return{status:"init",prices:[],availableCurrencyCodes:["USD"],selectedCurrencyCode:void 0}}resetExceptSelectedCurrencyCode(){this.update((e=>({...this.getInitialState(),selectedCurrencyCode:e.selectedCurrencyCode})))}waitUntilReady(){return this.waitUntil((()=>"ready"===this.state.status))}setPrices(e){this.update((t=>{const n=Array.from(new Set(e.map((e=>e.currencyCode))));n.sort();const o=t.selectedCurrencyCode&&n.includes(t.selectedCurrencyCode)?t.selectedCurrencyCode:n.find((e=>"USD"!==e))??"USD";return{...t,status:"ready",prices:e,availableCurrencyCodes:n,selectedCurrencyCode:o}}))}didStartLoading(){this.update((e=>({...e,status:"loading"})))}getPrice(e,t){const{status:n,selectedCurrencyCode:o}=this.state;if("init"===n){var i;const t=null===(i=s.default.state.currentSpaceStore)||void 0===i?void 0:i.id;t&&l.Zz({environment:e,spaceId:t})}if("ready"!==n)return{isLoaded:!1,result:void 0};const r=this.state.prices,c=r.filter((e=>e.currencyCode===o)),d=c.find(t);return d||a.IE(new Error("No matching price found in PriceStore.getPrice"),{extra:{allPriceCount:r.length,selectedCurrencyCode:o,selectedCurrencyPriceCount:c.length}}),{isLoaded:!0,result:d}}get selectedCurrencyCode(){return this.state.selectedCurrencyCode??"USD"}get availableCurrencyCodes(){return this.state.availableCurrencyCodes}get prices(){return this.state.prices}}const d=new c},25692:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},88280:(e,t,n)=>{n.r(t),n.d(t,{SubscriptionDataStore:()=>i,subscriptionDataStoreInstance:()=>r});var o=n(49085);class i extends o.default{constructor(){super(...arguments),this.spaceId=void 0}getInitialState(){}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state)))}}const r=new i},99334:(e,t,n)=>{let o;function i(e){o=e}function r(){return o}n.d(t,{$:()=>i,K:()=>r})},28662:(e,t,n)=>{n.d(t,{m:()=>d});var o=n(67294),i=n(97511),r=n(86628),a=n(21202),s=n(85031),l=n(77080),c=n(6258);function d(e){const{parentStore:t}=e,n=(0,i.l)(),d=e.pageStore??(null==n?void 0:n.pageStore),u=t.getRecordModel,p=(0,r.VK)((()=>l.default.checkGate("toc_nested_headings")),[]),m=(0,r.VK)((()=>d?s.Q(d.id,u,p):[]),[d,u,p]),f=(0,o.useMemo)((()=>m.map((e=>c.G.createChildStore(t,{table:a.iU,id:e})))),[t,m]);return{navigableAncestor:d,headerStores:f}}},89579:(e,t,n)=>{n.d(t,{R:()=>s});var o=n(86628),i=n(15145),r=n(84210),a=n(85957);function s(e){const{scrollToBlockId:t,pageStore:n}=e,s=(0,o.VK)((()=>Boolean(n&&(0,a.wq)(n))),[n]);return{href:(0,o.VK)((()=>{if(void 0!==n)return(0,r.Hu)({store:n,scrollToBlockId:t,fullyQualified:!1,pageVisitSource:i.tY.LinkInPage,openInSidePeek:s})}),[s,n,t]),replaceHistoryState:!0}}},56203:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isHovered:!1}}}const r=new i},9867:(e,t,n)=>{n.d(t,{wT:()=>se,aQ:()=>ye,ED:()=>xe,mX:()=>X,w6:()=>me,Ui:()=>we,Xy:()=>Te,Uj:()=>pe,Cj:()=>ue,um:()=>ce,s:()=>he,Dv:()=>ge,lo:()=>ae,tn:()=>Ce,hI:()=>Ie,mN:()=>be,WO:()=>ve,X0:()=>oe,YH:()=>_e,JX:()=>ke,Ju:()=>ie,$J:()=>J,jg:()=>re,xI:()=>Y,lH:()=>$,fs:()=>K,$x:()=>G,d:()=>Se,W8:()=>te,Ce:()=>ee,RF:()=>fe});n(21703),n(57658);var o=n(15145),i=n(5220),r=n(68626),a=n(87479),s=n(72141),l=n(75246),c=n(29369),d=n(19889),u=n(64684),p=n(52629),m=n(1898),f=n(19584),g=n(91536),h=n(17224),v=n(54642),b=n(47307),y=n(76464),_=n(9953),S=n(75754),w=n(29974),k=n(150),I=n(13447),C=n(65452),x=n(28020),T=n(33929),M=n(46654),P=n(45010),A=n(78122),R=n(21115),D=n(27406),E=n(68418),B=n(38676),F=n(55838),O=n(77999),Z=n(80444),V=n(3418),U=n(6258),L=n(42185),j=n(30397),N=n(81023),z=n(35057),q=n(30297),W=n(60396),H=n(36225);function K(e){const{store:t,update:n,transaction:o}=e;_.sW({store:t,data:(0,f.Q2)(n),transaction:o})}function G(e){let{environment:t,store:n,update:o,transaction:i}=e;const r=function(e){let{store:t,update:n}=e;const o=t.getSettingsStore().getValue();if(!o)return{};const i={};for(const r in n)i[r]=o[r];return i}({store:n,update:o});_.sW({store:n.getSettingsStore(),data:(0,f.Q2)(o),transaction:i}),h.OR(t,{store:n,old_settings:r,updated_settings:o})}async function $(e){let{environment:t,spaceStore:n,addedStores:o,removedStores:i,createNewTeamFlowId:r,from:a}=e;const s=t.currentUser.id;if(!s||o.some((e=>!e.isDefined())))return!1;const l=n.getSpaceUserStore(s);if(await l.load(),!l.isWorkspaceOwner())throw new Error("Only admins can update default teams");const{performResult:{results:c},serverCommitResult:d}=I.createAndCommit({environment:t,userAction:"teamActions.updateDefaultTeams",perform:e=>{const n=[];for(const i of o){const o=Q({environment:t,transaction:e,teamStore:i,isDefault:!0,from:a,createNewTeamFlowId:r});n.push(o)}for(const o of i){const i=Q({environment:t,transaction:e,teamStore:o,isDefault:!1,from:a,createNewTeamFlowId:r});n.push(i)}return{results:n}}});return await d,await N.bi(t),c.every((e=>e))}function Q(e){let{environment:t,transaction:n,teamStore:o,isDefault:i,from:r,createNewTeamFlowId:a}=e;return o.isDefault()===i||(_.sW({store:o,data:{is_default:i},transaction:n}),n.postSubmitCallbacks.push((e=>{e||h.cX(t,{store:o,is_default_team:i,create_new_team_flow_id:a,from:r})}))),!0}function Y(e){var t;const{environment:n,teamStore:o,newRole:i,transaction:r,permissionsToClear:a}=e,l=a.map((e=>({...e,role:"none"}))),c=(null===(t=o.getTeamPermission())||void 0===t?void 0:t.role)??"none",d={type:"explicit_team_permission",team_id:o.id,role:i};l.push(d),y.ep({environment:n,store:o,permissionItems:l,transaction:r}),o.isDefault()&&y.ep({environment:n,store:o,permissionItems:[{type:"space_permission",role:i}],transaction:r}),(0,s.J5)(c)||!(0,s.J5)(i)||o.getDisableTeamPageEdits()||G({environment:n,store:o,update:{disable_team_page_edits:!0},transaction:r})}function J(e){const{environment:t,teamStore:n,newRole:o,transaction:i,permissionsToClear:r}=e,a=r.map((e=>({...e,role:"none"}))),s={type:"explicit_team_guest_permission",team_id:n.id,role:o};a.push(s),y.ep({environment:t,store:n,permissionItems:a,transaction:i})}function X(e){let{userId:t,teamStore:n,transaction:o,environment:i,permissionRole:r}=e;const s=n.getMembershipDefinedOnTeam(),l=s.find((e=>"user"===e.entity_type&&e.user_id===t));if(!l)throw new Error("Specified user is not on the team");if("member"===l.type)return!1;if(!n.isDefined())return!1;const c=n.getPermissionItems(),d=n.id;if(r&&(0,a.bk)({teamValue:{id:d,permissions:c},permissionRole:r}))throw new Error("Cannot set member's permission to be lower than default team permission.");if(!(0,u.XO)({membership:s}).includes(t))throw new Error("Specified user is not an owner of the team");let p=!1;if(s.length>0){const e=s.filter((e=>!("user"===e.entity_type&&e.user_id===t)));p=s.length!==e.length;const r=[{entity_type:"user",type:"member",user_id:t},...e];I.applyOperation({store:n,operation:{pointer:n.pointer,path:["membership"],command:"set",args:r},transaction:o}),g.Pd(i,{store:n,permission_user_id:t,team_role:"member"})}let m=r||"none";const f=(0,u.xC)({id:d,permissions:c});f&&r===f&&(m="none");const h={type:"user_permission",role:m,user_id:t};return y.ep({environment:i,store:n,permissionItems:[h],transaction:o,skipAnalytics:p})}function ee(e){let{environment:t,userId:n,teamStore:o,spaceStore:i,transaction:r,newTeamRole:a}=e;if(!o.isDefined())return!1;const s=o.getMembers().find((e=>"user"===e.entity_type&&e.user_id===n));return!!s&&(s.type!==a&&(I.applyOperation({store:o,operation:{pointer:o.pointer,path:["membership"],command:"setTeamMembershipItem",args:{entity_type:"user",type:a,user_id:n}},transaction:r}),y.ep({environment:t,store:i,permissionItems:[{type:"user_permission",role:"read_and_write",user_id:n}],transaction:r}),oe({environment:t,memberInfo:s,teamStore:o,transaction:r}),!0))}function te(e){let{environment:t,userId:n,teamStore:o,transaction:i}=e;const r=o.getMembers().find((e=>"user"===e.entity_type&&e.user_id===n));if(!r)throw new Error("Specified user is not on the team");if("owner"===r.type)return!1;if(!o.isDefined())return!1;const a=o.getMembershipDefinedOnTeam().filter((e=>!("user"===e.entity_type&&e.user_id===n))),s=[{entity_type:"user",type:"owner",user_id:n},...a];return I.applyOperation({store:o,operation:{pointer:o.pointer,path:["membership"],command:"set",args:s},transaction:i}),g.Pd(t,{store:o,permission_user_id:n,team_role:"owner"}),oe({environment:t,memberInfo:r,teamStore:o,transaction:i}),!0}function ne(e){let{memberInfo:t,newRole:n}=e;return"user"===t.entity_type?{type:"user_permission",user_id:t.user_id,role:n}:{type:"group_permission",group_id:t.group_id,role:n}}function oe(e){let{environment:t,memberInfo:n,teamStore:o,transaction:i}=e;return!!o.getPermissionItems()&&(y.ep({environment:t,store:o,permissionItems:[ne({memberInfo:n,newRole:"none"})],transaction:i}),!0)}async function ie(e){let{store:t,environment:n,accessLevel:o,teamName:i,from:r,isDefault:a}=e;const{currentSpaceStore:s}=Z.default.getState();if(!s)throw new Error("currentSpaceStore does not exist");const l=t.isDefault()??!1,c=t.getTeamAccessLevel(),d=(0,u.Hf)({membership:t.getRawMembership()}).length;if(o===c&&a===l)return!1;if(!(await A.hL({teamName:i,accessLevel:o,currentIsDefault:l,isDefault:a,numberOfTeamGuests:d})))return!1;const p=t.getPermissionItems(),m=t.getSettingsStore().getValue();if(!m||!p)return!1;const f=(0,u.AW)({teamValue:{id:t.id,permissions:p,settings:m},accessLevel:o,isDefault:a}),{performResult:{result:g}}=I.createAndCommit({userAction:"teamActions.setTeamAccessLevel",environment:n,perform:e=>{Q({environment:n,transaction:e,teamStore:t,isDefault:"invite_only"!==f.settings.space_member_join_access&&a,from:r,createNewTeamFlowId:void 0});const o=y.ep({environment:n,store:t,permissionItems:f.permissions,transaction:e});return _.sW({store:t.getSettingsStore(),data:f.settings,transaction:e}),{result:o}}});return g&&h.BW(n,{store:t,old_access_level:c,new_access_level:o,from:r}),g}function re(e){let{memberInfo:t,teamStore:n,transaction:o,environment:i,permissionRole:r}=e;if("owner"===t.type)return X({userId:t.user_id,teamStore:n,transaction:o,environment:i,permissionRole:r});if(!n.isDefined())return!1;const s=n.id,l=n.getPermissionItems(),c=n.getMembers();if(r&&(0,a.bk)({teamValue:{id:s,permissions:l},permissionRole:r}))throw new Error("Cannot set member's permission to be lower than default team permission.");const d=(0,u.hY)({membership:c});if("user"===t.entity_type&&!d.find((e=>"user"===e.entity_type&&e.user_id===t.user_id))||"group"===t.entity_type&&!d.find((e=>"group"===e.entity_type&&e.group_id===t.group_id)))throw new Error("Specified memberInfo not found on team");let p=r||"none";const m=(0,u.xC)({id:s,permissions:l});return m&&r===m&&(p="none"),y.ep({environment:i,store:n,permissionItems:[ne({memberInfo:t,newRole:p})],transaction:o})}function ae(e,t){E.Z.setState({...E.Z.state,open:!0,from:e}),E.Z.state.onClose=null==t?void 0:t.onClose}async function se(e){let{environment:t,currentSpaceStore:n,teamStore:o,from:i,action:r}=e;const a=t.currentUser.id;if(!a||!n||!(0,q.o)({userId:a,spaceStore:n,entrypoint:i}))return!1;if(!(await async function(e){return!H.Z.state.open&&await new Promise((t=>{H.Z.setState({open:!0,type:e,onAccept:()=>t(!0),onCancel:()=>t(!1)})}))}(r)))return!1;const s=await v.setAdminPrivilegedTeamMembership(t,{spaceId:n.id,teamId:o.id,teamRole:le(r)});if("failed"===s.type)return Te(s),!1;switch(r){case"joinTeamAsOwner":case"joinClosedOrPrivateTeamAsMember":de({environment:t,teamStore:o,from:i,newRole:"joinTeamAsOwner"===r?"owner":"member",usingAdminPrivileges:!0,andNavigateToTeamHome:!1});break;case"upgradeToOwner":g.Pd(t,{permission_user_id:a,team_role:"owner",store:o});const e=o.getName();e&&(0,R._t)(e);break;default:(0,m.t1)(r)}return!0}function le(e){switch(e){case"joinTeamAsOwner":case"upgradeToOwner":return"owner";case"joinClosedOrPrivateTeamAsMember":return"member";default:(0,m.t1)(e)}}async function ce(e){let{environment:t,currentSpaceStore:n,teamStore:o,from:i,andNavigateToTeamHome:r}=e;const a=t.currentUser.id;if(!a)return!1;const s=await v.updateTeamMembers(t,{spaceId:n.id,teamId:o.id,newMembersOrGuestsToAdd:[{type:"member",entity_type:"user",user_id:a}]});return"failed"===s.type?(Te(s),!1):(de({environment:t,teamStore:o,from:i,newRole:"member",usingAdminPrivileges:!1,andNavigateToTeamHome:r}),!0)}function de(e){let{environment:t,teamStore:n,from:o,newRole:i,usingAdminPrivileges:r,andNavigateToTeamHome:a}=e;const s=t.currentUser.id,l=Z.default.state.currentSpaceStore,c=Z.default.state.currentSpaceViewStore;if(!s||!l||!c)return!1;!function(e){var t;let{environment:n,currentSpaceViewStore:o,teamId:i}=e;const r=null===(t=(0,x.k_)(n).state)||void 0===t?void 0:t.userJoinedTeamsStores;if(!r||!o)return!1;const a=[...r.map((e=>{let{id:t}=e;return t})).filter((e=>e!==i)),i];k.Ct({environment:n,currentSpaceViewStore:o,orderedTeamIds:a,userAction:"TeamBrowserOutliner",isExplicitUserAction:!1})}({environment:t,currentSpaceViewStore:c,teamId:n.id}),h.UD(t,{store:n,joined_role:i,from:o}),C.l({environment:t,userId:s,spaceId:l.id});const d=n.getName();a?(Ie({environment:t,teamStore:n,shouldScroll:!1}),d&&new Promise((e=>setTimeout(e,500))).then((()=>{(0,R.$$)({teamName:d,usingAdminPrivileges:r})}))):d&&(0,R.$$)({teamName:d,usingAdminPrivileges:r})}async function ue(e){let{environment:t,teamId:n,spaceId:o,teamMemberInfos:i,isSettingDefaultTeam:r,inviterId:a}=e;const s=t.currentUser.id;if(!o||!s)return!1;return"failed"!==(await v.updateTeamMembers(t,{spaceId:o,teamId:n,newMembersOrGuestsToAdd:i,isSettingDefaultTeam:r,addNewMembersToSpace:!1},a)).type}async function pe(e){let{environment:t,teamStore:n,teamMemberInfos:o,isSettingDefaultTeam:i,createNewTeamFlowId:r}=e;const a=n.getSpaceId();if(!a)return!1;const s=t.currentUser.id;if(!a||!s)return!1;if("failed"===(await v.updateTeamMembers(t,{spaceId:a,teamId:n.id,newMembersOrGuestsToAdd:o,isSettingDefaultTeam:i,addNewMembersToSpace:(0,z.Mk)()},s)).type)return!1;if(!i){const e=o.flatMap((e=>"user"!==e.entity_type?[]:e.user_id)),i=e.length,a=o.filter((e=>"group"===e.entity_type)).length;i>0&&h.ix(t,{store:n,num_members_invited:i,create_new_team_flow_id:r,members_invited:e}),a>0&&h.$1(t,{store:n,num_groups_invited:a,create_new_team_flow_id:r})}return!0}function me(e){switch(e){case"team_browser":case"duplicate_team":case"create_team_from_page":case"permission_item":case"teams_dropdown_for_team_guest":case"teams_dropdown_for_team_member":case"teams_dropdown_for_group":case"teamSidebar":case"teamBrowserSearch":case"teamBrowserUnjoinedTeams":case"teamBrowserJoinedTeams":case"team_breadcrumb_popup":case"team_menu_header":case"sidebar_team_modal":case"team_invite_link":case"teams_dropdown_space_settings_people":return!1;case"manage_teams_table":return!0;default:(0,m.t1)(e)}}function fe(e){let{environment:t,teamId:n,tab:o,from:i,buttonPopupStore:r}=e;const a=Z.default.state.currentSpaceStore;if(!a)return;const s=U.zX.createChildStore(a,{table:c.e0,id:n});if(s.canRead())F.Z.update((e=>({...e,open:!0,tab:o,teamStore:s,viewingUnjoinedPrivateTeamAsEnterpriseAdmin:!1})));else{const e=ge({environment:t,spaceStore:a,teamId:n,from:i});if(!e)return;F.Z.update((t=>({...t,open:!0,tab:o,unjoinedPrivateTeamStore:e,viewingUnjoinedPrivateTeamAsEnterpriseAdmin:!0})))}r&&(V.Z.removeNamedPopup("team_more_actions"),r.setState({...r.state,open:!1}))}function ge(e){var t,n;let{environment:o,spaceStore:r,teamId:a,from:s}=e;if(!me(s))return;const l=r.getModel(),c=null===(t=Z.default.state.currentUserStore)||void 0===t?void 0:t.id;if(!c)return;const d=null===(n=r.getSpaceUserStore(c))||void 0===n?void 0:n.getModel();if(!(0,i.RI)({space:l,spaceUser:d}))return;const p=W.Z.createTeamStoreFromCache({environment:o,teamId:a,spaceId:r.id,userId:c}),m=null==p?void 0:p.getModel();return null!=p&&p.canRead()&&m&&(0,u.Ei)({userId:c,teamModel:m,spaceModel:l})?p:void 0}async function he(e){let{environment:t,teamStore:n,currentSpaceStore:o,from:i}=e;const r=t.currentUser.id;return!!r&&await ve({environment:t,teamStore:n,currentSpaceStore:o,userId:r,from:i})}async function ve(e){let{environment:t,teamStore:n,currentSpaceStore:o,userId:i,from:r}=e;const a=n.getSpaceId();if(!(n.isDefined()&&null!=o&&o.isDefined()&&t.currentUser.id&&a))return!1;const s=n.getMembers(),l=(0,u.XO)({membership:s}),c=l.some((e=>e===i));if(c&&1===l.length)return A.ZH(),!1;const p=(0,u.x4)({members:s,groups:o.getPermissionGroups()}).filter((e=>{var t;return null===(t=e.user_ids)||void 0===t?void 0:t.includes(i)}));if(!n.getMembers().find((e=>"user"===e.entity_type&&e.user_id===i)))return A.T0(p),!1;const m=U.t1.createChildStore(n,{table:d.KJ,id:i}),f=i===t.currentUser.id,g=n.getName()??"",b=m.getDisplayName(T.default.getIntl());if(!(await A.A8({isCurrentUser:f,teamName:g,memberName:b})))return!1;const y=[{entity_type:"user",type:c?"owner":"member",user_id:i}],_=await v.updateTeamMembers(t,{spaceId:a,teamId:n.id,existingMembersOrGuestsToRemove:y});return"failed"===_.type?(Te(_),!1):(h.$(t,{store:n,is_leaving_team:f,num_members_removed:y.length,from:r}),p.length>0?f?(0,R.K9)(g,p):(0,R.zs)(b,g,p):f&&(0,R.e6)(g),C.l({environment:t,userId:i,spaceId:a}),!0)}function be(e){let{environment:t,teamStore:n,group:o}=e;const i=n.getSpaceId();if(!i)return;const r=n.getMembers().find((e=>"group"===e.entity_type&&e.group_id===o.id));r&&A.iT({group:o,onAccept:async()=>{const e=[r],o=await v.updateTeamMembers(t,{spaceId:i,teamId:n.id,existingMembersOrGuestsToRemove:e});"failed"!==o.type?h.mi(t,{store:n,num_groups_removed:e.length}):Te(o)}})}async function ye(e){const{currentSpaceStore:t}=Z.default.getState();if(!t)throw new Error("currentSpaceStore does not exist");const{environment:n,teamStore:o,from:i}=e,r=n.currentUser.id,c=o.getName()||"",d=t.getSettingsStore();if(!r)return;const u=j.Z.state.teams.map((e=>({membership:e.getMembers(),id:e.id,archived_by:e.getArchivedBy(),is_default:e.isDefault()}))),p={permissions:t.getPermissionItems(),permission_groups:t.getPermissionGroups()},m=(0,a.wN)({spaceValue:p,spaceMembers:(0,M.aG)(p),teamsInSpace:u,currentUserId:r});if(await A.Fy(c,m)){if(m){const e=await A.wG(c);I.createAndCommit({userAction:"teamsHelpers.archiveLastTeam",environment:n,perform:n=>{if(K({store:o,update:{archived_by:r,archived_at:Date.now()},transaction:n}),_.sW({store:d,data:{is_teams_enabled:!1},transaction:n}),w.oy({planType:"personal",spaceStore:t,transaction:n}),e){const e=o.getTeamPagesStores()??[];for(const o of e){const e=o.getRole();if(!e)continue;const i={type:"user_permission",user_id:r,role:e},a=[...o.getPermissionItems().filter((e=>!s.fG(e)&&!s.Le(e)&&!s.ix(e))),i];_.sW({store:o,data:{parent_id:t.id,parent_table:l.bx,permissions:a},transaction:n})}_.sW({store:o,data:{team_pages:[]},transaction:n})}}}),h.mF(n,{store:o,from:i})}else I.createAndCommit({userAction:"teamsHelpers.archiveTeam",environment:n,perform:e=>{K({store:o,update:{archived_by:r,archived_at:Date.now()},transaction:e})}});h.Gp(n,{store:o,from:i}),"inactive"!==O.default.state.type&&O.default.setState({type:"inactive"}),F.Z.setState({open:!1,limitMembers:!0,memberFilterQuery:"",tab:void 0}),(0,R.CC)(c)}}function _e(e){let{environment:t,teamStore:n,teamName:o,from:i}=e;I.createAndCommit({userAction:"teamsHelpers.restoreArchivedTeam",environment:t,perform:e=>{K({store:n,update:{archived_by:void 0,archived_at:void 0},transaction:e})}}),h.IW(t,{store:n,from:i}),(0,R.JB)(o)}async function Se(e){let{settingName:t,newTeamSettingValue:n,spaceSettingValue:o,environment:i,store:r}=e;let a=!0;return"disable"===o&&"allow"===n?a=await A.hC(t):"disable"===n&&(a=await A.Bj(t)),!!a&&(I.createAndCommit({userAction:"teamsHelpers.changeTeamSetting",environment:i,perform:e=>{G({environment:i,store:r,update:{[t]:"disable"===n},transaction:e})}}),!0)}function we(e){return`TeamToggle_${e.id}`}function ke(e){let{teamStore:t,environment:n}=e;if(n.device.isMobile)return;const o=we(t),i=D.Z.findDropTargetFromKey(o);if(i){const e=i.getNode();if(!(e instanceof HTMLElement))return;if(P.Z.SidebarScroller){var r;const n=(null===(r=P.Z.SidebarScroller.scrollerEl())||void 0===r?void 0:r.offsetTop)||0;P.Z.SidebarScroller.scrollTo(e.offsetTop-n,0,{animate:!0}),L.Z.setState(t.id),setTimeout((()=>{L.Z.state===t.id&&L.Z.setState(void 0)}),1500)}}}function Ie(e){const{environment:t,teamStore:n,shouldScroll:i}=e;i&&ke({teamStore:n,environment:t});const r=n.getTeamPagesStores();!r||r.length<1||(S._c({environment:t,store:r[0],pageVisitSource:o.tY.JoinTeam}),h.SJ(t,{store:n}))}function Ce(e,t){let{from:n}=t;h.pi(e,{from:n}),B.sidebarShowTeamBrowserStore.setState(!B.sidebarShowTeamBrowserStore.state)}function xe(e){let{environment:t,from:n,teamStore:o}=e;const{state:i}=E.Z;var r,a;(h.Pr(t,{screen:i.screen,team_id:i.teamId,team_has_icon:Boolean(i.icon),team_has_name:Boolean(i.name),team_has_description:Boolean(i.description),team_access_level:i.accessLevel,flow_id:i.flowId,from:n,store:o}),i.teamId)&&(null===(r=(a=E.Z.state).onClose)||void 0===r||r.call(a,i.teamId));E.Z.reset()}function Te(e){b.showError(e),r.log({level:"error",from:"teamActions",type:"TeamApiError",error:(0,p.Ui)(e.error),data:{miscDataToConvertToString:{body:e.body,status:e.status}}})}},73292:(e,t,n)=>{n.d(t,{RW:()=>l,k7:()=>s,oO:()=>c});var o=n(15157),i=n(66324),r=n(77999),a=n(70704);function s(e){const{environment:t,spaceViewStore:n,teamStore:a,outlinerToggleButtonStore:s,newIsHidden:c,shouldPersistToggleState:d,isExplicitUserAction:u}=e;s.setState({...s.state,isHidden:c}),u&&i.MR(t,{store:a,is_toggled:!c,outliner_type:e.teamOutlinerType}),d&&o.Z.set({userId:n.environment.currentUser.id,key:l(n,a.id),value:c}),c&&r.default.setState({type:"inactive"})}function l(e,t){return`Team_Outliner_Item_${e.id}:${t}`}function c(e){let{oldState:t,teamIds:n,spaceId:i,userId:r}=e;return n.reduce(((e,n)=>{if(n in e)return e;if(n in t)return e[n]=t[n],e;const s=l({id:i},n),c=o.Z.get({userId:r,key:s});return e[n]=new a.Z,e[n].setState({isHidden:c??!1}),e}),{})}},28517:(e,t,n)=>{n.d(t,{I:()=>s,m:()=>l});n(21703);var o=n(53965),i=n(54642),r=n(95697),a=n(69911);async function s(e){let{environment:t,spaceId:n,userId:o}=e;if(!t.currentUser.loggedInUserIds.includes(o))throw new Error("Must be logged in user.");(0,r.bq)()&&(a.Z.getUserJoinedTeamsState({userId:o,spaceId:n})||await l({environment:t,spaceId:n,userId:o}))}async function l(e){var t;let{environment:n,spaceId:r,userId:s,emitValue:l}=e;if(!n.currentUser.loggedInUserIds.includes(s))throw new Error("Must be logged in user.");a.Z.setHasFetched({userId:s,spaceId:r});const c=await i.getTeams(n,{spaceId:r,onlyJoined:!0},s);if("failed"===c.type)return;const d=c.data.teamIds,u=(null===(t=a.Z.getUserJoinedTeamsState({userId:s,spaceId:r}))||void 0===t?void 0:t.joinedTeamsIds)||[];d.length===u.length&&0===o.e5(d,u).length&&0===o.e5(u,d).length||a.Z.setUserJoinedTeamsState({userId:s,spaceId:r,state:{joinedTeamsIds:d,lastEmitValue:l}})}},74016:(e,t,n)=>{n.d(t,{p:()=>m});n(67294);var o=n(480),i=n(86628),r=n(24405),a=n(79362),s=n(22808),l=n(31278),c=n(48779),d=n(80444),u=n(6258),p=n(85893);function m(e){const{store:t,size:n=16,style:m,disabled:f=!1,onChange:g=(()=>{})}=e,h=(0,o.O7)(),{name:v,icon:b}=(0,i.VK)((()=>{const n=d.default.state.currentSpaceStore;return t?t instanceof u.zX?{name:t.getName(),icon:e.icon??t.getIcon()}:{name:(0,c.rn)(h,t),icon:e.icon??(0,c.Wd)(h,t)}:{name:n&&`team-icon-${n.id}`,icon:e.icon}}),[t,h,e.icon]),y=(0,r.yK)((e=>({backgroundContainer:{background:b&&(0,a.V2)(b.icon)?(0,a.Pk)(b.icon,e.mode):e.regularDividerColor,width:n,height:n}})),[b,n]),_=b&&b.icon&&((0,a.V2)(b.icon)||(0,s.Z)(b.icon)),S=e.iconLoggingData||t&&{recordTable:t.table,source:"team_settings"};return(0,p.jsx)(l.Z,{title:v,icon:b,size:_?.9*n:n,emojiSize:_?.78*n:n,isEmptyPage:!1,style:_?{...m,...y.backgroundContainer}:m,isLarge:!0,largeIcon:!0,iconLoggingData:S,...f?{disabled:!0}:{disabled:!1,onChange:g,bucket:"public"}})}},30297:(e,t,n)=>{n.d(t,{o:()=>l,r:()=>c});var o=n(480),i=n(86628),r=n(5220),a=n(80444),s=n(9867);function l(e){var t;let{entrypoint:n,userId:o,spaceStore:i}=e;const a=null==i?void 0:i.getModel();if(!o||!a)return!1;const l=null==i||null===(t=i.getSpaceUserStore(o))||void 0===t?void 0:t.getModel();if(!l)return!1;return(0,r.RI)({space:a,spaceUser:l})&&s.w6(n)}function c(e){const t=(0,o.O7)().currentUser.id;return(0,i.VK)((()=>{const{currentSpaceStore:n}=a.default.state;return l({entrypoint:e,spaceStore:n,userId:t})}),[t,e])}},60396:(e,t,n)=>{n.d(t,{Z:()=>c});var o=n(26263),i=n(49085),r=n(29369),a=n(1898),s=n(20431);class l extends i.default{getInitialState(){return{initialized:!1}}createTeamStoreFromCache(e){let{environment:t,teamId:n,spaceId:o,userId:i}=e;if(this.state.initialized&&o&&i&&this.state.spaceId===o&&this.state.userId===i)return new s.z(t,{table:r.e0,id:n},{inMemoryRecordCache:this.state.inMemoryCache})}initialize(e){let{environment:t,userId:n,spaceId:i,teamIds:s,getRecordWithRole:l}=e;const c=new o.Z({name:"GlobalEnterpriseAdminTeamsStore"});for(const o of s){const e={table:r.e0,id:o};c.setRecord({pointer:e,userId:n},l(e))}return this.setState({initialized:!0,spaceId:i,userId:n,inMemoryCache:c}),s.map((e=>this.createTeamStoreFromCache({environment:t,teamId:e,spaceId:i,userId:n}))).filter(a.$K)}}const c=new l},36225:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},75769:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{hasShownTooltip:!1}}hasShownTootlip(e){return this.state.hasShownTooltip&&this.state.teamId===e}}const r=new i},69911:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{joinedTeamsStates:{},hasFetched:new Set}}getKey(e){let{userId:t,spaceId:n}=e;return`${t}:${n}`}getUserJoinedTeamsState(e){let{userId:t,spaceId:n}=e;const o=this.getKey({userId:t,spaceId:n});return this.state.joinedTeamsStates[o]}setUserJoinedTeamsState(e){let{userId:t,spaceId:n,state:o}=e;const i=this.getKey({userId:t,spaceId:n});this.state.joinedTeamsStates[i]=o,this.emit()}getHasFetched(e){let{userId:t,spaceId:n}=e;const o=this.getKey({userId:t,spaceId:n});return this.state.hasFetched.has(o)}setHasFetched(e){let{userId:t,spaceId:n}=e;const o=this.getKey({userId:t,spaceId:n});this.state.hasFetched.add(o)}}const r=new i},83941:(e,t,n)=>{n.d(t,{M:()=>i});var o=n(77080);function i(e){return"on"===o.default.getEligibleGroup({experimentId:"duplication_workspace_selection_modal3",defaultGroup:"control",...e})}},51247:(e,t,n)=>{n.d(t,{E2:()=>i,YQ:()=>o,dm:()=>r,wN:()=>a});const o=90,i=90,r=275,a=32},29949:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{status:"closed"}}open(e){const{analyticsFrom:t,cloneTo:n,selectedTemplate:o,selectedTeam:i}=e;this.setState({...this.state,status:"opening",analyticsFrom:t,cloneTo:n,selectedTemplate:o,selectedTeam:i})}}const r=new i},24161:(e,t,n)=>{n.d(t,{N:()=>a,v:()=>r});var o=n(1898);const i={invertedInsertText:!0,invertedDeleteText:!0,invertedMoveTextSlice:!0,invertedAddAnnotation:!0,invertedRemoveAnnotation:!0};function r(e){return Boolean(i[e.command])}function a(e){const{pointer:t,invertedCrdtOperation:n}=e,i=n.type;switch(i){case"invertedInsertText":return{command:"invertedInsertText",pointer:t,path:[],args:n};case"invertedDeleteText":return{command:"invertedDeleteText",pointer:t,path:[],args:n};case"invertedAddAnnotation":return{command:"invertedAddAnnotation",pointer:t,path:[],args:n};case"invertedRemoveAnnotation":return{command:"invertedRemoveAnnotation",pointer:t,path:[],args:n};default:(0,o.t1)(i)}}},65663:(e,t,n)=>{n.d(t,{F:()=>a});var o=n(67175),i=n(13447),r=n(24161);function a(e){const{transaction:t,store:n,crdtOperations:a,invertedOperations:s}=e;i.applyCrdtTextOperations({transaction:t,store:n,operations:a.map((e=>(0,o.W5)({pointer:n.pointer,crdtOperation:e}))),invertedOperations:s.map((e=>(0,r.N)({pointer:n.pointer,invertedCrdtOperation:e})))})}},60027:(e,t,n)=>{n.d(t,{T:()=>_,n:()=>S});var o=n(30120),i=(n(67294),n(68626)),r=n(9182),a=n(9291),s=n(86572),l=n(54642),c=n(47307),d=n(80444),u=n(22616),p=n(81023),m=n(5682),f=n(58333),g=n(88893),h=n(33493),v=n(88280),b=n(22500),y=n(85893);async function _(e){const{environment:t,stripe:n,elements:l,trialData:_,trialDays:S}=e,w=v.subscriptionDataStoreInstance.state;if(!w)return void i.log({level:"error",from:"trialUpsellActions",type:"StripeError",error:{miscDataString:"Unable to get subscription data."}});if(!l||!n)return void i.log({level:"error",from:"trialUpsellActions",type:"StripeError",error:{miscDataString:"Stripe elements not initialized when user tried to upgrade"}});const{error:k}=await l.submit();if(k)return void s.iL(t,{error:"could not submit form",error_type:"payment_method"});const I=await n.createPaymentMethod({elements:l});if(I.error)return void s.iL(t,{error:I.error.message,error_type:"payment_method"});if(!I.paymentMethod)return void s.iL(t,{error:"could not create token",error_type:"payment_method"});const C={type:"paymentMethodId",value:I.paymentMethod.id},x=d.default.state.currentSpaceStore;if(!x)return;const T=x.id,M=await u.aQ({environment:t,spaceId:T}),P=(0,m.P)(M,w),A=(0,r.Lg)(P),R=h.Z.state.selectedCurrencyCode??"USD",D={product:(0,b.Hy)(),interval:"month",currency:R,quantity:1},E=(0,f.dP)(M,A,D),B=o.ou.now().plus({days:S});return await async function(e){const{environment:t,spaceStore:n,paymentData:o,desiredState:i,stripe:r,trialData:l}=e;try{const e=await p.Mg({environment:t,spaceStore:n,desiredState:i,paymentData:o,from:"onboarding",trialData:l,billingEmail:(0,g.pu)()}),s=e.paymentIntentClientSecret,d=e.paymentIntentStatus;if(s&&"requires_action"===d){const{error:e}=await r.handleNextAction({clientSecret:s});e&&(await p.EO({environment:t,spaceStore:n,planType:n.getPlanType()??"personal",from:"subscription_upgrade_onboarding_failed_payment"}),c.showErrorMessage((0,y.jsx)(a.FormattedMessage,{id:"subscription.upgrade.payment_failed",defaultMessage:"Your payment could not be processed. Please provide an alternate payment method or you will lose access to Notion."})))}return"success"}catch{return void s.Bg(t)}}({environment:t,spaceStore:x,desiredState:{...E,trialEnd:B},paymentData:C,stripe:n,subscriptionTier:(0,b.Hy)(),trialData:_})}async function S(e){const t=await l.getExternalOrgData(e,{});if("failed"===t.type)return!1;const n=t.data;return"company_employee_count"in n&&parseInt(n.company_employee_count)>99}},22500:(e,t,n)=>{n.d(t,{Hy:()=>f,yt:()=>g,O1:()=>d,Re:()=>h,XG:()=>p,zQ:()=>u});var o=n(9852),i=n(18212),r=n(18265),a=n(70060),s=n(53809),l=n(30548);const c=new s.D({key:"trialUpsell",namespace:l.$p,important:!1,trackingType:"preference"});function d(e){return Boolean(e&&["affiliates","marketing","upwork"].includes(e))}function u(e,t){(0,a.zS)(e,t)&&c.setState(e)}function p(){const e=(0,r.nx)(new URL(window.location.href).toString(),(0,o.x6)());null!=e&&e.trial_source&&(e.trial_source=void 0,(0,o.NW)(e)),c.setState(void 0)}function m(){var e;const t=null===(e=(0,o.x6)())||void 0===e?void 0:e.trial_source;return t&&d(t)?t:c.getState()??"plus"}function f(){return"business"===m()?"business":"plus"}function g(e){const t=m(),n=(0,i.Rk)();if(e&&"upwork"!==t)return n.enterprise;if(!t)return n.default;switch(t){case"affiliates":return n.affiliates;case"marketing":return n.marketing;case"upwork":return n.upwork;default:return n.default}}function h(){return"upwork"===m()}},42198:(e,t,n)=>{n.r(t),n.d(t,{default:()=>m});var o=n(49085),i=n(53965),r=n(19584),a=n(77080),s=(n(57658),n(1898)),l=n(54642),c=n(98730);async function d(e){const{spaceId:t,userId:n,environment:o}=e,i=await l.getUserSignals(o,{spaceId:t,signals:[{name:"similarUserRecentPages",includeRecords:!0},{name:"topPages7dPageView",includeRecords:!0},{name:"editedPages1d",includeRecords:!0},{name:"similarUsersEditedPages1d",includeRecords:!0}]});if("success"===i.type){const e={};i.data.signals.forEach((t=>{if("error"===t.status)return;const n=t.name;"similarUserRecentPages"===n?e[n]=function(e){const t=new Map,n=new Map;return e.forEach((e=>{let{userId:t,similarity:o}=e;n.set(t,o)})),e.forEach((e=>{const{userId:o,similarity:i}=e;e.recentPages.forEach((r=>{let{visitedAt:a,pageId:s}=r;const l=t.get(s);if(l){l.userIds.push(o),l.mostRecentlyVisitedAt<a&&(l.mostRecentlyVisitedUser=e.userId,l.mostRecentlyVisitedAt=a);const t=n.get(l.mostSimilarUser);t&&t<i&&(l.mostSimilarUser=o)}else t.set(s,{userIds:[o],mostRecentlyVisitedUser:o,mostRecentlyVisitedAt:a,mostSimilarUser:o})}))})),{pagesMetadata:t,userSimilarityScores:n}}(t.data):"topPages7dPageView"===n?e[n]=function(e){const t=new Map;return e.forEach((e=>{t.set(e.pageId,e.pageAuthorityV1)})),t}(t.data):"editedPages1d"===n||"similarUsersEditedPages1d"===n?e[n]=function(e){const t=new Map;return e.forEach((e=>{t.set(e.pageId,e.editedAt)})),t}(t.data):(0,s.t1)(n)})),m.update((o=>({...o,userSignals:o.userSignals.set(m.getKey(t,n),e)}))),c.S(o)}}const u=5*r.hM;class p extends o.default{constructor(){super(...arguments),this.refreshTimer=void 0,this.getKeyMemoized=(0,i.HP)(this.getKey)}getInitialState(){return{userSignals:new Map}}getKey(e,t){return`${e}:${t}`}getUserSignals(e){let{spaceId:t,userId:n}=e;if(!t||!n)return;const o=this.getKeyMemoized(t,n),i=this.state.userSignals.get(o);return i||void 0}initializeAndLoadAllUserSignals(e){this.refreshTimer&&window.clearTimeout(this.refreshTimer);(a.default.getEligibleGroup({experimentId:"search-new-local-recall-v2",parameter:"userSignals",defaultGroup:[]})??[]).length>0&&(d(e),this.refreshTimer=window.setTimeout((()=>{d(e)}),u))}isSimilarUsersRecentPages(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.similarUserRecentPages)||void 0===t||null===(t=t.pagesMetadata)||void 0===t?void 0:t.has(i)}getNumSimilarUsersVisitedPage(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.similarUserRecentPages)||void 0===t||null===(t=t.pagesMetadata)||void 0===t||null===(t=t.get(i))||void 0===t||null===(t=t.userIds)||void 0===t?void 0:t.length}getSimilarUsersMostRecentVisitTimeForPage(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.similarUserRecentPages)||void 0===t||null===(t=t.pagesMetadata)||void 0===t||null===(t=t.get(i))||void 0===t?void 0:t.mostRecentlyVisitedAt}getHighestViewerSimilarityScoreForPage(e){var t,n;const{userId:o,spaceId:i,pageId:r}=e,a=this.getUserSignals({userId:o,spaceId:i}),s=null==a||null===(t=a.similarUserRecentPages)||void 0===t||null===(t=t.pagesMetadata)||void 0===t||null===(t=t.get(r))||void 0===t?void 0:t.mostSimilarUser;if(s)return null==a||null===(n=a.similarUserRecentPages)||void 0===n||null===(n=n.userSimilarityScores)||void 0===n?void 0:n.get(s)}isTopPages7dPageView(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.topPages7dPageView)||void 0===t?void 0:t.has(i)}getPageAuthorityV1ForPage(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.topPages7dPageView)||void 0===t?void 0:t.get(i)}isRecentlyEdited(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.editedPages1d)||void 0===t?void 0:t.has(i)}getUserLastEditedTimeForPage(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.editedPages1d)||void 0===t?void 0:t.get(i)}isSimilarUsersRecentlyEdited(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.similarUsersEditedPages1d)||void 0===t?void 0:t.has(i)}getSimilarUserLastEditedTimeForPage(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.similarUsersEditedPages1d)||void 0===t?void 0:t.get(i)}}const m=new p},30615:(e,t,n)=>{n.d(t,{G:()=>o});class o extends Map{constructor(e,t){super(t),this.defaultFactory=void 0,this.defaultFactory=e}get(e){if(!super.has(e)){const t=this.defaultFactory(e);super.set(e,t)}return super.get(e)}}},50202:(e,t,n)=>{n.d(t,{kB:()=>d});n(21703);var o=n(1898),i=n(19584),r=n(12847);const a=Symbol("JSON Schema"),s=Symbol("JSON Schema Components"),l=Symbol("No JSON Schema"),c={isNull:()=>({type:"null",[s]:{}}),boolean:()=>({type:"boolean",[s]:{}}),number:()=>({type:"number",[s]:{}}),integer:()=>({type:"integer",[s]:{}}),string:()=>({type:"string",[s]:{}}),dateString:()=>({type:"string",format:"date",[s]:{}}),literal:e=>({enum:[e],[s]:{}}),literals:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{enum:t,[s]:{}}},uuid:()=>({type:"string",format:"uuid",[s]:{}}),uuidWithoutDashes:()=>({type:"string",format:"uuid",[s]:{}}),any:()=>u,array:e=>({type:"array",items:e[a],[s]:e[a][s]}),tuple:e=>({type:"tuple",items:!1,prefixItems:e.map((e=>e[a])).filter((e=>e!==l)),[s]:Object.assign({},...e.map((e=>e[a][s])))}),record:(e,t)=>({type:"object",additionalProperties:t[a],[s]:t[a][s]}),object:e=>{let{required:t,optional:n,exact:o}=e;return{type:"object",properties:(0,i.m8)(Object.entries({...t,...n}).filter((e=>{let[t,n]=e;return n[a]!==l})).map((e=>{let[t,n]=e;return[t,n[a]]}))),...o&&{additionalProperties:!1},...Object.keys(t).length>0&&{required:Object.keys(t)},[s]:Object.assign({},...Object.values({...t,...n}).map((e=>e[a][s])))}},union:e=>({anyOf:e.map((e=>e[a])).filter((e=>e!==l)),[s]:Object.assign({},...e.map((e=>e[a][s])))}),gte:(e,t)=>{const n=e[a];return n!==l?{...n,minimum:t}:n},lte:(e,t)=>{const n=e[a];return n!==l?{...n,maximum:t}:n},maxLength:(e,t)=>{const n=e[a];if(n===l)return n;if("type"in n){if("string"===n.type)return{...n,maxLength:t};if("array"===n.type)return{...n,maxItems:t}}throw new Error("Unknown type for max length.")},minLength:(e,t)=>{const n=e[a];if(n===l)return n;if("type"in n){if("string"===n.type)return{...n,minLength:t};if("array"===n.type)return{...n,minItems:t}}throw new Error("Unknown type for min length.")},nonEmpty:e=>{const t=e[a];if(t===l)return t;if("type"in t){if("string"===t.type)return{...t,minLength:1};if("object"===t.type)return{...t,minProperties:1};if("array"===t.type)return{...t,minItems:1}}throw new Error("Unknown non-emptyable type.")},nullable:e=>{const t=e[a];if(t===l)return t;if("type"in t)if(Array.isArray(t.type)){if("null"===t.type[1])return t;(0,o.t1)(t.type[1])}else{if("string"===t.type)return{...t,type:[t.type,"null"]};if("object"===t.type)return{...t,type:[t.type,"null"]};if("array"===t.type)return{...t,type:[t.type,"null"]};if("tuple"===t.type)return{...t,type:[t.type,"null"]};if("boolean"===t.type)return{...t,type:[t.type,"null"]};if("integer"===t.type)return{...t,type:[t.type,"null"]};if("number"===t.type)return{...t,type:[t.type,"null"]};if("null"===t.type)return t;(0,o.t1)(t.type)}else{if("const"in t)return{...t,enum:[t.const,null]};if("enum"in t)return{...t,enum:[...t.enum,null]};if("anyOf"in t)return{...t,anyOf:t.anyOf.map((e=>c.nullable({[a]:e})))};if("$ref"in t)return{anyOf:[t,{type:"null"}],[s]:t[s]};if(n=t,(0,o.Kn)(n)&&0===Object.keys(n).length)return t;(0,o.t1)(t)}var n}},d=(0,i.m8)(Object.entries(c).map((e=>{let[t,n]=e;return[t,function(){for(var e=arguments.length,i=new Array(e),l=0;l<e;l++)i[l]=arguments[l];return 1===i.length&&(0,o.Kn)(i[0])&&("id"in i[0]||"description"in i[0])?function(){const{description:e,examples:o,id:l}=i[0];let c={description:e,...o&&{examples:o},...n(...arguments)};return l&&(c={$ref:`#/components/schemas/${l}`,[s]:{...c[s],[l]:c}}),{[a]:c,...r[t](...arguments)}}:{[a]:n(...i),...r[t](...i)}}]})));Symbol("Exact empty object ({})"),d.object({id:"emptyObject"})({required:{},optional:{},exact:!0});const u={}},40376:(e,t,n)=>{n.d(t,{u:()=>s});n(57658);var o=n(30615),i=n(53965),r=n(70203);let a;a=Symbol.iterator;class s{constructor(){this.unique=new Map,this.multi=new o.G((()=>[]))}static fromArray(e){const t=new this;for(const n of e)(0,r.Pb$)(n)?t.add(n):t.findFirstOfType((0,r.J7s)(n))||t.add(n);return t}static normalize(e){return this.fromArray(e).toArray()}*[a](){for(const[,e]of this.unique)yield e;for(const[,e]of this.multi)for(const t of e)yield t}toArray(){return Array(...this)}findFirstOfType(e){if((0,r.WU4)(e)){return this.multi.get(e)[0]??void 0}return this.unique.get(e)??void 0}findType(e){if((0,r.WU4)(e))return this.multi.get(e);{const t=this.unique.get(e);return t?[t]:[]}}find(e){const t=[];for(const n of this)e(n)&&t.push(n);return t}add(e){(0,r.Pb$)(e)?this.multi.get((0,r.J7s)(e)).push(e):this.unique.set((0,r.J7s)(e),e)}removeType(e){if((0,r.WU4)(e)){const t=this.multi.get(e);return this.multi.delete(e),t.length>0}return this.unique.delete(e)}remove(e){if((0,r.Pb$)(e)){const t=(0,r.J7s)(e),n=this.multi.get(t),o=n.filter((t=>!i.Xy(t,e)));return this.multi.set(t,o),o.length<n.length}{const t=(0,r.J7s)(e),n=this.unique.get(t);return!(!n||!i.Xy(n,e))&&(this.unique.delete(t),!0)}}}},28084:(e,t,n)=>{n.d(t,{Z:()=>r});n(21703),n(57658);var o=n(57347),i=n(37850);const r=class{constructor(e){this.performRequests=void 0,this.batchSize=void 0,this.maxWorkers=void 0,this.requestDelayMs=void 0,this.requestTimeoutMs=void 0,this.queue=[],this.currentWorkers=0,this.currentSetTimeouts=0,this.dequeue=async()=>{if(this.currentSetTimeouts=0,this.currentWorkers>=this.maxWorkers||0===this.queue.length)return;this.currentWorkers++;const e=this.queue.splice(0,this.batchSize),t=e.map((e=>e.request));let n,r;try{if(this.requestTimeoutMs){const e=await i.OI(this.requestTimeoutMs,this.performRequests(t));if(e.timeout)throw new Error("Timed out.");n=e.result}else n=await this.performRequests(t)}catch(a){r=(0,o.t)(a)}try{if(r)for(let t=0;t<e.length;t++){e[t].deferred.reject(r)}else if(n)for(let t=0;t<e.length;t++){const o=e[t],i=n[t];o.deferred.resolve(i)}}catch(s){}this.currentWorkers--,this.queue.length>=this.batchSize?this.dequeue():this.dequeueAfterTimeout()};const{performRequests:t,batchSize:n,maxWorkers:r,requestDelayMs:a,requestTimeoutMs:s}=e;this.performRequests=t,this.batchSize=n,this.maxWorkers=r,this.requestDelayMs=a||0,this.requestTimeoutMs=s}getQueueSize(){return this.queue.length}updateBatchSize(e){this.batchSize=e}updateRequestDelayMs(e){this.requestDelayMs=e}getMaxWorkers(){return this.maxWorkers}updateMaxWorkers(e){this.maxWorkers=e,this.dequeueAfterTimeout()}enqueue(e){const t=i.UZ();return this.queue.push({request:e,deferred:t}),this.dequeueAfterTimeout(),t.promise}dequeueAfterTimeout(){this.currentSetTimeouts<this.maxWorkers&&(this.currentSetTimeouts++,setTimeout(this.dequeue,this.requestDelayMs))}}},54064:(e,t,n)=>{n.d(t,{Z:()=>o});const o=class{constructor(){this.listeners={}}addListener(e,t){let n=this.listeners[e];n||(n=new Set,this.listeners[e]=n),n.add(t)}addOnceListener(e,t){var n=this;const o=function(){n.removeListener(e,o),t(...arguments)};this.addListener(e,o)}removeListener(e,t){const n=this.listeners[e];n&&(n.delete(t),0===n.size&&delete this.listeners[e])}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];const i=this.listeners[e];i&&i.forEach((e=>e(...n)))}listenerCount(e){const t=this.listeners[e];return t?t.size:0}}},55652:(e,t,n)=>{n.d(t,{s:()=>i});n(57658);var o=n(1898);class i{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};this.buckets={},this.count=0,this.total=0,this.unique=0,this.startedAt=new Map,this.logger=e}async measureErrors(e,t,n,o){const i=`${e} ${++this.unique}`;this.start(i);try{const e=await o();return this.end(i,t),e}catch(r){throw this.end(i,n,r),r}}get average(){return Math.floor(this.total/this.count)}get summary(){const e=[];e.push(`avg ${this.average}ms for ${this.count} calls`);for(const[t,n]of(0,o.qP)(this.buckets)){if(!n)continue;const o=Math.floor(n.total/n.count),i=(n.count/this.count*100).toFixed(2);e.push(`[${t}: ${i}% avg ${o}ms]`)}return e.join(" ")}start(e){this.startedAt.set(e,"object"==typeof performance?performance.now():Date.now())}end(e,t){const n=this.startedAt.get(e);if(!n)return;this.startedAt.delete(e);const o=("object"==typeof performance?performance.now():Date.now())-n;this.count++,this.total=this.total+o;let i=this.buckets[t];i||(i={count:0,total:0},this.buckets[t]=i),i.count++,i.total=i.total+o;for(var r=arguments.length,a=new Array(r>2?r-2:0),s=2;s<r;s++)a[s-2]=arguments[s];this.logger(`end ${e} ${t}: ${o}ms`,...a)}}},18201:(e,t,n)=>{n.d(t,{Z:()=>i});n(21703),n(57658),n(30541);var o=n(57347);const i=class{constructor(e){let{maxSize:t,prefix:n,store:o,version:i}=e;this.prefix=void 0,this.maxSize=void 0,this.store=void 0,this.version=void 0,this.serializedKeys=void 0,this.namespace=void 0,this.lastVersion=void 0,this.createInternalKey=e=>`${this.namespace}${e}`,this.maxSize=t,this.prefix=n,this.store=o,this.version=i.toString(),this.namespace=`${n}:${i}::`,this.serializedKeys=`${n}:${i}:keys`,this.lastVersion=`${n}:version`}set(e,t){try{this.setInternal(e,t),this.promote(e)}catch(n){return{error:(0,o.t)(n)}}return{value:void 0}}get(e){try{const t=this.getInternal(e);if(null!==t)return{value:t}}catch(t){return{error:(0,o.t)(t)}}return{value:void 0}}remove(e){try{this.getKeys().indexOf(e)>-1&&(this.removeInternal(e),this.evict(e))}catch(t){return{error:(0,o.t)(t)}}return{value:void 0}}clear(){try{const e=this.getKeys();for(const t of e)this.removeInternal(t);this.setKeys([])}catch(e){return{error:(0,o.t)(e)}}return{value:void 0}}scan(e){try{const t=this.getKeys();for(const n of t){const t=this.getInternal(n);if(null===t)throw new Error(`Item not found: ${n}`);e(n,t)}}catch(t){return{error:(0,o.t)(t)}}return{value:void 0}}entries(){const e=[],t=this.scan(((t,n)=>{e.push([t,n])}));return t.error?{error:t.error}:{value:e}}keys(){try{return{value:this.getKeys()}}catch(e){return{error:(0,o.t)(e)}}}slowGC(){const e=[],t=e=>e!==this.serializedKeys&&(!!e.endsWith("keys")&&this.isOldKey(e));for(let n=0;n<this.store.length;n+=1){const o=this.store.key(n);null!==o&&((this.isOldKey(o)||t(o))&&e.push(o))}for(const n of e)this.store.removeItem(n)}updateVersionAndGC(){const e=this.store.getItem(this.lastVersion);if(null!==e){const t=parseInt(e,10),n=parseInt(this.version,10),o=!Number.isNaN(t),i=!Number.isNaN(n);o&&i&&t<n&&this.slowGC()}this.store.setItem(this.lastVersion,this.version)}isOldKey(e){if(!e.startsWith(`${this.prefix}:`))return!1;const t=e.substring(`${this.prefix}:`.length),n=parseInt(t,10);if(Number.isNaN(n))return!1;return n<parseInt(this.version,10)}getKeys(){const e=this.store.getItem(this.serializedKeys);if(null===e)return[];const t=JSON.parse(e);return Array.isArray(t)?t:[]}setKeys(e){const t=JSON.stringify(e);this.store.setItem(this.serializedKeys,t)}promote(e){const t=this.getKeys(),n=t.indexOf(e);if(n>-1)t.splice(n,1),t.unshift(e);else if(t.unshift(e),t.length>this.maxSize){const e=t.splice(this.maxSize);for(const t of e)this.removeInternal(t)}this.setKeys(t)}evict(e){const t=this.getKeys(),n=t.indexOf(e);n>-1&&t.splice(n,1),this.setKeys(t)}setInternal(e,t){this.store.setItem(this.createInternalKey(e),JSON.stringify(t))}getInternal(e){const t=this.store.getItem(this.createInternalKey(e));return null===t?null:JSON.parse(t)}removeInternal(e){this.store.removeItem(this.createInternalKey(e))}}},15157:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(30548);const i=new class{constructor(e,t){this.localStorageStore=void 0,this.localStorageStore=new o.ZP(e,t,"necessary")}get(e){let{userId:t,key:n}=e;return this.localStorageStore.get(this.makeUserKey(t,n))}set(e){let{userId:t,key:n,value:o}=e;return this.localStorageStore.set(this.makeUserKey(t,n),o)}remove(e){let{userId:t,key:n}=e;return this.localStorageStore.remove(this.makeUserKey(t,n))}clearStorageForUser(e){this.localStorageStore.scan((t=>{t.startsWith(e)&&this.remove({userId:e,key:t})}))}scan(e){this.localStorageStore.scan(e)}makeUserKey(e,t){return`${e||"guest"}:${t}`}}(o.TA,!1)},75189:(e,t,n)=>{n.d(t,{uP:()=>P,yx:()=>M});var o=n(12847);const i=o.union([o.number(),o.string(),o.boolean(),o.isNull(),o.array(o.string())]),r=o.undefinable(i),a=o.union([i,o.record(o.string(),i)]),s=o.union([r,o.record(o.string(),r)]),l=o.union([s,o.record(o.string(),s)]),c=l,d=o.without(o.without(o.nonEmpty(o.string()),"{"),"}");o.object({required:{key:d,value:a,ttl:o.undefinable(o.number())},optional:{}}),o.object({required:{key:d,value:s,version:o.number()},optional:{}}),o.object({required:{key:d,value:o.number(),ttl:o.undefinable(o.number())},optional:{}}),o.object({required:{key:d,value:o.number(),version:o.number()},optional:{}}),o.object({required:{key:d,amount:o.number(),ttl:o.undefinable(o.number())},optional:{passThroughData:c}}),o.object({required:{key:d,value:o.number(),version:o.number()},optional:{}}),o.object({required:{key:d,field:o.string(),value:s,ttl:o.undefinable(o.number())},optional:{}}),o.object({required:{key:d,field:o.string(),value:l,version:o.number()},optional:{}}),o.object({required:{id:o.string()},optional:{}}),o.object({required:{setValueTime:o.number()},optional:{}}),o.object({required:{key:d,field:o.string(),updates:o.record(o.string(),r),ttl:o.undefinable(o.number())},optional:{}}),o.object({required:{key:d,field:o.string(),value:l,version:o.number()},optional:{}});const u=o.object({required:{blockId:o.string(),userId:o.string(),spaceId:o.string(),operation:o.literal("logPageExit"),pageVisitId:o.undefinable(o.string()),ts:o.number()},optional:{}}),p=(o.object({required:{},optional:{}}),o.object({required:{key:d},optional:{}}),o.object({required:{key:d,value:s,version:o.number()},optional:{}}),o.object({required:{operation:o.literal("setValue"),key:d,value:o.string(),ttl:o.undefinable(o.number())},optional:{}})),m=o.object({required:{operation:o.literal("setValue"),key:d,value:s,version:o.number()},optional:{}}),f=o.object({required:{operation:o.literal("increment"),key:d,amount:o.number(),ttl:o.undefinable(o.number())},optional:{passThroughData:c}}),g=o.object({required:{operation:o.literal("increment"),key:d,value:o.number(),version:o.number()},optional:{}}),h=o.object({required:{operation:o.literal("setIfGreater"),key:d,value:o.number(),ttl:o.undefinable(o.number())},optional:{}}),v=o.object({required:{operation:o.literal("setIfGreater"),key:d,value:o.number(),version:o.number()},optional:{}}),b=o.object({required:{operation:o.literal("setField"),key:d,field:o.string(),value:s,ttl:o.undefinable(o.number())},optional:{}}),y=o.object({required:{operation:o.literal("setField"),key:d,field:o.string(),value:l,version:o.number()},optional:{}}),_=o.object({required:{operation:o.literal("updateField"),key:d,field:o.string(),updates:o.record(o.string(),r),ttl:o.undefinable(o.number())},optional:{}}),S=o.object({required:{operation:o.literal("updateField"),key:d,field:o.string(),value:l,version:o.number()},optional:{}}),w=o.object({required:{operation:o.literal("logPageExit"),spaceId:o.string(),userId:o.string(),blockId:o.string(),pageVisitId:o.undefinable(o.string())},optional:{}}),k=o.object({required:{operation:o.literal("logPageExit")},optional:{}}),I={setValue:p,increment:f,setIfGreater:h,setField:b,updateField:_,logPageExit:w},C=o.union(Object.values(I)),x={setValue:m,increment:g,setIfGreater:v,setField:y,updateField:S,logPageExit:k},T=o.union(Object.values(x)),M=(o.object({required:{operations:o.array(C)},optional:{}}),o.object({required:{responses:o.array(T)},optional:{}}),o.object({required:{subscriptions:o.array(o.object({required:{key:d,version:o.number()},optional:{}}))},optional:{}}),o.object({required:{responses:o.array(o.object({required:{key:d,wasNotified:o.boolean()},optional:{}})),internalProcessingTimeMs:o.number()},optional:{}}),o.object({required:{key:d,version:o.number()},optional:{}}),o.object({required:{key:d,wasNotified:o.boolean()},optional:{}}),o.object({required:{keys:o.array(d)},optional:{}}),o.object({required:{keys:o.array(d),internalProcessingTimeMs:o.number()},optional:{}}),o.object({required:{key:d},optional:{}}),o.object({required:{key:d},optional:{}}),o.object({required:{disconnectId:o.string(),operations:o.array(C)},optional:{}}),o.object({required:{disconnectId:o.string(),hadDisconnect:o.boolean()},optional:{}}),o.object({required:{disconnectId:o.string()},optional:{}}),o.object({required:{disconnectId:o.string(),wasRemoved:o.boolean()},optional:{}}),o.union([o.object({required:{type:o.literal("notification"),key:d,value:l,version:o.number()},optional:{passThroughData:c}}),o.object({required:{type:o.literal("response"),status:o.literals("ok","error"),requestId:o.string(),result:o.any()},optional:{}})])),P=o.object({required:{userId:o.string(),present:o.boolean()},optional:{activityTimestamp:o.number(),blockId:o.union([o.isNull(),o.string()])}});o.object({required:{max_records:o.number()},optional:{}}),o.object({required:{values:o.array(u)},optional:{}}),o.object({required:{last_length:o.number(),new_length:o.number(),added:o.boolean()},optional:{}})},11799:(e,t,n)=>{n.d(t,{Z:()=>c});var o=n(67266),i=n.n(o),r=n(53965);let a;const s=new WeakMap;function l(e){let t=s.get(e);return void 0!==t||(t=i()(e),s.set(e,t)),t}a=Symbol.iterator;class c{constructor(){let{getKey:e=l,from:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.map=new Map,this.getKey=void 0,this.getKey=e,t)for(const[n,o]of t)this.set(n,o)}get size(){return this.map.size}set(e,t){return this.map.set(this.getKey(e),[e,t])}get(e){const t=this.map.get(this.getKey(e));if(t)return t[1]}has(e){return this.map.has(this.getKey(e))}delete(e){return this.map.delete(this.getKey(e))}*entries(){for(const e of this.map.values())yield e}[a](){return this.entries()}*keys(){for(const e of this.map.keys())yield JSON.parse(e)}*values(){for(const[e,t]of this.map.values())yield t}valuesArray(){return Array.from(this.values())}compactedValuesArray(){return r.oA(Array.from(this.values()))}}},70096:(e,t,n)=>{n.d(t,{R:()=>i,l:()=>o});const o="center_peek",i="side_peek"},95371:(e,t,n)=>{n.d(t,{CY:()=>m,DG:()=>i,DY:()=>c,MW:()=>s,Sr:()=>d,Xf:()=>u,YL:()=>p,Yc:()=>l,Yz:()=>a,lj:()=>f,mp:()=>r,qF:()=>v,si:()=>g,ub:()=>h});n(57658);var o=n(1898);class i{constructor(e){this.children=e}map(e){const t=this.children.map((t=>t.map(e)));return new i(t)}toString(){return`DetachedTreeRoots([${this.children}])`}}class r{constructor(e,t){this.value=e,this.children=t}map(e){return s(this,(t=>({value:e(t.value),children:t.children})))}toString(){return`Tree(${this.value}, [${this.children}])`}}function a(e,t){return t(e.value)||e.children.some((e=>a(e,t)))}function s(e,t){const n=t(e);if(!n)return;const{value:i,children:a}=n,l=a?a.map((e=>s(e,t))).filter(o.$K):[];return new r(i,l)}function l(e){const{values:t,isAncestor:n,compareOrder:o}=e;if(0===t.length)return;const a=(e,t)=>{for(const o of e)if(n(o.value,t))return void a(o.children,t);e.push(new r(t,[]))},s=t.slice().sort(o),l=[];for(const i of s)a(l,i);return new i(l)}function c(e,t){for(const n of e){if(t(n))return[n];{const e=c(n.children,t);if(e)return[n,...e]}}}function d(e,t){if(t&&t.length>0){const n=t[t.length-1],o=t[t.length-2]||e,i=o.children.findIndex((e=>e===n));if(i>0)return{prev:o.children[i-1]};if(o!==e)return{parent:o}}return{}}function u(e,t){if(t&&t.length>0){const n=t[t.length-1],o=t[t.length-2]||e,i=o.children.findIndex((e=>e===n));return i<o.children.length-1?{next:o.children[i+1]}:u(e,t.slice(0,t.length-1))}return{}}function p(e,t){if(t&&t.length>0){const n=t[t.length-1],o=t[t.length-2]||e,i=o.children.findIndex((e=>e===n));if(i>0){return{prev:m(o.children[i-1])}}if(o!==e)return{parent:o}}return{}}function m(e){for(;e.children.length>0;)e=e.children[e.children.length-1];return e}function f(e,t){if(t&&t.length>0){const n=t[t.length-1];if(n.children.length>0){return{next:n.children[0]}}const{next:o}=u(e,t);return{next:o}}return{}}function g(e){if(e&&e.length>0){const t=e[e.length-1];if(t.children.length>0)return t.children[0]}}function h(e){if(e&&e.length>1)return e[e.length-2]}function v(e,t){if(0===e.length||0===t.length)return-1;for(let n=Math.min(e.length,t.length)-1;n>-1;n--){if(e[n]===t[n])return n}return-1}},39721:(e,t,n)=>{n.d(t,{F:()=>a,o:()=>s});n(21703),n(57658);var o=n(1898),i=n(95371),r=n(73597);const a={applyMutable:function(e,t){const n=(0,i.DY)(e.children,(e=>e===t.target));if(void 0===n)return!1;if(0===n.length)throw new Error("findPathInTree: empty path");const r=1===n.length?e.children:n[n.length-2].children,a=r.indexOf(t.target);if(-1===a)throw new Error("findPathInTree: cannot find node");switch(t.operation){case"indentSelf":return function(e,t){if(0===t)return!1;const n=e[t],o=e[t-1];return e.splice(t,1),o.children.push(n,...n.children),n.children=[],!0}(r,a);case"indentSelfAndSubtree":return function(e,t){if(0===t)return!1;const n=e[t],o=e[t-1];return e.splice(t,1),o.children.push(n),!0}(r,a);case"unindentSelf":{if(1===n.length)return!1;const t=2===n.length?e.children:n[n.length-3].children,o=n[n.length-2],i=t.indexOf(o);if(-1===i)throw new Error("findPathInTree: cannot find node");return function(e,t,n){const o=e[t],i=o.children[n];return o.children.splice(n,1),e.splice(t+1,0,i),!0}(t,i,a)}case"unindentSelfAndUpdateSiblings":{if(1===n.length)return!1;const t=2===n.length?e.children:n[n.length-3].children,o=n[n.length-2],i=t.indexOf(o);if(-1===i)throw new Error("findPathInTree: cannot find node");return function(e,t,n){const o=e[t],i=o.children[n],r=o.children.splice(n+1,o.children.length-n-1);return i.children.push(...r),o.children.splice(n,1),e.splice(t+1,0,i),!0}(t,i,a)}default:(0,o.t1)(t.operation)}}};const s={getIndentOperationsFromTreeRange:(e,t)=>"indent"===t?function(e){const t=[];for(const n of(0,r.bu)(e))t.push({operation:"indentSelf",target:n});return t}(e):"indentSelfAndSubtree"===t?function(e){const t=[];for(const n of(0,r.bu)(e))t.push({operation:"indentSelfAndSubtree",target:n});return t}(e):"unindent"===t?function(e){const t=[];for(const n of(0,r.bu)(e))t.push({operation:"unindentSelfAndUpdateSiblings",target:n});return t.reverse()}(e):"unindentSelf"===t?function(e){const t=[];for(const n of(0,r.bu)(e))t.push({operation:"unindentSelf",target:n});return t.reverse()}(e):void(0,o.t1)(t)}},73597:(e,t,n)=>{n.d(t,{JK:()=>i,bu:()=>a,tL:()=>r});n(21703);var o=n(1898);function*i(e){yield e;for(const t of e.children)yield*i(t)}function*r(e){for(let t=e.startPath.length-1;t>=0;t--){const n=e.getStartBoundary(t);if(!n)throw new Error("Start boundary must be defined");t===e.startPath.length-1?yield n.parent:yield*n.childrenInsideRange}}function*a(e){for(const{position:t,tree:n}of function*(e){for(let t=e.startPath.length-1;t>=0;t--){const n=e.getStartBoundary(t);if(n&&(t===e.startPath.length-1&&(yield{position:"start",tree:n.parent}),t>0))for(const e of n.childrenInsideRange)yield{position:"within",tree:e}}for(let t=0;t<e.endPath.length;t++){const n=e.getEndBoundary(t);if(n)for(const t of n.childrenInsideRange)e.isInEndPath(t)?yield{position:"endPath",tree:t}:yield{position:"within",tree:t}}}(e))switch(t){case"start":case"endPath":yield n;break;case"within":yield*i(n);break;default:(0,o.t1)(t)}}},374:(e,t,n)=>{n.d(t,{Z:()=>i,f:()=>r});var o=n(1898);function i(e){return[{operation:"delete",deleteFromParent:e.moveFromParent,deletingChildren:e.movingChildren,debug:e.debug},{operation:"insert",insertIntoParent:e.moveToParent,insertChildren:e.movingChildren,adjacentSibling:e.moveToAdjacentSibling,direction:e.moveToDirection,debug:e.debug}]}const r={applyMutable:function(e){switch(e.operation){case"delete":return a(e);case"insert":return s(e);case"move":const[t,n]=i(e),r=a(t),l=s(n);return r||l;default:(0,o.t1)(e)}}};function a(e){const{deleteFromParent:t,deletingChildren:n}=e;if(0===n.length)return!1;const o=new Set(n),i=t.children.filter((e=>!o.has(e)));return i.length!==t.children.length&&(t.children=i,!0)}function s(e){const{direction:t,insertChildren:n,insertIntoParent:i,adjacentSibling:r}=e;if(0===n.length)return!1;const a=r?i.children.indexOf(r):-1,s=(()=>{switch(t){case"listBefore":return Math.max(0,a);case"listAfter":return-1===a?i.children.length:a+1;default:(0,o.t1)(t)}})();return i.children.splice(s,0,...n),!0}},70842:(e,t,n)=>{n.d(t,{T:()=>i});n(21703),n(57658);var o=n(95371);class i{constructor(e,t,n){if(this.maxDepth=void 0,this.start=void 0,this.end=void 0,this.startPathSet=void 0,this.endPathSet=void 0,this.isInStartPath=e=>this.startPathSet.has(e),this.isInEndPath=e=>this.endPathSet.has(e),this.commonAncestor=e,this.startPath=t,this.endPath=n,0===this.startPath.length||0===this.endPath.length)throw new Error(`Cannot create TreeRange with empty path: ${this.startPath} ${this.endPath}`);this.start=this.startPath[this.startPath.length-1],this.end=this.endPath[this.endPath.length-1],this.startPathSet=new Set(t),this.endPathSet=new Set(n),this.maxDepth=Math.max(this.startPath.length,this.endPath.length)}static fromNearestCommonAncestor(e,t){const n=(0,o.qF)(e,t);if(!(n<0))return new this(e[n],e.slice(n),t.slice(n))}getStartBoundary(e){if(e>=this.startPath.length||e<0)return;const t=this.startPath[e];if(0===e&&this.startPath.length<=1&&this.endPath.length<=1)return{parentType:"commonAncestor",parent:t,childrenBeforeRange:[],childrenInsideRange:[],childrenAfterRange:t.children.slice()};const n=t.children.findIndex(this.isInStartPath)+1,o=t.children.findIndex(this.isInEndPath),i=t.children.slice(0,n),r=t.children.slice(n,-1===o?void 0:o+1),a=-1===o?[]:t.children.slice(o+1);return 0===e?{parentType:"commonAncestor",parent:t,childrenBeforeRange:i,childrenInsideRange:r,childrenAfterRange:a}:{parentType:"startPath",parent:t,childrenBeforeRange:i,childrenInsideRange:r}}getEndBoundary(e){if(e>=this.endPath.length||e<0)return;if(0===e)return this.getStartBoundary(0);const t=this.endPath[e],n=t.children.findIndex(this.isInStartPath)+1,o=t.children.findIndex(this.isInEndPath)+1,i=t.children.slice(n,o),r=t.children.slice(o);return{parentType:"endPath",parent:t,childrenInsideRange:i,childrenAfterRange:r}}getAnalagousNodesAtOffset(e){const t=this.startPath.length-1-e,n=this.endPath.length-1-e;return{start:this.getStartBoundary(t),end:this.getEndBoundary(n)}}*iterateAnalogousNodes(){for(let e=0;e<this.maxDepth;e++)yield this.getAnalagousNodesAtOffset(e)}getDeletionAtOffset(e){const{start:t,end:n}=this.getAnalagousNodesAtOffset(e),o=[];t&&t.childrenInsideRange.length>0&&o.push({operation:"delete",deleteFromParent:t.parent,deletingChildren:t.childrenInsideRange});const i=(null==t?void 0:t.parent)||this.commonAncestor;if(i&&n&&n.parent!==this.commonAncestor&&n.parent!==i&&n.childrenAfterRange.length>0){const e=i.children.find(this.isInStartPath);o.push({operation:"move",moveFromParent:n.parent,movingChildren:n.childrenAfterRange,moveToParent:i,moveToAdjacentSibling:e,moveToDirection:e?"listAfter":"listBefore"})}return o}*iterateDeletion(){for(let e=0;e<this.maxDepth;e++)yield*this.getDeletionAtOffset(e)}getInsertionAtOffset(e,t,n){const o=Math.max(0,e.length-1-t),i=e[o],r=e[o+1],{start:a,end:s}=this.getAnalagousNodesAtOffset(t),l=[];if(a&&a.childrenInsideRange.length>0){const e=n.get(i)||r;l.push({operation:"move",moveFromParent:a.parent,movingChildren:a.childrenInsideRange,moveToParent:i,moveToAdjacentSibling:e,moveToDirection:e?"listAfter":"listBefore"});const t=a.childrenInsideRange[a.childrenInsideRange.length-1];n.set(i,t)}const c=this.startPath.length-1-t,d=Math.min(c,this.endPath.length-1),u=this.getEndBoundary(d);if(u&&u.parent!==this.commonAncestor&&i!==e[0]){const e=i.children.indexOf(r)+1,t=i.children.slice(e);if(t.length){const e=0===u.childrenInsideRange.length&&u.childrenAfterRange.length>0,n=e?u.childrenAfterRange[0]:u.childrenInsideRange[u.childrenInsideRange.length-1];l.push({operation:"move",moveFromParent:i,movingChildren:t,moveToParent:u.parent,moveToAdjacentSibling:n,moveToDirection:e?"listBefore":"listAfter"})}}return s&&s.parent!==this.commonAncestor&&s.childrenAfterRange.length>0&&l.push({operation:"delete",deleteFromParent:s.parent,deletingChildren:s.childrenAfterRange}),l}*iterateInsertionAt(e){const t=new Map,n=[];for(let o=0;o<this.maxDepth;o++)n.push(...this.getInsertionAtOffset(e,o,t));yield*n}}},66504:(e,t,n)=>{n.d(t,{I:()=>a,o:()=>s});var o=n(1898),i=n(45953);let r;const a="guest";r=Symbol.iterator;class s{constructor(e){this.data=void 0,this.data=e??{}}getUserRecordMap(e){const t=e??a;let n=this.data[t];return n||(n=i.PF.create(),this.data[t]=n),n}getValue(e){return this.getUserRecordMap(e.userId).getValue(e.pointer)}getRole(e){return this.getUserRecordMap(e.userId).getRole(e.pointer)}setValueAndRole(e,t,n){return this.getUserRecordMap(e.userId).setValueAndRole(e.pointer,t,n),this}setModelAndRole(e,t,n){return this.getUserRecordMap(e.userId).setModelAndRole(e.pointer,t,n),this}delete(e){this.getUserRecordMap(e.userId).delete(e.pointer)}*[r](){for(const[e,t]of(0,o.qP)(this.data))for(const{pointer:n,model:o,role:i}of t)void 0!==o&&(yield{pointer:n,model:o,role:i,userId:e===a?void 0:e})}}},40902:(e,t,n)=>{n.d(t,{B9:()=>A,BX:()=>C,Dn:()=>x,Fb:()=>Z,KN:()=>U,OC:()=>w,OS:()=>T,Yr:()=>M,Z3:()=>E,fc:()=>B,gg:()=>D,hY:()=>O,j4:()=>R,lv:()=>F,md:()=>V,n_:()=>L,tR:()=>S});n(57658);var o=n(53965),i=n(7032),r=n(1898),a=n(19584),s=n(41432),l=n(99036),c=(n(80951),n(59753)),d=n(72141),u=n(70921),p=n(21202),m=n(6287),f=(n(13493),n(33709)),g=n(65311),h=n(75246),v=n(29369),b=n(19889),y=n(99108),_=n(70203);a.hM;function S(e,t){const n=c.kk.fromValue(u.TY,t),{edits:r,index:a}=e,s=[...n&&n.getEdits()||[],...r],l=y.VR(s),d=l[0],g=d&&d.timestamp.toString()||n&&n.start_time||r[0].timestamp,b=o.Z$(l),_=b&&b.timestamp.toString()||n&&n.end_time||g,S=k(r[0]),w=function(e){const{space_id:t,navigable_block_id:n,collection_id:o,collection_row_id:i,top_level_block_id:r,discussion_id:a,team_id:s,access_request_type:l}=e;return n?"guest_invite_request"===l?{parent_table:h.bx,parent_id:t}:{parent_table:p.iU,parent_id:n}:r?{parent_table:p.iU,parent_id:r}:i?{parent_table:p.iU,parent_id:i}:a?{parent_table:f.qF,parent_id:a}:o?{parent_table:m.vF,parent_id:o}:s?{parent_table:v.e0,parent_id:s}:{parent_table:h.bx,parent_id:t}}(r[0]);return{type:u.L8[r[0].type],index:a,start_time:g.toString(),end_time:_.toString(),edits:l.slice(0,1e3),invalid:I(l),shard_id:(0,i.bm)(S.space_id),context_id:u.rH(S),...S,...w}}function w(e){if("collection-changed"===e.type&&e.collection_data){if(!e.collection_data.before&&!e.collection_data.after)return!1;if(!e.collection_data.before||!e.collection_data.after)return!0;return x(e.collection_data.before.description,e.collection_data.after.description)}if("collection-created"===e.type&&e.collection_data){const t=e.collection_data.description;return Boolean(t)}return!1}function k(e){return a.ei(e,u.uJ)}function I(e){if(0===y.hI(e).length)return!0;{const t=e[0];if("mention-deleted"===t.type)return!0;if("mention-created"===t.type){if(t.authors&&t.authors.some((e=>e.table===b.KJ&&e.id===t.mentioned_user_id)))return!0}else if(e.every((e=>"comment-deleted"===e.type)))return!0}return!1}function C(e,t){const n=function(e){const t=c.kk.fromValue(u.TY,e),n=t&&t.getEdits()||[];return a.cf(o.xH(n.map((e=>e.authors||[]))))}(c.kk.fromValue(u.TY,e));return n.some((e=>e.table===b.KJ&&e.id===t))}function x(e,t){const n=_.V3g(e||[],{removeSuggestions:!0,removeDiscussions:!0}),i=_.V3g(t||[],{removeSuggestions:!0,removeDiscussions:!0});return!o.Xy(n,i)}function T(e){const{before:t,after:n,schema:o}=e,i=[];return(o?Object.keys(o):l.qF).forEach((e=>{x(t&&t.properties&&t.properties[e],n&&n.properties&&n.properties[e])&&i.push(e)})),i}function M(e){const{before:t,after:n}=e,o=[];return new Set((0,r.Yd)(t.properties||{}).concat((0,r.Yd)(n.properties||{}))).forEach((e=>{x(t&&t.properties&&t.properties[e],n&&n.properties&&n.properties[e])&&o.push(e)})),o}const P=["page_icon","is_placeholder"];function A(e){const{before:t,after:n}=e,o=[];return P.forEach((e=>{(t.format&&t.format[e])!==(n.format&&n.format[e])&&o.push(e)})),o}function R(e){const{before:t,after:n,property:o}=e;return x(t&&t.properties&&t.properties[o],n&&n.properties&&n.properties[o])}function D(e){return T(e).length>0}function E(e){return e.after.type===s.Ti.tableRow&&M(e).length>0}function B(e){return A(e).length>0}function F(e){const{before:t,after:n}=e,o=c.kk.fromBlock(t),i=c.kk.fromBlock(n),r=o.type,a=i.type,s=o.isNavigableBlock()&&i.isNavigableBlock();return r&&a&&r!==a&&!s}function O(e){const{activity:t,getRecordModel:n,baseUrl:o,pageVisitSource:i}=e;if(t.isType("top-level-block-created")||t.isType("top-level-block-deleted")){const e=n(t.getTopLevelBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else if(t.isType("commented")){const e=n(t.getDiscussionPointer());if(e){const t=n(e.getParentPointer());if(t)return t.getRenderUrl({getRecordModel:n,baseUrl:o,discussionId:e.id,pageVisitSource:i})}}else if(t.isType("collection-row-created")||t.isType("collection-row-deleted")){const e=n(t.getCollectionRowPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else if(t.isType("permissions-edited")){const e=t.getNavigableBlockPointer();if(e){const t=n(e);if(t)return t.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else{const e=n(t.getSpacePointer());if(e)return e.getRenderUrl({baseUrl:o})}}else if(t.isType("block-edited")){const e=n(t.getNavigableBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else if(t.isType("user-mentioned")){const e=n(t.getMentionedBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else if(t.isType("reminder")){const e=n(t.getReminderBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else if(t.isType("user-invited")){const e=t.getNavigableBlockPointer();if(e){const t=n(e);if(t)return t.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else{const e=n(t.getSpacePointer());if(e)return e.getRenderUrl({baseUrl:o})}}else if(t.isType("block-property-edited")){const e=n(t.getNavigableBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else if(t.isType("private-content-transferred")){const e=n(t.getNavigableBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else if(t.isType("access-request-resolved")){const e=n(t.getNavigableBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else if(t.isType("verification-expired")){const e=n(t.getNavigableBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else if(t.isType("in-app-notification-automation-action-triggered")){const e=n(t.getNavigableBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}return o||"/"}function Z(e){switch(e){case"top-level-block-created":return"activity_top_level_block_created";case"top-level-block-deleted":return"activity_top_level_block_deleted";case"collection-row-created":return"activity_collection_row_created";case"collection-row-deleted":return"activity_collection_row_deleted";case"block-edited":return"activity_block_edited";case"block-property-edited":return"activity_block_property_edited";case"permissions-edited":return"activity_permissions_edited";case"user-mentioned":return"activity_mention";case"commented":return"activity_comment";case"user-invited":return"activity_invited";case"collection-edited":return"collection_edited";case"collection-view-edited":return"collection_view_edited";case"collection-property-edited":return"collection_property_edited";case"reminder":return"activity_reminder";case"permission-group-edited":return"activity_permission_group_edited";case"page-locked":return"activity_page_locked";case"page-unlocked":return"activity_page_unlocked";case"email-edited":return"activity_email_edited";case"access-requested":return"activity_access_requested";case"access-request-resolved":return"activity_access_request_resolved";case"page-deleted":return"activity_page_deleted";case"page-restored":return"activity_page_restored";case"page-permanently-deleted":return"activity_page_permanently_deleted";case"team-membership-edited":return"activity_team_membership_edited";case"private-content-transferred":return"activity_private_content_transferred";case"permission-group-mentioned":return"activity_permission_group_mentioned";case"verification-expired":return"activity_verification_expired";case"import-completed":return"activity_import_completed";case"export-completed":return"activity_export_completed";case"in-app-notification-automation-action-triggered":return"activity_in_app_notification_automation_action_triggered"}}function V(e){const t=[],n=[],o=[];return e.forEach((e=>{!function(e){if("permission-created"===e.type){const t=e.permission_data;if("user_permission"===t.type&&d.YX(t.role)&&e.authors&&1===e.authors.length&&e.authors[0].table===b.KJ&&e.authors[0].id===t.user_id)return!0}return!1}(e)?"permission-restriction-created"===e.type||"permission-restriction-deleted"===e.type?n.push(e):o.push(e):t.push(e)})),{autojoinEdits:t,inheritanceEdits:n,otherEdits:o}}function U(e){return"commented"===e||"following"===g.hE[e]}function L(e){return"mentions"===g.hE[e]}},19234:(e,t,n)=>{n.d(t,{A:()=>r});n(53965);const o=/^\d{5}(-\d{4})?$/,i=/^[ABCEGHJKLMNPRSTVXY]\d[ABCEGHJKLMNPRSTVWXYZ] ?\d[ABCEGHJKLMNPRSTVWXYZ]\d$/i;function r(e){if(!e.country)return!1;switch(e.country){case"US":return o.test(e.zipCode);case"CA":return i.test(e.zipCode);default:return!0}}},79946:(e,t,n)=>{n.d(t,{iI:()=>_,HR:()=>w,SY:()=>y,Q3:()=>S,rQ:()=>f,xx:()=>b,j:()=>g,VT:()=>x,dG:()=>k,k3:()=>D,PL:()=>P,L1:()=>T,Dq:()=>R,I$:()=>C,T1:()=>I,tO:()=>M,kd:()=>A});n(57658);var o=n(52629),i=n(1898),r=n(18265),a=n(74686),s=n(68626),l=n(54153),c=n(46637);let d,u,p=[],m="/";async function f(e){const{device:t,config:n,cookieService:o}=e;u=!["staging","production"].includes(n.env),await a.vO({trackingType:"targeting",cookieService:o})&&(t.isNative||t.doNotTrackEnabled||(m=function(e){if(e.isLocalhost)return"http://localhost:3000";return"https://aif.notion.so"}(n),function(e){if(!m)return;const t=document.createElement("iframe");t.setAttribute("sandbox","allow-scripts allow-same-origin"),t.setAttribute("style","position: absolute; opacity: 0; width: 1px; height: 1px; top: 0; left: 0; border: none; display: block; z-index: -1;"),t.setAttribute("aria-hidden","true"),t.setAttribute("tabindex","-1"),t.setAttribute("referrerpolicy","no-referrer"),t.setAttribute("src",e.aif.url),document.body.appendChild(t),t.addEventListener("load",(()=>{d=t;for(const e of p)v(t,e);p=[]}))}(n)))}async function g(e){const{device:t,event:n,cookieService:i}=e;if(await a.vO({trackingType:"targeting",cookieService:i}))if(t.isNative||t.doNotTrackEnabled)h(n)&&s.log({level:"info",from:"adAnalyticsHelpers",type:"analyticsTrackSignupDoNotTrackEnabled"});else try{d?v(d,n):p.push(n)}catch(r){s.log({level:"error",from:"adAnalyticsHelpers",type:"analyticsTrack",error:(0,o.Ui)(r)})}}function h(e){var t,n;return"CompleteRegistration"===(null===(t=e.facebook)||void 0===t?void 0:t.eventName)||"registration"===(null===(n=e.google)||void 0===n?void 0:n.eventName)}function v(e,t){h(t)&&s.log({level:"info",from:"adAnalyticsHelpers",type:"analyticsTrackSignupIFramePostCall"}),e.contentWindow&&e.contentWindow.postMessage(t,m)}function b(e){if("facebook"===e.type){const t=`fb.1.${Date.now()}.${e.id}`;c.Z.set("adClick",{type:"facebook",id:t})}else"google"===e.type?c.Z.set("adClick",{type:"google",id:e.id}):(0,i.t1)(e)}function y(){return c.Z.get("adClick")}function _(){c.Z.remove("adClick")}function S(){return c.Z.get("fbp")}function w(){l.Z.remove("fbp")}function k(e){const{eventType:t,source:n,eventData:o}=e;if(u)console.debug(`track GTM event:%c ${t}`,"font-weight: bold;",o);else if("front"===n){(window.dataLayer=window.dataLayer||[]).push({event:t,data:o})}else{const e={google:{eventName:"custom",data:{event:t,data:o}}};d&&d.contentWindow?d.contentWindow.postMessage(e,m):p.push(e)}}function I(){k({eventType:"sign_up_flow_start",source:"client"})}function C(){k({eventType:"sign_up_flow_complete",source:"client"})}function x(e){let{planType:t,subscriptionTier:n,domainType:o}=e;t&&"team"===t?k({eventType:"create_space",source:"client",eventData:{planType:t}}):n&&k({eventType:"create_space",source:"client",eventData:{subscriptionTier:n,domainType:o}})}function T(e){let{planType:t,subscriptionTier:n}=e;k({eventType:"professional_workspace_created",source:"client",eventData:{planType:t,subscriptionTier:n}})}function M(e){let{planType:t,subscriptionTier:n}=e;k({eventType:"team_workspace_created",source:"client",eventData:{planType:t,subscriptionTier:n}})}function P(){k({eventType:"onboarding_complete",source:"client"})}function A(e,t){k({eventType:"workspace_first_invite_sent",source:"client",eventData:{subscriptionTier:e,domainType:t}})}function R(){k({eventType:"professional_workspace_first_invite_sent",source:"client"})}async function D(e){var t;const{device:n,email:o,cookieService:i}=e,a=(0,r.DP)(null===(t=document.location)||void 0===t?void 0:t.href),s=null==a?void 0:a.get("cid"),l=null==a?void 0:a.get("metadata_cid");var c;if(l)return g({device:n,event:{metadataio:{eventName:"sign_up",data:{email:o,cid:s,mcid:l,url:null===(c=document.location)||void 0===c?void 0:c.href}}},cookieService:i})}},93214:(e,t,n)=>{n.d(t,{l$:()=>s,yN:()=>l});var o=n(18265);const i="tid",r=new Set(["visit","page_visit","landing_page_visit","login_success"]);let a;function s(e){if(r.has(e))return a}function l(e){if(a)return;const t=(0,o.Ph)(e,i);if(!t)return;a=t;const n=(0,o.iO)(e,i);window.history.replaceState(window.history.state,"",n)}},82813:(e,t,n)=>{n.d(t,{e:()=>i});var o=n(1898);function i(e,t){const{notificationId:n,activityId:i,sessionId:r,from:a,alreadyRead:s}=t,l=function(e){const{alreadyRead:t,from:n}=e;switch(n){case"mark_as_unread":return t?"unread":"no_change";case"read_on_page":case"email":case"mark_as_read":case"add_reaction":case"title":case"body":case"frame":case"archive":case"unarchive":case"open_reply_menu":case"mark_all_as_read":case"main":return t?"no_change":"read";default:return(0,o.t1)(n)}}({alreadyRead:s,from:a});if("no_change"===l)return;const c={notificationId:n,activityId:i,sessionId:r,from:a,target:l};e.trackEvent({eventName:"mark_notification_as_read",properties:c})}},5809:(e,t,n)=>{n.d(t,{$:()=>r});n(21703);var o=n(12139);const i="__webStartTime";function r(){const e=window[i];if("number"==typeof e)return e;{const e=new Error("App Start Time not found. It should be in index.html.");o.IE(e)}}},94568:(e,t,n)=>{n.d(t,{vj:()=>o});const o="5ee0e0b5-7f0a-4788-a438-f37644514636"},37167:(e,t,n)=>{n.d(t,{t:()=>s});var o=n(7032),i=n(18265),r=n(15145),a=n(80310);function s(e){const{pageId:t,scrollToBlockId:n,pageVisitSource:s}=e,l={};return l[a.UJ]=(0,o.cj)(t),s&&(l[r.$X]=String(s)),(0,i.bf)({url:"/chat",query:l,hash:n&&(0,o.cj)(n)})}},41154:(e,t,n)=>{n.d(t,{Oy:()=>l,PX:()=>a,UI:()=>c,oi:()=>s});var o=n(7032),i=n(63811),r=n(12847);function a(){return(0,o.ZP)()}const s=(0,i.Z$)((e=>r.uuid().validator(e)),r.uuid().toString);function l(){return(0,o.ZP)()}const c=(0,i.Z$)((e=>r.uuid().validator(e)),r.uuid().toString)},38823:(e,t,n)=>{n.d(t,{m9:()=>r,v4:()=>i});var o=n(12174);const i=4;class r{constructor(e){this.getEligibleGroup=void 0,this.isAiEnabledFn=void 0,this.getIsWorkspaceVectorEmbeddingsComplete=void 0,this.getCanWorkspaceUseVectorEmbeddingsCollectionIdFilter=void 0,this.checkGate=void 0,this.getEligibleGroup=e.getEligibleGroup,this.isAiEnabledFn=e.isAiEnabled,this.getIsWorkspaceVectorEmbeddingsComplete=e.getIsWorkspaceVectorEmbeddingsComplete,this.getCanWorkspaceUseVectorEmbeddingsCollectionIdFilter=e.getCanWorkspaceUseVectorEmbeddingsCollectionIdFilter,this.checkGate=e.checkGate}isAiEnabled(){return this.isAiEnabledFn()}isQnAExplicitlyDisabled(){return this.checkGate("disable_qna_for_workspace")}isXMLAssistantEnabled(){return this.modeIsAtMost("development")}isJSAssistantEnabled(){return this.modeIsAtMost("wild_west")}isContextEnabled(){return this.modeIsAtMost("exploratory")}isAssistantExperienceQna(){return this.isMode("beta")||this.isMode("alpha")}showRemindersToUseQnA(){return this.modeIsAtMost("beta")&&this.checkGate("qna_enable_reminders")}isChatHistoryEnabled(){return this.modeIsAtMost("beta")}isBlockCitationsEnabled(){return this.modeIsAtMost("alpha")&&this.checkGate("qna_block_citations")}isWorkspaceVectorEmbeddingsComplete(){return this.getIsWorkspaceVectorEmbeddingsComplete()}isQnaShowLargeRemindersEnabledForUser(){return"on"===this.getEligibleGroup("qna_show_large_reminders")}isQnaShowAssistantOriginInputEnabledForUser(){return"on"===this.getEligibleGroup("qna_show_assistant_origin_input")}canUseDatabaseScopedSearch(){return this.getCanWorkspaceUseVectorEmbeddingsCollectionIdFilter()&&this.modeIsAtMost("development")}getMode(){if(!this.isAiEnabledFn())return"control";if(this.isQnAExplicitlyDisabled())return"control";const e=this.getEligibleGroup("assistant_variant");return e&&o.KM.find((t=>t===e))?e:this.getIsWorkspaceVectorEmbeddingsComplete()?"beta":"control"}isMode(e){return this.getMode()===e}modeIsAtMost(e){const t=["control",...o.KM],n=this.getMode();return t.indexOf(e)<=t.indexOf(n)}}},3865:(e,t,n)=>{n.d(t,{$M:()=>x,AQ:()=>S,Cf:()=>D,NO:()=>b,Q9:()=>f,SF:()=>h,TX:()=>R,Vd:()=>m,XO:()=>T,Ym:()=>C,bD:()=>P,cO:()=>v,g9:()=>y,n6:()=>k,rX:()=>I,vp:()=>w});n(57658);var o=n(53965),i=n(40470),r=n(1898),a=n(81730),s=n(23290),l=n(99036),c=n(6695),d=n(35102),u=n(76218),p=n(482);function m(e){return"event"===e.trigger.type}function f(e){return"recurrence"===e.trigger.type}(0,r.AO)((e=>(0,r.$K)(e)&&(0,r.$K)(e.target)&&(0,r.$K)(e.external_bot_id)?{true:{external_bot_id:e.external_bot_id,target:e.target}}:{false:e}));const g={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1};function h(e){return Boolean(g[e.type]&&!(0,l.NK)(e)&&(!(0,l.qQ)(e)||void 0===(0,l.q3)(e)))}function v(e){const{collectionFormat:t,collectionSchema:n,filter:i,sort:a,sourcePropertyIds:s}=e,l=(s??(0,r.Yd)(n)).filter(((e,t,o)=>{const r=n[e];return!(!r||!h(r))&&(!i||i([e,r],t,n))}));if(0===l.length)return[];if(!t||!1===a)return l;const d=(0,c.iB)(t,n,void 0,c.j5.Page).collection_page_properties||[];return o.MR(l,(e=>d.findIndex((t=>t.property===e))))}function b(e){const{collectionFormat:t,collectionSchema:n,sort:i}=e,a=(0,r.Yd)(n).filter(((e,t,o)=>{const i=n[e];return!(!i||!((0,l.KR)(i)||(0,l.M0)(i)||(0,l.To)(i)))}));if(0===a.length)return[];if(!t||!1===i)return a;const s=(0,c.iB)(t,n,void 0,c.j5.Page).collection_page_properties||[];return o.MR(a,(e=>s.findIndex((t=>t.property===e))))}async function y(e){const{config:t,collectionPointer:n,collectionSchema:o,actionId:r,context:l,getCurrentPropertyValue:c}=e,p={};for(const f of t.properties||[]){var m;const e=null===(m=t.values)||void 0===m?void 0:m[f],g=null==o?void 0:o[f];if(!g||!h(g))continue;const v=(0,u.H0)(n,f,g);if(!v)return{error:new a.Ox({actionId:r,property:f,collectionPointer:n})};const b=await(0,u.OH)({value:(null==e?void 0:e.value)||{type:"simple",value:void 0},context:{...l,returnType:v},executeFormula:l.executeContextualFormula});if(i.x.isFail(b))return{error:new a.x6({actionId:r,cause:b.error})};const y=(0,d.bw)({result:b.value,action:(0,s.o9)(e),currentPropertyValue:null==c?void 0:c(f),propertySchema:g});p[f]=y}return{value:p}}function _(e,t){"replace"===e.type?t(e.value):"keep"===e.type||(0,r.t1)(e)}function S(e){const{pointer:t,target:n,visitor:o}=e,i=[];return _(o.visitVariableOutsideOfFormula(n.id),(e=>{(0,r.$K)(e)?i.push(p.op.update({pointer:t,path:["config","target"],args:{id:e}})):i.push(p.op.update({pointer:t,path:["config"],args:{target:null}}))})),i}function w(e){const{pointer:t,config:{properties:n,values:o},visitor:i}=e;if(!n||!o)return[];const r=[];for(const a of n){const e=o[a];null!=e&&e.value&&_(i.visitFormula(e.value),(n=>{r.push(p.op.update({pointer:t,path:["config","values"],args:{[a]:n?{...e,value:n}:null}}))}))}return r}function k(e){const{fieldName:t,pointer:n,config:o,visitor:i}=e,r=[],a=o[t];return a&&_(i.visitFormula(a),(e=>{r.push(p.op.update({pointer:n,path:["config"],args:{[t]:e??null}}))})),r}function I(e){const{formulaValueTypes:t,minimumRole:n,targetId:o}=e,i=(0,d.vx)(t,o);if(i){const e=i.type;if("array"===e.type&&"block"===e.of.type&&e.of.collection)return[{type:"record_permission",pointer:e.of.collection,minimumRole:n??"reader"}]}return[]}const C={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,button:!1,file:!1,verification:!1,auto_increment_id:!1,created_by:!1,created_time:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1};function x(e){return Boolean(C[e.type])}function T(e){const{collectionFormat:t,collectionSchema:n,filter:i,sort:a}=e,s=(0,r.Yd)(n).filter(((e,t,o)=>{var r;const a=n[e];return!(!a||!C[a.type])&&((!(0,l.qQ)(a)||null===(r=(0,l.q3)(a))||void 0===r||!r.auto_update_on_edit)&&(!i||i([e,a],t,n)))}));if(0===s.length)return[];if(!t||!1===a)return s;const d=(0,c.iB)(t,n,void 0,c.j5.Page).collection_page_properties||[];return o.MR(s,(e=>d.findIndex((t=>t.property===e))))}const M={checkbox:!0,multi_select:!0,select:!0,status:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,date:!1,email:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,number:!1,person:!1,phone_number:!1,relation:!1,rollup:!1,text:!1,title:!1,url:!1,verification:!1};function P(e){return M[e.type]}const A={checkbox:!0,created_by:!0,created_time:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,last_edited_by:!0,last_edited_time:!0,auto_increment_id:!1,button:!1,file:!1,formula:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1};function R(e){return A[e.type]}function D(e){const{tab:t}=e;return"automationSettings"===(null==t?void 0:t.type)||"automationCreateSettings"===(null==t?void 0:t.type)||"automationEditSettings"===(null==t?void 0:t.type)}},48777:(e,t,n)=>{n.d(t,{L:()=>k,Y:()=>S});n(57658),n(21703);var o=n(9291),i=n(7032),r=n(40470),a=n(1898),s=n(3865),l=n(41432),c=n(97531),d=n(73110),u=n(35102),p=n(45681),m=n(47453),f=n(482),g=n(63306),h=n(18844),v=n(21202),b=n(6287),y=n(81730);const _=(0,o.defineMessages)({createPage:{id:"automations.actions.createPage",defaultMessage:"Add page toâ€¦"},createPageDefaultVariableName:{id:"automations.actions.createPageDefaultVariableName",defaultMessage:"New page added"},createPageVariableNameWithDatabase:{id:"automations.actions.createPageVariableNameWithDatabase",defaultMessage:"New page added in {databaseName}"},createPageVariableNameWithDatabaseAndStepNumber:{id:"automations.actions.createPageVariableNameWithDatabaseAndStepNumber",defaultMessage:"New page added in {databaseName} from step {stepNumber}"},createPageDescription:{id:"automations.actions.createPageDescription",defaultMessage:"Adds a new page to a database."}}),S={relation:!0,person:!0,multi_select:!0,title:!1,text:!1,url:!1,email:!1,phone_number:!1,checkbox:!1,created_by:!1,last_edited_by:!1,file:!1,select:!1,status:!1,number:!1,date:!1,created_time:!1,last_edited_time:!1,last_visited_time:!1,formula:!1,rollup:!1,button:!1,auto_increment_id:!1,location:!1,verification:!1},w=new Set(["button","event","recurrence"]),k={type:"create_page",display:{icon:m.R,name:_.createPage,description:_.createPageDescription,hasSideEffects:!0},isAvailableForContext:async e=>{let t=e.automation.getTriggerType();return"notification_event"===t&&(t="event"),"event"===t?await e.checkSubscribed():w.has(t)},getExecutionDependencies:(e,t)=>{const n=[],o=t.getConfig();return null!=o&&o.collection&&(n.push({type:"record_permission",pointer:o.collection,minimumRole:"content_only_editor"},{type:"collection_default_template_record_permission",pointer:o.collection,minimumRole:"none"}),null!=o&&o.template_page_id&&n.push({type:"record_permission",pointer:{id:o.template_page_id,spaceId:o.collection.spaceId,table:v.iU},minimumRole:"reader"})),n},typecheck:(e,t)=>{const n=t.getConfig();if(null==n||!n.collection)return{value:{validationFailures:[{type:"missing_required_config",actionType:"create_page",key:"collection"}]}};const o=e.getRecordModel(n.collection);if(!o)return{value:{validationFailures:[{type:"missing_required_config",actionType:"create_page",key:"collection"}]}};if(!n.collection.spaceId)return{error:new y.MO("Collection missing space ID")};if(n.template_page_id){const t=e.getRecordModel({id:n.template_page_id,table:v.iU});if(!t)return{value:{validationFailures:[{type:"invalid_optional_config",actionType:"create_page",key:"template"}]}};if(!t.isTemplate())return{value:{validationFailures:[{type:"invalid_optional_config",actionType:"create_page",key:"template"}]}};if(t.getParentId()!==n.collection.id)return{value:{validationFailures:[{type:"invalid_optional_config",actionType:"create_page",key:"template"}]}}}let i=!1,r=!1;for(const d of e.automationModel.getActionIds()){if(d===t.id)continue;const o=e.getRecordModel({id:d,spaceId:e.automationModel.getSpaceId(),table:h.Xj});var a;if("create_page"===(null==o?void 0:o.type))i=!0,(null===(a=o.getConfig())||void 0===a||null===(a=a.collection)||void 0===a?void 0:a.id)===n.collection.id&&(r=!0)}const s=(0,u.Kd)({source:"action",action_id:t.id,action_output_type:"page"}),l=e.automationModel.getActionIds().indexOf(t.id)??-1,c=o.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:e.userTimeZone,intl:e.intl}),p=r?e.intl.formatMessage(_.createPageVariableNameWithDatabaseAndStepNumber,{databaseName:c,stepNumber:l+1}):i?e.intl.formatMessage(_.createPageVariableNameWithDatabase,{databaseName:c}):e.intl.formatMessage(_.createPageDefaultVariableName);return{value:{valueTypes:[{kind:d.yp.ContextValue,id:s,name:p,type:{type:"block",collection:n.collection}}]}}},execute:async(e,t)=>{const n=t.getConfig();if(null==n||!n.collection||!n.collection.spaceId)return{error:new y.mK({pointer:null==n?void 0:n.collection,actionId:t.id})};const o=await e.loadRecordModel(n.collection);if(!o)return{value:{values:[]}};const m=o.getSpaceShardedPointer(),g=o.getNormalizedSchema();let h,_,S;if(g){const o=await(0,s.g9)({config:n,collectionPointer:m,collectionSchema:g,actionId:t.id,context:e});if(r.x.isFail(o))return o;h=o.value}else h={};if(n.template_page_id){const t={id:n.template_page_id,spaceId:n.collection.spaceId,table:v.iU};I({getRecordModel:(await e.handleDataRequest({recordPointers:[t]})).getRecordModel,pointer:t})&&(_=n.template_page_id)}if(!(0,a.$K)(_)){const t=(await e.handleDataRequest({recordPointers:[n.collection]})).getRecordModel(n.collection),o=null==t?void 0:t.getDefaultTemplatePagePointer();if(o){I({getRecordModel:(await e.handleDataRequest({recordPointers:[o]})).getRecordModel,pointer:o})&&(_=o.id)}}const w=[];if(_){const t=await e.executeEffectMap.initializeTemplateInDatabase({templateId:_,collection:n.collection,propertyUpdates:h});if(r.x.isFail(t))return t;S=t.value.pageId}else{S=(0,i.ZP)();const t={created_time:Date.now(),last_edited_time:Date.now(),id:S,type:l.Ti.page,version:0,parent_id:n.collection.id,parent_table:b.vF,alive:!0,space_id:n.collection.spaceId,properties:h,...e.author?{created_by_table:e.author.table}:{},...e.author?{created_by_id:e.author.id}:{}};w.push(...(0,c.Vt)([f.op.set({pointer:{table:v.iU,id:t.id,spaceId:t.space_id},path:[],args:t})],!1)),e.author&&w.push(f.op.update({pointer:{table:v.iU,id:S,spaceId:m.spaceId},path:[],args:{last_edited_time:Date.now(),last_edited_by_table:e.author.table,last_edited_by_id:e.author.id}}))}const k=o.isPageTreeCollection(),C=o.getRootPagePointer();if(k&&C){const e=(0,p.A6)(C.table,v.iU);if(!e)throw new Error(`Could not find child path for parent table ${C.table} and child table ${v.iU}`);w.push({pointer:C,path:e,command:"insertChildrenAfter",args:{ids:[S]}})}if(w.length>0){const n=await e.executeEffectMap.saveTransaction({actionId:t.id,info:{type:"create_page",collection:m,pageId:S},operations:w});if(n.error)return n}const x=(0,u.Kd)({source:"action",action_id:t.id,action_output_type:"page"});return{value:{values:[{kind:d.yp.ContextValue,id:x,value:{type:"block",value:{table:v.iU,id:S,spaceId:m.spaceId}}}]}}},acceptFormulaVisitor:e=>{const{action:t,visitor:n}=e,o=t.getConfig();return o?(0,s.vp)({pointer:t.pointer,config:o,visitor:n}):[]}};function I(e){const{getRecordModel:t,pointer:n}=e,o=g.DW(n,t);return g.Zg(o)}},59786:(e,t,n)=>{n.d(t,{z:()=>ge,P:()=>he});var o=n(23290),i=n(9291),r=n(11751);const a=(0,i.defineMessages)({assistant:{id:"automations.actions.assistant",defaultMessage:"Notion AI"},assistantDescription:{id:"automations.actions.assistantDescription",defaultMessage:"Uses Notion AI to execute a task."}}),s={type:"assistant",display:{icon:r.t,name:a.assistant,description:a.assistantDescription,hasSideEffects:!0},isAvailableForContext:async e=>"wild_west"===await e.checkExperimentGroup("assistant_variant"),getExecutionDependencies:(e,t)=>[],typecheck:(e,t)=>({value:{valueTypes:[]}}),execute:(e,t)=>({value:{values:[]}}),acceptFormulaVisitor:e=>[]};n(57658);var l=n(40470),c=n(92996),d=n(40506),u=n(73110),p=n(45953),m=n(98963),f=n(39927),g=n(94438),h=n(70203),v=n(81730),b=n(53965),y=n(7032),_=n(41432),S=n(59753),w=n(482),k=n(96367),I=n(21202),C=n(6287);async function x(e){const{completeSprintAction:t,completeSprintExecutionContext:n}=e,o=await async function(e){const{sprintCollectionSchema:t,sprintCollectionPointer:n}=e.sprintCollectionContext,{context:o,action:i}=e.automationContext,r=k.qB[c.p$].current.reducer.getCombinatorFilter(t);return await A((()=>o.executeEffectMap.queryCollection({actionId:i.id,collection:n,userTimeZone:o.userTimeZone,filter:r,limit:1})),e)}(n);if(l.x.isFail(o))return o;const i=o.value.blockIds[0],r=await async function(e){const{sprintCollectionSchema:t,sprintCollectionPointer:n}=e.sprintCollectionContext,{context:o,action:i}=e.automationContext,r=k.qB[c.p$].next.reducer.getCombinatorFilter(t);return await A((()=>o.executeEffectMap.queryCollection({actionId:i.id,collection:n,userTimeZone:o.userTimeZone,filter:r,limit:1})),e)}(n);if(l.x.isFail(r))return r;const a=b.Ps(r.value.blockIds),[s,d]=await Promise.all([T(n),M(n)]),u=function(e){const{incompleteTasksResult:t,completeTasksResult:n}=e;if(l.x.isFail(t)||l.x.isFail(n))return;const o=t.value.blockIds.length,i=n.value.blockIds.length,r=o+i;return{completedTaskCount:i,incompleteTaskCount:o,totalTaskCount:r,completedTaskPercent:0===r?0:i/r}}({incompleteTasksResult:s,completeTasksResult:d}),p=n.automationContext.context.automationModel.isActive()?"recurrence_automation":"button_automation";let m,g;if((0,f.$X)({eventTracker:n.automationContext.context.eventTracker,properties:{action:"complete_sprint",from:p,completeSprintActionType:t,nextSprintDateRange:n.sprintCollectionContext.nextSprintDateRange,nextSprintInput:a?{type:"pointer",pointer:{id:a,table:I.iU,spaceId:n.spaceId}}:{type:"actionId"},currentSprintTaskSummary:u}}),a)g=a,m=1;else{const e=await async function(e){const{completeSprintExecutionContext:t,currentSprintPageId:n}=e,{sprintStatusNextOptionName:o,sprintStatusPropertyId:i}=t.sprintCollectionContext,{context:r,action:a}=t.automationContext,{recordMap:s,spaceId:l}=t,c={id:n,table:I.iU,spaceId:l},d=s.getModel(c);if(!d)return{error:new v.Do({actionId:a.id,pointer:c})};const u=B({intl:r.intl,userTimeZone:r.userTimeZone,getRecordModel:S.om.fromRecordMap(s),incrementSprintIdAmount:1,sourceSprintPageModel:d}),p={title:(0,h.TPx)(u),[i]:[[o]]};return await D({completeSprintExecutionContext:t,pageProperties:p})}({completeSprintExecutionContext:n,currentSprintPageId:i});if(l.x.isFail(e))return e;g=e.value.blockId,m=2}const y=await async function(e){const{sprintUniqueIdPropertyId:t,sprintStatusPropertyId:n,sprintStatusFutureOptionName:o,sprintCollectionPointer:i}=e.sprintCollectionContext,{context:r,action:a}=e.automationContext,s={operator:"and",filters:[{property:n,filter:{operator:"status_is",value:{type:"is_option",value:o}}}]};return await A((()=>r.executeEffectMap.queryCollection({actionId:a.id,collection:i,filter:s,userTimeZone:r.userTimeZone,sort:[{property:t,direction:"ascending"}],limit:1})),e)}(n);if(l.x.isFail(y))return y;let _=y.value.blockIds[0];if(!_){const e=await R({completeSprintExecutionContext:n,sprintPageWithLargestUniqueId:g,incrementFutureSprintIdAmount:1});if(m=1===m?2:3,l.x.isFail(e))return e;_=e.value.blockId}const C=await async function(e){const{sprintUniqueIdPropertyId:t,sprintCollectionPointer:n}=e.sprintCollectionContext,{context:o,action:i}=e.automationContext;return await A((()=>o.executeEffectMap.queryCollection({actionId:i.id,collection:n,userTimeZone:o.userTimeZone,sort:[{property:t,direction:"descending"}],limit:1})),e)}(n);if(l.x.isFail(C))return C;const x=C.value.blockIds[0];if(function(e){var t;const{sprintStatusPropertySchema:n}=e.sprintCollectionContext;return(null===(t=n.options)||void 0===t?void 0:t.some((e=>e.id===c.Rw)))??!1}(n)){const e=await async function(e){const{sprintCollectionSchema:t,sprintCollectionPointer:n}=e.sprintCollectionContext,{context:o,action:i}=e.automationContext,r=k.qB[c.p$].last.reducer.getCombinatorFilter(t);return await A((()=>o.executeEffectMap.queryCollection({actionId:i.id,collection:n,userTimeZone:o.userTimeZone,filter:r,limit:1})),e)}(n);if(l.x.isFail(e))return e;const t=e.value.blockIds[0],o=await async function(e){const{completeSprintExecutionContext:t,currentSprintPageId:n}=e,{sprintStatusLastOptionName:o,sprintStatusPropertyId:i,sprintCollectionPointer:r}=t.sprintCollectionContext,{context:a,action:s}=t.automationContext,{spaceId:l}=t,c=[];o&&c.push(w.op.update({pointer:{id:n,table:I.iU,spaceId:l},path:["properties"],args:{[i]:[[o]]}}));return await a.executeEffectMap.saveTransaction({actionId:s.id,operations:c,info:{type:"update_pages",collection:r,editedProperties:[{id:i,type:"status"}],pageIds:[n]}})}({completeSprintExecutionContext:n,currentSprintPageId:i});if(l.x.isFail(o))return o;if(t){const e=await async function(e){const{completeSprintExecutionContext:t,lastSprintPageId:n}=e,{sprintStatusPastOptionName:o,sprintStatusPropertyId:i,sprintCollectionPointer:r}=t.sprintCollectionContext,{context:a,action:s}=t.automationContext,{spaceId:l}=t,c=[w.op.update({pointer:{id:n,table:I.iU,spaceId:l},path:["properties"],args:{[i]:[[o]]}})];return await a.executeEffectMap.saveTransaction({actionId:s.id,operations:c,info:{type:"update_pages",collection:r,editedProperties:[{id:i,type:"status"}],pageIds:[n]}})}({completeSprintExecutionContext:n,lastSprintPageId:t});if(l.x.isFail(e))return e}}else{const e=await async function(e){const{completeSprintExecutionContext:t,currentSprintPageId:n}=e,{sprintStatusPastOptionName:o,sprintStatusPropertyId:i,sprintCollectionPointer:r}=t.sprintCollectionContext,{context:a,action:s}=t.automationContext,{spaceId:l}=t,c=[w.op.update({pointer:{id:n,table:I.iU,spaceId:l},path:["properties"],args:{[i]:[[o]]}})];return await a.executeEffectMap.saveTransaction({actionId:s.id,operations:c,info:{type:"update_pages",collection:r,editedProperties:[{id:i,type:"status"}],pageIds:[n]}})}({completeSprintExecutionContext:n,currentSprintPageId:i});if(l.x.isFail(e))return e}const P=await async function(e){const{completeSprintExecutionContext:t,nextSprintPageId:n}=e,{sprintStatusCurrentOptionName:o,sprintStatusPropertyId:i,sprintCollectionPointer:r,nextSprintDateRange:a,sprintDatePropertyId:s}=t.sprintCollectionContext,{context:l,action:c}=t.automationContext,{spaceId:d}=t,u=[w.op.update({pointer:{id:n,table:I.iU,spaceId:d},path:["properties"],args:{[i]:[[o]],[s]:[(0,h.YCD)(["d",a])]}})];return await l.executeEffectMap.saveTransaction({actionId:c.id,operations:u,info:{type:"update_pages",collection:r,editedProperties:[{id:i,type:"status"}],pageIds:[n]}})}({completeSprintExecutionContext:n,nextSprintPageId:g});if(l.x.isFail(P))return P;const E=await async function(e){const{completeSprintExecutionContext:t,nextFutureSprintPageId:n}=e,{sprintStatusNextOptionName:o,sprintStatusPropertyId:i,sprintCollectionPointer:r}=t.sprintCollectionContext,{context:a,action:s}=t.automationContext,{recordMap:l,spaceId:c}=t,d={id:n,table:I.iU,spaceId:c},u=l.getModel(d);if(!u)return{error:new v.Do({actionId:s.id,pointer:d})};l.addModel(u);const p=[w.op.update({pointer:u.pointer,path:["properties"],args:{[i]:[[o]]}})];return await a.executeEffectMap.saveTransaction({actionId:s.id,operations:p,info:{type:"update_pages",collection:r,editedProperties:[{id:i,type:"status"}],pageIds:[n]}})}({completeSprintExecutionContext:n,nextFutureSprintPageId:_});if(l.x.isFail(E))return E;const F=await R({completeSprintExecutionContext:n,sprintPageWithLargestUniqueId:x,incrementFutureSprintIdAmount:m});if(l.x.isFail(F))return F;if("complete_sprint_and_move_incomplete_tasks_to_next_sprint"===t){const e=await async function(e){const{completeSprintExecutionContext:t,incompleteTasksResult:n,nextSprintPageId:o}=e,{taskSprintRelationPropertyId:i,taskCollectionPointer:r}=t.taskCollectionContext,{context:a,action:s}=t.automationContext,{spaceId:c}=t;if(l.x.isFail(n))return n;const d=n.value.blockIds,u=d.map((e=>w.op.update({pointer:{id:e,table:I.iU,spaceId:c},path:["properties"],args:{[i]:[(0,h.YCD)((0,h.$0A)(o,c))]}})));return await a.executeEffectMap.saveTransaction({actionId:s.id,operations:u,info:{type:"update_pages",collection:r,editedProperties:[{id:i,type:"relation"}],pageIds:d}})}({completeSprintExecutionContext:n,incompleteTasksResult:s,nextSprintPageId:g});if(l.x.isFail(e))return e}else if("complete_sprint_and_move_incomplete_tasks_to_backlog"===t){const e=await async function(e,t){const{taskSprintRelationPropertyId:n,taskCollectionPointer:o}=e.taskCollectionContext,{context:i,action:r}=e.automationContext,{spaceId:a}=e;if(l.x.isFail(t))return t;const s=t.value.blockIds,c=s.map((e=>w.op.update({pointer:{id:e,table:I.iU,spaceId:a},path:["properties"],args:{[n]:void 0}})));return await i.executeEffectMap.saveTransaction({actionId:r.id,operations:c,info:{type:"update_pages",collection:o,editedProperties:[{id:n,type:"relation"}],pageIds:s}})}(n,s);if(l.x.isFail(e))return e}return{value:{}}}async function T(e){const{taskStatusCompleteGroupName:t}=e.taskCollectionContext;return await P({statusFilter:{operator:"status_is_not",value:{type:"is_group",value:t}},completeSprintExecutionContext:e})}async function M(e){const{taskStatusCompleteGroupName:t}=e.taskCollectionContext;return await P({statusFilter:{operator:"status_is",value:{type:"is_group",value:t}},completeSprintExecutionContext:e})}async function P(e){const{statusFilter:t,completeSprintExecutionContext:n}=e,{taskStatusPropertyId:o,taskSprintRelationPropertyId:i,taskCollectionPointer:r}=n.taskCollectionContext,{context:a,action:s}=n.automationContext,l={operator:"and",filters:[{property:o,filter:t},{filter:{operator:"relation_contains",value:{type:"relative",value:{type:"builtin",variable:"current"}}},property:i}]};return await A((()=>a.executeEffectMap.queryCollection({actionId:s.id,collection:r,userTimeZone:a.userTimeZone,filter:l})),n)}async function A(e,t){const{spaceId:n,recordMap:o}=t,{context:i}=t.automationContext,r=await e();if(l.x.isFail(r))return r;const a=r.value;if(a.recordMap)o.assign(a.recordMap.toRecordMap());else{const e=a.blockIds.map((e=>({id:e,table:I.iU,spaceId:n}))),t=await i.loadRecordModel(e);o.assign(t)}return{value:{blockIds:a.blockIds}}}async function R(e){const{completeSprintExecutionContext:t,sprintPageWithLargestUniqueId:n,incrementFutureSprintIdAmount:o}=e,{sprintStatusFutureOptionName:i,sprintStatusPropertyId:r}=t.sprintCollectionContext,{context:a,action:s}=t.automationContext,{recordMap:l,spaceId:c}=t,d={id:n,table:I.iU,spaceId:c},u=l.getModel(d);if(!u)return{error:new v.Do({actionId:s.id,pointer:d})};const p=B({intl:a.intl,userTimeZone:a.userTimeZone,getRecordModel:S.om.fromRecordMap(l),incrementSprintIdAmount:o,sourceSprintPageModel:u}),m={title:(0,h.TPx)(p),[r]:[[i]]};return await D({completeSprintExecutionContext:t,pageProperties:m})}async function D(e){const{completeSprintExecutionContext:t,pageProperties:n}=e,{recordMap:o,sprintCollectionContext:i,automationContext:r,spaceId:a}=t,{context:s,action:c}=r,d=i.sprintCollectionPointer,u=o.getModel(d);if(!u)return{error:new v.fH("invalid_record",`Could not find collection record: ${d.id}`)};let p;const m=u.getDefaultTemplatePagePointer();if(m){const e=await s.executeEffectMap.initializeTemplateInDatabase({templateId:m.id,collection:u.getSpaceShardedPointer(),propertyUpdates:n});if(l.x.isFail(e))return e;p=e.value.pageId;const t={id:p,table:I.iU,spaceId:a},i=await s.loadRecordModel(t);if(!i)return{error:new v.fH("invalid_record",`Could not find new sprint page: ${t.id}`)};o.addModel(i)}else{p=(0,y.ZP)();const e={created_time:Date.now(),last_edited_time:Date.now(),id:p,type:_.Ti.page,version:0,parent_id:d.id,parent_table:C.vF,alive:!0,space_id:a,properties:n,...s.author?{created_by_table:s.author.table}:{},...s.author?{created_by_id:s.author.id}:{}},t=[w.op.set({pointer:{id:p,table:I.iU,spaceId:a},path:[],args:e})],i=await s.executeEffectMap.saveTransaction({actionId:c.id,operations:t,info:{type:"create_page",collection:d,pageId:p}});if(l.x.isFail(i))return i;o.setValue({id:p,table:I.iU,spaceId:a},e)}return{value:{blockId:p}}}const E=(0,i.defineMessages)({defaultSprintName:{id:"completeSprint.newSprint.defaultName",defaultMessage:"Sprint"},sprintNameWithId:{id:"completeSprint.newSprintWithId.name",defaultMessage:"Sprint {sprintId}"}});function B(e){const{intl:t,userTimeZone:n,getRecordModel:o,sourceSprintPageModel:i,incrementSprintIdAmount:r}=e,a=i.getRenderTitle({intl:t,userTimeZone:n,getRecordModel:o}),s=b.Z$(null==a?void 0:a.trim().split(" "));let l;if(s){const e=parseInt(s);isNaN(e)||(l=e+r)}return void 0!==l?t.formatMessage(E.sprintNameWithId,{sprintId:l}):t.formatMessage(E.defaultSprintName)}const F={type:"complete_sprint",isAvailableForContext:async e=>Promise.resolve("recurrence"===e.automation.getTriggerType()),getExecutionDependencies:(e,t)=>{const n=t.getConfig(),o=[];return null!=n&&n.sprint_collection&&o.push({type:"record_permission",pointer:n.sprint_collection,minimumRole:"editor"}),null!=n&&n.task_collection&&o.push({type:"record_permission",pointer:n.task_collection,minimumRole:"editor"}),o},typecheck:(e,t)=>({value:{valueTypes:[]}}),execute:async(e,t)=>{var n,i,r,a,s,b,y,_,S,w;const k=t.getConfig();if(!k)return{error:new v.Qq({actionId:t.id})};const I=p.Ak.create(),C=await e.loadRecordModel(k.sprint_collection);if(!C)return{error:new v.Do({actionId:t.id,pointer:k.sprint_collection})};I.addModel(C);const T=C.getNormalizedSchema(),M=null===(n=C.getFormat())||void 0===n||null===(n=n.app_uri_map)||void 0===n?void 0:n[c.b0.StatusV2];if(!M)return{error:new v.Ox({actionId:t.id,collectionPointer:k.task_collection,property:c.b0.StatusV2})};const P=null===(i=C.getFormat())||void 0===i||null===(i=i.app_uri_map)||void 0===i?void 0:i[c.b0.UniqueId];if(!P)return{error:new v.Ox({actionId:t.id,collectionPointer:k.task_collection,property:c.b0.UniqueId})};const A=null===(r=C.getFormat())||void 0===r||null===(r=r.app_uri_map)||void 0===r?void 0:r[c.b0.Dates];if(!A)return{error:new v.Ox({actionId:t.id,collectionPointer:k.task_collection,property:c.b0.Dates})};const R=T[M];if(!R||"status"!==R.type)return{error:new v.Ox({actionId:t.id,collectionPointer:k.task_collection,property:c.b0.StatusV2})};const D=null===(a=R.options)||void 0===a||null===(a=a.find((e=>e.id===c.df)))||void 0===a?void 0:a.value,E=null===(s=R.options)||void 0===s||null===(s=s.find((e=>e.id===c.Rw)))||void 0===s?void 0:s.value,B=null===(b=R.options)||void 0===b||null===(b=b.find((e=>e.id===c.SF)))||void 0===b?void 0:b.value,F=null===(y=R.options)||void 0===y||null===(y=y.find((e=>e.id===c.YE)))||void 0===y?void 0:y.value,O=null===(_=R.options)||void 0===_||null===(_=_.find((e=>e.id===c.eH)))||void 0===_?void 0:_.value;if(!(D&&B&&F&&O))return{error:new v.fH("invalid_property_schema",`Could not find required options for ${c.b0.StatusV2}.`)};const Z={id:e.automationModel.id,table:m.cv,spaceId:C.id},V=e.automationModel;if(!V.isType("recurrence"))return{error:new v.Do({actionId:t.id,pointer:Z})};const U=await e.loadRecordModel(k.task_collection);if(!U)return{error:new v.Do({actionId:t.id,pointer:k.task_collection})};I.addModel(U);const L=null===(S=U.getFormat())||void 0===S||null===(S=S.app_uri_map)||void 0===S?void 0:S[c.Es.Status];if(!L)return{error:new v.Ox({actionId:t.id,collectionPointer:k.task_collection,property:c.Es.Status})};const j=null===(w=U.getFormat())||void 0===w||null===(w=w.app_uri_map)||void 0===w?void 0:w[c.Es.TaskToSprintRelation];if(!j)return{error:new v.Ox({actionId:t.id,collectionPointer:k.task_collection,property:c.Es.TaskToSprintRelation})};const N=U.getNormalizedSchema(),z=N[L];if(!z||"status"!==z.type)return{error:new v.Ox({actionId:t.id,collectionPointer:k.task_collection,property:c.Es.Status})};const q=(0,f.F_)(e.intl,z);if(!q)return{error:new v.fH("invalid_property_schema",`Could not find required group for ${c.Es.Status}.`)};const W=function(e){let t,n;if(e.forEach((e=>{e.kind===u.yp.ContextValue&&(e.id===o.Pv&&"date"===e.value.type&&(0,d.h)(e.value.value)?t=e.value.value:e.id===o.JL&&"text"===e.value.type&&(n=(0,h.QaF)(e.value.value)))})),!(t&&n))return;return{nextSprintDateRange:t,completeSprintActionType:n}}(e.values);let H,K;if(W)H=W.completeSprintActionType,K=W.nextSprintDateRange;else{const t=V.getTrigger().recurrence,n=(0,g.Su)(t);if(!n)return{error:new v.fH("misc",`Invalid recurrence for sprint recurrence automation: ${V.id}`)};K=(0,g.IX)({userTimeZone:e.userTimeZone,sprintSchedule:n}),H=k.complete_sprint_action}const G={spaceId:C.space_id,automationContext:{action:t,context:e},sprintCollectionContext:{sprintCollectionPointer:k.sprint_collection,sprintCollectionSchema:T,nextSprintDateRange:K,sprintDatePropertyId:A,sprintStatusCurrentOptionName:B,sprintStatusFutureOptionName:O,sprintStatusNextOptionName:F,sprintStatusPastOptionName:D,sprintStatusLastOptionName:E,sprintStatusPropertyId:M,sprintStatusPropertySchema:R,sprintUniqueIdPropertyId:P},taskCollectionContext:{taskCollectionPointer:k.task_collection,taskCollectionSchema:N,taskSprintRelationPropertyId:j,taskStatusCompleteGroupName:q,taskStatusPropertyId:L,taskStatusPropertySchema:z},recordMap:I},$=await x({completeSprintAction:H,completeSprintExecutionContext:G});return l.x.isFail($)?$:{value:{values:[]}}},acceptFormulaVisitor:e=>[]};var O=n(48777),Z=n(1898),V=n(88437);const U=(0,i.defineMessages)({duplicateBlocks:{id:"automations.actions.duplicateBlocks",defaultMessage:"Insert blocks"},duplicateBlocksDescription:{id:"automations.actions.duplicateBlocksDescription",defaultMessage:"Insert text or blocks on this page."}}),L={type:"duplicate_blocks",display:{icon:V.a,name:U.duplicateBlocks,description:U.duplicateBlocksDescription,hasSideEffects:!0},isAvailableForContext:async e=>Promise.resolve("button_block"===e.contextType),getExecutionDependencies:(e,t)=>[{type:"record_permission",pointer:e.automationModel.getParentPointer(),minimumRole:"content_only_editor"}],typecheck:()=>({value:{valueTypes:[]}}),execute:async(e,t)=>{var n;const o=b.Ps(t.getBlocks()??[]),i=(null===(n=t.getConfig())||void 0===n?void 0:n.insertion_point)??S.IN.DEFAULT_INSERTION_POINT;return(0,Z.$K)(o)&&await e.executeEffectMap.duplicateBlockChildren({blockPointer:{table:I.iU,id:o,spaceId:e.automationModel.getSpaceId()},insertionPoint:i}),{value:{values:[]}}},acceptFormulaVisitor:e=>[]};var j=n(3865),N=n(35102),z=n(76218),q=n(84169);const W=(0,i.defineMessages)({modalConfirmation:{id:"automations.actions.modalConfirmation",defaultMessage:"Show confirmation"},modalConfirmationDescription:{id:"automations.actions.modalConfirmationDescription",defaultMessage:"Shows a confirmation window before proceeding."}}),H={type:"modal_confirmation",display:{icon:q.m,name:W.modalConfirmation,description:W.modalConfirmationDescription,hasSideEffects:!1},isAvailableForContext:async e=>Promise.resolve("button"===e.automation.getTriggerType()),getExecutionDependencies:(e,t)=>[],typecheck:()=>({value:{valueTypes:[]}}),execute:async(e,t)=>{var n,o,i;const r=t.getConfig();let a=[];if(null!=r&&r.text){const n=await(0,z.OH)({value:r.text,context:{...e,returnType:{type:"text"}},executeFormula:e.executeContextualFormula});if(l.x.isFail(n))return{error:new v.x6({actionId:t.id,cause:n.error})};a=(0,N.j4)(n.value)}(0,h.VrM)(a)>m.tb&&(a=(0,h.Zdj)(a,m.tb),a.push((0,h.V3y)("â€¦")));return"cancel"===await e.executeEffectMap.displayModal({format:{icon:null===(n=e.automationModel.getProperties())||void 0===n?void 0:n.icon,text:a,continueButtonText:(null==r||null===(o=r.continue_button)||void 0===o?void 0:o.text)??"",cancelButtonText:(null==r||null===(i=r.cancel_button)||void 0===i?void 0:i.text)??""}})?{error:new v.nQ}:{value:{values:[]}}},acceptFormulaVisitor:e=>{const{action:t,visitor:n}=e,o=t.getConfig();return o?(0,j.n6)({fieldName:"text",config:o,pointer:t.pointer,visitor:n}):[]}};var K=n(9999);const G=(0,i.defineMessages)({openPage:{id:"automations.actions.openPage",defaultMessage:"Open page"},openPageDescription:{id:"automations.actions.openPageDescription",defaultMessage:"Opens a specified page."}}),$={type:"open_page",display:{icon:K.J,name:G.openPage,description:G.openPageDescription,hasSideEffects:!1},isAvailableForContext:async e=>Promise.resolve("button"===e.automation.getTriggerType()),getExecutionDependencies:(e,t)=>{var n,o;const i=t.getConfig();return"page"===(null==i||null===(n=i.target)||void 0===n?void 0:n.type)?[{type:"record_permission",pointer:null==i?void 0:i.target.page,minimumRole:"reader"}]:"variable"===(null==i||null===(o=i.target)||void 0===o?void 0:o.type)?[{id:i.target.id,minimumRole:"reader",type:"formula_value_permission"}]:[]},typecheck:(e,t)=>{const n=t.getConfig();if(null==n||!n.target)return{value:{validationFailures:[{type:"missing_required_config",actionType:"open_page",key:"target"}]}};if("page"===n.target.type){if(!e.getRecordModel(n.target.page))return{value:{validationFailures:[{type:"missing_required_config",actionType:"open_page",key:"target"}]}}}return{value:{valueTypes:[]}}},execute:(e,t)=>{const n=t.getConfig();if(null==n||!n.target)return{error:new v.mK({pointer:null==n?void 0:n.target,actionId:t.id})};let o;if("page"===n.target.type)o=n.target.page;else if("variable"===n.target.type){const i=(0,N.dh)(e.values,n.target.id);if(!i)return{error:new v.Hb({actionId:t.id,source:"action",variable:void 0})};if("block"===i.value.type)o=i.value.value;else{if("array"!==i.value.type)return{error:new v.Hb({actionId:t.id,source:"action",variable:i.value})};{const e=i.value.values[0];if(!e||"block"!==e.type)return{error:new v.Hb({actionId:t.id,source:"action",variable:i.value})};o=e.value}}}else(0,Z.t1)(n.target);return e.executeEffectMap.navigateToPage({actionId:t.id,page:o,openIn:t.getOpenPageIn()}),{value:{values:[]}}},acceptFormulaVisitor:e=>{var t;const{action:n,visitor:o}=e,i=n.getConfig();if(!i)return[];const r=[];return"variable"===(null==i||null===(t=i.target)||void 0===t?void 0:t.type)&&r.push(...(0,j.AQ)({pointer:n.pointer,target:i.target,visitor:o})),r}};var Q=n(49019);const Y=(0,i.defineMessages)({queryCollection:{id:"automations.actions.queryCollection",defaultMessage:"Get pages"},queryCollectionDescription:{id:"automations.actions.queryCollectionDescription",defaultMessage:"Get a list of pages from a database with optional filters and sorts, to be used in a subsequent automation step."},queryCollectionPages:{id:"automations.actions.queryCollectionPages",defaultMessage:"Pages from step {stepNumber}"}}),J={type:"query_collection",display:{icon:Q.e,name:Y.queryCollection,description:Y.queryCollectionDescription,hasSideEffects:!1},isAvailableForContext:async()=>Promise.resolve(!1),getExecutionDependencies:(e,t)=>{const n=t.getConfig();return null!=n&&n.collection?[{type:"record_permission",pointer:null==n?void 0:n.collection,minimumRole:"reader"}]:[]},typecheck:(e,t)=>{const n=t.getConfig();if(null==n||!n.collection)return{value:{valueTypes:[]}};const o=(0,N.Kd)({source:"action",action_id:t.id,action_output_type:"pages"}),i=e.automationModel.getActionIds().indexOf(t.id)??-1;return{value:{valueTypes:[{kind:u.yp.ContextValue,id:o,name:e.intl.formatMessage(Y.queryCollectionPages,{stepNumber:i+1}),type:{type:"array",of:{type:"block",collection:n.collection}}}]}}},execute:async(e,t)=>{const n=t.getConfig();if(null==n||!n.collection)return{value:{values:[]}};if(null==n||!n.collection.spaceId)return{error:new v.mK({pointer:null==n?void 0:n.collection,actionId:t.id})};const o={table:C.vF,id:null==n?void 0:n.collection.id,spaceId:null==n?void 0:n.collection.spaceId},i=await e.executeEffectMap.queryCollection({actionId:t.id,collection:o,userTimeZone:e.userTimeZone,filter:null==n?void 0:n.filter,sort:null==n?void 0:n.sort,limit:null==n?void 0:n.limit});if(i.error)return i;const r=(0,N.Kd)({source:"action",action_id:t.id,action_output_type:"pages"});return{value:{values:[{kind:u.yp.ContextValue,id:r,value:{type:"array",values:i.value.blockIds.map((e=>({type:"block",value:{table:I.iU,id:e,spaceId:o.spaceId}})))}}]}}},acceptFormulaVisitor:e=>[]};var X=n(99036),ee=n(90792),te=n(19889);const ne=(0,i.defineMessages)({sendInAppNotification:{id:"automations.actions.sendInAppNotification",defaultMessage:"Send notification to..."},createPageDefaultVariableName:{id:"automations.actions.createPageDefaultVariableName",defaultMessage:"New page added"},createPageVariableNameWithDatabase:{id:"automations.actions.createPageVariableNameWithDatabase",defaultMessage:"New page added in {databaseName}"},createPageVariableNameWithDatabaseAndStepNumber:{id:"automations.actions.createPageVariableNameWithDatabaseAndStepNumber",defaultMessage:"New page added in {databaseName} from step {stepNumber}"},sendInAppNotificationDescription:{id:"automations.actions.sendInAppNotificationDescription",defaultMessage:"Sends a notification to one or more people in Notion."}}),oe={type:"send_in_app_notification",display:{icon:ee.t,name:ne.sendInAppNotification,description:ne.sendInAppNotificationDescription,hasSideEffects:!0},isAvailableForContext:async e=>{const t=e.checkExperimentGate("automation_action_notification"),n=e.automationActions.filter((e=>e.isType("send_in_app_notification"))),o="canAddAction"===e.checkType?n.length<1:n.length<=1;return Promise.resolve("event"===e.contextType&&o&&t)},getExecutionDependencies:(e,t)=>[],typecheck:(e,t)=>{var n;const o=t.getConfig(),i=null==o?void 0:o.target;if(!o||!i)return{value:{validationFailures:[{type:"missing_required_config",actionType:"send_in_app_notification",key:"target"}]}};if("property"===i.type){if(!i.propertyId)return{value:{validationFailures:[{type:"missing_required_config",actionType:"send_in_app_notification",key:"propertyId"}]}};if(!i.collectionPointer)return{value:{validationFailures:[{type:"missing_required_config",actionType:"send_in_app_notification",key:"collectionPointer"}]}}}else if("formula"===i.type&&!i.value)return{value:{validationFailures:[{type:"missing_required_config",actionType:"send_in_app_notification",key:"formulaValue"}]}};return o.notification_message&&null!==(n=o.notification_message)&&void 0!==n&&n.value&&0!==(0,h.Vkf)(o.notification_message.value)?{value:{valueTypes:[]}}:{value:{validationFailures:[{type:"missing_required_config",actionType:"send_in_app_notification",key:"notification_message"}]}}},execute:async(e,t)=>{var n,o;const i=null===(n=t.getConfig())||void 0===n?void 0:n.target,r=null===(o=t.getConfig())||void 0===o?void 0:o.notification_message;if(!i||!r)return{error:new v.Qq({actionId:t.id})};const a=e=>({error:new v.mz({actionId:t.id,propertyId:e})}),s=new Set,c=e.blockPointer;if(!c)return{error:new v.L({actionId:t.id,contextValueId:"blockPointer"})};const d=c.id,u=i.type;switch(u){case"formula":if(!i.value)return{error:new v.Qq({actionId:t.id})};const n=await(0,z.OH)({value:i.value,context:{...e,returnType:{type:"person"}},executeFormula:e.executeContextualFormula});if(l.x.isFail(n))return{error:new v.x6({actionId:t.id,cause:n.error})};const o=(0,N.j4)(n.value);(0,h.lcG)(o).forEach((e=>s.add(e)));break;case"property":const r=i.propertyId,c=i.collectionPointer;if(!r||!c)return{error:new v.Qq({actionId:t.id})};const p=await e.loadRecordModel(c),m=await e.loadRecordModel({table:I.iU,id:d,spaceId:t.pointer.spaceId});if(!m)return a(r);if(p){const e=p.getNormalizedSchema()[r];if(!e||!(0,X.KR)(e)&&!(0,X.M0)(e)&&!(0,X.To)(e))return a(r);const t="created_by"===e.type,n="last_edited_by"===e.type;if(t){const e=m.getCreatedByPointer();e&&e.table===te.KJ&&s.add(e.id)}else if(n){const e=m.getLastEditedByPointer();e&&e.table===te.KJ&&s.add(e.id)}else{const e=null==m?void 0:m.getProperties();if(e){const t=e[r],n=(0,h.lcG)(t);n.length>0&&n.map((e=>{s.add(e)}))}}}break;default:(0,Z.t1)(u)}return 0!==s.size&&await e.executeEffectMap.sendInAppNotification({targets:s,message:r,actionId:t.id,spaceId:t.pointer.spaceId}),{value:{values:[]}}},acceptFormulaVisitor:e=>[]};var ie=n(24600),re=n(77420);const ae=(0,i.defineMessages)({slackNotification:{defaultMessage:"Send Slack notification toâ€¦",id:"automations.actions.slackNotification"},slackNotificationDescription:{defaultMessage:"Sends a Slack notification to a user or channel.",id:"automations.actions.slackNotificationDescription"}}),se={type:"slack_notification",display:{icon:ie.P,name:ae.slackNotification,description:ae.slackNotificationDescription,hasSideEffects:!1},isAvailableForContext:async e=>{const t=e.automationActions.filter((e=>e.isType("slack_notification"))),n="canAddAction"===e.checkType?t.length<1:t.length<=1;return Promise.resolve("event"===e.contextType&&n)},getExecutionDependencies:(e,t)=>{const n=t.getConfig();return null!=n&&n.external_bot_id?[{minimumRole:"editor",pointer:{id:n.external_bot_id,table:re.cZ},type:"record_permission"}]:[]},typecheck:(e,t)=>{const n=t.getConfig();if(null==n||!n.external_bot_id)return{value:{validationFailures:[{type:"missing_required_config",actionType:"slack_notification",key:"external_bot_id"}]}};return e.getRecordModel({id:n.external_bot_id,table:re.cZ})?n.target?{value:{valueTypes:[]}}:{value:{validationFailures:[{type:"missing_required_config",actionType:"slack_notification",key:"target"}]}}:{value:{validationFailures:[{type:"missing_required_value",actionType:"slack_notification",key:"external_bot_id"}]}}},execute:(e,t)=>({value:{values:[]}}),acceptFormulaVisitor:e=>[]};var le=n(38297),ce=n(25651);const de=(0,i.defineMessages)({updatePages:{id:"automations.actions.updatePages",defaultMessage:"Edit pages inâ€¦"},updatePagesDescription:{id:"automations.actions.updatePagesDescription",defaultMessage:"Edits the properties of specified pages in a database."}}),ue=new Set(["button","event"]);async function pe(e){const{pointer:t,context:n,actionId:o}=e,i=await n.loadRecordModel(t);if(!i)return{error:new v.Do({pointer:t,actionId:o})};const r=await(0,le.Rd)({block:i,loadRecordModel:n.loadRecordModel});return r?{value:r.getSpaceShardedPointer()}:{error:new v.Do({pointer:t,actionId:o})}}const me={type:"update_pages",display:{icon:ce.R,name:de.updatePages,description:de.updatePagesDescription,hasSideEffects:!0},isAvailableForContext:async e=>{let t=e.automation.getTriggerType();if("notification_event"===t&&(t="event"),"event"===t){if(!(await e.checkSubscribed()))return!1;const t=e.automationActions.filter((e=>{var t;return e.isType("update_pages")&&"collection"===(null===(t=e.getConfig())||void 0===t||null===(t=t.target)||void 0===t?void 0:t.type)}));return"canAddAction"===e.checkType?t.length<5:t.length<=5}return ue.has(t)},getExecutionDependencies:(e,t)=>{var n,o;const i=t.getConfig();return"collection"===(null==i||null===(n=i.target)||void 0===n?void 0:n.type)?[{type:"record_permission",pointer:null==i?void 0:i.target.collection,minimumRole:"content_only_editor"}]:"variable"===(null==i||null===(o=i.target)||void 0===o?void 0:o.type)?[{id:i.target.id,minimumRole:"read_and_write",type:"formula_value_permission"}]:[]},typecheck:(e,t)=>{const n=t.getConfig();return null!=n&&n.target?{value:{valueTypes:[]}}:{value:{validationFailures:[{type:"missing_required_config",actionType:"update_pages",key:"target"}]}}},execute:async(e,t)=>{const n=t.getConfig();if(null==n||!n.target)return{error:new v.mK({pointer:null==n?void 0:n.target,actionId:t.id})};let o,i,r,a=e.loadRecordModel;if("collection"===(null==n?void 0:n.target.type)){const s=await a(n.target.collection);if(!s)return{error:new v.Do({pointer:n.target.collection,actionId:t.id})};const c=await e.executeEffectMap.queryCollection({actionId:t.id,collection:n.target.collection,userTimeZone:e.userTimeZone,filter:n.target.filter,limit:n.target.limit,sort:n.target.sort});if(l.x.isFail(c))return c;r=c.value.blockIds,o=s.getNormalizedSchema(),i=n.target.collection,c.value.recordMap&&(a=S.s8.tryUntilFound(a,S.s8.fromRecordMapWithRole(c.value.recordMap)))}else if("variable"===n.target.type){const s=(0,N.dh)(e.values,n.target.id);if(!s)return{error:new v.L({actionId:t.id,contextValueId:n.target.id})};if("block"===s.value.type){let n=await pe({pointer:s.value.value,context:e,actionId:t.id});if(l.x.isFail(n)){const t=function(e){var t;const{actionModels:n,contextValue:o}=e,i=(0,N.MY)(o.id);if("action"!==i.source)return{error:new v.Hb({source:"global",variable:o.value})};const r=n.find((e=>e.id===i.action_id));if(!r||"create_page"!==r.getType())return{error:new v.Hb({actionId:i.action_id,source:"action",variable:o.value})};const a=null===(t=r.getConfig())||void 0===t?void 0:t.collection;return a?{value:a}:{error:new v.Hb({actionId:i.action_id,source:"action",variable:o.value})}}({actionModels:e.actionModels,contextValue:s});if(l.x.isFail(t))return n;n=t}r=[s.value.value.id],i=n.value;const a=await e.executeEffectMap.getCollectionSchema({actionId:t.id,pointer:i});if(l.x.isFail(a))return a;o=a.value.collectionSchema}else{if("array"!==s.value.type)return{error:new v.Hb({actionId:t.id,source:"action",variable:s.value})};{const n=s.value.values[0];if(!n||"block"!==n.type)return{error:new v.Hb({actionId:t.id,source:"action",variable:n})};const c=await a(n.value),d=c?await(0,le.Rd)({block:c,loadRecordModel:a}):void 0;if(!d)return{error:new v.Do({pointer:n.value,actionId:t.id})};const u=d.getSpaceShardedPointer();r=b.oA(s.value.values.map((e=>"block"===e.type?e.value.id:void 0)));const p=await e.executeEffectMap.getCollectionSchema({actionId:t.id,pointer:u});if(l.x.isFail(p))return p;o=p.value.collectionSchema,i=u}}}else if("page"===n.target.type){const a=n.target.page,s=await pe({pointer:a,context:e,actionId:t.id});if(l.x.isFail(s))return s;r=[a.id],i=s.value;const c=await e.executeEffectMap.getCollectionSchema({actionId:t.id,pointer:i});if(l.x.isFail(c))return c;o=c.value.collectionSchema}else(0,Z.t1)(n.target);const s=[];for(const c of r){const r=await a({table:I.iU,id:c,spaceId:i.spaceId});let d;if(o){const a=null==r?void 0:r.getProperties(),s=await(0,j.g9)({config:n,collectionPointer:i,collectionSchema:o,actionId:t.id,context:e,getCurrentPropertyValue:e=>null==a?void 0:a[e]});if(l.x.isFail(s))return s;d=s.value}else d={};s.push({pointer:{table:I.iU,id:c,spaceId:i.spaceId},command:"update",path:["properties"],args:d}),e.author&&s.push(w.op.update({pointer:{table:I.iU,id:c,spaceId:i.spaceId},path:[],args:{last_edited_time:Date.now(),last_edited_by_table:e.author.table,last_edited_by_id:e.author.id}}))}if(s.length>0){const a=(n.properties??[]).map((e=>{var t;const n=null===(t=o)||void 0===t?void 0:t[e];if(n)return{id:e,type:n.type}})).filter(Z.$K),c=await e.executeEffectMap.saveTransaction({actionId:t.id,info:{type:"update_pages",pageIds:r,collection:i,editedProperties:a},operations:s});if(l.x.isFail(c))return c}return{value:{values:[]}}},acceptFormulaVisitor:e=>{var t;const{action:n,visitor:o}=e,i=n.getConfig();if(!i)return[];const r=[];if("variable"===(null==i||null===(t=i.target)||void 0===t?void 0:t.type)){const e=(0,j.AQ)({pointer:n.pointer,target:i.target,visitor:o});r.push(...e)}return r.push(...(0,j.vp)({pointer:n.pointer,config:i,visitor:o})),r}},fe={query_collection:J,create_page:O.L,update_pages:me,open_page:$,slack_notification:se,duplicate_blocks:L,modal_confirmation:H,complete_sprint:F,assistant:s,send_in_app_notification:oe};function ge(e){return fe[e]}function he(e){return(0,o.FP)(e).map((e=>ge(e)))}},2647:(e,t,n)=>{n.d(t,{A2:()=>y,Bj:()=>I,By:()=>u,Cz:()=>d,Ey:()=>b,OK:()=>_,Rt:()=>g,T0:()=>p,TY:()=>C,W5:()=>c,ai:()=>h,co:()=>a,d:()=>w,eI:()=>r,lN:()=>l,nC:()=>S,nK:()=>v,qu:()=>k,r4:()=>m,rg:()=>i,uO:()=>f,yK:()=>s});n(57658);var o=n(1898);function i(e,t){e.trackEvent({eventName:"automation_triggered",properties:t})}function r(e,t){e.trackEvent({eventName:"add_automation_step",properties:t})}function a(e,t){e.trackEvent({eventName:"delete_automation_step",properties:t})}function s(e,t){e.trackEvent({eventName:"click_configure_button",properties:t})}function l(e,t){e.trackEvent({eventName:"click_configure_button_done",properties:t})}function c(e,t){e.trackEvent({eventName:"click_automation_modal_option",properties:t})}function d(e,t){e.trackEvent({eventName:"automation_execution_success",properties:t})}function u(e,t){e.trackEvent({eventName:"automation_execution_fail",properties:t})}function p(e,t){e.trackEvent({eventName:"automation_create",properties:t})}function m(e,t){e.trackEvent({eventName:"automation_update",properties:t})}function f(e,t){e.trackEvent({eventName:"automation_delete",properties:t})}function g(e,t){e.trackEvent({eventName:"automation_enable",properties:t})}function h(e,t){e.trackEvent({eventName:"automation_disable",properties:t})}function v(e,t){e.trackEvent({eventName:"automation_trigger_create",properties:t})}function b(e,t){e.trackEvent({eventName:"automation_trigger_delete",properties:t})}function y(e,t){e.trackEvent({eventName:"automation_action_create",properties:t})}function _(e,t){e.trackEvent({eventName:"automation_action_delete",properties:t})}function S(e,t){e.trackEvent({eventName:"automation_configure_view",properties:t})}function w(e,t){e.trackEvent({eventName:"automation_configure_view",properties:t})}function k(e,t){e.trackEvent({eventName:"automation_learn_click",properties:t})}function I(e){const{automationActionModel:t,getRecordModel:n}=e;if(t.isType("assistant"))return{type:"assistant"};if(t.isType("complete_sprint"))return{type:"complete_sprint"};if(t.isType("create_page")){const e=t.getConfig();let i=[];const r=null==e?void 0:e.collection,a=null==e?void 0:e.properties;if((0,o.$K)(r)&&(0,o.$K)(a)&&a.length>0){const e=n(r),t=null==e?void 0:e.getNormalizedSchema();(0,o.$K)(t)&&(i=a.map((e=>{var n;return null===(n=t[e])||void 0===n?void 0:n.type})).filter(o.$K))}return{property_types:i,type:"create_page"}}if(t.isType("duplicate_blocks"))return{type:"duplicate_blocks"};if(t.isType("modal_confirmation"))return{type:"modal_confirmation"};if(t.isType("open_page"))return{type:"open_page"};if(t.isType("query_collection"))return{type:"query_collection"};if(t.isType("send_in_app_notification"))return{type:"send_in_app_notification"};if(t.isType("slack_notification"))return{type:"slack_notification"};if(t.isType("update_pages")){const e=t.getConfig();let i=[];if((0,o.$K)(e)&&(0,o.$K)(e.target)&&"collection"===e.target.type&&(0,o.$K)(e.properties)&&e.properties.length>0){const t=n(e.target.collection),r=null==t?void 0:t.getNormalizedSchema();(0,o.$K)(r)&&(i=e.properties.map((e=>{var t;return null===(t=r[e])||void 0===t?void 0:t.type})).filter(o.$K))}return{property_types:i,type:"update_pages"}}(0,o.t1)(t)}function C(e){const{automationModel:t,getRecordModel:n}=e,i=[];for(const l of t.getActionPointers()){const e=n(l);(0,o.$K)(e)&&i.push(I({automationActionModel:e,getRecordModel:n}))}const r=[];let a,s;if(t.isEventType()||t.isNotificationType()){const e=t.getEventConfiguration(),i=n(t.getParentPointer());a=t.getParentId();const l=null==i?void 0:i.getNormalizedSchema();if((0,o.$K)(l)){const{pagesAdded:t,pagePropertiesEdited:n}=e;t&&r.push({type:"page"}),"any"===n.type?r.push({condition:"any",type:"property"}):"none"===n.type?r.push({condition:"none",type:"property"}):r.push({condition:"some",property_types:n.some.map((e=>{var t;return null===(t=l[e.property])||void 0===t?void 0:t.type})).filter(o.$K),type:"property"})}const c=e.source;(0,o.$K)(c)&&"collection_view"===c.type&&(s=c.pointer.id)}return{automation_actions:i,automation_id:t.id,automation_triggers:r,collection_id:a,collection_view_id:s}}},81730:(e,t,n)=>{n.d(t,{Do:()=>a,Hb:()=>s,L:()=>p,MO:()=>o,Ox:()=>c,Pn:()=>l,Qq:()=>f,fH:()=>i,iR:()=>d,mK:()=>r,mz:()=>g,nQ:()=>m,x6:()=>u});n(21703);class o extends Error{}class i extends Error{constructor(e,t){super(t),this.type=e}}class r extends i{constructor(e){super("invalid_record_pointer","Invalid record pointer"),this.data=e}}class a extends i{constructor(e){super("invalid_record","Invalid record"),this.data=e}}class s extends i{constructor(e){super("invalid_variable_type","Invalid variable type"),this.data=e}}class l extends i{constructor(e){super(e.type,e.message),this.data=e}}class c extends i{constructor(e){super("invalid_property_schema","Invalid property schema"),this.data=e}}class d extends i{constructor(e){super("unsupported_context","Unsupported context"),this.data=e}}class u extends i{constructor(e){super("formula_execution_failed","Formula execution failed"),this.data=e}}class p extends i{constructor(e){super("missing_context_value","Missing context value"),this.data=e}}class m extends i{constructor(){super("user_cancelled","User cancelled")}}class f extends i{constructor(e){super("missing_action_config","Missing automation action config"),this.data=e}}class g extends i{constructor(e){super("notification_unresolvable_target_error","One or more of the send-in-app-notification targets could not be resolved to a user ID."),this.data=e}}Error},7445:(e,t,n)=>{n.d(t,{Ps:()=>s,TD:()=>l});n(57658);var o=n(53965),i=n(1898),r=n(3865),a=n(77492);function*s(e){const{permissions:t,typecheckContextValues:n}=e,s=[];for(const l of t)if("record_permission"===l.type)s.push((0,o.Xh)(l));else if("collection_default_template_record_permission"===l.type){const e=yield*a.R.fetchRecord(l.pointer),t=null==e?void 0:e.getDefaultTemplatePagePointer();(0,i.$K)(t)&&s.push({minimumRole:l.minimumRole,pointer:t,type:"record_permission"})}else if("formula_value_permission"===l.type){const e=(0,r.rX)({formulaValueTypes:n,minimumRole:l.minimumRole,targetId:l.id});e.length>0&&s.push(...e)}else(0,i.t1)(l);return s}const{sync:l,async:c}=a.R.makeRunners(s)},10450:(e,t,n)=>{n.d(t,{E$:()=>w,J0:()=>p,NG:()=>C,Px:()=>f,R4:()=>v,W7:()=>I,ZF:()=>k,dG:()=>b,io:()=>S,rb:()=>_,zW:()=>y});var o=n(9291),i=n(53965),r=n(53877),a=n(73110),s=n(35102),l=n(19889),c=n(70203),d=n(23290);const u=(0,o.defineMessages)({buttonPage:{id:"automations.triggers.button.page.label",defaultMessage:"This page"},currentUser:{id:"automations.triggers.currentUser.label",defaultMessage:"Person who clicked button"},now:{id:"automations.triggers.now.label",defaultMessage:"Now"},today:{id:"automations.triggers.today.label",defaultMessage:"Today"},triggerPageCreator:{id:"automations.triggers.pageCreator.label",defaultMessage:"Person who created this page"}});function p(){return(0,s.Kd)({source:"global",global:"button_page"})}function m(){return(0,s.Kd)({source:"global",global:"current_user"})}function f(){return(0,s.Kd)({source:"global",global:"page_creator"})}function g(){return(0,s.Kd)({source:"global",global:"now"})}function h(){return(0,s.Kd)({source:"global",global:"today"})}function v(e){const{blockPointer:t,currentUserId:n,createdById:o}=e,s=p(),c=m(),d=g(),u=h(),v=f();return{values:i.oA([{kind:a.yp.ContextValue,id:s,value:{type:"block",value:t}},n?{kind:a.yp.ContextValue,id:c,value:{type:"person",value:{table:l.KJ,id:n}}}:void 0,{kind:a.yp.ContextValue,id:d,value:{type:"date",value:(0,r.CQ)(Date.now(),e.userTimeZone)}},{kind:a.yp.ContextValue,id:u,value:{type:"date",value:(0,r.hT)(Date.now(),e.userTimeZone)}},o?{kind:a.yp.ContextValue,id:v,value:{type:"person",value:{table:l.KJ,id:o}}}:void 0])}}function b(e){const{blockPointer:t,currentUserId:n}=e,o=p(),s=m(),c=g(),d=h();return{values:i.oA([{kind:a.yp.ContextValue,id:o,value:{type:"block",value:t}},n?{kind:a.yp.ContextValue,id:s,value:{type:"person",value:{table:l.KJ,id:n}}}:void 0,{kind:a.yp.ContextValue,id:c,value:{type:"date",value:(0,r.CQ)(Date.now(),e.userTimeZone)}},{kind:a.yp.ContextValue,id:d,value:{type:"date",value:(0,r.hT)(Date.now(),e.userTimeZone)}}])}}function y(e){const{collectionPointer:t}=e,n=p(),o=m(),i=g(),r=h();return{valueTypes:[{kind:a.yp.ContextValue,id:n,name:e.intl.formatMessage(u.buttonPage),type:{type:"block",collection:t}},{kind:a.yp.ContextValue,id:o,name:e.intl.formatMessage(u.currentUser),type:{type:"person"}},{kind:a.yp.ContextValue,id:i,name:e.intl.formatMessage(u.now),type:{type:"date"}},{kind:a.yp.ContextValue,id:r,name:e.intl.formatMessage(u.today),type:{type:"date"}}]}}function _(e){const t=m(),n=g(),o=h(),r=p(),s={kind:a.yp.ContextValue,id:t,name:e.intl.formatMessage(u.currentUser),type:{type:"person"}},l={kind:a.yp.ContextValue,id:n,name:e.intl.formatMessage(u.now),type:{type:"date"}},c={kind:a.yp.ContextValue,id:o,name:e.intl.formatMessage(u.today),type:{type:"date"}},d=e.collectionPointer?{kind:a.yp.ContextValue,id:r,name:e.intl.formatMessage(u.buttonPage),type:{type:"block",collection:e.collectionPointer}}:void 0;return{valueTypes:i.oA([s,l,c,d])}}function S(e){const{currentUserId:t,pagePointer:n}=e,o=m(),s=g(),c=h(),d=p();return{values:i.oA([t?{kind:a.yp.ContextValue,id:o,value:{type:"person",value:{table:l.KJ,id:t}}}:void 0,{kind:a.yp.ContextValue,id:s,value:{type:"date",value:(0,r.CQ)(Date.now(),e.userTimeZone)}},{kind:a.yp.ContextValue,id:c,value:{type:"date",value:(0,r.hT)(Date.now(),e.userTimeZone)}},{kind:a.yp.ContextValue,id:d,value:{type:"block",value:n}}])}}function w(e){const t=g(),n=h(),o=p(),i=f(),r={kind:a.yp.ContextValue,id:o,name:e.intl.formatMessage(u.buttonPage),type:{type:"block",collection:e.collectionPointer}};return{valueTypes:[{kind:a.yp.ContextValue,id:t,name:e.intl.formatMessage(u.now),type:{type:"date"}},{kind:a.yp.ContextValue,id:n,name:e.intl.formatMessage(u.today),type:{type:"date"}},r,{kind:a.yp.ContextValue,id:i,name:e.intl.formatMessage(u.triggerPageCreator),type:{type:"person"}}]}}function k(){return{valueTypes:[]}}function I(){return{values:[]}}function C(e){const{nextSprintDateRange:t,completeSprintActionType:n}=e;return{values:[{kind:a.yp.ContextValue,id:d.Pv,value:{type:"date",value:t}},{kind:a.yp.ContextValue,id:d.JL,value:{type:"text",value:(0,c.TPx)(n)}}]}}},86433:(e,t,n)=>{n.d(t,{rS:()=>p});n(57658);var o=n(53965),i=n(40470),r=n(1898),a=n(77492),s=n(35102),l=n(42875),c=n(59786),d=n(7445),u=n(10450);const{sync:p,async:m}=a.R.makeRunners((function*(e){let t=[];return"button_property"===e.contextType?t=(0,u.zW)({collectionPointer:e.collectionPointer,intl:e.intl}).valueTypes??[]:"button_block"===e.contextType?t=(0,u.rb)({collectionPointer:e.collectionPointer,intl:e.intl}).valueTypes??[]:"event"===e.contextType?t=(0,u.E$)({collectionPointer:e.collectionPointer,intl:e.intl}).valueTypes??[]:"recurrence"===e.contextType?t=(0,u.ZF)().valueTypes??[]:"assistant"===e.contextType?t=[]:(0,r.t1)(e),yield*f({automationModel:e.automationModel,actionModels:e.actionModels,handleDataRequest:(0,s.yf)(e.getRecordModel,e.loadRecordModel),intl:e.intl,getRecordModel:e.getRecordModel,userTimeZone:e.userTimeZone||(0,l.r)(),valueTypes:t})}));function*f(e){const{actionModels:t,automationModel:n}=e,r={valueTypes:e.valueTypes,actionInputValueTypes:{},actionValidationFailures:{}};for(const l of t){const t=(0,c.z)(l.getType()),u=t.getExecutionDependencies({automationModel:n},l),p=yield*(0,d.Ps)({permissions:u,typecheckContextValues:r.valueTypes});yield*a.R.fetchRecords(p.map((e=>e.pointer)));const m=t.typecheck(e,l),f=o.d9(r.valueTypes);if(r.actionInputValueTypes[l.id]=f,i.x.isFail(m))return m;for(const e of m.value.valueTypes??[]){r.valueTypes.some((t=>(0,s.Fl)(e,t)))||r.valueTypes.push(e)}m.value.validationFailures&&(r.actionValidationFailures[l.id]=m.value.validationFailures)}return{value:r}}const{sync:g,async:h}=a.R.makeRunners(f)},23290:(e,t,n)=>{n.d(t,{E2:()=>c,FP:()=>s,JL:()=>r,Pv:()=>i,Xp:()=>m,lK:()=>l,o9:()=>u,ss:()=>p});var o=n(35102);const i=(0,o.Qc)("COMPLETE_SPRINT_NEXT_SPRINT_DATE_RANGE"),r=(0,o.Qc)("COMPLETE_SPRINT_ACTION_TYPE"),a={duplicate_blocks:{display:!0},create_page:{display:!0},modal_confirmation:{display:!0},open_page:{display:!0},query_collection:{display:!0},slack_notification:{display:!0},update_pages:{display:!0},assistant:{display:!0},send_in_app_notification:{display:!0},complete_sprint:{display:!1}};function s(e){return Object.entries(a).filter((t=>{let[n,o]=t;return o[e]})).map((e=>{let[t]=e;return t}))}function l(e,t){return a[e][t]}const c=["replace","append","remove","toggle"],d="replace";function u(e){return(null==e?void 0:e.action)||d}const p=50;function m(e){return l(e.type,"display")}},36576:(e,t,n)=>{n.d(t,{sU:()=>I,xU:()=>y});n(57658);var o=n(53965),i=n(26249),r=n(1898),a=n(41432),s=n(99036),l=n(14215),c=n(38297),d=n(59753),u=n(63306),p=n(87479),m=n(606),f=n(21202),g=n(70279),h=n(33709),v=n(23867),b=n(70203);async function y(e){const{loadRecordValue:t,operationPointers:n,getInitialRecordModel:i,getFinalRecordModel:a}=e,s=[],c=[];return await Promise.all(n.map((async e=>{if((0,m.$O)(e,f.iU)){const n=i.getRecordValue(e),u=a.getRecordValue(e),p=null==u?void 0:u.space_id,m={...e,spaceId:(0,v.C)(p)},g=(0,l.E)(_(n),_(u));if(await Promise.all([...g.deleted.map((async n=>{const o=await async function(e){const t=e.getInitialRecordModel.getRecordValue({table:f.iU,id:e.blockId});if(t&&t.parent_id!==e.parentId)return!0;const n=e.getFinalRecordModel.getRecordValue({table:f.iU,id:e.blockId});if(n&&n.parent_id!==e.parentId)return!0;if(!n){const t=await e.loadRecordValue({table:f.iU,id:e.blockId});if(t&&t.parent_id!==e.parentId)return!0}return!1}({loadRecordValue:t,blockId:n,parentId:e.id,getInitialRecordModel:i,getFinalRecordModel:a});o&&c.push({block_id:n,mentioned_from:{type:"reference",parent_block_id:e.id,parent_pointer:m}})})),...g.created.map((async n=>{const o=await async function(e){const t=e.getFinalRecordModel.getRecordValue({table:f.iU,id:e.blockId});if(t&&t.parent_id!==e.parentId)return!0;if(!t){const t=await e.loadRecordValue({table:f.iU,id:e.blockId});if(t&&t.parent_id!==e.parentId)return!0}return!1}({loadRecordValue:t,blockId:n,parentId:e.id,getFinalRecordModel:a});o&&s.push({block_id:n,mentioned_from:{type:"reference",parent_block_id:e.id,parent_pointer:m}})}))]),n&&u&&n.parent_id!==u.parent_id){if(n.parent_table===f.iU){let o=a.getRecordValue({table:f.iU,id:n.parent_id,spaceId:n.space_id});o||(o=await t({table:f.iU,id:n.parent_id,spaceId:n.space_id})),o&&o.content&&o.content.includes(e.id)&&s.push({block_id:e.id,mentioned_from:{type:"reference",parent_block_id:(0,r.xL)(n.parent_id),parent_pointer:m}})}if(u.parent_table===f.iU){let n=a.getRecordValue({table:f.iU,id:u.parent_id,spaceId:u.space_id});n||(n=await t({table:f.iU,id:u.parent_id})),n&&n.content&&!n.content.includes(e.id)&&s.push({block_id:e.id,mentioned_from:{type:"reference",parent_block_id:(0,r.xL)(u.parent_id),parent_pointer:{id:u.parent_id,table:f.iU,spaceId:u.space_id}}})}}let h;if(n&&(h=d.kk.fromBlock(n).getCollectionPointer()),(!n||!h)&&u){const e=d.kk.fromBlock(u).getCollectionPointer();if(e){let n=a.getRecordValue(e);n||(n=await t(e)),n&&n.parent_id!==u.id&&s.push({block_id:(0,r.xL)(n.parent_id),mentioned_from:{type:"collection_reference",block_id:u.id,pointer:{id:u.id,spaceId:u.space_id,table:f.iU}}})}}const b=(0,l.N)(w(n),w(u),S);for(const{blockId:t,propertyId:o}of b.created)s.push({block_id:t,mentioned_from:{type:"property_mention",block_id:e.id,property_id:o,pointer:m}});for(const{blockId:t,propertyId:o}of b.deleted)c.push({block_id:t,mentioned_from:{type:"property_mention",block_id:e.id,property_id:o,pointer:m}});const y=C(n),k=C(u);y&&!o.Xy(y,k)&&c.push({block_id:y.id,mentioned_from:{type:"alias",pointer:m}}),k&&!o.Xy(y,k)&&s.push({block_id:k.id,mentioned_from:{type:"alias",pointer:m}});const I=x(n),T=x(u);I&&!o.Xy(I,T)&&c.push({block_id:I.id,mentioned_from:{type:"transclusion_reference",pointer:m}}),T&&!o.Xy(I,T)&&s.push({block_id:T.id,mentioned_from:{type:"transclusion_reference",pointer:m}})}else if((0,m.$O)(e,g.x_)){const t=i.getRecordValue(e),n=a.getRecordValue(e),o=null==n?void 0:n.space_id,r={...e,spaceId:(0,v.C)(o)},d=(0,l.E)(k(t),k(n));for(const i of d.created)s.push({block_id:i,mentioned_from:{type:"comment_mention",comment_id:e.id,pointer:r}});for(const i of d.deleted)c.push({block_id:i,mentioned_from:{type:"comment_mention",comment_id:e.id,pointer:r}})}}))),{createdBacklinks:s,deletedBacklinks:c}}function _(e){const t=d.kk.fromValue(f.iU,e);return t?t.getContentIds():[]}function S(e){return`${e.blockId}${e.propertyId}`}function w(e){const t=d.kk.fromValue(f.iU,e),n=[];if(!t)return n;const o=t.getProperties();if(!o)return n;for(const i in o){const e=b.jDe(t.getProperty(i));for(const t of e)n.push({propertyId:i,blockId:t})}return n}function k(e){const t=d.kk.fromValue(g.x_,e);return t&&t.alive?b.jDe(t.getText()):[]}function I(e){const{actor:t,blockId:n,backlinks:l,getRecordModel:m}=e,b=(0,u.DW)({table:f.iU,id:n},m),y=o.Z$(b),_=b[0];if(!y||"block"!==_.table)return[];const S=(0,p.IJ)({actor:t,ancestors:b});return l.filter((e=>{const n=function(e){var t,n,o,i;return"comment_mention"===e.mentioned_from.type?{table:g.x_,id:e.mentioned_from.comment_id,spaceId:(0,v.C)(null===(t=e.mentioned_from.pointer)||void 0===t?void 0:t.spaceId)}:"reference"===e.mentioned_from.type?{table:f.iU,id:e.mentioned_from.parent_block_id,spaceId:(0,v.C)(null===(n=e.mentioned_from.parent_pointer)||void 0===n?void 0:n.spaceId)}:"property_mention"===e.mentioned_from.type?{table:f.iU,id:e.mentioned_from.block_id,spaceId:(0,v.C)(null===(o=e.mentioned_from.pointer)||void 0===o?void 0:o.spaceId)}:"collection_reference"===e.mentioned_from.type?{table:f.iU,id:e.mentioned_from.block_id,spaceId:(0,v.C)(null===(i=e.mentioned_from.pointer)||void 0===i?void 0:i.spaceId)}:"alias"===e.mentioned_from.type||"transclusion_reference"===e.mentioned_from.type?e.mentioned_from.pointer:void(0,r.t1)(e.mentioned_from)}(e),o=(0,u.DW)(n,m);if(!(0,u.Zg)(o))return!1;const l=(0,p.IJ)({actor:t,ancestors:o});if(l){if(!S)return!1;if(!(0,i.Z)(l.from,S.from))return!1}if(o.some((e=>e.table===h.qF&&e.resolved)))return!1;if("property_mention"===e.mentioned_from.type){var b;const t=m({table:f.iU,id:e.mentioned_from.block_id,spaceId:(0,v.C)(null===(b=e.mentioned_from.pointer)||void 0===b?void 0:b.spaceId)});if(!t)return!1;const n=(0,c.ky)({block:t,getRecordModel:m});if(n){const t=d.kk.fromCollection(n);if("title"!==e.mentioned_from.property_id){const o=s.oC(n),i=e.mentioned_from.property_id,r=o[i];if(!r)return!1;if("relation"===r.type){const e=(0,c.ky)({block:_,getRecordModel:m}),n=s.F0(r);if(!e||e.id!==n)return!1;if(s.EY({...t.pointer,propertyId:i,propertySchema:r},e))return!1}else if("title"!==r.type&&"text"!==r.type)return!1}}else if("title"===e.mentioned_from.property_id){if(!(0,a.XD)(t.type))return!1}else{if("caption"!==e.mentioned_from.property_id)return!1;if(!d.kk.fromBlock(t).isType(a.oe))return!1}}const y=(0,u.zN)(o)[0],w=(0,u.uJ)({table:f.iU,id:e.block_id},m)[1];return!y||!w||y.id!==w.id}))}function C(e){const t=d.kk.fromValue(f.iU,e);if(t&&"alias"===t.type)return t.getAliasTargetPointer()}function x(e){const t=d.kk.fromValue(f.iU,e);if(t&&"transclusion_reference"===t.type)return t.getTransclusionReferenceTargetPointer()}},49271:(e,t,n)=>{n.d(t,{N7:()=>r,ZD:()=>a});var o=n(31701),i=n(37810);function r(e){return{color:o.ZP.defaultText,fill:"currentColor",lineHeight:1.5,fontFamily:i.Z.getCompositeFontFamily(e).sans}}const a={paddingTop:3,paddingBottom:3,paddingLeft:2,paddingRight:2}},50475:(e,t,n)=>{n.d(t,{EW:()=>i,R5:()=>r,bv:()=>a,u7:()=>s});var o=n(1898);n(41432);function i(e){switch(e){case"home_main":case"home_trending":case"home_similar_users":case"home_my_tasks":case"home_most_visited":case"home_last_edited":case"home_favorites":return!0;case void 0:return!1;default:(0,o.t1)(e)}}function r(e){const t=null==e?void 0:e.getSystemBlockType();switch(t){case"home_main":case"home_trending":case"home_similar_users":case"home_most_visited":case"home_last_edited":case"home_my_tasks":case"home_favorites":return!0;case void 0:return!1;default:(0,o.t1)(t)}}function a(e){switch(e){case"home_main":case"home_trending":case"home_similar_users":case"home_most_visited":case"home_last_edited":case"home_my_tasks":case"home_favorites":return!0;case void 0:return!1;default:(0,o.t1)(e)}}function s(e){switch(e){case"home_main":case"home_trending":case"home_similar_users":case"home_most_visited":case"home_last_edited":case"home_favorites":return!0;case"home_my_tasks":case void 0:return!1;default:(0,o.t1)(e)}}},7289:(e,t,n)=>{n.d(t,{K0:()=>i,dq:()=>r,kR:()=>l,mk:()=>d,t2:()=>s});var o=n(80951);function i(e){let{collectionSchema:t,axisChartType:n}=e;const o=a({collectionSchema:t});if(!o)return;const i=s({xAxisProperty:o,collectionSchema:t});if(!i)return;return{chartFormat:{},type:n??"column",axisConfig:{dataConfig:{xAxis:{groupBy:i},yAxis:[l({})]}}}}function r(e){let{collectionSchema:t}=e;const n=a({collectionSchema:t});if(!n)return;const o=s({xAxisProperty:n,collectionSchema:t});if(!o)return;return{chartFormat:{},type:"donut",donutConfig:{dataConfig:{groupBy:o,aggregation:l({})}}}}function a(e){let{collectionSchema:t}=e;return Object.keys(t).filter((e=>{const n=(0,o.Qm)({schema:t,property:e});return!!n&&d(n.type)}))[0]}function s(e){let{xAxisProperty:t,collectionSchema:n}=e;const i=(0,o.Qm)({schema:n,property:t});if(i&&d(i.type))return"date"===i.type||"created_time"===i.type||"last_edited_time"===i.type||"last_visited_time"===i.type?{type:i.type,property:t,groupBy:"day",sort:{type:"ascending"}}:"relation"===i.type||"select"===i.type||"multi_select"===i.type?{type:i.type,property:t,sort:{type:"ascending"}}:"status"===i.type?{type:i.type,property:t,groupBy:"group",sort:{type:"ascending"}}:"number"===i.type?{type:i.type,property:t,groupBy:{type:"unique"},start:-1,end:-1,size:-1,sort:{type:"ascending"}}:"person"===i.type?{type:i.type,property:t,sort:{type:"manual"}}:void 0}function l(e){let{displayType:t}=e;return{type:"record_count",seriesFormat:{displayType:t??"column"},stackOptions:void 0}}const c=["date","created_time","last_edited_time","last_visited_time","relation","status","select","multi_select","number","person"];function d(e){return c.includes(e)}},14248:(e,t,n)=>{n.d(t,{Ko:()=>M,ND:()=>E,RA:()=>C,WL:()=>D,Xq:()=>U,hz:()=>L,r9:()=>z,wg:()=>j,zk:()=>x});n(57658);var o=n(53965),i=n(7032),r=n(1898),a=n(76205),s=n(30823),l=n(14714),c=n(99036),d=n(80951),u=n(10070),p=n(40506),m=n(53877),f=n(76725),g=n(59753),h=n(77337),v=n(74446),b=n(606),y=n(21202),_=n(19889),S=n(70203);function w(e){const t=[],n=[];for(const[o,i]of Object.entries(e))i&&((0,c.S4)(o)||("person"===i.type?t.push(o):"date"===i.type&&n.push(o)));return{date:n,person:t}}const k=S.V3y(", ");function I(e,t){const n={command:"update",args:t,pointer:{table:y.iU,id:e.id},path:["properties"]};return g.kk.fromValue(e.table,(0,h.lK)(n,e.__IM_SORRY__getValue()))}function C(e){const{block:t,schema:n,propertyMapping:i,filter:r,userFilterContext:s,groupsPointer:l,relativeVariableResult:c,getRecordModel:d,intl:u,resultCache:p}=e,{userId:m,userTimeZone:f,userStartOfWeek:h}=s;let b=t;const _=g.om.tryUntilFound(g.om.fromMonomorphicFunctionUnsafe((e=>{let{table:t,id:n}=e;if(t===y.iU&&n===b.id)return b}),v.mF.fromMonomorphicFunctionUnsafe((e=>{let{table:t,id:n}=e;if(t===y.iU&&n===b.id)return b.__IM_SORRY__getValue()}))),d),S={};for(const o of l)Object.assign(S,B({block:b,getRecordModel:_,schema:n,propertyMapping:i,group:o,intl:u,userFilterContext:s,relativeVariableResult:c,resultCache:p})),b=I(t,S);if(r){const e=Z({block:b,schema:n,filter:r,propertyMapping:i,userFilterContext:s,relativeVariableResult:c,getRecordModel:d,intl:u,resultCache:p}),o="failsFilter"===e.type||"coercedByFilter"===e.type?e.update??{}:{};Object.assign(S,o),b=I(t,S)}for(const o of l)Object.assign(S,B({block:b,getRecordModel:_,schema:n,propertyMapping:i,group:o,intl:u,userFilterContext:s,relativeVariableResult:c,resultCache:p})),b=I(t,S);const w=I(b,S),k=o.yW(l.map((e=>{const t=x({group:e,propertyMapping:i,schema:n,timeZone:f}),o=t?(0,a.q)({context:{schema:n,userId:m,userTimeZone:f,userStartOfWeek:h,relativeVariableResult:c,intl:u},propertyMapping:i,filter:t}):void 0;return Boolean(o&&o({block:w,getRecordModel:d,propertyMapping:i,resultCache:p}))}))),C=r?(0,a.q)({filter:r,propertyMapping:i,context:{schema:n,userId:m,userTimeZone:f,userStartOfWeek:h,relativeVariableResult:c,intl:u}}):void 0,T=!C||C({block:w,getRecordModel:d,propertyMapping:i,resultCache:p});return{coercionSucceeded:k&&T,update:S}}function x(e){const t=M(e);return t?(0,a.vA)(t)?t:{operator:"and",filters:[t]}:void 0}function T(e,t){var n;return t?(null===(n=u.aQ.fromViewPropertyIds([e.property],t))||void 0===n?void 0:n[0])??e.property:e.property}function M(e){const{schema:t,group:n,propertyMapping:o,timeZone:i}=e,a=T(n,o),s=t[a];if(!s)return;const c=n.value;if((0,l.LG)(s)&&c.type===s.type){if(void 0===c.value)return{property:a,filter:{operator:"is_empty"}};if("select"===s.type)return"string"==typeof c.value?{property:a,filter:{operator:"enum_is",value:{type:"exact",value:c.value}}}:void 0;if("status"===s.type)return void 0!==c.value&&"status"===c.type?{property:a,filter:{operator:"status_is",value:"by_group"===c.value.type?{type:"is_group",value:c.value.group}:{type:"is_option",value:c.value.option}}}:void 0;if((0,l.pd)(s.type))return"object"==typeof c.value&&c.type===s.type?{property:a,filter:{operator:"person_contains",value:{type:"exact",value:c.value}}}:void 0;if("relation"===s.type)return"object"==typeof c.value&&"relation"===c.type?function(e,t){if((0,l.RA)(t.value))return{property:e,filter:{operator:"relation_contains",value:{type:"exact",value:t.value.id}}};if((0,l.t2)(t.value))return{property:e,filter:{operator:"relation_contains",value:{type:"relative",value:{type:"builtin",variable:t.value.value.variable}}}}}(a,c):void 0;if("location"===s.type)return"object"==typeof c.value&&"location"===c.type?{property:a,filter:{operator:"location_is",value:{type:"exact",value:c.value.id}}}:void 0;if("multi_select"===s.type)return"string"==typeof c.value?{property:a,filter:{operator:"enum_contains",value:{type:"exact",value:c.value}}}:void 0;if((0,l.A1)(s.type)){if(c.type!==s.type)return;return P(c.value,a,i)}if((0,l.HB)(s.type)){if(c.type!==s.type)return;return A(c.value,a)}if("number"===s.type){if("number"!==c.type)return;return R(c.value,a)}if("checkbox"===s.type){if("checkbox"!==c.type)return;return{property:a,filter:{operator:"checkbox_is",value:{type:"exact",value:c.value}}}}if("formula"===s.type){if("formula"!==c.type)return;const e=c.value;if(void 0===e.value)return;if((0,l.R7)(e))return A(e.value,a);if("number"===e.type)return R(e.value,a);if("checkbox"===e.type)return{property:a,filter:{operator:"checkbox_is",value:{type:"exact",value:e.value}}};if((0,l.Mc)(e))return P(e.value,a,i);if((0,l.q6)(e))return function(e,t){return{property:e,filter:{operator:"person_contains",value:{type:"exact",value:t.value}}}}(a,e);if((0,l.tL)(e))return(0,l.RA)(e.value)?{property:a,filter:{operator:"relation_contains",value:{type:"exact",value:e.value.id}}}:void 0;(0,r.t1)(e)}(0,r.t1)(s.type)}}function P(e,t,n){const o=(0,l.Hk)(e,n);return{property:t,filter:{operator:"date_is_within",value:{type:"exact",value:m.OQ.toPersistedDateRange(o,n)}}}}function A(e,t){if("alphabet_prefix"===e.type){const n=e.value;return isNaN(parseInt(n))?{operator:"or",filters:[{property:t,filter:{operator:"string_starts_with",value:{type:"exact",value:e.value.toUpperCase()}}},{property:t,filter:{operator:"string_starts_with",value:{type:"exact",value:e.value.toLowerCase()}}}]}:{property:t,filter:{operator:"string_starts_with",value:{type:"exact",value:e.value}}}}return"other"===e.type?{property:t,filter:{operator:"string_has_no_alphabet_prefix"}}:"exact"===e.type?{property:t,filter:{operator:"string_is",value:{type:"exact",value:e.value}}}:void(0,r.t1)(e)}function R(e,t){if("range"===e.type){const{start:n,end:o}=e;return{operator:"and",filters:[{property:t,filter:{operator:"number_greater_than_or_equal_to",value:{type:"exact",value:n}}},{property:t,filter:{operator:"number_less_than",value:{type:"exact",value:o}}}]}}if("out_of_range"===e.type){const{start:n,end:o}=e;return{operator:"or",filters:[{property:t,filter:{operator:"number_less_than",value:{type:"exact",value:n}}},{property:t,filter:{operator:"number_greater_than_or_equal_to",value:{type:"exact",value:o}}}]}}if("unique"===e.type)return{property:t,filter:{operator:"number_equals",value:{type:"exact",value:e.value}}};(0,r.t1)(e)}function D(e,t){const n=e.property,o=null==t?void 0:t[n];if(null!=o&&o.derived_property_record_metadata)return!1;if(o&&d.A0(o))return!1;const i=e.value;return!i.value||("select"===i.type||"multi_select"===i.type||"status"===i.type||"person"===i.type||"checkbox"===i.type||"relation"===i.type||"date"===i.type||"number"===i.type||((0,l.R7)(i)?"exact"===i.value.type:"formula"!==i.type&&"created_by"!==i.type&&"last_edited_by"!==i.type&&"created_time"!==i.type&&"last_edited_time"!==i.type&&"location"!==i.type&&"last_visited_time"!==i.type&&void(0,r.t1)(i.type)))}function E(e){const{schema:t,propertyMapping:n,group:o,block:i,resultCache:a}=e;if(!D(o,t))return{};const s=function(e){const{schema:t,group:n,propertyMapping:o}=e,i=T(n,o),a=t[i];if(!a)return;const s=n.value;return(0,l.LG)(a)&&s.type===a.type&&void 0!==s.value?"person"===a.type?"object"==typeof s.value&&"person"===s.type?{property:i,filter:{operator:"person_does_not_contain",value:{type:"exact",value:s.value}}}:void 0:"relation"===a.type?"relation"===s.type&&(0,l.RA)(s.value)?{property:i,filter:{operator:"relation_does_not_contain",value:{type:"exact",value:s.value.id}}}:"relation"===s.type&&(0,l.t2)(s.value)?{property:i,filter:{operator:"relation_does_not_contain",value:{type:"relative",value:{type:"builtin",variable:s.value.value.variable}}}}:void 0:"location"===a.type?"object"==typeof s.value&&"location"===s.type?{property:i,filter:{operator:"location_is_not",value:{type:"exact",value:s.value.id}}}:void 0:"multi_select"===a.type?"string"==typeof s.value?{property:i,filter:{operator:"enum_does_not_contain",value:{type:"exact",value:s.value}}}:void 0:void("select"!==a.type&&"status"!==a.type&&"checkbox"!==a.type&&"date"!==a.type&&"text"!==a.type&&"title"!==a.type&&"url"!==a.type&&"email"!==a.type&&"phone_number"!==a.type&&"number"!==a.type&&"formula"!==a.type&&"created_by"!==a.type&&"last_edited_by"!==a.type&&"created_time"!==a.type&&"last_edited_time"!==a.type&&"last_visited_time"!==a.type&&(0,r.t1)(a)):void 0}({schema:t,group:o,propertyMapping:n});if(!s)return{};const c=V({...e,property:s.property,filter:s.filter,schema:t,block:i,resultCache:a});return("failsFilter"===c.type||"coercedByFilter"===c.type)&&c.update||{}}function B(e){const{schema:t,propertyMapping:n,group:o,block:i,userFilterContext:r}=e,{userTimeZone:s}=r;if(!D(o,t))return{};const l=M({schema:t,group:o,propertyMapping:n,timeZone:s});if(!l||!(0,a.aN)(l))return{};const c=V({...e,property:l.property,filter:l.filter,schema:t,block:i});return("failsFilter"===c.type||"coercedByFilter"===c.type)&&c.update||{}}function F(e){const{dateValue:t,timestamp:n,userTimeZone:o}=e;if("date"===t.type)return{...m.hT(n,o),reminder:t.reminder};if("datetime"===t.type)return{...m.CQ(n,o),reminder:t.reminder};if("daterange"===t.type){const e=m.DF(p.Nh(t),o).valueOf(),i=m.DF(p.v3(t),o).valueOf()-e;return{...m.fZ(n,n+i,o),reminder:t.reminder}}if("datetimerange"===t.type){const e=m.Sy(p.C1(t)).valueOf(),i=m.Sy(p.C1(t)).valueOf()-e;return{...m.iC(n,n+i,o),reminder:t.reminder}}(0,r.t1)(t)}const O={text:function(e){const{filter:t,value:n}=e;if("is_empty"===t.operator)return{type:"text",value:void 0};if("is_not_empty"===t.operator)return;if("string_has_no_alphabet_prefix"===t.operator)return;const o=(t.value.value||"").trim();return"string_is_not"===t.operator||"string_does_not_contain"===t.operator?{type:"text",value:void 0}:"string_is"===t.operator?{type:"text",value:o}:"string_contains"===t.operator||"string_ends_with"===t.operator?{type:"text",value:(n.value||"")+o}:"string_starts_with"===t.operator?{type:"text",value:o+(n.value||"")}:void(0,r.t1)(t.operator)},checkbox:function(e){const{filter:t}=e,n=t.value;return"checkbox_is"===t.operator?{type:"checkbox",value:Boolean(n.value)}:"checkbox_is_not"===t.operator?{type:"checkbox",value:!Boolean(n.value)}:void(0,r.t1)(t.operator)},select:function(e){var t;const{filter:n,propertySchema:o}=e;if("is_empty"===n.operator)return{type:"select",value:void 0};if("is_not_empty"===n.operator)return{type:"select",value:o.options&&o.options.length>0?o.options[0].value:void 0};const i=null===(t=(0,a.mg)(n)[0])||void 0===t?void 0:t.value;return void 0!==i?"enum_is"===n.operator?{type:"select",value:i}:"enum_is_not"===n.operator?{type:"select",value:void 0}:void(0,r.t1)(n.operator):void 0},multi_select:function(e){var t;const{filter:n,propertySchema:o,value:i}=e;if("is_empty"===n.operator)return{type:"multi_select",value:void 0};if("is_not_empty"===n.operator)return{type:"multi_select",value:o.options&&o.options.length>0?[o.options[0].value]:void 0};const s=null===(t=(0,a.qC)(n)[0])||void 0===t?void 0:t.value;if(void 0===s)return;const l=i.value||[];return"enum_contains"===n.operator?{type:"multi_select",value:[...l,s]}:"enum_does_not_contain"===n.operator?{type:"multi_select",value:l.filter((e=>e!==s))}:void(0,r.t1)(n.operator)},status:function(e){const{filter:t,propertySchema:n}=e,o=n.groups??[],i=n.options??[];if("is_empty"===t.operator)return{type:"status",option:void 0,group:void 0};if("is_not_empty"===t.operator)return{type:"status",option:n.options&&n.options.length>0?n.options[0].value:void 0,group:n.groups&&n.groups.length>0?n.groups[0].name:void 0};const s=(0,a.wB)(t);if(0===s.length)return;const l=o.map((e=>{const t=i.filter((t=>{var n;return null===(n=e.optionIds)||void 0===n?void 0:n.includes(t.id)}));return{group:e,groupOptions:t}}));if("status_is"===t.operator){const{type:e,value:t}=s[0];if("is_group"===e){var c;const e=o.findIndex((e=>e.name===t)),n=e>=0?l[e]:void 0;return{type:"status",group:null==n?void 0:n.group.name,option:null==n||null===(c=n.groupOptions[0])||void 0===c?void 0:c.value}}if("is_option"===e){const e=i.find((e=>e.value===t)),n=e&&o.find((t=>{var n;return null===(n=t.optionIds)||void 0===n?void 0:n.includes(e.id)}));return{type:"status",group:null==n?void 0:n.name,option:null==e?void 0:e.value}}(0,r.t1)(e)}if("status_is_not"===t.operator)return{type:"status",group:void 0,option:void 0};(0,r.t1)(t.operator)},relation:function(e){var t;const{filter:n,value:o,propertySchema:i,relativeVariableResult:s}=e;if("is_empty"===n.operator)return{type:"relation",value:void 0};if("is_not_empty"===n.operator)return;const l=(0,a.YO)(n),c=null===(t=l[0])||void 0===t?void 0:t.type;let d;var u;if("exact"===c)d=null===(u=l[0])||void 0===u?void 0:u.value;else if("relative"===c){var p,m;const e=null===(p=i.collection_pointer)||void 0===p?void 0:p.id;if(!e||!s)return;d=s[e][null===(m=l[0])||void 0===m?void 0:m.value.variable]}if(void 0===d)return;const f=o.value||[];return"relation_contains"===n.operator?{type:"relation",value:[...f,{id:d,table:y.iU,spaceId:0!==f.length?f[0].spaceId:void 0}]}:"relation_does_not_contain"===n.operator?{type:"relation",value:f.filter((e=>e.id!==d))}:void(0,r.t1)(n.operator)},person:function(e){const{filter:t,userFilterContext:n,value:i}=e,{userId:s}=n;if("is_empty"===t.operator)return{type:"person",value:void 0};if("is_not_empty"===t.operator)return s?{type:"person",value:[{table:_.KJ,id:s}]}:void 0;const l=(0,a.R8)(t)[0];if(!l)return;const c=(0,a.l$)({operatorValue:l,userId:s});if(void 0===c)return;const d=i.value||[];return"person_contains"===t.operator?{type:"person",value:[...d,c]}:"person_does_not_contain"===t.operator?{type:"person",value:d.filter((e=>!o.Xy(e,c)))}:void(0,r.t1)(t.operator)},number:function(e){const{filter:t}=e;if("is_empty"===t.operator)return{type:"number",value:void 0};if("is_not_empty"===t.operator)return{type:"number",value:0};const n=t.value.value;return void 0===n||o.i2(n)?void 0:"number_equals"===t.operator||"number_greater_than_or_equal_to"===t.operator||"number_less_than_or_equal_to"===t.operator?{type:"number",value:n}:"number_less_than"===t.operator?{type:"number",value:n-1}:"number_greater_than"===t.operator?{type:"number",value:n+1}:"number_does_not_equal"===t.operator?{type:"number",value:void 0}:void(0,r.t1)(t.operator)},date:function(e){const{filter:t,userFilterContext:n,value:o}=e,{userTimeZone:i,userStartOfWeek:s}=n;if("is_empty"===t.operator)return{type:"date",value:void 0};if("is_not_empty"===t.operator)return{type:"date",value:m.Lg(i)};const l=o.value;if((0,a.TQ)(t)){const e=(0,a.sw)({operatorValue:t.value,userTimeZone:i,userStartOfWeek:s});if(void 0===l){const t=m.Lg(i),n=m.NK(t,i).start.valueOf();return void 0!==e.start&&void 0!==e.end&&n>=e.start&&n<=e.end?{type:"date",value:t}:void 0!==e.start?{type:"date",value:m.hT(e.start,i)}:void 0!==e.end?{type:"date",value:m.hT(e.end,i)}:void 0}const n=m.NK(l,i).start.valueOf();return void 0!==e.end&&n>e.end?{type:"date",value:F({dateValue:l,timestamp:e.end,userTimeZone:i})}:void 0!==e.start&&n<e.start?{type:"date",value:F({dateValue:l,timestamp:e.start,userTimeZone:i})}:void 0}const c=t.value,d=(0,a.og)({operatorValue:c,userTimeZone:i});if(void 0!==d){if("date_is"===t.operator||"date_is_on_or_before"===t.operator||"date_is_on_or_after"===t.operator)return l?{type:"date",value:F({dateValue:l,timestamp:d,userTimeZone:i})}:{type:"date",value:m.hT(d,i)};if("date_is_before"===t.operator){const e=m.Xz({date:d,daysToAdd:-1});return l?{type:"date",value:F({dateValue:l,timestamp:e,userTimeZone:i})}:{type:"date",value:m.hT(e,i)}}if("date_is_after"===t.operator){const e=m.Xz({date:d,daysToAdd:1});return l?{type:"date",value:F({dateValue:l,timestamp:e,userTimeZone:i})}:{type:"date",value:m.hT(e,i)}}(0,r.t1)(t.operator)}},file:function(e){const{filter:t}=e;if("is_empty"===t.operator)return{type:"file",value:void 0};"is_not_empty"!==t.operator&&(0,r.t1)(t)},location:()=>{},verification:function(e){const{filter:t}=e;if("verification_is"===t.operator)return{type:"verification",value:void 0};"verification_is_not"!==t.operator&&(0,r.t1)(t.operator)}};function Z(e){const{filter:t,block:n,schema:o,propertyMapping:i,userFilterContext:s,relativeVariableResult:l,getRecordModel:c,intl:d,resultCache:u}=e,{userId:p,userTimeZone:m,userStartOfWeek:f}=s,h=t.filters||[];if(0===h.length)return{type:"passesFilter"};if((0,a.q)({context:{schema:o,userId:p,userTimeZone:m,userStartOfWeek:f,relativeVariableResult:l,intl:d},propertyMapping:i,filter:t})({block:n,getRecordModel:c,propertyMapping:i,resultCache:u}))return{type:"passesFilter"};if("or"===t.operator){const e=h.map((e=>(0,a.aN)(e)?V({intl:d,block:n,schema:o,propertyMapping:i,property:e.property,filter:e.filter,userFilterContext:s,getRecordModel:c,relativeVariableResult:l,resultCache:u}):(0,a.Mm)(e)?{type:"failsFilter"}:(0,a.vA)(e)?Z({filter:e,intl:d,block:n,schema:o,propertyMapping:i,userFilterContext:s,relativeVariableResult:l,getRecordModel:c,resultCache:u}):void(0,r.t1)(e)));if(e.some((e=>"passesFilter"===e.type)))return{type:"passesFilter"};const t=e.find((e=>"coercedByFilter"===e.type));return t||(e.find((e=>"failsFilter"===e.type))||{type:"failsFilter"})}const b=[...h];b.reverse();let _="passesFilter";const S={};let w=n;const k=g.om.tryUntilFound(g.om.fromMonomorphicFunctionUnsafe((e=>{let{table:t,id:n}=e;if(t===y.iU&&n===w.id)return w}),v.mF.fromMonomorphicFunctionUnsafe((e=>{let{table:t,id:n}=e;if(t===y.iU&&n===w.id)return w.__IM_SORRY__getValue()}))),c);for(const r of b){if((0,a.Mm)(r))continue;const e=(0,a.aN)(r)?V({intl:d,block:w,schema:o,propertyMapping:i,property:r.property,filter:r.filter,userFilterContext:s,getRecordModel:k,relativeVariableResult:l,resultCache:u}):Z({filter:r,intl:d,block:w,schema:o,propertyMapping:i,userFilterContext:s,relativeVariableResult:l,getRecordModel:k,resultCache:u});"coercedByFilter"===e.type&&"passesFilter"===_&&(_="coercedByFilter"),"failsFilter"===e.type&&(_="failsFilter"),("coercedByFilter"===e.type||"failsFilter"===e.type&&e.update)&&(Object.assign(S,e.update),w=I(n,S))}return"passesFilter"===_?{type:_}:{type:_,update:S}}function V(e){const{filter:t,block:n,property:o,schema:i,propertyMapping:r,userFilterContext:l,getRecordModel:c,relativeVariableResult:u,intl:p,resultCache:m}=e,{userId:f,userTimeZone:g,userStartOfWeek:h}=l;if((0,a.Y1)({context:{schema:i,userId:f,userTimeZone:g,userStartOfWeek:h,relativeVariableResult:u,intl:p},filter:t,property:o,propertyMapping:r,depth:0})({block:n,getRecordModel:c,propertyMapping:r,resultCache:m}))return{type:"passesFilter"};if((0,a.a_)(t))return{type:"failsFilter"};const v=(null==r?void 0:r[o])??o,b=i[v];if(!b)return{type:"failsFilter"};if(!(0,s.BJ)(b))return{type:"failsFilter"};const y=(0,s.vc)(b.type),_=(0,s.ML)({filterValueType:y,block:n,propertyValue:d.wS(n,v,c),propertySchema:b,getRecordModel:c,collectionRequestContext:{userId:f,userTimeZone:g,intl:p,depth:0,visitedProperties:new Set,resultCache:new Map}}),S=(0,O[y])({filter:t,value:_,propertySchema:b,userFilterContext:l,relativeVariableResult:u});if(void 0===S)return{type:"failsFilter"};return{type:"coercedByFilter",update:{[v]:(0,s.qg)({propertyType:b.type,filterValue:S})}}}function U(e){const{blockProperties:t,oldSchema:n,newSchema:o,typesMatch:r,oldPropertyMapping:a,newPropertyMapping:s}=e,l=Object.keys(n),c=Object.keys(o),d=function(e){const{blockProperties:t,oldSchema:n,newSchema:o}=e,i={},r=null==t?void 0:t.title,a=S.lcG(r),[s]=S.nai(r),{person:[l],date:[c]}=w(o),{person:[d],date:[u]}=w(n);if(l&&(null==t||!t[l])&&!d&&a.length>0){const e=Array.from(new Set(a));i[l]=(0,f.Z)(e.map((e=>S.YCD(S.tEo(e)))),(()=>k))}return!c||null!=t&&t[c]||u||!s||(i[c]=[S.YCD(S.pZr(s))]),i}({blockProperties:t,oldSchema:n,newSchema:o}),p={propertyUpdate:d,newSchema:o},m=["relation","auto_increment_id","verification"];for(const f of l){const e=n[f],l=null==t?void 0:t[f];if(e&&!m.includes(e.type)){if(r){const e=u.aQ.deriveTypeUri(f,a),n=e?null==s?void 0:s[e]:void 0;if(n&&n!==f){p.propertyUpdate[n]=(null==t?void 0:t[f])||null,p.propertyUpdate[f]=null;continue}}if(l){const r=c.find((e=>f===e))||c.find((t=>{const n=o[t];return Boolean(e&&n&&e.name.trim().toLowerCase()===n.name.trim().toLowerCase()&&e.type===n.type)}));if(r&&p.propertyUpdate)r!==f&&(p.propertyUpdate[r]=t[f]||null,p.propertyUpdate[f]=null);else{const e=(0,i.ZP)(),o=n[f];p.newSchema={...p.newSchema,[e]:o},p.propertyUpdate&&(p.propertyUpdate[e]=t[f]||null,p.propertyUpdate[f]=null)}}}}return p}function L(e){const{block:t,schema:n,property:i,oldValue:a,newValue:s}=e;if(void 0===a.value)return{};if(void 0===s.value)return{};const c=t.getProperties();if(!c)return{};const u=c[i];if(!u)return{};const p=n[i];if(!p)return{};if(!(0,l.LG)(p))return{};if("status"===p.type||"select"===p.type||"multi_select"===p.type||"checkbox"===p.type)return function(e){const{propertySchema:t,property:n,oldValue:o,newValue:i,propertyValue:a}=e;if(void 0===o.value)return{};if(void 0===i.value)return{};if(!(0,l.LG)(t))return{};if("select"===t.type){if("select"!==o.type||"select"!==i.type)return{};if(void 0===i.value)return{};const e=d.Ak(a);return 0===e.length&&void 0===o.value||e.some((e=>(e||"").trim().toLowerCase()===(o.value||"").trim().toLowerCase()))?{[n]:d.O2(i.value)}:{}}if("multi_select"===t.type){if("multi_select"!==o.type||"multi_select"!==i.type)return{};if(void 0===i.value)return{};const e=d.Ak(a);if(!e.some((e=>e.trim().toLowerCase()===(o.value||"").trim().toLowerCase())))return{};const t=i.value,r=e.map((e=>e.trim().toLowerCase()===(o.value||"").trim().toLowerCase()?t:e));return{[n]:d.zq(r)}}if("status"===t.type){const e=t.groups??[],r=t.options??[];if("checkbox"===o.type&&"status"===i.type){if(d.Ml(a)!==o.value)return{};let t;if("by_group"===i.value.type){const n=i.value.group,o=e.find((e=>e.name===n)),a=r.find((e=>{var t;return e.id===(null==o||null===(t=o.optionIds)||void 0===t?void 0:t[0])}));t=null==a?void 0:a.value}else t=i.value.option;if(t)return{[n]:d.Is(t)}}var s;return"status"===o.type&&"status"===i.type?"by_option"!==o.value.type||"by_option"!==i.value.type||(null===(s=d.Ak(a))||void 0===s?void 0:s[0])!==o.value.option?{}:{[n]:d.Is(i.value.option)}:{}}if("checkbox"===t.type)return"status"!==o.type||"checkbox"!==i.type||"by_option"!==o.value.type?{}:d.Ak(a).includes(o.value.option)?{[n]:d._I(i.value)}:{};(0,r.t1)(t)}({propertySchema:p,property:i,propertyValue:u,oldValue:a,newValue:s});if("person"===p.type){if("person"!==a.type||"person"!==s.type)return{};if(void 0===a.value)return{};if(void 0===s.value)return{};const e=s.value,n=a.value,r=g.kk.fromBlock(t),l=d.DW({textValue:u,propertySchema:p,blockCreatorPointer:r.getCreatedByPointer()});if(!l.some((e=>o.Xy(e,n))))return{};const c=l.map((t=>o.Xy(t,n)?e:t));return{[i]:d.C1(c)}}if("relation"===p.type){if("relation"!==a.type||"relation"!==s.type||void 0===a.value||void 0===s.value)return{};if((0,l.t2)(a.value)||(0,l.t2)(s.value))return{};const e=s.value,t=a.value,n=d.rq(u);if(!n.some((e=>(0,b.qo)(e,t))))return{};const o=n.map((n=>(0,b.qo)(n,t)?e:n));return{[i]:d.ow(o)}}if((0,l.HB)(p.type)){if(a.type!==p.type||s.type!==p.type||void 0===a.value||void 0===s.value||"exact"!==a.value.type||"exact"!==s.value.type)return{};return S.QaF(u)!==a.value.value?{}:{[i]:(0,S.TPx)(s.value.value)}}if("date"===p.type||"number"===p.type||"formula"===p.type||"created_by"===p.type||"last_edited_by"===p.type||"created_time"===p.type||"last_edited_time"===p.type||"location"===p.type||"last_visited_time"===p.type)return{};(0,r.t1)(p.type)}function j(e){const{block:t,schema:n,property:o,value:i,timeZone:r,intl:s,getRecordModel:c,resultCache:d}=e,u=n[o];if(!u||!(0,l.LG)(u)||t.is_template)return!1;const p=M({schema:n,propertyMapping:void 0,group:{property:o,value:i},timeZone:r});if(!p)return!1;return(0,a.q)({filter:{operator:"and",filters:[p]},propertyMapping:void 0,context:{schema:n,intl:s,userId:void 0,userTimeZone:"UTC",userStartOfWeek:(0,m.aN)(),relativeVariableResult:void 0}})({block:t,getRecordModel:c,propertyMapping:void 0,resultCache:d})}const N={Todo:"To-do","To-do":"To-do","To do":"To-do","Not started":"To-do",Backlog:"To-do",Incomplete:"To-do",Waiting:"To-do","On hold":"To-do",Later:"To-do",Blocked:"To-do","In progress":"In progress",Building:"In progress",Designing:"In progress",Research:"In progress",Scoping:"In progress",Planning:"In progress","Needs review":"In progress",Reviewed:"In progress",Review:"In progress",Pending:"In progress",Recurring:"In progress","Review needed":"In progress","Edits needed":"In progress",Editing:"In progress",Complete:"Complete",Completed:"Complete",Done:"Complete",Finished:"Complete",Archive:"Complete",Archived:"Complete",Deleted:"Complete",Published:"Complete",Reverted:"Complete"};function z(e,t,n){var i;const r=(0,c.I4)(e,n),a=r.groups??[],s=r.options??[],l=o.Cw(N,((e,t)=>t.toLowerCase())),d=new Set,u=new Set;for(const o of t){const e=s.findIndex((e=>e.value.toLowerCase()===o.value.toLowerCase()));if(e>-1){const t=s[e];if(!d.has(t.id)){u.add(o.id),d.add(t.id),s[e]={...o,id:t.id};continue}}const t=l[o.value.toLowerCase()],n=a.find((e=>e.name===t));var p;if(n)null===(p=n.optionIds)||void 0===p||p.push(o.id),u.add(o.id)}for(const[o,c]of a.entries()){var m;const e=null===(m=c.optionIds)||void 0===m?void 0:m.some((e=>u.has(e)));c.optionIds=(c.optionIds??[]).filter((t=>!(!u.has(t)&&!d.has(t))||!e))}null==a||null===(i=a[0].optionIds)||void 0===i||i.push(...t.filter((e=>!u.has(e.id))).map((e=>e.id)));const f=[...s,...t],g=[];for(const o of a)for(const e of o.optionIds??[]){const t=f.find((t=>t.id===e));t&&g.push(t)}return{type:"status",name:e,groups:a,options:g}}},34296:(e,t,n)=>{n.d(t,{S:()=>o});let o=function(e){return e[e.Source=0]="Source",e[e.Relation=1]="Relation",e[e.Automation=2]="Automation",e}({})},63144:(e,t,n)=>{n.d(t,{P:()=>i});var o=n(53965);function i(e,t){return t.getAlive()!==e.getAlive()||!o.Xy(t.getText(),e.getText())||!o.Xy(t.getContent(),e.getContent())}},1274:(e,t,n)=>{n.d(t,{IC:()=>c,bM:()=>u,fz:()=>d,o0:()=>p});n(57658);var o=n(1898),i=n(21202),r=n(77420),a=n(6287),s=n(13493),l=n(75246);function c(e){const{targetTriggerType:t,targetParentPointer:n,targetSpaceId:i}=e;return"notification_event"===t||"event"===t?[{pointer:n,minimumRequiredRole:"editor"},{pointer:{id:i,table:l.bx},minimumRequiredRole:"read_and_write"}]:"recurrence"===t||"button"===t||"chat"===t?[{pointer:n,minimumRequiredRole:"read_and_write"}]:void(0,o.t1)(t)}function d(e){const{automationValue:t,actionValues:n}=e,i=n.flatMap((e=>p(e))).filter(o.$K);return"notification_event"===t.trigger.type||"event"===t.trigger.type?(i.push({pointer:{id:t.parent_id,table:t.parent_table,spaceId:t.space_id},minimumRequiredRole:"editor"},{pointer:{id:t.space_id,table:l.bx},minimumRequiredRole:"read_and_write"}),(0,o.$K)(t.trigger.event.source)&&(t.trigger.event.source.type===s.np||t.trigger.event.source.type===a.vF?i.push({pointer:t.trigger.event.source.pointer,minimumRequiredRole:"reader"}):"filter"===t.trigger.event.source.type||(0,o.t1)(t.trigger.event.source))):"recurrence"===t.trigger.type||"button"===t.trigger.type||"chat"===t.trigger.type?i.push({pointer:{id:t.parent_id,table:t.parent_table,spaceId:t.space_id},minimumRequiredRole:"read_and_write"}):(0,o.t1)(t.trigger),i}function u(e){return"notification_event"===e.trigger.type||"event"===e.trigger.type?[{pointer:{id:e.parent_id,table:e.parent_table,spaceId:e.space_id},minimumRequiredRole:"editor"},{pointer:{id:e.space_id,table:l.bx},minimumRequiredRole:"read_and_write"}]:"recurrence"===e.trigger.type||"button"===e.trigger.type||"chat"===e.trigger.type?[{pointer:{id:e.parent_id,table:e.parent_table,spaceId:e.space_id},minimumRequiredRole:"read_and_write"}]:void(0,o.t1)(e.trigger)}function p(e){if("create_page"===e.type){var t,n;const o=[];var a,s;if(null!==(t=e.config)&&void 0!==t&&t.collection)o.push({pointer:null===(a=e.config)||void 0===a?void 0:a.collection,minimumRequiredRole:"content_only_editor"});if(null!==(n=e.config)&&void 0!==n&&n.template_page_id)o.push({pointer:{id:null===(s=e.config)||void 0===s?void 0:s.template_page_id,table:i.iU,spaceId:e.space_id},minimumRequiredRole:"reader"});return o}var l,c;if("query_collection"===e.type){if(null!==(l=e.config)&&void 0!==l&&l.collection)return[{pointer:null===(c=e.config)||void 0===c?void 0:c.collection,minimumRequiredRole:"content_only_editor"}]}else if("update_pages"===e.type){var d;const t=null===(d=e.config)||void 0===d?void 0:d.target;if(!t)return[];if("collection"===t.type)return[{pointer:t.collection,minimumRequiredRole:"content_only_editor"}];if("page"===t.type)return[{pointer:t.page,minimumRequiredRole:"content_only_editor"}];if("variable"===t.type)return[];(0,o.t1)(t)}else if("open_page"===e.type){var u;const t=null===(u=e.config)||void 0===u?void 0:u.target;if(!t)return[];if("page"===t.type)return[{pointer:t.page,minimumRequiredRole:"reader"}];if("variable"===t.type)return[];(0,o.t1)(t)}else if("slack_notification"===e.type){var p;if(null!==(p=e.config)&&void 0!==p&&p.external_bot_id)return[{pointer:{id:e.config.external_bot_id,table:r.cZ},minimumRequiredRole:"editor"}]}else{if("duplicate_blocks"===e.type)return[];if("modal_confirmation"===e.type)return[];if("complete_sprint"===e.type){var m,f;const t=[];return null!==(m=e.config)&&void 0!==m&&m.sprint_collection&&t.push({pointer:e.config.sprint_collection,minimumRequiredRole:"editor"}),null!==(f=e.config)&&void 0!==f&&f.task_collection&&t.push({pointer:e.config.task_collection,minimumRequiredRole:"editor"}),t}if("assistant"===e.type)return[];if("send_in_app_notification"===e.type)return[];(0,o.t1)(e)}}},86658:(e,t,n)=>{n.d(t,{Fd:()=>d,G_:()=>c,UE:()=>u,cW:()=>p,fV:()=>r,ze:()=>s});n(67294);var o=n(9291),i=n(85893);const r="v9",a="https://www.notion.so/Cookie-Notice-bc186044eed5488a8387a9e94b14e58c",s=(0,o.defineMessages)({cookieSettingsLabel:{id:"cookieConsent.settings.label",defaultMessage:"Cookie settings"},customizeCookiesHeader:{id:"cookieConsent.customizeCookies.header",defaultMessage:"Customize cookies"},trackingTypeNecessaryTitle:{id:"cookieConsent.trackingTypeNecessary.title",defaultMessage:"Strictly necessary"},trackingTypeNecessaryCaption:{id:"cookieConsent.trackingTypeNecessary.caption",defaultMessage:"Essential for the site to function. Always On."},trackingTypePreferenceTitle:{id:"cookieConsent.trackingTypePreference.title",defaultMessage:"Functional"},trackingTypePreferenceCaption:{id:"cookieConsent.trackingTypePreference.caption",defaultMessage:"Used to remember preference selections and provide enhanced features."},trackingTypePerformanceTitle:{id:"cookieConsent.trackingTypePerformance.title",defaultMessage:"Analytics"},trackingTypePerformanceCaption:{id:"cookieConsent.trackingTypePerformance.caption",defaultMessage:"Used to measure usage and improve your experience."},trackingTypeTargetingTitle:{id:"cookieConsent.trackingTypeTargeting.title",defaultMessage:"Marketing"},trackingTypeTargetingCaption:{id:"cookieConsent.trackingTypeTargeting.caption",defaultMessage:"Used for targeted advertising."},trackingTypeTargetingSubtitleiOS:{id:"cookieConsent.trackingTypeTargeting.subtitleiOS",defaultMessage:"Not collected nor used within the iOS app"},cookieDismissButtonLabel:{id:"cookieConsent.dismissButton.label",defaultMessage:"Done"},acceptAllButtonLabel:{id:"cookieConsent.acceptAllButton.label",defaultMessage:"Accept all"},rejectAllButtonLabel:{id:"cookieConsent.rejectAllButton.label",defaultMessage:"Reject all"},moreOptionsButtonLabel:{id:"cookieConsent.moreOptionsButton.label",defaultMessage:"More options"},reloadAfterSaveMessage:{id:"cookieConsent.reloadAfterSave.message",defaultMessage:"Notion will now reload to apply your cookie preferences. Click okay to continue."}}),l=(0,o.defineMessages)({banner:{id:"cookieConsent.bannerDisclaimer.message",defaultMessage:"Notion uses cookies to offer you a better experience. See<cookielink>Cookie Notice</cookielink>for details."},settings:{id:"cookieConsent.settingsDisclaimer.message",defaultMessage:"Customize cookies. See<cookielink>Cookie Notice</cookielink>for details."},snackbar:{id:"cookieConsent.snackbarDisclaimer.message",defaultMessage:"Notion uses cookies. See<cookielink>Cookie Notice</cookielink>for details."}});function c(e,t){switch(e){case"necessary":return{title:s.trackingTypeNecessaryTitle,caption:s.trackingTypeNecessaryCaption};case"preference":return{title:s.trackingTypePreferenceTitle,caption:s.trackingTypePreferenceCaption};case"performance":return{title:s.trackingTypePerformanceTitle,caption:s.trackingTypePerformanceCaption};case"targeting":const e=t?s.trackingTypeTargetingSubtitleiOS:void 0;return{title:s.trackingTypeTargetingTitle,subtitle:e,caption:s.trackingTypeTargetingCaption}}}function d(e,t){return(0,i.jsx)(o.FormattedMessage,{...l[t],values:{cookielink:t=>(0,i.jsxs)(i.Fragment,{children:["Â ",e(a,t),"Â "]})}})}const u={necessary:!0,performance:!0,preference:!0,targeting:!0},p={necessary:!0,performance:!1,preference:!1,targeting:!1}},66749:(e,t,n)=>{n.d(t,{IG:()=>a,k8:()=>o,pp:()=>r});const o=!0,i=Symbol("crdtAware");function r(e){return"test"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"production")?e:Object.defineProperty(Array.isArray(e)?[...e]:{...e},i,{value:!0,enumerable:!1,configurable:!1,writable:!1})}function a(e){return i in e&&!0===e[i]}},97531:(e,t,n)=>{n.d(t,{Ry:()=>b,Vt:()=>w,cX:()=>g,mz:()=>v,nY:()=>h});n(57658),n(21703);var o=n(53965),i=n(1898),r=n(41432),a=n(42509),s=n(59753),l=n(482),c=n(21202),d=n(67175),u=n(82798),p=n(66749),m=n(68955),f=n(46227);function g(e){return e.format?{...e,format:h(e.format)}:e}function h(e){const{use_crdt:t,text_slice_tree:n,text_clocks:o,...i}=e;return i}function v(e){const{block:t,useCrdt:n}=e,o=s.kk.fromBlock(t),i=o.__IM_SORRY__getValue();if(!n)return[l.op.set({pointer:o.pointer,path:[],args:_(i)})];const r=f.ZP.createEmpty(o.pointer.id),a=l.op.set({pointer:o.pointer,path:[],args:y(i,r)}),c=o.getProperty("title");if(!c||0===c.length)return[a];return[a,...r.getOperationsForInsertTextValue(0,c).operations.map((e=>d.W5({pointer:o.pointer,crdtOperation:e})))]}function b(e){const{existingBlock:t,duplicateBlock:n}=e,r=s.kk.fromBlock(t),a=s.kk.fromBlock(n).__IM_SORRY__getValue(),{format:c,properties:u,moved:m,...f}=g(a),{title:h,...v}=u??{},b=[l.op.update({pointer:r.pointer,path:[],args:(0,p.pp)(f)}),c&&Object.keys(c).length>0?l.op.update({pointer:r.pointer,path:["format"],args:c}):void 0,r.useCrdt()?v&&Object.keys(v).length>0?l.op.update({pointer:r.pointer,path:["properties"],args:v}):void 0:u&&Object.keys(u).length>0?l.op.update({pointer:r.pointer,path:["properties"],args:(0,p.pp)(u)}):void 0,m&&Object.keys(m).length>0?l.op.update({pointer:r.pointer,path:["moved"],args:m}):void 0].filter(i.$K);if(!r.useCrdt())return b;const y=r.getTextSliceTree();if(!y)return b;const _=y.getTextValue();if(o.Xy(_,h))return b;const S=[],w=y.getVisibleCount()>0?y.getOperationsForDeleteText(0,y.getVisibleCount()-1).operations:[];if(S.push(...w),h&&h.length>0){for(const t of w)y.applyDeleteOperation(t);const e=y.getOperationsForInsertTextValue(0,h).operations;S.push(...e)}const k=S.map((e=>d.W5({pointer:r.pointer,crdtOperation:e})));return[...b,...k]}function y(e,t){const n=S(e,{use_crdt:!0,text_slice_tree:m.Z.serialize(t),text_clocks:m.Z.serializeClocks(t)});return(0,p.pp)({...n,properties:{...n.properties,title:t.getTextValue()}})}function _(e){return S(e,{use_crdt:void 0,text_slice_tree:void 0,text_clocks:void 0})}function S(e,t){const{type:n,format:o}=e;return n===r.Ti.drawing?(0,p.pp)({...e,format:{drawing_value:void 0,...o,...t}}):n===r.Ti.externalObjectInstance?(0,p.pp)((0,a.Ux)(e)?e:{...e,format:{...o,...t}}):(r.Ti.externalObjectInstancePage,(0,p.pp)({...e,format:{...o,...t}}))}function w(e,t){return e.map((e=>{if("set"!==e.command||e.pointer.table!==c.iU)return e;if(!t)return{...e,args:(0,p.pp)(e.args)};if(e.path.length>0)throw new Error("Block operation should modify root record");return{...e,args:k({...e.args,id:e.args.id??e.pointer.id})}}))}function k(e){var t;(0,u.T)(!s.kk.fromBlock(e).useCrdt());const n=f.ZP.createEmpty(e.id),o=null===(t=e.properties)||void 0===t?void 0:t.title;return o&&o.length>0&&n.insertTextValue(0,o),y(e,n)}},52936:(e,t,n)=>{n.d(t,{Bp:()=>m,yu:()=>g});n(57658),n(21703);var o=n(30120),i=n(40470),r=n(1898),a=n(80951),s=n(40506),l=n(53877),c=n(21768),d=n(482),u=n(72141),p=n(21202);const m=["consume_gap","preserve_gap"];class f{constructor(){this.operations=[],this.numDependenciesUpdated=0,this.numCouldNotUpdateDueToPermissions=0}push(e){this.operations.push(...e.operations),this.numDependenciesUpdated+=e.numDependenciesUpdated,this.numCouldNotUpdateDueToPermissions+=e.numCouldNotUpdateDueToPermissions}pushUpdatedBlockDates(e,t){for(const[n,o]of e)this.operations.push(...t.toOperations(o,{id:n,table:p.iU}));this.numDependenciesUpdated+=e.size}}function g(e){const{block:t,options:n,blockingPropertyId:s,blockedByPropertyId:l,timeZone:c,locale:d,collectionSchema:u,getRecordRole:p,getRecordValue:m,dateProperty:g,endDateProperty:y}=e,_=function(e){return t=>{let{oldDateValue:n,newDateValue:i,dependencyDateValue:a}=t;const s=Boolean(e.avoid_weekends),l=e.mode;if(!l)return;const c=a.getStart(),d=i.getStart(),u=i.getEnd();let p;if("consume_gap"===l){if(u.valueOf()>=c.valueOf()){if(s)return k({dateShiftMode:l,newDateData:o.Xp.fromDateTimes(d,u),dependencyDateValue:a});p=u.plus(a.nudgeForDate("start"))}}else if("preserve_gap"===l)if(n){const e=n.getStart(),t=n.getEnd();if(s)return k({dateShiftMode:l,oldDateData:o.Xp.fromDateTimes(e,t),newDateData:o.Xp.fromDateTimes(d,u),dependencyDateValue:a});const i=u.diff(t);p=c.plus(i)}else u.valueOf()>=c.valueOf()&&(p=u.plus(a.nudgeForDate("start")));else(0,r.t1)(l);return p&&a.changeBoundary({type:"start",newValue:p})}}(n),S=function(e){return t=>{let{oldDateValue:n,newDateValue:i,dependencyDateValue:a}=t;const s=Boolean(e.avoid_weekends),l=e.mode;if(!l)return;const c=a.getEnd(),d=i.getStart(),u=i.getEnd();let p;if("consume_gap"===l){if(d.valueOf()<=c.valueOf()&&(p=d.minus(a.nudgeForDate("end")),s))return w({dateShiftMode:l,newDateData:o.Xp.fromDateTimes(d,u),dependencyDateValue:a})}else if("preserve_gap"===l)if(n){const e=n.getStart(),t=n.getEnd();if(s)return w({dateShiftMode:l,oldDateData:o.Xp.fromDateTimes(e,t),newDateData:o.Xp.fromDateTimes(d,u),dependencyDateValue:a});const i=e.diff(d);p=c.minus(i)}else d.valueOf()<=c.valueOf()&&(p=d.minus(a.nudgeForDate("end")));else(0,r.t1)(l);return p&&a.changeBoundary({type:"end",newValue:p})}}(n),I={timeZone:c,locale:d};let C,M;if((0,r.$K)(y)){const e=new T({convertArgs:I,startPropertyId:g.id,endPropertyId:y.id});C=e;const n=e.getFromBlock(t),o=(0,a.Gl)(g.newValue)??(null==n?void 0:n.startValue),i=(0,a.Gl)(y.newValue)??(null==n?void 0:n.endValue);if(!(0,r.$K)(o))return new f;M=new A({convertArgs:I,startValue:o,endValue:i})}else{C=new x({convertArgs:I,propertyId:g.id});const e=(0,a.Gl)(g.newValue);if(!(0,r.$K)(e))return new f;M=new P({convertArgs:I,value:e})}const R={startingBlock:t,startingNewDateValue:M,context:{collectionSchema:u,getRecordRole:p,getRecordValue:m,accessor:C}};if("consume_gap"===n.mode){const e=new f,t=b({...R,dependencyPropertyId:s,dateAdjuster:_,dateRangeIsFurtherThan:(e,t)=>e.getStart().valueOf()>t.getStart().valueOf()});if(i.x.isFail(t))return new f;e.push(t.value);const n=b({...R,dependencyPropertyId:l,dateAdjuster:S,dateRangeIsFurtherThan:(e,t)=>e.getEnd().valueOf()<t.getEnd().valueOf()});return i.x.isFail(n)?new f:(e.push(n.value),e)}if("preserve_gap"===n.mode)return function(e){const{startingBlock:t,startingNewDateValue:n,forwardConfig:o,backwardConfig:i,context:r}=e,{accessor:a}=r,s=new Set,l=[{block:t,newDateValue:n}],c=new Map,d=new f;for(;;){const e=l.shift();if(!e)break;const{block:n,newDateValue:u}=e;if(s.has(n.id))continue;s.add(n.id);const p=a.getFromBlock(n);for(const{dependencyPropertyId:a,dateAdjuster:s}of[o,i]){const e=v(r,n,a);for(const n of e)n.id!==t.id&&h({context:r,adjust:e=>s({oldDateValue:p,newDateValue:u,dependencyDateValue:e}),result:d,dependencyPointer:n,onDateUpdated:(e,t)=>{c.has(n.id)||c.set(n.id,t),l.push({block:e,newDateValue:t})}})}}return d.pushUpdatedBlockDates(c,a),d}({...R,forwardConfig:{dependencyPropertyId:s,dateAdjuster:_},backwardConfig:{dependencyPropertyId:l,dateAdjuster:S}});(0,r.t1)(n.mode)}function h(e){const{result:t,dependencyPointer:n,context:o,adjust:i,onDateUpdated:r}=e,{accessor:a,getRecordValue:s,getRecordRole:l}=o,c=l(n);if(c&&!(0,u.J5)(c))return void t.numCouldNotUpdateDueToPermissions++;const d=s(n);if(!d)return;const p=a.getFromBlock(d);if(!p)return;const m=i(p);m&&!m.equals(p)&&r(d,m)}function v(e,t,n){var o;const i=e.collectionSchema[n];return i&&"relation"===i.type?(0,a.j$)({propertySchema:i,getRecordModel:c.o.fromGetRecordValueFn(e.getRecordValue),relationValue:(0,a.rq)(null===(o=t.properties)||void 0===o?void 0:o[n])}):[]}function b(e){const{startingBlock:t,startingNewDateValue:n,context:o,dateAdjuster:i,dateRangeIsFurtherThan:r,dependencyPropertyId:a}=e,{accessor:s}=o,l=new Set,c=[{block:t,newDateValue:n,path:[]}],d=new Map,u=new f;for(;;){const e=c.shift();if(!e)break;const{block:t,newDateValue:n,path:p}=e;if(p.includes(t.id))return{error:"cycle_detected"};if(l.has(t.id))continue;l.add(t.id);const m=s.getFromBlock(t),f=[...p,t.id],g=v(o,t,a);for(const a of g)h({context:o,adjust:e=>i({oldDateValue:m,newDateValue:n,dependencyDateValue:e}),result:u,dependencyPointer:a,onDateUpdated:(e,t)=>{const n=d.get(a.id);n&&!r(t,n)||d.set(a.id,t),c.push({block:e,newDateValue:t,path:f})}})}return u.pushUpdatedBlockDates(d,s),{value:u}}function y(e){const{inputDate:t,dateShiftDirection:n}=e;return 6===t.weekday?t.plus({days:"right"===n?2:-1}):7===t.weekday?t.plus({days:"right"===n?1:-2}):t}function _(e,t){let n,o,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0;if(e.valueOf()>t.valueOf())n=t,o=e;else{if(!(e.valueOf()<t.valueOf()))return 0;n=e,o=t}for(i&&(n=n.plus({days:1}),o=o.minus({days:1}));n.valueOf()<=o.valueOf();)S(n)||r++,n=n.plus({days:1});return r}function S(e){return 6===e.weekday||7===e.weekday}function w(e){const{newDateData:t,dependencyDateValue:n,dateShiftMode:o}=e,i=n.getStart(),r=n.getEnd(),a=_(i,r);let s=y({inputDate:t.start.minus({days:1}),dateShiftDirection:"left"});if("preserve_gap"===o){const n=_(e.oldDateData.start,r,!0);for(let e=_(t.start,s,!0);e<n;e++)s=s.minus({days:1}),S(s)&&(s=y({inputDate:s,dateShiftDirection:"left"}))}let l=s,c=1;for(;c<a;)l=l.minus({days:1}),S(l)||c++;return n.changeBoundaries({newStart:l,newEnd:s})}function k(e){const{dependencyDateValue:t,newDateData:n,dateShiftMode:o}=e,i=t.getStart(),r=_(i,t.getEnd());let a=y({inputDate:n.end.plus({days:1}),dateShiftDirection:"right"});if("preserve_gap"===o){const t=_(e.oldDateData.end,i,!0);for(let e=_(n.end,a,!0);e<t;e++)a=a.plus({days:1}),S(a)&&(a=y({inputDate:a,dateShiftDirection:"right"}))}let s=a,l=1;for(;l<r;)s=s.plus({days:1}),S(s)||l++;return t.changeBoundaries({newStart:a,newEnd:s})}function I(e,t){if(!(e instanceof t))throw new Error(`Expected ShiftableDate to be of type ${t}`)}class C{constructor(e){this.convertArgs=e}}class x extends C{constructor(e){super(e.convertArgs),this.propertyId=void 0,this.propertyId=e.propertyId}getFromBlock(e){var t;const n=(0,a.Gl)(null===(t=e.properties)||void 0===t?void 0:t[this.propertyId]);return n?new P({value:n,convertArgs:this.convertArgs}):void 0}toOperations(e,t){return I(e,P),[d.op.update({pointer:t,path:["properties"],args:{[this.propertyId]:(0,a.d7)(e.value)}})]}}class T extends C{constructor(e){super(e.convertArgs),this.startPropertyId=void 0,this.endPropertyId=void 0,this.startPropertyId=e.startPropertyId,this.endPropertyId=e.endPropertyId}getFromBlock(e){var t;const n=(0,a.Gl)(null===(t=e.properties)||void 0===t?void 0:t[this.startPropertyId]);if((0,r.$K)(n)){var o;const t=(0,a.Gl)(null===(o=e.properties)||void 0===o?void 0:o[this.endPropertyId]);return new A({startValue:n,endValue:t,convertArgs:this.convertArgs})}}toOperations(e,t){return I(e,A),[d.op.update({pointer:t,path:["properties"],args:{[this.startPropertyId]:(0,a.d7)(e.startValue),...e.endValue?{[this.endPropertyId]:(0,a.d7)(e.endValue)}:{}}})]}}class M{constructor(e){this.convertArgs=e}toLuxon(e){return l.OQ.notionDateOrDateTimeToLuxon(e,this.convertArgs)}}class P extends M{constructor(e){super(e.convertArgs),this.value=void 0,this.value=e.value}getStart(){return this.toLuxon(s.Ws(this.value))}getEnd(){return this.toLuxon(s.S$(this.value))}nudgeForDate(e){return"date"===this.value.type||"daterange"===this.value.type?{days:1}:"datetime"===this.value.type?{minutes:1}:"datetimerange"===this.value.type?{}:void(0,r.t1)(this.value)}equals(e){return I(e,P),s.AP(this.value,e.value)}changeBoundary(e){let t;if("daterange"===this.value.type||"datetimerange"===this.value.type){const n=l.NK(this.value,this.convertArgs.timeZone,this.convertArgs.locale),o=n.end.diff(n.start);t=("daterange"===this.value.type?l.OQ.toPersistedDateRange:l.OQ.toPersistedDateTimeRange)("start"===e.type?{start:e.newValue,end:e.newValue.plus(o)}:{start:e.newValue.minus(o),end:e.newValue},this.convertArgs.timeZone)}else if("date"===this.value.type||"datetime"===this.value.type){t=("date"===this.value.type?l.OQ.toPersistedDate:l.OQ.toPersistedDateTime)(e.newValue.valueOf(),this.convertArgs.timeZone)}else(0,r.t1)(this.value);return new P({value:t,convertArgs:this.convertArgs})}changeBoundaries(e){const{newStart:t,newEnd:n}=e;return new P({value:l.OQ.toPersistedDateWithType({start:t,end:n},this.value.type,this.convertArgs.timeZone),convertArgs:this.convertArgs})}}class A extends M{getMergedValue(){if(this._mergedValue===A.MergedValueNotCalculated){const e=l.rH(this.startValue,this.endValue);this._mergedValue=e?l.Qq(e):void 0}return this._mergedValue}constructor(e){super(e.convertArgs),this.startValue=void 0,this.endValue=void 0,this._mergedValue=void 0,this.startValue=e.startValue,this.endValue=e.endValue}getStart(){return this.toLuxon(s.Ws(this.getMergedValue()??this.startValue))}getEnd(){return this.toLuxon(s.S$(this.getMergedValue()??this.endValue??this.startValue))}equals(e){return I(e,A),s.AP(this.startValue,e.startValue)&&((0,r.$K)(this.endValue)?(0,r.$K)(e.endValue)&&s.AP(this.endValue,e.endValue):!(0,r.$K)(e.endValue))}nudgeForDate(e){const t="start"===e?this.startValue:this.endValue??this.startValue;return"date"===t.type?{days:1}:"datetime"===t.type||"datetimerange"===t.type||"daterange"===t.type?{}:void(0,r.t1)(t)}toPersistedDateDiscardingRange(e,t){return void 0===t||"date"===t||"daterange"===t?l.OQ.toPersistedDate(e.valueOf(),this.convertArgs.timeZone):"datetime"===t||"datetimerange"===t?l.OQ.toPersistedDateTime(e.valueOf(),this.convertArgs.timeZone):void(0,r.t1)(t)}changeBoundary(e){var t,n;const o=this.getEnd().diff(this.getStart());return new A({convertArgs:this.convertArgs,..."start"===e.type?{startValue:this.toPersistedDateDiscardingRange(e.newValue,this.startValue.type),endValue:this.toPersistedDateDiscardingRange(e.newValue.plus(o),null===(t=this.endValue)||void 0===t?void 0:t.type)}:{startValue:this.toPersistedDateDiscardingRange(e.newValue.minus(o),this.startValue.type),endValue:this.toPersistedDateDiscardingRange(e.newValue,null===(n=this.endValue)||void 0===n?void 0:n.type)}})}changeBoundaries(e){var t;const{newStart:n,newEnd:o}=e;return new A({startValue:this.toPersistedDateDiscardingRange(n,this.startValue.type),endValue:this.toPersistedDateDiscardingRange(o,null===(t=this.endValue)||void 0===t?void 0:t.type),convertArgs:this.convertArgs})}}A.MergedValueNotCalculated=Symbol("Merged value not calculated yet")},44317:(e,t,n)=>{n.d(t,{Ct:()=>a,O5:()=>s,eG:()=>r});var o=n(9291),i=n(19584);const r=(0,o.defineMessages)({year:{id:"timeUtils.durationDescriptor.intervalYear",defaultMessage:"{numYears, plural, one {1 year} other {{numYears} years}}"},week:{id:"timeUtils.durationDescriptor.intervalWeek",defaultMessage:"{numWeeks, plural, one {1 week} other {{numWeeks} weeks}}"},day:{id:"timeUtils.durationDescriptor.intervalDay",defaultMessage:"{numDays, plural, one {1 day} other {{numDays} days}}"},hour:{id:"timeUtils.durationDescriptor.intervalHour",defaultMessage:"{numHours, plural, one {1 hour} other {{numHours} hours}}"},minute:{id:"timeUtils.durationDescriptor.intervalMinute",defaultMessage:"{numMinutes, plural, one {1 minute} other {{numMinutes} minutes}}"},second:{id:"timeUtils.durationDescriptor.intervalSecond",defaultMessage:"{numSeconds, plural, one {1 second} other {{numSeconds} seconds}}"}});function a(e,t){const n=Math.floor(e/i._I),o=Math.floor(e/i.DS),a=Math.floor(e/i.A0),s=Math.floor(e/i.U6),l=Math.floor(e/i.hM),c=Math.floor(e/i.C0);return n>=1?t.formatMessage(r.year,{numYears:n}):o>=1?t.formatMessage(r.week,{numWeeks:o}):a>=1?t.formatMessage(r.day,{numDays:a}):s>=1?t.formatMessage(r.hour,{numHours:s}):l>=1?t.formatMessage(r.minute,{numMinutes:l}):t.formatMessage(r.second,{numSeconds:c})}function s(e){return Math.floor((Date.now()-e)/864e5)}},93824:(e,t,n)=>{n.d(t,{q:()=>i});n(57658);var o=n(35311);function i(e,t){const n=o.create({arrays:{detectMove:!1,includeValueOnMove:!0}}).diff(e,t);if(!n)return{beforeOps:{},removeOps:new Set};let i=[],r=[];for(const o in n)"_t"!==o&&("_"===o[0]?i.push(parseInt(o.slice(1),10)):1===n[o].length&&r.push({index:parseInt(o,10),value:n[o][0]}));const a={},s=new Set,l=[...e];i=i.sort(((e,t)=>e-t));for(let o=i.length-1;o>=0;o--){const e=i[o],t=l.splice(e,1)[0];s.add(t)}r=r.sort(((e,t)=>e.index-t.index));for(let o=0;o<r.length;o++){const e=r[o];a[e.value]=l[e.index],l.splice(e.index,0,e.value)}return{beforeOps:a,removeOps:s}}},76837:(e,t,n)=>{n.d(t,{XJ:()=>te,J_:()=>ee,PZ:()=>Q,nM:()=>W,eb:()=>G});n(57658),n(21703);var o=n(53965),i=n(7032),r=n(15828),a=n(1898),s=n(19584),l=(n(92996),n(3865)),c=n(59786),d=n(41432),u=n(76205),p=n(14714),m=n(99036),f=n(1274),g=n(97531);const h="415fc269-e68f-4da0-b3e3-b1273b741a7f";n(42509);var v=n(89789),b=n(59753),y=(n(482),n(98963)),_=n(18844),S=n(21202),w=n(70203);function k(e){var t;const{blockValue:n,factoryButtonDeprecationContext:o,source:r}=e,a=function(e){return b.kk.fromValue(S.iU,e).getCreatedByPointer()??{id:v.P_.id,table:v.P_.table}}(n),s=n.space_id,l=(0,i.ZP)(),c=(0,i.ZP)(),d=o.isRootBlockFactoryBlock&&o.isCurrentBlockRootBlock?o.rootTextContainerId:(0,i.ZP)(),u=function(e){const{automationActionId:t,textContainerBlockId:n,creatorPointer:o,originalBlockValue:i,spaceId:r,blockContent:a}=e;return{table:S.iU,value:{id:n,space_id:r,alive:!0,parent_table:_.Xj,parent_id:t,type:"text",version:0,content:a,created_time:i.created_time,created_by_table:o.table,created_by_id:o.id}}}({automationActionId:c,textContainerBlockId:d,creatorPointer:a,originalBlockValue:n,blockContent:"duplication"===r?null===(t=n.content)||void 0===t?void 0:t.map((t=>e.pointerMapper({id:t,table:S.iU}).id)):n.content,spaceId:s}),p=function(e){const{automationId:t,automationActionId:n,spaceId:o,textContainerBlockId:i}=e;return{table:_.Xj,value:{id:n,space_id:o,alive:!0,parent_table:y.cv,parent_id:t,type:"duplicate_blocks",blocks:[i],version:0,config:void 0}}}({automationActionId:c,automationId:l,creatorPointer:a,originalBlockValue:n,spaceId:s,textContainerBlockId:d}),m=function(e){var t;const{creatorPointer:n,automationActionId:o,originalBlockValue:r,spaceId:a,automationId:s}=e,l=(0,i.ZP)(),c=Date.now();return{table:y.cv,value:{id:s,space_id:a,alive:!0,trigger:{id:l,type:"button"},parent_id:r.id,parent_table:S.iU,action_ids:[o],status:"active",properties:{name:(0,w.QaF)(null===(t=r.properties)||void 0===t?void 0:t.title)},created_by_id:n.id,created_by_table:n.table,created_time:r.created_time??c,last_edited_time:r.last_edited_time??c,version:0,last_edited_by_id:r.last_edited_by_id??n.id,last_edited_by_table:r.last_edited_by_table??n.table}}}({automationActionId:c,automationId:l,creatorPointer:a,originalBlockValue:n,spaceId:s});return{textContainerBlock:u,automation:m,automationAction:p}}var I=n(6695),C=n(35102),x=n(76218),T=n(68626),M=n(59730),P=n(64572),A=n(77337),R=n(63306),D=n(87479),E=n(72141),B=n(74446),F=n(45953),O=n(606),Z=n(77420),V=n(6287),U=n(13493),L=n(70279),j=n(33709),N=n(80396),z=n(23867),q=n(91644);function W(e){const t=G([w.V3y(e)]);return w.QaF(t)}function H(e){if(e.length<3||!e.startsWith("(")||!e.endsWith(")"))return;const t=e.substring(1,e.length-1),n=parseInt(t),o=!Number.isNaN(n)&&n>0&&function(e){return Boolean(e.match(/^[1-9][0-9]*$/))}(t);return o?n:void 0}function K(e){const t=e=>`(${e})`,{title:n,digit:o}=function(e){const t=e.trimEnd(),n=t.split(" "),o=H(n[n.length-1]);let i=t;if(void 0!==o){const e=n.slice(0,n.length-1).join(" ");i=e.length>0?e:void 0}return{title:i,digit:o}}(e[0]),i=void 0===n?"":`${n.trimEnd()} `,r=t(void 0===o?1:o+1);return w.V3y(`${i}${r}`)}function G(e){const t=w.QaF(e);if(0===t.trim().length||void 0===e)return[w.V3y(t)];const n=e[e.length-1];if(w.QJH(n)){return[...e.slice(0,e.length-1),K(n)]}return[...e,K([""])]}function $(e){return(t=e.table)===S.iU||t===V.vF||t===U.np||t===j.qF||t===L.x_||t===N.yo||t===y.cv||t===_.Xj||t===q.AT;var t}function Q(e){const{sourceBlockId:t,targetBlockPointer:n,recordMap:r,options:a,baseUrl:s,publicDomainName:l,actor:c,getRecordRole:d,mapper:u,duplicateForCrdt:p}=e,m=e.recordPointerMap||F.Ao.create();for(const{pointer:o}of r){if(o.id===t){m.set(o,n);continue}let e=m.get(o);!e&&u&&(e=u({requested:o,requester:{table:S.iU,id:t}})),e||(e={spaceId:n.spaceId,table:o.table,id:(0,i.ZP)()}),m.set(o,e)}const f=F.Ak.create(),g=e=>{let{requested:t}=e;return m.get(t)},h={},v=[],b=r.getModel({id:t,table:S.iU}),y=b?function(e){const t="duplication",n=new Map;let o;return"factory"===e.type?(o={type:t,isRootBlockFactoryBlock:!0,isCurrentBlockRootBlock:!1,factoryBlockIdToNewTextContainerIdMap:n,rootTextContainerId:(0,i.ZP)()},o.factoryBlockIdToNewTextContainerIdMap.set(e.id,{id:o.rootTextContainerId,table:S.iU})):o={type:t,isRootBlockFactoryBlock:!1,factoryBlockIdToNewTextContainerIdMap:n},o}(b):void 0;for(const{pointer:o,model:i}of r){if(void 0===i)continue;if(!$(i))continue;if(!(null!=a&&a.duplicateDiscussions||o.table!==j.qF&&o.table!==L.x_&&o.table!==N.yo))continue;const e=Boolean((null==a?void 0:a.resolveTemplateVariables)&&oe({rootSourceBlockIds:[t],childSourcePointer:o,getSourceRecordValue:B.mF.fromRecordMap(r)}))?{...a,resolveTemplateVariables:!1}:a;null!=y&&y.isRootBlockFactoryBlock&&(y.isCurrentBlockRootBlock=i.id===t);const{duplicateRecord:u,additionalRecords:m}=J({table:i.table,record:i.__IM_SORRY__getValue(),mapper:g,options:e,rewiredUriMap:h,typedCollectionViewBlocks:v,originOptions:{baseUrl:s,publicDomainName:l},actor:c,getRecordRole:d,factoryButtonDeprecationContext:y,duplicateForCrdt:p});if(void 0!==u){if(i.table===S.iU&&u.id===n.id){const e=u;delete e.parent_id,delete e.parent_table,delete e.alive}Y({duplicateRecordMap:f,duplicateRecordResult:{duplicateRecord:u,additionalRecords:m,duplicateRecordTable:i.table}})}}return function(e){const{rewiredUriMap:t,typedCollectionViewBlocks:n,duplicateRecordMap:r}=e;if(o.xb(t)||0===n.length)return;const a=o.oA(n.map((e=>r.getValue(e))));a.forEach((e=>{var n;const o=null==e||null===(n=e.format)||void 0===n?void 0:n.app_uri_map;o&&Object.entries(o).forEach((e=>{let[n,i]=e;o[n]=t[i]}))}));const s=a.reduce(((e,t)=>{var n;const o=null==t||null===(n=t.format)||void 0===n?void 0:n.app_id;return o&&(e[o]=e[o]?[...e[o],t]:[t]),e}),{});Object.entries(s).forEach((e=>{let[t,n]=e;const o=(0,i.ZP)();n.forEach((e=>{var t;null!=e&&null!==(t=e.format)&&void 0!==t&&t.app_id&&(e.format.app_id=o)}))}))}({rewiredUriMap:h,typedCollectionViewBlocks:v,duplicateRecordMap:f}),{duplicateRecordMap:f,originalToDuplicate:m}}function Y(e){const{duplicateRecordResult:t,duplicateRecordMap:n}=e,{additionalRecords:o,duplicateRecord:i,duplicateRecordTable:r}=t;n.setValue(O.dr.fromPointerLike({table:r,id:i.id}),i);for(const a of o)n.setValue(O.dr.fromPointerLike({id:a.value.id,table:a.table}),a.value)}function J(e){const{table:t,record:n,mapper:l,options:c,originOptions:u,actor:f,helperRecordMap:v,getRecordRole:x,rewiredUriMap:T,typedCollectionViewBlocks:P,factoryButtonDeprecationContext:A,duplicateForCrdt:R}=e,B=o.Xh(n),F=l({requested:O.dr.fromPointerLike({table:t,id:n.id,spaceId:n.space_id}),requester:O.dr.fromPointerLike({table:t,id:n.id})});if(void 0===F)throw new M.D3(`Failed to duplicate record ${n.id}`);B.id=F.id,B.space_id=(0,z.C)(F.spaceId);const W=[];if(t===S.iU){const e=B,{additionalRecords:t}=function(e){var t,n,r,l,c,u,p;const{originalBlock:m,duplicateBlock:f,mapper:v,options:_,originOptions:C,rewiredUriMap:x,typedCollectionViewBlocks:T,actor:M,helperRecordMap:P,factoryButtonDeprecationContext:A,duplicateForCrdt:R}=e;if(("transclusion_reference"===m.type||"transclusion_container"===m.type&&!_.deepCopyTransclusionContainers)&&b.kk.fromBlock(m).useCrdt()!==R){const e=R?`Cannot duplicate a non-CRDT ${m.type} block as a CRDT block`:`Cannot duplicate a CRDT ${m.type} block as a non-CRDT block`;f.type="callout",f.properties={title:[[e]]},f.format={block_color:"red_background",page_icon:"ðŸš¨"},delete f.content}const B={table:S.iU,id:m.id,spaceId:m.space_id};null!==(t=m.format)&&void 0!==t&&t.app_config_uri&&null!==(n=f.format)&&void 0!==n&&n.app_config_uri&&((0,I.iA)(m.format.app_config_uri)?f.format.app_config_uri=void 0:((0,d.dM)(f.type)&&T.push({table:S.iU,id:f.id,spaceId:f.space_id}),x[m.id]=f.id));const F=[];f.format&&(f.format=g.nY(f.format));if("factory"===f.type&&A){const{automation:e,automationAction:t,textContainerBlock:n}=k({blockValue:f,source:"duplication",pointerMapper:e=>v({requested:e,requester:B})??e,factoryButtonDeprecationContext:A});F.push(e,t,n),A.factoryBlockIdToNewTextContainerIdMap.set(m.id,{id:n.value.id,table:S.iU});const o=f;o.type="button",o.content=[],o.format={...o.format,automation_id:e.value.id}}(0,i.e)(m.id)&&(f.format||(f.format={}),f.format.copied_from_pointer={table:S.iU,id:m.id,spaceId:m.space_id},f.copied_from=m.id);const L=(m.parent_table===S.iU?null==A?void 0:A.factoryBlockIdToNewTextContainerIdMap.get(m.parent_id):void 0)??v({requested:{table:f.parent_table,id:f.parent_id,spaceId:f.space_id},requester:B});L&&(f.parent_id=L.id);const N=f;if(N.content){var q;if(N.content=N.content.map((e=>{var t;return(null===(t=v({requested:{table:S.iU,id:e},requester:B}))||void 0===t?void 0:t.id)||e})),f.space_id===h&&null!==(q=f.properties)&&void 0!==q&&q.title){var W,H,K;const e=(0,w.lzi)(null===(W=f.properties)||void 0===W?void 0:W.title);e&&e.length>0&&e[0].length>0&&null!==(H=e[0][0])&&void 0!==H&&null!==(H=H.trim())&&void 0!==H&&H.startsWith("ðŸŽ²")&&null!==(K=e[0][0])&&void 0!==K&&null!==(K=K.trim())&&void 0!==K&&K.endsWith("ðŸŽ²")&&(N.content=o.TV(N.content))}}null!==(r=f.format)&&void 0!==r&&r.ai_instructions_page_pointer&&(f.format.ai_instructions_page_pointer=v({requested:f.format.ai_instructions_page_pointer,requester:B}));null!==(l=f.format)&&void 0!==l&&l.ai_skill_pointer&&(f.format.ai_skill_pointer=v({requested:f.format.ai_skill_pointer,requester:B}));const G=f;G.view_ids&&(G.view_ids=G.view_ids.map((e=>{var t;return(null===(t=v({requested:{table:U.np,id:e,spaceId:G.space_id},requester:B}))||void 0===t?void 0:t.id)||e})));const $=b.kk.fromBlock(G).getCollectionPointer();if($){var Q;if(null==P||null===(Q=P.getValue($))||void 0===Q||null===(Q=Q.format)||void 0===Q?void 0:Q.bot_id)G.collection_id=$.id,G.format={...G.format,collection_pointer:$};else{const e=v({requested:$,requester:B})||$;if(e.table!==V.vF)throw new Error(`Collection pointer for duplicate collection is invalid: ${JSON.stringify(e)}`);G.collection_id=e.id,G.format={...G.format,collection_pointer:e}}}f.discussions&&(_.duplicateDiscussions?f.discussions=f.discussions.map((e=>{var t;return(null===(t=v({requested:O.dr.fromPointerLike({table:j.qF,id:e,spaceId:f.space_id}),requester:B}))||void 0===t?void 0:t.id)||e})):delete f.discussions);if(f.permissions){var Y;if(_.duplicatePermissions)f.permissions=function(e){const{block:t,targetSpaceSettings:n,targetTeamSettings:o}=e;return(t.permissions||[]).filter((e=>!(0,E.FB)(e)&&(!(0,E.hV)(e)&&((!(!o&&n.disablePublicAccess||o&&o.disable_public_access)||!(0,E.$D)(e))&&!((!o&&n.disableGuests||o&&o.disable_guests)&&(0,E.jg)(e)&&!(0,D.RT)({spacePermissions:n.permissions||[],userId:e.user_id,botId:void 0}))))))}({block:f,targetSpaceSettings:_.duplicatePermissions.targetSpaceSettings,targetTeamSettings:null===(Y=_.duplicatePermissions)||void 0===Y?void 0:Y.targetTeamSettings});else delete f.permissions}f.content_classification&&delete f.content_classification;f.moved&&delete f.moved;f.properties||(f.properties={});for(const o in f.properties){const e=_.duplicateDiscussions?f.properties[o]:w.V3g(f.properties[o],{removeSuggestions:!0,removeDiscussions:!0});f.properties[o]=e}f.ignore_block_count&&delete f.ignore_block_count;if(f.properties)for(const o of Object.keys(f.properties)){const e=f.properties[o];e&&(f.properties[o]=ne({...C,text:{value:e,spaceId:(0,z.C)(f.space_id)},mapper:v,requester:B,resolveTemplateVariables:_.resolveTemplateVariables||!1}))}if("transclusion_reference"===f.type&&_.deepCopyTransclusionContainers){const e=f;if(e.format&&e.format.transclusion_reference_pointer){const t=e.format.transclusion_reference_pointer,n=v({requested:t,requester:B});n&&(e.format.transclusion_reference_pointer=n)}}if("transclusion_container"===f.type&&!_.deepCopyTransclusionContainers){const e=f;e.type="transclusion_reference",e.content=void 0;const t=e.format||{};t.transclusion_reference_pointer=B,e.format=t}if("alias"===f.type&&f.format&&f.format.alias_pointer){const e=f.format.alias_pointer,t=v({requested:e,requester:B});t&&(f.format.alias_pointer=t)}f.type===d.Ti.externalObjectInstancePage&&(f.type=d.Ti.externalObjectInstance);if(f.type===d.Ti.externalObjectInstance){var J,X,ee;if(null!==(J=f.format)&&void 0!==J&&J.related_external_object_uris_to_instance_ids&&(f.format.related_external_object_uris_to_instance_ids=(0,s.m8)((0,a.qP)(f.format.related_external_object_uris_to_instance_ids).map((e=>{var t;let[n,o]=e;return[n,(null===(t=v({requested:{table:S.iU,id:o,spaceId:G.space_id},requester:B}))||void 0===t?void 0:t.id)||o]})))),_.convertExternalObjectInstancesToPlaceholders&&(null===(X=f.format)||void 0===X||!X.is_placeholder)&&null!==(ee=f.format)&&void 0!==ee&&ee.bot_id){const e=null==P?void 0:P.getValue({table:Z.cZ,id:f.format.bot_id}),t=null==e?void 0:e.integration_id;if(t){const e={is_placeholder:!0,integration_id:t};f.format=e}}}f.file_ids&&function(e){var t;const n=JSON.stringify(e.properties);e.file_ids=null==e||null===(t=e.file_ids)||void 0===t?void 0:t.filter((t=>{var o,i,r,a,s,l;return!(null===(o=e.format)||void 0===o||!o.display_source||-1===(null===(i=e.format)||void 0===i||null===(i=i.display_source)||void 0===i?void 0:i.indexOf(t)))||(!(null===(r=e.format)||void 0===r||!r.page_cover||-1===(null===(a=e.format)||void 0===a||null===(a=a.page_cover)||void 0===a?void 0:a.indexOf(t)))||(!(null===(s=e.format)||void 0===s||!s.page_icon||-1===(null===(l=e.format)||void 0===l||null===(l=l.page_icon)||void 0===l?void 0:l.indexOf(t)))||-1!==n.indexOf(t)))}))}(f);const te=m,oe=f;oe.format&&(null!==(c=te.format)&&void 0!==c&&c.original_source||null!==(u=te.format)&&void 0!==u&&u.image_edit_metadata)&&(oe.format.original_source=void 0,oe.format.image_edit_metadata=void 0);if(null!==(p=f.format)&&void 0!==p&&p.automation_id){const e=v({requested:{table:y.cv,id:f.format.automation_id,spaceId:f.space_id},requester:B});e&&(f.format.automation_id=e.id)}"collection"===m.parent_table&&m.type===d.Ti.copyIndicator&&f.properties&&(0,a.Yd)(f.properties).length>0&&(f.type=d.Ti.page);if(!_.preserveSourceMetadataTimestamps){const e=Date.now();f.created_time=e,f.last_edited_time=e}M&&(f.last_edited_by_id=M.id,f.last_edited_by_table=M.table,f.created_by_id=M.id,f.created_by_table=M.table);return{duplicateRecord:f,additionalRecords:F}}({originalBlock:n,duplicateBlock:e,mapper:l,options:c??{},rewiredUriMap:T,typedCollectionViewBlocks:P,originOptions:u,actor:f,helperRecordMap:v,factoryButtonDeprecationContext:A,duplicateForCrdt:R});W.push(...t)}else if(t===V.vF){!function(e,t,n,o,l){var c,d,u,p;const f={table:V.vF,id:e.id,spaceId:e.space_id};null!==(c=e.format)&&void 0!==c&&c.app_config_uri&&(l[e.id]=t.id);if((0,i.e)(e.id)){if(t.format||(t.format={}),t.format.copied_from_pointer={table:V.vF,id:e.id,spaceId:e.space_id},void 0!==t.format.collection_default_template&&"empty"!==t.format.collection_default_template){const e=n({requested:{table:S.iU,id:t.format.collection_default_template.template_page_id},requester:f});e&&(t.format.collection_default_template={template_page_id:e.id})}t.copied_from=e.id}const g=n({requested:{table:t.parent_table,id:t.parent_id},requester:f});g&&(t.parent_id=g.id);const h=m.oC(t);for(const i in h){const a=h[i];if(a&&"relation"===a.type&&m.j0(a)){const e=n({requested:m.j0(a),requester:f});e?(a.collection_id=e.id,a.collection_pointer={id:e.id,table:V.vF,spaceId:(0,z.C)(e.spaceId)}):a.property&&(a.property=(0,r.ZP)())}var v;if(a&&"title"===a.type&&t.name&&(t.name=ne({...o,text:{value:t.name,spaceId:t.space_id},mapper:n,requester:f,resolveTemplateVariables:!1})),a&&"button"===a.type&&a.automation_id)a.automation_id=(null===(v=n({requested:{id:a.automation_id,spaceId:e.space_id,table:y.cv},requester:f}))||void 0===v?void 0:v.id)??a.automation_id}t.description&&(t.description=ne({...o,text:{value:t.description,spaceId:t.space_id},mapper:n,requester:f,resolveTemplateVariables:!1}));for(const i in h){const e=h[i];if(!e||"formula"!==e.type||"v2"!==e.version||!e.formula2)continue;const t=(0,C.Wo)(e.formula2.code,n,f);e.formula2.code=t}t.template_pages&&(t.template_pages=t.template_pages.map((e=>{var t;return(null===(t=n({requested:{table:S.iU,id:e},requester:f}))||void 0===t?void 0:t.id)||e})));if(null!==(d=t.format)&&void 0!==d&&d.collection_mode&&"page_tree"===t.format.collection_mode.type){var b;const e=t.format.collection_mode.root_page_pointer,o=(null===(b=n({requested:O.dr.fromPointerLike({table:"block",id:e.id,spaceId:t.space_id}),requester:f}))||void 0===b?void 0:b.id)||e.id;t.format.collection_mode={type:"page_tree",root_page_pointer:{id:o,table:"block",spaceId:t.space_id}}}null!==(u=t.format)&&void 0!==u&&u.related_external_object_uris_to_instance_ids&&(t.format.related_external_object_uris_to_instance_ids=(0,s.m8)((0,a.qP)(t.format.related_external_object_uris_to_instance_ids).map((e=>{var o;let[i,r]=e;return[i,(null===(o=n({requested:{table:V.vF,id:r,spaceId:t.space_id},requester:f}))||void 0===o?void 0:o.id)||r]}))));delete t.deleted_schema,null!==(p=t.format)&&void 0!==p&&p.automation_ids&&(t.format.automation_ids=t.format.automation_ids.map((e=>{var o;return null===(o=n({requested:{id:e,table:y.cv,spaceId:t.space_id},requester:f}))||void 0===o?void 0:o.id})).filter(a.$K))}(n,B,l,u,T)}else if(t===U.np){!function(e,t,n,o,i){var r,a,s,l,c,d;const u={table:U.np,id:e.id,spaceId:e.space_id};null!==(r=e.format)&&void 0!==r&&r.app_config_uri&&null!==(a=t.format)&&void 0!==a&&a.app_config_uri&&((0,I.iA)(e.format.app_config_uri)?t.format.app_config_uri=void 0:o[e.id]=t.id);const m=null===(s=t.format)||void 0===s?void 0:s.collection_pointer;if(m){const e=null==i?void 0:i.getModel(m);if(!Boolean(null==e?void 0:e.isSyncedCollection())){const e=n({requested:m,requester:u})||m;t.format={...t.format,collection_pointer:e}}}if(t.format){var f;const e=null===(f=t.format.collection_groups)||void 0===f?void 0:f.map((e=>{if("relation"===e.value.type&&(0,p.RA)(e.value.value)&&e.value.value){return{...e,value:{type:"relation",value:n({requested:e.value.value,requester:u})}}}return e}));if(t.format.collection_groups=e,void 0!==t.format.collection_view_default_template&&"empty"!==t.format.collection_view_default_template){const e=n({requested:{table:S.iU,id:t.format.collection_view_default_template.template_page_id},requester:u});e&&(t.format.collection_view_default_template={template_page_id:e.id})}}const g=n({requested:{table:t.parent_table,id:t.parent_id,spaceId:t.space_id},requester:u});g&&(t.parent_id=g.id);t.page_sort&&(t.page_sort=t.page_sort.map((e=>{var o;return(null===(o=n({requested:{table:S.iU,id:e,spaceId:t.space_id},requester:u}))||void 0===o?void 0:o.id)||e})));if("page"===t.type&&null!==(l=t.format)&&void 0!==l&&l.page_pointer){var h;const e=t.format.page_pointer,o=(null===(h=n({requested:O.dr.fromPointerLike({table:"block",id:e.id,spaceId:t.space_id}),requester:u}))||void 0===h?void 0:h.id)||e.id;t.format.page_pointer={table:"block",id:o,spaceId:t.space_id}}if(null!==(c=t.format)&&void 0!==c&&c.property_filters){const e=t.format.property_filters;for(const t of e)t.filter&&X(t.filter,(e=>{var t;return null===(t=n({requested:e,requester:u}))||void 0===t?void 0:t.id}))}if(null!==(d=t.format)&&void 0!==d&&d.filters2){const e=t.format.filters2;for(const t of e)t.filter&&X(t.filter,(e=>{var t;return null===(t=n({requested:e,requester:u}))||void 0===t?void 0:t.id}))}const v=t.query2;v&&v.filter&&X(v.filter,(e=>{var t;return null===(t=n({requested:e,requester:u}))||void 0===t?void 0:t.id}))}(n,B,l,T,v)}else t===j.qF?function(e,t,n,o){const i={table:j.qF,id:e.id,spaceId:e.space_id},r=n({requested:{table:t.parent_table,id:t.parent_id,spaceId:t.space_id},requester:i});r&&(t.parent_id=r.id);t.comments&&(t.comments=t.comments.map((e=>{var o;return(null===(o=n({requested:{table:L.x_,id:e,spaceId:t.space_id},requester:i}))||void 0===o?void 0:o.id)||e})));if("default"===t.type&&t.context)t.context=ne({...o,text:{value:t.context,spaceId:t.space_id},mapper:n,requester:i,resolveTemplateVariables:!1});else if("suggestion"===t.type)throw new Error("Not implemented")}(n,B,l,u):t===L.x_?function(e,t,n,o){const i={table:L.x_,id:e.id,spaceId:e.space_id},r=n({requested:O.dr.fromPointerLike({table:t.parent_table,id:t.parent_id,spaceId:t.space_id}),requester:i});r&&(t.parent_id=r.id);t.text&&(t.text=ne({...o,text:{value:t.text,spaceId:t.space_id},mapper:n,requester:i,resolveTemplateVariables:!1}));if(t.content)for(const[s,l]of t.content.entries()){var a;const e=(null===(a=n({requested:O.dr.fromPointerLike({table:S.iU,id:l,spaceId:t.space_id}),requester:i}))||void 0===a?void 0:a.id)??l;t.content[s]=e}}(n,B,l,u):t===N.yo?function(e,t,n,o){const i={table:N.yo,id:e.id,spaceId:e.space_id},r=n({requested:O.dr.fromPointerLike({table:t.parent_table,id:t.parent_id,spaceId:t.space_id}),requester:i});r&&(t.parent_id=r.id)}(n,B,l):t===y.cv?ee({originalRecord:n,duplicateRecord:B,mapper:l,options:c??{},actor:f}):t===_.Xj?te({originalRecord:n,duplicateRecord:B,mapper:l,getRecordRole:x,options:c??{},originOptions:u}):t===q.AT?function(e){let{original:t,duplicate:n,mapper:o,originOptions:i}=e;const r={table:q.AT,id:t.id,spaceId:t.space_id},a=o({requested:O.dr.fromPointerLike({table:n.parent_table,id:n.parent_id,spaceId:n.space_id}),requester:r});a&&(n.parent_id=a.id)}({original:n,duplicate:B,mapper:l,originOptions:u}):(0,a.t1)(t);return{duplicateRecord:B,additionalRecords:W}}function X(e,t){if(u.vA(e)){(e.filters||[]).forEach((e=>X(e,t)))}if(u.aN(e)){if(u.e(e.filter)){const n=e.filter;if("relation_contains"===n.operator||"relation_does_not_contain"===n.operator)if(Array.isArray(n.value)){const e=n.value.map((e=>{const n=e.type;if("exact"===n){const n=e.value;return{type:"exact",value:n&&t({table:S.iU,id:n})||n}}if("relative"===n)return e;(0,a.t1)(n)}));n.value=e}else{const e=n.value.type;if("exact"===e){const e=n.value.value;n.value.value=e&&t({table:S.iU,id:e})||e}else{if("relative"===e)return;(0,a.t1)(e)}}}if(u.a_(e.filter)){const n=e.filter.subfilter;if(u.e(n)){const e=n;if("relation_contains"===e.operator||"relation_does_not_contain"===e.operator)if(Array.isArray(e.value)){const n=e.value.map((e=>{const n=e.type;if("exact"===n){const n=e.value;return{type:"exact",value:n&&t({table:S.iU,id:n})||n}}if("relative"===n)return e;(0,a.t1)(n)}));e.value=n}else{const n=e.value.type;if("exact"===n){const n=e.value.value;e.value.value=n&&t({table:S.iU,id:n})||n}else{if("relative"===n)return;(0,a.t1)(n)}}}}}}function ee(e){var t;const{originalRecord:n,duplicateRecord:o,mapper:i,options:r,actor:s}=e,c=O.dr.fromSpaceShardRecordId({id:n.id,spaceId:n.space_id},y.cv),d=(null===(t=i({requested:O.dr.fromPointerLike({table:o.parent_table,id:o.parent_id,spaceId:o.space_id}),requester:c}))||void 0===t?void 0:t.id)??o.parent_id;o.parent_id=d;const u=(o.action_ids??[]).map((e=>{var t;return(null===(t=i({requested:O.dr.fromPointerLike({table:_.Xj,id:e,spaceId:o.space_id}),requester:c}))||void 0===t?void 0:t.id)??e}));o.action_ids=u;const p=Date.now();o.created_time=p,o.last_edited_time=p,(0,a.$K)(s)&&(o.created_by_id=s.id,o.created_by_table=s.table,o.last_edited_by_id=s.id,o.last_edited_by_table=s.table),(0,l.Q9)(o)&&r.shouldDisableRecurrenceAutomation&&(o.status="disabled"),(0,l.Vd)(o)&&function(e){var t;const{duplicateRecord:n,mapper:o,originalRecord:i}=e,r={id:i.id,spaceId:i.space_id,table:y.cv},s={sourceAutomationParentId:i.parent_id,sourceAutomationId:i.id,sourceAutomationName:(null===(t=i.properties)||void 0===t?void 0:t.name)??""},l=n.trigger.event.source;if((0,a.$K)(l))if("collection"===l.type){const e=o({requested:l.pointer,requester:r});e?e.table!==V.vF?(T.log({data:{miscDataToConvertToString:{...s,duplicateAutomationTriggerTable:e.table}},from:"duplicateHelpers.duplicateAutomationEventValueHelper",level:"info",type:"duplicateAutomationIncorrectTriggerTableCollection"}),n.trigger.event.source=void 0,n.status="disabled"):(0,a.$K)(e.spaceId)&&e.spaceId===n.space_id?l.pointer={...e,spaceId:n.space_id}:(T.log({data:{miscDataToConvertToString:{...s,duplicateAutomationTriggerSpaceId:e.spaceId,sourceAutomationSpaceId:n.space_id}},from:"duplicateHelpers.duplicateAutomationEventValueHelper",level:"info",type:"duplicateAutomationMissingTriggerCollectionSpaceId"}),n.trigger.event.source=void 0,n.status="disabled"):(T.log({data:{miscDataToConvertToString:{...s,sourceAutomationTriggerSourceId:l.pointer.id}},from:"duplicateHelpers.duplicateAutomationEventValueHelper",level:"info",type:"duplicateAutomationMissingTriggerCollectionSource"}),n.trigger.event.source=void 0,n.status="disabled")}else if("collection_view"===l.type){const e=o({requested:l.pointer,requester:r});e?e.table!==U.np?(T.log({data:{miscDataToConvertToString:{...s,duplicateAutomationTriggerTable:e.table}},from:"duplicateHelpers.duplicateAutomationEventValueHelper",level:"info",type:"duplicateAutomationIncorrectTriggerCollectionViewTable"}),n.trigger.event.source=void 0,n.status="disabled"):(0,a.$K)(e.spaceId)&&e.spaceId===n.space_id?l.pointer={...e,spaceId:n.space_id}:(T.log({data:{miscDataToConvertToString:{...s,duplicateAutomationTriggerSpaceId:e.spaceId,sourceAutomationSpaceId:n.space_id}},from:"duplicateHelpers.duplicateAutomationEventValueHelper",level:"info",type:"duplicateAutomationMissingTriggerCollectionSpaceId"}),n.trigger.event.source=void 0,n.status="disabled"):(T.log({data:{miscDataToConvertToString:{...s,sourceAutomationTriggerSourceId:l.pointer.id}},from:"duplicateHelpers.duplicateAutomationEventValueHelper",level:"info",type:"duplicateAutomationMissingTriggerCollectionView"}),n.trigger.event.source=void 0,n.status="disabled")}else"filter"===l.type||(0,a.t1)(l);else T.log({data:{miscDataToConvertToString:s},from:"duplicateHelpers.duplicateAutomationEventValueHelper",level:"info",type:"duplicateAutomationMissingTriggerSource"}),n.status="disabled"}({duplicateRecord:o,mapper:i,originalRecord:n})}function te(e){const{originalRecord:t,duplicateRecord:n,mapper:o,getRecordRole:i,options:r,originOptions:s}=e,l=t.space_id!==n.space_id,d={table:_.Xj,id:t.id,spaceId:t.space_id},u=o({requested:O.dr.fromPointerLike({table:n.parent_table,id:n.parent_id,spaceId:n.space_id}),requester:d});let p=i;!function(e){const{automationAction:t,mapper:n,options:o}=e;if(!t.config)return;const i=(e,t)=>({spaceId:t.spaceId,...n({id:t.id,table:t.table,spaceId:t.spaceId}),table:e});if("create_page"===t.type){if(t.config.collection&&(t.config.collection=i(V.vF,t.config.collection)),t.config.template_page_id){(null==o?void 0:o.isTemplateInstantiation)&&o.sourceBlockIds.has(t.config.template_page_id)||(t.config.template_page_id=i(S.iU,{id:t.config.template_page_id,table:S.iU,spaceId:t.space_id}).id)}}else if("query_collection"===t.type)t.config.collection&&(t.config.collection=i(V.vF,t.config.collection));else if("update_pages"===t.type){const e=t.config.target;e&&("collection"===e.type?(e.collection=i(V.vF,e.collection),e.filter&&X(e.filter,(e=>{var t;return null===(t=n(e))||void 0===t?void 0:t.id}))):"variable"===e.type||("page"===e.type?e.page=i(S.iU,e.page):(0,a.t1)(e)))}else if("open_page"===t.type){const e=t.config.target;e&&("page"===e.type?e.page=i(S.iU,e.page):"variable"===e.type||(0,a.t1)(e))}else if("complete_sprint"===t.type){const e=t.config.sprint_collection,n=t.config.task_collection;t.config.sprint_collection=i(V.vF,e),t.config.task_collection=i(V.vF,n)}else"duplicate_blocks"===t.type||"modal_confirmation"===t.type||"slack_notification"===t.type||"assistant"===t.type||"send_in_app_notification"===t.type||(0,a.t1)(t)}({automationAction:n,mapper:e=>{const t=o({requester:d,requested:e});return t?(p=B.DH.tryUntilFound(B.DH.constantForPointer(t,"editor"),p),t):l?(p=B.DH.tryUntilFound(B.DH.constantForPointer(e,"none"),p),e):e},options:r.resolveAutomationConfig}),function(e){const{automationAction:t,requester:n,mapper:o,originOptions:i}=e,r=(0,c.z)(t.type);function s(e){const i=(0,C.MY)(e);if("action"===i.source){var r;const e=(null===(r=o({requester:n,requested:{id:i.action_id,table:_.Xj,spaceId:t.space_id}}))||void 0===r?void 0:r.id)??i.action_id;return(0,C.Kd)({...i,action_id:e})}if("global"===i.source)return e;(0,a.t1)(i)}const l=b.kk.fromValue(_.Xj,t),d=r.acceptFormulaVisitor({action:l,visitor:{visitFormula:e=>{const r=(0,x.Zw)(e,s);let a;return a=r.value?{...r,value:ne({...i,text:{value:r.value,spaceId:t.space_id},mapper:o,requester:n,resolveTemplateVariables:!1})}:r,{type:"replace",value:a}},visitVariableOutsideOfFormula:e=>({type:"replace",value:s(e)})}}),u=F.Ak.create();u.setValue(l.pointer,t),(0,A.FS)({recordMap:u,operations:d,updateOnly:!1});const p=u.getModel(l.pointer);if(!p)throw new Error("Updated automation action not found in record map");t.config=p.getConfig()}({automationAction:n,mapper:o,requester:d,originOptions:s});const m=(null==u?void 0:u.id)??n.parent_id;n.parent_id=m,l&&"slack_notification"===n.type&&(n.config={});const g=(0,f.o0)(n);if(g){g.some((e=>{const t=p(e.pointer);return!t||!(0,D.yY)(t,e.minimumRequiredRole)}))&&(n.config={})}const h=(n.blocks??[]).map((e=>{var t;return null===(t=o({requested:O.dr.fromPointerLike({table:S.iU,id:e,spaceId:n.space_id}),requester:d}))||void 0===t?void 0:t.id})).filter(a.$K);n.blocks=h.length>0?h:void 0}function ne(e){const{text:t,mapper:n,requester:o,resolveTemplateVariables:i,baseUrl:r,publicDomainName:s}=e;if(void 0!==t)return t.value.map((e=>function(e){const{token:t,mapper:n,requester:o,resolveTemplateVariables:i,baseUrl:r,publicDomainName:s}=e,l=w.hDy(t.token);let c;const d=l.map((e=>{if(w.STW(e)){const t=w.yrl(e);if(t){const e=n({requested:t,requester:o});if(e)return w.$0A(e.id,e.spaceId)}}if(w.j0F(e)){const t=w.zW$(e),i=(0,P.A5)({url:t,baseUrl:r,publicDomainName:s});if(i){const e=n({requested:{table:S.iU,id:i,spaceId:(0,z.C)(void 0)},requester:o});if(e)return w.edl((0,P.nR)({pageId:e.id}))}}if(w.nSN(e)){const t=w.frW(e);if(t){const e=n({requested:{table:S.iU,id:t,spaceId:(0,z.C)(void 0)},requester:o});if(e)return w.x36(e.id)}}if(w.xw5(e)){const i=w.h19(e),r=n({requested:{table:j.qF,id:i,spaceId:t.spaceId},requester:o});if(r)return w.jw(r.id)}if(w.aq(e)&&i){const t=w.x5L(e,i);if(t&&w.IWo(t)&&i){const e=w.zEN(t);if(e===i.currentUserId){if(c)return;c=e}}return t}if(w.IWo(e)&&i){const t=w.zEN(e);if(t===i.currentUserId){if(c)return;c=t}}return e})).filter(a.$K);return w.V3y(w.WiV(t.token),d)}({token:{token:e,spaceId:t.spaceId},mapper:n,requester:o,resolveTemplateVariables:i,baseUrl:r,publicDomainName:s})))}function oe(e){const{rootSourceBlockIds:t,childSourcePointer:n,getSourceRecordValue:o}=e;for(const i of(0,R.BW)(n,o))if(ie({rootSourceBlockIds:t,recordWithTable:i}))return!0;return!1}function ie(e){const{recordWithTable:t,rootSourceBlockIds:n}=e;if(t.table!==S.iU)return t.table===_.Xj;if(n.includes(t.value.id))return!1;if(b.kk.fromBlock(t.value).isTemplateVariableContainerBlock())return!0}},40654:(e,t,n)=>{n.d(t,{A_:()=>r,XW:()=>l,lO:()=>s,to:()=>a,x_:()=>i});var o=n(53965);const i=.5,r=4.9,a=.1,s=1;function l(e){switch(o.uZ(o.NM(e,1),i,r)){case i:return 155;case.6:return 128;case.7:return 108;case.8:return 94;case.9:return 83;default:return 75}}},5220:(e,t,n)=>{n.d(t,{RI:()=>r});var o=n(59730),i=n(47425);function r(e){const t=function(e){const{space:t,spaceUser:n}=e;if(void 0===t||null==n||!n.isWorkspaceOwner())return new o.XV("You do not have permissions to this feature in the requested space.",{type:"generic_insufficient_permissions"});return a(t)}(e);return void 0===t}function a(e){if(!(0,i.wP)(e.getSubscriptionTier()))return new o.XV("The feature is not available on your current plan type.",{type:"generic_insufficient_plan_type"})}},55632:(e,t,n)=>{n.d(t,{HX:()=>v,fK:()=>h,$A:()=>g,Jq:()=>b,j2:()=>p,Pv:()=>y,j:()=>_});var o=n(53965),i=n(52629),r=n(7032),a=n(18265),s=n(15145),l=n(74686);var c=n(68626);const d=new s.nY((async e=>{const{config:t,deviceId:o,disableCookies:i}=e,l=await n.e(9543).then(n.t.bind(n,16791,23));return await new Promise((e=>{const n=t.amplitude&&t.amplitude.apiKey;if(!n)return e(void 0);const c=new URL(t.domainBaseUrl),d=`${c.host}${t.api.http}/teV1`;let u,p=!0;"http:"===c.protocol&&(p=!1),o&&(u=o.startsWith("w_")||o.startsWith("a_")?o.replaceAll("-",""):(0,r.XR)(o));const m=u,f="development"===t.env?50:1e3;l.getInstance("eventTrailApi").init(n,"",{apiEndpoint:d,forceHttps:p,includeReferrer:!0,includeUtm:!0,includeFbclid:!0,includeGclid:!0,unsetParamsReferrerOnNewSession:!1,saveParamsReferrerOncePerSession:!1,storage:i?"none":"",saveEvents:!i,savedMaxCount:f,deviceId:m},(n=>{n&&n.setVersionName((t.env,"2023092001")),e(n),function(){const e=(0,a.gy)(window.location.href);if(!e)return;const t={utm_campaign:e.searchParams.get("utm_campaign")||s.cL,utm_content:e.searchParams.get("utm_content")||s.cL,utm_medium:e.searchParams.get("utm_medium")||s.cL,utm_source:e.searchParams.get("utm_source")||s.cL,utm_term:e.searchParams.get("utm_term")||s.cL};h({traits:(0,s.bt)({...t})})}()}))}))}));function u(e,t,n){return function(r,a,s){if(200===r&&"success"===a)return;const l=o.CE(t,"experiments"),d={data:{responseBody:a,eventName:e,eventData:l,groupData:n},statusCode:r,message:null==s?void 0:s.reason};c.log({level:"error",from:"eventTrailApiHelpers",type:"trackFailure",error:(0,i.Ui)(d)})}}async function p(e){const{config:t,isEnabled:n,deviceId:o,cookieService:r}=e,a=!(await l.ec({service:"amplitude",cookieService:r}));try{await d.load({config:t,isEnabled:n,deviceId:o,disableCookies:a})}catch(s){c.log({level:"error",from:"eventTrailApiHelpers",type:"initialize",error:(0,i.Ui)(s)})}}function m(e,t){const n=new e.Identify;if(t)for(const o of Object.keys(t)){const e=t[o];void 0!==e&&(Array.isArray(e)?n.append(o,e):n.set(o,e))}return n}function f(e,t,n){const o=t.userPropertiesOperations||{};n.logEvent(e,o,void 0,u(e,o))}async function g(e){const{userId:t,traits:n,spaceIds:i}=e,a=await d.getInstance();if(!a)return;a.setUserId((0,r.XR)(t));const s=m(a,n);i&&s.set("workspace",o.jj(i)),f("$identify_user",s,a)}async function h(e){const{traits:t}=e,n=await d.getInstance();if(!n)return;const o=new n.Identify;for(const i of t)"set"===i.operation?o.set(i.name,i.value):"setOnce"===i.operation&&o.setOnce(i.name,i.value);f("$identify_device",o,n)}async function v(){const e=await d.getInstance();null==e||e.setUserId(null)}async function b(e){const{spaceId:t,spaceData:n}=e;if(!t)return;const i=await d.getInstance();if(!i)return;const r=o.d9(n),a=Object.entries(r).filter((e=>{let[t,n]=e;return Array.isArray(n)}));a.forEach((e=>{let[t,n]=e;return delete r[t]}));var s=m(i,r);a.forEach((e=>{let[t,n]=e;return s=s.set(t,n)})),i.groupIdentify("workspace",t,s)}async function y(e){const t=await d.getInstance();t&&t.setDeviceId((0,r.XR)(e))}async function _(e){const{eventName:t,eventData:n,spaceId:o}=e,i=await d.getInstance();if(i)if(o){const e={workspace:o};i.logEventWithGroups(t,n,e,void 0,u(t,n,e))}else i.logEvent(t,n,void 0,u(t,n))}},12174:(e,t,n)=>{n.d(t,{DP:()=>_,KM:()=>h,LI:()=>x,TS:()=>S,XY:()=>k,YY:()=>M,_n:()=>P,b2:()=>I,dn:()=>C,eo:()=>f,g6:()=>i,l4:()=>w,mr:()=>s,nb:()=>A,rn:()=>g});n(21703);var o=n(1898);const i={"search-vectors":["log-norm","min-max-norm","cohere-snippets"],"search-no-local-blending":["on"],"search-debug-only-no-recent-boosting":["on"],"search-shorten-inactive-timer":["0","10","30","60","90"],"search-debug-only-force-random-sample":["on"],"search-debug-force-log-signals":["on"],"search-more-recent-pages-in-local":["lazy-100","lazy-200","lazy-500","lazy-1000"],"search-intent-based-grouping-n-side-peek":["on"],"search-results-new-utilities":["on"],"search-new-local-recall-v2":["v1","v2","v3","v4"],"search-query-expansion":["prefix-completion","word-splitting","spell-correction","all"],"search-debug-force-no-rerank":["on","always-rerank"],"search-rerank-new-recall":["on"],"dev-search-rerank-new-recall":["v1","v2"],"vector-naive-ranker":["on"],"search-mention-model-feature-logging":["on"],"search-people-mentions-higher-fuzzy-results":["on"],"search-mentions-models":["v1","v2"],"search-no-neg-boost-relation-search":["on"],"search-negative-boost-only-quickfind":["on"],"search-negative-boost-tuning":["0.01","0.1","0.25","0.5"]},r={teams_invite_link:["on"],team_invite_link_ms2:["on"],expandable_permission_items:["on"]},a={request_edit_access:["on"],move_inbox_top_right:["on"],move_settings_and_members:["copy_only","move","move_with_copy"],sidebar_home_multiplayer_ga:["home","home_with_default"],page_access_followups:["one_click_edit","select_access_level"],grant_access_via_mentions:["on"]},s=["page_grouping","internal_prototype_peek","internal_prototype_time_grouping","internal_comment_page_time_grouping","form_factor_only_experiment"],l={simplified_email_subject_line:["on"],improved_product_notif_email_and_settings:["on"],mobile_push_notification_reply_action:["on"],inbox_2_0:s,inbox_peek_and_panel_v2:["on"],access_request_email_digest:["on"],access_request_email_reminder:["on"]},c={search_modal_suggested_templates:["on"],simplified_getting_started:["on"],acquisition_global_holdout_aa_testing:["on"],acq_simplify_enterprise_joiner_onboarding_flow_v1:["on"],page_invite_message:["control","variant_1","variant_2"],invitation_email_final_reminder:["on"],share_modal_placeholder:["on"],share_modal_pending_invite_status_ui:["on"],invitation_modal_guest_vs_member_tag:["on"],share_modal_guest_member_confirmation:["v1","v2"],page_invitation_email_selfserve_exp:["v1","v2","v3","v4"],space_invitation_email_selfserve_exp:["v1","v2","v3","v4"],share_modal_autofill_email:["control","v1"],humanize_page_invite_joiner_email_copy:["on"],acq_person_property_invite_v1:["on"],acq_slack_imports_invite_v1:["on"],blue_signup_buttons:["on"],space_setting_people_search_bar_expand:["on"],onboarding_language_picker:["on"],acq_simplify_joiner_onboarding_flow_v1:["on"],read_persona_survey_data_from_space:["on"],signup_revamp:["on"],post_signup_onboarding_revamp:["on"],internal_domain_guests_in_settings:["on"]},d={in_app_contact_sales_cta_billing:["on"]},u={ai_annual_default:["on"],block_limit_cta_earlier:["25"],block_limit_increase:["on"],block_limit_reduction:["on"],checkout_name_required:["on"],checkout_refresh:["on"],churn_nudge:["on"],hide_block_limit_counter:["on"],largesse:["on"],plans_page_refresh:["on"],prices_test_country:["US","DE","GB"],mobile_web_subscriptions:["on"],quick_workspace_creation:["on"],subscription_payment_status:["message_only","on"],subscription_default_annual:["on"],subscription_elements:["payment_and_address","payment"],upsell_colors:["on"],upsell_to_plans_page:["on"],guest_limit_policy:["on"]},p={csv_adaptiveschema:["on"],csv_column_limit:["on"]},m={duplication_workspace_selection_modal3:["on"],show_student_org_sitebar_prompt:["on_default","on_blue"]},f=["move","copy_only","move_with_copy","control"],g=["control","one_click_edit","select_access_level"],h=["beta","alpha","development","exploratory","wild_west"],v={assistant_variant:h},b={ai_qna_alternative_embeddings:["cohere"],sqlite_vector_search:["dark_read","enabled"],qna_abandoned_search_reminders:["on"],qna_show_assistant_origin_input:["on"],qna_show_large_reminders:["on"],qna_show_page_suggested_questions:["on"],qna_vectorless_enabled:["last_edited_200_pages","simulated_200_pages"],show_space_qna_suggested_questions:["on"]},y={"indexeddb-transaction-timeout-v2":["on"],"product-page-length":["no-demo","short-scroll","shortest-scroll"],"remove-profile-photo-string":["on"],"template-checklist":["on"],mermaid:["on"],polyglot:["on"],rc:["on"],"ios-json-bridge-v2":["on"],"clear-record-cache-on-login":["on"],"await-update-user-id":["on"],aloha:["on"],"embed-previews":["on"],"beta-developers-external":["on"],"db-sync":["on"],janus:["on"],"mobile-drag-delay":["1000","600","700","800","900","1100","1200","1300","1400","1500"],"android-context-menu":["on"],"mobile-bottom-bar-ios-v4":["on"],"lucy-in-the-sky-with-tab-blocks":["on"],"messagestore-ios-v3":["on"],"home-ios":["on"],"home-ipad":["on"],"home-android":["on"],"txnqueue-ios-v6":["on"],"onboarding-emails":["generic","meeting-notes-focused"],patchExternalCollection:["on"],"emoji-apple-spritesheets":["enabled"],"default-new-page-property-to-hide-when-empty":["on"],"android-background-bridge-message-parsing":["on"],"columns-full-width":["on"],"notion-to-slack":["on"],"notion-mentions-to-slack":["on"],slash_menu_spaces_preceding:["on"],geo_ip_lookup_database:["on"],database_sync_for_google_calendar:["on"],database_sync_for_gitlab:["on"],database_sync_for_asana:["on"],enforce_enterprise_tier_for_scim:["on"],...i,...r,...a,...l,...c,...d,...u,...m,...p,"newer-primus":["on"],sort_indexeddb_tasks_by_index:["on"],marketing_home_page_hero_signup:["test","focus","work"],marketing_home_hero_text:["V1","V2","V3"],above_the_fold_product:["V1","V2","V3","V4"],marketing_contact_3_new_fields:["test"],template_gallery_web:["on"],invite_members_from_share_menu:["on"],statsig_space_id_debug:["on"],enforce_write_once_permissions_for_block_updates:["on"],"contextual-invite-on-select-focus":["on"],zendesk:["on"],collection_client_refetch_throttle_time_ms:["2000","3000","5000"],highlight_legacy_transclusions:["on"],lightbox_v2:["on"],user_similarity_debugging:["on"],log_iframely_results:["on"],iframely_switch:["on"],prompt_work_account_sidebar:["on"],request_membership:["on"],parallel_confluence_importer:["on"],parallel_confluence_importer_via_api:["on"],special_case_confluence_file_size:["on"],special_case_pdf_file_size:["on"],export_bounded_promise:["on"],confluence_dynamic_batch_size_temp:["on"],confluence_server_allow_requests:["on"],confluence_logs:["on"],confluence_api_v2:["on"],confluence_search_api:["on"],send_notification_for_transfer_content:["on"],box_file_picker:["on"],gdrive_embed_option_placement:["below"],guest_membership_request:["on"],link_preview_resizing:["on"],link_preview_resizing_api:["on"],google_external_integration_file_picker:["on"],enable_google_drive_external_integration:["on"],my_home:["on"],show_instruction_on_auth_popup_blocked:["on"],teamspace_guests:["on"],asana_max_task_limit:["on"],monday_importer:["on"],pdf_importer:["on"],migrate_confluence_into_teamspace:["on"],generic_importer:["on"],slash_command_import:["on"],special_case_generic_file_size:["on"],asana_to_single_team_space:["on"],state_manangement_in_asana_importer:["on"],android_3rd_party_login_with_external_browser:["on"],ios_3rd_party_login_with_external_browser:["on"],block_limit_delay:["on"],asana_import_by_batch:["on"],intro_share_tooltip_condition:["d3","b200"],ignore_non_renderable_blocks_in_export:["on"],prioritize_slash_menu_block_placeholder:["on"],joiner_subject_line_v2:["variant_1","variant_2","variant_3"],joiner_email_facepile:["on"],slash_menu_tooltip:["on"],redirect_after_passcode_sent:["with_gmail_cta","without_gmail_cta"],wiki_education_convert_modal:["bottom_right"],avoid_empty_eoip_creation_unfurl_collection:["on"],jira_import_and_sync:["on"],block_property_item_indexing:["incremental","backfill"],block_property_item_query_prefilter:["on"],use_global_local_search_cache:["on"],...v,...b,safari_17_transaction_queue:["force_in_memory","prefer_indexed_db"],indexeddb_graceful_fallback_to_in_memory_queue:["on"],ai_writer_autofill_gpt_4:["on"],allow_auth_with_app_browser_for_mobile:["on"],browser_sqlite:["on"],property_creation_tooltips_exp:["on"],monetizationExperiments:["on"],collection_querying:["sqlite","duckdb","eav"],collection_split_aggregation_v3:["on"],horizon_1_new_page_experience:["variant_a","variant_b"],horizon_1_quick_templates:["variant_a","variant_b"],mobile_horizon1_quick_capture:["on"],social_media_preview_image_uploader_enabled_2:["on"]};function _(e){return Boolean(y[e])}const S=new Set([]),w=["log_iframely_results","iframely_switch","database_sync_for_google_calendar","database_sync_for_gitlab","database_sync_for_asana","enforce_enterprise_tier_for_scim","slash_menu_spaces_preceding","geo_ip_lookup_database","sort_indexeddb_tasks_by_index","marketing_contact_3_new_fields","marketing_home_page_hero_signup","marketing_home_hero_text","above_the_fold_product","invite_members_from_share_menu","contextual-invite-on-select-focus","enforce_write_once_permissions_for_block_updates",...(0,o.Yd)(r),...(0,o.Yd)(a),"zendesk","highlight_legacy_transclusions","lightbox_v2","prompt_work_account_sidebar","request_membership","special_case_confluence_file_size","export_bounded_promise","special_case_pdf_file_size","special_case_generic_file_size","confluence_dynamic_batch_size_temp","confluence_server_allow_requests","confluence_logs","user_similarity_debugging","send_notification_for_transfer_content","box_file_picker","google_external_integration_file_picker","gdrive_embed_option_placement","guest_membership_request","link_preview_resizing","link_preview_resizing_api","enable_google_drive_external_integration","show_instruction_on_auth_popup_blocked","parallel_confluence_importer","parallel_confluence_importer_via_api","confluence_api_v2","confluence_search_api",...(0,o.Yd)(i),...(0,o.Yd)(c),...(0,o.Yd)(d),...(0,o.Yd)(u),...(0,o.Yd)(m),...(0,o.Yd)(p),"teamspace_guests","asana_max_task_limit","monday_importer","pdf_importer","migrate_confluence_into_teamspace","generic_importer","slash_command_import","asana_to_single_team_space","state_manangement_in_asana_importer",...(0,o.Yd)(l),"android_3rd_party_login_with_external_browser","ios_3rd_party_login_with_external_browser","collection_client_refetch_throttle_time_ms","block_limit_delay","asana_import_by_batch","intro_share_tooltip_condition","ignore_non_renderable_blocks_in_export","prioritize_slash_menu_block_placeholder","joiner_subject_line_v2","joiner_email_facepile","slash_menu_tooltip","redirect_after_passcode_sent","wiki_education_convert_modal","avoid_empty_eoip_creation_unfurl_collection","jira_import_and_sync","block_property_item_indexing","block_property_item_query_prefilter","use_global_local_search_cache",...(0,o.Yd)(v),...(0,o.Yd)(b),"safari_17_transaction_queue","indexeddb_graceful_fallback_to_in_memory_queue","ai_writer_autofill_gpt_4","allow_auth_with_app_browser_for_mobile","browser_sqlite","property_creation_tooltips_exp","collection_querying","collection_split_aggregation_v3","horizon_1_new_page_experience","horizon_1_quick_templates","mobile_horizon1_quick_capture","social_media_preview_image_uploader_enabled_2"],k=[...w].sort(),I=["polyglot","enforce_write_once_permissions_for_space_updates","person_vote","allow_dead_space_views_when_joining_space","throw_on_changing_unmanaged_scim_user","log_all_headers_for_unknown_scim_idp","enable_get_private_page_info_endpoint","log_saml_response_on_error","wiki_query_killswitch","fwd_wiki_to_collection_svc","debug_analytics","never_select_title_on_select_all","connected_relation","enable_search_team_filter","block_menu_shortcut_fix","expiring_public_links","display_date_in_user_timezone","text_selection_completions","new_page_completions","completions_chat","triage_notification_can_read","admin_content_search_tab","japan_full_launch","event_trail_router_v2","ai_waitlist_in_app_popup","public_api_dev_mode","optimize_single_workspace","enabled_bev_default_audience_filter","sprig","ai_multi_level_undo","ai_favorites","autoretry_file_uploads","enable_secure_file_url_for_user","lock_on_scim_patch_group","prevent_saml_guest_login","developer_integration_form_redesign","log_on_save_transactions","return_scim_errors_to_client","use_secure_file_url_for_audit_log","use_secure_file_url_for_space_export","use_secure_file_url_for_block_export","return_404_on_scim_get_for_user_not_in_workspace","client-performance-profiler","react_18_concurrent_rendering","customerio","dev_only_show_updates_filters","property_updates_notifications","enable_notifications_processor","sidebar_pages_hide_toggles","prefetch_spaces","home_allow_change_home_enabled_flag_killswitch_v2","sidebar_home_default_landing_gate","sidebar_home_dev_gate","sidebar_home_beta_gate","sidebar_home_ga_gate","home_welcome_animation","home_template_icons","home_cover_photo","home_singleplayer_tiles","show_home_favorites_tile","team_add_app_template_tooltip","new_share_menu_tooltip","optimize_fetch_user_content_emit","enable_sidebar_reorder","new_user_sidebar_default","truncate_private","space_settings_people_section","tips_inapp_modal","slack_bot_connection_message_revamp","onboarding_language_picker_feature_gate","allow_public_page_access_request","signup_revamp_v1","upwork_signup_flow","signup_revamp_brand_campaign","onboarding_brand_campaign_revamp","signup_revamp_help_message_support","feature_settings","relation_menu_refactor","page_layouts","collections_relation_picker_require_edit_perms","typed_db_creation","formulas_dark_read","typed_db_migration","contact_sales_marketo_migration","collections_bulk_relation_sync_queue_enabled","collection_subitem_nested_operations","collections_shorten_url","use_collection_reducer_request_hook","collection_subitem_new_show_hide_options","collection_groups_functional","charts_mvp","better_database_text_sorts","home_compact_view","collections_calendar_toggle_weekends","collections_compact_view","webhooks_beta","public_api_developer_survey","e_discovery","add_comments_on_blocks","install_dlp_integrations","public_api_use_secure_file_proxy","webhooks_enable_nightfall","inactive_webhook_subscription_ui","advanced_security_in_enterprise","ai_annual","android_native_blocks","can_remove_plan_without_removing_addon","currency_gbp","deny_multiplayer_personal_plan_upgrade","enable_midterm_subscription_changes","estudiantes","new_contact_sales_modal","plans_page_refresh_m_1_5","sepa_debit","test_clocks","tt_affiliates","tt_marketing","tt_upwork","upgrade_modal_ai_option","use_mp2_update_subscription_path","enable_localized_templates","template_submission_backend_v2","creator_platform_contentful_sync_m1","creator_platform_contentful_sync_m2","submit_template_flowdash","submit_template_contentful","use_duplicate_template_block_as_promise","csv_schema_typed_merge","csv_validation_errors_fix","csv_relation_support","csv_twoway_relation_support","card_details_unified","trello_pagination_enabled","trello_media_queue","zip_importer_enabled","enable_default_create_crdt_page","enable_text_crdt_client","enable_text_crdt_server","show_crdt_warnings","suppress_crdt_banner","automation_action_notification","sites_multiple_domains_server","sites_public_domain_double_write","sites_public_domain_dark_read","sites_domain_validation_allow_custom_hostname","sites_domains_settings_section","sites_create_multiple_domains","use_public_domains","cron_connected_relation","notion_calendar","notion_calendar_launch_modal","calendar_home_tile","block_attribution","workspace_consolidation_checkpoint","desktop_app_login_with_email_redirect","ai_property_autofill_v2","desktop_app_signup_hide_passcode","ios_app_signup_hide_passcode","better_asana_import_task_dependency","user_data_consent_admin_bypass","goodbye_credits","link_preview_auth_with_server_integration","formula_buttons","ai_onboarding_logging","enable_deleted_page_indicator","forethought","defer_remote_version_update_for_pending_tx","survey_data_writes","enable_refetch_eoi_blocks_on_retry","adding_extra_logs_in_eoi_retry_fg","snapshot_optional_collection_rollback_enabled","prevent_login_with_temporary_password","saml_throw_on_temporary_password_use_case_mismatch","saml_enforced_disallow_send_temporary_password","audit_log_aes_event_read","audit_log_permanently_deleted_filter_enable","audit_log_event_name_column","guest_invite_requests","drawing_block","log_identify_cross_domain_device_ids","duplcate_template_tracking_serverside","disable_ai_big_red_button","organization_is_source_of_truth","ai_data_sharing","convert_cut_paste_to_move","page_title_in_reranker","text_align","enable_giphy_feature_gate","dependency_date_shifting_by_space","admin_content_search_only_search_titles","legacy_slack_notifications","overlay_trap_focus","mobile_better_filing_eligibility","server_dispatch_recents_background_fetch","onetrust_onboarding_unsub_link","google_drive_connected_relation","figma_connected_relation","zendesk_connected_relation","zendesk_ai_enabled","toggleable_transcript","use_assembly","use_iframely_cards","embed_gdrive_option","transcript_feedback_button","space_for_ai_tooltip_enabled","export_collections_v1","use_new_import_notification","scim_patch_race_condition_resistant_operations","scim_post_race_condition_resistant_operations","scim_put_race_condition_resistant_operations","scim_high_throughput_save_transactions","message_store_client_send_request_metric_enabled","audio_processor_client_send_request_metric_enabled","enable_organization_domain_claim","template_gallery_web","response_size_instrumentation","append_favorites","support_synced_database_automations","template_contentful_sync_job","mobile_bridge_performance_logging","ai_source_picker","client_http_gzip","is_visibility_enabled_for_db_sync","disable_poll_jobs_for_collection_entities","export_new_structure","embed_block_fallback","automation_update_pages_batching","update_pages_action_batching","topbar_connection_indicator_v2","delete_kvs","force_kvs_break","enable_guest_export","animated_use_css_transition","perform_get_latest_activity_queries_sequentially","autofill_translate","scim_post_user_version_conflict","scim_post_user_space_view_mismatch","collections_view_specific_client_mode_enabled","autofill_tags","autotag_ambient_trigger","autotag_ambient_trigger_space","enable_vector_search_in_autotag","dark_fetch_autotag","enable_ai_suggested_properties","typed_move_to_improved_search","typed_move_to_improved_default_results","search_index_collection_ranking_features","ios_enable_prefetching","mobile_browser_remove_bottom_padding_hack","hide_orphan_blocks","wiki_perf_improvement_local_enabled","show_keep_existing_guests_modal","export_content_analytics_stream","recover_space_view_on_readd","space_user_recovery_read","recover_user_content_in_product","export_admin_content_search_stream","export_puppeteer_upgrade","affiliates_s2s_routing","meeting_notes_transcript_consumer_setup","meeting_notes_transcript_new_consumer","meeting_notes_formatting_fix","enable_external_integration_auth_strict_access","student_form","native-find-in-page","assistant-labeler-mode","active_token_counter","qna_block_citations","2024_workspace_gpt4","qna-reranker-skipped","experimental-cohere-only-for-personal-workspace","assistant-teacher-mode","ai_leap_is_visible","rerank_slack_only_by_cohere","vector_db_search","vector-search-live-indexing","embeddings-enabled-for-spaceid","qna-slack-workspaces","people_profile_popup","send_student_form_error_messages","recurrence_queue_task_improvements","enterprise_launch_modal","quick_search","search_toggle_side_peek","search-show-report-bad-search","search_operations_skip_local_search","update_space_permissions_if_no_records","improved_asana_importer_screens","disable_storage_manager_estimate","toc_nested_headings","mention_menu_page_headings","use_new_undo_redo_behavior","inline_mention_invites","disable_qna_for_workspace","derived_property_sync_processor","organization_audit_logs","enable_transcript_tab","wiki_query_perf_improve_enabled","autofill_turbo_traffic","filter_dependencies","enable-cron-job-updateembeddingindexedflags","mobile_native_external_link_fix","localized_parse_number","internal_communication_with_connections","qna_enable_reminders","inert_html_attribute","sync_session_cookie","remove_apostrophe_for_maps_url","student_form_v2","admin_console_enabled","settings_console_audit_log_enabled","settings_console_managed_accounts_enabled","settings_console_people_enabled","settings_console_analytics","settings_console_content_search","settings_console_security","use_hierarchy_in_zip_importer","cache_date_filters","audit_log_guest_membership_request","qna_enable_suggested_questions_cron_job","is_evernote_authpopup_closing_fix_enabled","enable_oauth_from_desktop_ux_v2","enable_public_content_scanning","inactive_webhook_subscriptions","should_extract_media_from_html","dark_read_block_property_item","docx_comment_importer_enable","csv_export_in_user_timezone","slack_token_specification","enable_server_integrations_proxy","page_property_search","comments_density_image_handling","hover_menu_requires_target","enable_custom_siem_integration","social_media_preview_image_render_page_metadata","include_nonindexed_public_content_for_scanning","human_suggested_edits","use_organization_on_read","enable_list_users_by_email_addresses","low_guest_limit","presence_avatar_tooltips","notion_ai_assistant_continuous_eval_sample_rate","partitioned_universal_importer","input_padding","block_reactions","collections_virtualization","qna_generate_reranker_label","article_extractor_all_url_enable","article_extractor_enable","google_doc_importer","ai_indexing_allowlist","scim_suppress_email","image_cropping","image_cropping_aspect_ratios","ask_ai_to_edit_fix","github_activity_comments","show_github_connected_property_settings","pinecone_serverless_real_read","export_html_search_engine_indexing","alt_text_image_blocks","navigation_render_parallel_requests","third_party_data_ingestion_consumer_setup","show_jira_import_overlay_messages","collection_group_ui_parent","preload_cutaway","comments_pane_improvements","comic_sans","ai_public_sites_scanning","prevent_edits_trash","floating_table_of_contents","dictation","is_third_party_qna_enabled","wrong_user_object_debug_server_enabled","code_block_preserve_indent","auto_delete_from_trash","google_drive_qna_ingestion","docs_clipboard_imagedata","prefer_high_level_operations","mobile_horizon1_dictation","prevent_edits_trash_server","enable_token_refresh_time_bump_enabled","client_verify_fetched_pointer_mismatch","run_rules_engine_for_bot_api","search_notion_calendar_ltr_reranking_model","limited_qna_dark_read","customer_io_track","delete_records_in_jira_resync","run_rules_engine_for_publish","enable_notion_activity_notifications_in_slack","slack_db_notification_default_props_untyped_dbs","slack_db_notification_default_properties","slack_bot_enable_slack_oauth_v2","enable_notion_ai_unfurl_in_slack","markdown_support_for_slack"],C=[...I].sort();const x={event_trail_events:{},page_tree_query_strategy:{strategy:"js_recursion_property_filter_sql"},event_trail_routing:{},collection_request_settings:{clientFormulaTimeoutMs:3e5},sentry:{errorsSampleRate:0,"tracesSampleRate-v0":0,"replaysSessionSampleRate-v0":0,"replaysOnErrorSampleRate-v0":0,profilesSessionSampleRate:0,profilesSampleRate:0},gtm_ai_favorites:{space_id:void 0,collection_id:void 0},palette:{"sessionSampleRate-v4":0,pageLoadSampleIntervalMs:10,interactionSampleIntervalMs:10,maxBufferSize:1e5},permanently_delete_tree_queue_task_override:{queue_task_kill_switch_on:!1,task_delay_override_seconds:void 0,elastic_search_request_batch_size:200,s3_request_batch_size:200,redis_read_batch_size:1e4,tree_iteration_batch_size:1e4,tree_iteration_max_buffer_size:5e4,postgres_query_batch_size:1e5},load_test_simulator_configs:{commenter_interval_ms:1e3,page_viewer_interval_ms:100,editor_interval_ms:1e3,editor_typing_interval_ms:100,presence_interval_ms:1e3},education_free_submit_form_config:{},confluence_server_groups:{default:{read:[],create:[]}},notion_people_block_id:{data:{}},template_ids_to_use_duplicate_block:{data:[]},template_ids_not_to_use_duplicate_block_server:{data:[]},csv_limits:{maxRelationPages:1e3,maxRows:1e5,maxColumns:500},model_overrides:{},slack_contacts_limit:{maxLimit:100,defaultLimit:100},automation_update_pages:{},assistant_error_message_override:{},inbox_2_0_shadow_traffic_testing:{getNotificationLogPassRate:0,getUserNotificationsPassRate:0},active_token_counter_config:{},text_crdt_config:{delete_merge_slice_tree_block_limit:100,crdt_page_banner_link:"https://dev.notion.so/notion/Conflict-Resolution-784929c697f54e1eb18d77ac782fc548"},default_create_crdt_page_config:{private:!1,space:!1,team:!1,app_template:!1,collection_table_view:!1,collection_non_table_view:!1,collection_unknown_view:!1,collection_instantiate_template:!1,other:!1,automation_action:!1,comment:!1,external_object_instance_page:!1},dev_ai_context:{suggestOnPageNavigationProbability:0},qna_ai_reminders:{abandonedSearchReminderProbability:0},mobile_inbox_2_0_feedback:{},paste_event_logging:{samplePercentage:0,redactedHtmlMaxSize:4096},article_extractor_enable_urls:{urls:[]},ai_qna_silent_retry_mode:{},ingestion:{slack:{clientId:"",prefix:"",channelIds:[],ingestionTopic:"",adminScopes:[],userScopes:[],maxChannelsPerPartition:0},googleDrive:{mainPollTime:120,ingestionTopic:""},bucket:"",kafka:{topic:"",partitionCount:0}},universal_qna:{defaultExternalSources:[]},collection_virtualized_load_limits:{table:{initial_limit:50,increment_limit:50}}},T=new Set(w);function M(e){return T.has(e)}function P(e){return y[e]}const A="_unassigned_"},64962:(e,t,n)=>{n.d(t,{O:()=>F});n(57658);var o=n(53965),i=n(19584),r=n(66897),a=n(15145),s=n(15070),l=n(90559),c=n(35011),d=n(80951),u=n(34299),p=n(56373),m=n(1800),f=n(40506),g=n(7057),h=n(53877),v=n(61075),b=n(64572),y=n(25718),_=n(59753),S=n(63306),w=n(21202),k=n(77420),I=n(6287),C=n(19889),x=n(70203),T=n(7928),M=n(4308);const P=g.ZV;function A(e){return(0,v.hJ)({...e,fromString:e=>e}).join("")}function R(e){const{textValue:t}=e;if(t){const n=[];for(const o of t)x.QJH(o)||n.push(A({...e,textValue:[o]}));return n.join(", ")}return""}const D={[x.GKr.Page]:e=>{let{annotation:t,exportArgs:n}=e;const{getExportedPathToPage:o}=n,i=x.TOT(t),r=(0,v.Ho)({intl:n.intl,blockId:i,getRecordValue:n.getRecordValue,userTimeZone:n.userTimeZone}),a=o({toPageId:i});if(r&&a)return`${r} (${a})`},[x.GKr.Comment]:e=>{let{annotation:t,exportArgs:n}=e;const{getRecordValue:o,baseUrl:i}=n,r=_.om.fromGetRecordValueFn(o),s=x.$WM(t);if(!s)return;const l=r(s);if(!l)return;const c=l.getParentId(),d=l.getParentPointer(),u=(0,S.el)((0,S.DW)(d,o));if(!u)return;const p=r(d);let f;if(p){const e=r(p.getParentPointer());f=e&&"table_row"===e.getType()?e.getParentId():p.getParentId()}return(0,m.Z)({pageId:u.id,scrollToBlockId:f,pageValue:u,baseUrl:i,discussionId:c,pageVisitSource:a.tY.Export})},[x.GKr.Link]:e=>{let{annotation:t,exportArgs:n}=e;const{getExportedPathToFile:o,getExportedPathToPage:i,navigableBlockId:r,baseUrl:a,publicDomainName:s}=n,l=x.zW$(t),c=(0,b.A5)({url:l,baseUrl:a,publicDomainName:s});return c?i({toPageId:c}):o({fromBlockId:r,toFileURI:l})},[x.GKr.User]:e=>{let{annotation:t,exportArgs:n}=e;const{intl:o}=n,i=x.zEN(t),r=n.getRecordValue({table:C.KJ,id:i});if(r)return`@${(0,T.Nz)(o,r)}`},[x.GKr.Bot]:e=>{let{annotation:t,exportArgs:n}=e;const o=x._Rq(t),i=n.getRecordValue({table:k.cZ,id:o});if(i)return`@${(0,s.Mh)(i)}`},[x.GKr.Group]:e=>{let{annotation:t,exportArgs:n}=e;const o=(0,v.kF)({annotation:t,exportArgs:n});if(o)return o},[x.GKr.ExternalObjectInstance]:e=>{var t;let{annotation:n,exportArgs:o}=e;const i=x.frW(n);return null===(t=o.getRecordValue({table:w.iU,id:i,spaceId:o.root.spaceId}))||void 0===t||null===(t=t.format)||void 0===t?void 0:t.original_url},[x.GKr.Date]:e=>{let{annotation:t,exportArgs:n}=e;const{date_format:o,time_format:i,...r}=x.zyO(t);return`@${(0,g.ZV)({value:r,date_format:o,time_format:i,userTimeZone:n.userTimeZone,allowRelativeDates:!1,intl:n.intl})}`},[x.GKr.Equation]:e=>{let{annotation:t,exportArgs:n}=e;const o=(0,y.dx)(t),i=(0,y.wB)(t,n.getExportedPathToPage,n);return`${o}${x.xey(t)}${i}`},[x.GKr.Bold]:v.Hf,[x.GKr.Italic]:v.Hf,[x.GKr.Strike]:v.Hf,[x.GKr.Code]:v.Hf,[x.GKr.Highlight]:v.Hf,[x.GKr.Discussion]:v.Hf,[x.GKr.Underline]:v.Hf,[x.GKr.Inserted]:v.Hf,[x.GKr.Deleted]:v.Hf,[x.GKr.TemporaryComment]:v.Hf,[x.GKr.TemporaryCursor]:v.Hf,[x.GKr.TemporaryEquation]:v.Hf,[x.GKr.TemporaryPage]:v.Hf,[x.GKr.TemporaryInput]:v.Hf,[x.GKr.TemporarySelection]:v.Hf,[x.GKr.TemporaryFindHighlight]:v.Hf,[x.GKr.TemporarySelectedFindHighlight]:v.Hf,[x.GKr.TemplateVariable]:v.Hf,[x.GKr.FormulaPageProperty]:v.Hf,[x.GKr.FormulaContextValue]:v.Hf,[x.GKr.FormulaError]:v.Hf,[x.GKr.Citation]:v.Hf,[x.GKr.SuggestionInsertText]:v.Hf,[x.GKr.SuggestionRemoveText]:v.Hf,[x.GKr.SuggestionAnnotate]:v.Hf,[x.GKr.SuggestionUnannotate]:v.Hf,[x.GKr.TemporaryNativeMABFilter]:v.Hf,[x.GKr.TemporaryDictation]:v.Hf};function E(){}function B(){return Promise.resolve(void 0)}const F={blockRenderers:{text:E,header:E,sub_header:E,sub_sub_header:E,quote:E,bulleted_list:E,toggle:E,to_do:E,numbered_list:E,code:E,page:E,image:E,video:E,embed:E,bookmark:E,file:E,tweet:E,maps:E,gist:E,framer:E,invision:E,mixpanel:E,drive:E,figma:E,loom:E,pdf:E,typeform:E,codepen:E,audio:E,divider:E,equation:E,collection_view:E,collection_view_page:E,column_list:E,column:E,factory:E,copy_indicator:E,breadcrumb:E,link_to_collection:E,link_to_page:E,table_of_contents:E,callout:E,whimsical:E,miro:E,abstract:E,sketch:E,excalidraw:E,replit:E,alias:E,transclusion_container:E,transclusion_reference:E,external_object_instance:E,table:E,table_row:E,tab:E,hex:E,deepnote:E,external_object_instance_page:E,button:E,ai_block:E,drawing:E,personal_home_page:E},asyncBlockRenderers:{text:B,header:B,sub_header:B,sub_sub_header:B,quote:B,bulleted_list:B,toggle:B,to_do:B,numbered_list:B,code:B,page:B,image:B,video:B,embed:B,bookmark:B,file:B,tweet:B,maps:B,gist:B,framer:B,invision:B,mixpanel:B,drive:B,figma:B,loom:B,pdf:B,typeform:B,codepen:B,audio:B,divider:B,equation:B,collection_view:B,collection_view_page:B,column_list:B,column:B,factory:B,copy_indicator:B,breadcrumb:B,link_to_collection:B,link_to_page:B,table_of_contents:B,callout:B,whimsical:B,miro:B,abstract:B,sketch:B,excalidraw:B,replit:B,alias:B,transclusion_container:B,transclusion_reference:B,external_object_instance:B,table:B,table_row:B,tab:B,hex:B,deepnote:B,external_object_instance_page:B,button:B,ai_block:B,drawing:B,personal_home_page:B},annotationRenderers:D,propertyRenderers:{title:e=>A(e),text:A,select:e=>{const{textValue:t,propertySchema:n}=e,o=n.options||[];return d.Sj(t,o)},multi_select:e=>{const{textValue:t,propertySchema:n}=e,o=n.options||[],i=d.uP(t,o);return i.sort(),i.join(", ")},status:e=>{const{textValue:t,propertySchema:n}=e;return d.ZG(t,n)},relation:e=>{const{textValue:t,propertySchema:n,exportArgs:o}=e;if("relation"!==n.type)return;const i=d.j$({relationValue:d.rq(t),getRecordModel:_.om.fromGetRecordValueFn(o.getRecordValue),propertySchema:n}),r=d.ow(i);return R({...e,textValue:r})},rollup:e=>{const t=e.exportArgs.getRecordValue,n=_.kk.fromValue(w.iU,e.block),o=_.om.fromGetRecordValueFn(t);return u.kJ({...e,block:n,getRecordModel:o,collectionRequestContext:{userId:void 0,userTimeZone:e.exportArgs.userTimeZone,depth:0,intl:e.exportArgs.intl,visitedProperties:new Set,resultCache:e.exportArgs.resultCache}})},url:e=>{let{textValue:t}=e;return x.Jcv(t)},email:e=>{let{textValue:t}=e;return x.Jcv(t)},phone_number:e=>{let{textValue:t}=e;return x.Jcv(t)},checkbox:e=>{let{textValue:t}=e;return d.Ml(t)?"Yes":"No"},person:e=>{let{textValue:t,exportArgs:n,propertySchema:i,block:r}=e;const{intl:a}=n,s=_.kk.fromBlock(r),l=d.DW({textValue:t,propertySchema:i,blockCreatorPointer:s.getCreatedByPointer()});return o.oA(l.map((e=>{const t=n.getRecordValue(e),o=t&&_.kk.fromValue(e.table,t);return null==o?void 0:o.getDisplayName(a)}))).join(", ")},number:e=>{let{textValue:t}=e;const n=d.VY(t);if(void 0!==n)return n.toString()},date:e=>{let{textValue:t,propertySchema:n,...o}=e;const i=o.exportArgs.userTimeZone,r=d.Gl(t),{date_format:a,time_format:s}=n;if(r)return(0,g.ZV)({allowRelativeDates:!1,value:r,date_format:a,time_format:s,userTimeZone:i,intl:o.exportArgs.intl,displayInUserTimezone:o.exportArgs.displayInUserTimezone??!1,alwaysIncludeTimezone:!0})},file:R,formula:e=>{const{property:t,schema:n,block:o,exportArgs:r}=e,{userTimeZone:a,getRecordValue:s,intl:l,resultCache:d}=r,u=(0,c.py)({schema:n,property:t,blockModel:_.kk.fromBlock(o),getRecordModel:_.om.fromGetRecordValueFn(s),intl:l,userTimeZone:a,depth:0,resultCache:d});return"boolean"==typeof u?u?"Yes":"No":(0,i.hj)(u)?u.toString():(0,f.U3)(u)?P({value:u,userTimeZone:a,allowRelativeDates:!1,intl:r.intl}):u},created_time:e=>{const{block:t,exportArgs:n}=e,{userTimeZone:o}=n;if(t.created_time)return P({allowRelativeDates:!1,value:(0,h.CQ)(t.created_time,o),userTimeZone:o,intl:n.intl})},last_edited_time:e=>{const{block:t,exportArgs:n}=e,{userTimeZone:o}=n;if(t.last_edited_time)return P({allowRelativeDates:!1,value:(0,h.CQ)(t.last_edited_time,o),userTimeZone:o,intl:n.intl})},created_by:e=>{const{block:t,exportArgs:n}=e,{getRecordValue:o,intl:i}=n;if(t.created_by_table&&t.created_by_id){const e=(0,r.Hl)({getRecordValue:o,pointer:{table:t.created_by_table,id:t.created_by_id,spaceId:t.space_id}});if(e.asActor)return(0,r.$4)(i,e)}},last_edited_by:e=>{const{block:t,exportArgs:n}=e,{getRecordValue:o,intl:i}=n;if(t.last_edited_by_table&&t.last_edited_by_id){const e=(0,r.Hl)({getRecordValue:o,pointer:{table:t.last_edited_by_table,id:t.last_edited_by_id,spaceId:t.space_id}});if(e.asActor)return(0,r.$4)(i,e)}},button:e=>"",auto_increment_id:e=>{let{textValue:t,block:n,exportArgs:o}=e;const i=d.ah(t),{getRecordValue:r}=o;if(void 0!==i){const e=_.kk.fromBlock(n),t=e.getParentTable();if(t!==I.vF)return;const o=r((0,p.We)({spaceId:e.getSpaceId(),parentTable:t,parentId:e.getParentId()}));return(0,l.wf)(null==o?void 0:o.record_key,i)}},last_visited_time:e=>"",location:e=>"",verification:e=>{let{textValue:t,exportArgs:n}=e;const o=d._w(t);if(!o)return"";const i=M.WN(o);return n.intl.formatMessage(M.A3(i.type))}}}},42509:(e,t,n)=>{n.d(t,{Ev:()=>l,Gq:()=>s,OY:()=>p,Ux:()=>u,hD:()=>c});var o=n(1898),i=n(21202),r=n(6287);(0,o.AO)((e=>e&&e.parent_table===i.iU&&a(e)&&e.format&&e.format.original_url&&!e.format.is_placeholder?{true:e}:{false:e})),(0,o.AO)((e=>{var t,n;return e&&e.parent_table===i.iU&&a(e)&&e.format&&void 0===e.format.original_url&&null!==(t=e.format)&&void 0!==t&&t.external_object_id&&null!==(n=e.format)&&void 0!==n&&n.uri&&!e.format.is_placeholder?{true:e}:{false:e}}));const a=(0,o.AO)((e=>d(e)&&"external_object_instance"===e.type?{true:e}:{false:e})),s=((0,o.AO)((e=>d(e)&&"external_object_instance_page"===e.type?{true:e}:{false:e})),(0,o.AO)((e=>e&&e.parent_table===r.vF&&d(e)&&"external_object_instance_page"===e.type?{true:e}:{false:e})),(0,o.AO)((e=>{var t;return d(e)?{false:e}:e.parent_table===i.iU&&null!==(t=e.format)&&void 0!==t&&t.original_url&&e.format.external_object_id?{true:e}:{false:e}}))),l=(0,o.AO)((e=>{var t;return d(e)?{false:e}:e.parent_table===i.iU&&null!==(t=e.format)&&void 0!==t&&t.original_url&&!e.format.external_object_id?{true:e}:{false:e}})),c=((0,o.AO)((e=>{var t;return!e||d(e)?{false:e}:e.parent_table===r.vF&&null!==(t=e.format)&&void 0!==t&&t.external_object_id?{true:e}:{false:e}})),(0,o.AO)((e=>{var t,n;return!e||d(e)?{false:e}:null!=e&&null!==(t=e.format)&&void 0!==t&&t.original_url||null!=e&&null!==(n=e.format)&&void 0!==n&&n.external_object_id||p(e)||m(e)||f(e)?{true:e}:{false:e}}))),d=(0,o.AO)((e=>"type"in e&&e.type?{true:e}:{false:e})),u=(0,o.AO)((e=>void 0===e.format?{true:e}:{false:e})),p=((0,o.AO)((e=>{var t;return null!==(t=e.format)&&void 0!==t&&t.is_placeholder?{true:e}:{false:e}})),(0,o.AO)((e=>{var t,n;return!e||d(e)?{false:e}:null!==(t=e.format)&&void 0!==t&&t.is_placeholder&&null!==(n=e.format)&&void 0!==n&&n.integration_id?{true:e}:{false:e}}))),m=(0,o.AO)((e=>d(e)?{false:e}:e.parent_table===r.vF&&e.format&&e.format.uri&&void 0===e.format.external_object_id&&e.format.integration_id?{true:e}:{false:e})),f=(0,o.AO)((e=>d(e)?{false:e}:e.parent_table===r.vF&&e.format&&e.format.uri&&void 0===e.format.external_object_id&&void 0===e.format.integration_id?{true:e}:{false:e}))},76218:(e,t,n)=>{n.d(t,{A6:()=>d,Ck:()=>m,H0:()=>f,OH:()=>y,S3:()=>h,UB:()=>v,YD:()=>c,Zw:()=>b,iC:()=>u,qW:()=>g});n(57658);var o=n(53965),i=n(1898),r=n(76725),a=n(6287),s=n(23867),l=n(70203);function c(e){if(void 0!==e)return[p(e)]}function d(e){const t=e||[],n=[];for(const o of t){const e=(0,l.hDy)(o),t=(0,l.hH9)(e)||(0,l.V8Y)(e)||(0,l.sP4)(e)||(0,l.K9C)(e);t&&n.push(t);const i=(0,l.WiV)(o).split(",");for(const o of i){const e=o.trim(),t=e.indexOf('"'),i=e.lastIndexOf('"');if(t>=0&&i>=0){const o=e.slice(t+1,i);o.length>0&&n.push(o)}else"true"===e?n.push(!0):"false"===e&&n.push(!1)}}return n}function u(e){const t=o.mN(e,(e=>JSON.stringify(e)));if(0!==t.length)return(0,l.Zxt)([["["],...(0,r.Z)(t.map(p),(()=>[", "])),["]"]])}function p(e){return"string"==typeof e?[`"${e}"`]:"boolean"==typeof e?[`${e}`]:(0,l.YCD)(e)}function m(e,t){return e.filter((e=>JSON.stringify(e)!==JSON.stringify(t)))}function f(e,t,n){const o=g(e,t,n);if(o)return function(e){if("text"===e.type)return e;if("number"===e.type)return e;if("checkbox"===e.type)return e;if("date"===e.type)return e;if("block_array"===e.type)return{type:"array",of:{type:"block",collection:e.collection}};if("person_array"===e.type)return{type:"array",of:{type:"person"}};if("select"===e.type)return{type:"select",collection:e.collection,property:e.property};if("select_array"===e.type)return{type:"array",of:{type:"select",collection:e.collection,property:e.property}};(0,i.t1)(e)}(o)}function g(e,t,n){if("text"===n.type||"url"===n.type||"email"===n.type||"phone_number"===n.type||"title"===n.type)return{type:"text"};if("checkbox"===n.type)return{type:"checkbox"};if("multi_select"===n.type)return{type:"select_array",collection:e,property:t};if("select"===n.type||"status"===n.type)return{type:"select",collection:e,property:t};if("person"===n.type)return{type:"person_array"};if("number"===n.type||"auto_increment_id"===n.type)return{type:"number"};if("date"===n.type)return{type:"date"};if("relation"===n.type){if(n.collection_pointer)return{type:"block_array",collection:{table:a.vF,id:n.collection_pointer.id,spaceId:(0,s.C)(n.collection_pointer.spaceId)}};if(n.collection_id)return{type:"block_array",collection:{table:a.vF,id:n.collection_id,spaceId:e.spaceId}}}else{if("formula"===n.type||"rollup"===n.type||"last_edited_by"===n.type||"last_edited_time"===n.type||"button"===n.type||"created_time"===n.type||"created_by"===n.type||"file"===n.type||"location"===n.type||"verification"===n.type||"last_visited_time"===n.type)return;(0,i.t1)(n)}}function h(e){return"string"!=typeof e&&"boolean"!=typeof e}function v(e){return(e.value??[]).map((e=>{if(!(0,l.km_)(e))return;const t=(0,l.sP4)(e[1]);if(!t)return;return(0,l.vmO)(t).id})).filter(i.$K)}function b(e,t){return{...e,value:e.value?e.value.map((e=>{if(!(0,l.km_)(e))return e;const n=o.Xh(e);for(const o of n[1])(0,l.wjk)(o)&&(o[1].id=t(o[1].id));return n})):void 0}}async function y(e){const{value:t,context:n,executeFormula:o}=e,{returnType:r}=n,a=t.value;if("simple"===t.type){if("number"===r.type){const e=(0,l.QaF)(a),t=parseFloat(e);return isNaN(t)?{value:{type:"undefined"}}:{value:{type:"number",value:t}}}if("text"===r.type)return{value:{type:"text",value:a||[]}};if("checkbox"===r.type){return{value:{type:"checkbox",value:"true"===(0,l.QaF)(a)}}}return o(n,a)}return"formula"===t.type?o(n,a):(0,i.t1)(t.type)}},5773:(e,t,n)=>{n.d(t,{ZP:()=>d,jy:()=>u,xN:()=>c});n(57658);var o=n(1898),i=n(80951),r=n(43593),a=n(59753),s=n(70203);const l=["source"];function c(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;const c=[],d=[],m=e.getProperties(),f=e.useCrdt()&&e.getTextSliceTree();if(f){const e=u(i.g(f.getTextValue()),[t,n],o,a);c.push(...e)}if(m){const e=Object.keys(m);for(const r of e){const e=m[r],f=e?i.g(e):void 0;if(s){const e=p(f,t,n,o,a);if(e&&e.length>0&&l.includes(r)){const t={pointer:s,path:["properties",r],command:"set",args:e};d.push(t)}}const g=u(f,[t,n],o,a);c.push(...g)}}const g=e.getFormat();if(g){const{page_cover:e,page_icon:i}=g;if(e){const i=(0,r.mV)(e,[t,n],o,a);i&&c.push(i)}if(i){const e=(0,r.mV)(i,[t,n],o,a);e&&c.push(e)}}return{files:c,operations:d}}function d(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;return c(a.kk.fromBlock(e),t,n,o,i,r).files}function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return void 0===e?[]:e.map((e=>(0,r.mV)(e.url,t,n,i))).filter(o.$K)}function p(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4?arguments[4]:void 0;if(void 0===e)return;const l=e.map((e=>(0,r.Wv)(e.url,t,n,i,a))).filter(o.$K);return l&&l.length>0?[s.V3y(l[0].link)]:void 0}},89789:(e,t,n)=>{n.d(t,{P_:()=>a});var o=n(66897),i=n(77420),r=n(19889);const a=(0,o.dp)(r.s$);(0,o.dp)(r.el),(0,o.dp)(r.T0),(0,o.dp)(r.fs),(0,o.D$)(i._H)},45681:(e,t,n)=>{n.d(t,{T1:()=>D,A6:()=>A,Wr:()=>P,rb:()=>R});var o=n(53965),i=n(90559),r=n(80951),a=n(38297),s=n(6287);const l={derivePrimitiveOperations:function(e,t){const{collectionId:n,spaceId:o}=e.args,l=t(e.pointer);if(!l)return[];if(l.is_template)return[];const c=(0,a.ky)({block:l,getRecordValue:t});if((null==c?void 0:c.id)===n){const a=(0,i.Y7)({spaceId:o,parentTable:s.vF,parentId:n}),l=t(a),c=t({table:s.vF,id:n,spaceId:o});if(c&&l&&l.alive)return(0,i.FT)(c).flatMap((t=>[{pointer:e.pointer,command:"set",path:["properties",t],args:(0,r.e7)(l.next_value)},{pointer:a,command:"set",path:["next_value"],args:l.next_value+1}]))}return[]},getAdditionalRelatedPointers:function(e){const{collectionId:t,spaceId:n}=e.args;return[(0,i.Y7)({spaceId:n,parentTable:s.vF,parentId:t})]},invert:function(e,t){return[]}};n(21703),n(57658);var c=n(482),d=n(73360);const u={derivePrimitiveOperations:function(e,t){const n=[];n.push({...e,command:"insertChildrenBefore"===e.command?"listBeforeMulti":"listAfterMulti",args:{...e.args}});const o=P(e.pointer.table,e.path);if(!o)throw new Error(`Unsupported operation table and operation path ${JSON.stringify(e)} `);return e.args.ids.forEach((i=>{const r={id:i,table:o,spaceId:e.pointer.spaceId};n.push({command:"update",pointer:r,path:[],args:{parent_table:e.pointer.table,parent_id:e.pointer.id,alive:!0}});const a=t(r);if(a&&a.parent_id&&a.parent_table&&a.parent_id!==e.pointer.id){const e=A(a.parent_table,o);e?n.push({command:"listRemove",pointer:{id:a.parent_id,table:a.parent_table,spaceId:a.space_id},path:e,args:{id:a.id}}):function(e){if(!e)throw new Error("Assertion failed in insertChildrenOperationHelper")}(a.parent_table===s.vF)}})),n},getAdditionalRelatedPointers:function(e){const t=P(e.pointer.table,e.path);if(!t)throw new Error(`Invalid operation ${JSON.stringify(e)}`);return e.args.ids.map((n=>({id:n,table:t,spaceId:e.pointer.spaceId})))},invert:function(e,t){const n=P(e.pointer.table,e.path);if(!n)throw new Error(`Invalid operation ${JSON.stringify(e)}`);return e.args.ids.flatMap((o=>{const i={id:o,table:n,spaceId:e.pointer.spaceId},r=t(i);if(r&&r.parent_table&&r.parent_id){if(A(r.parent_table,n)){const n=t({id:r.parent_id,table:r.parent_table,spaceId:r.space_id});if(n){const e=p(d.mk.create(r.parent_table,n),r.parent_table,i);return e?[e]:[]}return[{command:"removeChild",pointer:e.pointer,path:e.path,args:{id:o}}]}return[{command:"setParent",pointer:i,path:[],args:{parentId:r.parent_id,parentTable:r.parent_table}}]}return[{command:"removeChild",pointer:e.pointer,path:e.path,args:{id:o}}]}))}};function p(e,t,n){const o=A(e.table,n.table);if(!o)return{command:"setParent",pointer:n,path:[],args:{parentId:e.value.id,parentTable:t}};const i=(0,c.f4)(e.value,o);if(!i)return;const r=i.indexOf(n.id);if(-1===r)return;const a={id:e.value.id,table:t,spaceId:n.spaceId};if(0===r){return{command:"insertChildrenBefore",pointer:a,path:o,args:{ids:[n.id]}}}return{command:"insertChildrenAfter",pointer:a,path:o,args:{ids:[n.id],after:i[r-1]}}}n(30541);var m=n(39693),f=n.n(m),g=n(59753),h=n(29299),v=n(91644),b=n(75246);const y={derivePrimitiveOperations:function(e){const{pointer:t}=e,{spaceViewPointer:n,userId:o,removeFromParent:i}=e.args;if(t.spaceId!==n.spaceId)throw new Error("Invalid moveToPrivateOperation: Cannot move to a different space");const r=[(0,h.Y5)({pointer:t,userId:o}),(0,h.v2)({pointer:t,parent_table:b.bx,parent_id:n.spaceId,alive:!0}),{pointer:n,path:["private_pages"],command:"listAfter",args:{id:t.id}}];if(i){const e=A(i.table,t.table);e&&r.unshift({pointer:i,path:e,command:"listRemove",args:{id:t.id}})}return r},getAdditionalRelatedPointers:function(e){return f()([e.args.spaceViewPointer,e.args.removeFromParent])},invert:function(e,t){const{pointer:n}=e,{spaceViewPointer:o,removeFromParent:i}=e.args,r=g.om.fromGetRecordValueFn(t),a=r(n);if(!a)return[];const l=[{command:"set",pointer:n,path:["permissions"],args:a.getPermissionItems()},(0,h.v2)({pointer:n,parent_table:a.parent_table,parent_id:a.parent_id,alive:a.alive??!0}),{pointer:o,path:["private_pages"],command:"listRemove",args:{id:n.id}}];if(i){const e=A(i.table,n.table);if(e){const t=r(i);if(t&&t.table!==s.vF&&t.table!==v.AT){const o=t.getChildren(),r=o.indexOf(n.id);r<=0?l.push({pointer:i,path:e,command:"listBefore",args:{id:n.id}}):l.push({pointer:i,path:e,command:"listAfter",args:{id:n.id,after:o[r-1]}})}}}return l}},_={derivePrimitiveOperations:function(e){const t=[];t.push({...e,command:"listRemove"});const n=P(e.pointer.table,e.path);if(!n)throw new Error(`invalid operation ${JSON.stringify(e)}`);return t.push({command:"set",path:["alive"],args:!1,pointer:{table:n,spaceId:e.pointer.spaceId,id:e.args.id}}),t},getAdditionalRelatedPointers:function(e){const t=P(e.pointer.table,e.path);if(!t)throw new Error(`Invalid operation ${JSON.stringify(e)}`);return[{id:e.args.id,table:t,spaceId:e.pointer.spaceId}]},invert:function(e,t){const n=t(e.pointer);if(!n)return[];const o=P(e.pointer.table,e.path);if(!o)throw new Error(`Invalid operation ${JSON.stringify(e)}`);const i=p(d.mk.create(e.pointer.table,n),e.pointer.table,{id:e.args.id,table:o,spaceId:e.pointer.spaceId});return i?[i]:[]}};var S=n(98963),w=n(18844),k=n(21202),I=n(70279),C=n(33709),x=n(29369);const T={insertChildrenAfter:u,insertChildrenBefore:u,setParent:{derivePrimitiveOperations:function(e,t){const n=[{command:"update",pointer:e.pointer,path:[],args:{parent_table:e.args.parentTable,parent_id:e.args.parentId,alive:!0}}],o=t(e.pointer);if(o&&o.parent_id&&o.parent_table){const t=A(o.parent_table,e.pointer.table);t&&n.push({command:"listRemove",pointer:{id:o.parent_id,table:o.parent_table,spaceId:o.space_id},path:t,args:{id:e.pointer.id}})}return n},getAdditionalRelatedPointers:function(e){return[]},invert:function(e,t){const n=t(e.pointer);if(!n||!n.parent_id||!n.parent_table)return[{command:"set",pointer:e.pointer,path:["alive"],args:!1}];if(n.parent_id===e.args.parentId&&n.parent_table===e.args.parentTable)return[];if(A(n.parent_table,e.pointer.table)){const o=t({id:n.parent_id,table:n.parent_table,spaceId:n.space_id});if(o){const t=p(d.mk.create(n.parent_table,o),n.parent_table,e.pointer);if(t)return[t]}return[]}return[{command:"setParent",pointer:e.pointer,path:[],args:{parentId:n.parent_id,parentTable:n.parent_table}}]}},removeChild:_,assignAutoIncrementId:l,moveToPrivate:y},M={[k.iU]:[{childTable:k.iU,childPath:["content"]},{childTable:C.qF,childPath:["discussions"]}],[b.bx]:[{childTable:k.iU,childPath:["pages"]}],[C.qF]:[{childTable:I.x_,childPath:["comments"]}],[I.x_]:[{childTable:k.iU,childPath:["content"]}],[x.e0]:[{childTable:k.iU,childPath:["team_pages"]}],[S.cv]:[{childTable:w.Xj,childPath:["action_ids"]}],[w.Xj]:[{childTable:k.iU,childPath:["blocks"]}],[v.AT]:[]};function P(e,t){var n;const i=M[e];if(i)return null===(n=i.find((e=>{let{childPath:n}=e;return o.Xy(n,t)})))||void 0===n?void 0:n.childTable}function A(e,t){var n;const o=M[e];if(o)return null===(n=o.find((e=>t===e.childTable)))||void 0===n?void 0:n.childPath}function R(e,t){return T[e.command].invert(e,t)}function D(e,t){return T[e.command].derivePrimitiveOperations(e,t)}},19531:(e,t,n)=>{n.d(t,{$O:()=>tt,KD:()=>ce,xR:()=>nt,RE:()=>ot});n(57658),n(30541);var o=n(30120),i=n(57347),r=n(53965),a=n(7032),s=n(41432),l=n(99036),c=n(80951),d=n(97531),u=n(9291),p=n(19584),m=n(84795),f=n(68626),g=n(5773),h=n(59730),v=n(30845),b=n(23512),y=n(482),_=n(21202),S=n(6287),w=n(13493),k=n(70203);const I="PartialMatch",C="FullMatch",x="ColumnCategory",T=(0,u.defineMessages)({titleColumnName:{id:"database.titleColumn.name",defaultMessage:"Title"},genericColumnName:{id:"database.genericColumn.name",defaultMessage:"Column {columnNumber}"}});function M(e){const{table:t,deps:{intl:n,randomShortID:o,isPhoneNumber:i},options:{useCsvAdaptiveSchema:a}}=e,s=function(e,t,n,o){var i;let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5?arguments[5]:void 0;e=e.filter((e=>e.some((e=>Boolean((e.text||"").trim())))));const l=e.length>0?e[0].length:0,d=e.map(((e,t)=>({row:e,rowIndex:t}))).filter((e=>{let{row:t}=e;return t.length!==l}));if(d.length>0){const e=d[0];throw new h.p8("CsvImportError",{data:{},clientData:{type:"csv_import_inconsistent_columns",messageValues:{numTitleColumns:l,numBadRows:d.length,firstBadRowIndex:e.rowIndex+1,firstBadRow:JSON.stringify(e.row.map((e=>e.text))),firstBadRowLength:e.row.length}}})}const u=null===(i=e[0])||void 0===i?void 0:i.length;null==s||s.set(x,function(e){return e<50?"lessthan50":e<100?"lessthan100":e<500?"lessthan500":e<1e3?"lessthan1000":e<5e3?"lessthan5000":"greaterthan5000"}(u));let p=[];1===e.length?p=e[0].map(((e,n)=>t.formatMessage(T.genericColumnName,{columnNumber:n+1}))):e.length>1&&(p=e[0].map((e=>e.text)),e.shift());const m=e,g=function(e){return[{test:N.bind(null,e),sampledSchemaIsComplete:!0},{test:B,sampledSchemaIsComplete:!0},{test:V,sampledSchemaIsComplete:!0},{test:L,sampledSchemaIsComplete:!0},{test:O,sampledSchemaIsComplete:!0},{test:E,sampledSchemaIsComplete:!1},{test:z,sampledSchemaIsComplete:!1},{test:W,sampledSchemaIsComplete:!1},{test:H,sampledSchemaIsComplete:!0}]}(o),v=r.oA(r.Ri(m).map((e=>e.length&&e[0].columnType?e[0].columnType:function(e,t,n,o,i,a){const s=t.filter((e=>Boolean(e)));if(0===s.length)return H(e,s);if(i)for(const r of o){const o=r.test(e,s,n);if(o){let n=o;if(!1===o.isFullMatch){f.log({level:"info",from:"csvHelper",type:"csvColumnTypes",data:{message:"Partial column type match detected, setting data type as string",columnType:o.schema.type,matchType:"Partial"}}),n=H(e,t);const i=(null==a?void 0:a.get(I))||0;null==a||a.set(I,i+1)}else f.log({level:"info",from:"csvHelper",type:"csvColumnTypes",data:{message:"Complete column type match detected",columnType:o.schema.type,matchType:"Full"}});const i=(null==a?void 0:a.get(C))||0;return null==a||a.set(C,i+1),n}}else{const t=s.filter((e=>!r.xb(e))).slice(0,100);for(const i of o){const o=i.test(e,t,n);if(o){const r=i.sampledSchemaIsComplete||t.length===s.length?o:i.test(e,s,n);if(r){if(!1===r.isFullMatch){f.log({level:"info",from:"csvHelper",type:"csvColumnTypes",data:{message:"Partial column type match detected, Potential data loss due to parsing failures",columnType:r.schema.type,matchType:"Partial"}});const e=(null==a?void 0:a.get(I))||0;null==a||a.set(I,e+1)}else{const e=(null==a?void 0:a.get(C))||0;null==a||a.set(C,e+1)}return r}}}}return H(e,[])}(t,e.map((e=>null==e?void 0:e.text)),n,g,a,s)))),b=p.map((()=>!1));for(let r=0;r<p.length;r++)if("text"===v[r].schema.type)for(let e=0;e<m.length;e++){const t=m[e][r].textValue;if(t)for(const n of t)if(k.AJd(n)){b[r]=!0,e=m.length;break}}let y=!0;const _={title:{type:"title",name:t.formatMessage(T.titleColumnName)}};p.forEach(((e,t)=>{const o=v[t];if(o)if("text"===o.schema.type&&y&&!b[t]){y=!1,o.id="title",o.schema={type:"title",name:e};const t=_.title;t&&(t.name=e)}else{const t=n();o.id=t,_[t]={name:e,...o.schema}}}));const S=m.map((e=>{const t={};return v.forEach(((n,o)=>{if(n){const{id:i,schema:r,coerce:a}=n,{type:s}=r;if(i){const n=e[o]||"";t[i]="url"===s?c.iD(n.text):"date"===s?c.d7(a(n.text)):"text"===s?n.textValue||k.TPx(a(n.text)):"file"===s?n.textValue||[]:k.TPx(a(n.text))}}})),t}));return{schema:_,types:v,pages:S}}(t,n,o,i,a,e.csvEvalContext);return function(e){const{actor:t,blockType:n,rootId:o,parent:i,name:a,format:s,deps:{randomID:c,secureFileS3Url:d,secureFileS3UrlV2:u},options:{ignoreBlockCount:p},pages:m,schema:f,columnIds:h}=e,v=c(),b=c(),I=Date.now(),C=[],x={id:v,version:0,parent_table:_.iU,parent_id:o,space_id:i.spaceId,name:k.TPx(a),schema:f,alive:!0,format:{collection_page_properties:r.oA(h.map((e=>{if(e)return{visible:!0,property:e}})))}};C.push(y.op.set({pointer:{table:S.vF,id:v,spaceId:i.spaceId},path:[],args:x}));const T={id:o,version:0,type:n,collection_id:v,format:{collection_pointer:{table:S.vF,id:v,spaceId:i.spaceId}},view_ids:[b],alive:!0,created_by_table:t.table,created_by_id:t.id,created_time:I,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:I,parent_id:i.id,parent_table:i.table,space_id:i.spaceId};C.push(y.op.update({pointer:{table:_.iU,id:o,spaceId:i.spaceId},path:[],args:T}));const M=function(e){const{actor:t,collectionId:n,spaceId:o,pages:i,ignoreBlockCount:r,secureFileS3Url:a,secureFileS3UrlV2:s,randomID:l}=e,c=Date.now();return i.map((e=>{const i=l(),d={id:i,version:0,parent_id:n,parent_table:S.vF,space_id:o,type:"page",created_by_table:t.table,created_by_id:t.id,created_time:c,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:c,properties:e,...r?{ignore_block_count:!0}:void 0,alive:!0};if(a&&s){const e=(0,g.ZP)(d,a,s);e.length>0&&(d.file_ids=e.map((e=>e.id)))}return{id:i,operation:y.op.set({pointer:{table:_.iU,id:i,spaceId:o},path:[],args:d})}}))}({actor:t,collectionId:v,secureFileS3Url:d,secureFileS3UrlV2:u,spaceId:i.spaceId,pages:m,ignoreBlockCount:p,randomID:c});M.forEach((e=>{let{operation:t}=e;return C.push(t)}));const P={id:b,version:0,type:"table",name:"Show All",parent_id:o,parent_table:"block",space_id:i.spaceId,format:{table_properties:r.oA(h.map((e=>{if(e)return{visible:!0,property:e}}))),...s},page_sort:M.map((e=>e.id)).slice(0,l.gq),alive:!0};return C.push(y.op.set({pointer:{table:w.np,id:b,spaceId:i.spaceId},path:[],args:P})),{operations:C}}({...s,columnIds:s.types.map((e=>e.id)),...e})}const P=["yes","Yes","true","True","checked"],A=["no","No","false","False","unchecked"];function R(e){return P.some((t=>e===t))||A.some((t=>e===t))}function D(e,t){return e.length===t.length}function E(e,t){if(t.every(R))return{schema:{type:"checkbox"},validate:R,coerce:e=>P.some((t=>e===t))?l.bx:l.HC}}function B(e,t){const n=t.map(b._g),o=n[0];if(o&&n.every((e=>Boolean(e&&e.format===o.format))))return{schema:{type:"number",number_format:o.format},validate(e){const t=b._g(e);return!p.z4(t)&&t.format===o.format},coerce(e){const t=b._g(e);return`${t?t.value:void 0}`}}}function F(e,t){if(parseInt(t)&&t.length<=6)return!1;const n=m._1(t,e);return Boolean(n)}function O(e,t){const n=t.filter((t=>F(e,t)));if(n.length>=t.length/2)return{schema:{type:"date"},validate:t=>F(e,t),coerce:t=>m._1(t,e),isFullMatch:D(t,n)}}function Z(e){return e.length<320&&e.includes("@")&&v.B(e,"email")}function V(e,t){const n=t.filter(Z);if(n.length>=t.length/2)return{schema:{type:"email"},validate:Z,coerce:r.yR,isFullMatch:D(t,n)}}function U(e){return e.length<320&&v.B(e,"url")}function L(e,t){const n=t.filter(U);if(n.length>=t.length/2)return{schema:{type:"url"},validate:U,coerce:r.yR,isFullMatch:D(t,n)}}function j(e,t){return!String(t).match(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)&&e(String(t))}function N(e,t,n){const o=j.bind(null,e),i=n.filter(o);if(i.length>=n.length/2)return{schema:{type:"phone_number"},validate:o,coerce:r.yR,isFullMatch:D(n,i)}}function z(e,t,n){const o=[];t.forEach((e=>e.split(",").forEach((e=>o.push(e.trim())))));const i=new Set(o);if(a=i.size,s=o.length,c=t.length,s>c&&q(a,s)){return{schema:{type:"multi_select",options:Array.from(i).map(((e,t)=>({id:n(),value:e,color:(0,l.TL)([])})))},validate:e=>i.has(e),coerce:r.yR}}var a,s,c}function q(e,t){return e>0&&e**2<t}function W(e,t,n){const o=new Set(t);if(q(o.size,t.length)){return{schema:{type:"select",options:Array.from(o).map(((e,t)=>({id:n(),value:e,color:(0,l.TL)([])})))},validate:e=>o.has(e),coerce:r.yR}}}function H(e,t){return{schema:{type:"text"},validate:r._z,coerce:r.yR}}var K=n(53877),G=n(95538),$=n(15095),Q=n(43593),Y=n(19233),J=n(70279),X=n(33709),ee=n(19889);const te=n(60809),ne={CommentAuthor:"cma",CommentDiscussionId:"cmm"},oe={a:!0,strong:!0,em:!0,code:!0,del:!0,s:!0,span:!0,time:!0},ie={meta:!0,style:!0,script:!0,head:!0,title:!0},re="sourceCode",ae=700,se=1e5;function le(e){if(!e)return;const t=parseInt(e);return isNaN(t)?void 0:t}const ce={[k.GKr.Page]:"data-notion-page-id",spaceId:"data-notion-space-id",[k.GKr.Highlight]:"data-notion-highlight",[k.GKr.User]:"data-notion-user-id",[k.GKr.Discussion]:"data-notion-block-discussion-id",[k.GKr.Equation]:"data-notion-inline-equation",[k.GKr.Comment]:"data-notion-block-comment-id",[ne.CommentAuthor]:"data-notion-block-comment-author-id",[ne.CommentDiscussionId]:"data-notion-block-comment-discussion-id",[s.Ti.code]:"data-notion-code-syntax",[s.Ti.callout]:"data-notion-callout",calloutIcon:"data-notion-callout-icon",calloutBackground:"data-notion-callout-background",[s.Ti.tableOfContents]:"data-notion-toc",[s.Ti.file]:"data-notion-file",fileAlias:"data-notion-file-alias",[s.Ti.columnList]:"data-notion-column-list",[s.Ti.column]:"data-notion-column-ratio",[s.Ti.video]:"data-notion-video",[s.Ti.audio]:"data-notion-audio",[s.Ti.pdf]:"data-notion-pdf",[s.Ti.equation]:"data-notion-equation",dateFormat:"data-notion-date-format"};function de(e,t){return t&&t.nodeType===e.Node.ELEMENT_NODE}function ue(e,t){return e.nodeType===t.Node.TEXT_NODE||e instanceof t.Element&&oe[e.tagName.toLowerCase()]}function pe(e,t,n){var o;let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(t&&1===e.nodeType&&e.hasAttribute(ce[k.GKr.Comment]))return i;if(n&&"pre"===(null===(o=e.tagName)||void 0===o?void 0:o.toLowerCase()))return i;i.push(e);for(const r of $.p4(e.childNodes))pe(r,t,n,i);return i}function me(e){const t=[];if(!e.parentNode)return t;let n=e.parentNode;for(;n;)t.push(n),n=n.parentNode||void 0;return t}function fe(e,t){const n=me(e).filter((e=>e instanceof t.Element&&("ul"===e.tagName.toLowerCase()||"ol"===e.tagName.toLowerCase()))).length;return n}const ge=["â€¢","â—¦","â–ª"],he=["h1","h2","h3","h4","h5","h6"].map((e=>`${e}:not(:first-child)`)).join(", ");function ve(e){const{node:t,window:n,stripText:i,stripSurroundingWhitespace:r,timeZone:s,ignoreComments:l,ignoreCodeBlock:c}=e;if(!i){for(const e of Array.from(t.querySelectorAll("p:not(:first-child)")))e.prepend("\n");for(const e of Array.from(t.querySelectorAll(he)))e.prepend("\n");for(const e of Array.from(t.querySelectorAll("ul > li"))){const t=fe(e,n)-1,o=t%ge.length,i=ge[o],r="    ".repeat(t);e.prepend(`\n${r}${i} `)}for(const e of Array.from(t.querySelectorAll("ol"))){const t=fe(e,n),o="    ".repeat(t);for(let n=0;n<e.children.length;n+=1){e.children[n].prepend(`\n${o}${n+1}. `)}}for(const e of Array.from(t.querySelectorAll("pre")))e.parentNode&&e.parentNode.insertBefore(n.document.createTextNode("\n\n"),e)}const d=[],u=pe(t,l,c).filter((e=>e.nodeType===n.Node.TEXT_NODE&&(!i||!/^( |\t)*(\n)+( |\t)*$/.test(e.data))));let p=!0;u.forEach(((e,l)=>{let c=e.data;i&&(c=c.replace(/\[ \] /g,""),c=c.replace(/\[x\] /g,""),c=c.replace(/^[\-\*\â€¢]\s?/g,""),c=c.replace(/(\s)+/g,"$1")),!t.hasAttribute("confluenceTabSpaces")&&0===l&&r&&(c=c.trimStart()),l===u.length-1&&p&&r&&(c=c.trimEnd());const m=[],f=me(e);let g;!i&&f.some((e=>e instanceof n.Element&&("h1"===e.tagName.toLowerCase()||"h2"===e.tagName.toLowerCase()||"h3"===e.tagName.toLowerCase()||"h4"===e.tagName.toLowerCase()||"h5"===e.tagName.toLowerCase()||"h6"===e.tagName.toLowerCase())))&&m.push([k.GKr.Bold]),f.some((e=>e instanceof n.Element&&"strong"===e.tagName.toLowerCase()))&&m.push([k.GKr.Bold]),f.some((e=>e instanceof n.Element&&"em"===e.tagName.toLowerCase()))&&m.push([k.GKr.Italic]),f.some((e=>e instanceof n.Element&&"u"===e.tagName.toLowerCase()))&&m.push([k.GKr.Underline]),f.some((e=>e instanceof n.Element&&("code"===e.tagName.toLowerCase()||"pre"===e.tagName.toLowerCase())))&&m.push([k.GKr.Code]),f.some((e=>e instanceof n.Element&&("del"===e.tagName.toLowerCase()||"strike"===e.tagName.toLowerCase()||"s"===e.tagName.toLowerCase())))&&m.push([k.GKr.Strike]);const h=f.find((e=>{var t;return e instanceof n.Element&&(e.hasAttribute(ce[k.GKr.Highlight])||(null===(t=e.parentElement)||void 0===t?void 0:t.hasAttribute(ce[k.GKr.Highlight])))}));if(h&&h instanceof n.Element){var v;const e=h.getAttribute(ce[k.GKr.Highlight]),t=null===(v=h.parentElement)||void 0===v?void 0:v.getAttribute(ce[k.GKr.Highlight]),n=at(e&&"undefined"!==e?e||"":t||"");n&&m.push([k.GKr.Highlight,n])}const b=f.find((e=>e instanceof n.Element&&"a"===e.tagName.toLowerCase()));if(b){const e=b.getAttribute(ce[k.GKr.Page]),t=b.getAttribute("notionUserId")||b.getAttribute(ce[k.GKr.User]),n=b.getAttribute(ce.spaceId),o=b.getAttribute(ce[k.GKr.Comment]);"string"==typeof e&&(0,a.e)(e)&&"string"==typeof n&&(0,a.e)(n)?g=k.$0A(e,n):b.href?m.push(k.edl(b.href)):"string"==typeof t&&(0,a.e)(t)?(g=k.tEo(t),b.getAttribute("notionUserId")&&l===u.length-2&&(p=!1)):o&&n&&(0,a.e)(o)&&(0,a.e)(n)&&(g=k.mfJ(o,n))}const y=f.find((e=>!!(e instanceof n.Element&&e.getAttribute(ce[k.GKr.Discussion]))));if(y){const e=y.getAttribute(ce[k.GKr.Discussion]);if(e){e.split(",").forEach((e=>m.push(k.jw(e))))}}const _=f.find((e=>e instanceof n.Element&&"sub"===e.tagName.toLowerCase()));let S;"true"===(null==_?void 0:_.getAttribute("confluenceProcessableEquation"))&&(S=`_{${_.textContent}}`);const w=f.find((e=>e instanceof n.Element&&"sup"===e.tagName.toLowerCase()));let I;"true"===(null==w?void 0:w.getAttribute("confluenceProcessableEquation"))&&(I=`^{${w.textContent}}`);const C=f.find((e=>e instanceof n.Element&&e.hasAttribute(ce[k.GKr.Equation])));let x;null!=C&&C.textContent&&(x=C.textContent);const T=f.find((e=>e instanceof n.Element&&"time"===e.tagName.toLowerCase()));if(T){const e=T.getAttribute("datetime");if(e){const t=function(e,t){const n=o.ou.fromISO(e),i=n.toMillis();return i===n.startOf("day").toMillis()?K.OQ.toPersistedDate(i,t):K.OQ.toPersistedDateTime(i,t)}(e,s),n={...t};"relative"===T.getAttribute(ce.dateFormat)&&(n.date_format="relative"),g=k.pZr(n)}}g?d.push(k.YCD(g,m)):S?d.push(k.qZ6(S,m)):I?d.push(k.qZ6(I,m)):x?d.push(k.qZ6(x,m)):d.push(k.V3y(c,m))}));return k.Zdj(d,se)}function be(e,t){const n=["img[src]","a[download]",`a[${ce[s.Ti.file]}]`,`audio[${ce[s.Ti.audio]}]`,`video[${ce[s.Ti.video]}]`];t&&n.push("pre");const o=e.querySelectorAll(n.join(","));return $.p4(o)}function ye(e){const{actor:t,parent:n,node:o,allOperations:i,deps:{importFileMap:r,window:a,secureFileS3Url:s,secureFileS3UrlV2:l,intl:c,randomID:d,randomShortID:u,isPhoneNumber:p},options:{ignoreBlockCount:m,considerCodeBlockAsNonTextItem:f}}=e;return ze({actor:t,parent:n,nodes:be(o,f),allOperations:i,deps:{importFileMap:r,window:a,secureFileS3Url:s,secureFileS3UrlV2:l,intl:c,randomID:d,randomShortID:u,isPhoneNumber:p},options:{ignoreBlockCount:m}})}function _e(e){const{actor:t,parent:n,node:o,type:i,allOperations:r,options:{ignoreBlockCount:a,stripText:s,stripSurroundingWhitespace:l,ignoreCodeBlock:c},deps:{window:d,randomID:u}}=e,p=u(),m={id:p,version:0,type:i,properties:{title:ve({node:o,window:d,stripText:s,stripSurroundingWhitespace:l,ignoreComments:!0,ignoreCodeBlock:c})},parent_id:n.id,parent_table:n.table,space_id:n.spaceId,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!a||void 0};return r.push(y.op.set({pointer:{table:_.iU,id:p,spaceId:n.spaceId},path:[],args:m})),Ne({node:o,spaceId:n.spaceId,window:d,blockId:p,actor:t,allOperations:r}),p}function Se(e){const{actor:t,parent:n,node:o,tableData:i,allOperations:r,deps:{intl:a,secureFileS3Url:l,secureFileS3UrlV2:c,randomID:d,randomShortID:u,window:m,isPhoneNumber:f},options:{ignoreBlockCount:g,tableType:h}}=e,v=d();if("table"===h){const{operations:e}=function(e){const{table:t,actor:n,parent:o,tableId:i,deps:{randomID:r,randomShortID:a},options:{ignoreBlockCount:l}}=e,c=Date.now(),d=[],u=t.length?t[0].map((e=>a())):[],m=t.map((e=>r()));d.push(y.op.set({pointer:{id:i,table:_.iU,spaceId:o.spaceId},path:[],args:{id:i,version:0,type:s.Ti.table,content:m,format:{table_block_column_order:u},properties:{},parent_id:o.id,space_id:o.spaceId,parent_table:o.table,created_by_table:n.table,created_by_id:n.id,created_time:c,last_edited_by_table:n.table,last_edited_by_id:n.id,last_edited_time:c,alive:!0,ignore_block_count:!!l||void 0}}));const f=m.map(((e,r)=>{const a=p.m8(u.flatMap(((e,n)=>{var o;const i=null===(o=t[r])||void 0===o||null===(o=o[n])||void 0===o?void 0:o.textValue;return i?[[e,i]]:[]})));return y.op.set({pointer:{id:e,table:_.iU,spaceId:o.spaceId},path:[],args:{id:e,version:0,type:s.Ti.tableRow,parent_id:i,parent_table:_.iU,alive:!0,space_id:o.spaceId,properties:a,created_by_table:n.table,created_by_id:n.id,created_time:c,last_edited_by_table:n.table,last_edited_by_id:n.id,last_edited_time:c}})}));return d.push(...f),{operations:d}}({actor:t,tableId:v,parent:n,table:i,deps:{randomID:d,randomShortID:u},options:{ignoreBlockCount:g}});r.push(...e),Ne({node:o,spaceId:n.spaceId,window:m,blockId:v,actor:t,allOperations:r})}else if("collection"===h){const{operations:e}=M({actor:t,blockType:"collection_view",rootId:v,parent:n,name:"",format:{table_wrap:!0},table:i,deps:{secureFileS3Url:l,secureFileS3UrlV2:c,intl:a,randomID:d,randomShortID:u,isPhoneNumber:f},options:{ignoreBlockCount:g}});r.push(...e)}return v}function we(e){const{actor:t,parent:n,allOperations:o,deps:{randomID:i},options:{ignoreBlockCount:r}}=e,a=i(),l={id:a,version:0,type:s.Ti.divider,parent_id:n.id,parent_table:n.table,space_id:n.spaceId,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!r||void 0};return o.push(y.op.set({pointer:{table:_.iU,id:a,spaceId:n.spaceId},path:[],args:l})),a}function ke(e){const{actor:t,parent:n,source:o,allOperations:i,deps:{secureFileS3Url:r,secureFileS3UrlV2:a,randomID:l},options:{ignoreBlockCount:c,fallbackWidth:d}}=e;let u;"image"===o.type&&o.width?u=Math.min(o.width,ae):d&&(u=Math.min(d,ae));const p=l(),m={id:p,version:0,type:s.Ti.image,properties:{source:k.TPx(o.url)},format:{block_width:u},parent_id:n.id,parent_table:n.table,space_id:n.spaceId,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!c||void 0},f=(0,g.ZP)(m,r,a);return m.file_ids=f.map((e=>e.id)),i.push(y.op.set({pointer:{table:_.iU,id:p,spaceId:n.spaceId},path:[],args:m})),p}function Ie(e){const{actor:t,parent:n,node:o,sourceUrl:i,allOperations:r,deps:{randomID:a},options:{ignoreBlockCount:s}}=e,l=le(o.getAttribute("height")),c=le(o.getAttribute("width")),d=a();let u;try{u=new URL(i)}catch(m){u=i}const p={id:d,version:0,type:G.Dz({url:i,baseUrl:u instanceof URL?u.origin:u,publicDomainName:""}),properties:{source:k.TPx(i)},format:{block_width:c,block_height:l,block_full_width:!1,block_page_width:!(c||l),block_preserve_scale:!0},parent_id:n.id,parent_table:n.table,space_id:n.spaceId,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!s||void 0};return r.push(y.op.set({pointer:{table:_.iU,id:d,spaceId:n.spaceId},path:[],args:p})),d}function Ce(e){const{actor:t,parent:n,source:o,allOperations:i,deps:{secureFileS3Url:r,secureFileS3UrlV2:a,randomID:s},options:{ignoreBlockCount:l}}=e,d=s(),u=G.Dz({url:o.url,baseUrl:o.url,publicDomainName:""}),p={id:d,version:0,type:"embed"===u?"file":u,properties:{title:k.TPx((0,Q.w2)(o.url)),source:c.iD(o.url)},format:{block_width:"image"===o.type&&o.width?Math.min(o.width,ae):void 0},parent_id:n.id,parent_table:n.table,space_id:n.spaceId,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!l||void 0},m=(0,g.ZP)(p,r,a);return p.file_ids=m.map((e=>e.id)),i.push(y.op.set({pointer:{table:_.iU,id:d,spaceId:n.spaceId},path:[],args:p})),d}function xe(e){return"#text"===e.nodeName?e.textContent?e.textContent:"":Array.from(e.childNodes).map((e=>{const t=e.nodeName.toLowerCase();return"br"===t?"\n":"div"===t?`${xe(e)}\n`:xe(e)})).map((e=>e.split("\n").map((e=>e.trimRight())).join("\n"))).join("")}function Te(e){const{actor:t,parent:n,node:o,allOperations:i,deps:{importFileMap:r,window:a,secureFileS3Url:l,secureFileS3UrlV2:c,intl:d,randomID:u,randomShortID:p,isPhoneNumber:m},options:{ignoreBlockCount:f}}=e,g=u(),h=o.getAttribute(ce.calloutBackground),v=h?at(h):void 0,b=o.getAttribute(ce.calloutIcon),S=b&&b.match(te())?b:void 0,{title:w,children:k}=function(e){const{node:t,window:n}=e,o=$.p4(t.childNodes),[i,...r]=o;if(!i)return{title:[]};return function(e){return t=>!!(de(e,t)&&t instanceof e.HTMLParagraphElement)}(n)(i)?{title:ve({node:i,window:n,stripText:!1,stripSurroundingWhitespace:!0,ignoreComments:!0}),children:r}:ue(i,n)?{title:ve({node:t,window:n,stripText:!1,stripSurroundingWhitespace:!0,ignoreComments:!0}),children:void 0}:{title:[],children:o}}({node:o,window:a}),I=Array.isArray(k)?ze({actor:t,parent:{table:_.iU,id:g,spaceId:n.spaceId},nodes:k,allOperations:i,deps:{importFileMap:r,window:a,secureFileS3Url:l,secureFileS3UrlV2:c,intl:d,randomID:u,randomShortID:p,isPhoneNumber:m},options:{ignoreBlockCount:f}}):[],C={id:g,version:0,type:s.Ti.callout,content:I,properties:{title:w},format:{block_color:v,page_icon:S},parent_id:n.id,parent_table:n.table,space_id:n.spaceId,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!f||void 0};return i.push(y.op.set({pointer:{table:_.iU,id:g,spaceId:n.spaceId},path:[],args:C})),Ne({node:o,spaceId:n.spaceId,window:a,blockId:g,actor:t,allOperations:i}),g}function Me(e){const{actor:t,parent:n,node:o,allOperations:i,deps:{importFileMap:r,secureFileS3Url:a,secureFileS3UrlV2:l,randomID:c},options:{ignoreBlockCount:d}}=e,u=o.getAttribute(ce[s.Ti.file])||"",p=r[u]?r[u].url:u;let m=o.getAttribute(ce.fileAlias)||"";!m&&p.lastIndexOf("/")>=0&&(m=p.substring(p.lastIndexOf("/")+1));const f=c(),h={alive:!0,created_by_id:t.id,created_by_table:t.table,created_time:Date.now(),id:f,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),parent_id:n.id,parent_table:n.table,space_id:n.spaceId,properties:{source:k.TPx(p),title:k.TPx(m)},type:s.Ti.file,version:0,ignore_block_count:!!d||void 0},v=(0,g.ZP)(h,a,l);return h.file_ids=v.map((e=>e.id)),i.push(y.op.set({pointer:{table:_.iU,id:f,spaceId:n.spaceId},path:[],args:h})),f}const Pe=/language-(\w+)/;function Ae(e){let t=null;return null==e||e.forEach(((e,n,o)=>{if(t)return;if(Y.Y.hasOwnProperty(e))return void(t=e);const i=e.match(Pe);i&&i.length>1&&Y.Y.hasOwnProperty(i[1])&&(t=i[1])})),t}function Re(e){const{actor:t,parent:n,node:o,allOperations:i,deps:{randomID:r,window:a},options:{ignoreBlockCount:l}}=e,c=r();let d=o.getAttribute(ce[s.Ti.code]);if(!d){var u;d=Ae(null===(u=o.querySelector("code"))||void 0===u||null===(u=u.parentElement)||void 0===u?void 0:u.classList)}if(!d){var p;d=Ae(null===(p=o.querySelector("code"))||void 0===p?void 0:p.classList)}const m=d&&Y.Y[d]?Y.Y[d]:"Plain Text",f={id:c,version:0,type:s.Ti.code,properties:{title:k.TPx(xe(o)),language:k.TPx(m)},format:{code_wrap:!0},parent_id:n.id,parent_table:n.table,space_id:n.spaceId,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!l||void 0};return i.push(y.op.set({pointer:{table:_.iU,id:c,spaceId:n.spaceId},path:[],args:f})),Ne({node:o,spaceId:n.spaceId,window:a,blockId:c,actor:t,allOperations:i}),c}function De(e){const{actor:t,parent:n,node:o,allOperations:i,deps:{randomID:r},options:{ignoreBlockCount:a}}=e,l=r(),c={id:l,version:0,type:s.Ti.equation,properties:{title:k.TPx(xe(o))},parent_id:n.id,parent_table:n.table,space_id:n.spaceId,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!a||void 0};return i.push(y.op.set({pointer:{table:_.iU,id:l,spaceId:n.spaceId},path:[],args:c})),l}function Ee(e){const{actor:t,parent:n,allOperations:o,deps:{randomID:i},options:{ignoreBlockCount:r}}=e,a=i(),l={id:a,version:0,type:s.Ti.tableOfContents,format:{block_color:"gray"},parent_id:n.id,parent_table:n.table,space_id:n.spaceId,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!r||void 0};return o.push(y.op.set({pointer:{table:_.iU,id:a,spaceId:n.spaceId},path:[],args:l})),a}function Be(e){const{actor:t,parent:n,node:o,allOperations:i,deps:{importFileMap:r,window:a,secureFileS3Url:l,secureFileS3UrlV2:c,intl:d,randomID:u,randomShortID:p,isPhoneNumber:m},options:{ignoreBlockCount:f}}=e,g=u(),[h,...v]=$.p4(o.childNodes),b=ze({actor:t,parent:n,nodes:v,allOperations:i,deps:{importFileMap:r,window:a,secureFileS3Url:l,secureFileS3UrlV2:c,intl:d,randomID:u,randomShortID:p,isPhoneNumber:m},options:{ignoreBlockCount:f}}),S={id:g,version:0,type:s.Ti.quote,properties:{title:k.TPx(null!=h&&h.textContent?h.textContent.trim():"")},content:b,parent_id:n.id,parent_table:n.table,space_id:n.spaceId,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!f||void 0};return i.push(y.op.set({pointer:{table:_.iU,id:g,spaceId:n.spaceId},path:[],args:S})),Ne({node:o,spaceId:n.spaceId,blockId:g,actor:t,allOperations:i,window:a}),g}function Fe(e){const{actor:t,parent:n,node:o,allOperations:i,deps:{importFileMap:r,window:a,secureFileS3Url:l,secureFileS3UrlV2:c,intl:d,randomID:u,randomShortID:p,isPhoneNumber:m},options:{ignoreBlockCount:f}}=e,g=u(),h=o.querySelector("summary"),v=$.p4(o.childNodes).filter((e=>e!==h)),b=h&&h.textContent&&ve({node:h,window:a,stripText:!1,stripSurroundingWhitespace:!0,ignoreComments:!0}),S=ze({actor:t,parent:{id:g,table:_.iU,spaceId:n.spaceId},nodes:v,allOperations:i,deps:{importFileMap:r,window:a,secureFileS3Url:l,secureFileS3UrlV2:c,intl:d,randomID:u,randomShortID:p,isPhoneNumber:m},options:{ignoreBlockCount:f}}),w={id:g,version:0,type:s.Ti.toggle,content:S,properties:{title:b||k.TPx("")},parent_id:n.id,parent_table:n.table,space_id:n.spaceId,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!f||void 0};return i.push(y.op.set({pointer:{table:_.iU,id:g,spaceId:n.spaceId},path:[],args:w})),g}function Oe(e){const{actor:t,parent:n,node:o,allOperations:i,deps:{importFileMap:r,window:a,secureFileS3Url:l,secureFileS3UrlV2:c,intl:d,randomID:u,randomShortID:p,isPhoneNumber:m},options:{ignoreBlockCount:f}}=e,g=u(),h=$.p4(o.children).filter((e=>e.hasAttribute(ce[s.Ti.column]))).slice(0,8).map((e=>function(e){const{actor:t,parent:n,node:o,allOperations:i,deps:{importFileMap:r,window:a,secureFileS3Url:l,secureFileS3UrlV2:c,intl:d,randomID:u,randomShortID:p,isPhoneNumber:m},options:{ignoreBlockCount:f}}=e,g=u(),h=o.getAttribute(ce[s.Ti.column]);let v;if(null!==h){const e=parseFloat(h);!Number.isNaN(e)&&e>0&&e<=1&&(v=e)}const b=ze({actor:t,parent:{id:g,table:_.iU,spaceId:n.spaceId},nodes:$.p4(o.children),allOperations:i,deps:{importFileMap:r,window:a,secureFileS3Url:l,secureFileS3UrlV2:c,intl:d,randomID:u,randomShortID:p,isPhoneNumber:m},options:{ignoreBlockCount:f}}),S={id:g,version:0,type:s.Ti.column,format:{column_ratio:v},content:b,parent_id:n.id,parent_table:n.table,space_id:n.spaceId,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!f||void 0};return i.push(y.op.set({pointer:{table:_.iU,id:g,spaceId:n.spaceId},path:[],args:S})),g}({actor:t,parent:{id:g,table:_.iU,spaceId:n.spaceId},node:e,allOperations:i,deps:{importFileMap:r,window:a,secureFileS3Url:l,secureFileS3UrlV2:c,intl:d,randomID:u,randomShortID:p,isPhoneNumber:m},options:{ignoreBlockCount:f}}))),v={id:g,version:0,type:s.Ti.columnList,content:h,parent_id:n.id,parent_table:n.table,space_id:n.spaceId,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!f||void 0};return i.push(y.op.set({pointer:{table:_.iU,id:g,spaceId:n.spaceId},path:[],args:v})),g}const Ze=/^\[x\].*/,Ve=/^\[ \].*/,Ue=/^[-\*\â€¢].*/;function Le(e){const{actor:t,parent:n,node:o,allOperations:i,deps:{importFileMap:r,window:a,secureFileS3Url:c,secureFileS3UrlV2:d,intl:u,randomID:p,randomShortID:m,isPhoneNumber:f},options:{ignoreBlockCount:g}}=e,h=p(),v=a.document.createElement("span"),b=[];$.p4(o.childNodes).forEach(((e,t)=>{0===t&&function(e,t){return e instanceof t.Element&&"a"===e.tagName.toLowerCase()&&e.hasAttribute(ce[s.Ti.file])}(e,a)?b.push(e):0===t&&!(function(e,t){return e instanceof t.Element&&"img"===e.tagName.toLowerCase()}(e,a)||function(e,t){return e instanceof t.Element&&"video"===e.tagName.toLowerCase()}(e,a)||function(e,t){return e instanceof t.Element&&"audio"===e.tagName.toLowerCase()}(e,a))||ue(e,a)?(v.appendChild(e),e instanceof a.Element&&be(e).forEach((e=>b.push(e)))):b.push(e)}));const S=ze({actor:t,parent:{id:h,table:_.iU,spaceId:n.spaceId},nodes:b,allOperations:i,deps:{importFileMap:r,window:a,secureFileS3Url:c,secureFileS3UrlV2:d,intl:u,randomID:p,randomShortID:m,isPhoneNumber:f},options:{ignoreBlockCount:g}}),w=Ze.test(v.textContent||""),I=Ve.test(v.textContent||"");let C;C=w||I?s.Ti.toDo:o.parentNode instanceof a.Element&&"ol"===o.parentNode.tagName.toLowerCase()?s.Ti.numberedList:s.Ti.bulletedList;let x=!1;C===s.Ti.toDo&&w&&(x=!0);const T={id:h,version:0,type:C,content:S,properties:{title:ve({node:v,window:a,stripText:!0,stripSurroundingWhitespace:!0,ignoreComments:!0}),checked:x?k.TPx(l.bx):void 0},parent_id:n.id,parent_table:n.table,space_id:n.spaceId,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!g||void 0};return i.push(y.op.set({pointer:{table:_.iU,id:h,spaceId:n.spaceId},path:[],args:T})),Ne({node:v,spaceId:n.spaceId,blockId:h,actor:t,allOperations:i,window:a}),h}function je(e){const{node:t,spaceId:n,window:o,actor:i,discussionId:r,allOperations:a}=e,s=Array.from(t.querySelectorAll(`span[${ce[ne.CommentDiscussionId]}="${r}"]`)),l=Date.now(),c=[];for(const d of s){if(null===d.textContent||0===d.textContent.trim().length)continue;const e=d.getAttribute(ce[k.GKr.Comment]);if(!e)continue;const t=ve({node:d,window:o,stripText:!0,stripSurroundingWhitespace:!0,ignoreComments:!1}),s=d.getAttribute(ce[ne.CommentAuthor]);c.push(e);const u={id:e,parent_id:r,parent_table:X.qF,space_id:n,version:1,created_time:l,last_edited_time:l,text:t,created_by_table:ee.KJ,created_by_id:s||i.id,alive:!0};a.push(y.op.set({pointer:{table:J.x_,id:e,spaceId:n},path:[],args:u}))}return c}function Ne(e){const{node:t,spaceId:n,blockId:o,actor:i,allOperations:r,window:a}=e,s=Array.from(t.querySelectorAll(`span[${ce[k.GKr.Discussion]}]`)),l=new Map;for(const c of s){const e=c.getAttribute(ce[k.GKr.Discussion]);if(!e)continue;e.split(",").forEach((e=>{if(l.has(e)){var t;null===(t=l.get(e))||void 0===t||null===(t=t.context)||void 0===t||t.push([c.textContent??"",[[k.GKr.Discussion,e]]])}else{const t={id:e,type:"default",parent_id:o,parent_table:_.iU,resolved:!1,context:[[c.textContent??"",[[k.GKr.Discussion,e]]]],space_id:n,version:0};l.set(e,t)}}))}!function(e){const{node:t,spaceId:n,window:o,blockId:i,actor:r,discussionToTextMap:a,allOperations:s}=e;for(const[l,c]of a.entries()){const e=je({node:t,spaceId:n,window:o,discussionId:l,actor:r,allOperations:s});0!==e.length&&(c.comments=e,s.push(y.op.set({pointer:{table:X.qF,id:l,spaceId:n},path:[],args:c}),{pointer:{table:_.iU,id:i,spaceId:n},command:"listAfter",path:["discussions"],args:{id:l}}))}}({node:t,spaceId:n,window:a,blockId:o,actor:i,discussionToTextMap:l,allOperations:r})}function ze(e){const{actor:t,parent:n,nodes:o,allOperations:i,deps:a,htmlParserErrors:s,options:l}=e;return r.G0(...o.map((e=>qe({actor:t,parent:n,node:e,allOperations:i,deps:a,htmlParserErrors:s,options:l}))))}function qe(e){const{actor:t,parent:n,node:o,allOperations:a,deps:l,htmlParserErrors:d,options:{ignoreBlockCount:u,treatNestedCodeAsCodeBlocks:p}}=e,{importFileMap:m,window:f,secureFileS3Url:g,secureFileS3UrlV2:h,intl:v,randomID:b}=l;if(o&&o instanceof f.Element){const e=o.tagName.toLowerCase();if("div"===e&&"page-comments"===o.getAttribute("class")){return[st({node:o,window:f,allOperations:a,parent:n})]}if("h1"===e)return[_e({actor:t,parent:n,node:o,type:s.Ti.header,allOperations:a,deps:{window:f,randomID:b},options:{ignoreBlockCount:u,stripText:!0,stripSurroundingWhitespace:!0}}),...ye({actor:t,parent:n,node:o,allOperations:a,deps:l,options:{ignoreBlockCount:u}})];if("h2"===e)return[_e({actor:t,parent:n,node:o,type:s.Ti.subHeader,allOperations:a,deps:{window:f,randomID:b},options:{ignoreBlockCount:u,stripText:!0,stripSurroundingWhitespace:!0}}),...ye({actor:t,parent:n,node:o,allOperations:a,deps:l,options:{ignoreBlockCount:u}})];if("hr"===e)return[we({actor:t,parent:n,allOperations:a,deps:{randomID:b},options:{ignoreBlockCount:u}})];if("h"===e[0])return[_e({actor:t,parent:n,node:o,type:s.Ti.subSubHeader,allOperations:a,deps:{window:f,randomID:b},options:{ignoreBlockCount:u,stripText:!0,stripSurroundingWhitespace:!0}}),...ye({actor:t,parent:n,node:o,allOperations:a,deps:l,options:{ignoreBlockCount:u}})];if("pre"===e||"code"===e||"div"===e&&o.className===re)return[Re({actor:t,parent:n,node:o,allOperations:a,deps:{randomID:b,window:f},options:{ignoreBlockCount:u}}),...ye({actor:t,parent:n,node:o,allOperations:a,deps:l,options:{ignoreBlockCount:u}})];if(o.hasAttribute(ce[s.Ti.callout]))return[Te({actor:t,parent:n,node:o,allOperations:a,deps:l,options:{ignoreBlockCount:u}})];if("blockquote"===e)return[Be({actor:t,parent:n,node:o,allOperations:a,deps:l,options:{ignoreBlockCount:u}})];if("details"===e)return[Fe({actor:t,parent:n,node:o,allOperations:a,deps:l,options:{ignoreBlockCount:u}})];if("table"===e){const{tableData:p,tableFiles:g}=function(e){const{node:t,window:n,importFileMap:o,intl:i}=e,a=[],l=[],d=Array.from(t.querySelectorAll("tr")).filter((e=>e.closest("table")===t));for(const u of d){const e=[],t=[],d=Array.from(u.querySelectorAll("td, th")).filter((e=>e.closest("tr")===u));for(const i of d){const a=(i.textContent||"").trim(),l=We(i.getAttribute("rowspan"),1);e.push({text:a,textValue:ve({node:i,window:n,stripText:!1,stripSurroundingWhitespace:!0,ignoreComments:!0}),rowSpan:l});const c=We(i.getAttribute("colspan"),1);for(let t=1;t<c;t++)e.push({text:"",rowSpan:l});const d=be(i);if(d.length){const e=r.oA(d.flatMap((e=>{var t;const n=e.getAttribute("src")||e.getAttribute(ce[s.Ti.file])||e.getAttribute(ce[s.Ti.audio])||e.getAttribute(ce[s.Ti.video]),i=e.getAttribute(ce.fileAlias);return n?{name:i||n,url:(null===(t=o[n])||void 0===t?void 0:t.url)||n}:void 0})));t.push(...e)}}e.length&&l.push(e);const p=c.CC(t);a.push({text:i.formatMessage({id:"htmlHelpers.table.fileColumnName",defaultMessage:"Files"}),textValue:p})}for(let r=0;r<l.length;r++){const e=l[r];for(let t=0;t<e.length;t++){const n=e[t].rowSpan;if(n>1)for(let e=1;e<n&&!(r+e>=l.length);e++){l[r+e].splice(t,0,{text:"",rowSpan:1})}}}return{tableData:l,tableFiles:a}}({node:o,window:f,importFileMap:m,intl:v});if(g.some((e=>{var t;return null===(t=e.textValue)||void 0===t?void 0:t.length})))for(let e=0;e<p.length;e++)p[e].push({text:g[e].text,textValue:g[e].textValue,columnType:{schema:{type:"file"},validate:r._z,coerce:r.yR}});let h="table";if(g.some((e=>{var t;return null===(t=e.textValue)||void 0===t?void 0:t.length}))&&(h="collection"),0===r.Ar(p).length)return[];if(n.table===S.vF||n.table===J.x_)return[];const b={...n,table:n.table};try{return[Se({actor:t,parent:b,node:o,tableData:p,allOperations:a,deps:l,options:{ignoreBlockCount:u,tableType:h}})]}catch(y){const t=(0,i.t)(y);if(!d||"CsvImportError"!==t.message)throw y;const n=d.get(e)||0;return d.set(e,n+1),[]}}if("div"===e&&o.hasAttribute(ce[s.Ti.columnList]))return[Oe({actor:t,parent:n,node:o,allOperations:a,deps:l,options:{ignoreBlockCount:u}})];if("nav"===e&&o.hasAttribute(ce[s.Ti.tableOfContents]))return[Ee({actor:t,parent:n,allOperations:a,deps:{randomID:b},options:{ignoreBlockCount:u}}),...ye({actor:t,parent:n,node:o,allOperations:a,deps:l,options:{ignoreBlockCount:u}})];if("ul"===e||"ol"===e)return r.G0(...r.UI(o.children,(e=>qe({actor:t,parent:n,node:e,allOperations:a,deps:l,options:{ignoreBlockCount:u}}))));if("li"===e||Ze.test(o.textContent||"")||Ve.test(o.textContent||"")||Ue.test(o.textContent||""))return[Le({actor:t,parent:n,node:o,allOperations:a,deps:l,options:{ignoreBlockCount:u}})];if("img"===e){const e=o.getAttribute("src");if(e)return[ke({actor:t,parent:n,source:m[e]||{type:"unknown",url:e},allOperations:a,deps:{secureFileS3Url:g,secureFileS3UrlV2:h,randomID:b},options:{ignoreBlockCount:u,fallbackWidth:o instanceof f.HTMLImageElement?o.width:void 0}})]}if("a"===e&&o.getAttribute(ce[s.Ti.file]))return[Me({actor:t,parent:n,node:o,allOperations:a,deps:{importFileMap:m,secureFileS3Url:g,secureFileS3UrlV2:h,randomID:b},options:{ignoreBlockCount:u}})];if("a"===e&&0===$.p4(o.childNodes).length){const e=o.getAttribute("href");if(o.hasAttribute("download")&&e)return[Ce({actor:t,parent:n,source:m[e]||{type:"unknown",url:e},allOperations:a,deps:{secureFileS3Url:g,secureFileS3UrlV2:h,randomID:b},options:{ignoreBlockCount:u}})]}if("video"===e){const e=o.querySelector("source");if(e){const o=e.getAttribute("src");if(o&&G.xL({url:o}))return[Ce({actor:t,parent:n,source:{type:"unknown",url:o},allOperations:a,deps:{secureFileS3Url:g,secureFileS3UrlV2:h,randomID:b},options:{ignoreBlockCount:u}})]}}if("audio"===e){const e=o.querySelector("source");if(e){const o=e.getAttribute("src");if(o&&G._c({url:o}))return[Ce({actor:t,parent:n,source:{type:"unknown",url:o},allOperations:a,deps:{secureFileS3Url:g,secureFileS3UrlV2:h,randomID:b},options:{ignoreBlockCount:u}})]}}if("iframe"===e){const e=o.getAttribute("src");if(e)return[Ie({actor:t,parent:n,node:o,sourceUrl:e,allOperations:a,deps:{randomID:b},options:{ignoreBlockCount:u}})]}return"p"===e&&o.getAttribute("confluenceNewLine")?[_e({actor:t,parent:n,node:o,type:s.Ti.text,allOperations:a,deps:{window:f,randomID:b},options:{ignoreBlockCount:u,stripText:!0,stripSurroundingWhitespace:!0}})]:o.hasAttribute(ce[s.Ti.equation])?[De({actor:t,parent:n,node:o,allOperations:a,deps:{randomID:b},options:{ignoreBlockCount:u}})]:[.../^\s*$/g.test(o.textContent||"")?[]:[_e({actor:t,parent:n,node:o,type:s.Ti.text,allOperations:a,deps:{window:f,randomID:b},options:{ignoreBlockCount:u,stripText:!1,stripSurroundingWhitespace:!0,ignoreCodeBlock:p}})],...ye({actor:t,parent:n,node:o,allOperations:a,deps:l,options:{ignoreBlockCount:u,considerCodeBlockAsNonTextItem:p}})]}return[]}function We(e,t){const n=null!==e?parseInt(e,10):t;return isFinite(n)?n:t}function He(e){if(e&&-1!==e.indexOf("em"))return parseInt(e)}function Ke(e,t,n){const o=n.document.createElement(t);for(;e.firstChild;)o.appendChild(e.firstChild);for(let i=e.attributes.length-1;i>=0;--i){const t=e.attributes[i];o.setAttribute(t.name,t.value)}return e.parentNode&&e.parentNode.replaceChild(o,e),o}function Ge(e,t,n){const o=n.document.createElement(t);for(;e.firstChild;)o.appendChild(e.firstChild);e.appendChild(o)}function $e(e){const t=[];let n=e;for(;e.firstChild;){const o=e.firstChild;t.push(o),e.parentNode&&e.parentNode.insertBefore(o,n.nextSibling),n=o}const o=e.parentNode;return o&&(o.removeChild(e),o.normalize()),t}const Qe=1e4;function Ye(e,t){!function(e,t){const n=Array.from(e.querySelectorAll("p"));for(const o of n){let e=o.firstChild,n=0;for(;e&&n<Qe;){let i=!1;if(e instanceof t.Element&&null!==e.textContent&&!e.textContent.trim()){const t=Array.from(e.querySelectorAll("br"));if(t.length>0){for(const n of t)o.insertBefore(n,e);i=!0}}const r=e.nextSibling;i&&o.removeChild(e),e=r,n+=1}}}(e,t);const n=Array.from(e.querySelectorAll("p"));for(let o=0;o<Qe;o++){const e=n.shift();if(!e||!e.parentNode)return;const o=e.querySelector("br");if(!o)continue;if(o.parentElement!==e)continue;const i=t.document.createElement("p");e.parentNode.insertBefore(i,e.nextSibling);let r=o.nextSibling;for(;r;){const e=r.nextSibling;i.appendChild(r),r=e}e.removeChild(o),n.unshift(i)}}function Je(e){const t=e.match(/^([0-9]+)px$/i);if(t)return parseInt(t[1])}function Xe(e){const{rootNode:t,window:n,isInlineContent:o,emojiData:i}=e;!function(e){const{rootNode:t,window:n,emojiData:{emojiByName:o}}=e,i=Array.from(t.querySelectorAll("img[data-stringify-emoji]"));for(const r of i){const e=r.getAttribute("data-stringify-emoji")||"",t=e.match(/^:(.+):$/);if(!t||!r.parentNode)continue;const i=o[t[1]]||e;r.parentNode.replaceChild(n.document.createTextNode(i),r)}}({rootNode:t,window:n,emojiData:i}),t.normalize(),Ye(t,n);const a=$.p4(t.childNodes);for(;a.length>0;){let e=a.shift();if(e instanceof n.Element&&e.parentNode&&"google-sheets-html-origin"===e.tagName.toLowerCase()){const t=$.p4(e.childNodes);for(const n of t)e.parentNode.insertBefore(n,e);a.unshift(...t),e.remove()}else if(e&&e.parentNode&&3===e.nodeType&&/^( |\t)*(\n)+( |\t)*$/.test(e.data))e.parentNode.removeChild(e);else if(e&&e instanceof n.Element&&e.parentNode&&ie[e.tagName.toLowerCase()])e.parentNode.removeChild(e);else{if(e instanceof n.HTMLElement){const t=(s=e.style.fontSize||void 0)&&-1!==s.indexOf("px")||s&&-1!==s.indexOf("pt")?parseInt(s):void 0,o=He(e.style.fontSize||void 0);(t&&t>=24||o&&o>2)&&(e=Ke(e,"h1",n))}if(e instanceof n.HTMLElement&&("line-through"===e.style.textDecoration&&Ge(e,"del",n),"italic"===e.style.fontStyle&&Ge(e,"em",n),("bold"===e.style.fontWeight||e.style.fontWeight&&parseInt(e.style.fontWeight)>=500)&&Ge(e,"strong",n)),e instanceof n.HTMLImageElement){const t=Je(e.style.width);!e.width&&t&&(e.width=t)}if(e instanceof n.HTMLElement&&("b"===e.tagName.toLowerCase()?e=Ke(e,"strong",n):"i"===e.tagName.toLowerCase()&&(e=Ke(e,"em",n))),e instanceof n.HTMLElement&&"strong"===e.tagName.toLowerCase()&&"normal"===e.style.fontWeight&&(e=Ke(e,"span",n)),e instanceof n.HTMLElement&&("section"===e.tagName.toLowerCase()||"article"===e.tagName.toLowerCase())&&(e=Ke(e,"div",n)),e instanceof n.HTMLElement&&"div"===e.tagName.toLowerCase()&&"inline"===e.style.display&&(e=Ke(e,"span",n)),e instanceof n.HTMLElement&&"input"===e.tagName.toLowerCase()&&"checkbox"===e.type){const t=e.checked,o=e.parentNode,i=n.document.createElement("span");i.textContent=`[${t?"x":" "}] `,o&&(o.insertBefore(i,e),o.removeChild(e)),a.push(i)}else{if(e instanceof n.HTMLElement&&"table"===e.tagName.toLowerCase()){const t=Array.from(e.querySelectorAll("tr")).map((e=>e.querySelectorAll("td, th")));if(t.every((e=>1===e.length))){const o=n.document.createDocumentFragment();for(const e of t){const t=e[0],i=t.childNodes.length;for(let e=0;e<i;e+=1){const n=t.childNodes[e];n&&(o.appendChild(n.cloneNode(!0)),a.push(n))}o.appendChild(n.document.createElement("hr"))}e.parentNode&&e.parentNode.replaceChild(o,e)}}if(e instanceof n.HTMLElement&&("ul"===e.tagName.toLowerCase()||"ol"===e.tagName.toLowerCase())&&e.parentNode instanceof n.HTMLElement&&("ul"===e.parentNode.tagName.toLowerCase()||"ol"===e.parentNode.tagName.toLowerCase())&&e.previousSibling instanceof n.HTMLElement&&"li"===e.previousSibling.tagName.toLowerCase()&&e.previousSibling.appendChild(e),e instanceof n.Element&&(e.removeAttribute("style"),e.removeAttribute("dir")),e instanceof n.Element&&"span"===e.tagName.toLowerCase()){if("page-comment"===e.getAttribute("class"))continue;(e.hasAttribute(ce[k.GKr.Highlight])||e.hasAttribute(ce[k.GKr.Discussion])||e.hasAttribute(ce[k.GKr.Comment])||e.hasAttribute(ce[k.GKr.Equation])?Array.from(e.children):$e(e)).forEach((e=>a.push(e)))}else if(e){$.p4(e.childNodes).forEach((e=>a.push(e)))}}}}var s;for($.p4(t.childNodes).forEach((e=>a.push(e)));a.length>0;){const e=a.shift();if(e)if(et(e,n)&&r.yW(e.childNodes,(e=>e instanceof n.Element&&"h1"===e.tagName.toLowerCase()))){const t=n.document.createElement("h1");r.S6(e.childNodes,(e=>{r.S6(e.childNodes,(e=>{e&&t.appendChild(e)}))}));const o=e.parentNode;if(o){if("td"===e.tagName.toLowerCase()||"th"===e.tagName.toLowerCase()){const i=n.document.createElement(e.tagName.toLowerCase());i.appendChild(t),o.insertBefore(i,e)}else o.insertBefore(t,e);o.removeChild(e)}a.push(t)}else if(et(e,n)&&r.yW(e.childNodes,(e=>e instanceof n.Element&&"h2"===e.tagName.toLowerCase()))){const t=n.document.createElement("h2");r.S6(e.childNodes,(e=>{r.S6(e.childNodes,(e=>{e&&t.appendChild(e)}))}));const o=e.parentNode;if(o){if("td"===e.tagName.toLowerCase()||"th"===e.tagName.toLowerCase()){const i=n.document.createElement(e.tagName.toLowerCase());i.appendChild(t),o.insertBefore(i,e)}else o.insertBefore(t,e);o.removeChild(e)}a.push(t)}else if(e instanceof n.HTMLElement&&("div"===e.tagName.toLowerCase()||"span"===e.tagName.toLowerCase())&&e.parentNode&&0===e.childNodes.length)e.parentNode.removeChild(e);else if(!et(e,n)||"p"!==e.tagName.toLowerCase()&&"div"!==e.tagName.toLowerCase()&&"figure"!==e.tagName.toLowerCase()||!$.p4(e.childNodes).some((e=>e instanceof n.Element&&("p"===e.tagName.toLowerCase()||"div"===e.tagName.toLowerCase()||"img"===e.tagName.toLowerCase()||"ul"===e.tagName.toLowerCase()||"table"===e.tagName.toLowerCase()||"hr"===e.tagName.toLowerCase()||"video"===e.tagName.toLowerCase())))){if(e&&e.childNodes){$.p4(e.childNodes).forEach((e=>a.push(e)))}}else{$e(e).forEach((e=>a.push(e)))}}t.normalize(),o||$.p4(t.childNodes).forEach((e=>{if(3===e.nodeType){const o=n.document.createElement("p");t.insertBefore(o,e),o.appendChild(e)}}))}function et(e,t){return e instanceof t.Element&&(0!==e.childNodes.length&&!(e.hasAttribute(ce[s.Ti.columnList])||e.hasAttribute(ce[s.Ti.column])||e.hasAttribute(ce[s.Ti.callout])))}function tt(e){const{actor:t,parent:n,rootNode:o,deps:i,htmlParserErrors:r,options:a}=e;Xe({rootNode:o,window:i.window,isInlineContent:!1,emojiData:i.emojiData});const s=[],l=ze({actor:t,parent:n,nodes:$.p4(o.children),allOperations:s,deps:i,htmlParserErrors:r,options:a});return{allOperations:d.Vt(s,a.useCrdt),rootContentIds:l}}function nt(e){const{node:t,window:n,stripText:o,stripSurroundingWhitespace:i,emojiData:r}=e;return Xe({rootNode:t,window:n,isInlineContent:!0,emojiData:r}),ve({node:t,window:n,stripText:o,stripSurroundingWhitespace:i,ignoreComments:!0})}function ot(e){const{node:t,window:n,emojiData:o}=e;return Xe({rootNode:t,window:n,isInlineContent:!1,emojiData:o}),rt(t,n)}const it=new Set(["span","div","p"]);function rt(e,t){const n=e.tagName.toLowerCase();if(!it.has(n))return!0;if("div"===n&&(e.className===re||e.hasAttribute(ce[s.Ti.columnList])))return!0;for(const o of Array.from(e.childNodes))if(de(t,o)&&rt(o,t))return!0;return!1}function at(e){if("default"===e||"gray"===e||"brown"===e||"orange"===e||"yellow"===e||"teal"===e||"blue"===e||"purple"===e||"pink"===e||"red"===e||"gray_background"===e||"brown_background"===e||"orange_background"===e||"yellow_background"===e||"teal_background"===e||"blue_background"===e||"purple_background"===e||"pink_background"===e||"red_background"===e)return e}function st(e){const{node:t,parent:n,window:o,allOperations:i}=e,r=(0,a.ZP)();return i.push(y.op.set({pointer:{table:X.qF,id:r,spaceId:n.spaceId},path:[],args:{type:"default",id:r,parent_id:n.id,parent_table:_.iU,resolved:!1,space_id:n.spaceId,version:1}}),{pointer:n,path:["discussions"],command:"listAfter",args:{id:r}}),t.querySelectorAll("span").forEach((e=>{const t=`${e.getAttribute("data-author-name")} commented: ${e.innerHTML.replace("\n"," ")}`;e.innerHTML=t;const s=ve({node:e,window:o,stripText:!0,stripSurroundingWhitespace:!0,ignoreComments:!0}),l=(0,a.ZP)(),c=Date.now();i.push(y.op.set({pointer:{table:J.x_,id:l,spaceId:n.spaceId},path:[],args:{id:l,parent_id:r,parent_table:X.qF,alive:!0,space_id:n.spaceId,created_time:c,last_edited_time:c,version:1}}),{pointer:{table:X.qF,id:r,spaceId:n.spaceId},path:["comments"],command:"listAfter",args:{id:l}},y.op.update({pointer:{table:J.x_,id:l,spaceId:n.spaceId},path:["text"],args:s}),{pointer:{table:J.x_,id:l,spaceId:n.spaceId},path:[],command:"update",args:{created_by_id:ee.UO.id,created_by_table:ee.KJ}})})),r}},52897:(e,t,n)=>{n.d(t,{d:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("aiImproveWriting",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8.84082 0.982422C8.84082 0.524414 8.45801 0.134766 8 0.134766C7.54199 0.134766 7.15234 0.524414 7.15234 0.982422V3.06738C7.15234 3.52539 7.54199 3.9082 8 3.9082C8.45801 3.9082 8.84082 3.52539 8.84082 3.06738V0.982422ZM10.9463 3.9082C10.6318 4.22949 10.6318 4.77637 10.96 5.10449C11.2744 5.41895 11.8281 5.41895 12.1494 5.09082L13.5781 3.66211C13.8994 3.34766 13.8926 2.79395 13.5645 2.46582C13.25 2.14453 12.6963 2.1582 12.375 2.47949L10.9463 3.9082ZM3.84375 5.09082C4.16504 5.41895 4.71875 5.41895 5.0332 5.10449C5.36133 4.77637 5.36133 4.22949 5.04688 3.9082L3.625 2.47949C3.30371 2.1582 2.75 2.14453 2.43555 2.46582C2.10742 2.78711 2.10742 3.34082 2.42188 3.65527L3.84375 5.09082ZM13.3047 14.9277C13.7148 15.3447 14.4121 15.3379 14.8154 14.9277C15.2188 14.5107 15.2188 13.834 14.8154 13.417L8.32812 6.88184C7.91797 6.47168 7.2207 6.47168 6.81738 6.88184C6.40723 7.29883 6.41406 7.97559 6.81738 8.38574L13.3047 14.9277ZM0.931641 7.19629C0.473633 7.19629 0.0908203 7.5791 0.0908203 8.03711C0.0908203 8.49512 0.473633 8.87793 0.931641 8.87793H3.0166C3.47461 8.87793 3.86426 8.49512 3.86426 8.03711C3.86426 7.5791 3.47461 7.19629 3.0166 7.19629H0.931641ZM15.0615 8.87793C15.5195 8.87793 15.9092 8.49512 15.9092 8.03711C15.9092 7.5791 15.5195 7.19629 15.0615 7.19629H12.9834C12.5254 7.19629 12.1357 7.5791 12.1357 8.03711C12.1357 8.49512 12.5254 8.87793 12.9834 8.87793H15.0615ZM9.62695 10.1357L7.49414 7.99609C7.32324 7.83203 7.26172 7.62012 7.43262 7.45605C7.58301 7.30566 7.80176 7.36035 7.97266 7.53125L10.0918 9.65723L9.62695 10.1357ZM2.42188 12.3984C2.10059 12.7197 2.09375 13.2734 2.4082 13.5879C2.72949 13.916 3.2832 13.9229 3.60449 13.6084L5.0332 12.1797C5.35449 11.8584 5.36133 11.3115 5.04688 10.9902C4.72559 10.6689 4.17188 10.6621 3.85059 10.9766L2.42188 12.3984ZM8.84082 13.0137C8.84082 12.5557 8.45801 12.166 8 12.166C7.54199 12.166 7.15234 12.5557 7.15234 13.0137V15.0918C7.15234 15.5498 7.54199 15.9395 8 15.9395C8.45801 15.9395 8.84082 15.5498 8.84082 15.0918V13.0137Z"})})},9999:(e,t,n)=>{n.d(t,{J:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("alias",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M13.1475 10.5869V3.72363C13.1475 3.25195 12.833 2.93066 12.3477 2.93066H5.48438C5.02637 2.93066 4.70508 3.27246 4.70508 3.67578C4.70508 4.07227 5.05371 4.40039 5.46387 4.40039H7.89746L10.8438 4.30469L9.59961 5.39844L3.08496 11.9199C2.92773 12.0771 2.8457 12.2686 2.8457 12.46C2.8457 12.8564 3.20801 13.2256 3.61816 13.2256C3.80957 13.2256 3.99414 13.1504 4.15137 12.9932L10.6729 6.47168L11.7803 5.22754L11.6641 8.05762V10.6074C11.6641 11.0176 11.9922 11.373 12.4023 11.373C12.8057 11.373 13.1475 11.0312 13.1475 10.5869Z"})})},82477:(e,t,n)=>{n.d(t,{L:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("alignCenter",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M14.44 15.325H1.554a.598.598 0 01-.602-.602c0-.335.267-.601.602-.601H14.44c.334 0 .608.266.608.601a.604.604 0 01-.608.602zm0-13.447H1.554a.598.598 0 01-.602-.601c0-.335.267-.602.602-.602H14.44c.334 0 .608.267.608.602a.604.604 0 01-.608.601zm-8.736 10.34h4.738c1.12 0 1.776-.65 1.776-1.905V5.687c0-1.254-.656-1.905-1.922-1.905H5.704c-1.266 0-1.922.65-1.922 1.905v4.626c0 1.254.656 1.905 1.922 1.905zm.07-1.149c-.545 0-.843-.28-.843-.85V5.78c0-.568.298-.85.843-.85h4.452c.539 0 .843.282.843.85v4.44c0 .568-.304.85-.697.85H5.774z"})})},70622:(e,t,n)=>{n.d(t,{$:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("alignLeft",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M14.44 15.325H1.554a.598.598 0 01-.602-.602c0-.335.267-.601.602-.601H14.44c.334 0 .608.266.608.601a.604.604 0 01-.608.602zm0-13.447H1.554a.598.598 0 01-.602-.601c0-.335.267-.602.602-.602H14.44c.334 0 .608.267.608.602a.604.604 0 01-.608.601zM3.372 12.218H8.11c1.12 0 1.776-.65 1.776-1.905V5.687c0-1.254-.657-1.905-1.922-1.905H3.372c-1.266 0-1.922.65-1.922 1.905v4.626c0 1.254.656 1.905 1.922 1.905zm.07-1.149c-.545 0-.844-.28-.844-.85V5.78c0-.568.3-.85.844-.85h4.451c.54 0 .844.282.844.85v4.44c0 .568-.305.85-.697.85H3.442z"})})},53376:(e,t,n)=>{n.d(t,{g:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("alignRight",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M14.44 15.325H1.554a.598.598 0 01-.602-.602c0-.335.267-.601.602-.601H14.44c.334 0 .608.266.608.601a.604.604 0 01-.608.602zm0-13.447H1.554a.598.598 0 01-.602-.601c0-.335.267-.602.602-.602H14.44c.334 0 .608.267.608.602a.604.604 0 01-.608.601zm-6.408 10.34h4.738c1.12 0 1.776-.65 1.776-1.905V5.687c0-1.254-.657-1.905-1.922-1.905H8.032c-1.266 0-1.922.65-1.922 1.905v4.626c0 1.254.656 1.905 1.922 1.905zm.07-1.149c-.545 0-.844-.28-.844-.85V5.78c0-.568.3-.85.844-.85h4.451c.54 0 .844.282.844.85v4.44c0 .568-.305.85-.697.85H8.102z"})})},33907:(e,t,n)=>{n.d(t,{n:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("arrowRight",{viewBox:"0 0 30 30",svg:(0,i.jsx)("polygon",{points:"1 14 25.188 14 16.594 5.406 18 4 29 15 18 26 16.594 24.594 25.188 16 1 16"})})},12970:(e,t,n)=>{n.d(t,{O:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("assistFindActionItems",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M3.15503 7.44971C4.80298 7.44971 6.16748 6.0918 6.16748 4.43726C6.16748 2.78271 4.80957 1.41821 3.15503 1.41821C1.4939 1.41821 0.135986 2.78271 0.135986 4.43726C0.135986 6.0918 1.4939 7.44971 3.15503 7.44971ZM2.79248 6.06543C2.63428 6.06543 2.50903 5.97974 2.40356 5.85449L1.66528 4.97778C1.58618 4.87891 1.55322 4.7998 1.55322 4.68774C1.55322 4.45044 1.7312 4.27246 1.95532 4.27246C2.10034 4.27246 2.18604 4.33179 2.28491 4.45044L2.78589 5.0437L3.95264 3.17822C4.05151 3.02002 4.17017 2.94751 4.32178 2.94751C4.55249 2.94751 4.74365 3.1189 4.74365 3.33643C4.74365 3.42871 4.71729 3.5144 4.64478 3.62646L3.18799 5.84131C3.0957 5.97974 2.95068 6.06543 2.79248 6.06543ZM8.47461 5.16235H15.1257C15.5278 5.16235 15.8574 4.84595 15.8574 4.43726C15.8574 4.03516 15.5278 3.71216 15.1257 3.71216H8.47461C8.07251 3.71216 7.74951 4.03516 7.74951 4.43726C7.74951 4.84595 8.07251 5.16235 8.47461 5.16235ZM3.15503 15.0566C4.80957 15.0566 6.16748 13.6921 6.16748 12.0376C6.16748 10.3831 4.80957 9.01855 3.15503 9.01855C1.4939 9.01855 0.135986 10.3831 0.135986 12.0376C0.135986 13.6921 1.4939 15.0566 3.15503 15.0566ZM3.15503 13.6592C2.27173 13.6592 1.53345 12.9209 1.53345 12.0376C1.53345 11.1543 2.27173 10.416 3.15503 10.416C4.03833 10.416 4.77661 11.1543 4.77661 12.0376C4.77661 12.9209 4.03833 13.6592 3.15503 13.6592ZM8.47461 12.7957H15.1257C15.5278 12.7957 15.8574 12.4727 15.8574 12.0706C15.8574 11.6685 15.5278 11.3455 15.1257 11.3455H8.47461C8.07251 11.3455 7.74951 11.6685 7.74951 12.0706C7.74951 12.4727 8.07251 12.7957 8.47461 12.7957Z"})})},12436:(e,t,n)=>{n.d(t,{l:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("audio",{viewBox:"0 0 23.5 24",svg:(0,i.jsx)("path",{d:"M5.258 14.008a.661.661 0 01-.485-.203.702.702 0 01-.195-.492v-2.899c0-.187.065-.351.195-.492a.65.65 0 01.485-.211.67.67 0 01.5.21.694.694 0 01.203.493v2.899a.687.687 0 01-.203.492.68.68 0 01-.5.203zm2.695 3.148a.684.684 0 01-.688-.695V7.266c0-.193.066-.357.196-.493a.66.66 0 01.492-.21c.198 0 .362.07.492.21a.67.67 0 01.203.493v9.195a.67.67 0 01-.203.492.654.654 0 01-.492.203zm2.688 3.032a.645.645 0 01-.485-.204.667.667 0 01-.195-.492V4.234c0-.198.065-.364.195-.5a.645.645 0 01.485-.203.68.68 0 01.5.203.68.68 0 01.203.5v15.258a.654.654 0 01-.203.492.68.68 0 01-.5.203zm2.695-4.047a.684.684 0 01-.492-.196.684.684 0 01-.196-.492v-7.18a.684.684 0 01.688-.695.67.67 0 01.492.203.67.67 0 01.203.492v7.18a.684.684 0 01-.695.688zm2.695 2.328a.68.68 0 01-.695-.696V5.953c0-.193.065-.357.195-.492a.667.667 0 01.5-.211c.193 0 .354.07.485.21a.67.67 0 01.203.493v11.82a.67.67 0 01-.203.493.645.645 0 01-.485.203zm2.688-3.852a.654.654 0 01-.492-.203.675.675 0 01-.196-.484V9.797c0-.188.065-.35.196-.485.13-.14.294-.21.492-.21a.66.66 0 01.492.21.661.661 0 01.203.485v4.133a.661.661 0 01-.203.484.67.67 0 01-.492.203z"})})},90792:(e,t,n)=>{n.d(t,{t:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("bell",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M1.36914 11.7627C1.36914 12.3369 1.80664 12.7266 2.51074 12.7266H5.32031C5.38184 14.0322 6.44824 15.2285 8 15.2285C9.55176 15.2285 10.6182 14.0391 10.6797 12.7266H13.4893C14.2002 12.7266 14.6309 12.3369 14.6309 11.7627C14.6309 11.0381 13.9678 10.416 13.3457 9.81445C12.8672 9.34277 12.751 8.39941 12.6621 7.46289C12.5732 4.87207 11.8213 3.14258 10.0371 2.49316C9.77734 1.59082 9.01855 0.900391 8 0.900391C6.98145 0.900391 6.22266 1.59082 5.96289 2.49316C4.17871 3.14258 3.42676 4.87207 3.33789 7.46289C3.24902 8.39941 3.13965 9.34277 2.6543 9.81445C2.03906 10.416 1.36914 11.0381 1.36914 11.7627ZM3.00293 11.4756V11.3936C3.18066 11.1953 3.57715 10.833 3.91211 10.4434C4.38379 9.90332 4.60254 8.92578 4.6709 7.62695C4.75293 4.85156 5.60059 3.92871 6.70801 3.62793C6.87207 3.58691 6.96777 3.50488 6.98145 3.32031C7.01562 2.62305 7.39844 2.1582 8 2.1582C8.60156 2.1582 8.99121 2.62305 9.01855 3.32031C9.03223 3.50488 9.12793 3.58691 9.29883 3.62793C10.3994 3.92871 11.2539 4.85156 11.3291 7.62695C11.3975 8.92578 11.623 9.90332 12.0879 10.4434C12.4297 10.833 12.8125 11.1953 12.9834 11.3936V11.4756H3.00293ZM6.6123 12.7266H9.3877C9.33984 13.5811 8.7793 14.1348 8 14.1348C7.22754 14.1348 6.66699 13.5811 6.6123 12.7266Z"})})},83096:(e,t,n)=>{n.d(t,{Q:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("book",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M27,23V1H7C4.791,1,3,2.791,3,5v20c0,2.209,1.791,4,4,4h20v-2h-1v-4H27z M21,3v6l-1-1.333L19,9V3H21z M20,11l3,4V3h2v18H9V3 h8v12L20,11z M5,5c0-1.103,0.896-2,2-2v18c-0.729,0-1.411,0.195-2,0.537V5z M24,27H7c-1.104,0-2-0.896-2-2s0.896-2,2-2h17V27z"})})},49089:(e,t,n)=>{n.d(t,{o:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("caption",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.87 8.975h6.74c1.119 0 1.775-.65 1.775-1.904V2.444c0-1.254-.656-1.904-1.922-1.904H2.871C1.605.54.949 1.19.949 2.444V7.07c0 1.254.656 1.904 1.922 1.904zm.07-1.148c-.544 0-.843-.282-.843-.85v-4.44c0-.568.299-.849.844-.849h6.451c.54 0 .844.281.844.85v4.44c0 .567-.305.849-.697.849H2.94zm-1.39 4.386h12.893a.604.604 0 00.608-.601.604.604 0 00-.608-.602H1.55a.598.598 0 00-.601.602c0 .335.266.601.601.601zm8.49 3.247H1.55a.598.598 0 01-.601-.601c0-.335.266-.602.601-.602h8.49c.336 0 .609.267.609.602a.604.604 0 01-.608.601z"})})},36591:(e,t,n)=>{n.d(t,{e:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("check",{viewBox:"0 0 14 14",svg:(0,i.jsx)("polygon",{points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})})},22225:(e,t,n)=>{n.d(t,{g:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("checkPartial",{viewBox:"0 0 14 14",svg:(0,i.jsx)("rect",{x:"1.75",y:"6.125",width:"10.5",height:"1.75"})})},72261:(e,t,n)=>{n.d(t,{v:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("checkboxCircle",{viewBox:"0 0 22 23",svg:(0,i.jsx)("circle",{cx:"11",cy:"11.5",r:"10",stroke:"#E2E1DE",strokeWidth:"2"})})},65628:(e,t,n)=>{n.d(t,{z:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("checkboxSquare",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M1.5,1.5 L1.5,14.5 L14.5,14.5 L14.5,1.5 L1.5,1.5 Z M0,0 L16,0 L16,16 L0,16 L0,0 Z"})})},42853:(e,t,n)=>{n.d(t,{i:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("chevronDown",{viewBox:"0 0 30 30",svg:(0,i.jsx)("polygon",{points:"15,17.4 4.8,7 2,9.8 15,23 28,9.8 25.2,7 "})})},17693:(e,t,n)=>{n.d(t,{A:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("chevronDownRoundedThick",{viewBox:"0 0 12 12",svg:(0,i.jsx)("path",{d:"M6.02734 8.80274C6.27148 8.80274 6.47168 8.71484 6.66211 8.51465L10.2803 4.82324C10.4268 4.67676 10.5 4.49609 10.5 4.28125C10.5 3.85156 10.1484 3.5 9.72363 3.5C9.50879 3.5 9.30859 3.58789 9.15234 3.74902L6.03223 6.9668L2.90722 3.74902C2.74609 3.58789 2.55078 3.5 2.33105 3.5C1.90137 3.5 1.55469 3.85156 1.55469 4.28125C1.55469 4.49609 1.62793 4.67676 1.77441 4.82324L5.39258 8.51465C5.58789 8.71973 5.78808 8.80274 6.02734 8.80274Z"})})},5257:(e,t,n)=>{n.d(t,{o:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("chevronRight",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M12.375 8.06445C12.375 7.83203 12.2861 7.63379 12.1084 7.45605L6.77637 2.24023C6.62598 2.08984 6.44141 2.01465 6.22266 2.01465C5.77832 2.01465 5.42285 2.35645 5.42285 2.80078C5.42285 3.01953 5.51172 3.21777 5.66211 3.375L10.4746 8.06445L5.66211 12.7539C5.51855 12.9043 5.42285 13.1025 5.42285 13.3213C5.42285 13.7725 5.77832 14.1143 6.22266 14.1143C6.44141 14.1143 6.62598 14.0391 6.77637 13.8887L12.1084 8.67285C12.293 8.49512 12.375 8.29688 12.375 8.06445Z"})})},53465:(e,t,n)=>{n.d(t,{X:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("clearInput",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.993 15.528a7.273 7.273 0 01-2.923-.593A7.633 7.633 0 012.653 13.3a7.797 7.797 0 01-1.633-2.417 7.273 7.273 0 01-.593-2.922c0-1.035.198-2.01.593-2.922A7.758 7.758 0 015.063.99 7.273 7.273 0 017.985.395a7.29 7.29 0 012.93.593 7.733 7.733 0 012.417 1.64 7.647 7.647 0 011.64 2.41c.396.914.594 1.888.594 2.923 0 1.035-.198 2.01-.593 2.922a7.735 7.735 0 01-4.058 4.05 7.272 7.272 0 01-2.922.594zM5.59 11.06c.2 0 .371-.066.513-.198L8 8.951l1.904 1.911a.675.675 0 00.498.198.667.667 0 00.491-.198.67.67 0 00.205-.49.64.64 0 00-.205-.491L8.981 7.969l1.92-1.911a.686.686 0 00.204-.491.646.646 0 00-.205-.484.646.646 0 00-.483-.205.67.67 0 00-.49.205L8 6.995 6.081 5.083a.696.696 0 00-.49-.19.682.682 0 00-.491.198.651.651 0 00-.198.49c0 .181.068.342.205.484l1.912 1.904-1.912 1.92a.646.646 0 00-.205.483c0 .19.066.354.198.49.136.132.3.198.49.198z"})})},19525:(e,t,n)=>{n.d(t,{b:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("closeThick",{viewBox:"0 0 8 8",svg:(0,i.jsx)("polygon",{points:"8 1.01818182 6.98181818 0 4 2.98181818 1.01818182 0 0 1.01818182 2.98181818 4 0 6.98181818 1.01818182 8 4 5.01818182 6.98181818 8 8 6.98181818 5.01818182 4"})})},3124:(e,t,n)=>{n.d(t,{_:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("codeOnly",{viewBox:"0 0 24 20",svg:(0,i.jsx)("path",{d:"M8.093 13.62c.458.123.875-.123 1.011-.58l3.364-11.533c.13-.43-.082-.855-.54-.978-.451-.123-.848.075-.998.581L7.58 12.595c-.137.465.041.895.513 1.025zM.115 7.064c0 .233.103.472.301.643l4.423 3.992c.362.328.848.322 1.148-.02.308-.342.267-.834-.082-1.149L2.077 7.064l3.828-3.472c.349-.315.39-.8.082-1.142-.3-.342-.786-.348-1.148-.02L.416 6.415a.879.879 0 00-.3.65zm19.763 0a.878.878 0 00-.3-.649L15.153 2.43c-.362-.328-.847-.322-1.148.02-.308.342-.267.827.082 1.142l3.828 3.472-3.828 3.466c-.349.315-.39.807-.082 1.149.3.341.786.348 1.148.02l4.423-3.992c.198-.17.3-.41.3-.643z"})})},35013:(e,t,n)=>{n.d(t,{i:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("collectionBoard",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.39697 14.4634H13.5964C15.0532 14.4634 15.8311 13.6921 15.8311 12.2485V4.24609C15.8311 2.80249 15.0532 2.03125 13.5964 2.03125H2.39697C0.940186 2.03125 0.162354 2.7959 0.162354 4.24609V12.2485C0.162354 13.6987 0.940186 14.4634 2.39697 14.4634ZM2.52222 12.9934C1.94214 12.9934 1.63232 12.7034 1.63232 12.0969V4.39771C1.63232 3.79126 1.94214 3.50122 2.52222 3.50122H4.92822V12.9934H2.52222ZM6.34546 12.9934V3.50122H9.64795V12.9934H6.34546ZM13.4712 3.50122C14.0447 3.50122 14.3611 3.79126 14.3611 4.39771V12.0969C14.3611 12.7034 14.0447 12.9934 13.4712 12.9934H11.0652V3.50122H13.4712Z"})})},21321:(e,t,n)=>{n.d(t,{N:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("collectionCalendar",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M3.29688 14.4561H12.7031C14.1797 14.4561 14.9453 13.6904 14.9453 12.2344V3.91504C14.9453 2.45215 14.1797 1.69336 12.7031 1.69336H3.29688C1.82031 1.69336 1.05469 2.45215 1.05469 3.91504V12.2344C1.05469 13.6973 1.82031 14.4561 3.29688 14.4561ZM3.27637 13.1162C2.70898 13.1162 2.39453 12.8154 2.39453 12.2207V5.9043C2.39453 5.30273 2.70898 5.00879 3.27637 5.00879H12.71C13.2842 5.00879 13.6055 5.30273 13.6055 5.9043V12.2207C13.6055 12.8154 13.2842 13.1162 12.71 13.1162H3.27637ZM6.68066 7.38086H7.08398C7.33008 7.38086 7.41211 7.30566 7.41211 7.05957V6.66309C7.41211 6.41699 7.33008 6.3418 7.08398 6.3418H6.68066C6.44141 6.3418 6.35938 6.41699 6.35938 6.66309V7.05957C6.35938 7.30566 6.44141 7.38086 6.68066 7.38086ZM8.92285 7.38086H9.31934C9.56543 7.38086 9.64746 7.30566 9.64746 7.05957V6.66309C9.64746 6.41699 9.56543 6.3418 9.31934 6.3418H8.92285C8.67676 6.3418 8.59473 6.41699 8.59473 6.66309V7.05957C8.59473 7.30566 8.67676 7.38086 8.92285 7.38086ZM11.1582 7.38086H11.5547C11.8008 7.38086 11.8828 7.30566 11.8828 7.05957V6.66309C11.8828 6.41699 11.8008 6.3418 11.5547 6.3418H11.1582C10.9121 6.3418 10.8301 6.41699 10.8301 6.66309V7.05957C10.8301 7.30566 10.9121 7.38086 11.1582 7.38086ZM4.44531 9.58203H4.84863C5.09473 9.58203 5.17676 9.50684 5.17676 9.26074V8.86426C5.17676 8.61816 5.09473 8.54297 4.84863 8.54297H4.44531C4.20605 8.54297 4.12402 8.61816 4.12402 8.86426V9.26074C4.12402 9.50684 4.20605 9.58203 4.44531 9.58203ZM6.68066 9.58203H7.08398C7.33008 9.58203 7.41211 9.50684 7.41211 9.26074V8.86426C7.41211 8.61816 7.33008 8.54297 7.08398 8.54297H6.68066C6.44141 8.54297 6.35938 8.61816 6.35938 8.86426V9.26074C6.35938 9.50684 6.44141 9.58203 6.68066 9.58203ZM8.92285 9.58203H9.31934C9.56543 9.58203 9.64746 9.50684 9.64746 9.26074V8.86426C9.64746 8.61816 9.56543 8.54297 9.31934 8.54297H8.92285C8.67676 8.54297 8.59473 8.61816 8.59473 8.86426V9.26074C8.59473 9.50684 8.67676 9.58203 8.92285 9.58203ZM11.1582 9.58203H11.5547C11.8008 9.58203 11.8828 9.50684 11.8828 9.26074V8.86426C11.8828 8.61816 11.8008 8.54297 11.5547 8.54297H11.1582C10.9121 8.54297 10.8301 8.61816 10.8301 8.86426V9.26074C10.8301 9.50684 10.9121 9.58203 11.1582 9.58203ZM4.44531 11.7832H4.84863C5.09473 11.7832 5.17676 11.708 5.17676 11.4619V11.0654C5.17676 10.8193 5.09473 10.7441 4.84863 10.7441H4.44531C4.20605 10.7441 4.12402 10.8193 4.12402 11.0654V11.4619C4.12402 11.708 4.20605 11.7832 4.44531 11.7832ZM6.68066 11.7832H7.08398C7.33008 11.7832 7.41211 11.708 7.41211 11.4619V11.0654C7.41211 10.8193 7.33008 10.7441 7.08398 10.7441H6.68066C6.44141 10.7441 6.35938 10.8193 6.35938 11.0654V11.4619C6.35938 11.708 6.44141 11.7832 6.68066 11.7832ZM8.92285 11.7832H9.31934C9.56543 11.7832 9.64746 11.708 9.64746 11.4619V11.0654C9.64746 10.8193 9.56543 10.7441 9.31934 10.7441H8.92285C8.67676 10.7441 8.59473 10.8193 8.59473 11.0654V11.4619C8.59473 11.708 8.67676 11.7832 8.92285 11.7832Z"})})},69628:(e,t,n)=>{n.d(t,{n:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("collectionGallery",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.0542 7.75952H5.96973C7.00464 7.75952 7.50562 7.25854 7.50562 6.19727V3.58691C7.50562 2.53223 7.00464 2.03125 5.96973 2.03125H2.0542C1.01929 2.03125 0.518311 2.53223 0.518311 3.58691V6.19727C0.518311 7.25854 1.01929 7.75952 2.0542 7.75952ZM10.0303 7.75952H13.9392C14.9741 7.75952 15.4751 7.25854 15.4751 6.19727V3.58691C15.4751 2.53223 14.9741 2.03125 13.9392 2.03125H10.0303C8.98877 2.03125 8.48779 2.53223 8.48779 3.58691V6.19727C8.48779 7.25854 8.98877 7.75952 10.0303 7.75952ZM2.06079 6.55322C1.83008 6.55322 1.71802 6.44116 1.71802 6.20386V3.58032C1.71802 3.34961 1.83008 3.23755 2.06079 3.23755H5.96313C6.18726 3.23755 6.30591 3.34961 6.30591 3.58032V6.20386C6.30591 6.44116 6.18726 6.55322 5.96313 6.55322H2.06079ZM10.0369 6.55322C9.79956 6.55322 9.69409 6.44116 9.69409 6.20386V3.58032C9.69409 3.34961 9.79956 3.23755 10.0369 3.23755H13.9392C14.1633 3.23755 14.2754 3.34961 14.2754 3.58032V6.20386C14.2754 6.44116 14.1633 6.55322 13.9392 6.55322H10.0369ZM2.0542 14.4634H5.96973C7.00464 14.4634 7.50562 13.969 7.50562 12.9077V10.2974C7.50562 9.24268 7.00464 8.7417 5.96973 8.7417H2.0542C1.01929 8.7417 0.518311 9.24268 0.518311 10.2974V12.9077C0.518311 13.969 1.01929 14.4634 2.0542 14.4634ZM10.0303 14.4634H13.9392C14.9741 14.4634 15.4751 13.969 15.4751 12.9077V10.2974C15.4751 9.24268 14.9741 8.7417 13.9392 8.7417H10.0303C8.98877 8.7417 8.48779 9.24268 8.48779 10.2974V12.9077C8.48779 13.969 8.98877 14.4634 10.0303 14.4634ZM2.06079 13.2637C1.83008 13.2637 1.71802 13.1516 1.71802 12.9143V10.2974C1.71802 10.0601 1.83008 9.94141 2.06079 9.94141H5.96313C6.18726 9.94141 6.30591 10.0601 6.30591 10.2974V12.9143C6.30591 13.1516 6.18726 13.2637 5.96313 13.2637H2.06079ZM10.0369 13.2637C9.79956 13.2637 9.69409 13.1516 9.69409 12.9143V10.2974C9.69409 10.0601 9.79956 9.94141 10.0369 9.94141H13.9392C14.1633 9.94141 14.2754 10.0601 14.2754 10.2974V12.9143C14.2754 13.1516 14.1633 13.2637 13.9392 13.2637H10.0369Z"})})},17948:(e,t,n)=>{n.d(t,{O:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("collectionList",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.08716 5.15576C2.64087 5.15576 3.08911 4.70752 3.08911 4.15381C3.08911 3.6001 2.64087 3.15186 2.08716 3.15186C1.53345 3.15186 1.08521 3.6001 1.08521 4.15381C1.08521 4.70752 1.53345 5.15576 2.08716 5.15576ZM5.29736 4.85254H14.2161C14.605 4.85254 14.9148 4.54272 14.9148 4.15381C14.9148 3.76489 14.605 3.45508 14.2161 3.45508H5.29736C4.90845 3.45508 4.59863 3.7583 4.59863 4.15381C4.59863 4.54272 4.90186 4.85254 5.29736 4.85254ZM2.08716 9.24927C2.64087 9.24927 3.08911 8.80103 3.08911 8.24731C3.08911 7.6936 2.64087 7.24536 2.08716 7.24536C1.53345 7.24536 1.08521 7.6936 1.08521 8.24731C1.08521 8.80103 1.53345 9.24927 2.08716 9.24927ZM5.29736 8.94604H14.2161C14.605 8.94604 14.9148 8.64282 14.9148 8.24731C14.9148 7.8584 14.605 7.54858 14.2161 7.54858H5.29736C4.90845 7.54858 4.59863 7.8584 4.59863 8.24731C4.59863 8.63623 4.90186 8.94604 5.29736 8.94604ZM2.08716 13.3428C2.64087 13.3428 3.08911 12.8945 3.08911 12.3408C3.08911 11.7937 2.64087 11.3389 2.08716 11.3389C1.53345 11.3389 1.08521 11.7937 1.08521 12.3408C1.08521 12.8945 1.53345 13.3428 2.08716 13.3428ZM5.29736 13.0396H14.2161C14.605 13.0396 14.9148 12.7363 14.9148 12.3408C14.9148 11.9519 14.605 11.6487 14.2161 11.6487H5.29736C4.90845 11.6487 4.59863 11.9519 4.59863 12.3408C4.59863 12.7297 4.90186 13.0396 5.29736 13.0396Z"})})},49019:(e,t,n)=>{n.d(t,{e:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("collectionSearch",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M0 6.35938C0 9.86719 2.85156 12.7188 6.35938 12.7188C7.66406 12.7188 8.85938 12.3203 9.85938 11.6406L13.4531 15.2344C13.6719 15.4609 13.9766 15.5625 14.2812 15.5625C14.9453 15.5625 15.4219 15.0625 15.4219 14.4141C15.4219 14.1016 15.3125 13.8125 15.1016 13.5938L11.5312 10.0156C12.2734 8.99219 12.7188 7.72656 12.7188 6.35938C12.7188 2.85156 9.86719 0 6.35938 0C2.85156 0 0 2.85156 0 6.35938ZM1.65625 6.35938C1.65625 3.76562 3.75781 1.65625 6.35938 1.65625C8.95312 1.65625 11.0625 3.76562 11.0625 6.35938C11.0625 8.95312 8.95312 11.0625 6.35938 11.0625C3.75781 11.0625 1.65625 8.95312 1.65625 6.35938Z"})})},10405:(e,t,n)=>{n.d(t,{_:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("collectionTimeline",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.5964 14.4634H2.39697C0.940186 14.4634 0.162354 13.6987 0.162354 12.2485V4.24609C0.162354 2.7959 0.940186 2.03125 2.39697 2.03125H13.5964C15.0532 2.03125 15.8311 2.80249 15.8311 4.24609V12.2485C15.8311 13.6921 15.0532 14.4634 13.5964 14.4634ZM1.63232 12.0969C1.63232 12.7034 1.94214 12.9934 2.52222 12.9934H13.4712C14.0447 12.9934 14.3611 12.7034 14.3611 12.0969V4.39771C14.3611 3.79126 14.0447 3.50122 13.4712 3.50122H2.52222C1.94214 3.50122 1.63232 3.79126 1.63232 4.39771V12.0969ZM8.92711 6.13826H2.71776C2.44986 6.13826 2.23645 5.91123 2.23645 5.64787C2.23645 5.37997 2.44986 5.15747 2.71776 5.15747H8.92711C9.19955 5.15747 9.40842 5.37542 9.40842 5.64787C9.40842 5.91577 9.19955 6.13826 8.92711 6.13826ZM11.3757 8.49036H4.75992C4.49201 8.49036 4.2786 8.26332 4.2786 7.99996C4.2786 7.73206 4.49201 7.50957 4.75992 7.50957H11.3757C11.6482 7.50957 11.857 7.72752 11.857 7.99996C11.857 8.26332 11.6482 8.49036 11.3757 8.49036ZM13.2822 10.8424H8.24608C7.97818 10.8424 7.76477 10.6109 7.76477 10.352C7.76477 10.0841 7.97818 9.85711 8.24608 9.85711H13.2822C13.5547 9.85711 13.7636 10.0796 13.7636 10.352C13.7636 10.6154 13.5547 10.8424 13.2822 10.8424Z"})})},75553:(e,t,n)=>{n.d(t,{U:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("copy",{viewBox:"0 0 14 16",svg:(0,i.jsx)("path",{d:"M2.404 15.322h5.701c1.26 0 1.887-.662 1.887-1.927V12.38h1.154c1.254 0 1.91-.662 1.91-1.928V5.555c0-.774-.158-1.266-.626-1.74L9.512.837C9.066.387 8.545.21 7.865.21H5.463c-1.254 0-1.91.662-1.91 1.928v1.084H2.404c-1.254 0-1.91.668-1.91 1.933v8.239c0 1.265.656 1.927 1.91 1.927zm7.588-6.62c0-.792-.1-1.161-.592-1.665L6.225 3.814c-.452-.462-.844-.58-1.5-.591V2.215c0-.533.28-.832.843-.832h2.38v2.883c0 .726.386 1.113 1.107 1.113h2.83v4.998c0 .539-.276.832-.844.832H9.992V8.701zm-.79-4.29c-.206 0-.288-.088-.288-.287V1.594l2.771 2.818H9.201zM2.503 14.15c-.563 0-.844-.293-.844-.832V5.232c0-.539.281-.837.85-.837h1.91v3.187c0 .85.416 1.26 1.26 1.26h3.14v4.476c0 .54-.28.832-.843.832H2.504zM5.79 7.816c-.24 0-.346-.105-.346-.345V4.547l3.223 3.27H5.791z"})})},84197:(e,t,n)=>{n.d(t,{J:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("cropAndRotate",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M13.7519 5.14447C13.6414 5.14447 13.5437 5.10197 13.4587 5.01698C13.3737 4.93198 13.3312 4.83424 13.3312 4.72374V3.95879C13.3312 3.55931 13.2504 3.20871 13.089 2.90698C12.9275 2.60525 12.7001 2.37151 12.4069 2.20577C12.1179 2.03578 11.7779 1.95079 11.3869 1.95079H11.2084V2.65837C11.2084 2.87086 11.1341 3.00472 10.9853 3.05997C10.8408 3.11097 10.6878 3.07484 10.5264 2.9516L9.01557 1.84242C8.88808 1.74892 8.82433 1.64905 8.82433 1.54281C8.82858 1.43657 8.89233 1.3367 9.01557 1.2432L10.5264 0.127644C10.6878 0.00440153 10.8408 -0.0295964 10.9853 0.0256503C11.1341 0.0766472 11.2084 0.212639 11.2084 0.433626V1.17308H11.3869C11.9351 1.17308 12.4175 1.28995 12.834 1.52369C13.2547 1.75317 13.5819 2.07828 13.8157 2.499C14.0494 2.91548 14.1663 3.40207 14.1663 3.95879V4.72374C14.1663 4.83424 14.1238 4.93198 14.0388 5.01698C13.958 5.10197 13.8624 5.14447 13.7519 5.14447ZM2.28397 10.8561C2.39871 10.8561 2.49858 10.8986 2.58358 10.9836C2.66857 11.0644 2.71107 11.1621 2.71107 11.2769V12.0418C2.71107 12.4413 2.79182 12.7919 2.95331 13.0936C3.1148 13.3954 3.34003 13.6291 3.62902 13.7948C3.92225 13.9648 4.26435 14.0498 4.65533 14.0498H4.83382V13.3359C4.83382 13.1234 4.90606 12.9895 5.05056 12.9343C5.19505 12.8833 5.35016 12.9215 5.5159 13.049L7.02669 14.1582C7.14993 14.2517 7.21155 14.3515 7.21155 14.4578C7.21155 14.564 7.14993 14.6618 7.02669 14.751L5.5159 15.8666C5.35016 15.9941 5.19505 16.0302 5.05056 15.9749C4.90606 15.9239 4.83382 15.788 4.83382 15.567V14.8275H4.65533C4.10711 14.8275 3.62264 14.7106 3.20192 14.4769C2.78119 14.2432 2.45396 13.9181 2.22022 13.5016C1.99074 13.0851 1.87599 12.5985 1.87599 12.0418V11.2769C1.87599 11.1621 1.91637 11.0644 1.99711 10.9836C2.08211 10.8986 2.17773 10.8561 2.28397 10.8561ZM14.4786 10.5055C14.4786 10.684 14.4191 10.8285 14.3001 10.939C14.1854 11.0452 14.0345 11.0984 13.8475 11.0984H5.38204C5.21205 11.0984 5.07818 11.0495 4.98043 10.9517C4.88269 10.854 4.83382 10.7223 4.83382 10.5565V2.26952C4.83382 2.07403 4.89119 1.91679 5.00593 1.79779C5.12493 1.6788 5.28004 1.6193 5.47128 1.6193C5.65827 1.6193 5.80913 1.6788 5.92388 1.79779C6.04287 1.91679 6.10237 2.07403 6.10237 2.26952V9.72145C6.10237 9.84044 6.16186 9.89994 6.28086 9.89994H13.8475C14.0345 9.89994 14.1854 9.95518 14.3001 10.0657C14.4191 10.1762 14.4786 10.3228 14.4786 10.5055ZM1.52539 5.4632C1.52539 5.28471 1.58276 5.14022 1.69751 5.02973C1.8165 4.91923 1.96949 4.86399 2.15648 4.86399H10.6602C10.8217 4.86399 10.9535 4.91498 11.0554 5.01698C11.1574 5.11472 11.2084 5.24646 11.2084 5.4122V13.7311C11.2084 13.9223 11.1489 14.0774 11.0299 14.1964C10.9152 14.3197 10.7622 14.3813 10.571 14.3813C10.3797 14.3813 10.2267 14.3197 10.112 14.1964C9.99726 14.0774 9.93989 13.9223 9.93989 13.7311V6.2409C9.93989 6.12191 9.88039 6.06241 9.7614 6.06241H2.15648C1.96949 6.06241 1.8165 6.00929 1.69751 5.90305C1.58276 5.79256 1.52539 5.64594 1.52539 5.4632Z"})})},56666:(e,t,n)=>{n.d(t,{o:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("dots",{viewBox:"0 0 13 3",svg:(0,i.jsxs)("g",{children:[(0,i.jsx)("path",{d:"M3,1.5A1.5,1.5,0,1,1,1.5,0,1.5,1.5,0,0,1,3,1.5Z"}),(0,i.jsx)("path",{d:"M8,1.5A1.5,1.5,0,1,1,6.5,0,1.5,1.5,0,0,1,8,1.5Z"}),(0,i.jsx)("path",{d:"M13,1.5A1.5,1.5,0,1,1,11.5,0,1.5,1.5,0,0,1,13,1.5Z"})]})})},64330:(e,t,n)=>{n.d(t,{a:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("download",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8.215 15.126c3.862 0 7.061-3.192 7.061-7.062 0-3.862-3.199-7.061-7.068-7.061-3.862 0-7.055 3.2-7.055 7.061 0 3.87 3.2 7.062 7.062 7.062zm0-1.388a5.654 5.654 0 01-5.667-5.674 5.642 5.642 0 015.66-5.667 5.66 5.66 0 015.68 5.667 5.66 5.66 0 01-5.673 5.674zm0-9.174c-.342 0-.602.247-.602.588v3.234l.062 1.401-.622-.766-.766-.8a.557.557 0 00-.41-.177.54.54 0 00-.56.547c0 .164.054.3.163.41l2.256 2.283c.15.157.294.226.479.226.191 0 .335-.075.485-.226l2.256-2.283a.557.557 0 00.164-.41.539.539 0 00-.56-.547.523.523 0 00-.41.178l-.766.793-.622.779.054-1.408V5.152c0-.341-.253-.588-.601-.588z"})})},12217:(e,t,n)=>{n.d(t,{D:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("dragHandle",{viewBox:"0 0 10 10",svg:(0,i.jsx)("path",{d:"M3,2 C2.44771525,2 2,1.55228475 2,1 C2,0.44771525 2.44771525,0 3,0 C3.55228475,0 4,0.44771525 4,1 C4,1.55228475 3.55228475,2 3,2 Z M3,6 C2.44771525,6 2,5.55228475 2,5 C2,4.44771525 2.44771525,4 3,4 C3.55228475,4 4,4.44771525 4,5 C4,5.55228475 3.55228475,6 3,6 Z M3,10 C2.44771525,10 2,9.55228475 2,9 C2,8.44771525 2.44771525,8 3,8 C3.55228475,8 4,8.44771525 4,9 C4,9.55228475 3.55228475,10 3,10 Z M7,2 C6.44771525,2 6,1.55228475 6,1 C6,0.44771525 6.44771525,0 7,0 C7.55228475,0 8,0.44771525 8,1 C8,1.55228475 7.55228475,2 7,2 Z M7,6 C6.44771525,6 6,5.55228475 6,5 C6,4.44771525 6.44771525,4 7,4 C7.55228475,4 8,4.44771525 8,5 C8,5.55228475 7.55228475,6 7,6 Z M7,10 C6.44771525,10 6,9.55228475 6,9 C6,8.44771525 6.44771525,8 7,8 C7.55228475,8 8,8.44771525 8,9 C8,9.55228475 7.55228475,10 7,10 Z"})})},88437:(e,t,n)=>{n.d(t,{a:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("duplicate",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.83887 12.1523H4.00098V13.1846C4.00098 14.6406 4.75977 15.3994 6.24316 15.3994H13.1611C14.6377 15.3994 15.4033 14.6406 15.4033 13.1846V6.21191C15.4033 4.75586 14.6377 3.99707 13.1611 3.99707H11.999V2.96484C11.999 1.50879 11.2334 0.75 9.75684 0.75H2.83887C1.3623 0.75 0.59668 1.50195 0.59668 2.96484V9.93066C0.59668 11.3936 1.3623 12.1523 2.83887 12.1523ZM2.9209 10.8125C2.28516 10.8125 1.93652 10.4844 1.93652 9.82129V3.08105C1.93652 2.41797 2.28516 2.08301 2.9209 2.08301H9.68164C10.3105 2.08301 10.666 2.41797 10.666 3.08105V3.99707H6.24316C4.75977 3.99707 4.00098 4.75586 4.00098 6.21191V10.8125H2.9209ZM6.31836 14.0596C5.68262 14.0596 5.34082 13.7314 5.34082 13.0684V6.32812C5.34082 5.66504 5.68262 5.33691 6.31836 5.33691H13.0791C13.708 5.33691 14.0635 5.66504 14.0635 6.32812V13.0684C14.0635 13.7314 13.708 14.0596 13.0791 14.0596H6.31836Z"})})},75e3:(e,t,n)=>{n.d(t,{U:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("enter",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M5.38965 14.1667C5.81812 14.1667 6.10156 13.8767 6.10156 13.468C6.10156 13.2571 6.01587 13.0989 5.89062 12.967L4.18994 11.3125L3.02979 10.3369L4.55908 10.4028H12.7922C14.4402 10.4028 15.1389 9.65796 15.1389 8.04297V4.13403C15.1389 2.48608 14.4402 1.78735 12.7922 1.78735H9.13379C8.70532 1.78735 8.4021 2.11035 8.4021 2.50586C8.4021 2.90137 8.69873 3.22437 9.13379 3.22437H12.7593C13.4316 3.22437 13.7151 3.50781 13.7151 4.17358V7.99683C13.7151 8.67578 13.425 8.95923 12.7593 8.95923H4.55908L3.02979 9.03174L4.18994 8.04956L5.89062 6.39502C6.01587 6.26978 6.10156 6.11157 6.10156 5.89404C6.10156 5.48535 5.81812 5.19531 5.38965 5.19531C5.21167 5.19531 5.01392 5.27441 4.8689 5.41943L1.08521 9.1438C0.933594 9.28882 0.854492 9.48657 0.854492 9.68433C0.854492 9.87549 0.933594 10.0732 1.08521 10.2183L4.8689 13.9492C5.01392 14.0876 5.21167 14.1667 5.38965 14.1667Z"})})},37240:(e,t,n)=>{n.d(t,{s:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("expand",{viewBox:"-1 -1 9 11",svg:(0,i.jsx)("path",{id:"path0_stroke",d:"M 3.5 0L 3.98809 -0.569442L 3.5 -0.987808L 3.01191 -0.569442L 3.5 0ZM 3.5 9L 3.01191 9.56944L 3.5 9.98781L 3.98809 9.56944L 3.5 9ZM 0.488094 3.56944L 3.98809 0.569442L 3.01191 -0.569442L -0.488094 2.43056L 0.488094 3.56944ZM 3.01191 0.569442L 6.51191 3.56944L 7.48809 2.43056L 3.98809 -0.569442L 3.01191 0.569442ZM -0.488094 6.56944L 3.01191 9.56944L 3.98809 8.43056L 0.488094 5.43056L -0.488094 6.56944ZM 3.98809 9.56944L 7.48809 6.56944L 6.51191 5.43056L 3.01191 8.43056L 3.98809 9.56944Z"})})},13797:(e,t,n)=>{n.d(t,{F:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("factoryBlockSettings",{viewBox:"0 0 24 24",svg:(0,i.jsx)("path",{d:"M12,8c-2.209,0-4,1.791-4,4s1.791,4,4,4s4-1.791,4-4S14.209,8,12,8z M12,14c-1.104,0-2-0.896-2-2s0.896-2,2-2s2,0.896,2,2 S13.104,14,12,14z M24,15V9h-3.523c-0.105-0.299-0.227-0.589-0.361-0.872l2.491-2.492l-4.243-4.243l-2.491,2.491 C15.59,3.75,15.299,3.629,15,3.523V0H9v3.523C8.701,3.629,8.411,3.75,8.128,3.885L5.636,1.394L1.394,5.636l2.491,2.492 C3.75,8.411,3.629,8.701,3.523,9H0v6h3.523c0.106,0.299,0.227,0.589,0.362,0.872l-2.492,2.491l4.243,4.243l2.492-2.491 C8.411,20.25,8.701,20.371,9,20.477V24h6v-3.523c0.299-0.105,0.59-0.227,0.872-0.361l2.491,2.491l4.243-4.243l-2.491-2.491 c0.135-0.283,0.256-0.573,0.361-0.872H24z M19.778,18.363l-1.415,1.415l-2.077-2.077c-0.896,0.502-2.271,1.049-3.286,1.363V22h-2 v-2.936c-1.016-0.314-2.391-0.861-3.286-1.363l-2.078,2.077l-1.415-1.415L6.3,16.285C5.781,15.359,5.234,13.953,4.936,13H2v-2h2.936 C5.234,10.047,5.781,8.641,6.3,7.714L4.222,5.636l1.415-1.415l2.078,2.077C8.609,5.797,9.984,5.25,11,4.936V2h2v2.936 c1.016,0.314,2.391,0.861,3.286,1.363l2.077-2.077l1.415,1.415L17.7,7.714c0.519,0.926,1.065,2.333,1.364,3.286H22v2h-2.936 c-0.299,0.953-0.846,2.359-1.364,3.285L19.778,18.363z"})})},50066:(e,t,n)=>{n.d(t,{R:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("file",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M4.35645 15.4678H11.6367C13.0996 15.4678 13.8584 14.6953 13.8584 13.2256V7.02539C13.8584 6.0752 13.7354 5.6377 13.1406 5.03613L9.55176 1.38574C8.97754 0.804688 8.50586 0.667969 7.65137 0.667969H4.35645C2.89355 0.667969 2.13477 1.44043 2.13477 2.91016V13.2256C2.13477 14.7021 2.89355 15.4678 4.35645 15.4678ZM4.46582 14.1279C3.80273 14.1279 3.47461 13.7793 3.47461 13.1436V2.99219C3.47461 2.36328 3.80273 2.00781 4.46582 2.00781H7.37793V5.75391C7.37793 6.73145 7.86328 7.20312 8.83398 7.20312H12.5186V13.1436C12.5186 13.7793 12.1836 14.1279 11.5205 14.1279H4.46582ZM8.95703 6.02734C8.67676 6.02734 8.56055 5.9043 8.56055 5.62402V2.19238L12.334 6.02734H8.95703ZM8.59473 12.7266V10.6279L8.54004 9.56152L9.06641 10.1152L9.59277 10.6484C9.68848 10.7646 9.8457 10.833 9.98926 10.833C10.2969 10.833 10.5293 10.6143 10.5293 10.3066C10.5293 10.1357 10.4678 10.0127 10.3379 9.90332L8.45117 8.16699C8.29395 8.02344 8.16406 7.96191 7.99316 7.96191C7.8291 7.96191 7.69922 8.02344 7.54199 8.16699L5.65527 9.90332C5.52539 10.0127 5.46387 10.1357 5.46387 10.3066C5.46387 10.6143 5.68945 10.833 6.00391 10.833C6.14746 10.833 6.29785 10.7646 6.40039 10.6484L6.92676 10.1152L7.45312 9.56152L7.39844 10.6279V12.7266C7.39844 13.0547 7.67188 13.3008 7.99316 13.3008C8.32129 13.3008 8.59473 13.0547 8.59473 12.7266Z"})})},80750:(e,t,n)=>{n.d(t,{l:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("genericError",{viewBox:"0 0 32 32",svg:(0,i.jsx)("path",{d:"M16.0242 29.0485c7.1251 0 13.0243-5.8992 13.0243-13.0243C29.0485 8.91198 23.1365 3 16.0115 3 8.89922 3 3 8.91198 3 16.0242c0 7.1251 5.91198 13.0243 13.0242 13.0243zm-.0127-11.1089c-.6768 0-1.0471-.3959-1.0726-1.0726l-.1788-6.3078c-.0255-.70232.5108-1.20031 1.2386-1.20031.7151 0 1.2769.51076 1.2514 1.21301l-.1916 6.2951c-.0255.6895-.3958 1.0726-1.047 1.0726zm0 4.6989c-.7406 0-1.4301-.5874-1.4301-1.379 0-.7917.6767-1.3791 1.4301-1.3791.7533 0 1.4301.5746 1.4301 1.3791 0 .8044-.6895 1.379-1.4301 1.379z"})})},84169:(e,t,n)=>{n.d(t,{m:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("help",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 13.7383C4.85547 13.7383 2.33301 11.209 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.667 4.91992 13.6738 8.06445C13.6738 11.209 11.1445 13.7383 8 13.7383ZM7.84277 9.4248C8.21875 9.4248 8.45801 9.21289 8.47852 8.93262C8.47852 8.90527 8.47852 8.87109 8.47852 8.85059C8.49902 8.49512 8.74512 8.25586 9.18945 7.96875C9.85938 7.52441 10.2969 7.13477 10.2969 6.3418C10.2969 5.2002 9.27148 4.55078 8.06152 4.55078C6.89258 4.55078 6.09277 5.08398 5.88086 5.72656C5.83984 5.84277 5.81934 5.95898 5.81934 6.08203C5.81934 6.41016 6.0791 6.61523 6.35254 6.61523C6.60547 6.61523 6.76953 6.5127 6.90625 6.32812L7.01562 6.19141C7.24121 5.81543 7.56934 5.61719 7.97949 5.61719C8.5332 5.61719 8.90918 5.94531 8.90918 6.41016C8.90918 6.84082 8.62207 7.05273 8.04102 7.45605C7.55566 7.79102 7.2002 8.14648 7.2002 8.76855V8.84375C7.2002 9.22656 7.43262 9.4248 7.84277 9.4248ZM7.83594 11.5234C8.27344 11.5234 8.63574 11.2021 8.63574 10.7715C8.63574 10.3408 8.27344 10.0264 7.83594 10.0264C7.3916 10.0264 7.03613 10.3477 7.03613 10.7715C7.03613 11.2021 7.39844 11.5234 7.83594 11.5234Z"})})},74155:(e,t,n)=>{n.d(t,{u:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("helpButtonGuide",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8 2.77344C7.39844 2.0625 6.05859 1.42676 4.48633 1.42676C2.3877 1.42676 0.692383 2.51367 0.241211 3.5459V13.8066C0.241211 14.4766 0.678711 14.7363 1.16406 14.7363C1.52637 14.7363 1.73145 14.627 1.96387 14.4561C2.42871 14.0801 3.1875 13.6426 4.48633 13.6426C5.79199 13.6426 6.68066 14.0801 7.07715 14.415C7.2959 14.5791 7.54883 14.7363 8 14.7363C8.45117 14.7363 8.69727 14.5654 8.92285 14.415C9.34668 14.1006 10.208 13.6426 11.5137 13.6426C12.8125 13.6426 13.585 14.0869 14.0361 14.4561C14.2686 14.627 14.4736 14.7363 14.8359 14.7363C15.3213 14.7363 15.7588 14.4766 15.7588 13.8066V3.5459C15.3076 2.51367 13.6191 1.42676 11.5137 1.42676C9.94141 1.42676 8.6084 2.0625 8 2.77344ZM1.72461 4.01758C1.90918 3.56641 2.9209 2.80078 4.48633 2.80078C6.05176 2.80078 7.09766 3.57324 7.26172 4.01758V13.0342C6.55762 12.5283 5.55273 12.2549 4.48633 12.2549C3.41309 12.2549 2.41504 12.5283 1.72461 13.0547V4.01758ZM14.2754 4.01758V13.0547C13.585 12.5283 12.5869 12.2549 11.5137 12.2549C10.4473 12.2549 9.44238 12.5283 8.73828 13.0342V4.01758C8.90234 3.57324 9.94824 2.80078 11.5137 2.80078C13.0791 2.80078 14.0908 3.56641 14.2754 4.01758Z"})})},5377:(e,t,n)=>{n.d(t,{y:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("image",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M2,2v26h26V2H2z M26,26H4v-4h22V26z M26,20H4V4h22V20z M8,10c1.104,0,2-0.896,2-2S9.104,6,8,6S6,6.896,6,8S6.896,10,8,10z M18,7l-5,5l-2-1l-5,7h18L18,7z M11.635,13.553l1.76,0.881l4.129-4.129L20.631,16H9.887L11.635,13.553z"})})},44495:(e,t,n)=>{n.d(t,{D:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("info",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.97266 14.9453C11.7871 14.9453 14.9453 11.7803 14.9453 7.97266C14.9453 4.1582 11.7803 1 7.96582 1C4.1582 1 1 4.1582 1 7.97266C1 11.7803 4.16504 14.9453 7.97266 14.9453ZM7.97266 13.7832C4.74609 13.7832 2.16895 11.1992 2.16895 7.97266C2.16895 4.74609 4.73926 2.16211 7.96582 2.16211C11.1924 2.16211 13.7764 4.74609 13.7832 7.97266C13.79 11.1992 11.1992 13.7832 7.97266 13.7832ZM7.91113 5.53906C8.41016 5.53906 8.7998 5.14258 8.7998 4.64355C8.7998 4.14453 8.41016 3.74805 7.91113 3.74805C7.41895 3.74805 7.02246 4.14453 7.02246 4.64355C7.02246 5.14258 7.41895 5.53906 7.91113 5.53906ZM6.77637 11.7324H9.55859C9.83887 11.7324 10.0576 11.5273 10.0576 11.2471C10.0576 10.9805 9.83887 10.7686 9.55859 10.7686H8.71094V7.28906C8.71094 6.91992 8.52637 6.67383 8.17773 6.67383H6.89258C6.6123 6.67383 6.39355 6.88574 6.39355 7.15234C6.39355 7.43262 6.6123 7.6377 6.89258 7.6377H7.62402V10.7686H6.77637C6.49609 10.7686 6.27734 10.9805 6.27734 11.2471C6.27734 11.5273 6.49609 11.7324 6.77637 11.7324Z"})})},90199:(e,t,n)=>{n.d(t,{b:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("locked",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M4.79395 14.7227H11.1992C12.252 14.7227 12.7783 14.1963 12.7783 13.0479V8.20801C12.7783 7.19629 12.3682 6.66992 11.541 6.56055V4.96094C11.541 2.36328 9.81152 1.1123 7.99316 1.1123C6.18164 1.1123 4.45215 2.36328 4.45215 4.96094V6.56055C3.625 6.66992 3.21484 7.19629 3.21484 8.20801V13.0479C3.21484 14.1963 3.73438 14.7227 4.79395 14.7227ZM5.75098 4.83105C5.75098 3.22461 6.76953 2.35645 7.99316 2.35645C9.2168 2.35645 10.2422 3.22461 10.2422 4.83105V6.54004H5.75098V4.83105ZM4.99219 13.5059C4.69141 13.5059 4.54102 13.3623 4.54102 13V8.25586C4.54102 7.89355 4.69141 7.76367 4.99219 7.76367H11.0078C11.3086 7.76367 11.4521 7.89355 11.4521 8.25586V13C11.4521 13.3623 11.3086 13.5059 11.0078 13.5059H4.99219Z"})})},87292:(e,t,n)=>{n.d(t,{B:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("pdf",{viewBox:"0 0 23.5 23.5",svg:(0,i.jsx)("path",{d:"M8.61 10.922a.44.44 0 01-.313-.11.422.422 0 01-.117-.312.9.9 0 01.054-.273l1.07-2.985c.12-.354.342-.531.665-.531.338 0 .568.177.687.531l1.07 2.985c.032.114.047.205.047.273a.44.44 0 01-.109.313c-.073.072-.18.109-.32.109-.219 0-.365-.133-.438-.399l-.242-.68H9.281l-.226.68c-.068.266-.216.399-.446.399zm.85-1.75h1.032L10 7.609h-.047l-.492 1.563zm3.657-1.11a.514.514 0 01-.367-.14.503.503 0 01-.14-.36c0-.14.046-.257.14-.351a.514.514 0 01.367-.14h2.195a.477.477 0 01.5.492c0 .14-.046.26-.14.359a.487.487 0 01-.36.14h-2.195zm0 2.618a.514.514 0 01-.367-.14.503.503 0 01-.14-.36c0-.14.046-.258.14-.352a.514.514 0 01.367-.14h2.195a.477.477 0 01.5.492c0 .14-.046.26-.14.36a.487.487 0 01-.36.14h-2.195zm-4.953 6.234V13.25c0-.333.089-.583.266-.75.182-.172.435-.258.758-.258h5.632c.677 0 1.016.336 1.016 1.008v3.586h-.547l-1.492-1.719a.58.58 0 00-.242-.172.84.84 0 00-.282-.047c-.177 0-.348.073-.515.22l-1.547 1.366-.617-.562a.68.68 0 00-.461-.188.617.617 0 00-.438.188l-.984.992h-.547zm2.492-1.797a.78.78 0 00.57-.242.78.78 0 00.243-.57c0-.23-.081-.42-.242-.57a.823.823 0 00-.57-.243.737.737 0 00-.579.227.812.812 0 00-.234.586c0 .218.078.409.234.57a.79.79 0 00.578.242zm-5.36 2.64V5.97c0-.839.214-1.474.641-1.907.428-.437 1.06-.656 1.899-.656h8.32c.839 0 1.472.219 1.899.656.427.433.64 1.068.64 1.907v11.789c0 .844-.213 1.482-.64 1.914-.427.432-1.06.648-1.899.648h-8.32c-.839 0-1.471-.216-1.899-.648-.427-.432-.64-1.07-.64-1.914zm1.54-.093c0 .36.094.635.281.828.188.193.472.29.852.29h8.062c.38 0 .664-.097.852-.29.187-.193.281-.469.281-.828V6.07c0-.364-.094-.643-.281-.836-.188-.198-.471-.296-.852-.296H7.97c-.38 0-.664.098-.852.296-.187.193-.281.472-.281.836v11.594z"})})},17683:(e,t,n)=>{n.d(t,{Q:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("peekModeCenter",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.1416 14.4492H13.8516C15.3281 14.4492 16.0938 13.6904 16.0938 12.2344V3.9082C16.0938 2.45215 15.3281 1.69336 13.8516 1.69336H2.1416C0.665039 1.69336 -0.100586 2.44531 -0.100586 3.9082V12.2344C-0.100586 13.6904 0.665039 14.4492 2.1416 14.4492ZM2.22363 13.1094C1.58789 13.1094 1.23926 12.7812 1.23926 12.1182V4.02441C1.23926 3.36133 1.58789 3.02637 2.22363 3.02637H13.7695C14.3984 3.02637 14.7539 3.36133 14.7539 4.02441V12.1182C14.7539 12.7812 14.3984 13.1094 13.7695 13.1094H2.22363ZM4.33594 11.0654H11.6504C12.0742 11.0654 12.2588 10.8809 12.2588 10.4502V5.69238C12.2588 5.25488 12.0742 5.07715 11.6504 5.07715H4.33594C3.91211 5.07715 3.72754 5.25488 3.72754 5.69238V10.4502C3.72754 10.8809 3.91211 11.0654 4.33594 11.0654Z"})})},31490:(e,t,n)=>{n.d(t,{M:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("peekModeFull",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.1416 14.4492H13.8516C15.3281 14.4492 16.0938 13.6904 16.0938 12.2344V3.9082C16.0938 2.45215 15.3281 1.69336 13.8516 1.69336H2.1416C0.665039 1.69336 -0.100586 2.44531 -0.100586 3.9082V12.2344C-0.100586 13.6904 0.665039 14.4492 2.1416 14.4492ZM2.22363 13.1094C1.58789 13.1094 1.23926 12.7812 1.23926 12.1182V4.02441C1.23926 3.36133 1.58789 3.02637 2.22363 3.02637H13.7695C14.3984 3.02637 14.7539 3.36133 14.7539 4.02441V12.1182C14.7539 12.7812 14.3984 13.1094 13.7695 13.1094H2.22363ZM2.77734 12.1113H13.2158C13.5645 12.1113 13.7559 11.9131 13.7559 11.5645V4.57812C13.7559 4.22949 13.5645 4.02441 13.2158 4.02441H2.77734C2.42871 4.02441 2.2373 4.22949 2.2373 4.57812V11.5645C2.2373 11.9131 2.42871 12.1113 2.77734 12.1113Z"})})},32240:(e,t,n)=>{n.d(t,{y:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("peekModeSide",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.1416 14.4492H13.8516C15.3281 14.4492 16.0938 13.6904 16.0938 12.2344V3.9082C16.0938 2.45215 15.3281 1.69336 13.8516 1.69336H2.1416C0.665039 1.69336 -0.100586 2.44531 -0.100586 3.9082V12.2344C-0.100586 13.6904 0.665039 14.4492 2.1416 14.4492ZM2.22363 13.1094C1.58789 13.1094 1.23926 12.7812 1.23926 12.1182V4.02441C1.23926 3.36133 1.58789 3.02637 2.22363 3.02637H13.7695C14.3984 3.02637 14.7539 3.36133 14.7539 4.02441V12.1182C14.7539 12.7812 14.3984 13.1094 13.7695 13.1094H2.22363ZM8.51953 12.1113H13.2158C13.5986 12.1113 13.7559 11.9541 13.7559 11.5645V4.57812C13.7559 4.18848 13.5986 4.02441 13.2158 4.02441H8.51953C8.13672 4.02441 7.98633 4.18848 7.98633 4.57812V11.5645C7.98633 11.9541 8.13672 12.1113 8.51953 12.1113Z"})})},47453:(e,t,n)=>{n.d(t,{R:()=>r,s:()=>i});n(67294);var o=n(45238);const i=(0,n(85893).jsx)("path",{d:"M7.977 14.963c.407 0 .747-.324.747-.723V8.72h5.362c.399 0 .74-.34.74-.747a.746.746 0 00-.74-.738H8.724V1.706c0-.398-.34-.722-.747-.722a.732.732 0 00-.739.722v5.529h-5.37a.746.746 0 00-.74.738c0 .407.341.747.74.747h5.37v5.52c0 .399.332.723.739.723z"}),r=(0,o.IU)("plus",{viewBox:"0 0 16 16",svg:i})},18442:(e,t,n)=>{n.d(t,{H:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("settings",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.30957 15.4814H8.69043C9.25781 15.4814 9.70215 15.1328 9.83203 14.5928L10.1123 13.3828L10.29 13.3145L11.3428 13.9639C11.8213 14.2646 12.3818 14.1895 12.7783 13.7861L13.7354 12.8291C14.1455 12.4258 14.2139 11.8652 13.9131 11.3936L13.2637 10.3477L13.3252 10.1768L14.5352 9.89648C15.0684 9.75977 15.4238 9.31543 15.4238 8.75488V7.4082C15.4238 6.84766 15.0752 6.40332 14.5352 6.2666L13.3389 5.97949L13.2705 5.80176L13.9199 4.75586C14.2207 4.28418 14.1455 3.73047 13.7422 3.31348L12.7852 2.35645C12.3887 1.95996 11.8281 1.88477 11.3564 2.17871L10.3037 2.82129L10.1123 2.74609L9.83203 1.53613C9.70215 0.996094 9.25781 0.647461 8.69043 0.647461H7.30957C6.73535 0.647461 6.29785 0.996094 6.16797 1.53613L5.8877 2.74609L5.69629 2.82129L4.64355 2.17871C4.16504 1.88477 3.60449 1.95996 3.20801 2.35645L2.25098 3.31348C1.84766 3.73047 1.77246 4.28418 2.07324 4.75586L2.72949 5.80176L2.6543 5.97949L1.46484 6.2666C0.917969 6.40332 0.576172 6.84766 0.576172 7.4082V8.75488C0.576172 9.31543 0.924805 9.75977 1.46484 9.89648L2.66797 10.1768L2.73633 10.3477L2.08008 11.3936C1.7793 11.8652 1.85449 12.4258 2.25781 12.8291L3.21484 13.7861C3.61816 14.1895 4.17871 14.2646 4.65039 13.9639L5.70312 13.3145L5.8877 13.3828L6.16797 14.5928C6.29785 15.1328 6.73535 15.4814 7.30957 15.4814ZM7.47363 14.2441C7.35742 14.2441 7.30273 14.1895 7.28223 14.0869L6.87891 12.4053C6.44141 12.3027 6.03125 12.1318 5.69629 11.9199L4.21973 12.8291C4.1377 12.8838 4.05566 12.877 3.9668 12.7949L3.24219 12.0703C3.16699 11.9951 3.16016 11.9131 3.22168 11.8242L4.13086 10.3477C3.93945 10.0264 3.75488 9.61621 3.65234 9.18555L1.96387 8.78223C1.86133 8.76172 1.81348 8.70703 1.81348 8.59082V7.56543C1.81348 7.44238 1.86133 7.39453 1.96387 7.36719L3.65234 6.9707C3.75488 6.5127 3.95312 6.08887 4.11719 5.79492L3.21484 4.3252C3.15332 4.22949 3.15332 4.14746 3.23535 4.06543L3.95996 3.34766C4.04883 3.27246 4.11719 3.25879 4.21973 3.31348L5.68945 4.20898C5.99707 4.02441 6.44824 3.83301 6.87891 3.72363L7.28223 2.04199C7.30273 1.93945 7.35742 1.88477 7.47363 1.88477H8.52637C8.64258 1.88477 8.69727 1.93262 8.71094 2.04199L9.12109 3.7373C9.56543 3.83984 9.96875 4.02441 10.3037 4.21582L11.7734 3.32031C11.876 3.26562 11.9443 3.27246 12.0264 3.35449L12.7578 4.07227C12.8398 4.14746 12.8398 4.22949 12.7783 4.3252L11.876 5.79492C12.04 6.08887 12.2451 6.5127 12.3477 6.9707L14.0293 7.36719C14.1387 7.39453 14.1865 7.44238 14.1865 7.56543V8.59082C14.1865 8.70703 14.1318 8.76172 14.0293 8.78223L12.3408 9.18555C12.2383 9.61621 12.0537 10.0264 11.8691 10.3477L12.7715 11.8242C12.8262 11.9131 12.8262 11.9951 12.751 12.0635L12.0264 12.7949C11.9375 12.877 11.8555 12.8838 11.7734 12.8291L10.2969 11.9199C9.96191 12.1318 9.57227 12.3027 9.12109 12.4053L8.71094 14.0869C8.69727 14.1963 8.64258 14.2441 8.52637 14.2441H7.47363ZM8 10.6621C9.42188 10.6621 10.5908 9.49316 10.5908 8.06445C10.5908 6.64941 9.42188 5.48047 8 5.48047C6.57812 5.48047 5.40234 6.64941 5.40234 8.06445C5.40234 9.49316 6.57129 10.6621 8 10.6621ZM8 9.49316C7.2207 9.49316 6.57812 8.85059 6.57812 8.06445C6.57812 7.29199 7.2207 6.65625 8 6.65625C8.76562 6.65625 9.40137 7.29199 9.40137 8.06445C9.40137 8.84375 8.76562 9.49316 8 9.49316Z"})})},1436:(e,t,n)=>{n.d(t,{g:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("settingsConnectedApps",{viewBox:"0 0 20 20",svg:(0,i.jsx)("path",{d:"M16.492 3.922C15.695 3.125 14.57 3 13.234 3H7.148c-1.312 0-2.437.125-3.234.922C3.117 4.719 3 5.836 3 7.14v6.03c0 1.337.117 2.446.914 3.243.797.797 1.922.922 3.25.922h6.07c1.336 0 2.461-.125 3.258-.922.797-.797.914-1.906.914-3.242V7.164c0-1.336-.117-2.453-.914-3.242zm-.344 3.023v6.438c0 .812-.101 1.64-.578 2.117-.468.469-1.312.578-2.117.578h-6.5c-.805 0-1.648-.11-2.125-.578-.469-.477-.57-1.305-.57-2.117V6.969c0-.82.101-1.664.57-2.133.477-.477 1.328-.578 2.149-.578h6.476c.805 0 1.649.11 2.117.578.477.476.578 1.305.578 2.11zm-3.492 5.149c.344 0 .57-.266.57-.625V7.78c0-.46-.25-.64-.648-.64h-3.71c-.368 0-.602.226-.602.57s.242.57.617.57h1.422l1.156-.125-1.219 1.133-2.875 2.883a.62.62 0 00-.187.422c0 .351.226.578.57.578.188 0 .336-.07.445-.18l2.875-2.875 1.125-1.203-.117 1.219v1.351c0 .368.227.61.578.61z"})})},24600:(e,t,n)=>{n.d(t,{P:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("slackLogo",{viewBox:"0 0 16 16",svg:(0,i.jsxs)("g",{children:[(0,i.jsx)("path",{d:"M1.68078 11.7915C2.60586 11.7915 3.36156 11.0358 3.36156 10.1107V8.42993H1.68078C0.755701 8.42993 0 9.18563 0 10.1107C0 11.0358 0.755701 11.7915 1.68078 11.7915Z",fill:"#E01E5A"}),(0,i.jsx)("path",{d:"M5.88928 8.42993C4.9642 8.42993 4.2085 9.18563 4.2085 10.1107V14.3192C4.2085 15.2443 4.9642 16 5.88928 16C6.81436 16 7.57006 15.2443 7.57006 14.3192V10.1107C7.57006 9.18563 6.81436 8.42993 5.88928 8.42993Z",fill:"#E01E5A"}),(0,i.jsx)("path",{d:"M4.2085 1.68078C4.2085 2.60586 4.9642 3.36156 5.88928 3.36156H7.57006V1.68078C7.57006 0.755701 6.81436 0 5.88928 0C4.9642 0 4.2085 0.755701 4.2085 1.68078Z",fill:"#36C5F0"}),(0,i.jsx)("path",{d:"M7.57003 5.88928C7.57003 4.9642 6.81433 4.2085 5.88925 4.2085H1.68078C0.755701 4.2085 0 4.9642 0 5.88928C0 6.81436 0.755701 7.57006 1.68078 7.57006H5.88925C6.81433 7.57006 7.57003 6.81436 7.57003 5.88928Z",fill:"#36C5F0"}),(0,i.jsx)("path",{d:"M10.1107 7.57003C11.0358 7.57003 11.7915 6.81433 11.7915 5.88925V1.68078C11.7915 0.755701 11.0358 0 10.1107 0C9.18563 0 8.42993 0.755701 8.42993 1.68078V5.88925C8.42993 6.81433 9.18563 7.57003 10.1107 7.57003Z",fill:"#2EB67D"}),(0,i.jsx)("path",{d:"M14.3192 4.2085C13.3941 4.2085 12.6384 4.9642 12.6384 5.88928V7.57006H14.3192C15.2443 7.57006 16 6.81436 16 5.88928C16 4.9642 15.2443 4.2085 14.3192 4.2085Z",fill:"#2EB67D"}),(0,i.jsx)("path",{d:"M8.42993 10.1107C8.42993 11.0358 9.18563 11.7915 10.1107 11.7915H14.3192C15.2443 11.7915 16 11.0358 16 10.1107C16 9.18563 15.2443 8.42993 14.3192 8.42993H10.1107C9.18563 8.42993 8.42993 9.18563 8.42993 10.1107Z",fill:"#ECB22E"}),(0,i.jsx)("path",{d:"M11.7915 14.3192C11.7915 13.3941 11.0358 12.6384 10.1107 12.6384H8.42993V14.3192C8.42993 15.2443 9.18563 16 10.1107 16C11.0358 16 11.7915 15.2443 11.7915 14.3192Z",fill:"#ECB22E"})]})})},11751:(e,t,n)=>{n.d(t,{t:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("sparkles",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.2757 4.82358C7.57934 4.71847 7.57934 4.53161 7.2757 4.41483L5.62905 3.78419C5.33709 3.67908 4.99842 3.3404 4.88164 3.03676L4.25101 1.39009C4.1459 1.08644 3.95905 1.08644 3.84226 1.39009L3.21163 3.03676C3.10653 3.32872 2.76786 3.6674 2.46422 3.78419L0.817572 4.41483C0.513934 4.51994 0.513934 4.70679 0.817572 4.82358L2.46422 5.45422C2.75618 5.55933 3.09485 5.898 3.21163 6.20165L3.84226 7.84832C3.94737 8.15196 4.13422 8.15196 4.25101 7.84832L4.88164 6.20165C4.98674 5.90968 5.32541 5.571 5.62905 5.45422L7.2757 4.82358ZM15.2991 10.5929C16.2334 10.3593 16.2334 9.9739 15.2991 9.74032L13.2321 9.22647C12.2978 8.9929 11.3402 8.03526 11.1066 7.10097L10.5928 5.03387C10.3592 4.09959 9.97382 4.09959 9.74025 5.03387L9.2264 7.10097C8.99283 8.03526 8.03521 8.9929 7.10094 9.22647L5.03387 9.74032C4.09961 9.9739 4.09961 10.3593 5.03387 10.5929L7.10094 11.1067C8.03521 11.3403 8.99283 12.2979 9.2264 13.2322L9.74025 15.2993C9.97382 16.2336 10.3592 16.2336 10.5928 15.2993L11.1066 13.2322C11.3402 12.2979 12.2978 11.3403 13.2321 11.1067L15.2991 10.5929Z"})})},95855:(e,t,n)=>{n.d(t,{z:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("speechBubble",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M4.32 15.424c.39 0 .677-.192 1.149-.609l2.344-2.064h4.116c2.057 0 3.213-1.19 3.213-3.22V4.22c0-2.03-1.156-3.22-3.213-3.22H3.213C1.163 1 0 2.19 0 4.22V9.53c0 2.037 1.196 3.22 3.165 3.22h.28v1.675c0 .608.322.998.875.998zm.342-1.531v-1.949c0-.403-.178-.56-.56-.56H3.26c-1.285 0-1.9-.65-1.9-1.894V4.26c0-1.243.615-1.893 1.9-1.893h8.627c1.278 0 1.893.65 1.893 1.894v5.23c0 1.243-.615 1.893-1.893 1.893h-4.15c-.417 0-.622.068-.909.369l-2.167 2.14z"})})},65153:(e,t,n)=>{n.d(t,{n:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("sub",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M5 3V20H23.187L19.594 16.406L21 15L27 21L21 27L19.594 25.594L23.187 22H3V3H5Z"})})},60291:(e,t,n)=>{n.d(t,{b:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("sync",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M27.93 13.81h-1.54c-.606-5.717-5.536-10.265-11.387-10.265-3.425 0-6.514 1.55-8.625 3.987-.427.483-.37 1.078.079 1.392.438.315.965.214 1.336-.202a9.57 9.57 0 017.21-3.268 9.503 9.503 0 019.456 8.356h-1.673c-.798 0-1 .539-.573 1.156l2.516 3.583c.359.516.898.528 1.269 0l2.504-3.572c.45-.628.236-1.167-.573-1.167zM2.064 16.202h1.55c.607 5.716 5.526 10.253 11.388 10.253 3.425 0 6.525-1.561 8.636-3.987.416-.483.36-1.09-.078-1.404-.438-.314-.977-.202-1.337.214-1.74 2.01-4.324 3.268-7.221 3.268a9.496 9.496 0 01-9.467-8.344H7.22c.798 0 1-.55.573-1.157l-2.516-3.583c-.359-.516-.898-.527-1.269 0l-2.515 3.572c-.438.617-.236 1.168.572 1.168z"})})},77734:(e,t,n)=>{n.d(t,{s:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("tableHeaderColumn",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M13.7847 14H2.21528C0.756437 14 0 13.2862 0 11.9164V4.0836C0 2.7074 0.756437 2 2.21528 2H13.7847C15.2436 2 16 2.71383 16 4.0836V11.9164C16 13.2862 15.2436 14 13.7847 14ZM14.6762 4.19293C14.6762 3.56913 14.325 3.25402 13.7037 3.25402H7V5.60772H14.6762V4.19293ZM7 6.81672V9.18328H14.6762V6.81672H7ZM13.7037 12.7395C14.325 12.7395 14.6762 12.4309 14.6762 11.8071V10.3923H7V12.7395H13.7037Z"})})},73599:(e,t,n)=>{n.d(t,{f:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("tableHeaderRow",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M13.7847 14H2.21528C0.756437 14 0 13.2862 0 11.9164V4.0836C0 2.7074 0.756437 2 2.21528 2H13.7847C15.2436 2 16 2.71383 16 4.0836V11.9164C16 13.2862 15.2436 14 13.7847 14ZM1.32377 6.81672V9.18328H7.34825V6.81672H1.32377ZM8.645 6.81672V9.18328H14.6762V6.81672H8.645ZM1.32377 11.8071C1.32377 12.4309 1.66821 12.7395 2.29633 12.7395H7.34825V10.3923H1.32377V11.8071ZM13.7037 12.7395C14.325 12.7395 14.6762 12.4309 14.6762 11.8071V10.3923H8.645V12.7395H13.7037Z"})})},98519:(e,t,n)=>{n.d(t,{k:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("thinCheck",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M6.385 14.162c.362 0 .642-.15.84-.444L13.652 3.71c.144-.226.205-.417.205-.602 0-.485-.341-.82-.833-.82-.335 0-.54.123-.746.444l-5.926 9.4-3.042-3.903c-.205-.267-.417-.376-.718-.376-.492 0-.848.348-.848.827 0 .212.075.417.253.629l3.541 4.416c.24.3.492.437.848.437z"})})},16695:(e,t,n)=>{n.d(t,{H:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("thinCheckboxCircle",{viewBox:"0 0 22 23",svg:(0,i.jsx)("circle",{cx:"11",cy:"11.5",r:"10",stroke:"#E2E1DE",strokeWidth:"1"})})},47560:(e,t,n)=>{n.d(t,{o:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("topbarCommentFilled",{viewBox:"0 0 20 20",svg:(0,i.jsx)("path",{d:"M5.9375 18.4844C6.38281 18.4844 6.71094 18.2656 7.25 17.7891L9.92969 15.4297H14.6328C16.9844 15.4297 18.3047 14.0703 18.3047 11.75V5.67969C18.3047 3.35938 16.9844 2 14.6328 2H4.67188C2.32812 2 1 3.35938 1 5.67969V11.75C1 14.0781 2.36719 15.4297 4.61719 15.4297H4.9375V17.3438C4.9375 18.0391 5.30469 18.4844 5.9375 18.4844ZM6.32812 16.7344V14.5078C6.32812 14.0469 6.125 13.8672 5.6875 13.8672H4.72656C3.25781 13.8672 2.55469 13.125 2.55469 11.7031V5.72656C2.55469 4.30469 3.25781 3.5625 4.72656 3.5625H14.5859C16.0469 3.5625 16.75 4.30469 16.75 5.72656V11.7031C16.75 13.125 16.0469 13.8672 14.5859 13.8672H9.84375C9.36719 13.8672 9.13281 13.9453 8.80469 14.2891L6.32812 16.7344ZM5.67969 6.82812H13.5469C13.8125 6.82812 14.0312 6.60156 14.0312 6.32812C14.0312 6.07031 13.8125 5.85156 13.5469 5.85156H5.67969C5.41406 5.85156 5.20312 6.07031 5.20312 6.32812C5.20312 6.60156 5.41406 6.82812 5.67969 6.82812ZM5.67969 9.30469H13.5469C13.8125 9.30469 14.0312 9.08594 14.0312 8.8125C14.0312 8.55469 13.8125 8.32812 13.5469 8.32812H5.67969C5.41406 8.32812 5.20312 8.55469 5.20312 8.8125C5.20312 9.08594 5.41406 9.30469 5.67969 9.30469ZM5.67969 11.7891H10.8047C11.0781 11.7891 11.2891 11.5703 11.2891 11.3047C11.2891 11.0312 11.0781 10.8125 10.8047 10.8125H5.67969C5.41406 10.8125 5.20312 11.0312 5.20312 11.3047C5.20312 11.5703 5.41406 11.7891 5.67969 11.7891Z"})})},91:(e,t,n)=>{n.d(t,{L:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("triangle",{viewBox:"0 0 100 100",svg:(0,i.jsx)("polygon",{points:"5.9,88.2 50,11.8 94.1,88.2 "})})},55863:(e,t,n)=>{n.d(t,{s:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("undo",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M14.542 10.6826C14.542 7.96875 12.71 6.10254 9.59961 6.10254H5.29297L3.70703 6.1709L4.91016 5.15234L6.67383 3.43652C6.80371 3.30664 6.89258 3.14258 6.89258 2.91699C6.89258 2.5 6.59863 2.19238 6.1543 2.19238C5.96973 2.19238 5.76465 2.28125 5.61426 2.4248L1.69043 6.29395C1.5332 6.4375 1.45117 6.64258 1.45117 6.84766C1.45117 7.05273 1.5332 7.25098 1.69043 7.40137L5.61426 11.2705C5.76465 11.4141 5.96973 11.5029 6.1543 11.5029C6.59863 11.5029 6.89258 11.1953 6.89258 10.7715C6.89258 10.5527 6.80371 10.3887 6.67383 10.252L4.91016 8.53613L3.70703 7.52441L5.29297 7.59277H9.64746C11.8486 7.59277 13.0586 8.84375 13.0586 10.6211C13.0586 12.4053 11.8486 13.7109 9.64746 13.7109H8.05469C7.60352 13.7109 7.2959 14.0459 7.2959 14.4629C7.2959 14.873 7.61035 15.208 8.05469 15.208H9.69531C12.751 15.208 14.542 13.4102 14.542 10.6826Z"})})},54497:(e,t,n)=>{n.d(t,{t:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("warning",{viewBox:"0 0 14 14",svg:(0,i.jsx)("path",{d:"M1.619 12.581h9.96c.983 0 1.618-.73 1.618-1.625 0-.266-.07-.54-.21-.793L7.998 1.25a1.593 1.593 0 00-2.8 0L.217 10.163c-.14.26-.216.527-.216.793 0 .895.635 1.625 1.619 1.625zm4.989-4.367c-.375 0-.59-.21-.603-.584l-.089-3.174c-.013-.394.267-.666.686-.666.406 0 .704.279.691.672l-.101 3.162c-.013.387-.222.59-.584.59zm0 2.196c-.432 0-.787-.31-.787-.73 0-.419.349-.73.787-.73.432 0 .78.311.78.73 0 .425-.355.73-.78.73z"})})},18970:(e,t,n)=>{n.d(t,{V3:()=>o,Wm:()=>i});const o={"1:1":{width:1,height:1},"5:4":{width:5,height:4},"4:3":{width:4,height:3},"7:5":{width:7,height:5},"3:2":{width:3,height:2},"5:3":{width:5,height:3},"16:9":{width:16,height:9}},i={crop:{unit:"%",x:0,y:0,width:100,height:100},mask:"None"}},82138:(e,t,n)=>{function o(){return!0===window.__mobileAppBackgroundLaunch}n.d(t,{Z:()=>o})},97213:(e,t,n)=>{n.d(t,{F:()=>o});let o=function(e){return e.NotSpecified="NotSpecified",e.CreatorProfile="CreatorProfile",e.SpaceSwitcher="SpaceSwitcher",e.DeleteAccount="DeleteAccount",e.NoAvailableSpaces="NoAvailableSpaces",e.MobileNativeListener="MobileNativeListener",e.LogoutRouteVisited="LogoutRouteVisisted",e.AdminActionSelfLogout="AdminActionSelfLogout",e.AdminLogoutFallThrough="AdminActionFallThrough",e.PublicPageAccessDenied="PublicPageAccessDenied",e.PageAccessDenied="PageAccessDenied",e.OnboardingError="OnboardingError",e.OnboardingExit="OnboardingExit",e}({})},25718:(e,t,n)=>{n.d(t,{cG:()=>O,AS:()=>F,Lk:()=>E,wB:()=>x,dx:()=>C,c8:()=>Q,lM:()=>Y,on:()=>J,CK:()=>K,WB:()=>D});n(57658);var o=n(67266),i=n.n(o),r=n(53965),a=n(1898),s=n(40376),l=n(41432),c=n(80951),d=n(7057),u=n(14215),p=n(95538),m=n(64962),f=n(61075),g=n(64572),h=n(22808),v=n(59753),b=n(21202);var y=n(19233),_=n(606),S=n(70279),w=n(19889),k=n(70203);n(37850);var I=n(7928);function C(e){const t=k.J7s(e);return"a"===t?"[":"b"===t?"**":"i"===t?"*":"c"===t?"`":"s"===t?"~~":"e"===t?"$":""}function x(e,t,n){const o=k.J7s(e);if(k.j0F(e)){const o=k.zW$(e),i=(0,g.A5)({...n,url:o});return`](${(i?t({toPageId:i}):o)||""})`}return"b"===o?"**":"i"===o?"*":"c"===o?"`":"s"===o?"~~":"e"===o?"$":""}function T(e){const{annotation:t,exportArgs:n}=e,{getRecordValue:o,userTimeZone:i,getExportedPathToPage:r,intl:s,transformAnnotation:l}=n;if(l){const e=l(t,n);if("string"==typeof e)return e}if(k.IWo(t)){const e=k.zEN(t),n=o({table:w.KJ,id:e});return`@${(0,I.Nz)(s,n)}`}if(k.STW(t)){const e=k.TOT(t),i=o({table:b.iU,id:e});if(i){return`[${D({block:i,exportArgs:n})}](${r({toPageId:e})})`}}else{if(k.K$_(t)){var c;const e=k.r3j(t),i=o({table:S.x_,id:e,spaceId:n.root.spaceId});return null==i||null===(c=i.text)||void 0===c?void 0:c.toString()}if(k.fpG(t)){const{date_format:e,time_format:o,...r}=k.zyO(t);return(0,d.ZV)({value:r,date_format:e,time_format:o,userTimeZone:i,allowRelativeDates:!1,intl:n.intl})}if(k.kuv(t))return k.xey(t);if(k._bk(t)){const e=(0,f.kF)({annotation:t,exportArgs:n});if(e)return e}else{if(k.nSN(t)){var u;const e=k.frW(t);return null===(u=o({table:b.iU,id:e,spaceId:n.root.spaceId}))||void 0===u||null===(u=u.format)||void 0===u?void 0:u.original_url}if(k.OU5(t))return"";if(k.inx(t)||k.j0F(t)||k.aC4(t)||k.xw5(t)||k.BIG(t)||k.pV3(t)||k.STW(t)||k.rIb(t)||k.LAI(t)||k.fTS(t)||k.aq(t)||k.QVC(t)||k.uge(t)||k.Lyt(t)||k.wjk(t)||k.Ojp(t)||k.otC(t))return;(0,a.t1)(t)}}}function M(e){const t=/^\s+/.exec(e);return t?t[0]:""}function P(e){const t=/\s+$/.exec(e);return t?t[0]:""}function A(e){const t=P(e);return t.length>0?e.slice(0,-1*t.length):e}function R(e){const t=M(e);return e.slice(t.length)}function D(e){const{block:t,exportArgs:n}=e;return K({textValue:k.lzi(v.kk.fromBlock(t).getProperties().title),exportArgs:n})}function E(e){const{block:t,exportArgs:n}=e,{getRecordValue:o}=n,i=t&&t.content?t.content:[];return r.oA(r.UI(i,(t=>q({block:o({table:b.iU,id:t}),exportArgs:{...n,blockId:t},visitedBlock:e.visitedBlock}))))}function B(e){return e.split("\n")}function F(e){const{block:t,exportArgs:n}=e,o=k.lzi(v.kk.fromBlock(t).getProperties().caption);return o.length>0?[{text:K({textValue:o,exportArgs:n}),breakLines:!0,children:[]}]:[]}function O(e){const{block:t,exportArgs:n}=e;return K({textValue:k.lzi(v.kk.fromBlock(t).getProperties().caption),exportArgs:n})}function Z(e){return{text:"",breakLines:!0,children:E(e)}}function V(){}function U(e){const{block:t,exportArgs:n}=e;return{text:`# ${D({block:t,exportArgs:n}).trim()}`,breakLines:!0,children:E(e)}}function L(e){const{block:t,exportArgs:n}=e;return{text:`- ${D({block:t,exportArgs:n}).trim()}`,breakLines:!1,childrenPrefix:W,children:E(e)}}function j(e){const{block:t,exportArgs:n}=e,{getExportedRenderAsset:o}=n,{source:i}=v.kk.fromBlock(t).getProperties(),r=k.QaF(i),a=o({fromBlockId:n.blockId,toFileURI:r});return{text:`[${O(e)||D({block:t,exportArgs:n})||a}](${a})`,breakLines:!0,children:F(e)}}function N(e){const{block:t,exportArgs:n}=e,{getRecordValue:o,getExportedPathToPage:i,userTimeZone:r,intl:a}=n;if("collection_view"===t.type||"collection_view_page"===t.type){return{text:`[${(0,f.Ho)({blockId:t.id,getRecordValue:o,userTimeZone:r,intl:a})}](${i({toPageId:t.id,exportFileExt:".csv"})})`,breakLines:!0,children:[]}}}const z={text:function(e){const{block:t,exportArgs:n}=e;return{text:D({block:t,exportArgs:n}),breakLines:!0,children:E(e)}},header:U,sub_header:function(e){const{block:t,exportArgs:n}=e;return{text:`## ${D({block:t,exportArgs:n}).trim()}`,breakLines:!0,children:E(e)}},sub_sub_header:function(e){const{block:t,exportArgs:n}=e;return{text:`### ${D({block:t,exportArgs:n}).trim()}`,breakLines:!0,children:E(e)}},quote:function(e){const{block:t,exportArgs:n}=e;return{text:`> ${D({block:t,exportArgs:n}).trim()}`,breakLines:!0,childrenPrefix:"> ",children:E(e)}},bulleted_list:L,toggle:L,to_do:function(e){const{block:t,exportArgs:n}=e;let o;return o=c.Ml(v.kk.fromBlock(t).getProperties().checked)?"- [x] ":"- [ ] ",{text:`${o} ${D({block:t,exportArgs:n}).trim()}`,breakLines:!1,childrenPrefix:W,children:E(e)}},numbered_list:function(e){const{block:t,exportArgs:n}=e,{getRecordValue:o}=n;return{text:`${function(e){const{block:t,getRecordValue:n}=e,o=t.parent_id,i=n({table:b.iU,id:o});let a;a=i?r.oA(r.UI(i.content,(e=>n({table:b.iU,id:e})))):[];const s=r.cx(a,(e=>e.id===t.id)),c=r.tP(a,0,s),d=r.qr(c,(e=>e.type!==l.Ti.numberedList));return c.length-(d+1)}({block:t,getRecordValue:o})+1}. ${D({block:t,exportArgs:n})}`,breakLines:!1,childrenPrefix:W,children:E(e)}},code:function(e){const{block:t,exportArgs:n}=e,o=D({block:t,exportArgs:n});return{text:`${`\`\`\`${t.properties&&t.properties.language?function(e){const t=k.QaF(e);if(!t)return"";const n=y.W[t];return void 0===n||n===y.W["Plain Text"]?"":n}(t.properties.language):""}\n${B(o).join("\n")}\n\`\`\``}`,breakLines:!0,children:[]}},page:function(e){const{block:t,exportArgs:n}=e;if(t.id===n.navigableBlockId&&!n.renderParentBlockId)return U(e);const{getExportedPathToPage:o}=n;return{text:`[${D({block:t,exportArgs:n})}](${o({toPageId:t.id})})`,breakLines:!0,children:[]}},image:function(e){const{block:t,exportArgs:n}=e,{getExportedRenderAsset:o}=n,{source:i}=v.kk.fromBlock(t).getProperties(),r=k.QaF(i),a=o({fromBlockId:n.blockId,toFileURI:r}),s=O(e)||D({block:t,exportArgs:n})||a;return{text:(0,p.SR)({url:r})?`![${s}](${a})`:`[${s}](${a})`,breakLines:!0,children:F(e)}},video:j,embed:j,bookmark:function(e){const{block:t,exportArgs:n}=e,{link:o}=v.kk.fromBlock(t).getProperties(),i=c.zB(o);return{text:`[${D({block:t,exportArgs:n})}](${i})`,breakLines:!0,children:F(e)}},file:j,external_object_instance:function(e){var t;const{block:n}=e,o=null===(t=n.format)||void 0===t?void 0:t.original_url;if(o)return{text:`[${o}](${o})`,breakLines:!0,children:[]}},tweet:j,maps:j,gist:j,framer:j,invision:j,mixpanel:j,drive:function(e){const{block:t}=e;if(t.format&&t.format.drive_properties){const{url:e,title:n}=t.format.drive_properties;return{text:`[${n}](${e})`,breakLines:!0,children:[]}}return j(e)},figma:j,loom:j,pdf:j,typeform:j,codepen:j,audio:j,divider:function(){return{text:"---",breakLines:!0,children:[]}},equation:function(e){const{block:t}=e;let n="";return t&&t.properties&&t.properties.title&&(n=k.QaF(t.properties.title)),{text:`$$\n${n}\n$$`,breakLines:!0,children:[]}},collection_view:N,collection_view_page:N,column_list:Z,column:Z,factory:V,personal_home_page:V,copy_indicator:V,breadcrumb:V,link_to_collection:V,link_to_page:V,callout:function(e){var t;const{block:n,exportArgs:o}=e,i=D({block:n,exportArgs:o}),r=null===(t=n.format)||void 0===t?void 0:t.page_icon;return{text:`${(0,h.Z)(r)?r:"string"==typeof r?function(e){let{source:t,width:n=40,exportArgs:o}=e;const{getExportedRenderAsset:i}=o,r=i({fromBlockId:o.blockId,toFileURI:t});return`<img src="${r}" alt="${r}" width="${n}px" />`}({source:r,exportArgs:o}):""} ${i}`.trim(),breakLines:!0,children:E(e),htmlTag:"aside"}},table_of_contents:V,whimsical:j,miro:j,abstract:j,sketch:j,excalidraw:j,replit:j,hex:j,deepnote:j,alias:function(e){const{block:t,exportArgs:n}=e,{getRecordValue:o}=n;if(t.format&&t.format.alias_pointer&&(0,_.$O)(t.format.alias_pointer,b.iU)){const i=o(t.format.alias_pointer);if(i)return q({block:i,exportArgs:{...n,renderParentBlockId:t.id,blockId:t.format.alias_pointer.id},visitedBlock:e.visitedBlock})}},transclusion_container:Z,transclusion_reference:function(e){const{block:t,exportArgs:n}=e,{getRecordValue:o}=n;if(t.format&&t.format.transclusion_reference_pointer){const i=o(t.format.transclusion_reference_pointer);if(i)return q({block:i,exportArgs:{...n,renderParentBlockId:t.id,blockId:t.format.transclusion_reference_pointer.id},visitedBlock:e.visitedBlock})}},table:function(e){var t;const{block:n,exportArgs:o}=e,{getRecordValue:i}=o,r=(null===(t=n.format)||void 0===t||null===(t=t.table_block_column_order)||void 0===t?void 0:t.length)||0,a=n.content,s={text:"",breakLines:!0,children:[]};if(0===r||!a)return s;const l=a.map((t=>{const r=i({table:b.iU,id:t});return r&&q({block:r,exportArgs:{...o,blockId:t,renderParentBlockId:n.id},visitedBlock:e.visitedBlock})||s})),c={text:`| ${[...Array(r).keys()].map((()=>"---")).join(" | ")} |`,breakLines:!1,children:[]};return{text:"",breakLines:!0,children:[l[0],c,...l.slice(1)]}},table_row:function(e){var t;const{block:n,exportArgs:o}=e,{getRecordValue:i,renderParentBlockId:r}=o;if(!r)return;const a=i({table:b.iU,id:r}),s=null==a||null===(t=a.format)||void 0===t?void 0:t.table_block_column_order;if(!s)return;return{text:`| ${s.map((t=>{const o=c.wS(n,t);return o?(0,f.hJ)({textValue:o,fromString:e=>e,exportArgs:e.exportArgs,renderers:m.O}).join(""):void 0})).join(" | ")} |`,breakLines:!1,children:[]}},tab:function(e){var t;const{block:n,exportArgs:o}=e,{getRecordValue:i}=o;return{text:`${r.oA(null===(t=n.content)||void 0===t?void 0:t.flatMap((e=>{const t=i({table:b.iU,id:e});if(t)return[D({block:t,exportArgs:o}),H(E({block:t,exportArgs:o})).trim()]}))).join("\n\n")}\n\t\t`,breakLines:!0,children:[]}},external_object_instance_page:V,button:V,ai_block:Z,drawing:V};function q(e){const{block:t,forceRenderAsText:n,exportArgs:{transformBlockMapping:o}}=e;if(t&&t.type){if(e.visitedBlock){if(e.visitedBlock.has(t.id))return;e.visitedBlock.add(t.id)}const i=n&&l.wL[t.type]?(null==o?void 0:o.text)??z.text:(null==o?void 0:o[t.type])??z[t.type];if(i)return i(e)}}const W="    ";function H(e){let t="";for(const n of e){n.breakLines&&(t+="\n"),n.htmlTag&&(t+=`<${n.htmlTag}>\n`),n.text&&(t+=`${n.text}\n`),n.breakLines&&(t+=n.childrenPrefix?`${n.childrenPrefix}\n`:"\n");let e=H(n.children);if(e&&n.childrenPrefix){const t=B(e);e=[...t.slice(0,-1).map((e=>n.childrenPrefix+e)),...t.slice(-1)].join("\n")}t+=`${e}`,n.htmlTag&&(t+=`</${n.htmlTag}>\n\n`),n.suffix&&(t+=`${n.suffix}\n\n`)}return t=t.replace(/[\n]{3,}/g,"\n\n"),t}function K(e){const{textValue:t,exportArgs:n}=e;let o="";const l=k.lzi(t);let c=[];for(const p of l){const e=s.u.normalize(k.hDy(p)),t=(0,u.N)(c,e,(e=>i()(e))),l=k.WiV(p),d=e.map((e=>T({annotation:e,exportArgs:n}))).find((e=>(0,a.$K)(e))),m=d??l,f=P(o);o=A(o),t.deleted.reverse();for(const i of t.deleted)o+=x(i,n.getExportedPathToPage,n);o+=f,o+=M(m);for(const n of t.created)o+=C(n);o+=R(m);c=[...r.DY(c,e,((e,t)=>r.Xy(e,t))),...t.created]}const d=P(o);o=A(o),c.reverse();for(const i of c)o+=x(i,n.getExportedPathToPage,n);return o+=d,o}function G(e,t){const n=(new e).match(t)||[];if(0===n.length)return t;let o="",i=0;for(const r of n){const e=0===r.index||"<"!==t[r.index-1],n=r.lastIndex===t.length||">"!==t[r.lastIndex],a=Boolean(t.slice(r.index).match(/^[a-z][a-z]+:/i)),s=e&&n&&a;o+=t.slice(i,r.index),s&&(o+="<"),o+=r.raw,s&&(o+=">"),i=r.lastIndex}return o+=t.slice(i),o}function $(e){return e.replace(/\\/g,"\\\\")}function Q(e){const{MarkdownIt:t,LinkifyIt:n,markdown:o,plugin:i}=e,r=new t({linkify:!0});return i&&r.use(i),r.render($(G(n,o)))}function Y(e){const{MarkdownIt:t,LinkifyIt:n,markdown:o,plugin:i}=e,r=new t({linkify:!0});return i&&r.use(i),r.renderInline($(G(n,o)))}function J(e,t){const n=new Set;return H(r.oA(e.map((e=>q({block:e,exportArgs:{...t,blockId:e.id},visitedBlock:n}))))).trim()}},49143:(e,t,n)=>{function o(e){return{...e.page?{page:!0,createPage:Boolean(e.createPage)}:{page:!1,createPage:!1},...e.user?{user:!0,inviteUserToWorkspace:Boolean(e.inviteUserToWorkspace),inviteUserToPage:Boolean(e.inviteUserToPage)}:{user:!1,inviteUserToWorkspace:!1,inviteUserToPage:!1},...e.date?{date:!0,reminder:Boolean(e.reminder)}:{date:!1,reminder:!1},bot:Boolean(e.bot),heading:Boolean(e.heading),group:Boolean(e.group),templateVariable:Boolean(e.templateVariable)}}function i(e){return{...null!=e&&e.page?{page:!0,createPage:!0}:{page:!1,createPage:Boolean(null==e?void 0:e.createPage)},...null!=e&&e.user?{user:!0,inviteUserToWorkspace:!0,inviteUserToPage:!0}:{user:!1,inviteUserToWorkspace:Boolean(null==e?void 0:e.inviteUserToWorkspace),inviteUserToPage:Boolean(null==e?void 0:e.inviteUserToPage)},...null!=e&&e.date?{date:!0,reminder:!0}:{date:!1,reminder:Boolean(null==e?void 0:e.reminder)},bot:Boolean(null==e?void 0:e.bot),heading:Boolean(null==e?void 0:e.heading),group:Boolean(null==e?void 0:e.group),templateVariable:Boolean(null==e?void 0:e.templateVariable)}}function r(e){return i({page:!e.page,createPage:!e.createPage,user:!e.user,inviteUserToWorkspace:!e.inviteUserToWorkspace,inviteUserToPage:!e.inviteUserToPage,date:!e.date,reminder:!e.reminder,bot:!e.bot,group:!e.group,heading:!e.heading,templateVariable:!e.templateVariable})}n.d(t,{lU:()=>i,lX:()=>o,p_:()=>r})},44615:(e,t,n)=>{n.d(t,{Cy:()=>b,JK:()=>R,JY:()=>h,Lp:()=>y,Mv:()=>k,NP:()=>C,Ns:()=>S,T0:()=>M,TA:()=>x,ZS:()=>m,bS:()=>v,e7:()=>E,jY:()=>g,je:()=>_,pD:()=>P,pb:()=>I,pz:()=>f,vb:()=>w});var o=n(7032),i=n(606),r=n(21202),a=n(6287),s=n(13493),l=n(80396),c=n(75246),d=n(77858),u=n(29369);const p={[c.bx]:!0,[r.iU]:!0,[s.np]:!0,[a.vF]:!0,[d.zU]:!0,[u.e0]:!0,[l.yo]:!0};function m(e){return(0,i.UI)(e.table)&&!(e.table in p)?`versions/${e.id}:${e.table}:${e.spaceId}`:`versions/${e.id}:${e.table}`}function f(e){const t=e.indexOf("/");if(-1===t)return;const n=e.substring(t+1).split(":");return 2===n.length?i.dr.fromPointerLike({table:n[1],id:n[0]}):3===n.length?i.dr.fromPointerLike({table:n[1],id:n[0],spaceId:n[2]}):void 0}function g(e){return`collection/${e}`}function h(e){return`typedDatabasesListChanged/${e.spaceId}-${e.databaseType}`}function v(e){return`activity/${e}`}function b(e){return`activity/${e}`}function y(e){return`notification/${e}`}function _(e){return`teams_in_space/${e}`}function S(e){return`user_page_visit/${e}`}function w(e){let{botId:t,accountId:n,calendarId:i}=e;return`cron/events_updated/${t}/${n}/${(0,o.Ul)(i)}`}function k(e){return`backlinks/${e}`}function I(e){return`page_visit/${e}`}function C(e){return`user_shared_pages_in_space/${e.spaceId}-${e.userId}`}function x(e){return`subscription_banner/${e.spaceId}`}const T="presence";function M(e){return`${T}/${e}`}function P(e){return`user_joined_teams_in_space/${e.userId}:${e.spaceId}`}const A="diagnosticPing";function R(e){return`${A}/${e}`}const D="presence/drawing";function E(e){return`${D}/${e}`}},56589:(e,t,n)=>{function o(e,t){return t&&e.redirect_uris.includes(t)?t:t||1!==e.redirect_uris.length?void 0:e.redirect_uris[0]}n.d(t,{_:()=>o})},82036:(e,t,n)=>{n.d(t,{_:()=>o});const o={invalid_request:"invalid_request",unauthorized_client:"unauthorized_client",access_denied:"access_denied",unsupported_response_type:"unsupported_response_type",invalid_scope:"invalid_scope",server_error:"server_error",temporarily_unavailable:"temporarily_unavailable"}},77337:(e,t,n)=>{n.d(t,{FS:()=>D,bv:()=>T,lK:()=>x,Iw:()=>A});n(21703),n(57658);var o=n(53965),i=n(1898),r=n(19584),a=n(40902),s=n(53504),l=n(45681),c=n(59730);n(30541);function d(e,t){let n=Array.isArray(t)?t:[];return n=n.filter((t=>t!==e.id)),n}function u(e,t){let n=Array.isArray(t)?t:[];return n=n.filter((t=>t&&t.id&&t.id!==e.remove.id)),n}var p=n(59753),m=n(482),f=n(87479),g=n(80951),h=n(606),v=n(21202);n(70203);function b(e,t){const n=(0,g.rq)(t).filter((t=>t.id!==e.id));return(0,g.ow)(n)}function y(e,t){const n=(0,g.rq)(t),o=n.findIndex((t=>t.id===e.args.id));return o<0?{pointer:e.pointer,path:e.path,command:"removeRelation",args:{id:e.args.id,spaceId:e.args.spaceId}}:o===n.length-1?{pointer:e.pointer,path:e.path,command:"addRelationAfter",args:{id:e.args.id,spaceId:e.args.spaceId}}:{pointer:e.pointer,path:e.path,command:"addRelationBefore",args:{id:e.args.id,before:n[o+1].id,spaceId:e.args.spaceId}}}var _=n(76462),S=n(64684),w=n(67175);const k={set:function(e){return e},update:function(e,t){return t||(t={}),{...t,...e}},listBefore:function(e,t){let n=Array.isArray(t)?t:[];n=d({id:e.id},n);const i=o.cx(n,(t=>t===e.before));return i>=0?n.splice(i,0,e.id):n.unshift(e.id),n},listAfter:function(e,t){let n=Array.isArray(t)?t:[];n=d({id:e.id},n);const i=o.cx(n,(t=>t===e.after));return i>=0?n.splice(i+1,0,e.id):n.push(e.id),n},listRemove:d,listReplace:function(e,t){let n=Array.isArray(t)?t:[];return n=n.map((t=>t===e.id?e.newId:t)),n},listAfterMulti:function(e,t){const n=new Set(e.ids),i=(Array.isArray(t)?t:[]).filter((e=>!n.has(e))),r=o.cx(i,(t=>t===e.after));return r>=0?i.splice(r+1,0,...e.ids):i.push(...e.ids),i},listBeforeMulti:function(e,t){const n=new Set(e.ids),i=(Array.isArray(t)?t:[]).filter((e=>!n.has(e))),r=o.cx(i,(t=>t===e.before));return r>=0?i.splice(r,0,...e.ids):i.unshift(...e.ids),i},keyedObjectListBefore:function(e,t){let n=Array.isArray(t)?t:[];n=u({remove:{id:e.value.id}},n);const i=e.before?e.before.id:void 0,r=o.cx(n,(e=>e&&e.id&&e.id===i));return r>=0?n.splice(r,0,e.value):n.unshift(e.value),n},keyedObjectListAfter:function(e,t){let n=Array.isArray(t)?t:[];n=u({remove:{id:e.value.id}},n);const i=e.after?e.after.id:void 0,r=o.cx(n,(e=>e&&e.id&&e.id===i));return r>=0?n.splice(r+1,0,e.value):n.push(e.value),n},keyedObjectListRemove:u,keyedObjectListUpdate:function(e,t){const n=Array.isArray(t)?[...t]:[],i=o.cx(n,(t=>t&&t.id&&t.id===e.value.id));return i>=0?n[i]=e.value:n.push(e.value),n},appendActivity:a.tR,setPermissionItem:f.r2,setSingletonPermissionItem:f.co,addRelation:function(e,t){const n=(0,g.rq)(t),o={id:e.id,spaceId:e.spaceId,table:v.iU},i=h.dr.uniq([...n,o]);return(0,g.ow)(i)},addRelationAfter:function(e,t){const n=b({id:e.id,spaceId:e.spaceId},t),o=(0,g.rq)(n),i={id:e.id,spaceId:e.spaceId,table:v.iU};let r;if(e.after){const t=o.findIndex((t=>t.id===e.after));r=h.dr.uniq([...o.slice(0,t+1),i,...o.slice(t+1)])}else r=h.dr.uniq([...o,i]);return(0,g.ow)(r)},addRelationBefore:function(e,t){const n=b({id:e.id,spaceId:e.spaceId},t),o=(0,g.rq)(n),i={id:e.id,spaceId:e.spaceId,table:v.iU};let r;if(e.before){const t=o.findIndex((t=>t.id===e.before));r=h.dr.uniq([...o.slice(0,t),i,...o.slice(t)])}else r=h.dr.uniq([i,...o]);return(0,g.ow)(r)},addRelations:function(e,t){const n=o.Kn(t)?t:{},i={...n};for(const o in e){const t=e[o],r=(0,g.rq)(n[o]),a=h.dr.uniq([...r,...t.map((e=>({id:e.id,spaceId:e.spaceId,table:v.iU})))]);i[o]=(0,g.ow)(a)}return i},removeRelation:b,copyFile:function(e,t){const n=t.file_ids||[];return n.includes(e.fileId)?{...t}:{...t,file_ids:[...n,e.fileId]}},removeTeamMembershipItem:S.Uk,setTeamMembershipItem:S.I6};function I(e,t){return function(e,t){if(0!==e.path.length||!(0,i.Kn)(t)||0!==Object.keys(t).length||!(0,i.Kn)(e.args))return!1;const n=e.args.format;return!!(0,i.Kn)(n)&&!0===n.use_crdt}(e,t)?{pointer:e.pointer,path:[],command:"update",args:{alive:!1}}:{pointer:e.pointer,path:e.path,command:"set",args:r.z4(t)?null:t}}function C(e){return void 0===e.size?1:e.size}function x(e,t){let n,i,a=t||{};if(n=e.path.length>0?(0,m.f4)(a,e.path):a,i=a.version?a.version+C(e):C(e),!k[e.command])throw new Error(`Unknown operation command ${e.command}.`);if(void 0!==e.expectedVersion&&a.version&&e.expectedVersion!==a.version)throw new c.vq("Mismatching expected and actual versions for the record",{clientData:{type:"operation_conflict",expectedVersion:e.expectedVersion,currentVersion:a.version,command:e.command,path:e.path,pointer:e.pointer}});n=(0,k[e.command])(e.args,n);a=e.path.length>0?function(e,t,n){if(0===t.length)throw new c.D3("Empty path to set");const i=o.d9(e);let r=i;for(let a=0;a<t.length;a++){const e=t[a],i=(0,m.Xc)(e)?o.cx(r,{id:e.id}):e;if(a===t.length-1)r[i]=n;else{let e=o.d9(r[i]);null==e&&(e="number"==typeof t[a+1]?[]:{}),r[i]=e,r=e}}return i}(a,e.path,n):n;const l=_.ZP[e.pointer.table],d=l.requiredColumns||{},u=l.defaultColumnValues||{};for(const o of Object.keys(d))!t||r.z4(t[o])||a&&!r.z4(a[o])||(u.hasOwnProperty(o)?a[o]=u[o]:a[o]=t[o]);if(a&&t){const e=t.file_ids||[];(a.file_ids||[]).length<e.length&&(a.file_ids=e)}return a=(0,s.Z)(a,"mangle-class-instances")||{},a.id=e.pointer.id,a.version=i,a}function T(e,t){let n;switch(t=t||{},n=e.path.length>0?(0,m.f4)(t,e.path):t,e.command){case"set":return I(e,n);case"update":return function(e,t){t||(t={});const n={};return Object.keys(e.args).forEach((e=>{n[e]=t[e],void 0===n[e]&&(n[e]=null)})),{pointer:e.pointer,path:e.path,command:"update",args:n}}(e,n);case"listBefore":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t===e.args.id));if(o>=0){if(o+1===n.length)return{pointer:e.pointer,path:e.path,command:"listAfter",args:{id:e.args.id}};const t=n[o+1];return{pointer:e.pointer,path:e.path,command:"listBefore",args:{id:e.args.id,before:t}}}return{pointer:e.pointer,path:e.path,command:"listRemove",args:{id:e.args.id}}}(e,n);case"listAfter":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t===e.args.id));if(o>0){const t=n[o-1];return{pointer:e.pointer,path:e.path,command:"listAfter",args:{id:e.args.id,after:t}}}return 0===o?{pointer:e.pointer,path:e.path,command:"listBefore",args:{id:e.args.id}}:{pointer:e.pointer,path:e.path,command:"listRemove",args:{id:e.args.id}}}(e,n);case"listRemove":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t===e.args.id)),i=n[o-1];return i?{pointer:e.pointer,path:e.path,command:"listAfter",args:{id:e.args.id,after:i}}:{pointer:e.pointer,path:e.path,command:"listBefore",args:{id:e.args.id}}}(e,n);case"keyedObjectListBefore":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t.id===e.args.value.id));if(o>=0){if(o+1===n.length)return{pointer:e.pointer,path:e.path,command:"keyedObjectListAfter",args:e.args};const t=n[o+1];return{pointer:e.pointer,path:e.path,command:"keyedObjectListBefore",args:{value:e.args.value,before:{id:t.id}}}}return{pointer:e.pointer,path:e.path,command:"keyedObjectListRemove",args:{remove:{id:e.args.value.id}}}}(e,n);case"keyedObjectListAfter":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t.id===e.args.value.id));if(o>0){const t=n[o-1];return{pointer:e.pointer,path:e.path,command:"keyedObjectListAfter",args:{value:e.args.value,after:{id:t.id}}}}return 0===o?{pointer:e.pointer,path:e.path,command:"keyedObjectListBefore",args:{value:e.args.value}}:{pointer:e.pointer,path:e.path,command:"keyedObjectListRemove",args:{remove:{id:e.args.value.id}}}}(e,n);case"keyedObjectListRemove":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t.id===e.args.remove.id)),i=n[o],r=n[o-1];return i?r?{pointer:e.pointer,path:e.path,command:"keyedObjectListAfter",args:{value:i,after:{id:r.id}}}:{pointer:e.pointer,path:e.path,command:"keyedObjectListBefore",args:{value:i}}:{pointer:e.pointer,path:e.path,command:"keyedObjectListRemove",args:{remove:{id:e.args.remove.id}}}}(e,n);case"keyedObjectListUpdate":return function(e,t){t||(t={});const n=(Array.isArray(t)?t:[]).find((t=>t.id===e.args.value.id));return n?{pointer:e.pointer,path:e.path,command:"keyedObjectListUpdate",args:{value:n}}:{pointer:e.pointer,path:e.path,command:"keyedObjectListRemove",args:{remove:{id:e.args.value.id}}}}(e,n);case"addRelation":case"addRelationAfter":case"addRelationBefore":return y(e,n);case"removeRelation":return function(e,t){const n=(0,g.rq)(t),o=n.findIndex((t=>t.id===e.args.id));return o<0?{pointer:e.pointer,path:e.path,command:"addRelationAfter",args:{id:e.args.id,spaceId:e.args.spaceId}}:0===o?{pointer:e.pointer,path:e.path,command:"addRelationBefore",args:{id:e.args.id,before:n.length>1?n[1].id:void 0,spaceId:e.args.spaceId}}:{pointer:e.pointer,path:e.path,command:"addRelationAfter",args:{id:e.args.id,after:n[o-1].id,spaceId:e.args.spaceId}}}(e,n);default:return}}function M(e){let{operation:t,previousOperation:n}=e;return{...t,args:t.args,size:C(t)+C(n)}}function P(e){let{operation:t,previousOperation:n}=e;return{...t,args:{...n.args,...t.args},size:C(t)+C(n)}}function A(e){const[t,...n]=e,i=[t];for(const r of n){const e=i[i.length-1],t=o.Xy(r.pointer,e.pointer)&&o.Xy(r.path,e.path);"set"===r.command&&"set"===e.command&&t?i[i.length-1]=M({operation:r,previousOperation:e}):"update"===r.command&&"update"===e.command&&t?i[i.length-1]=P({operation:r,previousOperation:e}):i.push(r)}return i}function R(e){const{getRecordModel:t,setNewValue:n,primitiveOperation:o,updateOnly:i}=e,r=t.getRecordValue(o.pointer);if(!i||r){const e=x(o,r);n({pointer:o.pointer,newValue:e})}}function D(e){const{recordMap:t,operations:n,updateOnly:o}=e;n.forEach((e=>{if((0,w.Qf)(e))throw new Error("Text operations should be applied separately")})),function(e){const{getRecordModel:t,setNewValue:n,recordOperations:o,updateOnly:i}=e;for(const r of o)if((0,m.SH)(r)){const e=(0,l.T1)(r,t.getRecordValue);for(const o of e)R({primitiveOperation:o,getRecordModel:t,setNewValue:n,updateOnly:i})}else R({primitiveOperation:r,getRecordModel:t,setNewValue:n,updateOnly:i})}({getRecordModel:p.om.fromRecordMap(t),setNewValue:e=>{const{pointer:n,newValue:o}=e;t.setValue(n,o)},recordOperations:n,updateOnly:o})}},69246:(e,t,n)=>{n.d(t,{PT:()=>a,cz:()=>r,fY:()=>l,g$:()=>s,kg:()=>o,mu:()=>i});const o="teamSidebar",i="teamBrowserSearch",r="teamBrowserUnjoinedTeams",a="teamBrowserJoinedTeams",s="publicPageTemplateIncludes";function l(e){const{block:t,query:n,getRecordModel:o,userTimeZone:i,intl:r}=e;if(!n)return!0;const a=null==t?void 0:t.getRenderTitle({getRecordModel:o,userTimeZone:i,intl:r});return!!a&&a.toLowerCase().indexOf(n.trim().toLowerCase())>=0}},87479:(e,t,n)=>{n.d(t,{wN:()=>ge,_G:()=>ne,D3:()=>me,uH:()=>re,WM:()=>se,KJ:()=>P,Wo:()=>X,Gx:()=>de,kD:()=>ue,YO:()=>z,nl:()=>A,uq:()=>pe,L2:()=>ee,OC:()=>j,Xr:()=>ie,qY:()=>K,Ub:()=>oe,Rh:()=>ae,FD:()=>le,GU:()=>Y,RT:()=>J,oF:()=>R,bk:()=>fe,zX:()=>q,r2:()=>x,co:()=>T,Kf:()=>M,mq:()=>ce,yY:()=>B,xO:()=>V,IF:()=>Z,gr:()=>O,SL:()=>F,ws:()=>C,IJ:()=>I,ZO:()=>k});n(57658),n(21703);var o=n(9291),i=n(53965),r=n(1898),a=n(41432),s=n(15070),l=n(59730),c=n(59753),d=n(63306),u=n(21202),p=n(77420),m=n(33709),f=n(75246),g=n(29369),h=n(19889),v=(n(47425),n(64684)),b=n(72141),y=n(45953),_=n(91627);function S(e){const{actorPointers:t,recordMap:n}=e,o=n||y.Ak.create();return{actorPointersSet:new _.X(t),actorMemberships:void 0,explicitTeamsRecordMap:void 0,temporarySpacesForSpaceUserValues:void 0,ancestorsRecordMap:o,type:"empty_permissions_context"}}function w(e){const{actors:t}=e,n=[];return t&&t.forEach((e=>{e&&n.push(e.pointer)})),n}function k(e){const{actor:t,ancestors:n,updatedPermissionItem:o}=e;return K({actorPointer:t&&t.pointer,ancestors:n,permissionsContext:S({actorPointers:w({actors:[t]}),recordMap:void 0})}).some((e=>{const t=M(e.permissionItem,o)?o.role:e.permissionItem.role;return!!t&&(0,b.zz)(t)}))}function I(e){const{actor:t,ancestors:n}=e,o=K({actorPointer:t&&t.pointer,ancestors:n,permissionsContext:S({actorPointers:w({actors:[t]}),recordMap:void 0})});if(1===o.length){const e=o[0];if((0,b.$D)(e.permissionItem)&&(0,b.YX)(e.permissionItem.role))return e}}function C(e,t){return e.some((e=>"user_permission"===e.type&&e.user_id===t))}function x(e,t){let n=t||[];if("public_permission"===e.type){const t=n.filter((e=>(0,b.$D)(e))).map((e=>e.added_timestamp||0));t.length>0?e.added_timestamp=Math.min(...t):e.added_timestamp=(new Date).getTime()}return n=n.filter((t=>!M(t,e))),n.push(e),n=n.filter((e=>!(0,b.C2)(e)||"none"!==(0,b.cY)(e))),n}function T(e,t){const{singletonPermissionItem:n,set:o}=e;let i=t||[];return i=i.filter((e=>!M(e,n))),o&&i.push(n),i}function M(e,t){return!(!e||!t)&&((0,b.jg)(e)&&(0,b.jg)(t)||(0,b.e_)(e)&&(0,b.e_)(t)?e.user_id===t.user_id:(0,b.FB)(e)&&(0,b.FB)(t)?e.bot_id===t.bot_id:(0,b.hV)(e)&&(0,b.hV)(t)?e.group_id===t.group_id:(0,b.LW)(e)&&(0,b.LW)(t)||(0,b.zU)(e)&&(0,b.zU)(t)?e.team_id===t.team_id:e.type===t.type)}function P(e){return(0,d.gc)(e).map((e=>{if(e.table===u.iU){const t=c.kk.isAnyModel(e)?e.getPermissionItems():e.value.permissions,n=c.kk.isAnyModel(e)?e.id:e.value.id;if(t&&t.length>0)return{from:{table:u.iU,blockId:n},permissions:t}}else if(e.table===g.e0){const t=c.kk.isAnyModel(e)?e.getPermissionItems():e.value.permissions,n=c.kk.isAnyModel(e)?e.id:e.value.id;if(t&&t.length>0)return{from:{table:g.e0,teamId:n},permissions:t}}})).filter(r.$K)}function A(){let e=0,t="none";for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];for(const s of o)if("string"==typeof s)e=Math.max(e,b.Av.indexOf(s));else for(const e of(0,r.Yd)(s))s[e]&&(t=E(t,e));const a=b.Av[e];return"editor"===a||"read_and_write"===a||"membership_admin"===a?a:"none"!==t&&Object.keys(t).length?("reader"!==a&&"comment_only"!==a&&"content_only_editor"!==a||(t=E(t,"read_content")),t):a}const R=(0,r.AO)((e=>"object"==typeof e?{true:e}:{false:e})),D=(0,r.AO)((e=>(0,s.pH)(e)||(0,s.Ye)(e)||"none"===e?{true:e}:{false:e}));function E(e,t){let n;return"none"===e?"read_content"===t?n={read_content:!0}:"update_content"===t?n={update_content:!0}:"insert_content"===t?n={insert_content:!0}:"read_property"===t||"update_property"===t||"insert_property"===t?n={read_property:!0}:"read_comment"===t?n={read_comment:!0}:"insert_comment"===t?n={insert_comment:!0}:(0,r.t1)(t):(n={...e},"read_content"===t?(n.read_content=!0,delete n.read_property):"update_content"===t?(n.update_content=!0,delete n.update_property):"insert_content"===t?(n.insert_content=!0,delete n.insert_property):"read_property"===t?n.read_content||(n.read_property=!0):"update_property"===t?n.update_content||(n.update_property=!0):"insert_property"===t?n.insert_content||(n.insert_property=!0):"read_comment"===t?n.read_comment=!0:"insert_comment"===t?n.insert_comment=!0:(0,r.t1)(t)),n}function B(e,t){if("string"==typeof e&&"string"==typeof t)return Z(e,t);if("string"==typeof e){if("editor"===e||"membership_admin"===e)return!0;e=b.jD[e]}if("string"==typeof t){if("editor"===t||"membership_admin"===t)return!1;t=b.jD[t]}return function(e,t){if("none"===t)return!0;if("none"===e)return!1;let n=!0;for(const o of(0,r.Yd)(t))"read_property"===o?n&&=e.read_property||e.read_content:"update_property"===o?n&&=e.update_property||e.update_content:"insert_property"===o?n&&=e.insert_property||e.insert_content:"read_content"===o?n&&=e.read_content:"update_content"===o?n&&=e.update_content:"insert_content"===o?n&&=e.insert_content:"read_comment"===o?n&&=e.read_comment:"insert_comment"===o?n&&=e.insert_comment:"link_preview"===o||"synced_database"===o||(0,r.t1)(o);return Boolean(n)}(e,t)}function F(e,t){return b.Av.indexOf(e)<=b.Av.indexOf(t)}function O(e,t){return b.Av.indexOf(e)<b.Av.indexOf(t)}function Z(e,t){return b.Av.indexOf(e)>=b.Av.indexOf(t)}function V(e,t){return b.Av.indexOf(e)>b.Av.indexOf(t)}function U(e,t){return void 0!==e&&e||void 0!==t&&t}function L(e){const{inheritedPermissionToCompare:t,mostPermissivePermissionLoose:n}=e,o=n;if((0,b.KF)(o.permissionItem)&&!(0,b.KF)(t.permissionItem))return t;const i=o.permissionItem.role,r=A(i,t.permissionItem.role),a=r!==i?t:o;return{from:a.from,permissionItem:{...a.permissionItem,role:r}}}function j(e){return e?(0,b.jg)(e)||(0,b.e_)(e)?`${e.type}:${e.user_id}`:(0,b.FB)(e)?`${e.type}:${e.bot_id}`:(0,b.hV)(e)?`${e.type}:${e.group_id}`:(0,b.zU)(e)||(0,b.LW)(e)?`${e.type}:${e.team_id}`:e.type:""}function N(e){return 1===e.length?e[0]:e.reduce(((e,t)=>{if(!M(e.permissionItem,t.permissionItem))throw Error("Items should be grouped by target, but given items have different targets");return(0,b.jg)(t.permissionItem)||(0,b.e_)(t.permissionItem)||(0,b.ix)(t.permissionItem)||(0,b.bm)(t.permissionItem)||(0,b.RI)(t.permissionItem)||(0,b.ZQ)(t.permissionItem)||(0,b.hV)(t.permissionItem)||(0,b.FB)(t.permissionItem)?L({mostPermissivePermissionLoose:e,inheritedPermissionToCompare:t}):(0,b.$D)(t.permissionItem)?function(e){const{mostPermissivePermissionLoose:t,inheritedPermissionToCompare:n}=e,o=L({mostPermissivePermissionLoose:t,inheritedPermissionToCompare:n});var i,r,a,s;return o.permissionItem={...o.permissionItem,allow_duplicate:(a=o.permissionItem.allow_duplicate,s=n.permissionItem.allow_duplicate,void 0===a||a||void 0===s||s),allow_search_engine_indexing:U(o.permissionItem.allow_search_engine_indexing,n.permissionItem.allow_search_engine_indexing),expiration_timestamp:(i=o.permissionItem.expiration_timestamp,r=n.permissionItem.expiration_timestamp,i&&r?Math.max(i,r):i||r)},o}({mostPermissivePermissionLoose:e,inheritedPermissionToCompare:t}):(0,b.gG)(t.permissionItem)?{...e,from:t.from}:(0,b.Le)(t.permissionItem)?e:void(0,r.t1)(t.permissionItem)}),e[0])}function z(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=i.xH(e.map((e=>{const{permissions:t,from:n}=e;return t.map((e=>({from:n,permissionItem:e})))})));n.reverse();const o=i.vM(n,(e=>j(e.permissionItem))),r=i.Q8(o,N),a=new Set,s=[];for(const i of n){const e=j(i.permissionItem);a.has(e)||(a.add(e),s.push(r[e]))}if(!t){const e=s.find((e=>(0,b.gG)(e.permissionItem)));if(e)return[e]}return s}function q(e){return e.table===f.bx}function W(e){return e.table===f.bx}function H(e){return e.table===g.e0}function K(e){const{actorPointer:t,ancestors:n,permissionsContext:o}=e;if((0,d.GR)(n))return[];let i=e.ignorePublicPermissions;i||(0,d.Zg)(n)||(i=!0);const r=n.find(W),[a,s,l]=r?[r.__IM_SORRY__getValue(),r.getPermissionItems(),r.getPermissionGroups()]:[null,[],[]],c=(null==t?void 0:t.table)===h.KJ&&t,f=(null==t?void 0:t.table)===p.cZ&&t,g=f&&f.id,y=n.find(H),_=y?y.__IM_SORRY__getValue():null;if(f&&f.spaceId&&a&&a.id!==f.spaceId)return[];f&&!i&&(i=!0);const S=c&&c.id,w=S?l.filter((e=>e.user_ids&&e.user_ids.includes(S))).reduce(((e,t)=>(e.add(t.id),e)),new Set):new Set,k=z(P(n).map((e=>{const{permissions:t,from:n}=e;return{from:n,permissions:t.filter((e=>{if((0,b.jg)(e)||(0,b.e_)(e))return e.user_id===S;if((0,b.FB)(e))return e.bot_id===g;if((0,b.hV)(e))return w.has(e.group_id);if((0,b.Ix)(e))return Boolean(S&&_&&a&&(0,v.AL)({userId:S,team:_,spaceValue:a,groupIdsThatIncludeUser:w}));if((0,b.KK)(e))return Boolean(_&&c&&(0,v.pd)(_,c.id));if((0,b.zU)(e)){const t=Q({team:_,permissionItem:e,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(S&&t&&a&&(0,v.AL)({userId:S,team:t,spaceValue:a,groupIdsThatIncludeUser:w}))}if((0,b.LW)(e)){const t=Q({team:_,permissionItem:e,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(t&&c&&(0,v.pd)(t,c.id))}if((0,b.bm)(e)){const t=Q({team:_,permissionItem:e,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(S&&t&&a&&(0,v.s8)({userId:S,team:t}))}return!0}))}}))),I=J({spacePermissions:s,userId:S||void 0,botId:g||void 0}),C=(0,d.Zg)(n),x=n.some((e=>Boolean(e.table===m.qF&&e.resolved)));return k.filter((e=>{const{permissionItem:t}=e;if(!(0,b.C2)(t))return!1;if((!C||x)&&(0,b.rz)(t.role)&&!(0,b.FB)(t))return!1;if(((0,b.jg)(t)||(0,b.e_)(t))&&t.user_id===S)return!0;if((0,b.FB)(t)&&t.bot_id===g)return!0;if((0,b.Ix)(t))return Boolean(S&&_&&a&&(0,v.AL)({userId:S,team:_,spaceValue:a,groupIdsThatIncludeUser:w}));if((0,b.KK)(t))return Boolean(_&&c&&(0,v.pd)(_,c.id));if((0,b.zU)(t)){const e=Q({team:_,permissionItem:t,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(S&&e&&a&&(0,v.AL)({userId:S,team:e,spaceValue:a,groupIdsThatIncludeUser:w}))}if((0,b.bm)(t)){const e=Q({team:_,permissionItem:t,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(S&&e&&a&&(0,v.s8)({userId:S,team:e}))}if((0,b.LW)(t)){const e=Q({team:_,permissionItem:t,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(e&&c&&(0,v.pd)(e,c.id))}return!(!(0,b.ix)(t)||!I)||(!(i||!(0,b.$D)(t)||(0,b.o7)(t))||!!((0,b.hV)(t)&&I&&w.has(t.group_id)))})).map((e=>{const{from:t,permissionItem:o}=e,[i,r]=n;if("content_only_editor"===o.role){if(t.table!==u.iU)return $(n,t,e,o);if(!G(t,i)&&!G(t,r))return $(n,t,e,o);if(r&&r.table===t.table&&"collection"!==i.table&&"collection_view"!==i.table&&r.hasWikiBlockUri())return $(n,t,e,o)}return e}))}function G(e,t){return!!t&&(t.table===e.table&&t.id===e.blockId)}function $(e,t,n,o){return function(e,t){if(t.table!==u.iU)return!1;const n=e.findIndex((e=>e.table===u.iU&&e.type===a.Ti.page&&e.is_template));if(n<0)return!1;const o=e[n+2];if(!o)return!1;if(o.table!==u.iU)return!1;return o.isType(a.pg)&&o.id===t.blockId}(e,t)?{...n,permissionItem:{...o,role:"comment_only"}}:{...n,permissionItem:{...o,role:"read_and_write"}}}function Q(e){var t;let{team:n,permissionItem:o,spaceId:i,permissionsContext:r}=e;if(n&&n.id===o.team_id)return n;const a={table:g.e0,id:o.team_id,spaceId:i};let s=null===(t=r.explicitTeamsRecordMap)||void 0===t?void 0:t.getValue(a);return s||(s=r.ancestorsRecordMap.getValue(a)),s}function Y(e){const{spacePermissions:t,userId:n}=e;return t.some((e=>(0,b.jg)(e)&&e.user_id===n&&(0,b.J5)(e.role)))}function J(e){const{spacePermissions:t,userId:n,botId:o}=e;return t.some((e=>{const t=(0,b.jg)(e)&&e.user_id===n&&(0,b.J5)(e.role),i=(0,b.FB)(e)&&e.bot_id===o&&(0,b.J5)(e.role),r=(0,b.jg)(e)&&e.user_id===n&&(0,b.Bc)(e.role);return t||i||r}))}function X(e){return z(P(e)).map((e=>{let{permissionItem:t}=e;return t}))}function ee(e,t){const n=[],o=[],r=[],a=[],s={};for(const i of e){s[j(i)]=i}for(const l of t){const e=j(l);if(s[e]){const t=s[e];(0,b.C2)(t)&&(0,b.C2)(l)&&!i.Xy(t.role,l.role)?r.push([t,l]):a.push(l),delete s[e]}else n.push(l)}for(const i of Object.values(s))o.push(i);return{created:n.sort(ne),deleted:o.sort(ne),changed:r.sort(ne),unchanged:a.sort(ne)}}function te(e){return Array.isArray(e)?e[0].type:e.type}function ne(e,t){return b.UF.indexOf(te(e))-b.UF.indexOf(te(t))}function oe(e,t,n){const o=ee(t,n),i=o.unchanged.filter((e=>(0,b.C2)(e)));for(const[s,l]of o.changed){const t=A(s.role,l.role);e.isCollectionView()||"read_and_write"!==s.role||"content_only_editor"!==l.role?s.role!==l.role&&s.role!==t&&i.push(s):i.push(s)}const r=[];for(const s of i){const t={pointer:e.pointer,command:"setPermissionItem",path:["permissions"],args:{...s,role:"none"}};r.push(t)}const a={pointer:e.pointer,command:"setSingletonPermissionItem",path:["permissions"],args:{singletonPermissionItem:{type:"restricted_permission"},set:!1}};return r.push(a),r}function ie(e,t){const n=[],o=ee(e,t);for(const i of o.created)if((0,b.C2)(i)){const e={...i,role:"none"};n.push([e,i])}for(const[i,r]of o.changed){const e=A(i.role,r.role);("content_only_editor"===r.role&&"read_and_write"===i.role||i.role!==e)&&n.push([i,r])}return n}function re(e){if(e){const{read_user_without_email:t,read_user_with_email:n,inherit_creator_permissions:o,link_preview:i,synced_database:r,webhooks:a,workspace_search:s,workspace_page_export:l,read_teamspace:c,...d}=e;if(D(d))return d}return"none"}function ae(e){if(!e)return{};const{read_user_with_email:t,read_user_without_email:n}=e;return n&&t?{read_user_without_email:n,read_user_with_email:t}:n?{read_user_without_email:n}:{}}function se(e){if(!e)return{};const{link_preview:t,synced_database:n}=e;return t&&n?{link_preview:t,synced_database:n}:t?{link_preview:t}:{}}function le(e){return Boolean(e&&e.inherit_creator_permissions)}const ce=(0,o.defineMessages)({adminLabel:{id:"userPermissionsMenu.adminItem.label",defaultMessage:"Admin"},adminCaption:{id:"userPermissionsMenu.adminItem.caption",defaultMessage:"Can change workspace settings and invite new members to the workspace."},workspaceOwnerLabel:{id:"userPermissionsMenu.workspaceOwnerItem.label",defaultMessage:"Workspace owner"},workspaceOwnerCaption:{id:"userPermissionsMenu.workspaceOwnerItem.caption",defaultMessage:"Can change workspace settings and invite new members to the workspace."},membershipAdminLabel:{id:"userPermissionsMenu.membershipAdminItem.label",defaultMessage:"Membership admin"},membershipAdminCaption:{id:"userPermissionsMenu.membershipAdminItem.caption",defaultMessage:"Can manage workspace and group membership."},fullAccessLabel:{id:"userPermissionsMenu.fullAccessItem.label",defaultMessage:"Full access"},fullAccessCaption:{id:"userPermissionsMenu.fullAccessItem.caption",defaultMessage:"Can edit and share with others."},requestFullAccessLabel:{id:"userPermissionsMenu.requestFullAccessItem.label",defaultMessage:"Request full access"},memberLabel:{id:"userPermissionsMenu.memberItem.label",defaultMessage:"Member"},memberCaption:{id:"userPermissionsMenu.memberItem.caption",defaultMessage:"Cannot change workspace settings or invite new members to the workspace."},canEditLabel:{id:"userPermissionsMenu.canEditItem.label",defaultMessage:"Can edit"},canEditCaption:{id:"userPermissionsMenu.canEditItem.caption",defaultMessage:"Can edit, but not share with others."},requestEditLabel:{id:"userPermissionsMenu.requestEditItem.label",defaultMessage:"Request edit access"},canEditContentLabel:{id:"userPermissionsMenu.canEditContentItem.label",defaultMessage:"Can edit content"},canEditContentCaption:{id:"userPermissionsMenu.canEditContentItem.caption",defaultMessage:"Can edit content, but can't edit the database's views or structure."},canReadLabel:{id:"userPermissionsMenu.canReadItem.label",defaultMessage:"Can view"},canReadCaption:{id:"userPermissionsMenu.canReadItem.caption",defaultMessage:"Cannot edit or share with others."},requestReadLabel:{id:"userPermissionsMenu.requestReadItem.label",defaultMessage:"Request view access"},canWriteLabel:{id:"userPermissionsMenu.canWriteItem.label",defaultMessage:"Can write."},canWriteCaption:{id:"userPermissionsMenu.canWriteItem.caption",defaultMessage:"Cannot read or share with others."},canCommentLabel:{id:"userPermissionsMenu.canCommentItem.label",defaultMessage:"Can comment"},canCommentCaption:{id:"userPermissionsMenu.canCommentItem.caption",defaultMessage:"Can view and comment, but not edit."},requestCommentLabel:{id:"userPermissionsMenu.requestCommentItem.label",defaultMessage:"Request comment access"},mixedAccessLabel:{id:"userPermissionsMenu.mixedAccessItem.label",defaultMessage:"Mixed access"},mixedAccessCaption:{id:"userPermissionsMenu.mixedAccessItem.caption",defaultMessage:"Has mixed access."},leaveWorkspaceLabel:{id:"userPermissionsMenu.leaveWorkspaceItem.label",defaultMessage:"Leave workspace"},removeFromWorkspaceLabel:{id:"userPermissionsMenu.removeFromWorkspaceItem.label",defaultMessage:"Remove from workspace"},removeWorkspaceLabel:{id:"userPermissionsMenu.removeWorkspaceItem.label",defaultMessage:"Remove"},disabledLabel:{id:"userPermissionsMenu.disabledItem.label",defaultMessage:"Disabled"},noAccessLabel:{id:"userPermissionsMenu.noAccessItem.label",defaultMessage:"No access"},guestLabel:{id:"userPermissionsMenu.guestItem.label",defaultMessage:"Guest"},pageGuestLabel:{id:"userPermissionsMenu.pageGuestItem.label",defaultMessage:"Page guest"},teamGuestLabel:{id:"userPermissionsMenu.teamGuestItem.label",defaultMessage:"Teamspace guest"},canAccessLabel:{id:"userPermissionsMenu.canAccessItem.label",defaultMessage:"Can access"},limitedAccessLabel:{id:"userPermissionsMenu.limitedAccessItem.label",defaultMessage:"Limited access"}});function de(e,t){if(!e)throw new Error("Expected to have a role");if("none"===e)return{label:ce.noAccessLabel};if(t===f.bx)return{label:ce.memberLabel,caption:ce.memberCaption};if(e.read_content&&e.update_content&&e.insert_content)return{label:ce.canEditLabel,caption:ce.canEditCaption};if(e.insert_content||e.update_content||e.read_content||e.read_comment)return{label:ce.mixedAccessLabel,caption:ce.mixedAccessCaption};if(e.insert_comment)return{label:ce.canCommentLabel,caption:ce.canCommentCaption};if(e.insert_property||e.update_property||e.read_property)throw new Error("Unsupported permission role");(0,r.t1)(e)}function ue(e,t){if(R(e)){const{label:n}=de(e,t);return n}return"reader"===e?ce.canReadLabel:"editor"===e?ce.fullAccessLabel:"read_and_write"===e?ce.canEditLabel:"content_only_editor"===e?ce.canEditContentLabel:"comment_only"===e?ce.canCommentLabel:"none"===e?ce.noAccessLabel:"membership_admin"===e?ce.membershipAdminLabel:void(0,r.t1)(e)}async function pe(e){const t=await async function(e){const{permissionItems:t,spaceUserPermissions:n,hasTeamLevelGuests:o,teamHasTeamLevelGuestsCache:i}=e,a={shared_internally:!1,shared_externally:!1,shared_to_web:!1,private:!1},s=t.filter((e=>!(0,b.Le)(e)));if(1===s.length&&(0,b.jg)(s[0]))return a.private=!0,a;const l=new Set((n??[]).map((e=>{let{user_id:t}=e;return t})));for(const c of s)switch(c.type){case"user_permission":case"exclusive_user_permission":l.has(c.user_id)?a.shared_internally=!0:a.shared_externally=!0;continue;case"explicit_team_owner_permission":case"explicit_team_permission":case"explicit_team_guest_permission":const e=c.team_id;(void 0!==(null==i?void 0:i[e])?i[e]:await o(e))?a.shared_externally=!0:a.shared_internally=!0;continue;case"bot_permission":a.shared_externally=!0;continue;case"group_permission":case"space_permission":a.shared_internally=!0;continue;case"public_permission":a.shared_to_web=!0;break;case"deleted_permission":case"restricted_permission":case"team_owner_permission":case"team_permission":continue;default:(0,r.t1)(c)}return a}(e);return function(e){if(e.shared_to_web)return"shared_to_web";if(e.shared_externally)return"shared_externally";if(e.shared_internally)return"shared_internally";return"private"}(t)}function me(e){switch(e.type){case"explicit_team_owner_permission":case"explicit_team_guest_permission":case"explicit_team_permission":return e.team_id;case"bot_permission":return e.bot_id;case"exclusive_user_permission":case"user_permission":return e.user_id;case"group_permission":return e.group_id;case"public_permission":case"team_permission":case"team_owner_permission":case"deleted_permission":case"restricted_permission":case"space_permission":return;default:(0,r.t1)(e)}}function fe(e){let{teamValue:t,permissionRole:n}=e;const o=(0,v.xC)(t);if(!o)throw new l.p8("Couldn't find team's default permission");return A(n,o)===o&&n!==o}function ge(e){let{spaceValue:t,spaceMembers:n,teamsInSpace:o,currentUserId:i}=e;const r=o.filter((e=>!(0,v.m4)({archived_by:e.archived_by}))).filter((e=>(0,v.AL)({team:e,spaceValue:t,userId:i})));return Boolean(1===n.length&&n[0].userId===i&&1===r.length&&(0,v.pd)({membership:r[0].membership},i))}},19233:(e,t,n)=>{n.d(t,{W:()=>i,Y:()=>r});var o=n(20852);const i={ABAP:o.PrismLanguages.abap,Agda:o.PrismLanguages.agda,Arduino:o.PrismLanguages.arduino,Assembly:o.PrismLanguages.nasm,Bash:o.PrismLanguages.bash,BASIC:o.PrismLanguages.basic,BNF:o.PrismLanguages.bnf,C:o.PrismLanguages.c,"C#":o.PrismLanguages.csharp,"C++":o.PrismLanguages.cpp,Clojure:o.PrismLanguages.clojure,CoffeeScript:o.PrismLanguages.coffeescript,Coq:o.PrismLanguages.coq,CSS:o.PrismLanguages.css,Dart:o.PrismLanguages.dart,Dhall:o.PrismLanguages.dhall,Diff:o.PrismLanguages.diff,Docker:o.PrismLanguages.docker,EBNF:o.PrismLanguages.ebnf,Elixir:o.PrismLanguages.elixir,Elm:o.PrismLanguages.elm,Erlang:o.PrismLanguages.erlang,"F#":o.PrismLanguages.fsharp,Flow:o.PrismLanguages.flow,Fortran:o.PrismLanguages.fortran,Gherkin:o.PrismLanguages.gherkin,GLSL:o.PrismLanguages.glsl,Go:o.PrismLanguages.go,GraphQL:o.PrismLanguages.graphql,Groovy:o.PrismLanguages.groovy,Haskell:o.PrismLanguages.haskell,HTML:o.PrismLanguages.html,Idris:o.PrismLanguages.idris,Java:o.PrismLanguages.java,JavaScript:o.PrismLanguages.jsx,JSON:o.PrismLanguages.json,Julia:o.PrismLanguages.julia,Kotlin:o.PrismLanguages.kotlin,LaTeX:o.PrismLanguages.latex,Less:o.PrismLanguages.less,Lisp:o.PrismLanguages.lisp,LiveScript:o.PrismLanguages.livescript,"LLVM IR":o.PrismLanguages.llvm,Lua:o.PrismLanguages.lua,Makefile:o.PrismLanguages.makefile,Markdown:o.PrismLanguages.markdown,Markup:o.PrismLanguages.markup,MATLAB:o.PrismLanguages.matlab,Mathematica:o.PrismLanguages.mathematica,Mermaid:o.PrismLanguages.mermaid,Nix:o.PrismLanguages.nix,"Notion Formula":o.PrismLanguages.notion,"Objective-C":o.PrismLanguages.objectivec,OCaml:o.PrismLanguages.ocaml,Pascal:o.PrismLanguages.pascal,Perl:o.PrismLanguages.perl,PHP:o.PrismLanguages.php,"Plain Text":"null",PowerShell:o.PrismLanguages.powershell,Prolog:o.PrismLanguages.prolog,Protobuf:o.PrismLanguages.protobuf,PureScript:o.PrismLanguages.purescript,Python:o.PrismLanguages.python,R:o.PrismLanguages.r,Racket:o.PrismLanguages.racket,Reason:o.PrismLanguages.reason,Ruby:o.PrismLanguages.ruby,Rust:o.PrismLanguages.rust,Sass:o.PrismLanguages.sass,Scala:o.PrismLanguages.scala,Scheme:o.PrismLanguages.scheme,Scss:o.PrismLanguages.scss,Shell:o.PrismLanguages.bash,Solidity:o.PrismLanguages.solidity,SQL:o.PrismLanguages.sql,Swift:o.PrismLanguages.swift,TOML:o.PrismLanguages.toml,TypeScript:o.PrismLanguages.tsx,"VB.Net":o.PrismLanguages.vbnet,Verilog:o.PrismLanguages.verilog,VHDL:o.PrismLanguages.vhdl,"Visual Basic":o.PrismLanguages.visualBasic,WebAssembly:o.PrismLanguages.wasm,XML:o.PrismLanguages.xml,YAML:o.PrismLanguages.yaml,"Java/C/C++/C#":o.PrismLanguages.clike},r={[o.PrismLanguages.abap]:"ABAP",[o.PrismLanguages.agda]:"Agda",[o.PrismLanguages.arduino]:"Arduino",[o.PrismLanguages.bash]:"Shell",[o.PrismLanguages.basic]:"BASIC",[o.PrismLanguages.bnf]:"BNF",[o.PrismLanguages.c]:"C",[o.PrismLanguages.clojure]:"Clojure",[o.PrismLanguages.coffeescript]:"CoffeeScript",[o.PrismLanguages.coq]:"Coq",[o.PrismLanguages.cpp]:"C++",[o.PrismLanguages.csharp]:"C#",[o.PrismLanguages.css]:"CSS",[o.PrismLanguages.dart]:"Dart",[o.PrismLanguages.dhall]:"Dhall",[o.PrismLanguages.diff]:"Diff",[o.PrismLanguages.docker]:"Docker",[o.PrismLanguages.ebnf]:"EBNF",[o.PrismLanguages.elixir]:"Elixir",[o.PrismLanguages.elm]:"Elm",[o.PrismLanguages.erlang]:"Erlang",[o.PrismLanguages.flow]:"Flow",[o.PrismLanguages.fortran]:"Fortran",[o.PrismLanguages.fsharp]:"F#",[o.PrismLanguages.gherkin]:"Gherkin",[o.PrismLanguages.glsl]:"GLSL",[o.PrismLanguages.go]:"Go",[o.PrismLanguages.graphql]:"GraphQL",[o.PrismLanguages.groovy]:"Groovy",[o.PrismLanguages.haskell]:"Haskell",[o.PrismLanguages.html]:"HTML",[o.PrismLanguages.idris]:"Idris",[o.PrismLanguages.java]:"Java",[o.PrismLanguages.javascript]:"JavaScript",[o.PrismLanguages.json]:"JSON",[o.PrismLanguages.jsx]:"JavaScript",[o.PrismLanguages.julia]:"Julia",[o.PrismLanguages.kotlin]:"Kotlin",[o.PrismLanguages.latex]:"LaTeX",[o.PrismLanguages.less]:"Less",[o.PrismLanguages.lisp]:"Lisp",[o.PrismLanguages.livescript]:"LiveScript",[o.PrismLanguages.llvm]:"LLVM IR",[o.PrismLanguages.lua]:"Lua",[o.PrismLanguages.makefile]:"Makefile",[o.PrismLanguages.markdown]:"Markdown",[o.PrismLanguages.markup]:"Markup",[o.PrismLanguages.matlab]:"MATLAB",[o.PrismLanguages.mathematica]:"Mathematica",[o.PrismLanguages.mermaid]:"Mermaid",[o.PrismLanguages.nasm]:"Assembly",[o.PrismLanguages.notion]:"Notion Formula",[o.PrismLanguages.nix]:"Nix",[o.PrismLanguages.objectivec]:"Objective-C",[o.PrismLanguages.ocaml]:"OCaml",[o.PrismLanguages.pascal]:"Pascal",[o.PrismLanguages.perl]:"Perl",[o.PrismLanguages.php]:"PHP",[o.PrismLanguages.powershell]:"PowerShell",[o.PrismLanguages.prolog]:"Prolog",[o.PrismLanguages.protobuf]:"Protobuf",[o.PrismLanguages.purescript]:"PureScript",[o.PrismLanguages.python]:"Python",[o.PrismLanguages.r]:"R",[o.PrismLanguages.racket]:"Racket",[o.PrismLanguages.reason]:"Reason",[o.PrismLanguages.ruby]:"Ruby",[o.PrismLanguages.rust]:"Rust",[o.PrismLanguages.sass]:"Sass",[o.PrismLanguages.scala]:"Scala",[o.PrismLanguages.scheme]:"Scheme",[o.PrismLanguages.scss]:"Scss",[o.PrismLanguages.solidity]:"Solidity",[o.PrismLanguages.sql]:"SQL",[o.PrismLanguages.swift]:"Swift",[o.PrismLanguages.toml]:"TOML",[o.PrismLanguages.tsx]:"TypeScript",[o.PrismLanguages.typescript]:"TypeScript",[o.PrismLanguages.vbnet]:"VB.Net",[o.PrismLanguages.verilog]:"Verilog",[o.PrismLanguages.vhdl]:"VHDL",[o.PrismLanguages.visualBasic]:"Visual Basic",[o.PrismLanguages.wasm]:"WebAssembly",[o.PrismLanguages.xml]:"XML",[o.PrismLanguages.yaml]:"YAML",[o.PrismLanguages.clike]:"Java/C/C++/C#"}},90850:(e,t,n)=>{n.d(t,{$r:()=>a,Zj:()=>r});var o=n(15157);const i="promoCode";function r(e){let{currentUserId:t,promoCode:n}=e;n?o.Z.set({userId:t,key:i,value:n}):o.Z.remove({userId:t,key:i})}function a(e){o.Z.remove({userId:e,key:i})}},96367:(e,t,n)=>{n.d(t,{P8:()=>h,Zv:()=>g,oN:()=>f,qB:()=>d,un:()=>p,zy:()=>u});n(57658);var o=n(9291),i=n(61514),r=n(94714),a=n(76205),s=n(99036);class l{constructor(e,t){this.variable=void 0,this.property=void 0,this.variable=e,this.property=t}getProperty(){return this.property}get(e){const t=this.getCombinatorFilter(e);if(t)return{type:"results",limit:1,filter:t}}getCombinatorFilter(e){const t=this.getPropertyFilter(e,this.variable);if(t)return{operator:"and",filters:[{property:this.property,filter:t}]}}getPropertyFilter(e,t){var n;const o=e[this.property];if(!o)return;return{operator:"status_is",value:{type:"is_option",value:null===(n=o.options)||void 0===n||null===(n=n.find((e=>e.id===t)))||void 0===n?void 0:n.value}}}}const c=(0,o.defineMessages)({current:{id:"database.filterValue.relationType.relativeSprintVariable.current",defaultMessage:"Current"},next:{id:"database.filterValue.relationType.relativeSprintVariable.next",defaultMessage:"Next"},last:{id:"database.filterValue.relationType.relativeSprintVariable.last",defaultMessage:"Last"}}),d={[r.p$]:{current:{messageDescriptor:c.current,reducer:new l(i.SF,i.b0.StatusV2)},next:{messageDescriptor:c.next,reducer:new l(i.YE,i.b0.StatusV2)},last:{messageDescriptor:c.last,reducer:new l(i.Rw,i.b0.StatusV2)}}};function u(e,t){const{filter:n,property:o}=e;if(!(0,a.e)(n)||!(0,a.vR)(n))return!1;const i=t[o];if(!i||!(0,s.p_)(i))return!1;return(0,a.YO)(n).some((e=>"relative"===e.type))}function p(e,t,n){if(!e)return!1;const o=t[n];return!!o&&m(e,n,o)}function m(e,t,n){return e===r.p$&&t===i.b0.StatusV2&&(0,s.gB)(n)}function f(e,t){return!!e&&p(t,e,i.b0.StatusV2)}function g(e,t){const n=e[i.b0.StatusV2];if(!n||!m(t,i.b0.StatusV2,n))return[];return Object.keys(d[t]).filter((e=>{var t;return null===(t=n.options)||void 0===t?void 0:t.find((t=>t.id===e))}))}function h(e,t){const n=Object.entries(t).find((t=>{let[n,o]=t;return e===o}));return n?n[0]:void 0}},76462:(e,t,n)=>{n.d(t,{OC:()=>ht,ZP:()=>_t,wb:()=>bt});var o=n(53965),i=n(1898),r=n(19584),a=n(12847),s=(n(59730),n(58129)),l=n(70921),c=n(30842),d=n(39050),u=n(54368),p=n(45149),m=n(51650),f=n(88179),g=n(80926),h=n(8542),v=n(10188),b=n(98963),y=n(18844),_=n(56358),S=n(21202),w=n(7470),k=n(77420),I=n(60014),C=n(6287),x=n(13493),T=n(70279),M=n(75908),P=n(6359),A=n(7678),R=n(60897),D=n(69549),E=n(33709),B=n(44312),F=n(4986),O=n(52719),Z=n(58912),V=n(19639),U=n(36077),L=n(97715),j=n(32161),N=n(82447),z=n(9713),q=n(57398),W=n(49953),H=n(14710),K=n(9508),G=n(62643),$=n(57883),Q=n(66726),Y=n(30754),J=n(6946),X=n(9844),ee=n(25753),te=n(73081),ne=n(84683),oe=n(1849),ie=n(11318),re=n(38429),ae=n(89488),se=n(65311),le=n(16427),ce=n(61220),de=n(96683),ue=n(70017),pe=n(89470),me=n(49126),fe=n(94578),ge=n(86854),he=n(4137),ve=n(80396),be=n(24836),ye=n(86135),_e=n(78929),Se=n(84323),we=n(1311),ke=n(83200),Ie=n(67627),Ce=n(65963),xe=n(14130),Te=n(34406),Me=n(42314),Pe=n(16663),Ae=n(19221),Re=n(93646),De=n(91644),Ee=n(63787),Be=n(38952),Fe=n(40837),Oe=n(75246),Ze=n(65635),Ve=n(96740),Ue=n(63921),Le=n(75990),je=n(57829),Ne=n(63188),ze=n(56877),qe=n(76413),We=n(47969),He=n(47238),Ke=n(35623),Ge=n(77858),$e=n(37202),Qe=n(63368),Ye=n(29369),Je=n(26195),Xe=n(14718),et=n(14327),tt=n(71495),nt=n(53412),ot=n(65836),it=n(5505),rt=n(66295),at=n(10354),st=n(19889),lt=n(19716),ct=n(76244),dt=n(98897),ut=n(46769),pt=n(66079),mt=n(58161),ft=n(28182),gt=n(35794);s.J8,s.U$,l.TY,l.p3,c.Y,d.L,u.y0,u.CS,p.P,m.b,f.F,g.D,v.J4,v.Mb,b.cv,b.xx,y.Xj,y.MN,_.EK,_.Z,S.iU,S.i3,w.n,k.cZ,k.Mf,I.x,C.vF,C.Vv,x.np,x.av,T.x_,T.a,M.D,P.H,A.DJ,R.wK,D.U5,E.qF,E.Eu,B.Jd,B.n5,F.rv,V.mz,O.g,Z.J,U.z,L.sl,j.PJ,j.h0,N.r,z.a,q.T,W.r9,W.$x,H.Dw,K.F,G.q4,$.t0,J.N,Q.l,Y.G,X.K2,X.v5,ee.z,te.bC,te.xJ,ne.Tu,oe.a,ie.Bh,ie.DQ,ae.N,re.i6,se.uX,st.KJ,le.V,ce.V7,de.K,ue.Kk,ue.XK,pe.UI,pe.bl,me.v,fe.P9,fe.JI,ge.X,ge.bJ,he.A,ve.yo,ve.Cq,be.qV,be.lu,ye.FM,ye.Yo,_e.Nw,we.M,Se.b,Ce.a,Pe.h,ke.wM,ke.h1,Te.f1,Me.P,xe.O,Ie.m,Ae.a,Re.O,De.AT,De.yP,Ee.s_,Ee.iP,Be.A,Fe.rp,Fe.bW,Oe.bx,Ze.Zx,Ue.r,Le.F,Ne.V,Ve.L,ze.L9,qe.e8,We.WU,Ke.M,He.x,Ge.zU,Ge.AQ,$e.FU,Qe.ah,Qe.hJ,je.fF,Ye.e0,Ye.Im,Je.nE,Xe.u,et.z,tt.Az,nt.nt,ot.jA,it.uK,rt.O,at.I,lt.V,ct.e,dt.pm,ut.j,pt.dx,mt.t,ft.Sr,gt.bf,gt.AO,h.t_,h.zF;const ht={block:S.ZP,customer:R.ZP,notion_user:st.ZP,space:Oe.ZP,space_bot:Ze.ZP,space_user:We.ZP,space_view:Ge.ZP,token:it.ZP,user_root:pt.ZP,temporary_password:ot.ZP,password:me.Z,collection:C.ZP,collection_view:x.ZP,apple_token:f.Z,google_token:J.Z,follow:$.ZP,activity:l.ZP,notification:se.ZP,firebase_token:G.ZP,trello_token:rt.Z,asana_token:g.Z,confluence_token:M.Z,monday_token:ae.Z,external_entity:z.Z,external_token:K.Z,external_integration_app:q.Z,slack_integration:Ee.ZP,slack_notification:Be.Z,discussion:E.ZP,comment:T.ZP,snapshot:Fe.ZP,credit:A.ZP,used_credit:at.Z,user_settings:ft.ZP,evernote_token:U.Z,space_recover_pages:qe.ZP,drive_token:F.ZP,block_token:w.Z,user_metadata:ut.Z,bot:k.ZP,bot_token:I.Z,saml_config:_e.ZP,experiment:L.ZP,education_domain:O.Z,education_email:Z.Z,space_invite_link:Ne.Z,public_email_domain:he.Z,user_data_consent_permissions:lt.Z,access_request:s.ZP,template_tag:nt.ZP,page_visit:pe.ZP,page_exit:ue.ZP,subscription:$e.ZP,space_domain:Ue.Z,admin_api_log:c.Z,admin_api_op_log:d.Z,integration:X.ZP,integration_token:ee.Z,oauth_authorization_code:le.Z,mfa_settings:re.ZP,device:D.ZP,user_device:ct.Z,[j.PJ]:j.ZP,[N.r]:N.Z,[gt.bf]:gt.ZP,[H.Dw]:H.ZP,[mt.t]:mt.Z,team:Ye.ZP,[Re.O]:Re.Z,[P.H]:P.Z,[Y.G]:Y.Z,[Q.l]:Q.Z,[ve.yo]:ve.ZP,[W.r9]:W.ZP,[B.Jd]:B.ZP,[V.mz]:V.ZP,[Le.F]:Le.Z,[ne.Tu]:ne.ZP,[b.cv]:b.ZP,[we.M]:we.Z,[Se.b]:Se.Z,[Ce.a]:Ce.Z,[Pe.h]:Pe.Z,[Te.f1]:Te.ZP,[Me.P]:Me.Z,[ke.wM]:ke.ZP,[xe.O]:xe.Z,[Ie.m]:Ie.Z,[Ae.a]:Ae.Z,[be.qV]:be.ZP,[ye.FM]:ye.ZP,[y.Xj]:y.ZP,[je.fF]:je.ZP,[He.x]:He.ZP,[dt.pm]:dt.ZP,[Ve.L]:Ve.Z,[ze.L9]:ze.ZP,[Je.nE]:Je.ZP,[et.z]:et.Z,[Xe.u]:Xe.Z,[tt.Az]:tt.ZP,[ce.V7]:ce.ZP,[de.K]:de.Z,[u.y0]:u.ZP,[Ke.M]:Ke.Z,[De.AT]:De.ZP,[m.b]:m.Z,[p.P]:p.Z,[fe.P9]:fe.ZP,[h.t_]:h.ZP,[v.J4]:v.ZP,[ie.Bh]:ie.ZP,[Qe.ah]:Qe.ZP,[te.bC]:te.ZP,[ge.X]:ge.ZP,[_.EK]:_.ZP,[oe.a]:oe.Z};j.PJ,N.r,gt.bf,H.Dw,mt.t,Re.O,P.H,Y.G,Q.l,ve.yo,W.r9,B.Jd,V.mz,Le.F,ne.Tu,b.cv,we.M,Se.b,Ce.a,Pe.h,ke.wM,Te.f1,Me.P,xe.O,Ie.m,Ae.a,be.qV,ye.FM,y.Xj,je.fF,He.x,dt.pm,Ve.L,ze.L9,Je.nE,nt.nt,et.z,Xe.u,tt.Az,ce.V7,de.K,u.y0,Ke.M,De.AT,m.b,fe.P9,h.t_,v.J4,ie.Bh,Qe.ah,ge.X,p.P,_.EK,oe.a,te.bC;const vt=(0,i.Yd)(ht);function bt(e){return vt.includes(e)}a.literals(...(0,r.XP)(ht));const yt={};o.M6(ht,(e=>{e.columnTypes&&o.M6(e.columnTypes,((e,t)=>{t&&(yt[t]=!0)}))}));const _t=ht},53772:(e,t,n)=>{function o(e){return"development"===e.env||"local"===e.env||e.isAdminMode}n.d(t,{x:()=>o})},94804:(e,t,n)=>{n.d(t,{A7:()=>r,LO:()=>p,Y6:()=>l,fe:()=>s,nZ:()=>u,rE:()=>a,w8:()=>c});var o=n(1898),i=n(15157);function r(e){let{searchSessionId:t,searchSessionFlowNumber:n}=e;if((0,o.$K)(t)&&(0,o.$K)(n))return`1:${t}:${n}`}const a="SearchShowFilterBar";function s(e){return d({key:a,userId:e,defaultValue:!1})}const l="SearchSidePeekDefaultOpen";function c(e){return!e||d({key:l,userId:e,defaultValue:true})}function d(e){const{key:t,userId:n,defaultValue:o}=e,r=i.Z.get({userId:n,key:t});return void 0===r?o:"boolean"==typeof r&&r}const u=/(?:\s|^)-("[^"]+"|[\w]+)(?=\s|$)/g,p=/(?:\s|^)"([^"]*)"(?=\s|$)/g},92338:(e,t,n)=>{n.d(t,{GA:()=>y,Ix:()=>w,Um:()=>I,dK:()=>C,iY:()=>c,ik:()=>S,jl:()=>p,n8:()=>d,u4:()=>u,vp:()=>_});var o=n(12847),i=n(94714),r=n(41432);const a=o.object({required:{type:o.literal("date"),start_date:o.string()},optional:{}}),s=o.union([o.object({required:{starting:a,ending:o.isUndefined()},optional:{}}),o.object({required:{starting:o.isUndefined(),ending:a},optional:{}}),o.object({required:{starting:a,ending:a},optional:{}}),o.object({required:{starting:o.isUndefined(),ending:o.isUndefined()},optional:{}})]),l=o.union([o.array(o.string()),o.object({required:{teamIds:o.array(o.string()),includeSpaceRecords:o.boolean()},optional:{}})]);function c(e){if(e)return Array.isArray(e)?e:e.teamIds?e.teamIds:void 0}o.object({required:{id:o.string(),type:o.union([o.literal("user"),o.literal("permission_group")])},optional:{}});let d=function(e){return e.CollectionsInSpace="CollectionsInSpace",e.BlocksInSpace="BlocksInSpace",e.BlocksInAncestor="BlocksInAncestor",e.BlocksInParent="BlocksInParent",e.BlocksInCollection="BlocksInCollection",e}({});o.object({required:{ancestors:o.array(o.string()),createdBy:o.array(o.string()),editedBy:o.array(o.string()),lastEditedTime:s,createdTime:s},optional:{requireEditPermissions:o.boolean(),isDeletedOnly:o.boolean(),excludeTemplates:o.boolean(),isAdminModeDeletedPageSearch:o.boolean(),blockTypes:o.minLength(o.array(o.literals(...Object.keys(r.Ti))),1),inTeams:l,navigableBlockContentOnly:o.boolean(),includePublicPagesWithoutExplicitAccess:o.boolean(),audience:o.array(o.literals("private","shared_internally","shared_externally","shared_to_web")),dev_excludedPages:o.array(o.string()),dev_excludedTeams:o.array(o.string()),parentId:o.string(),databaseType:o.array(o.literals(...i.fW))}});function u(e){return{isDeletedOnly:!1,excludeTemplates:!1,navigableBlockContentOnly:!1,requireEditPermissions:!1,includePublicPagesWithoutExplicitAccess:!1,ancestors:[],parentId:void 0,createdBy:[],editedBy:[],lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},inTeams:[],...e}}function p(e,t){return{...e,...t,createdTime:{...e.createdTime,...t.createdTime},lastEditedTime:{...e.lastEditedTime,...t.lastEditedTime}}}const m=["question_answer_context_search","question_answer_limited_content_search"],f=["cron_attachment_search_input_change","cron_attachment_parent_search_input_change","cron_time_collection_views_query"],g=["legacy_searchPagesWithParent","relation_setup_menu"],h=(o.union([...["quick_find","quick_find_public","quick_find_input_change","quick_find_scroll","quick_find_filters","quick_find_ancestor_filter","quick_find_navigational_mode"].map(o.literal),...f.map(o.literal),...m.map(o.literal),...g.map(o.literal),o.literal("ancestor_filter_page_search"),o.literal("debugging"),o.literal("report_bad_search"),o.literal("trash"),o.literal("link_to_page_block"),o.literal("link_to_collection_block"),o.literal("mention_menu"),o.literal("move_to_menu"),o.literal("public_home_page_menu"),o.literal("relation_menu"),o.literal("web_clipper"),o.literal("oauth"),o.literal("collection_group_value"),o.literal("collection_settings_source"),o.literal("collection_settings_select_relation_source"),o.literal("admin_search_permanently_deleted_pages"),o.literal("bot_iterate_blocks_in_space"),o.literal("api_unknown"),o.literal("simple_formula_value_page_search"),o.literal("automation_page_picker"),o.literal("automation_collection_picker"),o.literal("admin_content_search"),o.literal("ediscovery_search_api"),o.literal("admin_content_search_export"),o.literal("export_content_analytics"),o.literal("send_to_notion_database_options"),o.literal("send_to_notion_project_options"),o.literal("search_content_analytics"),o.literal("search_unique_id"),o.literal("collection_page_tree_query"),o.literal("assistant_scoped_search_menu"),o.literal("benchmark_tests")]),["lastEdited","created","scroll","id",...Object.keys({pageViewsLast7Days:"pageViews.pageViewsLast7Days",pageViewsLast28Days:"pageViews.pageViewsLast28Days",pageViewsLast90Days:"pageViews.pageViewsLast90Days",pageViewsAllTime:"pageViews.pageViewsAllTime",uniquePageViewsLast7Days:"uniquePageViews.uniquePageViewsLast7Days",uniquePageViewsLast28Days:"uniquePageViews.uniquePageViewsLast28Days",uniquePageViewsLast90Days:"uniquePageViews.uniquePageViewsLast90Days",uniquePageViewsAllTime:"uniquePageViews.uniquePageViewsAllTime"})]),v=o.object({required:{field:o.literals("relevance")},optional:{}}),b=o.object({required:{field:o.literals(...h),direction:o.literals("asc","desc")},optional:{missing:o.union([o.literal("_first"),o.literal("_last"),o.number(),o.boolean(),o.string()]),searchAfter:o.undefinable(o.union([o.number(),o.string()]))}}),y=o.union([v,b]);let _=function(e){return e.Local="local",e.ElasticSearch="es",e.Postgres="pg",e.VectorDBBlock="vector_block",e.VectorDBCollection="vector_collection",e.ElasticsearchRandom="es_random",e.ElasticsearchUniqueID="es_uniqueId",e.ElasticsearchForcedRecentRecall="es_forced_recent_recall",e}({});const S=["spacePage","recentVisit","bookmarkedPage","sharedPage","frecencyStore","teamPage","defaultRecordCache","unknown","similarUser1dRecentPages","topPages7dPageView","editedPages1d","similarUsersEditedPages1d"],w={RequestFailed:{type:"RequestFailed",message:"Something went wrong."},NoResults:{type:"NoResultsFound",message:"No results found."},Offline:{type:"Offline",message:"Go online for more results."}},k="gzkNfoUU",I=`<${k}>`,C=`</${k}>`},98275:(e,t,n)=>{n.d(t,{S3:()=>o,St:()=>s,r8:()=>c,vl:()=>u});const o={local:"http://localhost:3008",development:"https://integrations-api-dev.notion.com",staging:"https://integrations-api-stg.notion.com",production:"https://integrations-api.notion.com"},i={local:"http://localhost:3000/sip",development:"https://dev.notion.so/sip",staging:"https://stg.notion.so/sip",production:"https://notion.so/sip"},r="/install",a="/slack";function s(e,t){return t?`${i[e]}${a}${r}`:`${o[e]}${a}${r}`}const l="/github";function c(e,t){return t?`${i[e]}${l}${r}`:`${o[e]}${l}${r}`}const d="/zendesk";function u(e,t){return t?`${i[e]}${d}${r}`:`${o[e]}${d}${r}`}},25666:(e,t,n)=>{n.d(t,{D:()=>a,T:()=>r});var o=n(53965),i=n(24211);const r="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";function a(e,t){if(o.HD(e))return e;{const n=e[t];return void 0!==n?n:e[i.al]}}},94044:(e,t,n)=>{n.d(t,{$e:()=>m,TQ:()=>p,UF:()=>s,VX:()=>c,jm:()=>d,my:()=>u,p_:()=>a,vr:()=>l});var o=n(9291),i=(n(7032),n(30845)),r=n(59753);const a=8,s=70,l=1e3,c=(0,o.defineMessages)({member:{id:"sharedContextualInviteHelpers.member.inviteMessage2",defaultMessage:"{userName} shared a page {pageName} with you."},guest:{id:"sharedContextualInviteHelpers.guest.inviteMessage2",defaultMessage:"{userName} shared {pageName}. Join {spaceName} to view this page."},default:{id:"sharedContextualInviteHelpers.default.inviteMessage",defaultMessage:"Your invitation message"},optional:{id:"sharedContextualInviteHelpers.default.inviteMessagePrefix",defaultMessage:"Optional message..."}});function d(e){const{includeOptional:t,isGuest:n,emailProps:o,intl:i}=e,r=n?c.guest:c.member;if(t){return`${i.formatMessage(c.optional)}\n"${i.formatMessage(r,o)}"`}return i.formatMessage(r,o)}function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;if(!e)return"";const n=i.s(e,"url");let o=e.slice();return n.forEach(((e,t)=>{o=o.replace(e.value,"[link]")})),o.length>t&&(o=`${o.substring(0,t)}...`),o}function p(e){if(!e)return!1;return i.s(e,"url").length>0}function m(e,t){var n;const o=null===(n=r.kk.fromValue("block",e).getPermissionItems())||void 0===n?void 0:n.find((e=>"user_permission"===e.type&&e.user_id===t.invited_user_id));if(o&&"invite_id"in o)return o.invite_id}},90965:(e,t,n)=>{n.d(t,{BD:()=>S,CF:()=>x,CJ:()=>p,DI:()=>f,Mi:()=>I,TZ:()=>h,UD:()=>k,XO:()=>c,XR:()=>g,du:()=>C,hU:()=>m,kC:()=>d,nV:()=>_,t5:()=>w,wv:()=>u});var o=n(1898),i=n(18265),r=n(77657),a=n(59753),s=n(72141),l=n(99405);function c(e,t,n){return!t||!n||!(0,s.zz)(n)||function(e){if(!e)return[];const t=a.kk.fromSpace(e);return t.getUserPermissionItems()}(t).filter((t=>t.role&&(0,s.zz)(t.role)&&t.user_id!==e)).length>0}function d(){let e=arguments.length>1?arguments[1]:void 0;return Boolean((arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find((t=>"user_permission"===t.type&&t.user_id===e&&(0,s.Jy)(t.role))))}function u(e,t){const n=a.kk.isAnyModel(e)?e.getPermissionItems():e.permissions;return Boolean(null==n?void 0:n.find((e=>"user_permission"===e.type&&e.user_id===t&&(0,s.zz)(e.role))))}function p(e){const t=null==e?void 0:e.integration_restrictions;return"approved_only"===t||"approved_or_built_by_notion"===t}function m(e){const{spaceBotSettings:t,integrationId:n,env:o}=e;return!t||(!p(t)||(!(!t.integration_approval_statuses||!t.integration_approval_statuses[n])||!("approved_or_built_by_notion"!==t.integration_restrictions||!(0,r.BP)({integrationId:n,env:o}))))}const f=(0,o.AO)((e=>e&&"personal_external_transfer"===e.type&&"completed"!==e.status?{true:e}:{false:e})),g=(0,o.AO)((e=>e&&"team_claim_upgrade"===e.type&&"requested"===e.status?{true:e}:{false:e})),h=((0,o.AO)((e=>e&&"organization_claiming_space"===e.type&&"requested"===e.status?{true:e}:{false:e})),(0,o.AO)((e=>{if(!e||"domain_claim_space_deletion"!==e.type)return{false:e};switch(e.status){case"started":return{true:e};case"canceled":return{false:e}}}))),v=((0,o.AO)((e=>v(e)||b(e)||y(e)?{true:e}:{false:e})),(0,o.AO)((e=>{if(!e||"space_content_duplication"!==e.type)return{false:e};switch(e.status){case"started":return{true:e};case"failed_with_closed_source":case"failed":case"completed":case"dry_run_completed":case"pending_deletion":return{false:e}}}))),b=(0,o.AO)((e=>{if(!e||"space_content_duplication"!==e.type)return{false:e};switch(e.status){case"completed":return{true:e};case"dry_run_completed":case"failed":case"started":case"failed_with_closed_source":case"pending_deletion":return{false:e}}})),y=((0,o.AO)((e=>{if(!e||"space_content_duplication"!==e.type)return{false:e};switch(e.status){case"pending_deletion":return{true:e};case"dry_run_completed":case"failed":case"started":case"failed_with_closed_source":case"completed":return{false:e}}})),(0,o.AO)((e=>{if(!e||"space_content_duplication"!==e.type)return{false:e};switch(e.status){case"failed_with_closed_source":return{true:e};case"dry_run_completed":case"failed":case"started":case"completed":case"pending_deletion":return{false:e}}}))),_=(0,o.AO)((e=>{if(!e||"space_content_duplication"!==e.type)return{false:e};switch(e.status){case"failed_with_closed_source":case"started":case"completed":case"pending_deletion":return{true:e};case"dry_run_completed":case"failed":return{false:e}}}));function S(e){const{spaceId:t,baseUrl:n}=e,o=(0,l.Xs)({route:{name:"space",spaceId:t,spaceDomain:void 0,requestedOnPublicDomain:void 0,searchQuery:void 0,searchRequest:void 0}});return(0,i.O_)({relativeUrl:o,baseUrl:n})}function w(e){return e?k({permissions:e}).length:0}function k(e){const t=null==e?void 0:e.permissions;return t?t.filter(s.jg).filter((e=>(0,s.Jy)(e.role))):[]}function I(e){return k(e).map((e=>e.user_id))}function C(e){return"none"===e.role}function x(e){return"none"!==e.role}},39927:(e,t,n)=>{n.d(t,{$X:()=>a,F_:()=>s,iZ:()=>r});var o=n(92996),i=n(42613);const r={autoCompleteSprints:!1,actionConfig:{complete_sprint_action:"complete_sprint_and_move_incomplete_tasks_to_next_sprint"},recurrenceConfig:{interval:2,weekdays:["MO"]}};function a(e){const{eventTracker:t,properties:n}=e;t.trackEvent({eventName:"complete_sprint_action",properties:n})}function s(e,t){var n;return null===(n=t.groups)||void 0===n||null===(n=n.find((t=>t.id===o.nl||(null==t?void 0:t.name)===i.RW||(null==t?void 0:t.name)===e.formatMessage(i.ct.statusGroupNameComplete))))||void 0===n?void 0:n.name}},94438:(e,t,n)=>{n.d(t,{DW:()=>s,IX:()=>a,Su:()=>i,rP:()=>r});var o=n(30120);function i(e){if("week"===e.frequency&&e.weekdays&&1===e.weekdays.length)return{weekday:e.weekdays[0],duration:e.interval}}function r(e){const{currentSprintEndDate:t,sprintSchedule:n}=e;return l({startDate:d({dateToAdjust:o.ou.fromISO(t),weekday:n.weekday,wrapForEqualDays:!0}),duration:n.duration})}function a(e){const{userTimeZone:t,sprintSchedule:n}=e;return l({startDate:o.ou.local({zone:t}),duration:n.duration})}function s(e){const{currentSprintStartDate:t,sprintSchedule:n}=e,i=d({dateToAdjust:o.ou.fromISO(t),weekday:n.weekday,wrapForEqualDays:!1}),{end_date:r}=l({startDate:i,duration:n.duration});let a=o.ou.fromISO(r);const s=o.ou.now().startOf("day");for(;a.diff(s,"days").days<0;)a=a.plus({weeks:1});return{type:"daterange",start_date:a.plus({days:1}).minus({weeks:n.duration}).toISODate(),end_date:a.toISODate()}}function l(e){const{startDate:t,duration:n}=e,o=t.plus({weeks:n}).minus({days:1});return{type:"daterange",start_date:t.toISODate(),end_date:o.toISODate()}}const c={SU:0,MO:1,TU:2,WE:3,TH:4,FR:5,SA:6};function d(e){const{dateToAdjust:t,weekday:n,wrapForEqualDays:o}=e,i=u({currentWeekday:t.weekday%7,nextWeekday:c[n],wrapForEqualDays:o});return t.plus({days:i})}function u(e){const{currentWeekday:t,nextWeekday:n,wrapForEqualDays:o}=e,i="number"==typeof t?t:c[t],r="number"==typeof n?n:c[n];if(i===r)return o?7:0;let a=i,s=0;for(;a!==r;)a===c.SA?a=0:a+=1,s+=1;return s}},99108:(e,t,n)=>{n.d(t,{VR:()=>P,hI:()=>R});n(57658);var o=n(53965),i=n(1898),r=n(40902),a=n(41432),s=n(80951),l=n(53504),c=n(87479),d=n(72141);function u(e,t){return e.space_id===t.space_id&&e.collection_id===t.collection_id&&e.navigable_block_id===t.navigable_block_id}function p(e){return e.table+e.id}function m(e,t){return o.Xy(o.MR(e.authors||[],p),o.MR(t.authors||[],p))}function f(e,t){return o.MR(o.mN([...e.authors||[],...t.authors||[]],p),p)}function g(e,t){return e.block_id===t.block_id&&u(e,t)}function h(e,t){return e.block_id===t.block_id&&u(e,t)}function v(e,t){return u(e,t)&&e.comment_id===t.comment_id}function b(e,t){return u(e,t)}function y(e,t){return e.collection_property_id===t.collection_property_id&&u(e,t)}function _(e,t){return e.collection_view_id===t.collection_view_id&&u(e,t)}function S(e,t){return e.mentioned_block_id===t.mentioned_block_id&&e.mentioned_user_id===t.mentioned_user_id&&e.mentioned_property===t.mentioned_property&&m(e,t)&&u(e,t)}function w(e,t){return e.mentioned_block_id===t.mentioned_block_id&&e.mentioned_group_id===t.mentioned_group_id&&e.mentioned_property===t.mentioned_property&&m(e,t)&&u(e,t)}function k(e){const t=[];e:for(;e.list.length>0;){const n=e.list.shift();let o,i=0,r=!1;for(;i<e.list.length;){const t=e.list[i];if(r=e.cancel(n,t),r){e.list.splice(i,1);continue e}if(o=e.replace(n,t),o){e.list[i]=o;continue e}i++}t.push(n)}return t}function I(e,t){return 0===o.e5(e,t).length&&0===o.e5(t,e).length}function C(e,t){return u(e,t)&&e.permission_group_id===t.permission_group_id}function x(e){return"permission-created"===e.type||"permission-deleted"===e.type?(0,c.OC)(e.permission_data):"permission-changed"===e.type?(0,c.OC)(e.permission_data.before):void(0,i.t1)(e)}function T(e,t){return!!u(e,t)&&(!!m(e,t)&&("permission-restriction-created"===e.type||"permission-restriction-deleted"===e.type?"permission-restriction-created"===t.type||"permission-restriction-deleted"===t.type||(null===(n=e.permission_data)||void 0===n||null===(n=n.actual_changes)||void 0===n?void 0:n.some((e=>(0,c.OC)(e)===x(t)))):"permission-restriction-created"===t.type||"permission-restriction-deleted"===t.type?t.permission_data.actual_changes.some((t=>(0,c.OC)(t)===x(e))):x(e)===x(t)));var n}function M(e,t){if("permission-deleted"===e.type&&"permission-created"===t.type&&T(e,t)&&!function(e,t){return d.cY(e)===d.cY(t)}(e.permission_data,t.permission_data))return{...t,type:"permission-changed",timestamp:t.timestamp,permission_data:{before:e.permission_data,after:t.permission_data}}}function P(e){const t=k({list:k({list:o.MR((0,l.Z)(e,"mangle-class-instances")||[],(e=>e.timestamp)),cancel:(e,t)=>!1,replace:(e,t)=>M(e,t)}),cancel:(e,t)=>function(e,t){return"block-created"===e.type&&"block-deleted"===t.type&&g(e,t)}(e,t)||function(e,t){return"block-deleted"===e.type&&"block-created"===t.type&&g(e,t)}(e,t)||function(e,t){if("block-changed"===e.type&&"block-changed"===t.type&&g(e,t)){if(e.block_data.after.block_value.type===a.Ti.tableRow){const n=r.Yr({before:e.block_data.before.block_value,after:e.block_data.after.block_value}),i=r.Yr({before:t.block_data.before.block_value,after:t.block_data.after.block_value});return I(n,i)&&o.Xy(o.ei(e.block_data.before.block_value.properties||{},n),o.ei(t.block_data.after.block_value.properties||{},i))}const n=r.OS({before:e.block_data.before.block_value,after:e.block_data.after.block_value,schema:e.block_schema}),i=r.B9({before:e.block_data.before.block_value,after:e.block_data.after.block_value}),s=r.OS({before:t.block_data.before.block_value,after:t.block_data.after.block_value,schema:t.block_schema}),l=r.B9({before:t.block_data.before.block_value,after:t.block_data.after.block_value});return!r.lv({before:t.block_data.before.block_value,after:t.block_data.after.block_value})&&I(n,s)&&o.Xy(o.ei(e.block_data.before.block_value.properties||{},n),o.ei(t.block_data.after.block_value.properties||{},s))&&I(i,l)&&o.Xy(o.ei(e.block_data.before.block_value.format||{},i),o.ei(t.block_data.after.block_value.format||{},l))}return!1}(e,t)||function(e,t){return!("block-property-changed"!==e.type||"block-property-changed"!==t.type||!h(e,t))&&I(Object.keys(e.property_updates),Object.keys(t.property_updates))&&o.Xy(Object.values(e.property_updates).map((e=>e.before)),Object.values(t.property_updates).map((e=>e.after)))}(e,t)||function(e,t){return"permission-created"===e.type&&"permission-deleted"===t.type&&T(e,t)}(e,t)||function(e,t){return"permission-deleted"===e.type&&"permission-created"===t.type&&T(e,t)}(e,t)||function(e,t){return"permission-changed"===e.type&&"permission-changed"===t.type&&T(e,t)&&o.Xy(e.permission_data.before,t.permission_data.after)}(e,t)||function(e,t){return"mention-created"===e.type&&"mention-deleted"===t.type&&S(e,t)}(e,t)||function(e,t){return"mention-deleted"===e.type&&"mention-created"===t.type&&S(e,t)}(e,t)||function(e,t){return"permission-group-mention-created"===e.type&&"permission-group-mention-deleted"===t.type&&w(e,t)}(e,t)||function(e,t){return"permission-group-mention-deleted"===e.type&&"permission-group-mention-created"===t.type&&w(e,t)}(e,t)||function(e,t){return"comment-created"===e.type&&"comment-deleted"===t.type&&v(e,t)}(e,t)||function(e,t){return"comment-deleted"===e.type&&"comment-created"===t.type&&v(e,t)}(e,t)||function(e,t){return"comment-changed"===e.type&&"comment-changed"===t.type&&v(e,t)&&o.Xy(e.comment_data.before,t.comment_data.after)}(e,t)||function(e,t){return!!("collection-changed"===e.type&&"collection-changed"===t.type&&b(e,t)&&e.collection_data&&t.collection_data)&&o.Xy(e.collection_data.before,t.collection_data.after)}(e,t)||function(e,t){return"collection-property-created"===e.type&&"collection-property-deleted"===t.type&&y(e,t)}(e,t)||function(e,t){return"collection-property-deleted"===e.type&&"collection-property-created"===t.type&&y(e,t)}(e,t)||function(e,t){return"collection-property-changed"===e.type&&"collection-property-changed"===t.type&&y(e,t)&&o.Xy(e.collection_property_data.before,t.collection_property_data.after)}(e,t)||function(e,t){return"collection-view-created"===e.type&&"collection-view-deleted"===t.type&&_(e,t)}(e,t)||function(e,t){return"collection-view-deleted"===e.type&&"collection-view-created"===t.type&&_(e,t)}(e,t)||function(e,t){return"collection-view-changed"===e.type&&"collection-view-changed"===t.type&&_(e,t)&&o.Xy(e.collection_view_data.before,t.collection_view_data.after)}(e,t)||function(e,t){return"permission-group-created"===e.type&&"permission-group-deleted"===t.type&&C(e,t)}(e,t)||function(e,t){return"permission-group-deleted"===e.type&&"permission-group-created"===t.type&&C(e,t)}(e,t),replace:(e,t)=>function(e,t){if("block-created"===e.type&&"block-changed"===t.type&&g(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),block_schema:t.block_schema,block_data:t.block_data.after}}(e,t)||function(e,t){if("block-changed"===e.type&&"block-changed"===t.type&&g(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),block_schema:t.block_schema,block_data:{before:e.block_data.before,after:t.block_data.after}}}(e,t)||function(e,t){if("block-property-changed"===e.type&&"block-property-changed"===t.type&&h(e,t)){const n=e.property_updates;return t.property_updates&&Object.entries(t.property_updates).forEach((i=>{let[r,a]=i;r in n?o.Xy(n[r].before,a.after)?(delete n[r],e.filtered_block_schema&&delete e.filtered_block_schema[r],t.filtered_block_schema&&delete t.filtered_block_schema[r]):n[r].after=a.after:n[r]=a})),{...e,timestamp:t.timestamp,authors:f(e,t),filtered_block_schema:{...e.filtered_block_schema,...t.filtered_block_schema},property_updates:n}}}(e,t)||function(e,t){if("comment-created"===e.type&&"comment-changed"===t.type&&v(e,t))return{...e,comment_data:t.comment_data.after}}(e,t)||function(e,t){if("comment-changed"===e.type&&"comment-changed"===t.type&&v(e,t))return{...e,comment_data:{before:e.comment_data.before,after:t.comment_data.after}}}(e,t)||function(e,t){if("permission-created"===e.type&&"permission-changed"===t.type&&T(e,t))return{...e,timestamp:t.timestamp,permission_data:t.permission_data.after}}(e,t)||function(e,t){if("permission-changed"===e.type&&"permission-changed"===t.type&&T(e,t))return{...e,permission_data:{before:e.permission_data.before,after:t.permission_data.after},timestamp:t.timestamp}}(e,t)||function(e,t){if("permission-created"===t.type&&"permission-restriction-created"===e.type&&T(e,t))return{...e,timestamp:t.timestamp}}(e,t)||function(e,t){if("permission-deleted"===t.type&&"permission-restriction-deleted"===e.type&&T(e,t))return{...e,timestamp:t.timestamp}}(e,t)||function(e,t){if("collection-created"===e.type&&"collection-changed"===t.type&&b(e,t))return{...e,authors:f(e,t),collection_data:t.collection_data?t.collection_data.after:void 0}}(e,t)||function(e,t){if("collection-changed"===e.type&&"collection-changed"===t.type&&b(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),collection_data:{before:e.collection_data?e.collection_data.before:void 0,after:t.collection_data?t.collection_data.after:void 0}}}(e,t)||function(e,t){if("collection-property-created"===e.type&&"collection-property-changed"===t.type&&y(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),collection_property_data:t.collection_property_data.after}}(e,t)||function(e,t){if("collection-property-changed"===e.type&&"collection-property-changed"===t.type&&y(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),collection_property_data:{before:e.collection_property_data.before,after:t.collection_property_data.after}}}(e,t)||function(e,t){if("collection-view-created"===e.type&&"collection-view-changed"===t.type&&_(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),collection_view_data:t.collection_view_data.after}}(e,t)||function(e,t){if("collection-view-changed"===e.type&&"collection-view-changed"===t.type&&_(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),collection_view_data:{before:e.collection_view_data.before,after:t.collection_view_data.after}}}(e,t)||function(e,t){if("permission-group-created"===e.type&&"permission-group-changed"===t.type&&C(e,t))return{...e,timestamp:t.timestamp,permission_group_data:t.permission_group_data.after,authors:f(e,t)}}(e,t)||function(e,t){if("permission-group-changed"===e.type&&"permission-group-changed"===t.type&&C(e,t))return{...e,permission_group_data:{before:e.permission_group_data.before,after:t.permission_group_data.after},timestamp:t.timestamp,authors:f(e,t)}}(e,t)}).filter((e=>!function(e){if("block-changed"===e.type){const t=r.gg({before:e.block_data.before.block_value,after:e.block_data.after.block_value,schema:e.block_schema}),n=r.lv({before:e.block_data.before.block_value,after:e.block_data.after.block_value}),o=r.fc({before:e.block_data.before.block_value,after:e.block_data.after.block_value}),i=r.Z3({before:e.block_data.before.block_value,after:e.block_data.after.block_value});return!(t||n||o||i)}return!1}(e)));return o.MR(t,(e=>e.timestamp))}function A(e){const t=k({list:o.MR((0,l.Z)(e,"ignore-class-instances")||[],(e=>e.timestamp)),cancel:(e,t)=>!1,replace:(e,t)=>function(e,t){if("block-changed"===e.type&&"block-deleted"===t.type&&g(e,t))return{...t,authors:f(e,t)}}(e,t)||function(e,t){if("permission-group-changed"===e.type&&"permission-group-deleted"===t.type&&C(e,t))return{...t,timestamp:t.timestamp,permission_group_data:e.permission_group_data.before,authors:f(e,t)}}(e,t)||function(e,t){if("permission-changed"===e.type&&"permission-deleted"===t.type&&T(e,t))return{...t,timestamp:t.timestamp,permission_data:e.permission_data.before}}(e,t)||function(e,t){if("collection-property-changed"===e.type&&"collection-property-deleted"===t.type&&y(e,t))return{...t,authors:f(e,t)}}(e,t)||function(e,t){if("collection-view-changed"===e.type&&"collection-view-deleted"===t.type&&_(e,t))return{...t,authors:f(e,t)}}(e,t)});return o.MR(t,(e=>e.timestamp))}function R(e){return function(e){const t=[];return e.forEach((e=>{if("block-changed"===e.type)if(r.lv({before:e.block_data.before.block_value,after:e.block_data.after.block_value})){const n={...e,type:"block-created",block_data:e.block_data.after},o={...e,type:"block-deleted",block_data:e.block_data.before};t.push(o),t.push(n)}else t.push(e);else t.push(e)})),t}(A(e)).filter((e=>!function(e){return("block-created"===e.type||"block-deleted"===e.type)&&a.wL[e.block_data.block_value.type]&&"page"!==e.block_data.block_value.type&&!(0,s.wS)(e.block_data.block_value,"title")}(e)&&!function(e){return("block-created"===e.type||"block-deleted"===e.type)&&a.XX[e.block_data.block_value.type]}(e)))}},34886:(e,t,n)=>{n.d(t,{F:()=>a,R:()=>r});var o=n(53965),i=n(1898);function r(e){const t={};return e?((0,i.qP)(e).forEach((e=>{let[n,i]=e;null!=n&&null!=i&&(t[String(n)]=o.HD(i)?i:JSON.stringify(i))})),t):t}function a(e){return e>=1e3?"1000+":e>=500?"500-999":e>=100?"100-499":e>=50?"50-99":e>=10?"10-49":e>=2?"2-9":e>=1?"1":"0"}},46637:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(30548);const i=["adClick","fbp"];const r=new class{constructor(e,t){this.localStorageStore=void 0,this.localStorageStore=new o.ZP(e,t,"targeting")}get(e){return this.localStorageStore.get(e)}set(e,t){return this.localStorageStore.set(e,t)}remove(e){return this.localStorageStore.remove(e)}removeAllIfNoPermission(){this.localStorageStore.hasPermissionForTrackingType||i.forEach((e=>this.remove(e)))}}(o.$p,!1)},72128:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(30548);const i=["sourceInitialPage"];const r=new class{constructor(e,t){this.localStorageStore=void 0,this.localStorageStore=new o.ZP(e,t,"performance")}get(e){let{userId:t,key:n}=e;return this.localStorageStore.get((0,o.dq)(t,n))}set(e){let{userId:t,key:n,value:i}=e;return this.localStorageStore.set((0,o.dq)(t,n),i)}remove(e){let{userId:t,key:n}=e;return this.localStorageStore.remove((0,o.dq)(t,n))}removeAllIfNoPermission(){const{namespace:e,hasPermissionForTrackingType:t}=this.localStorageStore;if(t)return;const n=`${o.eg}${e}:`;Object.keys(localStorage).filter((e=>e.startsWith(n))).filter((e=>{const[t,n,o,r]=e.split(":");return r&&i.includes(r)})).forEach((e=>localStorage.removeItem(e)))}}(o.TA,!1)},64793:(e,t,n)=>{n.d(t,{tA:()=>a});var o=n(1898),i=n(31919),r=n(896);class a{constructor(e){this.lastVersion=void 0,this.externalId=void 0,this.product=void 0,this.billingInterval=void 0,this.unitAmount=void 0,this.state=void 0,this.regions=void 0,this.externalId=e.external_id,this.product=e.product,this.billingInterval=e.billing_interval,this.unitAmount=i.n.fromValue({amount:e.unit_amount,currencyCode:e.currency}),this.state=e.state,this.regions=e.regions}get currencyCode(){return this.unitAmount.currencyCode}isAddOn(){return"ai"===this.product}getMonthlyUnitCost(e){const t=this.getAdjustedUnitAmount(e);return"year"===this.billingInterval?t.withDividedAmount(12):t}getMonthlyCost(e){const{quantity:t,coupon:n}=e;return this.getMonthlyUnitCost(n).withMultipliedAmount(t)}getCostPerBillingInterval(e){const{quantity:t,coupon:n}=e;return this.getAdjustedUnitAmount(n).withMultipliedAmount(t)}getDiscountPerBillingInterval(e){var t;const{quantity:n,coupon:o,promo:i}=e,a=this.unitAmount.withMultipliedAmount(n);if(o&&this.doesCouponApply(o))return a.withMultipliedAmount((0,r.ZN)(o));let s=0;return null!=i&&i.percent_off&&null!==(t=i.applies_to)&&void 0!==t&&t.includes(this.externalId)&&(s=i.percent_off/100),a.withMultipliedAmount(s)}getAdjustedUnitAmount(e){let t=1;return e&&this.doesCouponApply(e)&&(t=1-(0,r.ZN)(e)),this.unitAmount.withMultipliedAmount(t)}doesCouponApply(e){switch(this.product){case"ai":return"ai_fifty_percent"===e;case"free":case"student":case"personal":return!1;case"plus":return["team_three_months","team_annual"].includes(e);case"business":case"enterprise":return["business_three_months","business_annual"].includes(e);default:(0,o.t1)(this.product)}}}},9182:(e,t,n)=>{n.d(t,{F6:()=>m,H6:()=>g,Hw:()=>d,Lg:()=>r,Pc:()=>c,YK:()=>l,a7:()=>u,bs:()=>s,dK:()=>b,h_:()=>v,iv:()=>a,tw:()=>h,xi:()=>f,zt:()=>p});n(21703);var o=n(53965),i=n(19584);function r(e){return e.subscription?e.subscription.pending?{...e.subscription.pending,trialEnd:void 0}:e.subscription:{items:[],trialEnd:void 0}}function a(e){return e.subscription??{trialEnd:void 0,items:[]}}function s(e){if(e)return y(e.items.map((e=>e.price.unitAmount.currencyCode)),"All subscription items should have the same currency code.")}function l(e){return!!e&&e.items.length>0}function c(e){if(e)return y(e.items.map((e=>e.quantity)),"All subscription items should have the same quantity.")}function d(e){if(e)return y(e.items.map((e=>e.price.billingInterval)),"All subscription items should have the same billing interval.")}function u(e,t){return((null==e?void 0:e.items)??[]).find((e=>h(e)===t))}function p(e){const t=u(e,"plan");return(null==t?void 0:t.price.product)??"free"}function m(e){var t;return null===(t=u(e,"plan"))||void 0===t?void 0:t.price.externalId}function f(e){return((null==e?void 0:e.items)??[]).filter((e=>"plan"!==h(e))).map((e=>e.price.product))}function g(e){return"ai"!==e.price.product?e.price.product:void 0}function h(e){return v(e.price.product)}function v(e){return"ai"!==e?"plan":"ai"}function b(e,t){return(0,i.UV)(e,(e=>h(e)),t,(e=>h(e)))}function y(e,t){const n=(0,o.jj)(e);if(n.length>1)throw new Error(t);return n[0]}},31919:(e,t,n)=>{n.d(t,{n:()=>i});n(21703);const o={BRL:{currencyCode:"BRL",minorUnitDigits:2},EUR:{currencyCode:"EUR",minorUnitDigits:2},GBP:{currencyCode:"GBP",minorUnitDigits:2},USD:{currencyCode:"USD",minorUnitDigits:2}};class i{static fromValue(e){const{amount:t,currencyCode:n}=e,r=o[n];if(!r)throw new Error(`Unsupported currency code: ${n}`);return new i(r,t)}static sum(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const o=t.filter((e=>void 0!==e));if(0===o.length)return;const{currencyCode:r}=o[0];if(o.some((e=>e.currencyCode!==r)))throw new Error("Cannot add money with different currencies");const a=o.reduce(((e,t)=>e+t.amount),0);return i.fromValue({amount:a,currencyCode:r})}static zero(e){return i.fromValue({amount:0,currencyCode:e})}constructor(e,t){this.currencyValue=void 0,this.amount=void 0,this.currencyValue=e,this.amount=t}get currencyCode(){return this.currencyValue.currencyCode}toMoneyValue(){return{amount:this.amount,currencyCode:this.currencyValue.currencyCode}}withAmount(e){return new i(this.currencyValue,e)}withAddedAmount(e){return new i(this.currencyValue,this.amount+e)}plus(e){if(this.currencyCode!==e.currencyCode)throw new Error(`Cannot add money with currency code ${this.currencyCode} to money with currency code ${e.currencyCode}`);return new i(this.currencyValue,this.amount+e.amount)}minus(e){return this.plus(e.withMultipliedAmount(-1))}withMultipliedAmount(e){return new i(this.currencyValue,this.amount*e)}withDividedAmount(e){return new i(this.currencyValue,this.amount/e)}zeroIfNegative(){return new i(this.currencyValue,Math.max(0,this.amount))}zeroIfPositive(){return new i(this.currencyValue,Math.min(0,this.amount))}isPositive(){return this.amount>0}isNegative(){return this.amount<0}}},896:(e,t,n)=>{n.d(t,{$v:()=>r,ZN:()=>a,pp:()=>i});var o=n(1898);function i(e){if(!e)return!1;switch(e){case"ai_fifty_percent":return!0;case"team_three_months":case"team_annual":case"business_three_months":case"business_annual":case"enterprise_three_months":case"enterprise_annual":return!1;default:(0,o.t1)(e)}}function r(e){if(!e)return!1;switch(e){case"ai_fifty_percent":return!1;case"team_three_months":case"team_annual":case"business_three_months":case"business_annual":case"enterprise_three_months":case"enterprise_annual":return!0;default:(0,o.t1)(e)}}function a(e){switch(e){case"team_three_months":case"ai_fifty_percent":return.5;case"team_annual":case"business_three_months":case"business_annual":case"enterprise_three_months":case"enterprise_annual":return.1;default:(0,o.t1)(e)}}},26929:(e,t,n)=>{n.d(t,{Ym:()=>l,cS:()=>s});n(21703);var o=n(30120),i=n(1898);const r={payment_failed:30,confirmation_required:15};function a(e){const{now:t,subscriptionId:n,invoiceId:o,overdueReason:a,subscriptionStatus:s,invoiceDueDate:l}=e,c=function(e){const{subscriptionId:t,subscriptionStatus:n}=e;if(t&&n)switch(n){case"past_due":case"unpaid":return{paymentStatus:n,reason:`Subscription [${t}] status is '${n}'. This triggered the '${n}' payment status`};case"incomplete":return{paymentStatus:"past_due",reason:`Subscription [${t}] status is '${n}'. This triggered the 'past_due' payment status`};case"active":case"canceled":case"incomplete_expired":case"paused":case"trialing":return;default:(0,i.t1)(n)}}({subscriptionId:n,subscriptionStatus:s}),d=function(e){const{invoiceId:t,invoiceDueDate:n,overdueReason:o,now:i}=e;if(!t||!n||!o)return;if(i<n)return;const a=n.toFormat("LLLL dd, yyyy"),s=r[o];if(!s)throw new Error(`Unsupported overdue reason '${o}'`);const l=n.plus({days:s});if(i>=l)return{paymentStatus:"unpaid",reason:`Invoice [${t}] is overdue since ${a} due to '${o}'. This triggered the 'unpaid' payment status after a ${s} day warning period ending on ${l.toFormat("LLLL dd, yyyy")}`};return{paymentStatus:"past_due",reason:`Invoice [${t}] is overdue since ${a} due to '${o}'. This triggered the 'past_due' payment status on the due date.`}}({now:t,invoiceId:o,invoiceDueDate:l,overdueReason:a});return"unpaid"===(null==c?void 0:c.paymentStatus)?c:"unpaid"===(null==d?void 0:d.paymentStatus)?d:"past_due"===(null==c?void 0:c.paymentStatus)?c:"past_due"===(null==d?void 0:d.paymentStatus)?d:{paymentStatus:"paid"}}function s(e){const{now:t,overdueSubscription:n}=e;if(!n)return{paymentStatus:"paid",reason:"No overdue subscription was provided"};const{subscriptionId:i,invoiceId:r,subscriptionStatus:s,dueDate:l,overdueReason:c}=n;return a({now:t,subscriptionId:i,invoiceId:r,overdueReason:c,subscriptionStatus:s,invoiceDueDate:l?o.ou.fromMillis(l):void 0})}function l(e){let{status:t}=e;return["requires_payment_method","requires_source"].includes(t)}},2438:(e,t,n)=>{n.d(t,{Rb:()=>s,nR:()=>r,qH:()=>a,uN:()=>i});n(21703),n(57658);var o=n(60897);function i(e,t){return t?t.percent_off?{amount:e*t.percent_off/100,monthsRemaining:t.duration_in_months}:t.amount_off?{amount:t.amount_off}:{amount:0}:{amount:0}}function r(e){return"personal"!==e&&o.tt.find((t=>t===e))}function a(e,t){const n=e.find((e=>e.externalId===t));if(!n)throw new Error(`Unable to find price data for ${t}`);return n.billingInterval}function s(e){const{currency:t,isSepaEnabled:n}=e,o=["card","link"];return"EUR"===t&&n&&o.push("sepa_debit"),o}},64684:(e,t,n)=>{n.d(t,{$$:()=>T,AL:()=>v,AW:()=>D,B5:()=>R,Ei:()=>E,Fm:()=>I,Hf:()=>u,I6:()=>V,J2:()=>_,Uk:()=>Z,V3:()=>S,W9:()=>F,XO:()=>d,ah:()=>A,hY:()=>l,he:()=>g,jI:()=>B,jc:()=>w,lF:()=>O,m4:()=>p,pd:()=>m,s8:()=>b,t0:()=>M,uG:()=>h,x4:()=>c,xC:()=>y,xf:()=>k});n(57658),n(21703);var o=n(53965),i=n(1898),r=(n(59753),n(63306),n(72141)),a=n(29369),s=n(90965);function l(e){return void 0===e.membership?[]:e.membership}function c(e){let{members:t,groups:n}=e;if(!t||!n)return[];const i=o.KX(n,(e=>e.id)),r=t.map((e=>"group"===e.entity_type?i[e.group_id]:void 0));return o.oA(r)}function d(e){const t=l(e);return o.oA(t.map((e=>{if("owner"===e.type)return e.user_id})))}function u(e){const t=l(e);return o.oA(t.map((e=>{if("team_level_guest"===e.type)return e.user_id})))}function p(e){return Boolean(e.archived_by)}function m(e,t){return d(e).includes(t)}function f(e){var t;let{team:n,space:o,userId:i}=e;const r=null===(t=C({team:n,space:o}).find((e=>{let{userId:t}=e;return t===i})))||void 0===t?void 0:t.teamMemberInfos;if(!r||0===r.length)return"none";return h(...r.map((e=>e.type)))}function g(e){const t=function(e){const{team:t,space:n,spaceUser:o}=e,i=t.getRawMembership(),r=[],a=i.find((e=>"user"===e.entity_type&&e.user_id===o.user_id));if(!o.isMember()&&"team_level_guest"!==(null==a?void 0:a.type))return[];a&&r.push(a);const s={};i.filter((e=>"group"===e.entity_type)).forEach((e=>{const t=e;s[t.group_id]=t}));const l=n.getPermissionGroups().filter((e=>{var t;return s[e.id]&&(null===(t=e.user_ids)||void 0===t?void 0:t.includes(o.user_id))})).map((e=>s[e.id]));r.push(...l),t.is_default&&0===r.length&&r.push({type:"member",entity_type:"user",user_id:o.user_id});return r}(e);if(0===t.length)return"none";return h(...t.map((e=>e.type)))}function h(){let e=0;for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];for(const i of n)e=Math.max(e,a.d2.indexOf(i));return a.d2[e]}function v(e){let{team:t,spaceValue:n,userId:o,groupIdsThatIncludeUser:r}=e;const a=(0,s.kC)(n.permissions,o);if(!a)return!1;if(t.is_default&&a)return!0;r||(r=(n.permission_groups??[]).filter((e=>e.user_ids&&e.user_ids.includes(o))).reduce(((e,t)=>(e.add(t.id),e)),new Set));const c=l(t);for(const s of c){if("member"!==s.type&&"owner"!==s.type)continue;const{entity_type:e}=s;switch(e){case"user":if(s.user_id===o)return!0;break;case"group":if(r.has(s.group_id))return!0;break;default:(0,i.t1)(e)}}return!1}function b(e){let{team:t,userId:n}=e;return l(t).some((e=>"team_level_guest"===e.type&&e.user_id===n))}function y(e){if(!e.permissions)return"none";const t=e.permissions.find((t=>_(t,e.id)));return t?t.role:"none"}function _(e,t){return(0,r.zU)(e)?e.team_id===t:(0,r.Ix)(e)}function S(e,t){return!!(0,r.bm)(e)&&e.team_id===t}function w(e,t){return!(!(0,r.LW)(e)||e.team_id!==t)||(0,r.KK)(e)}function k(e){let{team:t,space:n}=e;const o=C({team:t,space:n.__IM_SORRY__getValue()}),i=[];for(const r of o){const{teamMemberInfos:e,userId:t}=r;e.some((e=>"owner"===e.type||"member"===e.type))&&i.push(t)}return i}function I(e){const t=function(e){const{team:t,space:n,spaceMembers:o}=e,i=t.isDefault()?T({team:t,spaceMembers:o}):t.getRawMembership(),r=new Set(o.map((e=>e.userId)));return x({teamMembership:i,spaceMemberIdsSet:r,permissionGroups:n.getPermissionGroups()})}(e);return t.map((e=>e.userId))}function C(e){const{team:t,space:n}=e;return x({spaceMemberIdsSet:new Set((0,s.Mi)(n)),teamMembership:t.is_default?M({team:t,space:n}):l(t),permissionGroups:n.permission_groups??[]})}function x(e){const{teamMembership:t,spaceMemberIdsSet:n,permissionGroups:o}=e,r={},a={};return t.forEach((e=>{if("user"===e.entity_type){("team_level_guest"===e.type||n.has(e.user_id))&&(r[e.user_id]=[e])}else"group"===e.entity_type?a[e.group_id]=e:(0,i.t1)(e)})),o.forEach((e=>{if(e.id in a&&e.user_ids){const t=a[e.id];e.user_ids.forEach((e=>{e in r||(r[e]=[]),n.has(e)&&r[e].push(t)}))}})),(0,i.qP)(r).map((e=>{let[t,n]=e;return{userId:t,teamMemberInfos:n}}))}function T(e){let{team:t,spaceMembers:n}=e;const o=[],i=new Set;for(const r of t.getRawMembership())o.push(r),"user"!==r.entity_type||"member"!==r.type&&"owner"!==r.type||i.add(r.user_id);for(const r of n)i.has(r.userId)||o.push({type:"member",entity_type:"user",user_id:r.userId});return o}function M(e){let{team:t,space:n}=e;const o=[],i=new Set;for(const a of l(t))o.push(a),"user"!==a.entity_type||"member"!==a.type&&"owner"!==a.type||i.add(a.user_id);const r=(0,s.UD)(n);for(const a of r)i.has(a.user_id)||o.push({type:"member",entity_type:"user",user_id:a.user_id});return o}function P(e){return"user"===e.entity_type?`${e.entity_type}|${e.user_id}`:"group"===e.entity_type?`${e.entity_type}|${e.group_id}`:void(0,i.t1)(e)}function A(e,t){return P(e)===P(t)}function R(e){return"self_join"===e.space_member_join_access?"open":"team_members"===e.visibility?"private":"closed"}function D(e){const{accessLevel:t,isDefault:n}=e,{id:o,permissions:a,settings:s}=e.teamValue,l={type:"explicit_team_owner_permission",role:"editor",team_id:o},c=(null==a?void 0:a.find(r.zU))||{type:"explicit_team_permission",role:"editor",team_id:o},d=null==a?void 0:a.find(r.ix),u={visibility:"space_members",space_member_join_access:"self_join",invite_access:"team_members"};if(n)return{settings:u,permissions:[l,c,{type:"space_permission",role:c.role},{type:"explicit_team_guest_permission",role:"none",team_id:o}]};if("open"===t){const e=(null==d?void 0:d.role)??"none";return{settings:u,permissions:[l,c,{type:"space_permission",role:(0,r.YX)(e)?e:c.role}]}}return"closed"===t?{settings:{visibility:"space_members",space_member_join_access:"invite_only",invite_access:s.invite_access},permissions:[l,c,{type:"space_permission",role:"none"}]}:"private"===t?{settings:{visibility:"team_members",space_member_join_access:"invite_only",invite_access:null==s?void 0:s.invite_access},permissions:[l,c,{type:"space_permission",role:"none"}]}:void(0,i.t1)(t)}function E(e){let{userId:t,teamModel:n,spaceModel:o}=e;if(void 0===t||void 0===n||void 0===o)return!1;if("private"!==R(n.getSettings()))return!1;return"none"===f({userId:t,team:{is_default:n.isDefault(),membership:n.getRawMembership()},space:{permissions:o.getPermissionItems()}})}function B(e){return d(e).length<1}function F(e,t,n){return!!B(e)&&(!!(0,s.wv)(n,t)&&("private"!==R(e.settings)||("enterprise"===n.subscription_tier||v({team:e,spaceValue:n,userId:t}))))}function O(e){let{groupId:t,teamMember:n}=e;return"group"===n.entity_type&&n.group_id===t}function Z(e,t){return t?t.filter((t=>!A(t,e))):[]}function V(e,t){return(t=(t=t??[]).filter((t=>!A(t,e)))).push(e),t}},62992:(e,t,n)=>{n.d(t,{J:()=>i});const o=new Set(["7754cf02-251f-4bc9-ab2f-9cc897765336","ba43b46e-4ad3-47f7-95f0-58a3ba01476f","86fd2f05-b95a-48d9-a2fd-9fd8aab2f74f","aa94ac95-f6b0-47f1-8211-37087c9dcba6","10e7ee2a-3beb-4b49-96f2-8b8f662aabd4","6ce5f94a-8f64-42bd-9df9-2718a97bf539","c3eec6d5-b872-4ed6-ba75-306ec8006d88","7777cfa6-76ad-4976-8ef6-8f49c217ab52","6f521ac5-cfca-4580-860b-65df285f9660","fbe283d2-7e33-41ce-ac39-4b29f194ee26","c1de9900-4b7d-431b-a470-84c5c26eefde","dfb87d56-70af-4ac6-917d-1291d8ec7354","73feb0ab-635a-4c7c-8925-0bf551c61700","f0391877-6552-4b6c-969f-4effd300e264","75aacb5d-c105-4c73-8aad-bba3df0181f8","6f040c35-60bf-432c-b30a-096d494c5960","b8cf3a52-269f-430e-8dcf-e4cc860e0884","ad3d8b0b-22d8-48d1-9146-812b7ad4faec","0bc5a2e1-f401-4179-ba2a-c99bcae55190","179b5241-bada-44e4-8928-1efd1656c38d","c9443c7b-c803-49fb-bce3-44d4e9021454","27fdba35-578f-482d-b496-a98821942c35","b72f783a-5dce-41e3-9735-2cae3fcef6e6","3d811429-6bdf-489a-8f10-832380aa873d","de1cdbdd-9c77-4f08-8211-007a2b3401c3","307087b5-e940-46bf-ae69-fe3eebe91031","566b2711-4a9c-4d1b-a9d7-a2439f358674","bb957a92-76ec-4283-aaab-7fa77deba3f1","bef399e1-8841-4a69-aa8b-1471664c582c","ee6c3e86-3fd1-4164-9351-b31ccbc695f8","35eee73a-0536-420a-a6a5-125e0aad2d54","ddc2981c-e7fd-4880-81b5-86e0c4bc2ea1","14d1a2a5-dc71-4275-9b0c-cfc5a1b13b00","fcc6e15e-257d-4260-bced-da7d6aeb7257","10a07eab-3d8f-42d2-86fe-e58aba32c6a4","a929b937-0b73-427a-afd5-1896715abc49","1f87c3fd-3c99-484d-af03-7a6296dd09af","9b8c7303-4148-4754-ae47-da98ad15ebd3","06917ea1-367b-44d4-9e74-8d0a507d0a1f","44b19dbc-c008-4dc3-a203-77d28f5c1859","c87c2638-8564-444c-88c6-8d6231da145e","f3627a1c-aa76-40d0-956d-4b305813f3b2","0bf1bac9-af83-47e9-8bd0-987732d57348","3b9a8796-0d8e-455e-af31-f5b4631ae438","4728ffef-226b-423b-a730-c71d38e71d85","835f8d33-9268-42e6-9e04-a9c9db7acfac","0f844dc5-4142-4061-9e84-e0dd1ef71d00","44ed096e-f287-46a7-9222-f8f1e519b0bb","866ce03b-d6a6-4ce3-a527-b95118b56bd7","82c3118e-5e8b-4917-a921-9e695a1853bb","72630fc1-3d80-4b39-b7de-269b1ce5d455","039fba32-3bea-4377-8b42-04ff8e5dd3f4","9f115bdc-8fa6-4272-896d-2678970d3ef8","98772d76-b111-49e4-a9db-f000e9d61b03","960c9f76-30d6-4861-bc01-ce82ba1a8591","b830a9d4-06bd-4639-ba9e-2832ee81a689","912d82c7-cd39-455d-8ff6-9742118186db","ca827af1-3833-4a3a-8e82-c02552d820f5","bb439161-a466-4571-b5da-63f84b193474","a80ed33e-3840-408e-a445-b1099ce2b9d0","f24f8158-ecde-49ef-a51a-95b6ccc0703e","bdcdf14b-1f7d-471b-b4d6-e3cd244d12a6","e15410a0-4766-499d-a513-f536544bd2f3","ef512485-d49b-448f-a038-c6c71cfddbca","5f6d17ed-543a-4395-a5a7-04b3d2a35a55","48374a18-b873-461c-9d08-0127c6553204","d3cc5d9f-1aee-4ebe-90ec-77968c058905","b3558f2a-8ee3-472b-ab47-3d05b83e47a4","caca4605-2888-4869-8dfd-ef8f1dedab70","61c5eaf1-c511-4e80-9ad9-a4aab4edd106","1a49c41e-4107-4161-ad19-7161197defa5","bf154056-b048-4a3e-bb40-f41ec111791b","0c805a36-50be-4442-9a35-ed2907d70239","72955d7d-a8c1-4e84-a5e1-db637f53781e","e5c98f03-928b-4d20-ba01-e36382468187","0fa21220-95d0-400f-9fa4-5a95a046e9e8","ff889770-d18d-4b18-9f01-905a57cd9b28","2273a46b-12b5-483b-8f67-f4842f282967","47f7d067-7741-4113-ab72-6d12b8cd5786","e609dd4f-39d7-4424-b273-6eead26c7fe9","4ba726cb-4898-4702-9e05-4e23d85fd015","d6ec9638-6bb3-4b9d-ae4f-47122405e3eb","282a4fdf-1457-4d32-88cd-51d599481d71","eb12d79d-5dff-4d0a-ba49-02c7fd72e7ac","04576141-9d17-4d7c-a499-79590630e9fa","e0513925-3754-4cdc-8213-398c81f89d1b","25154d3e-5937-43f2-a47e-11509f34ce5a","59fd9e00-4b34-4e8d-bf9e-26b86323fd81","07b1a6c5-3526-4272-a35a-127684cfbcfe","e9642cc5-1342-4e34-b0c4-585321151347","a2bbdea8-2e03-4df8-9b89-0569c0ffd127","6905c1f8-6e8b-4e92-b3e5-5bf3059ce472","7cb6e153-76d8-4f11-9c3c-2f0c3b816ddc","8c37f1d6-19ee-4de0-a851-65ddbef0d642","1b65b28b-db02-4a9a-b596-26bd59ec9ce0","1d32c0de-c904-4e01-b56f-759c643c20ca","14fc89bf-4a6a-44ab-b9f4-79c5f997a73a","c352dfd4-67b1-413c-88ea-f7bf2ec8a3e0","bdb36fd4-ac83-4c8d-b83b-2884fa63f0fd","f7bdcac5-3454-4ffe-904e-ad4fe91b4b53","ea04b311-11bd-4872-9ab7-c15faadc3e3c","b03f9c77-daaf-432a-8573-71a931204d98","89238317-2b73-4ca7-922d-7c6df95f6bdb","33f2c6ca-7a7e-44d0-ba49-8e8e2897c91f","70b3c08c-cd4a-40db-9c2c-0029a23ba970","8de1c223-226e-46f6-9f16-36847f42b99f","4175a9b5-ea6e-489b-a2b1-70db5518f9db","f582c072-525e-4412-8f5a-68e8f9aaba9b","1b53b923-a77d-4bca-adc6-764ff78769f7","16a18cca-cacb-48ed-b1a6-72560e0ad728","cb5551ab-a47f-41a0-8a9c-ad134d77c693","75fd09a5-821f-4faa-a8f4-9f862d3892d9","75a93415-c9a4-4270-86fd-42664893cc7c","754b3d46-509e-4a4b-82d0-ec340114d5b5","42a45521-808f-4f85-9922-dc8bc583e287","a5b24576-80f8-415c-9877-45ba9d6e6033","58444e8f-94eb-4708-9f3b-6582245e6a9e","e29a8fd7-faf4-4614-9341-c55cce539b3d","f41adbea-5c0a-4b74-b222-d898d8ece92c","aa2398a2-6261-4995-bcf5-2423e8560336","cf48a687-67bd-4117-ad07-c20c0682662c","edbfd965-92a1-4291-b11e-f52d21184507","e7b453b7-98b4-4166-a97a-e99fc7bd6a35","d7768c90-8491-42af-b960-3575f5b218a7","9368e169-ec01-4953-b7dc-817398ab6e53","3477b696-40b1-4548-8ff0-a93e0d41fc25","e0ccdb5a-bacd-4d8c-875c-4f29c8786048","8fb16dba-6f02-4d4f-b69c-210a900f9e57","9a47645f-8880-4d04-8b1e-d49f9f24a524","ded667af-370f-469a-ae2b-16737d423cfe","cd19749e-355c-493a-a1a9-64be68ba9399","aa94fec7-7dba-4aa3-a444-d321c2e6e11c","68e75880-ea6b-43f6-9a62-f813972d8f40","8c6f9188-eaff-426b-9d81-a14c4148a34b","b17d77ae-2af7-48e3-be6b-0c70b1dadd61","3e2349d2-0ca4-47ed-b4b9-817e5daafb19","5fd0af8d-72f1-4b7e-8246-4c46b651c531","e558a94c-6104-4bfd-b97b-ac7a2cecce35","cb137291-1ad2-4c35-b496-6f87a469c1b2","a7d3d253-0bfd-4c9d-a9c3-3459ec3ee8d8","3a966f53-355f-4a2e-a25a-4afce1ea4a0f","eea1c2a4-4992-459e-bf8c-735bf96abbe9","57c9d2f6-7086-4d8e-9d5d-1eca18ec8891","06334913-07b1-4622-9b2a-370cf56f0007","74dfb5af-738b-4a0e-916b-ce1970ec85cf","ba72173e-c456-46e9-92dc-73185c654d77","1887f846-11e7-4ab2-b816-c2e8c724718e","9ac64262-cad7-44f3-bfae-96dabec9e770","5b51de44-604b-4a96-b421-9f3e3cf470d2","b9626438-4451-441c-9608-35ab50e3b182","eb402bfa-b46f-4f51-878c-37aef629d3fa","89c371f3-766b-4dab-bde6-d23a97952cd5","ff21bacf-9b2b-4dc2-a715-02cf94e08015","87c07fd3-dcb2-4ba2-8855-927206bfba62","ea69e9ee-ee67-4f2d-83f6-7f862a8495ff","958b2624-6de2-44c8-bf07-ce363d450a28","67a391bb-2b1e-4fb6-b032-dc006e236e6e","e1218662-df9e-477c-bf3d-805e9b420911","697d17c4-4597-4949-9c24-c220aefc31f7","3d6561ad-7ea5-4c0e-9b9d-3280be3ffcc7","0f12132a-db77-4cdb-8b24-449d623a9010","05017ffd-160e-48c5-a6cf-67d04a45f53f","92cc7ea8-55a1-486c-a2ba-71c5093628aa","0821d4cd-353f-431c-bc63-5b51a7971bf0","4c801bb7-cb1b-45e3-a5eb-5aa31bbe1098","5c94c383-f6b2-4cf3-aff8-d629519c5fcd","b989c735-bc3a-4695-a7c2-9496aa28b8a6","a9019468-ed82-456b-854c-c08adf545757","4a898da1-68ac-4794-a30c-1fb7135776eb","aaddc9ad-2a6b-49cd-85a3-e80f4a04c5b8","6dd32bf2-72f8-4e62-bd77-870d9cc9cc99","949b3963-dbea-4abe-9590-97c7cd361209","897a2735-0e80-46da-b6f6-58fc3df53086","cdbbe77b-4b6c-49f0-a006-c1cb7c053d15","61a5c696-b407-4e63-85a8-b57f3f935cbb","42e9c365-194e-49b2-a7ac-d651f12c8cf7","fd81a9e6-b912-4f81-904c-a52526f6dbda","c46efa5f-a694-475c-8663-040a95fb807b","4adffda2-b85f-4660-b450-cfe09c9b0738","bd5cc0b9-d2e8-421b-9c88-de91dda82774","e9bc2136-0167-4fec-a72d-737571f7b027","0f93fc48-ec04-445d-94e5-ce4ed8b70c87","db3c3399-ddb8-4bae-9e89-1b0478931527","f3dfe652-b303-4177-ac57-10dff07f906f","56f414f6-20c9-40e8-8ff2-29784f768d1c","644c1c6a-8d94-4041-8dd4-5fb6a2aada91","7da30be9-2725-4226-9247-2a8fbf5d3d71","dd5540c5-fb12-49f9-b94f-5ffca3054ba5","b4f7298d-08b2-407a-9bee-50dbac0a7f00","7a950eae-90da-4885-8157-68009c201af0","8da6e187-ca72-4c85-8640-517601e1271f","046c0e5f-7098-42d1-b754-64fcc6276660","0b1a2c1b-3b18-4a55-8fa8-08fd5985aa4f","1abf52e0-b652-4629-8353-e2fc1ed8f046","bd871031-b4ad-417f-8082-5fd7bf3c805d","e8d82ad2-a010-4448-a29e-bd19ddf655e7","13d638ec-4f82-4318-bfa6-1f636643dc46","eeb6fd30-006e-4f99-b4c2-40931da53359","4c86679b-7ab7-407e-b863-2a8a46b82a8b","0a0b7aa2-bec5-46e7-949e-fd54ef7bffdc","d355b3d8-545a-4720-82f9-2a0243d72407","dc7a8827-25ac-4443-b8e1-c7de2304eb25","79ddf4d1-9031-4700-b30b-8db26a7b02af","68b8c5b5-7836-476b-8a02-af5b500aa180","e118777a-a087-4a6a-ba10-699cb73b06c4","b4d83009-a10d-4eb4-a04b-ff3dbc8e1304","1c3735df-eb4a-4a7a-ac45-a12b8c6ddbf7","412cb881-aecd-4cfd-8187-cbef4f6d70bb","3d875026-6da6-4cdf-ac18-084706a3eb24","f992976c-ecb4-41b5-ae2c-b25d48707701","90b462a0-5cbe-43d3-8de1-04926b96d492","a28036b8-5a0d-4867-9d8f-dfe034d6ac77","34e78ee8-d46b-4bd1-accb-8efffd17e7f2","1aacaa6e-3718-4b6b-9436-e5cf747a85f5","b147ba74-1764-41ec-93f2-47694e1b8ae3","f8243ce8-45a0-468f-a949-42595e728618","42496cf1-408c-45b5-9492-90985b5d933d","ee70e79d-2c8e-4307-81e3-5e8d1e6cdc4f","833ac885-ef61-4748-bd02-85e3e927a7da","da2975ce-c5eb-4f36-9ae5-541d74b0b370","edc45a1f-e2b4-4a8d-8868-c5d33027ff65","0907e06e-8884-4cdd-bc9a-766dc771049a","22f3e6fb-90b9-4cc6-bd8c-7d97998ffb9c","020a62e4-c5b4-4280-9872-3bf56fa34803","be58e424-c2ac-4835-a482-1083af3f75db","f3a92c2d-1fe4-48e6-b07e-52bf0a73735b","5b51f361-b0a8-4442-a095-4e781cdd2a38","476b5d8c-6d64-49fb-b664-d5c3b19e0dc6","bccc09eb-c3c0-43e1-a377-73ede6bfdc93","b31728b7-f4c4-4870-85dd-e4e543354fa9","4d2f560e-ef38-414b-b78c-c6b400f6d521","634abe84-7bfd-41c4-8ca8-8f2d8d548ec5","06c04e85-a23f-411c-8134-7d75ae627ebb","4c007793-6634-4891-b899-f709d3f8be13","90f9e4a2-b696-4f0c-ba98-d2856619b921","011db133-fd04-47f7-8fc1-255d2bb63e0b","652d83ae-50de-45da-8086-33749e5a8484","dc42afef-e4eb-4f39-9414-30cf73df3ec6","dd47099e-f772-48fd-97da-0396514afd22","9a0a5a76-bca8-44f9-87dc-65384c3a217c","99dcd6b6-61a3-4a17-945c-3e7be66ea38d","30b77330-aeed-45ff-84cc-fe68ff1f8f3a","f5157133-84a3-4904-97d4-07ee533ad17d","5ff9e66d-d71c-4449-825f-2f40aea916a7","05d2906c-0d7e-464a-86a7-e201ef984fdf","46500981-90b0-466c-ba96-7c8cc3abe6bb","66e403e8-7381-4576-a3a1-55b3e5562142","b8f6fce4-32fe-44d3-aa93-1f2b98735a46","9a87eddb-b5c5-4d26-9c05-2ebb3bc25c38","d7608a6b-48f4-4155-abcc-e3f816d76540","5b1ea383-85a8-49e0-92db-c5314fc2bf60","09c9fad5-8783-4bc5-823b-ee96006c988a","c6754733-1cae-447c-87f1-7dcc97ec3c91","e75096b4-c1b9-457c-a0b1-08bb16a9ccb7","184316f7-5174-4e40-ab49-9d0acc795626","1d1f0bf1-ed8d-4b28-b95d-2d45951f6bb7","e4bcde5b-a9af-4ca3-8048-84ed66114db6","fe748adb-5348-4b99-9550-eb578d1267fe","77af2dcb-2afc-4346-afed-eb4a056e6aea","4e041ef3-1f42-4185-a27c-89f919eab933","87546bbc-daa7-45f8-a9a4-1d3fb0dbccc8","c45fab4c-5aae-47ec-a2e8-3eff476212ca","83b9fbc2-90db-4d77-805e-3e5439c3cf94","81bb64e8-81e8-491d-8f87-d08a1a563293","7c02ebd1-16b2-45a2-93c0-276a9b2b802f","5ba31d6f-cb0d-404d-ba7e-470460959007","52308efd-956f-40f1-86c7-121262bfacc1","f76d2214-119e-4338-a84c-976c0f816f8d","d80b366f-38f8-4f43-b773-5fd57180ea04","7b2a23ff-8a2d-437d-927a-d3ebe2bfad75","0397fc82-ee33-457d-b0f5-ee1d6cdb96c8","c11cb495-f207-4780-b893-c049f88cb828","29927ba5-b792-45d2-a9eb-92009c88f23e","4c3cd83e-e143-4a16-9c5a-fafada32b0d1","65767cff-5517-4446-bc54-ab2783fd245e","2a5c0225-dc76-4cdf-9505-bef61cca3074","e687822e-f385-4a3a-b52f-e07dcf1eb946","85dbea68-b96e-4807-a076-fd2e76050c56","f3bccfd2-1ead-4101-8fb8-fd91e9264c47","93aaac98-cf8b-4647-bec1-75cadd34b277","5b6740a2-5ecb-4333-9971-ce9122536803","d138d7b0-547f-4a7a-aa7e-f5905d6f93d1","57ba4b5b-cda7-4fbf-a84b-d390fa8cb998","67e3ad55-b09b-45db-9e1c-d19f6cf42f75","c79374e2-375f-483d-b911-fcf31f5ab260","7cdb9ea8-6ba6-4e96-bd55-4a088f564c1a","2b8820f7-aa83-4844-aa7c-49f65e76ca13","5d695d09-8b83-4974-bbfa-e23db25c9777","965b2b54-ddd1-4aa4-ae8b-e9063f176508","cd7e1241-257f-4fb6-8a47-b58c44fa7fd8","144276a5-081a-491d-a7fe-1d2c302c3c77","48a232b8-2bc3-4e9c-8a19-3a6ea3b0a4f2","eb9db865-87c3-4c9f-8fc2-b616f33a191c","5a05fe82-51e7-4dec-be56-9ee88e1dfb09","1819b87e-93f4-437f-a576-a81829aea8a9","ad85e229-b68e-4609-b15d-7fb83cc57440","ac64ba9a-7be1-49a1-b3c7-ab03eeabb887","a04035db-bb1c-4a4f-a401-46b2852b69d5","31118d8a-d030-4990-ab6c-c1903e25f52d","b55a8da7-da4c-4f95-b24d-df30c2f45c71","d004e080-0446-4f6d-b7c1-e23a4112e42e","2229861a-a659-49b6-83f7-04532904bcaf","c627a829-9cce-40ba-9f5f-658730381474","cd180496-ae10-45de-b90d-ed645113e574","9f85c044-5eb6-43c3-8067-f3a7c605e90f","0428cf5d-33df-46de-bde7-15cdf830836e","2343e042-1a90-4156-bb85-1b4796cef497","f1559f2d-b7fa-438f-8203-314660014496","1137fddf-9bc0-4096-a8f7-60299e1045fa","933b8d80-00ac-441a-b7f1-ff89747a96ef","04530f0c-0761-4c13-8d09-9de1f762f1fb","47345698-eaa6-4dff-a289-a6166b7ed7de","73d74b26-c367-41d2-9631-8b0870281364","f871a524-8782-4e18-82bd-b37c9a02d20e","1cb94ea7-851b-47c4-9779-ca6e36ff729e","d825ee6e-087e-4529-b9c6-cc872035a99b","a0813507-dd48-4247-9e11-5591505be841","22e4f4a0-11e2-48e4-971f-45b042ab5ffe","f2cf7d5a-be29-4778-8716-2ba8052782b5","f7dcc389-593f-440f-9d0f-f2fcb13969b4","f1337a6d-af6e-4577-b393-b1b951b29caf","b0221a97-158b-40c8-9fdb-96de7f828d6f","ebeec459-313c-4cc1-b10e-1d1fd89379d2","67fd654f-5f30-4da9-a9ac-c3a00e62298d","ee5fc60a-9b57-470e-965b-016a9c78965d","1a69020b-4480-48c5-863e-0d362dadc4c5","07cedd59-44b0-4cf0-bb2f-71c15d4d959a","d9deb1c2-2e23-48c2-9df9-d45053a3d7c9","749d0431-47c8-491b-b325-2632a3450efa","3e688f6f-dd89-44a2-990b-1fbebfe4c545","49b38afa-be03-45c9-9709-e99f0fa29896","c0f9dd57-cb4c-4275-8c2c-923bf844fdcb","1224bf88-115f-4ccb-9990-9193ff2c38a5","0e60c769-183d-4657-9a98-b4348b446275","3a47f793-6767-4fab-bddd-acfd43149d5b","345b4e0a-1cd4-4bf6-9647-2830ff18d5ec","8f3857a7-54c3-4a78-8b47-5826f8886fee","dfe91161-0409-42bb-adf7-a97310d6a5e7","49a239b3-6587-4943-8518-ab1f6aa0c200","42f690d6-1db4-410d-85b7-5c89d567ecda","5632a03f-c43a-4560-86f8-9c85313f4164","5ecf0ee6-6e50-4b3e-a08e-62c57333a30c","073ca394-eaed-4b85-a191-6f44fc33ee41","538b78d9-928e-4ad4-b15a-34b37c96ab37","424d82df-9b44-41b5-b611-a1c29ee8ba3e","7a913969-1603-411f-9d1f-cea873782252","b67ce306-a79d-42b0-b2ea-030fc537611e","73aa919d-2805-4438-848b-8349c3f65fe0","c11dafa1-9f92-4f55-8fb7-4e1661bd8fa6","8d9c8281-961f-4c0f-94d3-c50222841c73","98846fb8-3d54-4f77-9d36-414234d86ef6","33b07269-76b3-44d8-9b67-8e101b1df37e","09556661-5d31-4e2b-a916-40772339c29d","a0a3bb82-6ff0-41b3-8b56-65bfad9bddfe","0de62cce-27ed-4c27-a27c-ad4ff7df3cb3","cfaa64e2-78ef-4426-a6a5-9c97b9416a9c","fac15e0e-1c6d-4f78-8b8b-0f64c67559e8","628a2e25-26d3-4ad2-af01-47435cb033aa","7d775bff-9e67-4e9c-bdf6-657139b0c7e3","c69ae828-ce06-417b-8d30-193e8f051c03","4d3d6a95-ba15-4d1a-ab3f-c62584729c22","40b390b6-94d7-4328-879a-4c44fc289ad4","fdebe0c2-395c-425b-ab3b-b460431c9f62","8885799b-3107-4637-8d53-e1a9c3699875","b6f9434d-abba-4b06-b4c5-802dd940be7c","f563cfb6-381f-49ba-85b1-7a59d873d828","5964fc7d-d005-414d-8ddd-f600e78816fc","26655761-99f0-4668-abd0-e86f18515d7d","a9fdbb7a-f803-49ba-b75d-cfa1a3742687","a17cce9b-db68-45da-8f95-44470ab22288","92fe12c4-d11f-4721-830f-acc1dc7ae238","fe508199-026a-4d25-8f86-4863e133ec55","a3d9e508-d6aa-43f0-81cd-bc04671db8e3","8131a139-1b1c-4eda-a538-5f3ffd99a260","eb1a4b9f-2727-4e6e-868e-5120a6f2a48a","f8a4db90-da62-41d3-a74f-fd50fc4f5458","b5c44d60-6655-4f28-a7a0-edd81828f572","6338cbe2-021e-406d-9bb8-88f1ddf0cbbe","51e3a828-8857-4d4c-907f-289e425fff1a","5ca2c593-796b-4ec9-a6af-0f9b56419b9b","41ecdb08-d684-418c-ae6a-6e459f7b7e39","b0df2874-6a4a-41f0-ab0a-74ffd9a58638","814f566f-c8da-4034-8ea5-dc73d1041280","7d3ffe57-f411-4116-97b1-5da284fb32f5","2731005d-3f2c-4d59-af95-857605008540","5c186c47-5c84-44c6-9019-fb1eda5ab042","4ae28606-869e-475e-aa55-6497ecb88ffc","1e9e7223-cf3f-4483-a682-c4da7477279f","e1473692-e4ad-40e2-a560-349cf8f67dbb","ed8ae3e6-b566-4e62-987c-f5d529774521","4e4db2c2-8ccb-4bfe-ae24-3562d9bbc9b1","7293bd3a-0389-4060-862d-33fc45dde040","c969b419-b18f-42cb-99cd-d361018bd4be","456f3b5a-9909-4d60-9810-7a8604038228","32b5f3ee-c089-4dbf-9f4d-afc4753d3ca6","35489a7a-2c8a-46f0-9ac7-b057f8310ddc","2278e74f-c3a5-46de-bc28-c6f4248b1f00","37dd0d04-d5bd-40a7-b057-3aa0ce27c438","f30afd5d-3d43-476e-96ba-30f31569e913","93c85785-8b2a-4305-b81d-f42431891bc0","b14624c2-72fa-44e9-a8ec-c9d82657e130","6dc57f42-9f7b-40e4-ab76-053508dd1cfb","17047d04-360c-41a4-b396-798269d987c5","15978e45-60a6-486a-bdfe-71c6359eae43","cd0038d3-3aff-4bce-aedf-d2caabc0ff24","38ccea82-6607-4013-a099-9e1d2dba1c29","bf90ab92-062f-4db9-bad7-bbf3d2de6203","c5a2d542-031b-465e-8227-e25357b6824c","e267772f-7f8f-4ff2-8420-8a74e70cbac6","f9131d21-248c-48ee-a7d2-0a955bc18143","e82516e0-a77e-481c-87f3-0c6111a60dee","78d7784c-3e69-4e7e-951e-b141fc903c01","5a86d993-6611-4359-b89c-090341d3cad6","60f6e613-1c1f-4e0c-ade6-c1d1df66c942","4f47a4f1-f305-4c53-a102-4c87a1140962","899c1257-4bd8-413e-8c22-15217d3bf246","dc37be6e-7432-43db-a5c4-85c3a61a41bf","b9a001df-14be-44a2-bd41-a91ecd393375","45efbfa5-1720-47fe-ae18-37f7997f2a9a","0da47389-92f1-435f-acb6-b6b88feb8cc3","18819350-9c15-44ef-9d3e-bea11c4f2a31","bad9dc3b-5768-4d3b-b929-cc30b44c6780","2c27388a-7069-4004-b793-7a46d671b9cc","8f94bda0-a5c9-4d38-9367-f76ba52212e5","c6717003-5b76-4978-bd64-e45a9815d9ad","2d189307-1cf8-4374-9357-32f7f719fdaa","4d6f6eed-8b98-4db2-82af-3c4459822a67","05932da9-e597-4c69-97bb-3178abe38ba7","76736415-9cd4-405e-92cc-36ef7fd42af7","35c2b473-7820-47de-b4e4-04001621ad86","c59c055e-e32d-4a75-9637-672fc770456a","927d26d8-a163-40cc-b8c0-95aae0d4c11e","9d09f6b8-402d-4023-8277-d73ef25bfadb","439e0c29-cea7-411a-8c43-f45fa2151183","d6ec245c-cddd-440e-b0b1-81330cb4a693","830701d2-8642-447e-9b42-41bc8cf0df9a","9a6bd000-39e6-4336-9bce-bfc1e0e4f59f","85770327-8f9d-464e-b0c1-5b8e9959e881","4867da7c-1548-4c15-afe2-105d99fca78c","34df3977-43be-4bcb-a7d8-89ef602f253d","7396298f-9fa6-48de-bc19-f7a13bd5ba35","44ee4609-b70a-4577-9728-a9d62330a30e","2c3e349c-e1ea-4089-b4af-20ba6836c694","250c35ee-2fa5-4eb9-b0eb-c7e46c240f3f","e4091305-7e34-41c2-b2e0-7eb6543f4710","02beaf98-46f4-4de2-a54b-9c6369d5409e","d6a2cc8c-7689-4cd5-802d-64373cf7ce8e","36e2df71-8508-4161-b4e2-cefb95aa211e","dafcf971-afd9-4346-a02a-198a71c4fd1f","813ff5ba-c59d-4597-98a9-a349a4b4008a","09c278d6-282b-4553-b1a3-0ecc88adb1ae","e578ce9a-42cf-4124-bc61-c6eb083de860","c25d1c6a-0ff7-4fce-9a3b-6f0d8669f75b","deb12fde-ed41-4923-970c-b8f29dbaea2e","8d3de27b-fb2f-40a8-9527-7c20df05cc8d","00ea135f-a479-45e1-a548-1f22f49ff99b","2bdd0d05-3d1f-4d51-a699-9e69435aab0c","8c371dbd-1a3c-402e-aa75-331025962d7b","83d0a451-567a-4e25-895a-62ead41abb09","310a39f7-be67-47aa-a92e-178da5267ee4","27e68f03-e28a-465e-a81f-336307432807","9f020f1c-ed8e-43fe-a4a0-1ba5c1b005e4","3348bfc5-29f4-4a7d-bbab-72c173fc43f2","24c2d68c-ea31-430c-a60c-718c61628680","bfc49a80-d536-48df-a7bb-b6e6b76a865f","6f5ce424-89c3-4459-ae53-a4945b232dae","c5906279-6c27-40e9-81e0-b440b781dddd","cadf74c9-8649-4b86-9eee-c1484a480745","460843c7-1b6a-4089-8f59-3413e3a5b6f4","6fae06c8-6ad4-47ba-82dc-8af74c6f6834","0e67e333-1728-4aa8-ac78-78a80bfaf00c","f04f5325-8bef-4a11-8dd1-7aee77bd888b","e3fa9fd5-10c3-4e52-88ae-9cb554776ba5","c9d27ef3-e2d0-4f15-9b26-76c6a0ef5c76","01f003ec-b90a-426b-b4f3-963bdb77a0db","4af52f7e-86d4-439f-9ff4-e11717f1c78f","8e76bce7-7c70-4854-aabc-ba8772740776","01fefbbd-9750-4fdd-a775-ccc4b2f43ea8","d77b6817-b98c-4827-a163-f4bfc77b5785","cf30353f-7429-4e89-b992-67b7dbe6ecca","a9056d36-db54-4e74-855c-6749a363dd21","6e424ac3-047a-4b53-b527-0d3689f94f3d","6eaa925a-29af-4359-9560-b8347e47f6fe","92b29e7d-c8ba-4cf2-a42c-f7e885704f63","32fbf9b8-4d95-4c94-9c0d-4ade7df6f586","f579b995-1c59-47d0-aca2-0d5c7b7802d9","4fad536a-fbdb-4acd-8e98-c71f64a8c88d","52d017d6-c4f9-4250-b478-b587d0ab6130","328ceba1-e265-457a-882a-41bbbb0e13e7","f281bde8-1b22-455f-ad21-843533f32437","bc5feb55-c4d3-4f3c-b07f-d160e1d4fb69","53368c52-10b3-4fa8-81d9-d6dca66bdd8b","d7d8b44d-0d19-421e-b3b4-4cb27442e225","75748896-5a01-4af3-8ff1-e63a8448acf6","7f1895e0-ba4e-48ac-85fc-8f8491b8d136","a504ed15-cddc-408f-8521-f302c6013c59","4aeb7590-be76-4ed6-bf30-339680701d77","4b9f4739-40d3-42c2-9868-605478b8dfb7","90bedd71-d96a-4b6a-a8eb-b783151461e6","4b9b3c6f-43c0-4652-9e0c-c308dc5bd091","89194e22-7505-4e71-9089-b2b21473ae2c","6efa3aeb-a5e6-4deb-9995-12bdee1bc77c","813736a0-b2f8-4998-b526-a0702f07f3f7","d99ec63a-e805-40a6-bb2f-c15a589241e0","269bb4b1-693f-4e47-844b-f181b6c92137","3bb69b37-9033-4507-8777-1a290c2074cb","5b31bc69-877b-41d5-a9c5-94460219ca5b","55258282-a6c6-4a33-afbf-70a927aa4c7a","1b74ea0a-9cd0-4f35-8070-cbed478058b1","91f94047-dcef-4d55-a243-9222d57dea3c","626a046b-e7ad-4795-af3a-9676745688b1","cd8e1b6b-7c3a-4e27-8473-c927becc83e8","2c76610c-703f-4246-9937-d21590f8dfff","ec844790-40e3-4651-8ac8-0263bf457b50","229e1236-0e31-4ca9-87a9-14566d3eb47e","805ed1ef-3805-4d0a-a165-9113872dd4d9","3f8bd200-0916-427d-9faa-fc20e4e17491","3dc84eb4-3ca6-44e8-80b8-85a74f989a5f","ab72f8f7-2e66-4adc-8056-5034b9417e87","ffd13238-71af-4015-8cb7-a633ead39d75","cc0f64ab-f56d-4dae-87e9-b77931ce4b7c","2007f60f-317f-4c63-9d0a-a9fec1968026","0af9b723-7a50-4db6-88d3-ca9eac2521d1","b1e3b467-7928-44ee-b131-d4689d2c9fbb","64de2a69-5822-47e2-affb-0138152703a2","003222f5-d07f-4347-a61b-bcabb3b852c1","66ed0ce7-e2b1-4c7a-bd7a-6e1901de2400","397ab7e2-065b-47c4-87d1-1b3119d20e7d","e96547f7-1f3d-42b8-a4ca-9bfbf2c0728e","36cd4db0-a61a-4b36-bbb0-0f87d0a7b7e0","00e361f1-9021-450e-bf35-fe48f1fb6844","ce6bbda4-1b44-44fa-983e-e5f37b89895b","893226e4-19a2-4c57-ae1e-4fa8cb6444d6","3d83c035-73ba-40f9-b4af-664e5d60daa6","c27a8223-bf18-46b9-8bb3-c4f7c5d11586","cb8dd03f-cd83-4a9e-87f4-addbd319d7d1","917abdc4-674d-4044-9f45-43926c460117","a949615a-e37c-404f-997d-ec150026e00a","1844b272-eaef-4856-8758-ea1c232cf5f0","ec52b635-a421-44fe-97b4-11d14fd5611f","90b6c626-f5a5-41b1-8bbb-cb73df20b253","38396723-b8f8-45f8-8c72-429f9ca72d10","4df9ffb7-5b28-4368-b009-89dcaaffe483","d1a3e625-464c-4d62-ad96-7ecdefea18dc","e1ed46a9-dfda-4716-9ad1-95b9b641ca71","6f6b1fb3-20e8-464e-8748-26567a74687f","340032de-aa3f-4e59-94dc-22da4acbf2df","ee92d25f-a687-4487-8bf7-6f93b037b6d8","8adb3e45-7a66-4197-862d-3e8cc30698f4","4cd0eced-e273-46c2-84f5-a7efd7fbdd2f","82be252e-5184-44cd-a91b-a7d6ffdefac6","bea8efd0-61d7-495b-a255-5c1f40753cf7","12a6eaa5-30f7-419b-aee7-1be2dbc7278c","75db54d0-46ad-43b1-8ef0-7556ce0e9069","89ba9061-3275-4d76-966f-11691fdfd72f","0eb824c6-f768-47bc-9204-d94dbb912c6e","09f3541c-8edb-4603-9bc3-02bd22cd7836","b13cc3bd-a0a3-4b61-b482-63051d7804b5","b2b10be2-1b2f-4a48-a453-532657bd8e92","a00ebb82-58f2-4b40-89ee-a65be3befabf","6d1f21ba-36cf-4c90-9ecb-d5e377942f3a","50a76940-a26e-443a-b752-1412855e6ad7","4c0f8e8c-3967-43ab-a0a8-a3a8ae837714","555c9896-0c2d-4af7-a951-1d81f051de2e","751d20c2-e2be-4e61-921a-adb553651c8c","8e0ffb71-86cb-46bf-abf2-720dcb4378f9","53da1632-5152-4b4f-b440-19b82802360b","30fa18a6-609e-4f5b-af3d-31906c46fe23","3afd60d5-3ce7-431a-b812-2c836b7596a3","dd2f1d05-d4ef-48a0-899c-10fe0346a447","ac411712-ee48-4589-828d-b4e5827efc17","0c5be7d7-cfcf-417b-824a-1a280254a58e","35c18cd6-99a8-47f3-91ee-40dbfec922fa","017372b2-9d34-4118-ad13-9b8e15c30ebd","035cfcde-4292-4905-82b2-6517e58a28b9","42a8570d-5be6-4be4-9ca3-0569f54863bf","5f103e1f-2659-4c6a-bb30-705d2dae0774","811aca42-41c0-4f83-9e08-e795d7a5f803","7643a79b-68c8-46af-ae10-f089cb1ae62b","6e5d9018-2dc0-4dc7-802c-be95d99f1660","bd0b93b9-a0e9-4582-a164-98acdc7a5b45","ecdfe65a-28ee-46d2-a82b-99573e3dd63d","56dd4a06-5073-46d2-8aca-8e37d90e5610","1f8febec-2e84-4be2-a67d-7b5165845a4b","ee67a0e4-8343-4dd6-9636-9504cae6c573","eabf4d1f-9a77-441f-88fb-de9e9e0dc26e","56ba9c1f-2a28-4d05-910c-e89fb051327d","07ffa801-adfb-41f3-809b-87f69ae9e9cd","62f63581-5683-49a3-8812-32e2de74a6a6","f01bdcc5-d573-4790-b605-988df0f3a5ea","e404919f-5dda-4fc3-a28f-6550e70cee12","cee1de64-79f4-45b4-85d5-1ffae9624a8e","86ecfb21-c0ed-42cb-864c-83890d49cb51","27fa9add-6ec7-433a-88c9-58279f5055c3","24c31e38-d546-423f-b3cb-a0533e711d02","6e87073b-2877-44d1-9df7-2dd266bb35e3","d6367cec-2e43-4558-882d-fb9a00545fef","172fd543-704b-489a-8d2e-7d1255f51bef","8f27f9ff-57f2-4c07-ad65-55c7f7f7501f","24f220ca-372b-4003-8e74-13291220c778","e16c2241-0f08-4946-908e-c5e6612b0a8c","2021f38b-f367-4f6c-8232-73387a4dcfb6","b40e41dc-6c0f-4d74-b3ad-3df012f49b01","5759d5ff-246c-4daf-85f3-7fc9884a4bf7","b89fffe8-2e2d-4574-84e1-f81b26df5c1e","2bfc9604-0e06-4ff2-90cf-c382d6bf341b","2e568628-70b1-4f35-934e-81ea4263d0e8","3d8c8d33-f904-41f7-a3ff-b6272c633079","9aefc3b4-f172-4917-b1c7-495c26ec37f9","4453c56e-831c-4203-83fc-9736e276b7dc","6239e7bb-e6a6-4cb4-b4fa-236035bad7f7","95dafcd5-6243-4838-bea1-8e19b0596f6f","34d8ae09-8161-49ec-ae2d-c188c477bb90","cb2a5d30-074f-4c07-97b5-61147e0ea504","e950a58c-0d6f-42c3-8225-9e7adc5d4182","bfe1c963-57ad-4ed2-a9f9-65a3e65f61fd","4ba67e59-362e-4fee-9a67-da423ceefa54","6e41b1fc-a49b-491c-a312-13578c137ab4","037b290e-c8e2-4985-9859-83c40b32b47a","ed447931-f637-4b99-ad61-a2d9d6292ed9","46bcda2b-ec7a-47cc-bcd4-255bb39d310d","61430569-a0c3-4804-a0a3-088135cbbf3e","8e9658b3-1879-43ee-8dd0-aa453db5102d","d8d61f33-8960-4603-849b-b4d1f13a6d36","ece03bf4-b8b2-477a-abe6-125ed58de706","e7bd67f9-1c39-4ac0-b9fe-3441fa74bc14","1ac86639-060b-4e5d-8801-5dd0a40743ff","3ebbe91c-2198-4cd8-8558-ca0b7b47464f","c3762916-2f17-40e0-bd88-12b9442756fd","fe341c1f-ce4e-4845-a24a-802d106b1c80","b5bc1d11-c24d-4523-b371-22c3ee0c4253","0c017ea5-219e-4212-bfdf-89f2ea88187f","39365f4f-a881-461b-97e5-d9aa4ff49498","37f70389-a5e2-4fb8-840f-8cfe940662ef","5ab11760-87f6-4b8a-ae84-206e92aa9009","2486c8b2-de46-4f07-8df9-00ac5080303e","453e1a27-0815-46a0-a5ad-b55267008588","a91e6b04-d782-4974-b523-6c4519a54f50","2c2559b7-77fa-4a0b-877b-2b9769a0caab","ff21f4c6-5ca3-4bb6-b795-aeb1c5b2fe06","845cb0c6-34d2-46fe-9d44-adc3dc124c80","64917ef4-eb94-4a23-a8dc-cb07d7756103","6c5d4d64-558f-4925-8168-b1a96613b0ad","ffb3e282-814e-4b16-a707-5efb54961ba7","7ea58f0d-22f4-4c96-8188-42319c1509ae","1e371f92-dae2-43d6-b029-3d4d1ac8acd9","47a3e557-3e63-45f6-beeb-f7f767589a83","d6070391-2f76-412f-b5a5-bccbfcafc4e5","a96635d9-4dfb-4970-9671-b8f64a5c080c","2238e3ac-7da8-4c47-a13f-854c0576fbd4"]);function i(e){return o.has(e.id)}},95807:(e,t,n)=>{n.d(t,{Hl:()=>r,Sl:()=>i});var o=n(1898);function i(e,t){if(!(0,o.$K)(t)||"production"===e)return t;const n=`notion-${e}-`;return t.startsWith(n)?t:`${n}${t}`}function r(e){return e&&e.startsWith("//")?`https:${e}`:e}},94826:(e,t,n)=>{n.d(t,{EY:()=>M,I$:()=>A,M2:()=>B,RW:()=>R,Uw:()=>P,ZB:()=>x,iV:()=>d,uw:()=>E,z6:()=>D});var o=n(9291),i=n(53965),r=n(7032),a=n(1898),s=n(18265),l=n(19584),c=n(15070);const d={headers:{authorization:{prefix:"Bearer"},hmac:!1},body:{path:["event"]},urlValidator:function(e){return Boolean((0,s.yn)(e))}},u=(0,o.defineMessages)({nightfall:{id:"temporaryWebhookIntegrationConfig.taglines.nightfall",defaultMessage:"Simplify security and compliance with Nightfall AI"},panther:{id:"temporaryWebhookIntegrationConfig.taglines.panther",defaultMessage:"A SIEM built for speed, scale, and flexibility"},sumologic:{id:"temporaryWebhookIntegrationConfig.taglines.sumologic",defaultMessage:"Secure and protect against modern threats with cloud-native log analytics"},splunk:{id:"temporaryWebhookIntegrationConfig.taglines.splunk",defaultMessage:"The unified security and observability platform"},datadog:{id:"temporaryWebhookIntegrationConfig.taglines.datadog",defaultMessage:"Detect, investigate, and automate response to threats at any scale"},polymer:{id:"temporaryWebhookIntegrationConfig.taglines.polymer",defaultMessage:"Protect sensitive data across cloud apps and reduce the risk of exposure"},onna:{id:"temporaryAdminIntegrationConfig.taglines.onna",defaultMessage:"Connect. Find. Act."},hanzo:{id:"temporaryAdminIntegrationConfig.taglines.hanzo",defaultMessage:"Manage Risk Everywhere Work Is Done"},aware:{id:"temporaryAdminIntegrationConfig.taglines.aware",defaultMessage:"Secure Your Digital Workplace. Drive Growth. Scale AI."},drata:{id:"temporaryAdminIntegrationConfig.taglines.drata",defaultMessage:"Drata tagline"},drataStaging:{id:"temporaryAdminIntegrationConfig.taglines.drataStaging",defaultMessage:"Drata (Staging) tagline"},metomic:{id:"temporaryAdminIntegrationConfig.taglines.metomic",defaultMessage:"Metomic integration tagline"},custom:{id:"temporaryAdminIntegrationConfig.taglines.custom",defaultMessage:"Custom webhook integration that only requires a destination URL."}}),p={id:"a2768733-a1f9-4174-84fa-40a9ff2053d7",name:"nightfall",icon:"/images/external_integrations/nightfall-logo.svg",website_url:"https://www.nightfall.ai/",signupUrl:"https://www.nightfall.ai/integrations/notion",privacy_policy_url:"https://www.nightfall.ai/privacy",terms_of_use_url:"https://www.nightfall.ai/terms",developer_name:"Nightfall AI",installation_info_url:void 0,type:"dlp",tagline:u.nightfall,webhookUrl:"https://notion.nightfall.ai/notion/v1/event",customization:{headers:{hmac:!0}},allowedBotCapabilities:{webhooks:!0,read_content:!0,update_content:!0,read_comment:!0,insert_comment:!0,read_user_without_email:!0,read_user_with_email:!0},allowedEndpoints:["public_getPage","public_getPageProperty","public_getBlock","public_listBlockChildren","public_getDatabase","public_getSelf","public_updatePage","public_updateBlock","public_deleteBlock","public_updateDatabase","public_listComments","public_createComment","public_deleteComment","public_updateComment","public_getComment","public_unsharePageFromWeb","public_removeGuestsFromPage","public_getUser","public_external_deleteExternalBot"],acceptsSecretToken:!1,integrationGalleryUrl:"https://www.notion.so/integrations/nightfall-ai",redirectUri:"https://app.nightfall.ai/dashboard"},m={id:"fb50a39e-955a-4b9c-9ffb-49587de2a79c",name:"panther",icon:"/images/external_integrations/panther-logo.png",website_url:"https://panther.com/",signupUrl:"https://panther.com/product/request-a-demo/",privacy_policy_url:"https://panther.com/privacy-policy/",terms_of_use_url:"https://panther.com/terms-of-service/",developer_name:"Panther",installation_info_url:void 0,type:"siem",customization:{headers:{hmac:!0},urlValidator:function(e){if(!e||!(0,s.yn)(e))return!1;const t=new URL(e);if("https:"!==t.protocol)return!1;if(!t.pathname.startsWith("/http/"))return!1;const n=t.pathname.replace("/http/","");return!!(0,r.t)(n)}},tagline:u.panther,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!0,integrationGalleryUrl:"https://www.notion.so/integrations/panther"},f={id:"3ecda536-3b09-4218-a756-bda416c512d7",name:"sumologic",icon:"/images/external_integrations/sumo-logic-logo.jpeg",website_url:"https://www.sumologic.com/",signupUrl:"https://www.sumologic.com/sign-up/",privacy_policy_url:"https://www.sumologic.com/privacy-statement/",terms_of_use_url:"https://www.sumologic.com/terms-conditions/",developer_name:"Sumo Logic",installation_info_url:void 0,type:"siem",tagline:u.sumologic,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!1,integrationGalleryUrl:"https://www.notion.so/integrations/sumo-logic",customization:{urlValidator:function(e){if(!e||!(0,s.yn)(e))return!1;const t=new URL(e);return"https:"===t.protocol&&(!!t.hostname.endsWith("sumologic.com")&&!!t.pathname.startsWith("/receiver/v1/http/"))}}},g={id:"ff522b0f-e688-4986-9b7d-255627316f73",name:"splunk",icon:"/images/external_integrations/splunk-logo.jpeg",website_url:"https://www.splunk.com/",signupUrl:"https://www.splunk.com/en_us/talk-to-sales.html",privacy_policy_url:"https://www.splunk.com/en_us/legal/privacy/privacy-policy.html",terms_of_use_url:"https://www.splunk.com/en_us/legal/terms/terms-of-use.html",developer_name:"Splunk",installation_info_url:void 0,integrationGalleryUrl:"https://www.notion.so/integrations/splunk",customization:{headers:{authorization:{prefix:"Splunk"}},body:{path:["event"]},urlValidator:function(e){if(!e||!(0,s.yn)(e))return!1;const t=new URL(e);if(!["http:","https:"].includes(t.protocol))return!1;let n=t.hostname;return!(!n.startsWith("http-inputs")||!n.endsWith(".splunkcloud.com"))&&(n=n.replace("http-inputs","").replace(".splunkcloud.com",""),!(n.length<2||!n.startsWith("-")&&!n.startsWith("."))&&!!["/services/collector/raw","/services/collector/event"].includes(t.pathname))}},type:"siem",tagline:u.splunk,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!0},h={id:"97d68716-a483-4472-8fa9-da26215d721a",name:"datadog",icon:"/images/external_integrations/datadog-logo.png",website_url:"https://www.datadoghq.com/",signupUrl:"https://www.datadoghq.com/free-datadog-trial/",privacy_policy_url:"https://www.datadoghq.com/legal/privacy/",terms_of_use_url:"https://www.datadoghq.com/legal/terms/",developer_name:"Datadog",installation_info_url:void 0,type:"siem",integrationGalleryUrl:"https://www.notion.so/integrations/datadog",customization:{headers:{hmac:!0}},oauth:{accountInfoPropertyNames:{accountId:"dd_oid",accountName:"dd_org_name"},usePKCE:!0,apiDomainsByRegion:{"https://app.datadoghq.com":"api.datadoghq.com","https://us3.datadoghq.com":"api.us3.datadoghq.com","https://us5.datadoghq.com":"api.us5.datadoghq.com","https://app.datadoghq.eu":"datadoghq.eu","https://app.ddog-gov.com":"ddog-gov.com","https://ap1.datadoghq.com":"ap1.datadoghq.com"},tokenPath:"/oauth2/v1/token",apiKeyPath:"/api/v2/api_keys/marketplace"},tagline:u.datadog,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!1},v={icon:"/images/external_integrations/polymer-logo.jpeg",website_url:"https://www.polymerhq.io/",signupUrl:"https://www.polymerhq.io/request-demo/",privacy_policy_url:"https://www.polymerhq.io/privacy/",terms_of_use_url:"https://www.polymerhq.io/terms-of-service/",installation_info_url:void 0,type:"dlp",tagline:u.polymer,integrationGalleryUrl:"https://www.notion.so/integrations/polymer",allowedBotCapabilities:{webhooks:!0,read_content:!0,update_content:!0,read_comment:!0,insert_comment:!0,read_user_without_email:!0,read_user_with_email:!0},allowedEndpoints:["public_getPage","public_getPageProperty","public_getBlock","public_listBlockChildren","public_getDatabase","public_getSelf","public_updatePage","public_updateBlock","public_deleteBlock","public_updateDatabase","public_listComments","public_createComment","public_deleteComment","public_updateComment","public_getComment","public_unsharePageFromWeb","public_removeGuestsFromPage","public_listUsers","public_getUser","public_external_deleteExternalBot"],acceptsSecretToken:!1,redirectUri:"https://www.polymerhq.io/"},b={...v,id:"9fb229bb-d287-45de-82f1-7331e99d9c6b",name:"polymer",developer_name:"Polymer",webhookUrl:"https://notion.polymerhq.io/notion/events"},y={...v,id:"1b725b3c-5eda-454d-9b41-0f903de3ba00",name:"polymerDev",developer_name:"PolymerDev",webhookUrl:"https://pilot.qa.polymerhq.io/notion/events"},_={icon:"https://s3-us-west-2.amazonaws.com/public.notion-static.com/3944326d-8881-4093-90f8-63637b1ef75f/metomic.png",website_url:"https://metomic.io/",privacy_policy_url:"https://metomic.io/privacy-policy",terms_of_use_url:"https://metomic.io/terms-and-conditions",signupUrl:"https://metomic.io/",allowedBotCapabilities:{webhooks:!0,read_comment:!0,read_content:!0,insert_content:!0,update_content:!0,read_user_with_email:!0,read_user_without_email:!0},type:"dlp",tagline:u.metomic,allowedEndpoints:["public_getPage","public_getPageProperty","public_getBlock","public_listBlockChildren","public_getDatabase","public_getSelf","public_updatePage","public_updateBlock","public_deleteBlock","public_updateDatabase","public_listComments","public_createComment","public_deleteComment","public_updateComment","public_getComment","public_unsharePageFromWeb","public_removeGuestsFromPage","public_getUser","public_external_deleteExternalBot","public_workspaceSearch","public_listTeamspaces"],acceptsSecretToken:!1,integrationGalleryUrl:"https://www.notion.so/integrations/metomic",redirectUri:"https://metomic.io/",customization:{headers:{hmac:!0}}},S={..._,id:"05d23763-7da5-4fcc-aad4-a147d5034cc3",name:"metomic",developer_name:"Metomic",webhookUrl:"https://integrations-api.metomic.io/notion/webhooks/generic/0188965b-c4f7-589c-45c0-7766857bad32"},w={..._,id:"75b66e0c-be9f-4fc5-bed6-1bc156f91e1c",name:"metomicStaging",developer_name:"Metomic (Staging)",webhookUrl:"https://integrations-api.metomic-staging.io/notion/webhooks/generic/01889547-4e22-1e0b-f363-571468d1b042"},k={id:"7487d286-3fa5-4984-8a62-3aa4c51f50ed",name:"custom",developer_name:"Custom SIEM integration",type:"siem",tagline:u.custom,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!1,integrationGalleryUrl:"https://www.notion.so/integrations"},I=["public_exportPage","public_workspaceSearch","public_getUser","public_listUsers","public_listTeamspaces","public_getPage","public_getDatabase","public_getSelf"],C={workspace_search:!0,workspace_page_export:!0,read_content:!0,read_user_without_email:!0,read_user_with_email:!0,read_teamspace:!0},x={datadog:h,nightfall:p,panther:m,polymer:b,polymerDev:y,metomic:S,metomicStaging:w,splunk:g,sumologic:f,onna:{id:"bb67e6bb-09f3-48fe-a7b2-428665ff20ac",name:"onna",icon:"/images/external_integrations/onna-icon.jpeg",website_url:"https://onna.com/",privacy_policy_url:"https://onna.com/privacy-policy",terms_of_use_url:"https://onna.com/master-subscription-agreement",developer_name:"Onna",type:"ediscovery",tagline:u.onna,integrationGalleryUrl:"https://www.notion.so/integrations/onna",allowedBotCapabilities:C,allowedEndpoints:I,redirectUri:"https://localhost:3005"},aware:{id:"99b8b727-7eee-40f8-af16-de045fb78e15",name:"aware",icon:"/images/external_integrations/aware-icon.png",website_url:"https://www.awarehq.com/",privacy_policy_url:"https://www.awarehq.com/privacy",terms_of_use_url:"https://www.awarehq.com/terms-conditions",developer_name:"Aware",type:"ediscovery",tagline:u.aware,integrationGalleryUrl:"https://www.notion.so/integrations/aware",allowedBotCapabilities:C,allowedEndpoints:I,redirectUri:"https://localhost:3005"},hanzo:{id:"2ebac254-9d38-4c94-b579-0eac7fe0f43c",name:"hanzo",icon:"/images/external_integrations/hanzo-icon.png",website_url:"https://www.hanzo.co/",privacy_policy_url:"https://www.hanzo.co/privacy",terms_of_use_url:"https://www.hanzo.co/privacy",developer_name:"Hanzo",type:"ediscovery",tagline:u.hanzo,integrationGalleryUrl:"https://www.notion.so/integrations/hanzo",allowedBotCapabilities:C,allowedEndpoints:I,redirectUri:"https://localhost:3005"},drata:{id:"04912200-d72b-4f0c-b61f-a192dc6e4a2f",name:"drata",website_url:"https://drata.com/",privacy_policy_url:"https://drata.com/privacy",terms_of_use_url:"https://drata.com/terms",developer_name:"Drata",type:"ediscovery",tagline:u.drata,integrationGalleryUrl:"https://www.notion.so/integrations/",allowedBotCapabilities:C,allowedEndpoints:I,redirectUri:"http://localhost:5000/callback/notion"},drataStaging:{id:"98e6e1b8-ac1b-414a-89b1-09cf4371d326",name:"drataStaging",website_url:"https://drata.com/",privacy_policy_url:"https://drata.com/privacy",terms_of_use_url:"https://drata.com/terms",developer_name:"Drata (Staging)",type:"ediscovery",tagline:u.drataStaging,integrationGalleryUrl:"https://www.notion.so/integrations/",allowedBotCapabilities:C,allowedEndpoints:I,redirectUri:"http://localhost:5000/callback/notion"},custom:k},T=(0,l.m8)((0,a.qP)(x).map((e=>{let[t,n]=e;return[n.id,n]})));function M(e){var t;return null===(t=A(e))||void 0===t?void 0:t.name}function P(e){const t=A(e);return Boolean(t&&"ediscovery"===t.type)}function A(e){if(e)return T[e]}function R(e){const t=A(e);if(t&&("siem"===t.type||"dlp"===t.type))return t}function D(e){return Boolean(A(e))}function E(e){if(!e)return!1;const t=A(e);return!!t&&(0,c.ms)(t.allowedBotCapabilities)}function B(e){const{env:t,integrationConfig:n,webhookUrlToValidate:o}=e;return!!(0,i.TS)({},d,n.customization).urlValidator(o)||"local"===t&&o.startsWith("http://localhost:3005/")}},67175:(e,t,n)=>{n.d(t,{Qf:()=>r,W5:()=>a});var o=n(1898);n(70203);const i={insertText:!0,deleteText:!0,splitTextIntoBlock:!0,splitText:!0,moveTextSliceIntoBlock:!0,moveTextSlice:!0,addAnnotation:!0,removeAnnotation:!0,replaceTextInBlock:!0};function r(e){return Boolean(i[e.command])}function a(e){const{pointer:t,crdtOperation:n}=e,i=n.type;switch(i){case"insertText":return{command:"insertText",pointer:t,path:[],args:n};case"deleteText":return{command:"deleteText",pointer:t,path:[],args:n};case"addAnnotation":return{command:"addAnnotation",pointer:t,path:[],args:n};case"removeAnnotation":return{command:"removeAnnotation",pointer:t,path:[],args:n};case"splitText":return{command:"splitText",pointer:t,path:[],args:n};default:(0,o.t1)(i)}}},7250:(e,t,n)=>{n.d(t,{$A:()=>u,Jq:()=>p,Nv:()=>h,OP:()=>b,j:()=>m,oG:()=>d});n(57658);var o=n(67294),i=n(7032),r=n(74686),a=n(65454);const s={download_desktop_app:!0,download_mobile_app:!0,sign_up:!0,onboarding_show:!0,onboarding_complete:!0,gdpr_consent:!0,create_subscription:!0,subscription_update_plan:!0,subscription_update_billing:!0,subscription_update_billing_email:!0,cancel_subscription:!0,click_upgrade_button:!0,create_space:!0,join_space:!0,leave_space:!0,delete_space:!0,open_support_chat:!0},l=[],c="intercomSettings";function d(e){let{getLocale:t,analyticsSettings:n,deviceId:s,onVisibilityChange:d,cookieService:u}=e;(0,o.useEffect)((()=>{!async function(e){const{getLocale:t,analyticsSettings:n,deviceId:o,onVisibilityChange:s,cookieService:d}=e;if(void 0===n||!n.isIntercomEnabled)return;if(!(await r.ec({service:"intercom",cookieService:d})))return;const u=t().split("-")[0];window[c]={app_id:n.intercomAppId,user_hash:n.intercomUserHash?n.intercomUserHash:void 0,language_override:u},!n.noIntercomUserId&&n.user_id?window[c].user_id=(0,i.cj)(n.user_id):n.user_email&&(window[c].email=n.user_email);o&&(window[c].device_id=(0,i.cj)(o));let p=Promise.resolve();const m=window.Intercom;if("function"==typeof m)m("reattach_activator"),m("update",window[c]);else{const e=function(){e.c(arguments)};e.q=l,e.c=function(t){e.q.push(t)},window.Intercom=e,p=(0,a.ZP)(`https://widget.intercom.io/widget/${n.intercomAppId}`)}s&&(g("onShow",(()=>{s(!0)})),g("onHide",(()=>{s(!1)})))}({getLocale:t,analyticsSettings:n,deviceId:s,onVisibilityChange:d,cookieService:u})}),[t,n,s,d,u])}function u(e){if(v()){const{userId:n,userName:o,traits:i,settings:r}=e;if(!r)return;var t={};o&&(t.name=o);const a={email:r.user_email,user_hash:r.intercomUserHash,...i,...t};!r.noIntercomUserId&&n?a.user_id=n:delete a.user_id,Intercom("update",a)}}function p(e){if(v()){const{companiesData:t}=e;Intercom("update",{companies:t})}}function m(e){const{eventName:t,eventData:n}=e;v()&&s[t]&&Intercom("trackEvent",t,n)}let f=!1;function g(e,t){if(v())Intercom(e,t);else{l.push([e,t])}}function h(e){const{prepopulatedContent:t,waitForCssInsets:n}=e;g("showNewMessage",t),!f&&n&&(f=!0,g("onHide",(()=>n())))}function v(){return"undefined"!=typeof Intercom}function b(){if(v())return Intercom("getVisitorId")}},49902:(e,t,n)=>{n.d(t,{j:()=>s,kI:()=>a});n(57658);var o=n(67294),i=n(66673),r=n(65454);function a(e){let{isEnabled:t,isLoggedIn:n,userId:a,userEmail:l,spaceId:c,sprigConfig:d,userDaysSinceSignup:u,userDomainType:p,isSpaceAdmin:m,spaceMemberCount:f}=e;(0,o.useEffect)((()=>{if(!t||!n||void 0===a||void 0===l||void 0===c||void 0===d||void 0===p)return;if(window.Sprig)return;const e=function(){e._queue.push(arguments)};e._queue=[],e.appId=d.environmentId,window.Sprig=e,window.UserLeap=e,window.Sprig("setUserId",a),window.Sprig("setEmail",l),window.Sprig("setAttribute","SPACE_ID",c),f&&window.Sprig("setAttribute","SPACE_MEMBER_COUNT",f),u>=3&&u<=14&&"professional"===p&&s(m?{name:"trigger-phase-1"}:{name:"trigger-phase-1-1"}),(0,r.ZP)("https://cdn.sprig.com/shim.js")}),[t,n,a,d,l,c,m,p,u,f]);const g=(0,i.D9)(n);(0,o.useEffect)((()=>{g&&!n&&window.Sprig&&window.Sprig("logoutUser")}),[g,n])}function s(e){const t=e.name;if(!window.Sprig)return void console.error("Sprig not loaded, not tracking: ",t);const n="args"in e?e.args:{};window.Sprig("track",t,n)}},80503:(e,t,n)=>{n.d(t,{Aj:()=>r,Pv:()=>d,R6:()=>l,TT:()=>i,br:()=>a,u3:()=>c});var o=n(40654);const i=52,r=45,a=37,s=30;function l(e){return e?a:r}function c(e){return 2*l(e)}function d(e,t,n){return(e&&!t?(0,o.XW)(n):12)+s}},45605:(e,t,n)=>{function o(e){const t={};return e.forEach((e=>t[e]=!0)),t}function i(e){const t=new Set;for(const o of e){var n;if(null!==(n=o.debug)&&void 0!==n&&n.tags)for(const e of o.debug.tags)t.add(e)}return t.size?Array.from(t):void 0}n.d(t,{G:()=>i,o:()=>o})},9163:(e,t,n)=>{n.d(t,{FW:()=>i,eU:()=>o,lR:()=>r});const o={"sprints-onboarding":{steps:[{id:"current-sprint-view-tooltip"},{id:"sprint-task-tooltip"},{id:"complete-sprint-button-tooltip"}]}},i="completed",r="dismissed"},41641:(e,t,n)=>{function o(e){return![".","#","$","[","]"].map((t=>-1!==e.indexOf(t))).reduce(((e,t)=>e||t),!1)}n.d(t,{Z:()=>o})},73123:(e,t,n)=>{n.d(t,{Fi:()=>p,Hz:()=>r,Rh:()=>s,Zj:()=>c,aT:()=>f,ez:()=>a,hx:()=>m,xX:()=>l,y3:()=>u,yM:()=>d});var o=n(9291),i=n(1898);const r=["last_7_days","last_28_days","last_90_days","all_time"],a={last_7_days:7,last_28_days:28,last_90_days:90},s=((0,i.AO)((e=>7===e||28===e||90===e?{true:e}:{false:e})),(0,o.defineMessages)({last_7_days:{id:"spaceAnalyticsUserTab.dateFilter.last7days",defaultMessage:"Last 7 Days"},last_28_days:{id:"spaceAnalyticsUserTab.dateFilter.last28days",defaultMessage:"Last 28 Days"},last_90_days:{id:"spaceAnalyticsUserTab.dateFilter.last90days",defaultMessage:"Last 90 Days"},all_time:{id:"spaceAnalyticsUserTab.dateFilter.allTime",defaultMessage:"All Time"}})),l=(0,o.defineMessages)({last_7_days:{id:"spaceAnalyticsUserTab.dateFilter.lowercase.last7days",defaultMessage:"last 7 days"},last_28_days:{id:"spaceAnalyticsUserTab.dateFilter.lowercase.last28days",defaultMessage:"last 28 days"},last_90_days:{id:"spaceAnalyticsUserTab.dateFilter.lowercase.last90days",defaultMessage:"last 90 days"},all_time:{id:"spaceAnalyticsUserTab.dateFilter.lowercase.allTime",defaultMessage:"all time"}});function c(e,t,n){const o=e||0,i=t||0;return n?o-i:i-o}function d(e,t,n){const o=e||-1,i=t||-1;return n?o-i:i-o}const u=(0,o.defineMessages)({page:{id:"contentAnalyticsHeaderMessages.columnHeader.page",defaultMessage:"Page"},pageId:{id:"contentAnalyticsHeaderMessages.columnHeader.pageId",defaultMessage:"Page ID"},teams:{id:"contentAnalyticsHeaderMessages.columnHeader.teamspace",defaultMessage:"Teamspace"},audience:{id:"contentAnalyticsHeaderMessages.columnHeader.audience",defaultMessage:"Audience"},allViews:{id:"contentAnalyticsHeaderMessages.columnHeader.allViews",defaultMessage:"All views"},uniqueViews:{id:"contentAnalyticsHeaderMessages.columnHeader.uniqueViews",defaultMessage:"Unique views"},createdBy:{id:"contentAnalyticsHeaderMessages.columnHeader.createdBy",defaultMessage:"Created by"},createdAt:{id:"contentAnalyticsHeaderMessages.columnHeader.createdAt",defaultMessage:"Created at"},lastEditedBy:{id:"contentAnalyticsHeaderMessages.columnHeader.lastEditedBy",defaultMessage:"Last edited by"},lastEditedAt:{id:"contentAnalyticsHeaderMessages.columnHeader.lastEditedAt",defaultMessage:"Last edited at"}});const p={num_searches:"numSearches",num_unique_users:"numUniqueUsers",ctr:"ctr"},m={numSearches:"num_searches",numUniqueUsers:"num_unique_users",ctr:"ctr"};function f(e){return e<=1?"1":e<=50?"2-50":e<=100?"51-100":e<=500?"101-500":e<=1e3?"501-1000":e<=5e3?"1001-5000":"5001-plus"}},51454:(e,t,n)=>{n.d(t,{A_:()=>L,Bh:()=>z,D_:()=>l,Dy:()=>K,E:()=>X,Eo:()=>O,Gt:()=>C,I5:()=>m,I8:()=>$,IK:()=>y,LI:()=>U,LN:()=>S,MC:()=>h,Mo:()=>F,Nm:()=>R,Nn:()=>B,O9:()=>u,Qm:()=>a,RJ:()=>b,S1:()=>D,VT:()=>v,Wd:()=>J,Wi:()=>o,XB:()=>j,XP:()=>i,Y6:()=>Z,YO:()=>N,_:()=>Y,_Y:()=>T,ag:()=>te,bF:()=>P,eU:()=>s,eu:()=>E,fQ:()=>x,hT:()=>W,hc:()=>A,iO:()=>_,jM:()=>G,ke:()=>ne,l6:()=>r,lB:()=>H,lI:()=>V,mJ:()=>Q,mK:()=>I,nD:()=>c,ov:()=>w,p8:()=>ee,py:()=>p,sL:()=>g,t8:()=>k,vt:()=>q,wx:()=>f,xP:()=>d,y:()=>M});const o=1,i=2,r=2,a=2,s=3,l=9,c=9,d=30,u=80,p=81,m=83,f=83,g=84,h=84,v=85,b=85,y=85,_=86,S=85,w=85,k=85,I=86,C=86,x=86,T=86,M=86,P=v+2,A=v+2,R=87,D=88,E=89,B=99,F=99,O=99,Z=99,V=100,U=100,L=101,j=102,N=109,z=110,q=111,W=111,H=113,K=200,G=105,$=201,Q=999,Y=9999,J=9999999,X=1e6,ee=1,te=2,ne=4},88642:(e,t,n)=>{n.d(t,{j:()=>l,g:()=>c});var o=n(37850),i=n(74686);let r,a;async function s(e,t,n){if(r)return r;e.planType=t,e.isSalesAssistedPlan=n;const a=(0,o.UZ)();r=a.promise,await async function(e){if(!(await i.ec({service:"zendesk",cookieService:e.cookieService})))return;const t=document.createElement("script");if(t.type="text/javascript",t.async=!0,t.src="https://solve-widget.forethought.ai/embed.js",t.id="forethought-widget-embed-script",t.setAttribute("data-api-key","c895ee24-2c6c-4ed6-a100-3037e65cadda"),t.setAttribute("data-ft-full-name",e.fullName||"Forethought Deflected"),t.setAttribute("data-ft-email",e.email||"forethought@makenotion.com"),e.locale){var n;const o=null===(n=e.locale.split("-")[0])||void 0===n?void 0:n.toLowerCase();o&&t.setAttribute("data-ft-embed-script-language",o)}const o=e.planType||"undefined";"enterprise"===o&&e.isSalesAssistedPlan?(t.setAttribute("data-ft-plan-type","enterprise_free"),t.setAttribute("data-ft-workflow-tag","enterprise_free"),t.setAttribute("initial-intent-id","d5cb32d0-3637-4e8e-87fa-c4ea8d79d45f")):(t.setAttribute("data-ft-plan-type",o),t.setAttribute("data-ft-workflow-tag",o));const r=document.getElementsByTagName("script")[0];return null==r||r.parentNode.insertBefore(t,r),window.addEventListener("message",(e=>{var t,n;"forethoughtWidgetClosed"===(null==e||null===(t=e.data)||void 0===t?void 0:t.event)&&(null===(n=Forethought)||void 0===n||n("widget","hide"))})),new Promise((e=>{t.addEventListener("load",(()=>{var t;null===(t=Forethought)||void 0===t||t("widget","hide"),e()}))}))}(e),a.resolve()}async function l(e){if(a)return a;const t=(0,o.UZ)();a=t.promise,e.isForethoughtEnabled&&await s(e.forethoughtInitializeArgs,e.userHighestPlanType,e.isSalesAssistedPlan),await async function(e){const{locale:t,cookieService:n}=e;if(!(await i.ec({service:"zendesk",cookieService:n})))return;const o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src="https://static.zdassets.com/ekr/snippet.js?key=b9ad856d-6b98-4cf5-a2f6-d96e50557722",o.id="ze-snippet";const r=document.getElementsByTagName("script")[0];return null==r||r.parentNode.insertBefore(o,r),new Promise((e=>{o.addEventListener("load",(()=>{var n=window.zE;n&&(n("webWidget","setLocale",t),n("webWidget","hide"),e())}))}))}(e),t.resolve()}async function c(e){if(await l(e),"undefined"!=typeof Forethought)Forethought("widget","show"),Forethought("widget","open");else{var t=window.zE;if(!t)return;t("webWidget","show"),t("webWidget","open"),t("webWidget:on","close",(function(e){(t=window.zE)&&t("webWidget","hide")}))}}}}]);