"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[1655],{15889:(e,t,o)=>{o.r(t),o.d(t,{AutomationWorkflowEditor:()=>xo,AutomationWorkflowEditorActionSection:()=>po,PlacedButtonBlockEditor:()=>vo,automationActions:()=>i,automationExecutionActions:()=>n});var n={};o.r(n),o.d(n,{ClientExecuteEffectMap:()=>ae,executeClientAutomation:()=>re});var i=o(43627),a=(o(57658),o(21703),o(67294)),r=o(1302),s=o(15145),l=o(2647),c=o(81730),u=o(59786);async function d(e){const{action:t,values:o,context:n}=e,i=(0,u.z)(t.getType());return await i.execute({...n,values:o},t)}var p=o(1898);var m=o(10450),g=o(41432),y=o(35102),h=o(68626),f=o(42875),x=o(21202),S=o(23867),v=o(37850),b=o(7032),C=o(40470),M=o(36610),k=o(952),j=o(98834),P=o(54532),A=o(13084),T=o(19785),w=o(68305),V=o(9953),I=o(52423),F=o(8055),B=o(24677),Z=o(64964),K=o(13447),_=o(6854),R=o(95477),W=o(21100),L=o(27105),D=o(97978),N=o(84210),O=o(33929),E=o(77907),H=o(95802),U=o(80444),z=o(58454),$=o(88923),q=o(6258),G=o(35057),Y=o(92996),Q=o(9291);const J=(0,Q.defineMessages)({genericSuccessMessage:{id:"automations.buttonTrigger.genericSuccessMessage",defaultMessage:"Button automation ran successfully"},createdBlocks:{defaultMessage:"Created {numBlocksDuplicated, plural, one {1 block} other {{numBlocksDuplicated} blocks}} on page",id:"automations.buttonTrigger.createdBlocks"},createdSprintsUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.createdSprints"},updatedSprintsUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.updatedSprints"},createdSprintsLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.createdSprintsLowercase"},updatedSprintsLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.updatedSprintsLowercase"},createdTasksUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.createdTasks"},updatedTasksUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.updatedTasks"},createdTasksLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.createdTasksLowercase"},updatedTasksLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.updatedTasksLowercase"},createdProjectsUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.createdProjects"},updatedProjectsUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.updatedProjects"},createdProjectsLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.createdProjectsLowercase"},updatedProjectsLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.updatedProjectsLowercase"},createdPagesUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.createdPages"},updatedPagesUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.updatedPages"},createdPagesLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.createdPagesLowercase"},updatedPagesLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.updatedPagesLowercase"}}),X=["sprint","task","project","page"],ee={[Y.wW]:"project",[Y.iS]:"task",[Y.zU]:"page",[Y.Fi]:"page",[Y.p$]:"sprint",[Y.GZ]:"page",[Y.nG]:"page",[Y.Be]:"page"};function te(e){const{typedAutomationExecutionSummary:t,numBlocksDuplicated:o,intl:n}=e,i=function(e){const{typedAutomationExecutionSummary:t,intl:o}=e,n=[];for(const a of X){const e=t[a];if(e){const{numPagesCreated:t,numPagesEdited:o}=e;t>0&&n.push({pageType:a,modificationType:"created",numPagesModified:t}),o>0&&n.push({pageType:a,modificationType:"updated",numPagesModified:o})}}const i=n.slice(0,oe).map(((e,t)=>{let{pageType:n,modificationType:i,numPagesModified:a}=e;const r=ne[n][i],s=0===t?r.start:r.append;return o.formatMessage(s,{numPagesModified:a})}));if(i.length>0)return o.formatList(i,{type:"conjunction",style:"long"})}({typedAutomationExecutionSummary:t,intl:n});return i||(o>0?n.formatMessage(J.createdBlocks,{numBlocksDuplicated:o}):n.formatMessage(J.genericSuccessMessage))}const oe=3;const ne={sprint:{created:{start:J.createdSprintsUppercase,append:J.createdSprintsLowercase},updated:{start:J.updatedSprintsUppercase,append:J.updatedSprintsLowercase}},task:{created:{start:J.createdTasksUppercase,append:J.createdTasksLowercase},updated:{start:J.updatedTasksUppercase,append:J.updatedTasksLowercase}},project:{created:{start:J.createdProjectsUppercase,append:J.createdProjectsLowercase},updated:{start:J.updatedProjectsUppercase,append:J.updatedProjectsLowercase}},page:{created:{start:J.createdPagesUppercase,append:J.createdPagesLowercase},updated:{start:J.updatedPagesUppercase,append:J.updatedPagesLowercase}}};var ie=o(85893);class ae{constructor(e){this.environment=void 0,this.clientContext=void 0,this.automationModel=void 0,this.numBlocksDuplicated=0,this.saveTransactionInfos=[],this.undoCheckpointName=void 0,this.getCollectionSchema=async e=>{const t=await this.clientContext.parentRecordStore.loadRecordModel(e.pointer);return t?{value:{collectionSchema:t.getNormalizedSchema()}}:{error:new c.Do({actionId:e.actionId,pointer:e.pointer})}},this.queryCollection=async e=>{const t=await w.tA(this.environment,{source:"automation",parentRecordStore:this.clientContext.parentRecordStore,collectionPointer:e.collection,filter:e.filter,sort:e.sort,limit:e.limit});return C.x.isFail(t)?{error:new c.Pn({actionId:e.actionId,type:t.error.type,message:t.error.message,cause:t.error})}:{value:{blockIds:t.value.blockIds}}},this.saveTransaction=e=>{if(this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.saveTransaction",environment:this.environment,perform:t=>{for(const o of e.operations){const e=(0,q.Kv)(this.clientContext.parentRecordStore,o.pointer);K.applyOperation({store:e,operation:o,transaction:t})}}}),this.saveTransactionInfos.push(e.info),"create_page"===e.info.type)k.W(this.environment,{type:"page",automation_id:this.automationModel.id,from:"button_automation",new_page_id:e.info.pageId,creating_block_id:e.info.pageId});else if("update_pages"===e.info.type){const{editedProperties:t,pageIds:o}=e.info;for(const e of o)for(const{id:o,type:n}of t)M.rv(this.environment,{block_id:e,property:o,property_type:n,from:"button_automation",automation_id:this.automationModel.id},!1)}else(0,p.t1)(e.info);return{value:{}}},this.navigateToPage=e=>{const t=U.default.state.mainEditorCurrentBlockStore;if(!t)return;const o=q.G.createChildStore(t,e.page),n="full_page"===e.openIn?(0,N.ZP)({store:o,fullyQualified:!1,pageVisitSource:s.tY.ButtonAutomation}):(0,N.ZP)({store:t,peekViewBlockId:o.id,peekMode:(0,$.getUrlParamFromPeekMode)(e.openIn),fullyQualified:!1,pageVisitSource:s.tY.ButtonAutomation});F.c4({environment:this.environment,url:n})},this.duplicateBlockChildren=async e=>{if("button_block"!==this.clientContext.type)return{error:new c.iR({contextType:this.clientContext.type})};const t=this.clientContext.blockStore,o=t.getRecordStoreUIParent();if(!o)return{value:{}};let n;"before"===e.insertionPoint?n=!0:"after"===e.insertionPoint?n=!1:(0,p.t1)(e.insertionPoint);const i=q.G.createChildStore(o,e.blockPointer);await i.load();const a=i.getContentStores();n||a.reverse();const s=H.C.findSelectableFromStore(t),l=[],u=this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.duplicateBlockChildren",environment:this.environment,perform:e=>a.map((o=>{const[i,a]=P.Qi({environment:this.environment,stores:[o],transaction:e,addCopyName:!1,deepCopyTransclusionContainers:!1,resolveTemplateVariables:!0,targetSpaceId:(0,S.C)(o.pointer.spaceId),baseUrl:R.default.domainBaseUrl,publicDomainName:R.default.publicDomainName,preferDuplicateLocation:"local",analyticsFrom:"button_automation",useCrdt:t.useCrdt()}),r=i[0];return s&&(n?s.props.onInsertAbove&&l.push(s.props.onInsertAbove({insertStores:[r],transaction:e})[0]):s.props.onInsertBelow&&l.push(s.props.onInsertBelow({insertStores:[r],transaction:e})[0])),{copy:r,onComplete:a}}))}).performResult;return n||l.reverse(),B.Z5({environment:this.environment,stores:l}),await v.Lc(u,10,(e=>e.onComplete)),r.default.afterNextFlush((()=>{for(const e of l){if(A.dM({environment:this.environment,isAtStartOfLine:!1,store:e}))break}})),this.numBlocksDuplicated+=l.length,{value:{}}},this.displayModal=async e=>{z.Z.setState({open:!0,format:e.format,recordStore:this.clientContext.parentRecordStore}),await z.Z.waitUntil((()=>!z.Z.state.open));const t=z.Z.state;let o;return t.open||(o=t.result),o=o??"continue",o},this.initializeTemplateInDatabase=async e=>{const t=(0,b.ZP)(),o=this.clientContext.parentRecordStore,n=q.G.createChildStore(o,{table:x.iU,id:e.templateId});await n.load();const i=q.NW.createChildStore(o,e.collection);return this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.initializeTemplateInDatabase",environment:this.environment,perform:a=>{const r=V.j4({environment:this.environment,transaction:a,inMemoryRecordCache:o.inMemoryRecordCache,type:g.Ti.page,id:t,useCrdt:L.dy({source:"collection_instantiate_template"})});T.zw({parentStore:i,childStore:r,transaction:a}),j.ob({environment:this.environment,store:r,transaction:a,templateStore:n,title:"template",isCreateIn:!1,isKeyboard:!1,from:"automation_actions"}),W.b({environment:this.environment,editorMode:"default",store:r,properties:e.propertyUpdates,transaction:a})}}),this.saveTransactionInfos.push({type:"create_page",pageId:t,collection:e.collection}),{value:{pageId:t}}},this.sendInAppNotification=e=>{throw new Error("Not supported on the client")},this.environment=e.environment,this.clientContext=e.clientContext,this.automationModel=e.automationModel,this.undoCheckpointName=`execute-client-automation-${(0,b.ZP)()}`}getNumBlocksDuplicated(){return this.numBlocksDuplicated}createAndCommitForEffect(e){return K.createAndCommit({...e,undoCheckpoint:this.undoCheckpointName})}}async function re(e){const{clientContext:t,environment:o,onUndo:n,store:a}=e,r=await E.deps.formulas.loader();await t.automationStore.load();const s=t.automationStore.getModel();if(!s)return;const c=t.automationStore.getActionStores().map((e=>e.getModel())).filter(p.$K),u=s.getTriggerType();if("event"===u)return;const g=(0,D.mc)(o),S=(0,G.zt)();(0,l.rg)(g,{actions:c.map((e=>e.getType())),automation_id:s.id,block_id:a.id,context_type:t.type,space_id:s.getSpaceId(),subscription_tier:S,trigger:u});const v=new ae({automationModel:s,clientContext:t,environment:o}),b=(0,y.yf)(t.parentRecordStore.getRecordModel,t.parentRecordStore.loadRecordModel),C=o.currentUser.id;let M;"button_property"===t.type?M=(0,m.dG)({blockPointer:a.getSpaceShardedPointer(),currentUserId:C,userTimeZone:(0,f.r)(),createdById:void 0}):"button_block"===t.type?M=(0,m.io)({currentUserId:C,userTimeZone:(0,f.r)(),pagePointer:t.pageStore.pointer}):"event"===t.type?M=(0,m.R4)({blockPointer:a.getSpaceShardedPointer(),currentUserId:C,userTimeZone:(0,f.r)(),createdById:void 0}):"recurrence"===t.type?"completeSprint"===t.recurrence.type?M=(0,m.NG)({completeSprintActionType:t.recurrence.completeSprintActionType,nextSprintDateRange:t.recurrence.nextSprintDateRange}):"default"===t.recurrence.type?M=(0,m.W7)():(0,p.t1)(t.recurrence):"assistant"===t.type?M={values:[]}:(0,p.t1)(t);const k={automationModel:s,actionModels:c,values:M.values,executeEffectMap:v,executeContextualFormula:async(e,o)=>{if(!o)return{value:{type:"undefined"}};return await r.executeFormulaAsync(o,{values:e.values,handleDataRequest:b,userTimeZone:(0,f.r)(),intl:t.intl,depth:0,visitedProperties:new Set,resultCache:new Map})},handleDataRequest:b,loadRecordModel:t.parentRecordStore.loadRecordModel,userTimeZone:(0,f.r)(),intl:t.intl,depth:0,visitedProperties:new Set,resultCache:new Map,eventTracker:(0,D.mc)(o)},j=performance.now(),P=await async function(e){const{context:t,executeAutomationActionFn:o}=e,{actionModels:n}=t;let i=t.values;const a=o??d;for(const r of n){const e=await a({action:r,values:i,context:t});if(e.error)return e.error;i=i.concat(e.value.values)}}({context:k}),A=Math.trunc(performance.now()-j),T=function(e){const{executionDuration:t,saveTransactionInfos:o}=e,[n,i]=o.reduce(((e,t)=>{let[o,n]=e;return"create_page"===t.type?[o+1,n]:"update_pages"===t.type?[o,n+t.pageIds.length]:void(0,p.t1)(t)}),[0,0]);return{executionDuration:t,createdPageCount:n,updatedPageCount:i,createdOrUpdatedPageCount:n+i}}({executionDuration:A,saveTransactionInfos:k.executeEffectMap.saveTransactionInfos}),w=o.currentUser.id?{id:o.currentUser.id,table:"notion_user"}:void 0,V={...T,automationContextType:t.type,automationId:s.id,spaceId:s.getSpaceId(),userId:null==w?void 0:w.id};if(P){0,h.log({actor:w,data:V,error:P,from:"automationActions",level:"error",type:"AutomationExecutionError"}),(0,l.By)(g,{automation_id:s.id,block_id:a.id,context_type:t.type,error_type:P.type,execution_duration_ms:A,subscription_tier:S,trigger:u});const e=function(e){if("user_cancelled"===e.type)return i.messages.errorUserCancelled;if("query_collection_too_many_items"===e.type)return i.messages.errorQueryCollectionTooManyPages;return i.messages.genericErrorMessage}(P),o=O.default.formatMessage(e);Z.oV({label:o})}else(0,l.Cz)(g,{automation_id:s.id,block_id:a.id,context_type:t.type,execution_duration_ms:A,subscription_tier:S,trigger:u}),h.log({actor:w,data:V,from:"automationActions",level:"info",type:"AutomationExecutionSuccess"}),await async function(e){const{environment:t,saveTransactionInfos:o,clientContext:n,undoCheckpointName:i,numBlocksDuplicated:a,onUndo:r}=e,s=function(e){const{saveTransactionInfos:t,parentRecordStore:o}=e,n={};for(const l of t)if("create_page"===l.type){var i,a;const e=q.NW.createChildStore(o,l.collection).getDatabaseType(),t=(e&&ee[e])??"page",r=(null===(i=n[t])||void 0===i?void 0:i.numPagesEdited)??0,s=(null===(a=n[t])||void 0===a?void 0:a.numPagesCreated)??0;n[t]={numPagesCreated:s+1,numPagesEdited:r}}else if("update_pages"===l.type){var r,s;const e=q.NW.createChildStore(o,l.collection).getDatabaseType(),t=(e&&ee[e])??"page",i=(null===(r=n[t])||void 0===r?void 0:r.numPagesEdited)??0,a=(null===(s=n[t])||void 0===s?void 0:s.numPagesCreated)??0;n[t]={numPagesCreated:a,numPagesEdited:i+l.pageIds.length}}else(0,p.t1)(l);return n}({saveTransactionInfos:o,parentRecordStore:n.parentRecordStore});let l;for(const y of o.slice().reverse()){if("create_page"===y.type){var c;l=q.G.createChildStore(n.parentRecordStore,{table:x.iU,id:y.pageId,spaceId:null===(c=y.collection)||void 0===c?void 0:c.spaceId});break}if("update_pages"===y.type){if(1===y.pageIds.length){var u;l=q.G.createChildStore(n.parentRecordStore,{table:x.iU,id:y.pageIds[0],spaceId:null===(u=y.collection)||void 0===u?void 0:u.spaceId})}else{const e=q.NW.createChildStore(n.parentRecordStore,y.collection);await e.load();const t=e.getParentBlockStore();if(!t)continue;l=t}break}(0,p.t1)(y)}const d=te({typedAutomationExecutionSummary:s,numBlocksDuplicated:a,intl:n.intl}),m=()=>{I.qB({environment:t,namedRevisionId:i}),Z.rN(),r&&r(i)},g=I.hv(i);Z.oV({label:d,right:(0,ie.jsx)(_.wr,{blockStoreToOpen:l,...g?{performUndo:m}:{}})})}({environment:o,saveTransactionInfos:v.saveTransactionInfos,clientContext:t,undoCheckpointName:v.undoCheckpointName,numBlocksDuplicated:v.getNumBlocksDuplicated(),onUndo:n})}var se=o(480),le=o(86628),ce=o(24405),ue=o(65955),de=o(27153),pe=o(98104),me=o(68709),ge=o(73063),ye=o(53437),he=o(58297),fe=o(31278),xe=o(53336),Se=o(26388),ve=o(13148),be=o(95094),Ce=o(37810),Me=o(42402);const ke="https://www.notion.so/help/template-buttons";function je(e){const{handleDismissBanner:t}=e,o=(0,ce.yK)((e=>({banner:{width:"100%",display:"flex",alignItems:"start",backgroundColor:e.accentColors.blue["light"===e.mode?50:300],borderRadius:4,padding:12,fontSize:12,lineHeight:1.5,gap:8},icon:{width:12,color:e.blueColor},bannerContent:{flex:"1 1 auto"},bannerTitle:{fontWeight:Ce.Z.fontWeight.medium},bannerCaption:{color:e.mediumTextColor},closeButton:{borderRadius:"50%"},starIcon:{flex:"0 0 auto",marginBlockStart:3},link:{color:e.text.uiBluePrimary}})),[]);return(0,ie.jsxs)("div",{style:o.banner,children:[(0,ie.jsx)("div",{style:o.starIcon,children:(0,be.p)(o.icon)}),(0,ie.jsxs)("div",{style:o.bannerContent,children:[(0,ie.jsx)("div",{style:o.bannerTitle,children:(0,ie.jsx)(Q.FormattedMessage,{id:"factoryButton.deprecationBanner.title",defaultMessage:"Your buttons just got better"})}),(0,ie.jsx)("div",{style:o.bannerCaption,children:(0,ie.jsx)(Q.FormattedMessage,{id:"factoryButton.deprecationBanner.caption",defaultMessage:"Now you can create, edit and open pages and <buttonsHelpCenterLink>more</buttonsHelpCenterLink>.",values:{buttonsHelpCenterLink:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,ie.jsx)(Me.Z,{href:ke,disableUnderline:!0,style:o.link,children:t})}}})})]}),(0,ie.jsx)(ge.Z,{icon:ve.U,ariaLabel:"closeButton",style:o.closeButton,onClick:()=>t()})]})}var Pe=o(59557),Ae=o(72187),Te=o(12534),we=o(98742),Ve=o(35314),Ie=o(63474),Fe=o(34859),Be=o(68910),Ze=o(9015),Ke=o(35294),_e=o(17501),Re=o(74404),We=o(19471),Le=o(67473),De=o(47453),Ne=o(52275),Oe=o(31945),Ee=o(79131),He=o(32130),Ue=o(61766),ze=o(45452),$e=o(12455),qe=o(73266),Ge=o(31524),Ye=o(70203),Qe=o(78140),Je=o(32163),Xe=o(72495),et=o(72865),tt=o(21273),ot=o(95193),nt=o(745),it=o(40190),at=o(47957);const rt=(0,Q.defineMessages)({codeLabel:{defaultMessage:"Code",id:"automations.AssistantAction.codeLabel"},promptLabel:{defaultMessage:"Prompt",id:"automations.AssistantAction.promptLabel"},humanLabel:{defaultMessage:"User",id:"automations.AssistantAction.humanLabel"},descriptionLabel:{defaultMessage:"Description",id:"automations.AssistantAction.descriptionLabel"}});function st(e){const{currentOption:t,disabled:o,onChange:n}=e,i=(0,Q.useIntl)(),r=(0,Ke.d)(),s=(0,le.qz)(void 0,Ue.Z),l=(0,a.useCallback)((e=>{n&&e!==t&&n(e),s.setState({open:!1})}),[s,t,n]);return(0,ie.jsx)(Oe.ZP,{alignmentToOrigin:Oe.vR.End,buttonPopupStore:s,disabled:o,originGap:0,placementToOrigin:Oe.pO.Bottom,popupType:r,render:()=>(0,ie.jsx)(lt,{currentOption:t,onChange:l}),renderOrigin:e=>(0,ie.jsx)(it.S,{...e,disabled:o,variant:"gray",children:i.formatMessage(ct(t))})})}function lt(e){const{currentOption:t,onChange:o}=e,n=(0,Q.useIntl)(),i=(0,ot.F)({maxWidth:360}),a=["prompt","code"].map((e=>({key:e,render:o=>(0,ie.jsx)(Ne.Z,{...o,checkState:t===e,title:n.formatMessage(ct(e))}),action:()=>null==o?void 0:o(e)})));return(0,ie.jsx)(Qe.Z,{...i,children:(0,ie.jsx)(Je.Z,{initialFocus:0,sections:[{key:0,render:e=>(0,ie.jsx)(Xe.Z,{enableActionSheetTitle:!0,...e}),items:a}],type:Je.i.Vertical})})}function ct(e){switch(e){case"code":return rt.codeLabel;case"prompt":return rt.promptLabel;case"human":return rt.humanLabel}}function ut(e){const{actionStore:t,disabled:o,value:n,onChange:i}=e,a=(0,le.VK)((()=>t.getType()),[t]),r=(0,ce.yK)((()=>({actionTitle:{display:"flex",gap:"0.5em",alignItems:"center",height:"24px"}})),[]);if(!a)return null;const s=(0,u.z)(a);return(0,ie.jsxs)("div",{style:r.actionTitle,children:[(0,ie.jsx)(Q.FormattedMessage,{...s.display.name}),(0,ie.jsx)(st,{currentOption:n,disabled:o,onChange:i})]})}var dt=o(51592),pt=o(41301);function mt(e){return!e.pathIsDead()&&e.isDefined()}function gt(e){if(!(0,p.$K)(e))return[];return e.getTemplatePageStores().filter((e=>mt(e)))}var yt=o(39477),ht=o(84619),ft=o(76798),xt=o(21396),St=o(8808);function vt(e){const{actionStore:t,currentValue:o,contextStore:n,onChange:i,disabled:r,dropdownButtonStyle:s,errorMessage:l,skipVariables:c}=e,u=(0,le.qz)(void 0,Ue.Z),d=(0,le.VK)((()=>o&&"collection"===o.type?q.NW.createChildStore(n.context.parentRecordStore,o.collection):void 0),[o,n.context.parentRecordStore]),p=(0,le.VK)((()=>{if(t&&o&&"variable"===o.type)return n.getContextValueForActionById(t.id,o.id)}),[t,o,n]),m=(0,a.useCallback)((e=>{"collection"!==e.type&&"variable"!==e.type||(i(e),u.reset())}),[i,u]),g=(0,a.useCallback)((()=>u.reset()),[u]),y=(0,Ke.d)(),h=(0,it.d)({errorMessage:l,hasValue:Boolean(d||p)});return(0,ie.jsx)(Oe.ZP,{buttonPopupStore:u,popupType:y,alignmentToOrigin:Oe.vR.End,placementToOrigin:Oe.pO.Bottom,originGap:0,disabled:r,renderOrigin:e=>(0,ie.jsx)(it.S,{...h,...e,disabled:r,style:s,children:d?(0,ie.jsx)(ft.Z,{store:d}):p?(0,ie.jsx)(xt.F,{format:ht.lo.Medium,isSingle:!0,value:p}):(0,ie.jsx)(Q.FormattedMessage,{id:"automations.databasePicker.buttonPlaceholder",defaultMessage:"Select database"})}),render:e=>(0,ie.jsx)(St.L,{actionId:null==t?void 0:t.id,automationContextStore:n,onChange:m,onClose:g,selectedTarget:o,skipPages:!0,skipVariables:c})})}var bt=o(53965),Ct=o(40071);function Mt(e){const{collectionStore:t,currentTemplateId:o,onChange:n,disabled:i,errorMessage:a,dropdownButtonStyle:r}=e,s=(0,se.O7)(),{device:l}=s,c=(0,le.VK)((()=>{if(!t)return;if(o){const e=q.G.createChildStore(t,{id:o,spaceId:t.getSpaceId(),table:x.iU});if(!e.pathIsDead())return e}const e=t.getDefaultTemplatePageStore();return e&&!e.pathIsDead()?e:void 0}),[t,o]),u=(0,Ke.d)(),d=(0,it.d)({errorMessage:a,hasValue:!0}),p=(0,le.VK)((()=>gt(t)),[t]),m=Boolean(o);return(0,ie.jsx)(Oe.ZP,{popupType:u,alignmentToOrigin:Oe.vR.End,placementToOrigin:Oe.pO.Bottom,originGap:0,disabled:i,renderOrigin:e=>(0,ie.jsx)(it.S,{...d,...e,disabled:i,style:{...r,minWidth:50},children:c&&(m||mt(c))?(0,ie.jsx)(ft.Z,{store:c}):(0,ie.jsx)(Q.FormattedMessage,{id:"automations.templatePicker.buttonPlaceholder",defaultMessage:"Empty"})}),render:e=>{const o=(0,ot.U)({device:l,width:280});return(0,ie.jsx)(Qe.Z,{...o,children:t&&(0,ie.jsx)(kt,{collectionStore:t,templatePageStores:p,parent:e,onChange:n})})}})}function kt(e){const{collectionStore:t,templatePageStores:o,parent:n,onChange:i}=e,r=(0,se.O7)(),{device:s}=r,l=(0,le.VK)((()=>t.getDefaultTemplatePageStore()),[t]),c=o.map((e=>{const o={key:e.id,render:o=>(0,a.createElement)(Ct.Z,{...o,key:e.id,isOverlay:!0,collectionStore:t,canConfigureCollection:!1,templateStore:e,isMobile:s.isMobile,locked:!0,isDefault:l===e,onCancelClick:()=>{},draggable:!1}),action:t=>{i(e.id),n.close()}};return o})),u={key:"empty",render:e=>(0,a.createElement)(Ct.Z,{...e,key:"empty",isOverlay:!0,collectionStore:t,canConfigureCollection:!1,templateStore:void 0,isMobile:s.isMobile,locked:!0,onCancelClick:()=>{},draggable:!1}),action:e=>{i(void 0),n.close()}};return(0,ie.jsx)(Je.Z,{type:Je.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,ie.jsx)(Xe.Z,{...e,title:(0,ie.jsx)(Q.FormattedMessage,{id:"automations.templatePicker.menuHeader",defaultMessage:"Select a template"})}),items:bt.oA([...c,l?void 0:u])}]})}function jt(e){const{actionStore:t,automationContextStore:o,disabled:n,errorMessage:i,onChange:a,value:r}=e,s=(0,ce.yK)((()=>({b:{fontWeight:Ce.Z.fontWeight.medium},picker:{display:"inline-flex",minWidth:50},span:{flex:0},title:{display:"inline-flex",minWidth:50}})),[]),l=(0,le.VK)((()=>{let e;if("collection"===(null==r?void 0:r.type)){const o=t.getRecordModel(r.collection);e=null==o?void 0:o.getDatabaseType()}return(0,dt.sN)(e)}),[t,r]);return(0,ie.jsxs)("div",{style:s.title,children:[(0,ie.jsx)(Q.FormattedMessage,{defaultMessage:"<span>Add <b>{itemType}</b> to </span>{collectionPicker}",id:"automations.CreatePageActionV2.header.title",values:{b:e=>(0,ie.jsx)("b",{style:s.b,children:e}),collectionPicker:(0,ie.jsx)("div",{style:s.picker,children:(0,ie.jsx)(vt,{actionStore:t,contextStore:o,currentValue:r,disabled:n,dropdownButtonStyle:{height:"auto",marginBlock:-6,marginInline:-5,maxWidth:"auto",paddingBlock:6,paddingInline:5},errorMessage:i,onChange:a,skipVariables:!0})}),itemType:l,span:e=>(0,ie.jsx)("span",{style:s.span,children:e})}})," "]})}function Pt(e){const{collectionStore:t,disabled:o,errorMessage:n,onChange:i,value:a}=e,r=(0,ce.yK)((()=>({picker:{display:"inline-flex",minWidth:50},span:{flex:0},title:{display:"inline-flex",minWidth:50}})),[]);return(0,ie.jsx)("div",{style:r.title,children:(0,ie.jsx)(Q.FormattedMessage,{defaultMessage:"<span>as </span>{collectionTemplatePicker}",id:"automations.CreatePageActionV2.header.template",values:{collectionTemplatePicker:(0,ie.jsx)(Mt,{collectionStore:t,currentTemplateId:a,disabled:o,dropdownButtonStyle:{height:"auto",marginBlock:-6,marginInline:-5,paddingBlock:6,paddingInline:5},errorMessage:n,onChange:i}),span:e=>(0,ie.jsx)("span",{style:r.span,children:e})}})})}var At=o(94184),Tt=o.n(At),wt=o(1230),Vt=o(41490),It=o(15201),Ft=o(55217),Bt=o(79954);const Zt=(0,Q.defineMessages)({aboveMenuItemLabel:{id:"automations.DuplicateBlocksAction.aboveButtonLabel",defaultMessage:"Above button"},aboveTitle:{id:"automations.DuplicateBlocksAction.aboveTitle",defaultMessage:"above button"},belowMenuItemLabel:{id:"automations.DuplicateBlocksAction.belowButtonLabel",defaultMessage:"Below button"},belowTitle:{id:"automations.DuplicateBlocksAction.belowTitle",defaultMessage:"below button"},title:{defaultMessage:"Insert blocks {insertionPicker}",id:"automations.DuplicateBlocksAction.title"}}),Kt={before:{icon:(0,Vt.F)({width:16}),key:"before",menuItemLabel:Zt.aboveMenuItemLabel,title:Zt.aboveTitle},after:{icon:(0,wt.H)({width:16}),key:"after",menuItemLabel:Zt.belowMenuItemLabel,title:Zt.belowTitle}},_t=Kt.after;function Rt(e){const{currentOption:t,disabled:o,onChange:n}=e,i=(0,Q.useIntl)(),r=(0,ce.yK)((e=>({button:{color:e.text.primary,fontWeight:Ce.Z.fontWeight.medium,height:"auto",marginBlock:-6,marginInline:-5,paddingBlock:6,paddingInline:5}})),[]),s=(0,Ke.d)(),l=(0,le.qz)(void 0,Ue.Z),c=(0,a.useCallback)((e=>{n&&t.key!==e&&n(e),l.setState({open:!1})}),[l,t,n]);return(0,ie.jsx)(Oe.ZP,{alignmentToOrigin:Oe.vR.End,buttonPopupStore:l,disabled:o,originGap:0,placementToOrigin:Oe.pO.Bottom,popupType:s,render:()=>(0,ie.jsx)(Wt,{currentOption:t,onChange:c}),renderOrigin:e=>(0,ie.jsx)(it.S,{...e,disabled:o,style:r.button,variant:"gray",children:i.formatMessage(t.title)})})}function Wt(e){const{currentOption:t,onChange:o}=e,n=(0,Q.useIntl)(),i=(0,ot.F)({maxWidth:360}),a=Object.values(Kt).map((e=>({key:e.key,render:o=>(0,ie.jsx)(Ne.Z,{...o,checkState:t.key===e.key,icon:e.icon,title:n.formatMessage(e.menuItemLabel)}),action:()=>o(e.key)})));return(0,ie.jsx)(Qe.Z,{...i,children:(0,ie.jsx)(Je.Z,{initialFocus:0,sections:[{key:0,render:e=>(0,ie.jsx)(Xe.Z,{enableActionSheetTitle:!0,...e}),items:a}],type:Je.i.Vertical})})}function Lt(e){const{actionStore:t,disabled:o,contentParentPointer:n,buttonPlacement:r}=e,s=(0,se.O7)(),l=(0,ce.yK)((e=>({listWrap:{background:e.contentBackground,borderRadius:5,boxShadow:e.inputBoxShadow,fontSize:14,minHeight:64,paddingBlock:3,paddingInline:10,..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},emptyPlaceholder:{caretColor:e.mediumTextColor,color:e.lightTextColor,fontSize:14,padding:"5px 0",display:"inline-block"}})),[]),c=(0,le.VK)((()=>q.G.createChildStore(t,n)),[t,n]),u=(0,le.VK)((()=>c.getContentStore()),[c]),d=(0,a.useCallback)((e=>{(0,Te.ZP)({event:e,context:Te.Af.EditorClick,callback:()=>{if(!u)return;(u.getValue()||[]).length>0||K.createAndCommit({userAction:"DuplicateBlocksAction.handleListClick",environment:s,perform:e=>{i.insertEmptyTextInDuplicateBlockAction({environment:s,parentStore:u,transaction:e})}})}})}),[s,u]);if(!u)return null;const p="inline"===(null==r?void 0:r.type);return(0,ie.jsx)(ie.Fragment,{children:(0,ie.jsx)(Bt.Z,{store:c,analyticsName:"duplicate_blocks_action",isListContainer:!0,children:(0,ie.jsx)(me.p,{allowSelectionWithin:!0,children:(0,ie.jsx)("div",{style:l.listWrap,onClick:d,className:Tt().focusableWithin,children:(0,ie.jsx)(It.O,{displayName:"DuplicateBlocksActionContent",disabled:o,children:(0,ie.jsx)(Ft.Z,{disabled:o,store:u,emptyPlaceholder:(0,ie.jsx)("div",{style:l.emptyPlaceholder,children:p?(0,ie.jsx)(Q.FormattedMessage,{id:"automations.DuplicateBlocksAction.emptyPlaceholder",defaultMessage:"Click to edit or drop blocks here…"}):(0,ie.jsx)(Q.FormattedMessage,{id:"automations.DuplicateBlocksAction.emptyCannotDropPlaceholder",defaultMessage:"Click to edit blocks here…"})}),disableCommentMenu:!0,disableHoverMenu:!1,disableDrag:!1})})})})})})}var Dt=o(98963);const Nt=(0,Q.defineMessages)({confirmationMessageLabel:{defaultMessage:"Confirmation message",id:"automations.BaseModalAction.confirmationMessageLabel"},continueButtonTextLabel:{defaultMessage:"Continue button text",id:"automations.BaseModalAction.continueButtonTextLabel"},cancelButtonTextLabel:{defaultMessage:"Cancel button text",id:"automations.BaseModalAction.cancelButtonTextLabel"}});var Ot=o(33732);function Et(e){const{contextStore:t,actionStore:o,target:n,onChange:i,disabled:r,errorMessage:s,dropdownButtonStyle:l}=e,c=(0,le.qz)(void 0,Ue.Z),u=(0,le.VK)((()=>{if(n&&"variable"===n.type)return t.getContextValueForActionById(o.id,n.id)}),[n,t,o.id]),d=(0,Ke.d)(),p=(0,it.d)({errorMessage:s,hasValue:Boolean(n)}),m=(0,a.useCallback)((e=>{"page"!==e.type&&"variable"!==e.type||(i(e),c.reset())}),[i,c]),g=(0,a.useCallback)((()=>c.reset()),[c]);return(0,ie.jsx)(Oe.ZP,{buttonPopupStore:c,popupType:d,alignmentToOrigin:Oe.vR.End,placementToOrigin:Oe.pO.Bottom,originGap:0,disabled:r,renderOrigin:e=>(0,ie.jsx)(it.S,{...e,...p,disabled:r,style:l,children:n&&"page"===n.type?(0,ie.jsx)(ft.Z,{store:q.G.createChildStore(t.context.parentRecordStore,n.page)}):u?(0,ie.jsx)(xt.F,{value:u,format:ht.lo.Medium,isSingle:!0}):(0,ie.jsx)(Q.FormattedMessage,{id:"automations.AutomationPagePicker.pagesDropdown.label",defaultMessage:"Select page"})}),render:e=>(0,ie.jsx)(St.L,{actionId:o.id,automationContextStore:t,onChange:m,onClose:g,selectedTarget:n,skipCollections:!0})})}function Ht(e){const{actionStore:t,automationContextStore:o,disabled:n,errorMessage:i,onChange:a,value:r}=e,s=(0,ce.yK)((()=>({picker:{display:"inline-flex",minWidth:50},span:{flex:0},title:{display:"inline-flex",minWidth:50}})),[]);return(0,ie.jsxs)("div",{style:s.title,children:[(0,ie.jsx)(Q.FormattedMessage,{defaultMessage:"<span>Open </span>{pagePicker}",id:"automations.OpenPageAction.action.title",values:{pagePicker:(0,ie.jsx)("div",{style:s.picker,children:(0,ie.jsx)(Et,{actionStore:t,contextStore:o,disabled:n,dropdownButtonStyle:{height:"auto",marginBlock:-6,marginInline:-5,maxWidth:"auto",paddingBlock:6,paddingInline:5},errorMessage:i,onChange:a,target:r})}),span:e=>(0,ie.jsx)("span",{style:s.span,children:e})}})," "]})}function Ut(e){const{actionStore:t,disabled:o,onChange:n}=e,i=(0,ce.yK)((()=>({picker:{display:"inline-flex",minWidth:50},span:{flex:0},title:{display:"inline-flex",minWidth:50}})),[]),a=(0,le.VK)((()=>t.getOpenPageIn()),[t]);return(0,ie.jsx)("div",{style:i.title,children:(0,ie.jsx)(Q.FormattedMessage,{defaultMessage:"<span>in </span>{peekModePicker}",id:"automations.OpenPageAction.peekMode.title",values:{peekModePicker:(0,ie.jsx)("div",{style:i.picker,children:(0,ie.jsx)(zt,{disabled:o,dropdownButtonStyle:{height:"auto",marginBlock:-6,marginInline:-5,maxWidth:"auto",paddingBlock:6,paddingInline:5},onChange:n,value:a})}),span:e=>(0,ie.jsx)("span",{style:i.span,children:e})}})})}function zt(e){const{disabled:t,dropdownButtonStyle:o,onChange:n,value:i}=e,r=(0,ce.Fg)(),s=(0,le.qz)(void 0,Ue.Z),l=(0,le.VK)((()=>(0,Ot.v)({currentViewType:void 0,theme:r}).find((e=>e.key===i))),[i,r]),c=(0,a.useCallback)((()=>s.reset()),[s]),u=(0,a.useCallback)((e=>{e!==(null==l?void 0:l.key)&&n(e),c()}),[c,null==l?void 0:l.key,n]),d=(0,Ke.d)();return l?(0,ie.jsx)(Oe.ZP,{alignmentToOrigin:Oe.vR.End,buttonPopupStore:s,disabled:t,originGap:0,placementToOrigin:Oe.pO.Bottom,popupType:d,renderOrigin:e=>(0,ie.jsx)(it.S,{...e,disabled:t,style:o,variant:"gray",children:l.title}),render:e=>(0,ie.jsx)($t,{onChange:u,value:i})}):null}function $t(e){const{onChange:t,value:o}=e,n=(0,ce.Fg)(),i=(0,ce.yK)((()=>({menuItem:{paddingBlock:8}})),[]),a=(0,ot.F)({maxWidth:360,width:280}),r=(0,le.VK)((()=>(0,Ot.v)({currentViewType:void 0,theme:n}).map(((e,n)=>({action:()=>t(e.key),key:n,render:t=>(0,ie.jsx)(Ne.Z,{...t,body:e.body,caption:e.caption,checkState:o===e.key,disabled:!1,icon:e.icon,style:i.menuItem,title:e.title})})))),[t,i.menuItem,n,o]),s=[{key:0,render:e=>(0,ie.jsx)(Xe.Z,{enableActionSheetTitle:!0,...e}),items:r}];return(0,ie.jsx)(Qe.Z,{...a,children:(0,ie.jsx)(Je.Z,{initialFocus:0,sections:s,type:Je.i.Vertical})})}var qt=o(3865),Gt=o(61586),Yt=o(60709);const Qt=(0,Q.defineMessages)({defaultMenuHeader:{defaultMessage:"Select people",id:"automationPersonPicker.defaultMenuHeaderMessage"},personValuePickerPlaceholder:{defaultMessage:"Select up to {maxSelected} people...",id:"automations.personPicker.buttonPlaceholder"}});function Jt(e){const{currentValue:t,contextStore:o,collectionStore:n,disabled:i,onChange:a,formulaTypecheckContextValues:r,menuHeader:s,limit:l}=e,c={type:"person_array"},u=(0,Q.useIntl)(),d={type:"collection",collectionStore:n,property:"person"},p={menuType:Yt.og.Popup,header:(0,ie.jsx)(Xe.Z,{style:{paddingBottom:0},title:s?u.formatMessage(s):u.formatMessage(Qt.defaultMenuHeader)})};return(0,ie.jsx)(Gt.Z,{formulaTypecheckContextValues:r,disabled:i,contextStore:o,context:d,onChange:a,type:c,value:t,menuProps:p,placeholder:l?u.formatMessage(Qt.personValuePickerPlaceholder,{maxSelected:l}):void 0,limit:l})}var Xt=o(32157);const eo=(0,Q.defineMessages)({property:{id:"automationAction.sendInAppNotification.targetType.property",defaultMessage:"Person property"},formula:{id:"automationAction.sendInAppNotification.targetType.formula",defaultMessage:"Specific people"},default:{id:"automations.targetPicker.targetTypePlaceholder",defaultMessage:"Select recipients"}});function to(e){const{disabled:t,dropdownButtonStyle:o,errorMessage:n,selectedTargetType:i,onSelectedTargetTypeChange:r}=e,s=(0,le.qz)(void 0,Ue.Z),l=(0,Ke.d)(),c=(0,it.d)({errorMessage:n,hasValue:Boolean(i)}),u=(0,a.useCallback)((e=>{e!==i&&(r(e),s.reset())}),[r,s,i]);return(0,ie.jsx)("div",{style:o,children:(0,ie.jsx)(Oe.ZP,{buttonPopupStore:s,popupType:l,alignmentToOrigin:Oe.vR.End,placementToOrigin:Oe.pO.Bottom,originGap:0,disabled:t,renderOrigin:e=>(0,ie.jsx)(it.S,{...c,...e,disabled:t,style:o,children:i?(0,ie.jsx)(Q.FormattedMessage,{...eo[i]}):(0,ie.jsx)(Q.FormattedMessage,{...eo.default})}),render:e=>(0,ie.jsx)(oo,{handleChange:u,selectedTargetType:i})})})}function oo(e){const{handleChange:t}=e,o=(0,ot.F)(),n=[(0,a.useMemo)((()=>({action:()=>null,key:"selectUsers",render:e=>(0,ie.jsx)(Ne.Z,{...e,onClick:()=>t("formula"),title:(0,ie.jsx)(Q.FormattedMessage,{...eo.formula})})})),[t]),(0,a.useMemo)((()=>({action:()=>null,key:"selectPersonProperty",render:e=>(0,ie.jsx)(Ne.Z,{...e,onClick:()=>t("property"),title:(0,ie.jsx)(Q.FormattedMessage,{...eo.property})})})),[t])].filter(p.$K);if(0===n.length)return null;const i={items:n,key:"targetType",render:e=>(0,ie.jsx)(Xe.Z,{topBorder:!0,...e,enableActionSheetTitle:!0})};return(0,ie.jsx)(Qe.Z,{...o,children:(0,ie.jsx)(Je.Z,{type:Je.i.Vertical,sections:[i],initialFocus:0})})}const no=(0,Q.defineMessages)({notificationMessageLabel:{defaultMessage:"Message",id:"automations.BaseModalAction.notificationMessageLabel"},personPropertyTargetTypeLabel:{defaultMessage:"Property",id:"automations.SendInAppNotificationAction.personPropertyTargetTypeLabel"},usersTargetTypeLabel:{defaultMessage:"People",id:"automations.SendInAppNotificationAction.usersTargetTypeLabel"},propertyPickerPlaceholder:{defaultMessage:"Select a property",id:"automations.SendInAppNotificationAction.propertyPickerPlaceholder"},personValuePickerMenuHeader:{defaultMessage:"Send notification to",id:"automations.personPicker.menuHeader"}});function io(e){const{targetsErrorMessage:t,selectedTargetType:o,disabled:n,onTargetTypeChange:i}=e,a=(0,ce.yK)((()=>({b:{fontWeight:Ce.Z.fontWeight.medium},picker:{display:"inline-flex",minWidth:50},span:{flex:0},title:{display:"inline-flex",minWidth:50,flexWrap:"wrap",gap:6}})),[]);return(0,ie.jsxs)("div",{style:a.title,children:[(0,ie.jsx)(Q.FormattedMessage,{defaultMessage:"<span>Send <b>notification</b> to </span>{targetTypePicker}",id:"automations.SendInAppNotificationAction.header.title",values:{b:e=>(0,ie.jsx)("b",{style:a.b,children:e}),span:e=>(0,ie.jsx)("span",{style:a.span,children:e}),targetTypePicker:(0,ie.jsx)("div",{style:a.picker,children:(0,ie.jsx)(to,{onSelectedTargetTypeChange:i,disabled:n,dropdownButtonStyle:{height:"auto",marginBlock:-6,marginInline:-5,maxWidth:"auto",paddingBlock:6,paddingInline:5},errorMessage:t,selectedTargetType:o})})}})," "]})}function ao(e){const{isMobile:t,selectedTargetType:o}=e,n=(0,ce.yK)((e=>({inputLabel:{color:e.lightTextColor,fontSize:t?14:12,lineHeight:1.3,fontWeight:Ce.Z.fontWeight.medium}})),[t]),i=(0,le.VK)((()=>{switch(o){case"property":return no.personPropertyTargetTypeLabel;case"formula":return no.usersTargetTypeLabel;default:(0,p.t1)(o)}}),[o]);return(0,ie.jsx)("label",{style:n.inputLabel,children:(0,ie.jsx)(Q.FormattedMessage,{...i})})}const ro=20;function so(e){const{automationContextStore:t,collectionStore:o,disabled:n,formulaTypecheckContextValues:i,currentProperties:a,currentTargetValue:r,onTargetValueChange:s}=e,l=r.type;switch(l){case"formula":return(0,ie.jsx)(Jt,{contextStore:t,collectionStore:o,currentValue:r.value,disabled:Boolean(n),onChange:e=>s({type:"formula",value:e}),formulaTypecheckContextValues:i,menuHeader:no.personValuePickerMenuHeader,limit:ro});case"property":return(0,ie.jsx)(Xt.X,{availablePropertyIds:a,currentValue:r.propertyId,collectionStore:o,onChange:e=>s({type:"property",propertyId:e}),disabled:Boolean(n),alreadyHaveProperties:a.length>0,placeholderMessage:no.propertyPickerPlaceholder});default:(0,p.t1)(l)}}var lo=o(80826);const co={create_page:function(e){const{actionStore:t}=e,{automationContextStore:o,disabled:n,maybePersistedTransactionActions:i,suppressActionErrors:r}=(0,$e.i)(),s=(0,u.z)("create_page"),{display:l}=s,[c,d]=(0,le.VK)((()=>{const e=t.getConfig();return[null==e?void 0:e.properties,null==e?void 0:e.values]}),[t]),[m,g]=(0,le.VK)((()=>{const e=t.getCollectionStore();return null!=e&&e.isDefined()?[e,{collection:e.getSpaceShardedPointer(),type:"collection"}]:[void 0,void 0]}),[t]),y=(0,le.VK)((()=>gt(m).length>0),[m]),h=(0,le.VK)((()=>{var e;return null===(e=t.getConfig())||void 0===e?void 0:e.template_page_id}),[t]),f=(0,a.useMemo)((()=>({values:d??{},properties:c??[]})),[d,c]),x=(0,le.qz)(void 0,Ue.Z),S=(0,a.useCallback)((()=>x.reset()),[x]),v=(0,a.useMemo)((()=>(0,ie.jsx)(nt.e,{actionStore:t,closeMenu:S})),[t,S]),b=(0,a.useCallback)((e=>{"collection"===e.type&&i.createAndCommit({perform:o=>{V.sW({data:{collection:e.collection,properties:["title"],template_page_id:null,values:null},store:t.getConfigStore(),transaction:o})},userAction:"CreatePageAction.setCollection"})}),[t,i]),C=(0,a.useCallback)((e=>{const{properties:o,values:n}=f;let a=!1;if(e&&o&&1===o.length&&o.includes("title")){var r;const e=null==n?void 0:n.title;e&&null!==(r=e.value)&&void 0!==r&&r.value||(a=!0)}i.createAndCommit({perform:o=>{V.sW({store:t.getConfigStore(),data:{template_page_id:e??null,...a&&{properties:[]}},transaction:o})},userAction:"CreatePageAction.onTemplateChange"})}),[t,i,f]),M=(0,a.useMemo)((()=>!r.includes(t.id)),[r,t]),k=(0,pt.TU)({actionId:t.id,contextStore:o,errorKey:"collection",shouldShow:M}),j=(0,pt.TU)({actionId:t.id,contextStore:o,errorKey:"template",shouldShow:M});if(!o)return null;const P=Boolean(n);return(0,ie.jsxs)(at.Ao,{actionMenu:v,buttonPopupStore:x,disabled:P,children:[(0,ie.jsxs)(at.vu,{disabled:P,display:l,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0"}},children:[(0,ie.jsx)(jt,{actionStore:t,automationContextStore:o,disabled:P,errorMessage:k,onChange:b,value:g}),(0,p.$K)(m)&&y&&(0,ie.jsx)(Pt,{collectionStore:m,disabled:P,errorMessage:j,onChange:C,value:h})]}),m&&(0,ie.jsx)(at.R7,{disabled:P,styles:{bodyWrap:{display:"grid",gap:8,gridTemplateColumns:"1fr",minWidth:0}},children:(0,ie.jsx)(yt.QF,{actionStore:t,collectionStore:m,contextStore:o,disabled:P,showSetPropertyActions:!1})})]})},update_pages:o(97291).B,query_collection:function(){return null},open_page:function(e){const{actionStore:t}=e,{automationContextStore:o,disabled:n,maybePersistedTransactionActions:i,suppressActionErrors:r}=(0,$e.i)(),s=(0,le.qz)(void 0,Ue.Z),l=(0,u.z)("open_page"),{display:c}=l,d=(0,le.VK)((()=>{var e;return null===(e=t.getConfig())||void 0===e?void 0:e.target}),[t]),p=(0,a.useMemo)((()=>({headerWrap:{paddingInlineEnd:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0"}})),[]),m=(0,a.useCallback)((e=>{i.createAndCommit({perform:o=>{V.sW({store:t.getConfigStore(),data:{target:e},transaction:o})},userAction:"OpenPageAction.setTarget"})}),[i,t]),g=(0,a.useCallback)((e=>{i.createAndCommit({perform:o=>{V.sW({store:t.getConfigStore(),data:{open_in:e},transaction:o})},userAction:"OpenPageAction.setPeekMode"})}),[i,t]),y=(0,a.useCallback)((()=>s.reset()),[s]),h=(0,a.useMemo)((()=>!r.includes(t.id)),[r,t]),f=(0,pt.TU)({actionId:t.id,contextStore:o,shouldShow:h}),x=(0,a.useMemo)((()=>(0,ie.jsx)(nt.e,{actionStore:t,closeMenu:y})),[t,y]);if(!o)return null;const S=Boolean(n);return(0,ie.jsx)(at.Ao,{actionMenu:x,buttonPopupStore:s,children:(0,ie.jsxs)(at.vu,{disabled:S,display:c,styles:p,children:[(0,ie.jsx)(Ht,{actionStore:t,automationContextStore:o,disabled:S,errorMessage:f,onChange:m,value:d}),(0,ie.jsx)(Ut,{actionStore:t,disabled:S,onChange:g})]})})},duplicate_blocks:function(e){const{actionStore:t}=e,{disabled:o,editorPlacement:n}=(0,$e.i)(),i=(0,se.O7)(),r=(0,ce.yK)((()=>({title:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0",whiteSpace:"pre-wrap"}})),[]),s=(0,le.VK)((()=>(0,bt.Ps)(t.getBlockPointers())),[t],{useDeepEqual:!0}),l=(0,le.VK)((()=>function(e){const t=Object.values(Kt).find((t=>t.key===e));return t??_t}(t.getInsertionPoint())),[t]),c=(0,a.useCallback)((e=>function(e,t,o){K.createAndCommit({userAction:"DuplicateBlocksAction.setInsertionPoint",environment:e,perform:e=>{V.sW({store:t.getConfigStore(),data:{insertion_point:o},transaction:e})}})}(i,t,e)),[t,i]),d=(0,le.qz)(void 0,Ue.Z),p=(0,a.useCallback)((()=>d.reset()),[d]),m=(0,a.useMemo)((()=>(0,ie.jsx)(nt.e,{actionStore:t,closeMenu:p})),[t,p]),g=(0,u.z)("duplicate_blocks"),{display:y}=g,h=Boolean(o);return(0,ie.jsxs)(at.Ao,{actionMenu:m,buttonPopupStore:d,disabled:h,children:[(0,ie.jsx)(at.vu,{disabled:h,display:y,children:(0,ie.jsx)("div",{style:r.title,children:(0,ie.jsx)(Q.FormattedMessage,{...Zt.title,values:{insertionPicker:(0,ie.jsx)(Rt,{currentOption:l,disabled:h,onChange:c})}})})}),(0,ie.jsx)(at.R7,{disabled:h,children:s?(0,ie.jsx)(Lt,{actionStore:t,buttonPlacement:n,contentParentPointer:s,disabled:h}):null})]})},modal_confirmation:function(e){const{actionStore:t}=e,o=(0,Q.useIntl)(),{automationContextStore:n,disabled:i,maybePersistedTransactionActions:r}=(0,$e.i)(),s=function(){const{isMobile:e}=(0,se.Fy)();return(0,ce.yK)((t=>({wrap:{display:"flex",flexDirection:"column",gap:10},inputLabel:{color:t.lightTextColor,fontSize:e?14:12,lineHeight:1.3,fontWeight:Ce.Z.fontWeight.medium},input:{backgroundColor:t.contentBackground,paddingTop:6,paddingBottom:6}})),[e])}(),l=(0,u.z)("modal_confirmation"),c=(0,le.qz)(void 0,Ue.Z),d=(0,a.useCallback)((()=>c.reset()),[c]),p=(0,a.useMemo)((()=>(0,ie.jsx)(nt.e,{actionStore:t,closeMenu:d})),[t,d]),m=(0,le.VK)((()=>t.getConfigStore().getKeyStore("text")),[t]),g=(0,le.VK)((()=>m.getValue()),[m]),y=(0,le.VK)((()=>t.getConfigStore().getKeyStore("continue_button").getKeyStore("text")),[t]),h=(0,le.VK)((()=>t.getConfigStore().getKeyStore("cancel_button").getKeyStore("text")),[t]),f=(0,a.useCallback)((e=>{r.createAndCommit({userAction:"BaseModalAction.handleTextChange",perform:t=>{V.sO({store:m,value:e,transaction:t})}})}),[r,m]);if(!n)return null;const x=Boolean(i);return(0,ie.jsxs)(at.Ao,{actionMenu:p,buttonPopupStore:c,disabled:x,children:[(0,ie.jsx)(at.vu,{disabled:x,display:l.display,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0"}},children:(0,ie.jsx)(Q.FormattedMessage,{...l.display.name})}),(0,ie.jsxs)(at.R7,{disabled:x,styles:{bodyWrap:{display:"grid",gap:8,gridTemplateColumns:"1fr",minWidth:0}},children:[(0,ie.jsx)("label",{style:s.inputLabel,children:(0,ie.jsx)(Q.FormattedMessage,{...Nt.confirmationMessageLabel})}),(0,ie.jsx)(et.D,{disabled:x,value:g,onChange:f,multiline:!0,placeholder:o.formatMessage(Nt.confirmationMessageLabel),disableFormattingAndMentions:!0,disableMobileActionBar:!0}),(0,ie.jsx)("label",{style:s.inputLabel,children:(0,ie.jsx)(Q.FormattedMessage,{...Nt.continueButtonTextLabel})}),(0,ie.jsx)(We.W_,{disabled:x,maxlength:Dt.OO,style:s.input,store:y}),(0,ie.jsx)("label",{style:s.inputLabel,children:(0,ie.jsx)(Q.FormattedMessage,{...Nt.cancelButtonTextLabel})}),(0,ie.jsx)(We.W_,{disabled:x,maxlength:Dt.OO,style:s.input,store:h})]})]})},slack_notification:lo.eQ,assistant:function(e){const{actionStore:t}=e,o=(0,Q.useIntl)(),n=(0,se.O7)(),i=(0,le.VK)((()=>tt.Z.isJSAssistantEnabled()),[]),{disabled:r,maybePersistedTransactionActions:s}=(0,$e.i)(),l=(0,ce.yK)((e=>({wrap:{display:"flex",flexDirection:"column",gap:10},plainTextInput:{backgroundColor:e.contentBackground,paddingTop:6,paddingBottom:6},sectionMenuItemTitle:{paddingLeft:0}})),[]),c=(0,le.VK)((()=>t.getType()),[t]),d=(0,le.VK)((()=>t.getConfigStore().getKeyStore("description")),[t]),p=(0,le.VK)((()=>({type:"simple",value:(0,Ye.TPx)(d.getValue())})),[d],{useDeepEqual:!0}),m=(0,le.VK)((()=>{var e;return(null===(e=t.getConfig())||void 0===e?void 0:e.type)||"prompt"}),[t]),g=(0,le.VK)((()=>t.getConfigStore().getKeyStore("value")),[t]),y=(0,le.VK)((()=>({type:"simple",value:(0,Ye.TPx)(g.getValue())})),[g],{useDeepEqual:!0}),h=(0,le.qz)(void 0,Ue.Z),f=(0,a.useCallback)((()=>h.reset()),[h]),x=(0,a.useMemo)((()=>(0,ie.jsx)(nt.e,{actionStore:t,closeMenu:f})),[t,f]),S=(0,a.useCallback)((e=>{s.createAndCommit({userAction:"AssistantAction.handleAssistantTypeChange",perform:o=>{V.sO({store:t.getConfigStore().getKeyStore("type"),value:e,transaction:o})}})}),[s,t]),v=(0,a.useCallback)((e=>{K.createAndCommit({userAction:"AssistantAction.handleDescriptionChange",environment:n,perform:t=>{V.sO({store:d,value:(0,Ye.QaF)(null==e?void 0:e.value),transaction:t})}})}),[n,d]),b=(0,a.useCallback)((e=>{K.createAndCommit({userAction:"AssistantAction.handleValueChange",environment:n,perform:t=>{V.sO({store:g,value:(0,Ye.QaF)(null==e?void 0:e.value),transaction:t})}})}),[n,g]);if(!i)return null;if(!c)return null;const C=(0,u.z)(c),M=Boolean(r),{display:k}=C;return(0,ie.jsxs)(at.Ao,{actionMenu:x,buttonPopupStore:h,disabled:M,children:[(0,ie.jsx)(at.vu,{disabled:M,display:k,children:(0,ie.jsx)(ut,{actionStore:t,disabled:M,value:m,onChange:S})}),(0,ie.jsx)(at.R7,{disabled:M,children:(0,ie.jsxs)("div",{style:l.wrap,children:[(0,ie.jsx)(et.D,{disabled:M,value:p,onChange:v,placeholder:o.formatMessage(rt.descriptionLabel),disableFormattingAndMentions:!0,disableMobileActionBar:!0}),(0,ie.jsx)(et.D,{disabled:M,value:y,onChange:b,placeholder:o.formatMessage(ct(m)),multiline:!0,disableFormattingAndMentions:!0,disableMobileActionBar:!0,code:"code"===m})]})})]})},send_in_app_notification:function(e){const{actionStore:t}=e,{automationContextStore:o,disabled:n,maybePersistedTransactionActions:i,suppressActionErrors:r}=(0,$e.i)(),s=Boolean(n),l=(0,le.VK)((()=>null==o?void 0:o.getCollectionStore()),[o]),c=(0,le.VK)((()=>{if(!l)return[];return(0,qt.NO)({collectionFormat:l.getFormat(),collectionSchema:l.getSchema()})}),[l]),u=(0,le.VK)((()=>{var e;return null==t||null===(e=t.getConfig())||void 0===e?void 0:e.target}),[t]),d=(0,le.VK)((()=>{var e;return null===(e=t.getConfig())||void 0===e?void 0:e.notification_message}),[t]),m=(0,le.VK)((()=>t.id),[t.id]),g=(0,le.VK)((()=>(null==o?void 0:o.getContextValuesForAction(m))??[]),[o,m]),y=(0,le.qz)(void 0,Ue.Z),h=(0,a.useCallback)((()=>y.reset()),[y]),f=(0,a.useMemo)((()=>(0,ie.jsx)(nt.e,{actionStore:t,closeMenu:h})),[t,h]),x=(0,a.useMemo)((()=>!r.includes(t.id)),[r,t]),S=function(e){const{automationContextStore:t,actionId:o,shouldShowError:n}=e,i={};return i.target=(0,pt.TU)({contextStore:t,actionId:o,shouldShow:n,errorKey:"target"}),i.notification_message=(0,pt.TU)({contextStore:t,actionId:o,shouldShow:n,errorKey:"notification_message"}),i.collectionPointer=(0,pt.TU)({contextStore:t,actionId:o,shouldShow:n,errorKey:"collectionPointer"}),i.propertyId=(0,pt.TU)({contextStore:t,actionId:o,shouldShow:n,errorKey:"propertyId"}),i.formulaValue=(0,pt.TU)({contextStore:t,actionId:o,shouldShow:n,errorKey:"formulaValue"}),i}({automationContextStore:o,actionId:t.id,shouldShowError:x}),v=(0,a.useCallback)((e=>{i.createAndCommit({perform:o=>{V.sW({data:{target:{type:e}},store:t.getConfigStore(),transaction:o})},userAction:"SendInAppNotificationAction.setTargetType"})}),[t,i]),b=(0,a.useCallback)((e=>{const o=e.type;switch(o){case"formula":if(!e.value)return;i.createAndCommit({perform:o=>{V.sW({data:{target:{type:"formula",value:e.value}},store:t.getConfigStore(),transaction:o})},userAction:"SendInAppNotificationAction.setTarget"});break;case"property":i.createAndCommit({perform:o=>{V.sW({data:{target:{...e,collectionPointer:null==l?void 0:l.getSpaceShardedPointer()}},store:t.getConfigStore(),transaction:o})},userAction:"SendInAppNotificationAction.setTarget"});break;default:(0,p.t1)(o)}}),[t,l,i]),C=(0,a.useCallback)((e=>{i.createAndCommit({perform:o=>{V.sW({data:{notification_message:e},store:t.getConfigStore(),transaction:o})},userAction:"SendInAppNotificationAction.setNotificationMessage"})}),[t,i]),{isMobile:M}=(0,se.Fy)(),k=(0,ce.yK)((e=>({inputLabel:{color:e.lightTextColor,fontSize:M?14:12,lineHeight:1.3,fontWeight:Ce.Z.fontWeight.medium},input:{backgroundColor:e.contentBackground,paddingTop:6,border:e.outlineButtonBorder,display:"flex",marginBlockEnd:16}})),[M]);if(!o||!l)return null;const j={type:"collection",collectionStore:l,property:"title"};return(0,ie.jsxs)(at.Ao,{actionMenu:f,buttonPopupStore:y,disabled:s,children:[(0,ie.jsx)(at.vu,{styles:{headerWrap:{paddingRight:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0"}},children:(0,ie.jsx)(io,{targetsErrorMessage:S.target,selectedTargetType:null==u?void 0:u.type,onTargetTypeChange:v,disabled:Boolean(n)})}),u&&(0,ie.jsxs)(at.R7,{children:[(0,ie.jsxs)("div",{children:[(0,ie.jsx)(ao,{isMobile:M,selectedTargetType:u.type}),(0,ie.jsx)("div",{style:k.input,children:(0,ie.jsx)(so,{automationContextStore:o,collectionStore:l,disabled:Boolean(n),formulaTypecheckContextValues:g,currentTargetValue:u,currentProperties:c,onTargetValueChange:b})})]}),(0,ie.jsxs)("div",{children:[(0,ie.jsx)("label",{style:k.inputLabel,children:(0,ie.jsx)(Q.FormattedMessage,{...no.notificationMessageLabel})}),(0,ie.jsx)("div",{style:{...k.input,marginBlockEnd:0},children:(0,ie.jsx)(Gt.Z,{type:{type:"text"},value:d,onChange:C,disabled:s,contextStore:o,context:j,disableMobileActionBar:!0,formulaTypecheckContextValues:g,disableTemplateVariableMentions:!0,multiline:!0,maximumInputLines:3})})]})]})]})}};var uo=o(28607);function po(e){let{isEditable:t}=e;const{automationContextStore:o,disabled:n}=(0,$e.i)(),{isMobile:i}=(0,se.Fy)(),a=(0,qe.a)(),r=(0,le.VK)((()=>{var e;return((null==o||null===(e=o.context.automationStore)||void 0===e?void 0:e.getActionStores())??[]).map((e=>e.isDefined()&&e.hasConcern("display")?e:null)).filter(p.K0)}),[o]),s=r.length>0,l=(0,ce.yK)((e=>({section:{display:"flex",flexDirection:"column",gap:6},header:{alignItems:"center",display:"flex",flexDirection:"row"},headerAdd:{marginLeft:"auto",flexGrow:0,flexShrink:0},title:{color:e.lightTextColor,fontSize:i?14:12,lineHeight:1.3,fontWeight:Ce.Z.fontWeight.medium}})),[i]),c=!n&&t&&s,u=t&&!a;return(0,ie.jsxs)("section",{style:l.section,children:[(0,ie.jsxs)("header",{style:l.header,children:[(0,ie.jsx)("div",{style:l.title,children:(0,ie.jsx)(Q.FormattedMessage,{...He.sY.actionTitle})}),c&&(0,ie.jsx)("div",{style:l.headerAdd,children:(0,ie.jsx)(fo,{disabled:n,hasAnyActions:s,variant:"icon"})})]}),u?(0,ie.jsx)(go,{actionStores:r}):(0,ie.jsx)(mo,{actionStores:r}),!n&&t&&(0,ie.jsx)("footer",{children:(0,ie.jsx)(fo,{disabled:n,hasAnyActions:s,variant:s?"menuitem":"button"})})]})}function mo(e){let{actionStores:t}=e;const o=(0,Le.L5)();return(0,ie.jsx)("div",{children:t.map((e=>(0,ie.jsx)("div",{className:o,children:(0,ie.jsx)(yo,{actionStore:e})},e.id)))})}function go(e){let{actionStores:t}=e;const{automationContextStore:o,disabled:n,onActionDragStart:r,onActionDragEnd:s,maybePersistedTransactionActions:l}=(0,$e.i)(),c=(0,le.VK)((()=>{var e;const t=(null==o||null===(e=o.context.automationStore)||void 0===e?void 0:e.getActionStores())??[];return new Map(t.map((e=>{if(e.isDefined()&&e.hasConcern("display"))return[e.id,e]})).filter(p.$K))}),[null==o?void 0:o.context.automationStore]),u=(0,a.useMemo)((()=>Array.from(c.keys())),[c]),d=(0,le.qz)(void 0,ze.Z);(0,le.VK)((()=>{const e=d.getState();if(e.willDrag){const t=c.get(e.draggingKey);(0,p.$K)(t)&&(0,p.$K)(r)&&r(t)}else e.willDrag||e.isDragging||null==s||s()}),[c,d,s,r]);const m=(0,a.useCallback)((e=>{if(!o)throw new Error("Error reordering actions. Could not find automationContextStore");l.createAndCommit({userAction:"AutomationButtonAction.moveAction",perform:t=>{i.reorderAutomationActions({clientContext:o.context,newActionIds:e,transaction:t})}})}),[o,l]),g=(0,a.useCallback)(((e,t)=>{const o=c.get(e);return(0,p.$K)(o)?(0,ie.jsx)(yo,{actionStore:o},o.id):null}),[c]);return t.length>0?(0,ie.jsx)(ho,{draggableListStore:d,hasDragging:!n,keys:u,onDrop:m,renderKey:g}):null}function yo(e){const{actionStore:t}=e,o=(0,le.VK)((()=>t.getType()),[t]);if(!o)return null;const n=co[o];return(0,ie.jsx)(n,{actionStore:t})}function ho(e){const{draggableListStore:t,hasDragging:o,keys:n,onDrop:i,renderKey:a,ruleTopOffset:r}=e,s=(0,Le.RD)({ruleTopOffset:r}),l=(0,Le.L5)();return(0,ie.jsxs)("div",{style:s.wrap,children:[(0,ie.jsx)("div",{style:s.verticalRule}),(0,ie.jsx)(Ee.ZP,{childClassName:l,direction:"vertical",disabled:!o,keys:n,onDrop:i,renderKey:a,store:t,style:s.list})]})}function fo(e){const{disabled:t,hasAnyActions:o,variant:n}=e,{isMobile:i}=(0,se.Fy)(),r=(0,Ke.d)(),s=(0,Q.useIntl)(),l=(0,a.useMemo)((()=>({availableActions:[],hasUpdateThisPagePropertyActions:!0,hasSearch:!0,type:"eventActions"})),[]),c=(0,le.qz)(void 0,Ue.Z),u=(0,a.useCallback)((()=>c.reset()),[c]),d=(0,ce.yK)((e=>({buttonWrap:{boxShadow:"initial",background:"transparent"},button:{color:e.mediumTextColor,fill:e.mediumIconColor,margin:0,width:"100%"},buttonIcon:{height:i?18:16,width:24}})),[i]),p=Boolean(t);return(0,ie.jsx)(Oe.ZP,{alignmentToOrigin:Oe.vR.Start,buttonPopupStore:c,disabled:p,placementToOrigin:Oe.pO.Bottom,popupType:r,render:()=>(0,ie.jsx)(Ge.Z,{initialState:l,onClose:u}),renderOrigin:e=>"icon"===n?(0,ie.jsx)(ge.Z,{...e,ariaLabel:s.formatMessage(He.sY.addActionAriaLabel),disabled:p,disabledFeedback:p,icon:De.R}):"button"===n?(0,ie.jsx)(uo.D,{...e,ariaLabel:s.formatMessage(He.sY.addActionAriaLabel),disabled:p,icon:(0,De.R)({height:24,width:12}),title:(0,ie.jsx)(Q.FormattedMessage,{...He.sY.addActionLabel})}):(0,ie.jsx)(Ne.Z,{...e,buttonStyle:d.button,disabled:p,disabledFeedback:p,focused:!1,icon:(0,De.R)(d.buttonIcon),style:d.buttonWrap,title:o?(0,ie.jsx)(Q.FormattedMessage,{id:"automations.addActionButton.nonEmpty.label",defaultMessage:"Add another step"}):(0,ie.jsx)(Q.FormattedMessage,{id:"automations.addActionButton.empty.label",defaultMessage:"Add a step"})})})}function xo(e){const{areActionsEditable:t,areTriggersEditable:o}=e,{isMobile:n}=(0,se.Fy)(),i=(0,ce.yK)((e=>({verticalRule:{background:e.stroke.regular,marginLeft:20,height:36,width:1},container:{padding:n?"16px 16px 0px 16px":void 0}})),[n]);return(0,ie.jsxs)("div",{style:i.container,children:[(0,ie.jsx)(Le.nT,{isEditable:o}),(0,ie.jsx)("div",{style:i.verticalRule}),(0,ie.jsx)(po,{isEditable:t})]})}const So=(0,Q.defineMessages)({addIconButtonAriaLabel:{defaultMessage:"Add icon",id:"buttonBlock.button.addIconButtonAriaLabel"},editButtonAriaLabel:{defaultMessage:"Edit button",id:"buttonBlock.button.editButtonAriaLabel"},buttonPlaceholder:{defaultMessage:"New button",id:"buttonBlock.button.placeholder"},buttonInsufficientPermissions:{defaultMessage:"You don’t have permission to run this button",id:"buttonBlock.button.insufficientPermissions"},clickToEdit:{defaultMessage:"Click to edit button",id:"buttonBlock.button.clickToEdit"}});function vo(e){var t,o,n;const{buttonBlockStore:i}=e,a=(0,le.VK)((()=>i.state.editing?i.state:void 0),[i]),r=(0,ce.yK)((e=>{var t;return{popup:{width:400},editor:{background:e.sidebarBackground,..."inline"===(null==a||null===(t=a.placement)||void 0===t?void 0:t.type)?{marginTop:6,borderRadius:6,border:`1px solid ${e.regularDividerColor}`,maxWidth:600}:{}}}}),[null==a||null===(t=a.placement)||void 0===t?void 0:t.type]),s=(0,Ke.d)({tabletBehavior:"slideUp"});return a&&a.placement?"popup"===(null===(o=a.placement)||void 0===o?void 0:o.type)?(0,ie.jsx)(ye.ZP,{open:!0,popupType:s,render:()=>(0,ie.jsx)(bo,{...e,style:r.editor}),originRect:a.placement.originRect,style:r.popup,originGap:4,onDismiss:()=>{i.stopEditing()}}):"inline"===(null===(n=a.placement)||void 0===n?void 0:n.type)?(0,ie.jsx)(bo,{...e,style:r.editor}):void(0,p.t1)(a.placement):null}function bo(e){const{disabled:t,store:o,buttonBlockStore:n}=e,i=(0,se.O7)(),r=i.currentUser.id,s=(0,Q.useIntl)(),[c,u]=(0,Ve.e)(),d=(0,ce.yK)((e=>({header:{display:"flex",alignItems:"center",padding:"12px 12px 8px 12px",gap:6},scroller:{maxHeight:"75vh"},nameInputWrap:{flexGrow:"1"},factoryButtonDeprecationBanner:{margin:"12px 12px 6px 12px"}})),[]),p=(0,Ie.D)(),m=(0,le.VK)((()=>o.getAutomationStore()),[o]),g=(0,le.VK)((()=>null==m?void 0:m.getSpaceId()),[m]),{maybePersistedAutomationStore:y,maybePersistedTransactionActions:h}=(0,Re.$)({automationId:null==m?void 0:m.id,spaceId:g,defaultValue:void 0,persist:!0}),f=(0,le.VK)((()=>null==y?void 0:y.getNameStore()),[y]),x=(0,le.VK)((()=>null==y?void 0:y.getIconStore()),[y]),S=(0,le.VK)((()=>(null==f?void 0:f.getValue())??""),[f]),v=(0,_e.R)({store:o,automationStore:y}),b=(0,le.VK)((()=>{var e;return o.canEdit()&&"sufficient"===(null==v||null===(e=v.state)||void 0===e?void 0:e.executionPermissionStatus)}),[o,v]),{showFactoryButtonDeprecationBanner:C,handleDismissFactoryButtonMigrationBanner:M}=(0,Pe.N)({blockStore:o}),k=(0,le.VK)((()=>null==x?void 0:x.getValue()),[x]),j=(0,le.VK)((()=>{const e=o.getRecordStoreUIRoot();if(e instanceof q.G)return e}),[o]),P=(0,le.VK)((()=>n.state.editing?n.state.placement:void 0),[n]),A=(0,a.useMemo)((()=>{if(y&&j)return new Be.L({type:"button_block",persisted:!0,automationStore:y,blockStore:o,pageStore:j,intl:O.default.getIntl(),parentRecordStore:y,currentUserId:r})}),[y,j,o,r]),T=(0,a.useCallback)((e=>{(0,Te.ZP)({event:e,context:Te.Af.EditorClick,callback:()=>{pe.ZH(i),B.ZH(i)}})}),[i]),w=(0,a.useCallback)((()=>{n.stopEditing(),(0,l.lN)(p,{block_id:o.id,automation_id:null==y?void 0:y.id})}),[y,n,o,p]),I=(0,a.useCallback)(((e,t)=>{y&&K.createAndCommit({userAction:"ButtonBlock.updateProperty",environment:i,perform:o=>{V.sW({store:y.getPropertiesStore(),transaction:o,data:{[e]:t??null}})}})}),[y,i]),F=(0,a.useCallback)((e=>I("icon",e)),[I]),Z=(0,a.useCallback)((e=>I("name",e)),[I]),_=(0,a.useCallback)((e=>{de.$(i,{originRect:e.currentTarget.getBoundingClientRect(),originGap:4,popupWidth:Ae.FZ,popupHeight:Ae.kX,isSmallWidth:!1,title:s.formatMessage({defaultMessage:"Icon",id:"buttonBlock.button.iconHeading"}),currentTab:"icon",tabs:[{type:"icon",onChange:e=>{F(e),de.Z()}},{type:"emoji",onChange:(e,t)=>{F(e),de.Z()}}],onDelete:k?()=>{F(void 0),de.Z()}:void 0})}),[i,F,s,k]),R=(0,le.VK)((()=>n.state.suppressErrorsForActionIds),[n]),W=(0,a.useCallback)((e=>n.suppressErrorsForAction(e.id)),[n]),[L,D]=(0,a.useState)(void 0),N=(0,a.useCallback)((e=>D(e.id)),[]),E=(0,a.useCallback)((()=>D(void 0)),[]),H=t||!b;if(!A||!y)return null;const U=e=>(0,ie.jsx)(ge.Z,{ariaLabel:s.formatMessage(So.addIconButtonAriaLabel),style:{width:26,height:26},iconStyle:{width:16,height:16},hasBackground:!0,disabled:H,showShadow:!0,icon:e=>k?(0,ie.jsx)(fe.Z,{disabled:!0,isEmptyPage:!1,size:24,icon:{icon:k,pointer:o.pointer},style:e}):(0,ue.o)(e),...(0,we.Z)(e??{},{onClick:_})}),z=k?U():(0,ie.jsx)(Se.ZP,{renderTooltip:()=>(0,ie.jsx)(Q.FormattedMessage,{defaultMessage:"Add an icon",id:"buttonBlock.button.addIcon"}),delayThreshold:300,render:U});return(0,ie.jsx)("div",{ref:c,style:e.style,onClick:T,children:(0,ie.jsxs)(Ze.Z.Provider,{value:{automationContextStore:A,automationStore:y,currentDraggingActionId:L,disabled:H,editorPlacement:P,editorWidth:u,maybePersistedTransactionActions:h,onActionAdded:W,onActionDragEnd:E,onActionDragStart:N,suppressActionErrors:R},children:[C&&(0,ie.jsx)("div",{style:d.factoryButtonDeprecationBanner,children:(0,ie.jsx)(je,{handleDismissBanner:M})}),(0,ie.jsxs)(me.p,{allowSelectionWithin:!0,style:d.header,children:[z,(0,ie.jsx)(We.bH,{onChange:Z,value:S,disabled:H,placeholder:O.default.formatMessage(So.buttonPlaceholder),wrapStyle:d.nameInputWrap}),(0,ie.jsx)(he.Z,{onClick:w,children:(0,ie.jsx)(Q.FormattedMessage,{defaultMessage:"Done",id:"buttonBlock.button.done"})})]}),(0,ie.jsx)(xe.Z,{style:d.scroller,type:Fe.Z.Y,children:(0,ie.jsx)("section",{style:{paddingBlock:8,paddingInline:8},children:(0,ie.jsx)(xo,{areActionsEditable:!0,areTriggersEditable:!1})})})]})})}},39477:(e,t,o)=>{o.d(t,{QF:()=>I,li:()=>L});var n=o(67294),i=o(86628),a=o(24405),r=o(3865),s=o(48777),l=o(10450),c=o(23290),u=o(73110),d=o(76218),p=o(6287),m=o(9291),g=o(53965),y=o(1898),h=o(9953),f=o(52275),x=o(31945),S=o(78140),v=o(32163),b=o(72495),C=o(61586),M=o(12455),k=o(73266),j=o(95193),P=o(35294),A=o(40190),T=o(32157),w=o(85893);const V=(0,m.defineMessages)({replaceActionLabel:{id:"automations.AutomationActionSetPropertiesSection.replaceAction.label",defaultMessage:"Replace with"},appendActionLabel:{id:"automations.AutomationActionSetPropertiesSection.appendAction.label",defaultMessage:"Add"},removeActionLabel:{id:"automations.AutomationActionSetPropertiesSection.removeAction.label",defaultMessage:"Remove"},toggleActionLabel:{id:"automations.AutomationActionSetPropertiesSection.toggleAction.label",defaultMessage:"Toggle"},titlePlaceholder:{id:"automations.AutomationActionSetPropertiesSection.titlePlaceholder",defaultMessage:"Untitled"}});function I(e){const{contextStore:t,actionStore:o,collectionStore:a,disabled:r,showSetPropertyActions:s}=e,l=(0,i.VK)((()=>o.id),[o.id]),{maybePersistedTransactionActions:c}=(0,M.i)(),u=(0,i.VK)((()=>{var e;return(null===(e=o.getConfig())||void 0===e?void 0:e.values)??{}}),[o]),d=(0,i.VK)((()=>{var e;return(null===(e=o.getConfig())||void 0===e?void 0:e.properties)??[]}),[o]),p=(0,n.useMemo)((()=>({properties:d,values:u})),[d,u]),m=(0,n.useCallback)((e=>{const t=d.concat([e]),n={...u,[e]:void 0};c.createAndCommit({userAction:"AutomationActionSetPropertiesSection.propertiesChange",perform:e=>{F({configStore:o.getConfigStore(),properties:t,transaction:e,values:n})}})}),[d,u,c,o]),g=(0,n.useCallback)(((e,t)=>{const n=d.indexOf(e);if(-1===n)return;const i=d.slice(0);i[n]=t;const a={...u,[t]:void 0};c.createAndCommit({userAction:"AutomationActionSetPropertiesSection.setProperties",perform:e=>{F({configStore:o.getConfigStore(),properties:i,transaction:e,values:a})}})}),[d,u,c,o]),y=(0,n.useCallback)((e=>{const t=d.filter((t=>t!==e)),n={...u,[e]:void 0};c.createAndCommit({userAction:"AutomationActionSetPropertiesSection.removeProperty",perform:e=>{F({configStore:o.getConfigStore(),properties:t,transaction:e,values:n})}})}),[d,u,c,o]),h=(0,n.useCallback)(((e,t)=>{const n={...u,[e]:t};c.createAndCommit({userAction:"AutomationActionSetPropertiesSection.handleValueChange",perform:e=>{F({configStore:o.getConfigStore(),properties:d,transaction:e,values:n})}})}),[u,c,o,d]);return(0,w.jsx)(B,{contextStore:t,actionId:l,config:p,onPropertyAdd:m,onPropertyChange:g,onPropertyRemove:y,onPropertyValueChange:h,collectionStore:a,showSetPropertyActions:s,disabled:r})}function F(e){const{configStore:t,properties:o,transaction:n,values:i}=e;h.sW({store:t,data:{properties:o,values:i},transaction:n})}function B(e){const{contextStore:t,actionId:o,config:n,collectionStore:s,onPropertyAdd:l,onPropertyChange:c,onPropertyRemove:u,onPropertyValueChange:d,disabled:p,showSetPropertyActions:m}=e,g=(0,a.yK)((e=>({addPropertyValuePlaceholder:{color:e.mediumTextColor,flexGrow:1,textAlign:"right"},addPropertyRow:{display:"flex",alignItems:"center"}})),[]),y=(0,i.VK)((()=>(0,r.cO)({collectionFormat:s.getFormat(),collectionSchema:s.getSchema(),sort:!1,sourcePropertyIds:n.properties})),[s,n.properties]),h=(0,i.VK)((()=>(0,r.cO)({collectionFormat:s.getFormat(),collectionSchema:s.getSchema(),filter:e=>{let[t]=e;return!y.includes(t)}})),[s,y]),f=0===h.length;return(0,w.jsxs)(w.Fragment,{children:[y.length>0&&(0,w.jsx)(Z,{availablePropertyIds:h,contextStore:t,actionId:o,config:{properties:y,values:n.values},collectionStore:s,onPropertyChange:c,onPropertyRemove:u,onPropertyValueChange:d,showSetPropertyActions:m,disabled:p}),!p&&!f&&(0,w.jsx)("div",{style:g.addPropertyRow,children:(0,w.jsx)(T.X,{availablePropertyIds:h,currentValue:void 0,collectionStore:s,onChange:l,disabled:p,alreadyHaveProperties:y.length>0})})]})}function Z(e){const{availablePropertyIds:t,contextStore:o,actionId:n,config:i,collectionStore:r,onPropertyChange:s,onPropertyRemove:l,onPropertyValueChange:c,showSetPropertyActions:u,disabled:d}=e,p=(0,k.a)(),m=(0,a.yK)((()=>({wrap:{alignItems:"center",columnGap:4,display:"grid",gridTemplateColumns:p?"100%":"160px 1fr",minWidth:0,rowGap:p?4:8},propertyValue:{...p?{fontSize:14,marginBlockEnd:16}:{}},lastPropertyValue:{...p?{fontSize:14,marginBlockEnd:0}:{}}})),[p]);return(0,w.jsx)("div",{style:m.wrap,children:i.properties.map(((e,a)=>{const p=a===i.properties.length-1;return(0,w.jsx)(K,{actionId:n,availablePropertyIds:t,collectionStore:r,contextStore:o,disabled:d,onPropertyChange:s,onPropertyRemove:l,onPropertyValueChange:c,property:e,showSetPropertyActions:u,value:i.values[e],valueStyle:p?m.lastPropertyValue:m.propertyValue},e)}))})}function K(e){const{actionId:t,availablePropertyIds:o,collectionStore:r,contextStore:g,disabled:y,onPropertyChange:h,onPropertyRemove:f,onPropertyValueChange:x,property:S,showSetPropertyActions:v,value:b,valueStyle:M}=e,k={type:"collection",collectionStore:r,property:S},j=(0,m.useIntl)(),P=(0,a.yK)((e=>({propertyName:{},propertyValue:{display:"flex",gap:4,minWidth:50,...M}})),[M]),A=(0,n.useMemo)((()=>{if("title"===S)return j.formatMessage(V.titlePlaceholder)}),[j,S]),I=(0,i.VK)((()=>{const e=r.getSchema()[S];if(e)return e}),[r,S]),F=(0,i.VK)((()=>{if(I)return(0,d.qW)({table:p.vF,id:r.id,spaceId:r.getSpaceId()},S,I)}),[r,I,S]),B=(0,i.VK)((()=>null==I?void 0:I.type),[I]),Z=null==b?void 0:b.value,K=(0,i.VK)((()=>(0,c.o9)(b)),[b]),R=(0,i.VK)((()=>g.context.parentRecordStore.getSpaceId()),[g.context.parentRecordStore]),W=(0,i.VK)((()=>{const e=g.getContextValuesForAction(t),o=(0,l.Px)();return e.filter((e=>e.kind!==u.yp.ContextValue||e.id!==o))}),[g,t]),D=(0,n.useCallback)((e=>{h(S,e)}),[h,S]),N=(0,n.useCallback)((()=>f(S)),[f,S]),O=(0,n.useCallback)((e=>{x(S,e)}),[x,S]),E=(0,n.useCallback)((e=>{O({action:e,value:Z})}),[Z,O]),H=(0,n.useCallback)((e=>{O({action:K,value:e})}),[K,O]);if(!F||!R)return null;const U=L(B);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{style:P.propertyName,children:(0,w.jsx)(T.X,{availablePropertyIds:o,currentValue:S,collectionStore:r,onChange:D,disabled:y,onRemove:N})}),(0,w.jsxs)("div",{style:P.propertyValue,children:[v&&I&&s.Y[I.type]&&(0,w.jsx)(_,{disabled:y,onChange:E,value:K}),(0,w.jsx)(C.Z,{...U,type:F,value:null==b?void 0:b.value,onChange:H,disabled:y,contextStore:g,context:k,placeholder:A,disableMobileActionBar:!0,formulaTypecheckContextValues:W,disableTemplateVariableMentions:!0})]})]})}function _(e){const{disabled:t,onChange:o,value:n}=e,i=(0,a.yK)((e=>({button:{boxShadow:e.inputBoxShadow}})),[]),r=(0,P.d)();return(0,w.jsx)(x.ZP,{popupType:r,alignmentToOrigin:x.vR.End,placementToOrigin:x.pO.Bottom,originGap:0,disabled:t,renderOrigin:e=>(0,w.jsx)(A.S,{...e,disabled:t,style:i.button,variant:"gray",children:(0,w.jsx)(W,{action:n})}),render:e=>(0,w.jsx)(R,{onChange:o,parent:e,value:n})})}function R(e){const{value:t,onChange:o,parent:n}=e,i=(0,j.F)({width:250}),a=g.oA(c.E2.map(((e,i)=>({key:i,render:o=>(0,w.jsx)(f.Z,{...o,disabled:!1,title:(0,w.jsx)(W,{action:e}),checkState:t===e}),action:()=>{e!==t&&o(e),n.close()}}))));return(0,w.jsx)(S.Z,{...i,children:(0,w.jsx)(v.Z,{type:v.i.Vertical,sections:[{key:0,render:e=>(0,w.jsx)(b.Z,{enableActionSheetTitle:!0,...e}),items:a}],initialFocus:0})})}function W(e){const{action:t}=e;return"replace"===t?(0,w.jsx)(m.FormattedMessage,{...V.replaceActionLabel}):"append"===t?(0,w.jsx)(m.FormattedMessage,{...V.appendActionLabel}):"remove"===t?(0,w.jsx)(m.FormattedMessage,{...V.removeActionLabel}):"toggle"===t?(0,w.jsx)(m.FormattedMessage,{...V.toggleActionLabel}):void(0,y.t1)(t)}function L(e){return"email"===e||"phone_number"===e||"url"===e?{disableEmojiCommands:!0,disableFormattingAndMentions:!0}:{}}},40190:(e,t,o)=>{o.d(t,{S:()=>g,d:()=>y});var n=o(67294),i=o(480),a=o(24405),r=o(42853),s=o(54497),l=o(37810),c=o(24677),u=o(98104),d=o(89728),p=o(26388),m=o(85893);const g=n.forwardRef(((e,t)=>{const{variant:o,onClick:g,style:y,icon:h,children:f,disabled:x}=e,S=(0,i.O7)(),v=(0,a.yK)((e=>({button:{..."gray"===o&&{color:e.mediumTextColor},..."blue"===o&&{color:e.blueColor,fontWeight:500},..."error"===o&&{color:e.errorText},maxWidth:"calc(100% + 2px)",marginLeft:1,padding:"0 8px 0 5px",...y},warningIcon:{width:12,height:12,marginLeft:-6,marginLeft:6,fill:e.errorText,color:e.errorText},chevronIcon:{width:10,height:10,marginLeft:4,marginTop:2,fill:e.lightIconColor},spacer:{flexGrow:1}})),[o,y]),b=(0,n.useCallback)((e=>{u.ZH(S),c.ZH(S),null==g||g(e)}),[g,S]);return(0,m.jsx)(p.ZP,{renderTooltip:()=>"error"===o?e.errorMessage:null,placement:p.ug.Bottom,disableTooltip:"error"!==o,delayThreshold:0,render:e=>(0,m.jsxs)(d.Z,{...e,style:v.button,icon:h,onClick:b,ref:t,shouldShrink:!0,disabled:x,disabledFeedback:x,children:[(0,m.jsx)("div",{style:{...l.Z.textOverflowStyle},children:f}),(0,m.jsx)("div",{style:v.spacer}),"error"===o&&(0,s.t)(v.warningIcon),(0,r.i)(v.chevronIcon)]})})}));function y(e){const{errorMessage:t,hasValue:o}=e;return(0,n.useMemo)((()=>t?{variant:"error",errorMessage:t}:o?{variant:"gray"}:{variant:"blue"}),[t,o])}},28607:(e,t,o)=>{o.d(t,{D:()=>r});o(67294);var n=o(24405),i=o(64921),a=o(85893);function r(e){const{ariaLabel:t,disabled:o,icon:r,onClick:s,title:l}=e,c=(0,n.yK)((e=>({button:{alignItems:"center",background:e.sidebarBackground,border:`1px dashed ${e.stroke.regular}`,borderRadius:6,display:"flex",color:e.accentColors.gray[900],gap:6,justifyContent:"center",padding:16},buttonWrap:{background:e.sidebarBackground,position:"relative"},iconWrap:{fill:e.accentColors.gray[600]},title:{fontSize:14,lineHeight:1.3}})),[]);return(0,a.jsx)("div",{style:c.buttonWrap,children:(0,a.jsxs)(i.Z,{ariaLabel:t,disabled:o,disabledFeedback:o,onClick:s,style:c.button,children:[r&&(0,a.jsx)("div",{"aria-hidden":"true",style:c.iconWrap,children:r}),(0,a.jsx)("div",{style:c.title,children:l})]})})}},67473:(e,t,o)=>{o.d(t,{nT:()=>R,HC:()=>Z,L5:()=>B,RD:()=>F});var n=o(67294),i=o(480),a=o(86628),r=o(24405),s=o(47453),l=o(9291),c=o(37810),u=o(31945),d=o(73063),p=o(32130),m=o(12455),g=o(73266),y=o(35294),h=o(28607),f=o(45238),x=o(85893);const S=(0,f.IU)("cursorArrowClick2",{viewBox:"0 0 20 20",svg:(0,x.jsxs)("g",{children:[(0,x.jsx)("path",{d:"M0 10.18c0 3.74 2.158 7.04 5.107 8.661 1.026.577 1.875-.79.743-1.445-2.452-1.367-4.18-4.082-4.18-7.217 0-4.609 3.672-8.3 8.281-8.3 4.61 0 8.31 3.691 8.31 8.3 0 .586.45.87.88.87.4 0 .78-.293.78-.87 0-5.449-4.52-9.96-9.97-9.96C4.511.218 0 4.73 0 10.178Z"}),(0,x.jsx)("path",{d:"M3.945 10.18c0 2.177 1.192 4.003 2.618 4.921.986.664 1.835-.654 1.005-1.22a4.41 4.41 0 0 1-2.011-3.702A4.38 4.38 0 0 1 9.95 5.765c2.442 0 4.326 1.944 4.414 4.414.02.45.362.801.81.801.45 0 .802-.351.802-.8 0-3.301-2.725-6.026-6.026-6.026-3.281 0-6.006 2.725-6.006 6.025Z"}),(0,x.jsx)("path",{d:"M9.58 17.25c-.01.38.44.508.684.263l1.494-1.494 1.67 4.121c.078.186.273.274.449.205l.967-.39c.176-.078.244-.283.156-.469l-1.748-4.063 2.1-.078c.37-.02.546-.38.283-.654l-5.332-5.488c-.254-.254-.625-.108-.635.254Z"})]})});var v=o(56812),b=o(66315);function C(){const e=(0,l.useIntl)(),{automationContextStore:t}=(0,m.i)();if(!k((0,a.VK)((()=>null==t?void 0:t.context.automationStore),[t])))return null;const o=e.formatMessage(v.Bo.triggerButtonClicked,{b:M});return(0,x.jsx)(b.R,{icon:S,tooltip:o,children:o})}function M(e){return(0,x.jsx)("span",{style:{fontWeight:c.Z.fontWeight.medium},children:e})}function k(e){return(0,a.VK)((()=>Boolean(null==e?void 0:e.isTriggerType("button"))),[e])}var j=o(53570);function P(){const{automationStore:e}=(0,m.i)(),{removePageAddedTrigger:t}=(0,j.i)(),o=(0,l.useIntl)(),n=(0,r.yK)((()=>({title:{fontWeight:c.Z.fontWeight.medium}})),[]);if(!A(e))return null;const i=v.Mz(o);return(0,x.jsx)(b.R,{icon:s.R,onDelete:t,tooltip:i,children:(0,x.jsx)("div",{style:n.title,children:i})})}function A(e){return(0,a.VK)((()=>{if(!(null!=e&&e.isTriggerType("event")||null!=e&&e.isTriggerType("notification_event")))return!1;const t=e.getEventConfiguration();return Boolean(null==t?void 0:t.pagesAdded)}),[e])}var T=o(61036),w=o(55307);const V="automation-list-item",I="automation-list-item-narrow";function F(e){const{ruleTopOffset:t}=e,o=(0,g.a)();return(0,r.yK)((e=>({wrap:{position:"relative"},list:{marginBottom:o?0:-8},verticalRule:{background:e.stroke.regular,bottom:0,left:20,position:"absolute",top:t??0,width:1}})),[o,t])}function B(){const e=(0,g.a)();return(0,n.useMemo)((()=>`${V} ${e?I:""}`),[e])}function Z(e){const{children:t}=e,o=B();return(0,x.jsx)("div",{className:o,children:t})}function K(e){const{children:t,ruleTopOffset:o}=e,n=F({ruleTopOffset:o});return(0,x.jsxs)("div",{style:n.wrap,children:[(0,x.jsx)("div",{style:n.verticalRule}),(0,x.jsx)("div",{style:n.list,children:t})]})}function _(e){const{variant:t}=e,o=(0,y.d)(),i=(0,l.useIntl)(),a=(0,n.useMemo)((()=>({type:"eventTriggers"})),[]);return(0,x.jsx)(u.ZP,{alignmentToOrigin:u.vR.End,placementToOrigin:u.pO.Bottom,popupType:o,render:e=>(0,x.jsx)(w.Z,{initialState:a,buttonPopupParent:e}),renderOrigin:e=>"icon"===t?(0,x.jsx)(d.Z,{...e,ariaLabel:i.formatMessage(p.sY.addTriggerAriaLabel),icon:s.R}):(0,x.jsx)(h.D,{...e,ariaLabel:i.formatMessage(p.sY.addTriggerAriaLabel),icon:(0,s.R)({height:24,width:12}),title:(0,x.jsx)(l.FormattedMessage,{...p.sY.addTriggerLabel})})})}function R(e){const{isEditable:t}=e,{isMobile:o}=(0,i.Fy)(),{showAnyPropertyTriggers:n,showButtonClickedTrigger:s,showPageAddedTrigger:u}=function(){const{automationContextStore:e}=(0,m.i)(),t=(0,a.VK)((()=>null==e?void 0:e.context.automationStore),[e]),o=k(t),n=A(t),i=(0,T.Zr)(t);return{showAnyPropertyTriggers:i,showPageAddedTrigger:n,showButtonClickedTrigger:o}}(),d=n||s||u,g=(0,r.yK)((e=>({section:{display:"flex",flexDirection:"column",gap:6},header:{alignItems:"center",display:"flex",flexDirection:"row"},headerAdd:{marginLeft:"auto",flexGrow:0,flexShrink:0,visibility:d?void 0:"hidden"},title:{color:e.lightTextColor,fontSize:o?14:12,lineHeight:1.3,fontWeight:c.Z.fontWeight.medium}})),[d,o]);return(0,x.jsxs)("section",{style:g.section,children:[(0,x.jsxs)("header",{style:g.header,children:[(0,x.jsx)("div",{style:g.title,children:(0,x.jsx)(l.FormattedMessage,{...p.sY.triggerTitle})}),t&&(0,x.jsx)("div",{style:g.headerAdd,children:(0,x.jsx)(_,{variant:"icon"})})]}),(0,x.jsxs)(K,{children:[s&&(0,x.jsx)(C,{}),u&&(0,x.jsx)(P,{}),n&&(0,x.jsx)(T.Dl,{}),!d&&t&&(0,x.jsx)(_,{variant:"button"})]})]})}},19471:(e,t,o)=>{o.d(t,{W_:()=>m,bH:()=>p});var n=o(67294),i=(o(480),o(86628)),a=o(9953),r=o(98104),s=(o(13447),o(1743)),l=o(74194),c=o(24098),u=o(12455),d=o(85893);function p(e){const{value:t,onChange:o,wrapStyle:i,...a}=e,[u,p]=(0,n.useState)(!1);return(0,d.jsx)(s.Z,{debugName:"AutomationPlainTextInput",capture:u,children:(0,d.jsx)(c.Z,{capture:!0,render:e=>(0,d.jsx)("div",{...e,style:i,children:(0,d.jsx)(l.Z,{value:t,onChange:e=>o(e.currentTarget.value),onBlur:()=>{p(!1)},onFocus:()=>{r.o9(),p(!0)},...a})})})})}function m(e){const{store:t,...o}=e,{maybePersistedTransactionActions:r}=(0,u.i)(),s=(0,i.VK)((()=>t.getValue()??""),[t]),l=(0,n.useCallback)((e=>{r.createAndCommit({userAction:"AutomationPlainTextInput.setValue",perform:o=>{a.sO({store:t,transaction:o,value:e})}})}),[r,t]);return(0,d.jsx)(p,{value:s,onChange:l,...o})}},32157:(e,t,o)=>{o.d(t,{X:()=>f});var n=o(67294),i=o(480),a=o(86628),r=o(24405),s=o(12396),l=o(9291),c=o(37810),u=o(57410),d=o(31945),p=o(78140),m=o(95193),g=o(35294),y=o(40190),h=o(85893);function f(e){const{alreadyHaveProperties:t,availablePropertyIds:o,collectionStore:f,currentValue:x,disabled:S,onChange:v,onRemove:b,placeholderMessage:C}=e,M=(0,i.O7)(),k=(0,r.Fg)(),{device:j}=M,P=(0,a.VK)((()=>f.getSchema()??{}),[f]),A=(0,a.VK)((()=>f.getFormat()??{}),[f]),T=(0,a.VK)((()=>x?f.getSchema()[x]:void 0),[x,f]),w=(0,r.yK)((e=>({propertyIcon:{fill:e.lightTextColor,height:"auto",marginRight:4,width:16}})),[]),V=(0,n.useCallback)((()=>o),[o]),I=(0,g.d)();return(0,h.jsx)(d.ZP,{popupType:I,alignmentToOrigin:d.vR.End,placementToOrigin:d.pO.Bottom,originGap:0,disabled:S,renderOrigin:e=>(0,h.jsx)(y.S,{...e,disabled:S,icon:T?e=>(0,h.jsx)(s.ZP,{icon:void 0,type:T.type,size:16,theme:k,style:{...e,...w.propertyIcon}}):void 0,variant:t||T?T?"default":"gray":"blue",children:T?(0,h.jsx)(h.Fragment,{children:(0,h.jsx)("div",{style:{fontWeight:c.Z.fontWeight.medium,...c.Z.textOverflowStyle},children:T.name})}):C?(0,h.jsx)(l.FormattedMessage,{...C}):t?(0,h.jsx)(l.FormattedMessage,{id:"automations.propertyPicker.buttonPlaceholderAlreadyHaveProperties",defaultMessage:"Edit another property"}):(0,h.jsx)(l.FormattedMessage,{id:"automations.propertyPicker.buttonPlaceholder",defaultMessage:"Edit a property"})}),render:e=>{const t=(0,m.U)({device:j,width:280,paddingTop:4});return(0,h.jsx)(p.Z,{...t,children:(0,h.jsx)(u.Z,{schema:P,format:A,showRemoveOption:Boolean(b),currentProperty:x,getProperties:V,onAccept:t=>{t&&t!==x?v(t):void 0===t&&(null==b||b(x)),e.close()}})})}})}},8808:(e,t,o)=>{o.d(t,{L:()=>U});o(57658),o(21703);var n=o(67294),i=o(480),a=o(86628),r=o(24405),s=o(84619),l=o(99319),c=o(73110),u=o(35102),d=o(58573),p=o(59054),m=o(56666),g=o(21202),y=o(6287),h=o(9291),f=o(53965),x=o(7032),S=o(1898),v=o(8406),b=o(32628),C=o(73657),M=o(52275),k=o(68894),j=o(78140),P=o(32163),A=o(11470),T=o(72495),w=o(26388),V=o(21396),I=o(78948),F=o(60709),B=o(98742),Z=o(77907),K=o(75822),_=o(80444),R=o(29798),W=o(6258),L=o(95193),D=o(85893);const N=(0,h.defineMessages)({searchInputPlaceholder:{defaultMessage:"Type to search…",id:"automations.AutomationTargetPickerMenu.search.placeholder"}}),O=5,E=20,H=20;function U(e){const t=(0,i.O7)(),o=(0,L.F)({maxWidth:360,paddingTop:12,width:280}),a=(0,n.useMemo)((()=>(0,x.ZP)()),[]),r=(0,n.useCallback)((()=>{v.tW({environment:t,eventName:"abandoned_search",sessionId:a,source:b.S.Automation})}),[t,a]);return o.menuType===F.og.Popup&&(o.onClickOutside=r),(0,D.jsx)(j.Z,{...o,children:(0,D.jsx)(z,{...e,searchSessionId:a})})}function z(e){const{actionId:t,automationContextStore:o,onChange:r,onClose:m,selectedTarget:x,skipCollections:k,skipPages:j,skipVariables:F,searchSessionId:L}=e,N=(0,i.O7)(),E=(0,a.qz)(void 0,R.Z),U=(0,a.VK)((()=>{const{context:e}=o;if("button_property"===e.type)return e.collectionContextStore.collectionViewBlockStore()}),[o]),z=(0,a.VK)((()=>{if(F)return[];const e=(0,S.$K)(t)?o.getContextValuesForAction(t):o.getAllContextValues();if(e){return Object.values(e).filter((e=>{if(!(0,l.uy)(e.type,{type:"block"}))return!1;if("event"===o.context.type&&e.kind===c.yp.ContextValue){const t=(0,u.MY)(e.id);return!("global"===t.source&&"button_page"===t.global)}return!0}))}return[]}),[F,o,t],{useDeepEqual:!0}),Q=(0,n.useMemo)((()=>o.context.parentRecordStore),[o.context]),J=(0,a.VK)((()=>Q.getSpaceId()),[Q]),[X,ee]=(0,n.useReducer)(G,{automationVariables:[],collectionQueryLimit:O,pageQueryLimit:O,searchTerm:""});(0,n.useEffect)((()=>{if(X.searchTerm){const e=(0,d.ZP)(X.searchTerm,z,(e=>e.kind===c.yp.ContextValue?e.name:""));ee({type:"set_variables",variables:e})}else ee({type:"set_variables",variables:z})}),[X.searchTerm,z]);const te=function(e){const{collectionViewBlockStore:t,limit:o,parentStore:r,searchTerm:s,skip:l}=e,c=(0,i.O7)(),u=(0,a.VK)((()=>_.default.state.currentSpaceStore),[]),[d,m]=(0,n.useReducer)(Y,{error:void 0,isLoading:Boolean(l),results:void 0,total:void 0}),g=(0,Z.useDependency)(Z.deps.searchActions),[y]=(0,p.r5)((async()=>{if(l||"resolved"!==g.status)return;const e=g.value,n=await e.searchCollectionsWithRecents({collectionViewBlockStore:t,environment:c,spaceStore:u,limit:o,parentStore:r,query:s,requireEditPermissions:!0,searchSessionId:void 0});return{results:n.results,total:n.total}}),[t,c,o,r,s,l,g.status,g.value,u],{debounce:K.vp});return(0,n.useEffect)((()=>{if("pending"===y.status||"idle"===y.status)m({type:"query_loadstart"});else if("resolved"===y.status){var e,t;m({results:null===(e=y.value)||void 0===e?void 0:e.results,total:null===(t=y.value)||void 0===t?void 0:t.total,type:"query_finish"})}else"rejected"===y.status?m({error:y.error,type:"query_error"}):(0,S.t1)(y)}),[y]),d}({collectionViewBlockStore:U,limit:X.collectionQueryLimit,parentStore:Q,searchTerm:X.searchTerm,skip:k}),oe=function(e){const{limit:t,searchTerm:o,skip:a,spaceId:r}=e,s=(0,i.O7)(),[l,c]=(0,n.useReducer)(Y,{error:void 0,isLoading:Boolean(a),results:void 0,total:void 0}),[u]=(0,p.r5)((async()=>{if(a||!r)return;const e=await Z.deps.searchActions.loader(),n=await e.searchPagesInSpace({boostRecentlyViewedPages:!0,environment:s,excludeTemplates:!0,limit:t,query:o,requireEditPermissions:!1,source:"automation_page_picker",spaceId:r});return{results:n.results.map((e=>e.id)),total:n.total}}),[s,t,o,a,r],{debounce:K.vp});return(0,n.useEffect)((()=>{if("pending"===u.status||"idle"===u.status)c({type:"query_loadstart"});else if("resolved"===u.status){var e,t;c({results:null===(e=u.value)||void 0===e?void 0:e.results,total:null===(t=u.value)||void 0===t?void 0:t.total,type:"query_finish"})}else"rejected"===u.status?c({error:u.error,type:"query_error"}):(0,S.t1)(u)}),[u]),l}({limit:X.pageQueryLimit,searchTerm:X.searchTerm,skip:j,spaceId:J}),ne=(0,n.useCallback)((e=>{"collection"===e.type&&v.tW({environment:N,eventName:"select_search_item",queryLength:X.searchTerm.length,sessionId:L,source:b.S.Automation,totalResults:te.total}),x&&!f.Xy(x,e)?r(e):x?m():r(e)}),[N,L,X.searchTerm,te.total,x,r,m]),ie=(0,n.useCallback)((e=>{const t=e.target.value;ee({searchTerm:t,type:"set_search_term"}),E.setState({focus:{section:0,indexLocal:0,indexGlobal:0}})}),[E]),ae=(0,n.useCallback)((()=>{ee({queryLimit:X.collectionQueryLimit+H,type:"set_collection_query_limit"})}),[X.collectionQueryLimit]),re=(0,n.useCallback)((()=>{ee({queryLimit:X.pageQueryLimit+H,type:"set_page_query_limit"})}),[X.pageQueryLimit]),se="variable"===(null==x?void 0:x.type)?x.id:void 0,le="collection"===(null==x?void 0:x.type)?x.collection.id:void 0,ce="page"===(null==x?void 0:x.type)?x.page.id:void 0,ue=[],de=function(e){const{automationVariables:t,onClick:o,selectedVariableId:n}=e,i=t.map((e=>{if(e.kind!==c.yp.ContextValue)throw new Error("Not implemented yet.");return{action:()=>o({id:e.id,type:"variable"}),key:e.id,render:t=>(0,D.jsx)(w.ZP,{placement:w.ug.Right,render:o=>(0,D.jsx)(M.Z,{...(0,B.Z)(o,t),checkState:e.id===n,title:(0,D.jsx)("div",{style:{display:"flex"},children:(0,D.jsx)(V.F,{value:e,format:s.lo.Medium,isSingle:!0,shouldShrink:!0})})}),renderTooltip:()=>e.name,textWrap:!0})}}));if(0===i.length)return;return{key:"variable_results",items:i,render:e=>(0,D.jsx)(T.Z,{...e,title:(0,D.jsx)(h.FormattedMessage,{defaultMessage:"From this automation",id:"automations.AutomationTargetPickerMenu.variablesSection.title"})})}}({automationVariables:X.automationVariables,onClick:ne,selectedVariableId:se});de&&ue.push(de);const pe=function(e){const{collectionQueryResult:t,onCollectionMenuItemClick:o,onShowMoreItemClick:n,parentRecordStore:i,selectedCollectionId:a}=e;if(t.isLoading)return;let r=[];if(t.error)r.push({action:n,key:"show_more_collection_results",render:e=>(0,D.jsx)(C.Z,{...e,caption:(0,D.jsx)(h.FormattedMessage,{defaultMessage:"Sorry, something went wrong while searching for databases.",id:"automations.AutomationTargetPickerMenu.errorCollections.label"}),shouldWrapCaption:!0})});else{const e=t.results??[],s=e.length;r=e.map((e=>{const t=W.NW.createChildStore(i,{table:y.vF,id:e});return{action:()=>o({collection:t.getSpaceShardedPointer(),type:"collection"}),key:e,render:o=>(0,D.jsx)(A.Z,{...o,checkState:e===a,store:t})}}));const l=t.total??0,c=Math.max(0,l-s);c>0&&r.push({action:n,key:"show_more_collection_results",render:e=>(0,D.jsx)(q,{...e,showMoreCount:c})})}if(0===r.length)return;return{key:"collection_results",items:r,render:e=>(0,D.jsx)(T.Z,{...e,title:(0,D.jsx)(h.FormattedMessage,{defaultMessage:"Databases",id:"automations.AutomationTargetPickerMenu.collectionsSection.title"})})}}({collectionQueryResult:te,onCollectionMenuItemClick:ne,onShowMoreItemClick:ae,parentRecordStore:Q,selectedCollectionId:le});pe&&ue.push(pe);const me=function(e){const{pageQueryResult:t,onPageMenuItemClick:o,onShowMoreItemClick:n,parentRecordStore:i,selectedPageId:a}=e;if(t.isLoading)return;let r=[];if(t.error)r.push({action:n,key:"show_more_collection_results",render:e=>(0,D.jsx)(C.Z,{...e,caption:(0,D.jsx)(h.FormattedMessage,{defaultMessage:"Sorry, something went wrong while searching for pages.",id:"automations.AutomationTargetPickerMenu.errorPages.label"}),shouldWrapCaption:!0})});else{const e=t.results??[],s=e.length;r=e.map((e=>{const t=W.G.createChildStore(i,{table:g.iU,id:e});return{key:e,render:o=>(0,D.jsx)(A.Z,{...o,checkState:e===a,store:t}),action:()=>o({page:t.getSpaceShardedPointer(),type:"page"})}}));const l=t.total??0,c=Math.max(0,l-s);c>0&&r.push({action:n,key:"show_more_page_results",render:e=>(0,D.jsx)(q,{...e,showMoreCount:c})})}if(0===r.length)return;return{key:"page_results",items:r,render:e=>(0,D.jsx)(T.Z,{...e,title:(0,D.jsx)(h.FormattedMessage,{defaultMessage:"Pages",id:"automations.AutomationTargetPickerMenu.pagesSection.title"})})}}({onPageMenuItemClick:ne,onShowMoreItemClick:re,pageQueryResult:oe,parentRecordStore:Q,selectedPageId:ce});me&&ue.push(me);const ge=te.isLoading||oe.isLoading;return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)($,{onChange:ie,value:X.searchTerm}),ge?(0,D.jsx)(T.Z,{children:(0,D.jsx)(I.Z,{})}):!ge&&ue.length>0?(0,D.jsx)(P.Z,{initialFocus:0,sections:ue,store:E,type:P.i.Vertical}):(0,D.jsx)(C.Z,{caption:(0,D.jsx)(h.FormattedMessage,{defaultMessage:"No results",id:"automations.AutomationTargetPickerMenu.noResults.label"})})]})}function $(e){const{onChange:t,value:o}=e,{isMobile:n}=(0,i.Fy)(),a=(0,h.useIntl)(),s=(0,r.yK)((()=>({section:{paddingBlockStart:0}})),[]);return(0,D.jsx)(T.Z,{style:s.section,children:(0,D.jsx)(k.ZP,{focusInitial:!n||void 0,onChange:t,placeholder:a.formatMessage(N.searchInputPlaceholder),showClearButton:!0,value:o??""})})}const q=(0,n.forwardRef)((function(e,t){const{showMoreCount:o}=e,n=(0,r.yK)((e=>({showMoreButton:{color:e.mediumTextColor,fill:e.mediumIconColor}})),[]);return(0,D.jsx)(M.Z,{...e,icon:(0,m.o)({width:16,height:16}),ref:t,style:n.showMoreButton,title:(0,D.jsx)(h.FormattedMessage,{defaultMessage:"Show {showMore} more",id:"automations.AutomationTargetPickerMenu.showMore.label",values:{showMore:Math.min(o,H)}})})}));function G(e,t){if("set_variables"===t.type)return{...e,automationVariables:t.variables.slice(0)};if("set_search_term"===t.type){const o=t.searchTerm?E:O;return{...e,collectionQueryLimit:o,pageQueryLimit:o,searchTerm:t.searchTerm}}if("set_collection_query_limit"===t.type){if(e.collectionQueryLimit!==t.queryLimit)return{...e,collectionQueryLimit:t.queryLimit}}else if("set_page_query_limit"===t.type){if(e.pageQueryLimit!==t.queryLimit)return{...e,pageQueryLimit:t.queryLimit}}else(0,S.t1)(t);return e}function Y(e,t){if("query_loadstart"===t.type){if(!e.isLoading)return{...e,isLoading:!0}}else{if("query_finish"===t.type)return{...e,error:void 0,isLoading:!1,results:t.results,total:t.total};if("query_error"===t.type)return{...e,error:t.error,isLoading:!1,results:void 0,total:void 0};(0,S.t1)(t)}return e}},93060:(e,t,o)=>{o.d(t,{y:()=>s});var n=o(67294),i=o(24405),a=o(26388),r=o(85893);function s(e){const{caption:t,disable:o,renderOrigin:s,title:l,tooltipAlignment:c,tooltipPlacement:u}=e,d=(0,i.yK)((e=>({tooltipTitle:{margin:0},tooltipCaption:{color:e.mediumInvertedTextColor,margin:0}})),[]),p=(0,n.useCallback)((()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{style:d.tooltipTitle,children:l}),(0,r.jsx)("p",{style:d.tooltipCaption,children:t})]})),[t,l,d.tooltipCaption,d.tooltipTitle]);return(0,r.jsx)(a.ZP,{alignment:c,delayThreshold:800,disableTooltip:o,placement:u,render:s,renderTooltip:p,textWrap:!0})}},47957:(e,t,o)=>{o.d(t,{YG:()=>B,Ao:()=>Z,R7:()=>_,vu:()=>K,_S:()=>F});var n=o(94184),i=o.n(n),a=o(67294),r=o(480),s=o(6740),l=o(37989),c=o(86628),u=o(24405),d=o(77744),p=o(98104),m=o(64921),g=o(50478),y=o(75024),h=o(35948),f=o(61766),x=o(12455),S=o(73266),v=o(56666),b=o(9291),C=o(31945),M=o(73063),k=o(53437),j=o(85893);const P=(0,b.defineMessages)({moreLabel:{id:"automationBaseStepElement.moreActionsMenu.title",defaultMessage:"More"}});function A(e){const{actionMenu:t,disabled:o,buttonPopupStore:n}=e,{device:i}=(0,r.O7)(),a=(0,b.useIntl)(),s=(0,u.yK)((e=>({iconButton:{border:`1px solid ${e.regularDividerColor}`,height:26,width:26},icon:{height:14,width:14}})),[]);return(0,j.jsx)(C.ZP,{alignmentToOrigin:C.vR.Center,buttonPopupStore:n,originGap:0,placementToOrigin:C.pO.Bottom,popupType:i.isMobile?k.kQ.SlideUp:k.kQ.Popup,render:()=>t,renderOrigin:e=>(0,j.jsx)(M.Z,{...e,ariaLabel:a.formatMessage(P.moreLabel),disabled:o,disabledFeedback:o,hasBackground:!0,icon:v.o,iconStyle:s.icon,style:s.iconButton})})}const T="automation-list-item-base-step",w="automation-list-item-base-step--disabled",V="automation-list-item-icon",I="automation-list-item-drag-handle";function F(e){const{actionMenu:t,buttonPopupStore:o,children:n,disabled:s,icon:u,onClick:p,onMouseDown:m,onMouseEnter:g,onMouseLeave:y,subtitle:x,styles:v}=e,{isMobile:b}=(0,r.Fy)(),C=(0,c.qz)(o,f.Z),[M,k]=(0,l.Z)(),[P,V]=(0,h.C)(),I=(0,c.VK)((()=>C.getState()),[C]),F=!s&&(b||V||k||I.open),B=R({disabled:s,hasActionMenu:Boolean(t),isActionMenuVisible:F,overrideStyles:v}),Z=(0,S.a)(),K=(0,d.lq)(M,P),_=(0,a.useMemo)((()=>({...B.componentWrap,...B.border})),[B.border,B.componentWrap]);return(0,j.jsxs)("div",{className:i()(T,{[w]:s}),onClick:p,onMouseDown:m,onMouseEnter:g,onMouseLeave:y,ref:K,style:_,children:[(0,j.jsxs)("div",{style:B.headerWrap,children:[!Z&&u&&(0,j.jsx)("div",{"aria-hidden":"true",style:B.iconContainer,children:(0,j.jsx)("div",{style:B.iconWrap,children:u(B.icon)})}),(0,j.jsx)("div",{style:B.titleWrap,children:n})]}),x&&(0,j.jsx)("div",{style:B.subtitleWrap,children:x}),t&&(0,j.jsx)("div",{style:B.actionMenuWrap,children:(0,j.jsx)(A,{actionMenu:t,buttonPopupStore:C,disabled:s})})]})}function B(e){const{actionMenu:t,buttonPopupStore:o,children:n,disabled:a,icon:u,onBlur:g,onClick:y,onFocus:x,onMouseDown:v,onMouseEnter:b,onMouseLeave:C,styles:M,subtitle:k}=e,{isMobile:P}=(0,r.Fy)(),[V,I]=(0,s.Z)(),[F,B]=(0,l.Z)(),[Z,K]=(0,h.C)(),_=(0,c.qz)(o,f.Z),W=(0,c.VK)((()=>_.getState()),[_]),L=(0,d.lq)(Z,F),D=!a&&(P||K||I||B||W.open),N=!a&&K;(0,c.VK)((()=>{W.open||p.sD()}),[W]);const O=R({disabled:a,hasActionMenu:Boolean(t),isActionMenuVisible:D,overrideStyles:M}),E=(0,S.a)();return(0,j.jsxs)("div",{className:i()(T,{[w]:a}),ref:L,style:O.buttonWrap,children:[(0,j.jsxs)(m.Z,{disabled:a,disabledFeedback:a,hovered:N,ignoreLocalHoverState:!0,onBlur:g,onClick:y,onFocus:x,onMouseDown:v,onMouseEnter:b,onMouseLeave:C,ref:V,style:O.componentWrap,children:[(0,j.jsxs)("div",{style:O.headerWrap,children:[!E&&u&&(0,j.jsx)("div",{"aria-hidden":"true",style:O.iconContainer,children:(0,j.jsx)("div",{style:O.iconWrap,children:u(O.icon)})}),(0,j.jsx)("div",{style:O.titleWrap,children:n})]}),k&&(0,j.jsx)("div",{style:O.subtitleWrap,children:k})]}),t&&(0,j.jsx)("div",{style:O.actionMenuWrap,children:(0,j.jsx)(A,{actionMenu:t,buttonPopupStore:_,disabled:a})})]})}function Z(e){const{actionMenu:t,buttonPopupStore:o,children:n,disabled:s,forceShowActionMenu:u,onMouseEnter:m,onMouseLeave:g,styles:y}=e,{isMobile:S}=(0,r.Fy)(),[v,b]=(0,l.Z)(),[C,M]=(0,h.C)(),k=(0,c.qz)(o,f.Z),P=(0,c.VK)((()=>k.getState()),[k]),{currentDraggingActionId:V}=(0,x.i)(),I=(0,d.lq)(C,v),F=!s&&(u||S||M||b||P.open);(0,c.VK)((()=>{P.open||p.sD()}),[P]);const B=R({disabled:s,hasActionMenu:Boolean(t),isActionMenuVisible:F,overrideStyles:y}),Z=(0,a.useMemo)((()=>({...B.componentWrap,...B.border,...V?{cursor:"grabbing"}:{}})),[V,B.border,B.componentWrap]);return(0,j.jsxs)("div",{className:i()(T,{[w]:s}),onMouseEnter:m,onMouseLeave:g,ref:I,style:Z,children:[t&&(0,j.jsx)("div",{style:B.actionMenuWrap,children:(0,j.jsx)(A,{actionMenu:t,buttonPopupStore:k,disabled:s})}),n]})}function K(e){const{children:t,disabled:o,display:n,onMouseEnter:i,onMouseLeave:a,styles:r}=e,s=R({disabled:o,hasActionMenu:!1,isActionMenuVisible:!1,overrideStyles:r}),l=(0,S.a)();return(0,j.jsxs)("header",{onMouseEnter:i,onMouseLeave:a,style:s.headerWrap,children:[!l&&n&&(0,j.jsxs)("div",{"aria-hidden":"true",style:s.iconContainer,children:[(0,j.jsx)("div",{className:V,style:s.iconWrap,children:(0,j.jsx)(W,{display:n})}),(0,j.jsx)("div",{className:I,style:s.iconWrap,children:(0,j.jsx)(g.ZP,{hideClickMessage:!0})})]}),(0,j.jsx)("div",{style:s.titleWrap,children:t})]})}function _(e){const{children:t,disabled:o,styles:n}=e,i=R({disabled:o,hasActionMenu:!1,isActionMenuVisible:!1,overrideStyles:n});return(0,j.jsx)("div",{style:i.bodyWrap,children:t})}function R(e){const{disabled:t,hasActionMenu:o,isActionMenuVisible:n,overrideStyles:i}=e;return(0,u.yK)((e=>({border:{border:`1px solid ${e.stroke.regular}`},buttonWrap:{background:e.cardContentBackground,border:`1px solid ${e.stroke.regular}`,overflow:"hidden",position:"relative"},componentWrap:{background:e.cardContentBackground,display:"flex",flexDirection:"column",gap:14,paddingInline:12,paddingBlock:14,position:"relative",...t?{cursor:"default",pointerEvents:"none"}:{},...null==i?void 0:i.componentWrap},headerWrap:{display:"flex",flexDirection:"row",gap:4,marginInlineEnd:o?38:0,...t?{opacity:.4}:{},...null==i?void 0:i.headerWrap},iconContainer:{marginRight:4,width:24,height:24,position:"relative"},iconWrap:{display:"flex",justifyContent:"center",width:"100%",height:"100%",position:"absolute",...null==i?void 0:i.iconWrap},icon:{fill:e.text.secondary,height:"auto",width:16,...null==i?void 0:i.icon},titleWrap:{alignSelf:"center",flex:"1 1 auto",fontSize:14,lineHeight:1.285,marginBlockStart:1,minWidth:0,whiteSpace:"pre",...null==i?void 0:i.titleWrap},subtitleWrap:{...null==i?void 0:i.subtitleWrap},bodyWrap:{fontSize:14,...null==i?void 0:i.bodyWrap},actionMenuWrap:{flex:"0 0 auto",height:26,position:"absolute",right:12,top:12,width:26,...n?{}:y.jy}})),[t,o,n,i])}function W(e){const{display:t}=e,o=(0,u.yK)((e=>({iconWrap:{width:24,height:24,display:"flex",alignItems:"center",borderRadius:4,background:t.hasSideEffects?"rgba(35, 131, 226, 0.14)":e.accentColors.gray[50],flexShrink:0},icon:{width:14,height:14,fill:t.hasSideEffects?e.blueColor:e.accentColors.gray[500],margin:"0 auto"}})),[t.hasSideEffects]);return(0,j.jsx)("div",{style:o.iconWrap,children:t.icon(o.icon)})}},37867:(e,t,o)=>{o.d(t,{Z:()=>d});o(67294);var n=o(480),i=o(24405),a=o(84619),r=o(54497),s=o(9291),l=o(85567),c=o(56812),u=o(85893);function d(e){let{key:t,tokenFormat:o=a.lo.Medium,isSingle:d,showRemoveButton:p,onClickRemove:m}=e;const{isMobile:g}=(0,n.Fy)(),y=(0,s.useIntl)(),h=(0,i.yK)((e=>{const t="light"===e.mode?400:800,o="light"===e.mode?50:200,n="light"===e.mode?700:900;return{tokenValueWrap:{display:"inline-flex",gap:"4px",alignItems:"baseline"},warning:{color:e.accentColors.orange[t],height:"auto",width:g?16:14},warningWrap:{alignSelf:"center"},token:{backgroundColor:e.accentColors.yellow[o]},textWrap:{color:e.accentColors.yellow[n]}}}),[g]);return(0,u.jsx)(l.Z,{format:o,isSingle:d??!0,showRemoveButton:p??!1,onClickRemove:m,style:h.token,value:(0,u.jsxs)("span",{style:h.tokenValueWrap,children:[(0,u.jsx)("span",{style:h.warningWrap,children:(0,r.t)(h.warning)}),(0,u.jsx)("span",{style:h.textWrap,children:(0,c.ST)(y)})]})},t)}},745:(e,t,o)=>{o.d(t,{e:()=>A});var n=o(67294),i=o(480),a=o(86628),r=o(40745),s=o(8597),l=o(88437),c=o(1230),u=o(41490),d=o(25651),p=o(37612),m=o(9291),g=o(1898),y=o(52275),h=o(91839),f=o(78140),x=o(32163),S=o(72495),v=o(43627),b=o(12455),C=o(95193),M=o(97291),k=o(31524),j=o(85893);const P=(0,m.defineMessages)({addStepAboveMenuItemLabel:{defaultMessage:"Add step above",id:"automations.actionContextMenu.addStepAboveMenuItemLabel"},addStepBelowMenuItemLabel:{defaultMessage:"Add step below",id:"automations.actionContextMenu.addStepBelowMenuItemLabel"},deleteMenuItemLabel:{defaultMessage:"Delete",id:"automations.actionContextMenu.deleteMenuItemLabel"},duplicateAboveMenuItemLabel:{defaultMessage:"Duplicate above",id:"automations.actionContextMenu.duplicateAboveMenuItemLabel"},duplicateBelowMenuItemLabel:{defaultMessage:"Duplicate below",id:"automations.actionContextMenu.duplicateBelowMenuItemLabel"},duplicatingMenuItemLabel:{defaultMessage:"Duplicating…",id:"automations.actionContextMenu.duplicatingMenuItemLabel"},editMenuItemLabel:{defaultMessage:"Edit",id:"automations.actionContextMenu.editMenuItemLabel"},moveDownMenuItemLabel:{defaultMessage:"Move down",id:"automations.actionContextMenu.moveDownMenuItemLabel"},moveUpMenuItemLabel:{defaultMessage:"Move up",id:"automations.actionContextMenu.moveUpMenuItemLabel"}});function A(e){const{actionStore:t,closeMenu:o}=e,{automationContextStore:r,maybePersistedTransactionActions:s}=(0,b.i)(),l=(0,i.O7)(),[c,u]=(0,n.useState)(),d=(0,a.VK)((()=>null==r?void 0:r.context.automationStore),[r]),p=(0,a.VK)((()=>(null==d?void 0:d.getActionIds())??[]),[d]),m=(0,a.VK)((()=>p.indexOf(t.id)),[t.id,p]),g=(0,a.VK)((()=>(0,M.r)(r,t)),[t,r]),y=(0,a.VK)((()=>{if(!g||!t.isType("update_pages"))return;const e=t.getConfigStore().getKeyStore("properties").getValue();return null==e?void 0:e[0]}),[t,g]),h=0===m,f=m===p.length-1,x=(0,n.useCallback)((()=>{u(void 0),null==o||o()}),[o]),S=(0,n.useCallback)((async()=>{if(!d)return;const e=s.createAndCommit({perform:e=>v.duplicateAutomationAction({environment:l,includeParenting:!0,insertionPoint:{beforeActionId:t.id},sourceActionStore:t,transaction:e}),userAction:"ActionContextMenu.duplicateAction"});await e.performResult.onComplete,x()}),[t,d,l,x,s]),C=(0,n.useCallback)((async()=>{if(!d)return;const e=s.createAndCommit({perform:e=>v.duplicateAutomationAction({sourceActionStore:t,environment:l,includeParenting:!0,insertionPoint:{afterActionId:t.id},transaction:e}),userAction:"ActionContextMenu.duplicateAction"});await e.performResult.onComplete,x()}),[t,d,l,x,s]),P=(0,n.useCallback)((()=>{const e=null==r?void 0:r.context;return e?(s.createAndCommit({perform:o=>{v.removeAutomationAction({actionStore:t,clientContext:e,environment:l,transaction:o})},userAction:"ActionContextMenu.removeAction"}),x(),Promise.resolve()):Promise.resolve()}),[t,null==r?void 0:r.context,l,x,s]),A=(0,n.useCallback)((()=>{const e=null==r?void 0:r.context;if(!e)return Promise.resolve();s.createAndCommit({perform:t=>{const o=V(p,m-1,m);v.reorderAutomationActions({clientContext:e,newActionIds:o,transaction:t})},userAction:"ActionContextMenu.moveAction"}),x()}),[p,null==r?void 0:r.context,m,x,s]),w=(0,n.useCallback)((()=>{const e=null==r?void 0:r.context;if(!e)return Promise.resolve();s.createAndCommit({perform:t=>{const o=V(p,m+1,m);v.reorderAutomationActions({clientContext:e,newActionIds:o,transaction:t})},userAction:"ActionContextMenu.moveAction"}),x()}),[p,null==r?void 0:r.context,m,x,s]),I=(0,n.useMemo)((()=>{if(g&&y)return function(){u({initialState:{actionId:t.id,propertyId:y,type:"eventActionProperty"},insertionPoint:void 0})}}),[t.id,g,y]),F=(0,n.useCallback)((()=>{u({initialState:{availableActions:[],hasUpdateThisPagePropertyActions:!0,hasSearch:!0,type:"eventActions"},insertionPoint:{beforeActionId:t.id}})}),[t.id]),B=(0,n.useCallback)((()=>{u({initialState:{availableActions:[],hasUpdateThisPagePropertyActions:!0,hasSearch:!0,type:"eventActions"},insertionPoint:{afterActionId:t.id}})}),[t.id]);return(0,j.jsxs)(j.Fragment,{children:[!c&&(0,j.jsx)(T,{onAddStepAbove:F,onAddStepBelow:B,onDelete:P,onDuplicateAbove:S,onDuplicateBelow:C,onEdit:I,onMoveDown:f?void 0:w,onMoveUp:h?void 0:A}),c&&(0,j.jsx)(k.Z,{initialState:c.initialState,insertionPoint:c.insertionPoint,onClose:x})]})}function T(e){const{onAddStepAbove:t,onAddStepBelow:o,onDelete:i,onDuplicateAbove:a,onDuplicateBelow:y,onEdit:h,onMoveDown:v,onMoveUp:b}=e,M=(0,C.F)(),k=function(e){const{hasSeparator:t,onMoveDown:o,onMoveUp:i}=e,a=(0,n.useMemo)((()=>{if(i)return{action:i,key:"moveUp",render:e=>(0,j.jsx)(w,{...e,icon:(0,s.Z)({height:16,width:16}),children:(0,j.jsx)(m.FormattedMessage,{...P.moveUpMenuItemLabel})})}}),[i]),l=(0,n.useMemo)((()=>{if(o)return{action:o,key:"moveDown",render:e=>(0,j.jsx)(w,{...e,icon:(0,r.M)({height:16,width:16}),children:(0,j.jsx)(m.FormattedMessage,{...P.moveDownMenuItemLabel})})}}),[o]),c=[a,l].filter(g.$K);if(0===c.length)return;return{items:c,key:"moveSteps",render:e=>(0,j.jsx)(S.Z,{enableActionSheetTitle:!0,topBorder:t,...e})}}({onMoveDown:v,onMoveUp:b}),A=function(e){const{hasSeparator:t,onAddStepAbove:o,onAddStepBelow:i}=e,a=(0,n.useMemo)((()=>{if(o)return{action:o,key:"addStepAbove",render:e=>(0,j.jsx)(w,{...e,icon:(0,u.F)({height:16,width:16}),children:(0,j.jsx)(m.FormattedMessage,{...P.addStepAboveMenuItemLabel})})}}),[o]),r=(0,n.useMemo)((()=>{if(i)return{action:i,key:"addStepBelow",render:e=>(0,j.jsx)(w,{...e,icon:(0,c.H)({height:16,width:16}),children:(0,j.jsx)(m.FormattedMessage,{...P.addStepBelowMenuItemLabel})})}}),[i]),s=[a,r].filter(g.$K);if(0===s.length)return;return{items:s,key:"addSteps",render:e=>(0,j.jsx)(S.Z,{enableActionSheetTitle:!0,topBorder:t,...e})}}({hasSeparator:Boolean(k),onAddStepAbove:t,onAddStepBelow:o}),T=function(e){const{hasSeparator:t,onDuplicateAbove:o,onDuplicateBelow:i}=e,[a,r]=(0,n.useState)(!1),s=(0,n.useMemo)((()=>{if(o)return{action:async()=>{r(!0);try{await o()}finally{r(!1)}},key:"duplicateAbove",render:e=>(0,j.jsx)(w,{...e,icon:(0,l.a)({height:16,width:16}),isLoading:a,children:a?(0,j.jsx)(m.FormattedMessage,{...P.duplicatingMenuItemLabel}):(0,j.jsx)(m.FormattedMessage,{...P.duplicateAboveMenuItemLabel})})}}),[a,o]),c=(0,n.useMemo)((()=>{if(i)return{action:async()=>{r(!0);try{await i()}finally{r(!1)}},key:"duplicateBelow",render:e=>(0,j.jsx)(w,{...e,icon:(0,l.a)({height:16,width:16}),isLoading:a,children:a?(0,j.jsx)(m.FormattedMessage,{...P.duplicatingMenuItemLabel}):(0,j.jsx)(m.FormattedMessage,{...P.duplicateBelowMenuItemLabel})})}}),[a,i]),u=[s,c].filter(g.$K);if(0===u.length)return;return{items:u,key:"duplicateSteps",render:e=>(0,j.jsx)(S.Z,{enableActionSheetTitle:!0,topBorder:t,...e})}}({hasSeparator:Boolean(k||A),onDuplicateAbove:a,onDuplicateBelow:y}),V=function(e){const{hasSeparator:t,onDelete:o,onEdit:i}=e,a=(0,n.useMemo)((()=>{if(i)return{action:i,key:"edit",render:e=>(0,j.jsx)(w,{...e,icon:(0,d.R)({height:16,width:16}),children:(0,j.jsx)(m.FormattedMessage,{...P.editMenuItemLabel})})}}),[i]),r=(0,n.useMemo)((()=>{if(o)return{action:o,key:"delete",render:e=>(0,j.jsx)(w,{...e,icon:(0,p.y)({height:16,width:16}),children:(0,j.jsx)(m.FormattedMessage,{...P.deleteMenuItemLabel})})}}),[o]),s=[a,r].filter(g.$K);if(0===s.length)return;return{items:s,key:"otherActions",render:e=>(0,j.jsx)(S.Z,{enableActionSheetTitle:!0,topBorder:t,...e})}}({hasSeparator:Boolean(k||A||T),onDelete:i,onEdit:h});return(0,j.jsx)(f.Z,{...M,children:(0,j.jsx)(x.Z,{type:x.i.Vertical,sections:[k,A,T,V].filter(g.$K),initialFocus:0})})}function w(e){const{children:t,icon:o,isLoading:n,...i}=e,a=n?(0,j.jsx)(h.Z,{}):o;return(0,j.jsx)(y.Z,{...i,disabled:n,disabledFeedback:n,icon:a,title:t})}function V(e,t,o){if(t<0||t>=e.length||o<0||o>=e.length)return e;const n=[...e];return n[t]=e[o],n[o]=e[t],n}},31524:(e,t,o)=>{o.d(t,{Z:()=>Ae});var n=o(67294),i=o(86628),a=o(1898),r=o(91738),s=(o(57658),o(43261)),l=o.n(s),c=o(480),u=o(24405),d=o(3865),p=o(2647),m=o(12396),g=o(9999),y=o(65422),h=o(5257),f=o(9291),x=o(7032),S=o(52275),v=o(68894),b=o(78140),C=o(32163),M=o(72495),k=o(49117),j=o(65183),P=o(33929),A=o(63474),T=o(44041),w=o(35057),V=o(43627),I=o(12455),F=o(95193),B=o(59786),Z=o(59054);var K=o(85893);const _=(0,f.defineMessages)({searchInputPlaceholder:{id:"automationEventActionMenu.searchInputPlaceholder.label",defaultMessage:"Search for action…"}}),R=["automation_actions","update_this_page_actions"],W=["update_this_page_actions","automation_actions"];function L(e){const{automationActionMenuStore:t,hasSearch:o,hasUpdateThisPagePropertyActions:r,onClose:s}=e,{isMobile:u}=(0,c.Fy)(),m=(0,c.O7)(),g=(0,f.useIntl)(),y=(0,A.D)(),{automationContextStore:h,automationStore:v,maybePersistedTransactionActions:_,onActionAdded:L}=(0,I.i)(),O=(0,i.VK)((()=>null==h?void 0:h.getCollectionStore()),[h]),H=function(){const{automationContextStore:e}=(0,I.i)(),[t,o]=(0,n.useState)([]),a=(0,i.VK)((()=>e?(0,k.uV)(e.context.automationStore,e.context.type):void 0),[e]),r=(0,n.useMemo)((()=>(0,B.P)("display")),[]),s=(0,i.VK)((()=>a?r.map((e=>e.isAvailableForContext(a))):[]),[r,a]);return(0,Z.r5)((async()=>{const e=await Promise.all(s);o(function(e){const t=e=>e?1:-1;return e.slice().sort(((e,o)=>t(o.display.hasSideEffects)-t(e.display.hasSideEffects)))}(r.filter(((t,o)=>e[o]))))}),[r,s]),t}(),z=(0,i.VK)((()=>null==h?void 0:h.context.type),[h]),$="event"===z,q=(0,n.useMemo)((()=>$?W:R),[$]),G=(0,i.VK)((()=>t.getInsertionPoint()),[t]),[Y,Q]=n.useState(""),J=(0,i.VK)((()=>o?function(e){const{availableActions:t,searchInput:o}=e;if(0===t.length)return[];const n=new Map,i=t.map((e=>{const t=P.default.formatMessage(e.display.name);return n.set(e.type,t),t})),a=new Set(l().filter(o,i).map((e=>{let{original:t}=e;return t})));return t.filter((e=>{const t=n.get(e.type);return t&&a.has(t)}))}({availableActions:H,searchInput:Y}):H),[H,o,Y]),X=(0,n.useCallback)((e=>{if(!v)return;const{performResult:t}=_.createAndCommit({userAction:"AutomationActionList.addAction",perform:t=>V.addAutomationAction({actionId:(0,x.ZP)(),actionType:e,automationStore:v,environment:m,insertionPoint:G,intl:g,transaction:t})});t&&((0,p.eI)(y,{automation_id:v.id,automation_action_id:t.id,automation_action_type:e}),null==L||L(t)),s()}),[v,_,s,m,G,g,y,L]),ee=(0,i.VK)((()=>r&&O&&v?function(e){const{automationStore:t,collectionStore:o,searchInput:n}=e,i=new Set(t.getActionStores().flatMap((e=>e.isType("update_pages")?e.getConfigStore().getKeyStore("properties").getValue()??[]:[]))),r=o.getFormat(),s=o.getSchema(),c=(0,d.cO)({collectionFormat:r,collectionSchema:s,filter:e=>{let[t]=e;return!i.has(t)}}),u=new Map,p=c.map((e=>{const t=s[e];if(t){const o=`${t.name} ${j.SO[t.type]}`;return u.set(e,o),o}})).filter(a.$K),m=new Set(l().filter(n,p).map((e=>{let{original:t}=e;return t})));return c.filter((e=>{const t=u.get(e);return t&&m.has(t)}))}({automationStore:v,collectionStore:O,searchInput:Y}):[]),[v,O,r,Y]),te=(0,i.VK)((()=>null==O?void 0:O.getSchema()),[O]),oe=(0,n.useCallback)((()=>{s(),T.y(m,{for:"plus",from:"database_automation_action_item"})}),[m,s]),ne=(0,k.Rr)({contextType:z,environment:m}),ie=(0,i.VK)((()=>!(0,w.sX)()),[]),ae=0===H.length&&ie,re=(0,n.useMemo)((()=>{const e=[];o&&!ae&&e.push(function(e){const{onChange:t,value:o}=e;return{items:[{action:()=>{},key:"search-input",render:e=>(0,K.jsx)(D,{...e,onChange:t,value:o})}],key:"search",render:e=>(0,K.jsx)(M.Z,{...e})}}({onChange:e=>Q(e.target.value),value:Y}));const n=q.reduce(((e,o)=>{if("automation_actions"===o){const t=function(e){const{actionRegistryItems:t,hasTopBorder:o,onMenuItemClick:n}=e,i=t.map((e=>function(e){const{actionRegistryItem:t,onClick:o}=e;return{action:()=>o(t.type),key:`${t.type}_action`,render:e=>(0,K.jsx)(N,{...e,actionRegistryItem:t})}}({actionRegistryItem:e,onClick:n}))).filter(a.$K);if(0===i.length)return;return{key:"automation_actions_section",items:i,render:e=>(0,K.jsx)(M.Z,{...e,topBorder:o})}}({actionRegistryItems:J,hasTopBorder:e.length>0,onMenuItemClick:X});t&&e.push(t)}else if("update_this_page_actions"===o){const o=te&&!(ie&&$)&&function(e){const{automationActionMenuStore:t,hasTopBorder:o,normalizedBlockSchema:n,propertyIds:i}=e;if(0===i.length)return;const r=i.map((e=>{const o=n[e];if(o)return function(e){const{automationActionMenuStore:t,propertyId:o,propertySchema:n}=e;return{action:()=>{t.pushSettingsItem({actionId:void 0,propertyId:o,type:"eventActionProperty"})},key:`update_this_page_property_${o}_action`,render:e=>(0,K.jsx)(E,{...e,propertySchema:n})}}({automationActionMenuStore:t,propertyId:e,propertySchema:o})})).filter(a.$K);if(0===r.length)return;return{key:"automation_update_this_page_section",items:r,render:e=>(0,K.jsx)(M.Z,{...e,title:(0,K.jsx)(f.FormattedMessage,{id:"automationEventActionMenu.pagePropertiesEditedSection.title",defaultMessage:"Edit property"}),topBorder:o})}}({automationActionMenuStore:t,hasTopBorder:e.length>0,normalizedBlockSchema:te,propertyIds:ee});o&&e.push(o)}else(0,a.t1)(o);return e}),[]);return 0===n.length?e.push({key:"no_results_section",items:[{key:"no_results_item",action:()=>{},render:e=>(0,K.jsx)(S.Z,{...e,disabled:!0,disabledFeedback:!0,title:(0,K.jsx)(f.FormattedMessage,{defaultMessage:"No results",id:"automations.automationEventActionMenu.noResultsItem"})})}],render:e=>(0,K.jsx)(M.Z,{...e})}):e.push(...n),ie&&ne&&e.push(function(e){const{onUpsellClick:t,hasTopBorder:o}=e;return{key:"upsell_section",items:[{action:t,key:"upsell_item",render:e=>(0,K.jsx)(U,{...e})}],render:e=>(0,K.jsx)(M.Z,{...e,topBorder:o})}}({hasTopBorder:e.length>0,onUpsellClick:oe})),e}),[t,ee,J,ne,te,o,$,ie,ae,X,oe,Y,q]),se=(0,F.F)({paddingBottom:6,paddingTop:6,width:266});return u||(se.maxHeight="50vh"),(0,K.jsx)(b.Z,{...se,children:(0,K.jsx)(C.Z,{initialFocus:0,sections:re,type:C.i.Vertical})})}function D(e){const{onChange:t,value:o,...n}=e,i=(0,f.useIntl)(),a=(0,u.yK)((()=>({input:{margin:0,padding:0}})),[]);return(0,K.jsx)(v.ZP,{...n,inputOuterStyle:{margin:0},onChange:t,placeholder:i.formatMessage(_.searchInputPlaceholder),style:a.input,value:o})}function N(e){const{actionRegistryItem:t,...o}=e;return(0,K.jsx)(S.Z,{...o,icon:(0,K.jsx)(O,{actionRegistryItem:t}),title:(0,K.jsx)(f.FormattedMessage,{...t.display.name})})}function O(e){const{actionRegistryItem:t}=e,o="slack_notification"===t.type,n=(0,u.yK)((e=>({icon:{fill:o?void 0:e.blueColor,height:"auto",width:o?16:12},iconWrap:{alignItems:"center",background:o?void 0:"rgba(35, 131, 226, 0.14)",borderRadius:4,display:"flex",height:20,justifyContent:"center",width:20}})),[o]);return(0,K.jsx)("div",{style:n.iconWrap,children:t.display.icon(n.icon)})}function E(e){const{propertySchema:t,...o}=e,n=(0,u.yK)((e=>({chevronIcon:{marginInlineStart:6,width:12,height:"auto"}})),[]);return(0,K.jsx)(S.Z,{...o,icon:(0,K.jsx)(H,{propertySchema:t}),right:(0,h.o)(n.chevronIcon),title:t.name})}function H(e){const{propertySchema:t}=e,o=(0,u.Fg)(),n=(0,u.yK)((e=>({icon:{fill:e.blueColor,width:12},iconWrap:{alignItems:"center",background:"rgba(35, 131, 226, 0.14)",borderRadius:4,display:"flex",height:20,justifyContent:"center",width:20}})),[]);return(0,K.jsx)("div",{style:n.iconWrap,children:(0,K.jsx)(m.ZP,{icon:t.icon,size:16,style:n.icon,theme:o,type:t.type})})}function U(e){const t=(0,u.yK)((e=>({aliasIcon:{height:"auto",marginBlockStart:2,width:12},icon:{fill:e.icon.yellow,height:"100%",width:"100%"},iconWrap:{background:e.accentColors.yellow[50],borderRadius:4,height:20,padding:3,width:20},right:{alignSelf:"start"}})),[]);return(0,K.jsx)(S.Z,{...e,caption:(0,K.jsx)(f.FormattedMessage,{defaultMessage:"Automatically set properties, create new pages, and more with automations.",id:"automationEventActionMenu.upsellSection.caption"}),icon:(0,K.jsx)("div",{style:t.iconWrap,children:(0,y.K)(t.icon)}),right:(0,g.J)(t.aliasIcon),rightStyle:t.right,shouldWrapCaption:!0,title:(0,K.jsx)(f.FormattedMessage,{defaultMessage:"Upgrade for more actions",id:"automationEventActionMenu.upsellSection.title"})})}var z=o(10450),$=o(30823),q=o(99036),G=o(76218),Y=o(70203),Q=o(37810),J=o(9953),X=o(53498),ee=o(39477),te=o(25757);const oe=(0,f.defineMessages)({menuHeaderTitle:{defaultMessage:"Set {propertyName} to",id:"automations.eventActionProperty.menuHeaderTitle"}});function ne(e){var t;const{actionId:o,automationActionMenuStore:a,onClose:r,propertyId:s}=e,{automationContextStore:l,automationStore:u,maybePersistedTransactionActions:d,onActionAdded:m}=(0,I.i)(),g=(0,f.useIntl)(),y=(0,c.O7)(),h=(0,A.D)(),S=(0,i.VK)((()=>a.getInsertionPoint()),[a]),v=(0,i.VK)((()=>null==l?void 0:l.getCollectionStore()),[l]),b=(0,n.useMemo)((()=>v?{collectionStore:v,property:s,type:"collection"}:void 0),[v,s]),C=o??(0,x.ZP)(),M=(0,i.VK)((()=>{const e=((null==u?void 0:u.getActionStores())??[]).find((e=>e.id===C));if(e&&e.isType("update_pages"))return e}),[u,C]),k=(0,i.VK)((()=>null==v?void 0:v.getSchema()[s]),[v,s]),j=(0,n.useMemo)((()=>!!k&&("multi_select"===k.type||(0,q.en)(k)&&1!==k.limit)),[k]),P=Boolean(k&&"button"!==k.type&&"rollup"!==k.type&&"formula"!==k.type&&"text"===(0,$.vc)(k.type)),T=Boolean(k&&"button"!==k.type&&"rollup"!==k.type&&"formula"!==k.type&&"number"===(0,$.vc)(k.type)),w=Boolean(k&&"date"===k.type),F=Boolean(k&&"status"===k.type),B=(0,i.VK)((()=>{if(v&&k)return(0,G.qW)(v.getSpaceShardedPointer(),s,k)}),[v,k,s]),Z=(0,i.VK)((()=>{if(M)return M.getConfigStore().getKeyStore("values").getKeyStore(s).getValue()}),[M,s]),[_,R]=(0,n.useState)(Z),W=(0,n.useRef)(null==Z?void 0:Z.value),L=(0,G.A6)(null==_||null===(t=_.value)||void 0===t?void 0:t.value),D=(0,i.VK)((()=>l?M?l.getContextValuesForAction(M.id):l.getAllContextValues():[]),[M,l]),N=(0,n.useCallback)((e=>{if(!u)return;const{performResult:t}=d.createAndCommit({perform:t=>{if(!M)return V.addAutomationAction({actionId:C,actionType:"update_pages",automationStore:u,config:{properties:[s],target:{id:(0,z.J0)(),type:"variable"},values:{[s]:{action:"replace",value:e}}},environment:y,intl:g,insertionPoint:S,transaction:t});J.sW({data:{[s]:{action:"replace",value:e}},store:M.getConfigStore().getKeyStore("values"),transaction:t})},userAction:"UpdateThisPagePropertyActionMenu.saveChanges"});t&&((0,p.eI)(h,{automation_id:u.id,automation_action_id:t.id,automation_action_type:"update_pages"}),null==m||m(t))}),[M,u,y,h,C,S,g,d,m,s]),O=(0,n.useCallback)((()=>{N(W.current),r()}),[N,r]),E=(0,n.useCallback)((e=>{if(W.current=e,P||T||j)R({action:"replace",value:e});else if(w){const t=(0,G.A6)(null==e?void 0:e.value);0===t.length?O():(0,G.S3)(t[0])&&(0,Y.fpG)(t[0])&&R({action:"replace",value:e})}}),[w,P,T,j,O]),H=(0,te.F)({automationTriggerActionMenuStore:a,leftStyle:{flexGrow:0},onClose:O,onDone:j||P||T?O:void 0,rightStyle:{flexGrow:0},title:(0,K.jsx)("div",{style:{display:"inline-flex",minWidth:0,whiteSpace:"pre"},children:g.formatMessage(oe.menuHeaderTitle,{propertyName:(0,K.jsx)("div",{style:{...Q.Z.textOverflowStyle},children:(null==k?void 0:k.name)??""})})}),titleStyle:{minWidth:0}});if(!(k&&B&&l&&b))return null;const U=(0,ee.li)(k.type);return(0,K.jsx)(X.a,{context:b,contextStore:l,currentSimpleFormulaValueTokens:L,disabled:!1,formulaTypecheckContextValues:D,menuProps:H,onChange:E,onClose:O,showClearButton:!F,type:B,value:null==_?void 0:_.value,...U})}var ie=o(41892),ae=o(77657),re=o(32161),se=o(40470),le=o(89475),ce=o(89728),ue=o(58297),de=o(18441),pe=o(80444),me=o(30874),ge=o(6258);function ye(e){const{type:t,automationActionMenuStore:o,onClose:n}=e,a=ve(),r=(0,i.VK)((()=>{var e;return null===(e=pe.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),s=(0,i.VK)((()=>pe.default.state.currentUserStore),[]),l=(0,i.VK)((()=>{if("connectToSlackReconnect"===t&&s)return(0,ge.Kv)(s,{table:re.PJ,id:e.externalBotId,spaceId:r}).getValue()}),[r,s,e,t]);let c,u=Se({viewType:"connectToSlackDefault"});if("connectToSlackReconnect"===t){if(!l)return null;const{accountName:e,organizationName:t}=(0,de.jg)(l);c=(0,de.jc)(l),u=Se({viewType:"connectToSlackReconnect",accountName:e,organizationName:t})}return(0,K.jsx)(te.Z,{type:"custom",automationTriggerActionMenuStore:o,onClose:n,children:(0,K.jsx)(M.Z,{children:(0,K.jsxs)("div",{style:a.container,children:[(0,K.jsx)(fe,{}),(0,K.jsxs)("div",{style:a.connectToSlackBody,children:[(0,K.jsx)("div",{style:a.connectToSlackTitleText,children:xe(t)}),(0,K.jsx)("div",{style:a.connectToSlackDescriptionText,children:u})]}),(0,K.jsx)(he,{...e,slackWorkspaceId:c})]})})})}function he(e){const{automationActionMenuStore:t,slackWorkspaceId:o}=e,n=(0,c.O7)(),r=ve(),s=(0,i.VK)((()=>{var e;return null===(e=pe.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),l=(0,i.VK)((()=>me.Z.integrations.state.find((e=>e.id===ae.nO))),[]);return l&&s?(0,K.jsxs)("div",{style:r.buttonGroup,children:[(0,K.jsx)(ue.Z,{style:r.connectToSlackButton,isLarge:!0,onClick:async()=>{const i=await le.hM({environment:n,integration:l,spaceId:s,from:"collection_view_settings",options:{slackWorkspaceId:o}});se.x.isFail(i)?t.replaceSettingsItem({actionStore:e.actionStore,type:"selectWorkspace"}):"connectToSlackReconnect"===e.type||("connectToSlackDefault"===e.type?i.value.externalAuthentication?t.replaceSettingsItem({type:"selectChannelNew",currentExternalAuthentication:i.value.externalAuthentication,actionStore:e.actionStore}):t.replaceSettingsItem({actionStore:e.actionStore,type:"selectWorkspace"}):(0,a.t1)(e))},children:(0,K.jsx)(f.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.connectButton.label",defaultMessage:"Connect"})}),(0,K.jsx)(ce.Z,{style:r.cancelButton,isLarge:!0,onClick:()=>{t.popSettingsItem()},children:(0,K.jsx)(f.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.cancelButton.label",defaultMessage:"Cancel"})})]}):null}function fe(){const e=ve();return(0,K.jsx)("div",{children:(0,K.jsx)("img",{src:ie.Z.images.externalIntegrations.slackIconPng,style:e.slackIcon})})}function xe(e){return"connectToSlackDefault"===e?(0,K.jsx)(f.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.title",defaultMessage:"Connect to Slack"}):"connectToSlackReconnect"===e?(0,K.jsx)(f.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.reconnect.title",defaultMessage:"Reconnect to Slack"}):void(0,a.t1)(e)}function Se(e){const{viewType:t}=e;return"connectToSlackDefault"===t?(0,K.jsx)(f.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.description",defaultMessage:"Get notified in channels, see rich previews, and more."}):"connectToSlackReconnect"===t?(0,K.jsx)(f.FormattedMessage,{id:"AutomationSlackConnectToSlackView.reconnect.description",defaultMessage:'Reconnect your Slack account ({accountName}) on {hasOrganizationName, select, true {"{organizationName}"} other {your Slack workspace}} to resume your notifications.',values:{accountName:e.accountName,hasOrganizationName:(0,a.$K)(e.organizationName),organizationName:e.organizationName}}):void(0,a.t1)(t)}function ve(){return(0,u.yK)((e=>({container:{display:"flex",flexDirection:"column",margin:"10px 15px",justifyContent:"center",textAlign:"center"},connectToSlackBody:{margin:"0px 25px"},connectToSlackTitleText:{marginBottom:2,fontWeight:Q.Z.fontWeight.semibold},connectToSlackDescriptionText:{fontSize:13,color:e.mediumTextColor},slackIcon:{width:23,height:"auto"},buttonGroup:{margin:"10px 10px 0px 10px"},connectToSlackButton:{width:"100%"},cancelButton:{color:e.mediumTextColor,width:"100%",justifyContent:"center",fontWeight:Q.Z.fontWeight.medium,fontSize:13,marginTop:8}})),[])}var be=o(86538);function Ce(e){const{actionStore:t,automationActionMenuStore:o,onClose:i}=e,{maybePersistedTransactionActions:r}=(0,I.i)(),s=n.useCallback(((e,o)=>{t&&r.createAndCommit({perform:n=>{J.sW({data:{config:{external_bot_id:o.parent_id,target:{id:e.id,name:"",type:e.type}}},store:t,transaction:n})},userAction:"SlackSelectChannelMenu.handleChannelSelect"}),i()}),[t,r,i]),l=(0,n.useCallback)((()=>{const e=o.getState().stack;e.length<2||("selectWorkspace"===e[e.length-2].type?o.popSettingsItem():o.replaceSettingsItem({actionStore:t,type:"selectWorkspace"}))}),[t,o]);return(0,K.jsx)(be.ZP,{currentExternalAuthentication:e.currentExternalAuthentication,currentNotificationChannel:"selectChannelNew"===e.type?void 0:"selectChannelUpdate"===e.type?e.currentNotificationChannel:(0,a.t1)(e),onClose:i,onNotificationChannelSelect:s,onNewSlackAccountAdded:l,renderMenu:e=>(0,K.jsx)(te.Z,{type:"default",automationTriggerActionMenuStore:o,headerTitle:(0,K.jsx)(f.FormattedMessage,{id:"notificationRuleSettings.selectChannelView.title",defaultMessage:"Select Slack channel"}),sections:e,onClose:i})})}o(30541);var Me=o(35840);const ke=(0,f.defineMessages)({workspaceSearchPlaceholder:{id:"notificationRuleSettings.selectWorkspaceView.searchInput.placeholder",defaultMessage:"Search…"}});function je(e){const{onWorkspaceSelect:t,renderMenu:o,workspaceFilter:a,onNewSlackAccountAdded:r}=e,s=(0,c.O7)(),{isMobile:l}=(0,c.Fy)(),d=(0,i.VK)((()=>{var e;return null===(e=pe.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),p=(0,i.VK)((()=>(0,de.P9)(me.Z.completeSlackAuthentications.state,a)),[a]),m=(0,i.VK)((()=>me.Z.integrations.state.find((e=>e.id===ae.nO))),[]),[g,y]=n.useState(""),x=(0,u.yK)((e=>({chevronRight:{width:12,height:"auto",color:e.lightIconColor}})),[]);if(!m)return null;const b=Object.entries((0,de.YJ)(p,g)).map(((e,o)=>{let[n,i]=e;return{key:n,items:i.map((e=>{let{workspaceName:o,externalAuthentication:n}=e;return{key:n.id,action:()=>{t(n)},render:e=>(0,K.jsx)(S.Z,{...e,title:o??(0,K.jsx)(f.FormattedMessage,{id:"notificationRuleSettings.selectWorkspace.untitledWorkspace",defaultMessage:"Slack workspace"}),right:(0,h.o)(x.chevronRight)})}})),render:e=>(0,K.jsx)(M.Z,{...e,title:n,topBorder:0!==o})}}));return b.unshift({key:"search-input-section",items:[{key:"search-input-item",action:()=>{},render:e=>(0,K.jsx)("div",{children:(0,K.jsx)(v.ZP,{...e,inputLeft:(0,K.jsx)(v.f_,{icon:Me.R}),showClearButton:!0,placeholder:P.default.formatMessage(ke.workspaceSearchPlaceholder),focus:!l||void 0,value:g,onChange:e=>{y(e.target.value)}})})}],render:e=>(0,K.jsx)(M.Z,{...e})}),b.push({key:"add-another-slack-account-section",items:[{key:"add-another-slack-account-item",action:async()=>{if(!d)return;const e=await le.hM({environment:s,integration:m,spaceId:d,from:"collection_view_settings"});se.x.isFail(e)||e.value.externalAuthentication&&(t(e.value.externalAuthentication),null==r||r())},render:e=>(0,K.jsx)(S.Z,{...e,icon:(0,K.jsx)("img",{src:ie.Z.images.externalIntegrations.slackIconPng,style:{width:18,height:"auto"}}),title:(0,K.jsx)(f.FormattedMessage,{id:"notificationRuleSettings.selectWorkspaceView.setupAnotherSlackAccount.label",defaultMessage:"Add another Slack account"})})}],render:e=>(0,K.jsx)(M.Z,{...e,topBorder:!0})}),(0,K.jsx)(K.Fragment,{children:o(b)})}function Pe(e){const{automationActionMenuStore:t,onClose:o}=e,i=n.useCallback((o=>{t.pushSettingsItem({actionStore:e.actionStore,type:"selectChannelNew",currentExternalAuthentication:o})}),[t,e.actionStore]);return(0,K.jsx)(je,{onWorkspaceSelect:i,renderMenu:e=>(0,K.jsx)(te.Z,{type:"default",automationTriggerActionMenuStore:t,headerTitle:(0,K.jsx)(f.FormattedMessage,{id:"notificationRuleSettings.selectSlackWorkspace.title",defaultMessage:"Select Slack workspace"}),sections:e,onClose:o})})}function Ae(e){const{initialState:t,insertionPoint:o,onClose:s}=e,l=(0,i.VK)((()=>{const e=new r.H0;return e.setState({insertionPoint:o,stack:[t]}),e}),[t,o]),c=(0,i.VK)((()=>l.getCurrentTab()),[l]),u=(0,n.useCallback)((()=>null==s?void 0:s()),[s]);if(!c)return null;if("connectToSlackDefault"===c.type)return(0,K.jsx)(ye,{actionStore:c.actionStore,automationActionMenuStore:l,onClose:u,type:"connectToSlackDefault"});if("connectToSlackReconnect"===c.type)return(0,K.jsx)(ye,{actionStore:c.actionStore,automationActionMenuStore:l,externalBotId:c.externalBotId,notificationActionConfigStore:c.notificationActionConfigStore,onClose:u,type:"connectToSlackReconnect"});if("selectWorkspace"===c.type)return(0,K.jsx)(Pe,{actionStore:c.actionStore,automationActionMenuStore:l,onClose:u});if("selectChannelNew"===c.type)return(0,K.jsx)(Ce,{actionStore:c.actionStore,automationActionMenuStore:l,currentExternalAuthentication:c.currentExternalAuthentication,onClose:u,type:"selectChannelNew"});if("selectChannelUpdate"===c.type)return(0,K.jsx)(Ce,{actionStore:c.actionStore,automationActionMenuStore:l,currentExternalAuthentication:c.currentExternalAuthentication,currentNotificationChannel:c.currentNotificationChannel,onClose:u,type:"selectChannelUpdate"});if("eventActions"===c.type)return(0,K.jsx)(L,{automationActionMenuStore:l,hasUpdateThisPagePropertyActions:c.hasUpdateThisPagePropertyActions,hasSearch:c.hasSearch,onClose:u});if("eventActionProperty"===c.type){const{propertyId:e,actionId:t}=c;return(0,K.jsx)(ne,{actionId:t,automationActionMenuStore:l,onClose:u,propertyId:e})}return"eventActionCreatePage"===c.type||"eventActionUpdatePages"===c.type||"actionSendInAppNotification"===c.type?(0,K.jsx)("div",{children:"WILL BE REMOVED"}):(0,a.t1)(c)}},80826:(e,t,o)=>{o.d(t,{eQ:()=>T,pZ:()=>I});var n=o(67294),i=o(480),a=o(86628),r=o(24405),s=o(59786),l=o(90199),c=o(9291),u=o(53965),d=o(1898),p=o(37810),m=o(31945),g=o(86538),y=o(28020),h=o(46654),f=o(61766),x=o(30874),S=o(68016),v=o(41301),b=o(12455),C=o(35294),M=o(745),k=o(31524),j=o(40190),P=o(47957),A=o(85893);function T(e){const{actionStore:t}=e,{automationContextStore:o,automationStore:i,disabled:r,suppressActionErrors:l}=(0,b.i)(),u=(0,s.z)("slack_notification"),{display:d}=u,p=Boolean(r),m=R(i)?(0,A.jsx)(v.So,{content:(0,A.jsx)(c.FormattedMessage,{...v.Mm.slackNotificationAuthenticationError})}):null,g=(0,a.qz)(void 0,f.Z),y=(0,n.useCallback)((()=>g.reset()),[g]),h=(0,n.useMemo)((()=>(0,A.jsx)(M.e,{actionStore:t,closeMenu:y})),[t,y]),x=(0,n.useMemo)((()=>!l.includes(t.id)),[l,t]),S=(0,v.TU)({actionId:t.id,contextStore:o,errorKey:"external_bot_id",shouldShow:x}),C=(0,v.TU)({actionId:t.id,contextStore:o,errorKey:"target",shouldShow:x});return(0,A.jsx)(P.Ao,{actionMenu:h,buttonPopupStore:g,disabled:p,children:(0,A.jsx)(P.vu,{disabled:p,display:d,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0"}},children:(0,A.jsx)(w,{actionStore:t,automationStore:i,disabled:p,errorMessage:m??S??C})})})}function w(e){const{actionStore:t,automationStore:o,disabled:n,errorMessage:i}=e,a=(0,r.yK)((()=>({picker:{display:"inline-flex",minWidth:50},span:{flex:0},title:{display:"inline-flex",minWidth:50}})),[]);return(0,A.jsx)("div",{style:a.title,children:(0,A.jsx)(c.FormattedMessage,{defaultMessage:"<span><b>Notify</b> </span>{slackTargetPicker}",id:"automations.slackNotificationAction.action.title",values:{b:e=>(0,A.jsx)("b",{style:{fontWeight:p.Z.fontWeight.medium},children:e}),slackTargetPicker:(0,A.jsx)("div",{style:a.picker,children:(0,A.jsx)(V,{actionStore:t,automationStore:o,disabled:n,errorMessage:i})}),span:e=>(0,A.jsx)("span",{style:a.span,children:e})}})})}function V(e){const{actionStore:t,automationStore:o,disabled:i,errorMessage:r}=e,s=(0,a.VK)((()=>{const e=t.getConfigStore(),o=e.getKeyStore("external_bot_id").getValue();if((0,u.xb)(o))return!1;const n=e.getKeyStore("target").getValue();return!(0,u.xb)(null==n?void 0:n.id)}),[t]),l=(0,a.qz)(void 0,f.Z),p=(0,n.useCallback)((()=>l.reset()),[l]),g=function(e){const{actionStore:t,automationStore:o}=e,[n,i]=(0,a.VK)((()=>{const e=t.getConfigStore();return[e.getKeyStore("target").getValue(),e.getKeyStore("external_bot_id").getValue()]}),[t]),r=R(o),s=_(t),l=(0,a.VK)((()=>x.Z.completeSlackAuthentications.state.length??0),[]);if((0,d.$K)(n)&&(0,d.$K)(i))return r?{actionStore:t,externalBotId:i,notificationActionConfigStore:t,type:"connectToSlackReconnect"}:(0,d.$K)(s)?{actionStore:t,currentExternalAuthentication:s,currentNotificationChannel:n,type:"selectChannelUpdate"}:{actionStore:t,type:"connectToSlackDefault"};return 0===l?{actionStore:t,type:"connectToSlackDefault"}:l>1?{actionStore:t,type:"selectWorkspace"}:{actionStore:t,type:"selectChannelNew"}}({actionStore:t,automationStore:o}),y=(0,C.d)(),h=(0,j.d)({errorMessage:r,hasValue:s});return(0,A.jsx)(m.ZP,{alignmentToOrigin:m.vR.End,buttonPopupStore:l,disabled:i,originGap:0,placementToOrigin:m.pO.Bottom,popupType:y,renderOrigin:e=>(0,A.jsx)(j.S,{...h,...e,disabled:i,style:{height:"auto",marginBlock:-6,marginInline:-5,maxWidth:"auto",paddingBlock:6,paddingInline:5},children:s?(0,A.jsx)(I,{actionStore:t}):(0,A.jsx)(c.FormattedMessage,{id:"slackNotificationAction.targetPicker.noTarget",defaultMessage:"Select Slack channel"})}),render:()=>(0,A.jsx)(k.Z,{initialState:g,onClose:p})})}function I(e){const{actionStore:t}=e,o=(0,i.O7)(),r=(0,a.VK)((()=>{const e=(0,y.RM)();return!(0,d.$K)(e)||Boolean((0,h.IJ)(o,e))}),[o]),s=function(e){const t=(0,i.O7)(),o=(0,a.VK)((()=>{var t;return null===(t=e.getConfig())||void 0===t||null===(t=t.target)||void 0===t?void 0:t.id}),[e]),r=_(e);return n.useEffect((()=>{r&&(0,g.uV)({botId:r.id,environment:t,spaceId:r.space_id})}),[t,r]),(0,a.VK)((()=>{if(r&&o){const e=S.Z.getStateForBot(r.id).channels[o];if(e)return e}}),[o,r])}(t);return r||!(0,d.$K)(s)?(0,A.jsx)(K,{}):"me"===s.type?(0,A.jsx)(Z,{channelName:s.name}):"private"===s.type?(0,A.jsx)(B,{channelName:s.name}):"public"===s.type?(0,A.jsx)(F,{channelName:s.name}):void(0,d.t1)(s.type)}function F(e){return(0,A.jsx)("span",{style:p.Z.textOverflowStyle,children:`#${e.channelName}`})}function B(e){const{channelName:t}=e,o=W();return(0,A.jsxs)("div",{style:o.container,children:[(0,l.b)(o.lockIcon),(0,A.jsx)("span",{style:p.Z.textOverflowStyle,children:t})]})}function Z(e){const{channelName:t}=e;return(0,A.jsx)("span",{style:p.Z.textOverflowStyle,children:`@${t}`})}function K(){const e=W();return(0,A.jsxs)("div",{style:e.container,children:[(0,l.b)(e.lockIcon),(0,A.jsx)("span",{style:p.Z.textOverflowStyle,children:(0,A.jsx)(c.FormattedMessage,{defaultMessage:"Hidden channel",id:"slackNotificationAction.slackTargetChannel.hiddenName"})})]})}function _(e){return(0,a.VK)((()=>{const t=e.getConfigStore().getKeyStore("external_bot_id").getValue();if(t)return x.Z.completeSlackAuthentications.state.find((e=>t===e.id))}),[e])}function R(e){return(0,a.VK)((()=>"disabled_auth"===e.getStatus()),[e])}function W(){const{isMobile:e}=(0,i.Fy)(),t=e?p.Z.fontSize.UISmall.mobile:p.Z.fontSize.UISmall.desktop;return(0,r.yK)((()=>({container:{alignItems:"baseline",display:"inline-flex",gap:2,minWidth:50,width:"100%"},lockIcon:{alignSelf:"center",height:"auto",width:t}})),[t])}},97291:(e,t,o)=>{o.d(t,{B:()=>le,r:()=>ce});var n=o(67294),i=o(86628),a=o(35102),r=o(12455),s=(o(21703),o(480)),l=o(24405),c=o(59786),u=o(76205),d=o(43690),p=o(84619),m=o(9291),g=o(40470),y=o(1898),h=o(37810),f=o(9953),x=o(13447),S=o(51592),v=o(31945),b=o(76798),C=o(21396),M=o(54802),k=o(61766),j=o(6258),P=o(41301),A=o(35294),T=o(745),w=o(39477),V=o(94166),I=o(6758),F=o(8982),B=o(78140),Z=o(72495),K=o(95193),_=o(40190),R=o(85893);function W(e){const{filter:t,onChange:o,onClose:a,collectionStore:r}=e,s=(0,i.VK)((()=>r.getSchema()),[r]),l=(0,K.F)({minWidth:300,tabletBehavior:"actionSheet"}),c=(0,n.useCallback)(((e,t)=>o(t)),[o]),d=(0,n.useCallback)((()=>{o(void 0),a()}),[o,a]);return(0,R.jsxs)(B.Z,{...l,children:[(0,R.jsx)(F.D,{children:(0,R.jsx)(I.Pq,{collectionViewId:"Automation.FilterMenu",collectionViewType:"table",combinatorFilter:t||u.hh,index:0,level:0,onChange:c,parentStore:r,schema:s})}),(0,R.jsx)(Z.Z,{topBorder:!0,children:(0,R.jsx)(V.Z,{title:(0,R.jsx)(m.FormattedMessage,{defaultMessage:"Delete filter",id:"automations.AutomationCombinatorFilterPopup.deleteFilter.label"}),onClick:d})})]})}var L=o(8808),D=o(47957);const N=(0,m.defineMessages)({multipleTargetsFilter:{defaultMessage:"<span>Edit </span>{filterPicker}",id:"automations.UpdatePagesAction.multipleTargetsFilter"},multipleTargetsPicker:{defaultMessage:"<span>in </span>{targetPicker}",id:"automations.UpdatePagesAction.multipleTargetsPicker"},singleTarget:{defaultMessage:"<span>Edit </span>{targetPicker}",id:"automations.UpdatePagesAction.singleTarget"}});function O(e){const{actionStore:t}=e,o=(0,s.O7)(),{automationContextStore:a,disabled:l,suppressActionErrors:u}=(0,r.i)(),p=(0,i.VK)((()=>t.getTargetStore()),[t]),m=(0,i.VK)((()=>(0,y.$K)(a)?$(t,a):void 0),[a,t]),g=(0,i.VK)((()=>{var e;const o=t.getCollectionTargetStore(),n=null==o||null===(e=o.getKeyStore("filter"))||void 0===e?void 0:e.getValue();if(n)return(0,d.Ih)(n,(null==m?void 0:m.getSchema())||{})}),[t,m]),h=(0,i.VK)((()=>{const e=t.getVariableTargetStore();if(e)return e.getValue();const o=t.getCollectionTargetStore();if(o){const e=o.getKeyStore("collection").getValue();if(e)return{collection:e,type:"collection"}}}),[t]),S=(0,i.VK)((()=>{if(!h||"variable"!==h.type||!a)return!1;const e=a.getContextValueForActionById(t.id,h.id);return"block"===(null==e?void 0:e.type.type)}),[t.id,a,h]),v=(0,i.qz)(void 0,k.Z),b=(0,n.useCallback)((()=>v.reset()),[v]),C=(0,n.useMemo)((()=>(0,R.jsx)(T.e,{actionStore:t,closeMenu:b})),[t,b]),M=(0,n.useMemo)((()=>!u.includes(t.id)),[u,t]),j=(0,P.TU)({contextStore:a,actionId:t.id,shouldShow:M}),A=(0,n.useCallback)((e=>{x.createAndCommit({userAction:"UpdatePagesAction.filterChange",environment:o,perform:t=>{f.sW({data:{filter:e},store:p,transaction:t})}})}),[o,p]),V=(0,n.useCallback)((e=>{let n;if("collection"===e.type)n="UpdatePageAction.updateCollection";else if("variable"===e.type)n="UpdatePageAction.updateVariable";else{if("page"===e.type||"property"===e.type||"formula"===e.type)throw new Error("Not implemented yet.");(0,y.t1)(e)}x.createAndCommit({userAction:n,environment:o,perform:o=>{f.sW({data:{properties:null,target:e,values:null},store:t.getConfigStore(),transaction:o})}})}),[o,t]),I=Boolean(l),F=(0,c.z)("update_pages"),{display:B}=F;return a?(0,R.jsxs)(D.Ao,{actionMenu:C,buttonPopupStore:v,disabled:I,children:[(0,R.jsx)(D.vu,{disabled:I,display:B,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0"}},children:S||!m?(0,R.jsx)(E,{actionStore:t,automationContextStore:a,disabled:I,errorMessage:j,onTargetChange:V,value:h}):(0,R.jsx)(H,{actionStore:t,automationContextStore:a,collectionStore:m,disabled:I,errorMessage:j,filter:g,onFilterChange:A,onTargetChange:V,value:h})}),m&&(0,R.jsx)(D.R7,{disabled:I,styles:{bodyWrap:{display:"grid",gap:8,gridTemplateColumns:"1fr",minWidth:0}},children:(0,R.jsx)(w.QF,{actionStore:t,collectionStore:m,contextStore:a,disabled:I,showSetPropertyActions:!0})})]}):null}function E(e){const{actionStore:t,automationContextStore:o,disabled:n,errorMessage:i,onTargetChange:a,value:r}=e,s=(0,l.yK)((()=>({b:{fontWeight:h.Z.fontWeight.medium},picker:{display:"inline-flex",minWidth:50},span:{flex:0},title:{display:"inline-flex",minWidth:50}})),[]);return(0,R.jsx)("div",{style:s.title,children:(0,R.jsx)(m.FormattedMessage,{...N.singleTarget,values:{b:e=>(0,R.jsx)("b",{style:s.b,children:e}),targetPicker:(0,R.jsx)(z,{actionStore:t,automationContextStore:o,disabled:n,errorMessage:i,onChange:a,value:r}),span:e=>(0,R.jsx)("span",{style:s.span,children:e})}})})}function H(e){const{actionStore:t,automationContextStore:o,collectionStore:n,disabled:i,errorMessage:a,filter:r,onFilterChange:s,onTargetChange:c,value:u}=e,d=(0,l.yK)((()=>({b:{fontWeight:h.Z.fontWeight.medium},picker:{display:"inline-flex",minWidth:50},span:{flex:0},title:{display:"inline-flex",minWidth:50}})),[]);return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)("div",{style:d.title,children:[(0,R.jsx)(m.FormattedMessage,{...N.multipleTargetsFilter,values:{filterPicker:(0,R.jsx)(U,{collectionStore:n,disabled:i,filter:r,onChange:s}),span:e=>(0,R.jsx)("span",{style:d.span,children:e})}})," "]}),(0,R.jsx)("div",{style:d.title,children:(0,R.jsx)(m.FormattedMessage,{...N.multipleTargetsPicker,values:{targetPicker:(0,R.jsx)(z,{actionStore:t,automationContextStore:o,disabled:i,errorMessage:a,onChange:c,value:u}),span:e=>(0,R.jsx)("span",{style:d.span,children:e})}})})]})}function U(e){var t;const{collectionStore:o,disabled:a,filter:r,onChange:s}=e,c=(0,l.yK)((()=>({b:{fontWeight:h.Z.fontWeight.medium}})),[]),d=(0,i.qz)(void 0,k.Z),p=(0,A.d)({tabletBehavior:"slideUp"}),g=(0,n.useCallback)((()=>d.reset()),[d]),y=(0,i.VK)((()=>{const e=o.getModel(),t=null==e?void 0:e.getDatabaseType();return(0,S.Q_)(t)}),[o]),f=(null==r||null===(t=r.filters)||void 0===t?void 0:t.length)||0;return(0,R.jsx)(v.ZP,{alignmentToOrigin:v.vR.End,disabled:a,originGap:0,placementToOrigin:v.pO.Bottom,popupType:p,renderOrigin:e=>(0,R.jsx)(_.S,{...e,disabled:a,variant:"gray",onClick:t=>{e.onClick(t),0===f&&s(u.TI)},style:{height:"auto",marginBlock:-6,marginInline:-5,maxWidth:"auto",paddingBlock:6,paddingInline:5},children:f>0?(0,R.jsx)(m.FormattedMessage,{defaultMessage:"<b>{itemType}</b> that match {ruleCount, plural, one {{ruleCount} filter} other {{ruleCount} filters}}",id:"automations.UpdatePagesAction.FilterPicker.withRules",values:{b:e=>(0,R.jsx)("b",{style:c.b,children:e}),itemType:y,ruleCount:f}}):(0,R.jsx)(m.FormattedMessage,{defaultMessage:"all <b>{itemType}</b>",id:"automations.UpdatePagesAction.FilterPicker.noRules",values:{b:e=>(0,R.jsx)("b",{style:c.b,children:e}),itemType:y}})}),render:()=>(0,R.jsx)(W,{collectionStore:o,disabled:a,filter:r,onChange:s,onClose:g})})}function z(e){const{actionStore:t,automationContextStore:o,disabled:a,errorMessage:r,onChange:s,value:l}=e,c=(0,i.VK)((()=>{if("collection"===(null==l?void 0:l.type))return j.NW.createChildStore(t,l.collection)}),[t,l]),u=(0,i.VK)((()=>{if(l&&"variable"===l.type)return o.getContextValueForActionById(t.id,l.id)}),[l,o,t.id]),d=(0,_.d)({errorMessage:r,hasValue:Boolean(l||u)}),g=(0,i.qz)(void 0,k.Z),h=(0,A.d)(),f=(0,n.useCallback)((()=>g.reset()),[g]),x=(0,n.useCallback)((e=>{s(e),f()}),[s,f]);return(0,R.jsx)(v.ZP,{buttonPopupStore:g,popupType:h,alignmentToOrigin:v.vR.End,placementToOrigin:v.pO.Bottom,originGap:0,disabled:a,renderOrigin:e=>(0,R.jsx)(_.S,{disabled:a,...d,...e,style:{height:"auto",marginBlock:-6,marginInline:-5,maxWidth:"auto",paddingBlock:6,paddingInline:5},children:(0,y.$K)(c)?(0,R.jsx)(b.Z,{store:c}):u?(0,R.jsx)(C.F,{format:p.lo.Medium,isSingle:!0,value:u}):(0,R.jsx)(m.FormattedMessage,{id:"automations.UpdatePagesAction.pagesDropdown.label",defaultMessage:"Select database"})}),render:e=>(0,R.jsx)(L.L,{actionId:t.id,automationContextStore:o,onChange:x,onClose:f,selectedTarget:l,skipPages:!0})})}function $(e,t){const o=e.getTargetStore().getValue();if(o){if("collection"===o.type)return j.NW.createChildStore(e,o.collection);if("variable"===o.type){if(!t)return;const n=t.compilationResultStore.state;if(g.x.isFail(n))return;const i=(0,a.vx)(n.value.valueTypes,o.id);if(i)return(0,M.wB)(i,e)}else{if("page"===o.type)return;(0,y.t1)(o)}}}var q=o(3865),G=o(31524),Y=o(67653),Q=o(34067),J=o(29735),X=o(42767),ee=o(39864),te=o(80981),oe=o(23745),ne=o(90073),ie=o(19656),ae=o(23645);function re(e){var t;const{actionStore:o}=e,{automationContextStore:a,disabled:s}=(0,r.i)(),l=(0,i.VK)((()=>o.getConfig()),[o]),c=(0,i.VK)((()=>(0,y.$K)(a)?$(o,a):void 0),[a,o]),u=(0,i.VK)((()=>null==c?void 0:c.getSchema()),[c]),d=(0,i.VK)((()=>null==c?void 0:c.getDeletedSchema()),[c]),p=(0,i.qz)(void 0,k.Z),m=(0,n.useCallback)((()=>p.reset()),[p]),g=(0,n.useMemo)((()=>(0,R.jsx)(T.e,{actionStore:o,closeMenu:m})),[o,m]),h=((null==l?void 0:l.properties)??[])[0],f=null==u?void 0:u[h],x=null==d?void 0:d[h],S=null==l||null===(t=l.values)||void 0===t?void 0:t[h],v=Boolean(s),b={actionMenu:g,buttonPopupStore:p,disabled:v,value:null==S?void 0:S.value};return!f&&x?(0,R.jsx)(J.RN,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,R.jsx)(J.rV,{...e,...b,propertySchema:x})}):f||x?f&&c?(0,q.SF)(f)?"person"===f.type?(0,R.jsx)(se,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,R.jsx)(ee.ZP,{...e,...b,propertySchema:f})}):"status"===f.type?(0,R.jsx)(se,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,R.jsx)(ne.yr,{...e,...b,propertySchema:f})}):"select"===f.type?(0,R.jsx)(se,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,R.jsx)(oe.D9,{...e,...b,propertySchema:f})}):"multi_select"===f.type?(0,R.jsx)(se,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,R.jsx)(X.m,{...e,...b,propertySchema:f})}):"date"===f.type?(0,R.jsx)(se,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,R.jsx)(Q.er,{...e,...b,propertySchema:f,valueContext:{collectionStore:c,property:h,type:"collection"}})}):"relation"===f.type?(0,R.jsx)(se,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,R.jsx)(te.ZP,{...e,...b,collectionStore:c,propertySchema:f})}):"checkbox"===f.type?(0,R.jsx)(se,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,R.jsx)(Y.Q2,{...e,...b,propertySchema:f})}):"title"===f.type?(0,R.jsx)(se,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,R.jsx)(ie.QQ,{...e,...b,propertySchema:f})}):"text"===f.type?(0,R.jsx)(se,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,R.jsx)(ie.Vk,{...e,...b,propertySchema:f})}):"email"===f.type?(0,R.jsx)(se,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,R.jsx)(ie.Kh,{...e,...b,propertySchema:f})}):"url"===f.type?(0,R.jsx)(se,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,R.jsx)(ie.GJ,{...e,...b,propertySchema:f})}):"number"===f.type?(0,R.jsx)(se,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,R.jsx)(ie.go,{...e,...b,propertySchema:f})}):"phone_number"===f.type?(0,R.jsx)(se,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,R.jsx)(ie.gi,{...e,...b,propertySchema:f})}):null:(0,R.jsx)(ae.l6,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,R.jsx)(ae.OZ,{...e,...b,propertySchema:f})}):null:(0,R.jsx)(J.RN,{actionId:o.id,renderOrigin:e=>(0,R.jsx)(J.PO,{...e,...b})})}function se(e){const{actionId:t,propertyId:o,renderOrigin:a}=e,r=(0,A.d)(),s=(0,i.qz)(void 0,k.Z),l=(0,n.useCallback)((()=>s.reset()),[s]),c=(0,n.useMemo)((()=>({actionId:t,propertyId:o,type:"eventActionProperty"})),[t,o]);return(0,R.jsx)(v.ZP,{buttonPopupStore:s,popupType:r,render:()=>(0,R.jsx)(G.Z,{initialState:c,onClose:l}),renderOrigin:a})}function le(e){const{actionStore:t}=e,{automationContextStore:o}=(0,r.i)();return(0,i.VK)((()=>ce(o,t)),[t,o])?(0,R.jsx)(re,{...e}):(0,R.jsx)(O,{...e})}function ce(e,t){var o;if(!t.isType("update_pages"))return!1;const n=t.getConfig(),i="variable"===(null==n||null===(o=n.target)||void 0===o?void 0:o.type)?(0,a.MY)(n.target.id):void 0;return"event"===(null==e?void 0:e.context.type)&&i&&"global"===i.source&&"button_page"===i.global}},67653:(e,t,o)=>{o.d(t,{G7:()=>x,Q2:()=>f});var n=o(67294),i=o(24405),a=o(76218),r=o(65628),s=o(96711),l=o(42283),c=o(9291),u=o(37810),d=o(20776),p=o(4023),m=o(56812),g=o(93060),y=o(47957),h=o(85893);function f(e){const{actionMenu:t,buttonPopupStore:o,disabled:f,onClick:S,propertySchema:v,value:b}=e,C=(0,i.yK)((()=>({content:{alignItems:"center",display:"flex"},propertyName:{...u.Z.textOverflowStyle,fontWeight:u.Z.fontWeight.semibold}})),[]),M=function(e){const{propertySchema:t,styles:o,value:n}=e,i=(0,a.A6)(null==n?void 0:n.value)[0],l=t.name,u=!0===i?(0,s.V)({width:12}):(0,r.z)({width:10}),p=!0===i?(0,h.jsx)(c.FormattedMessage,{...m.Bo.actionCheckboxPropertyChecked}):(0,h.jsx)(c.FormattedMessage,{...m.Bo.actionCheckboxPropertyUnchecked});return(0,h.jsx)(c.FormattedMessage,{...m.hW({propertyName:(0,h.jsx)("span",{style:o.propertyName,children:l}),propertyValue:(0,h.jsx)(d.o,{icon:u,shouldTruncateChildren:!0,children:p})})})}({propertySchema:v,styles:C,value:b}),k=x({propertySchema:v,value:b}),j=(0,n.useCallback)((e=>(0,h.jsx)(y.YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:f,icon:l.r,onClick:S,children:(0,h.jsx)("div",{style:C.content,children:M})})),[t,o,f,S,C.content,M]);return(0,h.jsx)(g.y,{renderOrigin:j,title:k,tooltipAlignment:p.v.Center,tooltipPlacement:p.u.Left})}function x(e){const{propertySchema:t,value:o}=e,n=!0===(0,a.A6)(null==o?void 0:o.value)[0]?(0,h.jsx)(c.FormattedMessage,{...m.Bo.actionCheckboxPropertyChecked}):(0,h.jsx)(c.FormattedMessage,{...m.Bo.actionCheckboxPropertyUnchecked});return(0,h.jsx)(c.FormattedMessage,{...m.hW({propertyName:t.name,propertyValue:n})})}},34067:(e,t,o)=>{o.d(t,{er:()=>P,kD:()=>A});var n=o(67294),i=o(86628),a=o(24405),r=o(84619),s=o(7057),l=o(35102),c=o(76218),u=o(42875),d=o(53016),p=o(70203),m=o(9291),g=o(1898),y=o(37810),h=o(26388),f=o(21396),x=o(75311),S=o(85567),v=o(54802),b=o(56812),C=o(12455),M=o(93060),k=o(47957),j=o(85893);function P(e){const{actionMenu:t,buttonPopupStore:o,disabled:P,onClick:w,propertySchema:V,value:I,valueContext:F}=e,{automationContextStore:B}=(0,C.i)(),Z=(0,m.useIntl)(),K=(0,a.yK)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"wrap",whiteSpace:"pre"},propertyName:{...y.Z.textOverflowStyle,fontWeight:y.Z.fontWeight.semibold}})),[]),_=(0,i.VK)((()=>B?function(e){const{automationContextStore:t,intl:o,propertySchema:n,styles:i,value:a,valueContext:d}=e,h=(0,j.jsx)("span",{style:i.propertyName,children:n.name});if(void 0===(null==a?void 0:a.value))return(0,j.jsx)(m.FormattedMessage,{...b.xf({propertyName:h})});let C;const M=v.tk(t),k=(0,x._)(d),P=(0,c.A6)(null==a?void 0:a.value)[0];if(!(0,g.$K)(P)||"string"==typeof P||"boolean"==typeof P||(0,p.IWo)(P)||(0,p.STW)(P))C=(0,j.jsx)(S.Z,{format:r.lo.Medium,isRound:!0,isSingle:!0,shouldShrink:!0,showRemoveButton:!1,value:(0,j.jsx)("span",{style:y.Z.textOverflowStyle,children:(0,j.jsx)(m.FormattedMessage,{...b.Bo.unknownValue})})});else if((0,p.wjk)(P)){const e=(0,p.vmO)(P).id,t=(0,l.vx)(M,e);C=t?(0,j.jsx)(f.F,{value:t,format:r.lo.Medium,isSingle:!1,shouldShrink:!0}):(0,j.jsx)(S.Z,{format:r.lo.Medium,isRound:!0,isSingle:!0,shouldShrink:!0,showRemoveButton:!1,value:(0,j.jsx)("span",{style:y.Z.textOverflowStyle,children:(0,j.jsx)(m.FormattedMessage,{...b.Bo.unknownValue})})})}else if((0,p.fpG)(P)){const e=(0,p.zyO)(P);C=e?(0,s.OB)({value:e,date_format:k.dateFormat,time_format:k.timeFormat,userTimeZone:(0,u.r)(),allowRelativeDates:!0,intl:o,shortenDateAndRange:!0,displayInUserTimezone:!0,formatValuesFn:e=>{let{endDate:t,endTime:o,startDate:n}=e;return(0,g.$K)(o)?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(T,{value:n})," → ",(0,j.jsx)(T,{value:o})]}):(0,g.$K)(t)?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(T,{value:n})," → ",(0,j.jsx)(T,{value:t})]}):(0,j.jsx)(T,{value:n})}}):null}else(0,g.t1)(P);return void 0===C?void 0:(0,j.jsx)(m.FormattedMessage,{...b.zU({propertyName:h,propertyValue:C})})}({automationContextStore:B,intl:Z,propertySchema:V,styles:K,value:I,valueContext:F}):void 0),[B,Z,V,K,I,F]),R=(0,i.VK)((()=>B?A({automationContextStore:B,intl:Z,propertySchema:V,value:I,valueContext:F}):void 0),[B,Z,V,I,F]),W=(0,n.useCallback)((e=>(0,j.jsx)(k.YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:P,icon:d.V,onClick:w,children:(0,j.jsx)("div",{style:K.content,children:_})})),[t,o,P,w,K.content,_]);return B&&_&&R?(0,j.jsx)(M.y,{disable:P,renderOrigin:W,title:R,tooltipAlignment:h.v2.Center,tooltipPlacement:h.ug.Left}):null}function A(e){const{automationContextStore:t,intl:o,propertySchema:n,value:i,valueContext:a}=e,r=n.name;if(void 0===(null==i?void 0:i.value))return(0,j.jsx)(m.FormattedMessage,{...b.xf({propertyName:r})});let d;const y=v.tk(t),h=(0,x._)(a),S=(0,c.A6)(null==i?void 0:i.value)[0];if(!(0,g.$K)(S)||"string"==typeof S||"boolean"==typeof S||(0,p.IWo)(S)||(0,p.STW)(S))d=(0,j.jsx)(m.FormattedMessage,{...b.Bo.unknownValue});else if((0,p.wjk)(S)){const e=(0,p.vmO)(S).id,t=(0,l.vx)(y,e);d=t?(0,f.e)(t):(0,j.jsx)(m.FormattedMessage,{...b.Bo.unknownValue})}else if((0,p.fpG)(S)){const e=(0,p.zyO)(S);d=e?(0,s.ZV)({value:e,date_format:h.dateFormat,time_format:h.timeFormat,userTimeZone:(0,u.r)(),allowRelativeDates:!0,intl:o,shortenDateAndRange:!0,displayInUserTimezone:!0}):null}else(0,g.t1)(S);return void 0===d?void 0:(0,j.jsx)(m.FormattedMessage,{...b.zU({propertyName:r,propertyValue:d})})}function T(e){const{value:t}=e,o=(0,a.Fg)();return(0,j.jsx)(S.Z,{backgroundColor:o.accentColors.gray[75],format:r.lo.Medium,isRound:!0,isSingle:!0,showRemoveButton:!1,style:{marginBlockEnd:4},value:t})}},29735:(e,t,o)=>{o.d(t,{Ox:()=>h,PO:()=>g,RN:()=>y,Si:()=>f,fX:()=>x,rV:()=>m});var n=o(67294),i=o(86628),a=o(24405),r=o(9291),s=o(31945),l=o(61766),c=o(35294),u=o(92688),d=o(23645),p=o(85893);function m(e){const{actionMenu:t,buttonPopupStore:o,disabled:n,onClick:i,propertySchema:r}=e,s=(0,a.yK)((e=>({icon:{fill:e.text.uiRedPrimary},propertyType:{color:e.accentColors.red[700]}})),[]),l=h({propertySchema:r,styles:s}),c=f({propertySchema:r});return(0,p.jsx)(d.gq,{actionMenu:t,buttonPopupStore:o,disabled:n,onClick:i,styles:s,tooltip:c,children:l})}function g(e){const{actionMenu:t,buttonPopupStore:o,disabled:n,onClick:i}=e,r=(0,a.yK)((e=>({icon:{fill:e.text.uiRedPrimary},propertyType:{color:e.accentColors.red[700]}})),[]),s=x();return(0,p.jsx)(d.gq,{actionMenu:t,buttonPopupStore:o,disabled:n,onClick:i,styles:r,tooltip:s,children:s})}function y(e){const{actionId:t,propertyId:o,renderOrigin:a}=e,r=(0,c.d)(),d=(0,i.qz)(void 0,l.Z),m=(0,n.useCallback)((()=>d.reset()),[d]);return(0,p.jsx)(s.ZP,{buttonPopupStore:d,popupType:r,render:()=>(0,p.jsx)(u.k,{actionId:t,closeMenu:m,propertyId:o}),renderOrigin:a})}function h(e){const{propertySchema:t,styles:o}=e;return(0,p.jsx)(r.FormattedMessage,{defaultMessage:"{propertyName} property was deleted",id:"updateThisPageUnsupportedPropertyAction.deletedProperty.title",values:{propertyName:(0,p.jsx)("span",{style:o.propertyType,children:t.name})}})}function f(e){const{propertySchema:t}=e;return(0,p.jsx)(r.FormattedMessage,{defaultMessage:"{propertyName} property was deleted",id:"updateThisPageUnsupportedPropertyAction.deletedProperty.title",values:{propertyName:t.name}})}function x(){return(0,p.jsx)(r.FormattedMessage,{defaultMessage:"The property was permanently deleted",id:"updateThisPageUnsupportedPropertyAction.permanentlyDeleted.title"})}},42767:(e,t,o)=>{o.d(t,{H:()=>f,m:()=>x});var n=o(67294),i=o(86628),a=o(24405),r=o(76218),s=o(72050),l=o(9291),c=o(1898),u=o(37810),d=o(26388),p=o(56812),m=o(93060),g=o(47957),y=o(23745),h=o(85893);const f=5;function x(e){const{actionMenu:t,buttonPopupStore:o,disabled:x,limit:S=f,onClick:v,propertySchema:b,value:C}=e,M=(0,l.useIntl)(),k=null!=C&&C.value?(0,r.A6)(null==C?void 0:C.value):[],j=p.oJ({limit:S,optionValues:k.map((e=>"string"==typeof e?e:void 0)).filter(c.$K),propertySchema:b}),P=(0,a.yK)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:j.length<=1?"nowrap":"wrap",whiteSpace:"pre"},propertyName:{...u.Z.textOverflowStyle,fontWeight:u.Z.fontWeight.semibold}})),[j.length]),A=(0,i.VK)((()=>(0,y.F0)({intl:M,propertySchema:b,styles:P,values:j})),[M,j,b,P]),T=(0,i.VK)((()=>(0,y.I7)({intl:M,propertySchema:b,values:j})),[M,j,b]),w=(0,n.useCallback)((e=>(0,h.jsx)(g.YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:x,icon:s.A,onClick:v,children:(0,h.jsx)("div",{style:P.content,children:A})})),[t,o,x,v,P.content,A]);return(0,h.jsx)(m.y,{renderOrigin:w,title:T,tooltipAlignment:d.v2.Center,tooltipPlacement:d.ug.Left})}},39864:(e,t,o)=>{o.d(t,{UD:()=>v,ZP:()=>S,y3:()=>b});var n=o(67294),i=o(86628),a=o(24405),r=o(66897),s=o(80951),l=o(26774),c=o(9291),u=o(1898),d=o(37810),p=o(26388),m=o(92864),g=o(56812),y=o(12455),h=o(93060),f=o(47957),x=o(85893);function S(e){const{actionMenu:t,buttonPopupStore:o,disabled:r,onClick:s,propertySchema:S,value:C}=e,{automationContextStore:M}=(0,y.i)(),k=(0,c.useIntl)(),j=(0,i.VK)((()=>{const e=null==M?void 0:M.context.automationStore;return(0,u.$K)(e)?v({getRecordModel:e.getRecordModel,propertySchema:S,value:C}):[]}),[null==M?void 0:M.context.automationStore,S,C]),P=(0,a.yK)((()=>({content:{alignItems:"center",display:"flex",flexWrap:j.length>1?"wrap":"nowrap",whiteSpace:"pre"},propertyName:{...d.Z.textOverflowStyle,fontWeight:d.Z.fontWeight.semibold},propertyValue:{...d.Z.textOverflowStyle,paddingBlockStart:4},propertyValueList:{display:"flex",flexBasis:"100%",flexDirection:"column",listStyle:"none",margin:0,marginBlockStart:10,padding:0,rowGap:4}})),[j.length]),A=(0,i.VK)((()=>function(e){const{actors:t,propertySchema:o,styles:n}=e,i=(0,x.jsx)("span",{style:n.propertyName,children:o.name}),a=function(e){const{actors:t,styles:o}=e;return 1===t.length?(0,x.jsx)("div",{style:o.propertyValue,children:(0,x.jsx)(m.ZP,{actor:t[0],showRemoveButton:!1,format:m.ZP.Format.Medium,isSingle:!1})}):(0,x.jsx)("ul",{style:o.propertyValueList,children:t.map(((e,t)=>(0,x.jsx)("li",{children:(0,x.jsx)("div",{style:o.propertyValue,children:(0,x.jsx)(m.ZP,{actor:e,showRemoveButton:!1,format:m.ZP.Format.Medium,isSingle:!1})},t)},t)))})}({actors:t,styles:n});let r;r=0===t.length?g.ht({propertyName:i}):1===t.length?g.wE({propertyName:i,propertyValue:a}):g.Oq({propertyName:i,propertyValue:a});return(0,x.jsx)(c.FormattedMessage,{...r})}({actors:j,propertySchema:S,styles:P})),[j,S,P]),T=(0,i.VK)((()=>b({actors:j,intl:k,propertySchema:S})),[j,k,S]),w=(0,n.useCallback)((e=>(0,x.jsx)(f.YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:r,icon:l.O,onClick:s,children:(0,x.jsx)("div",{style:P.content,children:A})})),[t,o,r,s,P.content,A]);return(0,x.jsx)(h.y,{renderOrigin:w,title:T,tooltipAlignment:p.v2.Center,tooltipPlacement:p.ug.Left})}function v(e){const{getRecordModel:t,propertySchema:o,value:n}=e;return(0,s.DW)({textValue:null==n?void 0:n.value,propertySchema:o,blockCreatorPointer:void 0}).map((e=>(0,r.Hl)({getRecordModel:t,pointer:e}))).filter(u.$K)}function b(e){const{actors:t,intl:o,propertySchema:n}=e,i=t.map((e=>(0,r.$4)(o,e))),a=n.name,s=o.formatList(i,{style:"long",type:"conjunction"});let l;return l=0===t.length?g.ht({propertyName:a}):1===t.length?g.wE({propertyName:a,propertyValue:s}):g.Oq({propertyName:a,propertyValue:s}),(0,x.jsx)(c.FormattedMessage,{...l})}},80981:(e,t,o)=>{o.d(t,{ZP:()=>P,wr:()=>T});var n=o(67294),i=o(480),a=o(86628),r=o(24405),s=o(84619),l=o(35102),c=o(76218),u=o(92607),d=o(21202),p=o(70203),m=o(9291),g=o(1898),y=o(37810),h=o(26388),f=o(21396),x=o(25845),S=o(37034),v=o(6258),b=o(56812),C=o(12455),M=o(93060),k=o(47957),j=o(85893);function P(e){const{actionMenu:t,buttonPopupStore:o,collectionStore:s,disabled:l,onClick:c,propertySchema:d,value:p}=e,{automationContextStore:g}=(0,C.i)(),f=(0,i.O7)(),x=(0,m.useIntl)(),S=(0,a.VK)((()=>(null==g?void 0:g.getAllContextValues())??[]),[g]),v=(0,r.yK)((()=>({content:{alignItems:"center",display:"flex",flex:"1 1 auto",minWidth:0,whiteSpace:"pre"},propertyName:{...y.Z.textOverflowStyle,fontWeight:y.Z.fontWeight.semibold,minWidth:20},propertyValue:{...y.Z.textOverflowStyle,minWidth:40},propertyValueList:{display:"flex",flexBasis:"100%",flexDirection:"column",listStyle:"none",margin:0,marginBlockStart:10,padding:0,rowGap:10},propertyValueListItem:{display:"flex"}})),[]),P=(0,a.VK)((()=>function(e){const{automationContextValues:t,collectionStore:o,propertySchema:n,styles:i,value:a}=e,r=a?w({automationContextValues:t,limit:n.limit,value:a}):[],s=(0,j.jsx)("span",{style:i.propertyName,children:n.name});let l;l=0===r.length?(0,j.jsx)("div",{style:i.content,children:(0,j.jsx)(m.FormattedMessage,{...b.Iu({propertyName:s})})}):1===r.length?(0,j.jsx)("div",{style:i.content,children:(0,j.jsx)(m.FormattedMessage,{...b.S0({propertyName:s,propertyValue:(0,j.jsx)("span",{style:i.propertyValue,children:(0,j.jsx)(A,{collectionStore:o,value:r[0]})})})})}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{style:i.content,children:(0,j.jsx)(m.FormattedMessage,{...b.om({propertyName:s,propertyValue:[]})})}),(0,j.jsx)("ul",{style:i.propertyValueList,children:r.map(((e,t)=>(0,j.jsx)("li",{style:i.propertyValueListItem,children:(0,j.jsx)(A,{collectionStore:o,value:e})},t)))})]});return l}({automationContextValues:S,collectionStore:s,propertySchema:d,styles:v,value:p})),[S,s,d,v,p]),V=(0,a.VK)((()=>T({automationContextValues:S,collectionStore:s,environment:f,intl:x,propertySchema:d,value:p})),[S,s,f,x,d,p]),I=(0,n.useCallback)((e=>(0,j.jsx)(k.YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:l,icon:u.v,onClick:c,children:P})),[t,o,l,c,P]);return(0,j.jsx)(M.y,{renderOrigin:I,title:V,tooltipAlignment:h.v2.Center,tooltipPlacement:h.ug.Left})}function A(e){const{collectionStore:t,value:o}=e;return"string"==typeof o?(0,j.jsx)(x.Z,{blockId:o,format:s.lo.Medium,isSingle:!0,noUnderline:!0,parentStore:t,shouldShrink:!0}):(0,j.jsx)(f.F,{format:s.lo.Medium,isSingle:!0,shouldShrink:!0,value:o})}function T(e){const{automationContextValues:t,collectionStore:o,environment:n,intl:i,propertySchema:a,value:r}=e,s=(r?w({automationContextValues:t,limit:a.limit,value:r}):[]).map((e=>{if("string"==typeof e){const t=v.G.createChildStore(o,{id:e,table:d.iU});return(0,S.vU)({environment:n,intl:i,store:t})}return(0,f.e)(e)})).filter(g.$K),l=a.name;let c;return c=0===s.length?b.Iu({propertyName:l}):1===s.length?b.S0({propertyName:l,propertyValue:s[0]}):b.om({propertyName:l,propertyValue:i.formatList(s,{style:"long",type:"conjunction"})}),(0,j.jsx)(m.FormattedMessage,{...c})}function w(e){const{automationContextValues:t,limit:o,value:n}=e;return(0,c.A6)(n.value).slice(0,o).map((e=>{if("string"!=typeof e&&"boolean"!=typeof e){if((0,p.wjk)(e)){const o=(0,p.vmO)(e).id,n=(0,l.vx)(t,o);if(!n)return;return n}if((0,p.STW)(e)){const t=(0,p.TOT)(e);if(!t)return;return t}}})).filter(g.$K)}},23745:(e,t,o)=>{o.d(t,{D9:()=>C,F0:()=>M,I7:()=>k});var n=o(67294),i=o(86628),a=o(24405),r=o(84619),s=o(76218),l=o(53866),c=o(9291),u=o(53965),d=o(1898),p=o(37810),m=o(26388),g=o(22084),y=o(85567),h=o(65380),f=o(56812),x=o(93060),S=o(47957),v=o(37867),b=o(85893);function C(e){const{actionMenu:t,buttonPopupStore:o,disabled:r,onClick:d,propertySchema:g,value:y}=e,h=(0,c.useIntl)(),v=(0,a.yK)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"nowrap",whiteSpace:"pre"},propertyName:{...p.Z.textOverflowStyle,fontWeight:p.Z.fontWeight.semibold}})),[]),C=null!=y&&y.value?(0,s.A6)(null==y?void 0:y.value)[0]:void 0,j=f.oJ({propertySchema:g,optionValues:(0,u.HD)(C)?[C]:[]}),P=(0,i.VK)((()=>M({intl:h,propertySchema:g,styles:v,values:j})),[h,j,g,v]),A=(0,i.VK)((()=>k({intl:h,propertySchema:g,values:j})),[h,j,g]),T=(0,n.useCallback)((e=>(0,b.jsx)(S.YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:r,icon:l.w,onClick:d,children:(0,b.jsx)("div",{style:v.content,children:P})})),[t,o,r,d,v.content,P]);return(0,b.jsx)(x.y,{renderOrigin:T,title:A,tooltipAlignment:m.v2.Center,tooltipPlacement:m.ug.Left})}function M(e){const{intl:t,propertySchema:o,styles:n,tokenFormat:i,values:a}=e,s=i??r.lo.Medium,l=(0,b.jsx)("span",{style:n.propertyName,children:o.name}),u=a.map((e=>"deleted"===e.type?(0,b.jsx)(v.Z,{tokenFormat:s},`missing_option_value_${e.value}`):"option"===e.type?(0,b.jsx)(g.a,{color:e.value.color,format:s,isSingle:!0,showRemoveButton:!1,value:e.value.value},e.value.id):"truncation"===e.type?(0,b.jsx)(y.Z,{format:s,isRound:!0,isSingle:!0,showRemoveButton:!1,value:e.value},"More tokens"):void(0,d.t1)(e)));return 0===u.length?(0,b.jsx)(c.FormattedMessage,{...f.Mw({propertyName:l})}):1===u.length?(0,b.jsx)(c.FormattedMessage,{...f.rf({propertyName:l,propertyValue:u[0]})}):(0,b.jsx)(c.FormattedMessage,{...f.Sj({propertyName:l,propertyValue:(0,h.H)(t.formatList(u,{style:"long",type:"conjunction"}))})})}function k(e){const{intl:t,propertySchema:o,values:n}=e,i=o.name,a=n.map((e=>"deleted"===e.type?f.ST(t):"option"===e.type?e.value.value:"truncation"===e.type?e.value:void(0,d.t1)(e)));return 0===a.length?(0,b.jsx)(c.FormattedMessage,{...f.Mw({propertyName:i})}):1===a.length?(0,b.jsx)(c.FormattedMessage,{...f.rf({propertyName:i,propertyValue:a[0]})}):(0,b.jsx)(c.FormattedMessage,{...f.Sj({propertyName:i,propertyValue:(0,h.H)(t.formatList(a,{style:"long",type:"conjunction"}))})})}},90073:(e,t,o)=>{o.d(t,{LQ:()=>f,yr:()=>h});var n=o(67294),i=o(86628),a=o(24405),r=o(76218),s=o(3729),l=o(9291),c=o(37810),u=o(26388),d=o(56812),p=o(93060),m=o(47957),g=o(87181),y=o(85893);function h(e){const{actionMenu:t,buttonPopupStore:o,disabled:h,onClick:x,propertySchema:S,value:v}=e,b=(0,l.useIntl)(),C=(0,r.A6)(null==v?void 0:v.value)[0],M=(0,a.yK)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"nowrap",whiteSpace:"pre"},propertyName:{...c.Z.textOverflowStyle,fontWeight:c.Z.fontWeight.semibold}})),[]),k=(0,i.VK)((()=>function(e){const{intl:t,propertySchema:o,styles:n,value:i}=e;if(!i||"string"!=typeof i)return;const a=(0,y.jsx)("span",{style:n.propertyName,children:o.name}),r=(0,g.L)({intl:t,groupValues:[],optionValues:[i],propertySchema:o});if(0===r.length)return;return(0,y.jsx)(l.FormattedMessage,{...(0,d.Ig)({propertyName:a,propertyValue:r})})}({intl:b,propertySchema:S,styles:M,value:C})),[b,S,C,M]),j=(0,i.VK)((()=>f({intl:b,propertySchema:S,value:C})),[b,S,C]),P=(0,n.useCallback)((e=>(0,y.jsx)(m.YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:h,icon:s.T,onClick:x,children:(0,y.jsx)("div",{style:M.content,children:k})})),[t,o,h,x,M.content,k]);return k&&j?(0,y.jsx)(p.y,{renderOrigin:P,title:j,tooltipAlignment:u.v2.Center,tooltipPlacement:u.ug.Left}):null}function f(e){const{intl:t,propertySchema:o,value:n}=e;if(!n||"string"!=typeof n)return;const i=o.name,a=(0,g.L)({intl:t,isText:!0,groupValues:[],optionValues:[n],propertySchema:o});return 0!==a.length?(0,y.jsx)(l.FormattedMessage,{...(0,d.Ig)({propertyName:i,propertyValue:a})}):void 0}},19656:(e,t,o)=>{o.d(t,{GJ:()=>I,Kh:()=>V,QQ:()=>T,Vk:()=>w,gi:()=>B,go:()=>F,lG:()=>A});var n=o(67294),i=o(480),a=o(86628),r=o(24405),s=o(84619),l=o(48524),c=o(55159),u=o(34093),d=o(108),p=o(83303),m=o(8938),g=o(23867),y=o(9291),h=o(37810),f=o(26388),x=o(85567),S=o(60682),v=o(14976),b=o(56812),C=o(12455),M=o(93060),k=o(47957),j=o(85893);function P(e){const{actionMenu:t,buttonPopupStore:o,disabled:l,icon:c,onClick:u,propertySchema:d,value:p}=e,{automationStore:m}=(0,C.i)(),P=(0,i.O7)(),T=(0,r.Fg)(),w=(0,r.yK)((()=>({content:{alignItems:"center",display:"flex"},propertyName:{...h.Z.textOverflowStyle,fontWeight:h.Z.fontWeight.semibold}})),[]),V=(0,a.VK)((()=>function(e){const{automationStore:t,environment:o,propertySchema:n,styles:i,theme:a,value:r}=e,l=void 0===(null==r?void 0:r.value),c=null!=r&&r.value?(0,v.IY)({disabled:!0,disableDateStyleAnnotations:!0,disableHover:!0,disableLinks:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,emojiType:(0,S.e_)(o),environment:o,formulaValueTypes:[],katex:o.KatexStore.getKatex(),parentStore:t,stopLinkPropagation:!0,textValue:{value:null==r?void 0:r.value,spaceId:(0,g.C)(t.pointer.spaceId)},theme:a}):null,u=(0,j.jsx)("span",{style:i.propertyName,children:n.name}),d=(0,j.jsx)(x.Z,{format:s.lo.Medium,isRound:!0,isSingle:!0,shouldShrink:!0,showRemoveButton:!1,value:(0,j.jsx)("span",{style:h.Z.textOverflowStyle,children:c})}),p=l?b.NZ({propertyName:u}):b.vE({propertyName:u,propertyValue:d});return(0,j.jsx)(y.FormattedMessage,{...p})}({automationStore:m,environment:P,propertySchema:d,styles:w,theme:T,value:p})),[m,P,d,w,T,p]),I=(0,a.VK)((()=>A({automationStore:m,environment:P,propertySchema:d,theme:T,value:p})),[m,P,d,T,p]),F=(0,n.useCallback)((e=>(0,j.jsx)(k.YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:l,icon:c,onClick:u,children:(0,j.jsx)("div",{style:w.content,children:V})})),[t,o,l,c,u,w.content,V]);return V&&I?(0,j.jsx)(M.y,{renderOrigin:F,title:I,tooltipAlignment:f.v2.Center,tooltipPlacement:f.ug.Left}):null}function A(e){const{automationStore:t,environment:o,propertySchema:n,theme:i,value:a}=e,r=void 0===(null==a?void 0:a.value),s=null!=a&&a.value?(0,v.IY)({disabled:!0,disableDateStyleAnnotations:!0,disableHover:!0,disableLinks:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,emojiType:(0,S.e_)(o),environment:o,formulaValueTypes:[],katex:o.KatexStore.getKatex(),parentStore:t,stopLinkPropagation:!0,textValue:{value:null==a?void 0:a.value,spaceId:(0,g.C)(t.pointer.spaceId)},theme:i}):null,l=n.name,c=s,u=r?b.NZ({propertyName:l}):b.vE({propertyName:l,propertyValue:c});return(0,j.jsx)(y.FormattedMessage,{...u})}function T(e){return(0,j.jsx)(P,{...e,icon:p.c})}function w(e){return(0,j.jsx)(P,{...e,icon:d.p})}function V(e){return(0,j.jsx)(P,{...e,icon:l.n})}function I(e){return(0,j.jsx)(P,{...e,icon:m.O})}function F(e){return(0,j.jsx)(P,{...e,icon:c.J})}function B(e){return(0,j.jsx)(P,{...e,icon:u.u})}},23645:(e,t,o)=>{o.d(t,{JS:()=>b,K1:()=>C,OZ:()=>x,gq:()=>S,l6:()=>v});var n=o(67294),i=o(86628),a=o(24405),r=o(54497),s=o(9291),l=o(37810),c=o(31945),u=o(65183),d=o(4023),p=o(61766),m=o(35294),g=o(93060),y=o(47957),h=o(86034),f=o(85893);function x(e){const{actionMenu:t,buttonPopupStore:o,disabled:n,onClick:i,propertySchema:r}=e,s=(0,a.yK)((e=>({icon:{fill:e.text.uiRedPrimary},propertyType:{color:e.accentColors.red[700]}})),[]),l=b({propertySchema:r,styles:s}),c=C({propertySchema:r});return(0,f.jsx)(S,{actionMenu:t,buttonPopupStore:o,disabled:n,onClick:i,styles:s,tooltip:c,children:l})}function S(e){const{actionMenu:t,buttonPopupStore:o,children:i,disabled:s,onClick:c,styles:u,tooltip:p}=e,m=(0,a.yK)((e=>({content:{color:e.text.uiRedPrimary,fontWeight:l.Z.fontWeight.medium,whiteSpace:"normal"}})),[]),h=(0,n.useCallback)((e=>(0,f.jsx)(y.YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:s,icon:r.t,onClick:c,styles:u,children:(0,f.jsx)("div",{style:m.content,children:i})})),[t,o,i,s,c,u,m.content]);return(0,f.jsx)(g.y,{renderOrigin:h,title:p,tooltipAlignment:d.v.Center,tooltipPlacement:d.u.Left})}function v(e){const{actionId:t,propertyId:o,renderOrigin:a}=e,r=(0,m.d)(),s=(0,i.qz)(void 0,p.Z),l=(0,n.useCallback)((()=>s.reset()),[s]);return(0,f.jsx)(c.ZP,{buttonPopupStore:s,popupType:r,render:()=>(0,f.jsx)(h.qO,{actionId:t,closeMenu:l,propertyId:o}),renderOrigin:a})}function b(e){const{propertySchema:t,styles:o}=e,n=t.type,i=u.SO[n];return(0,f.jsx)(s.FormattedMessage,{defaultMessage:"{propertyTypeDisplayName} property type is not supported",id:"updateThisPageUnsupportedPropertyAction.unsupportedProperty.title",values:{propertyTypeDisplayName:(0,f.jsx)("span",{style:o.propertyType,children:i})}})}function C(e){const{propertySchema:t}=e,o=t.type,n=u.SO[o];return(0,f.jsx)(s.FormattedMessage,{defaultMessage:"{propertyTypeDisplayName} property type is not supported",id:"updateThisPageUnsupportedPropertyAction.unsupportedProperty.title",values:{propertyTypeDisplayName:n}})}},92688:(e,t,o)=>{o.d(t,{_:()=>y,k:()=>g});var n=o(67294),i=o(480),a=o(86628),r=o(5149),s=o(66890),l=o(58812),c=o(43627),u=o(12455),d=o(53570),p=o(86034),m=o(85893);function g(e){const{actionId:t,closeMenu:o,propertyId:d}=e,{automationContextStore:g,automationStore:y,maybePersistedTransactionActions:h}=(0,u.i)(),f=(0,s.DK)(),x=(0,i.O7)(),S=(0,a.VK)((()=>null==f?void 0:f.settingsStore),[f]),v=(0,a.VK)((()=>y.getName()??""),[y]),b=(0,a.VK)((()=>{const e=y.getActionStores().find((e=>e.id===t));if(null!=e&&e.isDefined())return e}),[y,t]),C=(0,n.useCallback)((()=>{const e=null==g?void 0:g.context;e&&b&&(h.createAndCommit({perform:t=>{c.removeAutomationAction({actionStore:b,clientContext:e,environment:x,transaction:t})},userAction:"UnsupportedPropertyMenu.removeAction"}),null==o||o())}),[b,null==g?void 0:g.context,o,x,h]),M=(0,n.useMemo)((()=>{if(S&&d)return async function(){await(0,l.hL)({automationName:v,hasPendingChanges:!0})&&r.H4({collectionSettingsStore:S,item:{type:"deletedProperties",timelineViewTab:"timeline"}}),null==o||o()}}),[v,o,S,d]);return(0,m.jsx)(p.PO,{onDelete:C,onRestore:M,stepType:"action"})}function y(e){const{closeMenu:t,propertyId:o}=e,{automationStore:i}=(0,u.i)(),c=(0,s.DK)(),{removePropertyTrigger:g}=(0,d.i)(),y=(0,a.VK)((()=>null==c?void 0:c.settingsStore),[c]),h=(0,a.VK)((()=>{const e=null==c?void 0:c.collectionStore();return Boolean(!(null!=e&&e.getDeletedSchema()[o]))}),[c,o]),f=(0,a.VK)((()=>i.getName()??""),[i]),x=(0,n.useCallback)((()=>{g(o),null==t||t()}),[t,o,g]),S=(0,n.useMemo)((()=>{if(y&&!h)return async function(){await(0,l.hL)({automationName:f,hasPendingChanges:!0})&&r.H4({collectionSettingsStore:y,item:{timelineViewTab:"timeline",type:"deletedProperties"}}),null==t||t()}}),[f,t,y,h]);return(0,m.jsx)(p.PO,{onDelete:x,onRestore:S,stepType:"trigger"})}},86034:(e,t,o)=>{o.d(t,{Iw:()=>P,PO:()=>A,qO:()=>j});var n=o(67294),i=o(480),a=o(86628),r=o(24405),s=o(50780),l=o(37612),c=o(55863),u=o(9291),d=o(1898),p=o(5149),m=o(52275),g=o(78140),y=o(32163),h=o(72495),f=o(66890),x=o(58812),S=o(68641),v=o(43627),b=o(12455),C=o(95193),M=o(53570),k=o(85893);function j(e){const{actionId:t,closeMenu:o,propertyId:r}=e,{automationContextStore:s,automationStore:l,maybePersistedTransactionActions:c}=(0,b.i)(),u=(0,f.DK)(),d=(0,i.O7)(),m=(0,a.VK)((()=>null==u?void 0:u.settingsStore),[u]),g=(0,a.VK)((()=>u&&(0,S.jI)({collectionContextStore:u,timelineViewTab:"timeline"})),[u]),y=(0,a.VK)((()=>l.getName()??""),[l]),h=(0,a.VK)((()=>{const e=l.getActionStores().find((e=>e.id===t));if(null!=e&&e.isDefined())return e}),[l,t]),C=(0,n.useCallback)((()=>{const e=null==s?void 0:s.context;e&&h&&(c.createAndCommit({perform:t=>{v.removeAutomationAction({actionStore:h,clientContext:e,environment:d,transaction:t})},userAction:"UnsupportedPropertyMenu.removeAction"}),null==o||o())}),[h,null==s?void 0:s.context,o,d,c]),M=(0,n.useMemo)((()=>{if(m&&g&&r)return async function(){await(0,x.hL)({automationName:y,hasPendingChanges:!0})&&p.H4({collectionSettingsStore:m,item:{type:"property",formatKey:g,property:r}}),null==o||o()}}),[y,o,m,g,r]);return(0,k.jsx)(A,{onDelete:C,onEdit:M,stepType:"action"})}function P(e){const{closeMenu:t,propertyId:o}=e,{automationStore:i}=(0,b.i)(),r=(0,f.DK)(),{removePropertyTrigger:s}=(0,M.i)(),l=(0,a.VK)((()=>null==r?void 0:r.settingsStore),[r]),c=(0,a.VK)((()=>r&&(0,S.jI)({collectionContextStore:r,timelineViewTab:"timeline"})),[r]),u=(0,a.VK)((()=>i.getName()??""),[i]),d=(0,n.useCallback)((()=>{s(o),null==t||t()}),[t,o,s]),m=(0,n.useMemo)((()=>{if(l&&c&&o)return async function(){await(0,x.hL)({automationName:u,hasPendingChanges:!0})&&p.H4({collectionSettingsStore:l,item:{type:"property",formatKey:c,property:o}}),null==t||t()}}),[u,t,l,c,o]);return(0,k.jsx)(A,{onDelete:d,onEdit:m,stepType:"trigger"})}function A(e){const{onDelete:t,onEdit:o,onRestore:a,stepType:p}=e,f=(0,C.F)({width:266}),x=(0,i.Fy)().isMobile,S=(0,r.yK)((e=>({icon:{color:e.accentColors.gray[600],height:"auto",width:x?"12px":"16px"}})),[x]),v=(0,n.useMemo)((()=>(0,d.$K)(o)?{action:o,key:"edit-property-menu-item",render:e=>(0,k.jsx)(m.Z,{...e,icon:(0,s.E)(S.icon),title:(0,k.jsx)(u.FormattedMessage,{defaultMessage:"Edit property",id:"unsupportedPropertyMenu.editMenuItem.title"})})}:void 0),[o,S.icon]),b=(0,n.useMemo)((()=>(0,d.$K)(a)?{action:a,key:"restore-property-menu-item",render:e=>(0,k.jsx)(m.Z,{...e,icon:(0,c.s)(S.icon),title:(0,k.jsx)(u.FormattedMessage,{defaultMessage:"Restore property",id:"unsupportedPropertyMenu.restoreMenuItem.title"})})}:void 0),[a,S.icon]),M=(0,n.useMemo)((()=>(0,d.$K)(t)?{action:t,key:"delete-property-menu-item",render:e=>(0,k.jsx)(m.Z,{...e,icon:(0,l.y)(S.icon),title:"action"===p?(0,k.jsx)(u.FormattedMessage,{id:"automationUnsupportedPropertyMenu.deleteAction.title",defaultMessage:"Delete action"}):(0,k.jsx)(u.FormattedMessage,{id:"automationUnsupportedPropertyMenu.deleteTrigger.title",defaultMessage:"Delete trigger"})})}:void 0),[t,p,S.icon]);return(0,k.jsx)(g.Z,{...f,children:(0,k.jsx)(y.Z,{initialFocus:0,sections:[{key:"actions-section",items:[v,b,M].filter(d.$K),render:e=>(0,k.jsx)(h.Z,{...e})}],type:y.i.Vertical})})}},25757:(e,t,o)=>{o.d(t,{F:()=>M,Z:()=>S});var n=o(67294),i=o(480),a=o(86628),r=o(24405),s=o(80721),l=o(12392),c=o(9291),u=o(37810),d=o(73063),p=o(78140),m=o(32163),g=o(40721),y=o(89728),h=o(60709),f=o(85893);const x=(0,c.defineMessages)({backButtonAriaLabel:{id:"notificationRuleSettingsMenu.backButton.ariaLabel",defaultMessage:"Back to previous step"}});function S(e){const{type:t,automationTriggerActionMenuStore:o,headerTitle:n,onClose:i,width:a,onDone:r}=e,s=M({automationTriggerActionMenuStore:o,onClose:i,onDone:r,title:n,width:a});return"custom"===t?(0,f.jsx)(b,{...e,menuProps:s}):(0,f.jsx)(v,{...e,menuProps:s})}function v(e){const{sections:t,menuProps:o}=e;return(0,f.jsx)(p.Z,{...o,children:(0,f.jsx)(m.Z,{type:m.i.Vertical,initialFocus:0,sections:t})})}function b(e){const{children:t,menuProps:o}=e;return(0,f.jsx)(p.Z,{...o,children:t})}function C(e){const{automationActionMenuStore:t,menuHeaderTitle:o,onDone:n}=e,i=(0,c.useIntl)(),l=(0,a.VK)((()=>t.state.stack.length>1),[t]),p=(0,r.yK)((e=>({header:{display:"flex",alignItems:"center",margin:8,color:e.mediumTextColor,fontWeight:u.Z.fontWeight.medium,fontSize:u.Z.fontSize.UISmall.desktop},iconButtonStyle:{marginRight:8,marginLeft:-2,height:22},iconButtonIconStyle:{width:16,height:16},doneButtonStyle:{marginLeft:"auto"}})),[]);return void 0!==o||l?(0,f.jsxs)("div",{style:p.header,children:[l&&(0,f.jsx)(d.Z,{ariaLabel:i.formatMessage(x.backButtonAriaLabel),icon:s.W,style:p.iconButtonStyle,iconStyle:p.iconButtonIconStyle,onClick:()=>{t.popSettingsItem()}}),o,n&&(0,f.jsx)(y.Z,{onClick:n,isBlue:!0,style:p.doneButtonStyle,children:(0,f.jsx)(c.FormattedMessage,{id:"automationTriggerActionMenu.doneButton.title",defaultMessage:"Done"})})]}):null}function M(e){const{automationTriggerActionMenuStore:t,leftStyle:o,onClose:a,onDone:r,rightStyle:s,title:u,titleStyle:p,width:m}=e,{isMobile:y}=(0,i.Fy)(),S=(0,c.useIntl)(),v=(0,n.useCallback)((()=>{1===t.getState().stack.length?a():t.popSettingsItem()}),[t,a]);return(0,n.useMemo)((()=>{let e;return e=y?{leftOuterStyle:o,menuType:h.og.Modal,title:u,titleOuterStyle:p,left:(0,f.jsx)(d.Z,{ariaLabel:S.formatMessage(x.backButtonAriaLabel),icon:l.S,onClick:v}),right:(0,f.jsx)(g.DoneMenuText,{}),rightOuterStyle:s,onClickRight:()=>{null==r||r(),a()}}:{width:m??266,menuType:h.og.Popup,maxHeight:"50vh",header:(0,f.jsx)(C,{automationActionMenuStore:t,menuHeaderTitle:u,onDone:r})},e}),[t,S,y,o,a,r,v,s,u,p,m])}},66315:(e,t,o)=>{o.d(t,{R:()=>b});o(21703);var n=o(67294),i=o(86628),a=o(25651),r=o(37612),s=o(9291),l=o(1898),c=o(52275),u=o(78140),d=o(32163),p=o(72495),m=o(26388),g=o(61766),y=o(12455),h=o(95193),f=o(67473),x=o(93060),S=o(47957),v=o(85893);function b(e){const{onDelete:t,styles:o}=e,{disabled:a}=(0,y.i)(),r=Boolean(a),s=(0,i.qz)(void 0,g.Z),l=(0,n.useCallback)((()=>{if(!t)throw new Error("onDelete is not implemented for trigger");t(),s.setState({open:!1})}),[s,t]),c=(0,n.useMemo)((()=>t?(0,v.jsx)(C,{onDelete:l}):null),[t,l]),u=(0,n.useCallback)((t=>{const n=e.onClick?S.YG:S._S;return(0,v.jsx)(n,{...t,actionMenu:c,buttonPopupStore:s,disabled:r,icon:e.icon,onClick:e.onClick,styles:o,children:e.children})}),[e.onClick,e.icon,e.children,c,s,r,o]);return(0,v.jsx)(f.HC,{children:(0,v.jsx)(x.y,{disable:r,renderOrigin:u,title:e.tooltip,tooltipAlignment:m.v2.Center,tooltipPlacement:m.ug.Left})})}function C(e){const{onClose:t,onEdit:o,onDelete:n}=e,i=(0,h.F)(),m=[o?{action:()=>{null==t||t(),o()},key:"edit",render:e=>(0,v.jsx)(c.Z,{...e,icon:(0,a.R)({height:16,width:16}),title:(0,v.jsx)(s.FormattedMessage,{id:"automationBaseStepElement.moreActionsMenu.edit",defaultMessage:"Edit"})})}:void 0,n?{action:()=>{null==t||t(),n()},key:"delete",render:e=>(0,v.jsx)(c.Z,{...e,icon:(0,r.y)({height:16,width:16}),title:(0,v.jsx)(s.FormattedMessage,{id:"automationBaseStepElement.moreActionsMenu.delete",defaultMessage:"Delete"})})}:void 0].filter(l.$K);return(0,v.jsx)(u.Z,{...i,children:(0,v.jsx)(d.Z,{type:d.i.Vertical,sections:[{items:m,key:"items",render:e=>(0,v.jsx)(p.Z,{enableActionSheetTitle:!0,topBorder:!0,...e})}],initialFocus:0})})}},55307:(e,t,o)=>{o.d(t,{Z:()=>U});var n=o(67294),i=o(86628),a=o(1898),r=o(91738),s=o(43261),l=o.n(s),c=o(24405),u=o(3865),d=o(12396),p=o(5257),m=o(25651),g=o(47453),y=o(9291),h=o(47307),f=o(52275),x=o(68894),S=o(78140),v=o(32163),b=o(72495),C=o(54802),M=o(12455),k=o(95193),j=o(53570),P=o(85893);const A=(0,y.defineMessages)({searchInputPlaceholder:{id:"automationEventTriggerMenu.searchInputPlaceholder.label",defaultMessage:"Search for trigger…"},pageAddedCopy:{id:"automationEventTriggerMenu.pageAdded.title",defaultMessage:"Page added"},pagePropertiesEditedCopy:{id:"automationEventTriggerMenu.anyPropertyEdited.title",defaultMessage:"Any property"}});function T(e){const{automationTriggerMenuStore:t,onClose:o}=e,{automationStore:r,collectionStore:s}=(0,M.P)(),T=(0,c.Fg)(),w=(0,y.useIntl)(),V=(0,j.i)(),I=(0,n.useMemo)((()=>({...V,closeMenu:o})),[V,o]),[F,B]=n.useState(""),Z=(0,i.VK)((()=>s.getSchema()),[s]),K=(0,i.VK)((()=>r.getTrigger()),[r]),_=(0,i.VK)((()=>("event"===(null==K?void 0:K.type)||"notification_event"===(null==K?void 0:K.type))&&K.event.pagesAdded),[K]),R=(0,i.VK)((()=>(0,u.XO)({collectionFormat:s.getFormat(),collectionSchema:Z})),[s,Z]),W=(0,C.EF)({collectionSchema:Z,propertyIds:R,searchTerm:F}),L=(0,c.yK)((e=>({propertyIcon:{width:16,height:16,color:e.mediumIconColor}})),[]),D=(0,k.F)({maxHeight:"50vh",width:266}),N=(0,P.jsx)(x.ZP,{focus:!0,style:{marginTop:12,marginBottom:6},value:F,onChange:e=>{B(e.target.value)},placeholder:w.formatMessage(A.searchInputPlaceholder)}),O=_?void 0:function(e){const{intl:t,searchInput:o,styles:n,actions:i}=e,a=t.formatMessage(A.pageAddedCopy);if(!l().test(o,a))return;return{key:"page_added_section",items:[{key:"page_added",action(){i.addPageAddedTrigger(),i.closeMenu()},render:e=>(0,P.jsx)(f.Z,{...e,icon:(0,g.R)(n.propertyIcon),title:a})}],render:e=>(0,P.jsx)(b.Z,{...e})}}({intl:w,searchInput:F,actions:I,styles:L}),E=(0,i.VK)((()=>function(e){const{automationTriggerValue:t,automationTriggerMenuStore:o,showTopBorder:n,properties:i,collectionSchema:r,theme:s,intl:c,searchInput:g,styles:x,actions:S}=e,v=c.formatMessage(A.pagePropertiesEditedCopy);let C=!1,M=[];"event"!==(null==t?void 0:t.type)&&"notification_event"!==(null==t?void 0:t.type)||(C="any"===t.event.pagePropertiesEdited.type,M="some"===t.event.pagePropertiesEdited.type?t.event.pagePropertiesEdited.some:[]);const k=[C||!l().test(g,v)?void 0:{key:"any_property_edited",action:async()=>{const e=await async function(e){const{hasSpecificPropertyChangedFilters:t}=e;if(!t)return!0;return await h.confirmUserAction({message:(0,P.jsx)(y.FormattedMessage,{id:"automations.eventTriggerMenu.replaceTriggerConfirmation.message",defaultMessage:"Replace other triggers?"}),description:(0,P.jsx)(y.FormattedMessage,{id:"automations.eventTriggerMenu.replaceTriggerConfirmation.description",defaultMessage:"Adding the 'Any property edited' trigger will replace all other property triggers."}),acceptLabel:(0,P.jsx)(y.FormattedMessage,{id:"automations.eventTriggerMenu.replaceTriggerConfirmation.acceptLabel",defaultMessage:"Replace"})})}({hasSpecificPropertyChangedFilters:M.length>0});e&&(S.addAnyPropertyEditedTrigger(),S.closeMenu())},render:e=>(0,P.jsx)(f.Z,{...e,icon:(0,m.R)(x.propertyIcon),title:v})},...i.map((e=>{if(!M.find((t=>t.property===e)))return function(e){const{automationTriggerMenuStore:t,propertyId:o,collectionSchema:n,theme:i,actions:a}=e,r=n[o];if(!r)return;const s=(0,u.bD)(r);return{key:o,action:()=>{s?t.pushSettingsItem({type:"propertyChangedFilter",property:o}):(a.addPropertyTrigger({property:o,filter:{operator:"changes_to_any"}}),a.closeMenu())},render:e=>(0,P.jsx)(f.Z,{...e,icon:(0,P.jsx)(d.ZP,{icon:r.icon,type:r.type,size:16,theme:i}),title:r.name,right:s?(0,p.o)({marginLeft:6,width:12,height:"auto"}):void 0})}}({propertyId:e,collectionSchema:r,theme:s,automationTriggerMenuStore:o,actions:S})})).filter(a.$K)].filter(a.$K);if(0===k.length)return;return{key:"page_properties_edited_section",items:k,render:e=>(0,P.jsx)(b.Z,{...e,topBorder:n,title:(0,P.jsx)(y.FormattedMessage,{id:"automationEventTriggerMenu.pagePropertiesEditedSection.title",defaultMessage:"Property edited"})})}}({automationTriggerValue:K,automationTriggerMenuStore:t,showTopBorder:Boolean(O),properties:W,collectionSchema:Z,theme:T,searchInput:F,intl:w,styles:L,actions:I})),[K,t,O,W,Z,T,F,w,L,I]),H=n.useMemo((()=>{const e=[O,E].filter(a.$K);return 0===e.length?[{key:"none",items:[{key:"none-item",action:()=>{},render:e=>(0,P.jsx)(f.Z,{...e,disabled:!0,disabledFeedback:!0,title:(0,P.jsx)(y.FormattedMessage,{id:"automations.eventTriggerMenu.noResultsItem",defaultMessage:"No results"})})}],render:e=>(0,P.jsx)(b.Z,{...e})}]:e}),[O,E]);return(0,P.jsx)(S.Z,{...D,header:N,children:(0,P.jsx)(v.Z,{type:v.i.Vertical,sections:H,initialFocus:0})})}var w=o(76205),V=o(25757);function I(e){const{propertyId:t,automationTriggerMenuStore:o,propertySchema:a,propertyChangedFilter:r,onClose:s}=e,{updatePropertyTrigger:l}=(0,j.i)(),c=(0,i.VK)((()=>"changes_to_any"===r.operator?[{type:"exact",value:!0},{type:"exact",value:!1}]:(0,w.XA)(r)&&(0,w.vR)(r)?Array.isArray(r.value)?r.value:[r.value]:[]),[r]),[u,d]=(0,n.useState)(c),p=(0,n.useMemo)((()=>1===u.length?{operator:"checkbox_is",value:u[0]}:{operator:"changes_to_any"}),[u]),m=(0,n.useMemo)((()=>2===u.length||1===u.length&&"partial"),[u]),g=(0,n.useCallback)((e=>{const t=Boolean(u.find((t=>t.value===e)));d(t?u.filter((t=>t.value!==e)):[...u,{type:"exact",value:e}])}),[u]),h=(0,n.useCallback)((()=>{l({anyOptionCheckState:m,propertyId:t,currentFilter:p}),s()}),[m,p,s,t,l]),x=Boolean(u.find((e=>!0===e.value))),S=Boolean(u.find((e=>!1===e.value)));return(0,P.jsx)(V.Z,{type:"default",automationTriggerActionMenuStore:o,onDone:h,onClose:s,sections:[{key:"select",render:e=>(0,P.jsx)(b.Z,{...e,topBorder:!0}),items:[{key:"unchecked",render:e=>(0,P.jsx)(f.Z,{...e,checkState:S,isTokenTitle:!0,title:(0,P.jsx)(y.FormattedMessage,{defaultMessage:"Unchecked",id:"automations.propertyTrigger.checkbox.unchecked"})}),action:()=>g(!1)},{key:"checked",render:e=>(0,P.jsx)(f.Z,{...e,checkState:x,isTokenTitle:!0,title:(0,P.jsx)(y.FormattedMessage,{defaultMessage:"Checked",id:"automations.propertyTrigger.checkbox.checked"})}),action:()=>g(!0)}]}],headerTitle:(0,P.jsx)(y.FormattedMessage,{id:"automations.propertyTrigger.checkbox.title",defaultMessage:"{propertyName} set to",values:{propertyName:a.name}})})}var F=o(480),B=o(80951),Z=o(84619),K=o(53965),_=o(56416),R=o(60458),W=o(22084),L=o(47082);function D(e){const{propertyId:t,automationTriggerMenuStore:o,propertySchema:r,propertyChangedFilter:s,onClose:l}=e,{isMobile:c,isAndroid:u}=(0,F.Fy)(),d=(0,y.useIntl)(),{updatePropertyTrigger:p}=(0,j.i)(),m=(0,i.VK)((()=>{if("changes_to_any"===s.operator){return(r.options??[]).map((e=>({type:"exact",value:e.value})))}if(!(0,w.dx)(s)&&!(0,w.NU)(s))return[];if((0,w.vR)(s)){const e=(r.options??[]).map((e=>e.value));return(Array.isArray(s.value)?s.value:[s.value]).filter((t=>(0,a.$K)(t.value)&&e.includes(t.value)))}return[]}),[r,s]),[g,h]=n.useState(m),x=(0,i.VK)((()=>function(e){const{propertySchema:t,selectedOptions:o}=e;let n=!1,i=!0;const a=t.options??[];for(const r of a){const e=o.some((e=>e.value===r.value));n||=e,i&&=e}return!!i||!!n&&"partial"}({propertySchema:r,selectedOptions:g})),[r,g]),S=n.useMemo((()=>(r.options??[]).map((e=>({type:"exact",value:e.value})))),[r]),v=n.useMemo((()=>"multi_select"===r.type?{operator:"enum_contains",value:g}:"select"===r.type?{operator:"enum_is",value:g}:(0,a.t1)(r)),[r,g]),C=!0===x?[]:g.map((e=>{if(!e.value||!r.options)return;const t=(0,B.i7)(r.options,e.value);return t?(0,P.jsx)(W.a,{format:c?Z.lo.Large:Z.lo.Small,isSingle:!1,value:t.value,color:t.color,showRemoveButton:!0,onClickRemove:()=>{const t=K.zu(g,e);h(t)}},t.id):void 0})),[M,k]=n.useState(""),A=(0,_.I4)({query:M,propertySchema:r,selectedValues:g,updateValue:e=>{k(""),h(e)},isMobile:c,styles:{}}),T=[{key:"search",items:[{key:"input",action:()=>{},render:e=>(0,P.jsx)(L.Z,{...e,focusInitial:!0,onClick:void 0,focusAfterAnimation:!0,format:L.U.FilterValue,tokens:C,placeholder:x?d.formatMessage({defaultMessage:"Any option",id:"automations.selectPropertyChangedFilter.inputPlaceholder.anyOption"}):d.formatMessage({defaultMessage:"Select one or more options…",id:"automations.selectPropertyChangedFilter.inputPlaceholder.searchPlaceholder"}),onRemoveLastToken:()=>{const e=g.slice(0,g.length-1);h(e)},onClearButtonClick:()=>{h([]),l()},value:M,onChange:e=>{k(e.target.value)},dontShowBorderBottom:u,showClearButton:!0})}],render:e=>(0,P.jsx)(b.Z,{...e})},{key:"any",items:[{key:"any-option-item",action:()=>{!0===x?h([]):!1===x||"partial"===x?h(S):(0,a.t1)(x),k("")},render:e=>(0,P.jsx)(f.Z,{...e,icon:(0,P.jsx)(R.Z,{checked:x,size:14,onClick:e.onClick}),title:(0,P.jsx)(y.FormattedMessage,{id:"automations.selectPropertyChangedFilter.anyOption.title",defaultMessage:"Any option"})})}],render:e=>(0,P.jsx)(b.Z,{...e,topBorder:!0})},A.length>0?{key:"items",items:A,render:e=>(0,P.jsx)(b.Z,{...e,topBorder:!0})}:void 0].filter(a.$K);return(0,P.jsx)(V.Z,{type:"default",automationTriggerActionMenuStore:o,onDone:()=>{p({anyOptionCheckState:x,propertyId:t,currentFilter:v}),l()},onClose:l,sections:T,headerTitle:(0,P.jsx)(y.FormattedMessage,{id:"automations.propertyChangedFilterHeader.select.title",defaultMessage:"{propertyName} set to",values:{propertyName:r.name}})})}var N=o(11299),O=o(97004);function E(e){const{propertyId:t,automationTriggerMenuStore:o,propertySchema:r,propertyChangedFilter:s,onClose:l}=e,{isMobile:c}=(0,F.Fy)(),{updatePropertyTrigger:u}=(0,j.i)(),d=(0,i.VK)((()=>{if("changes_to_any"===s.operator){return(r.groups??[]).map((e=>({type:"is_group",value:e.name})))}return(0,w.r2)(s)&&(0,w.vR)(s)?(0,w.wB)(s):[]}),[r,s]),[p,m]=n.useState(d),g=(0,i.VK)((()=>function(e){const{propertySchema:t,selectedStatusOptions:o}=e,n=t.groups??[],i=t.options??[],a=n.map((e=>(0,O.IX)({group:e,options:i,filterValues:o}))),r=a.every((e=>!0===e.groupCheckState)),s=a.some((e=>!1!==e.groupCheckState));return!!r||!!s&&"partial"}({propertySchema:r,selectedStatusOptions:p})),[r,p]),h=n.useMemo((()=>(r.groups??[]).map((e=>({type:"is_group",value:e.name})))),[r]),x=(0,N.S)({propertySchema:r,statusFilterValues:p,updateValue:e=>{m(e)},isMobile:c,styles:{},visibleOptions:r.options??[]});return(0,P.jsx)(V.Z,{type:"default",automationTriggerActionMenuStore:o,onDone:()=>{u({anyOptionCheckState:g,propertyId:t,currentFilter:{operator:"status_is",value:p}}),l()},onClose:()=>{l()},sections:[{key:"any",items:[{key:"any-option-item",action:()=>{!0===g?m([]):!1===g||"partial"===g?m(h):(0,a.t1)(g)},render:e=>(0,P.jsx)(f.Z,{...e,icon:(0,P.jsx)(R.Z,{checked:g,size:14,onClick:e.onClick}),title:(0,P.jsx)(y.FormattedMessage,{id:"automationEventTriggerPropertyChangedFilterMenu.anyOption.title",defaultMessage:"Any option"})})}],render:e=>(0,P.jsx)(b.Z,{...e})},{key:"items",items:x,render:e=>(0,P.jsx)(b.Z,{...e,topBorder:!0})}],headerTitle:(0,P.jsx)(y.FormattedMessage,{id:"automations.propertyChangedFilterHeader.status.title",defaultMessage:"{propertyName} set to",values:{propertyName:r.name}})})}function H(e){const{propertyId:t,automationTriggerMenuStore:o,onClose:n}=e,{automationStore:a,collectionStore:r}=(0,M.P)(),s=(0,i.VK)((()=>r.getSchema()),[r])[t],l=(0,i.VK)((()=>a.getTrigger()),[a]);let c=[];"event"!==(null==l?void 0:l.type)&&"notification_event"!==(null==l?void 0:l.type)||(c="some"===l.event.pagePropertiesEdited.type?l.event.pagePropertiesEdited.some:[]);const d=c.find((e=>e.property===t))??{property:t,filter:{operator:"changes_to_any"}};if(!s)return null;return(0,u.bD)(s)?"multi_select"===s.type||"select"===s.type?(0,P.jsx)(D,{propertyId:t,automationTriggerMenuStore:o,propertySchema:s,propertyChangedFilter:d.filter,onClose:n}):"status"===s.type?(0,P.jsx)(E,{propertyId:t,automationTriggerMenuStore:o,propertySchema:s,propertyChangedFilter:d.filter,onClose:n}):"checkbox"===s.type?(0,P.jsx)(I,{automationTriggerMenuStore:o,onClose:n,propertyChangedFilter:d.filter,propertyId:t,propertySchema:s}):null:null}function U(e){const{initialState:t,buttonPopupParent:o}=e,s=(0,i.VK)((()=>{const e=new r.Bh;return e.setState({insertionPoint:void 0,stack:[t]}),e}),[t]),l=(0,i.VK)((()=>s.getCurrentTab()),[s]),c=(0,n.useCallback)((()=>o.close()),[o]);return l?"eventTriggers"===l.type?(0,P.jsx)(T,{automationTriggerMenuStore:s,onClose:c}):"propertyChangedFilter"===l.type?(0,P.jsx)(H,{propertyId:l.property,automationTriggerMenuStore:s,onClose:c}):(0,a.t1)(l):null}},61036:(e,t,o)=>{o.d(t,{Dl:()=>N,ew:()=>D,Zr:()=>O});var n=o(67294),i=o(86628),a=o(12455),r=o(24405),s=o(47453),l=o(9291),c=o(37810),u=o(56812),d=o(53570),p=o(66315),m=o(85893);function g(){const{removeAnyPropertyEditedTrigger:e}=(0,d.i)(),t=(0,l.useIntl)(),o=(0,r.yK)((()=>({title:{fontWeight:c.Z.fontWeight.medium}})),[]),n=u.c5(t);return(0,m.jsx)(p.R,{icon:s.R,onDelete:e,tooltip:n,children:(0,m.jsx)("div",{style:o.title,children:n})})}var y=o(3865),h=o(76205),f=o(31945),x=o(35294),S=o(55307);function v(e){const{renderOrigin:t,property:o}=e,n=(0,x.d)();return(0,m.jsx)(f.ZP,{popupType:n,renderOrigin:t,render:e=>(0,m.jsx)(S.Z,{initialState:{type:"propertyChangedFilter",property:o},buttonPopupParent:e})})}var b=o(20239),C=o(51230),M=o(61410);function k(e){let{propertySchema:t,onClick:o}=e;return(0,m.jsx)(M.n,{onClick:o,icon:e=>(0,m.jsx)(C.Y,{propertySchema:t,style:e}),tooltip:(0,m.jsx)(P,{propertyName:t.name}),children:(0,m.jsx)(j,{propertyName:t.name})})}function j(e){let{propertyName:t}=e;const o=(0,l.useIntl)(),n=(0,r.yK)((()=>({propertyName:{...c.Z.textOverflowStyle,fontWeight:c.Z.fontWeight.medium},wrap:{alignItems:"center",display:"flex",whiteSpace:"pre"}})),[]),i=u.$G(o,{propertyName:(0,m.jsx)("span",{style:n.propertyName,children:t})});return(0,m.jsx)("span",{style:n.wrap,children:i})}function P(e){let{propertyName:t}=e;const o=(0,l.useIntl)();return(0,m.jsx)(m.Fragment,{children:u.$G(o,{propertyName:t})})}var A=o(54497),T=o(1898),w=o(61766),V=o(29735),I=o(92688);function F(e){const{deletedPropertySchema:t}=e,{property:o}=(0,n.useContext)(D),{removePropertyTrigger:a}=(0,d.i)(),s=(0,r.yK)((e=>({content:{color:e.text.uiRedPrimary,fontWeight:c.Z.fontWeight.medium,whiteSpace:"normal"},icon:{fill:e.text.uiRedPrimary},propertyType:{color:e.accentColors.red[700]}})),[]),l=(0,x.d)(),u=(0,i.qz)(void 0,w.Z),g=(0,n.useCallback)((()=>u.reset()),[u]),y=(0,n.useCallback)((()=>{a(o)}),[o,a]),h=(0,T.$K)(t)?(0,V.Ox)({propertySchema:t,styles:s}):(0,V.fX)(),S=(0,T.$K)(t)?(0,V.Si)({propertySchema:t}):(0,V.fX)();return(0,m.jsx)(f.ZP,{buttonPopupStore:u,popupType:l,render:()=>(0,m.jsx)(I._,{closeMenu:g,propertyId:o}),renderOrigin:e=>(0,m.jsx)(p.R,{...e,icon:A.t,onDelete:y,styles:s,tooltip:S,children:(0,m.jsx)("div",{style:s.content,children:h})})})}var B=o(76954),Z=o(87181),K=o(23645),_=o(86034);function R(e){let{propertySchema:t}=e;const{property:o}=(0,n.useContext)(D),{removePropertyTrigger:a}=(0,d.i)(),s=(0,r.yK)((e=>({content:{color:e.text.uiRedPrimary,fontWeight:c.Z.fontWeight.medium,whiteSpace:"normal"},icon:{fill:e.text.uiRedPrimary},propertyType:{color:e.accentColors.red[700]}})),[]),l=(0,x.d)(),u=(0,i.qz)(void 0,w.Z),g=(0,n.useCallback)((()=>u.reset()),[u]),y=(0,n.useCallback)((()=>{a(o)}),[o,a]),h=(0,K.JS)({propertySchema:t,styles:s}),S=(0,K.K1)({propertySchema:t});return(0,m.jsx)(f.ZP,{buttonPopupStore:u,popupType:l,render:()=>(0,m.jsx)(_.Iw,{closeMenu:g,propertyId:o}),renderOrigin:e=>(0,m.jsx)(p.R,{...e,icon:A.t,onDelete:y,styles:s,tooltip:S,children:(0,m.jsx)("div",{style:s.content,children:h})})})}function W(e){const{collectionStore:t}=(0,a.P)(),{property:o,filter:n}=e,[r,s]=(0,i.VK)((()=>{var e,n;return[null===(e=t.getSchema())||void 0===e?void 0:e[o],null===(n=t.getDeletedSchema())||void 0===n?void 0:n[o]]}),[t,o]);return r?(0,y.$M)(r)?(0,y.bD)(r)?(0,m.jsx)(L,{property:o,propertySchema:r,filter:n}):(0,m.jsx)(k,{propertySchema:r}):(0,m.jsx)(R,{propertySchema:r}):(0,m.jsx)(F,{deletedPropertySchema:s})}function L(e){const{filter:t,propertySchema:o,property:i}=e,a=(0,n.useMemo)((()=>function(e){let{filter:t,propertySchema:o}=e;return e=>"changes_to_any"!==t.operator&&(0,h.vR)(t)?"checkbox"===o.type&&(0,h.XA)(t)?(0,m.jsx)(b.Ij,{...e,filter:t,propertySchema:o}):"status"===o.type&&(0,h.r2)(t)?(0,m.jsx)(Z.V,{...e,filter:t,propertySchema:o}):"select"===o.type&&(0,h.dx)(t)||"multi_select"===o.type&&(0,h.NU)(t)?(0,m.jsx)(B.v,{...e,filter:t,propertySchema:o}):(0,m.jsx)(k,{...e,propertySchema:o}):(0,m.jsx)(k,{...e,propertySchema:o})}({filter:t,propertySchema:o})),[t,o]);return(0,m.jsx)(v,{renderOrigin:a,property:i})}const D=(0,n.createContext)({pagePropertiesEdited:[],property:""});function N(){const{automationContextStore:e,collectionStore:t}=(0,a.i)(),o=(0,i.VK)((()=>null==e?void 0:e.context.automationStore),[e]),n=O(o),r=(0,i.VK)((()=>{var e;if(!o||!o.isTriggerType("event")&&!o.isTriggerType("notification_event"))return;const t=null===(e=o.getEventConfiguration())||void 0===e?void 0:e.pagePropertiesEdited;return"none"===(null==t?void 0:t.type)?void 0:t}),[o]),s=(0,i.VK)((()=>null==t?void 0:t.getSchema()),[t]);return n&&r?"any"===r.type?(0,m.jsx)(g,{}):s?(0,m.jsx)(m.Fragment,{children:r.some.map((e=>{let{property:t,filter:o}=e;return(0,m.jsx)(D.Provider,{value:{property:t,pagePropertiesEdited:r.some},children:(0,m.jsx)(W,{property:t,filter:o})},t)}))}):null:null}function O(e){return(0,i.VK)((()=>{if(!(null!=e&&e.isTriggerType("event")||null!=e&&e.isTriggerType("notification_event")))return!1;const t=e.getEventConfiguration();return Boolean("none"!==(null==t?void 0:t.pagePropertiesEdited.type))}),[e])}},20239:(e,t,o)=>{o.d(t,{Ij:()=>p,l4:()=>g});o(67294);var n=o(24405),i=o(65628),a=o(96711),r=o(9291),s=o(37810),l=o(20776),c=o(56812),u=o(61410),d=o(85893);function p(e){const t=(0,r.useIntl)(),{propertySchema:o,filter:n,onClick:i}=e;return(0,d.jsx)(u.n,{onClick:i,tooltip:g({filter:n,intl:t,propertySchema:o}),children:(0,d.jsx)(m,{propertySchema:o,filter:n})})}function m(e){let{propertySchema:t,filter:o}=e;const i=(0,r.useIntl)(),a=(0,n.yK)((()=>({propertyName:{...s.Z.textOverflowStyle,fontWeight:s.Z.fontWeight.medium},wrap:{alignItems:"center",display:"flex",whiteSpace:"pre"}})),[]),l=function(e){const{filter:t,intl:o,propertySchema:n,styles:i}=e,a=n.name,r=t.value,s={propertyName:(0,d.jsx)("span",{style:i.propertyName,children:a}),propertyValues:(0,d.jsx)(y,{checkboxValue:r.value??!1})};return(0,c.vz)(o,s)}({filter:o,intl:i,propertySchema:t,styles:a});return(0,d.jsx)("span",{style:a.wrap,children:l})}function g(e){const{filter:t,intl:o,propertySchema:n}=e,i={propertyName:n.name,propertyValues:!0===t.value.value?(0,d.jsx)(r.FormattedMessage,{...c.Bo.actionCheckboxPropertyChecked}):(0,d.jsx)(r.FormattedMessage,{...c.Bo.actionCheckboxPropertyUnchecked})};return(0,c.vz)(o,i)}function y(e){const{checkboxValue:t}=e,o=!0===t?(0,a.V)({width:12}):(0,i.z)({width:10}),n=!0===t?(0,d.jsx)(r.FormattedMessage,{...c.Bo.actionCheckboxPropertyChecked}):(0,d.jsx)(r.FormattedMessage,{...c.Bo.actionCheckboxPropertyUnchecked});return(0,d.jsx)(l.o,{icon:o,children:n})}},61410:(e,t,o)=>{o.d(t,{n:()=>d});var n=o(67294),i=o(86628),a=o(12455),r=o(53570),s=o(66315),l=o(51230),c=o(61036),u=o(85893);function d(e){const{property:t}=(0,n.useContext)(c.ew),{collectionStore:o}=(0,a.P)(),{removePropertyTrigger:d}=(0,r.i)(),p=(0,n.useCallback)((()=>{d(t)}),[t,d]),m=(0,i.VK)((()=>o.getSchema()),[o])[t],g=m?e=>(0,u.jsx)(l.Y,{propertySchema:m,style:e}):void 0;return(0,u.jsx)(s.R,{icon:g,onDelete:p,...e,children:e.children})}},76954:(e,t,o)=>{o.d(t,{v:()=>f,z:()=>S});o(67294);var n=o(24405),i=o(80951),a=o(84619),r=o(9291),s=o(1898),l=o(37810),c=o(22084),u=o(85567),d=o(65380),p=o(56812),m=o(37867),g=o(61410),y=o(85893);const h=5;function f(e){const t=(0,r.useIntl)(),{filter:o,propertySchema:n,onClick:i}=e,a={...l.Z.textOverflowStyle,fontWeight:l.Z.fontWeight.medium},c=o.value,u=n.name,m=(Array.isArray(c)?c:[c]).map((e=>e.value)).filter(s.$K),f=S({intl:t,isText:!0,limit:h,optionValues:m,propertySchema:n}),v=t.formatList(f,{style:"long",type:"disjunction"}),b=(0,p.XJ)(t,{propertyName:(0,y.jsx)("span",{style:a,children:u}),propertyValues:(0,d.H)(v)});return(0,y.jsx)(g.n,{tooltip:b,onClick:i,children:(0,y.jsx)(x,{filter:o,propertySchema:n})})}function x(e){const{filter:t,propertySchema:o}=e,i=(0,r.useIntl)(),a=t.value,c=o.name,u=(Array.isArray(a)?a:[a]).map((e=>e.value)).filter(s.$K),m=S({intl:i,limit:h,optionValues:u,propertySchema:o}),g=i.formatList(m,{style:"long",type:"disjunction"}),f=(0,n.yK)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"wrap",whiteSpace:"pre"},propertyName:{...l.Z.textOverflowStyle,fontWeight:l.Z.fontWeight.semibold}})),[]),x=(0,p.XJ)(i,{propertyName:(0,y.jsx)("span",{style:f.propertyName,children:c}),propertyValues:(0,d.H)(g)});return(0,y.jsx)("div",{style:f.content,children:x})}function S(e){let{intl:t,isText:o,limit:n,optionValues:r,propertySchema:s,tokenFormat:l=a.lo.Medium}=e;const d=s.options??[],g=r.map((e=>{const n=(0,i.i7)(d,e);return n?o?n.value:(0,y.jsx)(c.a,{value:n.value,color:n.color,format:l,isSingle:!0,showRemoveButton:!1},n.id):o?(0,p.ST)(t):(0,y.jsx)(m.Z,{tokenFormat:l},`missing_option_value_${e}`)}));let h;if(void 0!==n&&g.length>n){const e=g.length-n,t=o?`+${e}`:(0,y.jsx)(u.Z,{format:a.lo.Medium,isRound:!0,isSingle:!0,showRemoveButton:!1,value:`+${e}`},"More tokens");h=[...g.slice(0,n),t]}else h=g;return h}},87181:(e,t,o)=>{o.d(t,{L:()=>b,V:()=>x});o(67294);var n=o(24405),i=o(76205),a=o(80951),r=o(84619),s=o(9291),l=o(1898),c=o(37810),u=o(22084),d=o(85567),p=o(65380),m=o(56812),g=o(37867),y=o(61410),h=o(85893);const f=5;function x(e){const t=(0,s.useIntl)(),{filter:o,limit:n=f,propertySchema:a,onClick:r}=e,c=a.name,u=(0,i.wB)(o),d=u.map((e=>"is_group"===e.type?e.value:void 0)).filter(l.$K),p=u.map((e=>"is_option"===e.type?e.value:void 0)).filter(l.$K),m=b({intl:t,groupValues:d,limit:n,optionValues:p,propertySchema:a}),g=b({intl:t,isText:!0,groupValues:d,limit:n,optionValues:p,propertySchema:a});return(0,h.jsx)(y.n,{onClick:r,tooltip:(0,h.jsx)(v,{propertyName:c,statusValues:g}),children:(0,h.jsx)(S,{propertyName:c,statusValues:m})})}function S(e){let{propertyName:t,statusValues:o}=e;const i=(0,s.useIntl)(),a=(0,n.yK)((()=>({propertyName:{...c.Z.textOverflowStyle,fontWeight:c.Z.fontWeight.semibold}})),[]),r=i.formatList(o,{style:"long",type:"disjunction"});return(0,h.jsx)(h.Fragment,{children:(0,m.VO)(i,{propertyName:(0,h.jsx)("span",{style:a.propertyName,children:t}),propertyValues:(0,p.H)(r)})})}function v(e){let{propertyName:t,statusValues:o}=e;const i=(0,s.useIntl)(),a=(0,n.yK)((()=>({propertyName:{...c.Z.textOverflowStyle,fontWeight:c.Z.fontWeight.semibold}})),[]),r=i.formatList(o,{style:"long",type:"disjunction"});return(0,h.jsx)(h.Fragment,{children:(0,m.VO)(i,{propertyName:(0,h.jsx)("span",{style:a.propertyName,children:t}),propertyValues:(0,p.H)(r)})})}function b(e){let{groupValues:t,intl:o,isText:n,limit:i,optionValues:s,propertySchema:c,tokenFormat:p=r.lo.Medium}=e;const y=c.groups||[],f=c.options||[],x=t.map((e=>{const t=y.find((t=>t.name===e));if(t)return n?t.name:(0,h.jsx)("span",{children:t.name},t.id)})).filter(l.$K),S=s.map((e=>{const t=(0,a.i7)(f,e);if(void 0===t)return n?(0,m.ST)(o):(0,h.jsx)(g.Z,{tokenFormat:p},`missing_option_value_${e}`);if(n)return t.value;const i=y.find((e=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));return(0,h.jsx)(u.F,{format:p,isSingle:!0,value:t.value,color:t.color,groupColor:null==i?void 0:i.color,showRemoveButton:!1,showEllipsis:!0},t.id)})),v=[...x,...S];let b=[];if(void 0!==i&&v.length>i){const e=S.length-i,t=n?`+${e}`:(0,h.jsx)(d.Z,{format:r.lo.Medium,isRound:!0,isSingle:!0,showRemoveButton:!1,value:`+${e}`},"More tokens");b=[...S.slice(0,i),t]}else b=v;return b}},51230:(e,t,o)=>{o.d(t,{Y:()=>r});o(67294);var n=o(24405),i=o(12396),a=o(85893);function r(e){let{style:t,propertySchema:o}=e;const r=(0,n.Fg)();return(0,a.jsx)(i.ZP,{size:16,theme:r,icon:o.icon,style:t,type:o.type})}},65380:(e,t,o)=>{o.d(t,{H:()=>i});o(57658),o(67294);var n=o(85893);function i(e){if(!Array.isArray(e))return[e];const t=[];for(const o of e)if("string"==typeof o&&" "!==o[0]){const e=t.pop();t.push((0,n.jsxs)("div",{children:[e,o]}))}else t.push(o);return t}},56812:(e,t,o)=>{o.d(t,{$G:()=>k,Bo:()=>i,Ig:()=>f,Iu:()=>d,Mw:()=>g,Mz:()=>b,NZ:()=>x,Oq:()=>u,S0:()=>p,ST:()=>T,Sj:()=>h,VO:()=>A,XJ:()=>P,aD:()=>v,c5:()=>C,hW:()=>a,ht:()=>l,nf:()=>M,oJ:()=>w,om:()=>m,rf:()=>y,vE:()=>S,vz:()=>j,wE:()=>c,xf:()=>r,zU:()=>s});var n=o(80951);const i=(0,o(9291).defineMessages)({actionCheckboxPropertyChecked:{defaultMessage:"checked",id:"automations.action.checkboxProperty.checked"},actionCheckboxPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.checkboxProperty.single"},actionCheckboxPropertyUnchecked:{defaultMessage:"unchecked",id:"automations.action.checkboxProperty.unchecked"},actionDatePropertyClear:{defaultMessage:"Clear {propertyName}",id:"automations.action.dateProperty.clear"},actionDatePropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.dateProperty.single"},actionPersonPropertyClear:{defaultMessage:"Clear {propertyName}",id:"automations.action.personProperty.clear"},actionPersonPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.personProperty.single"},actionPersonPropertySetMultiple:{defaultMessage:"Set {propertyName} to all of {propertyValues}",id:"automations.action.personProperty.multiple"},actionRelationPropertyClear:{defaultMessage:"Clear {propertyName}",id:"automations.action.relationProperty.clear"},actionRelationPropertySetMultiple:{defaultMessage:"Set {propertyName} to all of {propertyValues}",id:"automations.action.relationProperty.multiple"},actionRelationPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.relationProperty.single"},actionSelectPropertyClear:{defaultMessage:"Clear {propertyName}",id:"automations.action.selectProperty.clear"},actionSelectPropertySetMultiple:{defaultMessage:"Set {propertyName} to all of {propertyValues}",id:"automations.action.selectProperty.multiple"},actionSelectPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.selectProperty.single"},actionStatusPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.statusProperty.single"},actionTextPropertyClear:{defaultMessage:"Clear {propertyName}",id:"automations.action.textProperty.clear"},actionTextPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.textProperty.single"},actionDeletedProperty:{defaultMessage:"Edit a deleted property",id:"automations.action.deletedProperty"},triggerAnyPageAdded:{defaultMessage:"Page added",id:"automations.trigger.pageAdded.title"},triggerAnyPagePropertyEdit:{defaultMessage:"Any property edited",id:"automations.trigger.anyPagePropertyEdited.title"},triggerAnyPropertyEdit:{defaultMessage:"{propertyName} is edited",id:"automations.trigger.propertyChangesToAny.title"},triggerButtonClicked:{defaultMessage:"<b>Button</b> is clicked",id:"automations.trigger.button.clicked"},triggerCheckboxPropertyChecked:{defaultMessage:"checked",id:"automations.trigger.checkboxProperty.checked"},triggerCheckboxPropertySet:{defaultMessage:"{propertyName} set to {propertyValues}",id:"automations.trigger.checkboxPropertySet.title"},triggerCheckboxPropertyUnchecked:{defaultMessage:"unchecked",id:"automations.trigger.checkboxProperty.unchecked"},triggerSelectPropertySet:{id:"automations.trigger.selectPropertySet.title",defaultMessage:"{propertyName} set to {propertyValues}"},triggerStatusPropertySet:{defaultMessage:"{propertyName} set to {propertyValues}",id:"automations.trigger.statusPropertySet.singleProperty"},triggerDeletedPropertyEdit:{defaultMessage:"Deleted property is edited",id:"automations.trigger.deletedPropertyEdited"},deletedPropertyOption:{defaultMessage:"Deleted option",id:"automations.values.deletedPropertyOption"},unknownValue:{defaultMessage:"Unknown value",id:"automations.values.unknownValue"},unknownPropertyTitle:{defaultMessage:"a property",id:"database.viewSettings.automationTab.unknownPropertyTitle"}});function a(e){const{propertyName:t,propertyValue:o}=e;return{...i.actionCheckboxPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function r(e){const{propertyName:t}=e;return{...i.actionDatePropertyClear,values:{propertyName:t}}}function s(e){const{propertyName:t,propertyValue:o}=e;return{...i.actionDatePropertySetSingle,values:{propertyName:t,propertyValue:o}}}function l(e){const{propertyName:t}=e;return{...i.actionPersonPropertyClear,values:{propertyName:t}}}function c(e){const{propertyName:t,propertyValue:o}=e;return{...i.actionPersonPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function u(e){const{propertyName:t,propertyValue:o}=e;return{...i.actionPersonPropertySetMultiple,values:{propertyName:t,propertyValues:o}}}function d(e){const{propertyName:t}=e;return{...i.actionRelationPropertyClear,values:{propertyName:t}}}function p(e){const{propertyName:t,propertyValue:o}=e;return{...i.actionRelationPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function m(e){const{propertyName:t,propertyValue:o}=e;return{...i.actionRelationPropertySetMultiple,values:{propertyName:t,propertyValues:o}}}function g(e){const{propertyName:t}=e;return{...i.actionSelectPropertyClear,values:{propertyName:t}}}function y(e){const{propertyName:t,propertyValue:o}=e;return{...i.actionSelectPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function h(e){const{propertyName:t,propertyValue:o}=e;return{...i.actionSelectPropertySetMultiple,values:{propertyName:t,propertyValues:o}}}function f(e){const{propertyName:t,propertyValue:o}=e;return{...i.actionStatusPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function x(e){const{propertyName:t}=e;return{...i.actionTextPropertyClear,values:{propertyName:t}}}function S(e){const{propertyName:t,propertyValue:o}=e;return{...i.actionTextPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function v(e){return e.formatMessage(i.actionDeletedProperty)}function b(e){return e.formatMessage(i.triggerAnyPageAdded)}function C(e){return e.formatMessage(i.triggerAnyPagePropertyEdit)}function M(e){return e.formatMessage(i.triggerDeletedPropertyEdit)}function k(e,t){const{propertyName:o}=t;return e.formatMessage(i.triggerAnyPropertyEdit,{propertyName:o})}function j(e,t){return e.formatMessage(i.triggerCheckboxPropertySet,t)}function P(e,t){return e.formatMessage(i.triggerSelectPropertySet,t)}function A(e,t){return e.formatMessage(i.triggerStatusPropertySet,t)}function T(e){return e.formatMessage(i.deletedPropertyOption)}function w(e){const{limit:t,optionValues:o,propertySchema:i}=e,a=i.options??[],r=a.length>0,s=o.map((e=>{const t=r?(0,n.i7)(a,e):void 0;return t?{type:"option",value:t}:{type:"deleted",value:e}}));let l=s;if(void 0!==t&&s.length>t){const e=s.length-t;l=[...s.slice(0,t),{type:"truncation",value:`+${e}`}]}return l}},91494:(e,t,o)=>{o.d(t,{X:()=>r});var n=o(86628),i=o(33929),a=o(68910);function r(e){const{automationStore:t,collectionStore:o}=e;return(0,n.VK)((()=>{if(!o||!t)return;const e=o.getSpaceShardedPointer();return new a.L({automationStore:t,parentPointer:e,type:"event",intl:i.default.getIntl(),parentRecordStore:o})}),[o,t])}},12455:(e,t,o)=>{o.d(t,{P:()=>s,i:()=>r});o(21703);var n=o(67294),i=o(86628),a=o(9015);function r(){const e=(0,n.useContext)(a.Z),t=(0,i.VK)((()=>{var t;return null===(t=e.automationContextStore)||void 0===t?void 0:t.context.automationStore}),[e.automationContextStore]);if(!t)throw new Error("automationStore is undefined. Is this rendered inside an AutomationEditorContext.Provider?");return{...e,automationStore:t}}function s(){const{collectionStore:e,automationStore:t,...o}=r(),n=(0,i.VK)((()=>{if(!(null!=t&&t.isTriggerType("event")||null!=t&&t.isTriggerType("notification_event")))throw new Error("automationStore is wrong type. Is this called in the wrong type of automation?");return t}),[t]);if(!e)throw new Error("collectionStore is undefined. Is this rendered inside an AutomationEditorContext.Provider?");return{...o,collectionStore:e,automationStore:n}}},73266:(e,t,o)=>{o.d(t,{a:()=>a});var n=o(67294),i=o(9015);function a(){const e=(0,n.useContext)(i.Z),{editorWidth:t}=e;return t<500}},35294:(e,t,o)=>{o.d(t,{d:()=>r});var n=o(480),i=o(86628),a=o(53437);function r(e){const t=(0,n.Fy)();return(0,i.VK)((()=>t.isPhone||"slideUp"===(null==e?void 0:e.tabletBehavior)&&t.isTablet?a.kQ.SlideUp:a.kQ.Popup),[t,null==e?void 0:e.tabletBehavior])}},53570:(e,t,o)=>{o.d(t,{i:()=>l});o(57658);var n=o(67294),i=o(2647),a=o(13447),r=o(63474),s=o(12455);function l(){const{automationStore:e,collectionStore:t,maybePersistedTransactionActions:o}=(0,s.P)(),l=(0,r.D)(),u=(0,n.useMemo)((()=>({automation_id:e.id,collection_id:t.id})),[e.id,t.id]),d=(0,n.useCallback)((()=>{var t;const o=null===(t=e.getTrigger())||void 0===t?void 0:t.event.pagePropertiesEdited,n="some"===(null==o?void 0:o.type)&&o.some;return n||[]}),[e]),p=(0,n.useCallback)((t=>{o.createAndCommit({userAction:"automations.removePropertyTrigger",perform:o=>{a.applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{pagePropertiesEdited:0===t.length?{type:"none"}:{type:"some",some:t}}},transaction:o})}})}),[e,o]);return{addPropertyTrigger:(0,n.useCallback)((e=>{p([...d(),e]);const o=t.getSchema()[e.property];(0,i.nK)(l,{automation_trigger:{type:"property",condition:"some",property_types:null!=o&&o.type?[o.type]:[]},...u})}),[u,t,l,d,p]),updatePropertyTrigger:(0,n.useCallback)((e=>{const{anyOptionCheckState:o,propertyId:n,currentFilter:a}=e,r=d();p((()=>{switch(o){case"partial":return c(r,(e=>e.property===n),(e=>({...e,filter:a})),{property:n,filter:a});case!0:return c(r,(e=>e.property===n),(e=>({...e,filter:{operator:"changes_to_any"}})),{property:n,filter:{operator:"changes_to_any"}});case!1:return r.filter((e=>e.property!==n))}})());const s=t.getSchema()[n];(0,i.nK)(l,{automation_trigger:{type:"property",condition:"some",property_types:null!=s&&s.type?[s.type]:[]},...u})}),[u,t,l,d,p]),removePropertyTrigger:(0,n.useCallback)((e=>{p(d().filter((t=>t.property!==e)));const o=t.getSchema()[e];(0,i.Ey)(l,{automation_trigger:{type:"property",condition:"some",property_types:null!=o&&o.type?[o.type]:[]},...u})}),[u,t,l,d,p]),addPageAddedTrigger:(0,n.useCallback)((()=>{o.createAndCommit({userAction:"automations.addPageAddedTrigger",perform:t=>{a.applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{pagesAdded:!0}},transaction:t})}}),(0,i.nK)(l,{automation_trigger:{type:"page"},...u})}),[u,e,l,o]),removePageAddedTrigger:(0,n.useCallback)((()=>{o.createAndCommit({userAction:"automations.removePageAddedTrigger",perform:t=>{a.applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{pagesAdded:!1}},transaction:t})}}),(0,i.Ey)(l,{automation_trigger:{type:"page"},...u})}),[u,e,l,o]),addAnyPropertyEditedTrigger:(0,n.useCallback)((()=>{o.createAndCommit({userAction:"automations.addAnyPagePropertyEditedTrigger",perform:t=>{a.applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{pagePropertiesEdited:{type:"any"}}},transaction:t})}}),(0,i.nK)(l,{automation_trigger:{type:"property",condition:"any"},...u})}),[u,e,l,o]),removeAnyPropertyEditedTrigger:(0,n.useCallback)((()=>{o.createAndCommit({userAction:"automations.removeAnyPropertyEditedTrigger",perform:t=>{a.applyOperation({store:e,operation:{path:["trigger","event"],args:{pagePropertiesEdited:{type:"none"}},pointer:e.pointer,command:"update"},transaction:t})}}),(0,i.Ey)(l,{automation_trigger:{type:"property",condition:"any"},...u})}),[u,e,l,o])}}function c(e,t,o,n){let i=!1;const a=e.map((e=>t(e)?(i=!0,o(e)):e));return i||a.push(n),a}},72865:(e,t,o)=>{o.d(t,{D:()=>f});var n=o(67294),i=o(480),a=o(24405),r=o(20852),s=o(993),l=o(13447),c=o(43250),u=o(68657),d=o(34859),p=o(24666),m=o(28385),g=o(53336),y=o(65187),h=o(85893);function f(e){const{value:t,disabled:o,onChange:f,multiline:x,maximumInputLines:S,placeholder:v,disableFormattingAndMentions:b,disableMobileActionBar:C,disableEmojiCommands:M,disableTemplateVariableMentions:k,code:j}=e,P=(0,i.O7)(),A=(0,a.yK)((e=>({wrap:{flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow,borderRadius:4,padding:x?"6px 10px":"4px 8px",overflow:x&&S?"scroll":"hidden",..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},text:x?S?{minHeight:60,maxHeight:20*S}:{minHeight:60}:{whiteSpace:"pre"},placeholder:x?{minHeight:60}:{}})),[x,S,60,20]),T=(0,n.useCallback)((e=>{f({type:"simple",value:e})}),[f]),{store:w}=(0,u.Cl)({initialValue:null==t?void 0:t.value,onChange:T}),V=(0,n.useMemo)((()=>x?()=>{const e=p.default.state;"editing"===e.mode&&l.createAndCommit({userAction:"SimpleFormulaValueTextInput.handleEnter",environment:P,perform:t=>{s.hJ({environment:P,editorMode:"default",string:"\n",multiSelection:e.multiSelection,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t})}})}:void 0),[P,x]);return j?(0,h.jsx)("div",{style:A.wrap,className:c.Wh_,children:(0,h.jsx)(m.Z,{disabled:o,store:w,language:r.PrismLanguages.jsx,blockStore:void 0,codeWrap:!1,isQuickFind:!1,parentSpaceId:"",style:{padding:0}})}):(0,h.jsx)(g.Z,{style:A.wrap,className:c.Wh_,type:d.Z.Y,children:(0,h.jsx)(y.Z,{placeholder:v,disabled:o,store:w,style:A.text,placeholderStyle:A.placeholder,pasteBehavior:"inline",disableSlashCommands:!0,disableEmbedMenu:!0,disableEmojiCommands:M,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:V,disableMobileActionBar:C,inPageFind:{type:"none"},...b?{disableMentions:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableFilters:!0}:{disabledMentionTypes:{templateVariable:k}}})})}},61586:(e,t,o)=>{o.d(t,{Z:()=>D});var n=o(67294),i=o(480),a=o(86628),r=o(24405),s=o(76218),l=o(40190),c=o(61766),u=o(31945),d=o(53437),p=o(72865),m=o(40470),g=o(60709),y=o(77907),h=o(78140),f=o(40721),x=o(65668),S=o(85893);const v=(0,y.withDependency)(y.deps.formulas,((e,t)=>(0,S.jsx)(b,{...t,formulas:e})));function b(e){const{value:t,onChange:o,onClose:r,disabled:s,contextStore:l,formulas:c}=e,u=(0,i.Fy)(),d=(0,n.useCallback)((()=>{o({type:"simple",value:null==t?void 0:t.value}),r()}),[o,r,null==t?void 0:t.value]),p=(0,n.useCallback)((e=>{void 0!==e&&e[0][0].length?o({type:"formula",value:e}):o(void 0),r()}),[o,r]),y=(0,a.VK)((()=>l.context.parentRecordStore.getSpaceId()),[l.context.parentRecordStore]),v=(0,a.Kw)(l.compilationResultStore),b=(0,n.useMemo)((()=>c.createFormulaDataRequestHandler(l.context.parentRecordStore.getRecordModel,l.context.parentRecordStore.loadRecordModel)),[l.context.parentRecordStore.getRecordModel,l.context.parentRecordStore.loadRecordModel,c]),C=(0,a.VK)((()=>{if(m.x.isFail(v))return;return{valueTypes:v.value.valueTypes,handleDataRequest:b}}),[v,b],{useDeepEqual:!0});let M;return M=u.isMobile?{menuType:g.og.Modal,right:(0,S.jsx)(f.DoneMenuText,{}),onClickRight:parent.close}:{menuType:g.og.Popup,maxHeight:"50vh",width:600,height:320,disableHeaderBorder:!0},y&&C?(0,S.jsx)(h.Z,{...M,children:(0,S.jsx)(x.Z,{formulas:c,initialCode:null==t?void 0:t.value,typecheckContext:C,handleClose:p,handleBack:d,parentSpaceId:y,disabled:s,focus:!0,evaluationErrors:[],getRecordModel:l.context.parentRecordStore.getRecordModel})}):null}var C=o(70203),M=o(68657),k=o(65187);function j(e){const{value:t,disabled:o,buttonPopupStore:i,onChange:a}=e,s=(0,r.yK)((e=>({wrap:{flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow,borderRadius:4,padding:4}})),[]),l=(0,n.useCallback)((e=>{"="===(0,C.QaF)(e)&&(0,M.NY)()?(a({type:"formula",value:void 0}),i.setState({open:!0})):a({type:"simple",value:e})}),[a,i]),{store:c}=(0,M.Cl)({initialValue:null==t?void 0:t.value,onChange:l});return(0,S.jsx)("div",{style:s.wrap,children:(0,S.jsx)(k.Z,{disabled:o,store:c,pasteBehavior:"inline",disableSlashCommands:!0,disableEmojiCommands:!0,disableMentions:!0,disableEmbedMenu:!0,disableMobileActionBar:!0,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableEquationInteraction:!0,inPageFind:{type:"none"}})})}var P=o(53498),A=o(18466),T=o(13991),w=o(32426),V=o(9291),I=o(1898),F=o(37810),B=o(60682),Z=o(14976),K=o(75311),_=o(30387);function R(e){const{value:t,type:o,currentSimpleFormulaValueTokens:n,contextStore:i,context:s,placeholder:l}=e,{collectionStore:c,property:u}=s,d=(0,r.yK)((()=>({tokenWrap:{display:"flex",alignItems:"center",flexGrow:1,overflow:"hidden",marginTop:6}})),[]),p=(0,K.M)(c,u),m=(0,a.VK)((()=>(0,M.NY)()),[]);if("formula"===(null==t?void 0:t.type)&&t.value&&m)return(0,S.jsx)(L,{...e});if("text"===o.type||"number"===o.type)return null;if("date"===o.type||"select"===o.type||"checkbox"===o.type){const e=n[0];return void 0===e?(0,S.jsx)(W,{placeholder:l}):(0,S.jsx)("div",{style:d.tokenWrap,children:(0,S.jsx)(P.K,{token:e,contextStore:i,disabled:!0,currentSimpleFormulaValueTokens:n,context:s})})}if("person_array"===o.type||"block_array"===o.type||"select_array"===o.type)return 0===n.length?(0,S.jsx)(W,{placeholder:l}):(0,S.jsx)("div",{style:d.tokenWrap,children:p(n,"first").map(((e,t)=>(0,S.jsx)(P.K,{token:e,contextStore:i,disabled:!0,currentSimpleFormulaValueTokens:n,context:s},t)))});(0,I.t1)(o)}function W(e){const{placeholder:t}=e,o=(0,r.yK)((e=>({placeholderText:{color:e.lightTextColor}})),[]);return(0,S.jsx)("div",{style:o.placeholderText,children:t?(0,S.jsx)(V.FormattedMessage,{defaultMessage:"{placeholder}",values:{placeholder:t},id:"formulas.SimpleFormulaValuePicker.people.customPlaceholder"}):(0,S.jsx)(V.FormattedMessage,{..._.s.personSelect})})}function L(e){const{value:t,contextStore:o}=e,s=(0,i.O7)(),l=(0,r.Fg)(),c=(0,r.yK)((e=>({wrap:{display:"flex",alignItems:"center",pointerEvents:"none",fontFamily:F.Z.getCompositeFontFamily(T.SP).githubMono,fontSize:12,flexGrow:1,...F.Z.textOverflowStyle},icon:{width:14,fill:e.mediumIconColor,marginRight:6}})),[]),u=(0,B.kw)(),d=(0,a.VK)((()=>s.KatexStore.getKatex()),[s]),p=(0,a.VK)((()=>o.context.parentRecordStore.getSpaceId()),[o.context.parentRecordStore]),g=(0,a.Kw)(o.compilationResultStore),y=m.x.isSuccess(g)?g.value.valueTypes:void 0,h=(0,n.useMemo)((()=>A.Z.withListenerIgnored((()=>(0,Z.IY)({environment:s,textValue:null!=t&&t.value&&p?{value:t.value,spaceId:p}:void 0,parentStore:o.context.parentRecordStore,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disabled:!0,theme:l,emojiType:u,katex:d,parentBlockId:void 0,renderedPageBlockId:void 0,formulaValueTypes:y||[]})))),[t,p,s,o.context.parentRecordStore,u,d,l,y]);return(0,S.jsxs)("div",{style:c.wrap,children:[(0,w.D)(c.icon),h]})}function D(e){const{type:t,value:o,disabled:n}=e,m=(0,i.Fy)(),g=!o||"simple"===o.type,y=(0,a.VK)((()=>(0,s.A6)(null==o?void 0:o.value)),[o]),h=(0,r.yK)((e=>({button:{flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow}})),[]),f=(0,a.qz)(void 0,c.Z);return"number"===t.type&&g?(0,S.jsx)(j,{...e,buttonPopupStore:f}):"text"===t.type?(0,S.jsx)(p.D,{...e}):(0,S.jsx)(u.ZP,{popupType:m.isMobile?d.kQ.SlideUp:d.kQ.Popup,alignmentToOrigin:u.vR.End,placementToOrigin:u.pO.Bottom,originGap:0,buttonPopupStore:f,disabled:n,renderOrigin:t=>(0,S.jsx)(l.S,{disabled:n,variant:"gray",...t,style:h.button,children:(0,S.jsx)(R,{...e,currentSimpleFormulaValueTokens:y})}),render:t=>g?(0,S.jsx)(P.a,{...e,onClose:t.close,currentSimpleFormulaValueTokens:y}):(0,S.jsx)(v,{...e,onClose:t.close})})}},53498:(e,t,o)=>{o.d(t,{a:()=>Me,K:()=>j});var n=o(67294),i=o(480),a=o(86628),r=o(66897),s=o(99036),l=o(80951),c=o(84619),u=o(35102),d=o(76218),p=o(19889),m=o(70203),g=o(40470),y=o(1898),h=o(37867),f=o(60458),x=o(92864),S=o(89845),v=o(25845),b=o(22084),C=o(21396),M=o(75311),k=o(85893);function j(e){const{token:t,contextStore:o,disabled:n,setCurrentTokens:j,currentSimpleFormulaValueTokens:P,context:A}=e,T=(0,i.Fy)(),w=(0,a.Kw)(o.compilationResultStore),V=(0,a.VK)((()=>{if((0,d.S3)(t)&&(0,m.IWo)(t)){const e=(0,m.zEN)(t);if(e)return(0,r.Hl)({pointer:{table:p.KJ,id:e},getRecordValue:o.context.parentRecordStore.getRecordValue})}}),[o.context.parentRecordStore,t]),I=(0,a.VK)((()=>(0,M._)(A)),[A]),F=(0,a.VK)((()=>A.collectionStore.getSchema()[A.property]),[A]);if("string"==typeof t){if(!F||!(0,s.t)(F))return null;const e=(0,l.i7)((null==F?void 0:F.options)??[],t);if(!e)return(0,k.jsx)(h.Z,{isSingle:!1,showRemoveButton:!n,onClickRemove:()=>{null==j||j((0,d.Ck)(P,t))}},`deleted_option_value_${t}`);const o={value:e.value,color:e.color,isSingle:!1,showRemoveButton:!n,format:T.isMobile?c.lo.Medium:c.lo.Small,onClickRemove:()=>{null==j||j((0,d.Ck)(P,t))}};if((0,s.gB)(F)){var B;const t=null===(B=F.groups)||void 0===B||null===(B=B.find((t=>{var o;return null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id)})))||void 0===B?void 0:B.color;return(0,k.jsx)(b.F,{...o,groupColor:t})}return(0,k.jsx)(b.a,{...o})}if("boolean"==typeof t)return(0,k.jsx)(f.Z,{checked:t,disabled:!0,size:16,checkSize:12,style:{marginBottom:6}},t.toString());if((0,m.IWo)(t))return null!=V&&V.asActor?(0,k.jsx)(x.ZP,{actor:V,format:T.isMobile?x.ZP.Format.Medium:x.ZP.Format.Small,showRemoveButton:!n,onClickRemove:()=>{null==j||j((0,d.Ck)(P,t))},shouldShrink:!0,isSingle:!1},V.id):null;if((0,m.wjk)(t)){const e=(0,m.vmO)(t).id,o=g.x.isSuccess(w)?(0,u.vx)(w.value.valueTypes,e):void 0;return o?(0,k.jsx)(C.F,{value:o,format:c.lo.Small,isSingle:!1,shouldShrink:!0,showRemoveButton:!n,onClickRemove:()=>{null==j||j((0,d.Ck)(P,t))}}):null}if((0,m.fpG)(t)){const e=P[0],t=e&&(0,d.S3)(e)&&(0,m.fpG)(e)?(0,m.zyO)(e):void 0;return t?(0,k.jsx)(S.Z,{value:t,dateFormat:I.dateFormat,timeFormat:I.timeFormat,style:{marginBottom:6}}):null}if((0,m.STW)(t)){const e=(0,m.TOT)(t);return e?(0,k.jsx)(v.Z,{format:T.isMobile?c.lo.Medium:c.lo.Small,blockId:e,shouldWrap:!1,shouldShrink:!0,isSingle:!1,parentStore:o.context.parentRecordStore,showRemoveButton:!n,onClickRemove:()=>{null==j||j((0,d.Ck)(P,t))}},e):null}(0,y.t1)(t)}o(57658);var P=o(99319),A=o(73110),T=o(58573),w=o(59054),V=o(9291),I=o(53965),F=o(68657),B=o(60709),Z=o(77907),K=o(75822),_=o(29798),R=o(78140),W=o(32163),L=o(43765),D=o(40721),N=o(72495),O=o(78948),E=o(47082),H=o(30387),U=o(32426),z=o(24405),$=o(5257),q=o(52275);function G(e){const t=(0,z.yK)((e=>({icon:{width:14,fill:e.mediumIconColor},chevronRight:{width:12,fill:e.mediumIconColor}})),[]);return(0,k.jsx)(q.Z,{icon:e.icon(t.icon),title:e.title,focused:!1,right:(0,$.o)(t.chevronRight),onClick:e.onClick})}function Y(e){const{value:t,onChange:o}=e,i=(0,n.useCallback)((()=>{o({type:"formula",value:null==t?void 0:t.value})}),[t,o]);return(0,k.jsx)(G,{icon:U.D,title:(0,k.jsx)(V.FormattedMessage,{...H.s.customFormula}),onClick:i})}o(21703);var Q=o(21202),J=o(6258),X=o(11470),ee=o(26388);const te=(0,V.defineMessages)({maximumPeopleSelectedTooltip:{defaultMessage:"Maximum people selected",id:"valuePickerItem.maximumSelectedReached"}});function oe(e){const{token:t,contextStore:o,args:n,checkState:h,checkType:S,context:v,onCheckboxClick:M,disabled:j}=e,P=(0,i.Fy)(),A=(0,a.VK)((()=>o.context.parentRecordStore.getSpaceId()),[o.context.parentRecordStore]),T=(0,a.VK)((()=>{if((0,d.S3)(t)&&(0,m.IWo)(t)){const e=(0,m.zEN)(t);if(e)return(0,r.Hl)({pointer:{table:p.KJ,id:e},getRecordValue:o.context.parentRecordStore.getRecordValue})}}),[o.context.parentRecordStore,t]),w=(0,a.VK)((()=>v.collectionStore.getSchema()[v.property]),[v]),I=(0,a.VK)((()=>w&&(0,s.t)(w)?w.options??[]:[]),[w]),F=(0,a.VK)((()=>w&&(0,s.gB)(w)?w.groups??[]:[]),[w]),B=(0,a.Kw)(o.compilationResultStore),Z=(0,z.yK)((e=>({disabledMenuItem:{cursor:"not-allowed",opacity:.4}})),[]),K=Boolean(w&&(0,s.gB)(w)),_="single"===S?{checkState:h}:"multi"===S?{icon:(0,k.jsx)(f.Z,{style:j?Z.disabledMenuItem:void 0,checked:h,size:14,onClick:M,disabled:j})}:{};if("string"==typeof t){if(K){const e=(0,l.i7)(I,t),o=F.find((t=>{var o;return e&&(null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id))}));return e?(0,k.jsx)(q.Z,{...n,..._,title:(0,k.jsx)(b.F,{format:P.isMobile?c.lo.Large:c.lo.Small,isSingle:!0,value:e.value,color:e.color,groupColor:null==o?void 0:o.color,shouldShrink:!0,showRemoveButton:!1},t),isTokenTitle:!0,disabled:j,style:j?Z.disabledMenuItem:void 0,...n}):null}{const e=(0,l.i7)(I,t);return e?(0,k.jsx)(q.Z,{...n,..._,title:(0,k.jsx)(b.a,{value:e.value,color:e.color,showRemoveButton:!1,isSingle:!0,shouldShrink:!0,format:P.isMobile?c.lo.Large:c.lo.Small}),isTokenTitle:!0,disabled:j,style:j?Z.disabledMenuItem:void 0,...n}):null}}if("boolean"==typeof t)return null;if((0,m.IWo)(t))return null!=T&&T.asActor&&T.table===p.KJ?(0,k.jsx)(q.Z,{...n,..._,title:j?(0,k.jsx)(ee.ZP,{renderTooltip:()=>(0,k.jsx)(V.FormattedMessage,{...te.maximumPeopleSelectedTooltip}),placement:ee.ug.Right,render:e=>(0,k.jsx)("div",{style:{width:"100%"},...e,children:(0,k.jsx)(x.vw,{isSingle:!0,shouldShrink:!0,format:P.isMobile?x.vw.Format.Large:x.vw.Format.Medium,userValue:T.asActor})})}):(0,k.jsx)(x.vw,{isSingle:!0,shouldShrink:!0,format:P.isMobile?x.vw.Format.Large:x.vw.Format.Medium,userValue:T.asActor}),disabled:j,style:j?Z.disabledMenuItem:void 0,isTokenTitle:!0}):null;if((0,m.wjk)(t)){const e=(0,m.vmO)(t).id,o=g.x.isSuccess(B)?(0,u.vx)(B.value.valueTypes,e):void 0;return o?(0,k.jsx)(q.Z,{..._,title:(0,k.jsx)(ee.ZP,{renderTooltip:()=>j?(0,k.jsx)(V.FormattedMessage,{...te.maximumPeopleSelectedTooltip}):(0,C.e)(o),placement:ee.ug.Right,render:e=>(0,k.jsx)("div",{style:{display:"flex"},...e,children:(0,k.jsx)(C.F,{value:o,format:c.lo.Medium,isSingle:!0,shouldShrink:!0})})}),disabled:j,style:j?Z.disabledMenuItem:void 0,...n}):null}if((0,m.fpG)(t))return null;if((0,m.STW)(t)){const e=(0,m.TOT)(t);if(!e)return null;if(!A)return null;const i=J.G.createChildStore(o.context.parentRecordStore,{table:Q.iU,id:e,spaceId:A});return(0,k.jsx)(X.Z,{store:i,checkState:h,hidePath:!0,...n})}(0,y.t1)(t)}function ne(e){const{currentSimpleFormulaValueTokens:t,value:o,contextStore:n,setCurrentTokens:i,action:a,context:r,checkType:s,onCheckboxClick:l,isDisabled:c}=e;if(o.kind!==A.yp.ContextValue)throw new Error("Not implemented yet.");const u=Boolean(t.find((e=>(0,d.S3)(e)&&(0,m.wjk)(e)&&(0,m.vmO)(e).id===o.id))),p=(0,m._QF)({id:o.id}),g=()=>{i("append"===a?u?(0,d.Ck)(t,p):[...t,p]:[p]),null==l||l()};return{key:o.id,render:e=>(0,k.jsx)(oe,{disabled:c,token:p,contextStore:n,args:e,checkState:u,checkType:s,context:r,onCheckboxClick:g}),action:g}}function ie(e){var t,o;const{currentSimpleFormulaValueTokens:r,menuProps:l,onClose:c,onChange:u,contextStore:p,formulaTypecheckContextValues:g,context:y,showClearButton:h,showInputMenuItem:f,type:x}=e,S=(0,i.Fy)(),v=(0,V.useIntl)(),b=(0,i.O7)(),[C,U]=(0,n.useState)(""),z=(0,a.qz)(void 0,_.Z),{collectionStore:$,property:q}=y,G=(0,M.M)($,q),Q=G(r,"first"),J=(0,a.VK)((()=>$.getSchema()[y.property]),[$,y.property]),X=(0,a.VK)((()=>!(!J||!(0,s.en)(J))&&1===J.limit),[J]),ee=(0,n.useMemo)((()=>{const e="relation"===(null==J?void 0:J.type)?(0,s.j0)(J):void 0;return g.filter((t=>(0,P.uy)(t.type,{type:"block",collection:e},!0)))}),[g,J]),te=(0,Z.useDependency)(Z.deps.searchActions),[ie]=(0,w.r5)((async()=>{const e=C?(0,T.ZP)(C,ee,(e=>e.kind===A.yp.ContextValue?e.name:"")):ee;if("resolved"!==te.status)return;const t=te.value,{results:o}=await t.searchPagesInCollection({environment:b,query:C,collectionId:x.collection.id,limit:20,spaceId:x.collection.spaceId,excludeTemplates:!0,source:"simple_formula_value_page_search",includePublicPagesWithoutExplicitAccess:!0,boostRecentlyViewedPages:!1});return{valueResults:e,pageResults:o}}),[b,C,ee,x,te.status,te.value],{debounce:K.vp}),ae=(0,n.useCallback)((()=>{U(""),z.setState({...z.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}),[z]),re=(0,n.useCallback)((e=>{const t=G(e,"last");u({type:"simple",value:(0,d.iC)(t)}),ae(),X&&c()}),[G,u,ae,X,c]),se=(0,a.VK)((()=>(0,F.NY)()),[]),le=I.oA(Q.map(((e,t)=>(0,k.jsx)(j,{token:e,contextStore:p,disabled:!1,currentSimpleFormulaValueTokens:Q,setCurrentTokens:re,context:y},t)))),ce=(0,k.jsx)(E.Z,{focus:!S.isMobile||void 0,focusAfterAnimation:!0,format:E.U.FilterValue,tokens:le,placeholder:v.formatMessage(H.s.pageSearchPlaceholder),onRemoveLastToken:()=>{re(Q.slice(0,Q.length-1))},onClearButtonClick:()=>{re([])},value:C,onChange:e=>{U(e.target.value)},dontShowBorderBottom:S.isAndroid,showClearButton:h}),ue=void 0!==(null==l?void 0:l.header)?l.header:(0,k.jsx)(N.Z,{style:{paddingBottom:0},title:v.formatMessage(H.s.genericMenuHeader)});let de;de=S.isMobile?{menuType:B.og.Modal,right:(0,k.jsx)(D.DoneMenuText,{}),onClickRight:c}:{menuType:B.og.Popup,maxHeight:"50vh",width:260,paddingTop:0,footer:se&&(0,k.jsx)(N.Z,{topBorder:!0,children:(0,k.jsx)(Y,{...e})}),disableHeaderBorder:!0};const pe={...de,...l,header:S.isMobile?null:ue},me=X?"single":"multi",ge=[],ye=[...I.oA(((null===(t=ie.value)||void 0===t?void 0:t.valueResults)||[]).map((e=>ne({currentSimpleFormulaValueTokens:Q,value:e,setCurrentTokens:re,contextStore:p,action:"append",context:y,checkType:me})))),...I.oA(((null===(o=ie.value)||void 0===o?void 0:o.pageResults)||[]).map((e=>{const t=Boolean(Q.find((t=>(0,d.S3)(t)&&(0,m.STW)(t)&&(0,m.TOT)(t)===e))),o=(0,m.$0A)(e,x.collection.spaceId),n=()=>{re(t?(0,d.Ck)(Q,o):[...Q,o])};return{key:e,render:e=>(0,k.jsx)(oe,{token:o,contextStore:p,args:e,checkState:t,checkType:me,context:y,onCheckboxClick:n}),action:n}})))];if(f){const e=Boolean(ue);ge.push({key:"search-input",render:t=>(0,k.jsx)(N.Z,{...t,style:{...e&&{paddingTop:0}}}),items:[{action:()=>{},key:"input",render:()=>ce}]})}if(ye.length>0){const e=Boolean(ue)||f;ge.push({key:"values",render:t=>(0,k.jsx)(N.Z,{topBorder:e,...t}),items:ye})}return(0,k.jsxs)(R.Z,{...pe,children:[ie.error&&(0,k.jsx)(N.Z,{children:(0,k.jsx)(L.Z,{title:(0,k.jsx)(V.FormattedMessage,{...H.s.somethingWentWrong})})}),0===ge.length&&ie.value&&(0,k.jsx)(N.Z,{children:(0,k.jsx)(L.Z,{title:(0,k.jsx)(V.FormattedMessage,{...H.s.noResults})})}),!ie.value&&!ie.error&&(0,k.jsx)(N.Z,{children:(0,k.jsx)(O.Z,{})}),ge.length>0&&(0,k.jsx)(W.Z,{type:W.i.Vertical,initialFocus:0,sections:ge,store:z})]})}function ae(e){const{context:t,contextStore:o,currentSimpleFormulaValueTokens:r,formulaTypecheckContextValues:s,menuProps:l,onChange:c,onClose:u}=e,p=(0,V.useIntl)(),m=(0,i.Fy)(),g=s.filter((e=>"checkbox"===e.type.type)),y=(0,n.useCallback)((e=>{c({type:"simple",value:void 0!==e[0]?(0,d.YD)(e[0]):void 0})}),[c]),h=(0,n.useCallback)((e=>{y(e),u()}),[y,u]),f=(0,a.VK)((()=>(0,F.NY)()),[]),x=I.oA(g.map((e=>ne({currentSimpleFormulaValueTokens:r,value:e,setCurrentTokens:h,contextStore:o,action:"replace",context:t,checkType:"single"})))),S=[],v=r.some((e=>!0===e)),b=[...x,...[{key:0,render:e=>(0,k.jsx)(q.Z,{title:(0,k.jsx)(V.FormattedMessage,{...H.s.unchecked}),checkState:!v,...e}),action:()=>{h([!1])}},{key:1,render:e=>(0,k.jsx)(q.Z,{title:(0,k.jsx)(V.FormattedMessage,{...H.s.checked}),checkState:v,...e}),action:()=>{h([!0])}}]],C=void 0!==(null==l?void 0:l.header)?l.header:(0,k.jsx)(N.Z,{style:{paddingBottom:0},title:p.formatMessage(H.s.genericMenuHeader)}),M=Boolean(C);let j;S.push({key:"checkbox",render:e=>(0,k.jsx)(N.Z,{...e,topBorder:M}),items:b}),j=m.isMobile?{menuType:B.og.Modal,right:(0,k.jsx)(D.DoneMenuText,{}),onClickRight:u}:{header:C,menuType:B.og.Popup,maxHeight:"50vh",width:260,footer:f&&(0,k.jsx)(N.Z,{topBorder:!0,children:(0,k.jsx)(Y,{...e})}),disableHeaderBorder:!0};const P={...j,...l,header:m.isMobile?null:C};return(0,k.jsx)(R.Z,{...P,children:(0,k.jsx)(W.Z,{type:W.i.Vertical,initialFocus:0,sections:S})})}var re=o(53016),se=o(40506),le=o(12392),ce=o(28020),ue=o(73063),de=o(89728);function pe(e){const{currentSimpleFormulaValueTokens:t,disabled:o,setInDatePicker:i,onClose:r,setCurrentTokens:s,context:l}=e,c=t[0],u=c&&(0,d.S3)(c)&&m.fpG(c)?m.zyO(c):void 0,p=(0,V.useIntl)(),g=(0,a.Kw)(ce.AK),y=(0,n.useCallback)((()=>{i(!1)}),[i]),h=(0,n.useCallback)((e=>{e&&(0,se.U3)(e)?s([m.pZr(e)]):s([])}),[s]),f=(0,z.yK)((e=>({header:{display:"flex",alignItems:"center",fontSize:12,paddingInline:14,color:e.mediumTextColor,marginTop:8,fontWeight:500},iconWrap:{width:18,height:18,marginRight:4},icon:{width:12,height:12},title:{flex:"1 1 auto"}})),[]),x=(0,a.VK)((()=>(0,M._)(l)),[l]);return(0,k.jsx)(Z.DependencyConsumer,{dependency:Z.deps.menus,children:e=>{let{DatePropertyMenu:t}=e;return(0,k.jsx)(t,{firstDayOfWeek:g,value:u,canConfigureCollection:!1,onChangeValue:h,dateFormat:x.dateFormat,timeFormat:x.timeFormat,onDismiss:r,disabled:o,shouldShowReminder:!1,header:(0,k.jsxs)("div",{style:f.header,children:[(0,k.jsx)(ue.Z,{ariaLabel:p.formatMessage(H.s.back),icon:le.S,onClick:y,style:f.iconWrap,iconStyle:f.icon}),(0,k.jsx)("span",{style:f.title,children:(0,k.jsx)(V.FormattedMessage,{...H.s.pickADate})}),(0,k.jsx)(de.Z,{onClick:r,isBlue:!0,children:(0,k.jsx)(D.DoneMenuText,{})})]}),isTemplatePage:!1})}})}function me(e){const{currentSimpleFormulaValueTokens:t,onClose:o,onChange:r,contextStore:s,formulaTypecheckContextValues:l,context:c,menuProps:u}=e,p=(0,V.useIntl)(),m=(0,i.Fy)(),[g,y]=(0,n.useState)(!1),h=l.filter((e=>"date"===e.type.type)),f=(0,n.useCallback)((e=>{r({type:"simple",value:void 0!==e[0]?(0,d.YD)(e[0]):void 0})}),[r]),x=(0,n.useCallback)((e=>{f(e),o()}),[f,o]),S=(0,n.useCallback)((()=>{y(!0)}),[]),v=(0,n.useCallback)((()=>{f([]),o()}),[f,o]),b=(0,a.VK)((()=>(0,F.NY)()),[]);if(g)return(0,k.jsx)(pe,{...e,setInDatePicker:y,setCurrentTokens:f,currentSimpleFormulaValueTokens:t});const C=void 0!==(null==u?void 0:u.header)?u.header:(0,k.jsx)(N.Z,{style:{paddingBottom:0},title:p.formatMessage(H.s.genericMenuHeader)}),M=I.oA(h.map((e=>ne({currentSimpleFormulaValueTokens:t,value:e,setCurrentTokens:x,contextStore:s,action:"replace",context:c,checkType:"single"})))),j=[];if(M.length>0){const e=Boolean(C);j.push({key:"values",render:t=>(0,k.jsx)(N.Z,{topBorder:e,...t}),items:M})}const P=(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(N.Z,{topBorder:!0,children:[(0,k.jsx)(G,{icon:re.V,title:(0,k.jsx)(V.FormattedMessage,{...H.s.pickADate}),onClick:S}),b&&(0,k.jsx)(Y,{...e})]}),t.length>0&&(0,k.jsx)(N.Z,{topBorder:!0,children:(0,k.jsx)(q.Z,{title:(0,k.jsx)(V.FormattedMessage,{...H.s.clear}),focused:!1,onClick:v})})]});let A;A=m.isMobile?{menuType:B.og.Modal,right:(0,k.jsx)(D.DoneMenuText,{}),onClickRight:o,footer:P}:{menuType:B.og.Popup,maxHeight:"50vh",width:260,footer:P,disableHeaderBorder:!0};const T={...A,...u,header:m.isMobile?null:C};return(0,k.jsx)(R.Z,{...T,children:(0,k.jsx)(W.Z,{type:W.i.Vertical,initialFocus:0,sections:j})})}var ge=o(68894);function ye(e){const{context:t,contextStore:o,currentSimpleFormulaValueTokens:r,formulaTypecheckContextValues:s,menuProps:l,onChange:c,onClose:u,value:p}=e,g=(0,V.useIntl)(),y=(0,i.Fy)(),h=s.filter((e=>"number"===e.type.type)),f=(0,n.useCallback)((e=>{c({type:"simple",value:e})}),[c]),x=(0,n.useCallback)((e=>{f(e),u()}),[f,u]),S=(0,n.useCallback)((e=>{const t=e.target.value;let o;o=""===t?void 0:[[t]],f(o)}),[f]),v=(0,n.useCallback)((e=>{const t=I.U2(e,"event.target.value");let o;o="string"==typeof t&&""!==t?[[t]]:void 0,x(o)}),[x]),b=(0,n.useCallback)((e=>{const t=void 0!==e[0]?(0,d.YD)(e[0]):void 0;x(t)}),[x]),C=(0,a.VK)((()=>(0,F.NY)()),[]),M=I.oA(h.map((e=>ne({currentSimpleFormulaValueTokens:r,value:e,setCurrentTokens:b,contextStore:o,action:"replace",context:t,checkType:"single"})))),j=[],P=[{action:v,key:"input",render:e=>{const t=r[0],o="string"==typeof t?t:(0,m.QaF)(null==p?void 0:p.value);return(0,k.jsx)(ge.ZP,{...e,focus:!0,onChange:S,onClick:void 0,value:o})}}],A=[...P,...M],T=void 0!==(null==l?void 0:l.header)?l.header:(0,k.jsx)(N.Z,{style:{paddingBottom:0},title:g.formatMessage(H.s.genericMenuHeader)});let w;j.push({key:"textbox",render:e=>(0,k.jsx)(N.Z,{...e}),items:A}),w=y.isMobile?{menuType:B.og.Modal,right:(0,k.jsx)(D.DoneMenuText,{}),onClickRight:u}:{menuType:B.og.Popup,maxHeight:"50vh",width:260,footer:C&&(0,k.jsx)(N.Z,{topBorder:!0,children:(0,k.jsx)(Y,{...e})}),disableHeaderBorder:!0};const Z={...w,...l,header:y.isMobile?null:T};return(0,k.jsx)(R.Z,{...Z,children:(0,k.jsx)(W.Z,{initialFocus:0,sections:j,type:W.i.Vertical})})}var he=o(1302);function fe(e){var t,o;const{context:r,contextStore:l,currentSimpleFormulaValueTokens:c,formulaTypecheckContextValues:u,menuProps:p,onChange:g,onClose:y,showClearButton:h,showInputMenuItem:f,limit:x}=e,S=(0,i.Fy)(),v=(0,V.useIntl)(),b=(0,i.O7)(),{collectionStore:C,property:U}=r,[z,$]=(0,n.useState)(""),q=(0,a.qz)(void 0,_.Z),G=(0,M.M)(C,U),Q=G(c,"first"),J=(0,a.VK)((()=>{const e=C.getSchema()[r.property];return!(!e||!(0,s.en)(e))&&1===e.limit}),[C,r]),X=u.filter((e=>(0,P.uy)(e.type,{type:"person"}))),[ee]=(0,w.r5)((async()=>{const e=z?(0,T.ZP)(z,X,(e=>e.kind===A.yp.ContextValue?e.name:"")):X,t=await Z.deps.searchActions.loader();return{valueResults:e,userResults:(await t.searchVisibleSpaceUsers({environment:b,query:z,membersOnly:!1})).map((e=>e.id)).slice(0,20)}}),[b,z,X],{debounce:K.vp}),te=(0,n.useCallback)((()=>{$(""),q.setState({...q.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}),[q]),ie=(0,n.useCallback)((e=>{const t=G(e,"last");g({type:"simple",value:(0,d.iC)(t)}),te()}),[g,te,G]),ae=(0,a.VK)((()=>(0,F.NY)()),[]),re=I.oA(Q.map(((e,t)=>(0,k.jsx)(j,{token:e,contextStore:l,disabled:!1,currentSimpleFormulaValueTokens:Q,setCurrentTokens:ie,context:r},t)))),se=new Set(I.oA(Q.map((e=>(0,d.S3)(e)&&(0,m.wjk)(e)&&(0,m.vmO)(e).id)))),le=new Set(I.oA(Q.map((e=>(0,d.S3)(e)&&(0,m.IWo)(e)&&(0,m.zEN)(e))))),ce=(0,k.jsx)(E.Z,{focus:!S.isMobile||void 0,focusAfterAnimation:!0,format:E.U.FilterValue,tokens:re,placeholder:v.formatMessage(H.s.personSearchPlaceholder),onRemoveLastToken:()=>{ie(Q.slice(0,Q.length-1))},onClearButtonClick:()=>{ie([])},value:z,onChange:e=>{$(e.target.value)},dontShowBorderBottom:S.isAndroid,showClearButton:h}),ue=void 0!==(null==p?void 0:p.header)?p.header:(0,k.jsx)(N.Z,{style:{paddingBottom:0},title:v.formatMessage(H.s.genericMenuHeader)});let de;de=S.isMobile?{menuType:B.og.Modal,right:(0,k.jsx)(D.DoneMenuText,{}),onClickRight:y}:{menuType:B.og.Popup,maxHeight:"50vh",width:260,footer:ae&&(0,k.jsx)(N.Z,{topBorder:!0,children:(0,k.jsx)(Y,{...e})}),disableHeaderBorder:!0};const pe={...de,...p,header:S.isMobile?null:ue},me=Boolean(x&&Q.length>=x),ge=[...I.oA(((null===(t=ee.value)||void 0===t?void 0:t.valueResults)||[]).map((e=>{if(!(e.kind===A.yp.ContextValue&&se.has(e.id)))return ne({currentSimpleFormulaValueTokens:Q,value:e,setCurrentTokens:ie,contextStore:l,action:"append",context:r,checkType:"none",onCheckboxClick:()=>{J&&he.default.afterNextFlush((()=>{y()}))},isDisabled:me})}))),...I.oA(((null===(o=ee.value)||void 0===o?void 0:o.userResults)||[]).map((e=>{if(le.has(e))return;const t=(0,m.tEo)(e),o=()=>{ie([...Q,t]),J&&he.default.afterNextFlush((()=>{y()}))};return{key:e,render:e=>(0,k.jsx)(oe,{disabled:me,token:t,contextStore:l,args:e,checkState:!1,checkType:"none",context:r,onCheckboxClick:o}),action:o}})))],ye=[];if(f){const e=Boolean(ue);ye.push({key:"search-input",render:t=>(0,k.jsx)(N.Z,{...t,style:{...e&&{paddingTop:0}}}),items:[{action:()=>{},key:"input",render:()=>ce}]})}if(ge.length>0){const e=Boolean(ue)||f;ye.push({key:"users",render:t=>(0,k.jsx)(N.Z,{topBorder:e,...t}),items:ge})}return(0,k.jsxs)(R.Z,{...pe,children:[ee.error&&(0,k.jsx)(N.Z,{children:(0,k.jsx)(L.Z,{title:(0,k.jsx)(V.FormattedMessage,{...H.s.somethingWentWrong})})}),0===ye.length&&ee.value&&(0,k.jsx)(N.Z,{children:(0,k.jsx)(L.Z,{title:(0,k.jsx)(V.FormattedMessage,{...H.s.noResults})})}),!ee.value&&!ee.error&&(0,k.jsx)(N.Z,{children:(0,k.jsx)(O.Z,{})}),ye.length>0&&(0,k.jsx)(W.Z,{type:W.i.Vertical,initialFocus:0,sections:ye,store:q})]})}function xe(e){const{context:t,contextStore:o,currentSimpleFormulaValueTokens:r,formulaTypecheckContextValues:l,isSingle:c,menuProps:u,onChange:p,onClose:m,showClearButton:g,showInputMenuItem:h,type:f}=e,x=(0,i.Fy)(),S=(0,V.useIntl)(),[v,b]=(0,n.useState)(""),C=(0,a.qz)(void 0,_.Z),M=J.NW.createChildStore(o.context.parentRecordStore,f.collection),w=(0,a.VK)((()=>M.getSchema()[f.property]),[M,f]),Z=(0,a.VK)((()=>w&&(0,s.gB)(w)?w.groups??[]:[]),[w]),K=(0,a.VK)((()=>w&&(0,s.t)(w)&&w.options||[]),[w]),O=l.filter((e=>(0,P.uy)(e.type,{type:"select",collection:f.collection,property:f.property}))),U=(0,a.VK)((()=>({valueResults:v?(0,T.ZP)(v,O,(e=>e.kind===A.yp.ContextValue?e.name:"")):O,selectResults:v?(0,T.ZP)(v,K,(e=>e.value)):K})),[v,O,K]),z=(0,n.useCallback)((()=>{b(""),C.setState({...C.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}),[C]),$=(0,n.useCallback)((e=>{p({type:"simple",value:c?(0,d.YD)(e[0]):(0,d.iC)(e)}),z()}),[p,z,c]),q=(0,a.VK)((()=>(0,F.NY)()),[]),G=I.oA(r.map(((e,n)=>(0,k.jsx)(j,{token:e,contextStore:o,disabled:!1,currentSimpleFormulaValueTokens:r,setCurrentTokens:$,context:t},n)))),Q=void 0!==(null==u?void 0:u.header)?u.header:(0,k.jsx)(N.Z,{style:{paddingBottom:0},title:S.formatMessage(H.s.genericMenuHeader)}),X=(0,k.jsx)(E.Z,{focus:!x.isMobile||void 0,focusAfterAnimation:!0,format:E.U.FilterValue,tokens:G,placeholder:S.formatMessage(H.s.searchPlaceHolder),onRemoveLastToken:()=>{$(r.slice(0,r.length-1))},onClearButtonClick:()=>{$([])},value:v,onChange:e=>{b(e.target.value)},dontShowBorderBottom:x.isAndroid,showClearButton:g}),ee=[];if(h){const e=Boolean(Q);ee.push({key:"search-input",render:t=>(0,k.jsx)(N.Z,{...t,style:{...e&&{paddingTop:0}}}),items:[{action:()=>{},key:"input",render:()=>X}]})}const te=Boolean(w&&(0,s.gB)(w)),ie={automationContextValues:U.valueResults??[],onClose:m,context:t,contextStore:o,currentSimpleFormulaValueTokens:r,isSingle:c,groupOptions:Z,selectOptions:U.selectResults??[],setCurrentTokens:$},ae=te?function(e){const{automationContextValues:t,onClose:o,context:n,contextStore:i,currentSimpleFormulaValueTokens:a,isSingle:r,groupOptions:s,selectOptions:l,setCurrentTokens:c}=e,u=[],p=r?"single":"multi",m=I.oA(t.map((e=>ne({currentSimpleFormulaValueTokens:a,value:e,setCurrentTokens:c,contextStore:i,action:r?"replace":"append",context:n,checkType:p,onCheckboxClick:()=>{r&&he.default.afterNextFlush((()=>{o()}))}}))));m.length>0&&u.push({key:"automation-variables",render:e=>(0,k.jsx)(N.Z,{title:(0,k.jsx)(V.FormattedMessage,{...H.s.valuesFromThisAutomation}),topBorder:!0,...e}),items:m});const g=new Map(l.map((e=>[e.id,e]))),h=s.map((e=>{const t=(e.optionIds??[]).map((e=>g.get(e))).filter(y.$K).map((e=>{const t=Boolean(a.find((t=>"string"==typeof t&&t===e.value))),s=()=>{c(r?t?[]:[e.value]:t?(0,d.Ck)(a,e.value):[...a,e.value]),r&&he.default.afterNextFlush((()=>{o()}))},l={key:e.id,render:o=>(0,k.jsx)(oe,{token:e.value,contextStore:i,args:o,checkState:t,checkType:p,context:n,onCheckboxClick:s}),action:s};return l})),s={key:e.id,items:t,render:t=>(0,k.jsx)(N.Z,{title:e.name,topBorder:!0,...t})};return s})).filter((e=>e.items.length>0));return u.push(...h),u}(ie):function(e){const{automationContextValues:t,onClose:o,context:n,contextStore:i,currentSimpleFormulaValueTokens:a,isSingle:r,selectOptions:s,setCurrentTokens:l}=e,c=[],u=r?"single":"multi",p=I.oA(t.map((e=>ne({currentSimpleFormulaValueTokens:a,value:e,setCurrentTokens:l,contextStore:i,action:r?"replace":"append",context:n,checkType:u,onCheckboxClick:()=>{r&&he.default.afterNextFlush((()=>{o()}))}})))),m=I.oA(s.map((e=>{const t=Boolean(a.find((t=>"string"==typeof t&&t===e.value))),s=()=>{l(r?t?[]:[e.value]:t?(0,d.Ck)(a,e.value):[...a,e.value]),r&&he.default.afterNextFlush((()=>{o()}))},c={key:e.id,render:o=>(0,k.jsx)(oe,{token:e.value,contextStore:i,args:o,checkState:t,checkType:u,context:n,onCheckboxClick:s}),action:s};return c}))),g=[...p,...m];g.length>0&&c.push({key:"options",render:e=>(0,k.jsx)(N.Z,{topBorder:!0,...e}),items:g});return c}(ie);let re;ee.push(...ae),re=x.isMobile?{menuType:B.og.Modal,right:(0,k.jsx)(D.DoneMenuText,{}),onClickRight:m}:{menuType:B.og.Popup,maxHeight:"50vh",width:260,paddingTop:0,footer:q&&(0,k.jsx)(N.Z,{topBorder:!0,children:(0,k.jsx)(Y,{...e})}),disableHeaderBorder:!0};const se={...re,...u,header:x.isMobile?null:Q};return(0,k.jsxs)(R.Z,{...se,children:[0===ee.length&&(0,k.jsx)(N.Z,{children:(0,k.jsx)(L.Z,{title:(0,k.jsx)(V.FormattedMessage,{...H.s.noResults})})}),ee.length>0&&(0,k.jsx)(W.Z,{type:W.i.Vertical,initialFocus:0,sections:ee,store:C})]})}var Se=o(65187),ve=o(43250),be=o(28992);function Ce(e){const{context:t,contextStore:o,currentSimpleFormulaValueTokens:r,formulaTypecheckContextValues:s,menuProps:l,onChange:c,onClose:u,value:p,disableEmojiCommands:m,disableFormattingAndMentions:g,disableMobileActionBar:y,disableTemplateVariableMentions:h}=e,f=(0,V.useIntl)(),{isMobile:x}=(0,i.Fy)(),S=(0,z.yK)((e=>({wrap:{background:e.inputBackground,borderRadius:4,boxShadow:e.inputBoxShadow,lineHeight:"24px",padding:1,marginBlock:x?12:0},text:{maxHeight:120,overflow:"auto",padding:"4px 10px"}})),[x]),v=(0,a.VK)((()=>(0,F.NY)()),[]),b=(0,n.useMemo)((()=>s.filter((e=>"text"===e.type.type))),[s]),C=(0,n.useCallback)((e=>{c({type:"simple",value:e})}),[c]),M=(0,n.useCallback)((e=>{C(e),u()}),[C,u]),j=(0,n.useCallback)((e=>{const t=void 0!==e[0]?(0,d.YD)(e[0]):void 0;M(t)}),[M]),{store:P}=(0,F.Cl)({initialValue:null==p?void 0:p.value,onChange:C}),A=I.oA(b.map((e=>ne({currentSimpleFormulaValueTokens:r,value:e,setCurrentTokens:j,contextStore:o,action:"replace",context:t,checkType:"single"})))),T=[],w=[{action:I.ZT,key:"input",render:e=>(0,k.jsx)(be.Z,{...e,title:(0,k.jsx)("div",{className:ve.Wh_,style:S.wrap,children:(0,k.jsx)(Se.Z,{disableComment:!0,disabled:!1,disableEmbedMenu:!0,disableEmojiCommands:m,disableMobileActionBar:y,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableSlashCommands:!0,disableTemplateVariableMentions:h,...g?{disableDateMentions:!0,disableDateReminderMentions:!0,disableMentions:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0}:{},onEnter:u,pasteBehavior:"inline",store:P,style:S.text,inPageFind:{type:"none"}})})})}],Z=[...A,...w],K=void 0!==(null==l?void 0:l.header)?l.header:(0,k.jsx)(N.Z,{style:{paddingBottom:0},title:f.formatMessage(H.s.genericMenuHeader)});let _;T.push({key:"textbox",render:e=>(0,k.jsx)(N.Z,{...e}),items:Z}),_=x?{menuType:B.og.Modal,right:(0,k.jsx)(D.DoneMenuText,{}),onClickRight:u}:{menuType:B.og.Popup,maxHeight:"50vh",width:260,footer:v&&(0,k.jsx)(N.Z,{topBorder:!0,children:(0,k.jsx)(Y,{...e})}),disableHeaderBorder:!0};const L={..._,...l,header:x?null:K};return(0,k.jsx)(R.Z,{...L,children:(0,k.jsx)(W.Z,{initialFocus:0,sections:T,type:W.i.Vertical})})}function Me(e){const{showClearButton:t,showInputMenuItem:o,type:n}=e;return"text"===n.type?(0,k.jsx)(Ce,{...e,type:n}):"number"===n.type?(0,k.jsx)(ye,{...e,type:n}):"checkbox"===n.type?(0,k.jsx)(ae,{...e,type:n}):"date"===n.type?(0,k.jsx)(me,{...e,type:n}):"person_array"===n.type?(0,k.jsx)(fe,{...e,showClearButton:t??!0,showInputMenuItem:o??!0,type:n}):"block_array"===n.type?(0,k.jsx)(ie,{...e,showClearButton:t??!0,showInputMenuItem:o??!0,type:n}):"select"===n.type?(0,k.jsx)(xe,{...e,showClearButton:t??!0,showInputMenuItem:o??!0,type:n,isSingle:!0}):"select_array"===n.type?(0,k.jsx)(xe,{...e,showClearButton:t??!0,showInputMenuItem:o??!0,type:n,isSingle:!1}):void(0,y.t1)(n)}},75311:(e,t,o)=>{o.d(t,{M:()=>l,_:()=>c});var n=o(67294),i=o(86628),a=o(99036),r=o(40506),s=o(1898);function l(e,t){const o=(0,i.VK)((()=>{const o=e.getSchema()[t];let n;return o&&(0,a.en)(o)&&(n=o.limit),n}),[e,t]);return(0,n.useCallback)(((e,t)=>(0,s.$K)(o)?"first"===t?e.slice(0,o):"last"===t?e.slice(-o):void(0,s.t1)(t):e),[o])}function c(e){var t;const o=null===(t=e.collectionStore.getSchema())||void 0===t?void 0:t[e.property];return o&&"date"===o.type?{dateFormat:o.date_format||r.sF,timeFormat:o.time_format||r.c_}:{dateFormat:r.sF,timeFormat:r.c_}}},30387:(e,t,o)=>{o.d(t,{s:()=>n});const n=(0,o(9291).defineMessages)({back:{defaultMessage:"Back",id:"formulas.SimpleFormulaValuePicker.back"},valuesFromThisAutomation:{defaultMessage:"From this automation",id:"formulas.SimpleFormulaValuePicker.valuesFromThisAutomation"},pickADate:{defaultMessage:"Pick a date",id:"formulas.SimpleFormulaValuePicker.pickADate"},clear:{defaultMessage:"Clear",id:"formulas.SimpleFormulaValuePicker.clear"},unchecked:{defaultMessage:"Unchecked",id:"formulas.SimpleFormulaValuePicker.checkbox.unchecked"},checked:{defaultMessage:"Checked",id:"formulas.SimpleFormulaValuePicker.checkbox.checked"},checkboxOptions:{defaultMessage:"Checkbox options",id:"formulas.SimpleFormulaValuePicker.checkbox.sectionHeader"},searchPlaceHolder:{defaultMessage:"Select one or more options…",id:"formulas.SimpleFormulaValuePicker.select.searchPlaceholder"},selectOptionsSectionHeader:{defaultMessage:"Select an option",id:"formulas.SimpleFormulaValuePicker.select.sectionHeader"},noResults:{defaultMessage:"No results",id:"formulas.simpleValuePicker.noResults"},pageSearchPlaceholder:{defaultMessage:"Search for one or more pages…",id:"formulas.SimpleFormulaValuePicker.pages.searchPlaceholder"},pages:{defaultMessage:"Pages",id:"formulas.SimpleFormulaValuePicker.pages.sectionHeader"},somethingWentWrong:{defaultMessage:"Something went wrong.",id:"formulas.simpleValuePicker.errorMessage"},personSelect:{defaultMessage:"Select...",id:"formulas.SimpleFormulaValuePicker.chooseAValue"},personSearchPlaceholder:{defaultMessage:"Search for one or more people…",id:"formulas.SimpleFormulaValuePicker.people.searchPlaceholder"},customFormula:{defaultMessage:"Custom formula",id:"formulas.SimpleFormulaValuePicker.customFormula"},peopleInWorkspace:{defaultMessage:"People",id:"formulas.SimpleFormulaValuePicker.people.sectionHeader"},genericMenuHeader:{defaultMessage:"Set property to",id:"formulas.SimpleFormulaValuePicker.genericMenuHeader"}})},86538:(e,t,o)=>{o.d(t,{ZP:()=>F,uV:()=>_});o(57658);var n=o(67294),i=o(480),a=o(86628),r=o(24405),s=o(41892),l=o(77657),c=o(82114),u=o(36591),d=o(90199),p=o(35840),m=o(55159),g=o(9291),y=o(53965),h=o(40470),f=o(1898),x=o(54642),S=o(89475),v=o(12457),b=o(33929),C=o(18441),M=o(80444),k=o(30874),j=o(68016),P=o(52275),A=o(68894),T=o(68785),w=o(72495),V=o(85893);const I=(0,g.defineMessages)({channelSearchPlaceholder:{id:"notificationRuleSettings.selectChannelView.searchInput.placeholder",defaultMessage:"Search…"}});function F(e){const{currentNotificationChannel:t,onNotificationChannelSelect:o,onClose:c,onNewSlackAccountAdded:d,renderMenu:m,channelFilter:x}=e,F=(0,i.O7)(),{isMobile:K}=(0,i.Fy)(),R=(0,a.VK)((()=>k.Z.completeSlackAuthentications.state),[]),W=e.currentExternalAuthentication??y.Ps(R);n.useEffect((()=>{W&&_({environment:F,botId:W.id,spaceId:W.space_id})}),[F,W]);const[L,D]=n.useState(""),{loadedChannelsForAccount:N,isLoading:O}=(0,a.VK)((()=>{if(!W)return{loadedChannelsForAccount:[],isLoading:!1};const e=j.Z.getStateForBot(W.id);return{loadedChannelsForAccount:Object.values(e.channels),isLoading:e.fetching}}),[W]),E=(0,a.VK)((()=>k.Z.integrations.state.find((e=>e.id===l.nO))),[]),H=(0,a.VK)((()=>{var e;return null===(e=M.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),U=n.useCallback((e=>{W&&o(e,W),c()}),[o,W,c]),z=(0,r.yK)((e=>({icon:{marginLeft:8,width:12,height:12,color:e.lightTextColor},container:{backgroundColor:e.popoverBackground,marginTop:12,marginBottom:6},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,color:e.regularIconColor}})),[]),$=n.useCallback((e=>{const{channel:o}=e;return{key:o.id,render:e=>(0,V.jsx)(P.Z,{...e,icon:Z({channel:o,styles:z.icon}),desktopIconStyle:{width:8},title:o.name,right:o.id===(null==t?void 0:t.id)&&(0,u.e)(z.icon)}),action:()=>{U(o)}}}),[U,z.icon,t]),{publicChannels:q,privateChannels:G,personalChannels:Y}=n.useMemo((()=>function(e,t){const o=[],n=[],i=[];for(const a of e)t&&!t(a)||("public"===a.type?o.push(a):"private"===a.type?n.push(a):"me"===a.type?i.push(a):(0,f.t1)(a.type));return{publicChannels:o,privateChannels:n,personalChannels:i}}(N,x)),[x,N]),Q=n.useCallback((()=>q.map((e=>({menuListItem:$({channel:e}),channelName:e.name})))),[q,$]),J=n.useCallback((()=>G.map((e=>({menuListItem:$({channel:e}),channelName:e.name})))),[G,$]),X=n.useCallback((()=>Y.map((e=>({menuListItem:$({channel:e}),channelName:e.name})))),[Y,$]),ee=n.useCallback((()=>Q().map((e=>{let{menuListItem:t,channelName:o}=e;if(B({channelName:o,query:L}))return t})).filter(f.$K)),[Q,L]),te=n.useCallback((()=>J().map((e=>{let{menuListItem:t,channelName:o}=e;if(B({channelName:o,query:L}))return t})).filter(f.$K)),[J,L]),oe=n.useCallback((()=>X().map((e=>{let{menuListItem:t,channelName:o}=e;if(B({channelName:o,query:L}))return t})).filter(f.$K)),[X,L]),ne=n.useCallback((()=>{if(!W)return[];const e=[],t=ee(),o=te(),n=oe();return n.length>0&&e.push({key:"personal-channels",render:e=>(0,V.jsx)(w.Z,{...e,title:(0,C.jg)(W).organizationName}),items:n}),t.length>0&&e.push({key:"public-channels",render:e=>(0,V.jsx)(w.Z,{...e,topBorder:n.length>0,title:0===n.length&&(0,C.jg)(W).organizationName}),items:t}),o.length>0&&e.push({key:"private-channels",render:e=>(0,V.jsx)(w.Z,{...e,topBorder:t.length>0,title:0===n.length&&t.length>0&&(0,C.jg)(W).organizationName}),items:o}),e}),[ee,te,oe,W]);if(!W||!E)return null;const ie=[{key:"search-input-section",items:[{key:"search-input-item",action:()=>{},render:e=>(0,V.jsx)("div",{children:(0,V.jsx)(A.ZP,{...e,inputLeft:(0,V.jsx)(A.f_,{icon:p.R}),inputRight:(0,V.jsx)(v.Z,{show:O,showDelay:500,showHold:300,render:e=>e&&(0,V.jsx)(T.Z,{style:{marginRight:2}})}),showClearButton:!0,placeholder:b.default.formatMessage(I.channelSearchPlaceholder),focusInitial:!K,value:L,onChange:e=>{D(e.target.value)}})})}],render:e=>(0,V.jsx)(w.Z,{...e})},...ne()];return t||ie.push({key:"add-another-slack-account-section",items:[{key:"add-another-slack-account-item",action:async()=>{if(!H)return;const e=await S.hM({environment:F,integration:E,spaceId:H,from:"collection_view_settings"});h.x.isFail(e)||d()},render:e=>(0,V.jsx)(P.Z,{...e,icon:(0,V.jsx)("img",{src:s.Z.images.externalIntegrations.slackIconPng,style:{width:18,height:"auto"}}),title:(0,V.jsx)(g.FormattedMessage,{id:"notificationRuleSettings.selectChannelView.setupAnotherSlackAccount.label",defaultMessage:"Add another Slack account"})})}],render:e=>(0,V.jsx)(w.Z,{...e,topBorder:!0})}),(0,V.jsx)(V.Fragment,{children:m(ie)})}function B(e){const{channelName:t,query:o}=e;return 0===o.length||t.toLocaleLowerCase().indexOf(o.trim().toLocaleLowerCase())>=0}function Z(e){const{channel:t,styles:o}=e;return"private"===t.type?(0,d.b)(o):"me"===t.type?(0,c.p)(o):(0,m.J)(o)}const K=15e3;async function _(e){const{environment:t,botId:o,spaceId:n}=e,i=j.Z.getStateForBot(o);if(i.fetching||Date.now()-i.lastRefreshed<K)return;let a;for(j.Z.updateStateForBot(o,{fetching:!0,lastRefreshed:Date.now()});;){const e=await x.getExternalNotificationChannels(t,{botId:o,spaceId:n,cursor:a});if("success"!==e.type){console.error(e.error);break}{const t={};for(const o of e.data.channels)t[o.id]=o;if(j.Z.addChannelsForBot(o,t),a=e.data.cursor,!a)break}}j.Z.updateStateForBot(o,{fetching:!1})}},58812:(e,t,o)=>{o.d(t,{$K:()=>b,SC:()=>S,aO:()=>f,hL:()=>M,hY:()=>x,j3:()=>v});o(57658);var n=o(2647),i=o(98963),a=o(9291),r=o(7032),s=o(1898),l=o(47307),c=o(9953),u=o(13447),d=o(43627),p=o(97978),m=o(54802),g=o(33929),y=o(6258);const h=(0,a.defineMessages)({automationDeleteConfirmationMessage:{id:"slackAutomations.remove.confirmation.message",defaultMessage:"Are you sure you want to delete {automationName}?"},automationDeleteAcceptLabel:{id:"slackAutomations.remove.confirmation.acceptLabel",defaultMessage:"Delete"},confirmDiscardChangesMessage:{id:"automations.confirmDiscardChanges.message",defaultMessage:"{hasName, select, true {Are you sure you want to discard {automationName}?} other {Are you sure you want to discard this automation?}}"},confirmDiscardChangesAccept:{defaultMessage:"Discard",id:"automations.confirmDiscardChanges.acceptLabel"}});function f(e){const{automationStore:t,collectionStore:o,environment:a,intl:l}=e;u.createAndCommit({environment:a,userAction:"collectionSettingsAutomationsActions.createDatabaseAutomation",perform:e=>{u.applyOperation({store:o,operation:{pointer:o.pointer,path:["format","automation_ids"],command:"listAfter",args:{id:t.id}},transaction:e});const n=y.Mz.createChildStore(o,t.pointer),s=t.getActionStores();for(const t of s){const o=t.getType();o&&d.addAutomationAction({actionId:t.id,actionType:o,automationStore:n,config:t.getConfig(),environment:a,intl:l,transaction:e})}const p=C(s);c.ae({environment:a,inMemoryRecordCache:o.inMemoryRecordCache,table:i.cv,transaction:e,value:{action_ids:t.getActionIds(),alive:!0,id:t.id,parent_id:o.id,parent_table:o.table,properties:{name:t.getName()},space_id:o.getSpaceId(),status:"active",trigger:{id:(0,r.ZP)(),event:t.getEventConfiguration()??{pagesAdded:!1,pagePropertiesEdited:{type:"none"},source:{pointer:o.getSpaceShardedPointer(),type:"collection"}},type:p}}})}});const m=t.getModel();if((0,s.$K)(m)){const e=(0,p.mc)(a),o=n.TY({automationModel:m,getRecordModel:t.getRecordModel});n.T0(e,o)}}function x(e){const{automationStore:t,collectionStore:o,environment:i}=e;u.createAndCommit({environment:i,userAction:"collectionSettingsAutomationsActions.saveDatabaseAutomation",perform:e=>{const n=y.Mz.createChildStore(o,t.pointer),i=t.getName(),a=n.getKeyStore("properties");c.sW({store:a,data:{name:i},transaction:e});const r=t.getActionStores(),s=C(r),l=n.getTriggerStore();if(c.sW({store:l,data:{type:s},transaction:e}),(0,m.Xd)(n)&&(0,m.Xd)(t)){const o=n.getTriggerStore().getKeyStore("event");c.sW({store:o,data:t.getTriggerStore().getKeyStore("event").getValue(),transaction:e})}const u=[];for(const t of r){const o=t.getModel();if(!o)continue;const i=y.zq.createChildStore(n,t.pointer);c.sO({store:i,value:{alive:!0,config:o.getConfig(),id:o.id,parent_id:n.id,parent_table:n.table,space_id:n.getSpaceId(),type:o.type},transaction:e}),u.push(t.id)}c.sW({store:n,data:{action_ids:u},transaction:e})}});const a=t.getModel();if((0,s.$K)(a)){const e=(0,p.mc)(i),o=n.TY({automationModel:a,getRecordModel:t.getRecordModel});n.r4(e,o)}}async function S(e){const{intl:t,environment:o,collectionStore:n,existingAutomationStore:i,onDelete:a}=e,r=i.getNameWithDefault(t);(await l.confirmUserActionV2({message:t.formatMessage(h.automationDeleteConfirmationMessage,{automationName:r}),acceptLabel:t.formatMessage(h.automationDeleteAcceptLabel)})).accept&&(!function(e){const{environment:t,collectionStore:o,existingAutomationStore:n}=e;u.createAndCommit({environment:t,userAction:"collectionSettingsAutomationsActions.deleteAutomation",perform:e=>{const i=o.getFormatStore().getKeyStore("automation_ids"),a=y.Mz.createChildStore(o,n.pointer);u.applyOperation({store:i,operation:{pointer:i.pointer,path:i.path,command:"listRemove",args:{id:a.id}},transaction:e}),d.deleteAutomation({automationStore:a,environment:t,transaction:e})}})}({environment:o,collectionStore:n,existingAutomationStore:i}),null==a||a())}function v(e){const{automationStore:t,collectionStore:o,environment:n}=e;u.createAndCommit({environment:n,userAction:"collectionSettingsAutomationsActions.disableAutomation",perform:e=>{const i=y.Mz.createChildStore(o,t.pointer);d.disableAutomation({automationStore:i,environment:n,transaction:e})}})}function b(e){const{automationStore:t,collectionStore:o,environment:n}=e;u.createAndCommit({environment:n,userAction:"collectionSettingsAutomationsActions.enableAutomation",perform:e=>{const i=y.Mz.createChildStore(o,t.pointer);d.enableAutomation({automationStore:i,environment:n,transaction:e})}})}function C(e){return 1===e.length&&e[0].isType("slack_notification")?"notification_event":"event"}async function M(e){const{automationName:t,hasPendingChanges:o}=e;if(!o)return!0;return(await l.confirmUserActionV2({acceptLabel:g.default.formatMessage(h.confirmDiscardChangesAccept),message:g.default.formatMessage(h.confirmDiscardChangesMessage,{automationName:t,hasName:Boolean(t)})})).accept}},20776:(e,t,o)=>{o.d(t,{o:()=>s});o(67294);var n=o(24405),i=o(31701),a=o(37810),r=o(85893);function s(e){const{children:t,icon:o,shouldTruncateChildren:s}=e,l=(0,n.yK)((e=>{const t=(0,i.KR)(e,void 0);return{iconWrap:{flex:"0 0 auto"},textWrap:{...s?a.Z.textOverflowStyle:{},flex:"1 1 auto"},wrap:{backgroundColor:t.backgroundColor,borderRadius:12,color:t.textColor,display:"inline-flex",gap:4,minWidth:s?50:void 0,padding:"0 8px"}}}),[s]);return(0,r.jsxs)("span",{style:l.wrap,children:[o&&(0,r.jsx)("span",{"aria-hidden":"true",style:l.iconWrap,children:o}),(0,r.jsx)("span",{style:l.textWrap,children:t})]})}},32130:(e,t,o)=>{o.d(t,{oC:()=>Be,ZD:()=>Ze,sY:()=>Ie});o(57658);var n=o(67294),i=o(480),a=o(86628),r=o(24405),s=o(53196),l=o(37612),c=o(98963),u=o(6287),d=o(13493),p=o(9291),m=o(7032),g=o(1898),y=o(37810),h=o(5149),f=o(64964),x=o(13447),S=o(93174),v=o(76205),b=o(36591),C=o(54497),M=o(53965),k=o(94166),j=o(20616),P=o(68155),A=o(10906),T=o(73657),w=o(52275),V=o(31945),I=o(68894),F=o(78140),B=o(32163),Z=o(40721),K=o(31278),_=o(72495),R=o(26388),W=o(65183),L=o(54802),D=o(60709),N=o(37034),O=o(61766),E=o(6258),H=o(35294),U=o(85893);function z(e){const{selectedSourcePointer:t,collectionContextStore:o,onSelect:s,disabled:l}=e,{isMobile:c}=(0,i.Fy)(),u=(0,p.useIntl)(),d=(0,i.O7)(),[m,y]=n.useState(""),h=(0,a.VK)((()=>o.collectionStore()),[o]),f=(0,a.VK)((()=>o.collectionViewBlockStore()),[o]),x=(0,a.VK)((()=>f&&h?f.getCollectionViewStores().filter((e=>{var t;const o=null===(t=e.getCollectionStore())||void 0===t?void 0:t.pointer;return(null==o?void 0:o.id)===h.id})):[]),[f,h]),S=(0,a.VK)((()=>{if(!h)return[];let e;t&&"collection_view"===t.table&&(e=E.Xr.createChildStore(h,t));return M.mN([...x,e].filter(g.$K),(e=>{let{id:t}=e;return t})).filter((e=>(0,A.D)(e,m)))}),[h,x,m,t]),v=(0,a.VK)((()=>{if(h&&(0,W.r_)({collectionStore:h,environment:d,intl:u,queryForFilter:m}))return function(e){const{collectionStore:t,environment:o,selectedSourcePointer:n,onSelect:i,isMobile:a,intl:r}=e,s=t.getIcon(),l=(0,N.vU)({environment:o,intl:r,store:t}),c=n&&"collection"===n.table&&n.id===t.id,u=t.getSpaceShardedPointer(),d={key:t.id,action:()=>{u&&i(u)},render:e=>(0,U.jsx)(w.Z,{...e,icon:s&&(0,U.jsx)(K.Z,{isEmptyPage:!1,size:a?18:16,disabled:!0,icon:s}),title:l,caption:(0,U.jsx)(p.FormattedMessage,{id:"AutomationCollectionSelectMenu.collection.caption",defaultMessage:"Any page in this database",values:{collectionName:l}}),right:c&&(0,b.e)({width:12,height:"auto"})})};return{key:"collection",items:[d],render:e=>(0,U.jsx)(_.Z,{...e,topBorder:!0})}}({collectionStore:h,environment:d,selectedSourcePointer:t,onSelect:s,isMobile:c,intl:u})}),[h,d,u,c,s,m,t]),z=(0,a.VK)((()=>h&&f&&x?function(e){const{blockStore:t,filteredCollectionViewStores:o,collectionStore:n,selectedSourcePointer:i,onSelect:a,intl:r}=e,s=n.getSchema(),l=o.map((e=>{const o=e.getSpaceShardedPointer();if(e.isDefined()&&o){const l=i&&"collection_view"===i.table&&i.id===o.id,c=(0,L.rU)({collectionViewStore:e,collectionSchema:s}),u=(0,g.$K)(c),d=e.getType(),m=e.getFormat().collection_view_icon,y=e.getName(),h=(o,n)=>(0,U.jsx)(w.Z,{...o,...n,icon:(0,U.jsx)(j.F,{color:"lightGray",viewType:d,viewIcon:m}),title:(0,U.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",padding:0,gap:4},children:[(0,U.jsx)(P.Z,{collectionViewType:d,collectionViewName:y}),u&&l&&(0,C.t)({width:16,height:"auto"})]}),caption:(0,U.jsx)(q,{blockStore:t,collectionViewStore:e,intl:r,collectionSchema:s,referencesIncompatibleProperties:u}),right:l&&(0,b.e)({width:12,height:"auto"}),disabled:u,disabledFeedback:u});let f;if(u&&c){var n;const e=null===(n=s[c])||void 0===n?void 0:n.type,t=e?W.SO[e]:void 0,o=t?(0,U.jsx)(p.FormattedMessage,{id:"AutomationCollectionSelectMenu.tooltip.incompatibleFiltersWarning.specific",defaultMessage:"{propertyTypeName} properties are not supported",values:{propertyTypeName:t}}):(0,U.jsx)(p.FormattedMessage,{id:"AutomationCollectionSelectMenu.tooltip.incompatibleFiltersWarning.default",defaultMessage:"Some properties are not supported"});f=e=>(0,U.jsx)(R.ZP,{placement:R.ug.Right,renderTooltip:()=>o,render:t=>h(e,t)})}else f=h;return{key:e.id,action:()=>{a(o)},render:f}}}));return[...l].filter(g.$K)}({blockStore:f,collectionStore:h,filteredCollectionViewStores:S,selectedSourcePointer:t,onSelect:s,intl:u}):[]),[f,h,x,S,u,s,t]),G=function(e){const{menuListItems:t}=e;if(0===t.length)return;return{key:"collection-views",items:t,render:e=>(0,U.jsx)(_.Z,{...e,topBorder:!0})}}({menuListItems:z}),Y={key:"search",items:[{key:"search_item",action:()=>{},render:()=>(0,U.jsx)(I.ZP,{value:m,focus:!0,style:X.searchBar,textWrapperStyle:X.searchText,onChange:e=>y(e.target.value),placeholder:u.formatMessage({defaultMessage:"Search for a view...",id:"collectionViewSelect.viewSearch.label"})})}],render:e=>(0,U.jsx)(_.Z,{...e})};let Q;(0,g.$K)(v)||(0,g.$K)(G)||(Q={key:"no-results-section",items:[{key:"no-results-item",action:M.ZT,render:()=>(0,U.jsx)(T.Z,{caption:(0,U.jsx)(p.FormattedMessage,{defaultMessage:"No results",id:"collectionViewSelect.noResults.title"})})}],render:e=>(0,U.jsx)(_.Z,{...e,topBorder:!0})});const J=[Y,v,G,Q].filter(g.$K),X=function(e){return(0,r.yK)((t=>({button:{marginTop:8},buttonPopup:{width:e?void 0:230},searchBar:{marginTop:8,marginBottom:8},searchText:{marginLeft:8,marginRight:8},buttonRight:{color:t.selectLightGray[500]},menuItemTextWrapper:{...e?{marginLeft:12}:{},minWidth:"auto"}})),[e])}(c),ee=(0,a.qz)(void 0,O.Z),te=(0,H.d)();if(!h)return null;const oe=(0,U.jsx)($,{pointer:t,collectionStore:h,intl:u});return(0,U.jsx)(V.ZP,{alignmentToOrigin:V.vR.End,placementToOrigin:V.pO.Bottom,popupType:te,style:X.buttonPopup,buttonPopupStore:ee,render:e=>{let t;return t=c?{menuType:D.og.Modal,title:(0,U.jsx)(p.FormattedMessage,{id:"collectionSettings.editAutomationView.notifyForOption.title",defaultMessage:"For pages in"}),right:(0,U.jsx)(Z.DoneMenuText,{}),onClickRight:()=>{e.close()}}:{menuType:D.og.Popup,width:230,maxHeight:"50vh"},(0,U.jsx)(F.Z,{...t,children:(0,U.jsx)(B.Z,{type:B.i.Vertical,sections:J,initialFocus:0,onAccept:()=>{e.close()}})})},renderOrigin:e=>(0,U.jsx)(k.Z,{title:(0,U.jsx)(p.FormattedMessage,{id:"collectionSettings.editAutomationView.notifyForOption.title",defaultMessage:"For pages in"}),showChevron:!0,right:oe,rightStyle:{flexShrink:1},rotateChevron:ee.state.open,disabled:l,textWrapperStyle:X.menuItemTextWrapper,...e})})}function $(e){const{pointer:t,collectionStore:o,intl:n}=e,s=(0,i.O7)(),l=(0,r.yK)((e=>({warningIcon:{width:16,height:"auto",color:e.accentColors.orange[400]},titleContainer:{display:"flex",flexDirection:"row",alignItems:"center",padding:0,gap:4,flex:"1 1 auto",minWidth:0},title:{...y.Z.textOverflowStyle},errorText:{color:e.errorText,fontWeight:y.Z.fontWeight.medium}})),[]),c=(0,a.VK)((()=>t?E.t1.createChildStore(o,t):void 0),[o,t]),d=(0,a.VK)((()=>c?(0,N.vU)({environment:s,intl:n,store:c}):(0,U.jsx)("span",{style:l.errorText,children:(0,U.jsx)(p.FormattedMessage,{id:"AutomationCollectionSelectMenu.source.missing",defaultMessage:"Select database"})})),[s,n,l.errorText,c]),m=(0,a.VK)((()=>{if(!c||c.table===u.vF)return!1;const e=o.getSchema();return(0,g.$K)((0,L.rU)({collectionViewStore:c,collectionSchema:e}))}),[o,c]);return(0,U.jsxs)("div",{style:l.titleContainer,children:[m&&(0,C.t)(l.warningIcon),(0,U.jsx)("span",{style:l.title,children:d})]})}function q(e){const{blockStore:t,collectionViewStore:o,intl:n,collectionSchema:r,referencesIncompatibleProperties:s}=e,l=(0,i.O7)(),c=(0,a.VK)((()=>!o.getAlive()),[o]),u=(0,a.VK)((()=>{const e=o.getParentBlockStore();if(e)return t.id!==e.id?(0,N.vU)({environment:l,intl:n,store:e}):void 0}),[t.id,o,n,l]),d=(0,a.VK)((()=>{const e=o.getQuery(r);return(0,v.OH)({propertyFilters:o.getPropertyFiltersStore().getValue()??[],combinatorFilter:null==e?void 0:e.filter,schema:r}).reduce(((e,t)=>{if((0,v.aN)(t))return e+1;return e+(t.filters??[]).length}),0)}),[r,o]);return s?(0,U.jsx)(p.FormattedMessage,{id:"AutomationCollectionSelectMenu.collectionView.unsupportedView",defaultMessage:"Not supported"}):c?(0,U.jsx)(p.FormattedMessage,{id:"AutomationCollectionSelectMenu.collectionView.deletedView",defaultMessage:"<emphasis>View not found.</emphasis>",values:{emphasis:e=>(0,U.jsx)("em",{children:e})}}):u?(0,U.jsx)(p.FormattedMessage,{id:"AutomationCollectionSelectMenu.collectionView.captionDifferentParent",defaultMessage:"<emphasis>View configured in {externalParentBlockName}</emphasis>",values:{emphasis:e=>(0,U.jsx)("em",{children:e}),externalParentBlockName:u}}):0===d?(0,U.jsx)(p.FormattedMessage,{id:"AutomationCollectionSelectMenu.collectionView.captionWithNoFilters",defaultMessage:"Any page in this view"}):(0,U.jsx)(p.FormattedMessage,{id:"AutomationCollectionSelectMenu.collectionView.captionWithFilters",defaultMessage:"{ruleCount, plural, one {{ruleCount} filter} other {{ruleCount} filters}}",values:{ruleCount:d}})}var G=o(9015),Y=o(91494),Q=o(12455);var J=o(74404),X=o(97372),ee=o(3386),te=o(58297),oe=o(63474),ne=o(84398),ie=o(80444),ae=o(77080),re=o(58812),se=o(2647);var le=o(13273);var ce=o(15145),ue=o(65422),de=o(16184),pe=o(63306),me=o(21202),ge=o(21862),ye=o(89728),he=o(42402),fe=o(97978),xe=o(49117),Se=o(46654),ve=o(44041);const be=(0,p.defineMessages)({automationIncompatibleViewFilterAndOwner:{defaultMessage:"This automation may not work because the view has a non-supported filter",id:"AutomationHeaderView.incompatibleCollectionViewFilter.owner"},automationPublicAccess:{defaultMessage:"This automation is part of a public page",id:"AutomationHeaderView.automationPublicAccess"},automationUpgrade:{defaultMessage:"<anchor-upsell>Upgrade</anchor-upsell> to edit this automation or create your own",id:"AutomationHeaderView.automationUpgrade"},automationEditOnSite:{defaultMessage:"This automation can only be edited on notion.com",id:"AutomationHeaderView.automationEditOnSite"},automationSlackNoPermissions:{defaultMessage:"Ask {user} to edit this automation",id:"AutomationHeaderView.automationSlackNoPermissions"},automationSlackWithPermissions:{defaultMessage:"Ask {user} to edit this automation or <anchor-delete>delete</anchor-delete> it when necessary",id:"AutomationHeaderView.automationSlackWithPermissions"},automationMissingPermissionsNoPermissions:{defaultMessage:"You must have full access to target databases in this automation to edit it",id:"AutomationHeaderView.automationMissingPermissionsNoPermissions"},automationMissingPermissionsWithPermissions:{defaultMessage:"You must have full access to target databases in this automation to edit it or <anchor-delete>delete</anchor-delete> it when necessary",id:"AutomationHeaderView.automationMissingPermissionsWithPermissions"},automationGenericFullAccess:{defaultMessage:"You must have full access to this database to edit automations",id:"AutomationHeaderView.automationGenericFullAccess"},automationCollectionInTrashedPage:{defaultMessage:"This database is in the trash and cannot be edited.",id:"AutomationHeaderView.automationCollectionInTrash"},automationCollectionInTrashedPageViewDeletedPageButton:{defaultMessage:"View deleted page",id:"AutomationHeaderView.automationCollectionInTrashedPageViewDeletedPageButton"}});function Ce(e){const{automationStore:t,automationPermissionScope:o,collectionStore:r,onDelete:s,referencesIncompatibleCollectionViewFilter:c}=e,u=(0,i.O7)(),d=(0,Y.X)({automationStore:t,collectionStore:r}),m=(0,a.VK)((()=>null==d?void 0:d.context.type),[d]),g=(0,a.VK)((()=>Boolean((0,Se.IJ)(u,t))),[t,u]),y=(0,a.VK)((()=>(0,xe.$5)(null==d?void 0:d.context)),[d]),h=(0,a.VK)((()=>(0,L.R4)(t)),[t]),f=(0,a.VK)((()=>{const e=(0,pe.DW)(r.pointer,r.getRecordModel),t=(0,pe.OJ)(e);if(!t||t.table!==me.iU)return;const o=t.pointer;return E.G.createChildStore(r,o)}),[r]),x=(0,a.VK)((()=>ae.default.checkGate("prevent_edits_trash")),[]),S=(0,n.useCallback)((()=>{ve.y(u,{from:"database_automation_settings_header_message",for:"plus"})}),[u]),v=Pe();if(x&&f)return(0,U.jsx)(je,{icon:(0,U.jsx)("div",{style:v.lockedIconWrap,children:(0,l.y)(v.lockedIcon)}),children:(0,U.jsxs)("div",{children:[(0,U.jsx)("p",{style:v.paragraph,children:(0,U.jsx)(p.FormattedMessage,{...be.automationCollectionInTrashedPage})}),(0,U.jsx)(ye.Z,{onClick:()=>function(e,t){(function(e){(0,fe.j)(e,"view_deleted_page_from_automation_edit_menu")})(t),ge.r({environment:t,store:e,pageVisitSource:ce.tY.LinkInPage})}(f,u),style:v.restoreButton,isLightGray:!0,children:(0,U.jsx)(p.FormattedMessage,{...be.automationCollectionInTrashedPageViewDeletedPageButton})})]})});if(g)return(0,U.jsx)(Me,{icon:(0,U.jsx)("div",{style:v.lockedIconWrap,children:(0,de.Q)(v.lockedIcon)}),children:(0,U.jsx)("p",{style:v.paragraph,children:(0,U.jsx)(p.FormattedMessage,{...be.automationPublicAccess})})});if("sufficient"!==y.editPermissionStatus&&"free_workspace"===y.reason)return(0,xe.Rr)({contextType:m,environment:u})?(0,U.jsx)(ke,{icon:(0,U.jsx)("div",{style:v.boltIconWrap,children:(0,ue.K)(v.boltIcon)}),children:(0,U.jsx)("p",{style:v.paragraph,children:(0,U.jsx)(p.FormattedMessage,{...be.automationUpgrade,values:{"anchor-upsell":e=>(0,U.jsx)(he.Z,{onClick:S,style:v.link,children:e})}})})}):(0,U.jsx)(Me,{icon:(0,U.jsx)("div",{style:v.lockedIconWrap,children:(0,de.Q)(v.lockedIcon)}),children:(0,U.jsx)("p",{style:v.paragraph,children:(0,U.jsx)(p.FormattedMessage,{...be.automationEditOnSite})})});if("sufficient"!==y.editPermissionStatus&&"missing_permissions"===y.reason&&y.actionId){const e=h[y.actionId];return(0,U.jsx)(Me,{icon:(0,U.jsx)("div",{style:v.lockedIconWrap,children:(0,de.Q)(v.lockedIcon)}),children:(0,U.jsx)("p",{style:v.paragraph,children:(0,U.jsx)(p.FormattedMessage,{..."readonly"===o?be.automationSlackNoPermissions:be.automationSlackWithPermissions,values:{"anchor-delete":e=>(0,U.jsx)(he.Z,{onClick:s,style:v.link,children:e}),user:e}})})})}return"insufficient"===y.editPermissionStatus||"unknown"===y.editPermissionStatus?(0,U.jsx)(Me,{icon:(0,U.jsx)("div",{style:v.lockedIconWrap,children:(0,de.Q)(v.lockedIcon)}),children:(0,U.jsx)("p",{style:v.paragraph,children:(0,U.jsx)(p.FormattedMessage,{...be.automationGenericFullAccess})})}):c?(0,U.jsx)(Me,{icon:(0,U.jsx)("div",{style:v.lockedIconWrap,children:(0,C.t)(v.warningIcon)}),children:(0,U.jsx)(p.FormattedMessage,{...be.automationIncompatibleViewFilterAndOwner})}):null}function Me(e){const{children:t,icon:o}=e,n=Pe();return(0,U.jsx)("div",{style:n.wrapWrap,children:(0,U.jsxs)("div",{style:n.wrap,children:[o&&(0,U.jsx)("div",{style:n.iconWrap,children:o}),(0,U.jsx)("div",{style:n.messageWrap,children:t})]})})}function ke(e){const{children:t,icon:o}=e,n=Pe();return(0,U.jsx)("div",{style:n.wrapWrap,children:(0,U.jsxs)("div",{style:n.upsellWrap,children:[o&&(0,U.jsx)("div",{style:n.iconWrap,children:o}),(0,U.jsx)("div",{style:n.messageWrap,children:t})]})})}function je(e){const{children:t,icon:o}=e,n=Pe();return(0,U.jsx)("div",{style:n.wrapWrap,children:(0,U.jsxs)("div",{style:n.trashPageWrap,children:[o&&(0,U.jsx)("div",{style:n.iconWrap,children:o}),(0,U.jsx)("div",{style:n.messageWrap,children:t})]})})}function Pe(){const{isMobile:e}=(0,i.Fy)();return(0,r.yK)((t=>({boltIcon:{fill:t.icon.yellow,height:"100%",width:"100%"},boltIconWrap:{height:20,padding:2,width:20},icon:{},iconWrap:{flexGrow:0,flexShrink:0},lockedIcon:{fill:t.icon.secondary,height:"100%",width:"100%"},lockedIconWrap:{background:t.fill.lightGray,borderRadius:4,height:20,padding:2,width:20},link:{color:t.text.uiBluePrimary},messageWrap:{flexGrow:1},paragraph:{color:t.text.secondary,fontSize:e?14:12,margin:0},restoreButton:{fontSize:e?14:12,fontWeight:y.Z.fontWeight.medium},warningIcon:{color:t.accentColors.orange[400],height:"100%",width:"100%"},warningIconWrap:{height:20,padding:2,width:20},wrap:{alignItems:"start",display:"flex",flexDirection:"row",gap:10},wrapWrap:{padding:e?12:"0 12px 12px 12px"},upsellWrap:{alignItems:"center",background:t.accentColors.yellow[50],border:`1px solid ${t.accentColors.yellow[100]}`,borderRadius:6,display:"flex",flexDirection:"row",gap:10,padding:8},trashPageWrap:{alignItems:"start",display:"flex",flexDirection:"row",gap:10,background:t.accentColors.gray[30],padding:8,borderRadius:6},personBadgeQuestionMark:{fill:t.mediumIconColor,width:16,height:"auto"},personBadgeQuestionMarkWrap:{height:20,padding:2,width:20}})),[e])}var Ae=o(24006),Te=o(75024);const we=(0,p.defineMessages)({automationEnabledLabel:{defaultMessage:"Active",id:"collectionSettings.editAutomationView.automationEnabledLabel"},automationPausedLabel:{defaultMessage:"Paused",id:"collectionSettings.editAutomationView.automationPausedLabel"},automationEnabledHiddenAriaLabel:{defaultMessage:"Automation is active.",id:"collectionSettings.editAutomationView.automationEnabledHiddenAriaLabel"},automationPausedHiddenAriaLabel:{defaultMessage:"Automation is paused.",id:"collectionSettings.editAutomationView.automationPausedHiddenAriaLabel"},automationDisabledTooltip:{defaultMessage:"Ask {user} to resume this automation.",id:"collectionSettings.editAutomationView.automationDisabledTooltip"}});function Ve(e){const{automationId:t,automationOwner:o,disabled:i,isAutomationPaused:a,onPause:s,onResume:l}=e,c=`toggle-${t}`,u=(0,n.useCallback)((()=>{a?null==l||l():null==s||s()}),[a,l,s]),d=(0,r.yK)((e=>({labelWrap:{color:i?e.text.tertiary:a?e.text.secondary:e.text.primary,flex:"1 1 auto",fontSize:14},sectionWrap:{alignItems:"start",display:"flex",flexDirection:"row",gap:6,marginBlockEnd:12},toggleWrap:{flex:"0 0 auto",paddingBlockStart:2}})),[i,a]),m=a?we.automationPausedLabel:we.automationEnabledLabel,g=a?we.automationPausedHiddenAriaLabel:we.automationEnabledHiddenAriaLabel;return(0,U.jsxs)("section",{style:d.sectionWrap,children:[(0,U.jsx)("div",{style:d.toggleWrap,children:(0,U.jsx)(R.ZP,{disableTooltip:!i||!a,renderTooltip:()=>(0,U.jsx)(p.FormattedMessage,{...we.automationDisabledTooltip,values:{user:o}}),render:e=>(0,U.jsx)("div",{...e,children:(0,U.jsx)(Ae.Z,{disabled:i,inputId:c,on:!a,onClick:u})})})}),(0,U.jsx)("div",{style:d.labelWrap,children:(0,U.jsxs)("label",{htmlFor:c,children:[(0,U.jsx)("span",{"aria-hidden":!0,children:(0,U.jsx)(p.FormattedMessage,{...m})}),(0,U.jsx)("span",{style:Te.jy,children:(0,U.jsx)(p.FormattedMessage,{...g})})]})})]})}const Ie=(0,p.defineMessages)({createAutomationViewMenuTitle:{id:"collectionSettings.createStatusAutomationView.menuTitle",defaultMessage:"New automation"},editAutomationViewMenuTitle:{id:"collectionSettings.editStatusAutomationView.menuTitle",defaultMessage:"Edit automation"},addTriggerLabel:{defaultMessage:"Add trigger",id:"collectionSettings.editAutomationView.triggerSection.placeholder"},addTriggerAriaLabel:{id:"collectionSettings.editAutomationView.addTrigger.iconButton",defaultMessage:"Add trigger"},addActionLabel:{defaultMessage:"Add action",id:"AutomationActionSelectButton.actionSection.addAction"},addActionAriaLabel:{id:"collectionSettings.editAutomationView.addAction.iconButton",defaultMessage:"Add action"},deleteButton:{id:"collectionSettings.editAutomationView.deleteButton",defaultMessage:"Delete"},triggerTitle:{defaultMessage:"When any of these occur",id:"collectionSettings.editAutomationView.triggerSection.title"},actionTitle:{defaultMessage:"Do this",id:"collectionSettings.editAutomationView.actionSection.title"},automationEnabledLabel:{defaultMessage:"Active",id:"collectionSettings.editAutomationView.automationEnabledLabel"},automationPausedLabel:{defaultMessage:"Paused",id:"collectionSettings.editAutomationView.automationPausedLabel"},automationEnabledHiddenAriaLabel:{defaultMessage:"Automation is active.",id:"collectionSettings.editAutomationView.automationEnabledHiddenAriaLabel"},automationPausedHiddenAriaLabel:{defaultMessage:"Automation is paused.",id:"collectionSettings.editAutomationView.automationPausedHiddenAriaLabel"},automationDisabledTooltip:{defaultMessage:"Ask {user} to resume this automation.",id:"collectionSettings.editAutomationView.automationDisabledTooltip"}});function Fe(){}function Be(e){return(0,U.jsx)(Ke,{...e})}function Ze(e){return(0,U.jsx)(Ke,{...e})}function Ke(e){const{collectionSettingsStore:t,collectionContextStore:o,...r}=e,u=(0,n.useMemo)((()=>r),[]),{mode:d}=u,y=(0,p.useIntl)(),x=(0,oe.D)(),v=(0,i.O7)(),{isMobile:b}=(0,i.Fy)(),[C,M]=(0,n.useState)([]),j="create"===d,P=(0,ne.$)("CollectionSettingsEditAutomationView",{cacheFallback:v.defaultRecordCache.inMemoryRecordCache,isTemporaryData:!0}),A=(0,a.VK)((()=>ie.default.state.currentUserStore),[]),T=(0,a.VK)((()=>null==A?void 0:A.userId),[A]),w=(0,a.VK)((()=>null==A?void 0:A.getDisplayName(y)),[A,y]),V=(0,a.VK)((()=>o.collectionStore()),[o]),I=(0,a.VK)((()=>null==V?void 0:V.getSpaceId()),[V]),F=(0,a.VK)((()=>null==V?void 0:V.id),[V]),Z=(0,n.useMemo)((()=>"update"===u.mode?u.automationId:(0,m.ZP)()),[u]),K=(0,a.VK)((()=>o.aliveAutomationCount.state),[o]),R=(0,a.VK)((()=>{if(I&&V&&T)return new E.Mz(v,{id:Z,table:c.cv,spaceId:I})}),[Z,V,T,v,I]),W=(0,a.VK)((()=>(null==R?void 0:R.getStatus())??"disabled"),[R]),D="active"===W,N=(0,a.VK)((()=>(0,s.XO)(y,w)),[w,y]),O=(0,a.VK)((()=>{if(!I||!V||!T)return;const e={id:Z,table:c.cv,spaceId:I},t=P.getEntry({pointer:e,userId:T});return t?t.value.value:L.sA({automationId:Z,automationName:N,collectionStore:V,userId:T})}),[N,Z,V,T,I,P]),{maybePersistedAutomationStore:H,maybePersistedTransactionActions:z,hasUnpersistedChanges:$}=(0,J.$)({automationId:Z,spaceId:I,defaultValue:j?O:void 0,persist:!1}),q=(0,a.VK)((()=>{if(H&&L.Xd(H))return H}),[H]),Q=(0,a.VK)((()=>(null==q?void 0:q.getName())??""),[q]),ce=(0,a.VK)((()=>{var e;return(null==q||null===(e=q.getOwnerStore())||void 0===e?void 0:e.getDisplayName(y))??""}),[y,q]),ue=(0,a.VK)((()=>((null==q?void 0:q.getActionStores())??[]).filter((e=>e.isDefined()))),[q]),de=(0,a.VK)((()=>{const e=null==V?void 0:V.getParentBlockStore();if(!e)return!1;return ae.default.checkGate("prevent_edits_trash")&&e.pathIsDead()}),[V]),pe=function(e){const{actionStores:t,automationStore:o,loadingStatus:n,mode:i}=e;return(0,a.VK)((()=>"create"===i?"edit":"resolved"===n&&o&&t?(0,L.i1)({automationStore:o,actionStores:t})?"edit":(0,L.qM)({automationStore:o})?"readonly_with_delete":"readonly":"readonly"),[i,n,o,t])}({automationStore:q,actionStores:ue,loadingStatus:"resolved",mode:u.mode}),me=("readonly_with_delete"===pe||"edit"===pe&&!j)&&!de,ge="edit"===pe&&!de,ye=(0,Y.X)({automationStore:q,collectionStore:V}),he=(0,Y.X)({automationStore:R,collectionStore:V}),fe=(0,a.VK)((()=>!(!q||!V)&&L.vM({automationStore:q,collectionStore:V})),[q,V]),xe=(0,a.VK)((()=>!!(V&&q&&ye)&&L.qk({automationContextStore:ye,automationStore:q,collectionStore:V})),[ye,q,V]),Se=(0,a.VK)((()=>!!(V&&R&&he)&&L.qk({automationContextStore:he,automationStore:R,collectionStore:V})),[V,he,R]);!function(e){const{automationStore:t,collectionStoreId:o,eventTracker:i}=e,[r,s]=(0,n.useState)(!1),l=(0,a.VK)((()=>(null==t?void 0:t.getActionIds().length)??0),[t]),c=(0,a.VK)((()=>{if(!t||!(0,L.Xd)(t))return 0;const e=t.getTriggerStore().getKeyStore("event");let o=0;e.getKeyStore("pagesAdded").getValue()&&o++;const n=e.getKeyStore("pagePropertiesEdited").getValue();return"any"===(null==n?void 0:n.type)?o++:"some"===(null==n?void 0:n.type)&&(o+=n.some.length),o}),[t]);(0,n.useEffect)((()=>{i&&o&&!r&&t&&((0,se.nC)(i,{automation_id:t.id,automation_total_actions:l,automation_total_triggers:c,collection_id:o}),ae.default.logEvent("automation_configure_view","true"),s(!0))}),[i,o,r,l,c,null==t?void 0:t.id,t])}({automationStore:q,collectionStoreId:F,eventTracker:x});const ve=(0,n.useCallback)((()=>{V&&q&&$&&("create"===d?function(e){const{automationStore:t,collectionSettingsStore:o,collectionStore:n,environment:i,intl:a}=e;re.aO({automationStore:t,collectionStore:n,environment:i,intl:a}),f.oV({label:(0,U.jsx)(p.FormattedMessage,{id:"automations.editAutomationView.createdConfirmation",defaultMessage:"{automationName} created",values:{automationName:t.getName()}})}),h.z$({collectionSettingsStore:o})}({automationStore:q,collectionSettingsStore:t,collectionStore:V,environment:v,intl:y}):"update"===d?function(e){const{automationStore:t,collectionSettingsStore:o,collectionStore:n,environment:i}=e;re.hY({automationStore:t,collectionStore:n,environment:i}),f.oV({label:(0,U.jsx)(p.FormattedMessage,{id:"automations.editAutomationView.updatedConfirmation",defaultMessage:"{automationName} updated",values:{automationName:t.getName()}})}),h.z$({collectionSettingsStore:o})}({automationStore:q,collectionSettingsStore:t,collectionStore:V,environment:v}):(0,g.t1)(d))}),[q,t,V,v,$,y,d]),be=(0,n.useCallback)((()=>{q&&V&&re.j3({automationStore:q,collectionStore:V,environment:v})}),[V,v,q]),Me=(0,n.useCallback)((()=>{q&&V&&re.$K({automationStore:q,collectionStore:V,environment:v})}),[V,v,q]),ke=(0,n.useCallback)((async()=>{q&&V&&!j&&await re.SC({intl:y,environment:v,existingAutomationStore:q,collectionStore:V,onDelete:()=>{1===K?h.wl({collectionSettingsStore:t,item:{type:"main"}}):h.z$({collectionSettingsStore:t})}})}),[K,q,t,V,v,y,j]),je=(0,n.useCallback)((async()=>{await re.hL({automationName:Q,hasPendingChanges:$})&&(0===K?h.wl({collectionSettingsStore:t,item:{type:"main"}}):h.z$({collectionSettingsStore:t}))}),[K,Q,t,$]),Pe=(0,n.useCallback)((async()=>{await re.hL({automationName:Q,hasPendingChanges:$})&&h.E3({collectionSettingsStore:t})}),[Q,t,$]);!function(e){const{hasPendingChanges:t,onClick:o}=e;(0,n.useEffect)((()=>{async function e(e){const n=e.target;if(t&&e.eventPhase===Event.CAPTURING_PHASE&&n instanceof Element){if((0,le.jM)(n)||(0,le.yT)(n))return;e.stopPropagation(),e.preventDefault(),await o()}}return window.addEventListener("click",e,{capture:!0}),()=>{window.removeEventListener("click",e,{capture:!0})}}),[t,o])}({hasPendingChanges:$,onClick:Pe});const Ae=(0,n.useCallback)((e=>{M((t=>[...t,e.id]))}),[]),Te=We({showDeleteEnableDisableOptions:me}),we=[],Be=$&&xe;if(ge&&we.push((0,U.jsx)(_.Z,{mobileStyle:Te.automationCreateMobile,style:Te.automationCreateDesktop,topBorder:!b,children:(0,U.jsx)(te.Z,{onClick:ve,disabled:!Be,style:Te.automationCreateButton,children:j?(0,U.jsx)(p.FormattedMessage,{id:"collectionSettings.editAutomationView.createButton.label",defaultMessage:"Create"}):(0,U.jsx)(p.FormattedMessage,{id:"collectionSettings.editAutomationView.saveButton.label",defaultMessage:"Save"})})},"save")),me&&we.push((0,U.jsx)(_.Z,{disableMobilePadding:!0,topBorder:b||0===we.length,children:(0,U.jsx)(k.Z,{desktopIconStyle:Te.automationOptionIconDesktop,icon:l.y,isRed:!0,onClick:ke,title:y.formatMessage(Ie.deleteButton)})},"delete")),!V||!q)return null;const Ze=j?y.formatMessage(Ie.createAutomationViewMenuTitle):y.formatMessage(Ie.editAutomationViewMenuTitle),Ke=W&&ce&&(0,U.jsx)(Ce,{automationStore:q,collectionStore:V,automationPermissionScope:pe,referencesIncompatibleCollectionViewFilter:fe,onDelete:ke});return(0,U.jsx)(ee.Z,{debugName:"CollectionSettingsEditAutomationView",capture:!0,onEsc:Pe,children:(0,U.jsx)(X.ZP,{title:Ze,collectionSettingsStore:t,handleBackArrowClick:je,handleClose:Pe,footer:we,fullHeight:!0,menuScrollerStyle:Te.menuScroller,children:(0,U.jsxs)(G.Z.Provider,{value:{automationContextStore:ye,automationStore:q,collectionStore:V,disabled:!ge,editorPlacement:{type:"inline"},editorWidth:X.nJ,maybePersistedTransactionActions:z,onActionAdded:Ae,suppressActionErrors:C,currentDraggingActionId:void 0},children:[Ke,(0,U.jsx)(B.Z,{type:B.i.Vertical,initialFocus:void 0,sections:[{key:"automation_top_input",items:[{key:"automation_name",action:()=>{},render:e=>(0,U.jsx)(_e,{...e,disabled:!ge})},{key:"automation_source",action:Fe,render:e=>(0,U.jsx)(Re,{disabled:!ge,collectionContextStore:o,menuListItemProps:e})}],render:e=>(0,U.jsx)(_.Z,{...e,disableMobilePadding:Boolean(Ke)})}]}),(0,U.jsxs)("div",{style:Te.wrap,children:[Se&&me&&(0,U.jsx)(Ve,{automationId:q.id,automationOwner:ce,isAutomationPaused:!D,onPause:be,onResume:Me}),(0,U.jsx)(S.IQ,{areActionsEditable:ge,areTriggersEditable:ge})]})]})})})}function _e(e){let{disabled:t,...o}=e;const{automationStore:i,maybePersistedTransactionActions:r}=(0,Q.i)(),s=We({showDeleteEnableDisableOptions:!1}),l=(0,a.VK)((()=>(null==i?void 0:i.getName())??""),[i]),c=(0,n.useCallback)((e=>{const t=e.target.value;r.createAndCommit({userAction:"Automation.updateName",perform:e=>{x.applyOperation({store:i,operation:{path:["properties"],pointer:i.pointer,command:"update",args:{name:t}},transaction:e})}})}),[i,r]);return(0,U.jsx)(I.ZP,{style:s.automationNameInput,...o,value:l??"Loading...",onChange:c,disabled:t,textWrapperStyle:s.automationNameText})}function Re(e){const{automationStore:t,maybePersistedTransactionActions:o}=(0,Q.i)(),i=(0,a.VK)((()=>{if(t&&(0,L.Xd)(t)){const e=t.getTriggerStore().getKeyStore("event").getKeyStore("source").getValue();if(e&&"filter"!==e.type)return e.pointer}}),[t]),r=(0,n.useCallback)((e=>{const n=e.table===u.vF?{pointer:e,type:u.vF}:{pointer:e,type:d.np};o.createAndCommit({userAction:"Automation.updateSource",perform:e=>{x.applyOperation({store:t,operation:{path:["trigger","event"],pointer:t.pointer,command:"update",args:{source:n}},transaction:e})}})}),[t,o]);return(0,U.jsx)(z,{selectedSourcePointer:i,onSelect:r,...e})}function We(e){const{showDeleteEnableDisableOptions:t}=e,{isMobile:o}=(0,i.Fy)();return(0,r.yK)((e=>({automationSection:{display:"flex",flexDirection:"column",gap:4},automationSectionAdd:{marginLeft:"auto",flexGrow:0,flexShrink:0},automationSectionHeader:{alignItems:"center",display:"flex",flexDirection:"row"},automationSectionHeaderAction:{background:`linear-gradient(to right, ${e.stroke.regular} 50%, transparent 50%), linear-gradient(to right, ${e.stroke.regular} 50%, transparent 50%)`,backgroundPosition:"20px 0px, 20px bottom",backgroundRepeat:"no-repeat",backgroundSize:"2px 36px, 2px 6px",marginBlockEnd:-4,paddingBlock:"36px 4px",position:"relative"},automationSectionTitle:{color:e.lightTextColor,fontSize:o?14:12,lineHeight:1.3,position:"relative",fontWeight:y.Z.fontWeight.medium},automationCreateMobile:{boxShadow:"none",paddingBlock:"0 12px",paddingInline:12},automationCreateDesktop:{paddingBlock:t?"12px 0":12,paddingInline:12},automationCreateButton:{...o?{minHeight:45}:{},width:"100%"},automationNameInput:{marginBlockEnd:o?void 0:8},automationNameText:{marginInlineStart:12},automationOptionIconDesktop:{marginInlineStart:12},menuScroller:{...o?{}:{marginBlockStart:6}},wrap:{borderTop:`1px solid ${e.regularDividerColor}`,paddingBlockStart:15,paddingBlockEnd:12,paddingInline:12}})),[o,t])}},44157:(e,t,o)=>{o.r(t),o.d(t,{CollectionSettingsAutomationsView:()=>vt,CollectionSettingsCreateAutomationView:()=>n.oC,CollectionSettingsEditAutomationView:()=>n.ZD});var n=o(32130),i=(o(57658),o(43261)),a=o.n(i),r=o(67294),s=o(480),l=o(86628),c=o(24405),u=o(66897),d=o(3865),p=o(59786),m=o(2647),g=o(23290),y=o(76205),h=o(99036),f=o(80951),x=o(84619),S=o(76218),v=o(88607),b=o(91856),C=o(90792),M=o(65422),k=o(60019),j=o(84169),P=o(20669),A=o(25651),T=o(47453),w=o(24600),V=o(42283),I=o(63030),F=o(69196),B=o(53016),Z=o(48524),K=o(43393),_=o(32426),R=o(71500),W=o(73201),L=o(72050),D=o(55159),N=o(26774),O=o(34093),E=o(92607),H=o(32623),U=o(53866),z=o(3729),$=o(108),q=o(83303),G=o(56505),Y=o(8938),Q=o(94308),J=o(606),X=o(19889),ee=o(70203),te=o(9291),oe=o(1898),ne=o(37810),ie=o(5149),ae=o(80826),re=o(67653),se=o(34067),le=o(42767),ce=o(39864),ue=o(80981),de=o(23745),pe=o(90073),me=o(19656),ge=o(23645),ye=o(93060),he=o(20239),fe=o(76954),xe=o(87181),Se=o(56812),ve=o(91494),be=o(97372),Ce=o(94166),Me=o(68894),ke=o(16354),je=o(72495),Pe=o(62385),Ae=o(26388),Te=o(65183),we=o(54802),Ve=o(46654),Ie=o(37034),Fe=o(63474),Be=o(80444),Ze=o(77080),Ke=o(6258),_e=o(58812),Re=o(6740),We=o(37989),Le=o(33907),De=o(54497),Ne=o(77744),Oe=o(12589),Ee=o(45238),He=o(85893);const Ue=(0,Ee.IU)("boltSlash",{svg:(0,He.jsx)("path",{d:"M1.248 12.444c0 .38.293.663.703.663h5.517l-2.91 7.588c-.39 1.006.684 1.553 1.318.723l4.405-5.664-1.094-1.094-3.008 3.985.274.146 2.129-4.746-2.413-2.393H3.69l1.074-1.416-1.142-1.142-2.12 2.725c-.166.214-.253.41-.253.624zm4.716-6.368L7.058 7.17l3.008-3.984-.274-.147-2.128 4.746 2.392 2.393h2.5l-1.074 1.416 1.143 1.142 2.128-2.734c.166-.205.254-.4.254-.625 0-.371-.293-.654-.703-.654H8.787l2.91-7.598c.39-1.006-.684-1.553-1.319-.713zm8.995 12.735a.754.754 0 001.064 0 .754.754 0 000-1.065L1.287 3.01a.766.766 0 00-1.075 0 .773.773 0 000 1.064z"}),viewBox:"0 0 17 22"});var ze=o(56666),$e=o(88437),qe=o(37612),Ge=o(52275),Ye=o(31945),Qe=o(73063),Je=o(78140),Xe=o(32163),et=o(61766),tt=o(95193),ot=o(35294);const nt=(0,te.defineMessages)({automationSummaryCardMoreButtonAriaLabel:{defaultMessage:"More",id:"automations.AutomationSummaryCard.MoreActionsButton.ariaLabel"},automationSummaryCardMoreMenuEditTitle:{defaultMessage:"Edit",id:"automations.AutomationSummaryCard.MoreActionsMenu.Edit.title"},automationSummaryCardMoreMenuDuplicateTitle:{defaultMessage:"Duplicate",id:"automations.AutomationSummaryCard.MoreActionsMenu.Duplicate.title"},automationSummaryCardMoreMenuPauseTitle:{defaultMessage:"Pause",id:"automations.AutomationSummaryCard.MoreActionsMenu.Pause.title"},automationSummaryCardMoreMenuResumeTitle:{defaultMessage:"Resume",id:"automations.AutomationSummaryCard.MoreActionsMenu.Resume.title"},automationSummaryCardMoreMenuDeleteTitle:{defaultMessage:"Delete",id:"automations.AutomationSummaryCard.MoreActionsMenu.Delete.title"}});function it(e){const{focused:t,style:o,onEdit:n,onDelete:i,onDuplicate:a,onDisable:s,onEnable:u}=e,d=(0,te.useIntl)(),p=(0,l.qz)(void 0,et.Z),m=(0,ot.d)();(0,r.useEffect)((()=>{t||p.setState({open:!1})}),[t,p]);const g=(0,c.yK)((e=>({iconButton:{border:`1px solid ${e.regularDividerColor}`,height:26,width:26,...o},iconButtonIcon:{width:16}})),[o]);return(0,He.jsx)(He.Fragment,{children:(0,He.jsx)(Ye.ZP,{stopClickPropagation:!0,popupType:m,alignmentToOrigin:Ye.vR.Center,placementToOrigin:Ye.pO.Bottom,originGap:0,renderOrigin:e=>(0,He.jsx)(Qe.Z,{ariaLabel:d.formatMessage(nt.automationSummaryCardMoreButtonAriaLabel),icon:ze.o,iconStyle:g.iconButtonIcon,style:g.iconButton,hasBackground:!0,...e}),render:e=>(0,He.jsx)(at,{onClose:()=>e.close(),onEdit:n,onDelete:i,onDuplicate:a,onDisable:s,onEnable:u}),buttonPopupStore:p})})}function at(e){const{onClose:t,onEdit:o,onDelete:n,onDuplicate:i,onDisable:a,onEnable:r}=e,s=(0,te.useIntl)(),l=(0,tt.F)(),c=o?{action:()=>{t(),o()},key:"edit",render:e=>(0,He.jsx)(Ge.Z,{...e,icon:(0,A.R)({height:16,width:16}),title:s.formatMessage(nt.automationSummaryCardMoreMenuEditTitle)})}:void 0,u=i?{action:()=>{t(),i()},key:"duplicate",render:e=>(0,He.jsx)(Ge.Z,{...e,icon:(0,$e.a)({height:16,width:16}),title:s.formatMessage(nt.automationSummaryCardMoreMenuDuplicateTitle)})}:void 0,d=a?{action:()=>{t(),a()},key:"disable",render:e=>(0,He.jsx)(Ge.Z,{...e,icon:Ue({height:16,width:16}),title:s.formatMessage(nt.automationSummaryCardMoreMenuPauseTitle)})}:void 0,p=r?{action:()=>{t(),r()},key:"enable",render:e=>(0,He.jsx)(Ge.Z,{...e,icon:(0,Oe.M)({height:16,width:16}),title:s.formatMessage(nt.automationSummaryCardMoreMenuResumeTitle)})}:void 0,m=n?{action:()=>{t(),n()},key:"delete",render:e=>(0,He.jsx)(Ge.Z,{...e,icon:(0,qe.y)({height:16,width:16}),title:s.formatMessage(nt.automationSummaryCardMoreMenuDeleteTitle),isRedOnHover:!0})}:void 0;return(0,He.jsx)(Je.Z,{...l,children:(0,He.jsx)(Xe.Z,{type:Xe.i.Vertical,sections:[{items:[c,u,d,p,m].filter(oe.$K),key:"items",render:e=>(0,He.jsx)(je.Z,{enableActionSheetTitle:!0,topBorder:!0,...e})}],initialFocus:0})})}var rt=o(64921),st=o(92864),lt=o(75024);const ct=6;function ut(e){const{actions:t,caption:o,focused:n,hasWarning:i,maxIcons:a,onBlur:l,onClick:u,onDelete:d,onDisable:p,onDuplicate:m,onEdit:g,onEnable:y,onFocus:h,onMouseDown:f,onMouseEnter:x,onMouseLeave:S,title:v,triggers:b}=e,{isMobile:C}=(0,s.Fy)(),M=(0,r.useRef)(null),[k,j]=(0,Re.Z)(),[P,A]=(0,We.Z)(),[T,w]=(0,r.useState)(!1),V=C||T||j||A,I=(0,c.yK)((e=>({wrap:{background:e.cardContentBackground,border:`1px solid ${e.regularDividerColor}`,borderRadius:8,display:"flex",flexDirection:"column",gap:15,padding:15,position:"relative"},moreButtonWrap:{display:V?"block":"none",position:"absolute",right:8,top:8},iconList:{display:"flex",flexWrap:"wrap",gap:5,listStyle:"none",margin:"0 30px 0 0",padding:0},body:{display:"flex",flexDirection:"column",gap:C?4:2},titleWrap:{...i?{alignItems:"center",display:"inline-flex",gap:4}:(0,lt.pd)(2),fontSize:C?16:14,fontWeight:ne.Z.fontWeight.medium,lineHeight:"130%"},title:{...i?ne.Z.textOverflowStyle:{}},warning:{color:e.accentColors.orange[400],height:"auto",width:C?16:14},caption:{...(0,lt.pd)(2),color:e.lightTextColor,fontSize:C?14:12,fontWeight:ne.Z.fontWeight.regular,lineHeight:"130%",margin:0}})),[i,V,C]),F=(0,r.useCallback)((e=>{w(!0),x&&x(e)}),[x]),B=(0,r.useCallback)((e=>{w(!1),S&&S(e)}),[S]);(0,r.useEffect)((()=>{n&&null!==M.current&&M.current.focus()}),[n]);const Z=(0,Ne.lq)(M,k,P),K=function(e){const{actionIcons:t,maxIcons:o,triggerIcons:n}=e,i=n.length,a=t.length,r=i>0&&a>0,s=Math.max(o,3),l=r?s-1:s;let c=Math.max(Math.floor(l/2),1),u=Math.max(Math.ceil(l/2),1);if(i<c&&a>u){u+=c-i,c=i}else if(a<u&&i>c){c+=u-a,u=a}const d=[];if(i>0)if(i>c)if(1===c)d.push({color:"gray",type:"truncate",value:i});else{const e=i-(c-1);d.push(...n.slice(0,c-1)),d.push({color:"gray",type:"truncate",value:e})}else d.push(...n);r&&d.push({type:"arrow"});if(a>0)if(a>u)if(1===u)d.push({color:"gray",type:"truncate",value:a});else{const e=a-(u-1);d.push(...t.slice(0,u-1)),d.push({color:"gray",type:"truncate",value:e})}else d.push(...t);return d}({actionIcons:t,maxIcons:ft(a),triggerIcons:b}),_=Boolean(d||p||y||m||g);return(0,He.jsxs)(rt.Z,{onBlur:l,onClick:u,onFocus:h,onMouseDown:f,onMouseEnter:F,onMouseLeave:B,ref:Z,style:I.wrap,children:[(0,He.jsxs)("header",{children:[_&&(0,He.jsx)("div",{style:I.moreButtonWrap,children:(0,He.jsx)(it,{focused:V,onDelete:d,onDisable:p,onEnable:y,onDuplicate:m,onEdit:g})}),(0,He.jsx)("ul",{"aria-hidden":"true",style:I.iconList,children:K.map(((e,t)=>(0,He.jsx)("li",{children:(0,He.jsx)(dt,{icon:e})},t)))})]}),(0,He.jsxs)("div",{style:I.body,children:[(0,He.jsxs)("div",{style:I.titleWrap,children:[(0,He.jsx)("span",{style:I.title,children:v}),i&&(0,De.t)(I.warning)]}),o&&(0,He.jsx)("p",{style:I.caption,children:o})]})]})}function dt(e){const{icon:t}=e;return"property"===t.type||"page"===t.type||"misc"===t.type?(0,He.jsx)(pt,{color:t.color,icon:t.icon}):"person"===t.type?(0,He.jsx)(ht,{actor:t.actor}):"app"===t.type?(0,He.jsx)(gt,{color:"default",icon:t.icon}):"arrow"===t.type?(0,He.jsx)(mt,{}):"truncate"===t.type?(0,He.jsx)(yt,{color:t.color,value:t.value}):void(0,oe.t1)(t.type)}function pt(e){const{color:t,icon:o}=e,n=xt(t);return(0,He.jsx)("div",{"aria-hidden":"true",style:n.iconWrap,children:o(n.icon)})}function mt(){const e=xt("default");return(0,He.jsx)("div",{style:{...e.iconWrap,...e.iconArrowWrap},children:(0,Le.n)({...e.icon,...e.iconArrow})})}function gt(e){const{icon:t}=e,o=xt("default");return(0,He.jsx)("div",{"aria-hidden":"true",style:o.iconAppWrap,children:t(o.iconApp)})}function yt(e){const{color:t,value:o}=e,n=xt(t);return(0,He.jsxs)("div",{style:{...n.iconWrap,...n.truncateWrap},children:["+",o]})}function ht(e){const{actor:t}=e,o=xt("default");return(0,He.jsx)("div",{"aria-hidden":"true",style:o.iconPersonWrap,children:(0,He.jsx)(st.ZP,{actor:t,avatarSize:26,format:st.ZP.Format.Inline,isSingle:!1,showRemoveButton:!1,style:{margin:0}})})}function ft(e){return void 0===e||e<0?ct:e}function xt(e){const t="default"===e?"gray":e;return(0,c.yK)((e=>{const o="light"===e.mode?400:800,n="light"===e.mode?100:400;return{icon:{fill:e.accentColors[t][o],width:16},iconWrap:{background:e.accentColors[t][n],borderRadius:6,padding:6},iconApp:{width:14},iconAppWrap:{borderRadius:6,borderWidth:1,borderStyle:"solid",borderColor:e.accentColors.gray[n],padding:6},iconPerson:{display:"block",width:"100%"},iconPersonWrap:{alignItems:"center",display:"flex",height:28,justifyContent:"center",width:28},iconArrow:{fill:e.accentColors.gray[600]},iconArrowWrap:{background:void 0},truncateWrap:{alignItems:"center",background:e.accentColors.gray[n],color:e.accentColors[t][o],display:"inline-flex",fontSize:12,fontWeight:ne.Z.fontWeight.semibold,height:28,justifyContent:"center",padding:3,width:28}}}),[t])}const St=(0,te.defineMessages)({automationTabTitle:{defaultMessage:"Automations",id:"database.viewSettings.automationTab.title"},automationTabFilterButton:{defaultMessage:"Filter",id:"database.viewSettings.automationTab.filterButton"},automationTabAddFilterButton:{defaultMessage:"Add filter",id:"database.viewSettings.automationTab.addFilterButton"},automationTabFilterMenuSearchInputPlaceholder:{defaultMessage:"Filter by…",id:"database.viewSettings.automationTab.filterMenuSearchInputPlaceholder"},automationTabFilterMenuNoResults:{defaultMessage:"No results",id:"database.viewSettings.automationTab.filterMenuNoResults"},automationNewAutomationTitle:{defaultMessage:"New automation",id:"database.viewSettings.automationTab.newAutomationTitle"},automationLearnAutomationTitle:{defaultMessage:"Learn about automations",id:"database.viewSettings.automationTab.learnAutomationTitle"},automationDisabledCaption:{defaultMessage:"Paused",id:"database.viewSettings.automationTab.disabledCaption"},automationEmptyViewEditorPublic:{defaultMessage:"Automatically set status, assignees, property values and more with automations",id:"database.viewSettings.automationTab.automationEmptyViewEditorPublic"},automationEmptyViewReadOnly:{defaultMessage:"You're a content viewer. Content viewers cannot create automations.",id:"database.viewSettings.automationTab.automationEmptyViewReadOnly"},automationEmptyViewContentOnly:{defaultMessage:"You're a content editor. Content editors can edit pages, but cannot create automations.",id:"database.viewSettings.automationTab.automationEmptyViewContentOnly"},automationSearchPlaceholder:{defaultMessage:"Search for an automation…",id:"database.viewSettings.automationTab.automationSearchPlaceholder"}});function vt(e){const{collectionContextStore:t,collectionSettingsStore:o,tabSettings:n}=e,i=(0,te.useIntl)(),u=(0,Fe.D)(),{isMobile:d}=(0,s.Fy)(),[y,h]=(0,r.useState)(""),f=(0,l.VK)((()=>t.collectionStore()),[t]),x=(0,l.VK)((()=>t.collectionViewBlockStore()),[t]),S=(0,l.VK)((()=>f&&f.id),[f]),v=(0,l.VK)((()=>null==f?void 0:f.getSchema()),[f]),b=(0,l.VK)((()=>null==f?void 0:f.getFormat()),[f]),C=(0,l.VK)((()=>function(e){const{collectionStore:t,collectionViewBlockStore:o}=e;if(!t||!o)return[];const n=t.getAutomationStores(),i=[];for(const r of n){var a;const e=r.getModel();null!=e&&e.getAlive()&&((r.isTriggerType("event")||r.isTriggerType("notification_event"))&&(null!==(a=r.getProperties())&&void 0!==a&&a.is_assistant||i.push(r)))}return i}({collectionStore:f,collectionViewBlockStore:x})),[f,x]),M=(0,l.VK)((()=>function(e){const{automationStores:t,collectionSchema:o,intl:n}=e,i=new Map,r=[];for(const a of t){var s;if(!a.isDefined())continue;const e=[],t=a.getName();void 0!==t&&e.push(t);const c=null===(s=a.getOwnerStore())||void 0===s?void 0:s.getDisplayName(n);if(void 0!==c&&e.push(c),a.isTriggerType("event")||a.isTriggerType("notification_event")){const t=a.getEventConfiguration(),i=null==t?void 0:t.pagePropertiesEdited;if("some"===(null==i?void 0:i.type))for(const n of i.some){const t=null==o?void 0:o[n.property];t&&e.push(`${t.name} ${Te.SO[t.type]}`)}const r=a.getActionStores();for(const a of r){const t=a.getType();if(t){const o=(0,p.z)(t);(0,g.Xp)(o)&&e.push(n.formatMessage(o.display.name))}if(a.isType("create_page")||a.isType("update_pages")){var l;const t=a.getConfig();null==t||null===(l=t.properties)||void 0===l||l.forEach((t=>{const n=null==o?void 0:o[t];n&&e.push(`${n.name} ${Te.SO[n.type]}`)}))}}}const u=e.join(" ");i.set(a.id,u),r.push(u)}return function(e){const o=new Set(a().filter(e,r).map((e=>{let{original:t}=e;return t})));return t.filter((0,oe.AO)((e=>{if(!e.isTriggerType("event")&&!e.isTriggerType("notification_event"))return{false:e};const t=i.get(e.id);return t&&o.has(t)?{true:e}:{false:e}})))}}({automationStores:C,collectionSchema:v,intl:i})),[C,v,i]),k=(0,l.VK)((()=>M(y)),[M,y]),P=(0,l.VK)((()=>we.Li({collectionStore:f})),[f]),A=(0,r.useCallback)((()=>{ie.H4({collectionSettingsStore:o,item:{type:"automationCreateSettings"}})}),[o]),w=(0,r.useCallback)((e=>h(e.target.value)),[]),V=(0,r.useCallback)((()=>{u&&S&&m.qu(u,{collection_id:S})}),[u,S]);(0,r.useEffect)((()=>{if(!u||!S)return;const e="collection_table_header"===n.source?{property_type:n.propertyType,source:n.source}:{source:n.source};m.d(u,{...e,collection_id:S}),Ze.default.logEvent("automation_list_view","true")}),[u,S,n]);const[I,F]=r.useState(!1),B=(0,l.VK)((()=>function(e){var t;const o=null===(t=Be.default.state.currentUserStore)||void 0===t?void 0:t.pointer,n=[],i=[];for(const a of e){const e=a.getCreatedByPointer();o&&e&&J.dr.isEqual(o,e)?n.push(a):i.push(a)}return n.sort(((e,t)=>t.getLastEditedTime()-e.getLastEditedTime())),i.sort(((e,t)=>t.getLastEditedTime()-e.getLastEditedTime())),{currentUserAutomations:n,otherUserAutomations:i}}(k)),[k]),Z=(0,r.useMemo)((()=>{const{currentUserAutomations:e,otherUserAutomations:t}=B;return I?[...e,...t]:e.length>0?e:t}),[B,I]),K=k.length-Z.length,_=!I&&K>0,R=Z.length>0,W=!R&&!(""!==y),L=(0,c.yK)((e=>({buttonList:{display:"flex",flexDirection:"column",flexShrink:1,gap:12,overflow:"hidden auto",paddingBlockEnd:d?0:12,paddingBlockStart:d?12:0,paddingInline:12},emptyViewWrap:{paddingBlockEnd:42,paddingInline:12},menuScrollerStyle:{marginBlockStart:d?12:8},wrap:{display:"flex",flexDirection:"column"},showMoreButtonContainer:{marginLeft:12,marginBottom:12,marginRight:"auto"},showMoreButtonContent:{fontSize:12},noResultsTitle:{color:e.text.secondary,fontSize:12,margin:0}})),[d]);return f&&v&&b&&x?(0,He.jsx)(be.ZP,{...e,header:!W&&(0,He.jsx)(je.Z,{children:(0,He.jsx)(Me.ZP,{focusInitial:!d,onChange:w,placeholder:i.formatMessage(St.automationSearchPlaceholder),showClearButton:!0,value:y})}),footer:(0,He.jsxs)(je.Z,{topBorder:!0,children:[P&&(0,He.jsx)(Ce.Z,{icon:T.R,onClick:A,title:i.formatMessage(St.automationNewAutomationTitle),isGray:!0}),(0,He.jsx)(ke.Z,{href:"https://www.notion.so/help/database-automations",external:!0,onClick:V,children:(0,He.jsx)(Ce.Z,{icon:j.m,title:i.formatMessage(St.automationLearnAutomationTitle),isGray:!0})})]}),menuScrollerStyle:L.menuScrollerStyle,title:R||y?i.formatMessage(St.automationTabTitle):null,children:(0,He.jsx)("div",{style:L.wrap,children:W?(0,He.jsx)("div",{style:L.emptyViewWrap,children:(0,He.jsx)(bt,{collectionStore:f})}):(0,He.jsxs)(He.Fragment,{children:[(0,He.jsx)("div",{style:L.buttonList,children:Z.length>0?Z.map(((e,n)=>(0,He.jsx)(Mt,{collectionContextStore:t,collectionStore:f,collectionSettingsStore:o,focused:!1,schema:v,automationStore:e},e.id))):(0,He.jsx)("p",{style:L.noResultsTitle,children:(0,He.jsx)(te.FormattedMessage,{defaultMessage:"No results",id:"collectionSettings.automationsView.noResults"})})}),_&&(0,He.jsx)(Pe.Z,{style:L.showMoreButtonContainer,onClick:e=>{e.stopPropagation(),F(!0)},children:(0,He.jsx)("div",{style:L.showMoreButtonContent,children:(0,He.jsx)(te.FormattedMessage,{id:"collectionSettings.automationsView.showMore",defaultMessage:"Show {number} more",values:{number:K}})})})]})})}):null}function bt(e){const{collectionStore:t}=e,o=(0,s.O7)(),n=(0,c.yK)((e=>({wrap:{alignItems:"center",display:"flex",flexDirection:"column",gap:7.5,justifyContent:"center",minHeight:250,textAlign:"center"},icon:{fill:e.icon.yellow,height:24,width:24},title:{fontSize:17,fontWeight:ne.Z.fontWeight.medium,margin:0},copy:{color:e.text.secondary,fontSize:14,margin:0,lineHeight:1.5}})),[]),i=(0,l.VK)((()=>t.getRole()),[t]);let a;return a=(0,l.VK)((()=>Boolean((0,Ve.IJ)(o,t))),[t,o])||!i||"editor"===i?St.automationEmptyViewEditorPublic:"reader"===i||"comment_only"===i?St.automationEmptyViewReadOnly:"content_only_editor"===i||"read_and_write"===i?St.automationEmptyViewContentOnly:St.automationEmptyViewEditorPublic,(0,He.jsxs)("div",{style:n.wrap,children:[(0,He.jsx)("div",{"aria-hidden":!0,children:(0,M.K)(n.icon)}),(0,He.jsx)("p",{style:n.title,children:(0,He.jsx)(te.FormattedMessage,{...St.automationTabTitle})}),(0,He.jsx)("p",{style:n.copy,children:(0,He.jsx)(te.FormattedMessage,{...a})})]})}const Ct={text:$.p,number:D.J,url:Y.O,file:K.Z,date:B.V,person:N.O,email:Z.n,phone_number:O.u,checkbox:V.r,select:U.w,multi_select:L.A,status:z.T,relation:E.v,rollup:H.G,formula:_.D,created_time:I.I,created_by:F.H,title:q.c,last_edited_time:I.I,last_edited_by:F.H,last_visited_time:I.I,button:z.T,auto_increment_id:R.A,location:W.w,verification:Q.f,ai_summary:b.Y,ai_custom_prompt:P.y,ai_extract:L.A,ai_translate:v.Q,ai_keywords:k.F};function Mt(e){const{automationStore:t,collectionContextStore:o,collectionStore:n,collectionSettingsStore:i,focused:a,schema:c}=e,p=(0,te.useIntl)(),m=(0,s.O7)(),g=(0,ve.X)({automationStore:t,collectionStore:n}),v=(0,l.VK)((()=>!!(n&&t&&g)&&we.qk({automationContextStore:g,automationStore:t,collectionStore:n})),[g,t,n]),b=(0,l.VK)((()=>t.getActionStores()),[t]),M=(0,l.VK)((()=>t.getTriggerStore().getValue()),[t]),k=(0,l.VK)((()=>t.getNameWithDefault(p)),[p,t]),j=(0,l.VK)((()=>t.isActive()),[t]),P=(0,l.VK)((()=>o.aliveAutomationCount.state),[o]),V=(0,l.VK)((()=>we.i1({actionStores:b,automationStore:t})),[b,t]),I=(0,l.VK)((()=>we.qM({automationStore:t})),[t]),F=(0,r.useCallback)((async()=>{await _e.SC({collectionStore:n,environment:m,existingAutomationStore:t,intl:p,onDelete:()=>{1===P&&ie.wl({collectionSettingsStore:i,item:{type:"main"}})}})}),[p,m,n,i,t,P]),B=(0,r.useCallback)((()=>{_e.j3({automationStore:t,collectionStore:n,environment:m})}),[n,m,t]),Z=(0,r.useCallback)((()=>{ie.H4({collectionSettingsStore:i,item:{type:"automationEditSettings",automationId:t.id}})}),[i,t]),K=(0,r.useCallback)((()=>{_e.$K({automationStore:t,collectionStore:n,environment:m})}),[n,m,t]),_=(0,r.useMemo)((()=>M?function(e){const{schema:t,triggerConfig:o}=e;if("notification_event"!==o.type&&"event"!==o.type)return[];const n=[];o.event.pagesAdded&&n.push({color:"blue",icon:T.R,type:"page"});const i=o.event.pagePropertiesEdited;if("any"===i.type)n.push({color:"blue",icon:A.R,type:"misc"});else if("some"===i.type)for(const a of i.some){const e=t[a.property],o=a.filter;if(!e)continue;if(!d.Ym[e.type]){n.push({color:"gray",icon:It(e.type),type:"property"});continue}const i=h.gB(e),r=h.cu(e);if("changes_to_any"===o.operator)n.push({color:i||r?"gray":"blue",icon:It(e.type),type:"property"});else if(i&&!y.mv(o)&&y.r2(o)){const t=y.wB(o);if(t.length>1)n.push({color:"gray",icon:It(e.type),type:"property"});else if(1===t.length){const o=t[0];if("is_group"===o.type){const t=(e.groups??[]).find((e=>e.name===o.value));t&&n.push({color:t.color??"gray",icon:It(e.type),type:"property"})}else{const t=(e.options??[]).find((e=>e.value===o.value));t&&n.push({color:t.color??"gray",icon:It(e.type),type:"property"})}}}else if(r&&!y.mv(o)&&(y.dx(o)||y.NU(o))){const t=y.dx(o)?y.mg(o):y.qC(o);if(1===t.length){const o=t[0],i=(e.options??[]).find((e=>e.value===o.value));i&&n.push({color:i.color??"gray",icon:It(e.type),type:"property"})}else t.length>1&&n.push({color:"gray",icon:It(e.type),type:"property"})}}return n}({schema:c,triggerConfig:M}):[]),[c,M]),R=(0,l.VK)((()=>function(e){const{actionStores:t,collectionStore:o,schema:n}=e,i=[];for(const c of t)if(c.isType("slack_notification"))i.push({icon:w.P,type:"app"});else if(c.isType("update_pages")){const e=c.getConfig(),t=(null==e?void 0:e.properties)??[];if(1===t.length){var a,r;const l=t[0],c=n[l],p=null==e||null===(a=e.values)||void 0===a?void 0:a[l];if(!c||!p)continue;if(!d.SF(c)){i.push({color:"gray",icon:It(c.type),type:"property"});continue}const m=(0,S.A6)(null===(r=p.value)||void 0===r?void 0:r.value);if(h.gB(c)){const e=(c.options||[]).find((e=>e.value===m[0]));e&&i.push({color:e.color??"gray",icon:It(c.type),type:"property"})}else if(h.cu(c))if(1===m.length){const e=(c.options||[]).find((e=>e.value===m[0]));e&&i.push({color:e.color??"gray",icon:It(c.type),type:"property"})}else m.length>1&&i.push({color:"gray",icon:It(c.type),type:"property"});else if(h.KR(c)){var s;const e=(0,f.DW)({textValue:null===(s=p.value)||void 0===s?void 0:s.value,propertySchema:c,blockCreatorPointer:void 0}).map((e=>(0,u.Hl)({pointer:e,getRecordValue:o.getRecordValue})));1===e.length?i.push({actor:e[0],type:"person"}):i.push({color:"gray",icon:It(c.type),type:"property"})}else i.push({color:"gray",icon:It(c.type),type:"property"})}else t.length>1&&i.push({color:"gray",icon:A.R,type:"misc"})}else if(c.isType("create_page")){var l;(null===(l=c.getConfig())||void 0===l?void 0:l.collection)&&i.push({color:"blue",icon:T.R,type:"page"})}else c.isType("send_in_app_notification")&&i.push({color:"blue",icon:C.t,type:"misc"});return i}({actionStores:b,collectionStore:n,schema:c})),[c,n,b]),W=(0,l.VK)((()=>j?g&&function(e){var t,o;const{environment:n,actionStores:i,automationContextStore:a,collectionStore:r,intl:s,schema:l,triggerConfig:c}=e;if(!c||"event"!==c.type&&"notification_event"!==c.type)return;const{event:p}=c,m=[];p.pagesAdded&&m.push(Se.Mz(s));if("none"===p.pagePropertiesEdited.type);else if("any"===p.pagePropertiesEdited.type)m.push(Se.c5(s));else if("some"===p.pagePropertiesEdited.type)for(const u of p.pagePropertiesEdited.some){const e=l[u.property];if(!e){m.push(Se.nf(s));continue}if(!d.Ym[e.type]){m.push((0,ge.K1)({propertySchema:e}));continue}const{filter:t}=u;if("changes_to_any"===t.operator)m.push(Se.$G(s,{propertyName:e.name}));else if(d.bD(e))if("status"===e.type){if(!y.r2(t)||!y.vR(t))continue;const o=y.wB(t),n=(0,xe.L)({intl:s,groupValues:o.map((e=>"is_group"===e.type?e.value:void 0)).filter(oe.$K),isText:!0,optionValues:o.map((e=>"is_option"===e.type?e.value:void 0)).filter(oe.$K),propertySchema:e,tokenFormat:x.lo.Small}),i=s.formatList(n,{style:"long",type:"disjunction"});m.push(Se.VO(s,{propertyName:e.name,propertyValues:i}))}else if("select"===e.type||"multi_select"===e.type){if(y.mv(t)||!y.dx(t)&&!y.NU(t))continue;const o=Array.isArray(t.value)?t.value:[t.value],n=(0,fe.z)({intl:s,isText:!0,optionValues:o.map((e=>e.value)).filter(oe.$K),propertySchema:e,tokenFormat:x.lo.Small}),i=s.formatList(n,{style:"long",type:"disjunction"});m.push(Se.XJ(s,{propertyName:e.name,propertyValues:i}))}else if("checkbox"===e.type){if(!y.XA(t))continue;m.push((0,he.l4)({filter:t,propertySchema:e,intl:s}))}else(0,oe.t1)(e)}const g=s.formatList(m,{style:"long",type:"disjunction"}),h=[];for(const y of i)if(y.isType("slack_notification"))h.push((0,He.jsx)(te.FormattedMessage,{defaultMessage:"notify {channel}",id:"CollectionSettingsAutomationsView.summaryCard.slackAction",values:{channel:(0,He.jsx)(ae.pZ,{actionStore:y})}}));else if(y.isType("update_pages")){const e=y.getConfig(),t=null==e?void 0:e.properties,o=null==e?void 0:e.values,i=null==e?void 0:e.target;if(!t||0===t.length||!i)continue;if("collection"===i.type)if((0,J.qo)(i.collection,r.pointer))h.push((0,He.jsx)(te.FormattedMessage,{defaultMessage:"edit pages in this collection",id:"automation.summaryCard.updatePages.sameCollection"}));else{const e=Ke.NW.createChildStore(r,i.collection),t=(0,Ie.vU)({environment:n,intl:s,store:e});h.push((0,He.jsx)(te.FormattedMessage,{defaultMessage:"edit pages in {collectionTitle}",id:"automation.summaryCard.updatePages.differentCollection",values:{collectionTitle:t}}))}else if("variable"===i.type){const e=t[0],n=l[e],i=null==o?void 0:o[e];if(!n){h.push(Se.aD(s));continue}if(!i)continue;if(d.SF(n))if("person"===n.type)h.push((0,He.jsx)(kt,{collectionStore:r,propertyActionValue:i,propertySchema:n}));else if("status"===n.type){const e=(0,He.jsx)(jt,{propertyActionValue:i,propertySchema:n});e&&h.push(e)}else if("select"===n.type||"multi_select"===n.type)h.push((0,He.jsx)(Pt,{propertyActionValue:i,propertySchema:n}));else if("checkbox"===n.type)h.push((0,He.jsx)(At,{propertyActionValue:i,propertySchema:n}));else if("relation"===n.type)h.push((0,He.jsx)(Tt,{automationContextStore:a,collectionStore:r,propertyActionValue:i,propertySchema:n}));else if("date"===n.type){const t=(0,He.jsx)(wt,{automationContextStore:a,collectionStore:r,propertyActionValue:i,propertyId:e,propertySchema:n});t&&h.push(t)}else"number"===n.type||"phone_number"===n.type||"text"===n.type||"title"===n.type||"email"===n.type||"url"===n.type?h.push((0,He.jsx)(Vt,{automationStore:a.context.automationStore,propertyActionValue:i,propertySchema:n})):(0,oe.t1)(n);else h.push((0,ge.K1)({propertySchema:n}))}}else if(y.isType("create_page")){var f;const e=null===(f=y.getConfig())||void 0===f?void 0:f.collection;if(!e)continue;e.id===r.pointer.id?h.push((0,He.jsx)(te.FormattedMessage,{defaultMessage:"create a page in this database",id:"automation.summaryCard.createPageThisDatabase"})):h.push((0,He.jsx)(te.FormattedMessage,{defaultMessage:"create a page in another database",id:"automation.summaryCard.createPageAnotherDatabase"}))}else if(y.isType("send_in_app_notification")){var S;const e=null===(S=y.getConfig())||void 0===S?void 0:S.target;if(!e)continue;const n=e.type;switch(n){case"formula":const i=(0,ee.lcG)(null===(t=e.value)||void 0===t?void 0:t.value),a=(0,ee.oOk)(null===(o=e.value)||void 0===o?void 0:o.value),l=e=>{const t=y.getSpaceId()??"";return{table:X.KJ,id:e,spaceId:t}},c=i.map((e=>l(e))),d=c.map((e=>(0,u.Hl)({getRecordModel:r.getRecordModel,pointer:e}))).filter(oe.$K).map((e=>(0,u.$4)(s,e)));h.push((0,He.jsx)(te.FormattedMessage,{defaultMessage:"{numTargets, plural, one {send a notification to {singleTarget}} other {send a notification to {numTargets} people}}",values:{numTargets:c.length+a.length,singleTarget:c.length>0?d[0]:Te.SO.created_by},id:"automation.summaryCard.sendNotificationUserTarget"}));break;case"property":if(!e.propertyId)break;let p;const m=r.getSchema()[e.propertyId];p=m?m.name??Te.SO[m.type]:Se.Bo.unknownPropertyTitle.defaultMessage,h.push((0,He.jsx)(te.FormattedMessage,{defaultMessage:"send a notification to {propertyDisplayName}",values:{propertyDisplayName:p},id:"automation.summaryCard.sendNotificationPropertyTarget"}));break;default:(0,oe.t1)(n)}}const v=s.formatList(h,{style:"long",type:"conjunction"});return s.formatMessage({defaultMessage:"When {triggers}, {actions}.",id:"automation.summaryCard.caption"},{actions:v,triggers:g})}({environment:m,actionStores:b,automationContextStore:g,collectionStore:n,intl:p,schema:c,triggerConfig:M}):p.formatMessage(St.automationDisabledCaption)),[j,g,m,b,n,p,c,M]),L=(0,l.VK)((()=>{if(!t.isTriggerType("event")&&!t.isTriggerType("notification_event"))return!0;return!t.getTrigger()||we.vM({automationStore:t,collectionStore:n})}),[t,n]),D=!j||L,N=(0,r.useCallback)((e=>(0,r.createElement)(ut,{...e,key:t.id,actions:R,caption:W,focused:a,hasWarning:D,onClick:Z,onDelete:I?F:void 0,onDisable:j&&I&&v?B:void 0,onEdit:V?Z:void 0,onEnable:!j&&I&&v?K:void 0,title:k,triggers:_})),[R,t.id,V,I,W,a,D,j,v,F,B,Z,K,k,_]);return(0,He.jsx)(ye.y,{caption:W,renderOrigin:N,title:k,tooltipAlignment:Ae.v2.Start,tooltipPlacement:Ae.ug.Bottom})}function kt(e){const{collectionStore:t,propertyActionValue:o,propertySchema:n}=e,i=(0,te.useIntl)(),a=(0,l.VK)((()=>(0,ce.UD)({getRecordModel:t.getRecordModel,propertySchema:n,value:o.value})),[t.getRecordModel,o.value,n]),r=(0,l.VK)((()=>(0,ce.y3)({actors:a,intl:i,propertySchema:n})),[a,i,n]);return r||null}function jt(e){var t;const{propertyActionValue:o,propertySchema:n}=e,i=(0,S.A6)(null===(t=o.value)||void 0===t?void 0:t.value)[0],a=(0,te.useIntl)(),r=(0,pe.LQ)({intl:a,propertySchema:n,value:i});return r||null}function Pt(e){var t,o;const{propertyActionValue:n,propertySchema:i}=e,a=(0,te.useIntl)(),r=null!==(t=n.value)&&void 0!==t&&t.value?(0,S.A6)(null===(o=n.value)||void 0===o?void 0:o.value):[],s=Se.oJ({limit:le.H,propertySchema:i,optionValues:r.map((e=>"string"==typeof e?e:void 0)).filter(oe.$K)});return(0,l.VK)((()=>(0,de.I7)({intl:a,propertySchema:i,values:s})),[a,s,i])}function At(e){const{propertyActionValue:t,propertySchema:o}=e;return(0,re.G7)({propertySchema:o,value:t.value})}function Tt(e){const{automationContextStore:t,collectionStore:o,propertyActionValue:n,propertySchema:i}=e,a=(0,te.useIntl)(),r=(0,s.O7)(),c=n.value,u=(0,l.VK)((()=>t.getAllContextValues()),[t]);return(0,l.VK)((()=>(0,ue.wr)({automationContextValues:u,collectionStore:o,environment:r,intl:a,propertySchema:i,value:c})),[u,o,r,a,i,c])}function wt(e){const{automationContextStore:t,collectionStore:o,propertyActionValue:n,propertyId:i,propertySchema:a}=e,s=(0,te.useIntl)(),c=n.value,u=(0,r.useMemo)((()=>({type:"collection",collectionStore:o,property:i})),[o,i]),d=(0,l.VK)((()=>(0,se.kD)({automationContextStore:t,intl:s,propertySchema:a,value:c,valueContext:u})),[t,s,a,c,u]);return d||null}function Vt(e){const{automationStore:t,propertyActionValue:o,propertySchema:n}=e,i=(0,s.O7)(),a=(0,c.Fg)(),r=(0,l.VK)((()=>(0,me.lG)({automationStore:t,environment:i,propertySchema:n,theme:a,value:o.value})),[t,i,o.value,n,a]);return r||null}function It(e){return(0,oe.$K)(e)?Ct[e]??G.S:G.S}},18441:(e,t,o)=>{o.d(t,{P9:()=>l,YJ:()=>c,jc:()=>s,jg:()=>r});o(57658);var n=o(77657),i=o(59753),a=o(32161);function r(e){if(e.integration_id!==n.nO)throw"Cannot render account for integration.";const t=/(.+) - (.+)/.exec(e.account_name);if(!t)return{accountName:e.account_name};const[,o,i]=t;return{organizationName:o,accountName:i}}function s(e){return i.kk.fromValue(a.PJ,e).getSlackWorkspaceId()}function l(e,t){return t?e.filter((e=>{const o=s(e);return!!o&&t(o)})):e}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const o={};for(const n of e){const{accountName:e,organizationName:i}=r(n);u({query:t,accountName:e,organizationName:i})&&(o[e]||(o[e]=[]),o[e].push({externalAuthentication:n,workspaceName:i}))}return o}function u(e){const{accountName:t,organizationName:o,query:n}=e;if(0===n.length)return!0;const i=t.toLocaleLowerCase().indexOf(n.trim().toLocaleLowerCase())>=0,a=!!o&&o.toLocaleLowerCase().indexOf(n.trim().toLocaleLowerCase())>=0;return i||a}},35314:(e,t,o)=>{o.d(t,{e:()=>r});var n=o(67294),i=o(86628),a=o(77794);function r(){const[e,t]=(0,n.useState)(0),[o]=(0,n.useState)((()=>new a.E)),r=(0,n.createRef)();return(0,n.useEffect)((()=>{if(r.current)return o.observe(r.current),()=>{o.destroy()}}),[r,o]),(0,i.VK)((()=>{e!==o.rect.state.width&&t(o.rect.state.width)}),[e,o.rect]),[r,e]}},58454:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(49085),i=o(92595);class a extends n.default{getInitialState(){return{open:!1}}}const r=new a;(0,i.exposeDebugValue)("AutomationModalStore",r);const s=r},91738:(e,t,o)=>{o.d(t,{Bh:()=>r,H0:()=>s});var n=o(49085),i=o(53965);class a extends n.default{getInitialState(){return{insertionPoint:void 0,stack:[]}}getCurrentTab(){return i.Z$(this.getState().stack)}getInsertionPoint(){return this.getState().insertionPoint}pushSettingsItem(e){this.update((t=>({...t,stack:[...t.stack,e]})))}popSettingsItem(){this.update((e=>({...e,stack:e.stack.slice(0,e.stack.length-1)})))}replaceSettingsItem(e){this.update((t=>{const o=[...t.stack.slice(0,t.stack.length-1),e];return{...t,stack:o}}))}setInsertionPoint(e){this.update((t=>({...t,insertionPoint:e})))}}class r extends a{}class s extends a{}},68016:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(49085),i=o(92595);class a extends n.default{getStateForBot(e){return this.state[e]??{channels:{},fetching:!1,lastRefreshed:0}}updateStateForBot(e,t){this.setState({...this.state,[e]:{...this.getStateForBot(e),...t}})}addChannelsForBot(e,t){const o=this.getStateForBot(e);this.setState({...this.state,[e]:{...o,channels:{...o.channels,...t}}})}}const r=new a;(0,i.exposeDebugValue)("ExternalNotificationChannelsStore",r);const s=r},65955:(e,t,o)=>{o.d(t,{o:()=>a});o(67294);var n=o(45238),i=o(85893);const a=(0,n.IU)("addPage",{viewBox:"0 0 14 14",svg:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 0c3.861 0 7 3.139 7 7s-3.139 7-7 7-7-3.139-7-7 3.139-7 7-7zM3.561 5.295a1.027 1.027 0 1 0 2.054 0 1.027 1.027 0 0 0-2.054 0zm5.557 1.027a1.027 1.027 0 1 1 0-2.054 1.027 1.027 0 0 1 0 2.054zm1.211 2.816a.77.77 0 0 0-.124-1.087.786.786 0 0 0-1.098.107c-.273.407-1.16.958-2.254.958-1.093 0-1.981-.55-2.244-.945a.788.788 0 0 0-1.107-.135.786.786 0 0 0-.126 1.101c.55.734 1.81 1.542 3.477 1.542 1.668 0 2.848-.755 3.476-1.541z"})})},8597:(e,t,o)=>{o.d(t,{Z:()=>a});o(67294);var n=o(45238),i=o(85893);const a=(0,n.IU)("arrowUp",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8 14.5586C8.44434 14.5586 8.74512 14.251 8.74512 13.7998V5.30957L8.69043 3.83984L10.4951 5.84961L12.0469 7.38086C12.1836 7.51074 12.3682 7.59961 12.5801 7.59961C12.9902 7.59961 13.291 7.28516 13.291 6.86816C13.291 6.66992 13.2158 6.49219 13.0586 6.32812L8.55371 1.81641C8.40332 1.66602 8.20508 1.57715 8 1.57715C7.79492 1.57715 7.59668 1.66602 7.44629 1.81641L2.94141 6.32812C2.78418 6.49219 2.70898 6.66992 2.70898 6.86816C2.70898 7.28516 3.0166 7.59961 3.42676 7.59961C3.63184 7.59961 3.82324 7.51074 3.95312 7.38086L5.50488 5.84961L7.30957 3.83301L7.25488 5.30957V13.7998C7.25488 14.251 7.5625 14.5586 8 14.5586Z"})})},82114:(e,t,o)=>{o.d(t,{Q:()=>i,p:()=>a});o(67294);var n=o(45238);const i=(0,o(85893).jsx)("path",{d:"M.911 8.034c0 4.505 3.049 7.24 7.246 7.24 1.135 0 2.215-.158 2.885-.376.472-.15.622-.397.622-.65a.44.44 0 00-.451-.444 1.3 1.3 0 00-.321.048c-.834.205-1.552.341-2.516.341-3.74 0-6.29-2.255-6.29-6.118 0-3.698 2.407-6.275 6.03-6.275 3.206 0 5.886 1.975 5.886 5.523 0 2.072-.697 3.466-1.825 3.466-.752 0-1.176-.437-1.176-1.183V4.972c0-.37-.205-.595-.554-.595-.341 0-.553.226-.553.595v.779h-.062c-.349-.84-1.203-1.374-2.222-1.374-1.77 0-3.014 1.51-3.014 3.678 0 2.187 1.237 3.712 3.042 3.712 1.06 0 1.88-.575 2.276-1.545h.062c.13.963.943 1.551 2.023 1.551 1.907 0 3.09-1.873 3.09-4.498 0-3.971-2.92-6.548-6.96-6.548C3.886.727.912 3.632.912 8.034zm6.911 2.652c-1.223 0-2.003-1.018-2.003-2.638 0-1.593.786-2.611 2.01-2.611 1.258 0 2.05.998 2.05 2.584 0 1.62-.813 2.665-2.057 2.665z"}),a=(0,n.IU)("at",{viewBox:"0 0 16 16",svg:i})},64275:(e,t,o)=>{o.d(t,{D:()=>a});o(67294);var n=o(45238),i=o(85893);const a=(0,n.IU)("closeSmall",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M3.732 11.052c-.303.308-.32.877.011 1.202.33.33.894.32 1.203.011L8 9.21l3.05 3.05c.32.325.872.32 1.197-.011a.857.857 0 00.01-1.197L9.21 8.002l3.05-3.056a.857.857 0 00-.01-1.197.857.857 0 00-1.198-.01L8 6.788 4.946 3.732c-.31-.303-.878-.32-1.203.01-.325.331-.314.895-.01 1.203l3.055 3.056-3.056 3.05z"})})},50780:(e,t,o)=>{o.d(t,{E:()=>a});o(67294);var n=o(45238),i=o(85893);const a=(0,n.IU)("editPropertyType",{viewBox:"0 0 16 16 ",svg:(0,i.jsx)("path",{d:"M11.5615 4.84473L12.2998 4.11328C12.6689 3.74414 12.6826 3.34082 12.3545 3.00586L12.0879 2.73926C11.7529 2.4043 11.3428 2.43848 10.9736 2.79395L10.2354 3.52539L11.5615 4.84473ZM3.22168 13.1641L10.9053 5.4873L9.59277 4.16797L1.90918 11.8516L1.23926 13.4512C1.16406 13.6562 1.37598 13.875 1.57422 13.7998L3.22168 13.1641ZM3.92578 13.8066H14.1045C14.4736 13.8066 14.7744 13.499 14.7744 13.1367C14.7744 12.7676 14.4736 12.4668 14.1045 12.4668H5.27246L3.92578 13.8066Z"})})},1230:(e,t,o)=>{o.d(t,{H:()=>a});o(67294);var n=o(45238),i=o(85893);const a=(0,n.IU)("insertDown",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M9.55548 13.0343H14.2085C14.5315 13.0343 14.7951 13.2913 14.7951 13.6142C14.7951 13.9372 14.5315 14.1942 14.2085 14.1942H9.55548C9.23254 14.1942 8.9755 13.9372 8.9755 13.6142C8.9755 13.2913 9.23254 13.0343 9.55548 13.0343ZM1.21167 9.67959C1.21167 9.09961 1.52802 8.74371 2.0421 8.74371C2.55617 8.74371 2.87911 9.11279 2.87911 9.65982V10.7868C2.87911 10.945 2.96479 11.0373 3.12956 11.0373H4.70473V10.365C4.70473 9.818 5.26494 9.60709 5.68675 9.94322L7.56509 11.4525C7.84849 11.6766 7.84849 12.0786 7.56509 12.2961L5.68675 13.812C5.25176 14.1679 4.70473 13.9569 4.70473 13.3836V12.7047H2.93184C1.89051 12.7047 1.21167 12.0984 1.21167 11.057V9.67959ZM9.55548 9.58073H14.2085C14.5315 9.58073 14.7951 9.83777 14.7951 10.1607C14.7951 10.4837 14.5315 10.7407 14.2085 10.7407H9.55548C9.23254 10.7407 8.9755 10.4837 8.9755 10.1607C8.9755 9.83777 9.23254 9.58073 9.55548 9.58073ZM1.78506 6.12721H14.2085C14.5315 6.12721 14.7951 6.38425 14.7951 6.70719C14.7951 7.03014 14.5315 7.28717 14.2085 7.28717H1.78506C1.46211 7.28717 1.20508 7.03014 1.20508 6.70719C1.20508 6.38425 1.46211 6.12721 1.78506 6.12721ZM1.78506 2.68028H14.2085C14.5315 2.68028 14.7951 2.93073 14.7951 3.25367C14.7951 3.5832 14.5315 3.83365 14.2085 3.83365H1.78506C1.46211 3.83365 1.20508 3.5832 1.20508 3.25367C1.20508 2.93073 1.46211 2.68028 1.78506 2.68028Z"})})},41490:(e,t,o)=>{o.d(t,{F:()=>a});o(67294);var n=o(45238),i=o(85893);const a=(0,n.IU)("insertUp",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M9.55566 3.61987H14.2095C14.5325 3.61987 14.7961 3.36279 14.7961 3.03979C14.7961 2.7168 14.5325 2.45972 14.2095 2.45972H9.55566C9.23267 2.45972 8.97559 2.7168 8.97559 3.03979C8.97559 3.36279 9.23267 3.61987 9.55566 3.61987ZM1.21045 6.9751C1.21045 7.55518 1.52686 7.91113 2.04102 7.91113C2.55518 7.91113 2.87817 7.54199 2.87817 6.99487V5.86768C2.87817 5.70947 2.96387 5.61719 3.12866 5.61719H4.7041V6.28955C4.7041 6.83667 5.2644 7.04761 5.68628 6.71143L7.56494 5.2019C7.84839 4.97778 7.84839 4.57568 7.56494 4.35815L5.68628 2.84204C5.25122 2.48608 4.7041 2.69702 4.7041 3.27051V3.94946H2.93091C1.8894 3.94946 1.21045 4.55591 1.21045 5.59741V6.9751ZM9.55566 7.07397H14.2095C14.5325 7.07397 14.7961 6.81689 14.7961 6.4939C14.7961 6.1709 14.5325 5.91382 14.2095 5.91382H9.55566C9.23267 5.91382 8.97559 6.1709 8.97559 6.4939C8.97559 6.81689 9.23267 7.07397 9.55566 7.07397ZM1.78394 10.5281H14.2095C14.5325 10.5281 14.7961 10.271 14.7961 9.948C14.7961 9.625 14.5325 9.36792 14.2095 9.36792H1.78394C1.46094 9.36792 1.20386 9.625 1.20386 9.948C1.20386 10.271 1.46094 10.5281 1.78394 10.5281ZM1.78394 13.9756H14.2095C14.5325 13.9756 14.7961 13.7251 14.7961 13.4021C14.7961 13.0725 14.5325 12.822 14.2095 12.822H1.78394C1.46094 12.822 1.20386 13.0725 1.20386 13.4021C1.20386 13.7251 1.46094 13.9756 1.78394 13.9756Z"})})},38715:(e,t,o)=>{o.d(t,{N:()=>a});o(67294);var n=o(45238),i=o(85893);const a=(0,n.IU)("save",{viewBox:"0 0 16 16",svg:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("path",{d:"M7.99316 10.8877C8.16406 10.8877 8.31445 10.833 8.47168 10.6758L10.7686 8.46094C10.8848 8.34473 10.9463 8.22168 10.9463 8.05762C10.9463 7.74316 10.6934 7.51074 10.3857 7.51074C10.2285 7.51074 10.0713 7.5791 9.96191 7.70215L8.99805 8.7207L8.56055 9.21973L8.62891 8.20801V1.11914C8.62891 0.78418 8.3418 0.49707 7.99316 0.49707C7.65137 0.49707 7.36426 0.78418 7.36426 1.11914V8.20801L7.43262 9.22656L6.98828 8.7207L6.03125 7.70215C5.92188 7.5791 5.75781 7.51074 5.60059 7.51074C5.29297 7.51074 5.04004 7.74316 5.04004 8.05762C5.04004 8.22168 5.1084 8.34473 5.22461 8.46094L7.52148 10.6758C7.67871 10.833 7.8291 10.8877 7.99316 10.8877ZM4.0625 15.3174H11.9307C13.4072 15.3174 14.1729 14.5586 14.1729 13.1025V6.36914C14.1729 4.91309 13.4072 4.1543 11.9307 4.1543H10.0781V5.49414H11.8486C12.4775 5.49414 12.833 5.82227 12.833 6.48535V12.9863C12.833 13.6494 12.4775 13.9775 11.8486 13.9775H4.14453C3.50879 13.9775 3.16016 13.6494 3.16016 12.9863V6.48535C3.16016 5.82227 3.50879 5.49414 4.14453 5.49414H5.92871V4.1543H4.0625C2.58594 4.1543 1.82031 4.91309 1.82031 6.36914V13.1025C1.82031 14.5586 2.58594 15.3174 4.0625 15.3174Z"})})})},95094:(e,t,o)=>{o.d(t,{p:()=>a});o(67294);var n=o(45238),i=o(85893);const a=(0,n.IU)("starFilled",{viewBox:"0 0 24 24",svg:(0,i.jsx)("path",{d:"M4.603 22.837c.375.277.826.2 1.4-.22l6.002-4.411 6.003 4.41c.561.42 1.024.498 1.387.221.375-.276.463-.73.232-1.403l-2.346-7.075 6.047-4.366c.572-.41.77-.83.627-1.271-.143-.432-.55-.653-1.255-.653l-7.424.045-2.269-7.108C12.787.32 12.457 0 12.005 0c-.463 0-.782.32-1.002 1.006l-2.27 7.108-7.423-.045c-.716 0-1.123.221-1.266.653-.144.442.066.862.638 1.27l6.036 4.367-2.335 7.075c-.231.674-.143 1.127.22 1.403z"})})},73201:(e,t,o)=>{o.d(t,{w:()=>a});o(67294);var n=o(45238),i=o(85893);const a=(0,n.IU)("typesLocation",{viewBox:"0 0 25 25",svg:(0,i.jsxs)("g",{children:[(0,i.jsx)("path",{d:"M12.105 24.21C18.7369 24.21 24.2121 18.7273 24.2121 12.105C24.2121 5.47312 18.7273 0 12.0954 0C5.47523 0 0 5.47312 0 12.105C0 18.7273 5.48484 24.21 12.105 24.21ZM12.105 21.8255C6.71085 21.8255 2.39412 17.4991 2.39412 12.105C2.39412 6.71085 6.70124 2.38452 12.0954 2.38452C17.4895 2.38452 21.8276 6.71085 21.8276 12.105C21.8276 17.4991 17.4991 21.8255 12.105 21.8255Z"}),(0,i.jsx)("path",{d:"M6.75703 16.5939C6.75703 17.4355 7.28742 17.9479 8.17266 17.9479H16.0416C16.9247 17.9479 17.4476 17.4355 17.4476 16.5939V12.0109L12.4683 7.82758C12.236 7.63047 11.9686 7.64008 11.7363 7.82758L6.75703 12.0013V16.5939ZM13.6692 16.7148H10.5429V12.9969C10.5429 12.7178 10.7283 12.5366 11.0128 12.5366H13.2014C13.4977 12.5366 13.6692 12.7178 13.6692 12.9969V16.7148ZM4.81055 11.2199C4.81055 11.5316 5.04469 11.8138 5.43211 11.8138C5.62593 11.8138 5.78554 11.7083 5.9271 11.5806L11.8111 6.65687C12.0145 6.47477 12.2093 6.49609 12.4052 6.65687L18.2775 11.5806C18.4383 11.7083 18.5883 11.8138 18.7725 11.8138C19.1194 11.8138 19.3941 11.5818 19.3941 11.2391C19.3941 11.0315 19.3228 10.873 19.1653 10.7336L13.0078 5.5661C12.4605 5.10508 11.7558 5.10508 11.2181 5.5661L5.03929 10.7357C4.89141 10.8751 4.81055 11.0507 4.81055 11.2199ZM15.8079 8.35282L17.4623 9.75391V6.88399C17.4623 6.62618 17.3004 6.44501 17.033 6.44501H16.249C15.9912 6.44501 15.8079 6.62618 15.8079 6.88399V8.35282Z"})]})})}}]);