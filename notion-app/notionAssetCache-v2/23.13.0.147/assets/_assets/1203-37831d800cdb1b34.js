"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[1203],{20993:(e,t,n)=>{n.d(t,{Z:()=>f,a:()=>b});var o=n(30120),a=n(67294),s=n(86628),i=n(24405),r=n(60897),c=n(9291),u=n(37810),l=n(35253),d=n(91376),p=n(21051),m=n(88893),y=n(91754),v=n(85893);function b(){const e=(0,i.yK)((e=>({bannerContent:{alignItems:"center",display:"flex",flexWrap:"wrap",gap:6,justifyContent:"space-between",padding:"12px 6px",whiteSpace:"normal",width:"100%",lineHeight:1.35},callToAction:{cursor:"pointer",fontWeight:u.Z.fontWeight.semibold}})),[]);return(0,v.jsxs)("div",{style:e.bannerContent,children:[(0,v.jsx)("div",{children:(0,v.jsx)(c.FormattedMessage,{id:"app.banner.trial_subscription.add_payment_method",defaultMessage:"Add a payment method to continue using your free trial. You will not be charged until the end of your trial period."})}),(0,v.jsx)("div",{style:e.callToAction,onClick:()=>d.r$({currentTab:"billing"}),children:(0,v.jsx)(c.FormattedMessage,{id:"app.banner.trial_subscription.add_payment_method.call_to_action",defaultMessage:"Add payment method"})})]})}function f(e){const{subscriptionDataStore:t}=e,{showBanner:n}=(0,s.VK)((()=>{const e=m.XX(t.state);return e&&e.trialEnd?r.Sf.includes(e.plan)||e.paymentMethodType?{showBanner:!1}:{showBanner:o.ou.now()>o.ou.fromSeconds(e.trialEnd).minus({days:15})}:{showBanner:!1}}),[t]);return a.useEffect((()=>(n?l.Bw({bannerStore:p.Z,id:"SubscriptionTrialAddPaymentMethodBanner",contentKey:"subscription_trial_add_payment_method",styleKey:y.v.Yellow,prepend:!0}):l.qL({bannerStore:p.Z,id:"SubscriptionTrialAddPaymentMethodBanner"}),()=>{l.qL({bannerStore:p.Z,id:"SubscriptionTrialAddPaymentMethodBanner"})})),[n]),null}},1404:(e,t,n)=>{n.d(t,{Z:()=>O,k:()=>W});var o=n(30120),a=n(67294),s=n(480),i=n(86628),r=n(24405),c=n(92595),u=n(26929),l=n(9291),d=n(1898),p=n(37810),m=n(86572),y=n(35253),v=n(91376),b=n(91754),f=(n(95477),n(48779)),g=n(80444),_=n(21051),w=n(70060),h=n(88893),x=n(88280),S=n(85893);const T={updatePaymentMethod:(0,S.jsx)(l.FormattedMessage,{id:"subscription.payment_status_banner.update_payment_method",defaultMessage:"View unpaid invoice"}),viewWorkspaceOwner:(0,S.jsx)(l.FormattedMessage,{id:"subscription.payment_status_banner.view_workspace_owner",defaultMessage:"View workspace owner"}),confirmPayment:(0,S.jsx)(l.FormattedMessage,{id:"subscription.payment_status_banner.confirm_payment",defaultMessage:"Confirm payment"})};function k(e){const{messageType:t,overdueInvoiceCount:n=1}=e;switch(t){case"past_due_owner":return(0,S.jsx)(l.FormattedMessage,{id:"subscription.payment_status_banner.payment_failed.past_due.workspace_owner",defaultMessage:"We couldn’t process {overdueInvoiceCount, plural, one {your last payment} other {{overdueInvoiceCount} payments}}. Please update your payment method or you may lose access to Notion soon.",values:{overdueInvoiceCount:n}});case"past_due_member":return(0,S.jsx)(l.FormattedMessage,{id:"subscription.payment_status_banner.payment_failed.past_due.member",defaultMessage:"Please contact a workspace owner to update your payment method or you may lose access to Notion soon."});case"unpaid_owner":return(0,S.jsx)(l.FormattedMessage,{id:"subscription.payment_status_banner.payment_failed.unpaid.workspace_owner",defaultMessage:"Access to Notion is limited to viewing because we couldn’t process {overdueInvoiceCount, plural, one {your last payment} other {{overdueInvoiceCount} payments}}. Update your payment information to restore full access.",values:{overdueInvoiceCount:n}});case"unpaid_member":return(0,S.jsx)(l.FormattedMessage,{id:"subscription.payment_status_banner.payment_failed.unpaid.member",defaultMessage:"Access to Notion is limited to viewing. Contact a workspace owner to update your workspace’s payment method."});default:(0,d.t1)(t)}}function C(e){const{messageType:t,overdueInvoiceCount:n=1}=e;switch(t){case"past_due_owner":return(0,S.jsx)(l.FormattedMessage,{id:"subscription.payment_status_banner.confirmation_required.past_due.workspace_owner",defaultMessage:"Please confirm {overdueInvoiceCount, plural, one {your subscription payment} other {{overdueInvoiceCount} payments}} or you may lose access to Notion soon.",values:{overdueInvoiceCount:n}});case"unpaid_owner":return(0,S.jsx)(l.FormattedMessage,{id:"subscription.payment_status_banner.confirmation_required.unpaid.workspace_owner",defaultMessage:"Access to Notion is limited to viewing. Confirm {overdueInvoiceCount, plural, one {your subscription payment} other {{overdueInvoiceCount} payments}} to restore full access.",values:{overdueInvoiceCount:n}});case"unpaid_member":return(0,S.jsx)(l.FormattedMessage,{id:"subscription.payment_status_banner.confirmation_required.unpaid.member",defaultMessage:"Access to Notion is limited to viewing. Contact a workspace owner to update your workspace’s payment method."});default:(0,d.t1)(t)}}function I(){const e=(0,s.O7)();return(0,i.VK)((()=>{var t,n;if(!(0,w.IC)())return;const a=null===(t=g.default.state.currentSpaceStore)||void 0===t?void 0:t.getOverdueSubscription();if(!a)return;const s=(0,h.aS)(x.subscriptionDataStoreInstance.state),i=null==s||null===(n=s.testClock)||void 0===n?void 0:n.frozen_time,r=i?o.ou.fromSeconds(i):o.ou.now(),c=u.cS({now:r,overdueSubscription:a});if("paid"===c.paymentStatus)return;return{overdueSubscription:a,isWorkspaceOwner:(0,f.Fn)(e),paymentStatusWithReason:c}}),[e])}function j(){return()=>{v.r$()}}function M(e){if(void 0!==e)return()=>{e&&window.open(e,"_blank")}}function A(e){const{overdueSubscription:t,isWorkspaceOwner:n,paymentStatusWithReason:o}=e,{invoiceHostedUrl:a,overdueInvoiceCount:s}=t,{paymentStatus:i}=o;switch(i){case"past_due":return function(e){const{isWorkspaceOwner:t,invoiceHostedUrl:n,overdueInvoiceCount:o}=e,a=b.v.Yellow;return t?{bannerStyleKey:a,messageType:"past_due_owner",messageText:k({overdueInvoiceCount:o,messageType:"past_due_owner"}),callToActionText:T.updatePaymentMethod,callToActionHandler:M(n)}:{bannerStyleKey:a,messageType:"past_due_member",messageText:k({overdueInvoiceCount:o,messageType:"past_due_member"}),callToActionText:T.viewWorkspaceOwner,callToActionHandler:j()}}({isWorkspaceOwner:n,invoiceHostedUrl:a,overdueInvoiceCount:s});case"unpaid":return function(e){const{isWorkspaceOwner:t,invoiceHostedUrl:n,overdueInvoiceCount:o}=e,a=b.v.LightRed;return t?{bannerStyleKey:a,messageType:"unpaid_owner",messageText:k({overdueInvoiceCount:o,messageType:"unpaid_owner"}),callToActionText:T.updatePaymentMethod,callToActionHandler:M(n)}:{bannerStyleKey:a,messageType:"unpaid_member",messageText:k({overdueInvoiceCount:o,messageType:"unpaid_member"}),callToActionText:T.viewWorkspaceOwner,callToActionHandler:j()}}({isWorkspaceOwner:n,invoiceHostedUrl:a,overdueInvoiceCount:s});case"paid":return;default:(0,d.t1)(i)}}function K(e){const{overdueSubscription:t,isWorkspaceOwner:n,paymentStatusWithReason:o}=e,{invoiceHostedUrl:a}=t,{paymentStatus:s}=o;switch(s){case"past_due":return function(e,t,n){if(e)return{bannerStyleKey:b.v.Yellow,messageType:"past_due_owner",messageText:C({overdueInvoiceCount:n,messageType:"past_due_owner"}),callToActionText:T.confirmPayment,callToActionHandler:M(t)}}(n,a);case"unpaid":return function(e,t,n){const o=b.v.LightRed;return e?{bannerStyleKey:o,messageType:"unpaid_owner",messageText:C({overdueInvoiceCount:n,messageType:"unpaid_owner"}),callToActionText:T.confirmPayment,callToActionHandler:M(t)}:{bannerStyleKey:o,messageType:"unpaid_member",messageText:C({overdueInvoiceCount:n,messageType:"unpaid_member"}),callToActionText:T.viewWorkspaceOwner,callToActionHandler:j()}}(n,a);case"paid":return;default:(0,d.t1)(s)}}function B(e){if(void 0===e)return;const{overdueReason:t}=e.overdueSubscription;if(t)switch(t){case"payment_failed":return A(e);case"confirmation_required":return K(e);default:(0,d.t1)(t)}}function W(){var e;const t=I(),n=(0,a.useMemo)((()=>B(t)),[t]),o=null==n?void 0:n.messageType,i=null==n?void 0:n.callToActionText,c=null==n?void 0:n.callToActionHandler,u=(0,s.O7)(),l=(0,r.yK)((e=>({bannerContent:{alignItems:"center",display:"flex",flexWrap:"wrap",gap:6,justifyContent:"space-between",padding:"12px 6px",whiteSpace:"normal",width:"100%",lineHeight:1.35},callToAction:{cursor:"pointer",fontWeight:p.Z.fontWeight.semibold}})),[]),d=null==t||null===(e=t.overdueSubscription)||void 0===e?void 0:e.overdueReason,y=(0,a.useCallback)((e=>{void 0!==c&&c(e),o&&m.j(u,{name:"payment_status_banner_action",args:{overdueReason:d,messageType:o}})}),[u,c,o,d]);return n?(0,S.jsxs)("div",{style:l.bannerContent,children:[(0,S.jsx)("div",{children:n.messageText}),void 0!==c?(0,S.jsx)("div",{style:l.callToAction,onClick:y,children:i}):null]}):null}function O(){const e=(0,s.O7)(),t=I(),n=(0,a.useMemo)((()=>B(t)),[t]);return a.useEffect((()=>(["local","development","staging"].includes("production")&&(0,c.exposeDebugValue)("paymentStatus",t),void 0===n||void 0===t?y.qL({bannerStore:_.Z,id:"SubscriptionPaymentStatusBanner"}):(y.Bw({bannerStore:_.Z,id:"SubscriptionPaymentStatusBanner",contentKey:"subscription_payment_status",styleKey:n.bannerStyleKey,prepend:!0}),m.j(e,{name:"payment_status_banner_displayed",args:{overdueReason:t.overdueSubscription.overdueReason,messageType:n.messageType}})),()=>{y.qL({bannerStore:_.Z,id:"SubscriptionPaymentStatusBanner"})})),[e,n,t]),null}},67181:(e,t,n)=>{n.d(t,{T:()=>f,Z:()=>g});var o=n(67294),a=n(480),s=n(86628),i=n(24405),r=n(9291),c=n(1898),u=n(86572),l=n(35253),d=n(91754),p=n(80444),m=n(80148),y=n(21051),v=n(6258),b=n(85893);function f(){const e=(0,a.O7)(),t=(0,s.VK)((()=>e.currentUser.id),[e]),n=(0,i.yK)((e=>({bannerContent:{alignItems:"center",display:"flex",flexWrap:"wrap",gap:6,justifyContent:"space-between",padding:"12px 6px",whiteSpace:"normal",width:"100%",lineHeight:1.35}})),[]),o=(0,s.VK)((()=>p.default.state.currentSpaceStore),[]),u=(0,s.VK)((()=>m.Z.state.visible_banners),[]),l=(0,s.VK)((()=>{if(!o||!t)return null;const e=o.getModel();if(u&&u.length>0){const n=u[0],a=v.$I.createChildStore(o,{id:n,table:"subscription_banner",spaceId:o.id});if(!a.isDefined())return null;const s=a.getBannerText();if(s)return(0,b.jsx)("span",{children:s});const i=!(!e||!e.userIdIsAdmin(t));return function(e,t){switch(e){case"uncollectible_past_due":return t?(0,b.jsx)(r.FormattedMessage,{id:"subscription.payment_uncollectible.past_due.workspace_owner",defaultMessage:"Your workspace may lose editing capabilities soon due to past-due invoices. Please remit payment to avoid losing access to Notion. If you have any questions, please reach out to billing@makenotion.com."}):(0,b.jsx)(r.FormattedMessage,{id:"subscription.payment_uncollectible.past_due.member",defaultMessage:"Your workspace may lose editing capabilities soon due to past-due invoices. Please remit payment to avoid losing access to Notion. If you have any questions, please reach out to billing@makenotion.com."});case"uncollectible_unpaid":return t?(0,b.jsx)(r.FormattedMessage,{id:"subscription.payment_uncollectible.unpaid.workspace_owner",defaultMessage:"Your workspace is unable to edit due to past-due invoices. Please remit payment to avoid losing access to Notion. If you have any questions, please reach out to billing@makenotion.com."}):(0,b.jsx)(r.FormattedMessage,{id:"subscription.payment_uncollectible.unpaid.member",defaultMessage:"Your workspace is unable to edit due to past-due invoices. Please remit payment to avoid losing access to Notion. If you have any questions, please reach out to billing@makenotion.com."});default:(0,c.t1)(e)}}(a.getBannerKey(),i)}return null}),[o,t,u]);return l?(0,b.jsx)("div",{style:n.bannerContent,children:(0,b.jsx)("div",{children:l})}):null}function g(){const e=(0,a.O7)(),t=(0,s.VK)((()=>p.default.state.currentSpaceStore),[]),n=(0,s.VK)((()=>m.Z.state.visible_banners),[]),[i,r,b,f,g]=(0,s.VK)((()=>{if(!t)return[];if(n&&n.length>0){const e=n[0],o=v.$I.createChildStore(t,{id:e,table:"subscription_banner",spaceId:t.id});if(!o.isDefined())return[];const a=o.getBannerKey(),s=o.getAudience(),i=o.getBannerText();switch(a){case"uncollectible_past_due":return[e,d.v.Yellow,a,s,i];case"uncollectible_unpaid":return[e,d.v.LightRed,a,s,i];default:(0,c.t1)(a)}}return[]}),[t,n]);return o.useEffect((()=>{if(i&&r){if(l.Bw({bannerStore:y.Z,id:"SubscriptionUncollectibleBanner",contentKey:"subscription_uncollectible",styleKey:r,prepend:!0}),b&&f){const t={banner:b,audience:f,text:""};g&&(t.text=g),u.j(e,{name:"subscription_uncollectible_banner_displayed",args:t})}}else l.qL({bannerStore:y.Z,id:"SubscriptionUncollectibleBanner"});return()=>{l.qL({bannerStore:y.Z,id:"SubscriptionUncollectibleBanner"})}}),[e,i,r,b,f,g]),null}},59260:(e,t,n)=>{n.d(t,{U:()=>w,Z:()=>h});var o=n(30120),a=n(67294),s=n(480),i=n(86628),r=n(24405),c=n(37850),u=n(1898),l=n(54642),d=n(35253),p=(n(47307),n(91754)),m=n(68785),y=(n(95477),n(80444)),v=n(21051),b=n(81023),f=n(88893),g=n(88280),_=n(85893);function w(){const{testClock:e,billingInterval:t}=(0,i.VK)((()=>{const e=g.subscriptionDataStoreInstance.state,t=f.aS(e);return t?{testClock:t.testClock,billingInterval:t.interval}:{testClock:void 0,billingInterval:void 0}}),[]),n=(0,i.VK)((()=>{var e;return null===(e=y.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),[d,p]=(0,a.useState)(1),[v,w]=(0,a.useState)("second"),[h,S]=(0,a.useState)(!1),T=(0,s.O7)(),k=(0,r.yK)((e=>({bannerContent:{alignItems:"center",display:"flex",gap:6,justifyContent:"space-between",padding:"12px 6px",whiteSpace:"normal",width:"100%",lineHeight:1.35},message:{flexGrow:1,textWrap:"wrap"}})),[]);if(!e||!t||!n)return null;const C=o.ou.fromSeconds(e.frozen_time);return(0,_.jsxs)("div",{style:k.bannerContent,children:[(0,_.jsxs)("div",{style:k.message,children:["The clock time is currently frozen at ",C.toLocaleString(o.ou.DATETIME_FULL),h?(0,_.jsx)(m.Z,{}):null]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("input",{disabled:h,type:"number",value:d,style:{width:75,textAlign:"right"},onChange:e=>p(parseInt(e.target.value))}),(0,_.jsxs)("select",{disabled:h,value:v,onChange:e=>{w(e.target.value)},children:[(0,_.jsx)("option",{value:"seconds",children:"seconds"}),(0,_.jsx)("option",{value:"minutes",children:"minutes"}),(0,_.jsx)("option",{value:"hours",children:"hours"}),(0,_.jsx)("option",{value:"days",children:"days"}),(0,_.jsx)("option",{value:"months",children:"months"}),(0,_.jsx)("option",{value:"years",disabled:"year"!==t,children:"years"})]}),(0,_.jsx)("button",{disabled:h,onClick:async()=>{const e=o.nL.fromObject({[v]:d}),a=function(e){switch(e){case"month":return o.nL.fromObject({months:2});case"year":return o.nL.fromObject({years:2});default:(0,u.t1)(e)}}(t);if(e>a)return void x(`Cannot advance test clock by more than two billing intervals. The current billing interval is ${t}.`);S(!0);"success"===(await l.stripeAdvanceTestClock(T,{spaceId:n,epochSeconds:C.plus(e).toSeconds()})).type?await async function(e,t){let n=await l.stripeGetTestClock(e,{spaceId:t});for(;"success"===n.type&&"advancing"===n.data.status;)await(0,c.Vs)(1e3),n=await l.stripeGetTestClock(e,{spaceId:t});if("failed"===n.type)return void x("Test clock poll request failed. Refresh page to see updated time.");switch(n.data.status){case"ready":await b.bi(e);break;case"advancing":x("Test clock still advancing");break;case"internal_failure":x("Test clock internal failure");break;case void 0:x("Test clock undefined");break;default:(0,u.t1)(n.data.status)}}(T,n):x("Failed to advance test clock. Check server logs for details."),S(!1)},children:"Advance clock"})]})]})}function h(){const e=(0,i.VK)((()=>{const e=g.subscriptionDataStoreInstance.state,t=f.aS(e);return f.DB(e)&&Boolean(null==t?void 0:t.testClock)}),[]);return a.useEffect((()=>(e?d.Bw({bannerStore:v.Z,id:"TestClockBanner",contentKey:"test_clock",styleKey:p.v.Yellow,prepend:!0}):d.qL({bannerStore:v.Z,id:"TestClockBanner"}),()=>{d.qL({bannerStore:v.Z,id:"TestClockBanner"})})),[e]),null}function x(e){}}}]);