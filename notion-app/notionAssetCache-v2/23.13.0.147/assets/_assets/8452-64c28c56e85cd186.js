"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[8452],{16091:(e,t,s)=>{s.d(t,{ND:()=>P,RD:()=>w,gc:()=>R,gl:()=>T,u7:()=>k});var n=s(67294),r=s(36769),i=s(480),o=s(86628),a=s(41432),l=s(9291),d=s(11969),c=s(13447),u=s(37181),h=s(81415),p=(s(95477),s(19124)),g=s(68056),m=s(89086),f=s(28685),v=s(80444),x=s(77080),S=s(83212),y=s(6258),b=s(24666),C=s(47449),M=s(89626),j=s(85893);const I=(0,l.defineMessages)({spaceForAiHeader:{id:"AiOnboardingTooltips.spaceForAi.header",defaultMessage:"Press ‘space’ for AI"},spaceForAiContent:{id:"AiOnboardingTooltips.spaceForAi.content",defaultMessage:"On a new line or page, press ‘space’ on your keyboard for AI to generate or edit the page. Try it now!"},askAiAnythingHeader:{id:"AiOnboardingTooltips.askAiAnything.header",defaultMessage:"Ask AI anything"},askAiAnythingContent:{id:"AiOnboardingTooltips.askAiAnything.content",defaultMessage:"Just tell AI what to do — the more details, the better. You can also start from an example in the menu."},refineAiResponseHeader:{id:"AiOnboardingTooltips.refineAiResponse.header",defaultMessage:"Tell AI what to do next"},refineAiResponseContent:{id:"AiOnboardingTooltips.refineAiResponse.content",defaultMessage:"How was it? Give AI further instructions to improve what it wrote, or hit ‘Done’ when finished."},showAssistantLocationHeader:{id:"AiOnboardingTooltips.showAssistantLocation.answersToYourQuestionHeader",defaultMessage:"Ask AI when searching"},showAssistantLocationContent:{id:"AiOnboardingTooltips.showAssistantLocation.askQuestionBody",defaultMessage:"AI can find pages and synthesize a quick, concise answer for you. Try it now."},showAssistantOriginElementLocationHeader:{id:"AiOnboardingTooltips.ShowAssistantOriginElementLocationTooltip.header",defaultMessage:"Start by asking a question"},showAssistantOriginElementLocationContent:{id:"AiOnboardingTooltips.ShowAssistantOriginElementLocationTooltip.content",defaultMessage:"Notion AI will find pages and compose a concise answer for you. Try it now."}});function k(){const e=(0,i.O7)(),t=function(){const e=(0,i.O7)(),t=(0,o.VK)((()=>{const t=v.default.state.mainEditorCurrentBlockStore;return t&&S.Z.getMode(e,t)}),[e]);return(0,o.VK)((()=>{if(e.device.isMobile)return;if(!x.default.checkGate("space_for_ai_tooltip_enabled"))return;const{currentUserSettingsStore:s,inAppCalloutStore:n}=v.default.state;if(!n.canShow("ai_onboarding_tooltip"))return;const r=null==s?void 0:s.getSettings();if(!r)return;if(r.signup_time&&r.signup_time>16770636e5)return;if("space_for_ai"!==(0,M.sy)())return;if(!(0,p.GD)(t))return;const i=b.default.state;if("editing"===i.mode){const e=(0,g.QY)(i.multiSelection);if(e&&(0,m.wd)(e.selection)){const t=e.store,s=f.E.findEditableWithStore(t);if(s){const e="block"===t.pointer.table?y.G.createChildStore(t,t.pointer):void 0,n=e&&e.getType(),r=Boolean(n&&(0,a.hD)(n)),i=t.getValue();if(r&&!i)return s}}}}),[e,t])}();return t?(0,j.jsx)(h.U,{origin:()=>t.getNode(),placementToOrigin:"bottom",header:(0,j.jsx)(l.FormattedMessage,{...I.spaceForAiHeader}),content:(0,j.jsx)(l.FormattedMessage,{...I.spaceForAiContent}),onCloseClick:()=>(0,M.h1)(e)}):null}function w(e){const{originRef:t,openState:s}=e,n=(0,i.O7)(),r=(0,o.VK)((()=>(0,M.sy)()),[]);if(n.device.isMobile)return null;return"ask_ai_anything"===r&&"initialPrompt"===s.stage?(0,j.jsx)(h.U,{origin:t,placementToOrigin:"top",header:(0,j.jsx)(l.FormattedMessage,{...I.askAiAnythingHeader}),content:(0,j.jsx)(l.FormattedMessage,{...I.askAiAnythingContent}),onCloseClick:()=>(0,M.h1)(n)}):null}function T(e){const{originRef:t,openState:s,isInputEmpty:n}=e,r=(0,i.O7)(),a=(0,o.VK)((()=>(0,M.sy)()),[]);if(r.device.isMobile)return null;const d="refine_ai_response"===a&&"results"===s.stage&&!s.loading&&"cursor"===s.context.type&&n;return(0,j.jsx)(h.U,{origin:d?t:void 0,placementToOrigin:"right",pointerOffset:-4,pointerLength:25,header:(0,j.jsx)(l.FormattedMessage,{...I.refineAiResponseHeader}),content:(0,j.jsx)(l.FormattedMessage,{...I.refineAiResponseContent}),onCloseClick:()=>(0,M.h1)(r)})}function P(e){const{origin:t}=e,s=(0,i.O7)();(0,n.useEffect)((()=>{d.K(s,{from:"qna_button"})}),[s]);const r=(0,n.useCallback)((()=>{const{currentUserSettingsStore:e}=v.default.state;e&&(d.y(s,{from:"qna_button"}),(0,C.CX)(s,{phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickTooltipComplete",userSettingsStore:e}))}),[s]);return(0,j.jsx)(h.U,{style:{width:250},pointerLength:25,pointerPosition:"94%",origin:t,placementToOrigin:"top",header:(0,j.jsx)(l.FormattedMessage,{...I.showAssistantOriginElementLocationHeader}),content:(0,j.jsx)(l.FormattedMessage,{...I.showAssistantOriginElementLocationContent}),onCloseClick:r})}function R(e){const{origin:t}=e,s=(0,i.O7)();(0,n.useEffect)((()=>{d.K(s,{from:"qna_search"})}),[s]);const r=(0,n.useCallback)((()=>{const{currentUserSettingsStore:e}=v.default.state;e&&(d.y(s,{from:"qna_search"}),(0,C.CX)(s,{phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickTooltipComplete",userSettingsStore:e}))}),[s]);return(0,j.jsx)(h.U,{style:{width:250},pointerLength:25,pointerPosition:"5%",origin:t,placementToOrigin:"bottom",header:(0,j.jsx)(l.FormattedMessage,{...I.showAssistantLocationHeader}),content:(0,j.jsx)(l.FormattedMessage,{...I.showAssistantLocationContent}),onCloseClick:r})}(0,r.exposeDebugEnvironmentValue)("resetAIOnboarding",(e=>()=>{const{currentUserSettingsStore:t}=v.default.state;t&&c.createAndCommit({userAction:"AiIntroModal.debugging.resetAIOnboarding",environment:e,perform:e=>{u.d2({userSettingsStore:t,transaction:e,data:{ai_onboarding_phase:"space_for_ai"}})},userId:t.id})}))},40824:(e,t,s)=>{s.d(t,{N:()=>o});var n=s(49085),r=s(92595);class i extends n.default{getInitialState(){return{currentState:"default",lastStepLoadingCompletionUnixEpochMs:-1/0,aiWindowLastSeenUnixEpochMs:-1/0}}setAssistantLastViewedTime(){o.setState({...o.state,aiWindowLastSeenUnixEpochMs:Date.now()})}}const o=new i;(0,r.exposeDebugValue)("AssistantOriginElementStore",o)},92660:(e,t,s)=>{s.d(t,{Z:()=>l});s(67294);var n=s(480),r=s(86628),i=s(50506),o=s(53437),a=s(85893);function l(e){const t=(0,n.O7)(),{modalStore:s,render:l}=e,{device:d}=t,c=(0,r.VK)((()=>s.state.open),[s]);return d.isMobile?(0,a.jsx)(o.ZP,{ariaLabel:e.ariaLabel,open:c,popupType:o.ZP.PopupType.SlideUp,origin:e.origin,onDismiss:e.onDismiss,render:l,style:e.style}):(0,a.jsx)(i.Z,{ariaLabel:e.ariaLabel,open:c,preventHideChildrenWhileOpening:!0,render:l,onDismiss:e.onDismiss,style:e.style,innerStyle:e.innerStyle})}},30676:(e,t,s)=>{s.d(t,{F:()=>a});s(67294);var n=s(86628),r=s(74016),i=s(52275),o=s(85893);function a(e){const{teamStore:t}=e,{name:s}=(0,n.VK)((()=>({name:t.getName()})),[t]);return(0,o.jsx)(i.Z,{...e,icon:(0,o.jsx)(r.p,{size:14,store:t,disabled:!0}),title:s})}},22715:(e,t,s)=>{s.d(t,{Z:()=>o});s(67294);var n=s(480),r=s(24405),i=(s(58047),s(85893));function o(){(0,n.O7)(),(0,r.yK)((e=>({container:{margin:"8px 16px",background:e.accentColors.yellow[100],borderRadius:8,height:"fit-content"}})),[]);return(0,i.jsx)(i.Fragment,{})}},93481:(e,t,s)=>{s.d(t,{Z:()=>I});var n=s(67294),r=s(480),i=s(84747),o=s(86628),a=s(24405),l=s(69651),d=s(9291),c=s(1898),u=s(45257),h=s(97638),p=s(41558),g=s(52275),m=s(3386),f=s(89728),v=s(53437),x=s(58297),S=s(83264),y=s(255),b=s(75689),C=s(91642),M=s(8319),j=s(85893);const I=function(e){let{onChange:t,onMenuDismiss:s,showButtons:n,title:a,value:l,disabled:d,dateFormat:c,icon:u,mode:h,focused:g}=e;const m=(0,r.O7)(),f=(0,o.qz)(void 0,p.Z);(0,i.Z)((()=>{L({value:l},f)}));const{device:v}=m;return v.isMobile?(0,j.jsx)(q,{onChange:t,onMenuDismiss:s,showButtons:n,title:a,value:l,disabled:d,dateFormat:c,icon:u,mode:h,store:f}):(0,j.jsx)(_,{onChange:t,onMenuDismiss:s,showButtons:n,title:a,value:l,disabled:d,dateFormat:c,focused:g,icon:u,mode:h,store:f})};function k(e){const{device:t}=e;return t.isMobile?v.ZP.PopupType.SlideUp:v.ZP.PopupType.Popup}function w(e){return{buttonMenuItem:{color:e.mediumTextColor},activeMenuItem:{color:e.regularTextColor}}}function T(e){e.preventDefault&&e.preventDefault()}function P(e){e({starting:void 0,ending:void 0})}function R(e){return{menuItem:{minHeight:void 0,paddingTop:e.device.isMobile?12:4,paddingBottom:e.device.isMobile?12:4},icon:{height:14,width:14,fill:"currentColor"},iconActiveDesktop:{height:14,width:14,fill:"currentColor",alignSelf:"flex-start",marginTop:2,marginRight:2},iconActiveDesktopWrapper:{marginTop:0},iconActiveMobile:{height:14,width:14,fill:"currentColor",marginTop:1,marginRight:6},popup:{paddingTop:12,paddingBottom:8},menuItemTitleDesktop:{width:"100%"},sectionMenuItem:{display:"flex"},summary:{display:"inline-flex"}}}function Z(e,t){t||e.setState({...e.state,isOpen:!0,focus:"starting"})}function F(e,t,s,n,r){const{temporaryDateRange:i}=s.state;h.zD(e)||(r||t(i),s.setState({...s.state,isOpen:!1,temporaryDateRange:{starting:void 0,ending:void 0}}),n&&n())}function L(e,t){if(!e.error)return t.setState({...t.state,temporaryDateRange:{...t.state.temporaryDateRange,...e.value}})}function O(e){let{disabled:t,icon:s,title:i,store:o}=e;const a=(0,r.O7)(),l=(0,n.useCallback)((()=>Z(o,t)),[o,t]),d=R(a);return(0,j.jsx)(g.Z,{disabled:t,focused:!1,icon:s(d.icon),title:i,onClick:l})}function B(e){let{disabled:t,title:s,value:i,dateFormat:o,onChange:a,store:c}=e;const u=(0,d.useIntl)(),p=(0,r.O7)(),g=(0,n.useCallback)((()=>Z(c,t)),[c,t]),m=R(p),f=(0,j.jsxs)("div",{style:m.summary,children:[(0,l.C)(m.iconActiveMobile),h._Q(i,u,o)]});return(0,j.jsx)(b.Z,{disabled:t,onClick:g,onClickClear:()=>P(a),label:s,title:f})}function A(e){let{disabled:t,value:s,dateFormat:i,focused:o,onChange:c,store:u}=e;const p=(0,d.useIntl)(),m=(0,a.Fg)(),f=(0,r.O7)(),v=(0,n.useCallback)((()=>Z(u,t)),[u,t]),x=R(f),S=w(m),b={...x.menuItem,...S.activeMenuItem},C=h._Q(s,p,i),M=(0,j.jsx)(y.Z,{onClick:()=>P(c),disabled:t});return(0,j.jsx)(g.Z,{focused:o,disabled:t,icon:(0,l.C)(x.iconActiveDesktop),title:C,right:M,isTokenTitle:!0,alignIconTop:!0,onClick:v,desktopTitleStyle:x.menuItemTitleDesktop,desktopIconStyle:x.iconActiveDesktopWrapper,style:b})}function D(e){let{disabled:t,title:s,icon:i,focused:o,mode:l,store:d}=e;const c=(0,a.Fg)(),u=(0,r.O7)(),h=(0,n.useCallback)((()=>Z(d,t)),[d,t]),p=R(u),m=w(c),f={...p.menuItem,...m.buttonMenuItem,...l===M.z.Pill?{width:"fit-content",border:"solid 1px",paddingLeft:0,paddingRight:0,borderRadius:20,fontSize:12}:{}};return(0,j.jsx)(g.Z,{focused:o,disabled:t,icon:i(p.icon),title:s,onClick:h,style:f})}function E(e){let{disabled:t,value:s,title:r,store:i}=e;const o=(0,n.useCallback)((()=>Z(i,t)),[i,t]);return(0,j.jsx)(u.Z,{on:Boolean(s.starting||s.ending),icon:(0,l.C)({width:16,marginRight:6,fill:"currentColor"}),title:(0,j.jsx)("span",{children:r}),onClick:o})}function V(e){let{onChange:t,onMenuDismiss:s,showButtons:r,title:i,value:a,store:l}=e;const c=(0,n.useCallback)((e=>F(e,t,l,s,r)),[t,l,s,r]),u=(0,n.useCallback)((e=>L(e,l)),[l]),h=(0,o.VK)((()=>function(e,t){const{temporaryDateRange:s}=t.state;return{...e,...s}}(a,l)),[l,a]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(S.Z,{title:i,value:h,onUpdate:u,store:l,onDismiss:c}),r&&(0,j.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",padding:"0px 10px"},children:[(0,j.jsx)(f.Z,{isGray:!0,style:{marginLeft:"auto",marginRight:8},onClick:c,children:(0,j.jsx)(d.FormattedMessage,{defaultMessage:"Cancel",id:"searchDateFilter.cancelButton.label"})}),(0,j.jsx)(x.Z,{onClick:()=>t(l.state.temporaryDateRange),children:(0,j.jsx)(d.FormattedMessage,{defaultMessage:"Accept",id:"searchDateFilter.acceptButton.label"})})]})]})}function _(e){let{mode:t,onChange:s,onMenuDismiss:i,showButtons:a,title:l,value:d,disabled:u,dateFormat:h,focused:p,icon:g,store:f}=e;const x=(0,r.O7)(),S=(0,n.useCallback)((e=>F(e,s,f,i,a)),[s,f,i,a]),y=(0,n.useCallback)((()=>(0,j.jsx)(V,{onChange:s,onMenuDismiss:i,showButtons:a,title:l,value:d,store:f})),[s,i,a,l,d,f]),b=R(x),I=t===M.z.Section,w=I?l:void 0,P=t===M.z.Section?(0,j.jsx)(A,{disabled:u,value:d,dateFormat:h,focused:p,onChange:s,store:f}):t===M.z.Button?(0,j.jsx)(D,{disabled:u,title:l,icon:g,focused:p,mode:t,store:f}):t===M.z.Pill?(0,j.jsx)(E,{disabled:u,value:d,title:l,store:f}):void(0,c.t1)(t),Z=(0,o.VK)((()=>f.state.isOpen),[f]);return(0,j.jsx)(C.Z,{title:w,marginAfter:I,children:(0,j.jsx)(m.Z,{debugName:"SearchDateFilter",capture:Z,onUp:T,onDown:T,onEnter:T,children:(0,j.jsx)(v.ZP,{popupType:k(x),open:Z,origin:P,render:y,onDismiss:S,placementToOrigin:v.ZP.Placement.Bottom,alignmentToOrigin:v.ZP.Alignment.Start,keepFocus:!0,style:b.popup})})})}function q(e){let{mode:t,onChange:s,onMenuDismiss:r,showButtons:i,title:a,value:l,disabled:d,dateFormat:c,icon:u,store:h}=e;const p=(0,o.VK)((()=>h.state.isOpen),[h]),g=(0,n.useCallback)((e=>F(e,s,h,r,i)),[s,h,r,i]),m=(0,n.useCallback)((()=>(0,j.jsx)(V,{onChange:s,onMenuDismiss:r,showButtons:i,title:a,value:l,store:h})),[s,r,i,a,l,h]),f=t===M.z.Section?(0,j.jsx)(B,{disabled:d,title:a,value:l,dateFormat:c,onChange:s,store:h}):(0,j.jsx)(O,{disabled:d,icon:u,title:a,store:h});return(0,j.jsx)(v.ZP,{popupType:v.ZP.PopupType.SlideUp,open:p,origin:f,render:m,onDismiss:g,preventScaleTransition:!0})}},33991:(e,t,s)=>{s.r(t),s.d(t,{DEFAULT_MODAL_WIDTH_WITH_SIDE_PEEK:()=>J,INACTIVE_TIMEOUT_MS:()=>G,SearchCopyLinkSource:()=>X,SearchStaticContext:()=>$,SearchStoresContext:()=>Q,default:()=>ee,getSearchResultMetadata:()=>ne});s(57658);var n=s(67294),r=s(83355),i=s(18466),o=s(49085),a=s(15145),l=s(1800),d=s(12174),c=s(15157),u=s(45366),h=s(94804),p=(s(70203),s(53965)),g=s(7032),m=s(1898),f=s(19584),v=s(51787),x=s(47839),S=s(98730),y=s(40468),b=s(87531),C=s(81598),M=s(40824),j=(s(95477),s(43250)),I=s(73744),k=(s(69988),s(98165)),w=(s(65598),s(59139)),T=s(97638),P=(s(95697),s(2688)),R=s(74948),Z=s(80444),F=s(77080),L=s(32470),O=s(55320),B=s(92338),A=s(26249),D=s(29026);class E extends o.default{getInitialState(){return{insertedActionResultsCount:0,localResults:void 0,serverResultsLoading:!1,serverResults:void 0,serverEventProperties:void 0,serverResultsAllLoaded:!1,errorState:V,selectedQueryResultQuery:void 0,timesToRender:new Map}}setState(e){const t={...this.instanceState};if(!(0,A.Z)(this.instanceState,t))return;const s=function(e){const{newState:t,priorState:s}=e,{localResults:n,serverError:r,serverResultsLoading:i,serverResults:o}=t,a=Boolean(n),l=i?void 0:r;if(!a&&i)return!s.errorState.isLoading&&s.errorState.showMajorError?s.errorState:{isLoading:i};if(a)return{hasLocalResults:a,serverError:l,isLoading:!1,showMajorError:!1};if(l)return{hasLocalResults:a,serverError:l,isLoading:!1,showMajorError:!0};if(0===(null==o?void 0:o.results.length))return{hasLocalResults:a,serverError:B.Ix.NoResults,isLoading:!1,showMajorError:!0};return{hasLocalResults:a,serverError:l,isLoading:!1,showMajorError:!1}}({newState:e,priorState:t});super.setState({...e,errorState:s})}getResultCount(){const{serverResults:e,localResults:t}=this.state,s=(null==e?void 0:e.total)??(null==t?void 0:t.total)??0,n=Boolean(e&&s>=100);return{count:s,isLowerBound:Boolean(e&&t&&s<D.Xv)||n}}}const V={showMajorError:!1,isLoading:!1,hasLocalResults:!1,serverError:void 0};const _=E;var q=s(30857),K=s(87956),N=s(88893),H=s(9019),U=s(93464),z=s(86244),W=s(85893);const G=120*f.C0,$=n.createContext(null),Q=n.createContext(null);let X=function(e){return e[e.SidePeekPanel=0]="SidePeekPanel",e[e.KeyboardShortcut=1]="KeyboardShortcut",e}({});const J=755;class Y extends r.Z{constructor(){super(...arguments),this.inactiveTimer=void 0,this.spaceId=void 0,this.isOpen=!1,this.shouldClearServerResultsOnQueryChange=!1,this.queryResultsSectionRef=n.createRef(),this.searchFilterMenuRef=n.createRef(),this.modalBodyMenuRef=n.createRef(),this.searchResultStore=new _,this.secondarySearchResultStore=new _,this.focusedIndexStore=o.default.createValue(void 0),this.defaultBodyFocusedResult=o.default.createValue(void 0),this.searchActionItemsList=o.default.createValue([]),this.getStaticContext=p.HP((()=>({queryResultsSectionRef:this.queryResultsSectionRef,searchFilterMenuRef:this.searchFilterMenuRef,modalBodyMenuRef:this.modalBodyMenuRef,handleSelectSearchResult:this.handleSelectSearchResult,handleCopySearchItemLink:this.handleCopySearchItemLink,handleQueryChange:ae,handlePopupOpen:ie,handlePopupClose:oe,searchResultStore:this.searchResultStore,secondarySearchResultStore:this.secondarySearchResultStore,focusedIndexStore:this.focusedIndexStore,defaultBodyFocusedResult:this.defaultBodyFocusedResult,searchActionItemsStore:this.searchActionItemsList,isQuickSearch:this.props.quickSearchMode}))),this.getStoresContext=p.HP((e=>({parentStore:e}))),this.renderContent=e=>{const t=this.currentMode.state,s=this.isPopupOpen.state;return(0,W.jsx)($.Provider,{value:this.getStaticContext(),children:(0,W.jsxs)(Q.Provider,{value:this.getStoresContext(this.props.parentStore),children:[this.props.quickSearchMode&&!s&&(0,W.jsx)("div",{style:{position:"absolute",height:z.$,width:"100%"},className:j.pMC}),"search"===t?(0,W.jsx)(U.$T,{renderAsPage:this.props.renderAsPage,quickSearchMode:this.props.quickSearchMode,searchContentPaneType:e,onClose:this.handleComponentClose}):(0,W.jsx)(C.yX,{renderAsPage:this.props.renderAsPage,quickSearchMode:this.props.quickSearchMode,searchContentPaneType:e,onClose:this.handleComponentClose})]})})},this.handleComponentOpenClose=()=>{const e=O.default.state.open||O.default.state.openAsPage;this.isOpen!==e&&(this.isOpen=e,(O.default.state.open||O.default.state.openAsPage)&&(clearTimeout(this.inactiveTimer),D.ZP.update((e=>({...e,hasScrolled:!1})))))},this.handleComponentClose=e=>{const{device:t}=this.environment,{selectedQueryResult:s,numKeystrokes:n,numServerRequests:r,numLocalRequests:i,hadMetaClick:o}=q.default.state,{serverEventProperties:a}=this.searchResultStore.state,{query:l,hasScrolled:c,mode:u}=D.ZP.state;if(n>0&&(r>0||i>0)&&!s&&!o&&(O.default.state.openAsPage||O.default.state.open)){const e=Date.now(),s=O.default.state.openedTimeMs,i=O.default.state.sessionId,o=e-s,d=q.default.state.firstKeyStrokeTimeMs;v.EH(this.environment,{...a,timeToAbandonMs:o,timeFromFirstKeyStrokeToAbandonMs:d?e-d:void 0,numKeystrokes:n,numResultsAboveFold:this.getNumResultsAboveFold(),searchSessionId:i,searchSessionFlowNumber:r,hasScrolled:c,numLocalResults:this.getNumLocalResults(),numTotalLocalResults:this.getNumTotalLocalResults(),numVisibleMembers:(0,N.qX)(),isMobile:t.isMobile}),b.X2({environment:this.environment,timeToAbandonMs:o,query:l.text})}"assistant"===u&&"keydown"===(null==e?void 0:e.type)?D.ZP.switchToSearchPane():this.props.quickSearchMode?(O.default.closeAndResetMetricsState(),q.default.reset(),s&&!o&&this.resetState(),x.closeQuickSearch()):b.IB(this.environment),"assistant"===u&&M.N.setAssistantLastViewedTime(),""===l.text.trim()&&"assistant"!==u&&D.ZP.reset();const h=F.default.getEligibleGroup({experimentId:"search-shorten-inactive-timer",defaultGroup:"control"});let p=G;"control"!==h&&d.g6["search-shorten-inactive-timer"].includes(h)&&(p=parseInt(h,10)*f.C0),this.inactiveTimer&&clearTimeout(this.inactiveTimer),p>0?this.inactiveTimer=window.setTimeout(this.resetState,p):this.resetState(),!this.props.renderAsPage&&t.isMobile&&R.close(),q.default.reset()},this.handleVisibilityChange=(e,t,s)=>{if(!this.props.quickSearchMode)return;const n=P.ZP;if("stopQueueingSubscriptions"in n&&n.stopQueueingSubscriptions(this.environment),t){let e;e="tray-icon"===s?"quick-search-tray-icon":"shortcut"===s?"quick-search-shortcut":"debug-menu"===s?"quick-search-debug-menu":"quick-search",b.UT({environment:this.environment,analyticsFrom:e,isQuickSearch:!0,renderAsPage:!0})}else this.handleComponentClose()},this.handlePotentialWebSearchAbandon=e=>{this.props.renderAsPage&&this.handleComponentClose()},this.constructSelectSearchItemContext=e=>{let{index:t,actionItemCount:s,context:n,selectedResult:r,allSearchResults:i,fromSidePeekPanel:o,sessionId:a,openedTimeMs:l}=e;const{serverEventProperties:d,store:c}=r,h=Date.now(),{numKeystrokes:p,hadMetaClick:g}=q.default.state,{firstKeyStrokeTimeMs:m}=q.default.state,{numServerRequests:f}=q.default.state,{query:v}=D.ZP.state;return{...d,context:n,queryStringLength:v.text.trim().length,numQueryTokens:u.wS(v.text.trim()).length,hasFilters:T.FN(v.filters),activeFilters:v.filters,selectedItemIndex:t.global-s,selectedItemLocalIndex:{section:t.local.section,index:t.local.indexLocal},numKeystrokes:p,fromSidePeekPanel:o,isSidePeekPanelOpen:D.ZP.state.isSidePeekPanelOpen,isSidebarOpen:D.ZP.isDebugSidebarOpen(),timeToSelectMs:h-l,timeFromFirstKeyStrokeToSelectMs:m?h-m:h-l,sources:null==r?void 0:r.sources,localSources:[...(null==r?void 0:r.localSource)??[]],indexInRecentPages:null==r?void 0:r.indexInRecentPages,timeSinceLastViewedMs:null==r?void 0:r.timeSinceLastViewedMs,hadMetaClick:g,numResultsAboveFold:this.getNumResultsAboveFold(),selectedSearchResultMetadata:ne(r),selectedSearchResultContent:void 0,allSearchResultMetadata:null==i?void 0:i.slice(0,50).map((e=>ne(e))),totalSearchResultCount:null==i?void 0:i.length,searchSessionId:a,searchSessionFlowNumber:f,originalPosition:null==r?void 0:r.originalPosition,numLocalResults:this.getNumLocalResults(),numTotalLocalResults:this.getNumTotalLocalResults(),numVisibleMembers:(0,N.qX)(),isMobile:this.environment.device.isMobile,timeToRenderResult:this.searchResultStore.state.timesToRender.get(c.id)}},this.handleSelectSearchResult=e=>{let{index:t,actionItemCount:s,event:n,context:r,selectedResult:i,allSearchResults:o,fromSidePeekPanel:d}=e;const{serverEventProperties:c,store:u}=i;if(!O.default.state.open&&!O.default.state.openAsPage)return;const p=I.DJ(n);"query_results"===r&&(q.default.update((e=>({...e,selectedQueryResult:!0}))),this.searchResultStore.update((e=>({...e,selectedQueryResultQuery:D.ZP.state.query}))));const{sessionId:g,openedTimeMs:f}=O.default.state,{numServerRequests:S}=q.default.state;v.nL(this.environment,{...this.constructSelectSearchItemContext({index:t,actionItemCount:s,context:r,selectedResult:i,allSearchResults:o,fromSidePeekPanel:d,sessionId:g,openedTimeMs:f}),isMetaClick:Boolean(p)});const b=(null==c?void 0:c["server-queryId"])??(0,h.A7)({searchSessionId:g,searchSessionFlowNumber:S});let C;"recent_pages"===r?C=a.tY.SearchRecents:"query_results"===r?C=a.tY.SearchQuery:(0,m.t1)(r);if(this.environment.device.isElectron&&this.props.quickSearchMode){const e=(0,l.Z)({pageModel:i.store.getModel(),pageId:i.store.id,scrollToBlockId:(0,T.dy)(i),pageVisitSource:C,queryId:b});x.openQuickSearchResult(e)}else y.P({searchResult:i,environment:this.environment,pageVisitSource:C,queryId:b,openInNew:p,openInSidePeek:false});K.Z.setState({queryId:b,pageId:u.id,timeEntered:new Date}),p?q.default.update((e=>({...e,hadMetaClick:!0}))):this.handleComponentClose()},this.handleCopySearchItemLink=e=>{let{index:t,actionItemCount:s,context:n,selectedResult:r,allSearchResults:i,fromSidePeekPanel:o,source:a}=e;if(!O.default.state.open&&!O.default.state.openAsPage)return;const{sessionId:l,openedTimeMs:d}=O.default.state;v.sb(this.environment,{...this.constructSelectSearchItemContext({index:t,actionItemCount:s,context:n,selectedResult:r,allSearchResults:i,fromSidePeekPanel:o,sessionId:l,openedTimeMs:d}),source:a})},this.getNumResultsAboveFold=()=>T.MQ({environment:this.environment,searchResultsSection:this.queryResultsSectionRef.current,modalBodyMenu:this.modalBodyMenuRef.current,searchFilterMenu:this.searchFilterMenuRef.current,actionItemCount:this.searchActionItemsList.state.length??0}),this.getNumLocalResults=()=>{var e;return(null===(e=this.searchResultStore.state.localResults)||void 0===e?void 0:e.results.length)??0},this.getNumTotalLocalResults=()=>{var e;return(null===(e=this.searchResultStore.state.localResults)||void 0===e?void 0:e.total)??0},this.handleSpaceChange=()=>{const e=Z.default.state.currentSpaceStore&&Z.default.state.currentSpaceStore.id;this.spaceId!==e&&(this.spaceId=e,this.resetStateWhenSpaceChange(),S.S(this.environment),this.spaceId&&Z.default.state.currentUserStore&&this.props.quickSearchMode&&x.quickSearchReady())},this.resetState=()=>{D.ZP.reset(),this.searchResultStore.reset(),this.secondarySearchResultStore.reset(),q.default.reset(),this.props.quickSearchMode?O.default.closeAndResetMetricsState():O.default.reset()},this.resetStateWhenSpaceChange=()=>{D.ZP.reset(),this.searchResultStore.reset(),this.secondarySearchResultStore.reset(),this.props.quickSearchMode||(O.default.reset(),q.default.reset())},this.currentMode=this.createComputedStore((()=>D.ZP.state.mode)),this.isPopupOpen=this.createComputedStore((()=>D.ZP.state.isPopupOpen))}UNSAFE_willMount(e){var t;this.spaceId=null===(t=Z.default.state.currentSpaceStore)||void 0===t?void 0:t.id,(0,L.lO)(),Z.default.state.currentSpaceStore&&Z.default.state.currentUserStore&&e.quickSearchMode&&x.quickSearchReady()}UNSAFE_willMountOrUpdate(e){if(e.renderAsPage&&!e.quickSearchMode&&!O.default.state.sessionId){const e=(0,g.ZP)();O.default.update((t=>({...t,open:!1,openAsPage:!0,openedTimeMs:Date.now(),sessionId:e}))),v.wF(this.environment,{from:"nativeTab-search-direct-link",searchSessionId:e})}}didMount(){Z.default.addListener(this.handleSpaceChange),O.default.addListener(le),this.props.renderAsPage&&!this.props.quickSearchMode||O.default.addListener(this.handleComponentOpenClose),this.props.quickSearchMode?x.quickSearchVisibilityState.addListener(this.handleVisibilityChange):x.openSearchModalFromQuickSearch.addListener((()=>de(this.environment))),y.T.addListener(this.handlePotentialWebSearchAbandon)}willUnmount(){this.resetState(),this.props.renderAsPage&&!this.props.quickSearchMode||(O.default.removeListener(this.handleComponentOpenClose),x.openSearchModalFromQuickSearch.removeListener((()=>de(this.environment)))),this.props.quickSearchMode&&x.quickSearchVisibilityState.removeListener(this.handleVisibilityChange),y.T.removeListener(this.handlePotentialWebSearchAbandon),Z.default.removeListener(this.handleSpaceChange),O.default.removeListener(le),this.inactiveTimer&&(clearTimeout(this.inactiveTimer),this.inactiveTimer=void 0)}renderComponent(){const e=Boolean(D.ZP.state.query.text.trim())||T.VA(D.ZP.state.query.filters)?"search_results":"default_body";if(this.props.renderAsPage)return this.renderContent(e);const{device:t,mobileNative:s}=this.environment,n=Boolean(O.default.state.open);return(0,W.jsx)(H.Z,{open:n,onDismiss:this.handleComponentClose,modalStyle:re(e,this.props.renderAsPage,this.environment,this.theme),disableAnimation:!t.isMobile||(null==s?void 0:s.supportsNativeHomeOnPhone())||!1,renderContent:()=>this.renderContent(e)})}}Y.displayName="Search";const ee=Y;function te(e){return T.bC(e)}function se(e){const t=(0,L.gq)({device:e.device}),s=(0,U.X1)({device:e.device,isPublicAccessPermissionForPage:te(e).hasPublicAccessPermission});if(t)return"90vw";if((0,w.rd)(e))return J;let n=660;return s&&(n+=250),n}function ne(e){const{store:t,highlight:s,sources:n,localSource:r}=e;return i.Z.withListenerIgnored((()=>{var i,o,a,l,d;return{blockId:t.id,blockType:t.getType(),lowestNavigableAncestorId:null===(i=t.getNavigableBlockStore())||void 0===i?void 0:i.id,depth:k.qA(t).length,matchesText:Boolean(null==s?void 0:s.text),matchesPathText:Boolean((null==s?void 0:s.pathText)||(null==s?void 0:s.title)),matchesTitle:Boolean(null==s?void 0:s.title),isNavigable:t.isNavigableBlock(),lastEditedTime:t.getLastEditedTime(),isTeamArchived:null===(o=(0,k.VP)(t))||void 0===o?void 0:o.isArchived(),sources:n,localSource:[...r??[]],badges:(null===(a=e.badges)||void 0===a?void 0:a.map((e=>e.type)))??[],isCollectionPropertyMatch:void 0!==(null===(l=e.matchedCollectionProperties)||void 0===l?void 0:l.collectionText),isCollectionPropertyHighlight:void 0!==(null===(d=e.highlight)||void 0===d?void 0:d.collectionText),featureGroups:e.featureGroups}}))}function re(e,t,s,n){const r=(0,U.ip)({searchContentPaneType:e,renderAsPage:t,environment:s});return{width:"100%",minHeight:r.minHeight,maxHeight:r.maxHeight,transform:"translate3d(0,0,0)",background:n.popoverBackground,maxWidth:se(s),borderRadius:12}}function ie(){D.ZP.setIsAnyPopupOpen(!0)}function oe(){D.ZP.setIsAnyPopupOpen(!1)}function ae(e){""!==e?(q.default.update((e=>({...e,numKeystrokes:e.numKeystrokes+1}))),D.ZP.updateQueryText(e)):D.ZP.resetQuery({resetFilters:!1})}function le(){var e;const t=null===(e=Z.default.state.currentUserStore)||void 0===e?void 0:e.id;t&&c.Z.set({userId:t,key:h.Y6,value:O.default.state.preferSidePeekOpen})}function de(e){b.UT({environment:e,analyticsFrom:"keyboard-shortcut-quick-search-hotkey",isQuickSearch:!1,renderAsPage:!1})}},17576:(e,t,s)=>{s.d(t,{Z:()=>v});var n=s(94184),r=s.n(n),i=s(67294),o=s(24405),a=s(8597),l=s(75e3),d=s(52275),c=s(28992),u=s(63296),h=s(64369),p=s(85893);function g(e,t){const{inline:s,title:n,focused:i,className:l,blueOutlineFocused:h,compact:g,shouldShowArrowUp:v}=e,{icon:x,...S}=e,y=(0,o.yK)((e=>({hoveredStyle:{background:e.buttonHoveredBackground}})),[]),b=(0,o.yK)((e=>({style:{minHeight:36,paddingTop:8,paddingBottom:8,width:g?"min-content":"100%",display:"flex",...h?{boxShadow:e.focusedShadow,borderRadius:6}:{}},textWrapper:{marginLeft:4,alignItems:void 0,flex:void 0,display:"block",textOverflow:"ellipsis",...s&&{alignItems:"baseline"}},icon:{display:"block",flexShrink:0,height:18,width:18,color:e.mediumTextColor,overflow:"visible",marginRight:6},enterIcon:{height:12,width:12,fill:e.mediumIconColor},iconContainer:{overflow:"visible"},compactButtonHover:{background:e.buttonHoveredBackground},compactButton:{borderRadius:44,marginLeft:10,marginRight:10,padding:"6px 12px",display:"inline-flex",boxShadow:h?e.focusedShadow:void 0,maxWidth:"calc(100% - 20px)"},menuItem:{overflow:"hidden"},menuItemTextWrapper:{marginLeft:0,marginRight:0},right:{marginLeft:i?8:void 0,marginRight:2}})),[s,h,i,g]),C={title:n,icon:x?m(x,b.icon,b.iconContainer):void 0,style:b.style,textWrapperStyle:b.textWrapper,right:v?(0,a.Z)(b.enterIcon):f(i,b.enterIcon),className:r()("notranslate",l),buttonStyle:{paddingLeft:2,width:g?"min-content":void 0},hoveredStyle:y.hoveredStyle};return g?(0,p.jsx)(u.Z,{style:b.compactButton,icon:e=>C.icon,...S,ref:t,hoveredStyle:b.compactButtonHover,children:(0,p.jsx)(c.Z,{title:(0,p.jsx)("div",{style:b.menuItem,children:n}),textWrapperStyle:b.menuItemTextWrapper,style:b.menuItem,allowTextSelection:void 0,right:i?C.right:void 0,rightStyle:b.right})}):(0,p.jsx)(d.Z,{...S,...C,disableTransition:!0,ignoreLocalHoverState:!0,ref:t})}function m(e,t,s){return(0,p.jsx)(h.Z,{style:s,children:e(t)})}function f(e,t){const s={...t,opacity:e?1:0};return(0,p.jsx)("div",{style:{display:"flex"},children:(0,l.U)(s)})}const v=i.forwardRef(g)},93464:(e,t,s)=>{s.d(t,{$T:()=>Fr,ip:()=>Or,X1:()=>Er});var n=s(67294),r=s(480),i=s(86628),o=s(24405),a=s(15145),l=s(80503),d=s(53965),c=s(37850),u=s(893),h=s(98730),p=s(43250),g=s(84210),m=s(60709),f=s(59139),v=s(97638),x=s(82063),S=s(5162),y=s(80444),b=s(88632),C=s(69454),M=s(32470),j=s(55320),I=s(29026),k=s(36488),w=s(56940),T=s(3386),P=s(78140),R=s(40721),Z=s(83785),F=s(22715),L=s(33991),O=s(73935),B=s(12174),A=s(67220),D=s(69651),E=s(64275),V=s(6637),_=s(60291),q=s(37612),K=s(83303),N=s(53772),H=s(9291),U=s(1898),z=s(37810),W=s(95477),G=s(34700),$=s(95697),Q=s(61766),X=s(77080),J=s(23063),Y=s(64921),ee=s(52275),te=s(31945),se=s(60458),ne=s(89728),re=s(72495),ie=s(93481),oe=s(84619),ae=s(90028),le=s(21202),de=s(33929),ce=s(15447),ue=s(77907),he=s(6258),pe=s(31278),ge=s(11470),me=s(76798),fe=s(255),ve=s(85567),xe=s(8319),Se=s(85893);const ye={token:{display:"flex",alignItems:"center"},icon:{marginRight:4}},be=(0,H.defineMessages)({searchPages:{defaultMessage:"Search pages",id:"searchPageFilter.searchTokenFilter.tokenInput.placeholder"},selectAPage:{defaultMessage:"Select a page",id:"searchPageFilter.searchTokenFilter.resultSection.title"}});const Ce=function(e){let{mode:t,title:s,blockIds:n,onChange:i,disabled:o,focused:a,onMenuDismiss:l,onMenuOpen:d,parentStore:c}=e;const u=(0,r.O7)();return(0,Se.jsx)(xe.Z,{mode:t,hasItemsSelected:(null==n?void 0:n.length)>0,title:s,icon:ae.j,iconStyles:we(u).recordIcon,items:n,onChange:i,focused:a,renderFilter:(e,t)=>(0,Se.jsx)(Te,{item:e,args:t,parentStore:c}),renderToken:(e,t)=>(0,Se.jsx)(Ie,{item:e,handlers:t,blockIds:n,parentStore:c}),renderItemForSummary:e=>(0,Se.jsx)(je,{item:e,parentStore:c}),addItemLabel:(0,Se.jsx)(H.FormattedMessage,{defaultMessage:"Add another page",id:"searchPageFilter.searchTokenFilter.addAPage.button"}),labelText:{title:s,tokenInputPlaceholder:de.default.formatMessage(be.searchPages),componentDebugName:"SearchPageFilter"},performRequest:e=>async function(e,t){let{query:s,current:n}=e;const{currentSpaceStore:r}=y.default.state;if(!r)return[];const i=await ue.deps.searchActions.loader(),o=s?(await i.searchPageIds({environment:t,query:s,limit:20,spaceId:r.id,requireEditPermissions:!1,excludeTemplates:!1,source:"ancestor_filter_page_search",boostRecentlyViewedPages:!0})).results:ce.X4.state.map((e=>e.pageId)),a=new Set(n);return o.filter((e=>!a.has(e)))}(e,u),renderResultMenuItem:(e,t)=>(0,Se.jsx)(ke,{item:e,props:t,parentStore:c}),disabled:o,onMenuDismiss:l,onMenuOpen:d})};function Me(e,t){return he.G.createChildStore(t,{table:le.iU,id:e})}function je(e){let{item:t,parentStore:s}=e;const n=Me(t,s);return(0,Se.jsx)(me.Z,{store:n,shouldWrap:!0,maxLength:50})}function Ie(e){let{item:t,handlers:s,blockIds:n,parentStore:o}=e;const a=(0,r.O7)(),l=ye,d=1===n.length,c=Me(t,o),u=(0,i.VK)((()=>c.getIcon()),[c]),h=(0,Se.jsxs)("div",{style:l.token,children:[(0,Se.jsx)(pe.Z,{disabled:!0,icon:u,isEmptyPage:!1,size:20,style:l.icon}),(0,Se.jsx)(me.Z,{store:c})]});return(0,Se.jsx)(ve.Z,{format:a.device.isMobile?oe.lo.Large:oe.lo.Small,value:h,showRemoveButton:!0,onClickRemove:s.onRemove,isSingle:d,shouldShrink:!0,backgroundColor:"transparent",shouldWrap:!1})}function ke(e){let{item:t,props:s,parentStore:n}=e;const r=(0,i.VK)((()=>Me(t,n)),[t,n]);return(0,Se.jsx)(ge.Z,{...s,store:r})}function we(e){return{menuItem:{minHeight:void 0,paddingTop:e.device.isMobile?12:4,paddingBottom:e.device.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginRight:12},recordIcon:{fill:"currentColor"}}}function Te(e){let{item:t,args:s,parentStore:n}=e;const{disabled:i,onRemove:o,onClick:a}=s,l=we((0,r.O7)()),d=Me(t,n),c=(0,Se.jsx)(fe.Z,{disabled:i,onClick:o});return(0,Se.jsx)(ge.Z,{disabled:i,focused:!1,store:d,right:c,style:l.menuItem,desktopTitleStyle:l.menuItemTitle,onClick:a})}var Pe=s(83890),Re=s(88507),Ze=s(29369),Fe=s(92338),Le=s(30397),Oe=s(93044),Be=s(30676);const Ae=function(e){let{mode:t,title:s,teamIds:n,onChange:i,disabled:o,focused:a,onMenuDismiss:l,onMenuOpen:d,parentStore:c}=e;const u=(0,r.O7)(),h=(0,H.useIntl)(),p=(0,Fe.iY)(n);return(0,Se.jsx)(xe.Z,{mode:t,title:s,icon:Re.I,iconStyles:qe(u).recordIcon,items:p||[],onChange:i,disabled:o,focused:a,renderFilter:(e,t)=>(0,Se.jsx)(Ke,{item:e,args:t,parentStore:c}),renderToken:(e,t)=>(0,Se.jsx)(_e,{item:e,handlers:t,teamIds:n,parentStore:c}),renderItemForSummary:e=>(0,Se.jsx)(Ee,{item:e,parentStore:c}),addItemLabel:(0,Se.jsx)(H.FormattedMessage,{defaultMessage:"Add a teamspace",id:"search.filterMenu.addATeamButton.label"}),labelText:{title:s,tokenInputPlaceholder:h.formatMessage({defaultMessage:"Search teamspaces",id:"search.filterMenu.searchTeams.placeholder"}),componentDebugName:"SearchTeamFilter"},performRequest:e=>async function(e,t){var s;let{query:n,current:r}=e;const i=new Set(r),o=y.default.state.currentSpaceViewStore,a=y.default.state.currentSpaceStore,l=null===(s=y.default.state.currentUserStore)||void 0===s?void 0:s.id;if(!o||!a||!l)return[];if(!n){const e=new Set(o.getTeamsStores().map((e=>e.id)));if(Le.Z.state.teams.map((e=>e.id)).forEach((t=>e.add(t))),e.size>0)return[...e]}const d=await(0,$.qX)({environment:t,spaceStore:a,currentUserId:l}),c=await ue.deps.searchActions.loader();return(await c.searchTeams({query:n,spaceViewStore:o,teamStores:d})).filter((e=>!i.has(e.id))).slice(0,20).map((e=>e.id))}(e,u),renderResultMenuItem:(e,t)=>(0,Se.jsx)(Ve,{item:e,props:t,parentStore:c}),onMenuDismiss:l,onMenuOpen:d,hasItemsSelected:Boolean(p&&(null==p?void 0:p.length)>0)})};function De(e,t){return he.zX.createChildStore(t,{table:Ze.e0,id:e})}function Ee(e){let{item:t,parentStore:s}=e;return(0,Se.jsx)(Se.Fragment,{children:De(t,s).getName()})}function Ve(e){let{item:t,props:s,parentStore:r}=e;const i=De(t,r);return(0,n.createElement)(Be.F,{...s,key:t,teamStore:i})}function _e(e){let{item:t,handlers:s,teamIds:n,parentStore:o}=e;const a=(0,r.O7)(),l=(0,Fe.iY)(n),d=1===(null==l?void 0:l.length),c=(0,i.VK)((()=>De(t,o)),[t,o]),u=(0,i.VK)((()=>c.getName()),[c]),h=(0,i.VK)((()=>function(e){const t=e.getIcon();return e=>(0,Se.jsx)(pe.Z,{disabled:!0,icon:t,isEmptyPage:!1,size:e})}(c)),[c]);return c?(0,Se.jsx)(Oe.ZP,{format:a.device.isMobile?Oe.lP.Large:Oe.lP.Small,showRemoveButton:!0,isSingle:d,onClickRemove:s.onRemove,renderAvatar:h,title:u,style:{background:"transparent"}}):null}function qe(e){return{menuItem:{minHeight:void 0,paddingTop:e.device.isMobile?12:4,paddingBottom:e.device.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginRight:12},recordIcon:{marginRight:6,fill:"currentColor"}}}function Ke(e){let{item:t,args:s,parentStore:n}=e;const{disabled:i,onRemove:o,onClick:a}=s,l=qe((0,r.O7)()),d=De(t,n),c=(0,Se.jsx)(fe.Z,{disabled:i,onClick:o});return(0,Se.jsx)(Be.F,{disabled:i,focused:!1,teamStore:d,right:c,style:l.menuItem,desktopTitleStyle:l.menuItemTitle,onClick:a},t)}var Ne=s(45257),He=s(86825),Ue=s(75689),ze=s(91642);const We=function(e){let{title:t,value:s,disabled:n,icon:i,style:o,onChange:a,focused:l,mode:d}=e;const c=(0,r.O7)(),{device:u}=c;return u.isMobile?(0,Se.jsx)(Je,{title:t,value:s,disabled:n,icon:i,style:o,onChange:a,focused:l,mode:d}):(0,Se.jsx)(Xe,{title:t,icon:i,value:s,style:o,onChange:a,focused:l,mode:d})};function Ge(e,t){t(!e)}function $e(e){return{menuItem:{minHeight:void 0,paddingTop:e.device.isMobile?12:4,paddingBottom:e.device.isMobile?12:4},icon:{height:14,width:14,fill:"currentColor"},pillIcon:{height:16,width:16,fill:"currentColor",marginRight:6},sectionMenuItem:{display:"flex"}}}function Qe(e){let{mode:t,title:s,icon:n,value:i,style:a,onChange:l,focused:d}=e;const c=(0,o.Fg)(),u=$e((0,r.O7)()),h=function(e){return{menuItem:{color:e.mediumTextColor}}}(c),p={...u.menuItem,...h.menuItem,...a};return t===xe.z.Pill?(0,Se.jsx)(Ne.Z,{on:i,hideChevron:!0,title:(0,Se.jsx)("span",{children:s}),onClick:()=>Ge(i,l),icon:n(u.pillIcon)}):(0,Se.jsx)(He.Z,{title:s,icon:n(u.icon),on:i,onClick:()=>Ge(i,l),style:p,focused:d})}function Xe(e){let{mode:t,title:s,icon:n,value:i,style:o,onChange:a,focused:l}=e;const d=(0,r.O7)();return(0,Se.jsx)(ze.Z,{marginAfter:!1,style:$e(d).sectionMenuItem,children:(0,Se.jsx)(Qe,{title:s,icon:n,value:i,style:o,onChange:a,mode:t,focused:l})})}function Je(e){let{mode:t,title:s,value:n,disabled:r,icon:i,style:o,onChange:a,focused:l}=e;return t===xe.z.Button?(0,Se.jsx)(Qe,{title:s,icon:i,value:n,style:o,onChange:a,mode:t,focused:l}):(0,Se.jsx)(Ue.Z,{disabled:r,onClick:()=>Ge(n,a),label:s,isToggle:!0,isToggleActive:n})}var Ye=s(42853),et=s(31701),tt=s(32163);function st(e){const t=(0,r.Fy)();return(0,Se.jsx)(te.ZP,{popupType:t.isMobile?te.Z4.SlideUp:te.Z4.Popup,renderOrigin:t=>(0,Se.jsx)(rt,{events:t,...e}),render:t=>(0,Se.jsx)(nt,{parent:t,...e})})}function nt(e){let{parent:t,experiment:s,onChange:n}=e;const i=(0,r.Fy)(),a=(0,o.yK)((()=>({menuOptionStyle:{color:et.ZP.mediumTextColor}})),[]);let l;l=i.isMobile?{menuType:m.og.Modal,title:s.experimentId,right:(0,Se.jsx)(H.FormattedMessage,{defaultMessage:"Done",id:"appearanceSettings.modal.done"}),onClickRight:t.close}:{menuType:m.og.Popup,width:250};const d=s.groups.map((e=>({key:e,action:r=>{n({experimentId:s.experimentId,group:e}),t.close()},render:(t,s)=>(0,Se.jsx)(ee.Z,{...t,title:e,style:a.menuOptionStyle})})));return(0,Se.jsx)(P.Z,{...l,children:(0,Se.jsx)(tt.Z,{type:tt.i.Vertical,initialFocus:void 0,sections:[{key:s.experimentId,render:e=>(0,Se.jsx)(re.Z,{...e}),items:d}]})})}function rt(e){let{experiment:t,events:s,searchExperimentOverrides:r}=e;const i=(0,o.yK)((e=>({experimentGroupButtonChevronStyle:{width:10,fill:e.lightIconColor},experimentGroupButtonStyle:{overflowX:"hidden",justifyContent:"left",overflow:"hidden",marginLeft:6,color:e.mediumTextColor},rowContainer:{display:"flex",overflow:"hidden",flexDirection:"row"},groupCell:{overflow:"hidden",marginRight:4}})),[]);return(0,n.createElement)(ne.Z,{...s,isSmall:!0,key:t.experimentId,style:i.experimentGroupButtonStyle},(0,Se.jsxs)("div",{style:i.rowContainer,children:[(0,Se.jsx)("div",{style:i.groupCell,children:r[t.experimentId]||t.group}),(0,Se.jsx)("div",{children:(0,Ye.i)(i.experimentGroupButtonChevronStyle)})]}))}function it(e){return{fontSize:14,lineHeight:1.2,color:e.mediumTextColor,marginRight:4,display:"flex",alignItems:"center",whiteSpace:"nowrap"}}const ot=function(e){const{experiment:t}=e,{leftOverrides:s,rightOverrides:r,experimentDiffers:a,experimentAgreesButNondefault:l}=(0,i.VK)((()=>{const e=M.v_.state.searchExperimentOverrides,s=M.BJ.state.searchExperimentOverrides,n=(e[t.experimentId]??t.group)!==(s[t.experimentId]??t.group);return{leftOverrides:e,rightOverrides:s,experimentDiffers:n,experimentAgreesButNondefault:!n&&void 0!==s[t.experimentId]&&e[t.experimentId]!==t.group}}),[t]),d=(0,o.yK)((e=>({rowContainer:{backgroundColor:a?e.equationErrorPlaceholderBackground:l?e.accentColors.yellow[100]:void 0},titleCell:{...it(e),maxWidth:180,textOverflow:"ellipsis",overflow:"hidden"}})),[l,a]),c=(0,n.useCallback)((e=>{const{experimentId:t,group:s,store:n}=e;n.setState({...n.state,searchExperimentOverrides:{...n.state.searchExperimentOverrides,[t]:s}})}),[]);return(0,Se.jsxs)(Se.Fragment,{children:[(0,Se.jsx)("div",{style:{...d.titleCell,...d.rowContainer},children:t.experimentId.replace("search-","")}),(0,Se.jsx)("div",{style:d.rowContainer,children:(0,Se.jsx)(st,{experiment:t,searchExperimentOverrides:s,onChange:e=>{c({...e,store:M.v_})}})}),(0,Se.jsx)("div",{style:d.rowContainer,children:(0,Se.jsx)(st,{experiment:t,searchExperimentOverrides:r,onChange:e=>{c({...e,store:M.BJ})}})})]})};var at=s(53877),lt=s(42875),dt=s(22686);let ct=function(e){return e[e.Button=0]="Button",e[e.MenuItem=1]="MenuItem",e}({});function ut(e){let{mode:t,icon:s,title:n,filter:r,isLastInSection:i,onMenuDismiss:o,focused:a}=e;return t===ct.Button?(0,Se.jsx)(bt,{icon:s,title:n,filter:r,isLastInSection:i,onMenuDismiss:o}):t===ct.MenuItem?(0,Se.jsx)(Ct,{icon:s,title:n,filter:r,focused:a,isLastInSection:i,onMenuDismiss:o}):void(0,U.t1)(t)}function ht(e){const t=(0,i.VK)((()=>mt()),[]);return t?(0,Se.jsx)(ut,{icon:ae.j,title:(0,Se.jsx)(H.FormattedMessage,{id:"search.filterMenu.quickFilters.inCurrentPage",defaultMessage:"In current page"}),filter:t,...e}):null}function pt(e){const t=vt((0,r.O7)());return t?(0,Se.jsx)(ut,{icon:dt.f,title:(0,Se.jsx)(H.FormattedMessage,{id:"search.filterMenu.quickFilters.createdByMe",defaultMessage:"Created by me"}),filter:t,...e}):null}function gt(e){const t=ft();return t?(0,Se.jsx)(ut,{icon:D.C,title:(0,Se.jsx)(H.FormattedMessage,{id:"search.filterMenu.quickFilters.editedLastWeek",defaultMessage:"Edited last week"}),filter:t,...e}):null}function mt(){const{mainEditorCurrentBlockStore:e}=y.default.state;if(e&&e.id)return{ancestors:[e.id]}}function ft(){return{lastEditedTime:{starting:at.Oo((0,lt.r)()),ending:at.Lg((0,lt.r)())}}}function vt(e){const{id:t}=e.currentUser;if(t)return{createdBy:[t]}}function xt(e,t,s){const{device:n}=t;return{menuItem:{color:n.isDesktop?s.mediumTextColor:void 0,...e&&{boxShadow:void 0}},buttonFilter:{color:s.mediumTextColor}}}function St(e,t){!function(e){I.ZP.updateFilters(e)}(e),I.ZP.isDebugSidebarOpen()||I.ZP.setState({...I.ZP.state,isDebugSidebarOpen:!0}),t&&t()}function yt(e){return{menuItem:{minHeight:void 0,paddingTop:e.device.isMobile?12:4,paddingBottom:e.device.isMobile?12:4},buttonFilter:{padding:"4px 8px",display:"flex",alignItems:"center",overflow:"hidden"},buttonText:{...z.Z.textOverflowStyle},icon:{display:"inline-block",height:14,width:14,fill:"currentColor"},buttonIcon:{marginRight:6}}}function bt(e){let{icon:t,title:s,filter:n,isLastInSection:i,onMenuDismiss:a}=e;const l=(0,o.Fg)(),d=(0,r.O7)(),c=yt(d),u=xt(i,d,l);return(0,Se.jsxs)(Y.Z,{style:{...c.buttonFilter,...u.buttonFilter},onClick:()=>St(n,a),children:[t&&t({...c.icon,...c.buttonIcon}),(0,Se.jsx)("span",{style:c.buttonText,children:s})]})}function Ct(e){let{icon:t,title:s,filter:n,focused:i,isLastInSection:a,onMenuDismiss:l}=e;const d=(0,o.Fg)(),c=(0,r.O7)(),u=yt(c),h=xt(a,c,d),p={...u.menuItem,...h.menuItem};return(0,Se.jsx)(ee.Z,{icon:t&&t(u.icon),focused:i,title:s,onClick:()=>St(n,l),style:p})}var Mt=s(1743),jt=s(74194);function It(e){const{leftValue:t,rightValue:s,setLeftValue:r,setRightValue:i,placeholder:a,label:l}=e,{titleCell:d,rightTitleCell:c,leftTitleCell:u}=(0,o.yK)((e=>{const n=it(e);return{titleCell:n,rightTitleCell:{...n,color:s?n.color:e.lightTextColor,width:"95%"},leftTitleCell:{...n,color:t?n.color:e.lightTextColor,width:"95%"}}}),[t,s]),[h,p]=(0,n.useState)(s),[g,m]=(0,n.useState)(t);(0,n.useEffect)((()=>{void 0===s&&p(void 0),void 0===t&&m(void 0)}),[s,t]);const f=(0,n.useCallback)((()=>{i(h)}),[i,h]),v=(0,n.useCallback)((()=>{r(g)}),[r,g]),x=(0,n.useCallback)((e=>{p(e.target.value)}),[]),S=(0,n.useCallback)((e=>{m(e.target.value)}),[]);return(0,Se.jsxs)(Se.Fragment,{children:[(0,Se.jsx)("div",{style:d,children:l}),(0,Se.jsxs)(Mt.Z,{debugName:"SearchStringOverrideControls",capture:!0,allowMenuList:!1,children:[(0,Se.jsx)(jt.Z,{style:u,onBlur:v,value:g,onChange:S,placeholder:a}),(0,Se.jsx)(jt.Z,{style:c,onBlur:f,value:h,onChange:x,placeholder:a})]})]})}let kt=function(e){return e.Button="Button",e.Section="Section",e}({});function wt(e,t){let{isMobile:s,mode:r}=e;const o=(0,i.qz)(void 0,Q.Z),a=(0,i.VK)((()=>(0,U.qP)(B.g6).map((e=>{let[t,s]=e;return{experimentId:t,experimentVersion:1,group:X.default.getGroup(t),groups:["control",...s]}}))),[]),l=(0,n.useRef)(null),d=(0,n.useRef)(null);return(0,n.useImperativeHandle)(t,(()=>({getClientHeight:()=>{if(null!==l.current){const e=l.current.getAnchor(),t=O.findDOMNode(e);return(null==t?void 0:t.clientHeight)??0}return null!==d.current?d.current.clientHeight:0}}))),s?r===kt.Button?(0,Se.jsx)(es,{ref:l,isMobile:s,buttonPopupStore:o}):r===kt.Section?(0,Se.jsx)(Yt,{ref:d,buttonPopupStore:o}):void(0,U.t1)(r):(0,Se.jsx)(Xt,{ref:d,isMobile:s,searchExperimentsToToggle:a})}function Tt(e){let{columnStore:t}=e;const s=(0,i.VK)((()=>t.state.visible),[t]);return(0,Se.jsx)(ee.Z,{icon:(0,Se.jsx)(se.Z,{checked:s,size:14,onClick:()=>t.update((e=>({...e,visible:!e.visible})))}),focused:!1,title:"Show",onClick:()=>t.update((e=>({...e,visible:!e.visible})))})}function Pt(e){let{title:t,searchExperimentOverrides:s}=e;return(0,Se.jsx)(ee.Z,{focused:!1,title:t,onClick:()=>{M.BJ.update((e=>({...e,visible:!1}))),M.v_.update((e=>({...e,searchExperimentOverrides:s})))}})}const Rt=n.forwardRef(wt);function Zt(e){return t=>I.ZP.updateFilters({[e]:t})}function Ft(){return null}function Lt(){const e=(0,i.VK)((()=>M.ZP.state.showDebugInfo),[]);return(0,Se.jsx)(We,{mode:xe.z.Button,focused:!1,title:"Show debug info",icon:A.S,value:e,onChange:e=>{M.ZP.setState({...M.ZP.state,showDebugInfo:Boolean(e)})}})}function Ot(){const e=(0,i.VK)((()=>"everything"===M.ZP.state.debug),[]);return(0,Se.jsx)(We,{mode:xe.z.Button,focused:!1,title:"Profile query",icon:A.S,value:e,onChange:e=>{M.ZP.setState({...M.ZP.state,debug:e?"everything":void 0})}})}function Bt(e){let{mode:t}=e;const s=(0,i.VK)((()=>I.ZP.state.query.filters),[]);return(0,Se.jsx)(We,{mode:t,focused:!1,title:(0,Se.jsx)(H.FormattedMessage,{id:"search.filterMenu.deletedOnlyToggle.label",defaultMessage:"Deleted only"}),icon:q.y,value:s.isDeletedOnly||!1,onChange:Zt("isDeletedOnly")})}function At(){return(0,Se.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFiltersSection.title",defaultMessage:"More filters"})}function Dt(e){I.ZP.updateFilters({navigableBlockContentOnly:e})}function Et(){I.ZP.update((e=>({...e,isDebugSidebarOpen:!1})))}function Vt(e){let{mode:t}=e;const{filters:s}=(0,i.VK)((()=>I.ZP.state.query),[]);return(0,Se.jsx)(We,{mode:t,focused:!1,title:(0,Se.jsx)(H.FormattedMessage,{id:"search.filterMenu.onlyMatchTitlesToggle.label",defaultMessage:"Title only"}),icon:K.c,value:s.navigableBlockContentOnly||!1,onChange:Dt})}function _t(e){return{sidebar:{paddingTop:12,paddingBottom:24,overflowY:"auto",overflowX:"hidden",flex:"0 0 250px",minHeight:400},sidebarHidden:{display:"none"},addFilterButtonMobile:{fontSize:e?z.Z.fontSize.UISmall.mobile:z.Z.fontSize.UISmall.desktop,fontWeight:z.Z.fontWeight.medium,marginRight:-8}}}function qt(e){const{isMobile:t}=e,s=_t(t);return(0,Se.jsx)(ne.Z,{...e,style:s.addFilterButtonMobile,icon:V.I,isBlue:!0,children:(0,Se.jsx)(H.FormattedMessage,{defaultMessage:"Add filter",id:"search.addFilter.button.label"})})}function Kt(e){e.setState({...e.state,open:!1})}function Nt(e){let{buttonPopupStore:t}=e;const s=(0,r.O7)(),o=(0,n.useCallback)((()=>Kt(t)),[t]),{filters:a}=(0,i.VK)((()=>I.ZP.state.query),[]),l=function(e,t){const s=vt(e);if(!s)return!1;if(!s.createdBy)return!1;const n=s.createdBy[0];return-1!==t.createdBy.indexOf(n)}(s,a),c=function(e){const{lastEditedTime:t}=ft();return d.Xy(t,e.lastEditedTime)}(a),u=(0,i.VK)((()=>function(e){const t=mt();if(!t)return!1;if(!t.ancestors)return!1;const s=t.ancestors[0];return-1!==e.ancestors.indexOf(s)}(a)),[a]);return l&&c&&u?null:(0,Se.jsxs)(ze.Z,{title:(0,Se.jsx)(H.FormattedMessage,{id:"search.filterMenu.quickFiltersSection.title",defaultMessage:"Quick filters"}),marginAfter:!0,children:[!l&&(0,Se.jsx)(pt,{mode:ct.MenuItem,focused:!1,onMenuDismiss:o}),!c&&(0,Se.jsx)(gt,{mode:ct.MenuItem,focused:!1,onMenuDismiss:o}),!u&&(0,Se.jsx)(ht,{mode:ct.MenuItem,focused:!1,onMenuDismiss:o,isLastInSection:!0})]})}function Ht(e){let{searchExperimentsToToggle:t}=e;return(0,N.x)(W.default)?(0,Se.jsx)(ze.Z,{title:"Dev Tools",children:(0,Se.jsx)(J.Z,{isVisible:!0,animationStyle:{height:"100%"},render:()=>(0,Se.jsxs)("div",{style:{overflow:"scroll"},children:[(0,Se.jsx)(Lt,{}),(0,Se.jsx)(Ot,{}),(0,Se.jsx)(Ft,{}),(0,Se.jsxs)(ze.Z,{style:{marginTop:16},title:"Quick Switch",children:[(0,Se.jsx)(Pt,{title:"No local at all",searchExperimentOverrides:{"search-no-local-blending":"on","search-debug-only-no-recent-boosting":"on"}}),(0,Se.jsx)(Pt,{title:"No local results",searchExperimentOverrides:{"search-no-local-blending":"on"}}),(0,Se.jsx)(Pt,{title:"No local boosting",searchExperimentOverrides:{"search-debug-only-no-recent-boosting":"on"}}),(0,Se.jsx)(Pt,{title:"Vector only",searchExperimentOverrides:{"search-vectors":"log-norm"}})]}),(0,Se.jsx)(ze.Z,{style:{marginTop:16},title:"Dev Experiments",right:(0,Se.jsx)(ne.Z,{onClick:()=>{M.v_.reset(),M.BJ.reset()},style:{paddingLeft:0,paddingRight:0,height:"unset"},children:(0,_.b)({width:12})}),children:(0,Se.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr 1fr",minWidth:"100%",maxWidth:"100%",paddingLeft:14},children:[(0,Se.jsx)("div",{}),(0,Se.jsx)("div",{}),(0,Se.jsx)(Tt,{columnStore:M.BJ}),t.map((e=>(0,Se.jsx)(ot,{experiment:e},e.experimentId))),(0,Se.jsx)(It,{leftValue:M.v_.state.forcedClusterPattern,rightValue:M.BJ.state.forcedClusterPattern,setLeftValue:M.v_.updateForcedClusterPattern,setRightValue:M.BJ.updateForcedClusterPattern,placeholder:"cluster-pattern",label:"forced cluster pattern"}),(0,Se.jsx)(It,{leftValue:M.v_.state.forcedBlockIds,rightValue:M.BJ.state.forcedBlockIds,setLeftValue:M.v_.updateForcedBlockIds,setRightValue:M.BJ.updateForcedBlockIds,placeholder:"block ids",label:"forced block ids"})]})})]})})}):null}function Ut(e){let{mode:t,buttonPopupStore:s}=e;const r=(0,n.useCallback)((()=>Kt(s)),[s]),{filters:o}=(0,i.VK)((()=>I.ZP.state.query),[]);return(0,Se.jsx)(L.SearchStoresContext.Consumer,{children:e=>{let{parentStore:s}=e;return(0,Se.jsx)(Ce,{mode:t,focused:!1,title:(0,Se.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.inPage",defaultMessage:"In"}),parentStore:s,blockIds:o.ancestors,onMenuDismiss:r,onChange:Zt("ancestors")})}})}function zt(e){let{mode:t,buttonPopupStore:s}=e;const r=(0,n.useCallback)((()=>Kt(s)),[s]),{filters:o}=(0,i.VK)((()=>I.ZP.state.query),[]);return(0,Se.jsx)(L.SearchStoresContext.Consumer,{children:e=>{let{parentStore:s}=e;return(0,Se.jsx)(Pe.Z,{mode:t,focused:!1,title:(0,Se.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.createdBy",defaultMessage:"Created by"}),parentStore:s,userIds:o.createdBy,onMenuDismiss:r,onChange:Zt("createdBy")})}})}function Wt(e){let{mode:t,buttonPopupStore:s}=e;const r=(0,n.useCallback)((()=>Kt(s)),[s]),{filters:o}=(0,i.VK)((()=>I.ZP.state.query),[]);return(0,Se.jsx)(ie.Z,{mode:t,focused:!1,title:(0,Se.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.created",defaultMessage:"Created"}),icon:D.C,value:o.createdTime,onMenuDismiss:r,onChange:Zt("createdTime")})}function Gt(e){let{mode:t,buttonPopupStore:s}=e;const r=(0,n.useCallback)((()=>Kt(s)),[s]),{filters:o}=(0,i.VK)((()=>I.ZP.state.query),[]);return(0,Se.jsx)(ie.Z,{mode:t,focused:!1,title:(0,Se.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.lastEdited",defaultMessage:"Last edited"}),icon:D.C,value:o.lastEditedTime,onMenuDismiss:r,onChange:Zt("lastEditedTime")})}function $t(e){let{mode:t,buttonPopupStore:s}=e;const r=(0,n.useCallback)((()=>Kt(s)),[s]),{filters:o}=(0,i.VK)((()=>I.ZP.state.query),[]);return(0,i.VK)((()=>(0,$.bq)()),[])?(0,Se.jsx)(L.SearchStoresContext.Consumer,{children:e=>{let{parentStore:s}=e;return(0,Se.jsx)(Ae,{mode:t,focused:!1,title:(0,Se.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.inTeams",defaultMessage:"Teamspace"}),parentStore:s,teamIds:o.inTeams,onMenuDismiss:r,onChange:Zt("inTeams")})}}):null}function Qt(e){let{activeFilters:t,mode:s,buttonPopupStore:r}=e;return(0,Se.jsxs)(n.Fragment,{children:[t.createdBy&&(0,Se.jsx)(zt,{buttonPopupStore:r,mode:s}),t.createdTime&&(0,Se.jsx)(Wt,{buttonPopupStore:r,mode:s}),t.lastEditedTime&&(0,Se.jsx)(Gt,{buttonPopupStore:r,mode:s}),t.ancestors&&(0,Se.jsx)(Ut,{buttonPopupStore:r,mode:s}),t.inTeams&&(0,Se.jsx)($t,{buttonPopupStore:r,mode:s})]})}const Xt=n.forwardRef((function(e,t){let{isMobile:s,searchExperimentsToToggle:n}=e;const a=(0,o.Fg)(),l=(0,r.O7)(),d=_t(s),c=function(e){return{sidebar:{backgroundColor:e.sidebarSecondaryBackground,borderLeft:`1px solid ${e.regularDividerColor}`}}}(a),u=(0,i.VK)((()=>I.ZP.isDebugSidebarOpen()),[]),h=(0,i.VK)((()=>(0,f.bN)(l)),[l]),p={...d.sidebar,...c.sidebar,...!u&&d.sidebarHidden};return(0,Se.jsxs)("aside",{ref:t,style:p,children:[(0,Se.jsx)(Y.Z,{onClick:Et,style:{display:"flex",alignItems:"center",justifyContent:"center",background:void 0,borderRadius:6,width:16,height:16,position:"absolute",top:10,right:10,...h&&(0,G.X)({noDrag:!0})},children:(0,E.D)({width:14,fill:a.mediumTextColor})}),(0,Se.jsx)(Ht,{searchExperimentsToToggle:n})]})}));function Jt(e){let{buttonPopupStore:t}=e;return(0,Se.jsxs)(P.Z,{menuType:m.og.ActionSheet,children:[(0,Se.jsx)(Nt,{buttonPopupStore:t}),(0,Se.jsxs)(ze.Z,{title:(0,Se.jsx)(At,{}),children:[(0,Se.jsx)(zt,{buttonPopupStore:t,mode:xe.z.Button}),(0,Se.jsx)(Wt,{buttonPopupStore:t,mode:xe.z.Button}),(0,Se.jsx)(Gt,{buttonPopupStore:t,mode:xe.z.Button}),(0,Se.jsx)(Ut,{buttonPopupStore:t,mode:xe.z.Button}),(0,Se.jsx)($t,{buttonPopupStore:t,mode:xe.z.Button})]})]})}const Yt=n.forwardRef((function(e,t){let{buttonPopupStore:s}=e;const n=(0,i.VK)((()=>I.ZP.state),[]),r=(0,i.VK)((()=>v.De(n.query.filters)),[n.query.filters]);return(0,Se.jsxs)(re.Z,{ref:t,disableMobilePadding:!0,disableMobileBorders:!0,children:[(0,Se.jsx)(Vt,{mode:xe.z.Section}),(0,Se.jsx)(Bt,{mode:xe.z.Section}),(0,Se.jsx)(Qt,{buttonPopupStore:s,activeFilters:r,mode:xe.z.Section})]})})),es=n.forwardRef((function(e,t){let{isMobile:s,buttonPopupStore:r}=e;const i=(0,n.useCallback)((()=>(0,Se.jsx)(Jt,{buttonPopupStore:r})),[r]);return(0,Se.jsx)(te.ZP,{ref:t,popupType:te.Z4.SlideUp,buttonPopupStore:r,renderOrigin:e=>(0,Se.jsx)(qt,{...e,isMobile:s}),render:i})}));var ts=s(28992),ss=s(98519),ns=s(4023),rs=s(7931);const is=function(e){const t=n.useRef(),s=(0,r.Fy)(),{isMobile:i}=s,{activeOption:a,items:l}=n.useMemo((()=>function(e){const{currentSortBy:t,setSortBy:s,sortOptions:n,selectButton:r}=e;let i=n[0];const o=n.map((e=>{const n=t.field,o=`${n}.${"relevance"===n?"":t.direction}`,a=e.key===o;return a&&(i=e),{key:e.key,action:()=>{s(e.sort),r&&r.current&&r.current.closeMenu()},render:t=>(0,Se.jsx)(ee.Z,{...t,title:e.formattedName,right:a&&(0,ss.k)({fill:et.ZP.regularIconColor,width:14,height:14})})}}));return{activeOption:i,items:o}}({...e,selectButton:t})),[e,t]),d=(0,o.yK)((e=>({selectedTitle:{color:e.mediumTextColor},label:{marginRight:2,fontSize:i?z.Z.fontSize.UISmall.mobile:z.Z.fontSize.UISmall.desktop,transform:"translateY(0.5px)"},innerButton:{color:e.mediumTextColor,fontWeight:z.Z.fontWeight.semibold,fontSize:i?z.Z.fontSize.UISmall.mobile:z.Z.fontSize.UISmall.desktop,height:20,padding:"2px 4px",marginRight:1,transform:"translateY(0.5px)"},menu:{minWidth:200}})),[i]),c=i?(0,Se.jsx)(H.FormattedMessage,{id:"search.sort.sortMenuTitle",defaultMessage:"Sort By"}):void 0;return(0,Se.jsx)(rs.Z,{ref:e=>{e&&(t.current=e)},alignmentToOrigin:ns.v.Start,selectedTitle:(0,Se.jsx)("div",{style:d.selectedTitle,children:a.formattedName}),label:void 0,renderMenuSections:()=>[{key:"searchSortOrder",render:e=>(0,Se.jsx)(ze.Z,{...e,title:c,desktopStyle:d.menu,disableDesktopPadding:!1}),items:l}],labelStyle:d.label,innerButtonStyle:d.innerButton})};const os=[{key:"relevance.",formattedName:(0,Se.jsx)(H.FormattedMessage,{id:"search.sort.sortOrder.bestMatches",defaultMessage:"Best matches"}),sort:{field:"relevance"}},{key:"lastEdited.desc",formattedName:(0,Se.jsx)(H.FormattedMessage,{id:"search.sort.sortOrder.lastEdited.newestFirst",defaultMessage:"Last edited: Newest first"}),sort:{field:"lastEdited",direction:"desc"}},{key:"lastEdited.asc",formattedName:(0,Se.jsx)(H.FormattedMessage,{id:"search.sort.sortOrder.lastEdited.oldestFirst",defaultMessage:"Last edited: Oldest first"}),sort:{field:"lastEdited",direction:"asc"}},{key:"created.desc",formattedName:(0,Se.jsx)(H.FormattedMessage,{id:"search.sort.sortOrder.created.newestFirst",defaultMessage:"Created: Newest first"}),sort:{field:"created",direction:"desc"}},{key:"created.asc",formattedName:(0,Se.jsx)(H.FormattedMessage,{id:"search.sort.sortOrder.created.oldestFirst",defaultMessage:"Created: Oldest first"}),sort:{field:"created",direction:"asc"}}],as=function(e){let{isPublicPageSearch:t}=e;const s=(0,r.O7)(),{device:n}=s,i=function(e){return{menuItemMobile:{paddingBottom:0},titleWrapper:{flex:void 0,marginTop:-3,marginBottom:-1},showSidebarButton:()=>{const{device:t}=e;return{padding:"0 4px",fontSize:t.isMobile?z.Z.fontSize.UISmall.mobile:z.Z.fontSize.UISmall.desktop,fontWeight:z.Z.fontWeight.medium,borderRadius:4,height:20,lineHeight:"20px"}}}}(s),o={...n.isMobile&&i.menuItemMobile},a=t?void 0:(0,Se.jsx)(ds,{});return(0,Se.jsx)(ts.Z,{title:(0,Se.jsx)(ls,{}),right:a,textWrapperStyle:i.titleWrapper,style:o})};function ls(){const e=(0,i.VK)((()=>I.ZP.state.query.sort),[]);return(0,Se.jsx)(is,{currentSortBy:e,setSortBy:e=>{I.ZP.setState({...I.ZP.state,query:{...I.ZP.state.query,sort:e}})},sortOptions:os})}function ds(){const e=(0,r.O7)(),{device:t}=e;return t.isMobile?(0,Se.jsx)(Rt,{isMobile:!0,mode:kt.Button}):null}var cs=s(86244),us=s(61496);const hs=(0,s(45238).IU)("title",{viewBox:"0 0 14 10",svg:(0,Se.jsx)("path",{d:"M10.674 9.45c.293 0 .576-.052.85-.153.273-.098.515-.238.726-.422.215-.184.383-.4.504-.65h.03v.662a.569.569 0 00.163.416c.11.101.25.152.422.152a.579.579 0 00.428-.164c.11-.105.164-.256.164-.451V4.973c0-.43-.104-.805-.31-1.125-.208-.32-.5-.569-.88-.744-.378-.18-.828-.27-1.347-.27-.594 0-1.114.115-1.559.346-.445.226-.75.533-.914.92-.031.07-.056.14-.076.21a.684.684 0 00-.03.194c0 .148.05.27.147.363.102.09.23.135.387.135a.61.61 0 00.287-.064.555.555 0 00.217-.2c.172-.32.377-.554.615-.703.238-.148.533-.223.885-.223.426 0 .76.112 1.002.334.242.223.363.528.363.915v.486l-1.828.1c-.77.042-1.361.23-1.775.562-.41.328-.616.773-.616 1.336 0 .379.09.71.27.996.183.285.435.508.756.668.324.16.697.24 1.119.24zm.328-.938c-.367 0-.666-.092-.897-.276a.906.906 0 01-.345-.738.86.86 0 01.34-.709c.23-.184.558-.29.984-.322l1.664-.106v.598c0 .293-.078.557-.234.791a1.69 1.69 0 01-.627.557c-.266.136-.56.205-.885.205zM.689 9.414c.2 0 .354-.045.463-.135.114-.086.202-.234.264-.445l.65-1.816h3.346l.65 1.816c.063.21.149.36.258.445.114.09.268.135.463.135.207 0 .371-.057.492-.17a.593.593 0 00.188-.463c0-.129-.027-.27-.082-.422L4.79 1.357c-.09-.246-.22-.43-.393-.55C4.23.686 4.012.625 3.742.625c-.508 0-.847.244-1.02.732L.116 8.39a1.3 1.3 0 00-.076.404c0 .195.057.348.17.457.117.11.277.164.48.164zm1.717-3.486L3.73 2.119h.03l1.324 3.809H2.406z"})});var ps=s(15157),gs=s(34859),ms=s(79131),fs=s(53336),vs=s(76725),xs=s(19889),Ss=s(7928);function ys(e){const{filterUIName:t}=e,{parentStore:s}=(0,n.useContext)(L.SearchStoresContext),r=(0,i.VK)((()=>I.ZP.state.query.filters),[]),a=(0,o.yK)((e=>({title:{maxWidth:220,...z.Z.textOverflowStyle}})),[]),l=(0,i.VK)((()=>{switch(t){case"personFilter":return function(e,t){const s=e.createdBy,n=de.default.getIntl(),r=d.oA(s.map((e=>{const s=he.U6.createChildStore(t,{table:xs.KJ,id:e});return(0,Ss.Nz)(n,s.getModel())})));return(0,vs.Z)(r,js)}(r,s);case"teamsFilter":case"dev_notInTeamFilter":return function(e,t){const s=(0,Fe.iY)(e.inTeams);if(!s)return[];const n=d.oA(s.map((e=>he.zX.createChildStore(t,{table:Ze.e0,id:e}).getName())));return(0,vs.Z)(n,js)}(r,s);case"pageFilter":case"pageFilter":case"dev_notInPageFilter":return Is(r,s);case"dateFilter":return function(e){const t=de.default.getIntl(),s=Cs(e);if("createdTime"===s)return v._Q(e.createdTime,t);if("lastEditedTime"===s)return v._Q(e.lastEditedTime,t);return""}(r);case"titleToggle":return[];default:(0,U.t1)(t)}}),[s,t,r]);return(0,Se.jsx)("div",{style:a.title,children:(0,Se.jsx)(H.FormattedMessage,{defaultMessage:"{filterName}{colon} {filterOperator} {filterValues}",id:"search.filterBarFilter.title",values:{filterName:bs(t),filterOperator:0===l.length?void 0:Ms(t,r),filterValues:l,colon:0===l.length?void 0:":"}})})}function bs(e){switch(e){case"personFilter":return(0,Se.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.person",defaultMessage:"Created by"});case"teamsFilter":return(0,Se.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.inTeams",defaultMessage:"Teamspace"});case"pageFilter":return(0,Se.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.inPage",defaultMessage:"In"});case"dateFilter":return(0,Se.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.date",defaultMessage:"Date"});case"titleToggle":return(0,Se.jsx)(H.FormattedMessage,{id:"search.filterMenu.onlyMatchTitlesToggle.label",defaultMessage:"Title only"});case"dev_notInPageFilter":return(0,Se.jsx)(H.FormattedMessage,{id:"[DO NOT TRANSLATE].search.filterMenu.notInPageFilter.label",defaultMessage:"[dev] Not in page"});case"dev_notInTeamFilter":return(0,Se.jsx)(H.FormattedMessage,{id:"[DO NOT TRANSLATE].search.filterMenu.notInTeamFilter.label",defaultMessage:"[dev] Not in teamspace"})}(0,U.t1)(e)}function Cs(e){const t=v.VD.createdTime(e.createdTime),s=v.VD.lastEditedTime(e.lastEditedTime);return t?"createdTime":s?"lastEditedTime":void 0}function Ms(e,t){switch(e){case"personFilter":case"teamsFilter":case"pageFilter":case"dev_notInPageFilter":case"dev_notInTeamFilter":case"dateFilter":case"titleToggle":return}(0,U.t1)(e)}function js(e){return", "}function Is(e,t){const s=e.ancestors,n=d.oA(s.map((e=>{const s=he.G.createChildStore(t,{table:le.iU,id:e});return s.isDefined()?s.getModel().getRenderTitle({getRecordModel:s.getRecordModel,userTimeZone:(0,lt.r)(),intl:de.default.getIntl()}):""})));return(0,vs.Z)(n,js)}var ks=s(83355),ws=s(41558),Ts=s(53437),Ps=s(14871),Rs=s(83264);const Zs={today:(0,Se.jsx)(H.FormattedMessage,{defaultMessage:"Today",id:"searchDateFilter.quickActions.today.label"}),pastWeek:(0,Se.jsx)(H.FormattedMessage,{defaultMessage:"Last 7 days",id:"searchDateFilter.quickActions.last7Days.label"}),pastMonth:(0,Se.jsx)(H.FormattedMessage,{defaultMessage:"Last 30 days",id:"searchDateFilter.quickActions.last30Days.label"})};function Fs(e){let{date:t,onClick:s,onDismiss:n}=e;const r=(0,lt.r)(),i=at.Lg(r),o=i;let a;const l=Zs[t];"today"===t?a=i:"pastWeek"===t?a=at.Oo(r):"pastMonth"===t?a=at.dj(r):(0,U.t1)(t);return(0,Se.jsx)(ee.Z,{focused:!1,icon:(0,D.C)({height:18,width:18}),title:l,onClick:e=>{s({value:{starting:{type:"date",start_date:a.start_date},ending:{type:"date",start_date:o.start_date}}}),n(e)}})}class Ls extends ks.Z{constructor(){super(...arguments),this.storeTypes={store:ws.Z},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderPopupContents=()=>(0,Se.jsx)($s,{onMenuDismiss:this.props.onMenuDismiss,title:this.props.title,value:this.props.value,store:this.stores.store}),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleOriginActivate=()=>qs(this.stores.store,this.props.disabled,this.props.onMenuOpen),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMenuClose=e=>Ks(e,this.stores.store,this.props.onMenuDismiss),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleClear=()=>Ns(this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_updateTemporary=e=>Hs(e,this.stores.store)}didMount(){Hs({value:this.props.value},this.stores.store)}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?(0,Se.jsx)(Xs,{onMenuDismiss:this.props.onMenuDismiss,title:this.props.title,value:this.props.value,disabled:this.props.disabled,onMenuOpen:this.props.onMenuOpen,dateFormat:this.props.dateFormat,intl:this.props.intl,icon:this.props.icon,store:this.stores.store,mode:t}):(0,Se.jsx)(Qs,{onMenuDismiss:this.props.onMenuDismiss,title:this.props.title,value:this.props.value,disabled:this.props.disabled,onMenuOpen:this.props.onMenuOpen,icon:this.props.icon,store:this.stores.store,mode:t})}}Ls.displayName="SearchGenericDateFilter";const Os=(0,H.injectIntl)(Ls);function Bs(e,t){I.ZP.updateFilters({[e]:t})}function As(e){return{lastEditedTime:(0,Se.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.lastEdited",defaultMessage:"Last edited"}),createdTime:(0,Se.jsx)(H.FormattedMessage,{id:"search.filterMenu.moreFilters.created",defaultMessage:"Created"})}[e]}function Ds(e){const{device:t}=e;return t.isMobile?Ts.ZP.PopupType.SlideUp:Ts.ZP.PopupType.Popup}function Es(){const e=(0,r.O7)(),{device:t}=e;return(0,Ye.i)({width:10,height:10,...t.isMobile&&{marginTop:2}})}function Vs(e){e.preventDefault&&e.preventDefault()}function _s(e,t){return{menuItem:{minHeight:void 0,paddingTop:e.device.isMobile?12:4,paddingBottom:e.device.isMobile?12:4},sectionMenuItem:{display:"flex"},icon:{height:14,width:14,fill:"currentColor"},pillIcon:{height:16,width:16,fill:"currentColor",marginRight:6},iconActiveDesktop:{height:14,width:14,fill:"currentColor",alignSelf:"flex-start",marginTop:2,marginRight:2},iconActiveDesktopWrapper:{marginTop:0},iconActiveMobile:{height:14,width:14,fill:"currentColor",marginTop:1,marginRight:6},popup:{paddingTop:12,paddingBottom:8},menuItemTitleDesktop:{width:"100%"},summary:{display:"inline-flex"},quickDatesWrapper:{marginTop:12,boxShadow:`0 1px 0 ${t.regularDividerColor}`,paddingBottom:15,marginBottom:15},clearButton:{color:t.mediumTextColor,fill:t.lightIconColor,fontWeight:500,fontSize:13,paddingLeft:2,paddingRight:2,paddingBottom:2,borderRadius:4,flexShrink:0},dateFilterHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginLeft:12,marginRight:12}}}function qs(e,t,s){t||(s&&s(),e.setState({...e.state,isOpen:!0,focus:"starting"}))}function Ks(e,t,s){const{temporaryDateRange:n,dateFilterType:r}=t.state;v.zD(e)||(Bs(r,n),t.setState({...t.state,isOpen:!1}),s&&s())}function Ns(e){const{dateFilterType:t}=e.state;Bs(t,{starting:void 0,ending:void 0}),e.clearTemporaryDateRange()}function Hs(e,t){if(e.error)return;t.setState({...t.state,temporaryDateRange:{...t.state.temporaryDateRange,...e.value}});const{dateFilterType:s,temporaryDateRange:n}=t.state,{starting:r,ending:i}=n;r&&i&&Bs(s,{starting:r,ending:i})}function Us(e){let{value:t,store:s}=e;const n=(0,o.Fg)(),a=(0,r.O7)(),{device:l}=a,{dateFilterType:d}=(0,i.VK)((()=>s.state),[s]),c={width:190,items:["createdTime","lastEditedTime"],selectedItem:d,getKey:e=>e,onSelect:e=>function(e,t,s){const{dateFilterType:n}=s.state;Bs(e,t),e!==n&&(Bs(n,{starting:void 0,ending:void 0}),s.setState({...s.state,dateFilterType:e}))}(e,t,s),renderItem:e=>(0,Se.jsx)(ee.Z,{title:As(e.value),...e}),renderOrigin:e=>(0,Se.jsx)(Y.Z,{...e,style:{paddingLeft:2,paddingRight:2,paddingBottom:2,borderRadius:4,flexShrink:0},children:(0,Se.jsxs)("div",{style:{display:"flex",alignItems:"center",...!l.isMobile&&{color:n.mediumTextColor,fill:n.lightIconColor,fontWeight:500,fontSize:13}},children:[(0,Se.jsx)("span",{style:{marginRight:4},children:As(d)}),(0,Se.jsx)(Es,{})]})})};return(0,Se.jsx)(Ps.Z,{...c,mobileActionSheet:!0})}function zs(e){let{disabled:t,onMenuOpen:s,icon:i,title:a,store:l}=e;const d=(0,o.Fg)(),c=(0,r.O7)(),u=(0,n.useCallback)((()=>qs(l,t,s)),[l,t,s]),h=_s(c,d);return(0,Se.jsx)(ee.Z,{disabled:t,focused:!1,icon:i(h.icon),title:a,onClick:u})}function Ws(e){let{disabled:t,onMenuOpen:s,title:i,value:a,dateFormat:l,store:d}=e;const c=(0,o.Fg)(),u=(0,r.O7)(),h=(0,H.useIntl)(),p=(0,n.useCallback)((()=>Ns(d)),[d]),g=(0,n.useCallback)((()=>qs(d,t,s)),[d,t,s]),m=_s(u,c),f=(0,Se.jsxs)("div",{style:m.summary,children:[(0,D.C)(m.iconActiveMobile),v._Q(a,h,l)]});return(0,Se.jsx)(Ue.Z,{disabled:t,onClick:g,onClickClear:p,label:i,title:f})}function Gs(e){let{disabled:t,onMenuOpen:s,icon:a,title:l,store:d}=e;const c=(0,o.Fg)(),u=(0,r.O7)(),h=(0,n.useCallback)((()=>qs(d,t,s)),[d,t,s]),p=_s(u,c),{dateFilterType:g}=(0,i.VK)((()=>d.state),[d]),m=(0,i.VK)((()=>I.ZP.state.query.filters[g].starting),[g]);return(0,Se.jsx)(Ne.Z,{on:Boolean(m),icon:a(p.pillIcon),title:(0,Se.jsx)("span",{children:l}),onClick:h})}function $s(e){let{onMenuDismiss:t,title:s,value:a,store:l}=e;const d=(0,o.Fg)(),c=(0,r.O7)(),u=(0,n.useCallback)((e=>Ks(e,l,t)),[l,t]),h=(0,n.useCallback)((e=>Hs(e,l)),[l]),p=(0,n.useCallback)((()=>Ns(l)),[l]),g=(0,i.VK)((()=>function(e){const{dateFilterType:t,temporaryDateRange:s}=e.state;return{...I.ZP.state.query.filters[t],...s}}(l)),[l]);return(0,Se.jsxs)(Se.Fragment,{children:[(0,Se.jsxs)("div",{style:_s(c,d).dateFilterHeader,children:[(0,Se.jsx)(Us,{value:a,store:l}),(0,Se.jsx)(Y.Z,{style:_s(c,d).clearButton,onClick:p,children:(0,Se.jsx)(H.FormattedMessage,{defaultMessage:"Clear",id:"searchDateFilter.clearButton.label"})})]}),(0,Se.jsxs)("div",{style:_s(c,d).quickDatesWrapper,children:[(0,Se.jsx)(Fs,{date:"today",onClick:h,onDismiss:u}),(0,Se.jsx)(Fs,{date:"pastWeek",onClick:h,onDismiss:u}),(0,Se.jsx)(Fs,{date:"pastMonth",onClick:h,onDismiss:u})]}),(0,Se.jsx)(Rs.Z,{title:s,value:g,onUpdate:h,store:l,onDismiss:u,hideDateInputMenuItems:!0})]})}function Qs(e){let{mode:t,onMenuDismiss:s,title:a,value:l,disabled:d,onMenuOpen:c,icon:u,store:h}=e;const p=(0,o.Fg)(),g=(0,r.O7)(),m=(0,n.useCallback)((e=>Ks(e,h,s)),[h,s]),f=(0,n.useCallback)((()=>(0,Se.jsx)($s,{onMenuDismiss:s,title:a,value:l,store:h})),[s,a,l,h]),v=_s(g,p),x=(0,i.VK)((()=>h.state.isOpen),[h]);return(0,Se.jsx)(ze.Z,{style:v.sectionMenuItem,children:(0,Se.jsx)(T.Z,{debugName:"SearchGenericDateFilter",capture:x,onUp:Vs,onDown:Vs,onEnter:Vs,children:(0,Se.jsx)(Ts.ZP,{popupType:Ds(g),open:x,origin:(0,Se.jsx)(Gs,{disabled:d,onMenuOpen:c,icon:u,title:a,store:h}),render:f,onDismiss:m,placementToOrigin:Ts.ZP.Placement.Bottom,alignmentToOrigin:Ts.ZP.Alignment.Start,keepFocus:!0,style:v.popup})})})}function Xs(e){let{mode:t,onMenuDismiss:s,title:r,value:o,disabled:a,onMenuOpen:l,dateFormat:d,intl:c,icon:u,store:h}=e;const p=(0,n.useCallback)((e=>Ks(e,h,s)),[h,s]),g=(0,n.useCallback)((()=>(0,Se.jsx)($s,{onMenuDismiss:s,title:r,value:o,store:h})),[s,r,o,h]),m=(0,i.VK)((()=>h.state.isOpen),[h]),f=t===xe.z.Section?(0,Se.jsx)(Ws,{disabled:a,onMenuOpen:l,title:r,value:o,dateFormat:d,store:h}):(0,Se.jsx)(zs,{disabled:a,onMenuOpen:l,icon:u,title:r,store:h});return(0,Se.jsx)(Ts.ZP,{popupType:Ts.ZP.PopupType.SlideUp,open:m,origin:f,render:g,onDismiss:p,preventScaleTransition:!0})}s(57658);var Js=s(22109);function Ys(e){const t=I.ZP.state.query.sort,s=os.find((e=>d.Xy(e.sort,t)))??os[0],n="relevance"===s.sort.field?(0,Se.jsx)(H.FormattedMessage,{id:"search.sort.sortOrder.bestMatches.title",defaultMessage:"Sort"}):s.formattedName;return(0,Se.jsx)(Ne.Z,{disabled:!1,title:n,onClick:e.onClick,icon:(0,Js.T)({width:16,marginRight:6,fill:"currentColor"})})}function en(){const e=I.ZP.state.query.sort,t=os.findIndex((t=>d.Xy(t.sort,e))),s=[];for(const n of os)s.push({key:n.key,render:e=>(0,Se.jsx)(ee.Z,{...e,title:n.formattedName}),action:()=>{I.ZP.setState({...I.ZP.state,query:{...I.ZP.state.query,sort:n.sort}})}});return(0,Se.jsx)(P.Z,{menuType:m.og.Popup,children:(0,Se.jsx)(tt.Z,{type:tt.i.Vertical,initialFocus:t<0?0:t,sections:[{key:"sortOptions",items:s,render:e=>(0,Se.jsx)(re.Z,{...e,disableDesktopPadding:!0})}]})})}const tn=function(e){const t=(0,o.yK)((()=>({popup:{paddingTop:12,paddingBottom:8}})),[]);return(0,Se.jsx)(te.ZP,{popupType:te.Z4.Popup,renderOrigin:Ys,render:en,disabled:!1,placementToOrigin:Ts.ZP.Placement.Bottom,alignmentToOrigin:Ts.ZP.Alignment.Start,style:t.popup,onClick:e.onMenuOpen,onClose:e.onMenuDismiss})},sn="SearchFilterSettings";function nn(e){const{isMobile:t}=e,{parentStore:s}=(0,n.useContext)(L.SearchStoresContext),{handlePopupOpen:a,handlePopupClose:l}=(0,n.useContext)(L.SearchStaticContext),c=(0,r.O7)(),u=(0,i.VK)((()=>c.currentUser.id),[c]),h=(0,i.VK)((()=>I.ZP),[]),p=(0,i.Kw)(h),g=p.query.filters,m=(0,i.VK)((()=>j.default.state.isPublicPageSearch),[]),f=(0,i.VK)((()=>(0,$.bq)()&&X.default.checkGate("enable_search_team_filter")&&!m),[m]),v=(0,i.VK)((()=>!m),[m]),x=!1,S=(0,o.yK)((e=>({scroller:{display:"flex",alignItems:"center",paddingTop:10,paddingRight:12,paddingBottom:10,paddingLeft:12},barContainer:{display:"flex",alignItems:"center"},scrollerContainer:{position:"relative",flexGrow:0,overflow:"hidden"},draggableList:{display:"flex",flexShrink:0,marginLeft:6},divider:{height:16,width:1,borderRadius:1,backgroundColor:e.stroke.deemphasized}})),[]),y=(0,n.useCallback)((e=>t=>h.updateFilters({[e]:t})),[h]),b=(0,n.useCallback)((e=>{const{onMenuDismiss:t,onMenuOpen:n}=e;if(v)return(0,Se.jsx)(Pe.Z,{mode:xe.z.Pill,focused:!1,title:(0,Se.jsx)(ys,{filterUIName:"personFilter"}),parentStore:s,userIds:g.createdBy,onMenuDismiss:t,onMenuOpen:n,onChange:y("createdBy")})}),[v,s,g.createdBy,y]),C=(0,n.useCallback)((e=>{const{onMenuDismiss:t,onMenuOpen:n}=e;return f&&(0,Se.jsx)(Ae,{mode:xe.z.Pill,focused:!1,title:(0,Se.jsx)(ys,{filterUIName:"teamsFilter"}),parentStore:s,teamIds:g.inTeams,onMenuDismiss:t,onMenuOpen:n,onChange:y("inTeams")})}),[s,g.inTeams,y,f]),M=(0,n.useCallback)((e=>{const{onMenuDismiss:t,onMenuOpen:n}=e;return(0,Se.jsx)(Ce,{mode:xe.z.Pill,focused:!1,title:(0,Se.jsx)(ys,{filterUIName:"pageFilter"}),parentStore:s,blockIds:g.ancestors,onMenuDismiss:t,onMenuOpen:n,onChange:y("ancestors")})}),[s,g.ancestors,y]),k=(0,n.useCallback)((()=>null),[s,g.dev_excludedPages,y,x]),w=(0,n.useCallback)((()=>null),[s,g.dev_excludedTeams,y,x]),T=(0,n.useCallback)((e=>{const{onMenuDismiss:t,onMenuOpen:s}=e;return(0,Se.jsx)(Os,{mode:xe.z.Pill,focused:!1,title:(0,Se.jsx)(ys,{filterUIName:"dateFilter"}),icon:D.C,value:g.lastEditedTime,onMenuDismiss:t,onMenuOpen:s})}),[g.lastEditedTime]),P=(0,n.useCallback)((()=>!t&&(0,Se.jsx)(We,{mode:xe.z.Pill,focused:!1,title:(0,Se.jsx)(ys,{filterUIName:"titleToggle"}),icon:hs,value:g.navigableBlockContentOnly||!1,onChange:y("navigableBlockContentOnly")})),[g.navigableBlockContentOnly,y,t]);(0,n.useEffect)((()=>{const e=ps.Z.get({userId:u,key:sn});e&&d.Xy(new Set(e.filterOrder),new Set(p.filterBar.order))&&!d.Xy(e.filterOrder,p.filterBar.order)&&e.filterOrder&&h.updateFilterOrder(e.filterOrder)}),[p.filterBar.order,u,h]);const R={onMenuOpen:a,onMenuDismiss:l},Z={titleToggle:P(),personFilter:b(R),teamsFilter:C(R),pageFilter:M(R),dateFilter:T(R),dev_notInPageFilter:k(),dev_notInTeamFilter:w()};const F=(0,n.useCallback)((e=>{const{onMenuDismiss:t,onMenuOpen:s}=e;return(0,Se.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,Se.jsx)(tn,{onMenuOpen:s,onMenuDismiss:t}),(0,Se.jsx)("div",{style:S.divider})]})}),[S.divider]);return(0,Se.jsx)("div",{style:S.barContainer,children:(0,Se.jsx)("div",{style:S.scrollerContainer,children:(0,Se.jsxs)(fs.Z,{type:gs.Z.X,style:S.scroller,showLeftRightOverlay:!1,children:[(0,Se.jsx)(Se.Fragment,{children:F(R)}),(0,Se.jsx)(Se.Fragment,{children:(0,Se.jsx)(ms.ZP,{direction:"horizontal",keys:p.filterBar.order,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,renderKey:e=>Z[e],style:S.draggableList,onDrop:e=>function(e){const t={filterOrder:e};ps.Z.set({userId:u,key:sn,value:t}),h.updateFilterOrder(e)}(e)})})]})})})}var rn=s(11751),on=s(87531),an=s(21273),ln=s(98180),dn=s(29798),cn=s(49085),un=s(12457),hn=s(75024),pn=s(68785),gn=s(50506),mn=s(63296),fn=s(25904),vn=s(54642),xn=s(47307),Sn=s(64964),yn=s(1310),bn=s(92660);const Cn=(0,H.defineMessages)({additionalInformationPlaceholder:{id:"SearchBadResultsForm.additionalInformation.placeholder",defaultMessage:"Add feedback..."},submitFailed:{id:"SearchBadResultsForm.submitFailed",defaultMessage:"Failed to submit report"},submitSuccess:{id:"SearchBadResultsForm.submitSuccess",defaultMessage:"Your report has been submitted, thanks!"},title:{id:"SearchBadResultsForm.title",defaultMessage:"Give search feedback"},warning:{id:"SearchBadResultsForm.warning",defaultMessage:"The pages from the search results will be sent to Notion for quality improvement"},cancel:{id:"SearchBadResultsForm.cancel",defaultMessage:"Cancel"},submit:{id:"SearchBadResultsForm.submit",defaultMessage:"Submit"},urlPlaceholder:{id:"SearchBadResultsForm.url.placeholder",defaultMessage:"Link to page you were looking for..."}});function Mn(){fn.Z.reset()}const jn=function(e){const{serverResults:t,localResults:s,exposedSearchExperiments:a,debugInfo:l}=e,d=null==l?void 0:l.traceLogs,{isMobile:c}=(0,r.Fy)(),u=(0,o.yK)((e=>({wrap:{display:"flex",flexDirection:"column",width:c?"min(100%, 600px)":void 0,minHeight:128,maxHeight:c?void 0:"max(calc(100vh - 78px), 300px)"},modalWrap:{width:"32rem",padding:24,fontSize:14,maxWidth:"100%"},modalTitle:{fontSize:16,fontWeight:z.Z.fontWeight.medium},modalWarning:{fontSize:13,color:e.lightTextColor},titleContainer:{marginBottom:12},buttonArea:{display:"flex",justifyContent:"flex-end",marginTop:18,gap:8},outlineButton:{marginRight:12},feedbackArea:{marginTop:17,padding:8}})),[c]),[h]=(0,n.useState)(I.ZP),p=(0,i.VK)((()=>y.default.state.currentSpaceStore),[]),[g,m]=(0,i.AF)(fn.Z),f=(0,r.O7)(),x=(0,n.useCallback)((()=>{!function(e){var t;let{searchStoreState:s,currentSpaceStore:n,serverResults:r,localResults:i,environment:o,exposedSearchExperiments:a,traceLogs:l}=e;const d=fn.Z.getState(),c=v.AX(r),u=v.AX(i),h=void 0,p={query:s.query,limit:s.limit,debug:h},{publicAccessPermissionAncestorBlockId:g}=v.bC(o),m=v.gC({input:p,spaceId:null==n?void 0:n.id,publicAccessPermissionAncestorBlockId:g,source:"report_bad_search"});if(!m)return;const f=null===(t=document.getElementsByClassName("search-results-list")[0])||void 0===t?void 0:t.outerHTML,x=c.some((e=>e.sources.includes(Fe.vp.VectorDBBlock)||e.sources.includes(Fe.vp.VectorDBCollection)));x&&c.splice(0,-20);const S=a?Object.fromEntries(a.entries()):{},y={queryText:s.query.text.trim(),apiRequest:m,serverResults:JSON.stringify(c,null,2),localResults:JSON.stringify(u,null,2),additionalInformation:d.additionalInformation,desiredUrl:d.desiredUrl,renderedHtml:f,experiments:JSON.stringify(S,null,2),isVectorSearchEnabled:x,traceLogs:null==l?void 0:l.log};vn.reportBadSearch(o,y).then((e=>{"failed"===e.type?xn.showErrorMessage((0,Se.jsx)("h1",{children:de.default.formatMessage(Cn.submitFailed)})):Sn.oV({label:de.default.formatMessage(Cn.submitSuccess),durationMs:yn.JY})})),fn.Z.reset()}({searchStoreState:h.state,currentSpaceStore:p,serverResults:t,localResults:s,exposedSearchExperiments:a,environment:f,traceLogs:d})}),[f,h,p,t,s,a,d]);return(0,Se.jsx)(bn.Z,{onDismiss:Mn,render:()=>(0,Se.jsx)(k.Z,{allowMobileAutoScroll:!0,capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:e=>(0,Se.jsx)("div",{style:u.wrap,children:(0,Se.jsxs)("div",{style:u.modalWrap,...e,children:[(0,Se.jsxs)("div",{style:u.titleContainer,children:[(0,Se.jsx)("div",{style:u.modalTitle,children:de.default.formatMessage(Cn.title)}),(0,Se.jsx)("div",{style:u.modalWarning,children:de.default.formatMessage(Cn.warning)})]}),(0,Se.jsx)(jt.Z,{placeholder:de.default.formatMessage(Cn.additionalInformationPlaceholder),value:g.additionalInformation,onChange:e=>{m({...g,additionalInformation:e.target.value})},focusInitial:!0,inputStyle:{padding:8},style:u.feedbackArea}),false,(0,Se.jsxs)("div",{style:u.buttonArea,children:[(0,Se.jsx)(mn.Z,{isLarge:!0,onClick:Mn,style:u.outlineButton,children:de.default.formatMessage(Cn.cancel)}),(0,Se.jsx)(mn.Z,{isRed:!0,isLarge:!0,onClick:x,disabledFeedback:!0,children:de.default.formatMessage(Cn.submit)})]})]})})}),requireOnline:!0,modalStore:fn.Z})};var In=s(59592);function kn(e){const[t,s]=(0,i.AF)(fn.Z),n=(0,o.yK)((t=>({button:{...(0,In.r)(t),...e.buttonStyles}})),[e.buttonStyles]);return(0,Se.jsxs)(mn.Z,{style:n.button,onClick:()=>{s({...t,open:!0})},children:[(0,Se.jsx)(H.FormattedMessage,{defaultMessage:"Give search feedback",id:"search.header.badSearch.button.label"}),(0,Se.jsx)(jn,{...e})]})}var wn=s(88357);const Tn=cn.default.createClass(!1),Pn=cn.default.createClass(!1);const Rn=function(e){var t;let{searchResultStore:s,shouldShow:n,showSpinner:a}=e;const l=(0,H.useIntl)(),d=(0,o.Fg)(),c=(0,r.O7)(),u=(0,i.qz)(void 0,Pn),h=(0,i.qz)(void 0,Tn),{localResults:p,serverResults:g}=(0,i.VK)((()=>s.state),[s]),{count:m,isLowerBound:v}=(0,i.VK)((()=>s.getResultCount()),[s]),x=(0,i.VK)((()=>(0,f.rd)(c)),[c]),S=(0,i.VK)((()=>!x&&X.default.checkGate("search-show-report-bad-search")),[x]);if(!n)return null;const y=Zn(c,d),b=function(e){return{footerText:{color:e.lightTextColor},resultCount:{color:e.mediumTextColor},keyboardShortcut:{color:e.mediumTextColor}}}(d),C={...y.resultCount,...b.resultCount},M=(0,Se.jsx)("span",{style:y.resultText,children:v?l.formatMessage({id:"SearchResultsFooter.helpText.resultCountApproximate",defaultMessage:"{resultCount, plural, other {<resultwrapper>{resultCount}+</resultwrapper> results}}"},{resultCount:m,resultwrapper:e=>(0,Se.jsx)("span",{style:C,children:e})}):l.formatMessage({id:"SearchResultsFooter.helpText.resultCount",defaultMessage:"{resultCount, plural, one {<resultwrapper>{resultCount}</resultwrapper> result} other {<resultwrapper>{resultCount}</resultwrapper> results}}"},{resultCount:m,resultwrapper:e=>(0,Se.jsx)("span",{style:C,children:e})})}),j=(0,f.XP)()||x,I=j?(0,Se.jsx)(wn.Z,{}):(0,Se.jsxs)("div",{style:y.resultCountWrapper,children:[j?void 0:(0,Se.jsxs)("div",{children:[M,(0,Se.jsx)(Fn,{showSpinner:a})]}),(0,Se.jsx)("div",{style:y.navigationHints,children:(0,Se.jsx)(wn.Z,{})})]});return(0,Se.jsx)(In.Z,{title:I,right:(0,Se.jsxs)(Se.Fragment,{children:[S&&(0,Se.jsx)(kn,{exposedSearchExperiments:null==g||null===(t=g.serverEventProperties)||void 0===t?void 0:t["server-searchExperiments"],localResults:null==p?void 0:p.results,serverResults:null==g?void 0:g.results,debugInfo:null==g?void 0:g.debugInfo}),(0,Se.jsx)(Ln,{searchResultStore:s,requestModalOpenStore:h,responseModalOpenStore:u})]})})};function Zn(e,t){return{footer:()=>{const{device:t}=e;return{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:t.isMobile?z.Z.fontSize.UIRegular.mobile:z.Z.fontSize.UIRegular.desktop}},footerText:{fontSize:hn.yv(e,"UISmall"),...z.Z.textOverflowStyle},inlineHint:{display:"inline",marginRight:16},resultCountWrapper:{display:"flex",alignItems:"center",...z.Z.textOverflowStyle},resultCount:{fontWeight:z.Z.fontWeight.medium},resultText:{verticalAlign:"middle",marginRight:6},spinner:{display:"inline",width:12,height:12,verticalAlign:"middle"},keyboardShortcut:{marginRight:4,marginBottom:1,fontVariant:"all-small-caps",fontSize:1.1*hn.yv(e,"UISmall")},commandGlyph:{fontSize:.75*hn.yv(e,"UIRegular")},footerDebugButton:(0,In.r)(t),debugModalStyle:{maxHeight:"90vh",maxWidth:"90vw",height:"90vh",width:"90vw",overflow:"scroll",padding:10},navigationHints:{marginLeft:15}}}function Fn(e){let{showSpinner:t}=e;const s=(0,o.Fg)(),n=Zn((0,r.O7)(),s);return(0,Se.jsx)(un.Z,{show:t,showDelay:500,showHold:200,render:e=>e&&(0,Se.jsx)(pn.Z,{style:n.spinner})})}function Ln(e){var t;let{searchResultStore:s,requestModalOpenStore:n,responseModalOpenStore:a}=e;const l=(0,o.Fg)(),d=(0,r.O7)(),{debug:c,showDebugInfo:u}=(0,i.VK)((()=>M.ZP.state),[]),{serverResults:h}=(0,i.VK)((()=>s.state),[s]),p=(0,i.VK)((()=>n.state),[n]),g=(0,i.VK)((()=>a.state),[a]);if(!c&&!u)return null;const{rawRequests:m,rawResponses:f}=(null==h||null===(t=h.debugInfo)||void 0===t?void 0:t.response)||{};return(0,Se.jsxs)(Se.Fragment,{children:[m&&(0,Se.jsxs)(Se.Fragment,{children:[(0,Se.jsx)(gn.Z,{open:p,innerStyle:Zn(d,l).debugModalStyle,onDismiss:()=>{n.setState(!1)},render:()=>(0,Se.jsx)(ue.LazyAdminReactJson,{showCopyButton:"large",defaultCollapsed:!1,data:m})}),(0,Se.jsx)(mn.Z,{style:Zn(d,l).footerDebugButton,onClick:()=>n.setState(!0),children:"Open Request"})]}),f&&(0,Se.jsxs)(Se.Fragment,{children:[(0,Se.jsx)(gn.Z,{open:g,innerStyle:Zn(d,l).debugModalStyle,onDismiss:()=>{a.setState(!1)},render:()=>(0,Se.jsx)(ue.LazyAdminReactJson,{showCopyButton:"large",data:{rawResponses:f},defaultCollapsed:!1})}),(0,Se.jsx)(mn.Z,{style:Zn(d,l).footerDebugButton,onClick:()=>a.setState(!0),children:"Open Response"})]})]})}var On=s(36896),Bn=s(44604),An=s(36596),Dn=s(43765),En=s(43145),Vn=s(17576),_n=s(39634),qn=s(16354);const Kn=function(e){const{style:t,captionStyle:s,title:n,caption:i}=e,o=(0,r.O7)(),a=Un(o),l={...a.menuItem,...t},d={...a.caption,...s};return(0,Se.jsx)(ts.Z,{...e,title:(0,Se.jsx)(zn,{title:n}),caption:(0,Se.jsx)(Hn,{caption:i,captionStyle:d}),textWrapperStyle:Un(o).text,style:l,captionStyle:d})};function Nn(e){return{title:{color:e.mediumTextColor},caption:{color:e.lightTextColor}}}function Hn(e){let{captionStyle:t,caption:s}=e;const n=(0,o.Fg)();if(!s)return null;const r={...t,...Nn(n).caption};return(0,Se.jsx)("div",{style:r,children:s})}function Un(e){return{menuItem:{minHeight:void 0,...e.device.isMobile&&{background:void 0,boxShadow:void 0},paddingTop:32,paddingBottom:32},text:{textAlign:"center"},title:{margin:0,fontWeight:z.Z.fontWeight.medium,fontSize:hn.yv(e,"UIRegular"),lineHeight:hn.Dp(e,"UIRegular")},caption:{fontSize:hn.yv(e,"UIRegular")}}}function zn(e){let{title:t}=e;const s=(0,o.Fg)(),n=(0,r.O7)();if(!t)return null;const i=Un(n),a=Nn(s),l={...i.title,...a.title};return(0,Se.jsx)("div",{role:"alert",style:l,children:t})}const Wn=(0,Se.jsx)(H.FormattedMessage,{defaultMessage:"No results",id:"searchErrorMenuItem.error.noResults"});const Gn=function(e){const t=(0,o.yK)((e=>({menuItem:{marginTop:"auto",marginBottom:"auto"},caption:{marginTop:"auto"},reportProblemButton:{display:"inline",color:e.blueColor},searchDeletedButton:{display:"inline",lineHeight:"25px",color:e.blueColor}})),[]),s=(0,r.O7)(),{isQuickSearch:a}=(0,n.useContext)(L.SearchStaticContext),l=()=>{_n.j({environment:s,from:"quick_find"})};function d(s){const n=function(s){if(s)return;const n=v.FN(c);if(!v.VD.isDeletedOnly(c.isDeletedOnly))return(0,Se.jsx)(H.FormattedMessage,{id:"searchErrorMenuItem.errorPrompt.searchDeleted",defaultMessage:"Some results may be in your deleted pages.{br}<searchdeleted>Search deleted pages</searchdeleted>",values:{searchdeleted:s=>(0,Se.jsx)(qn.Z,{onClick:e.handleSearchDeletedOnly,style:t.searchDeletedButton,children:s}),br:(0,Se.jsx)("br",{})}});return n?(0,Se.jsx)(H.FormattedMessage,{defaultMessage:"Try different search terms or filters",id:"searchErrorMenuItem.errorPrompt.searchTermsAndFilters"}):(0,Se.jsx)(H.FormattedMessage,{defaultMessage:"Try different search terms",id:"searchErrorMenuItem.errorPrompt.searchTerms"})}(s);return{title:Wn,caption:n}}const c=(0,i.VK)((()=>I.ZP.state.query.filters),[]);return(0,Se.jsx)(Kn,{...function(s){const n=e.error;switch(n.type){case Fe.Ix.NoResults.type:return d(s);case Fe.Ix.Offline.type:return function(){const e=(0,Se.jsx)(H.FormattedMessage,{defaultMessage:"Go online for more results.",id:"searchErrorMenuItem.errorPrompt.goOnline"});return{title:Wn,caption:e}}();case Fe.Ix.RequestFailed.type:return{title:(0,Se.jsx)(H.FormattedMessage,{id:"searchErrorMenuItem.error.genericErrorMessage",defaultMessage:"Something went wrong"}),caption:(0,Se.jsx)(H.FormattedMessage,{id:"searchErrorMenuItem.errorPrompt.refreshOrReport",defaultMessage:"Try refreshing or <reportlink>report a problem</reportlink>.",values:{reportlink:e=>(0,Se.jsx)(qn.Z,{onClick:l,style:t.reportProblemButton,children:e})}})};default:(0,U.t1)(n)}}(a??!1),style:t.menuItem,captionStyle:t.caption,shouldWrapCaption:!0})};var $n=s(69680);const Qn=8;function Xn(e){const{numberOfShimmerResults:t,assistantActionsEnabled:s}=e,n=t===Qn&&s,r=(0,o.yK)((e=>({container:{margin:(n?"0px":"8px")+" 10px 6px 10px",display:"flex",flexDirection:"column",gap:10},icon:{width:20,height:20,borderRadius:5,marginLeft:6},titleAndPath:{width:"100%",display:"flex",flexDirection:"column",gap:5},title:{height:18,borderRadius:5},path:{height:12,borderRadius:5},resultContainer:{display:"flex",gap:10,boxShadow:`0 1px 0 ${e.lightDividerColor}`,paddingBottom:10},sectionHeader:{marginBottom:7,marginTop:8}})),[n]),i=Array.from({length:t},(()=>!0));return(0,Se.jsxs)("div",{children:[n&&(0,Se.jsx)(re.Z,{desktopTitleStyle:r.sectionHeader,title:(0,Se.jsx)(H.FormattedMessage,{id:"search.searchResultsShimmer.bestMatches.text",defaultMessage:"Best matches"})}),(0,Se.jsx)("div",{style:r.container,children:i.map(((e,t)=>(0,Se.jsxs)("div",{style:{...r.resultContainer,...t===i.length-1&&{boxShadow:"none"}},children:[(0,Se.jsx)(An.Z,{style:r.icon}),(0,Se.jsxs)("div",{style:r.titleAndPath,children:[(0,Se.jsx)(An.Z,{style:{...r.title,width:d.UP(["30%","45%","55%","60%","70%","75%","80%","90%"])}}),(0,Se.jsx)(An.Z,{style:{...r.path,width:d.UP(["10%","15%","20%","25%","30%","35%","55%","70%"])}})]})]},`shimmer-item-${t}`)))})]})}const Jn=n.memo(Xn);function Yn(e,t,s){if(!t.isLoading)return t.showMajorError?(0,Se.jsx)(Gn,{error:t.serverError,handleSearchDeletedOnly:()=>{const t=I.ZP.state.query.text;on.IB(e),On.Z.setState({...On.Z.state,open:!0}),Bn.Z.setState({...Bn.Z.state,currentTab:"all_pages",filter:t,limit:Bn.Z.startLimit})}}):t.serverError&&t.serverError!==Fe.Ix.NoResults?function(e,t){return(0,Se.jsx)(re.Z,{disableMobilePadding:!0,disableMobileBorders:!0,children:(0,Se.jsx)(Dn.Z,{title:e,style:t})})}(t.serverError.message,s):void 0}function er(e,t){return(0,Se.jsx)(re.Z,{disableMobilePadding:!0,disableMobileBorders:!0,topBorder:!1,style:{marginTop:0,paddingTop:0},children:(0,Se.jsx)(ts.Z,{body:e,bodyStyle:t})})}const tr=(0,H.injectIntl)((function(e){var t,s,a,l,c,u,h;const[g,m]=(0,n.useState)(!1),x=(0,r.Fy)().isMobile,S=(0,o.yK)((e=>({results:{flex:1,display:"flex",flexDirection:"column",overflow:"auto",height:"100%"},messageMenuItem:{...x&&{background:void 0,boxShadow:void 0}},debugMessageMenuItemTextStyle:{whiteSpace:"pre-wrap",fontFamily:"monospace",marginTop:0},actionMenuItemTitle:{fontWeight:z.Z.fontWeight.medium,lineHeight:"20px",fontSize:15,color:e.mediumTextColor,textOverflow:"ellipsis",overflow:"hidden",display:"block"},menuListContainer:{display:"flex",flexDirection:"column",gap:12,marginTop:x?13:void 0,marginBottom:4}})),[x]),{searchResultStore:y,localResults:b,serverResults:C,resultListStore:j,searchExperimentOverrides:k,intl:w,showActions:T,extraTopPadding:P}=e,R=e.errorState,Z=(0,i.VK)((()=>I.ZP.state.query.text),[]),{focusedIndexStore:F}=(0,n.useContext)(L.SearchStaticContext),B=(0,i.VK)((()=>{var e;return null===(e=F.state)||void 0===e?void 0:e.global}),[F]),A=(0,i.VK)((()=>T.length),[T]),D=A>0?{key:"actions",render:e=>(0,Se.jsx)(re.Z,{...e,shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,extraTopPadding:P,title:(0,Se.jsx)(H.FormattedMessage,{id:"search.searchActions.actions.text",defaultMessage:"Actions"}),titleClassName:p.Xjk}),items:d.oA(T.map(((e,t)=>function(e){const{type:t,title:s,icon:n,action:r,shouldShowArrowUp:i}=e;return{key:`actionMenuItem.${t}`,action:r,render:e=>(0,Se.jsx)(Vn.Z,{type:t,...e,title:s,icon:n,shouldShowArrowUp:i})}}({...e,title:e.renderTitle(Z,w,S.actionMenuItemTitle),shouldShowArrowUp:void 0!==e.shouldShowArrowUp&&e.shouldShowArrowUp({currentGlobalFocusedIndex:B,actionItemCount:A})}))))}:void 0,E=(0,i.VK)((()=>(0,f.XP)()),[]),V=(0,v.IV)({intentBasedGrouping:E,localResults:b,serverResults:C}),{allSearchResults:_}=V,q=(0,n.useCallback)((t=>{const{results:s,sectionTitle:r,compact:i,rendersTimeSinceLastViewedMs:o}=t,{id:a,title:l}=function(e){if(!e)return{id:"allSearchResults",title:void 0};switch(e.type){case"unique-id":return{id:"uniqueIdSearchResults",title:(0,Se.jsx)(H.FormattedMessage,{id:"search.searchResultBuckets.uniqueID.text",defaultMessage:"ID matches"})};case"jump-back-in":return{id:"jumpBackInSearchResults",title:(0,Se.jsx)(H.FormattedMessage,{id:"search.searchResultBuckets.topResults.text",defaultMessage:"Top results"})};case"server":return{id:"serverOnlySearchResults",title:(0,Se.jsx)(H.FormattedMessage,{id:"search.searchResultBuckets.server.text",defaultMessage:"{count}{maybeLowerBoundSign} results",values:{count:e.values.count,maybeLowerBoundSign:e.values.isLowerBound?"+":""}})};case"main":return{id:"mainSearchResults",title:(0,Se.jsx)(H.FormattedMessage,{id:"search.searchResultBuckets.bestMatches.text",defaultMessage:"Best matches"})};default:(0,U.t1)(e)}}(r);return s.length>0?{key:a,render:e=>(0,Se.jsx)(re.Z,{...e,shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,title:l,titleClassName:p.Xjk}),items:d.oA(s.map(((t,s)=>{var r,a;return function(e){var t;const{selectedResult:s,index:r,actionItemCount:i,allSearchResults:o,props:a,compact:l,timeSinceLastViewedMs:d}=e,{store:c}=s,u=c.isNavigableBlock()?c:c.getNavigableBlockStore();if(!u)return;const h=n.createRef(),g=Boolean(M.ZP.getDebugLevel()),m=g&&s.sources.includes(Fe.vp.Local)?{score:s.score,frecencyScore:s.frecencyScore,localSource:s.localSource,personalizationBoost:s.personalizationBoost,id:s.id,terms:s.terms}:void 0,f=g&&(s.sources.includes(Fe.vp.ElasticSearch)||s.sources.includes(Fe.vp.VectorDBBlock)||s.sources.includes(Fe.vp.VectorDBCollection))?null===(t=a.debugInfo)||void 0===t||null===(t=t.response)||void 0===t?void 0:t.resultsDebugMap[c.id]:void 0,v=a.clusterInfo,x=Date.now();return{key:`${c.id}:${r}`,action:e=>{const{event:t}=e;function n(e){const s=O.findDOMNode(e.current);return Boolean(s&&"target"in t&&t.target&&(s===t.target||s.contains(t.target)))}h.current&&n(h)||a.handleSelectResult({event:e.event,index:{local:e.indexLocal,global:e.index},selectedResult:s,allSearchResults:o,fromSidePeekPanel:!1,actionItemCount:i,context:"query_results"})},render:e=>{var t;return(0,Se.jsx)($n.Z,{...e,index:r,originalPosition:s.originalPosition,isFirstInSection:0===r,store:u,hidePath:!1,result:s,className:p.ulv,debugLocal:m,debugHits:f,debugAreaRef:h,clusterInfo:v,inline:l&&!g,inlineCaptionMinWidthPercentage:20,lastViewed:d?x-d:void 0,queryId:null===(t=s.serverEventProperties)||void 0===t?void 0:t["server-queryId"],type:"query_results"})}}}({selectedResult:t,index:s,actionItemCount:(null==D||null===(r=D.items)||void 0===r?void 0:r.length)??0,allSearchResults:_,props:e,compact:i,timeSinceLastViewedMs:o&&null!==(a=t.localSource)&&void 0!==a&&a.has("recentVisit")?t.timeSinceLastViewedMs:void 0})})))}:void 0}),[null==D||null===(t=D.items)||void 0===t?void 0:t.length,_,e]),K=(0,i.VK)((()=>q({results:"intent-based-grouping"===V.type?V.sections.jumpBackInSearchResults:[],sectionTitle:{type:"jump-back-in"},compact:!0,rendersTimeSinceLastViewedMs:!0})),[q,V.sections,V.type]),N=(0,i.VK)((()=>{const e="intent-based-grouping"===V.type?V.sections.serverOnlySearchResults:[],{count:t,isLowerBound:s}=y.getResultCount();return q({results:e,sectionTitle:{type:"server",values:{count:t,isLowerBound:s}},compact:!1})}),[q,V.sections,V.type,y]),W=(0,i.VK)((()=>q({results:"uniqueIdSearchResults"in V.sections?V.sections.uniqueIdSearchResults:[],sectionTitle:{type:"unique-id"},compact:!1})),[q,V.sections]),G=(0,i.VK)((()=>q({results:"unique-id"===V.type?V.sections.nonUniqueIdSearchResults:"all"===V.type?V.sections.allSearchResults:[],sectionTitle:"unique-id"===V.type||((null==D?void 0:D.items)??[]).length>0?{type:"main"}:void 0,compact:!1})),[null==D?void 0:D.items,q,V.sections,V.type]),$=[D,K,W,N,G].filter(U.$K),Q=null===(s=e.debugInfo)||void 0===s||null===(s=s.response)||void 0===s?void 0:s.parsedQueries,X=null===(a=e.debugInfo)||void 0===a||null===(a=a.response)||void 0===a?void 0:a.detectedLanguages,J=null===(l=e.debugInfo)||void 0===l?void 0:l.traceLogs,Y=null===(c=e.debugInfo)||void 0===c||null===(c=c.response)||void 0===c?void 0:c.debugUrls,ee=(0,n.useCallback)(((t,s)=>{const{onMaybeLoadMoreResults:n}=e,r=t<=200;r&&!g&&n(),m(r),s.offsetFromTop&&I.ZP.update((e=>({...e,hasScrolled:!0})))}),[g,e]),te=0===((null==b?void 0:b.length)??0)&&"serverError"in R&&"NoResultsFound"===(null===(u=R.serverError)||void 0===u?void 0:u.type)?0:(null==D||null===(h=D.items)||void 0===h?void 0:h.length)??0,se=(0,i.VK)((()=>an.Z.showSearchAiFeatures()),[]),ne=(0,r.O7)(),ie=(0,i.VK)((()=>{const e=void 0===C;if(!(e&&(se||(0,f.rd)(ne))))return 0;const t=y.state.serverResultsLoading,s=(null==b?void 0:b.length)??0,n="serverError"in R&&void 0!==R.serverError;return(e&&!t||t)&&!n?Qn-s:0}),[ne,y,null==b?void 0:b.length,C,R,se]);return(0,Se.jsx)(L.SearchStaticContext.Consumer,{children:e=>{let{queryResultsSectionRef:t}=e;return(0,Se.jsxs)("section",{style:S.results,ref:t,children:[!d.xb(k)&&er((0,Se.jsx)(Se.Fragment,{children:(0,Se.jsx)(ue.LazyAdminReactJson,{data:{searchExperimentOverrides:k},showCopyButton:!1,showModalButton:!1,defaultCollapsed:!1})}),S.debugMessageMenuItemTextStyle),Q&&er((0,Se.jsx)(ue.LazyAdminReactJson,{data:{parsedQueries:Q},customCollapsedRenderers:[or],showCopyButton:"small",showModalButton:!0,defaultCollapsed:!0}),S.debugMessageMenuItemTextStyle),X&&er((0,Se.jsx)(ue.LazyAdminReactJson,{data:{detectedLanguages:X},customCollapsedRenderers:[rr]}),S.debugMessageMenuItemTextStyle),J&&er((0,Se.jsx)(ue.LazyAdminReactJson,{data:{tracer:{traceLogs:J}},customCollapsedRenderers:[nr],defaultCollapsed:!0}),S.debugMessageMenuItemTextStyle),Y&&er((0,Se.jsx)(ue.LazyAdminReactJson,{data:{debugUrls:Y},defaultCollapsed:!0,customCollapsedRenderers:[lr],showCopyButton:"small",showModalButton:!0,maxLinkValueLength:40}),S.debugMessageMenuItemTextStyle),$&&(0,Se.jsx)("div",{className:"search-results-list",children:(0,Se.jsx)(tt.Z,{type:tt.i.Vertical,initialFocus:te,store:j,disableKeyboardArrowWrap:!0,sections:$,style:S.menuListContainer})}),Yn(ne,R,S.messageMenuItem)||(0,Se.jsx)(En.Z,{onChange:ee}),ie>0&&(0,Se.jsx)(Jn,{numberOfShimmerResults:ie,assistantActionsEnabled:se})]})}})}));function sr(e){const t=e.replaceAll(/\(MatchNoDocsQuery\("Matching no documents because no terms present"\)\)\^[0-9\.]/g,"").replaceAll(/MatchNoDocsQuery\("Matching no documents because no terms present"\)/g,"").replaceAll(/ConstantScore\(([^)]+):([^)]+)\)/g,"<i>$1</i>:<b>$2</b>").replace(/function score \(\((.*)\), functions:.*\)/,"$1").replaceAll("( ","(").replaceAll(" )",")").replaceAll("|","| <br/>").replaceAll(/([^( ]+):"([^"]+)"/g,'<i>$1</i>:<b>"$2"</b>').replaceAll(/([^( ]+):([^) ]+)/g,"<i>$1</i>:<b>$2</b>");return(0,Se.jsx)("span",{dangerouslySetInnerHTML:{__html:t}})}function nr(e){let{data:t,keyPath:s}=e;if("traceLogs"===(null==s?void 0:s[0])&&d.PO(t)&&Array.isArray(t.log)&&t.log.length>0){const{log:e,startTimeMs:s}=t;return{element:(0,Se.jsxs)(Se.Fragment,{children:[(0,Se.jsx)("div",{children:(0,Se.jsx)("b",{children:`Trace started at ${s}`})}),e.map(((e,t)=>(0,Se.jsxs)("div",{children:[(0,Se.jsx)("span",{style:ar,children:`[${e.timestamp-s}ms][${e.callerFileName.split(".")[0]}]`}),(0,Se.jsx)("span",{children:`${e.msg}`})]},t)))]}),expanded:!1}}return null}function rr(e){let{data:t,keyPath:s}=e;return"detectedLanguages"===s.join(".")&&d.PO(t)?{element:(0,Se.jsx)(Se.Fragment,{children:Object.entries(t).filter((e=>{let[t,s]=e;return Boolean(s)})).map((e=>{let[t]=e;return t})).join(", ")||"None"}),expanded:!1}:null}const ir=["type","description","time_in_nanos"];function or(e){var t,s;let{data:n,keyPath:r}=e;const i=n,o=Object.values(i).find((e=>void 0!==e));if(!o)return null;if(!ir.every((e=>o[e])))return null;if(1===r.length)return{element:sr(o.description),expanded:!1};let a=o.description??"";return null!==(t=a)&&void 0!==t&&t.includes("permissions.teamIds")&&(a="PermissionsQuery"),null!==(s=a)&&void 0!==s&&s.includes("(_id:[")&&(a="BoostRecentPageIds"),{element:sr(a),expanded:!1}}const ar={color:"blue"};function lr(e){let{data:t}=e;const s=t;if(!s)return null;const n=Object.values(s).find((e=>{let{clusterName:t}=e;return void 0!==t}));if(n){const{clusterName:e}=n;return{element:(0,Se.jsx)(Se.Fragment,{children:e}),expanded:!1}}return{element:(0,Se.jsx)(Se.Fragment,{children:"unknown"}),expanded:!1}}const dr=function(e){const{searchResultStore:t,sxsMode:s,searchDebugColumnStore:a,extraTopPadding:l}=e,d=(0,r.O7)(),c=(0,r.Fy)(),u=(0,i.VK)((()=>an.Z.shouldShowSearchMenuItemAskAI(c)),[c]),h=(0,o.yK)((e=>({container:{display:"flex",flexDirection:"column",width:s?"50%":"100%",flex:1,overflow:"hidden",paddingTop:u?void 0:5},askAiLabel:{color:e.regularTextColor,fontWeight:z.Z.fontWeight.medium,fontSize:14},askAiQuery:{fontWeight:z.Z.fontWeight.regular},askAiIcon:{fill:e.aiPurpleColor}})),[s,u]),p=(0,i.qz)(void 0,dn.Z),g=(0,i.VK)((()=>p.state.focus),[p]),{handleSelectSearchResult:m,focusedIndexStore:x,searchActionItemsStore:S}=(0,n.useContext)(L.SearchStaticContext),{localResults:y,serverResults:C,clusterInfo:j,debugInfo:k,serverResultsLoading:w,searchExperimentOverrides:T,hasPublicAccessPermission:P,errorState:R,serverResultsAllLoaded:Z}=(0,i.VK)((()=>{var e,s;const{hasPublicAccessPermission:n}=v.bC(d);return{localResults:t.state.localResults,serverResults:t.state.serverResults,serverResultsLoading:t.state.serverResultsLoading,clusterInfo:null===(e=t.state.serverResults)||void 0===e?void 0:e.clusterInfo,debugInfo:null===(s=t.state.serverResults)||void 0===s?void 0:s.debugInfo,searchExperimentOverrides:a.state.searchExperimentOverrides,hasPublicAccessPermission:n,errorState:t.state.errorState,serverResultsAllLoaded:t.state.serverResultsAllLoaded}}),[t,a,d]),F=!1===R.isLoading&&R.showMajorError,O=Boolean(y||C),B=(0,n.useCallback)((()=>{!w&&!Z&&void 0!==C&&I.ZP.update((e=>({...e,limit:e.limit+I.Xv,isScrolled:!0,source:"quick_find_scroll"})))}),[w,Z,C]),A=(0,i.VK)((()=>v.oO({localResults:null==y?void 0:y.results,serverResults:null==C?void 0:C.results})),[y,C]),D=(0,i.VK)((()=>{if(s)return[];const e=[{type:"assistant",renderTitle:(e,t,s)=>function(e,t){return(0,Se.jsx)("div",{className:"notranslate",style:t,children:e})}((0,Se.jsxs)(Se.Fragment,{children:[(0,Se.jsx)("span",{children:(0,Se.jsx)(H.FormattedMessage,{id:"searchResultsBody.askAiMenuItem.title",defaultMessage:"Ask AI"})}),(0,Se.jsx)("span",{style:h.askAiQuery,children:e?` “${e}”`:""})]}),{...s,...h.askAiLabel}),icon:e=>(0,rn.t)({...e,...h.askAiIcon}),action:()=>{on.Ky({environment:d,shouldResetAssistantStore:I.ZP.state.query.text.length>0||ln.Z.wasActiveSessionLastOpenedOutsideOfHistorySavedWindow()})},shouldShow:()=>b.Z.state.online&&an.Z.shouldShowSearchMenuItemAskAI(c),shouldShowArrowUp:e=>{let{currentGlobalFocusedIndex:t,actionItemCount:s}=e;return void 0!==t&&t===s}}];return e.filter((e=>e.shouldShow(d)))}),[s,h.askAiQuery,h.askAiLabel,h.askAiIcon,d,c],{useDeepEqual:!0}),E=(0,i.VK)((()=>{if(s)return 0;{const e=D.map((e=>({type:e.type})));return S.update((t=>e)),S.state.length}}),[s,D,S]);(0,i.VK)((()=>{const e=t.state.insertedActionResultsCount,s=E;e!==s&&t.update((e=>({...e,insertedActionResultsCount:s})))}),[t,E]);const V=(0,n.useCallback)((()=>p.update((e=>e.focus.isInitialized&&0===e.focus.section&&0===e.focus.indexLocal&&0===e.focus.indexGlobal||void 0!==A&&void 0!==e.focus.indexGlobal&&e.focus.indexGlobal<=A.length?e:{...e,focus:D.length>0?{section:1,indexLocal:0,indexGlobal:D.length}:{section:0,indexLocal:0,indexGlobal:0}}))),[p,D,A]);(0,n.useEffect)((()=>{V()}),[A,V]),(0,n.useEffect)((()=>{void 0!==g.section&&void 0!==g.indexLocal&&void 0!==g.indexGlobal?x.setState({local:{section:g.section,indexLocal:g.indexLocal},global:g.indexGlobal}):x.setState(void 0)}),[x,g]);const _=(0,i.VK)((()=>{const e=M.ZP.state.showDebugInfo;return!F&&O&&!c.isMobile&&!(0,f.rd)(d)||e||s}),[c.isMobile,O,F,s,d]);return(0,Se.jsxs)("div",{style:h.container,children:[(0,Se.jsx)(tr,{errorState:R,handleSelectResult:m,onMaybeLoadMoreResults:B,resultListStore:p,searchResultStore:t,localResults:null==y?void 0:y.results,serverResults:null==C?void 0:C.results,debugInfo:k,clusterInfo:j,publicAccessPermission:P,searchExperimentOverrides:T,showActions:D,extraTopPadding:l}),(0,Se.jsx)(Rn,{searchResultStore:t,showSpinner:w,shouldShow:_})]})};function cr(e){const{searchContentPaneType:t}=e,{searchFilterMenuRef:s,handleSelectSearchResult:a,searchResultStore:l,secondarySearchResultStore:d}=(0,n.useContext)(L.SearchStaticContext),c=(0,r.Fy)(),{errorState:u,shouldShowSxSView:h}=(0,i.VK)((()=>({shouldShowSxSView:Boolean((0,M.gq)({device:c})&&M.BJ.state.visible),errorState:l.state.errorState})),[l,c]),p=(0,o.yK)((()=>({container:{display:"flex",flexDirection:"column",width:h?"50%":"100%"},sxsContainer:{display:"flex",flexDirection:"row",height:"100%",overflow:"hidden",maxWidth:"100%"}})),[h]),g=!1===u.isLoading&&u.showMajorError,m=(0,i.VK)((()=>I.ZP.state.filterBar.show),[]),f=!c.isMobile&&!m,v={searchResultStore:l,searchDebugColumnStore:M.v_,sxsMode:h,extraTopPadding:f},x=(0,i.VK)((()=>{var e;return null===(e=y.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]);return(0,Se.jsxs)(Se.Fragment,{children:[!c.isMobile&&m&&(0,Se.jsx)(nn,{isMobile:c.isMobile}),"search_results"===t?(0,Se.jsxs)(Se.Fragment,{children:[!g&&c.isMobile&&(0,Se.jsx)(Rt,{isMobile:!0,mode:kt.Section,ref:s}),(0,Se.jsxs)("div",{style:p.sxsContainer,children:[(0,Se.jsx)(dr,{...v}),h&&(0,Se.jsx)(dr,{...v,searchResultStore:d,searchDebugColumnStore:M.BJ})]})]}):x?(0,Se.jsx)(us.Z,{onSelect:a,spaceId:x,extraTopPadding:f}):null]})}var ur=s(66897),hr=s(97439),pr=s(27714),gr=s(18442),mr=s(90683),fr=s(37034),vr=s(16402),xr=s(10912),Sr=s(73063),yr=s(58261),br=s(84076),Cr=s(26388);function Mr(e){const{itemName:t,itemValue:s,associatedUser:n}=e,r=(0,o.yK)((e=>({itemName:{fontSize:12,color:e.lightTextColor},itemValue:{fontSize:12,...n&&{display:"grid",gridTemplateColumns:"1fr auto auto",gap:5,textAlign:"right"}},itemContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:12},metadataActorName:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}})),[n]),i=n;return(0,Se.jsxs)("div",{style:r.itemContainer,children:[(0,Se.jsx)("div",{style:r.itemName,children:t}),(0,Se.jsxs)("div",{style:r.itemValue,children:[i&&(0,Se.jsxs)(Se.Fragment,{children:[(0,Se.jsx)(Cr.ZP,{delayThreshold:50,placement:Cr.ug.Top,allowHover:!0,renderTooltip:()=>(0,Se.jsxs)("div",{style:{display:"flex",gap:5},children:[i.avatar,i.name]}),closeDelay:0,render:e=>(0,Se.jsx)("span",{...e,style:r.metadataActorName,children:i.name})}),(0,Se.jsx)("span",{children:"·"})]}),(0,Se.jsx)("span",{children:s})]})]})}const jr={createdBy:(0,Se.jsx)(H.FormattedMessage,{id:"search.preview.metadata.createdBy",defaultMessage:"Created by"}),created:(0,Se.jsx)(H.FormattedMessage,{id:"search.preview.metadata.created",defaultMessage:"Created"}),lastEditedBy:(0,Se.jsx)(H.FormattedMessage,{id:"search.preview.metadata.lastEditedBy",defaultMessage:"Last edited by"}),lastEdited:(0,Se.jsx)(H.FormattedMessage,{id:"search.preview.metadata.lastEdited",defaultMessage:"Edited"})},Ir={type:"page_content"},kr="large";function wr(e){var t;const{selectedResult:s,onClickPreview:l,handleClickCopyLink:d}=e,c="page_result"===s.type,h=(0,o.yK)((e=>({sidePeekPanel:{width:250,overflowY:"auto",overflowX:"hidden",minHeight:400,borderLeft:`1px solid ${e.lightDividerColor}`,display:"flex",flexDirection:c?"column":"row",justifyContent:c?"space-between":"center",alignItems:c?"normal":"center",zIndex:1},emoji:{width:20},sidePeekContentContainer:{margin:16},report:{fontSize:12,position:"absolute",bottom:0,right:0,margin:16,display:"flex",gap:10},sidePeekActionContainer:{margin:16},pageIconAndTitleContainer:{marginTop:12,display:"flex",gap:8,flexDirection:"column",justifyContent:"space-between"},title:{fontSize:16,fontWeight:z.Z.fontWeight.semibold,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},untitledPageColor:{color:e.text.tertiary},titleAndLinkContainer:{display:"grid",gridTemplateColumns:"1fr auto",width:"fit-content",gap:5},previewContainer:{marginTop:8,marginBottom:8,display:"flex",flexDirection:"column",position:"relative"},hoveredOrPressedPreview:{background:"unset",boxShadow:"unset"},preview:{borderRadius:6,background:"unset",boxShadow:"unset",border:`1px solid ${e.lightDividerColor}`,padding:12},contentCover:{color:e.text.primary,fontSize:11,lineHeight:1.5,marginBottom:0,width:"110%",transform:"translateX(-12px) translateY(-4px) scale(0.91)",paddingLeft:12,paddingRight:12,paddingTop:12,paddingBottom:0,borderRadius:6,border:`1px solid ${e.lightDividerColor}`,background:"transparent"},contentCoverFade:{height:48,background:`linear-gradient(to bottom, transparent, ${"light"===e.mode?e.contentBackground:e.sidebarBackground} 100%)`},metadataContainer:{marginTop:8,display:"flex",flexDirection:"column",gap:8},action:{borderRadius:4,background:"unset",fontSize:12,display:"flex"},metadataActorWrapper:{overflow:"hidden"},metadataActorAvatar:{marginRight:5},doubleChevronIcon:{color:e.accentColors.gray[400],cursor:"pointer",width:"max-content"},debugGearIcon:{color:e.accentColors.gray[400]},hoveredDebugGearIcon:{color:e.accentColors.gray[600]}})),[c]),p=(0,i.VK)((()=>h.sidePeekPanel),[h.sidePeekPanel]),m=(0,r.O7)(),f=(0,H.useIntl)(),v=(0,i.VK)((()=>"page_result"===s.type?{type:"page_result",value:s.value.selectedResult.store}:{type:"assistant",value:void 0}),[s]),x=(0,i.VK)((()=>{if("page_result"!==v.type)return;const e=(0,fr.V)(v.value,f,m,!an.Z.isXMLAssistantEnabled());return e&&e.trim().length>0?e:void 0}),[f,m,v]),S=(0,n.useCallback)((e=>{const{id:t,spaceStore:s,table:n,showAvatar:r}=e;if(void 0===t||void 0===n)return;const i=(0,ur.Hl)({pointer:{id:t,spaceId:s.id,table:n},getRecordModel:s.getRecordModel}).asActor;return!i||i.isUser()&&!s.getSpaceUserStore(i.id).isMember()||i.isBot()&&!s.getSpaceBotStore(i.id).isMember()?void 0:{name:(0,ur.$4)(f,i),avatar:r?(0,mr.a)({actor:i,size:18,style:h.metadataActorAvatar}):void 0}}),[f,h.metadataActorAvatar]),b=(0,n.useCallback)((e=>(0,vr.IS)(e,{useUltraCompactFormat:!0,useWeeks:!0,useLowercase:!0})),[]),{createdBy:C,created:M,lastEditedBy:j,lastEdited:k}=(0,i.VK)((()=>{const e=y.default.state.currentSpaceStore;if(void 0===e||"page_result"!==s.type)return{createdBy:void 0,created:void 0,lastEditedBy:void 0,lastEdited:void 0};const t=s.value.selectedResult.store;return{createdBy:S({id:t.getCreatedById(),table:t.getCreatedByTable(),spaceStore:e,showAvatar:!0}),created:b(t.getCreatedTime()),lastEditedBy:S({id:t.getLastEditedById(),table:t.getLastEditedByTable(),spaceStore:e,showAvatar:!0}),lastEdited:b(t.getLastEditedTime())}}),[b,S,s]),w=[{key:"created",itemName:jr.created,itemValue:M,associatedUser:C},{key:"lastEdited",itemName:jr.lastEdited,itemValue:k,associatedUser:j}],{previewIcon:T,isEmptyPage:P}=(0,i.VK)((()=>{if("page_result"!==s.type)return{previewIcon:void 0,isEmptyPage:!0};const e=s.value.selectedResult.store;return{previewIcon:e.getIcon(),isEmptyPage:e.isEmptyPage()}}),[s]),R=(0,i.VK)((()=>{if("page_result"!==s.type)return;const e=s.value.selectedResult.store;return(0,g.ZP)({store:e,collectionViewId:e.id,fullyQualified:!0,pageVisitSource:a.tY.SearchQuery})}),[s]),Z=(0,n.useCallback)((()=>{R&&(u.RD({environment:m,stringValue:R,copiedMessage:u.tq.copiedLinkToClipboard}),d&&d({source:L.SearchCopyLinkSource.SidePeekPanel}))}),[d,m,R]),F=(0,i.VK)((()=>X.default.checkGate("search_toggle_side_peek")),[]),O=(0,i.VK)((()=>X.default.checkGate("search-show-report-bad-search")),[]),{searchResultStore:B}=(0,n.useContext)(L.SearchStaticContext),{localResults:A,serverResults:D}=(0,i.VK)((()=>B.state),[B]),E=(0,N.x)(W.default);return(0,Se.jsxs)("aside",{style:p,children:[(0,Se.jsx)("div",{style:h.sidePeekContentContainer,children:"page_result"===s.type?(0,Se.jsxs)(Se.Fragment,{children:[F&&(0,Se.jsx)("div",{onClick:()=>on.bn(),style:h.doubleChevronIcon,children:(0,hr.D)({width:15,height:15})}),(0,Se.jsxs)("div",{style:h.pageIconAndTitleContainer,children:[(0,Se.jsx)(pe.Z,{disabled:!0,icon:T,isEmptyPage:P,size:26,largeIcon:!0}),(0,Se.jsxs)("span",{style:h.titleAndLinkContainer,children:[(0,Se.jsx)("span",{style:{...h.title,...!x&&h.untitledPageColor},children:x??(0,Se.jsx)(H.FormattedMessage,{id:"search.preview.untitledPage",defaultMessage:"Untitled"})}),(0,Se.jsx)(Pr,{onClick:Z})]})]}),(0,Se.jsx)(br.Z,{style:h.previewContainer,href:R,hoveredStyle:h.hoveredOrPressedPreview,pressedStyle:h.hoveredOrPressedPreview,onClick:l,children:(0,Se.jsx)(xr.Z,{variant:"default",store:s.value.selectedResult.store,coverFormat:Ir,coverSizeFormat:kr,showEmptyGalleryCover:!1,coverContentFadedOverlay:!0,coverContentFadedOverlayStyle:h.contentCoverFade,contentWrapStyle:h.contentCover,coverHeight:180,onLoadProxiedImage:()=>{},renderAdditionalBlocks:!0,rendererBlockStyle:{fontSize:9}})}),(0,Se.jsx)("div",{style:h.metadataContainer,children:w.filter((e=>void 0!==e.itemValue)).map(((e,t)=>(0,Se.jsx)(Mr,{isFirstInList:0===t,itemName:e.itemName,itemValue:e.itemValue,associatedUser:e.associatedUser},e.key)))})]}):(0,Se.jsx)(Tr,{query:s.value??""})}),O?(0,Se.jsxs)("div",{style:h.report,children:[(0,Se.jsx)(kn,{exposedSearchExperiments:null==D||null===(t=D.serverEventProperties)||void 0===t?void 0:t["server-searchExperiments"],localResults:null==A?void 0:A.results,serverResults:null==D?void 0:D.results,debugInfo:null==D?void 0:D.debugInfo}),E&&(0,Se.jsx)(Sr.Z,{ariaLabel:"Button to open search's debug side panel",onClick:()=>I.ZP.setState({...I.ZP.state,isDebugSidebarOpen:!0}),style:h.debugGearIcon,hoveredStyle:h.hoveredDebugGearIcon,icon:e=>(0,gr.H)({width:12,height:12})})]}):null]})}function Tr(e){const{query:t}=e,s=(0,o.yK)((e=>({container:{display:"flex",flexDirection:"column",gap:30},chatAndAvatarContainer:{display:"flex",gap:6,alignItems:"flex-end"},chatContainer:{display:"flex",flexDirection:"column",gap:10,flexGrow:1,justifyContent:"center"},questionBubble:{backgroundColor:e.cardHoveredBackground,color:e.lightTextColor,padding:8,borderRadius:16,fontSize:12,minWidth:40,minHeight:32,width:"fit-content",maxWidth:180,alignSelf:"flex-end",userSelect:"none",overflow:"hidden",textOverflow:"ellipsis"},introBubble:{backgroundColor:e.accentColors.purple[50],color:e.accentColors.purple[500],padding:"8px 12px",borderRadius:16,fontSize:14,width:170,userSelect:"none",overflow:"hidden",display:"flex",flexDirection:"column",gap:6,textOverflow:"ellipsis"},helperDescription:{textAlign:"center",fontSize:12,color:e.lightTextColor,display:"flex",justifyContent:"center"},loadingDots:{border:`1px solid ${e.lightDividerColor}`,padding:12,borderRadius:100,width:"max-content"},writingIndicatorCircle:{height:5,width:5,opacity:.6,backgroundColor:e.lightIconColor,borderRadius:"100%"},writingButtonWrapper:{display:"flex",alignItems:"center",justifyContent:"center",gap:3,width:"inherit",height:"inherit"}})),[]);return(0,Se.jsxs)("div",{style:s.container,children:[(0,Se.jsxs)("div",{style:s.chatAndAvatarContainer,children:[(0,Se.jsx)(Rr,{}),(0,Se.jsx)("div",{style:s.chatContainer,children:t?(0,Se.jsxs)(Se.Fragment,{children:[(0,Se.jsx)("div",{style:s.questionBubble,children:t}),(0,Se.jsx)("div",{style:s.loadingDots,children:(0,Se.jsxs)("div",{role:"decorative",style:s.writingButtonWrapper,children:[(0,Se.jsx)("div",{role:"decorative",style:s.writingIndicatorCircle}),(0,Se.jsx)("div",{role:"decorative",style:s.writingIndicatorCircle}),(0,Se.jsx)("div",{role:"decorative",style:s.writingIndicatorCircle})]})})]}):(0,Se.jsxs)("div",{style:s.introBubble,children:[(0,Se.jsx)("div",{children:(0,Se.jsx)(H.FormattedMessage,{id:"searchSidePeekPanel.welcomeMessage.title",defaultMessage:"Hi! I’m Notion AI."})}),(0,Se.jsx)(H.FormattedMessage,{id:"searchSidePeekPanel.welcomeMessage.caption",defaultMessage:"Let me help you find information and answer questions."})]})})]}),(0,Se.jsx)("div",{style:s.helperDescription,children:(0,Se.jsx)("div",{style:{width:"90%"},children:(0,Se.jsx)(H.FormattedMessage,{id:"SearchSidePeek.caption",defaultMessage:"Get quick answers for anything in your workspace"})})})]})}function Pr(e){const t=(0,r.O7)(),s=(0,o.yK)((e=>({linkIcon:{width:14,height:14,fill:"light"===e.mode?e.accentColors.gray[300]:e.accentColors.gray[500]},hoveredBackground:{backgroundColor:e.buttonHoveredBackground},shortcutLabel:{color:e.mediumInvertedTextColor},tooltipContent:{display:"flex",flexDirection:"column"}})),[]),n=(0,i.VK)((()=>(0,f.bN)(t)),[t]);return(0,Se.jsx)(Cr.ZP,{delayThreshold:600,placement:Cr.ug.Top,allowHover:!0,renderTooltip:()=>(0,Se.jsxs)("div",{style:s.tooltipContent,children:[(0,Se.jsx)(H.FormattedMessage,{id:"search.preview.copyLink",defaultMessage:"Copy link"}),n&&(0,Se.jsx)(yr.Z,{style:s.shortcutLabel,name:"copyLinkToCurrentPage"})]}),closeDelay:0,render:t=>(0,Se.jsx)(Sr.Z,{...t,icon:e=>(0,pr.N)(s.linkIcon),ariaLabel:"Button to toggle the filter bar",hoveredStyle:s.hoveredBackground,onClick:e.onClick})})}function Rr(){const e=(0,o.yK)((e=>({faceImgWrap:{width:32,height:32,borderRadius:"100%",background:e.whiteButtonBackground,border:`1px solid ${e.lightDividerColor}`,overflow:"hidden",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"center"},faceImg:{width:40,pointerEvents:"none"},aiSparklesFill:{height:14,width:14,fill:e.mediumIconColor,pointerEvents:"none"}})),[]);return(0,Se.jsx)("div",{style:e.faceImgWrap,children:(0,rn.t)(e.aiSparklesFill)})}const Zr=570;function Fr(e){const t=(0,r.Fy)(),s=(0,r.O7)();return(0,n.useEffect)((()=>{h.S(s)}),[s]),(0,x.Z)(),(0,Se.jsx)(w.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!t.isMobile,render:()=>(0,Se.jsx)(k.Z,{capture:!0,allowMenuList:!0,render:t=>(0,Se.jsx)(Lr,{...e,ignoreAreaEvents:t})})})}function Lr(e){const{ignoreAreaEvents:t,renderAsPage:s,quickSearchMode:l,onClose:c,searchContentPaneType:h}=e,{handleQueryChange:x,searchFilterMenuRef:S,modalBodyMenuRef:y,searchResultStore:k,focusedIndexStore:w,defaultBodyFocusedResult:R,searchActionItemsStore:Z,handleSelectSearchResult:O,handleCopySearchItemLink:B}=(0,n.useContext)(L.SearchStaticContext),[A,D]=(0,n.useState)(!1),[E,V]=(0,n.useState)(!1),_=(0,r.O7)(),q=(0,r.Fy)(),K=(0,i.VK)((()=>I.ZP.state.query.text),[]),{isSearchMenuOpen:N,shouldShowDebugSidebar:H,hasPublicAccessPermission:U,shouldShowSpinner:z}=(0,i.VK)((()=>{const e=Boolean(b.Z.state.online),{hasPublicAccessPermission:t}=v.bC(_);return{isSearchMenuOpen:j.default.state.open,shouldShowSpinner:e&&Boolean(K)&&k.state.serverResultsLoading&&!A,shouldShowDebugSidebar:Er({device:q,isPublicAccessPermissionForPage:t}),hasPublicAccessPermission:t}}),[A,k,q,_,K]),W=(0,n.useMemo)((()=>d.Ds((()=>{const{activeElement:e}=document;e instanceof HTMLInputElement&&e.blur()}),500,{leading:!0})),[]),G=(0,n.useCallback)((()=>{E&&W()}),[W,E]),$=(0,n.useCallback)((e=>{V(e),e||q.isMobileNative&&C.Z.updateKeyboardPhase(_,C.i.willHide,0)}),[q.isMobileNative,_]),Q=(0,i.VK)((()=>v.pG({searchResultStore:k,focusedIndexStore:w,searchActionsStore:Z})),[k,w,Z]),X=(0,i.VK)((()=>R.state),[R]),J=(0,n.useMemo)((()=>(0,Se.jsx)(cs.Z,{isOpen:Boolean(s||N),onTypingChange:D,onFocusChange:$,showSpinner:z,onQueryChange:x,quickSearchMode:l,selectedResult:"page_result"===(null==Q?void 0:Q.type)?Q.value.selectedResult.store:void 0})),[s,N,$,z,x,l,Q]),Y=(0,i.VK)((()=>Or({searchContentPaneType:h,renderAsPage:s,environment:_})),[h,s,_]),ee=(0,o.yK)((e=>({body:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",zIndex:2},topbar:{height:void 0,marginTop:10,marginLeft:16,marginBottom:10,marginRight:16},topbarRightButtonWrapper:{flex:void 0,paddingLeft:16},topbarButton:{fontWeight:void 0,padding:0,color:e.mediumTextColor},scroller:{display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"space-between",maxHeight:Y.maxHeight,minHeight:Y.minHeight}})),[Y.maxHeight,Y.minHeight]),te=(0,n.useMemo)((()=>{if(q.isMobile){return{menuType:m.og.Modal,left:J,shouldRenderLeftDirectly:!0,width:s?"100vw":void 0,...Ar({isPhone:q.isPhone,renderAsPage:s,style:ee.topbarRightButtonWrapper,onClick:c}),header:"search_results"===h&&(0,Se.jsx)(as,{isPublicPageSearch:U}),disableHeaderShadow:!0,topbarStyle:ee.topbar,leftRightButtonStyle:ee.topbarButton,onScroll:Dr(q)?G:void 0,bodyScrollerClassName:p.GZn,...t}}return{menuType:m.og.Popup,maxHeight:Y.maxHeight,minHeight:Y.minHeight,maxWidth:"100%",...l?{width:"100vw"}:{},disableScroller:!0,scrollerStyle:ee.scroller,...t}}),[q,ee,t,J,s,c,h,U,G,Y.minHeight,Y.maxHeight,l]),se=X||Q;"assistant"===(null==se?void 0:se.type)&&(se.value=K);const ne=(0,i.VK)((()=>Z.state.length),[Z]),re=(0,i.VK)((()=>{if("page_result"===(null==se?void 0:se.type)){const{index:e,selectedResult:t,allSearchResults:s}=se.value;return n=>O({event:n,index:e,selectedResult:t,allSearchResults:s,fromSidePeekPanel:!0,actionItemCount:ne,context:"search_results"===h?"query_results":"recent_pages"})}}),[ne,O,h,se]),ie=(0,i.VK)((()=>{if("page_result"===(null==se?void 0:se.type)){const{index:e,selectedResult:t,allSearchResults:s}=se.value;return n=>{const{source:r}=n;B({index:e,selectedResult:t,allSearchResults:s,fromSidePeekPanel:r===L.SearchCopyLinkSource.SidePeekPanel,actionItemCount:ne,context:"search_results"===h?"query_results":"recent_pages",source:r})}}}),[ne,B,h,se]),oe=(0,i.VK)((()=>!(0,f.bN)(_)&&_.WindowSizeStore.state.width<L.DEFAULT_MODAL_WIDTH_WITH_SIDE_PEEK),[_]),ae=(0,i.VK)((()=>!((0,M.gq)({device:q})||oe||I.ZP.state.isDebugSidebarOpen||void 0===se||"default_body"===h)&&(0,f.Qi)(_)),[_,h,se,q,oe]);(0,i.VK)((()=>{I.ZP.state.isSidePeekPanelOpen!==ae&&I.ZP.update((e=>({...e,isSidePeekPanelOpen:ae})))}),[ae]);const le=(0,n.useCallback)((()=>{if(!l||!se||"page_result"!==se.type)return;const e=se.value.selectedResult.store,t=(0,g.Hu)({store:e,collectionViewId:e.id,fullyQualified:!0,pageVisitSource:a.tY.SearchQuery});t&&(u.RD({environment:_,stringValue:t,copiedMessage:u.tq.copiedLinkToClipboard}),ie&&ie({source:L.SearchCopyLinkSource.KeyboardShortcut}))}),[_,ie,l,se]);return(0,Se.jsx)(T.Z,{debugName:"SearchContentPane",capture:!0,onCopyLinkToCurrentPage:e=>{le()},onCopyLinkToPageInCommandSearch:e=>{le()},children:(0,Se.jsx)(P.Z,{...te,className:p.Oau,ref:y,children:(0,Se.jsxs)(Br,{enableLazyLoading:s,children:[(0,Se.jsxs)("div",{style:ee.body,children:[(0,Se.jsx)(F.Z,{}),!q.isMobile&&J,(0,Se.jsx)(cr,{searchContentPaneType:h})]}),ae&&void 0!==se?(0,Se.jsx)(wr,{selectedResult:se,onClickPreview:re,handleClickCopyLink:ie}):void 0,H&&(0,Se.jsx)(Rt,{ref:S})]})})})}function Or(e){const{searchContentPaneType:t,renderAsPage:s,environment:n}=e;if(s)return{maxHeight:"100vh",minHeight:"100vh"};if((0,f.rd)(n)){const e=n.WindowSizeStore.state.height,s=(0,l.u3)(n.device.isElectronMac),r=e>Zr+s?Zr:0;return{minHeight:`max(${"search_results"===t?70:50}vh, ${r}px)`,maxHeight:`max(${"search_results"===t?70:50}vh, ${r}px)`}}return"assistant"===I.ZP.state.mode?{maxHeight:"80vh",minHeight:Zr}:{maxHeight:"80vh",minHeight:50}}function Br(e){const{enableLazyLoading:t,children:s}=e,i=(0,r.O7)();return t?(0,Se.jsx)(Z.Z,{fetch:async()=>{var e;await c.Vs(0),await y.default.waitUntil((()=>void 0!==y.default.state.currentSpaceStore)),null===(e=i.mobileNative)||void 0===e||e.markTransitionReady({type:"search"})},loading:()=>(0,Se.jsx)(n.Fragment,{}),render:()=>s}):(0,Se.jsx)(n.Fragment,{children:s})}function Ar(e){let{isPhone:t,style:s,renderAsPage:n,onClick:r}=e;return t&&(0,S.Y)("supportsNativeHome")||n?{rightOuterStyle:{display:"none"}}:{right:(0,Se.jsx)(R.CancelMenuText,{}),onClickRight:r,rightOuterStyle:s}}function Dr(e){return!!e.isMobile&&(!e.isIOS||e.isMobileNative)}function Er(e){let{device:t,isPublicAccessPermissionForPage:s}=e;if(!s&&!t.isMobile)return I.ZP.isDebugSidebarOpen()}},61496:(e,t,s)=>{s.d(t,{Z:()=>V,e:()=>E});s(57658);var n=s(67294),r=s(480),i=s(86628),o=s(24405),a=s(11751),l=s(92338),d=s(9291),c=s(53965),u=s(1898),h=s(37810),p=s(87531),g=s(47449),m=s(16091),f=s(15447),v=s(48779),x=s(77907),S=s(80444),y=s(21273),b=s(98180),C=s(88632),M=s(77080),j=s(69327),I=s(29798),k=s(88923),w=s(27724),T=s(32163),P=s(43145),R=s(72495),Z=s(33991),F=s(17576),L=s(59592),O=s(88357),B=s(69680),A=s(85893);function D(e,t){return{store:e,id:e.id,score:-1,spaceId:e.getSpaceId(),sources:[l.vp.Local],featureGroups:[],originalPosition:t,serverEventProperties:void 0}}function E(e){switch(e){case"today":return(0,A.jsx)(d.FormattedMessage,{id:"search.recentPagesTimeBuckets.today.text",defaultMessage:"Today"});case"yesterday":return(0,A.jsx)(d.FormattedMessage,{id:"search.recentPagesTimeBuckets.yesterday.text",defaultMessage:"Yesterday"});case"past_week":return(0,A.jsx)(d.FormattedMessage,{id:"search.recentPagesTimeBuckets.pastWeek.text",defaultMessage:"Past week"});case"past_30_days":return(0,A.jsx)(d.FormattedMessage,{id:"search.recentPagesTimeBuckets.past30Days.text",defaultMessage:"Past 30 days"});case"older":return(0,A.jsx)(d.FormattedMessage,{id:"search.recentPagesTimeBuckets.older.text",defaultMessage:"Older"})}(0,u.t1)(e)}const V=function(e){const{onSelect:t,spaceId:s,extraTopPadding:l}=e,[u,V]=n.useState(!1),[_,q]=n.useState(!1),K=(0,i.qz)(void 0,I.Z),{section:N,indexLocal:H,indexGlobal:U}=(0,i.VK)((()=>K.state.focus),[K]),z=(0,r.O7)(),W=(0,r.Fy)(),G=(0,i.VK)((()=>C.Z.state.online&&y.Z.shouldShowSearchMenuItemAskAI(W)),[W]),$=(0,o.yK)((e=>({wrapper:{paddingTop:l||!G?8:void 0,width:"100%",height:"100%",overflowX:"hidden",overflowY:"auto"},sectionHeader:{marginBottom:8},section:{marginBottom:18},sectionBorderBottom:{paddingBottom:10,boxShadow:`0 1px 0 ${e.lightDividerColor}`},notionAiLabel:{lineHeight:"20px",fontSize:14,textOverflow:"ellipsis",overflow:"hidden",display:"block",fontWeight:h.Z.fontWeight.medium},notionAiIcon:{fill:e.aiPurpleColor,overflow:"visible"}})),[l,G]),{defaultBodyFocusedResult:Q,isQuickSearch:X}=(0,n.useContext)(Z.SearchStaticContext),J=(0,i.VK)((()=>{const e=k.default.state,t=k.default.isCenterPeekOpen()||w.default.isInPeekRenderer();return e.open&&(t||e.isOpening)?e.target:S.default.state.mainEditorCurrentBlockStore}),[]),Y=(0,i.VK)((()=>f.X4.state.filter((e=>e.pageId!==(null==J?void 0:J.id)))),[null==J?void 0:J.id]),ee=(0,i.VK)((()=>{const{currentUserSettingsStore:e,currentSpaceStore:t,mainEditorCurrentBlockStore:s}=S.default.state;return!!(t&&s&&s.canRead())&&y.Z.isQnATooltipsVisible(z.device,e)}),[z.device]);(0,n.useEffect)((()=>()=>{Q.setState(void 0)}),[Q]);const te=(0,n.useRef)(null),{value:se}=(0,x.useDependency)(x.deps.assistant),ne=(0,i.VK)((()=>G?[{key:"actionMenuItem.assistant",action:()=>{const{currentUserSettingsStore:e}=S.default.state;e&&(0,g.CX)(z,{phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickTooltipClose",userSettingsStore:e}),p.Ky({environment:z,shouldResetAssistantStore:b.Z.wasActiveSessionLastOpenedOutsideOfHistorySavedWindow()}),null==se||se.assistantActions.updateAssistantTimestampsAfterSessionInitialization({environment:z})},render:e=>{const t=null==J?void 0:J.getSpaceStore(),s=t?(0,v.rn)(z,t):void 0,n=(0,A.jsx)("div",{className:"notranslate",style:$.notionAiLabel,children:s?(0,A.jsx)(d.FormattedMessage,{id:"searchDefaultBody.searchActionMenuItem.askAiInSpace",defaultMessage:"Ask AI in {spaceName}",values:{spaceName:s}}):(0,A.jsx)(d.FormattedMessage,{id:"searchDefaultBody.searchActionMenuItem.askNotionAi",defaultMessage:"Ask Notion AI about..."})});return ee?(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(m.gc,{origin:te}),(0,A.jsx)(F.Z,{type:"assistant",...e,blueOutlineFocused:!0,ref:te,title:n,icon:e=>(0,a.t)({...e,...$.notionAiIcon})})]}):(0,A.jsx)(F.Z,{type:"assistant",...e,title:n,icon:e=>(0,a.t)({...e,...$.notionAiIcon})})}}]:[]),[G,z,J,ee,$,se]),re=(0,i.VK)((()=>{const e={};return Y.forEach((t=>{let{pageId:s,visitedAt:n}=t;return e[s]=n})),e}),[Y]),ie=(0,i.VK)((()=>{const e=new Map;return Y.map(((s,n)=>{const r=f._5(s.visitedAt),i="today"!==r&&"yesterday"!==r,o={key:`${s.store.id}:${n}`,action:e=>t({index:{local:e.indexLocal,global:e.index},event:e.event,selectedResult:D(s.store,n),fromSidePeekPanel:!1,actionItemCount:ne.length,context:"recent_pages"}),render:e=>(0,A.jsx)(B.Z,{...e,inline:!W.isMobile,store:s.store,hidePath:!1,lastViewed:i?re[s.store.id]:void 0,buttonStyle:{paddingLeft:1},type:"recent_pages"})},a={result:o,store:s.store};var l;e.has(r)?null===(l=e.get(r))||void 0===l||l.push(a):e.set(r,[a])})),e}),[ne.length,W.isMobile,Y,t,re]),oe=(0,x.useDependency)(x.deps.AppTemplates),ae=(0,i.VK)((()=>(0,v.kO)().function),[]),le=(0,i.VK)((()=>{var e;const t=null===(e=oe.value)||void 0===e?void 0:e.templatePickerItems.getSuggestedTemplatesForSearch({persona:ae,environment:z}).slice(0,3),s=null==t?void 0:t.map(((e,t)=>({key:`${t}:${e.name}`,action:()=>{p.IB(z),e.onClick()},render:t=>(0,A.jsx)(F.Z,{...t,title:e.name,icon:()=>e.icon,type:"page_result"})})));return s}),[oe,ae,z]),de=(0,i.VK)((()=>!(!le||0===le.length)&&"on"===M.default.getEligibleGroup({experimentId:"search_modal_suggested_templates"})),[le]),ce=(0,i.VK)((()=>{const e=[];ne.length>0&&e.push({key:"actions",items:ne,render:e=>(0,A.jsx)(R.Z,{title:"Actions",desktopTitleStyle:$.sectionHeader,disableDesktopPadding:!0,style:$.section,children:e.children})});for(const[t,s]of ie.entries()){const n=E(t),r={key:t,items:s.map((e=>e.result)),render:e=>(0,A.jsx)(R.Z,{title:n,desktopTitleStyle:$.sectionHeader,disableDesktopPadding:!0,style:{...$.section},children:e.children})};e.push(r)}return!X&&le&&le.length>0&&de&&e.push({key:"templates",items:le,render:e=>(0,A.jsx)(R.Z,{title:(0,A.jsx)(d.FormattedMessage,{id:"search.templateSuggestions.header",defaultMessage:"Start with a template"}),desktopTitleStyle:$.sectionHeader,disableDesktopPadding:!0,style:$.section,children:e.children})}),e}),[X,ne,ie,$.section,$.sectionHeader,le,de]),ue=(0,n.useCallback)((e=>{const t=()=>{const e=j.Z.getWithoutSubscribing(s),t=e[e.length-1];return null==t?void 0:t.visitedAt},n=c.P2((async()=>{const e=t(),n=z.currentUser.id;if(!n||!e)return;V(!0);const r=await f.Od(e,{environment:z,userId:n,spaceId:s});V(!1),r||q(!0)}),300);t()&&e<=200&&!u&&!_&&n()}),[_,u,z,s]);(0,n.useEffect)((()=>{var e;if(void 0===N||void 0===H||void 0===U)return;const t=null===(e=ce[N])||void 0===e?void 0:e.key;if(t&&"string"==typeof t)if("actions"===t)Q.setState({type:"assistant"});else if(f._k.includes(t)){var s;const e=null===(s=ie.get(t))||void 0===s||null===(s=s[H])||void 0===s?void 0:s.store;e&&Q.setState({type:"page_result",value:{index:{local:{indexLocal:H,section:N},global:U},selectedResult:D(e,U-ne.length)}})}}),[ne.length,Q,U,N,H,ie,ce]);const he=(0,i.VK)((()=>ne.length),[ne.length]),pe=!W.isMobile&&Y.length>0;return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("div",{style:$.wrapper,children:[(0,A.jsx)(T.Z,{store:K,type:T.i.Vertical,initialFocus:he,disableKeyboardArrowWrap:!0,sections:ce,unfocusOnScroll:!0}),(0,A.jsx)(P.Z,{onChange:ue})]}),pe&&(0,A.jsx)(L.Z,{title:(0,A.jsx)(O.Z,{})})]})}},59592:(e,t,s)=>{s.d(t,{Z:()=>v,r:()=>f});s(67294);var n=s(480),r=s(86628),i=s(24405),o=s(18442),a=s(53772),l=s(37810),d=s(95477),c=s(75024),u=s(29026),h=s(28992),p=s(89728),g=s(72495),m=s(85893);function f(e){return{fontSize:12,color:e.lightTextColor,marginLeft:6,paddingRight:4,paddingLeft:4,height:24}}const v=function(e){const t=(0,i.Fg)(),s=function(e,t){return{footer:()=>{const{device:t}=e;return{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:t.isMobile?l.Z.fontSize.UIRegular.mobile:l.Z.fontSize.UIRegular.desktop}},footerWrapper:{flexShrink:0},footerText:{color:t.lightTextColor,fontSize:c.yv(e,"UISmall"),...l.Z.textOverflowStyle},footerDebugButton:{...f(t),marginRight:6},debugGearIcon:{color:t.accentColors.gray[400]},hoveredDebugGearIcon:{color:t.accentColors.gray[600]}}}((0,n.O7)(),t),v=(0,r.VK)((()=>u.ZP.state.isDebugSidebarOpen),[]);return(0,m.jsx)("footer",{style:s.footerWrapper,children:(0,m.jsxs)(g.Z,{topBorder:!0,style:s.footer(),disableDesktopPadding:!0,children:[(0,m.jsx)(h.Z,{...e,style:s.footerText}),(0,a.x)(d.default)&&!v&&(0,m.jsx)(p.Z,{onClick:()=>u.ZP.setState({...u.ZP.state,isDebugSidebarOpen:!0}),isSmall:!0,style:s.debugGearIcon,hoveredStyle:s.hoveredDebugGearIcon,children:(0,o.H)({width:12,height:12})})]})})}},88357:(e,t,s)=>{s.d(t,{Z:()=>O});var n=s(67294),r=s(480),i=s(86628),o=s(24405),a=s(41892),l=s(22109),d=s(75e3),c=s(45238),u=s(85893);const h=(0,c.IU)("flatNotionLogoMenuBar",{viewBox:"0 0 128 128",svg:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M76.8 10.25H51.2C42.07 10.25 35.839 10.258 31.0171 10.6519C26.3149 11.0361 23.8625 11.7357 22.1257 12.6206C18.0332 14.7059 14.7059 18.0332 12.6206 22.1257C11.7357 23.8625 11.0361 26.3149 10.6519 31.0171C10.258 35.839 10.25 42.07 10.25 51.2V76.8C10.25 85.93 10.258 92.161 10.6519 96.9829C11.0361 101.685 11.7357 104.138 12.6206 105.874C14.7059 109.967 18.0332 113.294 22.1257 115.379C23.8625 116.264 26.3149 116.964 31.0171 117.348C35.839 117.742 42.07 117.75 51.2 117.75H76.8C85.93 117.75 92.161 117.742 96.9829 117.348C101.685 116.964 104.138 116.264 105.874 115.379C109.967 113.294 113.294 109.967 115.379 105.874C116.264 104.138 116.964 101.685 117.348 96.9829C117.742 92.161 117.75 85.93 117.75 76.8V51.2C117.75 42.07 117.742 35.839 117.348 31.0171C116.964 26.3149 116.264 23.8625 115.379 22.1257C113.294 18.0332 109.967 14.7059 105.874 12.6206C104.138 11.7357 101.685 11.0361 96.9829 10.6519C92.161 10.258 85.93 10.25 76.8 10.25ZM3.48779 17.4723C0 24.3175 0 33.2783 0 51.2V76.8C0 94.7217 0 103.683 3.48779 110.528C6.55574 116.549 11.4511 121.444 17.4723 124.512C24.3175 128 33.2783 128 51.2 128H76.8C94.7217 128 103.683 128 110.528 124.512C116.549 121.444 121.444 116.549 124.512 110.528C128 103.683 128 94.7217 128 76.8V51.2C128 33.2783 128 24.3175 124.512 17.4723C121.444 11.4511 116.549 6.55574 110.528 3.48779C103.683 0 94.7217 0 76.8 0H51.2C33.2783 0 24.3175 0 17.4723 3.48779C11.4511 6.55574 6.55574 11.4511 3.48779 17.4723Z"}),(0,u.jsx)("path",{d:"M34.8247 30H51.877L82.6339 73.8338V38.7877L72.8 36.9046C72.5211 35.0215 72.9047 33.4174 73.9508 32.0923C74.997 30.6974 76.6708 30 78.9723 30H99.5816C100.14 31.4646 100.105 32.7897 99.4769 33.9754C98.919 35.161 97.838 36.1026 96.2339 36.8L92.8862 38.3692V97.1631C90.9334 98.0697 89.4339 98.6626 88.3877 98.9415C87.3416 99.2205 86.0513 99.36 84.517 99.36C82.4246 99.36 80.5416 98.8718 78.8677 97.8954C77.1939 96.919 75.6595 95.4195 74.2646 93.3969L45.4954 52.7015V89.3169L55.957 91.2C56.2359 93.0831 55.8523 94.722 54.8062 96.1169C53.76 97.5118 52.0862 98.2092 49.7847 98.2092C48.32 98.2092 46.2975 98.1744 43.717 98.1046C41.1365 98.0349 38.8 98 36.7077 98C34.8944 98 33.1857 98.0349 31.5816 98.1046C30.0472 98.1046 29.0011 98.1395 28.4431 98.2092C28.3036 97.8605 28.199 97.4769 28.1293 97.0585C28.0595 96.64 28.0247 96.2564 28.0247 95.9077C28.0247 94.9313 28.2688 94.0246 28.757 93.1877C29.3149 92.3508 30.2565 91.6882 31.5816 91.2L35.2431 89.7354V37.9508L28.6524 36.5908C28.3734 34.7077 28.757 33.1385 29.8031 31.8831C30.8493 30.6277 32.5231 30 34.8247 30Z"})]})});var p=s(9291),g=s(37810),m=s(51787),f=s(47839),v=s(62134),x=s(59139),S=s(75024),y=s(86706),b=s(24042),C=s(77080),M=s(55320),j=s(29026),I=s(58261),k=s(74420),w=s(26388);const T=(0,c.IU)("command",{viewBox:"0 0 16 16",svg:(0,u.jsx)("path",{d:"M4.35938 5.5625L4.35938 9.21094L2.78906 9.21094C1.25 9.21094 0 10.4219 0 11.9688C0 13.5156 1.25 14.7656 2.78906 14.7656C4.32812 14.7656 5.57812 13.5156 5.57812 11.9688L5.57812 10.4062L9.17969 10.4062L9.17969 11.9688C9.17969 13.5156 10.4297 14.7656 11.9688 14.7656C13.5078 14.7656 14.7578 13.5156 14.7578 11.9688C14.7578 10.4219 13.5078 9.21094 11.9688 9.21094L10.3984 9.21094L10.3984 5.5625L11.9688 5.5625C13.5078 5.5625 14.7578 4.35156 14.7578 2.80469C14.7578 1.25781 13.5078 0 11.9688 0C10.4297 0 9.17969 1.25781 9.17969 2.80469L9.17969 4.36719L5.57812 4.36719L5.57812 2.80469C5.57812 1.25781 4.32812 0 2.78906 0C1.25 0 0 1.25781 0 2.80469C0 4.35156 1.25 5.5625 2.78906 5.5625ZM2.78906 4.38281C1.92969 4.38281 1.21875 3.67188 1.21875 2.80469C1.21875 1.9375 1.92969 1.21875 2.78906 1.21875C3.64844 1.21875 4.35938 1.9375 4.35938 2.80469L4.35938 4.38281ZM11.9688 4.38281L10.3984 4.38281L10.3984 2.80469C10.3984 1.9375 11.1094 1.21875 11.9688 1.21875C12.8281 1.21875 13.5391 1.9375 13.5391 2.80469C13.5391 3.67188 12.8281 4.38281 11.9688 4.38281ZM5.57812 9.22656L5.57812 5.54688L9.17969 5.54688L9.17969 9.22656ZM2.78906 10.3828L4.35938 10.3828L4.35938 11.9609C4.35938 12.8281 3.64844 13.5391 2.78906 13.5391C1.92969 13.5391 1.21875 12.8281 1.21875 11.9609C1.21875 11.0938 1.92969 10.3828 2.78906 10.3828ZM11.9688 10.3828C12.8281 10.3828 13.5391 11.0938 13.5391 11.9609C13.5391 12.8281 12.8281 13.5391 11.9688 13.5391C11.1094 13.5391 10.3984 12.8281 10.3984 11.9609L10.3984 10.3828Z"})}),P=(0,c.IU)("control",{viewBox:"0 0 16 16",svg:(0,u.jsx)("path",{d:"M0.210938 6.41406C0.078125 6.55469 0 6.72656 0 6.92188C0 7.32812 0.304688 7.64062 0.710938 7.64062C0.914062 7.64062 1.09375 7.55469 1.21875 7.42969L7.20312 1.32031L6.36719 1.32031L12.3516 7.42969C12.4844 7.55469 12.6641 7.64062 12.8594 7.64062C13.2656 7.64062 13.5703 7.32812 13.5703 6.92188C13.5703 6.72656 13.4922 6.55469 13.3594 6.41406L7.3125 0.226562C7.17969 0.078125 6.98438 0 6.78906 0C6.58594 0 6.40625 0.078125 6.25781 0.226562Z"})}),R=(0,c.IU)("option",{viewBox:"0 0 16 16",svg:(0,u.jsx)("path",{d:"M4.5 0L0.734375 0C0.320312 0 0 0.304688 0 0.703125C0 1.10156 0.320312 1.41406 0.734375 1.41406L4.17188 1.41406C4.45312 1.41406 4.65625 1.53906 4.77344 1.79688L9.92188 13.3594C10.2109 14.0156 10.6875 14.3203 11.4062 14.3203L15.2188 14.3203C15.625 14.3203 15.9531 14.0078 15.9531 13.6172C15.9531 13.2266 15.625 12.9062 15.2188 12.9062L11.7578 12.9062C11.4453 12.9062 11.25 12.7891 11.125 12.5312L6 0.976562C5.73438 0.367188 5.17188 0 4.5 0ZM15.2188 0L10.1641 0C9.75 0 9.42969 0.296875 9.42969 0.695312C9.42969 1.09375 9.75 1.39844 10.1641 1.39844L15.2188 1.39844C15.6328 1.39844 15.9453 1.09375 15.9453 0.695312C15.9453 0.296875 15.6328 0 15.2188 0Z"})}),Z=(0,c.IU)("shift",{viewBox:"0 0 16 16",svg:(0,u.jsx)("path",{d:"M5.99219 14.5L10.8125 14.5C11.9062 14.5 12.4922 13.8594 12.4922 12.8281L12.4922 9.32812L15.6641 9.32812C16.3047 9.32812 16.8047 8.9375 16.8047 8.34375C16.8047 7.97656 16.6172 7.70312 16.3359 7.42188L9.36719 0.476562C9.0625 0.171875 8.75 0 8.39844 0C8.05469 0 7.73438 0.171875 7.4375 0.476562L0.46875 7.42188C0.164062 7.71875 0 7.97656 0 8.34375C0 8.9375 0.5 9.32812 1.13281 9.32812L4.3125 9.32812L4.3125 12.8281C4.3125 13.8594 4.89844 14.5 5.99219 14.5ZM6.11719 13.2891C5.82031 13.2891 5.61719 13.0859 5.61719 12.7969L5.61719 8.41406C5.61719 8.21875 5.54688 8.14844 5.35938 8.14844L1.75 8.14844C1.69531 8.14844 1.66406 8.125 1.66406 8.08594C1.66406 8.05469 1.67969 8.03125 1.71094 7.99219L8.23438 1.50781C8.29688 1.44531 8.35156 1.42969 8.39844 1.42969C8.45312 1.42969 8.50781 1.44531 8.5625 1.50781L15.0859 7.99219C15.125 8.03125 15.1328 8.05469 15.1328 8.08594C15.1328 8.125 15.1094 8.14844 15.0469 8.14844L11.4453 8.14844C11.2578 8.14844 11.1875 8.21875 11.1875 8.41406L11.1875 12.7969C11.1875 13.0781 10.9766 13.2891 10.6875 13.2891Z"})});function F(e){const{shortcut:t,iconStyles:s,containerStyles:n}=e,r=(0,o.yK)((e=>({container:{display:"flex",gap:3,alignItems:"center",color:e.mediumIconColor,...n},icon:{strokeWidth:.25,overflow:"visible",stroke:e.mediumIconColor,...s}})),[n,s]);return t?(0,u.jsxs)("div",{style:r.container,children:[t.shift?Z(r.icon):void 0,t.control?P(r.icon):void 0,t.option?R(r.icon):void 0,t.command?T(r.icon):void 0,t.key?1===t.key.length?t.key.toUpperCase():t.key:void 0]}):null}var L=s(33991);function O(){const e=(0,r.O7)(),t=(0,p.useIntl)(),{isQuickSearch:s}=(0,n.useContext)(L.SearchStaticContext),a=(0,i.VK)((()=>.75*S.yv(e,"UIRegular")),[e]),c=(0,o.yK)((t=>({listStyle:{...S.mK,...g.Z.textOverflowStyle,display:"inline-flex",alignItems:"center",fontSize:S.yv(e,"UISmall"),color:t.lightTextColor,gap:20},upDownIcon:{display:"inline",width:a+2,height:a+2,fill:t.mediumIconColor},enterIcon:{display:"inline",width:a+1,height:a+1,fill:t.mediumIconColor},commandGlyph:{fontSize:.75*S.yv(e,"UIRegular"),paddingRight:1,color:t.mediumIconColor},inlineHint:{display:"flex",gap:6,alignItems:"center",height:"max-content"},forwardSlash:{fontSize:9,userSelect:"none",fontWeight:500,display:"flex",lineHeight:1.4},toggleSidePeekHotkey:{display:"inline-flex",marginRight:4},icons:{width:a-1,height:a-1,marginTop:.5},keyboardShortcutContainer:{fontSize:S.yv(e,"UISmall")}})),[e,a]),h=(0,i.VK)((()=>(0,x.rd)(e)),[e]),y=(0,i.VK)((()=>{var t;const n=null===(t=b.Z.state.preferences)||void 0===t?void 0:t.isQuickSearchEnabled;return e.device.isElectron&&n&&(h||s)}),[e.device.isElectron,s,h]),[k,w]=(0,i.VK)((()=>{const t=j.ZP.state.query.text.length>0;return[h&&C.default.checkGate("search_toggle_side_peek")&&t,(0,x.Qi)(e)]}),[e,h]),T=(0,n.useCallback)((()=>{(M.default.state.open||M.default.state.openAsPage)&&m.Sn(e,{searchSessionId:M.default.state.sessionId})}),[e]),P=(0,i.VK)((()=>e.device.isMac),[e.device.isMac]),{command:R}=v.fg(e);return(0,u.jsxs)("ul",{style:c.listStyle,children:[(0,u.jsxs)("li",{style:c.inlineHint,children:[(0,l.T)(c.upDownIcon),t.formatMessage({id:"searchFooter.helpText.selectHint",defaultMessage:"Select"})]}),(0,u.jsxs)("li",{style:c.inlineHint,children:[(0,d.U)(c.enterIcon),t.formatMessage({id:"searchFooter.helpText.openHint",defaultMessage:"Open"})]}),s?(0,u.jsxs)("li",{style:c.inlineHint,children:[P?(0,u.jsx)(F,{shortcut:{command:!0,key:"L"},iconStyles:c.icons,containerStyles:c.keyboardShortcutContainer}):(0,u.jsx)(I.Z,{name:"copyLinkToCurrentPage"}),t.formatMessage({id:"searchFooter.helpText.copyLink",defaultMessage:"Copy link"})]}):void 0,y?(0,u.jsx)("li",{style:c.inlineHint,onClick:()=>{T(),f.openQuickSearchShortcutSetting()},children:(0,u.jsx)(B,{environment:e,containerStyles:c.inlineHint})}):void 0,h?null:(0,u.jsxs)("li",{style:c.inlineHint,children:[(0,u.jsxs)("span",{children:[(0,u.jsx)("span",{style:c.commandGlyph,children:R}),(0,d.U)(c.enterIcon)]}),t.formatMessage({id:"searchFooter.helpText.openNewTab",defaultMessage:"Open in a new tab"})]}),k?(0,u.jsxs)("li",{style:c.inlineHint,children:[(0,u.jsxs)("span",{style:c.toggleSidePeekHotkey,children:[(0,u.jsx)("span",{style:c.commandGlyph,children:R}),(0,u.jsx)("span",{style:c.forwardSlash,children:"\\"})]}),w?t.formatMessage({id:"searchFooter.helpText.closeSidePeek",defaultMessage:"Close preview"}):t.formatMessage({id:"searchFooter.helpText.openSidePeek",defaultMessage:"Preview"})]}):null]})}function B(e){const{environment:t,containerStyles:s}=e,[r,a]=(0,n.useState)(!1),l=(0,i.VK)((()=>.75*S.yv(t,"UIRegular")),[t]),d=(0,o.yK)((e=>({container:{...s,cursor:"pointer"},commandSearchHint:{display:"flex",alignItems:"center"},commandText:{padding:"2px 4px",borderRadius:4,background:r?e.buttonHoveredBackground:void 0},hintAndBadgeContainer:{display:"flex",gap:3,alignItems:"center",width:"max-content"},tooltip:{background:"transparent",boxShadow:"none"},icons:{width:l-1,height:l-1,marginTop:.5},keyboardShortcutContainer:{fontSize:S.yv(t,"UISmall")}})),[s,t,r,l]),c=(0,i.VK)((()=>t.device.isMac),[t.device.isMac]),h=(0,p.useIntl)(),{commandSearchShortcut:g,commandSearchShortcutToString:v}=(0,i.VK)((()=>{var e;const t=null===(e=b.Z.state.preferences)||void 0===e?void 0:e.quickSearchShortcut;if(!t)return{commandSearchShortcut:void 0,commandSearchShortcutToString:void 0};const s=(0,y.Uy)(t);return{commandSearchShortcut:s,commandSearchShortcutToString:(0,y.K9)(s,c)}}),[c]),x=(0,n.useCallback)((()=>{(M.default.state.open||M.default.state.openAsPage)&&m.Zb(t,{searchSessionId:M.default.state.sessionId})}),[t]);return(0,u.jsx)(w.ZP,{delayThreshold:400,placement:w.ug.Bottom,originGap:8,disableTooltip:!c,renderTooltip:()=>(x(),(0,u.jsx)(A,{shortcut:v})),closeDelay:0,style:d.tooltip,render:e=>(0,u.jsxs)("div",{...e,style:d.container,onClick:()=>f.openQuickSearchShortcutSetting(),onMouseEnter:t=>{e.onMouseEnter&&e.onMouseEnter(t),r||a(!0)},onMouseLeave:t=>{e.onMouseLeave&&e.onMouseLeave(t),r&&setTimeout((()=>{a(!1)}),200)},children:[(0,u.jsx)("span",{style:d.commandText,children:c?(0,u.jsx)(F,{shortcut:g,iconStyles:d.icons,containerStyles:d.keyboardShortcutContainer}):v}),(0,u.jsx)("div",{style:d.commandSearchHint,children:r?(0,u.jsx)("span",{children:h.formatMessage({id:"searchFooter.commandSearch.editText",defaultMessage:"Click to edit shortcut"})}):(0,u.jsxs)("div",{style:d.hintAndBadgeContainer,children:[h.formatMessage({id:"searchFooter.commandSearch.defaultText",defaultMessage:"Command Search"}),(0,u.jsx)(k.Z,{style:{marginLeft:0}})]})})]})})}function A(e){const{shortcut:t}=e,s=a.Z.images.commandSearch.tooltipPng,[r,i]=(0,n.useState)(!1);(0,n.useEffect)((()=>{const e=new Image;e.src=s,e.onload=()=>{i(!0)}}),[s]);const l=(0,o.yK)((e=>({container:{width:260,borderRadius:8,backgroundColor:"transparent"},textContainer:{whiteSpace:"break-spaces",padding:15,display:"flex",flexDirection:"column",gap:1,backgroundColor:"light"===e.mode?e.accentColors.gray[700]:e.accentColors.gray[300],borderTopRightRadius:8,borderTopLeftRadius:8},description:{fontWeight:g.Z.fontWeight.regular,color:"light"===e.mode?e.accentColors.gray[300]:e.accentColors.gray[600]},image:{width:"100%"}})),[]);return r?(0,u.jsxs)("div",{style:l.container,children:[(0,u.jsxs)("div",{style:l.textContainer,children:[(0,u.jsx)("div",{children:(0,u.jsx)(p.FormattedMessage,{id:"searchFooter.commandSearch.tooltip.header",defaultMessage:"Use search and Q&A anywhere"})}),(0,u.jsx)("div",{style:l.description,children:(0,u.jsx)(p.FormattedMessage,{id:"searchFooter.commandSearch.tooltip.description",defaultMessage:"Try {shortcut} or click on {menuBarIcon} in your menubar to access search and Ask AI anytime, even with Notion minimized.",values:{shortcut:t,menuBarIcon:(0,u.jsx)(D,{})}})})]}),(0,u.jsx)("img",{style:l.image,src:s})]}):null}function D(){const e=(0,o.yK)((e=>({container:{display:"inline-block",position:"relative"},placeholder:{width:15,height:15,display:"inline-block"},flatMenuIcon:{position:"absolute",left:0,top:3,width:15,height:15,fill:"light"===e.mode?e.accentColors.gray[300]:e.accentColors.gray[600]}})),[]);return(0,u.jsxs)("div",{style:e.container,children:[(0,u.jsx)("span",{style:e.placeholder}),h(e.flatMenuIcon)]})}},86244:(e,t,s)=>{s.d(t,{$:()=>W,Z:()=>Q});var n=s(67294),r=s(83355),i=s(480),o=s(86628),a=s(24405),l=s(6637),d=s(35840),c=s(94804),u=s(70203),h=s(9291),p=s(37810),g=s(12457),m=s(43250),f=s(59139),v=s(97638),x=s(48779),S=s(5162),y=s(80444),b=s(21273),C=s(25904),M=s(30857),j=s(29026),I=s(73063),k=s(74194),w=s(68785),T=s(31278),P=s(26388),R=s(72787),Z=s(53965),F=s(51787),L=s(87531),O=s(70782),B=s(81598),A=s(60709),D=s(58476),E=s(69327),V=s(55320),_=s(31945),q=s(78140),K=s(53437),N=s(33991),H=s(85893);function U(e){const{events:t,spaceIcon:s,spaceName:r}=e,[i,o]=(0,n.useState)(!1),l=(0,a.yK)((e=>({downIcon:{height:8,width:8,stroke:e.icon.tertiary},wrapper:{display:"flex",alignItems:"center",gap:2,paddingRight:5,cursor:"pointer"},recordIcon:{backgroundColor:i?e.buttonHoveredBackground:void 0,padding:4,height:void 0,width:void 0}})),[i]);return(0,H.jsxs)("span",{...t,style:l.wrapper,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),role:"button",children:[(0,H.jsx)(T.Z,{bucket:"public",disabled:!0,icon:s,isEmptyPage:!1,size:24,style:l.recordIcon,title:r}),(0,R.Y)(l.downIcon)]})}const z=function(){const e=(0,o.VK)((()=>y.default.state.currentSpaceStore),[]),t=(0,o.VK)((()=>null==e?void 0:e.id),[null==e?void 0:e.id]),s=(0,i.O7)(),r=(0,o.VK)((()=>s.currentUser.id),[s.currentUser.id]),{handlePopupOpen:a,handlePopupClose:l}=(0,n.useContext)(N.SearchStaticContext),d=(0,n.useCallback)((async e=>{const{newSpaceView:t,associatedUserId:n,closeSwitcherPopupFn:i}=e,o=t.getSpaceId();if(t&&r&&o){var a;const e=null===(a=y.default.state.currentSpaceViewStore)||void 0===a?void 0:a.id,l=V.default.state.sessionId;e&&l&&o&&F.fh(s,{currentSearchSessionId:l,currentWorkspaceId:e,newWorkspaceId:o}),i(),y.default.update((e=>({...e,currentSpaceViewStore:t,currentSpaceStore:null==t?void 0:t.getSpaceStore()}))),r!==n&&await O.x({environment:s,newCurrentUserId:n}),b.Z.isAiEnabled()&&B.L6.loader().then((e=>{let{assistantActions:t}=e;t.clearAllAssistantSessions()})),E.Z.reinitializeState(s,n,o),V.default.closeAndResetMetricsState(),M.default.reset(),L.UT({environment:s,analyticsFrom:"quick-search-switch-workspace",isQuickSearch:!0,renderAsPage:!0})}}),[r,s]),{spaceIcon:c,spaceName:u}=(0,o.VK)((()=>e?{spaceName:e.getName(),spaceIcon:(0,x.Wd)(s,e)}:{spaceName:void 0,spaceIcon:void 0}),[e,s]),h=[...s.currentUser.loggedInUserIds],p=(0,o.VK)((()=>{var e;return Z.mN(Z.oA((null===(e=y.default.state.currentUserRootStore)||void 0===e?void 0:e.getSpaceViewStores())??[]),(e=>e.getSpaceId()))}),[]);return e?!t||!r||!e||p.length<=1&&1===h.length?null:(0,H.jsx)(_.ZP,{popupType:_.Z4.Popup,renderOrigin:e=>(0,H.jsx)(U,{events:e,spaceIcon:c,spaceName:u}),render:e=>(0,H.jsx)(q.Z,{menuType:A.og.Popup,children:h.map(((t,s)=>(0,H.jsx)(D.LP,{onSpaceClick:s=>d({newSpaceView:s.spaceViewStore,associatedUserId:t,closeSwitcherPopupFn:e.close}),userId:t,isLastUser:s===h.length-1,disableAccountActions:!0,hideShortcuts:!0},`commandSearch-userworkspaces-${s}`)))}),onClick:a,onClose:l,disabled:!1,placementToOrigin:K.ZP.Placement.Bottom,alignmentToOrigin:K.ZP.Alignment.Start,style:{marginRight:30}}):null},W=48;class G extends r.Z{constructor(){super(...arguments),this.typingTimer=void 0,this.renderLeft=()=>{const{showSpinner:e,selectedResult:t,quickSearchMode:s}=this.props,{device:n}=this.environment,r=this.styles,i={...J(this.theme).searchIcon,...r.searchIcon};if(s)return(0,H.jsx)(z,{});const o=null==t?void 0:t.getIcon(),a=Boolean(j.ZP.state.query.text.trim())&&!n.isMobile;return(0,H.jsx)(g.Z,{show:e,showDelay:500,showHold:200,render:e=>(e=>(0,H.jsx)("div",{style:r.headerIcon,children:e?(0,H.jsx)(w.Z,{style:i}):a?(0,H.jsx)(T.Z,{disabled:!0,icon:o,isEmptyPage:Boolean(o),size:20}):(0,d.R)(i)}))(e)})},this.handleQueryChange=e=>{this.handleTyping();const t=String(e.target.value);this.props.onQueryChange(t)},this.isPopupOpen=this.createComputedStore((()=>j.ZP.state.isPopupOpen)),this.styles={inputDesktop:{fontSize:18,height:W,paddingLeft:12,paddingRight:16,alignItems:"center",flexGrow:0,flexShrink:0,zIndex:1},inputMobile:{fontSize:16,border:"none",boxShadow:"none",borderRadius:7,lineHeight:"1.2",padding:"6px 8px"},searchIcon:{width:16,height:16},headerIcon:{height:24,width:24,display:"flex",alignItems:"center",justifyContent:"center"},input:{minWidth:0,...p.Z.textOverflowStyle},suggestedText:{whiteSpace:"pre",color:this.theme.mediumTextColor},suggestedTextWrapper:{overflow:"hidden",textOverflow:"ellipsis"},autoCompletedText:{background:this.theme.tint.regular},clearButton:{marginLeft:8},userInputAndSuggestedTextContainer:{display:"grid",gridTemplateColumns:"auto 1fr"}}}willUnmount(){this.typingTimer&&(clearTimeout(this.typingTimer),this.typingTimer=void 0)}renderComponent(){const{device:e}=this.environment,{isOpen:t,selectedResult:s,quickSearchMode:n}=this.props,r=this.styles,i=J(this.theme),o=j.ZP.state.query.text,a=function(e,t,s){if(0===s.length||s.length>=20||e.isMobile||void 0===t)return;const n=u.Jcv(t.getTitleValue()),r=n.replaceAll("\n"," "),i=n.slice(0,s.length),o=r.substring(s.length),a=n.length>0&&i.toLocaleLowerCase()===s.toLocaleLowerCase();if(a)return`${o} — ${G.messages.open.defaultMessage}`;return` — ${G.messages.open.defaultMessage}`}(e,s,o),l=o.trim().length>0&&a?(0,H.jsxs)("div",{style:r.userInputAndSuggestedTextContainer,children:[(0,H.jsx)("span",{style:{whiteSpace:"pre-wrap"},children:o}),(0,H.jsx)("div",{style:{...r.suggestedTextWrapper},className:n&&!this.isPopupOpen.state?m.pMC:void 0,children:(0,H.jsx)("span",{style:r.autoCompletedText,children:a})})]}):"",d=e.isMobile?k.B.ExtraLarge:k.B.Transparent,c=e.isMobile?{...r.inputMobile,...i.inputMobile}:{...r.inputDesktop,...i.inputDesktop},h=b.Z.showSearchAiFeatures()||(0,f.rd)(this.environment),p={...r.input,width:0===o.length&&n?`min(${X(this.props.intl,this.environment).length}ch, 100%)`:"100%"};return(0,H.jsx)("div",{style:{display:"flex",flex:1},className:n&&!this.isPopupOpen.state?m.pMC:void 0,children:(0,H.jsx)(k.Z,{format:d,placeholder:X(this.props.intl,this.environment),left:this.renderLeft(),value:o,suggestedText:l,suggestedTextStyle:r.suggestedText,focus:e.isMobile?void 0:t&&!C.Z.state.open,focusInitial:!(0,S.Y)("supportsNativeHome")&&e.isMobile,focusAfterAnimation:!0,showClearButton:!0,right:!e.isMobile&&h&&(0,H.jsx)($,{quickSearchMode:n}),isRightLastElementOfInput:!0,selectAll:!0,onChange:this.handleQueryChange,onClearButtonClick:Y,onFocus:()=>{(0,this.props.onFocusChange)(!0)},onBlur:()=>{(0,this.props.onFocusChange)(!1)},style:c,inputStyle:p})})}handleTyping(){void 0===M.default.state.firstKeyStrokeTimeMs&&M.default.update((e=>({...e,firstKeyStrokeTimeMs:Date.now()})));const{onTypingChange:e}=this.props;this.typingTimer&&window.clearTimeout(this.typingTimer),e(!0),this.typingTimer=window.setTimeout((()=>e(!1)),300)}}function $(e){const[t,s]=(0,o.VK)((()=>{const e=j.ZP.state.query.filters,t=(0,v.FN)(e);return[j.ZP.state.filterBar.show,t]}),[]),n=(0,i.O7)();(0,o.VK)((()=>{const e=n.currentUser.id;if(!e)return;!1===(0,c.fe)(e)&&!0===t&&j.ZP.collapseFilterBar()}),[n,t]);const r=(0,a.yK)((e=>({container:{padding:4,marginLeft:5,borderRadius:4,height:"fit-content",width:"fit-content",display:"flex"},hoveredContainerStyles:{background:s?e.accentColors.uiBlue[100]:e.buttonHoveredBackground},icon:{width:17,height:17,cursor:"pointer",fill:s?e.accentColors.uiBlue[600]:"light"===e.mode?e.accentColors.gray[300]:e.accentColors.gray[500]}})),[s]);return(0,H.jsx)(P.ZP,{renderTooltip:()=>(0,H.jsx)(H.Fragment,{children:(0,H.jsx)("div",{children:t?(0,H.jsx)(h.FormattedMessage,{id:"searchInputMenuItem.filterBarToggleButtonTooltip.hide",defaultMessage:"Hide filters"}):(0,H.jsx)(h.FormattedMessage,{id:"searchInputMenuItem.filterBarToggleButtonTooltip.show",defaultMessage:"Show filters"})})}),placement:P.ug.Bottom,alignment:P.v2.Start,disableTooltip:n.device.isMobile,delayThreshold:400,render:e=>(0,H.jsx)(I.Z,{...e,icon:e=>(0,l.I)(r.icon),ariaLabel:"Button to toggle the filter bar",style:r.container,hoveredStyle:r.hoveredContainerStyles,onClick:()=>t?j.ZP.collapseFilterBar():j.ZP.expandFilterBar()})})}G.displayName="SearchInputMenuItem",G.messages=(0,h.defineMessages)({open:{id:"search.inputMenu.suggestedText.open",defaultMessage:"Open"}});const Q=(0,h.injectIntl)(G);function X(e,t){const{currentSpaceStore:s,mainEditorCurrentBlockStore:n}=y.default.state,r=s&&(0,x.rn)(t,s);if(r&&b.Z.showSearchAiFeatures())return e.formatMessage({id:"searchInputMenuItem.placeholder.SearchOrAskQuestionInSpace",defaultMessage:"Search or ask question in {spaceName}…"},{spaceName:r});if(r)return e.formatMessage({id:"searchInputMenuItem.placeholder.searchInSpace",defaultMessage:"Search {spaceName}…"},{spaceName:r});if(n){const t=u.Jcv(n.getTitleValue()).slice(0,100);return e.formatMessage({id:"searchInputMenuItem.placeholder.namedPage",defaultMessage:"Search in {pageTitle}…"},{pageTitle:t})}return e.formatMessage({id:"searchInputMenuItem.placeholder.unnamedPage",defaultMessage:"Search in page…"})}function J(e){return{inputDesktop:{boxShadow:`0 1px 0 ${e.regularDividerColor}`},inputMobile:{background:e.inputBackground},searchIcon:{fill:e.mediumIconColor}}}function Y(){j.ZP.resetQuery({resetFilters:!0}),j.ZP.update((e=>({...e,source:"quick_find"})))}},69680:(e,t,s)=>{s.d(t,{Z:()=>de});s(57658);var n=s(94184),r=s.n(n),i=s(67294),o=s(83355),a=s(480),l=s(86628),d=s(24405),c=s(49085),u=s(15145);function h(e){var t;let{explanation:s,simple:n=!1,filterZeros:r=!1}=e;return function e(t,s){if(!t)return[];const{value:i,description:o,details:a}=t;if(0===i&&r)return[];const l=(0===i?"0":i.toFixed(4)).padStart(8);function d(e){return`${"  ".repeat(s+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0))}${e}`}const c=`[${l}] ${o}`;if(o.startsWith("match on required clause")){return[d(`[${l}] match on required clause ${null==a?void 0:a[1].description}`)]}if(["max of:","sum of:","min of:"].includes(o)&&1===(null==a?void 0:a.length))return e(a[0],s);if(o.startsWith("tf")||o.startsWith("idf")){var u;const e=o.split(",")[0],t=null===(u=o.split(" computed as ")[1])||void 0===u?void 0:u.replace(" from:","");return[d(`[${l}] ${e}: [${(a??[]).map((e=>`${e.description.split(",")[0]}=${e.value}`)).join(" ")}] --\x3e ${t}`)]}if(o.startsWith("ConstantScore(_id:"))return[d(`[${l}] ids query`)];const h=n&&0!==s&&(o.startsWith("weight")||o.startsWith("Function"));return[d(c.replace(", result of:","").replace(" from:","").replace(" [PerFieldSimilarity]","").replace(/:$/,"").trim()),...(h?[]:a??[]).flatMap((t=>e(t,s+1)))]}(null==s||null===(t=s.details)||void 0===t?void 0:t[0],0)}var p=s(75553),g=s(75e3),m=s(32240),f=s(94308),v=s(58203),x=s(21202),S=s(92338);var y=s(9291),b=s(31701),C=(s(53965),s(1898)),M=s(37810),j=s(893),I=s(21862),k=s(40468),w=s(97820),T=(s(95477),s(28020)),P=s(69988),R=s(84210),Z=s(33929),F=s(98742),L=s(98165),O=s(59139),B=s(16402),A=s(77907),D=s(77080),E=s(6258),V=s(32470),_=s(29026),q=s(35057),K=s(16011),N=s(90403),H=s(52275),U=s(64133),z=s(73063),W=s(50506),G=s(31278),$=s(86176),Q=s(76798),X=s(26388),J=(s(3043),s(60709),s(95697),s(64921),s(31945),s(96525),s(78140),s(32163),s(40721),s(89728),s(11470),s(72495),s(85893));var Y=s(66897),ee=s(45238);const te=(0,ee.IU)("arrowRightSquare",{viewBox:"0 0 18 18",svg:(0,J.jsx)("path",{d:"M3.06641 17.998L14.9121 17.998C16.9629 17.998 17.9785 16.9824 17.9785 14.9707L17.9785 3.04688C17.9785 1.03516 16.9629 0.0195312 14.9121 0.0195312L3.06641 0.0195312C1.02539 0.0195312 0 1.02539 0 3.04688L0 14.9707C0 16.9922 1.02539 17.998 3.06641 17.998ZM14.1797 8.98438C14.1797 9.20898 14.082 9.38477 13.8867 9.57031L10.4883 12.9785C10.3516 13.1152 10.1758 13.1934 9.96094 13.1934C9.54102 13.1934 9.22852 12.8711 9.22852 12.4512C9.22852 12.2363 9.31641 12.0508 9.45312 11.9141L10.7129 10.6738L11.9238 9.6582L9.79492 9.73633L4.56055 9.73633C4.12109 9.73633 3.80859 9.42383 3.80859 8.98438C3.80859 8.53516 4.12109 8.22266 4.56055 8.22266L9.79492 8.22266L11.9238 8.31055L10.7129 7.29492L9.45312 6.05469C9.32617 5.9082 9.22852 5.72266 9.22852 5.50781C9.22852 5.08789 9.54102 4.77539 9.96094 4.77539C10.1758 4.77539 10.3516 4.84375 10.4883 4.98047L13.8867 8.39844C14.0918 8.60352 14.1797 8.75977 14.1797 8.98438Z"})}),se=(0,ee.IU)("sidebarRight",{viewBox:"0 0 23 18",svg:(0,J.jsx)("path",{d:"M3.06641 17.998L19.9609 17.998C22.0117 17.998 23.0273 16.9824 23.0273 14.9707L23.0273 3.04688C23.0273 1.03516 22.0117 0.0195312 19.9609 0.0195312L3.06641 0.0195312C1.02539 0.0195312 0 1.02539 0 3.04688L0 14.9707C0 16.9922 1.02539 17.998 3.06641 17.998ZM3.08594 16.4258C2.10938 16.4258 1.57227 15.9082 1.57227 14.8926L1.57227 3.125C1.57227 2.10938 2.10938 1.5918 3.08594 1.5918L19.9414 1.5918C20.9082 1.5918 21.4551 2.10938 21.4551 3.125L21.4551 14.8926C21.4551 15.9082 20.9082 16.4258 19.9414 16.4258ZM14.082 16.7285L15.6152 16.7285L15.6152 1.29883L14.082 1.29883ZM17.4902 5.21484L19.5801 5.21484C19.8828 5.21484 20.1367 4.95117 20.1367 4.66797C20.1367 4.375 19.8828 4.12109 19.5801 4.12109L17.4902 4.12109C17.1973 4.12109 16.9336 4.375 16.9336 4.66797C16.9336 4.95117 17.1973 5.21484 17.4902 5.21484ZM17.4902 7.74414L19.5801 7.74414C19.8828 7.74414 20.1367 7.48047 20.1367 7.1875C20.1367 6.89453 19.8828 6.65039 19.5801 6.65039L17.4902 6.65039C17.1973 6.65039 16.9336 6.89453 16.9336 7.1875C16.9336 7.48047 17.1973 7.74414 17.4902 7.74414ZM17.4902 10.2637L19.5801 10.2637C19.8828 10.2637 20.1367 10.0195 20.1367 9.72656C20.1367 9.43359 19.8828 9.17969 19.5801 9.17969L17.4902 9.17969C17.1973 9.17969 16.9336 9.43359 16.9336 9.72656C16.9336 10.0195 17.1973 10.2637 17.4902 10.2637Z"})});var ne=s(90683),re=s(55320);function ie(e){const{store:t}=e,s=(0,l.VK)((()=>{const e=t.getCreatedByPointer();if(e)return(0,Y.Hl)({pointer:e,getRecordValue:t.getRecordValue})}),[t]),n=(0,l.VK)((()=>{const e=t.getLastEditedByPointer();if(e)return(0,Y.Hl)({pointer:e,getRecordValue:t.getRecordValue})}),[t]),r=(0,d.yK)((e=>({container:{backgroundColor:b.FN.light.gray[900],display:"flex",flexDirection:"column",borderRadius:8},preview:{fontSize:14,color:b.FN.light.gray[100],fontWeight:400,display:"flex",gap:10,alignItems:"center"}})),[]),i=(0,y.useIntl)();return(0,J.jsxs)("div",{style:r.container,children:[s&&(0,J.jsx)(oe,{store:t,activity:"created",actor:s}),n&&(0,J.jsx)(oe,{store:t,activity:"edited",actor:n}),(0,J.jsxs)("div",{style:{padding:10,display:"flex",justifyContent:"space-between",cursor:"pointer",alignItems:"center"},onClick:()=>re.default.update((e=>({...e,preferSidePeekOpen:!0}))),children:[(0,J.jsxs)("div",{style:r.preview,children:[(0,J.jsx)("span",{children:se({height:14,width:14})}),(0,J.jsx)("span",{children:i.formatMessage({id:"searchResultMenuItem.tooltip.sidePeek",defaultMessage:"Preview"})})]}),(0,J.jsx)("div",{style:{color:"#7F7F7F"},children:te({height:14,width:14})})]})]})}function oe(e){const{activity:t,actor:s,store:n}=e,r=(0,d.yK)((e=>({container:{display:"flex",flexDirection:"column",padding:"8px 10px 10px 10px",gap:8,borderBottom:`1px solid ${b.FN.light.gray[800]}`,minWidth:195},actorAvatarAndName:{display:"flex",alignItems:"center",gap:5},actorActivityInfo:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:10,fontSize:14},description:{color:"#7F7F7F",fontSize:12,fontWeight:600},date:{color:"#7F7F7F",fontSize:12}})),[]),[i]=(0,l.VK)((()=>{const e="created"===t?n.getCreatedTime():n.getLastEditedTime();return[(0,B.IS)(e,{useCompactFormat:!0,useLowercase:!0})]}),[t,n]),o=(0,y.useIntl)();return(0,J.jsxs)("div",{style:r.container,children:[(0,J.jsx)("div",{style:r.description,children:"edited"===t?o.formatMessage({id:"searchResultMenuItem.tooltip.lastEditedBy",defaultMessage:"Last edited by"}):o.formatMessage({id:"searchResultMenuItem.tooltip.createdBy",defaultMessage:"Created by"})}),(0,J.jsxs)("div",{style:r.actorActivityInfo,children:[(0,J.jsxs)("div",{style:r.actorAvatarAndName,children:[(0,J.jsx)("span",{children:(0,ne.a)({actor:s,size:20,style:{}})}),(0,J.jsx)("span",{children:(0,Y.$4)(o,s)})]}),(0,J.jsx)("div",{style:r.date,children:i})]})]})}const ae=(0,y.defineMessages)({openInSidePeekButtonLabel:{id:"search.result.openInSidePeek.button.label",defaultMessage:"Open search result in side peek"},copySearchResultLinkButtonLabel:{id:"search.result.copyLink.button.label",defaultMessage:"Copy link to search result"}});class le extends o.Z{constructor(){super(...arguments),this.storeTypes={explanationModalOpen:c.default.createClass(!1)},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_debugHitCustomRenderer=e=>Be(e,this.stores.explanationModalOpen)}renderComponent(){const{focused:e,isLastInSection:t,inline:s,className:n}=this.props,i=Ce(this.environment,this.theme,this.props.inline),o=be(this.theme),a={...i.menuItem,...!s&&!t&&!e&&!this.props.isBeforeFocused&&o.menuItemBorder},l={...i.caption,...o.caption},d={...i.timestamp,...o.timestamp},c={...i.textWrapper,...this.props.inline&&i.inlineTextWrapper},u={title:(0,J.jsx)(Oe,{store:this.props.store,result:this.props.result,placeholder:this.props.placeholder,index:this.props.index,inline:this.props.inline,focused:this.props.focused,originalPosition:this.props.originalPosition}),icon:(0,J.jsx)(xe,{store:this.props.store}),caption:(0,J.jsx)(Ae,{store:this.props.store,inline:this.props.inline,result:this.props.result,debugLocal:this.props.debugLocal,debugHits:this.props.debugHits,debugAreaRef:this.props.debugAreaRef,explanationModalOpen:this.stores.explanationModalOpen}),body:(0,J.jsx)(Me,{result:this.props.result,store:this.props.store,inline:this.props.inline}),right:(0,J.jsx)(Le,{inline:this.props.inline,focused:this.props.focused,store:this.props.store,type:this.props.type,lastViewed:this.props.lastViewed,queryId:this.props.queryId,result:this.props.result}),rightStyle:e?void 0:d,dontShrinkRight:!0,captionStyle:l,style:a,spacerStyle:(h=this.props.store,p=this.props.hidePath,p||!(0,$.L)(h)?me:void 0),textWrapperStyle:c,className:r()("notranslate",n),buttonStyle:{paddingLeft:2},hoveredStyle:{background:this.theme.tint.regular}};var h,p;const g=D.default.checkGate("search_toggle_side_peek"),m=(0,O.rd)(this.environment)&&g,f=(0,q.Mk)()&&!(0,O.Qi)(this.environment)&&!_.ZP.state.isDebugSidebarOpen,v=f&&m&&this.props.focused;return f?(0,J.jsx)(X.ZP,{delayThreshold:50,placement:X.ug.Right,originGap:18,renderTooltip:()=>(0,J.jsx)(ye,{store:this.props.store}),style:v?i.sidePeekTooltip:i.tooltip,forceVisibleState:!!v||void 0,allowHover:!!v,render:e=>(0,J.jsx)(H.Z,{...this.props,...u,disableTransition:!0,...(0,F.Z)(this.props,e)}),closeDelay:0}):(0,J.jsx)(H.Z,{...this.props,...u,disableTransition:!0,ignoreLocalHoverState:!0})}shouldComponentUpdate(e,t,s){var n,r;const i=e.focused!==this.props.focused,o=(null===(n=e.result)||void 0===n?void 0:n.highlight)!==(null===(r=this.props.result)||void 0===r?void 0:r.highlight),a=e.isLastInSection!==this.props.isLastInSection,l=e.isBeforeFocused!==this.props.isBeforeFocused;return i||o||a||l}}le.displayName="SearchResultMenuItem";const de=le;function ce(e){let{data:t}=e;const s=t;if(!s)return null;const{localSource:n}=s;let r=n;return r||(r=new Set(["unknown"])),{element:(0,J.jsx)(J.Fragment,{children:`from ${[...r].join(",")}`}),expanded:!1}}const ue={paddingLeft:5,paddingRight:20,paddingTop:2,paddingBottom:2,border:"1px solid black",color:b.FN.dark.green[900]},he={...ue,color:b.FN.dark.gray[30]},pe={maxHeight:200,overflowY:"scroll"},ge={border:"1px solid black"};const me={visibility:"hidden"};function fe(e){return e&&!e.sources.includes(S.vp.Local)}function ve(e){var t;let{result:s,index:n,originalPosition:r}=e;const i=null===(t=(null==s?void 0:s.sources)??[])||void 0===t?void 0:t.flatMap((e=>e===S.vp.Local?["💻"]:e===S.vp.ElasticSearch?["🌐"]:e===S.vp.Postgres?["🐘"]:e===S.vp.VectorDBBlock||e===S.vp.VectorDBCollection?["🔭"]:e===S.vp.ElasticsearchRandom?["🎲"]:e===S.vp.ElasticsearchUniqueID?["🆔"]:e===S.vp.ElasticsearchForcedRecentRecall?["⏰"]:void(0,C.t1)(e))).reverse(),o=[...void 0===n||void 0===r?[" "]:n>r?["⬇️"]:n<r?["⬆️"]:[],...i].join("").trim();return o?(0,J.jsx)("span",{children:o}):null}function xe(e){let{store:t}=e;const s=(0,l.VK)((()=>t.getIcon()),[t]),n=(0,l.VK)((()=>t.isEmptyPage()),[t]);return(0,J.jsx)(G.Z,{disabled:!0,icon:s,isEmptyPage:n,size:20,largeIcon:!1})}function Se(e){return"recent_pages"===e?u.tY.SearchRecents:u.tY.SearchQuery}function ye(e){let{store:t}=e;const s=(0,a.O7)();return(0,O.rd)(s)?(0,J.jsx)(ie,{store:t}):(0,J.jsx)(K.Z,{store:t})}function be(e){return{nonHighlightedTextColor:{color:e.text.secondary},menuItemBorder:{boxShadow:`0 1px 0 ${e.lightDividerColor}`},highlightedText:{color:e.text.primary},enterIcon:{fill:e.icon.secondary},bookmarkedIcon:{fill:e.topbarFavorite},caption:{color:e.text.secondary},captionTooltip:{color:e.text.contrast},captionTooltipDivider:{color:e.text.contrast},timestamp:{color:e.text.tertiary},tooltipTitle:{color:e.text.secondary},tooltipText:{color:e.text.primary},tooltipValue:{color:e.text.tertiary}}}function Ce(e,t,s){return{title:{fontWeight:M.Z.fontWeight.medium,lineHeight:"20px"},titleContent:{display:"flex",...s?{}:{width:0,flexGrow:1}},menuItem:{minHeight:36,paddingTop:e.device.isMobile?12:8,paddingBottom:e.device.isMobile?12:8},textWrapper:{marginLeft:4,alignItems:"center",width:"100%"},inlineTextWrapper:{alignItems:"center"},highlight:{fontWeight:M.Z.fontWeight.medium},vectorHighlight:{fontWeight:M.Z.fontWeight.medium,whiteSpace:"pre-wrap"},rightContentWrapper:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},rightIcon:{height:12,width:12},rightIconButtonIcon:{height:12,width:12},rightIconButtonWrapper:{height:18,width:18,marginRight:6},uniqueIDBadgeWrapper:{display:"flex",gap:8,marginRight:8,alignItems:"center"},caption:{marginTop:1},debugArea:{fontFamily:"monospace"},timestamp:{fontSize:M.Z.fontSize.UISmall.desktop,fontWeight:M.Z.fontWeight.regular},tooltip:{maxWidth:300},sidePeekTooltip:{background:"transparent",boxShadow:"none"},tooltipTitle:{fontWeight:M.Z.fontWeight.medium,fontSize:M.Z.fontSize.UISmall.desktop},tooltipText:{fontWeight:M.Z.fontWeight.medium,fontSize:M.Z.fontSize.UISmall.desktop,marginLeft:0,paddingRight:20},tooltipValue:{fontSize:M.Z.fontSize.UISmall.desktop,fontWeight:M.Z.fontWeight.regular},tooltipMenuItem:{minHeight:20},badge:{background:"light"===t.mode?t.accentColors.blue[30]:t.accentColors.blue[200]},badgeContent:{display:"flex",alignItems:"center",width:"100%"},badgeCaption:{marginLeft:2,color:t.blueColor},grayedOutBadgeCaption:{marginLeft:1},vectorBadge:{background:t.invoiceGreen,color:t.contentBackground},verifiedBadgeIcon:{width:10,height:10,fill:t.blueColor},right:{display:"flex"},collectionTextMatchingProperty:{lineHeight:2,fontSize:12}}}function Me(e){var t,s;let{result:n,store:r,inline:i}=e;const o=(0,d.Fg)(),c=(0,a.O7)(),u=n?E.G.createChildStore(r,{table:x.iU,id:n.id,spaceId:n.spaceId}):void 0,h=(0,l.VK)((()=>null==u?void 0:u.isNavigableBlock()),[u]);if(!n)return null;if(!n.highlight)return null;if(h&&!fe(n))return null;let p,g;if(n.highlight.text)p=n.highlight.text;else if(n.highlight.collectionText){var m;p=n.highlight.collectionText,g=null==n||null===(m=n.matchedCollectionProperties)||void 0===m?void 0:m.collectionText}if(p=(0,v.$B)(p),!p)return null;const f=(0,P.ZP)(p);let y=!1;if(fe(n)){const e=e=>e.filter(P.il).map((e=>e[0].toLowerCase())),t=t=>void 0===t?[]:e((0,P.ZP)(t)),s=[...new Set([...t(n.highlight.title),...t(n.highlight.pathText)])],r=e=>s.some((t=>t.includes(e)));y=e(f).every((e=>r(e)))}const b=null!==(t=n.sources)&&void 0!==t&&t.includes(S.vp.VectorDBBlock)||null!==(s=n.sources)&&void 0!==s&&s.includes(S.vp.VectorDBCollection)?Ce(c,o,i).vectorHighlight:Ce(c,o,i).highlight,{highlightedText:C}=be(o),M=y?{}:{...b,...C};return(0,J.jsxs)(J.Fragment,{children:[void 0!==g&&(0,J.jsx)(w.Z,{propertySchema:g,showIcon:!0,style:Ce(c,o,i).collectionTextMatchingProperty}),(0,J.jsx)(U.Z,{text:p,highlighter:{tokenize:e=>(0,P.Vu)(f),style:M}})]})}function je(e){let{label:t,inline:s}=e;const n=(0,d.Fg)(),r=(0,a.O7)();return(0,J.jsx)(N.Z,{style:Ce(r,n,s).badge,content:(0,J.jsxs)("div",{style:Ce(r,n,s).badgeContent,children:[(0,f.f)(Ce(r,n,s).verifiedBadgeIcon),(0,J.jsx)("div",{style:Ce(r,n,s).badgeCaption,children:t})]})})}function Ie(e){let{label:t,inline:s}=e;const n=(0,d.Fg)(),r=(0,a.O7)();return(0,J.jsx)(N.Z,{style:Ce(r,n,s).badge,content:(0,J.jsx)("div",{style:Ce(r,n,s).badgeCaption,children:t})})}function ke(e){let{label:t,inline:s}=e;const n=(0,d.Fg)(),r=(0,a.O7)();return(0,J.jsx)(N.Z,{style:Ce(r,n,s).badge,content:(0,J.jsx)("div",{style:Ce(r,n,s).badgeCaption,children:t})})}function we(e){let{label:t,inline:s}=e;const n=(0,d.Fg)(),r=(0,a.O7)();return(0,J.jsx)(N.Z,{content:(0,J.jsx)("div",{style:Ce(r,n,s).grayedOutBadgeCaption,children:t})})}function Te(e){let{inline:t}=e;const s=(0,d.Fg)(),n=(0,a.O7)();return(0,J.jsx)(N.Z,{content:(0,J.jsx)("div",{style:Ce(n,s,t).grayedOutBadgeCaption,children:(0,J.jsx)(y.FormattedMessage,{id:"search.result.archived.badge.text",defaultMessage:"Archived"})})})}function Pe(e){let{inline:t}=e;const s=(0,d.Fg)(),n=(0,a.O7)();return(0,J.jsx)(N.Z,{content:(0,J.jsx)("div",{style:Ce(n,s,t).grayedOutBadgeCaption,children:(0,J.jsx)(y.FormattedMessage,{id:"search.result.current.page.badge.text",defaultMessage:"Current Page"})})})}function Re(e){let{focused:t,inline:s,store:n,type:r,lastViewed:i,queryId:o,result:c}=e;const u=(0,a.O7)(),h=(0,d.Fg)(),f=(0,l.VK)((()=>!1),[]);if(u.device.isMobile)return null;if(i&&!t)return(0,J.jsx)(J.Fragment,{children:(0,B.IS)(i,{useCompactFormat:!0})});const v=Ce(u,h,s),x=be(h),S={...v.rightIcon,...x.enterIcon,opacity:t?1:0},y={...v.rightIconButtonIcon,opacity:t?1:0};return f?(0,J.jsxs)("div",{style:v.rightContentWrapper,children:[(0,J.jsx)(z.Z,{icon:m.y,iconStyle:y,showShadow:t,style:v.rightIconButtonWrapper,onClick:()=>function(e,t,s,n,r){const i=Se(t);r?k.P({searchResult:r,openInSidePeek:!0,environment:s,pageVisitSource:i,queryId:n,openInNew:void 0}):I.r({store:e,queryId:n,environment:s,pageVisitSource:i,openInSidePeek:!0,peekMode:"s"})}(n,r,u,o,c),ariaLabel:Z.default.formatMessage(ae.openInSidePeekButtonLabel)}),(0,J.jsx)(z.Z,{icon:p.U,iconStyle:y,showShadow:t,style:v.rightIconButtonWrapper,onClick:()=>function(e,t,s,n){const r=(0,R.ZP)({store:e,pageVisitSource:Se(t),queryId:n});j.RD({environment:s,stringValue:r,copiedMessage:j.tq.copiedLinkToClipboard})}(n,r,u,o),ariaLabel:Z.default.formatMessage(ae.copySearchResultLinkButtonLabel)}),(0,g.U)(S)]}):(0,J.jsx)(J.Fragment,{children:(0,g.U)(S)})}function Ze(e,t,s,n){const{words:r,removeDuplicate:i}=e;if(0===r.length)return;const o={...Ce(t,s,n).highlight,...be(s).highlightedText},a=i?new Set:void 0;return{tokenize:e=>(0,P.XT)({text:e,patterns:r,uniqueTokenHighlighterContext:a}),style:o}}function Fe(e){var t;let{result:s,focused:n,inline:r}=e;const i=(0,d.Fg)(),o=(0,a.O7)(),c=null==s||null===(t=s.highlight)||void 0===t?void 0:t.uniqueId,u=(0,l.VK)((()=>"dark"===o.ThemeStore.state.mode),[o]);if(!c)return null;const h=Ce(o,i,r),p=Ze({words:[c]},o,i,r),g=n?u?b.FN.dark.translucentGray[300]:b.se.light.darkgray.alpha(.09):u?b.FN.dark.translucentGray[200]:b.se.light.darkgray.alpha(.06);return(0,J.jsxs)("div",{style:h.uniqueIDBadgeWrapper,children:[(0,J.jsx)("div",{children:(0,J.jsx)(U.Z,{text:c,highlighter:p})}),(0,J.jsx)("div",{style:{borderRight:`1.5px solid ${g}`,height:14,borderRadius:1}})]})}function Le(e){let{inline:t,focused:s,store:n,type:r,lastViewed:i,queryId:o,result:l}=e;const c=(0,d.Fg)(),u=(0,a.O7)();return(0,J.jsx)("div",{style:Ce(u,c,t).right,children:(0,J.jsx)(Re,{focused:s,inline:t,store:n,type:r,lastViewed:i,queryId:o,result:l})})}function Oe(e){let{store:t,result:s,placeholder:n,index:r,inline:i,focused:o,originalPosition:c}=e;const u=(0,d.Fg)(),h=(0,a.O7)(),p=Ce(h,u,i),g=be(u),m=void 0===s,f={...p.title,...!m&&!o&&g.nonHighlightedTextColor},v=(0,l.VK)((()=>{const e=[];if(s&&s.highlight)if(e.push(...(0,P.fe)(s.highlight.pathText)),fe(s))e.push(...(0,P.fe)(s.highlight.title));else{E.G.createChildStore(t,{table:x.iU,id:s.id,spaceId:s.spaceId}).isNavigableBlock()&&e.push(...(0,P.fe)(s.highlight.text))}return e}),[s,t]);const y=o?void 0:Ze({words:v},h,u,i),b=(0,l.VK)((()=>{var e;return null===(e=(0,L.VP)(t))||void 0===e?void 0:e.isArchived()}),[t]),C=function(e){if(e)return e.sources.includes(S.vp.ElasticsearchUniqueID)}(s),M=(0,l.VK)((()=>(0,T.zj)()),[]),j=M&&M===(null==s?void 0:s.id);const I=(0,l.VK)((()=>(0,q.Mk)()&&!j&&!b),[j,b])?function(){function e(e){var t;return null==s||null===(t=s.badges)||void 0===t?void 0:t.find((t=>t.type===e))}for(const t of["is_template","popular_this_week","most_viewed","verified"]){const s=e(t);if(void 0!==s)return{type:s.type,label:s.label}}}():void 0,k={is_template:e=>(0,J.jsx)(we,{label:e,inline:i}),verified:e=>(0,J.jsx)(je,{label:e,inline:i}),popular_this_week:e=>(0,J.jsx)(Ie,{label:e,inline:i}),most_viewed:e=>(0,J.jsx)(ke,{label:e,inline:i})},w=(0,l.VK)((()=>V.ZP.state.showDebugInfo),[]);return(0,J.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",...f},children:[(0,J.jsxs)("div",{style:p.titleContent,children:[w&&void 0!==r&&`${r+1}. `,C&&(0,J.jsx)(Fe,{focused:o,inline:i,result:s}),(0,J.jsx)(Q.Z,{style:f,store:t,placeholder:n,highlighter:y}),!1,b&&(0,J.jsx)(Te,{inline:i}),j&&(0,J.jsx)(Pe,{inline:i}),I&&k[I.type](I.label)]}),w&&(0,J.jsx)(ve,{result:s,index:r,originalPosition:c})]})}function Be(e,t){const{data:s,keyPath:n}=e;if(2===n.length&&"_explanation"===n[0])return{element:(0,J.jsx)(J.Fragment,{children:(0,J.jsx)("button",{onClick:e=>{t.setState(!0),e.stopPropagation()},children:"show simplified explanation"})}),expanded:!1};const r=s._ltrlog;if(r)return function(e){const t=Object.keys(e[0])[0],s=e[0][t].map(((e,t)=>{const s=t%2==0?he:ue;return(0,J.jsxs)("tr",{children:[(0,J.jsx)("td",{style:s,children:`${t}`}),(0,J.jsx)("td",{style:s,children:`${e.name}`}),(0,J.jsx)("td",{style:s,children:`${e.value}`})]},e.name)}));return{element:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("div",{children:(0,J.jsx)("b",{children:`Featureset: ${t}`})}),(0,J.jsx)("div",{style:pe,children:(0,J.jsx)("table",{style:ge,children:s})})]}),expanded:!1}}(r);if(!["_score","matched_queries"].every((e=>s[e])))return null;const{_score:i,matched_queries:o}=s;return{element:(0,J.jsx)(J.Fragment,{children:`score ${i}, ${(o??[]).length} matched query clauses`}),expanded:!1}}function Ae(e){let{store:t,inline:s,result:n,debugLocal:r,debugHits:o,debugAreaRef:c,explanationModalOpen:u}=e;const p=(0,d.Fg)(),g=(0,a.O7)(),m=(0,i.useCallback)((e=>Be(e,u)),[u]),{device:f}=g,v=Ze({words:(0,P.fe)(n&&n.highlight&&n.highlight.pathText),removeDuplicate:!0},g,p,s),x=s||f.isMobile?0:2,S=(o??[]).find((e=>"elasticsearch"===e.type&&void 0!==e._explanation)),y="elasticsearch"===(null==S?void 0:S.type)?null==S?void 0:S._explanation:void 0,b=(0,l.VK)((()=>Boolean(V.ZP.getDebugLevel())),[]);return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)($.Z,{store:t,extraLength:x,showFullPathInTooltip:!0,highlighter:v,enableHoverAncestor:!0,tooltipStyle:be(p).captionTooltip,tooltipDividerStyle:be(p).captionTooltipDivider}),(0,J.jsxs)("div",{ref:c,children:[r&&(0,J.jsx)("div",{style:Ce(g,p,s).debugArea,children:(0,J.jsx)(A.LazyAdminReactJson,{data:{debugLocal:r},defaultCollapsed:!0,customCollapsedRenderers:[ce],showCopyButton:!1,showModalButton:!1})}),o&&(0,J.jsx)("div",{style:Ce(g,p,s).debugArea,children:(0,J.jsx)(A.LazyAdminReactJson,{data:{debugHits:o},defaultCollapsed:!0,customCollapsedRenderers:[m],showCopyButton:"small",showModalButton:!0})}),o&&(null==n?void 0:n.rankingSignals)&&(0,J.jsx)("div",{style:Ce(g,p,s).debugArea,children:(0,J.jsx)(A.LazyAdminReactJson,{data:{rankingSignals:n.rankingSignals},defaultCollapsed:!0,showCopyButton:"small",showModalButton:!1})}),b&&(null==n?void 0:n.featureGroups)&&(0,J.jsx)("div",{style:Ce(g,p,s).debugArea,children:(0,J.jsx)(A.LazyAdminReactJson,{data:{featureGroups:n.featureGroups},defaultCollapsed:!0,showCopyButton:"small",showModalButton:!1})}),y&&(0,J.jsx)(W.Z,{open:u.state,innerStyle:{maxHeight:"90vh",maxWidth:"90vw",height:"90vh",width:"90vw",overflow:"scroll",padding:10},onDismiss:()=>{u.setState(!1)},render:()=>(0,J.jsx)("pre",{children:h({explanation:y}).join("\n")})})]})]})}},82063:(e,t,s)=>{s.d(t,{Z:()=>O});var n=s(67294),r=s(480),i=s(86628),o=s(53965),a=s(33991),l=s(75822),d=s(32470),c=(s(57658),s(59054)),u=s(21202),h=s(94804),p=s(92338),g=s(1898),m=s(19584),f=s(51787),v=s(59139),x=s(97638),S=s(18245),y=s(52432),b=s(80444),C=s(88632),M=s(77080),j=s(69327),I=s(84166),k=s(6258),w=s(55320),T=s(30857),P=s(29026);function R(e){let{dependencies:t,debugColumnStore:s,localDebounce:n=75,serverSearchFn:a,searchResultStore:l,permanentFilterOverride:d,enabled:u,preventUpdateSearchMetrics:p}=e;const g=(0,r.O7)(),m=(0,i.VK)((()=>function(e){const{debugColumnStore:t}=e,s=t.state.searchExperimentOverrides;function n(e){return(null==s?void 0:s[e])??M.default.getGroup(e,{disableExposureLogging:!0})}return{isLocalBlendingDisabled:"on"===n("search-no-local-blending"),forcedClusterPattern:t.state.forcedClusterPattern,searchExperimentOverrides:t.state.searchExperimentOverrides,forcedBlockIds:t.state.forcedBlockIds}}({debugColumnStore:s})),[s]);(0,c.r5)((()=>u?async function(e){var t;const{query:s,openAsPage:n,store:r,serverSearchFn:i}=e;if(n&&o.Xy(s,r.state.selectedQueryResultQuery))return;const a=Date.now();!function(e){const{isLocalBlendingDisabled:t,parentStore:s,environment:n,query:r,debug:i,limit:a,hasPublicAccessPermission:l,isOnline:d,store:c,permanentFilterOverride:u,preventUpdateSearchMetrics:p,now:g}=e;if("quick_find_scroll"===P.ZP.state.source||"relevance"!==r.sort.field)return;let m;const v={...r,filters:{...r.filters,...u}},b=function(e){const t=[];e.match(h.LO)&&t.push("literal");e.match(h.nZ)&&t.push("negation");return t}(r.text);(function(e){const{isLocalBlendingDisabled:t,queryOperations:s,queryText:n,shouldOperationsSkipLocalSearch:r}=e,i=r&&s.length>0;return!o.xb(n.trim())&&!t&&!i})({isLocalBlendingDisabled:t,queryOperations:b,queryText:r.text,shouldOperationsSkipLocalSearch:M.default.checkGate("search_operations_skip_local_search")})&&(b.length>0&&f.Cr(n,{operations:b,searchSessionId:w.default.state.sessionId}),m=x.b9(function(e){const{parentStore:t,requestInput:s,isOnline:n,environment:r,hasPublicAccessPermission:i,localSearchCache:o}=e,{query:a}=s;if(!o)return;if(!a.text.trim())return;if(i)return;const l=S.default.mark("rum.local_quick_search_query"),d=(0,y.Y)({query:s,localCachedPages:o,parentStore:t,environment:r,isOnline:n,shouldLimitLocalResultsWhenOnline:!0,applyScoreThresholdWhenOnline:!0,maxLocalResultsOverride:void 0,canUseLtr:!0});return S.default.measure(l,{environment:r}),d}({parentStore:s,environment:n,requestInput:{query:v,debug:i,limit:a},hasPublicAccessPermission:l,isOnline:d,localSearchCache:I.Z.state.localSearchableBlocksCache})),p||T.default.update((e=>({...e,numLocalRequests:e.numLocalRequests+1}))));c.update((e=>{var t;return null===(t=m)||void 0===t||t.results.forEach((t=>e.timesToRender.set(t.id,Date.now()-g))),{...e,localResults:m}}))}({...e,now:a});const l=new Set;null===(t=r.state.localResults)||void 0===t||t.results.forEach((e=>l.add(e.id))),await i({...e,now:a,excludedBlockIds:[...l]})}({...t,...m,store:l,serverSearchFn:a,environment:g,permanentFilterOverride:d,preventUpdateSearchMetrics:p}):Promise.resolve()),[t,m,l,a,g,d,u,p],{debounce:n})}async function Z(e){var t,s,n,r,i,o;let{parentStore:a,environment:l,query:d,debug:c,isOnline:y,publicAccessPermissionAncestorBlockId:b,currentSpaceStore:C,searchExperimentOverrides:M,forcedClusterPattern:I,store:R,forcedBlockIds:Z,limit:F,permanentFilterOverride:L,excludedBlockIds:O,preventUpdateSearchMetrics:B,now:A}=e;const D={...d,filters:{...d.filters,...L}};if(!D.text.trim()&&!x.FN(D.filters))return;const E=P.ZP.state.source,V="quick_find_scroll"===E,_=V||0===T.default.state.numServerRequests;R.update((e=>{var t;return{...e,serverResultsLoading:!0,..._?{serverResults:e.serverResults,serverEventProperties:null===(t=e.serverResults)||void 0===t?void 0:t.serverEventProperties}:{serverResults:void 0,serverEventProperties:void 0}}})),B||T.default.update((e=>({...e,numServerRequests:e.numServerRequests+1})));const q=(0,h.A7)({searchSessionId:w.default.state.sessionId,searchSessionFlowNumber:T.default.state.numServerRequests}),K={query:D,debug:c,limit:F},N=await async function(e){const{parentStore:t,requestInput:s,isOnline:n,environment:r,publicAccessPermissionAncestorBlockId:i,searchSessionId:o,searchSessionFlowNumber:a,source:l,spaceId:d,searchExperimentOverrides:c,forcedClusterPattern:h,forcedBlockIds:f,excludedBlockIds:v}=e;if(!n)return{error:p.Ix.Offline};const y=S.default.mark("rum.server_quick_search_query"),b=await x.MS({environment:r,input:s,spaceId:d,publicAccessPermissionAncestorBlockId:i,searchSessionId:o,searchSessionFlowNumber:a,source:l,searchExperimentOverrides:c,forcedClusterPattern:h,recentPagesForBoosting:d&&"on"!==(null==c?void 0:c["search-debug-only-no-recent-boosting"])?j.Z.getWithoutSubscribing(d):[],forcedBlockIds:f,excludedBlockIds:v});if(!b)return;if("failed"===b.type)return b.offline?{error:p.Ix.Offline}:{error:p.Ix.RequestFailed};const{trackEventProperties:C,results:M,total:I,debug:w,clusterInfo:T}=b.data,P=(0,m.m8)((0,g.qP)(C).map((e=>{let[t,s]=e;return[`server-${t}`,s]}))),R=M.map(((e,s)=>({...e,serverEventProperties:P,originalPosition:s,store:k.G.createChildStore(t,{table:u.iU,id:e.id})})));return S.default.measure(y,{environment:r}),{value:{results:R,total:I,debugInfo:w,serverEventProperties:P,clusterInfo:T}}}({parentStore:a,environment:l,requestInput:K,spaceId:null==C?void 0:C.id,searchSessionId:w.default.state.sessionId,searchSessionFlowNumber:T.default.state.numServerRequests,publicAccessPermissionAncestorBlockId:b,isOnline:y,source:E,searchExperimentOverrides:M,forcedClusterPattern:I,forcedBlockIds:Z,excludedBlockIds:O});if(q!==(0,h.A7)({searchSessionId:w.default.state.sessionId,searchSessionFlowNumber:T.default.state.numServerRequests}))return;if(!N||N.error)return R.update((e=>({...e,serverError:null==N?void 0:N.error,serverResultsLoading:!1,serverResults:void 0,serverEventProperties:void 0})));const H=V?x.Nu({existingResults:R.state.serverResults,newPageResults:N.value}):N.value;R.update((e=>(N.value.results.forEach((t=>e.timesToRender.set(t.id,Date.now()-A))),{...e,serverError:null==N?void 0:N.error,serverResultsLoading:!1,serverResults:H,serverResultsAllLoaded:N.value.results.length<F,serverEventProperties:N.value.serverEventProperties})));const U=(null===(t=R.state.serverResults)||void 0===t?void 0:t.results.map((e=>{var t;return{id:e.id,badges:(null===(t=e.badges)||void 0===t?void 0:t.map((e=>e.type)))??[]}})))??[],z=new Map;for(const{badges:u}of U)for(const e of u){const t=z.get(e)??0;z.set(e,t+1)}const{sections:W}=x.IV({intentBasedGrouping:(0,v.XP)(),localResults:null===(s=R.state.localResults)||void 0===s?void 0:s.results,serverResults:null===(n=R.state.serverResults)||void 0===n?void 0:n.results}),G={};for(const[u,h]of Object.entries(W))G[u]=h.map((e=>e.id));f.Zf(l,{numLocalResults:(null===(r=R.state.localResults)||void 0===r?void 0:r.results.length)||0,localResultsIds:(null===(i=R.state.localResults)||void 0===i?void 0:i.results.map((e=>e.id)))||[],numServerResults:(null===(o=R.state.serverResults)||void 0===o?void 0:o.results.length)||0,...R.state.serverEventProperties,badgeCounts:z,badgesByResultId:U,idsBySection:G,timeToRenderById:[...R.state.timesToRender.entries()].map((e=>{let[t,s]=e;return{id:t,timeToRender:s}}))})}const F=(0,o.Ds)(Z,l.rE),L=(0,o.Ds)(Z,l.rE);function O(){const e=(0,r.Fy)(),{searchResultStore:t,secondarySearchResultStore:s}=(0,n.useContext)(a.SearchStaticContext),{parentStore:o}=(0,n.useContext)(a.SearchStoresContext),l=function(e){const t=(0,r.O7)();return(0,i.VK)((()=>{const{hasPublicAccessPermission:s,publicAccessPermissionAncestorBlockId:n}=x.bC(t);return{isOnline:Boolean(C.Z.state.online),limit:P.ZP.state.limit,parentStore:e,hasPublicAccessPermission:s,publicAccessPermissionAncestorBlockId:n,currentSpaceStore:b.default.state.currentSpaceStore,debug:d.ZP.getDebugLevel(),openAsPage:w.default.state.openAsPage,currentSpaceViewStore:b.default.state.currentSpaceViewStore,query:P.ZP.state.query}}),[t,e])}(o),c=(0,i.VK)((()=>Boolean((0,d.gq)({device:e})&&d.BJ.state.visible)),[e]);R({dependencies:l,searchResultStore:t,debugColumnStore:d.v_,enabled:!0,serverSearchFn:F}),R({dependencies:l,searchResultStore:s,debugColumnStore:d.BJ,enabled:c,serverSearchFn:L,preventUpdateSearchMetrics:!0})}},52432:(e,t,s)=>{s.d(t,{Y:()=>T,f:()=>w});var n=s(21202),r=s(45366),i=s(92338),o=s(53965),a=s(7032),l=s(97978),d=s(97638),c=(s(57658),s(71384)),u=s(80444);class h{constructor(e,t,s){var n;this.featuresets=void 0,this.queryLower=void 0,this.userId=void 0,this.spaceId=void 0,this.currentTimeMs=void 0,this.pageSignals=void 0,this.resultsFeatureMetadata={},this.featuresets=e,this.queryLower=s.toLowerCase(),this.userId=t.currentUser.id,this.spaceId=null===(n=u.default.state.currentSpaceStore)||void 0===n?void 0:n.id,this.currentTimeMs=Date.now(),this.pageSignals=c.Z.getPageSignals({spaceId:this.spaceId,userId:this.userId})}minMaxScale(e,t,s){return t===s?0:(e-t)/(s-t)}extractFeatureGroup(e){const t=[];for(const s of this.featuresets){const n={groupName:s.name,features:[]};for(const t of s.features)n.features.push(t({result:e,featureExtractor:this}));t.push(n)}return t}}var p=s(26842),g=s(55320),m=s(29026),f=s(88893),v=s(43759);const x={name:"CLIENT_FEATURESET_RELEVANCY_MODEL",features:[function(e){let{result:t,featureExtractor:s}=e;return{name:"TIME_SINCE_LAST_EDIT",value:s.currentTimeMs-t.block.blockModel.last_edited_time}},function(e){let{result:t,featureExtractor:s}=e;return{name:"IS_LAST_EDITED_BY_ME",value:s.userId&&t.block.blockModel.last_edited_by_id===s.userId?1:0}},function(e){let{result:t,featureExtractor:s}=e;return{name:"IS_CREATED_BY_ME",value:s.userId&&t.block.blockModel.created_by_id===s.userId?1:0}},...i.ik.map((e=>t=>{let{result:s}=t;return{name:`BLOCK_SOURCE_${e}`,value:s.block.source.has(e)?1:0}})),function(e){var t;let{result:s,featureExtractor:n}=e;return{name:"PAGE_AUTHORITY_V1",value:n.pageSignals?null===(t=n.pageSignals[s.block.blockModel.id])||void 0===t?void 0:t.pageAuthorityV1:void 0}},function(e){let{result:t}=e;return{name:"TITLE_LENGTH",value:t.block.text.length}},function(e){let{result:{terms:t},featureExtractor:{queryLower:s}}=e;return{name:"TERMS_COUNT_NORMALIZED",value:t.length/(0,v.pv)(s).length}},function(e){let{result:{terms:t},featureExtractor:{queryLower:s}}=e;const n=(0,v.pv)(s),r=new Set(t);return{name:"FULL_MATCH_TERM_COUNT_NORMALIZED",value:n.filter((e=>r.has(e))).length/n.length}},function(e){let{result:{terms:t,block:{text:s}}}=e;const n=(0,v.pv)(s.toLowerCase());return{name:"MATCHING_PERCENTAGE_OF_TITLE",value:t.length/n.length}}]},S=1.25,y=[x];function b(e){const{results:t,featureGroups:s}=e;return t.map(((e,t)=>{const{block:n,score:r,personalizationBoost:o,rendered:a,terms:l}=e;return{sources:[i.vp.Local],id:n.blockModel.id,spaceId:n.blockModel.space_id,score:r,localSource:n.source,personalizationBoost:o,terms:l,highlight:{text:a},featureGroups:s[t]}}))}function C(e,t,s){const n=e=>s.matches(e.block),i=(0,r.wS)(t);if(1===i.length)return e.search(t,{filter:n,prefix:!0,fields:["text","inits"]});const o=e.search(t,{filter:n,combineWith:"AND",fields:["text"]});if(o.length>0)return o;const a=i.filter((e=>e.length>=v.Qu)),l=(d=a.length,Math.round(.6*d+.5));var d;return e.search(t,{filter:e=>e.queryTerms.length>=l&&n(e)})}function M(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function j(e){const{block:t,score:s,terms:n}=e,{source:r,text:o}=t,a=n.map(M).join("|"),l=new RegExp(a,"ig");var d;return{block:t,rendered:n.length>0?o.replaceAll(l,`${i.Um}$&${i.dK}`):o,score:s,personalizationBoost:(d=r).has("recentVisit")||d.has("frecencyStore")||d.has("bookmarkedPage")||d.has("defaultRecordCache")?S:1,terms:n}}function I(e,t,s){const{blocks:n,getAllBlocks:r}=e,i=s.text.trim(),o=(0,a.nv)(i),l=o.length>0?o.join(" "):i,c=new d.uL(t);return l.length>0?function(e){const{blocksIndex:t,queryString:s,filterMatcher:n}=e;return C(t,s,n).map((e=>{const t=(0,v.RA)(s,e.block.text);return{...e,score:e.score*t}})).map(j)}({blocksIndex:n,queryString:l,filterMatcher:c}):r().filter((e=>c.matches(e.block))).map(j)}const k=(0,o.Ds)(((e,t,s)=>{y.forEach(((n,r)=>{const i=s.map(((e,s)=>({features:e[r].features,id:t[s].block.blockModel.id})));(0,l.j)(e,"search_local_result_features",{search_session_id:g.default.state.sessionId,group_name:n.name,results_features:i})}))}),1e3,{leading:!1,trailing:!0});function w(e){let{query:t,localCachedPages:s,userId:n,includeRecordMap:r,environment:i,canUseLtr:a}=e;const{query:c,limit:u}=t,{filters:p,sort:g}=c,v=I(s,p,c);if(0===v.length)return;const x=function(e,t){const{field:s}=e,n="relevance"===s||"desc"===e.direction?-1:1;switch(s){case"lastEdited":case"scroll":return(0,o.MR)(t,(e=>{let{block:{blockModel:t}}=e;return n*(t.last_edited_time||0)}));case"created":return(0,o.MR)(t,(e=>{let{block:{blockModel:t}}=e;return n*(t.created_time||0)}));default:return(0,o.MR)(t,(e=>{let{score:t}=e;return n*t}))}}(g,v),S=t.query.text.length>1&&a,C=S?function(e,t,s,n){const r=new h(t,e,s);return n.map((e=>r.extractFeatureGroup(e)))}(i,y,t.query.text,x):x.map((e=>[]));(0,l.j)(i,"search_local_recall_results",{num_visible_members:(0,f.qX)(),results:x.map(P)}),S&&k(i,x,C);const M=("relevance"===g.field?(0,d.YB)({sort:g,currentUserId:n,unsorted:b({results:x,featureGroups:C}),batchSize:m.Xv}):b({results:x,featureGroups:C})).slice(0,u),j=r??!0;return{total:v.length,results:M,recordMap:j?s.recordMap.toJson({allowVersionDowngrade:!1}):{},trackEventProperties:void 0}}function T(e){let{query:t,localCachedPages:s,parentStore:r,isOnline:o,environment:a,shouldLimitLocalResultsWhenOnline:l,maxLocalResultsOverride:c,canUseLtr:u}=e;const h=w({query:t,localCachedPages:s,userId:a.currentUser.id,environment:a,canUseLtr:u});if(!h)return;if(0===h.results.length)return{error:i.Ix.NoResults};let g=h.results.map(((e,t)=>({...e,originalPosition:t,store:p.G.createChildStore(r,{table:n.iU,id:e.id}),serverEventProperties:void 0})));const m=g.length;return o&&l&&(g=(0,d.g8)(a,g,c)),0===g.length?{error:i.Ix.NoResults}:{value:{total:m,results:g,debugInfo:void 0}}}function P(e){const{block:{source:t,blockModel:{id:s}}}=e;return{id:s,localSource:[...t]}}},63334:(e,t,s)=>{s.d(t,{Z:()=>i});var n=s(49085);class r extends n.default{getInitialState(){return{}}}const i=r},25904:(e,t,s)=>{s.d(t,{Z:()=>i});var n=s(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},30857:(e,t,s)=>{s.r(t),s.d(t,{default:()=>i});var n=s(49085);class r extends n.default{getInitialState(){return{selectedQueryResult:!1,numKeystrokes:0,numServerRequests:0,numLocalRequests:0,hadMetaClick:!1,firstKeyStrokeTimeMs:void 0}}}const i=new r},54983:(e,t,s)=>{s.d(t,{Z:()=>i});var n=s(49085);class r extends n.default{getInitialState(){return{}}}const i=r},22109:(e,t,s)=>{s.d(t,{T:()=>i});s(67294);var n=s(45238),r=s(85893);const i=(0,n.IU)("arrowsUpDown",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M4.11 2.385a.61.61 0 01.48-.211c.191 0 .353.07.486.21L8.03 5.409a.66.66 0 01.2.475c0 .191-.061.347-.182.469a.627.627 0 01-.463.181.59.59 0 01-.451-.187L5.926 5.098l-.72-.844.04 1.219v7.242a.624.624 0 01-.187.469.624.624 0 01-.47.187.636.636 0 01-.468-.187.635.635 0 01-.182-.47V5.474l.041-1.22-.726.845-1.201 1.248a.61.61 0 01-.457.187.627.627 0 01-.463-.181.634.634 0 01-.182-.47.66.66 0 01.2-.474l2.958-3.023zm7.786 10.781a.636.636 0 01-.486.205.665.665 0 01-.486-.205l-2.947-3.035a.64.64 0 01-.206-.475c0-.191.061-.345.182-.463a.634.634 0 01.469-.181c.18 0 .33.06.451.181l1.201 1.248.727.85-.041-1.219V2.824c0-.187.06-.342.181-.463a.636.636 0 01.47-.187.627.627 0 01.65.65v7.248l-.041 1.219.726-.85 1.207-1.248a.6.6 0 01.451-.181c.188 0 .342.06.463.181a.615.615 0 01.182.463.648.648 0 01-.2.475l-2.953 3.035z"})})},67220:(e,t,s)=>{s.d(t,{S:()=>i});s(67294);var n=s(45238),r=s(85893);const i=(0,n.IU)("bot",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M7.996 16C12.381 16 16 12.38 16 8s-3.627-8-8.012-8C3.611 0 0 3.62 0 8s3.62 8 7.996 8zm0-1.594A6.375 6.375 0 011.61 8a6.366 6.366 0 016.38-6.398A6.393 6.393 0 0114.398 8a6.383 6.383 0 01-6.403 6.406zM4.648 8.518c0 .21.17.364.386.364h2.53l-1.346 3.605c-.202.527.355.813.703.395l4.168-5.176a.515.515 0 00.132-.325c0-.209-.17-.356-.379-.356H8.305l1.346-3.613c.201-.518-.356-.812-.704-.395l-4.16 5.184a.484.484 0 00-.14.317z"})})},6637:(e,t,s)=>{s.d(t,{I:()=>i});s(67294);var n=s(45238),r=s(85893);const i=(0,n.IU)("filterCircled",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 13.7383C4.85547 13.7383 2.33301 11.209 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.667 4.91992 13.6738 8.06445C13.6738 11.209 11.1445 13.7383 8 13.7383ZM4.41797 6.75879H11.5889C11.9307 6.75879 12.1699 6.54688 12.1699 6.22559C12.1699 5.9043 11.9307 5.68555 11.5889 5.68555H4.41797C4.07617 5.68555 3.84375 5.9043 3.84375 6.22559C3.84375 6.54688 4.07617 6.75879 4.41797 6.75879ZM5.36816 9.02148H10.6455C10.9805 9.02148 11.2197 8.80273 11.2197 8.48145C11.2197 8.16016 10.9805 7.94141 10.6455 7.94141H5.36816C5.02637 7.94141 4.78711 8.16016 4.78711 8.48145C4.78711 8.80273 5.02637 9.02148 5.36816 9.02148ZM6.35254 11.2773H9.6543C9.99609 11.2773 10.2354 11.0654 10.2354 10.7441C10.2354 10.4229 9.99609 10.2041 9.6543 10.2041H6.35254C6.01074 10.2041 5.77148 10.4229 5.77148 10.7441C5.77148 11.0654 6.01074 11.2773 6.35254 11.2773Z"})})},90028:(e,t,s)=>{s.d(t,{j:()=>i});s(67294);var n=s(45238),r=s(85893);const i=(0,n.IU)("searchInPage",{viewBox:"0 0 12 14",svg:(0,r.jsx)("path",{d:"M2.877 13.365h6.24c.63 0 1.104-.164 1.424-.492.32-.324.48-.8.48-1.43V6.13c0-.274-.015-.504-.046-.691a1.531 1.531 0 00-.182-.522 2.185 2.185 0 00-.387-.498l-3.07-3.123a2.11 2.11 0 00-.48-.38 1.528 1.528 0 00-.51-.183A3.464 3.464 0 005.7.68H2.877c-.629 0-1.104.164-1.424.492-.32.324-.48.8-.48 1.43v8.841c0 .633.16 1.112.48 1.436.32.324.795.486 1.424.486zm.094-1.154c-.282 0-.492-.072-.633-.217-.14-.144-.211-.351-.211-.621V2.678c0-.27.07-.479.21-.627.142-.149.354-.223.64-.223h2.496V5.04c0 .418.101.73.304.938.207.207.52.31.938.31h3.158v5.086c0 .27-.07.477-.21.621-.142.145-.354.217-.64.217H2.971zm3.855-6.938c-.12 0-.209-.027-.263-.082-.051-.054-.077-.142-.077-.263V1.986l3.229 3.287H6.826z"})})},45366:(e,t,s)=>{s.d(t,{wS:()=>i});var n=s(53965);const r=/[-./\\()"'’‘”“，。、·～；,;<>~!@#$%^&*|+=[\]{}`~?:\s]/u;function i(e){return(0,n.oA)(e.split(r))}}}]);