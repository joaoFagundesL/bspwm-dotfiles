"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[5645],{43328:(e,t,o)=>{o.r(t),o.d(t,{AutomationModal:()=>k});var n=o(67294),r=o(480),i=o(86628),a=o(24405),c=o(2647),l=o(9291),s=o(37810),u=o(68657),d=o(63474),p=o(58454),m=o(6258),f=o(1743),h=o(50506),g=o(89728),x=o(58297),C=o(31278),b=o(65187),y=o(85893);const v=(0,l.defineMessages)({confirmationDialogAriaLabel:{defaultMessage:"Confirmation",id:"automations.ConfirmationDialog.ariaLabel"}});function k(){const e=(0,i.VK)((()=>p.Z.state),[]),t=(0,r.Fy)(),o=(0,i.VK)((()=>t.isPhone),[t]),l=(0,a.yK)((e=>({innerStyle:{padding:24,width:o?"calc(100% - 20px)":320}})),[o]),s=(0,d.D)(),u=(0,n.useCallback)((e=>{p.Z.setState({open:!1,result:e});const t=p.Z.state;(0,c.W5)(s,{automation_id:t.open&&t.recordStore instanceof m.Mz?t.recordStore.id:void 0,option:e})}),[s]),f=(0,n.useCallback)((()=>u("cancel")),[u]),g=function(){const e=(0,i.VK)((()=>p.Z.state),[]),[t,o]=(0,n.useReducer)(((e,t)=>e+1),1),r=(0,n.useRef)(void 0);return(0,n.useEffect)((()=>{e.open&&e.format!==r.current&&(o(void 0),r.current=e.format)}),[e,r]),t}();return(0,y.jsx)(h.Z,{open:e.open,keepFocus:!0,innerStyle:l.innerStyle,disableAnimation:!0,onDismiss:f,render:()=>e.open&&(0,y.jsx)(S,{id:`${g}`,modalState:e,onDismiss:u},`${g}`)})}function S(e){const{id:t,modalState:o,onDismiss:r}=e,{icon:i}=o.format,c=(0,l.useIntl)(),d=(0,n.useRef)(null);(0,n.useEffect)((()=>{null!==d.current&&d.current.focus()}),[]);const p=(0,a.yK)((e=>({wrap:{display:"flex",flexDirection:"column"},buttonWrap:{display:"flex",flexDirection:"column",gap:10,marginTop:10},textWrap:{whiteSpace:"pre-wrap",wordBreak:"break-word",textAlign:"center",fontWeight:s.Z.fontWeight.medium,marginTop:10,marginBottom:10,display:"flex",flexDirection:"column",alignItems:"center"},icon:{marginBottom:10},cancelButton:{justifyContent:"center"}})),[]),{store:m}=(0,u.Cl)({initialValue:o.format.text,onChange:()=>{}}),h=[(0,y.jsx)(x.Z,{isLarge:!0,onClick:()=>r("continue"),ref:d,children:o.format.continueButtonText},"continue"),(0,y.jsx)(g.Z,{isLarge:!0,onClick:()=>r("cancel"),isLightGray:!0,style:p.cancelButton,children:o.format.cancelButtonText},"cancel")],k=`automation-modal-dialog-${t}`;return(0,y.jsx)(f.Z,{debugName:"AutomationModal",capture:!0,allowEsc:!0,children:(0,y.jsxs)("div",{"aria-modal":"true","aria-label":c.formatMessage(v.confirmationDialogAriaLabel),"aria-describedby":k,role:"dialog",style:p.wrap,children:[(0,y.jsxs)("div",{style:p.textWrap,children:[i&&(0,y.jsx)("div",{style:p.icon,children:(0,y.jsx)(C.Z,{size:50,icon:{icon:i,pointer:o.recordStore.pointer},disabled:!0,isEmptyPage:!1,bucket:"public",onChange:()=>{}})}),(0,y.jsx)("div",{id:k,children:(0,y.jsx)(b.Z,{disabled:!0,store:m,parentStore:o.recordStore,inPageFind:{type:"none"}})})]}),(0,y.jsx)("div",{style:p.buttonWrap,children:h})]})})}},68657:(e,t,o)=>{o.d(t,{Cl:()=>p,NY:()=>m});var n=o(67294),r=o(480),i=o(86628),a=o(21202),c=(o(70203),o(53965)),l=o(7032),s=o(84398),u=o(77080),d=o(6258);function p(e){const{initialValue:t,onChange:o,source:u="title",parentCollection:p}=e,m=(0,r.O7)(),f=(0,s.$)("formulaPrototypeHelpers.useMockTextStore",{isMockTextStore:!0,overrideDefaultRecordCache:!0}),h=function(e){const{initialValue:t,inMemoryRecordCache:o,source:i,parentCollection:c}=e,s=(0,r.O7)(),u=(0,n.useMemo)((()=>t),[]);return(0,n.useMemo)((()=>{const e={id:(0,l.ZP)(),table:a.iU};o.setRecord({pointer:e,userId:s.currentUser.id},{value:{alive:!0,id:e.id,parent_id:(null==c?void 0:c.id)??l._6,parent_table:"block",properties:{[i]:u},space_id:(null==c?void 0:c.getSpaceId())??l._6,type:"page",version:0},role:"editor"});const t=new d.ST({environment:s,inMemoryRecordCache:o,path:["properties",i],pointer:e,userId:s.currentUser.id});return o.emitRecord(e,[]),t}),[s,o,u,c,i])}({initialValue:t,inMemoryRecordCache:f,source:u,parentCollection:p}),g=(0,n.useRef)(t),x=(0,n.useCallback)((e=>{const t=m.currentUser.id,o=h.getRecordStoreAtRootPath();if(o instanceof d.G){const n=o.getValue();n&&(f.setRecord({pointer:h.pointer,userId:t},{role:"editor",value:{...n,properties:{...null==n?void 0:n.properties,[u]:e}}}),f.emitRecord(h.pointer,[]))}}),[m.currentUser.id,h,f,u]);return(0,i.VK)((()=>{const e=h.getValue();c.Xy(g.current,e)||(g.current=e,null==o||o(e))}),[h,o]),{store:h,setValue:x}}function m(){return u.default.checkGate("formula_buttons")}},84398:(e,t,o)=>{o.d(t,{$:()=>a});var n=o(67294),r=o(26263),i=o(480);function a(e,t){const{cacheFallback:o,isMockTextStore:a,isTemporaryData:c,overrideDefaultRecordCache:l}=t??{},s=(0,i.O7)(),{inMemoryRecordCache:u}=s.defaultRecordCache,d=(0,n.useMemo)((()=>{const t=new r.Z({isTemporaryData:Boolean(c),name:e});return t.isMockTextStore=Boolean(a),o&&t.addCacheFallback(o),l&&u.addCacheOverride(t),t}),[o,u,a,c,e,l]);return(0,n.useEffect)((()=>function(){o&&d.removeCacheFallback(o),l&&u.removeCacheOverride(d)}),[o,u,d,l]),d}},58454:(e,t,o)=>{o.d(t,{Z:()=>c});var n=o(49085),r=o(92595);class i extends n.default{getInitialState(){return{open:!1}}}const a=new i;(0,r.exposeDebugValue)("AutomationModalStore",a);const c=a}}]);