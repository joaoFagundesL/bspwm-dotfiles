"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[8586],{63923:(e,t,s)=>{s.d(t,{Op:()=>O,Oq:()=>E,hS:()=>L});s(57658),s(67294);var n=s(41432),i=s(88437),o=s(66466),a=s(79310),r=s(37612),l=s(45238),d=s(85893);const c=(0,l.IU)("unstar",{viewBox:"0 0 16 16",svg:(0,d.jsx)("path",{d:"M11.6641 9.32227L15.1299 6.83398C15.5879 6.50586 15.7861 6.14355 15.6562 5.76074C15.5264 5.38477 15.1641 5.2002 14.5967 5.20703L10.1943 5.23438L8.85449 1.03711C8.68359 0.490234 8.40332 0.196289 8 0.196289C7.60352 0.196289 7.32324 0.490234 7.14551 1.03711L6.22949 3.9082L7.2002 4.87207L7.96582 2.28125C7.97266 2.24023 7.98633 2.2334 8 2.2334C8.02051 2.2334 8.02734 2.24023 8.04102 2.28125L9.13477 6.01367C9.2373 6.35547 9.42188 6.47168 9.77051 6.45801L13.6602 6.36914C13.7012 6.36914 13.7148 6.37598 13.7217 6.38965C13.7285 6.41016 13.7217 6.41699 13.6875 6.4375L10.7754 8.44043L11.6641 9.32227ZM13.9268 14.2783C14.1387 14.4902 14.4941 14.4902 14.6992 14.2783C14.9043 14.0664 14.9111 13.7246 14.6992 13.5127L3.44043 2.28809C3.22852 2.07617 2.87988 2.06934 2.66797 2.28809C2.46289 2.49316 2.46289 2.84863 2.66797 3.05371L13.9268 14.2783ZM3.2627 14.7637C3.58398 15.0098 3.98047 14.9277 4.44531 14.5928L8 11.9814L11.5547 14.5928C12.0195 14.9277 12.4092 14.9961 12.7441 14.7637C12.8193 14.709 12.8672 14.6406 12.9629 14.5107L8.3418 10.7236C8.10254 10.5254 7.84277 10.5391 7.60352 10.7305L4.52051 13.1094C4.49316 13.123 4.47266 13.1367 4.45898 13.1162C4.45215 13.1025 4.45215 13.0957 4.45898 13.0615L5.75781 9.39062C5.87402 9.05566 5.83301 8.84375 5.52539 8.63867L2.3125 6.4375C2.28516 6.42383 2.27148 6.41016 2.27832 6.38965C2.29199 6.37598 2.30566 6.36914 2.33984 6.36914L4.88281 6.42383L3.67969 5.2207L1.40332 5.20703C0.835938 5.2002 0.480469 5.38477 0.350586 5.76074C0.220703 6.14355 0.412109 6.50586 0.876953 6.83398L4.46582 9.41113L3.05762 13.5879C2.87305 14.1279 2.94141 14.5244 3.2627 14.7637Z"})});var u=s(9291),p=s(66324),m=s(3297),g=s(42858),h=s(13447),f=s(52275),x=s(31278),y=s(72495),S=s(19037),v=s(28020),b=s(48779),M=s(74948),j=s(80444),C=s(49386),w=s(82763),k=s(29768),T=s(62967),I=s(42784),Z=s(2295),P=s(12988),F=s(6471),A=s(5337);const _=(0,u.defineMessages)({unpinName:{id:"action.unpin.name",defaultMessage:"Remove from sidebar"},leaveName:{id:"action.leave.name",defaultMessage:"Leave"},removefromFavoritesName:{id:"action.removefromFavorites.name",defaultMessage:"Remove from Favorites"},duplicateToName:{id:"action.duplicateTo.name",defaultMessage:"Duplicate to"}}),R=(0,T.cN)({key:"remove pinned shared page",displayName:_.unpinName,analyticsName:_.unpinName.defaultMessage,svg:a.A,validators:[S.cWe,S.uqO],closeParentMenu:!0,action:e=>{let{blocks:t,environment:s}=e;const{currentSpaceViewStore:n,currentUserSettingsStore:i}=j.default.state;n&&i&&(h.createAndCommit({userAction:"actionRegistry.removePinnedSharedPage",environment:s,perform:e=>{for(const o of t)M.unpinSharedPage({environment:s,transaction:e,spaceViewStore:n,userSettingsStore:i,store:o})}}),p.An(s,{type:"shared",from:"sidebar_dropdown_menu"}))}}),O=(0,T.cN)({key:"delete block without shortcuts",displayName:T.RE.deleteName,analyticsName:T.RE.deleteName.defaultMessage,svg:r.y,validators:[S.or([S.DFt,S.STD]),S.eot,S.ffD(S.sRS),S.ffD(S.P99(n.Ti.externalObjectInstancePage)),S.vdd,S.ffD(S.uY7)],closeParentMenu:!0,action:async e=>{let{blocks:t,environment:s}=e;await g.Qw({environment:s,blocks:t,shouldCheckSuggestEdit:!1})}}),B=(0,T.cN)({key:"leave shared page",displayName:_.leaveName,analyticsName:_.leaveName.defaultMessage,svg:o.S,validators:[S.cWe,S.zl0,S.ffD(S.uqO)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:s}=e;h.createAndCommit({userAction:"actionRegistry.leaveSharedPage",environment:s,perform:e=>{M.leaveBlocks({environment:s,blocks:t,transaction:e})}})}});function D(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,T.cN)({key:"remove from favorites",displayName:_.removefromFavoritesName,analyticsName:_.removefromFavoritesName.defaultMessage,svg:c,validators:[...e,S.UI7,S.U7o,S.ffD(S.xDy([S.uqO,S.cWe]))],closeParentMenu:!0,action:e=>{let{blocks:t,environment:s}=e;const{currentSpaceViewStore:n}=j.default.state;n&&h.createAndCommit({userAction:"actionRegistry.removeFromFavorites",environment:s,perform:e=>{M.unbookmarkPage({spaceViewStore:n,store:t[0],transaction:e})}})}})}const L=D([S.tqC]),V=D(),N=(0,T.MV)({key:"duplicate to workspace",displayName:_.duplicateToName,analyticsName:_.duplicateToName.defaultMessage,svg:i.a,validators:[S.DFt,S.nJQ,S.zzA,S.ffD(S.KEd),S.Jlb],subActions:e=>{let{blocks:t,environment:s}=e;const{currentUserRootStore:n}=j.default.state;if(!n)return[];const i=t[0],o=v.o(n),a=[];for(const r of o){const e=r.getSpaceStore();if(e){const t=(0,b.rn)(s,e),n=(0,b.Wd)(s,e);a.push({key:r.id,displayName:t||"",analyticsName:"Duplicate to workspace",searchName:t||"",closeParentMenu:!0,action:async()=>{await m.DK({environment:s,store:i,spaceStore:e,spaceViewStore:r,isPrivate:!0,context:"duplicate_to_another_space"})},render:(e,s)=>{let{environment:i}=s;return(0,d.jsx)(f.Z,{title:t,icon:(0,d.jsx)(x.Z,{icon:n,isEmptyPage:!1,title:t,size:i.device.isMobile?24:20,disabled:!0}),...e})}})}}return[(0,T.$J)({key:"duplicate-to",render:e=>(0,d.jsx)(y.Z,{...e}),actions:a})]}}),E=[I.ww,{key:"outliner organization actions",render:e=>(0,d.jsx)(y.Z,{...e}),actions:[C._p,V,R,B]},{key:"outliner primary actions",render:e=>(0,d.jsx)(y.Z,{...e}),actions:[w.H,w.K,C.Dw,C.IK,k.o1,k.vh,k.fI,k.MI,N,F.$,Z.A,O]},{key:"turn page into",render:e=>(0,d.jsx)(y.Z,{...e}),actions:[A.NO,A.LM,A.BW]},{key:"outliner navigation",render:e=>(0,d.jsx)(y.Z,{...e}),actions:P.ej}]},5337:(e,t,s)=>{s.d(t,{NO:()=>A,LM:()=>P,BW:()=>R,bV:()=>B,R$:()=>D});s(67294);var n=s(62208),i=s(73039),o=s(55863),a=s(70203),r=s(9291),l=s(37810),d=s(47307),c=s(13447),u=s(12304),p=s(72495),m=s(24405),g=s(98742),h=s(93405),f=s(74420),x=s(26388),y=s(85893);function S(e){let{menuListItemProps:t,title:s,caption:n,icon:i,disabled:o,tooltipText:a,showNewBadge:r}=e;const l=(0,m.yK)((()=>({menuItem:{WebkitBackfaceVisibility:"hidden"},caption:{whiteSpace:"pre-wrap"}})),[]);return(0,y.jsx)(x.ZP,{placement:x.ug.Bottom,disableTooltip:!a,renderTooltip:()=>a,render:e=>(0,y.jsx)(h.Z,{...(0,g.Z)(t,e),style:l.menuItem,title:s,caption:n,captionStyle:n?l.caption:void 0,svg:i,disabled:o,disabledFeedback:o,right:r&&(0,y.jsx)(f.Z,{})})})}var v=s(19037),b=s(95697),M=s(77080),j=s(21884),C=s(35057),w=s(73466),k=s(62967),T=s(11732);const I=(0,r.defineMessages)({createTeamFromPageFullName:{id:"action.createTeamFromPage.fullName",defaultMessage:"Turn into teamspace"},createTeamFromPageCaption:{id:"action.createTeamFromPage.caption",defaultMessage:"Space for your team to customize permissions and collaborate"},createTeamFromPageName:{id:"action.createTeamFromPage.name",defaultMessage:"Teamspace"},turnPageIntoWikiCaption:{id:"action.turnPageIntoWiki.caption",defaultMessage:"Organize by owner, tags, verification, and more"},turnPageIntoWikiName:{id:"action.turnPageIntoWiki.name",defaultMessage:"Wiki"},undoTurnPageIntoWikiName:{id:"action.undoTurnPageIntoWiki.name",defaultMessage:"Undo wiki"},turnPageIntoWikiFullName:{id:"action.turnPageIntoWiki.fullName",defaultMessage:"Turn into wiki"}});function Z(e,t){return(0,k.cN)({key:"turn page into team",displayName:t,analyticsName:I.createTeamFromPageFullName.defaultMessage,svg:n.z,validators:e,closeParentMenu:!0,render:(e,s)=>{const n=function(e){const{block:t,environment:s}=e;if(!s.currentUser.id)return;if(0===a.QaF(t.getTitleValue()).length)return(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Cannot turn page without a title into a Teamspace",id:"sidebar.turnPageIntoTeamButton.missingTitleDisabledTooltip"});if("private"===(0,b.Pr)(t).accessLevel&&!(0,C.Rs)())return(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Only Business Plans and above can turn a private page into a Teamspace",id:"sidebar.turnPageIntoTeamButton.privateTeamsOnlyOnBusinessPlansAndAboveDisabledTooltip"})}({environment:s.environment,block:s.blocks[0]});return(0,y.jsx)(S,{menuListItemProps:e,title:(0,y.jsx)(r.FormattedMessage,{...t}),caption:(0,y.jsx)(r.FormattedMessage,{...I.createTeamFromPageCaption}),disabled:Boolean(n),tooltipText:n,icon:i.K})},action:e=>{let{blocks:t,environment:s}=e;const n=t[0];w.VG({environment:s,page:n})}})}const P=Z([v.xDy([v.jp9,v.ffD(v.KSG)])],I.createTeamFromPageFullName),F=Z([v.jp9],I.createTeamFromPageName),A=(0,k.MV)({key:"turn into teamspace or wiki",displayName:T.s.turnIntoSection,analyticsName:T.s.turnIntoSection.defaultMessage,svg:n.z,validators:[v.jp9,v.KSG],subActions:()=>[(0,k.$J)({key:"turn into teamspace or wiki",render:e=>(0,y.jsx)(p.Z,{...e}),actions:[F,O]})],width:300});function _(e,t){return(0,k.cN)({key:"turn page into wiki",displayName:t,analyticsName:I.turnPageIntoWikiFullName.defaultMessage,svg:n.z,validators:e,closeParentMenu:!0,action:e=>{let{environment:t,blocks:s}=e;"bottom_right"===M.default.getEligibleGroup({experimentId:"wiki_education_convert_modal",defaultGroup:"control"})?j.E.setState({showConvertTooltip:!1,forceShow:!0,pendingWikiBlockStore:s[0]}):c.createAndCommit({userAction:"actionRegistry.turnIntoAction.wiki",environment:t,perform:e=>{u.Y({environment:t,blocks:s,transaction:e,source:"page_menu"})}})},render:e=>(0,y.jsx)(S,{menuListItemProps:e,title:(0,y.jsx)(r.FormattedMessage,{...t}),disabled:!1,icon:n.z,tooltipText:(0,y.jsx)(r.FormattedMessage,{...I.turnPageIntoWikiCaption})})})}const R=_([v.xDy([v.KSG,v.ffD(v.jp9)]),v.ffD(v.uY7)],I.turnPageIntoWikiFullName),O=_([v.KSG],I.turnPageIntoWikiName);const B=_([v.KSG,v.ffD(v.uY7)],I.turnPageIntoWikiFullName),D=(0,k.cN)({key:"undo turn page into wiki",displayName:I.undoTurnPageIntoWikiName,analyticsName:I.undoTurnPageIntoWikiName.defaultMessage,svg:o.s,validators:[v.U7o,v.U_8,v.ffD(v.p1d),v.f7f,v.zzA,v.ffD(v.uY7)],closeParentMenu:!0,action:async e=>{let{environment:t,blocks:s}=e;await d.confirmUserAction({message:(0,y.jsx)("div",{style:{textAlign:"center"},children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Are you sure you want to turn <bold>{pageName}</bold> back into a normal page?",id:"action.undoTurnIntoWiki.message",values:{pageName:a.QaF(s[0].getTitleValue()),bold:e=>(0,y.jsx)("span",{style:{fontWeight:l.Z.fontWeight.semibold},children:e})}})}),description:(0,y.jsx)("div",{style:{textAlign:"center"},children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"This will remove properties like owners and verification from your pages",id:"action.undoTurnIntoWiki.description"})})})&&c.createAndCommit({userAction:"actionRegistry.undoTurnIntoAction.wiki",environment:t,perform:e=>{u.Cq({environment:t,blocks:s,transaction:e,source:"page_menu"})}})}})},83265:(e,t,s)=>{s.d(t,{Ce:()=>a,IC:()=>c,Jv:()=>p,QF:()=>u,Yc:()=>i,az:()=>r,eO:()=>d,s4:()=>l,ti:()=>o});var n=s(97978);function i(e,t){n.j(e,"workspace_creation_ability",t)}function o(e,t){n.j(e,"workspace_creation_setting_updated",t)}function a(e,t){n.j(e,"claimable_spaces_viewed",t)}function r(e,t){n.j(e,"space_transfer_requested",t)}function l(e,t){n.j(e,"space_transfer_completed",t)}function d(e,t){n.j(e,"space_claim_upgrade_requested",t)}function c(e,t){n.j(e,"space_claim_upgrade_completed",t)}function u(e,t){n.j(e,"space_claim_deletion_started",t)}function p(e,t){n.j(e,"space_claim_deletion_canceled",t)}},41311:(e,t,s)=>{s.d(t,{B3:()=>P,T_:()=>Z,XP:()=>k,bA:()=>I,h7:()=>F,w1:()=>w,y2:()=>T});s(57658);var n=s(92996),i=s(68626),o=s(99405),a=s(23867),r=s(9291),l=s(7032),d=s(18265),c=s(40663),u=s(95477),p=s(91924),m=s(77907),g=s(80444),h=s(22756),f=s(67940),x=s(57549),y=s(54642),S=s(47307),v=s(47839),b=s(601),M=s(15356),j=s(13447);const C=(0,r.defineMessages)({authenticatingWithAsana:{id:"asanaActions.authenticatingWithAsana.loadingMessage",defaultMessage:"Authenticating with Asana…"},titleMessage:{id:"asanaActions.loginWithAsanaPopupModal.title",defaultMessage:"Asana login"}});async function w(e){const{environment:t,flowId:s}=e;await y.disconnectAsana(t,{});const n=(0,p.eC)(t);let i=(0,o.s1)(u.default.domainBaseUrl,{authType:n,userId:t.currentUser.id});if(i=n.redirectToAuth?i:await(0,p.HU)(t,i),t.device.isElectron)return h.Z.setState({...h.Z.state,isAccountLinkingInProgress:!0}),void v.openExternalUrl(i);const a=await M.M(t,{width:580,height:800,url:i,titleMessage:C.titleMessage});if(!a)return;const r=d.Qc(a);if(!r.query.code||!r.query.state)return;h.Z.setState({...h.Z.state,isAccountLinkingInProgress:!0});const l=await y.authWithAsana(t,{code:r.query.code,encryptedState:r.query.state}),c=await y.getAsanaWorkspacesNames(t,{});if("failed"===l.type)x.a1(t,{import_source:"asana",data:{import_type:"api",status:"failure",error:l.error},flowId:s}),console.error(l.error),S.showError(l);else if(x.a1(t,{import_source:"asana",data:{import_type:"api",status:"success"},flowId:s}),"success"===c.type){const{data:{account:e,workspaces:t}}=c;h.Z.setState({...h.Z.state,isAccountLinkingInProgress:!1,account:e,workspaces:t,currentTab:"selectData",isModalOpen:!0})}}async function k(e){const{environment:t}=e;h.Z.setState({...h.Z.state,isAccountDelinkingInProgress:!0});const s=await y.disconnectAsana(t,{});"failed"===s.type?(console.error(s.error),S.showError(s)):(x.qJ(t,{integration_name:"asana"}),"success"===s.type&&h.Z.setState({...h.Z.state,isAccountDelinkingInProgress:!1,account:void 0,workspaces:[]}))}async function T(e){const{selectedWorkspace:t,environment:s}=e;h.Z.setState({...h.Z.state,isLoadingProjects:!0});const n=await y.getTeamsAndProjectsInAsanaWorkspace(s,{workspaceId:t,size:5});"success"===n.type&&h.Z.setState({...h.Z.state,teamsAndProjects:n.data,isLoadingProjects:!1})}async function I(e){let{environment:t}=e;h.Z.setState({...h.Z.state,isLoadingAsanaWorkspaces:!0});const s=await y.getAsanaWorkspacesNames(t,{});"success"===s.type&&h.Z.setState({...h.Z.state,account:s.data.account,workspaces:s.data.workspaces,isLoadingAsanaWorkspaces:!1})}async function Z(e){let{environment:t,spaceStore:s,currentSpaceViewStore:o,teamsStores:r,flowId:d}=e;const{appTemplatesSetupActions:u,appConfigs:p}=await m.deps.AppTemplates.loader(),S=h.Z.state.selectedWorkspace;if(!S)return;h.Z.setState({...h.Z.state,templateCreationInProgress:!0});const v={},M={};try{for(const e in h.Z.state.selectedProjectsAndTeamspaces){if(0===h.Z.state.selectedProjectsAndTeamspaces[e].projects.length)continue;let i;const a=h.Z.state.selectedProjectsAndTeamspaces[e],{notionTeamspaceId:l}=a;if(!l)continue;const d=r.find((e=>e.id===a.notionTeamspaceId));if(i=d||s,M[l])v[e]=M[l];else{const{serverCommitResult:s,performResult:a}=j.createAndCommit({environment:t,perform:e=>{const s={type:"preset",uri:n.T3};if("preset"===s.type&&!s.uri.startsWith("notion://wiki")){var a;const n=s.uri,r=null===(a=(0,c.iX)(p(),n))||void 0===a?void 0:a.uri;if(!r)return;const l=p().find((e=>e.uri===r));if(null==l?void 0:l.presets.find((e=>e.uri===n))){return u.initializeApp({environment:t,spaceViewStore:o,appParentStore:i,appUri:r,presetUri:n,transaction:e,from:"asana_import"})}return[]}},userAction:"importActions.importAsana"});v[e]=a,M[l]=a,await s}}}catch(_){return void h.Z.setState({...h.Z.state,templateCreationInProgress:!1,currentTab:"failure"})}const C=[],w=g.default.state.currentSpaceViewStore;if(!w)return;const k=b.Ym({environment:t,spaceStore:s,spaceViewStore:w,append:!0});await k.deferred.promise;const T=k.pageId;h.Z.setState({...h.Z.state,loggerPageId:T});const I=new Set,Z=[],P=[];for(const n in v){const e=h.Z.state.selectedProjectsAndTeamspaces[n],t=v[n];if(!(t&&e.notionTeamspaceId&&e.projects.length))continue;const i="string"==typeof e.projects?[]:e.projects;Z.push(...i),I.add(e.notionTeamspaceId),P.push(n),C.push({collectionViewBlocks:t.map((e=>({id:e.id,spaceId:(0,a.C)(s.id)}))),projectIds:i,asanaTeamId:n,notionTeamSpaceId:e.notionTeamspaceId,importAllProjects:"all"===e.projects,importOnlyIncompleteProjects:"in_complete"===e.projects})}const F=y.parallelAsanaImport(t,{importParams:C,spaceId:(0,a.C)(s.id),asanaWorkspaceId:S,importCompletedTasks:h.Z.state.importCompletedTasks,loggerPageId:T,flowId:d||(0,l.ZP)()});h.Z.setState({...h.Z.state,templateCreationInProgress:!1,currentTab:"importingData",choosingWorkspacesCompleted:!0}),f.Z.reset();const A=h.Z.state.workspaces.find((e=>e.gid===S));A&&function(e,t,s){try{x.qy(e,{import_source:"asana",data:t,flowId:s})}catch(n){i.log({level:"error",from:"asanaV2Actions",type:"parallelAsanaImport",error:{miscDataString:JSON.stringify({error:n,message:"Errored in tracking import_source_input event."})}})}}(t,{workspaceName:A.name,teams:P,projects:Z,numberOfTeamspacesUsed:I.size,completedTasks:h.Z.state.importCompletedTasks,userId:t.currentUser.id,spaceId:(0,a.C)(s.id)},d);for await(const n of F){if(!h.Z.state.isModalOpen)break;if(n.error)return void h.Z.setState({...h.Z.state,currentTab:"failure"});"success"===n.taskStatus&&h.Z.setState({...h.Z.state,currentTab:"confirm",result:n.value.status,isComplete:!0})}}function P(e){var t;let{teamId:s,spaceId:n}=e;h.Z.setState({...h.Z.state,selectedProjectsAndTeamspaces:{...h.Z.state.selectedProjectsAndTeamspaces,[s]:{projects:(null===(t=h.Z.state.selectedProjectsAndTeamspaces[s])||void 0===t?void 0:t.projects)||[],notionTeamspaceId:n}}})}function F(){h.Z.setState({...h.Z.state,isModalOpen:!0})}},79257:(e,t,s)=>{s.d(t,{D2:()=>x,Do:()=>f,M0:()=>g,W4:()=>h,bA:()=>p,xv:()=>m});var n=s(1898),i=s(85680),o=s(98452),a=s(6258),r=s(52258),l=s(36610),d=s(6404),c=s(96802),u=s(13447);function p(e){const{originRect:t}=e;r.Z.reset(),o.Z.reset(),d.xv(),i.Z.setState({isOpen:!0,rect:t})}function m(){i.Z.setState({isOpen:!1})}function g(e){const{format:t,store:s,property:n,visibility:i,transaction:o}=e,a=t.property_visibility;a&&o&&c.FH({stores:[s],update:{property_visibility:Object.values(a||{}).map((e=>({property:e.property,visibility:n===e.property?i:e.visibility})))},transaction:o})}function h(e){const{store:t,pageSection:s,visibility:i,environment:o,format:r}=e,d=r.page_section_visibility;d&&(l.Mz(o,{section:s,visibility:i}),u.createAndCommit({userAction:"customizePageActions.updatePageSectionVisibility",environment:o,perform:e=>{c.FH({stores:t instanceof a.NW||t instanceof a.G?[t]:(0,n.t1)(t),update:{page_section_visibility:{...d,[s]:i}},transaction:e})}}))}function f(e){const{store:t,transaction:s,pageSectionFormats:i}=e;c.FH({stores:t instanceof a.NW||t instanceof a.G?[t]:(0,n.t1)(t),update:{collection_page_sections:i},transaction:s})}function x(e){const{store:t,properties:s,environment:i}=e;u.createAndCommit({userAction:"customizePageActions.updateCollectionPageProperties",environment:i,perform:e=>{c.FH({stores:t instanceof a.NW||t instanceof a.G?[t]:(0,n.t1)(t),update:{collection_page_properties:s},transaction:e})}})}},601:(e,t,s)=>{s.d(t,{Ym:()=>z,A1:()=>H,am:()=>G,ro:()=>U,xG:()=>K,su:()=>q,Pv:()=>E});s(57658),s(21703);var n=s(13991),i=s(41432),o=s(7057),a=s(68626),r=s(59730),l=s(34390),d=s(23512),c=s(21202),u=s(23867),p=s(9291),m=s(57347),g=s(53965),h=s(52629),f=s(37850),x=s(7032),y=s(72340),S=s(33954),v=s(8989),b=s(77080);const M=1073741824;var j=s(33929),C=s(36214),w=s(78900),k=s(90365),T=s(82066),I=s(88923),Z=s(6258),P=s(57549),F=s(54642),A=s(47307),_=s(94419),R=s(92625),O=s(9953),B=s(28014),D=s(13447),L=s(53471);const V=(0,p.defineMessages)({uploadingOneFile:{id:"importActions.uploadingOneFile.loadingMessage",defaultMessage:"Uploading… ({percentComplete}%)"},uploadingMultipleFilesNotStarted:{id:"importActions.uploadingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Uploaded 0 of {totalNumberOfFiles}"},uploadingMultipleFilesInProgress:{id:"importActions.uploadingMultipleFilesInProgress.loadingMessage",defaultMessage:"Uploaded {numberOfUploadedFiles} of {totalNumberOfFiles}"},uploadingMultipleFilesComplete:{id:"importActions.uploadingMultipleFilesComplete.loadingMessage",defaultMessage:"Uploaded {totalNumberOfFiles} of {totalNumberOfFiles}"},importingOneFile:{id:"importActions.importingOneFile.loadingMessage",defaultMessage:"Importing…"},importingMultipleFilesNotStarted:{id:"importActions.importingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Imported 0 of {totalNumberOfFiles}"},importingMultipleFilesInProgress:{id:"importActions.importingMultipleFilesInProgress.loadingMessage",defaultMessage:"Imported {numberOfImportedFiles} of {totalNumberOfFiles}"},importingMultipleFilesComplete:{id:"importActions.importingMultipleFilesComplete.loadingMessage",defaultMessage:"Imported {totalNumberOfFiles} of {totalNumberOfFiles}"},importingFromTrelloMessage:{id:"importActions.importingFromTrello.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} board from Trello} other {Importing {importingCount} boards from Trello}}"},importingFromAsanaMessage:{id:"importActions.importingFromAsana.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} project from Asana} other {Importing {importingCount} projects from Asana}}"},importingFromEvernoteMessage:{id:"importActions.importingFromEvernote.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} notebook from Evernote} other {Importing {importingCount} notebooks from Evernote}}"},importingFromConfluenceViaAPIMessage:{id:"importActions.importingFromConfluenceViaAPI.loadingMessage",defaultMessage:"Importing confluence space: {confluenceSpaceKey}."},importFailed:{id:"importActions.importFailedError.message",defaultMessage:"Import failed."},fileImportFailedSizeTooLarge:{id:"importActions.fileImportFailedError.sizeTooLarge.message",defaultMessage:"Import failed: file exceeds 5MB."},fileImportFailedCustomSizeTooLarge:{id:"importActions.fileImportFailedError.customSizeTooLarge.message",defaultMessage:"Import file cannot exceed {maxSize}."},trelloImportFailed:{id:"importActions.trelloImportFailedError.message",defaultMessage:"Trello import failed."},asanaImportFailed:{id:"importActions.asanaImportFailedError.message",defaultMessage:"Asana import failed."},evernoteImportFailed:{id:"importActions.evernoteImportFailedError.message",defaultMessage:"Evernote import failed."},confluenceImportViaAPIFailed:{id:"importActions.confluenceImportViaAPIFailedError.message",defaultMessage:"Confluence space import failed."},importTitle:{id:"importActions.importTitle",defaultMessage:"Import {date}"},importTitleForGenericFileImporter:{id:"importActions.importTitleForGenericFileImporter",defaultMessage:"{fileName} Import {date}"},onlyDocxExtensionSupported:{id:"importErrors.onlyDocxExtensionSupported.message",defaultMessage:"Import failed: file type not supported."}}),N=1073741824;async function E(e){const{uploadType:t,allowMultiple:s}=e;return U(e,await L.y({multiple:s??!0,accept:l.b[t].join(",")}))}async function U(e,t){const{environment:s,pageStore:n,spaceStore:i,isTeamPage:o,spaceViewStore:l,uploadType:u,flowId:p}=e;let g;try{if(0===t.length)return;const a=1===t.length;if("confluence"===u){const n=(Number((0,y.$6)(s))||15)*N;if(t[0].size>n)throw P.a1(e.environment,{import_source:"confluence",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:t[0].size},flowId:p}),new r.nY("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:d.td(n,1)}}})}else if("genericImporter"===u){const n=(0,v.bk)(s)||15,i=n*N;if(t[0].size>i)throw P.a1(e.environment,{import_source:"file",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:t[0].size},flowId:p}),new r.p8("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:`${n} GB}`}}})}else if("pdf"===u){const s=Number(b.default.getEligibleGroup({experimentId:"special_case_pdf_file_size",defaultGroup:M.toString()})),n=s;for(const i of t)if(i.size>n)throw P.a1(e.environment,{import_source:"file",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:i.size},flowId:p}),new r.p8("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:`${s} GB}`}}})}const m=await new Promise(((e,n)=>{L.IL({environment:s,uploadType:u,files:t,bucket:"temporary",preventLimitFreeFileSize:!0,flowId:p,onBatchStart:()=>{R.j({message:a?V.uploadingOneFile:V.uploadingMultipleFilesNotStarted,interpolatedValues:{totalNumberOfFiles:t.length,percentComplete:0}})},onBatchProgress:e=>{let{uploadedFiles:s,progressPercent:n}=e;R.j({message:a?V.uploadingOneFile:V.uploadingMultipleFilesInProgress,interpolatedValues:{numberOfUploadedFiles:s,totalNumberOfFiles:t.length,percentComplete:n}})},onBatchComplete:s=>{R.j({message:a?V.uploadingOneFile:V.uploadingMultipleFilesComplete,interpolatedValues:{totalNumberOfFiles:t.length,percentComplete:100}}),e(s)},onBatchError:n})})),h=await W(s,i,l,u,(null==t?void 0:t.length)??0,null==t?void 0:t[0].name,n,o);g=h.createdPage;const f=h.importType,S=h.pageId,j=m.map(((e,s)=>({fileURL:e,fileName:t[s].name})));let C=0;R.j({message:a?V.importingOneFile:V.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:C,totalNumberOfFiles:t.length}});for(const{fileURL:e,fileName:n}of j){if("confluence"===u){P.a1(s,{import_source:"confluence",data:{import_type:"file",status:"success",fileSize:t[0].size},flowId:p});const o=z({environment:s,spaceStore:i,spaceViewStore:l});await o.deferred.promise;const a=o.pageId,r=F.parallelImportConfluenceExport(s,{fileURL:e,fileName:n,page:{id:S,spaceId:i.id},loggerPageId:a,flowId:p||(0,x.ZP)()});for await(const e of r){if(e.error)throw e.error;e.value.isComplete||R.j(e.value.status)}}else if("AppendToBlock"===f){const t={fileURL:e,fileName:n,importType:f,block:{id:S,spaceId:i.id},flowId:p};P.qy(s,{import_source:"file",data:t,flowId:p});const{value:o}=await F.importFile(s,t).next();if(o.error)throw o.error}else if("ReplaceBlock"===f){const t={fileURL:e,fileName:n,importType:f,block:{id:S,spaceId:i.id},flowId:p};P.qy(s,{import_source:"file",data:t,flowId:p});const{value:o}=await F.importFile(s,t).next();if(o.error)throw o.error}C++,R.j({message:a?V.importingOneFile:V.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:C,totalNumberOfFiles:t.length}})}return R.x(),Z.G.createChildStore(i,{table:c.iU,id:S})}catch(C){var f;let e;a.log({level:"error",from:"importFiles",type:"importFilesFailure",error:(0,h.Ui)(C),data:{spaceId:i.id}}),R.x(),D.createAndCommit({userAction:"importActions.importFiles",environment:s,perform:e=>{g&&_.Od({parent:i.getPagesStore(),childToRemove:g,transaction:e})}});let t=null,n=null;if(C instanceof r.hm&&C.clientData?(t=C.clientData,S.Em[C.clientData.type]&&"ImportFileSizeTooLargeError"===(0,m.t)(C).message?n=S.Em[C.clientData.type]:S.$5[C.clientData.type]&&"CsvImportError"===(0,m.t)(C).message?n=S.$5[C.clientData.type]:S.zP[C.clientData.type]&&(n=S.zP[C.clientData.type])):C instanceof r.nY&&"upload_file_size_exceeded"===(null===(f=C.body)||void 0===f||null===(f=f.clientData)||void 0===f?void 0:f.type)&&S.zP[C.body.clientData.type]&&(t=C.body.clientData,n=S.zP[t.type]),t&&n){const s="messageValues"in t?t.messageValues:void 0;e=j.default.formatMessage(n,s)}else e="ImportFileSizeTooLargeError"===(0,m.t)(C).message?j.default.formatMessage(V.fileImportFailedSizeTooLarge):j.default.formatMessage(V.importFailed);throw A.showErrorMessage(e),C}}async function W(e,t,s,i,a,r,l,d){var c;let u,p,m;if(I.default.isSidePeekOpen()&&null!==(c=I.default.peekTarget.state)&&void 0!==c&&c.isEmptyPage())p=I.default.peekTarget.state.id,m="ReplaceBlock";else if(l&&l.isEmptyPage())a>1||l.isInsideCollection()?(p=l.id,m="AppendToBlock"):(p=l.id,m="ReplaceBlock");else{const l={date:(0,o.Yx)(Date.now(),"medium",n.SP)};"genericImporter"===i&&(l.fileName=r?r.replace(".zip",""):"Universal File");const{performResult:c}=D.createAndCommit({userAction:"importActions.result",environment:e,perform:n=>{const o=j.default.formatMessage("genericImporter"===i?V.importTitleForGenericFileImporter:V.importTitle,l),r=B.KE({environment:e,spaceStore:t,spaceViewStore:s,isPrivate:!d,prepend:!d,title:o,transaction:n}),c=a>1?"AppendToBlock":"ReplaceBlock",u=f.UZ();return n.postSubmitCallbacks.push((e=>{e?u.reject(e):u.resolve()})),{deferred:u,createdPage:r,pageId:r.id,importType:c}}});u=c.createdPage,p=c.pageId,m=c.importType,await c.deferred.promise}return{createdPage:u,pageId:p,importType:m}}async function K(e){const{environment:t,fileId:s,token:n,spaceStore:i,spaceViewStore:o,pageStore:a}=e;let l;try{R.j({message:V.importingOneFile});const e=await W(t,i,o,"gdocs",1,void 0,a,void 0);l=e.createdPage;const r=e.importType,d=e.pageId,{value:u}=await F.importGoogleDoc(t,{fileId:s,tokenId:n.id,importType:r,block:{id:d,spaceId:i.id}}).next();if(u.error)throw u.error;return R.x(),Z.G.createChildStore(i,{table:c.iU,id:d})}catch(d){D.createAndCommit({userAction:"importActions.importFiles",environment:t,perform:e=>{l&&_.Od({parent:i.getPagesStore(),childToRemove:l,transaction:e})}});let e=j.default.formatMessage(V.importFailed);throw d instanceof r.hm&&d.clientData&&("only_docx_extension_supported"===d.clientData.type?e=j.default.formatMessage(V.onlyDocxExtensionSupported):"file_size_exceeded"===d.clientData.type&&(e=j.default.formatMessage(V.fileImportFailedCustomSizeTooLarge,{maxSize:d.clientData.messageValues.maxSize}))),A.showErrorMessage(e),R.x(),new Error((0,m.t)(d).message)}}function z(e){const{environment:t,spaceStore:s,spaceViewStore:i,append:a}=e,{performResult:r}=D.createAndCommit({userAction:"importActions.result",environment:t,perform:e=>{const r=j.default.formatMessage(V.importTitle,{date:(0,o.Yx)(Date.now(),"medium",n.SP)}),l=B.KE({environment:t,spaceStore:s,spaceViewStore:i,isPrivate:!0,prepend:!a,title:`${r} Logs`,transaction:e}),d=f.UZ();return e.postSubmitCallbacks.push((e=>{e?d.reject(e):d.resolve()})),{deferred:d,pageId:l.id}}});return r}async function q(e){const{environment:t,boards:s,spaceStore:n,spaceViewStore:i}=e;R.j({message:V.importingFromTrelloMessage,interpolatedValues:{importingCount:s.length}}),T.Z.setState({open:!1});const{performResult:{deferred:o,pages:a}}=D.createAndCommit({userAction:"importActions.importTrello",environment:t,perform:e=>{const o=s.map((s=>B.KE({environment:t,spaceStore:n,spaceViewStore:i,isPrivate:!0,prepend:!0,loading:!0,title:s.name,transaction:e}))),a=f.UZ();return e.postSubmitCallbacks.push((e=>{e?a.reject(e):a.resolve()})),{deferred:a,pages:o}}});await o.promise;try{return await Promise.all(a.map((async(e,n)=>{const i=s[n],{value:o}=await F.importTrello(t,{boardId:i.id,block:{id:e.id,spaceId:(0,u.C)(e.pointer.spaceId)}}).next();if(o.error)throw o.error}))),R.x(),a[0]}catch(r){throw D.createAndCommit({userAction:"importActions.importTrello",environment:t,perform:e=>{for(const t of a)_.Od({parent:n.getPagesStore(),childToRemove:t,transaction:e})}}),A.showErrorMessage(j.default.formatMessage(V.trelloImportFailed)),R.x(),new Error((0,m.t)(r).message)}}async function G(e){const{environment:t,spaceStore:s,spaceViewStore:n,notebooks:o,userSettingsStore:a}=e;if(0===o.length)throw new Error("Expected at least one notebook");R.j({message:V.importingFromEvernoteMessage,interpolatedValues:{importingCount:o.length}}),k.Z.setState({open:!1});const r=await async function(e){const{environment:t,spaceStore:s,spaceViewStore:n,notebooks:o}=e,{serverCommitResult:a,performResult:{blockStores:r}}=D.createAndCommit({userAction:"importActions.createStacks",environment:t,perform:e=>{const a=g.jj(g.oA(o.map((e=>e.stack)))).sort().reverse(),r={};let l=e=>!0;return o.length>1&&a.length>0&&(a.forEach((a=>{const l=B.KE({environment:t,spaceStore:s,spaceViewStore:n,isPrivate:!0,prepend:!0,loading:!1,title:a,transaction:e}),d=l.getContentStore();o.filter((e=>e.stack===a)).forEach((s=>{const n=O.j4({environment:t,type:i.Ti.copyIndicator,inMemoryRecordCache:l.inMemoryRecordCache,transaction:e,spaceId:d.pointer.spaceId,useCrdt:l.useCrdt()});_.R3({parent:d,append:n,transaction:e}),r[s.guid]=n}))})),l=e=>!Boolean(e.stack)),o.filter(l).reverse().forEach((i=>{const o=B.KE({environment:t,spaceStore:s,spaceViewStore:n,isPrivate:!0,prepend:!0,loading:!0,title:i.title,transaction:e});r[i.guid]=o})),{blockStores:r}}});return await a,r}({environment:t,spaceStore:s,spaceViewStore:n,notebooks:o}),l=r[o[0].guid];try{return await async function(e){const{environment:t,spaceStore:s,spaceViewStore:n,notebooks:i,waitForNotebook:o,notebookMapping:a,userSettingsStore:r}=e;let l;if(f.jl(i,Y,(async e=>{await Promise.all(e.map((async e=>{const s=a[e.guid];if(!s)throw new Error(`Missing notebook page ${e.guid}`);const n=f.UZ();s===o&&(l=n),await async function(e){const{environment:t,notebookStore:s,notebook:n,firstCompleted:i}=e,o=F.importEvernote(t,{notebookId:n.guid,block:{id:s.id,spaceId:(0,u.C)(s.pointer.spaceId)},timestamp:Date.now(),parentTable:c.iU}),{value:a}=await o.next();a.error&&(console.error(a.error),D.createAndCommit({userAction:"importActions.importEvernoteNotebook",environment:t,perform:e=>{const t=s.getParentBlockStore();if(t){const n=t.getContentStore();_.Od({parent:n,childToRemove:s,transaction:e})}}}),A.showErrorMessage(j.default.formatMessage(V.evernoteImportFailed)));i.resolve(void 0)}({environment:t,notebookStore:s,notebook:e,firstCompleted:n})})))})),!l)throw new Error("waitForNotebookFirstCompleted not defined.");const d=r.getSettings();null!=d&&d.created_evernote_getting_started||await C.FI({environment:t,type:"evernote",spaceStore:s,spaceViewStore:n,userSettingsStore:r});await l.promise}({environment:t,waitForNotebook:l,notebookMapping:r,notebooks:o,spaceStore:s,spaceViewStore:n,userSettingsStore:a}),R.x(),l}catch(d){throw R.x(),A.showErrorMessage(j.default.formatMessage(V.evernoteImportFailed)),d}}async function H(e){const{environment:t,spaceStore:s,spaceViewStore:i,space:r,flowId:l}=e;if(!t.currentUser.id)throw new Error("User does not exist.");R.j({message:V.importingFromConfluenceViaAPIMessage,interpolatedValues:{confluenceSpaceKey:r.name}}),w.Z.setState({open:!1});const d=z({environment:t,spaceStore:s,spaceViewStore:i});await d.deferred.promise;const c=d.pageId;let u;if((0,y.SL)(t)){const e=await F.createTeam(t,{spaceId:s.id,name:r.name,accessLevel:"closed"});if("failed"===e.type)throw new Error("Cannot create teamspace");u=e.data.teamId}const{performResult:p}=D.createAndCommit({userAction:"importActions.importConfluenceViaApi",environment:t,perform:e=>{const a=j.default.formatMessage(V.importTitle,{date:(0,o.Yx)(Date.now(),"medium",n.SP)}),r=B.KE({environment:t,spaceStore:s,spaceViewStore:i,isPrivate:!0,prepend:!0,title:a,transaction:e}),l=f.UZ();return e.postSubmitCallbacks.push((e=>{e?l.reject(e):l.resolve()})),{deferred:l,createdPage:r,pageId:r.id}}});await p.deferred.promise;const g=p.createdPage;try{if(!g)throw new Error("No root page");const e=F.parallelImportConfluenceViaApi(t,{userId:t.currentUser.id,confluenceSpaceKey:r.key,confluenceSpaceId:r.id,page:{id:p.pageId,spaceId:s.id},loggerPageId:c,flowId:l,teamId:u});for await(const t of e){if(t.error)throw t.error;t.value.isComplete||R.j(t.value.status)}return R.x(),g}catch(x){throw a.log({level:"error",from:"importConfluenceViaAPI",type:"importConfluenceViaAPIFailure",error:(0,h.Ui)(x),data:{spaceId:s.id}}),D.createAndCommit({userAction:"importActions.importConfluenceViaApi",environment:t,perform:e=>{g&&_.Od({parent:s.getPagesStore(),childToRemove:g,transaction:e})}}),A.showErrorMessage(j.default.formatMessage(V.confluenceImportViaAPIFailed)),R.x(),new Error((0,m.t)(x).message)}}const Y=2},61397:(e,t,s)=>{s.d(t,{C8:()=>k,FM:()=>j,IO:()=>C,eL:()=>w,h7:()=>v,qF:()=>b,sC:()=>M});s(57658);var n=s(92996),i=s(68626),o=s(23867),a=s(9291),r=s(47307),l=s(40663),d=s(33929),c=s(77907),u=s(80444),p=s(67940),m=s(69122),g=s(57549),h=s(54642),f=s(601),x=s(92625),y=s(13447);const S=(0,a.defineMessages)({successfullyConnected:{id:"mondayActions.successfullyConnected.message",defaultMessage:"Successfully connected monday.com instance."}});function v(){m.Z.setState({...m.Z.state,isModalOpen:!0})}async function b(e){const{environment:t,userEmail:s,APIToken:n,flowId:i,spaceId:o}=e;if(!t.currentUser.id||!s||!n)return r.showMessage({message:"Invalid details"}),void x.x();const a=await h.authenticateMondayUser(t,{userId:t.currentUser.id,spaceId:o,userEmail:s,APIToken:n});"failed"===a.type?(g.a1(t,{import_source:"monday.com",data:{import_type:"api",status:"failure",error:a.error},flowId:i}),console.error(a.error),r.showError(a)):(g.a1(t,{import_source:"monday.com",data:{import_type:"api",status:"success"},flowId:i}),m.Z.setState({...m.Z.state,account:s}),r.showMessage({message:d.default.formatMessage(S.successfullyConnected)})),x.x()}async function M(e){const{environment:t,spaceId:s}=e,n=await h.disconnectMonday(t,{spaceId:s});"failed"===n.type?r.showError(n):(g.qJ(t,{integration_name:"monday.com"}),"success"===n.type&&m.Z.setState({...m.Z.state,account:void 0,workspaces:[]}))}async function j(e){const{environment:t,spaceId:s}=e;m.Z.setState({...m.Z.state,isLoadingMondayWorkspaces:!0});const n=await h.getMondayWorkspaces(t,{spaceId:s});"success"===n.type&&m.Z.setState({...m.Z.state,workspaces:n.data.workspaces,isLoadingMondayWorkspaces:!1})}async function C(e){const{environment:t,spaceId:s,selectedWorkspace:n}=e;if(!s)return;m.Z.setState({...m.Z.state,isLoadingProjects:!0});const i=await h.getMondayFoldersAndBoards(t,{spaceId:s,selectedWorkspace:n});"success"===i.type&&m.Z.setState({...m.Z.state,mondayFoldersAndBoards:i.data.mondayFoldersAndBoards,isLoadingProjects:!1})}function w(e){var t;let{folderId:s,spaceId:n}=e;m.Z.setState({...m.Z.state,selectedProjectsAndTeamspaces:{...m.Z.state.selectedProjectsAndTeamspaces,[s]:{projects:(null===(t=m.Z.state.selectedProjectsAndTeamspaces[s])||void 0===t?void 0:t.projects)||[],notionTeamspaceId:n}}})}async function k(e){const{environment:t,spaceStore:s,currentSpaceViewStore:a,teamsStores:r,flowId:d}=e,{appTemplatesSetupActions:x,appConfigs:S}=await c.deps.AppTemplates.loader(),v=m.Z.state.selectedWorkspace;if(!v)return;m.Z.setState({...m.Z.state,templateCreationInProgress:!0});const b={},M={},j=[],C=new Set;try{for(const e in m.Z.state.selectedProjectsAndTeamspaces){const i=m.Z.state.selectedProjectsAndTeamspaces[e].projects;if(0===i.length)continue;let o;j.push(...i.map((e=>e.mondayProjectId)));const d=m.Z.state.selectedProjectsAndTeamspaces[e],{notionTeamspaceId:c}=d;if(!c)continue;C.add(c);const u=r.find((e=>e.id===d.notionTeamspaceId));if(o=u||s,!b[c]){const{serverCommitResult:e,performResult:s}=y.createAndCommit({environment:t,perform:e=>{const s={type:"preset",uri:n.T3};if("preset"===s.type&&!s.uri.startsWith("notion://wiki")){var i;const n=s.uri,r=null===(i=(0,l.iX)(S(),n))||void 0===i?void 0:i.uri;if(!r)return;const d=S().find((e=>e.uri===r));if(null==d?void 0:d.presets.find((e=>e.uri===n))){return x.initializeApp({environment:t,spaceViewStore:a,appParentStore:o,appUri:r,presetUri:n,transaction:e,from:"monday_import"})}return[]}},userAction:"importActions.importMonday"});b[c]=s,await e}M.hasOwnProperty(c)?M[c]=[...M[c],{mondayFolderId:e,projects:i}]:M[c]=[{mondayFolderId:e,projects:i}]}}catch(P){return void m.Z.setState({...m.Z.state,templateCreationInProgress:!1,currentTab:"failure"})}const w=[],k=u.default.state.currentSpaceViewStore;if(!k)return;const T=f.Ym({environment:t,spaceStore:s,spaceViewStore:k,append:!0});await T.deferred.promise;const I=T.pageId;m.Z.setState({...m.Z.state,loggerPageId:I});for(const[n,i]of Object.entries(M)){const e=b[n];e&&w.push({collectionViewBlocks:e.map((e=>({id:e.id,spaceId:(0,o.C)(s.id)}))),notionTeamSpaceId:n,mondayProjectsAndFolders:i})}const Z=h.parallelMondayImport(t,{importParams:w,loggerPageId:I,spaceId:s.id,flowId:d});m.Z.setState({...m.Z.state,templateCreationInProgress:!1,currentTab:"importingData"}),p.Z.reset(),v&&function(e,t,s){try{g.qy(e,{import_source:"monday.com",data:t,flowId:s})}catch(n){i.log({level:"error",from:"mondayActions",type:"parallelMondayImport",error:{miscDataString:JSON.stringify({error:n,message:"Errored in tracking import_source_input event."})}})}}(t,{workspaceId:v,projects:j,numberOfTeamspacesUsed:C.size,userId:t.currentUser.id,spaceId:(0,o.C)(s.id)},d);for await(const n of Z){if(!m.Z.state.isModalOpen)break;if(n.error)return void m.Z.setState({...m.Z.state,currentTab:"failure"});"success"===n.taskStatus&&m.Z.setState({...m.Z.state,currentTab:"confirm",result:n.value.status,isComplete:!0})}}},360:(e,t,s)=>{s.d(t,{l:()=>i,q:()=>o});var n=s(25399);function i(){n.Z.setState({open:!0,submitted:!1,error:void 0})}function o(){n.Z.setState({open:!1})}},37834:(e,t,s)=>{s.d(t,{FF:()=>h,U4:()=>f,gs:()=>x,jN:()=>g,xx:()=>S,zb:()=>y});s(67294);var n=s(23867),i=s(9291),o=s(37810),a=s(77080),r=s(46096),l=s(36610),d=s(54642),c=s(47307),u=s(92625),p=s(85893);const m=(0,i.defineMessages)({restoringPreviousVersion:{id:"historyModalActions.restoringPreviousVersion.loadingMessage",defaultMessage:"Restoring…"}});function g(e){const{environment:t,from:s,...n}=e;l.y(t,s),r.Z.setState({...n,open:!0,size:50})}function h(){const e=r.Z.state;e.open&&r.Z.setState({...e,size:e.size+20})}function f(){r.Z.setState({open:!1})}function x(e){const{environment:t,snapshot:s,nextFutureSnapshot:n}=e;l.qD(t,s);const i=r.Z.state;i.open&&r.Z.setState({...i,snapshot:s,nextFutureSnapshot:n,openSnapshotNearTimestamp:void 0})}function y(){const e=r.Z.state;e.open&&r.Z.setState({...e,snapshot:void 0,nextFutureSnapshot:void 0})}async function S(e){if(!r.Z.state.open)return;if(!r.Z.state.snapshot)return;const t="restore_collection",s=r.Z.state.pageHasCollection,g=a.default.checkGate("snapshot_optional_collection_rollback_enabled")&&s?[{key:t,text:(0,p.jsx)(i.FormattedMessage,{defaultMessage:"Also restore databases on this page",id:"historyModal.confirmDialog.selectOption.collection"}),description:(0,p.jsx)(i.FormattedMessage,{defaultMessage:"All database pages will be restored to the previous version, which may impact other users or database views.",id:"historyModal.confirmDialog.selectOption.collection.description"})}]:void 0,{accept:h,selectionResult:x}=await c.confirmUserActionV2({message:(0,p.jsx)("div",{style:{fontWeight:o.Z.fontWeight.semibold,fontSize:"medium"},children:(0,p.jsx)(i.FormattedMessage,{defaultMessage:"Restore to this version?",id:"historyModal.confirmDialog.description"})}),acceptLabel:(0,p.jsx)(i.FormattedMessage,{defaultMessage:"Restore",id:"historyModal.confirmDialog.restoreButton.label"}),selectionItems:g});if(!h)return;l.R9(e,r.Z.state.snapshot),u.j({message:m.restoringPreviousVersion});const y=await d.restoreSnapshot(e,{block:{id:r.Z.state.blockStore.id,spaceId:(0,n.C)(r.Z.state.blockStore.pointer.spaceId)},timestamp:r.Z.state.snapshot.timestamp,shouldRestoreCollection:(null==x?void 0:x[t])??!1}).next();y.value.error&&c.showErrorMessage(y.value.error.message),u.x(),f()}},28040:(e,t,s)=>{s.d(t,{i:()=>u});var n=s(26263),i=s(65958),o=s(21202),a=s(80444),r=s(77080),l=s(6258),d=s(35057),c=s(54642);async function u(e){const{environment:t,sudoModeStore:s,pageBlockId:u}=e,p=s.state.privatePageStore&&s.state.privatePageStore.id===u;if(t.device.isMobile||p||s.state.loading||s.state.error)return;if(!r.default.checkGate("enable_get_private_page_info_endpoint"))return;const{currentSpaceStore:m}=a.default.state,g=null==m?void 0:m.canAdmin();if(!(u&&g&&m&&(0,d.wP)()))return;s.setState({...s.state,loading:!0});const h=m.id,f=await c.getPrivatePageInfo(t,{id:u});if("failed"===f.type)return void s.setState({...s.state,loading:!1,error:f.error});const x=f.data,y=new n.Z({name:i.Gh});for(const n of x)switch(n.table){case"block":case"collection":case"team":y.setRecord({pointer:{spaceId:h,table:n.table,id:n.value.id},userId:t.currentUser.id},{role:"editor",value:n.value})}const S=new l.G(t,{table:o.iU,id:u},{inMemoryRecordCache:y});S.inMemoryRecordCache.addCacheFallback(t.defaultRecordCache.inMemoryRecordCache),s.setState({...s.state,privatePageStore:S,loading:!1,error:void 0})}},54814:(e,t,s)=>{s.d(t,{nc:()=>l,rG:()=>r});s(57658);var n=s(6287),i=s(98165),o=s(6258),a=s(54642);async function r(e){let{environment:t,spaceId:s,databaseType:i,parentStore:r}=e;if(!s)return;const l=await a.getTypedDatabases(t,{spaceId:s,databaseType:i});return"success"===l.type?l.data.result.map((e=>o.NW.createChildStore(r,{table:n.vF,id:e.collectionId}))):void 0}async function l(e){let{environment:t,spaceId:s,databaseTypes:n,parentStore:o,teamId:a}=e;const l=[];return await Promise.all(n.map((async e=>{const n=await async function(e){let{environment:t,spaceId:s,databaseType:n,parentStore:o,teamId:a}=e;const l=await r({spaceId:s,environment:t,databaseType:n,parentStore:o});if(!l)return!1;for(const r of l){const e=i.VP(r);if(e&&e.id===a)return!0}return!1}({environment:t,spaceId:s,databaseType:e,parentStore:o,teamId:a});n&&l.push(e)}))),l}},2405:(e,t,s)=>{s.d(t,{Z:()=>a,h:()=>r});s(67294);var n=s(24405),i=s(64921),o=s(85893);function a(e){const{style:t,icon:s,disabled:a,iconStyle:r,title:l,onClick:d,focused:c,variant:u,...p}=e,m=(g={lightGrey:"lightGrey"===u,tintedSuggestion:"tintedSuggestion"===u},(0,n.yK)((e=>{let t=e.regularIconColor;return g.lightGrey?t=e.lightIconColor:g.tintedSuggestion&&(t=e.aiPurpleColor),{AssistantActionButton:{display:"flex",alignItems:"center",boxShadow:g.tintedSuggestion?"none":e.inputBoxShadow,padding:"6px 10px 6px 12px",color:g.lightGrey?e.lightTextColor:e.regularTextColor,fontSize:13,fontWeight:500,borderRadius:24,width:"max-content",background:g.tintedSuggestion?e.accentColors.gray[50]:"transparent"},...g.tintedSuggestion&&{hoveredStyle:{background:e.accentColors.gray[90]},pressedStyle:{background:e.accentColors.gray[100]}},icon:{width:14,height:14,fill:t,marginRight:6}}}),[g.lightGrey,g.tintedSuggestion]));var g;return(0,o.jsxs)(i.Z,{...p,disabled:a,style:{...m.AssistantActionButton,...t},onClick:d,focused:c,...e.tooltipEvents??{},children:[null==s?void 0:s({...m.icon,...r}),l]})}function r(e){return(0,o.jsx)(a,{...e,variant:"tintedSuggestion"})}},90891:(e,t,s)=>{s.r(t),s.d(t,{default:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{open:!1}}}const o=new i},17095:(e,t,s)=>{s.d(t,{l:()=>g});s(67294);var n=s(480),i=s(24405),o=s(60493),a=s(9291),r=s(64921),l=s(26388),d=s(43224),c=s(35948),u=s(4023),p=s(85893);const m=(0,a.defineMessages)({addDescriptionTooltip:{id:"database.description.addDescriptionTooltip",defaultMessage:"Add description"},editDescriptionTooltip:{id:"database.description.editDescriptionTooltip",defaultMessage:"Edit description"}});function g(e){let{onClick:t,description:s,showTooltip:g,addDescriptionText:h,editDescriptionText:f}=e;const{isMobile:x}=(0,n.Fy)(),[y,S]=(0,c.C)(),v=(0,a.useIntl)(),b=(0,i.yK)((e=>({button:{flexShrink:0,flexGrow:0,borderRadius:x?24:20,marginLeft:4},info:{width:x?18:16,height:x?18:16,fill:S?e.regularIconColor:e.mediumIconColor}})),[S,x]);return(0,p.jsx)(l.ZP,{renderTooltip:e=>(0,p.jsx)("div",{...e,children:null!=s&&s.length?s:h??v.formatMessage(m.addDescriptionTooltip)}),disableTooltip:!g,style:d.F6,placement:u.u.Top,render:e=>(0,p.jsx)(r.Z,{...e,ref:y,onClick:t,"aria-label":null!=s&&s.length?h:f??v.formatMessage(m.editDescriptionTooltip),style:b.button,children:(0,o.N)(b.info)})})}},27871:(e,t,s)=>{s.d(t,{i:()=>m,k:()=>u});var n=s(67294),i=s(480),o=s(24405),a=s(9291),r=s(68894),l=s(72495),d=s(43224),c=s(85893);const u=(0,a.defineMessages)({descriptionHeader:{id:"database.viewSettings.propertyTab.description.title",defaultMessage:"Description"},addDescription:{id:"database.viewSettings.propertyTab.description.addDescription",defaultMessage:"Add a description..."}}),p=60;function m(e){let{initialDescription:t,handleSaveDescription:s,disableAutoSection:m}=e;const[g,h]=(0,n.useState)(t??""),f=(0,n.useRef)(g),{isMobile:x}=(0,i.Fy)(),y=(0,a.useIntl)(),S=(0,o.yK)((e=>({title:{display:"flex",alignItems:"center",gap:4,cursor:"default",color:e.mediumTextColor},infoTooltip:{width:300,whiteSpace:"normal"},menuItem:{padding:x?"8px 0":void 0},descriptionInput:{lineHeight:"20px",fontSize:x?14:13}})),[x]),v=(0,n.useCallback)((()=>s(f.current)),[s]);(0,n.useEffect)((()=>()=>v()),[v]);const b=(0,n.useMemo)((()=>(0,c.jsx)(r.ZP,{value:g,onChange:e=>{h(e.target.value),f.current=e.target.value},onBlur:v,onSubmit:v,placeholder:y.formatMessage(u.addDescription),focusInitial:!0,disabled:!1,style:S.menuItem,inputOuterStyle:S.descriptionInput,textarea:!0,textareaSubmitOnEnter:!0,maxlength:d.pT,autosize:!0,autosizeMaxHeight:p,showClearButton:!1})),[g,y,v,S.descriptionInput,S.menuItem]);return x&&!m?(0,c.jsx)(l.Z,{topBorder:!0,title:(0,c.jsx)("span",{style:S.title,children:y.formatMessage(u.descriptionHeader)}),children:b}):b}},59827:(e,t,s)=>{s.d(t,{Q:()=>l});s(67294);var n=s(37810),i=s(65183),o=s(85893);const a={...n.Z.textOverflowStyle,position:"absolute",left:0,right:0,top:0,bottom:0},r={marginLeft:4,fontWeight:n.Z.fontWeight.semibold};function l(e){const{prefix:t,viewName:s,viewType:n}=e;return(0,o.jsxs)("div",{style:{position:"relative",width:"100%"},children:[" ",(0,o.jsxs)("div",{style:a,children:[t,n&&i.aW[n]({marginLeft:8,marginRight:2,width:"1em",display:"inline",verticalAlign:"bottom"}),(0,o.jsx)("span",{style:r,children:s})]})]})}},41229:(e,t,s)=>{s.r(t),s.d(t,{AiQnaIntroVideo:()=>O,QnaTermsApplyLink:()=>N,default:()=>E});var n=s(67294),i=s(13991),o=s(480),a=s(86628),r=s(24405),l=s(89968),d=s(7220),c=s(9291),u=s(7032),p=s(1898),m=s(25888),g=s(54642),h=s(47449),f=s(28344),x=s(1853),y=s(76110),S=s(15010),v=s(80444),b=s(21273),M=s(67940),j=s(92083),C=s(31809),w=s(66309),k=s(89024),T=s(90403),I=s(97122),Z=s(84076),P=s(89728),F=s(64369),A=s(6175),_=s(85893);const R=!1;function O(e){const t=(0,C.useNamedStyles)(),{isSmall:s,disableAutoplay:n}=e;return(0,_.jsx)(A.Z,{src:(0,y.Ix)(),defaultTextTrack:A.W[i.SP]||"en",options:{muted:!0,autoplay:!n,loop:!1},style:s?t.smallVariantVideoStubPng:t.stubPng})}function B(e){const{currentUserSettingsStore:t}=v.default.state;t&&(0,h.CX)(e,{userSettingsStore:t,phase:"tooltip",transactionUserAction:"AiQnaIntroModal.debug.clickTryNow"})}function D(e){const{onImport:t,onSkip:s}=e,i=(0,C.useNamedStyles)(),a=(0,r.Fg)(),u=(0,o.O7)();return(0,n.useEffect)((()=>{(0,f.trackQnaIntroModalShowImportRecommendation)(u)}),[u]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(x.U4,{}),(0,_.jsxs)(k.jX,{gap:30,children:[(0,_.jsx)(k.jX,{padding:"10px 22px 0px 28px",children:(0,d.l)({marginTop:20,marginBottom:-10,width:32,height:32,fill:a.lightIconColor})}),(0,_.jsxs)("div",{style:i.introCopyArea,children:[(0,_.jsx)("div",{style:i.introTitle,children:(0,_.jsx)(c.FormattedMessage,{defaultMessage:"Add content for Q&A",id:"AiQnaIntroModal.import.title"})}),(0,_.jsx)(F.Z,{isSecondaryColor:!0,isMultiline:!0,style:i.mainCopyText,children:(0,_.jsx)(c.FormattedMessage,{defaultMessage:"AI answers questions from content in your Notion workspace. Get better responses by importing content from other tools.",id:"AiQnaIntroModal.import.caption"})}),(0,_.jsxs)("div",{style:i.importDisclaimerWrap,children:[(0,l.Y)(i.clockIcon),(0,_.jsx)(F.Z,{isSecondaryColor:!0,isSmall:!0,children:(0,_.jsx)(c.FormattedMessage,{defaultMessage:"Q&A may take up to 30 minutes to process new content",id:"AiQnaIntroModal.import.disclaimer"})})]})]}),(0,_.jsxs)(C.Footer,{children:[(0,_.jsx)(C.LearnMoreLink,{shouldShowHelpCenterLink:!0}),(0,_.jsxs)(k.jX,{align:"center-right",direction:"row",gap:12,width:"hug",children:[(0,_.jsx)(P.Z,{isGray:!0,onClick:s,children:(0,_.jsx)(c.FormattedMessage,{defaultMessage:"Skip",id:"AiQnaIntroModal.import.skipButtonLabel"})}),(0,_.jsx)(I.h,{onClick:t,children:(0,_.jsx)(c.FormattedMessage,{defaultMessage:"Import",id:"AiQnaIntroModal.import.importButtonLabel"})})]})]})]})]})}function L(e){const{setShouldShowImportModal:t}=e,s=(0,o.O7)(),i=(0,a.VK)((()=>{const{currentSpaceStore:e}=v.default.state;return null==e?void 0:e.getSpaceId()}),[]);return(0,n.useEffect)((()=>{i?g.getQnaOnboardingData(s,{spaceId:i}).then((e=>{t("success"===e.type?e.data.isImportingDataRecommended:R)})).catch((e=>{console.error(e),t(R)})):t(R)}),[s,t,i]),null}function V(e){const{onContinue:t}=e,s=(0,C.useNamedStyles)(),i=(0,o.O7)();return(0,n.useEffect)((()=>{(0,f.trackQnaIntroModalOpen)(i)}),[i]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(x.U4,{}),(0,_.jsxs)(k.jX,{gap:30,children:[(0,_.jsx)(O,{}),(0,_.jsxs)("div",{style:s.introCopyArea,children:[(0,_.jsx)(C.NotionAI,{}),(0,_.jsxs)("div",{style:s.introTitle,children:[(0,_.jsx)(c.FormattedMessage,{defaultMessage:"Welcome to Q&A",id:"AiQnaIntroModal.intro.title"}),(0,_.jsx)(T.Z,{style:s.betaBadge,content:(0,_.jsx)(c.FormattedMessage,{id:"AiQnaIntroModal.intro.betaLabel",defaultMessage:"Beta"})})]}),(0,_.jsx)(F.Z,{isSecondaryColor:!0,isMultiline:!0,style:s.mainCopyText,children:(0,_.jsx)(c.FormattedMessage,{defaultMessage:"Get instant answers to your questions, using information from across your workspace.",id:"AiQnaIntroModal.intro.caption"})}),(0,_.jsx)("div",{style:{marginTop:10},children:(0,_.jsx)(C.LearnMoreLink,{shouldShowHelpCenterLink:!0})})]}),(0,_.jsxs)(C.Footer,{children:[(0,_.jsx)(N,{}),(0,_.jsx)(k.jX,{align:"center-right",direction:"row",gap:12,width:"hug",children:(0,_.jsx)(I.h,{onClick:t,children:(0,_.jsx)(c.FormattedMessage,{defaultMessage:"Continue",id:"AiQnaIntroModal.intro.signup.nextMessage"})})})]})]})]})}function N(){const e=(0,C.useNamedStyles)(),t=(0,o.O7)();return(0,_.jsx)("div",{style:e.learnMoreCopy,children:(0,_.jsx)(Z.Z,{onClick:()=>{m.IS(t,{from:"qna_intro_modal"})},style:e.learnMoreLink,innerStyle:e.learnMoreLinkInner,href:"https://notion.notion.site/39fa8d3593344f478917db8ff3dfc852",external:!0,children:(0,_.jsx)(c.FormattedMessage,{defaultMessage:"Q&A Beta terms apply",id:"AiQnaWaitlistModal.intro.termsApplyButton"})})})}const E=(0,c.injectIntl)((function(e){const[t,s]=(0,n.useState)(!1),i=(0,o.O7)(),l=(0,r.Fg)(),[d,c]=(0,n.useState)(R),[m,g]=(0,n.useState)("welcome"),[y,C]=(0,n.useState)(!1),k=(0,n.useCallback)((()=>{const{currentUserSettingsStore:e}=v.default.state;e&&((0,h.CX)(i,{userSettingsStore:e,phase:"tooltip",transactionUserAction:"AiQnaIntroModal.debug.clickCancel"}),(0,f.trackQnaIntroModalClose)(i,{modal_phase:m}))}),[i,m]),T=(0,n.useCallback)((()=>{(0,f.trackQnaIntroModalContinue)(i),d?g("importContent"):B(i)}),[i,d]),I=(0,n.useCallback)((()=>{(0,f.trackQnaIntroModalSkipImportClick)(i),B(i)}),[i]),Z=(0,n.useCallback)((()=>{(0,f.trackQnaIntroModalImportClick)(i),j.Z.setState({...j.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0}),M.Z.setState({flowId:(0,u.ZP)()}),C(!0)}),[i]),P=(0,a.VK)((()=>!j.Z.state.open),[]),F=(0,a.VK)((()=>{const{currentUserSettingsStore:e,currentSpaceStore:t,mainEditorCurrentBlockStore:s}=v.default.state;if(!e||!e.isReady())return!1;const n=e.getSettings();return!!n&&(!!(t&&s&&s.canRead())&&(!i.device.isMobile&&(!y&&(!(Number((0,S.e2)(e))<=2)&&(!(void 0!==n.ai_qna_intro_onboarding_phase||!b.Z.showAiQnaOnboardingModalForBetaLaunch())||void 0)))))}),[y,i]);return function(){const e=(0,n.useRef)(!1),t=(0,o.O7)();(0,a.VK)((()=>{const{currentUserSettingsStore:s}=v.default.state;if(!s||!s.isReady())return;if(!b.Z.showRemindersToUseQnA())return;const n=s.getSettingsStore().getKeyStore("last_exposed_to_ai_qna_at").getValue();(0,p.$K)(n)||e.current||(e.current=!0,(0,h.Up)(t,{userSettingsStore:s}))}),[t])}(),(0,n.useEffect)((()=>{s(!!F)}),[F]),(0,n.useEffect)((()=>{y&&P&&(C(!1),B(i))}),[y,P,i]),(0,_.jsx)(x.gv.Provider,{value:k,children:(0,_.jsx)(w.default,{shouldShow:t,calloutId:"ai_qna_alpha",desktopRenderInner:()=>{switch(m){case"welcome":return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(L,{setShouldShowImportModal:c}),(0,_.jsx)(V,{onContinue:T})]});case"importContent":return(0,_.jsx)(D,{onImport:Z,onSkip:I});default:(0,p.t1)(m)}},desktopInnerStyle:{background:l.sidebarBackground,borderRadius:12,width:450},desktopOnDismiss:k,phoneRenderInner:()=>null})})}))},31809:(e,t,s)=>{s.r(t),s.d(t,{Footer:()=>Q,LearnMoreLink:()=>X,NotionAI:()=>ie,default:()=>me,useNamedStyles:()=>pe});var n=s(67294),i=s(36769),o=s(13991),a=s(480),r=s(86628),l=s(24405),d=s(41892),c=s(3338),u=s(11751),p=s(9291),m=s(1898),g=s(37810),h=s(25888),f=s(54642),x=s(64964),y=s(10259),S=s(13447),v=s(37181),b=s(28344),M=s(90891),j=s(1853),C=s(76110),w=s(15010),k=s(99622),T=s(12205),I=s(3791),Z=s(88280);function P(){return(0,r.VK)((()=>{var e;const t=(null===(e=Z.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,I.de)(t)}),[])}var F=s(80444),A=s(21273),_=s(80671),R=s(44041),O=s(35057),B=s(66309),D=s(89024),L=s(90403),V=s(97122),N=s(84076),E=s(89728),U=s(58297),W=s(64369),K=s(6175),z=s(85893);const q=24,G=254,H=170;function Y(e){const{stage:t,setStage:s}=e;switch(t){case"intro":case"upsell":return(0,z.jsx)($,{onAddedToWaitlist:()=>s("thank-u-next")});case"thank-u-next":return(0,z.jsx)(re,{});case"waitlist-upsell":return(0,z.jsx)(ce,{});default:(0,m.t1)(t)}}function Q(e){const{children:t}=e,s=pe(),{isPhone:n}=(0,a.Fy)();return n?(0,z.jsx)(D.jX,{align:"center-right",gap:12,padding:q,style:s.footer,children:t}):(0,z.jsx)(D.jX,{align:"center",direction:"row",gap:"auto",padding:q,style:s.footer,children:t})}function $(e){const{onAddedToWaitlist:t}=e,s=pe(),i=(0,a.O7)(),o=(0,n.useContext)(j.gv),r=function(e){const t=(0,a.O7)(),s=(0,k.Y)(Z.subscriptionDataStoreInstance),i=(0,T.J)();return(0,n.useCallback)((()=>{const{currentSpaceStore:n,currentSpaceViewStore:o}=F.default.state;n&&o&&(f.addUserToWaitlist(t,{program:"ai",spaceId:n.id}),(0,b.trackQnaWaitlistModalRequestAccess)(t,{isSalesAssisted:s,isSpaceAdmin:i}),e())}),[t,e,s,i])}(t);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(j.U4,{}),(0,z.jsxs)(D.jX,{gap:32,children:[(0,z.jsx)(J,{}),(0,z.jsx)("div",{style:s.introCopyArea,children:(0,z.jsxs)(D.jX,{gap:8,children:[(0,z.jsx)(ie,{}),(0,z.jsxs)("div",{style:s.introTitle,children:[(0,z.jsx)(p.FormattedMessage,{defaultMessage:"Introducing Q&A",id:"AiQnaWaitlistModal.intro.title"}),(0,z.jsx)(L.Z,{style:s.betaBadge,content:(0,z.jsx)(p.FormattedMessage,{id:"AiQnaWaitlistModal.intro.betaLabel",defaultMessage:"Beta"})})]}),(0,z.jsx)(W.Z,{isSecondaryColor:!0,isMultiline:!0,style:s.mainCopyText,children:(0,z.jsx)(p.FormattedMessage,{defaultMessage:"Get instant answers to your questions, using information from across your workspace.",id:"AiQnaWaitlistModal.intro.caption"})})]})}),(0,z.jsxs)(Q,{children:[(0,z.jsx)(X,{}),(0,z.jsxs)(D.jX,{align:"center-right",direction:"row",gap:12,width:"hug",children:[(0,z.jsx)(E.Z,{isSmall:!0,style:s.skipButton,onClick:()=>{(0,b.trackQnaWaitlistModalSkip)(i),null==o||o()},children:(0,z.jsx)(W.Z,{isSmall:!0,children:(0,z.jsx)(p.FormattedMessage,{defaultMessage:"Skip",id:"AiQnaWaitlistModal.intro.skip.nextMessage"})})}),(0,z.jsx)(V.h,{onClick:r,styles:{padding:"6px 16px",height:void 0},children:(0,z.jsx)(p.FormattedMessage,{defaultMessage:"Request access to Q&A",id:"AiQnaWaitlistModal.intro.signup.nextMessage"})})]})]})]})]})}function J(){const e=pe();return(0,z.jsx)(K.Z,{src:(0,C.bv)(),defaultTextTrack:K.W[o.SP]||"en",options:{muted:!0,autoplay:!0,loop:!0},style:e.stubPng})}function X(e){let{shouldShowHelpCenterLink:t}=e;const s=pe(),n=(0,a.O7)();return(0,z.jsx)("div",{style:s.learnMoreCopy,children:(0,z.jsx)(N.Z,{onClick:()=>{h.Fs(n,{from:"qna_intro_modal"})},style:s.learnMoreLink,innerStyle:s.learnMoreLinkInner,href:t?"https://www.notion.so/help/qna":"https://www.notion.so/ai",external:!0,children:(0,z.jsx)(p.FormattedMessage,{defaultMessage:"Learn more about Q&A",id:"AiQnaWaitlistModal.intro.learnMoreUrl"})})})}function ee(){const e=pe(),t=function(){const e=(0,a.O7)(),t=(0,n.useContext)(j.gv),s=(0,r.VK)((()=>F.default.state.currentSpaceStore),[]);return(0,n.useCallback)((()=>{if(!s)return;(async()=>{await(0,_.jw)({environment:e,spaceStore:s,from:"ai_qna_waitlist"}),null==t||t(),x.oV({label:(0,z.jsx)(p.FormattedMessage,{id:"AiQnaWaitlistModal.requestAccess.snackbar",defaultMessage:"Thank you! We received your request"})})})()}),[e,t,s])}();return(0,z.jsx)(U.Z,{style:e.upsellButton,onClick:t,children:(0,z.jsx)(p.FormattedMessage,{defaultMessage:"Send upgrade request",id:"AiQnaWaitlistModal.requestUpgrade.nextMessage"})})}function te(){const e=pe(),t=function(){const e=(0,a.O7)();return(0,n.useCallback)((()=>{R.y(e,{from:"ai_qna_waitlist",for:(0,O.zt)(),addOnFeature:"ai"})}),[e])}();return(0,z.jsx)(U.Z,{style:e.upsellButton,onClick:t,children:(0,z.jsx)(p.FormattedMessage,{defaultMessage:"Get Notion AI",id:"AiQnaWaitlistModal.thankunext.nextMessage"})})}function se(){const e=(0,T.J)(),t=(0,k.Y)(Z.subscriptionDataStoreInstance);return P()||t&&e?null:t&&!e?(0,z.jsx)(ee,{}):!t&&e?(0,z.jsx)(te,{}):t||e?null:(0,z.jsx)(ee,{})}function ne(){const e=(0,T.J)(),t=(0,k.Y)(Z.subscriptionDataStoreInstance);return P()||t&&e?null:t&&!e?(0,z.jsx)(ae,{}):!t&&e?(0,z.jsx)(de,{}):t||e?null:(0,z.jsx)(ae,{})}function ie(){const e=pe();return(0,z.jsxs)(D.jX,{direction:"row",children:[(0,u.t)(e.sparklesIcon),(0,z.jsx)(W.Z,{isSmall:!0,style:e.notionAiText,children:(0,z.jsx)(p.FormattedMessage,{defaultMessage:"Notion AI",id:"AiQnaWaitlistModal.intro.brandingHero"})})]})}function oe(){const e=pe(),t="dark"===(0,l.Fg)().mode?d.Z.images.onboarding.aiQnaBudsDarkPng:d.Z.images.onboarding.aiQnaBudsPng;return(0,z.jsx)("img",{style:e.qnaBuds,src:t})}function ae(){const e=pe();return(0,z.jsxs)("div",{style:e.nextSteps,children:[(0,z.jsx)(W.Z,{isMultiline:!0,style:e.upsellHeader,children:(0,z.jsx)(p.FormattedMessage,{defaultMessage:"Request an upgrade",id:"AiQnaWaitlistModal.thankunext.requestUpgrade"})}),(0,z.jsx)(W.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,style:e.upsellCopy,children:(0,z.jsx)(p.FormattedMessage,{defaultMessage:"Send a request to your workspace owner to upgrade for unlimited usage of Notion AI.",id:"AiQnaWaitlistModal.thankunext.captionRequest"})}),(0,z.jsx)(oe,{})]})}function re(){const e=pe(),t=(0,r.VK)((()=>{var e;return null===(e=F.default.state.currentSpaceStore)||void 0===e?void 0:e.getName()}),[]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(j.U4,{}),(0,z.jsxs)(D.jX,{gap:32,children:[(0,z.jsxs)(D.jX,{gap:32,padding:`0 ${q}px`,children:[(0,z.jsx)("div",{children:(0,z.jsxs)(D.jX,{gap:6,children:[(0,z.jsx)("div",{style:e.thanksHeaderArea,children:(0,z.jsxs)(D.jX,{gap:6,children:[(0,c.p)(e.circleCheckIcon),(0,z.jsx)(p.FormattedMessage,{defaultMessage:"Thanks, you're on the list!",id:"AiQnaWaitlistModal.thankunext.title"})]})}),(0,z.jsx)(W.Z,{isSecondaryColor:!0,isMultiline:!0,style:e.thanksCopy,children:(0,z.jsx)(p.FormattedMessage,{defaultMessage:"Your workspace owners will get an email when {spaceName} receives access to Q&A.",id:"AiQnaWaitlistModal.thankunext.caption",values:{spaceName:t}})})]})}),(0,z.jsx)(ne,{})]}),(0,z.jsxs)(Q,{children:[(0,z.jsx)(X,{}),(0,z.jsx)(le,{}),(0,z.jsx)(se,{})]})]})]})}function le(){const e=pe(),t=(0,n.useContext)(j.gv);return(0,z.jsx)(E.Z,{isSmall:!0,style:e.thanksDoneButton,onClick:t,children:(0,z.jsx)(W.Z,{isSmall:!0,children:(0,z.jsx)(p.FormattedMessage,{defaultMessage:"Got it",id:"AiQnaWaitlistModal.thankunext.gotIt"})})})}function de(){const e=pe();return(0,z.jsxs)("div",{style:e.nextSteps,children:[(0,z.jsx)(W.Z,{isMultiline:!0,style:e.upsellHeader,children:(0,z.jsx)(p.FormattedMessage,{defaultMessage:"Upgrade to go unlimited",id:"AiQnaWaitlistModal.thankunext.headerUpsell"})}),(0,z.jsx)(W.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,style:e.upsellCopy,children:(0,z.jsx)(p.FormattedMessage,{defaultMessage:"Give everyone in your workspace unlimited use of Notion AI's writing assistant and database autofill. Plus, we'll bump you to the top of the list for Q&A!",id:"AiQnaWaitlistModal.thankunext.captionUpsell"})}),(0,z.jsx)(oe,{})]})}function ce(){const e=pe();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(j.U4,{}),(0,z.jsxs)(D.jX,{gap:32,children:[(0,z.jsx)(ue,{}),(0,z.jsx)("div",{style:e.introCopyArea,children:(0,z.jsxs)(D.jX,{gap:8,children:[(0,z.jsx)("div",{style:e.preIntroArea,children:(0,z.jsxs)(D.jX,{direction:"row",gap:6,align:"center-left",children:[(0,c.p)(e.circleCheckIconSmall),(0,z.jsx)(p.FormattedMessage,{defaultMessage:"You're on the waitlist",id:"AiQnaWaitlistModal.waitlistUpsell.confirmation"})]})}),(0,z.jsx)("div",{style:e.introTitle,children:(0,z.jsx)(p.FormattedMessage,{defaultMessage:"Get in front of line with Notion AI add-on",id:"AiQnaWaitlistModal.waitlistUpsell.title"})}),(0,z.jsx)(W.Z,{isSecondaryColor:!0,isMultiline:!0,style:e.mainCopyText,children:(0,z.jsx)(p.FormattedMessage,{defaultMessage:"Get faster access to Q&A by subscribing to Notion AI. Use Notion AI for writing and autofills today.",id:"AiQnaWaitlistModal.waitlistUpsell.caption"})})]})}),(0,z.jsxs)(Q,{children:[(0,z.jsx)(X,{}),(0,z.jsxs)(D.jX,{align:"center-right",direction:"row",gap:12,width:"hug",children:[(0,z.jsx)(le,{}),(0,z.jsx)(te,{})]})]})]})]})}function ue(){const e=pe();return(0,z.jsx)(K.Z,{src:(0,C.Ix)(),defaultTextTrack:K.W[o.SP]||"en",options:{muted:!0,autoplay:!0,loop:!0},style:e.stubPng})}function pe(){return(0,l.yK)((e=>({betaBadge:{borderRadius:4,display:"inline-block",fontSize:11,fontWeight:500,padding:"1px 4px"},circleCheckIcon:{color:e.grayButtonBackground,paddingBottom:4,width:32},importDisclaimerWrap:{marginTop:10,display:"flex",alignItems:"center",gap:2},clockIcon:{width:14,height:14,color:e.mediumTextColor},circleCheckIconSmall:{color:e.accentColors.gray[700],width:14},connectedAppsIcon:{height:14,marginLeft:4,width:14},desktopInner:{background:e.sidebarBackground,borderRadius:12,width:450},footer:{borderTop:`1px solid ${e.tableLightDividerColor}`},introCopyArea:{paddingLeft:q,paddingRight:q},introTitle:{fontWeight:g.Z.fontWeight.bold,fontSize:25,display:"flex"},learnMoreCopy:{color:e.mediumTextColor,fontSize:12,textDecoration:"underline"},learnMoreLink:{width:"max-content",marginLeft:-4},learnMoreLinkInner:{display:"flex",alignItems:"center",paddingLeft:4,paddingRight:4},mainCopyText:{width:350},nextSteps:{borderRadius:8,background:"dark"===e.mode?e.accentColors.gray[300]:e.accentColors.gray[50],padding:16,position:"relative"},notionAiText:{marginTop:2,paddingLeft:4,color:e.accentColors.gray[900],fontWeight:g.Z.fontWeight.medium},preIntroArea:{fontWeight:g.Z.fontWeight.medium,fontSize:14,color:e.accentColors.gray[700]},qnaBuds:{position:"absolute",height:50,bottom:0,right:0},sparklesIcon:{width:14},skipButton:{height:32},stubPng:{width:"100%",height:G},smallVariantVideoStubPng:{width:"100%",height:H},thanksCopy:{width:375},thanksDoneButton:{height:32},thanksHeaderArea:{fontWeight:g.Z.fontWeight.bold,fontSize:25,marginTop:q+16},upsellButton:{height:32,minWidth:72,width:"fit-content"},upsellCopy:{width:270},upsellHeader:{fontWeight:600,fontSize:16,paddingBottom:6,paddingTop:4}})),[])}(0,i.exposeDebugEnvironmentValue)("resetQnAWaitlist",(e=>()=>{const{currentSpaceViewStore:t}=F.default.state;t&&y.aW(e,{spaceViewStore:t,shown:void 0,transactionUserAction:"debugging.resetAIOnboarding"})}));const me=function(){const e=(0,a.O7)(),[t,s]=(0,n.useState)(!1),[i,o]=(0,n.useState)("intro"),l=function(e,t){const s=(0,a.O7)();return(0,n.useCallback)((()=>{const{currentSpaceViewStore:n,currentUserSettingsStore:i}=F.default.state;n&&i&&(e(!1),t("intro"),M.default.state.open&&(M.default.setState({open:!1}),S.createAndCommit({userAction:"dismissQnaUpsellNudge",environment:s,userId:i.id,perform:e=>{v.d2({userSettingsStore:i,data:{ai_qna_upsell_dismissed_at:Date.now()},transaction:e})}})),y.aW(s,{spaceViewStore:n,shown:!0,transactionUserAction:"AiQnaWaitlistModal.cancel"}),(0,b.trackQnaWaitlistModalClose)(s))}),[s,e,t])}(s,o),d=pe(),c=function(){const e=(0,a.O7)();return(0,r.VK)((()=>{const{currentSpaceViewStore:t,currentSpaceStore:s,mainEditorCurrentBlockStore:n,currentUserSettingsStore:i}=F.default.state;if(!s||!s.isReady())return!1;if(!t||!t.isReady())return!1;if(!i||!i.isReady())return!1;const o=t.getSettings();return!!o&&(!!(s&&n&&n.canRead())&&(!(Number((0,w.e2)(i))<=2)&&(!e.device.isMobile&&!(void 0!==o.ai_qna_waitlist_shown||!A.Z.canSeeWaitlistModal()))))}),[e])}();(0,n.useEffect)((()=>{s(!!c)}),[c]);const u=(0,r.VK)((()=>M.default.state),[]);return(0,n.useEffect)((()=>{u.open?(o(u.stage),s(!0)):s(!1)}),[u]),(0,z.jsx)(j.gv.Provider,{value:l,children:(0,z.jsx)(B.default,{shouldShow:t,calloutId:"ai_qna_beta_waitlist",desktopRenderInner:()=>(0,z.jsx)(Y,{stage:i,setStage:o}),desktopInnerStyle:d.desktopInner,desktopOnDismiss:l,phoneRenderInner:()=>(0,z.jsx)(Y,{stage:i,setStage:o}),onModalShow:()=>{(0,b.trackQnaWaitlistModalOpen)(e)}})})}},87493:(e,t,s)=>{s.r(t),s.d(t,{default:()=>d});s(67294);var n=s(480),i=s(49386),o=s(60709),a=s(48019),r=s(78140),l=s(85893);const d=function(e){let{block:t,onAccept:s}=e;const d={blocks:[t],environment:(0,n.O7)(),publicEditMode:void 0};return(0,l.jsx)(r.Z,{menuType:o.og.Popup,children:(0,l.jsx)(a.Z,{sections:i.Qi,context:d,onAccept:s})})}},66309:(e,t,s)=>{s.r(t),s.d(t,{default:()=>C});s(67294);var n=s(480),i=s(86628),o=s(24405),a=s(27328),r=s(99747),l=s(24677),d=s(98104),c=s(95477),u=s(18514),p=s(34859),m=s(80444),g=s(77080),h=s(69454),f=s(92083),x=s(36488),y=s(28451),S=s(50506),v=s(53437),b=s(53336),M=s(32662),j=s(85893);function C(e){const t=(0,n.O7)(),s=(0,o.Fg)(),C=(0,n.Fy)(),w=(0,i.VK)((()=>(0,u.__)(t)),[t]),k=(0,i.VK)((()=>t.TabbedRouterStore),[t.TabbedRouterStore]),T=(0,i.VK)((()=>(0,a.w_)(k.state)),[k]),I=(0,i.VK)((()=>{var e;return"web"===T.type&&((null===(e=T.redirectedTo)||void 0===e?void 0:e.route)||T.route)}),[T]),Z=(0,i.VK)((()=>{const t="notTransitioning"===m.default.state.spaceTransitionStatus&&m.default.state.initialized,s=g.default.state.isLoaded;if(!t||!s)return!1;if(f.Z.state.open)return!1;const n=c.default.isAdminMode;return C.isPhone&&w?e.shouldShow&&!n&&I&&"page"===I.name:e.shouldShow&&!c.default.isAdminMode}),[C.isPhone,w,e.shouldShow,I]),P=(0,i.VK)((()=>t.WindowSizeStore.isLandscape()),[t.WindowSizeStore]),F=(0,i.VK)((()=>t.WindowSizeStore.getSafePaddingTopCSS(r.g)),[t.WindowSizeStore]),A=(0,i.VK)((()=>{const e=h.Z.state.phase===h.i.hidden||h.Z.state.phase===h.i.willHide;let s=h.Z.estimatedNativeWebBottomOverlap();return C.isMobileBrowser&&(s+=32),e?t.WindowSizeStore.getSafePaddingBottomPx(s):s}),[C.isMobileBrowser,t.WindowSizeStore]);if(C.isPhone){function _(){var s;null===(s=e.onModalShow)||void 0===s||s.call(e),l.ZH(t),d.sD()}return(0,j.jsx)(y.g,{calloutId:e.calloutId,shouldShow:Z,onShow:_,children:(0,j.jsx)(v.ZP,{open:Z,forceFullScreenSlideUp:!0,hidesMobileNativeBottomBar:!0,preventBlockRenderQueueOnEnter:!0,popupType:v.ZP.PopupType.SlideUp,style:{background:s.sidebarBackground,borderRadius:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},render:()=>(0,j.jsxs)(b.Z,{type:P?p.Z.Y:p.Z.None,style:{background:s.sidebarBackground,width:P?"80%":"100%",height:P?void 0:"100%",display:"flex",flexDirection:"column",alignItems:"center",...e.phoneInnerStyle},children:[(0,j.jsx)(M.Z,{size:P?200:F}),e.phoneRenderInner(),(0,j.jsx)(M.Z,{size:A})]})})})}return(0,j.jsx)(y.g,{calloutId:e.calloutId,shouldShow:Z,onShow:e.onModalShow,children:(0,j.jsx)(S.Z,{open:Z,preventHideChildrenWhileOpening:!0,onDismiss:e.desktopOnDismiss,innerStyle:{background:s.sidebarBackground,borderRadius:12,...e.desktopInnerStyle},render:()=>(0,j.jsx)(x.Z,{capture:!0,allowEsc:!0,render:e.desktopRenderInner})})})}},50407:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Zd});var n=s(67294),i=s(480),o=s(86628),a=s(47839),r=s(52989),l=s(33767),d=s(83355),c=s(70203),u=s(53965),p=s(68425),m=s(4727),g=s(13447),h=s(78140),f=s(53437),x=s(60709),y=s(68056),S=s(31352),v=s(24666),b=s(72187),M=s(69783),j=s(75375),C=s(85893);class w extends d.Z{constructor(){super(...arguments),this.renderMenu=()=>{const{device:e}=this.environment,t=M.Z.state,s=n.createRef();if(!t.open)return;let i;return i=e.isMobileNative&&!e.isTablet?{menuType:x.og.ActionSheet}:{menuType:x.og.Popup,width:b.fG,maxHeight:b.VJ,onClickOutside:m.xv},(0,C.jsx)(h.Z,{innerRef:s,...i,children:(0,C.jsx)(j.Z,{filter:T(t)||"",onSubmit:e=>function(e,t){g.createAndCommit({userAction:"EmojiMenu.handleSubmit",environment:t,perform:s=>{m.RL({environment:t,emoji:e,transaction:s})}})}(e,this.environment),onNoResults:this.handleNoResults,isCallout:!1,menuRef:s})})},this.handleNoResults=()=>{const e=M.Z.state;if(!e.open)return;const t=T(e);if(!t)return;const s=u.Z$(t);s&&(/\s/g.test(s)?m.xv():this.trackNoResultsDebounced(t))},this.trackNoResultsDebounced=u.Ds((e=>{p.VJ(this.environment,{searchQuery:e})}),500)}UNSAFE_willMountOrUpdate(){const e=M.Z.state;if(e.open){var t;const s=v.default.state,n=T(e);if("editing"!==s.mode)return void m.xv();const i=c.eeV(s.multiSelection.start.store.getValue())[s.multiSelection.start.index-1];if(!n&&":"!==i)return void m.xv();((null===(t=(0,y.QY)(s.multiSelection))||void 0===t?void 0:t.store)!==e.textStore||void 0===n||":"===n||n.startsWith("\n")||n.startsWith(" "))&&m.xv()}}renderComponent(){const{device:e}=this.environment,t=M.Z.state;let s=!1;if(t.open){const e=T(t);e&&e.length>0&&(s=!0),t.showPopupWithEmptyFilter&&(s=!0)}return(0,C.jsx)(f.ZP,{popupType:e.isMobileNative&&!e.isTablet?f.ZP.PopupType.SlideUp:f.ZP.PopupType.Popup,open:s,originRect:t.open?t.selectionRect:void 0,placementToOrigin:f.ZP.Placement.Bottom,alignmentToOrigin:f.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:I,render:this.renderMenu,keepFocus:!0})}}w.displayName="EmojiMenu";const k=w;function T(e){return S.zK(e.textStore,e.oldTextValue,!0)}function I(){m.xv()}var Z=s(12534),P=s(39500),F=s(95697),A=s(77907),_=s(35868);function R(){return(0,o.VK)((()=>_.Z.state.open),[],{debugName:"MessageStoreDebugPanelWrapper.isOpen"})?(0,C.jsx)(A.LazyMessageStoreDebugPanel,{}):null}var O=s(75538),B=s(23279),D=s.n(B),L=s(59054),V=s(54642),N=s(1898),E=s(80444);function U(e){let{environment:t}=e;const{currentSpaceViewStore:s,currentSpaceStore:n,currentUserStore:i}=E.default.state,o=null==s?void 0:s.getUserId(),a=null==s?void 0:s.getSpaceId(),r={readyForHomePagesRequest:!1,spaceViewUserId:void 0,spaceViewId:void 0};return null!=s&&s.isDefined()&&s.getAlive()&&s.canRead()&&o&&a?O.default.state.isOnboarding||function(){const{spaceTransitionStatus:e}=E.default.state;switch(e){case"notTransitioning":return!1;case"joiningOrCreatingSpace":case"switchingToOrLoadingSpace":return!0;default:(0,N.t1)(e)}}()||t.currentUser.id!==o||(null==i?void 0:i.id)!==o||(null==n?void 0:n.id)!==a?r:(0,F.QI)()?{readyForHomePagesRequest:!0,spaceViewId:s.id,spaceViewUserId:o}:r:r}const W=D()(V.getUserHomePages,1e3,{leading:!0,trailing:!0}),K=function(){const e=(0,i.O7)(),t=(0,o.VK)((()=>U({environment:e})),[e]);return(0,L.r5)((async()=>{t.readyForHomePagesRequest&&await W(e,{spaceViewId:t.spaceViewId},t.spaceViewUserId)}),[e,t.readyForHomePagesRequest,t.spaceViewId,t.spaceViewUserId]),null};var z=s(77080),q=s(94416),G=s(19671),H=s(13023),Y=s(69784),Q=s(44615),$=s(2688),J=s(28517),X=s(69911);function ee(){const e=(0,i.O7)(),{currentSpaceStore:t}=(0,o.Kw)(E.default),s=e.currentUser.id,a=(0,o.VK)((()=>null==t?void 0:t.id),[t]);return(0,n.useEffect)((()=>{if(!a||!s)return;const t=$.ZP.addListener((0,Q.pD)({userId:s,spaceId:a}),(async(t,n)=>{(function(e){var t;let{spaceId:s,userId:n,emitValue:i}=e;const o=null===(t=X.Z.getUserJoinedTeamsState({userId:n,spaceId:s}))||void 0===t?void 0:t.lastEmitValue;if(o===i)return!1;if(void 0===o&&X.Z.getHasFetched({userId:n,spaceId:s}))return!1;return!0})({spaceId:a,userId:s,emitValue:n})&&await J.m({environment:e,spaceId:a,userId:s,emitValue:n});const i=X.Z.getUserJoinedTeamsState({userId:s,spaceId:a});i&&X.Z.setUserJoinedTeamsState({userId:s,spaceId:a,state:{...i,lastEmitValue:n}})}),void 0,e);return function(){t&&$.ZP.removeListener(t,e)}}),[e,s,a]),null}var te=s(41464),se=s(24405),ne=s(64275),ie=s(84169),oe=s(9291),ae=s(37810),re=s(88150),le=s(98104),de=s(14976),ce=s(18514),ue=s(4023),pe=s(85305),me=s(73063),ge=s(26388),he=s(65187);const fe=(0,oe.defineMessages)({learnTooltip:{defaultMessage:"Learn more about alt text",id:"altTextMenuPopup.helpButton.tooltip"}});function xe(){const e=(0,i.O7)(),{device:t}=e,s=(0,oe.useIntl)(),a=(0,se.yK)((e=>({wrapper:{padding:t.isMobile?16:12,display:"flex",flexDirection:"column",fontSize:t.isMobile?ae.Z.fontSize.UIRegular.mobile:ae.Z.fontSize.UIRegular.desktop,wordBreak:"break-word",maxHeight:t.isMobile?"35vh":"200px",overflowY:"auto"},closeButton:{borderRadius:"100%",width:22,height:22,float:"right",marginLeft:8},input:{marginTop:t.isMobile?16:12,padding:t.isMobile?"8px 12px":"4px 10px",width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.surface.page,cursor:"text",overflowX:"hidden"},helpText:{color:e.text.secondary,display:"inline"},helpButton:{marginLeft:2,display:"inline-flex",position:"absolute",transform:t.isMobile?void 0:"translateY(-1px)"}})),[t.isMobile]),{altTextStore:r,altText:l,canEdit:d}=(0,o.VK)((()=>{const e=pe.Z.state.blockStore;return{altTextStore:null==e?void 0:e.getPropertyStore("alt_text"),altText:e?(0,de.Xh)(null==e?void 0:e.getPropertyValue("alt_text"),e):void 0,canEdit:(null==e?void 0:e.canEdit())&&!(null!=e&&e.isNavigableAncestorNonEditableState())}}),[]);return(0,n.useEffect)((()=>{r&&le.NX({store:r})}),[r]),(0,C.jsx)(h.Z,{menuType:t.isMobile?x.og.ActionSheet:x.og.Popup,width:t.isMobile?"100vw":310,children:(0,C.jsxs)("div",{style:a.wrapper,children:[(0,C.jsxs)("div",{children:[(0,C.jsx)(me.Z,{style:a.closeButton,hovered:!0,icon:ne.D,onClick:()=>re.x(e),ariaLabel:s.formatMessage({id:"altTextMenuPopup.closeButton",defaultMessage:"Close"})}),d?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{style:a.helpText,children:(0,C.jsx)(oe.FormattedMessage,{id:"altTextMenuPopup.description",defaultMessage:"Add alt text to describe this image. This makes your page more accessible to people who are vision-impaired or blind"})}),(0,C.jsx)(ge.ZP,{renderTooltip:()=>s.formatMessage(fe.learnTooltip),render:e=>(0,C.jsx)(me.Z,{ariaLabel:s.formatMessage(fe.learnTooltip),icon:ie.m,external:!0,href:(0,ce.UY)("guides.altText"),style:a.helpButton,isLightIconColor:!0,...e})})]}):l]}),d&&r&&(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(he.Z,{store:r,disabled:!1,pasteBehavior:"plaintext",style:a.input,placeholderStyle:a.input,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableInsertText:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableMentions:!0,disableEmbedMenu:!0,disableMobileActionBar:!0,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:()=>re.x(e),onEsc:()=>re.x(e),placeholder:s.formatMessage({id:"altTextMenuPopup.placeholder",defaultMessage:"Add alt text..."}),inPageFind:{type:"none"}})})]})})}const ye=function(){const e=(0,i.O7)(),{device:t}=e,s=(0,se.yK)((e=>({popup:{background:e.altTextPopupBackground,borderTopLeftRadius:t.isMobile?12:6,borderTopRightRadius:t.isMobile?12:6,left:t.isMobile?0:8}})),[t.isMobile]),{open:n,originRect:a}=(0,o.VK)((()=>{const{open:e}=pe.Z.state;return e?{open:e,originRect:pe.Z.state.originRect}:{open:e,originRect:void 0}}),[]);return(0,C.jsx)(f.ZP,{popupType:t.isMobile?f.ZP.PopupType.SlideUp:f.ZP.PopupType.Popup,open:n,originRect:a,originGap:8,placementToOrigin:ue.u.Bottom,alignmentToOrigin:f.ZP.Alignment.End,onDismiss:()=>re.x(e),render:()=>(0,C.jsx)(xe,{}),sameWidthAsOrigin:!1,style:s.popup})};var Se=s(54564),ve=s(92650),be=s(24646),Me=s(24229),je=s(41432),Ce=s(24039),we=s(65598),ke=s(34859),Te=s(9672),Ie=s(36488),Ze=s(3386),Pe=s(40721),Fe=s(3553),Ae=s(66957);const _e=[Me.u.Open,Me.u.Resolved];const Re=function(e){let{discussionIds:t,blockStore:s,recursivelyLoadAllDiscussions:n,tab:a}=e;const r=(0,i.O7)(),{resolved:l,unresolved:d}=(0,o.VK)((()=>{const e=we.al(s,{recursivelyLoadAllDiscussions:n}).filter((e=>!t||t.includes(e.id)||we.De(e))),{resolved:i,unresolved:o}=we.bB(e);return{resolved:i,unresolved:o}}),[t,s,n]);if((0,o.VK)((()=>(0,be.Sx)(r)),[r]))return null;const{device:c}=r;let u;return u=c.isMobile?{menuType:x.og.Modal,title:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Comments",id:"blockDiscussionMenu.mobileMenu.title"}),header:(0,C.jsx)(Le,{tab:a,resolved:l,unresolved:d}),right:(0,C.jsx)(Pe.DoneMenuText,{}),onClickRight:Se.LZ,whiteBackground:!0}:{menuType:x.og.Popup,header:(0,C.jsx)(Le,{tab:a,resolved:l,unresolved:d}),width:480,maxHeight:"50vh",onClickOutside:Se.LZ},(0,C.jsx)(Ce.Z,{capture:!0,preventType:ke.Z.All,children:(0,C.jsx)(Ie.Z,{capture:!0,allowMobileAutoScroll:!0,render:()=>(0,C.jsx)(Ze.Z,{debugName:"BlockDiscussionMenu",capture:!0,onEsc:Se.LZ,onBackspace:De,onDelete:De,children:(0,C.jsx)(Fe.Z,{store:s,droppable:!0,render:()=>(0,C.jsx)(h.Z,{...u,children:(0,C.jsx)(Ne,{tab:a,blockStore:s,resolved:l,unresolved:d})})},s.id)})})})};function Oe(e){let{message:t}=e;const s=(0,se.Fg)(),n=(0,i.O7)(),{device:o}=n;return(0,C.jsx)("div",{style:{textAlign:"center",padding:o.isMobile?"64px 18px":"32px 18px 36px",fontSize:14,color:s.mediumTextColor},children:t})}function Be(e){const t=Me.Z.state;t.open&&Me.Z.setState({...t,tab:_e[e]})}function De(e){null==e||e.preventDefault(),Se.LZ()}function Le(e){let{tab:t,resolved:s,unresolved:n}=e;const o=(0,i.O7)(),{device:a}=o,r=n.length,l=s.length;return 0===l||0===r?null:(0,C.jsx)(Ae.Z,{tabs:[(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Open ({numberOfOpenDiscussions})",id:"blockDiscussionMenu.openDiscussionsTab.title",values:{numberOfOpenDiscussions:r}},"openDiscussions"),(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Resolved ({numberOfResolvedDiscussions})",id:"blockDiscussionMenu.resolvedDiscussionsTab.title",values:{numberOfResolvedDiscussions:l}},"resolvedDiscussions")],selectedIndex:_e.indexOf(t),onChange:Be,style:{...a.isAndroid&&{borderBottom:"none"}}})}function Ve(e){const{value:t}=(0,A.useDependency)(l.Av);return t?(0,C.jsx)(C.Fragment,{children:e.discussionStores.map(((s,n,i)=>(0,C.jsx)(l.gU,{store:s,format:t.discussionHelpers.DiscussionFormat.Menu,isFirst:0===n,isOnly:1===i.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:e.blockStore,onDismiss:Se.LZ},s.id)))}):null}function Ne(e){let{tab:t,blockStore:s,resolved:a,unresolved:r}=e;const d=(0,se.Fg)(),c=(0,i.O7)(),{device:u}=c,p=(0,o.VK)((()=>s.getType()),[s]),m=(0,o.VK)((()=>Te.h(s)),[s]),{value:g}=(0,A.useDependency)(l.Av);if(!g)return null;if(t===Me.u.Open){if(r.length){const e=p&&je.p2[p];return u.isMobile&&e&&m?(0,C.jsxs)(n.Fragment,{children:[(0,C.jsx)("div",{style:{padding:"12px 16px",boxShadow:`0 1px 0 ${d.regularDividerColor}`,marginBottom:1},children:(0,C.jsx)(m,{store:s,disabled:!0,hideContent:!0,style:{fontSize:14,pointerEvents:"none"},isQuickFind:!0})}),(0,C.jsx)(Ve,{discussionStores:r,blockStore:s})]}):(0,C.jsx)(Ve,{discussionStores:r,blockStore:s})}return(0,C.jsx)(Oe,{message:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"No comments to show.",id:"blockDiscussionMenu.emptyState.noCommentsMessage"})})}return a.length?(0,C.jsx)(Ve,{discussionStores:a,blockStore:s}):(0,C.jsx)(Oe,{message:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"No resolved comments.",id:"blockDiscussionMenu.emptyState.noResolvedCommentsMessage"})})}const Ee=function(){const e=(0,i.O7)(),{device:t}=e,s=(0,o.VK)((()=>Me.Z.state.rect),[]),a=(0,o.VK)((()=>!(0,be.Sx)(e)&&Me.Z.state.open&&!(0,ve.az)(e,Me.Z.state.blockStore)),[e]),r=(0,n.useCallback)((()=>{if(Me.Z.state.open&&!(0,be.Sx)(e))return(0,C.jsx)(Re,{rect:Me.Z.state.rect,tab:Me.Z.state.tab,blockStore:Me.Z.state.blockStore,discussionIds:Me.Z.state.discussionIds,recursivelyLoadAllDiscussions:Me.Z.state.recursivelyLoadAllDiscussions})}),[e]);return(0,C.jsx)(f.ZP,{popupType:t.isMobile?f.ZP.PopupType.SlideUp:f.ZP.PopupType.Popup,open:a,originRect:s,placementToOrigin:f.ZP.Placement.Bottom,alignmentToOrigin:f.ZP.Alignment.Center,disableMouseCapture:!0,originGap:4,render:r,preventScaleTransition:!0,preventOpacityTransition:!0,onDismiss:Se.LZ})};s(57658);var Ue=s(26249),We=s(79554),Ke=s(43250),ze=s(33929),qe=s(61207),Ge=s(27724),He=s(52275),Ye=s(32163),Qe=s(72495);const $e=(0,oe.defineMessages)({createTransclusion:{defaultMessage:"Paste and sync",id:"blockPasteMenu.actions.createTransclusion.title"},linkToPage:{defaultMessage:"Link to page",id:"blockPasteMenu.actions.linkToPage.title"},dismissItem:{defaultMessage:"Dismiss",id:"blockPasteMenu.actions.dismiss.title"}});const Je=function(){const e=(0,i.Fy)(),t=(0,o.VK)((()=>qe.Z.state),[]),s=(0,o.VK)((()=>Ge.default.state),[]);return(0,n.useEffect)((()=>{if(t.open){const{stores:e,phase:n}=s;(0,Ue.Z)(e,t.blocks)&&n===Ge.SelectionPhase.Selected||We.xv()}}),[t,s]),(0,C.jsx)(f.ZP,{popupType:e.isMobileNative&&!e.isTablet?f.ZP.PopupType.SlideUp:f.ZP.PopupType.Popup,open:t.open,originRect:t.open?t.rect:void 0,placementToOrigin:f.ZP.Placement.Bottom,alignmentToOrigin:f.ZP.Alignment.End,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:()=>(0,C.jsx)(et,{}),onDismiss:Xe})};function Xe(){We.xv()}function et(){const e=(0,i.O7)(),{device:t}=e,s=(0,o.VK)((()=>{const t=qe.Z.state;return t.open?function(e,t){const{blocks:s}=e,{currentSpaceStore:n}=E.default.state,i=[];if("blocks"===e.type){const{copiedStores:o,pageSource:a}=e;We.H8({currentSpaceId:null==n?void 0:n.id,blocks:s,copiedStores:o})&&i.push({name:ze.default.formatMessage($e.createTransclusion),action:async()=>{await We.ry({environment:t,blocks:s,copiedBlockIds:o.map((e=>e.id))})}}),We.wK({blocks:s})&&i.push({name:ze.default.formatMessage($e.linkToPage),action:async()=>We.Dq({environment:t,blocks:s,source:{type:"blocks",copiedStores:o,pageSource:a}})})}return"links"===e.type&&i.push({name:ze.default.formatMessage($e.linkToPage),action:async()=>We.Dq({environment:t,blocks:s,source:{type:"links",copiedLinks:e.copiedLinks}})}),[{key:"embed section",render:e=>(0,C.jsx)(Qe.Z,{...e}),items:[{key:"dismiss",render:e=>(0,C.jsx)(He.Z,{...e,title:ze.default.formatMessage($e.dismissItem)}),action:Xe},...i.map((e=>{let{name:t,action:s}=e;return{key:`embed ${t}`,render:e=>(0,C.jsx)(He.Z,{...e,title:t}),action:s}}))]}]}(t,e):null}),[e]);if(null===s)return null;let n;return n=t.isMobile?{menuType:x.og.ActionSheet}:{menuType:x.og.Popup,width:320,maxHeight:"40vh"},(0,C.jsx)(h.Z,{...n,className:Ke.srZ,children:(0,C.jsx)(Ye.Z,{type:Ye.i.Vertical,sections:s,initialFocus:0})})}var tt=s(87143),st=s(74194),nt=s(64369);const it=function(){const e=(0,i.O7)(),{device:t}=e,{active:s,stringValue:n}=(0,o.VK)((()=>tt.Z.state),[]),a=window.innerWidth/2-150,r=window.innerHeight/2,l=t.isMobileNative?(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Tap to copy the link above",id:"clipboardInputRenderer.copyLink.mobile_message"}):(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Right click and copy the link above",id:"clipboardInputRenderer.copyLink.message"});return(0,C.jsx)(f.ZP,{popupType:t.isMobileNative?f.ZP.PopupType.SlideUp:f.ZP.PopupType.Popup,open:s,originRect:{top:r,left:a},onDismiss:ot,placementToOrigin:f.ZP.Placement.Bottom,alignmentToOrigin:f.ZP.Alignment.Start,originGap:0,render:()=>(0,C.jsx)(Ze.Z,{debugName:"ClipboardInputRenderer",capture:!0,onEnter:u.yR,onCommandEnter:u.yR,onCommandShiftEnter:u.yR,onCommandSlash:u.yR,onDelete:u.yR,onBackspace:u.yR,onEsc:u.yR,onLeft:u.yR,onRight:u.yR,onUntab:u.yR,onTab:u.yR,onSelectAll:u.yR,onRedo:u.yR,onUndo:u.yR,onToggleBold:u.yR,onToggleItalics:u.yR,onToggleStrike:u.yR,onToggleCode:u.yR,onCut:u.yR,onCopy:u.yR,onPaste:u.yR,onKeypress:u.yR,children:(0,C.jsxs)("div",{style:{padding:8,width:300},children:[(0,C.jsx)(st.Z,{style:{width:"100%",fontSize:12},value:n,focus:!0,textarea:!0,selectAll:!0,readOnly:!0}),(0,C.jsx)(nt.Z,{isSmall:!0,style:{marginTop:6,pointerEvents:"none"},children:l})]})})})};function ot(){tt.Z.setState({...tt.Z.state,active:!1,stringValue:""})}var at=s(11977),rt=s(14131),lt=s(7337),dt=s(40506),ct=s(82798),ut=s(67133),pt=s(993),mt=s(28020),gt=s(28748);const ht=function(){const e=(0,i.O7)(),{device:t}=e,s=(0,o.VK)((()=>gt.Z.state),[]);return(0,C.jsx)(f.ZP,{popupType:t.isMobile?f.ZP.PopupType.SlideUp:f.ZP.PopupType.Popup,open:s.open,originRect:s.originRect,onDismiss:ut.x,render:()=>(0,C.jsx)(ft,{shouldShowReminder:!!s.open&&s.allowReminders})})};function ft(e){let{shouldShowReminder:t}=e;const s=(0,i.O7)(),n=(0,o.VK)((()=>xt()),[]);if(!n)return null;const a="default",{date_format:r,time_format:l,dateValue:d}=n;return(0,C.jsx)(A.DependencyConsumer,{dependency:A.deps.menus,children:e=>{let{DatePropertyMenu:n}=e;return(0,C.jsx)(n,{firstDayOfWeek:mt.AK.state,value:d,canConfigureCollection:!0,onChangeValue:e=>function(e,t,s){if(!e)return void function(e,t){const s=xt();if(!s)return;const{textStore:n,textValue:i,tokenIndex:o}=s,a=c.VrM(i.slice(0,o)),r=c.VrM(i.slice(0,o+1));g.createAndCommit({userAction:"DateMentionMenu.removeDateAnnotation",environment:e,perform:s=>{pt.pe({environment:e,store:n,selection:{startIndex:a,endIndex:r},transaction:s,editorMode:t})}})}(t,s);if(!dt.U3(e))return;const n=xt();if(!n)return;const{date_format:i,time_format:o}=n;yt({date_format:i,time_format:o,...e},t,s)}(e,s,a),dateFormat:r,onChangeDateFormat:e=>function(e,t,s){const n=xt();if(!n)return;const{dateValue:i,time_format:o}=n;yt({date_format:e,time_format:o,...i},t,s)}(e,s,a),timeFormat:l,onChangeTimeFormat:e=>function(e,t,s){const n=xt();if(!n)return;const{dateValue:i,date_format:o}=n;yt({date_format:o,time_format:e,...i},t,s)}(e,s,a),onDismiss:ut.x,disabled:!1,shouldShowReminder:t,isTemplatePage:!1})}})}function xt(){const e=gt.Z.state;if(e.open){const{textStore:t,tokenIndex:s}=e,n=t.getValue();if(n){const e=n[s];if(e){(0,ct.T)(c.km_(e),"Token should be a mention token");const i=c.hDy(e),o=c.K9C(i);if(o){const{date_format:a,time_format:r,...l}=c.zyO(o);return{textStore:t,textValue:n,tokenIndex:s,token:e,annotations:i,date_format:a,time_format:r,dateValue:l}}}}}}function yt(e,t,s){const n=xt();if(!n)return;const{textStore:i,textValue:o,tokenIndex:a,token:r,annotations:l}=n,d=l.map((t=>c.fpG(t)?["d",e]:t)),u=c.V3y(r[0],d),p=c.VrM(o.slice(0,a)),m=c.VrM(o.slice(0,a+1));g.createAndCommit({userAction:"DateMentionMenu.setDateAnnotationData",environment:t,perform:e=>{pt.pe({environment:t,store:i,selection:{startIndex:p,endIndex:m},transaction:e,editorMode:s}),pt.mM({environment:t,store:i,tokens:[u],index:p,transaction:e})}})}s(30541);var St=s(50475),vt=s(95538),bt=s(99405),Mt=s(21202),jt=s(19584),Ct=s(88864),wt=s(89951),kt=s(95477),Tt=s(64233),It=s(6258);const Zt=(0,oe.defineMessages)({image:{defaultMessage:"Embed image",id:"embedMenu.action.image"},video:{defaultMessage:"Embed video",id:"embedMenu.action.video"},tweet:{defaultMessage:"Embed Tweet",id:"embedMenu.action.tweet"},drive:{defaultMessage:"Embed Google Drive",id:"embedMenu.action.drive"},gist:{defaultMessage:"Embed GitHub Gist",id:"embedMenu.action.gist"},figma:{defaultMessage:"Embed Figma",id:"embedMenu.action.figma"},invision:{defaultMessage:"Embed Invision project",id:"embedMenu.action.invision"},abstract:{defaultMessage:"Embed Abstract project",id:"embedMenu.action.abstract"},framer:{defaultMessage:"Embed Framer prototype",id:"embedMenu.action.framer"},whimsical:{defaultMessage:"Embed Whimsical board",id:"embedMenu.action.whimsical"},mixpanel:{defaultMessage:"Embed Mixpanel project",id:"embedMenu.action.mixpanel"},sketch:{defaultMessage:"Embed Sketch document",id:"embedMenu.action.sketch"},excalidraw:{defaultMessage:"Embed excalidraw",id:"embedMenu.action.excalidraw"},replit:{defaultMessage:"Embed a repl",id:"embedMenu.action.replit"},miro:{defaultMessage:"Embed Miro board",id:"embedMenu.action.miro"},audio:{defaultMessage:"Embed audio",id:"embedMenu.action.audio"},maps:{defaultMessage:"Embed Google Map",id:"embedMenu.action.maps"},loom:{defaultMessage:"Embed Loom",id:"embedMenu.action.loom"},typeform:{defaultMessage:"Embed Typeform",id:"embedMenu.action.typeform"},codepen:{defaultMessage:"Embed CodePen",id:"embedMenu.action.codepen"},pdf:{defaultMessage:"Embed PDF",id:"embedMenu.action.pdf"},embed:{defaultMessage:"Create embed",id:"embedMenu.action.createEmbed"},hex:{defaultMessage:"Embed Hex",id:"embedMenu.action.hex"},deepnote:{defaultMessage:"Embed Deepnote",id:"embedMenu.action.deepnote"},drawing:{defaultMessage:"Embed a drawing",id:"embedMenu.action.drawing"}}),Pt=(0,oe.defineMessages)({linkToPage:{defaultMessage:"Link to page",id:"embedMenu.actions.linkToPage.title"},mentionPage:{defaultMessage:"Mention page",id:"embedMenu.actions.mentionPage.title"},mentionBlock:{defaultMessage:"Mention block",id:"embedMenu.actions.mentionBlock.title"},createLinkedDatabase:{defaultMessage:"Create linked database",id:"embedMenu.actions.createLinkedDatabase.title"},createLinkedViewOfDatabase:{defaultMessage:"Create linked view of database",id:"embedMenu.actions.createLinkedViewOfDatabase.title"},bookmarkMenuItem:{defaultMessage:"Create bookmark",id:"embedMenu.actions.createBookmark.title"},createTransclusionItem:{defaultMessage:"Paste and sync",id:"embedMenu.actions.createTransclusion.title"},dismissItem:{defaultMessage:"Dismiss",id:"embedMenu.actions.dismiss.title"}}),Ft={image:ze.default.formatMessage(Zt.image),video:ze.default.formatMessage(Zt.video),tweet:ze.default.formatMessage(Zt.tweet),drive:ze.default.formatMessage(Zt.drive),gist:ze.default.formatMessage(Zt.gist),figma:ze.default.formatMessage(Zt.figma),invision:ze.default.formatMessage(Zt.invision),abstract:ze.default.formatMessage(Zt.abstract),framer:ze.default.formatMessage(Zt.framer),whimsical:ze.default.formatMessage(Zt.whimsical),mixpanel:ze.default.formatMessage(Zt.mixpanel),miro:ze.default.formatMessage(Zt.miro),sketch:ze.default.formatMessage(Zt.sketch),excalidraw:ze.default.formatMessage(Zt.excalidraw),replit:ze.default.formatMessage(Zt.replit),audio:ze.default.formatMessage(Zt.audio),maps:ze.default.formatMessage(Zt.maps),loom:ze.default.formatMessage(Zt.loom),typeform:ze.default.formatMessage(Zt.typeform),codepen:ze.default.formatMessage(Zt.codepen),pdf:ze.default.formatMessage(Zt.pdf),embed:ze.default.formatMessage(Zt.embed),hex:ze.default.formatMessage(Zt.hex),deepnote:ze.default.formatMessage(Zt.deepnote),drawing:ze.default.formatMessage(Zt.drawing)};const At=function(){const e=(0,i.O7)(),t=(0,i.Fy)(),s=(0,o.VK)((()=>Tt.Z.state),[]),a=(0,o.VK)((()=>v.default.state),[]);return(0,n.useEffect)((()=>{if(s.open&&"editing"===a.mode){const{multiSelection:e}=a;(0,y.qS)(e)&&e.start.store.id===s.textStore.id&&e.end.index===s.urlSelection.endIndex||wt.xv()}}),[s,a]),(0,C.jsx)(f.ZP,{popupType:t.isMobileNative&&!t.isTablet?f.ZP.PopupType.SlideUp:f.ZP.PopupType.Popup,open:s.open,originRect:s.open?s.selectionRect:void 0,placementToOrigin:f.ZP.Placement.Bottom,alignmentToOrigin:f.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:t.isMobile,keepFocus:t.isMobile,render:()=>(0,C.jsx)(Bt,{}),onDismiss:()=>_t(e)})};function _t(e){const t=Tt.Z.state;if(!t.open)return;const{url:s}=t;Ct.X0(e,{url:s,type:"close"}),wt.xv()}function Rt(e,t){const{device:s}=t,{url:n,textStore:i}=e,{currentSpaceStore:o}=E.default.state,a=[],r=(0,bt.Wj)({url:n,baseUrl:kt.default.domainBaseUrl,publicDomainName:kt.default.publicDomainName,isMobile:s.isMobile,protocol:kt.default.protocol,currentUrl:window.location.href});if("page"===r.name){const e=It.G.createChildStore(i,{table:Mt.iU,id:r.blockId}),t=r.scrollToBlockId?It.G.createChildStore(i,{table:Mt.iU,id:r.scrollToBlockId}):void 0;a.push({name:ze.default.formatMessage(Pt.createLinkedViewOfDatabase),validator:()=>!t&&e.isCollectionView()&&!wt.f_(i)&&(!e.isCollectionViewPageWithContent()||!function(e,t){const s=e.getCollectionViewStores(),n=u.sE(s,(e=>e.id===t&&"page"===e.getType()));return Boolean(n)}(e,r.collectionViewId))&&(null==o?void 0:o.id)===e.getSpaceId()&&Ot(e),type:je.Ti.collectionView}),a.push({name:ze.default.formatMessage(void 0===t?Pt.mentionPage:Pt.mentionBlock),validator:()=>Ot(e),type:"mention-page"}),a.push({name:ze.default.formatMessage(Pt.createTransclusionItem),validator:()=>Boolean(t&&!t.isNavigableBlock()&&!wt.f_(i)&&!t.isNonEditableState()&&!t.isNavigableAncestorNonEditableState()&&t.canEdit()&&t.getSpaceId()===(null==o?void 0:o.id)&&Ot(e)),type:"create-transclusion"}),a.push({name:ze.default.formatMessage(Pt.linkToPage),validator:()=>!t&&!e.isCollectionView()&&!wt.f_(i)&&Ot(e),type:je.Ti.page})}const l=jt.XP(Ft);for(const u of l)"embed"!==u&&a.push({name:Ft[u],validator:vt.Wb[u],type:u});a.push({name:ze.default.formatMessage(Pt.bookmarkMenuItem),validator:e=>!wt.f_(i)&&vt.Cm(e),type:je.Ti.bookmark}),a.push({name:Ft.embed,validator:e=>!wt.f_(i)&&vt.Wb.embed(e),type:"embed"});const d=u.oA(a.map((e=>{let{name:s,validator:i,type:o}=e;if(i({url:n,baseUrl:kt.default.domainBaseUrl,publicDomainName:kt.default.publicDomainName})){const e={key:`embed ${s}`,render:e=>(0,C.jsx)(He.Z,{...e,title:s}),action:()=>function(e,t){const s=Tt.Z.state;if(!s.open)return;const{url:n}=s;wt.RL({environment:t,type:e}),Ct.X0(t,{url:n,type:e})}(o,t)};return e}}))),c={key:"dismiss",render:e=>(0,C.jsx)(He.Z,{...e,title:ze.default.formatMessage(Pt.dismissItem)}),action:()=>_t(t)};if(0===d.length)return[];"page"===r.name?d.push(c):d.unshift(c);return[{key:"embed section",render:e=>(0,C.jsx)(Qe.Z,{...e}),items:d}]}function Ot(e){const t=e.getSystemBlockTypeStore().getValue();return!(0,St.bv)(t)}function Bt(){const e=(0,i.O7)(),{device:t}=e,s=(0,o.VK)((()=>{const t=Tt.Z.state;return t.open?Rt(t,e):null}),[e]),a=(null==s?void 0:s.length)??0;if((0,n.useEffect)((()=>{0===a&&wt.xv()}),[a]),null===s)return null;let r;return r=t.isMobile?{menuType:x.og.ActionSheet}:{menuType:x.og.Popup,width:320,maxHeight:"40vh"},(0,C.jsx)(h.Z,{...r,className:Ke.srZ,children:(0,C.jsx)(Ye.Z,{type:Ye.i.Vertical,sections:s,initialFocus:0})})}var Dt=s(49085),Lt=s(43593),Vt=s(37652),Nt=s(33907),Et=s(45238);const Ut=(0,Et.IU)("collapse",{viewBox:"0 0 16 16",svg:(0,C.jsx)("path",{d:"M2.477 7.51h3.787c.396 0 .701-.106.916-.32.214-.22.321-.525.321-.917V2.534a.723.723 0 00-.745-.745.731.731 0 00-.54.212.736.736 0 00-.205.533v.486l.15 2.146-1.6-1.682-1.968-1.982a.695.695 0 00-.52-.219.791.791 0 00-.574.219.736.736 0 00-.219.554.78.78 0 00.055.294.917.917 0 00.17.253L3.482 4.57l1.675 1.593-2.153-.143h-.526a.723.723 0 00-.746.745.723.723 0 00.746.745zm6.74 6.912a.71.71 0 00.526-.212.7.7 0 00.212-.526v-.554l-.143-2.14 1.6 1.682 2.002 2.016a.69.69 0 00.526.22c.224 0 .41-.074.561-.22a.725.725 0 00.226-.553.707.707 0 00-.062-.294.728.728 0 00-.164-.246l-2.01-2.017-1.688-1.586 2.16.144h.588a.736.736 0 00.533-.205.711.711 0 00.219-.534.72.72 0 00-.219-.54.723.723 0 00-.533-.211H9.702c-.392 0-.697.109-.916.328-.214.214-.321.517-.321.909v3.8a.7.7 0 00.212.527.746.746 0 00.54.212z"})});var Wt=s(64330),Kt=s(80342),zt=s(47453),qt=s(70279),Gt=s(51454),Ht=s(31701),Yt=s(36610),Qt=s(54604),$t=s(42858),Jt=s(24677),Xt=s(17504),es=s(58202),ts=s(38302),ss=s(23063),ns=s(68785),is=s(4827),os=s(89728);const as={background:"rgba(255, 255, 255, 0.055)"},rs={padding:"6px 10px 6px 6px"},ls={padding:"6px 6px 6px 10px"},ds={display:"flex",borderRadius:4,background:Ht.ZP.blackWithAlpha(.65)},cs=.5,us=.5,ps=-.002,ms=-.004;class gs extends d.Z{constructor(){var e;super(...arguments),e=this,this.isListeningToWheel=!1,this.hideControlsTimeout=void 0,this.isMovingToPrevOrNextTimeout=void 0,this.isEditingZoom=Dt.default.createValue(!1),this.contentDimensions=Dt.default.createValue(void 0),this.showControls=Dt.default.createValue(!1),this.responsiveSettings=this.createComputedStore((()=>{const e=this.environment.WindowSizeStore.state.width;return{edgePadding:Qt.zp(e),backgroundOpacity:.8}})),this.renderOverlay=()=>{const{isOpen:e,renderFullScreenNode:t,fullScreenNodeRect:s,contentAspectRatio:n,zoomScale:i,panOffset:o,skipAnimations:a}=ts.Z.state;e&&!this.isListeningToWheel?(window.addEventListener("wheel",this.handleWheel,{passive:!1}),this.isListeningToWheel=!0):!e&&this.isListeningToWheel&&(window.removeEventListener("wheel",this.handleWheel),this.isListeningToWheel=!1);const{edgePadding:r,backgroundOpacity:l}=this.responsiveSettings.state,d=window.innerWidth,c=window.innerHeight-2*r;let p=d-2*r;const m=n??(s?s.width/s.height:void 0);if(void 0===m)return;let g=p/m;if(g>c){const e=g/c;g/=e,p/=e}const h={opacity:0},f={scale:i,opacity:1,translateX:o.x,translateY:o.y,width:"100%",height:"100%"};let x,y;return t&&(x=t()),y=this.showControls.state?i>=1.5?"zoom-out":"zoom-in":"none",(0,Xt.Z)((t=>(0,C.jsx)(Ze.Z,{debugName:"FullScreenRenderer",capture:e,onEsc:()=>{this.handleClose(!0)},onEnter:u.yR,onSpace:()=>this.handleClose(!0),onCommandEnter:()=>this.handleClose(!0),onCommandShiftEnter:u.yR,onCommandSlash:u.yR,onUp:u.yR,onDown:u.yR,onDelete:u.yR,onBackspace:u.yR,onLeft:()=>this.handlePrevious(!0),onRight:()=>this.handleNext(!0),onUntab:u.yR,onTab:u.yR,onSelectAll:u.yR,onRedo:u.yR,onUndo:u.yR,onToggleBold:u.yR,onToggleItalics:u.yR,onToggleStrike:u.yR,onToggleCode:u.yR,onCut:u.yR,onCopy:u.yR,onPaste:u.yR,onKeypress:this.handleKeypress,children:(0,C.jsx)(Ce.Z,{capture:e,preventType:ke.Z.All,children:(0,C.jsxs)("div",{style:this.getStyle({isOpen:e}),...t,onClick:this.handleBackgroundClick,onMouseMove:this.resetHideControlsTimeout,children:[(0,C.jsx)(ss.Z,{isVisible:e,enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},animationStyle:{opacity:l},render:()=>(0,C.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:Ht.ZP.black}}),onAnimationEnd:Ts}),(0,C.jsx)(ss.Z,{isVisible:e,enterAnimationStyle:h,exitAnimationStyle:h,animationStyle:f,skipAnimation:a,forceTransformStyle:!0,render:()=>(0,C.jsx)("div",{style:{display:"flex",cursor:y,maxWidth:p,maxHeight:g,justifyContent:"center"},ref:e=>{e&&this.contentDimensions.setState({width:e.clientWidth,height:e.clientHeight})},onClick:this.handleContentClick,onMouseDown:Zs,onMouseUp:Ps,onMouseLeave:Ps,onMouseMove:this.handleMouseMove,children:x}),onAnimationEnd:Is}),this.renderBottomBar()]})})})))},this.clearHideControlsTimeout=()=>{this.hideControlsTimeout&&clearTimeout(this.hideControlsTimeout)},this.resetHideControlsTimeout=()=>{const{isSaving:e}=ts.Z.state;this.showControls.setState(!0),this.clearHideControlsTimeout(),this.isEditingZoom.state||e||(this.hideControlsTimeout=setTimeout((()=>this.showControls.setState(!1)),2e3))},this.enableZoomEditing=()=>{this.isEditingZoom.setState(!0),this.clearHideControlsTimeout()},this.disableZoomEditing=()=>{this.isEditingZoom.setState(!1),this.resetHideControlsTimeout()},this.handleBackgroundClick=e=>{(0,P.uG)(e)||this.handleClose()},this.handleContentClick=e=>{const{zoomScale:t,panOffset:s}=ts.Z.state;if(e.stopPropagation(),(0,P.uG)(e))return;let n,i;n=t<1?1:t<1.5?1.5:1,i=n<=1?{x:0,y:0}:this.clampPanOffset({x:(window.innerWidth/2-e.clientX)/(n/(n-1)),y:(window.innerHeight/2-e.clientY)/(n/(n-1))})??s,ts.Z.setState({...ts.Z.state,zoomScale:n,panOffset:i}),this.resetHideControlsTimeout(),this.disableZoomEditing()},this.handleClose=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Qt.xv(),e.resetControls(),Yt.Lf(e.environment,{type:"close",triggered_by:t?"keypress":"click"}),Jt.ZH(e.environment),Ps()},this.handleResize=()=>{const{isOpen:e}=ts.Z.state;e&&this.enqueueForceUpdate()},this.handlePrevious=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.moveToImageOffset(-1,t)},this.handleNext=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.moveToImageOffset(1,t)},this.handleZoomInputSubmit=e=>{const t=e.target,s=parseInt(t.value);if(!isNaN(s)){const e=s/100;Yt.Lf(this.environment,{type:"set_zoom",new_zoom:e}),this.setZoomScale(e)}this.disableZoomEditing()},this.handleZoomOut=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{zoomScale:s}=ts.Z.state;let n=Math.ceil(2*(s-cs))/2;s-n<.25&&(n-=cs),Yt.Lf(e.environment,{type:"zoom_out",new_zoom:n,triggered_by:t?"keypress":"click"}),e.setZoomScale(n)},this.handleZoomIn=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{zoomScale:s}=ts.Z.state;let n=Math.floor(2*(s+cs))/2;n-s<.25&&(n+=cs),Yt.Lf(e.environment,{type:"zoom_in",new_zoom:n,triggered_by:t?"keypress":"click"}),e.setZoomScale(n)},this.addDeltaToZoomScale=e=>{const{zoomScale:t}=ts.Z.state;this.setZoomScale(t+e)},this.setZoomScale=e=>{const{panOffset:t}=ts.Z.state;this.resetHideControlsTimeout();const s=Math.max(Math.min(e,2),us),n=s<=1?{x:0,y:0}:t;ts.Z.setState({...ts.Z.state,zoomScale:s,panOffset:n})},this.handleWheel=e=>{const{isOpen:t,panOffset:s}=ts.Z.state;t&&(e.preventDefault(),e.ctrlKey?e.deltaY?this.addDeltaToZoomScale(e.deltaY*ms):e.deltaX&&this.addDeltaToZoomScale(e.deltaX*ms):e.metaKey?e.deltaY?this.addDeltaToZoomScale(e.deltaY*ps):e.deltaX&&this.addDeltaToZoomScale(e.deltaX*ps):ys()&&this.setPanOffset({x:s.x-e.deltaX,y:s.y-e.deltaY}))},this.handleMouseMove=e=>{const{panStartPosition:t,zoomScale:s}=ts.Z.state;this.contentDimensions.state&&1===e.buttons&&ys()&&this.setPanOffset({x:e.clientX/s-t.x,y:e.clientY/s-t.y})},this.handleDownload=e=>{const{block:t,imageUrl:s}=ts.Z.state;if(!t||!Ss())return;ts.Z.setState({...ts.Z.state,isSaving:!0}),this.clearHideControlsTimeout();const n=null==t?void 0:t.getProperties();let i;if(i=s||c.QaF(null==n?void 0:n.source),!i)return;const o=c.QaF(null==n?void 0:n.caption);(0,Lt.GN)(i,null==t?void 0:t.pointer,kt.default.domainBaseUrl,this.environment.currentUser.id,o).then((()=>{ts.Z.setState({...ts.Z.state,isSaving:!1}),Yt.Lf(this.environment,{type:"download",triggered_by:"click"}),this.resetHideControlsTimeout()}))},this.handleKeypress=e=>{switch(e.key){case"+":case"=":this.handleZoomIn(!0);break;case"-":case"_":this.handleZoomOut(!0)}}}didMount(){super.didMount(),window.addEventListener("resize",this.handleResize)}willUnmount(){super.willUnmount(),window.removeEventListener("resize",this.handleResize),window.removeEventListener("wheel",this.handleWheel),this.isListeningToWheel=!1}renderComponent(){const{isOpen:e,fullscreenNodeAnimationComplete:t,backgroundAnimationComplete:s}=ts.Z.state;return(0,C.jsx)(is.Z,{open:e||!t||!s,children:this.renderOverlay()})}renderBottomBar(){const{isOpen:e}=ts.Z.state;if(!this.environment.device.isMobile)return(0,C.jsx)(ss.Z,{isVisible:this.showControls.state,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},animationStyle:{opacity:1},render:()=>(0,C.jsxs)("div",{style:vs(e),onClick:e=>{!function(e){e.stopPropagation()}(e),this.resetHideControlsTimeout(),this.disableZoomEditing()},children:[(0,C.jsx)("div",{style:{...ds,marginRight:10},children:this.renderPrevNextButtons()}),(0,C.jsxs)("div",{style:ds,children:[this.renderZoomControls(),(0,C.jsx)(ks,{}),Ss()?(0,C.jsxs)(C.Fragment,{children:[this.renderDownloadButton(),(0,C.jsx)(ks,{})]}):void 0,this.renderCloseButton()]})]})})}renderZoomControls(){const{zoomScale:e}=ts.Z.state,t=(100*e).toFixed(0);return(0,C.jsxs)("div",{style:{alignItems:"center",display:"flex",height:"100%",justifySelf:"flex-start"},children:[(0,C.jsx)(ge.ZP,{renderTooltip:()=>(0,C.jsx)(ws,{primaryText:(0,C.jsx)(oe.FormattedMessage,{id:"fullScreenRenderer.zoomOut",defaultMessage:"Zoom out"}),secondaryText:"-"}),disableTooltip:e<=us,render:t=>(0,C.jsx)(os.Z,{...t,disabled:e<=us,style:{...js(e<=us),...ls},onClick:()=>this.handleZoomOut(),icon:e=>(0,Kt.$)({...e,fill:bs(),height:16,margin:0,width:16})})}),this.isEditingZoom.state?(0,C.jsx)(hs,{initialValue:t,onSubmit:this.handleZoomInputSubmit,onCancel:this.disableZoomEditing,primaryColor:bs(),secondaryColor:Ms()}):(0,C.jsx)(os.Z,{onClick:e=>{e.stopPropagation(),this.enableZoomEditing()},style:{color:Ms(),margin:0,width:46,padding:0,justifyContent:"center"},children:`${t}%`}),(0,C.jsx)(ge.ZP,{renderTooltip:()=>(0,C.jsx)(ws,{primaryText:(0,C.jsx)(oe.FormattedMessage,{id:"fullScreenRenderer.zoomIn",defaultMessage:"Zoom in"}),secondaryText:"+"}),disableTooltip:e>=2,render:t=>(0,C.jsx)(os.Z,{...t,disabled:e>=2,style:js(e>=2),onClick:()=>this.handleZoomIn(),icon:e=>(0,zt.R)({...e,fill:bs(),height:16,margin:0,width:16})})})]})}renderPrevNextButtons(){const{block:e}=ts.Z.state,t=(0,C.jsx)("div",{});if(!e)return t;const s=xs();if(s.length<=1)return t;const n=s.findIndex((t=>t.id===(null==e?void 0:e.id)))??-1;if(-1===n)return t;const i=s.length;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(ge.ZP,{renderTooltip:()=>(0,C.jsx)(ws,{primaryText:(0,C.jsx)(oe.FormattedMessage,{id:"fullScreenRenderer.previous",defaultMessage:"Back"}),secondaryText:(0,C.jsx)(Cs,{imageIndex:n-1,totalImageCount:i})}),disableTooltip:0===n,render:e=>(0,C.jsx)(os.Z,{...e,disabled:n<=0,style:{...js(n<=0),...ls},hoveredStyle:as,onClick:()=>this.handlePrevious(),icon:e=>(0,Vt.V)({...e,fill:bs(),height:16,margin:0,width:16})})}),(0,C.jsx)(ge.ZP,{renderTooltip:()=>(0,C.jsx)(ws,{primaryText:(0,C.jsx)(oe.FormattedMessage,{id:"fullScreenRenderer.next",defaultMessage:"Next"}),secondaryText:(0,C.jsx)(Cs,{imageIndex:n+1,totalImageCount:i})}),disableTooltip:n+1===i,render:e=>(0,C.jsx)(os.Z,{...e,disabled:n>=i-1,style:{...js(n>=i-1),...rs},hoveredStyle:as,onClick:()=>this.handleNext(),icon:e=>(0,Nt.n)({...e,fill:bs(),height:16,margin:0,width:16})})})]})}renderDownloadButton(){const{isSaving:e}=ts.Z.state;return(0,C.jsx)(ge.ZP,{renderTooltip:()=>(0,C.jsx)(ws,{primaryText:(0,C.jsx)(oe.FormattedMessage,{id:"fullScreenRenderer.download",defaultMessage:"Download"})}),render:t=>(0,C.jsx)(os.Z,{...t,disabled:e,onClick:this.handleDownload,style:js(!1),hoveredStyle:as,children:e?(0,C.jsx)(ns.Z,{style:{width:16}}):(0,Wt.a)({fill:bs(),width:16})})})}renderCloseButton(){return(0,C.jsx)(ge.ZP,{renderTooltip:()=>(0,C.jsx)(ws,{primaryText:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Close",id:"fullscreenRenderer.closeButton.label"}),secondaryText:"esc"}),render:e=>(0,C.jsx)(os.Z,{...e,onClick:()=>this.handleClose(),style:{...js(!1),...rs},hoveredStyle:as,icon:e=>Ut({...e,fill:bs(),height:16,margin:0,width:16})})})}resetControls(){this.isEditingZoom.setState(!1),ts.Z.setState({...ts.Z.state,zoomScale:1,panStartPosition:{x:0,y:0},panOffset:{x:0,y:0}})}clampPanOffset(e){const t=this.contentDimensions.state;if(!t)return;let s,n;s=2*t.width>window.innerWidth?(2*t.width-window.innerWidth)/4:(window.innerWidth-2*t.width)/4,n=2*t.height>window.innerHeight?(2*t.height-window.innerHeight)/4:(window.innerHeight-2*t.height)/4;return{x:Math.min(Math.max(e.x,-1*s),s),y:Math.min(Math.max(e.y,-1*n),n)}}setPanOffset(e){const{panStartPosition:t}=ts.Z.state,s=this.clampPanOffset(e);s&&(e.x!==s.x&&(t.x=t.x+(e.x-s.x)),e.y!==s.y&&(t.y=t.y+(e.y-s.y)),ts.Z.setState({...ts.Z.state,panOffset:s,panStartPosition:t}))}moveToImageOffset(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{block:s}=ts.Z.state;if(!s)return;const n=xs();if(!n)return;const i=n.findIndex((e=>e.id===s.id));if(i+e<0||i+e>=n.length)return;Yt.Lf(this.environment,{type:e>0?"next":"previous",image_count:n.length,image_index:i+e,triggered_by:t?"keypress":"click"}),ts.Z.setState({...ts.Z.state,skipAnimations:!0}),this.isMovingToPrevOrNextTimeout&&clearTimeout(this.isMovingToPrevOrNextTimeout),this.isMovingToPrevOrNextTimeout=setTimeout((()=>{ts.Z.setState({...ts.Z.state,skipAnimations:!1})}),250);const o=n[i+e];$t.dK({blocks:[o]}),this.resetControls()}getStyle(e){const{isOpen:t}=e;return{zIndex:Gt.mJ,position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:t?"auto":"none",cursor:this.showControls.state?void 0:"none"}}}function hs(e){const[t,s]=(0,n.useState)(e.initialValue);return(0,C.jsx)(st.Z,{style:{width:46,color:e.primaryColor},inputStyle:{textAlign:"center",border:"solid 1px rgba(45, 156, 219, 0.72)",borderRadius:4,boxShadow:"0px 0px 0px 3px rgba(45, 156, 219, 0.2)"},onClick:e=>e.stopPropagation(),onChange:e=>{const t=e.target;s(t.value)},value:t,onSubmit:e.onSubmit,focusInitial:!0,selectAll:!0,format:st.B.Transparent,right:(0,C.jsx)("span",{style:{color:e.secondaryColor},children:"%"}),onKeyDown:t=>{t.stopPropagation(),"Escape"===t.key?e.onCancel():"Tab"===t.key&&e.onSubmit(t)}})}gs.displayName="FullScreenRenderer";const fs=gs;function xs(){const{block:e}=ts.Z.state;if(!e)return[];if(function(){const{block:e}=ts.Z.state;return(null==e?void 0:e.getParentTable())===qt.x_??!1}()){return e.getParentStore().getContentStores().filter((e=>"image"===e.getType())).filter((e=>Boolean(e.getProperties().source)))}const t=Ge.default.getCurrentRootStore();return es.R.getMembersByDOMOrder({filter:e=>"image"===e.renderedType&&Boolean(e.getBlockStore().findRecordStoreUIAncestor((e=>Boolean(t&&e===t))).ancestor)}).map((e=>e.getBlockStore())).filter((e=>Boolean(e.getProperties().source)))}function ys(){const{zoomScale:e}=ts.Z.state;return e>1}function Ss(){var e;const{block:t,imageUrl:s}=ts.Z.state;return t&&(s||(null===(e=t.getProperties())||void 0===e?void 0:e.source)&&c.QaF(t.getProperties().source))}function vs(e){return{bottom:30,display:e?"flex":"none",fontSize:14,left:"50%",lineHeight:1.2,position:"absolute",transform:"translate(-50%, 0)"}}function bs(){return Ht.ZP.white}function Ms(){return Ht.ZP.whiteWithAlpha(.5)}function js(e){return{borderRadius:4,opacity:e?.4:1,padding:6}}function Cs(e){let{imageIndex:t,totalImageCount:s}=e;return(0,C.jsx)(oe.FormattedMessage,{values:{currentIndex:t+1,totalCount:s},defaultMessage:"{currentIndex} of {totalCount}",id:"fullscreenRenderer.imageCount.label"})}function ws(e){const{primaryText:t,secondaryText:s}=e;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("span",{style:{marginRight:s?4:void 0},children:t}),s?(0,C.jsx)("span",{style:{color:Ms()},children:s}):void 0]})}function ks(){return(0,C.jsx)("span",{style:{borderLeft:`1px solid ${Ht.ZP.whiteWithAlpha(.25)}`,height:"100%"}})}function Ts(){const{isOpen:e}=ts.Z.state;e||ts.Z.setState({...ts.Z.state,backgroundAnimationComplete:!0})}function Is(){const{isOpen:e}=ts.Z.state;e||ts.Z.setState({...ts.Z.state,fullscreenNodeAnimationComplete:!0})}function Zs(e){const{panOffset:t,zoomScale:s}=ts.Z.state;ts.Z.setState({...ts.Z.state,panStartPosition:{x:e.clientX/s-t.x,y:e.clientY/s-t.y},skipAnimations:!0})}function Ps(){ts.Z.setState({...ts.Z.state,skipAnimations:!1})}var Fs=s(98567),As=s(23867),_s=s(19889),Rs=s(36280),Os=s(73959),Bs=s(89086),Ds=s(66949),Ls=s(3702);const Vs=function(){const e=(0,i.O7)(),t=(0,n.useRef)(null),s=(0,n.useCallback)((s=>function(e,t,s){if(!Ds.Z.isOpen())return;if(!s.current)return;const n=s.current.getSelection();if(!n)return;const i=Ds.Z.state.value.length;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&n.startIndex===i&&n.endIndex===i&&(Us(t),Rs.Wj())}(s,e,t)),[e]),a=(0,n.useCallback)((s=>function(e,t,s){if(!s.current)return;const n=s.current.getSelection();if(!n)return;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&0===n.startIndex&&0===n.endIndex&&(Us(t),Rs.Wj(Ds.P.Backward))}(s,e,t)),[e]),r=(0,n.useCallback)((()=>Us(e)),[e]),l=(0,o.VK)((()=>Ds.Z.state),[]),d=(0,o.VK)((()=>function(){if(!Ds.Z.isOpen())return;return Ds.Z.state.savedTextSelectionRect}()),[]),u=(0,o.VK)((()=>function(){var e;if("editing"!==v.default.state.mode&&!Ds.Z.isOpen())return!0;const t=Ds.Z.isOpen()?null===(e=(0,y.QY)(Ds.Z.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store:void 0;if(t&&!t.canEdit())return!0;if(t){const e=(0,Os.J2)(t);if(e&&e.isNonEditableState())return!0}if(t&&t.table===qt.x_){const e=It.T5.createChildStore(t,{table:qt.x_,id:t.id,spaceId:(0,As.C)(t.pointer.spaceId)}),s=e.isDefined(),{currentUserStore:n}=E.default.state;if(!s||!n)return!0;const i=e.getCreatedByTable(),o=e.getCreatedById();if(i!==_s.KJ||n.id!==o)return!0}const s={[c.GKr.User]:c.GKr.User,[c.GKr.Page]:c.GKr.Page,[c.GKr.Comment]:c.GKr.Comment,[c.GKr.Bot]:c.GKr.Bot,[c.GKr.Date]:c.GKr.Date,[c.GKr.ExternalObjectInstance]:c.GKr.ExternalObjectInstance,[c.GKr.TemporaryPage]:c.GKr.TemporaryPage,[c.GKr.TemplateVariable]:c.GKr.TemplateVariable,[c.GKr.FormulaPageProperty]:c.GKr.FormulaPageProperty,[c.GKr.FormulaContextValue]:c.GKr.FormulaContextValue,[c.GKr.Group]:c.GKr.Group,[c.GKr.Citation]:c.GKr.Citation};for(const n of Object.values(s))if((0,Bs.J6)(n))return!0;return!1}()),[]);if(!l.open)return null;const p=l.value,m=l.error;return(0,C.jsx)(A.DependencyConsumer,{dependency:A.deps.prismjs,children:e=>l.open?(0,C.jsx)(Ls.Z,{Prism:e,ref:t,isOpen:!0,equationValue:p,error:m,displayMode:"inline",disabled:u,originRect:d,originGap:8,onDismiss:Es,onChange:Ns,onSubmit:r,onLeft:a,onRight:s}):null})};function Ns(e,t){Ds.Z.isOpen()&&Ds.Z.setState({...Ds.Z.state,value:e,error:t})}function Es(){Rs.Wj()}function Us(e){g.createAndCommit({userAction:"InlineEquationOverlay.handleSubmit",environment:e,perform:t=>{Rs.gt({environment:e,equationStore:Ds.Z,transaction:t})}})}var Ws=s(73935),Ks=s(96313),zs=s(12457),qs=s(73744),Gs=s(70726),Hs=s(48863);function Ys(e){switch(e){case Gs.Z.Preview:return(0,C.jsx)(oe.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Paste as preview"});case Gs.Z.Mention:return(0,C.jsx)(oe.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Paste as mention"});case Gs.Z.Link:return(0,C.jsx)(oe.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Paste as link"});default:(0,N.t1)(e)}}const Qs=function(){const e=(0,i.O7)(),t=(0,n.useRef)(null),[s]=(0,o.AF)(Hs.Z),a=(0,n.useCallback)((t=>{if(s.open){var n;if(!t)Ks.pg({actionType:s.focusedIndex,environment:e,commentStore:null===(n=s.args.commentStore)||void 0===n?void 0:n.state,useTempStores:!1});Hs.Z.setState({open:!1})}}),[e,s]),r=(0,n.useCallback)((e=>{s.open&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&a(void 0)}),[a,s.open]),l=(0,n.useCallback)((e=>{const n=t.current;if(!s.open||!e.target||!n)return;const i=Ws.findDOMNode(n);i&&(i.contains(e.target)||a(void 0))}),[a,s.open]);(0,n.useEffect)((()=>((0,qs.lj)(window,"keydown",r),(0,qs.lj)(window,"mousedown",l),()=>{(0,qs.ZV)(window,"keydown",r),(0,qs.ZV)(window,"mousedown",l)})),[r,l]);const d=(0,n.useRef)(!1);function c(t){var n;s.open&&void 0!==t.indexGlobal&&(Hs.Z.setState({...s,focusedIndex:t.indexGlobal}),Ks.pg({actionType:t.indexGlobal,environment:e,commentStore:null===(n=s.args.commentStore)||void 0===n?void 0:n.state,useTempStores:!0}))}(0,o.VK)((()=>{var t,n;const i=(s.open&&(null===(t=s.args.commentStore)||void 0===t?void 0:t.state)&&(null===(n=s.args.commentStore.state)||void 0===n?void 0:n.isReady()))??!1;var o;i&&!d.current&&s.open&&Ks.pg({actionType:s.focusedIndex,environment:e,commentStore:null===(o=s.args.commentStore)||void 0===o?void 0:o.state,useTempStores:!0});d.current=i}),[e,s]);const p=(0,o.VK)((()=>e.device.isMobileNative&&!e.device.isTablet),[e]),m=e.device.isMobile;return(0,C.jsx)(f.ZP,{popupType:p?f.ZP.PopupType.SlideUp:f.ZP.PopupType.Popup,open:s.open,originRect:s.open?s.selectionRect:void 0,placementToOrigin:f.ZP.Placement.Top,alignmentToOrigin:f.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:m,keepFocus:m,render:function(){var n;const{device:i}=e;if(!s.open)return;const o=function(t){const{url:s,args:n}=t,i=[];i.push({title:Ys(Gs.Z.Preview),validator:()=>!0,type:Gs.Z.Preview}),i.push({title:Ys(Gs.Z.Mention),validator:()=>!0,type:Gs.Z.Mention}),i.push({title:Ys(Gs.Z.Link),validator:()=>!0,type:Gs.Z.Link});return[{key:"menu section",render:e=>(0,C.jsx)(Qe.Z,{...e}),items:u.oA(i.map((t=>{let{title:i,validator:o,type:a}=t;if(o({url:s,baseUrl:kt.default.domainBaseUrl,publicDomainName:kt.default.publicDomainName})){return{key:`item ${a}`,render:t=>(0,C.jsx)(He.Z,{...t,title:i,onMouseEnter:s=>{var i;t.onMouseEnter(s),Ks.pg({actionType:a,environment:e,commentStore:null===(i=n.commentStore)||void 0===i?void 0:i.state,useTempStores:!0})}}),action:()=>{var t;return Ks.pg({actionType:a,environment:e,commentStore:null===(t=n.commentStore)||void 0===t?void 0:t.state,useTempStores:!1})}}}})))}]}(s);let a;return a=i.isMobile?{menuType:x.og.ActionSheet}:{menuType:x.og.Popup,width:320,maxHeight:"40vh"},null!==(n=s.args.commentStore)&&void 0!==n&&n.state&&s.args.commentStore.state.isReady()?(0,C.jsx)(h.Z,{...a,className:Ke.srZ,ref:t,children:(0,C.jsx)(Ye.Z,{type:Ye.i.Vertical,sections:o,onKeyboardArrow:c,initialFocus:0,priority:1,disallowBackspace:!0})}):(0,C.jsx)(zs.Z,{show:!0,showDelay:500,showHold:0,render:()=>(0,C.jsx)(h.Z,{...a,className:Ke.srZ,ref:t,children:(0,C.jsx)(Qe.Z,{style:{display:"flex",justifyContent:"center"},children:(0,C.jsx)(ns.Z,{})})})})},onDismiss:()=>a(void 0)})};var $s=s(1302),Js=s(64572),Xs=s(88295),en=s(45990),tn=s(48709),sn=s(40462),nn=s(23210),on=s(57549),an=s(54882),rn=s(23178),ln=s(68894);function dn(e){const{state:t,focusInitial:s,defaultValue:n,onBlur:o,onKeyDown:a,style:r}=e,l=(0,i.MO)(),d=(0,oe.useIntl)(),c=d.formatMessage({defaultMessage:"Paste link or search pages",id:"selectionLinkButton.search.createNewLinkPlaceholder"}),u=d.formatMessage({defaultMessage:"Edit link or search pages",id:"selectionLinkButton.search.editLinkPlaceholder"}),p=!l||!t.showCreateIn,m=l?void 0:!t.showCreateIn&&t.focusLinkInput,g=t.editingToken?u:c;return p?(0,C.jsx)(ln.ZP,{onFocus:tn.FV,placeholder:g,value:n||t.url,onChange:cn,onBlur:o,onKeyDown:a,focus:m,focusInitial:s,focusAfterAnimation:!0,preventCaptureArrowShortcuts:!0,style:r}):null}function cn(e){const t=rn.Z.state;t.open&&rn.Z.setState({...t,url:e.target.value,focusLinkInput:!0})}function un(e){const{state:t,showPreview:s,store:n}=e,o=(0,i.MO)(),a=(0,tn.Fs)(t),{editingToken:r,focusTitleInput:l}=t;return s&&n?(0,C.jsx)(an.B,{store:n,onClick:tn.FV}):(0,C.jsx)(dn,{state:t,onBlur:tn.cX,onKeyDown:pn,defaultValue:s?a:void 0,style:r?void 0:{marginTop:6},focusInitial:!Boolean(r)||o&&!l})}function pn(e){"Escape"===e.key&&(e.stopPropagation(),(0,tn.hy)())}function mn(e){const{title:t,focus:s,defaultTitle:o}=e,a=(0,i.O7)(),r=(0,i.MO)(),[l,d]=(0,n.useState)(),c=(0,n.useRef)(!1),u=(0,n.useMemo)((()=>({environment:a,defaultTitle:o,setPlaceholder:d,hasTitleChanged:c})),[o,a]);return(0,n.useEffect)((()=>{const e=c.current;return()=>{e&&on.pZ(a)}}),[c,a]),(0,C.jsx)(ln.ZP,{focus:s,focusInitial:r,onFocus:hn,onBlur:()=>fn(u),onChange:e=>function(e,t){gn(e.target.value,t)}(e,u),onKeyDown:e=>function(e,t){"Enter"!==e.key&&"Escape"!==e.key||(e.stopPropagation(),fn(t))}(e,u),value:l?"":t,placeholder:l,preventCaptureArrowShortcuts:!0,style:{paddingBottom:8}})}function gn(e,t){const s=rn.Z.state;if(!s.open)return;const{editingToken:n,savedTextSelectionState:i}=s;if(!n)return;if(!e)return void rn.Z.setState({...s,title:""});const{environment:o,setPlaceholder:a,hasTitleChanged:r}=t;g.createAndCommit({userAction:"LinkMenu.updateTitle",environment:o,perform:t=>{const l=en.iX({environment:o,title:e,transaction:t,editingToken:n,savedTextSelectionState:i});l&&rn.Z.setState({...s,...l,title:e}),a(void 0),r.current=!0}})}function hn(){(0,tn.ZG)(!0)}function fn(e){!function(e){const t=rn.Z.state;if(!t.open)return;const{defaultTitle:s,setPlaceholder:n}=e;t.title||(gn(s,e),n(s))}(e),(0,tn.ZG)(!1)}var xn=s(88632),yn=s(18466),Sn=s(11470),vn=s(15447);var bn=s(37612);function Mn(e){const{state:t}=e,s=(0,n.useMemo)((()=>(0,tn.uP)(t)),[t]),a=(0,n.useMemo)((()=>(0,tn.dY)(s)),[s]),r=function(e){const{state:t,inputUrl:s,query:a,handleLinkSelection:r}=e,{url:l}=t,d=(0,i.O7)(),c=(0,i.MO)(),u=(0,o.VK)((()=>xn.Z.state.online),[]),p=!!l,m=(0,n.useMemo)((()=>{let e,n=!1;if(!s&&p)e=(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Type a complete URL to link",id:"selectionLinkButton.invalidUrl"}),n=!0;else{if(!s)return;if("notion"===s.type&&u)return;"web"===s.type?e=(0,C.jsx)(oe.FormattedMessage,{id:"selectionLinkButton.linkToWebPage",defaultMessage:"Link to web page"}):"notion"===s.type?e=(0,C.jsx)(oe.FormattedMessage,{id:"selectionLinkButton.linkToPage",defaultMessage:"Link to page"}):"other"===s.type?e=(0,C.jsx)(oe.FormattedMessage,{id:"selectionLinkButton.linkToURL",defaultMessage:"Link to URL"}):(0,N.t1)(s.type)}return{key:"link to url",action:()=>r(d,t,a,c),render:t=>(0,C.jsx)(He.Z,{...t,title:l,caption:e,icon:(0,sn.o)({width:16,paddingTop:4}),disabled:n})}}),[t,a,d,c,u,s,r,p,l]);return m}({state:t,inputUrl:a,query:s,handleLinkSelection:jn}),l=function(e){const{state:t,inputUrl:s,query:a,additionalItem:r}=e,{editingToken:l}=t,d=function(e){const{state:t,inputUrl:s,query:a,handleLinkSelection:r,disableEmptyQueryResults:l}=e,{savedTextSelectionState:d}=t,c=(0,i.O7)(),p=(0,i.MO)(),[{online:m}]=(0,o.AF)(xn.Z),g=(0,n.useMemo)((()=>{var e;const t=null===(e=(0,y.QY)(d.multiSelection))||void 0===e?void 0:e.store;if(t&&(0,we.OY)(t))return t}),[d]),h=(0,A.useDependency)(A.deps.searchActions),[{value:f,status:x}]=(0,L.r5)((async()=>{if(!m||"resolved"!==h.status)return[];if(!a)return l?[]:vn.X4.state.map((e=>e.pageId));const e=h.value;return(await e.searchMentionablePages({nearBlock:g,environment:c,query:a,source:"mention_menu",limit:10})).map((e=>e.id))}),[a,g,c,m,l,h.status,h.value]),S=(0,n.useMemo)((()=>{if(s&&"notion"===s.type){const e=f?u.zu(f,s.notionPage.blockId):[];return[s,...e]}return f}),[f,s]);return(0,n.useMemo)((()=>{if(!S||0===S.length)return;if(s&&"web"===s.type&&s.url===a)return;const e=yn.Z.withListenerIgnored(mt.RM);if(!e)return;const n=t.url?5:3,i=(0,C.jsx)(oe.FormattedMessage,{id:"selectionLinkButton.linkToPage.linkToBlock",defaultMessage:"Link to block"}),o=(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Link to page",id:"selectionLinkButton.linkToPageSection.title"});return{items:S.map(((s,n)=>{const o="object"==typeof s?s.notionPage.peekViewBlockId||s.notionPage.blockId:s,a=It.G.createChildStore(e,{table:Mt.iU,id:o});return{key:n,action:()=>{if("object"==typeof s){const e=(0,Js.nR)({pageId:s.notionPage.blockId,peekViewBlockId:s.notionPage.peekViewBlockId,peekMode:s.notionPage.peekMode,discussionId:s.notionPage.discussionId,collectionViewId:s.notionPage.collectionViewId,scrollToBlockId:s.notionPage.scrollToBlockId});r(c,t,e,p)}else r(c,t,(0,Js.nR)({pageId:o}),p)},render:e=>{const t="object"==typeof s&&s.notionPage.scrollToBlockId;return(0,C.jsx)(Sn.Z,{...e,store:a,caption:t?i:void 0,placeholder:(0,C.jsx)(zs.Z,{showHold:300,showDelay:300,show:"resolved"===x,render:e=>e?(0,C.jsx)(oe.FormattedMessage,{id:"selectionLinkButton.linkToPage.unknownBlock",defaultMessage:"Unknown block"}):(0,C.jsx)(oe.FormattedMessage,{id:"selectionLinkButton.linkToPage.loading",defaultMessage:"Loading..."})})})}}})).slice(0,n),title:S.some((e=>Boolean("object"==typeof e&&e.notionPage.scrollToBlockId)))?i:o}}),[S,t,c,p,a,s,x,r])}({state:t,inputUrl:s,query:a,handleLinkSelection:jn,disableEmptyQueryResults:!!l}),c=(0,n.useMemo)((()=>{if(d||r){return{key:"results",items:u.oA([...(null==d?void 0:d.items)||[],r]),render:e=>(0,C.jsx)(Qe.Z,{...e,title:l||a?void 0:(0,C.jsx)(oe.FormattedMessage,{id:"selectionLinkButton.recents.title",defaultMessage:"Recents"})})}}}),[d,r,l,a]);return c}({state:t,inputUrl:a,query:s,additionalItem:r}),d=(0,tn.Fs)(t),p=d&&(0,Js.A5)({url:d,baseUrl:kt.default.domainBaseUrl,publicDomainName:kt.default.publicDomainName}),m=(0,o.VK)((()=>{if(!p)return;const e=(0,mt.RM)();return e?It.G.createChildStore(e,{table:Mt.iU,id:p}):void 0}),[p]),g=function(e){const{state:t,url:s,isEmptyResults:i,pageStore:o}=e,a=(0,n.useMemo)((()=>{let e=(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Page or URL",id:"selectionLinkButton.currentInfo.pageOrUrl"});const n=!t.focusLinkInput&&i;let a;return o?a={key:"link to page",action:()=>{},render:()=>(0,C.jsx)(un,{state:t,showPreview:n,store:o})}:s?a={key:"link to web",action:()=>{},render:()=>(0,C.jsx)(un,{state:t,showPreview:!0})}:(e=void 0,a={key:"create link",action:()=>{},render:()=>(0,C.jsx)(un,{state:t,showPreview:n})}),{key:"page or url",render:t=>(0,C.jsx)(Qe.Z,{title:e,...t}),items:[a]}}),[t,s,i,o]);return a}({state:t,url:d,isEmptyResults:!Boolean(l),pageStore:m}),h=function(e){const{state:t,url:s,pageStore:i}=e,{editingToken:a,title:r,focusTitleInput:l}=t,d=(0,o.VK)((()=>i?c.QaF(i.getTitleValue()):void 0),[i]),u=(0,n.useMemo)((()=>{if(a)return{key:"link title",render:e=>(0,C.jsx)(Qe.Z,{title:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Link title",id:"selectionLinkButton.currentInfo.linkTitle"}),...e}),items:[{key:"update title",action:()=>{},render:()=>(0,C.jsx)(mn,{title:r,defaultTitle:d??s,focus:l})}]}}),[a,r,l,s,d]);return u}({state:t,url:d,pageStore:m}),f=function(e){const{state:t}=e,s=function(e){const{state:t}=e,s=(0,i.O7)();return(0,n.useMemo)((()=>{if(t.editingToken)return{key:"unlink",action:()=>{en.PP(s);const e=(0,tn.Fs)(t);on.oS(s,{type:"remove_link",url:e})},render:e=>(0,C.jsx)(He.Z,{...e,title:(0,C.jsx)(oe.FormattedMessage,{id:"selectionLinkButton.removeLink",defaultMessage:"Remove link"}),icon:(0,bn.y)({width:16})})}}),[t,s])}({state:t}),o=(0,n.useMemo)((()=>{const e=u.oA([s]);if(0!==e.length)return{key:"link actions",render:e=>(0,C.jsx)(Qe.Z,{topBorder:!0,...e}),items:e}}),[s]);return o}({state:t});let x,S;return l?(S=1,x=u.oA([g,l])):(S=void 0,x=u.oA([g,h,f])),{initialFocus:S,sections:x}}function jn(e,t,s,n){const i=(0,nn.D)(s);if(!i)return;const{editingToken:o,savedTextSelectionState:a,title:r}=t;g.createAndCommit({userAction:"LinkMenu.handleLinkSelection",environment:e,perform:s=>{const l=en.gp({environment:e,transaction:s,url:i,title:r,editingToken:o,savedTextSelectionState:a});l?(on.oS(e,{type:"edit_link",url:i}),rn.Z.setState({...t,...l,url:"",focusLinkInput:!1,focusTitleInput:Boolean(n)})):(on.oS(e,{type:"create_link",url:i}),rn.Z.reset())}})}var Cn=s(96065),wn=s(81023),kn=s(1743),Tn=s(56940);function In(){const e=(0,o.VK)((()=>rn.Z.state),[]),t=(0,i.Fy)(),s=(0,o.VK)(F.bq,[]),a=(0,o.VK)((()=>{if(!e.open)return!1;if(e.focusLinkInput||e.focusTitleInput)return!1;const t=v.default.state;if("editing"!==t.mode)return!0;const s=(0,y.QY)(t.multiSelection);if(!s)return!0;const{store:n,selection:i}=s;return(0,Bs.wd)(i)?!c.oP(n.getValue(),i.startIndex,i.endIndex,c.GKr.Link):!(0,y._v)(t.multiSelection,e.savedTextSelectionState.multiSelection)}),[e]);return(0,n.useEffect)((()=>{a&&en.F5()}),[a]),(0,C.jsx)(f.ZP,{popupType:t.isMobile?t.isTablet?f.ZP.PopupType.Popup:f.ZP.PopupType.SlideUp:f.ZP.PopupType.Popup,style:{width:Rn(s)},keepFocus:t.isPhone,open:e.open,originRect:e.open?e.selectionRect:void 0,placementToOrigin:f.ZP.Placement.Bottom,alignmentToOrigin:f.ZP.Alignment.Center,originGap:8,disableContentScroll:!0,onDismiss:en.F5,render:()=>e.open?(0,C.jsx)(Zn,{state:e}):void 0,preventBlockRenderQueueOnEnter:!t.isMobile})}function Zn(e){const{state:t}=e,s=(0,i.MO)(),[o,a]=(0,n.useState)(!0);(0,n.useEffect)((()=>a(!1)),[]);const r=(0,n.useRef)(null);(0,n.useEffect)((()=>(r.current=document.createElement("input"),r.current.style.position="fixed",r.current.style.top="-9999px",r.current.style.left="-9999px",document.body.appendChild(r.current),()=>{r.current&&document.body.removeChild(r.current)})),[]);const l=s&&!t.focusLinkInput&&!t.focusTitleInput;(0,n.useEffect)((()=>{l&&$s.default.afterNextFlush((()=>{r.current&&r.current.focus()}))}),[l]);const d=(0,n.useCallback)((()=>{$s.default.afterNextFlush((()=>{r.current&&document.activeElement===r.current&&r.current.blur()}))}),[]);if(t.showCreateIn&&!s)return(0,C.jsx)(Fn,{state:t});let c;return c=s?{menuType:x.og.Modal,title:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Link",id:"selectionLinkButton.mobile.title"}),right:(0,C.jsx)(Pe.CancelMenuText,{}),onClickRight:en.F5,footer:(0,C.jsx)(f.ZP,{popupType:f.ZP.PopupType.SlideUp,open:t.showCreateIn||!1,render:()=>(0,C.jsx)(Fn,{state:t})})}:{menuType:x.og.Popup},(0,C.jsxs)(kn.Z,{debugName:"LinkMenu",capture:t.open&&(o||t.focusLinkInput||t.focusTitleInput),allowEsc:!0,children:[(0,C.jsx)(h.Z,{...c,children:(0,C.jsx)(Tn.Z,{capture:l,ignoreBlockSelection:!0,restoreSelection:!0,onClearSelection:d,render:()=>(0,C.jsx)(Pn,{state:t,useMenuList:Mn})})}),(0,C.jsx)(Ze.Z,{debugName:"LinkMenu",capture:!0,onCommandSlash:tn.FV})]})}function Pn(e){const{state:t,useMenuList:s}=e,{initialFocus:n,sections:i}=s({state:t});return(0,C.jsx)(Ye.Z,{type:Ye.i.Vertical,initialFocus:n,sections:i})}function Fn(e){var t;const{state:s}=e,a=(0,i.O7)(),r=(0,n.useCallback)((async e=>{var t;if(!wn.M_(a))return;const n=null===(t=(0,y.QY)(s.savedTextSelectionState.multiSelection))||void 0===t?void 0:t.store;if(!n)return;const{performResult:{createInState:i}}=await g.createAndCommitAsync({environment:a,userAction:"LinkMenu.LinkCreateInMenu",waitForServerCommit:!0,perform:async t=>{const i=Xs.f8({environment:a,transaction:t,titleText:s.url||"",createInValue:e,recordStoreParent:n}),[o]=i.createdPages;return o&&(en.gp({environment:a,url:(0,Js.nR)({pageId:o.id}),transaction:t,editingToken:s.editingToken,savedTextSelectionState:s.savedTextSelectionState}),rn.Z.reset()),await i.moveToStorePromise,{createInState:i}}});await Xs.c_({analyticsFrom:"link_menu",createInState:i})}),[s,a]),l=null===(t=(0,y.QY)(s.savedTextSelectionState.multiSelection))||void 0===t?void 0:t.store,d=l&&"block"===l.table?l.id:void 0,c=(0,o.VK)(F.bq,[]);return(0,C.jsx)(Cn.Z,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:r,captureSelection:!1,restoreSelection:!1,parentBlockId:d,onAutocompleteQueryChange:An,autocompleteQuery:s.createInQuery||"",desktopWidth:Rn(c),onCancel:_n})}function An(e){const t=rn.Z.state;t.open&&rn.Z.setState({...t,createInQuery:e})}function _n(){const e=rn.Z.state;e.open&&rn.Z.setState({...e,showCreateIn:!1,createInQuery:""})}function Rn(e){return e?400:330}var On=s(27153),Bn=s(12673),Dn=s(91390);const Ln=function(){const e=(0,i.O7)(),{device:t}=e,s=(0,o.VK)((()=>Dn.Z.state),[]);return(0,C.jsx)(f.ZP,{popupType:t.isMobile?f.ZP.PopupType.SlideUp:f.ZP.PopupType.Popup,open:s.isActive,originRect:s.isActive?s.originRect:void 0,originGap:s.isActive?s.originGap:void 0,placementToOrigin:f.ZP.Placement.Bottom,alignmentToOrigin:f.ZP.Alignment.Center,preventScaleTransition:!0,onDismiss:Vn,render:()=>{if(s.isActive)return(0,C.jsx)(Ze.Z,{debugName:"MediaMenu",capture:!0,onUp:u.yR,onDown:u.yR,children:(0,C.jsx)(Bn.ZP,{...s,onCancel:Vn})})}})};function Vn(){On.Z()}var Nn=s(66897),En=s(15145),Un=s(41892),Wn=s(7057),Kn=s(53877),zn=s(84795),qn=s(33728),Gn=s(58573),Hn=s(42875),Yn=s(47612),Qn=s(9999),$n=s(82114),Jn=s(56666),Xn=s(26056),ei=s(35840),ti=s(15157),si=s(6746),ni=s(94804),ii=s(92338),oi=s(85031),ai=s(38585),ri=s(7928),li=s(91219),di=s(26189),ci=s(81918),ui=s(67060),pi=s(76464),mi=s(75754),gi=s(64964),hi=s(23586),fi=s(72402),xi=s(60682),yi=s(24990),Si=s(98742),vi=s(46654),bi=s(97638),Mi=s(83089),ji=s(7314),Ci=s(13394),wi=s(18245),ki=s(75822),Ti=s(52432),Ii=s(96820),Zi=s(63334),Pi=s(55899),Fi=s(84166),Ai=s(19111),_i=s(74510),Ri=s(69454),Oi=s(88923),Bi=s(72087),Di=s(65613),Li=s(43765);const Vi={...ae.Z.textOverflowStyle,fontWeight:ae.Z.fontWeight.medium,maxWidth:160,display:"inline-block",verticalAlign:"bottom"};function Ni(e){const{pageTitle:t}=e;return t?(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"New “{filterText}” page in…",id:"createPageMenuItem.title.withPageName",values:{filterText:(0,C.jsx)("span",{style:Vi,children:t})}}):(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Add new page in…",id:"createPageMenuItem.title.withoutPageName"})}function Ei(e){const{pageTitle:t}=e;return t?(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"New “{filterText}” sub-page",id:"createSubpageMenuItem.title.withPageName",values:{filterText:(0,C.jsx)("span",{style:Vi,children:t})}}):(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Add new sub-page",id:"createSubpageMenuItem.title.withoutPageName"})}var Ui=s(85215);class Wi extends Dt.default{getInitialState(){return{userId:"",userEmail:"",displayName:""}}}const Ki=Wi;var zi=s(60442),qi=s(97680);function Gi(e){const{svg:t,viewBox:s,fill:i}=e,o=(0,n.useMemo)((()=>{const e=si.Z.renderToString((0,C.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:s,children:t}));return`url("${`data:image/svg+xml,${encodeURIComponent(e)}`}")`}),[t,s]);return(0,C.jsx)("div",{style:{width:"100%",height:"100%",backgroundColor:i,WebkitMaskImage:o,maskImage:o,WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat"}})}const Hi=(0,oe.defineMessages)({mentionAll:{defaultMessage:"Mention a person, page, or date…",id:"mentionMenu.personPageDate.prompt2"},mentionPersonPage:{defaultMessage:"Mention a person or page…",id:"mentionMenu.personPage.prompt2"},mentionPersonDate:{defaultMessage:"Mention a person or date…",id:"mentionMenu.personDate.prompt2"},mentionPageDate:{defaultMessage:"Mention a page or date…",id:"mentionMenu.pageDate.prompt2"},mentionPerson:{defaultMessage:"Mention a person…",id:"mentionMenu.person.prompt2"},mentionDate:{defaultMessage:"Mention a date…",id:"mentionMenu.date.prompt2"},mentionPage:{defaultMessage:"Type to link or add page…",id:"mentionMenu.page.prompt2"},addPage:{defaultMessage:"Type to add or link page…",id:"mentionMenu.addPage.prompt2"}}),Yi=(0,oe.defineMessages)({autocompleteToday:{defaultMessage:"Today",id:"mentionMenu.date.autocomplete.today"},autocompleteNextTuesday:{defaultMessage:"Next Tuesday 3pm",id:"mentionMenu.date.autocomplete.nextTuesday"},autocompleteReminder:{defaultMessage:"Remind tomorrow 9am",id:"mentionMenu.date.autocomplete.reminder"},reminder:{defaultMessage:"Remind {dateTime}",id:"mentionMenu.date.remindAtDateTime"},noResults:{defaultMessage:"No results",id:"mentionMenu.noSearchResults.title"},noPageResults:{defaultMessage:"No page results",id:"mentionMenu.noPageSearchResults.title"},groupMentionCaption:{defaultMessage:"{numMembersInGroup, plural, one {{numMembersInGroup} member} other {{numMembersInGroup} members}}",id:"mentionMenu.group.caption"}}),Qi="ShowMentionInvite";function $i(e){return`${Qi}-${e}`}class Ji extends d.Z{constructor(){super(...arguments),this.storeTypes={ignoreSelectionAreaStore:Zi.Z,localPageMentionRequestStore:Bi.Z,localCachePageMentionRequestStore:Bi.Z,inviteTargetsStore:Pi.ZP,personPropertyInviteStore:Ci.Z,mentionMenuCurrentMentionStore:Ki},this.renderMentionResult=(e,t)=>{const{intl:s}=this.props,n=Ai.Z.state,i=n.open&&n.insertionType,o=this.shouldPrioritizeUserSection(t),a={sections:[],nextSectionShouldHaveTopBorder:()=>a.sections.length>0,addSection(e){e&&this.sections.push(e)}};"+"===i&&a.addSection(this.getCreatePageMenuSection(a.nextSectionShouldHaveTopBorder())),a.addSection(this.getDateResultsMenuSection(t,a.nextSectionShouldHaveTopBorder())),o&&a.addSection(this.getUserResultsMenuSection(t,a.nextSectionShouldHaveTopBorder())),a.addSection(this.getPageResultsMenuSection(t,a.nextSectionShouldHaveTopBorder())),a.addSection(this.getGroupResultsMenuSection(t,a.nextSectionShouldHaveTopBorder(),this.props.intl)),a.addSection(this.getHeaderResultsMenuSection(t,a.nextSectionShouldHaveTopBorder())),o||a.addSection(this.getUserResultsMenuSection(t,a.nextSectionShouldHaveTopBorder())),("@"===i&&this.filterStore.state||"[["===i)&&a.addSection(this.getCreatePageMenuSection(a.nextSectionShouldHaveTopBorder()));const{sections:r}=a;let l,d;if(xn.Z.state.online){const e=n.mentionTypes.user,t=n.mentionTypes.page,i=n.mentionTypes.date;let o="";const a=Hi;e&&t&&i?o=s.formatMessage(a.mentionAll):e&&t?o=s.formatMessage(a.mentionPersonPage):e&&i?o=s.formatMessage(a.mentionPersonDate):t&&i?o=s.formatMessage(a.mentionPageDate):e?o=s.formatMessage(a.mentionPerson):i?o=s.formatMessage(a.mentionDate):t&&n&&(o=n.open&&"+"===n.insertionType?s.formatMessage(Hi.addPage):s.formatMessage(a.mentionPage)),this.setTemporaryInputData({title:o,icon:go(this.theme),allowTabCompletion:!1}),l=void 0}else l=(0,C.jsx)(Li.Z,{title:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Please go online to mention a person or page.",id:"mentionMenu.offlineMessage"})});0===r.length&&(d=(0,C.jsx)(Qe.Z,{children:(0,C.jsx)(Li.Z,{title:(0,C.jsx)(oe.FormattedMessage,{...Yi.noResults})})}));const{device:c}=this.environment;let u;return u=io(this.environment)?{menuType:x.og.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${Ri.Z.estimatedNativeWebBottomOverlap()}px)`}:{menuType:x.og.Popup,width:so(),maxHeight:c.isMobile?"30vh":"40vh",onClickOutside:So(this.environment,this.filterStore)},(0,C.jsxs)(h.Z,{...u,header:l,children:[(0,C.jsx)(Ze.Z,{debugName:"MentionMenu",capture:Ai.Z.state.open,onBackspace:xo(this.filterStore)?this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleEmptyBackspace:void 0,onTab:this.handleTab}),(0,C.jsx)(Ye.Z,{type:Ye.i.Vertical,initialFocus:yo(this.environment,this.filterStore),sections:r,onEmptyEnter:So(this.environment,this.filterStore),resetInitialFocusOnSectionChange:!0}),d]})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderCreateInMenu=()=>(0,C.jsx)(vo,{ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,filterStore:this.filterStore}),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderInviteMenu=()=>(0,C.jsx)(Mo,{ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,inviteTargetsStore:this.stores.inviteTargetsStore,personPropertyInviteStore:this.stores.personPropertyInviteStore,filterStore:this.filterStore}),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleInviteStart=()=>function(e,t,s,n){const i=Ai.Z.state;t.reset(),s.reset(),i.open&&(t.setState({...t.state,tokenQuery:fo(e,n)}),s.setState({...s.state,flowId:i.flowId}),ci.P0(e,{origin:to(),invite_flow_id:i.flowId}),eo({showInvite:!0}))}(this.environment,this.stores.inviteTargetsStore,this.stores.personPropertyInviteStore,this.filterStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleInviteCancel=()=>ho(this.environment,this.stores.inviteTargetsStore,this.stores.personPropertyInviteStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleEmptyBackspace=e=>function(e,t,s){xo(s)&&e.preventDefault();So(t,s)()}(e,this.environment,this.filterStore),this.handleTab=e=>{e.preventDefault();const t=this.tabCompletionString;if(!t)return;const s=v.default.state;if("editing"!==s.mode)return;const n=(0,y.QY)(s.multiSelection);if(!n)return;const i=Ai.Z.state;i.open&&i.textStore===n.store&&g.createAndCommit({userAction:"MentionMenu.handleTab",environment:this.environment,perform:e=>{pt.hJ({environment:this.environment,editorMode:"default",transaction:e,string:t,store:n.store,selection:n.selection,disableMentions:!0,disableEmojiCommands:!0,disableSlashCommands:!0})}})},this.tabCompletionString=void 0,this.pageHeaderIdsStore=this.createComputedStore(ao),this.inputSelectionsStore=this.createComputedStore((()=>{const e=Ai.Z.state;if(e.open)return S.O2(e.textStore,e.oldTextValue,e.isEmptyPageTitle?"":e.insertionType)})),this.filterStore=this.createComputedStore((()=>{const e=this.inputSelectionsStore.state,t=Ai.Z.state;if(e&&t.open)return S.ug(t.textStore,e)})),this.popupOpenStore=this.createComputedStore((()=>{const e=Ai.Z.state;return!!e.open&&("+"!==e.insertionType||""!==fo(this.environment,this.filterStore))})),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_performLocalPageMentionRequest=e=>async function(e,t,s,n){const i=s.state.result;if(!i)return;const o=mt.RM();if(!o)return;if(!fo(t,n))return;return _i.Z.update((e=>({...e,numLocalRequests:e.numLocalRequests+1}))),Promise.resolve((0,Ti.Y)({query:e,localCachedPages:i,parentStore:o,isOnline:xn.Z.state.online,environment:t,shouldLimitLocalResultsWhenOnline:!1,applyScoreThresholdWhenOnline:!0,canUseLtr:!1}))}(e,this.environment,this.stores.localCachePageMentionRequestStore,this.filterStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_performServerPageMentionRequest=e=>async function(e,t,s){const n=Ai.Z.state;if(n.pageRequestStore.update((e=>({...e,loading:!0,ready:!1,result:void 0}))),!n.open||!fo(t,s))return[];_i.Z.update((e=>({...e,numServerRequests:e.numServerRequests+1})));const i=(0,ni.A7)({searchSessionId:Ai.Z.state.sessionId,searchSessionFlowNumber:_i.Z.state.numServerRequests}),o=n.mentionTypes.page?await async function(e,t){if(!xn.Z.state.online)return[];const s=Ai.Z.state,{numServerRequests:n}=_i.Z.state,i=s.open&&(0,we.OY)(s.textStore)&&s.textStore,o=await A.deps.searchActions.loader();return await o.searchMentionablePages({nearBlock:i||void 0,environment:t,query:e,source:"mention_menu",limit:20,searchSessionId:s.sessionId,searchSessionFlowNumber:n})}(e,t):[],a=(0,ni.A7)({searchSessionId:Ai.Z.state.sessionId,searchSessionFlowNumber:_i.Z.state.numServerRequests});if(i!==a)return[];return o}(e,this.environment,this.filterStore)}UNSAFE_willMountOrUpdate(){const e=Ai.Z.state,t=this.filterStore.state;if(e.open){var s;const n=v.default.state,i="editing"===n.mode?(0,y.QY)(n.multiSelection):void 0,o=(null==i?void 0:i.store)===e.textStore,a=this.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState,r=a&&"editing"===a.mode&&(null===(s=(0,y.QY)(a.multiSelection))||void 0===s?void 0:s.store)===e.textStore;if(!o&&!r)return void ui.xv();const l=o&&(null==i?void 0:i.selection),d=this.inputSelectionsStore.state;if(d&&l&&(l.startIndex<d.filter.startIndex||l.endIndex>d.filter.endIndex))return void ui.xv();const c=this.filterStore.state&&this.filterStore.state[0];if("+"===e.insertionType&&c&&!c.match(Mi.Ff))return void ui.xv();if(void 0===t&&!e.isEmptyPageTitle)return void ui.xv()}}renderComponent(){const{device:e}=this.environment,t=Ai.Z.state,s=fi.Z.find((e=>e.props.capture)),n=this.popupOpenStore.state;let i;if(s&&e.isMobile){var o;const e=null===(o=s.stores.store.state.node)||void 0===o?void 0:o.getBoundingClientRect();e&&(i={height:`calc(100vh - ${e.height}px)`})}const a=t.open&&t.showCreateIn,r=t.open&&t.showInvite,l=t.open&&t.showMentionAndShare;return(0,C.jsx)(f.ZP,{popupType:io(this.environment)?f.ZP.PopupType.SlideUp:f.ZP.PopupType.Popup,open:n,originRect:t.open?t.selectionRect:void 0,slideUpWrapStyle:i,placementToOrigin:f.ZP.Placement.Bottom,alignmentToOrigin:f.ZP.Alignment.Start,originGap:8,disableMouseCapture:!r,disableContentScroll:!0,onDismiss:So(this.environment,this.filterStore),disableDarkOverlayBackground:e.isMobile,keepFocus:!0,render:()=>e.isMobile?(0,C.jsxs)(C.Fragment,{children:[!l&&this.renderMentionSearch(),(0,C.jsx)(f.ZP,{popupType:f.ZP.PopupType.SlideUp,render:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderCreateInMenu,open:a,keepFocus:!0}),(0,C.jsx)(f.ZP,{popupType:f.ZP.PopupType.SlideUp,render:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderInviteMenu,open:r,keepFocus:!0}),(0,C.jsx)(f.ZP,{popupType:io(this.environment)?f.ZP.PopupType.SlideUp:f.ZP.PopupType.Popup,render:()=>(0,C.jsx)(bo,{mentionMenuCurrentMentionStore:this.stores.mentionMenuCurrentMentionStore,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore}),open:l,keepFocus:!0,originRect:t.open?t.selectionRect:void 0,slideUpWrapStyle:i,placementToOrigin:f.ZP.Placement.Bottom,alignmentToOrigin:f.ZP.Alignment.Start,originGap:8,isFullWidthOnMobile:!0})]}):a?(0,C.jsx)(vo,{ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,filterStore:this.filterStore}):r?(0,C.jsx)(Mo,{ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,inviteTargetsStore:this.stores.inviteTargetsStore,personPropertyInviteStore:this.stores.personPropertyInviteStore,filterStore:this.filterStore}):l?(0,C.jsx)(bo,{mentionMenuCurrentMentionStore:this.stores.mentionMenuCurrentMentionStore,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore}):this.renderMentionSearch()})}renderMentionSearch(){const e=fo(this.environment,this.filterStore),t=Ai.Z.state,s=wi.default.mark("rum.mention_menu_ready"),n={field:"relevance"};return(0,C.jsx)(hi.Z,{requestStore:t.userRequestStore,request:e,debounce:ki.E5,performRequest:e=>async function(e,t){const s=Ai.Z.state;if(!s.open)return;const n=s.mentionTypes.user?await async function(e,t){if(xn.Z.state.online){const s=await A.deps.searchActions.loader();return await s.searchVisibleSpaceUsers({environment:t,query:e,membersOnly:!1,minFuzzyScore:"on"===z.default.getEligibleGroup({experimentId:"search-people-mentions-higher-fuzzy-results"})?25:0})}return[]}(e,t):[];return""===e?n.slice(0,2):n.slice(0,20)}(e,this.environment),render:i=>(0,C.jsx)(hi.Z,{requestStore:t.pageRequestStore,request:e,performRequest:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_performServerPageMentionRequest,debounce:ki.vp,render:t=>(0,C.jsx)(hi.Z,{requestStore:this.stores.localCachePageMentionRequestStore,request:E.default.state.currentSpaceStore&&E.default.state.currentSpaceStore.id,performRequest:()=>async function(e){const{currentSpaceStore:t,currentSpaceViewStore:s}=E.default.state;if(!t)return;if("on"===z.default.getEligibleGroup({experimentId:"use_global_local_search_cache"}))return Fi.Z.state.localSearchableBlocksCache;return(0,Ii.S)({environment:e,currentSpaceStore:t,currentSpaceViewStore:s,excludeCurrentPage:!0})}(this.environment),render:o=>(0,C.jsx)(hi.Z,{requestStore:this.stores.localPageMentionRequestStore,debounce:ki.E5,request:{query:{text:e,filters:ii.u4({isDeletedOnly:!1,navigableBlockContentOnly:!0,excludeTemplates:!0,requireEditPermissions:void 0}),sort:n},limit:5},performRequest:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_performLocalPageMentionRequest,render:e=>this.renderMentionResult(i||t||e,function(e,t,s,n,i,o){const a=Ai.Z.state,r=a.userRequestStore.state.result||[],l=a.pageRequestStore.state.result||[],d=function(e,t){const s=Ai.Z.state;if(!s.open)return[];const n=s.mentionTypes.reminder,i=s.mentionTypes.date?function(e,t,s){if(0===e.length)return u.oA([{label:s.formatMessage(Yi.autocompleteToday),value:()=>Kn.Lg((0,Hn.r)())},t?void 0:{label:s.formatMessage(Yi.autocompleteNextTuesday),value:()=>{const e=Kn.Uu((0,Hn.r)()),t=e.set({weekday:2,hour:15}),s=t<=e?t.plus({week:2}):t.plus({week:1});return{type:"datetime",start_date:s.toFormat(Kn.Iq),start_time:s.toFormat(dt.jK),time_zone:(0,Hn.r)()}}},t?{label:s.formatMessage(Yi.autocompleteReminder),value:()=>({type:"datetime",start_date:Kn.Ro((0,Hn.r)()).start_date,start_time:"09:00",reminder:{unit:"day",value:0,time:dt.HZ,defaultTimeZone:(0,Hn.r)()},time_zone:(0,Hn.r)()})}:void 0]);const n=e.normalize("NFKD"),i=t?zn.St(n,s):zn.cg(n,s);if(i){let e=(0,Wn.ZV)({value:i,date_format:"relative",userTimeZone:(0,Hn.r)(),intl:s,allowRelativeDates:!0});return i.reminder&&(e=s.formatMessage(Yi.reminder,{dateTime:e})),[{label:e,value:()=>i}]}return[]}(e,n,t).slice(0,6):[];return i}(fo(t,i),s),p=function(e,t,s){const n=mt.RM();if(!n)return[];const i=e.toLowerCase();return u.oA(s.state.map((e=>{const s=It.G.createChildStore(n,{table:Mt.iU,id:e}),o=s.getModel();if(!o)return;const a=o.getRenderTitle({getRecordModel:s.getRecordModel,userTimeZone:(0,Hn.r)(),intl:t});return a&&a.toLowerCase().includes(i)?e:void 0})))}(fo(t,i),s,o),m=function(e,t){const s=Ai.Z.state;if(!s.open)return[];if(!s.mentionTypes.templateVariable)return[];return c.XVI(e,t)}(fo(t,i),s),g=a.mentionTypes.group?function(e){var t;const s=Ai.Z.state;if(!s.open)return[];const n=(null===(t=E.default.state.currentSpaceStore)||void 0===t?void 0:t.getPermissionGroups())||[];return(0,Gn.ZP)(e,n,(e=>e.name||""))}(fo(t,i)):[];let h=l;const{result:f}=n.state;if(f&&!f.error){const e=f.value.results,t=mt.RM();h=t?bi.oO({localResults:e,serverResults:l.map(((e,s)=>({...e,serverEventProperties:void 0,originalPosition:s,store:It.G.createChildStore(t,{table:Mt.iU,id:e.id})})))})||[]:e}let x;x=fo(t,i)?h.map((e=>e.id)):vn.X4.state.map((e=>e.pageId));const y=a.userRequestStore.state.ready&&a.pageRequestStore.state.ready;y&&wi.default.measure(e,{environment:t});return{headingResults:p,userResults:r,groupResults:g,pageResults:x,dateResults:d,templateVariableResults:m,ready:y}}(s,this.environment,this.props.intl,this.stores.localPageMentionRequestStore,this.filterStore,this.pageHeaderIdsStore))})})})})}getDateResultsMenuSection(e,t){const{dateResults:s}=e,{intl:n}=this.props,i=fo(this.environment,this.filterStore),o=this.getTemplateVariableMenuItems(e,"date");if(0===s.length&&0===o.length)return;const a=s.map((e=>{let{label:t,value:s}=e;return{key:t,render:e=>{if(e.focused&&this.setTemporaryInputData({title:t,icon:co(this.theme.mediumIconColor),allowTabCompletion:!0}),zn.UL(t,n)){const i=(0,Wn.ZV)({value:s(),userTimeZone:(0,Hn.r)(),intl:n,allowRelativeDates:!1});return(0,C.jsx)(He.Z,{...e,title:t,caption:i,inline:!0})}return(0,C.jsx)(He.Z,{...e,title:t})},action:e=>{g.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:t=>{const n=s();ui.RL({environment:this.environment,annotations:[["d",{...n,date_format:"relative"}]],transaction:t,menuListItemAction:e,query:i,mentionType:n.reminder?"reminder":"date"})}})}}}));return oo("date",{key:"date results",render:e=>(0,C.jsx)(Qe.Z,{...e,title:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Date",id:"mentionMenu.dateSection.title"}),topBorder:t,isTitleUppercase:!0}),items:o.concat(a)},this.environment,this.theme)}getTemplateVariableMenuItems(e,t){const{templateVariableResults:s}=e,{intl:n}=this.props,i=fo(this.environment,this.filterStore);return s.filter((e=>c.i6A(e,t))).map((e=>({key:e,render:t=>{const s=c.U$y(e,n),i=c.Z08(e,n);return t.focused&&this.setTemporaryInputData({title:s,icon:co(this.theme.mediumIconColor),allowTabCompletion:!0}),(0,C.jsx)(He.Z,{...t,title:s,caption:i,inline:!0})},action:t=>{g.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:s=>{ui.RL({environment:this.environment,annotations:[c.WBu({type:e})],transaction:s,menuListItemAction:t,query:i,mentionType:"templateVariable"})}})}})))}getUserResultsMenuSection(e,t){const s=this.environment,n=mt.np(),i=!!n&&ti.Z.get({userId:s.currentUser.id,key:$i(n.id)}),o=Ai.Z.state.mentionTypes.inviteUserToPage&&!i,{userResults:a}=e,r=fo(this.environment,this.filterStore),l=this.getTemplateVariableMenuItems(e,"user"),d=a.find((e=>e.email===r)),p=!d&&Ai.Z.state.mentionTypes.inviteUserToWorkspace;if(!p&&0===a.length&&0===l.length)return;const m=u.oA(a.map((e=>({key:e.id,render:t=>(t.focused&&this.setTemporaryInputData({title:(0,ri.Nz)(this.props.intl,e),icon:co(this.theme.mediumIconColor),allowTabCompletion:!0}),(0,C.jsx)(qi.Z,{...t,actor:(0,Nn.dp)(e),useEmailAsTooltip:!0})),action:t=>{const s=(0,vi.rc)(e.id);o&&"none"===s?(this.stores.mentionMenuCurrentMentionStore.reset(),this.stores.mentionMenuCurrentMentionStore.setState({userId:e.id,userEmail:e.email,displayName:(0,Nn.dp)(e).getDisplayName(this.props.intl)}),eo({showMentionAndShare:!0})):g.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:s=>{ui.RL({environment:this.environment,annotations:[(0,c.tEo)(e.id)],transaction:s,menuListItemAction:t,query:r,mentionType:"user"})}})}})))).concat(p?[{key:"__invite",action:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleInviteStart,render:e=>(e.focused&&this.setTemporaryInputData({title:"",icon:co(this.theme.mediumIconColor),allowTabCompletion:!1}),(0,C.jsx)(He.Z,{...e,icon:(0,Yn.C)({width:20}),title:r.length>0?(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Invite ”{query}”…",id:"mentionMenu.peopleSection.invitePrompt",values:{query:r}}):(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Invite…",id:"mentionMenu.peopleSection.invitePrompt.empty"})}))}]:[]);return oo("user",{key:"user results",render:e=>(0,C.jsx)(Qe.Z,{...e,title:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"People",id:"mentionMenu.peopleSection.title"}),topBorder:t,isTitleUppercase:!0}),items:l.concat(m)},this.environment,this.theme)}shouldPrioritizeUserSection(e){const{userResults:t}=e,s=fo(this.environment,this.filterStore),n=this.getTemplateVariableMenuItems(e,"user");return""===s||(t.length>0||n.length>0||!!(0,qn.BZ)(s))}getGroupResultsMenuSection(e,t,s){const{groupResults:n}=e;if(0===n.length)return;const i=fo(this.environment,this.filterStore);return oo("group",{key:"group results",render:e=>(0,C.jsx)(Qe.Z,{...e,title:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Groups",id:"mentionMenu.groupSection.title"}),topBorder:t,isTitleUppercase:!0}),items:u.oA(n.map((e=>{var t;const n=s.formatMessage(Yi.groupMentionCaption,{numMembersInGroup:(null===(t=e.user_ids)||void 0===t?void 0:t.length)||0});return{key:e.id,render:t=>(t.focused&&this.setTemporaryInputData({title:e.name||"",icon:co(this.theme.mediumIconColor),allowTabCompletion:!0}),(0,C.jsx)(Ui.l,{menuListItemProps:{...t,caption:n},group:e})),action:t=>{var s;const n=null===(s=E.default.state.currentSpaceStore)||void 0===s?void 0:s.id;n&&g.createAndCommit({userAction:"MentionMenu.groupMention",environment:this.environment,perform:s=>{ui.RL({environment:this.environment,annotations:[c.XIB(e.id,n)],transaction:s,menuListItemAction:t,query:i,mentionType:"group"})}})}}})))},this.environment,this.theme)}getHeaderResultsMenuSection(e,t){const{headingResults:s}=e,n=fo(this.environment,this.filterStore);if(0===s.length)return;const i=(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Link to heading",id:"mentionMenu.headerSection.title"})});return oo("heading",{key:"heading results",render:e=>(0,C.jsx)(Qe.Z,{...e,title:i,topBorder:t,isTitleUppercase:!0}),items:u.oA(s.map((e=>{const t=mt.RM();if(!t)return;const s=It.G.createChildStore(t,{table:Mt.iU,id:e});return{key:e,render:e=>{if(e.focused){const e=s.getModel();if(e){const n=e.getRenderTitle({getRecordModel:s.getRecordModel,userTimeZone:(0,Hn.r)(),intl:this.props.intl});this.setTemporaryInputData({title:n||"",icon:(t=this.theme.mediumIconColor,(0,C.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,C.jsx)(Gi,{svg:Xn.T,viewBox:Xn.f.__iconViewBox,fill:t})})),allowTabCompletion:!0})}}var t;return(0,C.jsx)(Di.Z,{...e,store:s})},action:t=>{g.createAndCommit({userAction:"MentionMenu.getHeaderResultsMenuSection",environment:this.environment,perform:s=>{ui.RL({environment:this.environment,annotations:[["p",e]],transaction:s,menuListItemAction:t,query:n,mentionType:"heading"})}})}}})))},this.environment,this.theme)}getPageResultsMenuSection(e,t){const{pageResults:s}=e,n=fo(this.environment,this.filterStore),{device:i}=this.environment,o=i.isSafari||i.isIOS,a=this.environment.currentUser.id,r=Ai.Z.state.pageRequestStore.state.result,l=r&&r[0]?r[0].serverEventProperties:void 0,d=(0,C.jsxs)(C.Fragment,{children:[0!==s.length||Ai.Z.state.pageRequestStore.state.loading?(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Link to page",id:"mentionMenu.pagesSection.title2"}):(0,C.jsx)(oe.FormattedMessage,{...Yi.noPageResults}),(0,C.jsx)(no,{show:Ai.Z.state.pageRequestStore.state.loading})]});return 0===s.length?{key:"no page results",render:e=>(0,C.jsx)(Qe.Z,{...e,title:d,topBorder:t,isTitleUppercase:!0}),items:[]}:oo("page",{key:"page results",render:e=>(0,C.jsx)(Qe.Z,{...e,title:d,topBorder:t,isTitleUppercase:!0}),items:u.oA(s.map((e=>{const t=mt.RF();if(!t)return;const s=It.G.createChildStore(t,{table:Mt.iU,id:e});return{key:e,render:e=>{if(e.focused){const e=s.getModel();if(e){const t=e.getRenderTitle({getRecordModel:s.getRecordModel,userTimeZone:(0,Hn.r)(),intl:this.props.intl});this.setTemporaryInputData({title:t||"",icon:lo(s,this.theme,o,(0,xi.e_)(this.environment),a),allowTabCompletion:!0})}}return(0,C.jsx)(Sn.Z,{...e,store:s})},action:t=>{g.createAndCommit({userAction:"MentionMenu.getPageResultsMenuSection",environment:this.environment,perform:s=>{ui.RL({environment:this.environment,annotations:[["p",e]],transaction:s,menuListItemAction:t,query:n,serverEventProperties:l,mentionType:"page",resultId:e})}})}}})))},this.environment,this.theme)}getCreatePageMenuSection(e){if(!function(){if(!Ai.Z.state.mentionTypes.createPage)return!1;return!0}())return;const t=Ai.Z.state;if(!t.open)return;const{intl:s}=this.props,n=fo(this.environment,this.filterStore),i="@"===t.insertionType?(0,C.jsx)(oe.FormattedMessage,{id:"mentionMenu.createPageSection.title",defaultMessage:"New page"}):void 0;return{key:"create page",render:t=>(0,C.jsx)(Qe.Z,{title:i,isTitleUppercase:!0,...t,topBorder:e}),items:[{key:"add new subpage",action:async e=>{const s=Xs.gt(t.textStore);s&&await ui.Br({environment:this.environment,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,titleText:fo(this.environment,this.filterStore),createInValue:s.createInValue,onPageCreated:e=>{e&&""===c.QaF(e.getTitleValue())&&mi._c({environment:this.environment,store:e,pageVisitSource:En.tY.Create})},menuListItemAction:e})},render:e=>{e.focused&&this.setTemporaryInputData({title:0===n.length?s.formatMessage(Hi.addPage):"",icon:ro(this.theme.mediumIconColor),allowTabCompletion:!1});const t=t=>(0,C.jsx)(He.Z,{...(0,Si.Z)(t||{},e),icon:(0,zt.R)({width:16}),title:(0,C.jsx)(Ei,{pageTitle:fo(this.environment,this.filterStore)})});return this.environment.device.isMobile?t():(0,C.jsx)(ge.ZP,{renderTooltip:()=>(0,C.jsx)(zi.Z,{imageURL:Un.Z.images.tooltips.pageMenu.newSubpagePng,imageWidth:140,imageHeight:100,caption:(0,C.jsx)(oe.FormattedMessage,{...Cn.s.createSubpage})}),placement:ge.ug.Right,delayThreshold:0,render:e=>t(e)})}},{key:"open create in menu",action:po,render:e=>{e.focused&&this.setTemporaryInputData({title:0===n.length?s.formatMessage(Hi.addPage):"",icon:ro(this.theme.mediumIconColor),allowTabCompletion:!1});const t=(0,C.jsx)(Ni,{pageTitle:fo(this.environment,this.filterStore)}),i=s=>(0,C.jsx)(He.Z,{...(0,Si.Z)(s||{},e),icon:(0,Qn.J)({width:16}),title:t});return this.environment.device.isMobile?i():(0,C.jsx)(ge.ZP,{renderTooltip:()=>(0,C.jsx)(zi.Z,{imageURL:Un.Z.images.tooltips.pageMenu.newPageInPng,imageWidth:140,imageHeight:100,caption:(0,C.jsx)(oe.FormattedMessage,{...Cn.s.newPageIn})}),placement:ge.ug.Right,delayThreshold:0,render:e=>i(e)})}}]}}setTemporaryInputData(e){const t=Ai.Z.state;if(!t.open)return;if(!e)return void t.temporaryInputData.setState(void 0);const{device:s}=this.environment,{title:n,icon:i,allowTabCompletion:o}=e,a=this.filterStore.state||"",r=n.toLowerCase().startsWith(a)?n.slice(a.length):"";this.tabCompletionString=o?r:void 0;const l=s.isFirefox?void 0:i;t.temporaryInputData.setState({prefix:t.insertionType,suffix:"[["===t.insertionType&&a.endsWith("]]")?"]]":"",completion:r,prefixIcon:l})}}Ji.displayName="MentionMenu";const Xi=(0,oe.injectIntl)(Ji);function eo(e){const t=Ai.Z.state;t.open&&Ai.Z.setState({...t,...e})}function to(){return"comment"===ui.WI()?"comment_mention":"inline_mention"}function so(){return(0,F.bq)()?400:330}function no(e){let{show:t}=e;return(0,C.jsx)(zs.Z,{show:t,showDelay:500,showHold:300,render:e=>(0,C.jsx)(ns.Z,{style:{textAlign:"center",visibility:e?"visible":"hidden",display:"inline",marginLeft:8}})})}function io(e){const{device:t}=e;return t.isMobileNative&&!t.isTablet}function oo(e,t,s,n){const i=Ai.Z.state;if(!i.open)return t;if(i.expandSection&&i.expandSection===e)return t;const{items:o}=t,a=s.device.isPhone||"heading"===e?3:5;if(o.length<=a)return t;const r=[...o.slice(0,a),{key:"show more",render:e=>(0,C.jsx)(He.Z,{...e,icon:(0,Jn.o)({width:16,fill:n.mediumTextColor}),title:(0,C.jsx)("span",{style:{color:n.mediumTextColor},children:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"{numberMore} more results",id:"mentionMenu.showMoreResultsButton.title",values:{numberMore:o.length-a}})})}),action:()=>{eo({expandSection:e})}}];return{...t,items:r}}function ao(){if(!z.default.checkGate("mention_menu_page_headings"))return[];const e=function(){const e=mt.RM();if(!e)return;const{mainEditorCurrentBlockStore:t}=E.default.state;return e===t?t:Oi.default.peekTarget.state===e?Oi.default.peekTarget.state:void 0}();if(!e)return[];const t=z.default.checkGate("toc_nested_headings");return oi.Q(e.id,e.getRecordModel,t)}function ro(e){return(0,C.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,C.jsx)(Gi,{svg:zt.s,viewBox:zt.R.__iconViewBox,fill:e})})}function lo(e,t,s,n,i){return(0,ai.tp)({pageModel:e.getModel(),pageRole:e.getRole(),showEmojiInline:!0,emojiType:n,baseUrl:kt.default.domainBaseUrl,getRecordModel:e.getRecordModel,isClient:!0,isSafariOrIOS:s,currentUserId:i,theme:t,emojiData:yi.Z.state})}function co(e){return(0,C.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,C.jsx)(Gi,{svg:$n.Q,viewBox:$n.p.__iconViewBox,fill:e})})}function uo(e){eo({createInQuery:e})}function po(){eo({showCreateIn:!0})}function mo(){eo({showCreateIn:!1,createInQuery:""})}function go(e){const t=Ai.Z.state;if(t.open)return"+"===t.insertionType?ro(e.mediumIconColor):(0,C.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,C.jsx)(Gi,{svg:ei.T,viewBox:ei.R.__iconViewBox,fill:e.mediumIconColor})})}function ho(e,t,s){const n=Ai.Z.state;n.open&&(ci.Zv(e,{origin:to(),invite_flow_id:n.flowId}),t.setState({tokenQuery:"",inviteTargets:[]}),s.setState({...s.state,emailMessage:""}),eo({showInvite:!1}))}function fo(e,t){const s=t.state;return s?Ai.Z.state.open&&"@"===Ai.Z.state.insertionType&&e.device.isAndroid&&s.startsWith("@")?s.slice(1).trim():Ai.Z.state.open&&"[["===Ai.Z.state.insertionType&&s.endsWith("]]")?s.slice(0,-2).trim():s.trim():""}function xo(e){return""===e.state}function yo(e,t){if(""!==fo(e,t))return 0}function So(e,t){const s=Ai.Z.state,n=fo(e,t),i=ui.WI();let o,a=Date.now();return s.open&&(a=s.openTime,o=s.flowId),()=>{if(Ai.Z.state.open){const t=Date.now(),{numServerRequests:s}=_i.Z.state,r=Ai.Z.state.sessionId,l=Ai.Z.state.showMentionAndShare;di.ew(e,{timeToAbandonInMs:t-a,analyticsFrom:i,queryLength:n.length,flowId:o,searchSessionId:r,searchSessionFlowNumber:s,stage:l?"share":"user_selection"})}s.open&&s.showInvite&&ci.Zv(e,{origin:to(),invite_flow_id:s.flowId}),ui.xv()}}function vo(e){let{ignoreSelectionAreaStore:t,filterStore:s}=e;const n=(0,i.O7)(),a=(0,o.VK)((()=>Ai.Z.state),[]),r=(0,o.VK)((()=>so()),[]);if(!a.open)return null;const l="block"===a.textStore.table?a.textStore.id:void 0;return(0,C.jsx)(Cn.Z,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:e=>{ui.Br({environment:n,titleText:fo(n,s),ignoreSelectionAreaStore:t,createInValue:e,menuListItemAction:void 0})},captureSelection:!0,restoreSelection:!0,parentBlockId:l,onAutocompleteQueryChange:uo,ignoreSelectionAreaStore:t,autocompleteQuery:a.createInQuery,desktopWidth:r,onCancel:mo})}function bo(e){const t=(0,i.O7)(),s=(0,o.VK)((()=>mt.np()),[]),{mentionMenuCurrentMentionStore:n,ignoreSelectionAreaStore:a}=e,r=(0,o.VK)((()=>n.getState().userId),[n]),l=(0,o.VK)((()=>n.getState().displayName),[n]),d=(0,o.VK)((()=>n.getState().userEmail),[n]);return s?(0,C.jsx)(Tn.Z,{store:a,capture:!0,ignoreBlockSelection:!1,restoreSelection:!0,render:()=>{const e={key:"invite buttons",render:e=>(0,C.jsx)(Qe.Z,{...e}),items:[{key:"MentionMenu.MentionWithoutSharing",render:e=>(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(He.Z,{title:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Mention without sharing",id:"mentionMenu.peopleSection.invitePrompt.mentionWithoutSharing"}),caption:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Mention {userDisplayName} without sharing this document",id:"mentionMenu.peopleSection.invitePrompt.mentionWithoutSharingCaption",values:{userDisplayName:l}}),icon:(0,$n.p)({width:18}),...e})}),action:()=>{g.createAndCommit({userAction:"MentionMenu.menuItem",environment:t,perform:e=>{ui.RL({environment:t,annotations:[(0,c.tEo)(r)],transaction:e,menuListItemAction:void 0,query:"",mentionType:"user",shareMenuSelection:"mention_without_share"})}}),ti.Z.set({userId:t.currentUser.id,key:$i(s.id),value:!0})}},{key:"MentionMenu.MentionAndShare",render:e=>(0,C.jsx)(He.Z,{title:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Mention and share",id:"mentionMenu.peopleSection.invitePrompt.mentionAndShare"}),caption:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Grant {userDisplayName} full access",id:"mentionMenu.peopleSection.invitePrompt.mentionAndShareCaption",values:{userDisplayName:l}}),icon:(0,Yn.C)({width:18}),...e}),action:()=>{g.createAndCommit({userAction:"MentionMenu.menuItem",environment:t,perform:e=>{ui.RL({environment:t,annotations:[(0,c.tEo)(r)],transaction:e,menuListItemAction:void 0,query:"",mentionType:"user",shareMenuSelection:"mention_and_share"})}}),g.createAndCommit({userAction:"MentionAndInviteUserComponent.setPermission",environment:t,perform:e=>{pi.ep({environment:t,transaction:e,store:s,permissionItems:[{type:"user_permission",role:"editor",user_id:r}],pagePermissionChangeLocation:"mention_share_menu"})}}),li.jB(t,{role:"editor",is_space:!1,invite_targets:[{type:"existingUser",value:{id:r,version:0,email:d}}],is_onboarding:!1,invite_origin:"mention_share_menu",permission_items:[{type:"user_permission",role:"editor",user_id:r}],invite_message_length:0}),gi.d4({item:{label:(0,C.jsx)(oe.FormattedMessage,{id:"mentionMenu.mentionShareMenu.mentionAndShare.snackbarMessage",defaultMessage:"Successfully granted {user} full access",values:{user:l}})},undoFunc:()=>g.createAndCommit({userAction:"MentionAndInviteUserComponent.setPermission.undoShare",environment:t,perform:e=>{pi.ep({environment:t,transaction:e,store:s,permissionItems:[{type:"user_permission",role:"none",user_id:r}],pagePermissionChangeLocation:"mention_share_menu"})}})})}}]},n=io(t)?{menuType:x.og.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${Ri.Z.mobileNativeBottomPadding(t)}px)`}:{menuType:x.og.Popup};return(0,C.jsx)(C.Fragment,{children:(0,C.jsxs)(h.Z,{...n,children:[(0,C.jsx)(Ze.Z,{debugName:"MentionMenu",capture:Ai.Z.state.open}),(0,C.jsx)(Ye.Z,{type:Ye.i.Vertical,initialFocus:0,sections:[e]})]})})}}):null}function Mo(e){let{ignoreSelectionAreaStore:t,inviteTargetsStore:s,personPropertyInviteStore:a,filterStore:r}=e;const l=(0,i.O7)(),d=(0,n.useCallback)((()=>ho(l,s,a)),[l,s,a]),p=(0,o.VK)((()=>mt.np()),[]),m=(0,o.VK)((()=>to()),[]);return p?(0,C.jsx)(Tn.Z,{store:t,capture:!0,ignoreBlockSelection:!1,restoreSelection:!0,render:()=>(0,C.jsx)(ji.Z,{inviteOrigin:m,store:p,onInviteCompleteFn:e=>{if(!e.success)return ho(l,s,a),null;const{invitedUsers:t,requestedUsers:n}=e,i=u.zo(Object.values(t),Object.values(n));i.length?g.createAndCommit({userAction:"MentionMenu.inviteMenu",environment:l,perform:e=>{ui.RL({environment:l,annotations:i.map((e=>(0,c.tEo)(e))),transaction:e,menuListItemAction:void 0,query:fo(l,r),mentionType:"user"})}}):ho(l,s,a)},handleBackButtonClick:d,inviteTargetsStore:s,personPropertyInviteStore:a})}):null}var jo=s(42239);const Co=function(){const e=(0,i.O7)(),t=(0,n.useRef)(void 0);return(0,n.useEffect)((()=>{const s=t=>{t.preventDefault(),function(e,t){const s=jo.f$(t,{startX:e.clientX,startY:e.clientY,stores:[],isNativeDrag:!0,getGhostElement:void 0});s&&Jt.ZH(t)}(t,e),n(t)},n=u.P2((s=>{t.current&&window.clearTimeout(t.current),t.current=window.setTimeout(ko,function(e){const{device:t}=e;return t.isLinux?2e3:200}(e),e),jo.td(e,{currentX:s.clientX,currentY:s.clientY})}),wo),i=t=>{!function(e,t){e.preventDefault();const s=Array.from(e.dataTransfer.files);s.length>0&&jo._4({environment:t,files:s,analyticsFrom:"native_drag"})}(t,e)};return window.addEventListener("dragover",s),window.addEventListener("drop",i),()=>{window.removeEventListener("dragover",s),window.removeEventListener("drop",i)}}),[e]),null},wo=62.5;function ko(e){jo.cQ(e)}var To=s(40902),Io=s(65311),Zo=s(19719),Po=s(8055),Fo=s(50770),Ao=s(19034),_o=s(12252);class Ro extends d.Z{constructor(){super(...arguments),this.lastEmitValue=-1,this.lastSentBadgeNumber=void 0,this.lastSentCurrentSpaceBadgeNumber=void 0,this.handleNotificationEmit=async(e,t)=>{if(t===this.lastEmitValue)return;if(this.lastEmitValue=t,!function(e){if(0===Ao.Z.state.results.length)return!0;if(!document.hasFocus())return!0;if(!e.includes("unreadCount"))return!0;return!1}(String(t)))return;const s=(0,Fo.tO)(this.environment),n=await V.getUserNotifications(this.environment,{size:1e3,isInboxV2:s});if("failed"===n.type)return;const{results:i}=n.data;Ao.Z.setState({results:i}),this.syncInitialBadgeNumber();const o=u.G0.apply(null,i.map((e=>e.unreceived.notificationIds)));for(const a of o)Do(a,this.props.rootStore,this.props.intl,this.environment)},this.handleNotificationEmitThrottled=u.P2(this.handleNotificationEmit,1e3),this.handleNotificationEmitWhenActive=(e,t)=>{_o.Z.whenActive((()=>{this.handleNotificationEmitThrottled(e,t)}))},this.listenerReference=void 0,this.updateBadgeNumbers=()=>{const{mobileNative:e}=this.environment,{allSpaces:t,currentSpace:s}=Bo();e&&(t===this.lastSentBadgeNumber&&s===this.lastSentCurrentSpaceBadgeNumber||e.setBadgeNumber(t,s),this.lastSentCurrentSpaceBadgeNumber=s),t!==this.lastSentBadgeNumber&&(t>0?a.setBadge(`${t}`):a.setBadge("")),this.lastSentBadgeNumber=t},this.syncInitialBadgeNumber=u.IH(this.updateBadgeNumbers)}UNSAFE_willMount(){this.startMessageListeners(),Ao.Z.addListener(this.updateBadgeNumbers),this.environment.mobileNative&&E.default.addListener(this.updateBadgeNumbers)}didUpdate(e){e.rootStore.userId!==this.props.rootStore.userId&&(this.stopMessageListeners(),this.startMessageListeners(),this.handleNotificationEmit("initializeListener",-1))}willUnmount(){this.stopMessageListeners(),Ao.Z.removeListener(this.updateBadgeNumbers),this.environment.mobileNative&&E.default.removeListener(this.updateBadgeNumbers)}startMessageListeners(){const{currentUserStore:e}=E.default.state;if(e){const t=(0,Q.Lp)(e.id);this.listenerReference=$.ZP.addListener(t,this.handleNotificationEmitWhenActive,void 0,this.environment)}}stopMessageListeners(){this.listenerReference&&$.ZP.removeListener(this.listenerReference,this.environment)}}Ro.displayName="NotificationListener";const Oo=(0,oe.injectIntl)(Ro);function Bo(){return{allSpaces:Ao.Z.getTotalUnreadMentionsCount(),currentSpace:Ao.Z.getUnreadCountForCurrentSpace().mentions}}async function Do(e,t,s,n){const i=(0,It.Kv)(t,{table:Io.uX,id:e});await i.load();const o=i.getValue();if(!o)return;const r=(0,we.No)(i,o.activity_id,o.space_id);await r.load();const l=r.getModel(),{currentUserStore:d,currentSpaceViewStore:c}=E.default.state;if(d&&c&&l&&!l.invalid&&!To.BX(l,d.id)&&await a.isMainTabOrWindow()&&"undefined"!=typeof Notification){if(await c.load(),!c.isDefined())return;if(!l.isMentionType())return;if(!c.getNotifyDesktop())return;if(!n.device.isDesktop)return;const e=(0,(await A.deps.desktop.loader()).Notification)({activity:l,getRecordValue:i.getRecordValue,userTimeZone:(0,Hn.r)(),intl:s,pageVisitSource:En.tY.PushNotification});if(!e)return;const{subject:t,body:o}=e,a=new Notification(t,{body:o,silent:!0}),d=To.Fb(l.type),u={medium:"desktop_push",type:d,badge_number:Bo().allSpaces,notification_id:i.id,activity_id:r.id},p=e=>Zo.b2({environment:n,args:u,action:e});p("sent"),a.addEventListener("show",(()=>p("shown"))),a.addEventListener("close",(()=>p("closed"))),a.addEventListener("click",(()=>{const e=To.hY({activity:l,getRecordModel:i.getRecordModel,baseUrl:kt.default.domainBaseUrl,pageVisitSource:En.tY.PushNotification}),t=(0,En.k6)(e,[d,"desktop_push"],En.tY.PushNotification);Po.c4({environment:n,url:t}),p("clicked")}))}}var Lo=s(83105),Vo=s(89224),No=s(58261);const Eo=function(){const e=(0,i.O7)(),t=(0,o.VK)((()=>{const e=v.default.state;if("editing"!==e.mode)return null;const t=(0,y.QY)(e.multiSelection);if(!t)return null;const{store:s,selection:n}=t;if(n.endIndex!==n.startIndex+1)return null;const i=s.getValue(),o=c.b1T(i,n.startIndex);if(!o||!c.eOb(o))return null;const[a]=c.jDe([o]);return{pageId:a,store:s}}),[]),s=(0,n.useCallback)((()=>(0,C.jsx)(Uo,{pageMentionTokenStoreState:t})),[t]);if(e.device.isMobile)return null;const a=Vo.getSelectionRect();return(0,C.jsx)(ge.ZP,{render:()=>{},renderTooltip:s,originRect:a,forceVisibleState:Boolean(t&&a),placement:ge.ug.Bottom})};function Uo(e){let{pageMentionTokenStoreState:t}=e;const s=(0,se.Fg)(),o=(0,i.O7)(),a=(0,n.useCallback)((e=>function(e,t,s){if(!s)return;const{pageId:n,store:i}=s;if(!n)return;e.preventDefault();const o=It.G.createChildStore(i,{table:Mt.iU,id:n});mi._c({store:o,environment:t,visitType:Lo.vu.Link,openInNew:"tab",pageVisitSource:En.tY.MentionInPage})}(e,o,t)),[o,t]),r=(0,n.useCallback)((e=>function(e,t,s){if(!s)return;const{pageId:n,store:i}=s;if(!n)return;e.preventDefault&&e.preventDefault();const o=It.G.createChildStore(i,{table:Mt.iU,id:n});mi._c({store:o,environment:t,visitType:Lo.vu.Link,pageVisitSource:En.tY.MentionInPage})}(e,o,t)),[o,t]);return(0,C.jsx)(Ze.Z,{debugName:"PageMentionOverlay",capture:!0,onEnter:r,onCommandEnter:a,children:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Open page",id:"pageMentionOverlay.openPage"}),(0,C.jsx)("div",{children:(0,C.jsx)(No.Z,{onlyShowFirst:!0,name:"enter",style:{color:s.mediumInvertedTextColor}})})]})})}var Wo=s(43008),Ko=s(64951);function zo(){const e=(0,oe.useIntl)(),t=(0,se.Fg)(),s=(0,i.O7)(),{device:a}=s,{blockStore:r}=(0,o.VK)((()=>Ko.Z.state),[]),l=(0,o.VK)((()=>null==r?void 0:r.getTitleStore()),[r]),d=(0,o.VK)((()=>(null==r?void 0:r.canEdit())??!1),[r]);if((0,n.useEffect)((()=>{const{blockStore:e}=Ko.Z.state;if(!e)return;const t=e.getTitleStore();t&&le.mT({environment:s,store:t,canSelectAllBlocks:!1})}),[s]),!r||!l)return null;let c;return c=a.isMobile?{menuType:x.og.ActionSheet}:{menuType:x.og.Popup,width:380},(0,C.jsx)(h.Z,{...c,children:(0,C.jsx)("div",{style:Go(t),children:(0,C.jsx)(he.Z,{store:l,disabled:!d,onEsc:()=>Wo.x(s),onEnter:()=>Wo.x(s),disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,placeholder:e.formatMessage({defaultMessage:"Untitled",id:"renameFileMenuPopup.input.placeholder"}),style:Ho(t),pasteBehavior:"inline",inPageFind:{type:"none"}})})})}const qo=function(){const e=(0,i.O7)(),{device:t}=e,{blockStore:s,originRect:n}=(0,o.VK)((()=>Ko.Z.state),[]);return(0,C.jsx)(f.ZP,{popupType:t.isMobile?f.ZP.PopupType.SlideUp:f.ZP.PopupType.Popup,open:Boolean(s),originRect:n,placementToOrigin:f.ZP.Placement.Bottom,alignmentToOrigin:f.ZP.Alignment.Center,originGap:4,onDismiss:()=>Wo.x(e),render:()=>(0,C.jsx)(zo,{})})};function Go(e){return{display:"flex",alignItems:"center",color:e.regularTextColor,fontSize:"13px",padding:"4px 8px"}}function Ho(e){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}}var Yo=s(9953),Qo=s(52771),$o=s(82187),Jo=s(31278);function Xo(e){const t=(0,oe.useIntl)(),s=(0,i.O7)(),{device:a}=s,r=(0,o.VK)((()=>$o.Z.state.clonedBlockStore),[]),l=(0,o.VK)((()=>null==r?void 0:r.getTitleStore()),[r]),d=(0,o.VK)((()=>(null==r?void 0:r.canEdit())??!1),[r]),c=(0,o.VK)((()=>{var e;if(r)return null===(e=r.getModel())||void 0===e?void 0:e.getEmptyTitlePlaceholder({getRecordModel:r.getRecordModel,userTimeZone:(0,Hn.r)(),intl:t})}),[r,t]);(0,n.useEffect)((()=>{if(!r)return;const e=r.getTitleStore();e&&le.mT({environment:s,store:e,canSelectAllBlocks:!1})}),[r,s]);const u=(0,se.yK)((e=>({wrapper:{display:"flex",alignItems:"center",color:e.regularTextColor,fontSize:"13px",padding:"4px 8px"},input:{display:"block",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}})),[]);if(!r||!l)return null;const{renderDelete:p}=e;let m;return m=a.isMobile?{menuType:x.og.ActionSheet}:{menuType:x.og.Popup,width:380},(0,C.jsx)(h.Z,{...m,children:(0,C.jsxs)("div",{style:u.wrapper,children:[(0,C.jsx)(na,{blockStore:r}),(0,C.jsx)(he.Z,{store:l,disabled:!d,onEsc:()=>Qo.x(s),onEnter:()=>Qo.x(s),disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,placeholder:c,style:u.input,pasteBehavior:"inline",inPageFind:{type:"none"}}),p&&d&&(0,C.jsx)(ta,{})]})})}const ea=function(){const e=(0,i.O7)(),{device:t}=e,{clonedBlockStore:s,originRect:n}=(0,o.VK)((()=>$o.Z.state),[]);return(0,C.jsx)(f.ZP,{popupType:t.isMobile?f.ZP.PopupType.SlideUp:f.ZP.PopupType.Popup,open:Boolean(s),originRect:n,placementToOrigin:f.ZP.Placement.Bottom,alignmentToOrigin:f.ZP.Alignment.Center,originGap:4,onDismiss:()=>Qo.x(e),render:()=>(0,C.jsx)(sa,{})})};function ta(){const e=(0,i.O7)();return(0,C.jsx)(me.Z,{ariaLabel:"Delete",icon:e=>(0,bn.y)({height:20,width:20,...e}),style:{marginLeft:6},hasBackground:!0,isDarkIconColor:!0,showShadow:!0,onClick:async()=>{const{originalBlockStore:t}=$o.Z.state;t&&await $t.Qw({environment:e,blocks:[t],shouldCheckSuggestEdit:!0}),Qo.x(e)}})}function sa(){const{renderDelete:e}=(0,o.VK)((()=>$o.Z.state),[]);return(0,C.jsx)(Xo,{renderDelete:Boolean(e)})}function na(e){let{blockStore:t}=e;const s=(0,se.Fg)(),n=(0,i.O7)(),a={width:28,height:28,marginRight:6,flexShrink:0,flexGrow:0,boxShadow:`inset 0 0 0 1px ${s.darkDividerColor}`},r=(0,o.VK)((()=>t.canEdit()),[t]),l=(0,o.VK)((()=>{var e;return null===(e=t.getIconStore())||void 0===e?void 0:e.table}),[t]),d=(0,o.VK)((()=>{var e;return null===(e=t.getIconStore())||void 0===e?void 0:e.id}),[t]),c=(0,o.VK)((()=>t.getIcon()),[t]),u=(0,o.VK)((()=>t.isEmptyPage()),[t]),p=(0,o.VK)((()=>t.getType()),[t]);return r?(0,C.jsx)(Jo.Z,{disabled:!1,bucket:"secure",store:t,icon:c,isEmptyPage:u,size:18,style:a,iconLoggingData:{recordTable:l,source:"breadcrumb",block_type:p,collection_id:"collection"===l?d:void 0},onChange:e=>function(e,t){const{clonedBlockStore:s}=$o.Z.state;if(s){const n=s.getIconStore();n&&g.createAndCommit({userAction:"RenamePageMenuPopup.handleRecordIconChange",environment:t,perform:t=>{Yo.sO({store:n,value:e,transaction:t})}})}}(e,n)}):(0,C.jsx)(Jo.Z,{disabled:!0,icon:c,isEmptyPage:u,size:18,style:a})}var ia=s(42853);const oa=(0,Et.IU)("code",{viewBox:"0 0 30 30",svg:(0,C.jsx)("path",{d:"M11.625,4L0,15l11.625,11L13,24.563L2.906,15L13,5.438L11.625,4z M18.375,4L17,5.438L27.094,15L17,24.563L18.375,26L30,15L18.375,4z"})});var aa=s(69634),ra=s(22962),la=s(11751),da=s(6287),ca=s(80503),ua=s(11732),pa=s(56863),ma=s(92022),ga=s(40350),ha=s(64921),fa=s(18821);function xa(e){const t=(0,i.O7)(),s=(0,n.useRef)(null),o=(0,se.yK)((e=>({shortcut:{color:e.mediumInvertedTextColor},reactionIcon:{width:15,height:20,marginTop:.5,marginLeft:.5,fill:e.regularIconColor}})),[]),a=()=>{const s=v.default.state;"empty"!==s.mode&&fa.Bf({environment:t,blockStore:e.blockStore,multiSelection:s.multiSelection})};return(0,C.jsx)(ge.ZP,{renderTooltip:()=>(0,C.jsxs)(n.Fragment,{children:[(0,C.jsx)("div",{children:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"React to selected text",id:"inlineReactionButton.tooltip"})}),(0,C.jsx)("div",{children:(0,C.jsx)(No.Z,{style:o.shortcut,name:"react"})})]}),render:t=>(0,C.jsx)(ha.Z,{ref:s,style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",...e.style},disabled:e.disabled,disabledFeedback:e.disabled,onClick:a,...t,children:(0,ga.V)(o.reactionIcon)})})}xa.displayName="InlineReactionButton";const ya=xa;var Sa=s(49117),va=s(19124),ba=s(40959),Ma=s(87078),ja=s(45162),Ca=s(35328),wa=s(5971),ka=s(15723),Ta=s(807),Ia=s(45214),Za=s(17903),Pa=s(4548),Fa=s(42057),Aa=s(49557),_a=s(4935),Ra=s(99757),Oa=s(13966),Ba=s(48019),Da=s(31945),La=s(64131),Va=s(82945),Na=s(60597),Ea=s(50799);function Ua(e){const t=(0,i.O7)().device.isMobile,s=(0,o.VK)((()=>"suggest"===Ta.Z.getMode(e.blockStore)),[e.blockStore]),a=()=>{Ea.t(e.blockStore,s?"default":"suggest")},r=(0,se.yK)((n=>({button:{display:"flex",alignItems:"center",padding:e.iconOnly?"0 8px":"0 10px",whiteSpace:"nowrap",color:s?n.blueColor:void 0,...e.style},icon:{width:t?18:16,height:t?18:16,marginTop:t?0:1,marginRight:e.iconOnly?0:4}})),[t,s,e.iconOnly,e.style]);return(0,C.jsx)(ge.ZP,{renderTooltip:()=>(0,C.jsxs)(n.Fragment,{children:[(0,C.jsx)("div",{children:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Suggest on selected text",id:"inlineSuggestButton.tooltip"})}),(0,C.jsx)("div",{})]}),render:s=>(0,C.jsxs)(ha.Z,{style:r.button,disabled:e.disabled,disabledFeedback:e.disabled,onClick:a,...s,children:[(0,Na.y)(r.icon),!t&&!e.iconOnly&&(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Suggest",id:"inlineSuggestButton.suggestLabel"})]})})}var Wa=s(40464),Ka=s(32404),za=s(73383);const qa={[je.Ti.code]:new Set(["showMention","showCode","showCompletions"]),[je.Ti.table]:new Set(["showTurnInto","showActionButton","showCompletions"]),[je.Ti.tableRow]:new Set(["showTurnInto","showActionButton","showCompletions"])},Ga={[je.Ti.factory]:!0};class Ha extends d.Z{constructor(){super(...arguments),this.mouseIsDownExternally=!1,this.lastRenderState=void 0,this.completionContextOnOpen=void 0,this.renderOverlay=()=>{const{isActive:e}=Aa.Z.state;return(0,C.jsx)(ss.Z,{isVisible:e,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:this.renderAnimated,onAnimationEnd:this.handleAnimationEnd})},this.renderAnimated=()=>{const{top:e,left:t}=Aa.Z.state,s=this.canOnlyDiscussStore.state,n=Math.max(s?t:t-60,0),i=s?"12px 0":12;return(0,C.jsxs)("div",{className:Ke.Qcf,style:{pointerEvents:"none",position:"absolute",top:e,left:0,display:"flex",width:"100%"},children:[(0,C.jsx)("div",{style:{flexShrink:1,width:n,minWidth:24}}),(0,Xt.Z)((e=>(0,C.jsx)("div",{style:{pointerEvents:"none",padding:i},...e,children:this.lastRenderState&&(0,C.jsx)(ur,{renderState:this.lastRenderState})}))),(0,C.jsx)("div",{style:{flexGrow:1,flexShrink:1,minWidth:36}})]})},this.updateRichTextState=()=>{const e=Aa.Z.state;if(rn.Z.state.open||_a.Z.state.open)return;if(Ra.n.state)return pa.w();const t=v.default.state;if("empty"===t.mode)return pa.w();const s=(0,ja.L5)(t.multiSelection);if(0===s.length)return pa.w();if(!s.every((e=>{let{store:t}=e;return t.table===Mt.iU||t.table===qt.x_||t.table===da.vF})))return pa.w();if(!this.environment.currentUser.isLoggedIn()||!s.every((e=>{let{store:t}=e;return t.canComment()})))return;const n=Vo.get();if(mt.JE())return pa.w();if(s.some((e=>{let{editable:t}=e;return t.props.disableStyleAnnotations})))return pa.w();const i=s.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()}));if(z.default.checkGate("prevent_edits_trash")&&i.some((e=>e&&e.pathIsDead())))return pa.w();if(i.some(((e,t)=>{const n=s[t].store.canComment(),i=s[t].store.table===qt.x_&&s[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!n||i})))return pa.w();if(this.mouseIsDownExternally&&e.blockTarget!==i[0])return pa.w();const o=s.some((e=>{let{store:t}=e;const s=t.getRecordStoreAtRootPath();if(!(s instanceof It.G))return!1;const n=s.getValue();return!!n&&Ga[n.type]}));if(o)return pa.w();const a=n?Vo.getRect(n):void 0;if(a&&!ka.kK(a,(0,Ma.Z)()))return pa.w();if($o.Z.isActive()||Ko.Z.isActive()||Ds.Z.isOpen()||o||!n||!function(){const e=Vo.get();return!!e&&!e.collapsed&&"empty"!==v.default.state.mode&&!(0,y.iG)(v.default.state.multiSelection)}()||Ia.Z.state.open)return pa.w();let r=0,l=0;if(a){r=a.left;const e=25,t=a.top-32-e,s=ca.R6(this.environment.device.isElectronMac),n=this.environment.WindowSizeStore.state.height-32-e;l=Math.min(Math.max(t,s),n)}0===Math.abs(Aa.Z.state.top-l)&&Math.abs(Aa.Z.state.left-r)<10&&(l=Aa.Z.state.top,r=Aa.Z.state.left),Aa.Z.setState({...Aa.Z.state,isActive:!0,isAnimatingClosed:!1,top:l,left:r,blockTarget:Ge.default.state.stores[0]})},this.updateRichTextStateThrottled=u.P2(this.updateRichTextState,200,{leading:!1}),this.handleAnimationEnd=()=>{Aa.Z.state.isActive||Aa.Z.setState({...Aa.Z.state,isAnimatingClosed:!1}),this.lastRenderState=this.renderStateStore.state},this.renderStateStore=this.createComputedStore((()=>{const{isActive:e,blockTarget:t}=Aa.Z.state,s=v.default.state;if(!e||"empty"===s.mode)return;const{multiSelection:n}=s,i=(0,ja.L5)(n),o=i.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()})),a=(0,y.qS)(n),r=v.default.isEditingComment(),l=v.default.isEditingCaption(),d=t&&t.getParentTable()===da.vF,c=a&&t&&n.start.store===t.getCollectionViewSourceDescriptionStore(),u=this.pageContext&&this.pageContext.publicEditModeStore.state,p=!(0,vi.YF)(u)&&(n.start.store.canEdit()&&n.end.store.canEdit()),m=z.default.checkGate("human_suggested_edits"),g=m&&t&&"suggest"===Ta.Z.getMode(t),h=o.some(((e,t)=>{const s=i[t].store.table===qt.x_&&!i[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!s})),f=p&&!h,x=t&&t.getType(),S=x&&qa[x],b=null==t?void 0:t.isType("button"),M=(0,Sa.td)(n.start.store)||(0,Sa.td)(n.end.store),j={isSingleStoreSelection:a,showTurnInto:Boolean(a&&!r&&!d&&!c&&!l&&t&&f&&!b&&!g),showBold:Boolean(f),showItalic:Boolean(f),showStrikethrough:Boolean(f),showUnderline:Boolean(f),showCode:Boolean(f),showLink:Boolean(a&&f),showHighlight:Boolean(f),showDiscuss:Boolean(!r&&t&&!d&&!c&&!M),showSuggest:Boolean(m&&!r&&t&&!d&&!c&&!M),showEquation:Boolean(a&&f&&!g),showMention:Boolean(a&&!r&&t&&!d&&f&&!m),showActionButton:Boolean(a&&!r&&!l&&t&&!d),blockTarget:t,isComment:r,showCompletions:Boolean((0,va.GD)(u)&&f&&!r&&!l&&t&&!d&&!c&&!b&&!M&&!g)};if(S&&S.size>0)for(const y of S)j[y]=!1;return j})),this.canOnlyDiscussStore=this.createComputedStore((()=>{const e=this.renderStateStore.state;return e&&e.showDiscuss&&!e.showBold}))}didMount(){Ge.default.addListener(this.updateRichTextStateThrottled),v.default.addListener(this.updateRichTextStateThrottled),Za.Z.addListener(this.updateRichTextState),Fa.Z.addListener(this.updateRichTextState),Pa.Z.addListener(this.updateRichTextState)}willUnmount(){v.default.removeListener(this.updateRichTextStateThrottled),Ge.default.removeListener(this.updateRichTextStateThrottled),Za.Z.removeListener(this.updateRichTextState),Fa.Z.removeListener(this.updateRichTextState),Pa.Z.removeListener(this.updateRichTextState)}UNSAFE_willMountOrUpdate(){const e=this.renderStateStore.state;e&&(this.lastRenderState=e)}renderComponent(){const{isActive:e,isAnimatingClosed:t}=Aa.Z.state;return(0,C.jsx)(is.Z,{open:e||t,children:this.renderOverlay()})}}Ha.displayName="RichTextMenu";const Ya=(0,oe.injectIntl)(Ha);function Qa(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return{boxShadow:`1px 0 0 ${e.regularDividerColor}`,marginRight:1}}function $a(e){let{blockStore:t}=e;const s=(0,se.Fg)(),n=(0,i.O7)(),a=(0,oe.useIntl)();let r=(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.label"});const l=(0,o.VK)((()=>t.getType()),[t]);if(l){const e=ba.Hc[l];r=e&&e.displayName||r}return(0,C.jsx)(Da.ZP,{popupType:Da.Z4.Popup,buttonPopupStore:_a.Z,originGap:4,renderOrigin:e=>(0,C.jsx)(ge.ZP,{renderTooltip:()=>a.formatMessage({defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.tooltip"}),render:t=>(0,C.jsxs)(ha.Z,{style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",...Qa(s)},...(0,Si.Z)(e,t),children:[r,(0,ia.i)({width:10,marginLeft:4,fill:s.lightIconColor})]})}),render:()=>(0,C.jsx)(h.Z,{menuType:x.og.Popup,children:(0,C.jsx)(Ba.Z,{context:{blocks:[t],environment:n,publicEditMode:void 0},sections:[ua.g],onAccept:e=>{const s=t.getType(),i=t.getFormat();pa.w(),Yt.dh(n,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"rich_text_menu",block_id:t.id,block_type:s,is_toggleable:s?(0,Ca._A)(s,i):void 0,parent_collection_id:t.getParentCollectionIdUpToTwoLevels()})}})}),onClick:()=>{Yt.mt(n,{action:"turn_into"})}})}function Ja(){const e=(0,se.Fg)();return(0,C.jsx)(Wa.Z,{type:"b",tooltipLabel:(0,C.jsxs)(n.Fragment,{children:[(0,C.jsx)("div",{children:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Bold",id:"richTextMenu.boldButton.tooltip"})}),(0,C.jsx)("div",{children:(0,C.jsx)(No.Z,{style:{color:e.mediumInvertedTextColor},name:"toggleBold"})})]}),children:(0,C.jsx)("span",{style:{fontWeight:ae.Z.fontWeight.semibold},children:"B"})})}function Xa(){const e=(0,se.Fg)();return(0,C.jsx)(Wa.Z,{type:"i",tooltipLabel:(0,C.jsxs)(n.Fragment,{children:[(0,C.jsx)("div",{children:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Italicize",id:"richTextMenu.italicsButton.tooltip"})}),(0,C.jsx)("div",{children:(0,C.jsx)(No.Z,{style:{color:e.mediumInvertedTextColor},name:"toggleItalics"})})]}),children:(0,C.jsx)("span",{style:{fontStyle:"italic"},children:"i"})})}function er(){const e=(0,se.Fg)();return(0,C.jsx)(Wa.Z,{type:"s",tooltipLabel:(0,C.jsxs)(n.Fragment,{children:[(0,C.jsx)("div",{children:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Strike-through",id:"richTextMenu.strikeThroughButton.tooltip"})}),(0,C.jsx)("div",{children:(0,C.jsx)(No.Z,{style:{color:e.mediumInvertedTextColor},name:"toggleStrike"})})]}),children:(0,C.jsx)("span",{style:{textDecoration:"line-through"},children:"S"})})}function tr(){const e=(0,se.Fg)();return(0,C.jsx)(Wa.Z,{type:"_",tooltipLabel:(0,C.jsxs)(n.Fragment,{children:[(0,C.jsx)("div",{children:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Underline",id:"richTextMenu.underlineButton.tooltip"})}),(0,C.jsx)("div",{children:(0,C.jsx)(No.Z,{style:{color:e.mediumInvertedTextColor},name:"toggleUnderline"})})]}),children:(0,C.jsx)("span",{style:{textDecoration:"underline"},children:"U"})})}function sr(){const e=(0,se.Fg)();return(0,C.jsx)(Wa.Z,{type:"c",style:{padding:"0 6px"},tooltipLabel:(0,C.jsxs)(n.Fragment,{children:[(0,C.jsx)("div",{children:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Mark as code",id:"richTextMenu.markAsCodeButton.tooltip"})}),(0,C.jsx)("div",{children:(0,C.jsx)(No.Z,{style:{color:e.mediumInvertedTextColor},name:"toggleCode"})})]}),children:oa({width:15,height:15})})}function nr(e){let{enableInlinePageCreationFeature:t}=e;const s=(0,se.Fg)(),n=(0,i.O7)().device.isMobile;return(0,C.jsxs)(za.Z,{style:Qa(s),children:[t&&(0,Qn.J)({width:n?18:16,height:n?18:16,marginRight:4,fill:s.regularIconColor}),(0,C.jsx)("span",{style:{borderBottom:`1px solid ${s.linkDecorationColor}`},children:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Link",id:"richTextMenu.linkButton.tooltip"})})]})}function ir(e){let{intl:t}=e;const s=(0,se.Fg)(),n=(0,i.O7)();return(0,C.jsx)(ge.ZP,{renderTooltip:()=>(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{children:t.formatMessage({defaultMessage:"Ask AI to help edit, review, or generate text.",id:"richTextMenu.assist.tooltip"})}),(0,C.jsx)("div",{children:(0,C.jsx)(No.Z,{style:{color:s.mediumInvertedTextColor},name:"commandJ"})})]}),render:e=>(0,C.jsxs)(ha.Z,{style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",...Qa(s)},...e,onClick:()=>{(0,ma.toggleInitialPrompt)({from:"rich_text_menu",environment:n}),Yt.mt(n,{action:"completions"})},children:[(0,la.t)({width:16,height:16,fill:Ht.FN.light.purple[400],marginRight:4}),(0,C.jsx)("span",{style:{color:Ht.FN.light.purple[400],fontWeight:500},children:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Ask AI",id:"richTextMenu.assistButton.label"})})]})})}function or(){const e=(0,se.Fg)(),t=(0,i.O7)();return(0,C.jsx)(Ka.Z,{style:Qa(e),onClick:()=>{Yt.mt(t,{action:"e"}),pa.w()},children:(0,aa.G)({width:16,height:16})})}function ar(){const e=(0,se.Fg)(),t=(0,i.O7)();return(0,C.jsx)(ge.ZP,{renderTooltip:()=>(0,C.jsxs)(n.Fragment,{children:[(0,C.jsx)("div",{children:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Mention a person,{br}page, or date",id:"richTextMenu.mentionButton.tooltip",values:{br:(0,C.jsx)("br",{})}})}),(0,C.jsx)("div",{style:{color:e.mediumInvertedTextColor},children:"@"})]}),render:s=>(0,C.jsx)(ha.Z,{style:{...Qa(e),padding:"0 8px"},...s,onClick:()=>{ui.lZ(t,{page:!0,heading:!0,createPage:!0,user:!0,inviteUserToWorkspace:!0,inviteUserToPage:!0,bot:!0,date:!0,reminder:!0,templateVariable:!0,group:!0}),Yt.mt(t,{action:"mention"})},children:(0,ra.O)({width:14,fill:e.regularTextColor})})})}function rr(e){let{blockTarget:t,iconOnly:s,disableBorderRight:n}=e;const i=(0,se.Fg)();return(0,C.jsx)(Va.Z,{style:Qa(i,n),iconOnly:s,blockStore:t})}function lr(e){let{blockTarget:t,disableBorderRight:s}=e;const n=(0,se.Fg)();return(0,wa.E)("block_reactions")?(0,C.jsx)(ya,{style:Qa(n,s),blockStore:t}):null}function dr(e){let{blockTarget:t}=e;const s=(0,se.Fg)();return(0,C.jsx)(Ua,{style:Qa(s),iconOnly:!0,blockStore:t})}function cr(e){let{target:t}=e;const s=(0,se.Fg)(),n=(0,i.O7)();return(0,C.jsx)(Oa.Z,{store:t,style:{borderRight:"none",borderRadius:0,padding:0,width:30,height:"none"},iconStyle:{fill:s.regularTextColor},fadeIn:!1,onClick:()=>{Yt.mt(n,{action:"more"})}})}function ur(e){let{renderState:t}=e;const s=(0,oe.useIntl)(),n=(0,se.Fg)(),{isActive:i}=(0,o.VK)((()=>Aa.Z.state),[]);return(0,C.jsxs)("div",{style:{display:"inline-flex",alignItems:"stretch",height:32,background:n.popoverBackground,overflow:"hidden",fontSize:14,lineHeight:1.2,borderRadius:5,boxShadow:n.mediumBoxShadow,pointerEvents:i?"auto":"none"},onMouseDown:e=>e.preventDefault(),children:[t.showCompletions&&(0,C.jsx)(ir,{intl:s}),t.showTurnInto&&t.blockTarget&&(0,C.jsx)($a,{blockStore:t.blockTarget}),t.showLink&&(0,C.jsx)(nr,{enableInlinePageCreationFeature:!0}),t.showDiscuss&&t.blockTarget&&(0,C.jsx)(rr,{blockTarget:t.blockTarget,iconOnly:t.showSuggest,disableBorderRight:t.showSuggest}),t.showDiscuss&&t.blockTarget&&(0,C.jsx)(lr,{blockTarget:t.blockTarget,disableBorderRight:t.showSuggest}),t.showSuggest&&t.blockTarget&&(0,C.jsx)(dr,{blockTarget:t.blockTarget}),(0,C.jsxs)("div",{style:{display:"flex"},children:[t.showBold&&(0,C.jsx)(Ja,{}),t.showItalic&&(0,C.jsx)(Xa,{}),t.showUnderline&&(0,C.jsx)(tr,{}),t.showStrikethrough&&(0,C.jsx)(er,{}),t.showCode&&(0,C.jsx)(sr,{}),t.showEquation&&(0,C.jsx)(or,{})]}),t.showHighlight&&(0,C.jsx)(La.Z,{style:Qa(n)}),t.showMention&&(0,C.jsx)(ar,{}),t.showActionButton&&t.blockTarget&&(0,C.jsx)(cr,{target:t.blockTarget})]})}s(21703);var pr=s(14248),mr=s(14714),gr=s(29369),hr=s(40663),fr=s(10906),xr=s(19037),yr=s(79954),Sr=s(55367),vr=s(12211),br=s(50628);const Mr=200,jr=30,Cr=125,wr=25;var kr=function(e){return e[e.Selectable=0]="Selectable",e[e.DropTarget=1]="DropTarget",e}(kr||{});function Tr(e){return e.type===kr.Selectable?{type:Sr.Dl.Selectable,store:e.target.props.store,direction:e.direction}:{type:Sr.Dl.DropTarget,key:e.target.props.dropTargetKey,direction:e.direction}}function Ir(e){const{target:t,device:s,direction:n,points:i}=e;return n===Sr.vh.Onto||!s.isPhone||t.props.dropzoneShouldNeverUseOrigin?i.mousePoint:{x:i.originPoint.x,y:i.mousePoint.y}}function Zr(e){return e instanceof yr.Z?{type:kr.Selectable,target:e}:{type:kr.DropTarget,target:e}}function Pr(e){if(!(e&&e instanceof yr.Z))return!1;let t=e;const s=Sr.ZP.state;if(!s.isDragging)return!1;const{draggedStores:n}=s;for(;t;){if(n.indexOf(t.props.store)>=0)return!0;t=t.getContextClosestSelectable()}return!1}function Fr(e){const{dropzoneMustBeWithinHorizontalBound:t,device:s}=e;return t?0:s.isPhone?9999:0}function Ar(e){switch(e.direction){case Sr.vh.Onto:return function(e){const{device:t,isNativeDrag:s,rect:n,target:i,points:o,priority:a,canAcceptDrop:r}=e,l=Sr.vh.Onto,d=Ir({device:t,target:i,direction:l,points:o});if((s?i.props.canNativeDropOnto:i.props.canDropOnto)&&Rr(d,n)&&!Pr(i)&&r(i,l))return{...Zr(i),direction:l,left:n.left,top:n.top,width:n.width,height:n.height,priority:a}}(e);case Sr.vh.Left:return function(e){const{device:t,isNativeDrag:s,rect:n,target:i,points:o,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=Sr.vh.Left,c=Ir({device:t,target:i,direction:d,points:o});if((s?i.props.canNativeDropLeft:i.props.canDropLeft)&&n&&c.y>=n.top&&c.y<=n.bottom&&Math.abs(c.x-n.left)<=Mr&&(r||!Pr(i))&&l(i,d))return{...Zr(i),direction:d,left:n.left,top:n.top,width:0,height:n.height,priority:a}}(e);case Sr.vh.Right:return function(e){const{device:t,isNativeDrag:s,rect:n,target:i,points:o,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=Sr.vh.Right,c=Ir({device:t,target:i,direction:d,points:o});if((s?i.props.canNativeDropRight:i.props.canDropRight)&&n&&c.y>=n.top&&c.y<=n.bottom&&Math.abs(c.x-n.right)<=Mr&&(r||!Pr(i))&&l(i,d))return{...Zr(i),direction:d,left:n.right,top:n.top,width:0,height:n.height,priority:a}}(e);case Sr.vh.Above:return function(e){const{device:t,isNativeDrag:s,rect:n,target:i,points:o,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=Fr({dropzoneMustBeWithinHorizontalBound:i.props.dropzoneMustBeWithinHorizontalBound,device:t}),c=Sr.vh.Above,u=Ir({device:t,target:i,direction:c,points:o});if((s?i.props.canNativeDropAbove:i.props.canDropAbove)&&n&&u.x>=n.left-jr-d&&u.x<=n.right+d&&(r||!Pr(i))&&Math.abs(u.y-n.top)<=Cr&&(n.height<=2*wr||u.y<=n.top+wr)&&l(i,c))return{...Zr(i),direction:c,left:n.left,top:n.top,width:n.width,height:0,priority:a}}(e);case Sr.vh.Below:return function(e){const{device:t,isNativeDrag:s,rect:n,target:i,points:o,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=Fr({dropzoneMustBeWithinHorizontalBound:i.props.dropzoneMustBeWithinHorizontalBound,device:t}),c=i.props.isLastItem?Number.MAX_SAFE_INTEGER:Cr,u=Sr.vh.Below,p=Ir({device:t,target:i,direction:u,points:o});if((s?i.props.canNativeDropBelow:i.props.canDropBelow)&&n&&p.x>=n.left-jr-d&&p.x<=n.right+d&&Math.abs(p.y-n.bottom)<=c&&(n.height<=2*wr||p.y>=n.bottom-wr)&&(r||!Pr(i))&&l(i,Sr.vh.Below))return{...Zr(i),direction:Sr.vh.Below,left:n.left,top:n.bottom,width:n.width,height:0,priority:a}}(e)}}function _r(e){const{device:t,rect:s,target:n,points:i,optionKeyDown:o}=e;return Rr(Ir({device:t,target:n,direction:Sr.vh.Onto,points:i}),s)&&Pr(n)&&!o}function Rr(e,t){return Boolean(t&&e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom)}var Or=s(28314),Br=s(75770),Dr=s(35026),Lr=s(17031),Vr=s(27406),Nr=s(81844),Er=s(16339),Ur=s(95802),Wr=s(91681),Kr=s(86486);class zr extends d.Z{constructor(){super(...arguments),this.isUpdatingDragState=!1,this.didTouchEnd=!1,this.lastMouseInfo=void 0,this.handleWindowMouseMove=e=>{const t=Kr.default.state;if(!e||t.isOpen&&t.menuIsOpen||(this.lastMouseInfo={target:e.target,x:e.clientX,y:e.clientY}),this.didTouchEnd)return void(this.didTouchEnd=!1);const{isDragging:s}=Sr.ZP.state;if(s)this.updateDragState();else{if(!this.lastMouseInfo)return;Yr(this.lastMouseInfo.target,this.lastMouseInfo.x,this.lastMouseInfo.y)}},this.handleDragBlockStoreChange=()=>{this.isUpdatingDragState||this.handleWindowMouseMoveThrottled(void 0)},this.handleWindowMouseMoveThrottled=u.P2((e=>yn.Z.withListenerIgnored((()=>this.handleWindowMouseMove(e)))),60),this.handleSelectionChange=()=>{const{isDragging:e}=Sr.ZP.state;$s.default.afterNextFlush((()=>{this.lastMouseInfo&&!e&&Yr(this.lastMouseInfo.target,this.lastMouseInfo.x,this.lastMouseInfo.y)}))},this.handleSelectionChangeThrottled=u.P2(this.handleSelectionChange,60),this.handleWindowKeyEvent=()=>{const{isDragging:e}=Sr.ZP.state;e&&this.updateDragState()},this.handleWindowTouchEnd=()=>{this.didTouchEnd=!0},this.memoizedCanDragCache=new WeakMap,this.memoizedCanDrag=e=>{const t=this.memoizedCanDragCache.get(e);if(this.memoizedCanDragCache.has(e))return t;const s=(0,xr.OOI)({environment:this.environment,blocks:e,publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state});return this.memoizedCanDragCache.set(e,s),s}}didMount(){super.didMount();const{device:e}=this.environment;qs.lj(window,"mousemove",this.handleWindowMouseMoveThrottled),Ge.default.addListener(this.handleSelectionChangeThrottled),e.isIOS&&qs.lj(window,"touchend",this.handleWindowTouchEnd),qs.lj(window,"keydown",this.handleWindowKeyEvent),qs.lj(window,"keyup",this.handleWindowKeyEvent),Sr.ZP.addListener(this.handleDragBlockStoreChange),qs.lj(window,"scroll",Jr,!0),qs.lj(window,"resize",Xr),mt.kw.addListener(el),Jt.Jy()}willUnmount(){super.willUnmount();const{device:e}=this.environment;qs.ZV(window,"mousemove",this.handleWindowMouseMoveThrottled),Ge.default.removeListener(this.handleSelectionChangeThrottled),e.isIOS&&qs.ZV(window,"touchend",this.handleWindowTouchEnd),qs.ZV(window,"keydown",this.handleWindowKeyEvent),qs.ZV(window,"keyup",this.handleWindowKeyEvent),Sr.ZP.removeListener(this.handleDragBlockStoreChange),qs.ZV(window,"scroll",Jr,!0),qs.ZV(window,"resize",Xr),mt.kw.removeListener(el)}updateDragState(){if(this.isUpdatingDragState)throw new Error("Assertion failure, updateDragState() called when this.isUpdatingDragState === true!");this.isUpdatingDragState=!0;try{this.updateDragStateInner()}finally{this.isUpdatingDragState=!1}}updateDragStateInner(){const e=Sr.ZP.state;if(!e.isDragging)return;const{draggedStores:t,currentX:s,currentY:n,offsetX:i,offsetY:o,isNativeDrag:a}=e,r={x:s,y:n},l={x:s-i,y:n-o},d=this.findNearbyDropZones({mousePoint:r,originPoint:l},t[0],a);if(d.ontoDropZone)Sr.ZP.setState({...e,currentDropZone:d.ontoDropZone,currentHintDropZones:[],currentParentStore:void 0});else if(d.verticalDropZone)Sr.ZP.setState({...e,currentDropZone:d.verticalDropZone,currentHintDropZones:[],currentParentStore:void 0});else{if(d.horizontalDropZones.length>0){const t=d.horizontalDropZones[0],s=u.Gb(d.horizontalDropZones);if(t.type===Sr.Dl.Selectable){const n=Ur.C.findSelectableFromStore(t.store);if(n){const i=n.getContextClosestSelectable();let o;return i&&i.props.store!==t.store&&i.props.shouldShowParentHalo&&(o=i.props.store),void Sr.ZP.setState({...e,currentDropZone:t,currentHintDropZones:s,currentParentStore:o})}}else{if(Vr.Z.findDropTargetFromKey(t.key))return void Sr.ZP.setState({...e,currentDropZone:t,currentHintDropZones:s,currentParentStore:void 0})}}Sr.ZP.setState({...e,currentDropZone:void 0,currentHintDropZones:[],currentParentStore:void 0})}}findNearbyDropZones(e,t,s){const{device:n}=this.environment,i=Or.yA(),o=function(){const{selectableRectMap:e}=br.Z.state,{dropTargetRectMap:t}=vr.Z.state,s=new Map;return e.forEach(((e,t)=>{s.set(t,e)})),t.forEach(((e,t)=>{s.set(t,e)})),s}(),a=o.keys();let r=a.next();const l=Ur.C.findSelectableFromStore(t),d=l?l.getContextSelectableContainer():void 0;let c=[];for(;!r.done;){const t=r.value;r=a.next();const l=o.get(t),p=t.getContextSelectableContainer();if(n.isPhone&&p!==d)continue;if(!p||p.props.disable)continue;const m=Hr(p),g={device:this.environment.device,isNativeDrag:s,rect:l,target:t,points:e,priority:m,optionKeyDown:i.option,canAcceptDrop:(e,t)=>this.selectableCanAcceptDrop(e,t,i.option)};if(_r(g))return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};c.push(...u.oA([Ar({...g,direction:Sr.vh.Onto}),Ar({...g,direction:Sr.vh.Left}),Ar({...g,direction:Sr.vh.Right}),Ar({...g,direction:Sr.vh.Above}),Ar({...g,direction:Sr.vh.Below})]))}c=function(e){const t=$r(u.UT(e,$r));return e.filter((e=>$r(e)===t))}(c);const p=c.filter((e=>e.direction===Sr.vh.Above||e.direction===Sr.vh.Below)),m=u.F(p,(t=>Math.abs(t.top-Qr(t,e,this.environment).y)));let g=p.filter((e=>{let{top:t}=e;return Math.abs(t-(m?m.top:0))<=2}));if(g.length>1){g=g.filter((t=>{const s=Qr(t,e,this.environment).x,n=Fr({device:this.environment.device});return s>=t.left-n&&s<=t.left+t.width+n})),g=u.MR(g,(e=>{let{left:t}=e;return t}));let t=0;for(;t<g.length-1;t++){const s=g[t+1],n=Qr(s,e,this.environment).x;if(s.left>n)break}g=g.slice(0,t+1),g.reverse()}const h=g.map(Tr);let f;const x=c.filter((e=>e.direction===Sr.vh.Onto)),y=u.F(x,(e=>e.height));if(y){p.some((t=>{const s=Qr(t,e,this.environment).y;return Math.abs(t.top-s)<7}))||(f=Tr(y))}let S;const v=c.filter((e=>e.direction===Sr.vh.Left||e.direction===Sr.vh.Right));let b=u.F(v,(t=>{const s=Qr(t,e,this.environment).x;return Math.abs(t.left-s)}));if(b){const e=b,t=v.filter((t=>Math.abs(t.left-e.left)<20));t.length>0&&(b=u.F(t,(e=>e.left)))}if(b){const e=b;p.some((t=>t.top>=e.top&&t.top+t.height<=e.top+e.height))||(S=Tr(b))}return{ontoDropZone:f,verticalDropZone:S,horizontalDropZones:h}}selectableCanAcceptDrop(e,t,s){if(G.Z.state.isOpen&&!Oi.default.state.open)return!1;if(H.Z.state.isOpen)return!1;const n=Sr.ZP.state,i=n.isDragging?n.draggedStores:[],o=!!n.isDragging&&n.isNativeDrag;let a,r,l,d=!1,c=!1;i.find((e=>{const t=Nr.Z.findOutlinerItemFromStore(e);return!!t&&(a=t,r=t.type,d=t.isTopLevelItem,!0)}));const u=e instanceof yr.Z?Nr.Z.findOutlinerItemFromStore(e.props.store):void 0,p=null==u?void 0:u.parentStore;var m;u&&(l=u.type,c=u.isTopLevelItem||"team"===(null===(m=u.parentStore)||void 0===m?void 0:m.table));if(function(e){var t;const{draggingOutlinerItem:s,selectableOutlinerItemParent:n,direction:i}=e;if(s&&"team"===s.type&&s.isTopLevelItem&&(null===(t=s.parentStore)||void 0===t?void 0:t.pointer.table)===gr.e0){const e=s.parentStore;if(!(s.store.getParentId()===e.pointer.id||n&&n.pointer.id===e.pointer.id&&i!==Sr.vh.Onto))return!0}return!1}({draggingOutlinerItem:a,selectableOutlinerItemParent:p,direction:t}))return!1;if(!(e instanceof yr.Z))return e.props.canAcceptDrop({direction:t,draggingStores:i,isNativeDrag:o});const g=e.props.store,h=g.getAssociatedCollectionStore();if(t===Sr.vh.Onto&&h){const e=h.id,t=(0,fr.fm)(g),s=null==t?void 0:t.collectionViewStore();if(s&&"page"!==s.getType()){if(i.find((s=>{const n=s.getAssociatedCollectionStore(),i=(0,fr.fm)(s);return Boolean(s instanceof It.G&&n&&n.id===e)||i===t})))return!1}}if(t!==Sr.vh.Onto){const e=(0,fr.fm)(g);if("collectionTypedView"===(null==e?void 0:e.contextType)&&e.databaseType){if(!i.find((t=>{const s=(0,fr.fm)(t);return(null==s?void 0:s.databaseType)===e.databaseType})))return!1}}if(e.props.groupsPointer){var f;const t=null===(f=g.getCollectionViewCollectionStore())||void 0===f?void 0:f.getSchema();if(Boolean(e.props.groupsPointer.find((e=>!(0,pr.WL)(e,(null==h?void 0:h.getSchema())??t))))){if(i.find((t=>{var s;const n=Ur.C.findSelectableFromStore(t);return(null==n||null===(s=n.props)||void 0===s?void 0:s.groupsPointer)&&e.props.groupsPointer&&!(0,mr.HH)(n.props.groupsPointer,e.props.groupsPointer)})))return!1}}if((0,Br.ru)({targets:i,destination:g,direction:t,draggingOutlinerType:r}))return!1;if(s&&i.find((e=>e.isTypedCollectionViewBlock()||(0,hr.h7)(e))))return!1;if(u&&t!==Sr.vh.Onto&&!c&&!(0,xr.MaU)({environment:this.environment,blocks:[u.store],publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state}))return!1;if(l&&o)return!1;if("bookmarks"===r&&d&&("bookmarks"!==l||!c||t===Sr.vh.Onto))return!1;if("bookmarks"===l&&c&&t!==Sr.vh.Onto&&("bookmarks"!==r||!d))return!1;if(a&&a.isTopLevelItem&&"team"===a.type&&a.parentStore&&a.parentStore.table===gr.e0){const e=a.parentStore,t=It.zX.createChildStore(e,{...e.pointer,table:gr.e0});if(t&&!(0,Dr.si)({teamStore:t,environment:this.environment}))return!1}if(u&&u.isTopLevelItem&&"team"===u.type&&u.parentStore&&u.parentStore.table===gr.e0){const e=u.parentStore,t=It.zX.createChildStore(e,{...e.pointer,table:gr.e0});if(t&&!(0,Dr.si)({teamStore:t,environment:this.environment}))return!1}if("shared"===l&&c&&("shared"!==r||!d))return!1;if(l&&c&&t!==Sr.vh.Onto){if(i.find((e=>{const t=e.getType();return Boolean(!t||!je.Z7[t])})))return!1}const{device:x}=this.environment;if(l&&x.isMobile&&t===Sr.vh.Onto&&c)return!1;if(i.find((e=>Boolean(e instanceof It.G&&e.isInlineCollectionView())))&&(t===Sr.vh.Left||t===Sr.vh.Right))return!1;if(i.some((e=>Boolean(Lr.Z.findCollectionTemplatePickerItemFromStore(e))))!==Boolean(Lr.Z.findCollectionTemplatePickerItemFromStore(g)))return!1;if(t===Sr.vh.Onto&&g&&!(0,xr.J5S)({environment:this.environment,blocks:[g],publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state}))return!1;if(!this.memoizedCanDrag(i))return!1;if(i.some((e=>e.isTransclusionType()))){if(g.findRecordStoreUIAncestor((e=>{if(e===g)return!1;const t=e.isTable("block")&&e.isPath([])&&e.getValue();return Boolean(t&&(0,je.nq)(t.type))})).ancestor)return!1}return!0}}zr.displayName="SelectableOrDropTargetListener";const qr=zr;function Gr(){const e=Kr.default.state;e.isOpen&&!e.menuIsOpen&&Kr.default.reset()}function Hr(e){return(Ge.default.state.droppableContainerStack||[]).indexOf(e)}function Yr(e,t,s){const n=Kr.default.state;if(!n.isOpen||!n.menuIsOpen){const i=function(e,t,s){if(Wr.Z.state.isResizing||Sr.ZP.state.isDragging||Y.default.state.isActive||mt.kw.state)return;const{selectableRectMap:n}=br.Z.state,i=Er.Z.getMembersByDOMOrder({filter:t=>{const s=t.getNode();return Boolean(s&&s.contains(e))}})[0];if(!i)return;const o=n.keys();let a=o.next();const r=[];for(;!a.done;){const e=a.value,l=n.get(e),d=150;(e.props.shouldShowHoverMenu||e.props.shouldShowCommentMenu)&&e.getContextSelectableContainer()===i&&l&&s>=l.top&&s<=l.bottom&&t>=l.left-d&&t<=l.right&&r.push(e),a=o.next()}const l=u.MR(r,(e=>{const t=n.get(e);return t?-t.left:1/0})),d=l.find((e=>{const t=e.getNode();return!t||!l.find((s=>{if(s!==e){const e=s.getNode();return Boolean(e&&t.contains(e))}return!1}))}));return d?{selectable:d,container:i}:void 0}(e,t,s);i?n.isOpen&&i.selectable.props.store===n.currentStore||Kr.default.setState({isOpen:!0,currentStore:i.selectable.props.store,container:i.container,menuIsOpen:!1}):Kr.default.reset()}}function Qr(e,t,s){return Ir({device:s.device,target:e.target,points:t})}function $r(e){return(null==e?void 0:e.priority)??0}function Jr(){Jt.Ch(),Gr()}function Xr(){Jt.Ch(),Gr()}function el(){const e=Kr.default.state,t=mt.kw.state;e.isOpen&&!e.menuIsOpen&&t&&Kr.default.reset()}var tl=s(49427),sl=s(74948),nl=s(38676);class il extends d.Z{constructor(){super(...arguments),this.cachedPageViewRect=void 0,this.previousMousePosition=void 0,this.mouseSpeed=1/0,this.timerId=void 0,this.setPreviousMousePosition=(e,t)=>{this.previousMousePosition={x:e,y:t},clearTimeout(this.timerId),this.timerId=setTimeout((()=>{this.previousMousePosition=void 0}),100)},this.handleWindowMouseMove=e=>{(0,Z.ZP)({event:e,context:Z.Af.SidebarMouseMove,callback:()=>{if(this.updatePageViewRectThrottled(),void 0!==this.previousMousePosition&&(this.mouseSpeed=Math.sqrt(Math.pow(e.clientX-this.previousMousePosition.x,2)+Math.pow(e.clientY-this.previousMousePosition.y,2))),this.setPreviousMousePosition(e.clientX,e.clientY),this.cachedPageViewRect){const t=nl.sidebarOpenStore.state,s=e.clientX,n=this.cachedPageViewRect.left,i=Math.max(.38*n,18,nl.sidebarMousePeekXStore.state);s<i&&!Oi.default.isCenterPeekOpen()&&this.mouseSpeed<5&&0!==this.mouseSpeed&&!t&&sl.open({fromElectron:!1}),s>(0,be.qG)(this.environment)&&s>i&&t&&sl.close()}}})},this.handleWindowResize=e=>{this.environment.WindowSizeStore.state.width<sl.OnlyOneSidebarVisibleWidthThreshold&&(0,be.Sx)(this.environment)&&(0,be.in)(this.environment)&&sl.setExpand({environment:this.environment,isExpanded:!1,from:"sidebar_listener"})},this.updatePageViewRectThrottled=u.P2(this.updatePageViewRect,500)}didMount(){window.addEventListener("mousemove",this.handleWindowMouseMove),window.addEventListener("mouseout",al),window.addEventListener("resize",this.handleWindowResize)}willUnmount(){window.removeEventListener("mousemove",this.handleWindowMouseMove),window.removeEventListener("mouseout",al),window.removeEventListener("resize",this.handleWindowResize)}updatePageViewRect(){const e=function(){const{mainEditorCurrentBlockStore:e}=E.default.state,t=tl.Z.find((t=>t.props.store===e));if(t){const e=t.getContentWrapEl();if(e)return e}}();this.cachedPageViewRect=e?e.getBoundingClientRect():document.body.getBoundingClientRect()}}il.displayName="SidebarListener";const ol=il;function al(e){e.toElement||e.relatedTarget||sl.close()}var rl=s(68012),ll=s(13991),dl=s(6906),cl=s(76994),ul=s(65965),pl=s(47425),ml=s(37834),gl=s(83420),hl=s(52533),fl=s(73819),xl=s(46096),yl=s(44041),Sl=s(91694),vl=s(88893),bl=s(35057),Ml=s(88280),jl=s(84787),Cl=s(50506),wl=s(63296),kl=s(58297),Tl=s(76798),Il=s(53336),Zl=s(83182),Pl=s(46247),Fl=s(26263),Al=s(16691),_l=s(45953),Rl=s(606),Ol=s(13493),Bl=s(7032),Dl=s(66213),Ll=s(82136),Vl=s(31192);const Nl=function(e){const t=(0,i.O7)(),s=(0,se.yK)((e=>({spinnerWrapper:{padding:32,display:"flex",alignItems:"center",justifyContent:"center"},scroller:{background:e.contentBackground,zIndex:1,flexGrow:1}})),[]),o=(0,n.useCallback)((e=>{ml.U4(),Po.c4({environment:t,url:e})}),[t]),a=e.blockStore.id,r=e.timestamp,l={request:{block:{id:a,spaceId:(0,As.C)(e.blockStore.pointer.spaceId)},timestamp:r},performRequest:s=>async function(e,t,s){const{timestamp:n}=e,i=e.block.id,o=await V.getSnapshotContents(s,e);if("failed"===o.type)throw o.error;const a=_l.PF.create(o.data.contentMap),r=s.currentUser.id,l=new Fl.Z({name:"PageSnapshotPreview"});for(const{pointer:c,model:u}of a)u&&l.setModelAndRole({pointer:c,userId:r},u,"reader");l.snapshotData={blockId:i,timestamp:n};const d=new Map,p=e=>{const s=l.getRecord({pointer:e,userId:r}),n=(0,Al.dn)(e);s||!(0,Bl.e)(e.id)||d.has(n)||d.set(n,(0,It.Kv)(t,e))};for(const{model:h}of a)if(h)if(h.table===Mt.iU){const e=h,t=e.getProperties(),s=Rl.dr.uniq(u.xH(Object.keys(t).map((e=>t[e])).map(c.cCA)));for(const l of s)p(l);const n=e.isNavigableBlock()?[]:e.getContentIds()||[];for(const l of n)p({table:Mt.iU,id:l});const i=e.getCollectionPointer();i&&p(i);const o=u.jj(u.xH(Object.keys(t).map((e=>t[e])).map(c.lcG)));for(const l of o)p({table:_s.KJ,id:l});const a=h.getCreatedByPointer();a&&p(a);const r=h.getLastEditedByPointer();r&&p(r)}else if(h.table===Ol.np){var m;const e=null===(m=h.getFormat())||void 0===m?void 0:m.collection_pointer;e&&p(e)}else if(h.table===qt.x_){const e=h.getCreatedByPointer();e&&p(e)}const g=Array.from(d.values());return await Promise.all(g.map((async e=>{await e.load();const t=e.getValue();t&&l.setRecord({pointer:e.pointer,userId:r},{role:"reader",value:t})}))),{blockStore:new It.G(s,{table:Mt.iU,id:i},{inMemoryRecordCache:l}),timestamp:n}}(s,e.blockStore,t),render:(e,n,i)=>(0,C.jsx)(zs.Z,{show:!i||!n,showDelay:400,showHold:400,render:i=>i?(0,C.jsx)("div",{style:s.spinnerWrapper,children:(0,C.jsx)(ns.Z,{})}):e?(0,C.jsx)("div",{style:{padding:32},children:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Something went wrong.",id:"pageSnapshotPreview.unknownPreviewLoadError.message"})}):n?(0,C.jsx)(Fe.Z,{store:n.blockStore,isDefaultContainer:!0,droppable:!0,render:e=>{let{selectableEvents:i}=e;return(0,C.jsx)(Il.Z,{style:s.scroller,type:(0,mt.Zy)({environment:t,store:n.blockStore}),...i,children:(0,C.jsx)(Vl.ZP,{store:n.blockStore,disabled:!0,context:Ll.S.InPageSnapShot,paddingBottom:Vl.ZP.paddingBottom(t)})})}},n.timestamp):void 0})};return(0,C.jsx)(Dl.LF,{value:o,children:(0,C.jsx)(hi.Z,{...l})})};var El=s(5595);const Ul={display:"flex",justifyContent:"center",padding:32};const Wl=(0,oe.injectIntl)((function(){const e=(0,oe.useIntl)(),t=(0,i.O7)(),{device:s}=t,n=(0,o.VK)((()=>xl.Z.state),[]);return s.isMobile?(0,C.jsx)(f.ZP,{ariaLabel:Ql(e),popupType:f.ZP.PopupType.SlideUp,open:n.open,render:()=>(0,C.jsx)(ld,{}),onDismiss:ml.U4}):(0,C.jsx)(Cl.Z,{ariaLabel:Ql(e),open:n.open,innerStyle:{height:`${El._Y}vh`,width:`${El.rp}vw`,overflow:"hidden",display:"flex"},onDismiss:ml.U4,render:()=>(0,C.jsx)(ld,{}),className:Ke.Nn$})})),Kl=(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"This page does not have any snapshots yet. Allow up to 10 minutes for the first snapshot to be generated.",id:"historyModal.noSnapshotsYet.message"});function zl(){return ul.sb.filter((e=>"personal"!==e.tier))}function ql(e){const t=zl(),s=t.findIndex((t=>t.tier===e));if(!(s<=0))return t[s-1]}function Gl(e){var t;if(kt.default.isAdminMode)return;const{nextFutureSnapshot:s}=e;if(!s)return;const n=(i=s,(Date.now()-parseInt(i.timestamp))/jt.A0);var i;if((0,bl.Aw)()&&n<=ul.hy.plus.days)return;const o=function(e){return zl().filter((t=>t.days>e)).map((e=>e.tier))}(n);if((0,bl.p4)(o))return;const a=o[0]??"enterprise";return(0,pl.QM)(a)?void 0:{tier:a,message:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Please upgrade to the {upsellTier} Plan to access versions older than {snapshotLimitDays} days.",id:"historyModal.upsell.message",values:{upsellTier:(0,dl.Z)((0,pl.eR)(a)?"plus":a),snapshotLimitDays:(null===(t=ql(a))||void 0===t?void 0:t.days)??Math.floor(n)}})}}function Hl(){return(0,C.jsx)(Pl.Z,{href:(0,ce.UY)("guides.pageHistory"),analyticsFrom:"page_history"})}function Yl(e,t){const{device:s}=t;return!s.isMobile||"personal"===e&&(0,hl.S$)({environment:t})}function Ql(e){return e.formatMessage({id:"historyModal.ariaLabel",defaultMessage:"Page History"})}function $l(e){const{device:t}=e;return t.isMobile?24:20}function Jl(e){let{menuState:t}=e;const s=(0,i.O7)(),a=(0,o.VK)((()=>t.blockStore.getIcon()),[t.blockStore]),r=(0,o.VK)((()=>t.blockStore.isEmptyPage()),[t.blockStore]);return t.snapshot?(0,C.jsxs)(n.Fragment,{children:[(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",flexShrink:0,height:45,fontSize:14,paddingLeft:14},children:[a&&(0,C.jsx)(Jo.Z,{disabled:!0,icon:a,isEmptyPage:r,size:$l(s),style:{marginRight:6}}),(0,C.jsx)(Tl.Z,{store:t.blockStore})]}),(0,C.jsx)(Nl,{blockStore:t.blockStore,timestamp:t.snapshot.timestamp})]}):null}function Xl(e,t){const{device:s}=e;return{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:28,padding:16,textAlign:"center",fontSize:14,...s.isMobile?{position:"relative",zIndex:1,background:t.popoverBackground,boxShadow:`\n                        0 -1px 0 ${t.regularDividerColor},\n                        0 1px 0 ${t.regularDividerColor}\n                    `}:{height:"100%"}}}function ed(){const e=(0,se.Fg)();return(0,cl.w)({width:64,height:"auto",fill:e.lightIconColor,marginBottom:12})}function td(e,t){yl.y(t,{from:"history_modal",for:e})}function sd(e){let{message:t,showUpgradeButtonForTier:s}=e;const n=(0,se.Fg)(),a=(0,i.O7)(),{device:r}=a,l=(0,o.VK)((()=>vl.GJ(Ml.subscriptionDataStoreInstance.state)),[]);let d=Yl(s,a);return d&&(0,hl.S$)({environment:a})&&"personal"===s&&!l&&(d=!1),(0,C.jsxs)("div",{style:Xl(a,n),children:[Yl(s,a)&&(0,C.jsx)(ed,{}),(0,C.jsx)("div",{style:{...!r.isMobile&&{maxWidth:340}},children:t}),d&&s&&(0,C.jsx)(kl.Z,{isLarge:!0,onClick:()=>td(s,a),style:{marginTop:16},children:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Upgrade",id:"historyModal.upgradeForHistoryButton.label"})})]})}function nd(e){const t=(0,i.O7)(),s=(0,oe.useIntl)(),{device:a}=t,{menuState:r,loadingMore:l}=e,d=(0,o.VK)((()=>u.oA(e.snapshotValues.map(((n,i)=>{const o=i>0?e.snapshotValues[i-1]:void 0,l=Gl({snapshot:n,nextFutureSnapshot:o}),d=!l;return{key:n.id,action:()=>{ml.gs({environment:t,snapshot:n,nextFutureSnapshot:o})},render:e=>{const i=n.authors||[],o=s.formatList(u.oA(i.map((e=>(0,gl.nc)({parentStore:r.blockStore,pointer:e,debugSrc:"SnapshotsMenuListComponent"}).getDisplayName(s)))),{type:"conjunction",style:"narrow"}),c=(0,C.jsx)("div",{style:{...ae.Z.textOverflowStyle},children:o}),p=Boolean(r.snapshot&&r.snapshot.id===n.id),m=parseInt(n.timestamp),g=m>Date.now()-6*jt.A0?(0,Wn.$b)(m,ll.SP,s):(0,Wn.Yx)(m,"medium",ll.SP),h=(0,Wn.Yx)(m,"medium_with_time",ll.SP);return d?(0,C.jsx)(ge.ZP,{render:t=>(0,C.jsx)(He.Z,{...(0,Si.Z)(e,t),title:g,focused:!a.isMobile&&p,caption:c}),renderTooltip:()=>(0,C.jsxs)("div",{style:{maxWidth:270,whiteSpace:"normal"},children:[(0,C.jsx)("div",{children:h}),(0,C.jsx)("div",{children:o})]})},e.key):(0,C.jsx)(ge.ZP,{render:s=>(0,C.jsx)(He.Z,{...(0,Si.Z)(s,e),title:(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,C.jsx)("div",{style:{...a.isMobile&&{display:"flex",flex:1},...ae.Z.textOverflowStyle},children:g}),(0,C.jsx)(Sl.Z,{subscriptionTier:l.tier,analyticsName:"history_modal",desktopStyle:{marginLeft:8},onClick:()=>td(l.tier,t)})]}),focused:!a.isMobile&&p,caption:c}),renderTooltip:()=>(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Upgrade to view this snapshot.",id:"historyModal.snapshotsMenuList.upgrade.tooltip"}),disableTooltip:!pl.QM},e.key)}}})))),[e.snapshotValues,a.isMobile,t,s,r.blockStore,r.snapshot]),c=r.snapshot&&r.snapshot.id,p=d.findIndex((e=>c===e.key)),m=[{key:"snapshots",render:e=>(0,C.jsx)(Qe.Z,{...e}),items:d}];return(0,C.jsxs)(n.Fragment,{children:[(0,C.jsx)(Ye.Z,{type:Ye.i.Vertical,initialFocus:p,sections:m}),(0,C.jsx)(jl.Z,{loading:l,fetchSize:r.size,resultSize:e.snapshotValues.length,onLoadMore:ml.FF}),(0,C.jsx)(zs.Z,{show:l,showDelay:300,showHold:100,render:e=>e&&(0,C.jsx)("div",{style:Ul,children:(0,C.jsx)(ns.Z,{})})})]})}function id(e){let{menuState:t}=e;const s=(0,i.O7)();return(0,C.jsx)(f.ZP,{popupType:f.ZP.PopupType.SlideUp,open:Boolean(t.snapshot),forceFullScreenSlideUp:!0,render:()=>{if(!t.snapshot)return null;const e=Gl({snapshot:t.snapshot,nextFutureSnapshot:t.nextFutureSnapshot}),n=!e,i=n?(0,C.jsx)(Nl,{blockStore:t.blockStore,timestamp:t.snapshot.timestamp}):(0,C.jsx)(sd,{message:e.message,showUpgradeButtonForTier:e.tier});return(0,C.jsx)(h.Z,{menuType:x.og.Modal,title:(0,Wn.$b)(parseInt(t.snapshot.timestamp),ll.SP,ze.default.getIntl()),right:(0,C.jsx)(Pe.DoneMenuText,{}),onClickRight:ml.zb,leftDisabled:!n,left:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Restore",id:"historyModal.mobileSnapshotMenu.restoreButton.label"}),onClickLeft:()=>ml.xx(s),whiteBackground:n,forceFullScreenSlideUp:!0,children:i})}})}function od(e){const t=(0,se.Fg)(),s=(0,i.O7)(),{menuState:n}=e,a=(0,fl.cR)(n.blockStore),r=(0,o.VK)((()=>Boolean(n.snapshot&&!a&&!Gl({snapshot:n.snapshot,nextFutureSnapshot:n.nextFutureSnapshot})&&function(e,t){return(0,xr.k5s)({environment:t,blocks:[e.blockStore],originRect:void 0,publicEditMode:void 0})}(n,s))),[s,n,a]);return(0,C.jsxs)("div",{style:{display:"flex",flexDirection:"column",flexShrink:0,width:El.mD},children:[(0,C.jsx)(Il.Z,{type:ke.Z.Y,style:{flex:1},children:(0,C.jsx)(nd,{...e})}),(0,C.jsxs)("div",{style:{display:"flex",padding:14,borderTop:`\n                        1px solid ${t.regularDividerColor}\n                    `},children:[(0,C.jsx)(ge.ZP,{disableTooltip:r,renderTooltip:()=>a?(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Restore page from trash to restore snapshots.",id:"historyModal.desktopModal.sidebar.restorePageFromTrashMessage.tooltip"}):(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Upgrade to restore snapshots.",id:"historyModal.desktopModal.sidebar.upgradeMessage.tooltip"}),render:e=>(0,C.jsx)(kl.Z,{isLarge:!0,onClick:()=>ml.xx(s),disabled:!r,...e,children:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Restore version",id:"historyModal.desktopModal.restoreButton.label"})})}),(0,C.jsx)(wl.Z,{isLarge:!0,style:{marginLeft:12},onClick:ml.U4,children:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Cancel",id:"historyModal.desktopModal.cancelButton.label"})})]}),(0,C.jsx)(Qe.Z,{topBorder:!0,disableDesktopPadding:!0,children:(0,C.jsx)(Zl.Z,{title:(0,C.jsx)(oe.FormattedMessage,{id:"historyModal.desktopModal.learnMoreButton.label",defaultMessage:"Learn about page history"}),href:(0,ce.UY)("guides.pageHistory"),analyticsFrom:"page_history"})})]})}function ad(e){let t,s;return e.loadingMore||0!==e.snapshotValues.length||(t=(0,C.jsx)(sd,{message:Kl,showUpgradeButtonForTier:!1})),s=e.error?(0,C.jsx)("div",{style:Ul,children:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Something went wrong",id:"historyModal.errorMessage"})}):e.initialLoading?(0,C.jsx)("div",{style:Ul,children:(0,C.jsx)(ns.Z,{})}):(0,C.jsxs)(n.Fragment,{children:[(0,C.jsx)(Il.Z,{type:ke.Z.Y,children:(0,C.jsx)(nd,{...e})}),(0,C.jsx)(id,{menuState:e.menuState})]}),(0,C.jsx)(h.Z,{menuType:x.og.Modal,title:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"History",id:"historyModal.mobileHistoryMenu.title"}),left:(0,C.jsx)(Hl,{}),right:(0,C.jsx)(Pe.DoneMenuText,{}),onClickRight:ml.U4,header:t,children:s})}function rd(e){const t=(0,se.Fg)(),s=(0,o.VK)((()=>e.menuState.snapshot?Gl({snapshot:e.menuState.snapshot,nextFutureSnapshot:e.menuState.nextFutureSnapshot}):null),[e.menuState.nextFutureSnapshot,e.menuState.snapshot]);let i;return i=e.error?(0,C.jsx)("div",{style:Ul,children:(0,C.jsx)(oe.FormattedMessage,{defaultMessage:"Something went wrong",id:"historyModal.desktopModal.errorMessage"})}):e.initialLoading?(0,C.jsx)("div",{style:Ul,children:(0,C.jsx)(ns.Z,{})}):s?(0,C.jsx)(sd,{message:s.message,showUpgradeButtonForTier:s.tier}):e.loadingMore||0!==e.snapshotValues.length?(0,C.jsx)(Jl,{menuState:e.menuState}):(0,C.jsx)(sd,{message:Kl,showUpgradeButtonForTier:!1}),(0,C.jsxs)(n.Fragment,{children:[(0,C.jsx)("div",{style:{display:"flex",flexDirection:"column",width:`calc(100% - ${El.mD}px)`,boxShadow:`1px 0 0 ${t.regularDividerColor}`},children:i}),(0,C.jsx)(od,{...e})]})}function ld(){const e=(0,i.O7)(),{device:t}=e,s=(0,o.VK)((()=>xl.Z.state),[]);if(!s.open)return null;const n={request:{block:{id:s.blockStore.id,spaceId:(0,As.C)(s.blockStore.pointer.spaceId)},size:s.size},performRequest:t=>async function(e,t,s){const{device:n}=s,i=await V.getSnapshotsList(s,e);if("failed"===i.type)throw i.error;const{snapshots:o}=i.data;if(t.pageHasCollection=o.some((e=>{var t;const s="collection"===e.parent_table,n=null===(t=e.collection_ids)||void 0===t?void 0:t.length;return s||n&&0!==n})),t.openSnapshotNearTimestamp){const e=parseInt(t.openSnapshotNearTimestamp),n=o.findIndex((t=>parseInt(t.timestamp)<e));0===o.length||(0===n?ml.gs({environment:s,snapshot:o[n],nextFutureSnapshot:void 0}):n>0?ml.gs({environment:s,snapshot:o[n-1],nextFutureSnapshot:n>1?o[n-2]:void 0}):o.length<t.size?ml.gs({environment:s,snapshot:o[o.length-1],nextFutureSnapshot:o.length>1?o[o.length-2]:void 0}):ml.FF())}else Boolean(t.snapshot)||n.isMobile||xl.Z.setState({...t,snapshot:o[0],nextFutureSnapshot:void 0});return i.data}(t,s,e),render:(e,n,i)=>(0,C.jsx)(zs.Z,{show:Boolean(!n||n.snapshots.length>=s.size&&s.openSnapshotNearTimestamp),showDelay:400,showHold:100,render:o=>t.isMobile?(0,C.jsx)(ad,{snapshotValues:n?n.snapshots:[],menuState:s,error:e,initialLoading:o,loadingMore:!i}):(0,C.jsx)(rd,{snapshotValues:n?n.snapshots:[],menuState:s,error:e,initialLoading:o,loadingMore:!i})})};return(0,C.jsx)(hi.Z,{...n})}var dd=s(30397);const cd=function(){const e=(0,i.O7)(),{currentSpaceStore:t,currentUserStore:s}=(0,o.Kw)(E.default),[,a,r]=(0,o.AF)(dd.Z),l=null==s?void 0:s.id;return(0,n.useEffect)((()=>{if(!t||!l)return;const s=$.ZP.addListener((0,Q.je)(t.id),(async(s,n)=>{if(!r.shouldRefetchTeamsInSpace({currentUserId:l,currentSpaceId:t.id,emitValue:n}))return;const i=await(0,F.qX)({environment:e,spaceStore:t,includeArchived:!1,currentUserId:l});a({teams:i,lastEmitData:{spaceId:t.id,userId:l,value:n}})}),void 0,e);return function(){s&&$.ZP.removeListener(s,e)}}),[t,l,e,a,r]),null};var ud=s(13148),pd=s(89475),md=s(37181),gd=s(4926),hd=s(1634),fd=s(51077),xd=s(42402);const yd=function(){const e=(0,se.Fg)(),t=(0,i.O7)(),s=(0,o.VK)((()=>hd.Z.state),[]),n=(0,o.VK)((()=>gd.Z.state),[]);if(!s.open)return null;const a=s.integration.info.icon;return a?(0,C.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:"default",padding:16,background:e.popoverBackground,borderRadius:4,boxShadow:e.lightBoxShadow,position:"absolute",bottom:65+n,right:16+n,width:240,zIndex:Gt.hT,clipPath:"inset(-10px -10px -10px -10px)"},children:[(0,C.jsx)(fd.Z,{type:"image_url",imageURL:a,size:38,style:{marginBottom:6}}),(0,C.jsx)("div",{style:{color:e.regularTextColor,fontSize:14,fontWeight:ae.Z.fontWeight.semibold,marginBottom:6,textAlign:"center"},children:(0,C.jsx)(oe.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.title",defaultMessage:"Connect to {integration}",values:{integration:s.integration.name}})}),(0,C.jsxs)("div",{style:{color:e.mediumTextColor,fontSize:12,marginBottom:8,textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,C.jsx)(oe.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.caption",defaultMessage:"You, and anyone else who has access to this Notion page, will see rich previews that update live."}),(0,C.jsx)(xd.Z,{href:(0,ce.UY)("guides.unfurling"),external:!0,children:(0,C.jsx)(oe.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.learnMore.text",defaultMessage:"Learn more"})})]}),(0,C.jsx)(kl.Z,{onClick:()=>async function(e){const t=hd.Z.state,{currentSpaceStore:s}=E.default.state;if(!t.open||!s)return;await pd.hM({environment:e,integration:t.integration,spaceId:s.id,unfurlUrl:t.unfurlUrl,externalObjectInstanceBlockId:t.externalObjectInstanceBlockId,from:"external_object_instance_inline_popup"}),Sd(t.integration.id,e),hd.Z.reset()}(t),style:{width:"100%"},children:(0,C.jsx)(oe.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.connectButton",defaultMessage:"Connect"})}),(0,C.jsx)(me.Z,{icon:ud.U,onClick:()=>function(e){const t=hd.Z.state;t.open&&Sd(t.integration.id,e);hd.Z.reset()}(t),style:{position:"absolute",top:6,right:6}})]}):null};function Sd(e,t){const{currentUserSettingsStore:s}=E.default.state;s&&g.createAndCommit({userAction:"UnfurlingInformationPopup.markPopupAsDismissed",environment:t,perform:t=>{md.GK({transaction:t,userSettingsStore:s,integrationId:e})}})}var vd=s(61202),bd=s(92083),Md=s(80064);const jd=function(){const e=(0,o.qz)(Md.Z),t=(0,i.O7)(),s=(0,n.createRef)(),a=(0,i.Fy)(),r=(0,oe.useIntl)(),[l,d,c,u]=(0,o.VK)((()=>[e.state.open,e.state.open?e.state.allOptionTypes:[],e.state.open?e.state.renderRect:void 0,e.state.open?e.state.integration.name:void 0]),[e]);return(0,n.useEffect)((()=>{const e=e=>{l&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&Id(t)},n=e=>{if(!l||!e.target||!s.current)return;const n=s.current;n&&!n===e.target&&Id(t)};return(0,qs.lj)(window,"keydown",e),(0,qs.lj)(window,"mousedown",n),()=>{(0,qs.ZV)(window,"keydown",e),(0,qs.ZV)(window,"mousedown",n)}}),[l,s,t]),(0,C.jsx)(f.ZP,{popupType:a.isMobileNative&&!a.isTablet?f.ZP.PopupType.SlideUp:f.ZP.PopupType.Popup,open:Boolean(l&&c),originRect:l?c:void 0,placementToOrigin:f.ZP.Placement.Top,alignmentToOrigin:f.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:a.isMobile,keepFocus:a.isMobile,render:()=>{if(!l)return;const e={key:"embed section",render:e=>(0,C.jsx)(Qe.Z,{...e}),items:d.map((e=>({key:e,render:s=>(0,C.jsx)(He.Z,{...s,title:(0,C.jsx)(Cd,{optionType:e,integrationName:u}),onMouseEnter:n=>{s.onMouseEnter(n),wd(e,r,t)}}),action:()=>kd(e,t)})))};let n;return n=a.isMobile?{menuType:x.og.ActionSheet}:{menuType:x.og.Popup,width:320,maxHeight:"40vh",onClickOutside:()=>Id(t)},(0,C.jsx)(h.Z,{...n,className:Ke.b_f,ref:s,children:(0,C.jsx)(Ye.Z,{type:Ye.i.Vertical,sections:[e],initialFocus:0,onKeyboardArrow:e=>function(e,t,s){const n=Md.Z.state;if(!n.open||void 0===e.indexGlobal)return;const i=n.allOptionTypes[e.indexGlobal];if(!i)return;wd(i,t,s)}(e,r,t),priority:1,disallowBackspace:!0})})},onDismiss:Id})};function Cd(e){let{optionType:t,integrationName:s}=e;return"preview"===t?(0,C.jsx)(oe.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Paste as preview"}):"mention"===t?(0,C.jsx)(oe.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Paste as mention"}):"link"===t?(0,C.jsx)(oe.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Paste as link"}):"drive"===t?(0,C.jsx)(oe.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsDrive.title",defaultMessage:"Paste as embed"}):"collection"===t?(0,C.jsx)(oe.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsDatabase.title",defaultMessage:"Paste as database"}):"import"===t?(0,C.jsx)(oe.FormattedMessage,{id:"unfurlingMenu.actions.import.title",defaultMessage:"Import from {integration}",values:{integration:s}}):void(0,N.t1)(t)}function wd(e,t,s){g.createAndCommit({userAction:"UnfurlingMenu.handleMenuListKeyboardArrow",environment:s,perform:n=>{vd.hJ({environment:s,type:Td(e),useTemporaryRecordCache:!0,transaction:n,intl:t})}})}function kd(e,t){let s;const n=Md.Z.state,i=bd.Z.state;n.open&&(s=n.integration.name),on.kM(t,{unfurl_option_type:e||"default",integration:s||"default"}),"import"===e&&i&&bd.Z.setState({...i,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"asana",openedFrom:"link_paste"}),g.createAndCommit({userAction:"UnfurlingMenu.handleDismiss",environment:t,perform:s=>{vd.xv({environment:t,setType:e?Td(e):void 0,transaction:s})}})}function Td(e){return"import"===e?"link":e}function Id(e){kd(void 0,e)}const Zd=function(){const e=(0,i.Fy)(),t=(0,i.O7)(),{isMobile:s,isElectron:d}=e;(0,n.useEffect)((()=>{if(s){function e(e){e.preventDefault()}return document.addEventListener("gesturestart",e),()=>{document.removeEventListener("gesturestart",e)}}}),[s]);const{currentSpaceStore:c,teamsEnabled:u}=(0,o.VK)((()=>({currentSpaceStore:E.default.state.currentSpaceStore,teamsEnabled:(0,F.bq)()})),[]),p=(0,o.VK)((()=>z.default.checkGate("alt_text_image_blocks")),[]);(0,n.useEffect)((()=>{function e(){q.Z.setState({open:!0})}function t(){q.Z.setState({open:!1})}return a.inPageSearch.started.addListener(e),a.inPageSearch.stopped.addListener(t),()=>{a.inPageSearch.started.removeListener(e),a.inPageSearch.stopped.removeListener(t)}}),[]),(0,n.useEffect)((()=>{function s(s){e.isAndroid||O.default.isOnboarding||(0,Z.ZP)({event:s,context:Z.Af.EditorContextMenu,callback:()=>{e.isElectron||t.currentUser.isLoggedIn()&&s.preventDefault()}})}return window.addEventListener("contextmenu",s),()=>{window.removeEventListener("contextmenu",s)}}),[e.isAndroid,e.isElectron,t.currentUser]),(0,n.useEffect)((()=>{function e(e){e.preventDefault()}return window.addEventListener("dragstart",e),()=>{window.removeEventListener("dragstart",e)}}),[]),(0,n.useEffect)((()=>{function e(e){Y.default.state.isActive&&(e.preventDefault(),r.MZ({environment:t,currentX:Y.default.state.currentX,currentY:Y.default.state.currentY,toggle:e.shiftKey}))}function s(e){Y.default.state.isActive&&(e.preventDefault(),r.MZ({environment:t,currentX:e.clientX,currentY:e.clientY,toggle:e.shiftKey}))}function n(e){Y.default.state.isActive&&((0,P.N9)(e)||e.preventDefault(),r.qw(t))}return window.addEventListener("keydown",e),window.addEventListener("keyup",e),window.addEventListener("mousemove",s),window.addEventListener("mouseup",n),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",e),window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",n)}}),[t]);const m=t.currentUser.isLoggedIn();return(0,C.jsxs)(n.Fragment,{children:[(0,C.jsx)(Ee,{}),(0,C.jsx)(l.zI,{}),(0,C.jsx)(l.y4,{}),(0,C.jsx)(R,{}),(0,C.jsx)(te.Z,{priority:-1,capture:!0,debugName:"AppComponents"}),(0,C.jsx)(qr,{}),m&&!s&&(0,C.jsx)(ol,{}),m&&c&&(0,C.jsx)(Oo,{rootStore:c}),m&&(0,C.jsx)(cd,{}),m&&u&&(0,C.jsx)(ee,{}),m&&(0,C.jsx)(K,{}),(0,C.jsx)(lt.Z,{}),(0,C.jsx)(Co,{}),(0,C.jsx)(A.LazyBlockMenu,{}),(0,C.jsx)(ea,{}),(0,C.jsx)(qo,{}),(0,C.jsx)(fs,{}),(0,C.jsx)(it,{}),!s&&(0,C.jsx)(Ya,{}),(0,C.jsx)(Vs,{}),(0,C.jsx)(Eo,{}),(0,C.jsx)(Ln,{}),(0,C.jsx)(at.Z,{store:G.Z}),(0,C.jsx)(at.Z,{store:H.Z}),(0,C.jsx)(Xi,{}),(0,C.jsx)(A.LazySlashMenu,{}),(0,C.jsx)(k,{}),(0,C.jsx)(At,{}),(0,C.jsx)(jd,{}),(0,C.jsx)(Qs,{}),(0,C.jsx)(yd,{}),(0,C.jsx)(Je,{}),(0,C.jsx)(rl.Z,{}),(0,C.jsx)(In,{}),d&&(0,C.jsx)(A.LazyElectronContextMenu,{}),(0,C.jsx)(ht,{}),(0,C.jsx)(rt.Z,{}),m&&(0,C.jsx)(Wl,{}),(0,C.jsx)(Fs.s6,{}),p&&(0,C.jsx)(ye,{})]})}},13713:(e,t,s)=>{s.d(t,{B:()=>S,Z:()=>v});s(67294);var n=s(13991),i=s(480),o=s(86628),a=s(24405),r=s(66897),l=s(7057),d=s(9291),c=s(83420),u=s(33929),p=s(4023),m=s(16011),g=s(28992),h=s(72495),f=s(26388),x=s(64369),y=s(85893);function S(e){const t=e.getCreatedByPointer(),s=e.getCreatedTime(),i=e.getLastEditedByPointer(),o=e.getLastEditedTime(),a=u.default.getIntl();if(t&&s&&o&&i){const r=(0,c.ue)({parentStore:e,pointer:t}),d=(0,l.$b)(s,n.SP,a),u=(0,c.ue)({parentStore:e,pointer:i}),p=(0,l.$b)(o,n.SP,a);if(!u)return;return{createdBy:r,createdTime:d,lastEditedBy:u,lastEditedTime:p}}}const v=function(e){let{isPageMoreButton:t,hideTopBorder:s,store:n}=e;const l=(0,o.VK)((()=>S(n)),[n]),{device:c}=(0,i.O7)(),v=(0,o.VK)((()=>c.isPhone),[c]),b=u.default.getIntl(),M=(0,a.yK)((()=>({menuItem:{paddingTop:v?8:s?0:6,paddingBottom:v?8:16}})),[s,v]);return(0,y.jsx)(h.Z,{topBorder:!t&&!s,style:{paddingTop:t?0:8,paddingBottom:t?0:8},children:(0,y.jsx)(g.Z,{style:l?void 0:M.menuItem,shouldWrapTitle:!0,title:l?(0,y.jsx)(f.ZP,{placement:p.u.Right,render:e=>(0,y.jsxs)("div",{...e,children:[(0,y.jsx)(x.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:c.isPhone,isMultiline:!0,style:{marginBottom:4},children:(0,y.jsx)(d.FormattedMessage,{id:"blockAuthorInfo.label",defaultMessage:"Last edited by {author}",values:{author:l.lastEditedBy.asActor?(0,r.$4)(b,l.lastEditedBy):void 0}})}),(0,y.jsx)(x.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:c.isPhone,children:l.lastEditedTime})]}),renderTooltip:()=>(0,y.jsx)(m.Z,{store:n,compactFormat:!0})}):void 0,loading:!l})})}},99662:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Ze});s(67294);var n=s(480),i=s(86628),o=s(29369),a=s(9291),r=s(53965),l=s(1898),d=s(49386),c=s(72495),u=s(35067),p=s(85893);const m=[{key:"block in comment menu primary",render:e=>(0,p.jsx)(c.Z,{...e}),actions:[u.G,d.yN,d.TH]}];var g=s(63923),h=s(82763);const f=[{key:"page mention context menu primary",render:e=>(0,p.jsx)(c.Z,{isTitleUppercase:!1,...e}),actions:[...s(12988).ej,h.K,h.H]}];var x=s(36610),y=s(6404),S=s(28020),v=s(75079),b=s(60709),M=s(18514),j=s(35328),C=s(94841),w=s(40745),k=s(37652),T=s(33907),I=s(8597),Z=s(80988),P=s(53465),F=s(88437),A=s(77734),_=s(73599),R=s(37612),O=s(31701),B=s(62967),D=s(96802),L=s(13447),V=s(41216),N=s(19037),E=s(80025),U=s(33929),W=s(98794);const K=(0,a.defineMessages)({simpleTableHeaderColumn:{id:"action.rowHeader.title",defaultMessage:"Header column"},simpleTableHeaderRow:{id:"action.columnHeader.title",defaultMessage:"Header row"},simpleTableInsertColumnLeft:{id:"action.insertColumnLeft.title",defaultMessage:"Insert Left"},simpleTableInsertColumnRight:{id:"action.insertColumnRight.title",defaultMessage:"Insert Right"},simpleTableClearContents:{id:"action.clearContents.title",defaultMessage:"Clear Contents"},simpleTableInsertRowAbove:{id:"action.insertRowAbove.title",defaultMessage:"Insert Above"},simpleTableInsertRowBelow:{id:"action.insertRowBelow.title",defaultMessage:"Insert Below"},textColorSection:{id:"action.section.textColor",defaultMessage:"Text Color"},backgroundColorSection:{id:"action.section.backgroundColor",defaultMessage:"Background Color"}}),z=(0,B.N$)({key:"simple table header column",displayName:K.simpleTableHeaderColumn,label:U.default.formatMessage(K.simpleTableHeaderColumn),svg:A.s,validators:[N.J5S,N.ffD(N.b47),N.W5_,N.p4X],isEnabled:e=>Boolean(e.getFormat().table_block_row_header),action:(e,t,s)=>D.FH({stores:[t],update:{table_block_row_header:!t.getFormat().table_block_row_header},transaction:s})}),q=(0,B.N$)({key:"simple table header row",displayName:K.simpleTableHeaderRow,label:U.default.formatMessage(K.simpleTableHeaderRow),svg:_.f,validators:[N.J5S,N.ffD(N.b47),N.W5_,N.zOn],isEnabled:e=>Boolean(e.getFormat().table_block_column_header),action:(e,t,s)=>D.FH({stores:[t],update:{table_block_column_header:!t.getFormat().table_block_column_header},transaction:s})}),G=(0,B.cN)({key:"insert column left",displayName:K.simpleTableInsertColumnLeft,analyticsName:K.simpleTableInsertColumnLeft.defaultMessage,svg:k.V,validators:[N.J5S,N.ffD(N.OPg),N.W5_,N.z22],closeParentMenu:!0,action:e=>{let{environment:t}=e;L.createAndCommit({userAction:"actionRegistry.insertColumnLeft",environment:t,perform:e=>{W.insertColumnLeft({environment:t,transaction:e})}})}}),H=(0,B.cN)({key:"insert column right",displayName:K.simpleTableInsertColumnRight,analyticsName:K.simpleTableInsertColumnRight.defaultMessage,svg:T.n,validators:[N.J5S,N.ffD(N.OPg),N.W5_,N.z22],closeParentMenu:!0,action:e=>{let{environment:t}=e;L.createAndCommit({userAction:"actionRegistry.insertColumnRight",environment:t,perform:e=>{W.insertColumnRight({environment:t,transaction:e})}})}}),Y=(0,B.cs)({key:"duplicate columns",displayName:B.RE.duplicateName,analyticsName:B.RE.duplicateName.defaultMessage,svg:F.a,validators:[N.J5S,N.ffD(N.OPg),N.W5_,N.z22],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t}=e;L.createAndCommit({userAction:"actionRegistry.duplicateColumns",environment:t,perform:e=>{W.duplicateColumns({transaction:e})}})}}),Q=(0,B.cs)({key:"delete columns",displayName:B.RE.deleteName,analyticsName:B.RE.deleteName.defaultMessage,svg:R.y,validators:[N.J5S,N.ffD(N.OPg),N.W5_,N.OTA,N.z22],shortcuts:["delete","backspace"],closeParentMenu:!0,action:e=>{let{environment:t}=e;L.createAndCommit({userAction:"actionRegistry.deleteColumns",environment:t,perform:e=>{W.deleteColumns({environment:t,transaction:e})}})}}),$=(0,B.cN)({key:"clear column contents",displayName:K.simpleTableClearContents,analyticsName:K.simpleTableClearContents.defaultMessage,svg:P.X,validators:[N.J5S,N.ffD(N.OPg),N.W5_,N.z22],closeParentMenu:!0,action:e=>{let{environment:t}=e;L.createAndCommit({userAction:"actionRegistry.clearColumnContents",environment:t,perform:e=>{W.clearSelectionContents({environment:t,transaction:e})}}),W.clearSelection()}}),J=(0,B.cN)({key:"insert row above",displayName:K.simpleTableInsertRowAbove,analyticsName:K.simpleTableInsertRowAbove.defaultMessage,svg:I.Z,validators:[N.J5S,N.ffD(N.OPg),N.W5_,N.EJd],closeParentMenu:!0,action:e=>{let{environment:t}=e;L.createAndCommit({userAction:"actionRegistry.insertRowAbove",environment:t,perform:e=>{W.insertRowAbove({environment:t,transaction:e})}})}}),X=(0,B.cN)({key:"insert row below",displayName:K.simpleTableInsertRowBelow,analyticsName:K.simpleTableInsertRowBelow.defaultMessage,svg:w.M,validators:[N.J5S,N.ffD(N.OPg),N.W5_,N.EJd],closeParentMenu:!0,action:e=>{let{environment:t}=e;L.createAndCommit({userAction:"actionRegistry.insertRowBelow",environment:t,perform:e=>{W.insertRowBelow({environment:t,transaction:e})}})}}),ee=(0,B.cs)({key:"duplicate rows",displayName:B.RE.duplicateName,analyticsName:B.RE.duplicateName.defaultMessage,svg:F.a,validators:[N.J5S,N.ffD(N.OPg),N.W5_,N.EJd],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t}=e;L.createAndCommit({userAction:"actionRegistry.duplicateRows",environment:t,perform:e=>{W.duplicateRows({environment:t,transaction:e})}})}}),te=(0,B.cs)({key:"delete rows",displayName:B.RE.deleteName,analyticsName:B.RE.deleteName.defaultMessage,svg:R.y,validators:[N.J5S,N.ffD(N.OPg),N.W5_,N.W3A,N.EJd],shortcuts:["delete","backspace"],closeParentMenu:!0,action:e=>{let{environment:t}=e;L.createAndCommit({userAction:"actionRegistry.deleteRows",environment:t,perform:e=>{W.deleteRows({environment:t,transaction:e})}})}}),se=(0,B.cN)({key:"clear row contents",displayName:K.simpleTableClearContents,analyticsName:K.simpleTableClearContents.defaultMessage,svg:P.X,validators:[N.J5S,N.ffD(N.OPg),N.W5_,N.EJd],closeParentMenu:!0,action:e=>{let{environment:t}=e;L.createAndCommit({userAction:"actionRegistry.clearRowContents",environment:t,perform:e=>{W.clearSelectionContents({environment:t,transaction:e})}}),W.clearSelection()}}),ne=[N.J5S,N.ffD(N.OPg),N.W5_,N.z22],ie=[N.J5S,N.ffD(N.OPg),N.W5_,N.EJd];function oe(e,t,s,n){const i=n||(0,E.qf)(e),o=(0,B.cN)({key:`color ${s||e}`,displayName:i,analyticsName:i.defaultMessage,fuzzySearchKeywords:(0,B.CJ)(e),validators:"column"===t?ne:ie,action:t=>{let{blocks:s,environment:n}=t;L.createAndCommit({userAction:"actionRegistry.createSimpleTableColorAction",environment:n,perform:t=>{W.setColor(n,e,t)}})},closeParentMenu:!0,render:t=>(0,p.jsx)(V.Z,{...t,color:e,overrideDisplayName:o.displayName}),nativeImageReference:t=>{let{environment:n}=t;return(0,B.q7)(n,e,s)}});return o}const ae=(0,B.$J)({key:"simple table column background color actions",title:B.RE.backgroundSection,overrideSearchTitle:B.RE.backgroundSectionKeywords,render:e=>(0,p.jsx)(c.Z,{...e}),actions:[oe("default","column","default background",E.mF.backgroundColorDefault),...O._K.map((e=>oe(e,"column")))]}),re=(0,B.$J)({key:"simple table column text color actions",title:B.RE.colorSection,overrideSearchTitle:B.RE.colorSection,render:e=>(0,p.jsx)(c.Z,{...e}),actions:[...O.CY.map((e=>oe(e,"column")))]}),le=(0,B.$J)({key:"simple table row background color actions",title:B.RE.backgroundSection,overrideSearchTitle:B.RE.backgroundSectionKeywords,render:e=>(0,p.jsx)(c.Z,{...e}),actions:[oe("default","row","default background",E.mF.backgroundColorDefault),...O._K.map((e=>oe(e,"row")))]}),de=(0,B.$J)({key:"simple table row text color actions",title:B.RE.colorSection,overrideSearchTitle:B.RE.colorSection,render:e=>(0,p.jsx)(c.Z,{...e}),actions:[...O.CY.map((e=>oe(e,"row")))]}),ce=(0,B.MV)({key:"set column color",displayName:B.RE.colorName,analyticsName:B.RE.colorName.defaultMessage,svg:Z.U,validators:ne,subActions:()=>[{key:0,title:U.default.formatMessage(K.textColorSection),render:e=>(0,p.jsx)(c.Z,{...e}),actions:re.actions},{key:1,title:U.default.formatMessage(K.backgroundColorSection),render:e=>(0,p.jsx)(c.Z,{...e}),actions:ae.actions}]}),ue=(0,B.MV)({key:"set row color",displayName:B.RE.colorName,analyticsName:B.RE.colorName.defaultMessage,svg:Z.U,validators:ie,subActions:()=>[{key:0,title:U.default.formatMessage(K.textColorSection),render:e=>(0,p.jsx)(c.Z,{...e}),actions:de.actions},{key:1,title:U.default.formatMessage(K.backgroundColorSection),render:e=>(0,p.jsx)(c.Z,{...e}),actions:le.actions}]}),pe=[(0,B.$J)({key:"column section",render:e=>(0,p.jsx)(c.Z,{...e}),actions:[z,ce,G,H,Y,$,Q]}),(0,B.$J)({key:"row section",render:e=>(0,p.jsx)(c.Z,{...e}),actions:[q,ue,J,X,ee,se,te]})];var me=s(80444),ge=s(8949),he=s(6258),fe=s(27724),xe=s(13713),ye=s(80209),Se=s(48019),ve=s(56940),be=s(68894),Me=s(3386),je=s(78140),Ce=s(40721),we=s(53437),ke=s(83182);function Te(){const e=(0,i.VK)((()=>ge.Z.state),[]);return(0,p.jsx)(ve.Z,{capture:e.isActive,ignoreBlockSelection:!1,restoreSelection:!0,render:()=>(0,p.jsx)(Ie,{})})}function Ie(){const e=(0,n.Fy)(),t=(0,i.VK)((()=>ge.Z.state),[]);return(0,p.jsx)(we.ZP,{popupType:e.isPhone?we.ZP.PopupType.SlideUp:we.ZP.PopupType.Popup,open:t.isActive,originRect:t.isActive?t.originBlockRect:void 0,onDismiss:Ae,placementToOrigin:we.ZP.Placement.Bottom,alignmentToOrigin:we.ZP.Alignment.Start,originGap:0,preventScaleTransition:!0,render:()=>(0,p.jsx)(Oe,{}),preventBlockRenderQueueOnEnter:e.isMobile})}const Ze=(0,a.injectIntl)((function(){const e=(0,n.Fy)();return e.isMobileNative&&e.isIOS&&e.isPhone?(0,p.jsx)(Te,{}):(0,p.jsx)(Ie,{})}));function Pe(){const[e,t]=(0,i.VK)((()=>{const e=ge.Z.state;if(!e.isActive)return[!1,!1];const t=e.stores[0];return[!0,(0,S.qG)(t.id)]}),[]);return e?t?(0,p.jsx)(c.Z,{topBorder:!0,children:(0,p.jsx)(ke.Z,{title:(0,p.jsx)(a.FormattedMessage,{defaultMessage:"Learn about tasks",id:"myTasks.helpTooltip.title"}),href:C.su,analyticsFrom:"block_menu"})}):(0,p.jsx)(c.Z,{topBorder:!0,children:(0,p.jsx)(ke.Z,{title:(0,p.jsx)(a.FormattedMessage,{defaultMessage:"Learn about databases",id:"blocks.blockMenu.collectionHelpButton"}),href:(0,M.UY)("guides.database"),analyticsFrom:"block_menu"})}):null}function Fe(){const e=(0,n.O7)(),t=(0,i.VK)((()=>ge.Z.state),[]),s=(0,i.VK)((()=>e.currentUser.isLoggedIn()),[e]),o=(0,i.VK)((()=>t.isActive&&1===t.stores.length&&(0,S.qG)(t.stores[0].id)),[t]);return s?!t.isActive||t.stores.length>1||o?null:(0,p.jsx)(xe.Z,{store:t.stores[0],isPageMoreButton:!1}):null}function Ae(){y.xv()}function _e(e){ge.Z.state.isActive&&ge.Z.setState({...ge.Z.state,inputValue:e.target.value})}function Re(){const e=(0,a.useIntl)(),t=(0,n.MO)(),s=(0,i.VK)((()=>ge.Z.state),[]);if(!s.isActive||t)return null;const{inputValue:o}=s;return(0,p.jsx)(c.Z,{isInput:!0,children:(0,p.jsx)(be.ZP,{value:o,onChange:_e,focus:!0,focusAfterAnimation:!0,placeholder:e.formatMessage({defaultMessage:"Search actions…",id:"blockMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0})})}function Oe(){var e;const t=(0,n.O7)(),s=(0,n.MO)(),c=(0,i.VK)((()=>ge.Z.state),[]),u=null===(e=c.stores)||void 0===e?void 0:e[0],h=(0,i.VK)((()=>null==u?void 0:u.isCollectionView()),[u]),S=(0,i.VK)((()=>c.isActive?function(e){switch(e){case"default":return d.Qi;case"simple_table":return pe;case"page_mention":return f;case"sidebar_outliner":return g.Oq;case"comment_media":return m;default:(0,l.t1)(e)}}(null==c?void 0:c.actionSectionGroupKey):[]),[c]);if(!c.isActive||!u)return null;const{originBlockRect:M,inputValue:C,publicEditMode:w}=c||{},k={environment:t,blocks:c.stores,originRect:M,publicEditMode:w},T=c.showInput&&(0,p.jsx)(Re,{});let I;return I=s?{menuType:b.og.Modal,title:(0,p.jsx)(a.FormattedMessage,{defaultMessage:"Actions",id:"blockMenu.actionButton.label"}),right:(0,p.jsx)(Ce.DoneMenuText,{}),onClickRight:Ae,header:T}:{menuType:b.og.Popup,width:265,header:T},(0,p.jsx)(Me.Z,{debugName:"BlockMenu",capture:!0,onBackspace:r.yR,children:(0,p.jsxs)(je.Z,{...I,children:[(0,p.jsx)(Se.Z,{filter:C,context:k,sections:S,onAccept:e=>function(e,t){const s=ge.Z.state;if(!s.isActive)return;const{stores:n}=fe.default.state,{analyticsFrom:i,collectionContextStore:a}=s,r=n[0];if(r){const s=r.getParentTable(),n=r.getType();if(n&&s){let l;if(s===o.e0){const e=r.getParentId(),{currentSpaceStore:t}=me.default.getState();t&&void 0!==e&&(l=he.zX.createChildStore(t,{table:o.e0,id:e}))}const d=(0,v.Pn)(a)||{};x.dh(t,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:i,block_id:r.id,block_type:n,parentTeamStore:l,is_toggleable:(0,j._A)(n,r.getFormat()),parent_collection_id:r.getParentCollectionIdUpToTwoLevels(),...d})}}e.closeParentMenu&&y.xv()}(e,t),initialFocus:C?0:void 0}),!C&&(0,p.jsx)(Fe,{}),!C&&(0,p.jsx)(ye.Z,{store:u}),!C&&h&&(0,p.jsx)(Pe,{})]})})}},80209:(e,t,s)=>{s.d(t,{Z:()=>y});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(87479),l=s(9291),d=s(37810),c=s(47307),u=s(76464),p=s(18878),m=s(19037),g=s(98165),h=s(64921),f=s(64369),x=s(85893);const y=function(e){let{store:t}=e;const s=(0,a.Fg)(),y=(0,i.O7)(),S=(0,n.useMemo)((()=>({environment:y,blocks:[t],publicEditMode:void 0})),[y,t]),v=(0,o.VK)((()=>m.xDy([m.Xa0,m.ffD(m.J5S)])(S)),[S]),b=(0,o.VK)((()=>m.xDy([m.c2G,m.ffD(m.zzA)])(S)),[S]);if(v){const{device:e}=y;return(0,x.jsx)(x.Fragment,{children:(0,x.jsx)("div",{style:{backgroundColor:s.sidebarSecondaryBackground,boxShadow:`0 -1px 0 ${s.regularDividerColor}`,marginTop:e.isMobile?28:1},children:(0,x.jsxs)(h.Z,{disabled:!b,style:{padding:12},onClick:()=>async function(e,t){const s=e.getPermissionItems(),n=g.Om(e),i=n?r.Wo(g.fJ(n)):[],o={type:"restore",permissionChanges:r.Xr(s,i)};await c.confirmUserAction({message:(0,p.mX)(o),acceptLabel:(0,p.nH)(o),cancelLabel:(0,x.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"}),description:(0,x.jsx)(p.mo,{openState:o})})&&u.hs({environment:t,store:e})}(t,y),children:[(0,x.jsx)(f.Z,{isMultiline:!0,isSmall:!0,children:(0,x.jsx)(l.FormattedMessage,{id:"blockMenuRestrictedMessage.label",defaultMessage:"You don’t have permission to edit this block because it is restricted."})}),b&&(0,x.jsx)(f.Z,{style:{marginTop:6,fontWeight:d.Z.fontWeight.semibold},children:(0,x.jsx)(l.FormattedMessage,{id:"blockMenuRestrictedMessage.adminRestoreAction.label",defaultMessage:"Restore permissions"})})]})})})}return null}},73657:(e,t,s)=>{s.d(t,{Z:()=>o});s(67294);var n=s(28992),i=s(85893);const o=function(e){return(0,i.jsx)(n.Z,{...e,style:{background:"none",borderBottom:"none",boxShadow:"",marginTop:2,marginBottom:6,paddingTop:4,paddingBottom:4,minHeight:"none",...e.style}})}},81870:(e,t,s)=>{s.d(t,{Z:()=>c});s(67294);var n=s(480),i=s(24405),o=s(84169),a=s(25888),r=s(73063),l=s(16354),d=s(85893);const c=function(e){const t=(0,n.O7)(),s=(0,i.Fg)();return(0,d.jsx)(l.Z,{href:e.href,external:!0,onClick:()=>a.Fs(t,{from:e.helpButtonContext}),children:(0,d.jsx)(r.Z,{icon:o.m,style:{height:24,width:24,marginRight:-6,fill:s.mediumIconColor}})})}},52500:(e,t,s)=>{s.r(t),s.d(t,{CollectionTypedDatabaseMigrationModal:()=>ae});var n=s(67294),i=s(86628),o=s(24405),a=s(92996),r=s(9291),l=s(77907),d=s(52489),c=s(41892),u=s(45238),p=s(85893);const m=(0,u.IU)("drawing",{viewBox:"0 0 12 12",svg:(0,p.jsx)(p.Fragment,{children:(0,p.jsx)("path",{d:"M2.606 9.98a6.714 6.714 0 01-1.162-1.538A6.54 6.54 0 01.8 6.752a5.933 5.933 0 01-.132-1.698c.042-.557.17-1.081.38-1.573.216-.494.512-.932.89-1.313a4.043 4.043 0 011.347-.898A4.761 4.761 0 014.887.928a5.48 5.48 0 011.68.185c.56.15 1.09.381 1.591.694l-.845.83a4.757 4.757 0 00-1.152-.435 4.372 4.372 0 00-1.23-.127c-.41.013-.804.093-1.182.24-.374.146-.71.367-1.006.664a3.09 3.09 0 00-.796 1.352 4.196 4.196 0 00-.117 1.646c.068.576.236 1.14.503 1.694.27.553.63 1.055 1.08 1.504.276.28.564.516.863.708a6 6 0 00.884.469c.287.123.552.22.796.288.247.071.456.127.625.166a.784.784 0 01.4.215c.092.1.136.23.132.39-.006.186-.078.322-.215.41-.136.091-.314.12-.532.088a6.388 6.388 0 01-.698-.151 7.184 7.184 0 01-1.997-.903 6.64 6.64 0 01-1.065-.875zm1.968-1.523L5.8 7.988a3.6 3.6 0 00.874.635c.329.17.669.282 1.02.337.352.055.694.039 1.026-.049a2.03 2.03 0 00.903-.542 1.85 1.85 0 00.537-1.035 2.906 2.906 0 00-.083-1.294 4.542 4.542 0 00-.64-1.348l.826-.82c.341.475.599.962.771 1.46.176.495.27.978.283 1.45.013.472-.055.913-.205 1.323a2.913 2.913 0 01-.678 1.075c-.3.3-.647.52-1.04.664-.391.14-.804.208-1.24.205-.434 0-.867-.064-1.3-.19a5.255 5.255 0 01-1.24-.547 4.715 4.715 0 01-1.04-.855zM5.6 7.48l-1.177.445c-.085.032-.165.014-.24-.054a.21.21 0 01-.053-.244l.459-1.162 4.443-4.439 1.011 1.011L5.6 7.48zm4.819-4.814l-1.01-1.01.468-.47a.716.716 0 01.44-.21.481.481 0 01.414.142l.176.171a.551.551 0 01.171.45.703.703 0 01-.205.453l-.454.474z"})})});var g=s(81570),h=s(37810),f=s(33929),x=s(84198),y=s(44731),S=s(51077),v=s(32662),b=s(64369);const M=(0,r.defineMessages)({dummyTask1:{id:"MyTasksWidgetPreview.dummyTask1",defaultMessage:"Set up sync with Lisa"},dummyTask2:{id:"MyTasksWidgetPreview.dummyTask2",defaultMessage:"Review design docs"},dummyTask3:{id:"MyTasksWidgetPreview.dummyTask3",defaultMessage:"Create color palette"},dummyTask4:{id:"MyTasksWidgetPreview.dummyTask4",defaultMessage:"Book flight to New York"},dummyTask5:{id:"MyTasksWidgetPreview.dummyTask5",defaultMessage:"Fix broken links"},dummyTask6:{id:"MyTasksWidgetPreview.dummyTask6",defaultMessage:"Upgrade database"},Blocked:{id:"MyTasksWidgetPreview.blockedStatus",defaultMessage:"Blocked"},"In Progress":{id:"MyTasksWidgetPreview.inProgressStatus",defaultMessage:"In Progress"},"Not Started":{id:"MyTasksWidgetPreview.notStartedStatus",defaultMessage:"Not Started"},locationIndicator:{id:"MyTasksWidgetPreview.locationIndicator",defaultMessage:"In"}}),j=[{icon:"📅",taskName:f.default.formatMessage(M.dummyTask1),status:"Blocked",teamspace:"Eng",location:(0,g.T)({width:13,fill:"#448361"})},{icon:"📚",taskName:f.default.formatMessage(M.dummyTask2),status:"In Progress",teamspace:"Design",location:m({width:13,fill:"#CB912F"})},{icon:"🎨",taskName:f.default.formatMessage(M.dummyTask3),status:"In Progress",teamspace:"Design",location:m({width:13,fill:"#CB912F"})},{icon:"🛫",taskName:f.default.formatMessage(M.dummyTask4),status:"Not Started",teamspace:"Eng",location:(0,g.T)({width:13,fill:"#448361"})},{icon:"🚧",taskName:f.default.formatMessage(M.dummyTask5),status:"Not Started",teamspace:"Design",location:m({width:13,fill:"#CB912F"})},{icon:"👩‍💻",taskName:f.default.formatMessage(M.dummyTask6),status:"Not Started",teamspace:"Eng",location:(0,g.T)({width:13,fill:"#448361"})}],C={Blocked:"red","In Progress":"blue","Not Started":"gray"};function w(){const e=I();return(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(x.Z,{title:(0,p.jsx)(r.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Title",defaultMessage:"My tasks"}),icon:(0,p.jsx)("div",{style:{paddingLeft:4},children:(0,p.jsx)(S.Z,{type:"app_package_asset",size:18,icon:c.Z.images.appPackages.taskDbIconSvg})}),children:(0,p.jsx)("div",{style:e.dummyAssignedToMe,children:(0,p.jsx)(k,{})})})})}function k(){const e=j.map(((e,t)=>(0,p.jsx)(T,{row:e},t)));return(0,p.jsx)("div",{style:{display:"flex",marginTop:4,paddingRight:16,flexDirection:"column"},children:e})}function T(e){let{row:t}=e;const s=I();return(0,p.jsxs)("div",{style:s.eachTask,children:[(0,p.jsxs)("div",{style:s.taskName,children:[(0,p.jsx)("span",{style:s.taskIcon,children:t.icon}),(0,p.jsx)(b.Z,{style:s.taskTitle,children:t.taskName})]}),(0,p.jsx)("div",{style:s.taskStatus,children:(0,p.jsx)(y.J,{type:"status",value:f.default.formatMessage(M[t.status]),color:C[t.status],groupColor:void 0})}),(0,p.jsx)(v.Z,{size:8}),(0,p.jsxs)("div",{style:s.location,children:[(0,p.jsx)("span",{style:s.locationIndicator,children:f.default.formatMessage(M.locationIndicator)}),(0,p.jsx)("div",{style:{...s.locationIcon,..."Design"===t.teamspace?{...s.designTeamspace}:{...s.engTeamspace}},children:t.location})]})]})}function I(){return(0,o.yK)((e=>({dummyAssignedToMe:{width:"60%",maxHeight:270,minHeight:90,paddingBottom:10},eachTask:{display:"flex",alignItems:"center",padding:4},taskName:{width:220,display:"flex",...h.Z.textOverflowStyle},taskIcon:{fontSize:14,marginRight:8},taskTitle:{color:e.regularTextColor,fontSize:14,fontWeight:500},taskStatus:{display:"flex",width:130},location:{display:"flex",alignItems:"center"},locationIndicator:{color:e.mediumTextColor,marginRight:4,maxWidth:48,...h.Z.textOverflowStyle},locationIcon:{display:"flex",justifyContent:"center",fontSize:14,height:18,width:18,borderRadius:4},designTeamspace:{backgroundColor:"light"===e.mode?"#FBF3DB":"#5c3b23"},engTeamspace:{backgroundColor:"light"===e.mode?"#E5F2E2":"#243d30"}})),[])}var Z=s(480),P=s(15145),F=s(12396),A=s(42853),_=s(47453),R=s(31701),O=s(53965),B=s(8406),D=s(64964),L=s(13447),V=s(91851),N=s(34517),E=s(40663),U=s(51592),W=s(27383),K=s(60709),z=s(94841),q=s(31194),G=s(1310),H=s(52275),Y=s(31945),Q=s(78140),$=s(32163),J=s(85740),X=s(58297),ee=s(72495),te=s(74523);function se(e){const t=(0,Z.O7)(),s=(0,r.useIntl)(),l=(0,Z.MO)(),c=(0,i.VK)((()=>l&&t.device.isMobileNative),[t.device.isMobileNative,l]),u=function(e){return(0,o.yK)((t=>({formTitle:{display:"inline-flex"},emojiTitle:{fontSize:36,marginRight:8},perPropertyInstruction:{color:t.mediumTextColor,fontSize:e?14:12,marginBottom:8},requiredPropertyError:{color:R.ZP.red,fontSize:e?14:12,marginRight:e?8:6},propertyMappingInstructions:{marginTop:6,marginBottom:24,fontSize:e?16:14,fontWeight:e?500:400},propertyMappingDropdown:{display:"flex",alignItems:"center"},chevronDownIconEnabled:{width:e?14:10,fill:t.lightIconColor},propertyMappingTitle:{fontSize:e?16:14,color:t.lightTextColor},propertyMappingMenu:{borderRadius:4,border:`1px solid ${t.tableDividerColor}`,boxShadow:"none"},propertyConversionCallout:{display:"flex",alignItems:"center",marginLeft:4,marginTop:3,color:t.lightTextColor},a:{color:"white",cursor:"pointer"},propertyIcon:{fill:t.darkTextColor},buttons:{marginBlockStart:e?"auto":void 0},submitMigrationButton:{display:"flex",height:e?36:32,fontSize:e?16:14},learnMore:{display:"flex",justifyContent:"center",marginTop:8,marginLeft:0,width:"100%"},learnMoreButton:{display:"inline-flex",justifyContent:"center",width:"100%",height:26},closeButton:{width:"100%",height:36,marginTop:8,display:"inline-flex",justifyContent:"center",fontSize:16,color:t.lightTextColor}})),[e])}(l),m=(0,o.Fg)(),{databaseType:g,collectionContextStore:h}=e,[f,x]=(0,n.useState)(!1),y=(0,i.VK)((()=>{var e;return null===(e=h.collectionStore())||void 0===e?void 0:e.getSchema()}),[h]),S=(0,i.VK)((()=>E.ck((0,N.appConfigs)(),g)),[g]),M=(0,i.VK)((()=>{if(y&&S)return E.Au(S,y)}),[S,y]),j=(0,i.VK)((()=>{const e={};return Object.keys(S||{}).filter((e=>void 0!==(null==S?void 0:S[e])&&e.startsWith("notion://"))).forEach((t=>{e[t]=void 0})),Object.entries(M||{}).forEach((t=>{let[s,n]=t;e[s]=n})),e}),[S,M]),[C,w]=(0,n.useState)(j),k=(0,n.useMemo)((()=>Object.entries(C).some((e=>{let[t,s]=e;if(t===a.Es.Status){const e=null==y?void 0:y[s||""];if("checkbox"===(null==e?void 0:e.type)||"select"===(null==e?void 0:e.type))return!0}}))),[y,C]),T=(0,n.useCallback)(((e,t)=>{const s=t.type;return E.fm(e,t,y??{}).map((e=>{let[t,n]=e;return{key:t,title:null==n?void 0:n.name,icon:(0,p.jsx)(F.ZP,{size:16,style:u.propertyIcon,theme:m,icon:null==n?void 0:n.icon,type:(null==n?void 0:n.type)||s})}}))}),[m,u.propertyIcon,y]),I=(0,n.useCallback)((e=>{const t=null==S?void 0:S[e],n={width:16,height:16,marginRight:10};if(!t)return null;const i=[...T(e,t),{key:a.bK,title:s.formatMessage(ne.createNew),icon:(0,_.R)({width:n.width,fill:u.propertyIcon.fill}),type:void 0}],o=C[e],d=null==y?void 0:y[o||""],c=!o&&f,m=e===a.Es.Status;let g=null;return o===a.bK?g=(0,_.R)(n):d&&(g=F.wG[null==d?void 0:d.type](n)),(0,p.jsx)(Y.ZP,{popupType:l?Y.Z4.SlideUp:Y.Z4.Popup,renderOrigin:t=>(0,p.jsxs)("div",{style:{marginBottom:24},children:[(0,p.jsx)(b.Z,{style:u.perPropertyInstruction,children:(0,p.jsx)(r.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.PerPropertyInstructions",defaultMessage:"Pick the property that represents {propertyDescription}",values:{propertyDescription:s.formatMessage(ie[e])}})}),(0,p.jsx)(H.Z,{focused:!1,right:(0,p.jsxs)("div",{style:u.propertyMappingDropdown,children:[c?(0,p.jsx)("span",{style:u.requiredPropertyError,children:(0,p.jsx)(r.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.RequiredPropertyError",defaultMessage:"Required"})}):void 0,(0,A.i)({...u.chevronDownIconEnabled,...c?{fill:R.ZP.red}:{}})]}),rightStyle:{marginRight:l?14:8},title:(0,p.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[g,o===a.bK?s.formatMessage(ne.createNew):d?d.name:s.formatMessage(ne.select)]}),titleStyle:o?{display:"flex",alignItems:"center"}:u.propertyMappingTitle,itemMarginLeft:8,style:{...u.propertyMappingMenu,...c?{borderColor:R.ZP.red}:{}},buttonStyle:{margin:0,width:"100%"},...t}),m&&k&&(0,p.jsx)(b.Z,{isSmall:!0,isMultiline:!0,children:(0,p.jsx)("div",{style:u.propertyConversionCallout,children:(0,p.jsx)(r.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CheckboxSelectMappingInfo",defaultMessage:"This property will be converted to a Status property type."})})})]}),placementToOrigin:q.Iw.Bottom,alignmentToOrigin:q.lU.Start,render:t=>{const s=[{key:"propertyOptions",render:e=>(0,p.jsx)(ee.Z,{...e,topBorder:0!==e.index}),items:i.map((s=>{const n={key:s.key,render:t=>(0,p.jsx)(H.Z,{...t,icon:s.icon,title:s.title,checkState:C[e]===s.key}),action:()=>{w({...C,[e]:s.key}),x(!1),t.close()}};return n}))}],n=l?{menuType:K.og.ActionSheet}:{menuType:K.og.Popup,width:250};return(0,p.jsx)(Q.Z,{...n,children:(0,p.jsx)($.Z,{type:$.i.Vertical,initialFocus:void 0,sections:s})})}},e)}),[S,T,s,u,C,y,f,k,l]),se=(0,n.useCallback)((()=>{var e,n;const i=h.collectionStore(),o=h.collectionViewBlockStore();if(!i||!o)return;const l=(0,z.J2)("main"),m=null==l||null===(e=l.getModel())||void 0===e?void 0:e.getRenderUrl({getRecordModel:null==l?void 0:l.getRecordModel,pageVisitSource:P.tY.TypedDBConversionToast}),f=(0,z.J2)("myTasks"),y=null==f||null===(n=f.getModel())||void 0===n?void 0:n.getRenderUrl({getRecordModel:null==f?void 0:f.getRecordModel,pageVisitSource:P.tY.TypedDBConversionToast});!function(e){return!Object.values(e).includes(void 0)}(C)?x(!0):L.createAndCommit({userAction:"CollectionTypedDatabaseMigrationModal.migrateDatabase",environment:t,perform:e=>{V.vD({environment:t,collectionViewBlockStore:o,collectionStore:i,databaseType:g,propertyMapping:{...C},typedPropertySchemas:{...S},transaction:e}),d.Z.setState({isModalOpen:!1,collectionContextStore:void 0}),g===a.iS&&(W.y.locallyMutatedTasksDatabase=!0),B.g2({environment:t,database_type:g,property_mapping:C,collectionContextStore:h});const n=c?(0,p.jsx)(r.FormattedMessage,{defaultMessage:"<span>{databaseName} has been turned into a {singularType} database. You will now be able to see your assigned tasks in <a>My tasks</a>.</span>",id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SuccessfulTypingToastMessage.nativePhone",values:{singularType:(0,U.sN)(g),databaseName:i.getName()||s.formatMessage(ne.defaultCollectionName),span:e=>(0,p.jsx)("span",{children:e}),a:e=>(0,p.jsx)("a",{style:u.a,href:y,children:e})}}):(0,p.jsx)(r.FormattedMessage,{defaultMessage:"<span>{databaseName} has been turned into a {singularType} database. You will now be able to see your assigned tasks in <a>Home</a>.</span>",id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SuccessfulTypingToastMessage",values:{singularType:(0,U.sN)(g),databaseName:i.getName()||s.formatMessage(ne.defaultCollectionName),span:e=>(0,p.jsx)("span",{children:e}),a:e=>(0,p.jsx)("a",{style:u.a,href:m,children:e})}});D.d4({item:{label:n,durationMs:G.JY},undoFunc:()=>{L.createAndCommit({environment:t,userAction:"CollectionTypedDatabaseMigrationModal.TypedDBConversionToast.Undo",perform:e=>{V.RQ({environment:t,collectionContextStore:h,transaction:e})}})}})}})}),[h,C,t,g,S,c,s,u.a]);return(0,p.jsxs)("div",{style:e.containerStyle,children:[(0,p.jsxs)("div",{style:u.formTitle,children:[l?(0,p.jsx)("span",{style:u.emojiTitle,children:"📋"}):null,(0,p.jsx)(b.Z,{style:u.propertyMappingInstructions,isMultiline:!0,children:(0,p.jsx)(r.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.Title",defaultMessage:"{databaseType} databases require status, assignee, and due date properties.",values:{databaseType:(0,O.kC)((0,U.sN)(g))}})})]}),l?(0,p.jsx)(v.Z,{size:16}):null,Object.entries(j).map((e=>{let[t,s]=e;return I(t)})),(0,p.jsxs)("div",{style:u.buttons,children:[(0,p.jsx)(X.Z,{style:u.submitMigrationButton,onClick:se,children:(0,p.jsx)(r.FormattedMessage,{defaultMessage:"Turn into {type} database",id:"CollectionTypedDatabaseMigrationModal.ConfirmMigration.Title",values:{type:(0,U.sN)(g)}})}),l?(0,p.jsx)(J.Z,{style:u.closeButton,onClick:()=>d.Z.reset(),children:(0,p.jsx)(r.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.Close",defaultMessage:"Close"})}):(0,p.jsx)(te.Z,{title:(0,p.jsx)(r.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.Info",defaultMessage:"Learn about {type} databases",values:{type:(0,U.sN)(g)}}),analyticsFrom:"set_database_type",href:z.su,style:u.learnMore,buttonStyle:u.learnMoreButton})]})]})}const ne=(0,r.defineMessages)({createNew:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CreateNew",defaultMessage:"Create new"},select:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.Select",defaultMessage:"Select..."},defaultCollectionName:{id:"CollectionTypedDatabaseMigrationModal.PropertyMappingToastSuccess.DefaultCollectionName",defaultMessage:"This database"},taskStatus:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskStatus",defaultMessage:"status"},taskAssignee:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskAssignee",defaultMessage:"assignee"},taskDueDate:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskDueDate",defaultMessage:"due date"}}),ie={[a.Es.Status]:ne.taskStatus,[a.Es.Assign]:ne.taskAssignee,[a.Es.DueDate]:ne.taskDueDate},oe=32;function ae(){const e=ce(),t=(0,i.VK)((()=>d.Z.state),[]),s=t.isModalOpen;return s?(0,p.jsx)(l.LazyAnnouncementModal,{shouldShow:s,calloutId:"tasks_migration_modal",desktopOnDismiss:()=>d.Z.reset(),desktopInnerStyle:e.desktopInner,desktopRenderInner:()=>(0,p.jsx)(le,{collectionContextStore:t.collectionContextStore}),phoneInnerStyle:e.phoneInner,phoneRenderInner:()=>(0,p.jsx)(de,{collectionContextStore:t.collectionContextStore})}):null}const re=450;function le(e){const t=ce();return(0,p.jsxs)("div",{style:{display:"flex",flexDirection:"column",position:"relative"},children:[(0,p.jsxs)("div",{style:t.title,children:[(0,p.jsx)("span",{style:t.emojiTitle,children:"📋"}),(0,p.jsx)(b.Z,{isMultiline:!0,style:t.previewTitle,children:(0,p.jsx)(r.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Description",defaultMessage:"See all your tasks across multiple databases in your personal Home."})})]}),(0,p.jsx)(v.Z,{size:36}),(0,p.jsx)(w,{}),(0,p.jsx)(se,{collectionContextStore:e.collectionContextStore,databaseType:a.iS,containerStyle:t.form})]})}function de(e){const t=ce();return(0,p.jsx)(se,{collectionContextStore:e.collectionContextStore,databaseType:a.iS,containerStyle:t.phoneForm})}function ce(){return(0,o.yK)((e=>({desktopInner:{width:768,height:re,padding:oe},phoneInner:{width:"100%",height:"100%"},title:{display:"flex",maxWidth:"60%",alignItems:"center"},emojiTitle:{fontSize:36,marginRight:16},previewTitle:{color:e.regularTextColor,width:350,fontSize:17,fontWeight:500},form:{width:"45%",height:re,background:e.sidebarBackground,position:"absolute",top:-oe,right:-oe,padding:oe,zIndex:1,borderLeft:`1px solid ${e.tableDividerColor}`},phoneForm:{display:"flex",flexDirection:"column",width:"100%",height:"100%",padding:oe}})),[])}},81933:(e,t,s)=>{s.r(t),s.d(t,{default:()=>V});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(41892),l=s(64275),d=s(45137),c=s(30845),u=s(9291),p=s(31701),m=s(53965),g=s(37810),h=s(86572),f=s(49085);class x extends f.default{getInitialState(){return{step:"initial"}}}const y=x;var S=s(73796),v=s(70453),b=s(37240),M=s(34430),j=s(8438),C=s(52275),w=s(63296),k=s(14871),T=s(85893);const I=(0,u.injectIntl)((function(e){const t=(0,i.O7)(),s=(0,a.Fg)(),{inputStyle:n}=(0,a.yK)((e=>{const{device:s}=t;return{inputStyle:{backgroundColor:e.whiteButtonBackground,height:31,...s.isMobile&&{height:42},padding:"2px 10px",display:"flex",alignItems:"center",justifyContent:"space-between",borderRadius:4,border:0,transition:"box-shadow 0.3s ease",boxShadow:`0 0 0 1px ${e.outlineButtonBorder}`,background:e.buttonBackground}}}),[t]),{intl:o,question:r}=e,l={menuTitle:o.formatMessage({defaultMessage:"Your question",id:"enterpriseContactModal.yourQuestion.title"}),items:j.T,width:"auto",minWidth:280,getKey:e=>e,selectedItem:r,originGap:4,onSelect:t=>{e.onSelect(t)},renderItem:e=>(0,T.jsx)(C.Z,{title:o.formatMessage(M.Sn[e.value]),...e}),renderOrigin:t=>(0,T.jsxs)(w.Z,{...t,isLarge:!0,style:{...n,...e.invalid&&{border:`1px solid ${p.ZP.red}`}},children:[(0,T.jsx)("div",{style:{display:"flex",alignItems:"center",color:r?s.regularTextColor:s.lightTextColor},children:r?o.formatMessage(M.Sn[r]):(0,T.jsx)(u.FormattedMessage,{defaultMessage:"Select question",id:"enterpriseContactModal.selectQuestion.label"})}),(0,b.s)({width:10,fill:s.lightIconColor})]})};return(0,T.jsx)(k.Z,{...l},"onboarding")}));var Z=s(23063),P=s(64921),F=s(74194),A=s(3386),_=s(50506),R=s(89728),O=s(58297),B=s(26388),D=s(29551);const L=(0,u.defineMessages)({additionalFeedbackPlaceholder:{id:"enterpriseContactModal.additionalFeedback.placeholder",defaultMessage:"What would you like to learn more about?"}});const V=function(){const e=(0,o.qz)(void 0,y),t=(0,n.useCallback)((()=>(0,T.jsx)(ee,{store:e})),[e]),s=(0,o.VK)((()=>S.Z.state.open),[]);return(0,T.jsx)(_.Z,{preventHideChildrenWhileOpening:!0,open:s,render:t,onDismiss:G})};function N(){return{border:`1px solid ${p.ZP.red}`}}function E(e){return{color:e.regularTextColor,fontWeight:g.Z.fontWeight.semibold,fontSize:14}}function U(e){return{background:e.popoverBackground,borderRadius:5,boxShadow:e.mediumBoxShadow}}function W(e){return{position:"absolute",top:"10px",right:"10px",background:e.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}function K(e){return{marginTop:17,fontSize:12,color:e.mediumTextColor,fontWeight:g.Z.fontWeight.medium,lineHeight:"135%",marginBottom:4,textAlign:"left"}}function z(e){return{backgroundColor:e.whiteButtonBackground,height:31}}function q(){const e=(0,a.Fg)();return(0,T.jsxs)("div",{children:[(0,T.jsx)("img",{style:{width:165,height:80},src:r.Z.images.feedbackThankYouPng}),(0,T.jsx)("div",{style:E(e),children:(0,T.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.thanks.caption",defaultMessage:"We've received your inquiry and will be contacting you via email shortly."})})]})}function G(){S.Z.setState({open:!1})}function H(){const e=(0,a.Fg)(),t=(0,i.O7)();return(0,T.jsx)(P.Z,{onClick:()=>{h.g3(t),G()},style:W(e),hoveredStyle:{background:e.buttonPressedBackground},children:(0,l.D)({width:14,fill:e.mediumTextColor})})}function Y(e){if(S.Z.state.open)return e.state.name||S.Z.state.name}function Q(e){if(S.Z.state.open)return e.state.email||S.Z.state.email}function $(e){if(S.Z.state.open)return e.state.question||S.Z.state.question}function J(e){let{store:t}=e;const s=(0,u.useIntl)(),n=(0,a.Fg)(),r=(0,i.O7)(),{additionalFeedback:l,invalidField:c,step:m,companySize:f}=(0,o.VK)((()=>t.state),[t]),x=(0,o.VK)((()=>S.Z.state.open),[]),y=(0,o.VK)((()=>function(e){const{step:t}=e.state;return{position:"absolute",transition:"transform 200ms ease",transform:"initial"===t?"translateY(153px)":"translateY(-180px)"}}(t)),[t]),b=(0,o.VK)((()=>Y(t)),[t]),M=(0,o.VK)((()=>Q(t)),[t]),j=(0,o.VK)((()=>$(t)),[t]),C=(0,o.VK)((()=>function(e,t){return{width:"100%",background:e.popoverBackground,display:"block",padding:"7px 10px",height:310,marginTop:17,marginBottom:17,transition:"opacity 200ms ease-in",opacity:"additional_input"===t.state.step?1:.001}}(n,t)),[t,n]);return x?(0,T.jsxs)("div",{style:{...y,padding:20},children:[(0,d.o)({width:"100%",height:24}),(0,T.jsx)("div",{style:{fontSize:14,fontWeight:g.Z.fontWeight.semibold,paddingTop:6,paddingBottom:4},children:(0,T.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.header",defaultMessage:"Get in touch with sales"})}),(0,T.jsx)("div",{style:{fontSize:12,color:n.mediumTextColor,width:200,margin:"0 auto"},children:(0,T.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.caption",defaultMessage:"We'll work with you on your setup and help you land on the best plan."})}),(0,T.jsx)("div",{style:{...K(n),marginTop:24},children:(0,T.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.nameLabel",defaultMessage:"Your name"})}),(0,T.jsx)(F.Z,{focusInitial:!0,value:b,placeholder:"Ada Lovelace",style:{marginRight:4,...z(n),..."name"===c&&N()},onChange:e=>{S.Z.setState({...S.Z.state,open:!0,name:void 0}),t.setState({...t.state,name:e.target.value}),h.QO(r,{contactFieldType:"name",contactFieldValue:e.target.value})}}),(0,T.jsx)("div",{style:K(n),children:(0,T.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.emailLabel",defaultMessage:"Your work email"})}),(0,T.jsx)(F.Z,{value:M,placeholder:"ada@lovelace.app",type:"email",style:{marginRight:4,...z(n),..."email"===c&&N()},onChange:e=>{S.Z.setState({...S.Z.state,open:!0,email:void 0}),t.setState({...t.state,email:e.target.value}),h.QO(r,{contactFieldType:"email",contactFieldValue:e.target.value})}}),(0,T.jsx)("div",{style:K(n),children:(0,T.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.companySizeLabel",defaultMessage:"Company size"})}),(0,T.jsx)(D.gq,{children:(0,v.getCompanySizeOptions)().map((e=>{let{option:n,message:i}=e;return(0,T.jsx)(R.Z,{isLightGray:!0,isLarge:!0,style:{border:"1px solid #E7E6E5",flexGrow:1,justifyContent:"center",...f===n&&{color:p.ZP.blue,border:`1px solid ${p.ZP.blue}`}},onClick:()=>{t.setState({...t.state,companySize:n}),h.QO(r,{contactFieldType:"companySize",contactFieldValue:n})},children:s.formatMessage(i)},n)}))}),(0,T.jsx)("div",{style:K(n),children:(0,T.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.questionLabel",defaultMessage:"Your question"})}),(0,T.jsx)(I,{question:j,invalid:"question"===c,onSelect:e=>{t.setState({...t.state,question:e,step:"other"===e?"additional_input":"initial"}),h.QO(r,{contactFieldType:"question",contactFieldValue:"other"===e?"additional_input":"initial"})}}),(0,T.jsx)(F.Z,{textarea:!0,textareaElementAttributes:{style:{width:"100%",height:"100%",background:"none",border:"none",resize:"none"}},style:C,focus:"additional_input"===m,value:l,placeholder:s.formatMessage(L.additionalFeedbackPlaceholder),onChange:e=>{t.setState({...t.state,additionalFeedback:e.target.value}),h.QO(r,{contactFieldType:"additionalFeedback",contactFieldValue:e.target.value})}})]}):null}function X(e){let{store:t}=e;const s=(0,i.O7)(),{step:n,companySize:a}=(0,o.VK)((()=>t.state),[t]),r="<100"===a;return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Z.Z,{isVisible:"initial"===n||"additional_input"===n,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,T.jsx)(A.Z,{debugName:"ContactModal",capture:!0,onBackspace:m.yR,onLeft:m.yR,onRight:m.yR,onSelectAll:m.yR,onRedo:m.yR,onUndo:m.yR,onCut:m.yR,onCopy:m.yR,onPaste:m.yR,onKeypress:m.yR,onDelete:m.yR,onTab:m.yR,children:(0,T.jsx)(J,{store:t})})}),(0,T.jsx)(Z.Z,{isVisible:"thanks"===n,animationStyle:(l="thanks"===n,{opacity:l?1:0,scale:l?1:.96}),enterAnimationStyle:{opacity:0,scale:.96},exitAnimationStyle:{opacity:0,scale:.96},render:()=>(0,T.jsx)(q,{})}),(0,T.jsx)(Z.Z,{isVisible:"initial"===n||"additional_input"===n,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,T.jsx)(B.ZP,{style:{width:"auto"},textWrap:!0,renderTooltip:()=>r?(0,T.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.companySize.error.label",defaultMessage:"The company size selected is not eligible for a sales assisted plan. Please message support if you have any questions."}):null,render:e=>(0,T.jsx)(O.Z,{...e,disabled:r,isLarge:!0,style:{marginTop:17,width:284,position:"absolute",bottom:20},onClick:()=>{const e=function(e){const t=Q(e),s=Y(e),{companySize:n}=e.state;return s?t&&c.B(t,"email")?n?$(e)?void 0:"question":"company_size":"email":"name"}(t);if(e){const{question:s}=t.state;return t.setState({...t.state,step:"initial",invalidField:e,question:"other"===s?$(t):s}),null}t.setState({...t.state,invalidField:void 0,step:"thanks"}),S.Z.state.open&&h.Ls(s,{email:S.Z.state.email,name:S.Z.state.name,question:S.Z.state.question,...t.state}),m.gw((()=>{S.Z.reset(),m.gw((()=>{t.reset()}),1e3)}),2e3)},children:(0,T.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.sendLabel",defaultMessage:"Send"})})})})]});var l}function ee(e){let{store:t}=e;const s=(0,a.Fg)();return(0,T.jsxs)("div",{style:U(s),children:[(0,T.jsx)(H,{}),(0,T.jsx)(D.gq,{style:{width:320,height:470,overflow:"hidden",position:"relative",padding:20,cursor:"default",textAlign:"center",justifyContent:"center"},alignItems:"center",alignContent:"center",children:(0,T.jsx)(X,{store:t})})]})}},85324:(e,t,s)=>{s.r(t),s.d(t,{default:()=>C});var n=s(67294),i=s(480),o=s(24405),a=s(41892),r=s(86658),l=s(9291),d=s(37810),c=s(19584),u=s(50950),p=s(36867),m=s(45293),g=s(10182),h=s(89728),f=s(58297),x=s(92660),y=s(29551),S=s(85893);function v(){const e=(0,o.yK)(j,[]),t=(0,i.O7)();return(0,S.jsx)(f.Z,{isLarge:!0,style:e.acceptAllButton,onClick:()=>{u.a9(t,{necessary:!0,preference:!0,performance:!0,targeting:!0}),m.Z.setState({open:!1}),u.qo()},children:(0,S.jsx)(l.FormattedMessage,{...r.ze.acceptAllButtonLabel})})}function b(){const e=(0,o.yK)(j,[]),t=(0,i.O7)();return(0,S.jsx)(h.Z,{isLarge:!0,isGray:!0,style:e.moreOptionsButton,onClick:()=>{u.a9(t,{necessary:!0,preference:!1,performance:!1,targeting:!1}),m.Z.setState({open:!1}),u.qo()},children:(0,S.jsx)(l.FormattedMessage,{...r.ze.rejectAllButtonLabel})})}function M(){const e=(0,o.yK)(j,[]);return(0,S.jsx)(g.Z,{hasDismissButton:!0,onDismiss:()=>{m.Z.setState({open:!1})},renderOrigin:t=>(0,S.jsx)(h.Z,{...t,isLarge:!0,isGray:!0,style:e.moreOptionsButton,children:(0,S.jsx)(l.FormattedMessage,{...r.ze.moreOptionsButtonLabel})})})}function j(e){return{modal:{maxWidth:400,padding:24},image:{height:100},title:{marginTop:8,color:e.regularTextColor,fontWeight:d.Z.fontWeight.semibold,fontSize:18},description:{color:e.mediumTextColor,textAlign:"center",fontSize:14,marginTop:8,marginBottom:18},acceptAllButton:{width:"100%",marginBottom:6},moreOptionsButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}}}const C=(0,l.injectIntl)((function(){const e=(0,i.O7)().currentUser.id;(0,n.useEffect)((()=>{if(!e)return;(0,p._)(e);const t=window.setInterval((()=>{(0,p._)(e)}),c.A0);return()=>{window.clearInterval(t)}}),[e]);const t=(0,o.yK)(j,[]);return(0,S.jsx)(x.Z,{onDismiss:()=>{},render:()=>(0,S.jsx)("div",{style:t.modal,children:(0,S.jsxs)(y.gq,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,S.jsx)("img",{style:t.image,src:a.Z.images.feedbackThankYouPng}),(0,S.jsx)("div",{style:t.title,children:(0,S.jsx)(l.FormattedMessage,{id:"cookieModal.requestConsent.title",defaultMessage:"Set your cookie preferences"})}),(0,S.jsx)("div",{style:t.description,children:(0,r.Fd)(u.Tz,"banner")}),(0,S.jsx)(v,{}),(0,S.jsx)(b,{}),(0,S.jsx)(M,{})]})}),requireOnline:!0,modalStore:m.Z})}))},15480:(e,t,s)=>{s.r(t),s.d(t,{default:()=>de});var n=s(67294),i=s(480),o=s(86628),a=s(79257),r=s(11599),l=s(80444),d=s(85680),c=s(88923),u=s(53437),p=s(24405),m=s(15145),g=s(6695),h=s(9999),f=s(90199),x=s(45238),y=s(85893);const S=(0,x.IU)("speechBubbleThick",{viewBox:"0 0 16 16",svg:(0,y.jsx)("path",{d:"M4.32 15.424c.39 0 .677-.192 1.149-.609l2.344-2.064h4.116c2.057 0 3.213-1.19 3.213-3.22V4.22c0-2.03-1.156-3.22-3.213-3.22H3.213C1.163 1 0 2.19 0 4.22V9.53c0 2.037 1.196 3.22 3.165 3.22h.28v1.675c0 .608.322.998.875.998zm.342-1.531v-1.949c0-.403-.178-.56-.56-.56H3.26c-1.285 0-1.9-.65-1.9-1.894V4.26c0-1.243.615-1.893 1.9-1.893h8.627c1.278 0 1.893.65 1.893 1.894v5.23c0 1.243-.615 1.893-1.893 1.893h-4.15c-.417 0-.622.068-.909.369l-2.167 2.14zm-.567-8.668h6.884a.433.433 0 00.423-.438.425.425 0 00-.423-.417H4.095a.419.419 0 00-.417.417c0 .24.184.438.417.438zm0 2.167h6.884a.427.427 0 000-.855H4.095a.425.425 0 00-.417.424c0 .24.184.43.417.43zm0 2.173h4.484c.24 0 .424-.191.424-.423 0-.24-.185-.431-.424-.431H4.095a.422.422 0 00-.417.43.42.42 0 00.417.424z"})});var v=s(92607),b=s(37888),M=s(9291),j=s(53965),C=s(37810),w=s(36610),k=s(96802),T=s(13447),I=s(2005),Z=s(59827),P=s(84210),F=s(60709),A=s(18514),_=s(92547),R=s(6258),O=s(81870),B=s(79131),D=s(84076),L=s(78140),V=s(28992),N=s(40721),E=s(89728),U=s(31278),W=s(76798),K=s(72495),z=s(49085),q=s(61766),G=s(43700),H=s(69872);const Y=z.default.createClass(!1);const Q=function(e){let{schema:t,property:s,format:n,showAsSectionMenu:l,handlePageSectionClick:d,visibility:c,locked:u,store:p}=e;const m=(0,i.O7)(),g=(0,o.qz)(void 0,q.Z),h=(0,o.qz)(void 0,Y),f=(0,o.VK)((()=>h.state),[h]),x=t[s];if(!x)return null;const S=function(e,t){if("hide_if_empty"===t)return r.kq({propertySchema:e})?"hide_if_empty":"show";return t}(x,c);return(0,y.jsx)(H.Z,{onMouseEnter:()=>h.setState(!0),onMouseLeave:()=>h.setState(!1),focused:f,showDragHandle:!m.device.isMobile,showExtensionArrow:!1,propertySchema:x,format:H.L.Name,dontShrinkRight:!0,ignoreLocalHoverState:!0,locked:u,onClick:()=>{u||g.setState({open:!g.state.open})},right:l&&d?(0,y.jsx)(G.Z,{buttonPopupStore:g,visibility:S,visibilityLevels:["show","hide","hide_if_empty","inline","minimal"],locked:u,onSelect:e=>d(e,s,n),onClose:()=>h.setState(!1),type:"relation_property",propertySchema:x,showAsMenu:!0}):(0,y.jsx)(G.Z,{buttonPopupStore:g,visibility:S,locked:u,onSelect:e=>function(e,t,s,n,i){T.createAndCommit({userAction:"CustomizePageMenu.handleShowAsClick",environment:i,perform:i=>{a.M0({property:t,visibility:e,format:s,store:n,transaction:i})}})}(e,s,n,p,m),onClose:()=>h.setState(!1),type:"property",propertySchema:x})},s)};const $=function(e){let{store:t,type:s,locked:n}=e;const r=(0,i.O7)(),l=(0,M.useIntl)(),d=(0,o.qz)(void 0,_.Z),{device:c}=r,u=(0,o.VK)((()=>"page"===s?t.isExternalObjectInstancePageBlockStore():t.isSyncedCollection()),[t,s]);let p;p=c.isMobile?{menuType:F.og.Modal,right:(0,y.jsx)(N.DoneMenuText,{}),onClickRight:a.xv,title:l.formatMessage({id:"customizePageMenu.mobileHeader.label",defaultMessage:"Customize page"})}:{menuType:F.og.Popup,minWidth:400};const m=(0,o.VK)((()=>ee(t,X({store:t,type:s}))),[t,s]),g=(0,o.VK)((()=>d.state.justUnlocked),[d]);return(0,y.jsxs)(L.Z,{...p,header:(0,y.jsx)(se,{store:t,type:s}),children:[(n||g)&&(0,y.jsx)(le,{lockStore:d}),(0,y.jsx)(re,{store:t,locked:n,type:s,lockStore:d,format:m,isSyncedCollection:u}),(0,y.jsx)(ae,{type:s,locked:n,store:t,format:m})]})};function J(e){return{propertyVisibility:e.property_visibility,pageSectionVisibility:e.page_section_visibility}}function X(e){let{type:t,store:s}=e;return s.getSchema()}function ee(e,t){const s=e.getFormat();if(!t)return{};return g.iB(s,t,void 0,g.j5.Collection)}function te(e){let{type:t,store:s}=e;if("collection"!==t)return[];return ee(s,X({type:t,store:s})).collection_page_sections||[]}function se(e){let{store:t,type:s}=e;const n=(0,i.O7)(),r=(0,o.VK)((()=>t&&t.getIcon()),[t]),l=(0,o.VK)((()=>"collection"===s?t.getParentBlockStore():void 0),[t,s]),d=(0,o.VK)((()=>{if(l)return(0,P.ZP)({store:l,fullyQualified:!1,pageVisitSource:m.tY.Breadcrumb})}),[l]);if(n.device.isMobile)return null;if(t){const e=r&&(0,y.jsx)(U.Z,{icon:r,isEmptyPage:!1,size:14,disabled:!0,style:{display:"inline-flex",marginRight:2}}),s=(0,y.jsx)(W.Z,{store:t,style:{display:"inline"}}),n=l?(0,y.jsx)(Z.Q,{prefix:(0,y.jsx)(M.FormattedMessage,{id:"customizePageMenu.header.allPages.label",defaultMessage:"Customize all pages in"}),viewName:l?(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)(D.Z,{onClick:a.xv,href:d,inline:!0,children:[e,s]})}):(0,y.jsxs)(y.Fragment,{children:[e,s]})}):(0,y.jsx)(M.FormattedMessage,{id:"customizePageMenu.header.singlePage.label",defaultMessage:"Customize this page view"});return(0,y.jsx)(V.Z,{style:I.oq,title:n,right:(0,y.jsx)(O.Z,{helpButtonContext:"customize_page_menu",href:(0,A.UY)("guides.customizePageView")})})}return null}function ne(e,t,s,n){if(n){const i=e.map((e=>n.find((t=>t.section===e))));n&&T.createAndCommit({userAction:"CustomizePageMenu.handleDraggableDropSections",environment:s,perform:e=>{a.Do({environment:s,pageSectionFormats:i,store:t,transaction:e})}})}}function ie(e){var t;let{schema:s,property:n,format:l,locked:d}=e;const c=(0,p.Fg)(),u=(0,i.O7)(),m=(0,o.VK)((()=>(0,r.ab)(void 0,n)),[n]);return(0,y.jsx)("div",{style:{display:"inline-flex",width:"100%"},children:(0,y.jsx)(V.Z,{title:null===(t=s[n])||void 0===t?void 0:t.name,icon:(0,v.v)({height:14,width:14,color:c.mediumIconColor,fill:c.mediumIconColor,fontWeight:C.Z.fontWeight.medium}),disabled:d,showDragHandle:!u.device.isMobile,right:(0,y.jsx)(G.Z,{visibility:m,visibilityLevels:["section_hide","inline","minimal"],locked:d,onSelect:e=>{!function(e,t,s,n,i){const o=r.$0();if(!o)return!1;let l=n.collection_page_sections?j.Xh(n.collection_page_sections):[];if(!s[t])return;const d=l.findIndex((e=>e.section===t));-1!==d?l[d]={section:t,visibility:e}:l=[...l,{section:t,visibility:e}];const c="inline"===e||"minimal"===e?"section":"show";l&&(T.createAndCommit({userAction:"CustomizePageMenu.handleShowAsClick",environment:i,perform:e=>{a.Do({environment:i,pageSectionFormats:l,store:o,transaction:e}),a.M0({property:t,visibility:c,store:o,format:n,transaction:e})}}),w.K1(i,{from:"page_properties",mode:"inline"===e?"page_section":"minimal"===e?"minimal_page_section":"property"}))}(e,n,s,l,u)},type:"page",showAsMenu:!0})})})}function oe(e){let{keys:t,visibilityMap:s,format:n,onDrop:l,locked:d,store:c,type:u}=e;const p=(0,i.O7)(),m=(0,o.VK)((()=>X({store:c,type:u})),[c,u]);return c instanceof R.NW?(0,y.jsx)(B.ZP,{direction:"vertical",keys:t,renderKey:e=>{var t;const i=null===(t=m[e])||void 0===t?void 0:t.type;if("collection"===u)return"relation"===i?(0,y.jsx)(Q,{schema:m,visibility:s[e],property:e,format:n,store:c,locked:d,showAsSectionMenu:!0,handlePageSectionClick:(e,t,s)=>function(e,t,s,n){const i=r.$0();if(!i)return;let o=s.collection_page_sections?j.Xh(s.collection_page_sections):[];if("inline"===e||"minimal"===e){const r=o.findIndex((e=>e.section===t));-1!==r?o[r]={section:t,visibility:e}:o=[...o,{section:t,visibility:e}];const l="inline"===e||"minimal"===e?"section":"show";o&&(T.createAndCommit({userAction:"CustomizePageMenu.handleShowAsPageSectionClick",environment:n,perform:e=>{a.Do({environment:n,pageSectionFormats:o,store:i,transaction:e}),a.M0({property:t,visibility:l,store:i,format:s,transaction:e})}}),w.K1(n,{from:"page_properties",mode:"minimal"===e?"minimal_page_section":"page_section"}))}else{const o=g.AX.find((t=>t===e));if(!o)return;T.createAndCommit({userAction:"CustomizePageMenu.handleShowAsPropertyClick",environment:n,perform:e=>{a.M0({property:t,visibility:o,store:i,format:s,transaction:e})}}),w.K1(n,{from:"page_properties",mode:"property"})}}(e,t,s,p)}):(0,y.jsx)(Q,{schema:m,visibility:s[e],property:e,format:n,store:c,locked:d})},onDrop:l}):null}function ae(e){let{format:t,type:s,locked:n,store:r}=e;const l=(0,i.O7)(),d=(0,o.VK)((()=>X({store:r,type:s})),[r,s]),c=(0,o.VK)((()=>te({store:r,type:s}).filter((e=>"inline"===e.visibility||"minimal"===e.visibility)).map((e=>e.section))),[r,s]),u=(0,o.VK)((()=>function(e){let{type:t,store:s}=e;return"collection"!==t?[]:ee(s,X({type:t,store:s})).collection_page_properties||[]}({store:r,type:s})),[r,s]);if(!d||"page"===s)return null;const p=J(t);if(!p)return null;const{propertyVisibility:m}=p;if(!m)return null;const g=m.reduce(((e,t)=>(e[t.property]=t.visibility,e)),{}),h=j.e5(u.map((e=>e.property)),c);return(0,y.jsx)(K.Z,{style:{opacity:n?.5:1},title:(0,y.jsx)(M.FormattedMessage,{id:"customizePageMenu.propertiesSection.header",defaultMessage:"Properties"}),children:(0,y.jsx)(oe,{keys:h,visibilityMap:g,format:t,onDrop:e=>function(e,t,s,n){if(n){const i=e.map((e=>n.find((t=>t.property===e))));a.D2({environment:s,properties:i,store:t})}}(e,r,l,u),store:r,type:s,locked:n})})}function re(e){let{format:t,isSyncedCollection:s,store:n,locked:l,type:d,lockStore:c}=e;const u=(0,i.O7)(),p=(0,o.qz)(c,_.Z),m=(0,o.VK)((()=>X({store:n,type:d})),[n,d]),g=(0,o.VK)((()=>te({store:n,type:d})),[n,d]),f=(0,o.VK)((()=>!l&&!p.state.justUnlocked),[l,p]),x=J(t),{pageSectionVisibility:v}=x,b=(0,o.VK)((()=>(0,r.ab)(v,"margin_comments")),[v]);if(!m||!n)return null;if(!x)return null;if(!v)return null;const j=g.map((e=>e.section)),C={topLevelDiscussions:!s,backLinks:!0,pageComments:!s};return(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(K.Z,{style:{opacity:l?.5:1},title:(0,y.jsx)(M.FormattedMessage,{id:"customizePageMenu.sectionsSection.header",defaultMessage:"Sections"}),topBorder:f,children:(0,y.jsxs)("div",{style:{marginLeft:8},children:[j.length>0&&(0,y.jsxs)(K.Z,{style:{opacity:l?.5:1,width:"100%",paddingBottom:0,paddingTop:0},children:[(0,y.jsx)(B.ZP,{direction:"vertical",keys:j,renderKey:e=>{if("collection"===d&&"inline"===(0,r.ab)(void 0,e))return(0,y.jsx)(ie,{locked:l,schema:m,property:e,format:t})},onDrop:e=>ne(e,n,u,g)}),(0,y.jsx)(B.ZP,{direction:"vertical",keys:j,renderKey:e=>{if("collection"===d&&"minimal"===(0,r.ab)(void 0,e))return(0,y.jsx)(ie,{locked:l,schema:m,property:e,format:t})},onDrop:e=>ne(e,n,u,g)})]}),C.topLevelDiscussions&&(0,y.jsx)(V.Z,{title:(0,y.jsx)(M.FormattedMessage,{id:"customizePageMenu.pageSections.topLevelPageDiscussionsTitle",defaultMessage:"Top-level page discussions"}),icon:S({height:16,width:16}),right:(0,y.jsx)(G.Z,{visibility:v.comments,visibilityLevels:["section_show","section_hide"],locked:l,onSelect:e=>{a.W4({environment:u,pageSection:"comments",visibility:e,store:n,format:t})},type:"page"})}),C.backLinks&&(0,y.jsx)(V.Z,{title:(0,y.jsx)(M.FormattedMessage,{id:"customizePageMenu.pageSections.backlinksTitle",defaultMessage:"Backlinks"}),icon:(0,h.J)({height:16,width:16,transform:"rotate(180deg)"}),right:(0,y.jsx)(G.Z,{visibility:v.backlinks,locked:l,visibilityLevels:["section_show","section_hide","section_collapsed"],onSelect:e=>{a.W4({environment:u,pageSection:"backlinks",visibility:e,store:n,format:t})},type:"page"})}),C.pageComments&&(0,y.jsx)(V.Z,{title:(0,y.jsx)(M.FormattedMessage,{id:"customizePageMenu.pageSections.pageCommentsTitle",defaultMessage:"Page comments"}),icon:S({height:16,width:16}),right:(0,y.jsx)(G.Z,{visibility:b,visibilityLevels:["inline","minimal"],locked:l,onSelect:e=>{a.W4({environment:u,pageSection:"margin_comments",visibility:e,store:n,format:t})},type:"page"})})]})})})}function le(e){let{lockStore:t}=e;const s=(0,p.Fg)(),a=(0,i.O7)(),l=(0,n.useCallback)((()=>function(e,t){const s=r.$0();if(!s)return!1;const n=s.getParentBlockStore();n&&(T.createAndCommit({userAction:"CustomizePageMenu.handleToggleLockClick",environment:e,perform:t=>{k.Wq({environment:e,store:n,isLocked:!r.p1(),transaction:t})}}),t.setState({justUnlocked:!t.state.justUnlocked}))}(a,t)),[a,t]),d=(0,o.VK)((()=>t.state.justUnlocked),[t]);return(0,y.jsxs)("div",{style:{fontSize:12,display:"flex",justifyContent:"center",alignItems:"center",borderTop:`1px solid ${s.regularDividerColor}`,borderBottom:`1px solid ${s.regularDividerColor}`,background:s.sidebarBackground,color:s.mediumTextColor,paddingTop:6,paddingBottom:6},children:[(0,y.jsx)("span",{style:{display:"inline-block",verticalAlign:"middle",paddingRight:6},children:d?(0,b.U)({height:12,width:12,fill:s.mediumIconColor}):(0,f.b)({height:12,width:12,fill:s.mediumIconColor})}),d?(0,y.jsx)(M.FormattedMessage,{id:"customizePageMenu.unlocked.header",defaultMessage:"Settings unlocked on parent database."}):(0,y.jsx)(M.FormattedMessage,{id:"customizePageMenu.locked.header",defaultMessage:"Settings locked on parent database."}),(0,y.jsx)(E.Z,{style:{fontSize:12,color:s.mediumTextColor,fontWeight:C.Z.fontWeight.semibold,marginLeft:2,paddingLeft:4,paddingRight:4,height:20},onClick:l,children:d?(0,y.jsx)(M.FormattedMessage,{id:"customizePageMenu.lock.label",defaultMessage:"Re-lock"}):(0,y.jsx)(M.FormattedMessage,{id:"customizePageMenu.unlock.label",defaultMessage:"Unlock"})})]})}const de=function(){const e=(0,i.O7)(),{device:t}=e,s=(0,o.VK)((()=>d.Z.state),[]);return(0,y.jsx)(u.ZP,{popupType:t.isMobile?u.ZP.PopupType.SlideUp:u.ZP.PopupType.Popup,alignmentToOrigin:u.ZP.Alignment.Center,open:s.isOpen,render:()=>(0,y.jsx)(ce,{}),originRect:s.isOpen?s.rect:void 0,onDismiss:()=>a.xv()})};function ce(){const e=(0,o.VK)((()=>d.Z.state),[]),t=(0,o.VK)((()=>r.$0()),[]),s=(0,o.VK)((()=>c.default.state.open&&c.default.state.target||l.default.state.mainEditorCurrentBlockStore),[]),n=(0,o.VK)((()=>r.p1()),[]);return e.isOpen?t?(0,y.jsx)($,{store:t,type:"collection",locked:n}):s?(0,y.jsx)($,{store:s,type:"page",locked:!1}):null:null}},43700:(e,t,s)=>{s.d(t,{P:()=>f,Z:()=>h});s(67294);var n=s(480),i=s(86628),o=s(24405),a=s(42853),r=s(9291),l=s(61766),d=s(31194),c=s(31945),u=s(89728),p=s(6318),m=s(85893);const g=(0,r.defineMessages)({hideSimpleLabel:{id:"customizePageMenuVisibilitySelect.hideSimple.label",defaultMessage:"Hide"},hideLabel:{id:"customizePageMenuVisibilitySelect.hide.label",defaultMessage:"Always hide"},hidePageLabel:{id:"customizePageMenuVisibilitySelect.off.label",defaultMessage:"Off"},showLabel:{id:"customizePageMenuVisibilitySelect.show.label",defaultMessage:"Always show"},showPageLabel:{id:"customizePageMenuVisibilitySelect.expanded.label",defaultMessage:"Expanded"},hideIfEmptyLabel:{id:"customizePageMenuVisibilitySelect.hideIfEmpty.label",defaultMessage:"Hide when empty"},collapsedLabel:{id:"customizePageMenuVisibilitySelect.collapsed.label",defaultMessage:"Show in popover"},defaultLabel:{id:"customizePageMenuVisibilitySelect.default.label",defaultMessage:"Default"},minimalLabel:{id:"customizePageMenuVisibilitySelect.minimal.label",defaultMessage:"Minimal"},sectionLabel:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"},propertyLabel:{id:"customizePageMenuVisibilitySelect.property.label",defaultMessage:"As property"}});const h=function(e){const t=(0,o.Fg)(),s=(0,n.O7)(),r=(0,i.qz)(e.buttonPopupStore,l.Z),{device:g}=s,{locked:h,visibility:x,showAsMenu:y,onClose:S}=e;return(0,m.jsx)(c.ZP,{popupType:g.isMobile?c.Z4.SlideUp:c.Z4.Popup,buttonPopupStore:r,renderOrigin:e=>(0,m.jsxs)(u.Z,{style:{color:t.mediumTextColor,paddingRight:0,height:s.device.isMobile?32:22},disabled:h,...e,children:[f(x,y),(0,a.i)({width:10,marginLeft:4,marginRight:4,fill:t.lightIconColor})]}),placementToOrigin:d.Iw.Bottom,onClose:S,render:t=>(0,m.jsx)(p.Z,{...e,onClose:t.close})})};function f(e,t){switch(e){case"hide":return(0,m.jsx)(r.FormattedMessage,{...g.hideLabel});case"show":return(0,m.jsx)(r.FormattedMessage,{...g.showLabel});case"hide_if_empty":return(0,m.jsx)(r.FormattedMessage,{...g.hideIfEmptyLabel});case"section_hide":return t?(0,m.jsx)(r.FormattedMessage,{...g.propertyLabel}):(0,m.jsx)(r.FormattedMessage,{...g.hidePageLabel});case"section_show":return(0,m.jsx)(r.FormattedMessage,{...g.showPageLabel});case"section_collapsed":return(0,m.jsx)(r.FormattedMessage,{...g.collapsedLabel});case"inline":return t?(0,m.jsx)(r.FormattedMessage,{...g.sectionLabel}):(0,m.jsx)(r.FormattedMessage,{...g.defaultLabel});case"minimal":return(0,m.jsx)(r.FormattedMessage,{...g.minimalLabel})}}},6318:(e,t,s)=>{s.d(t,{Z:()=>h});s(67294);var n=s(480),i=s(6695),o=s(36591),a=s(9291),r=s(11599),l=s(60709),d=s(52275),c=s(78140),u=s(32163),p=s(72495),m=s(43700),g=s(85893);const h=function(e){let{type:t,visibilityLevels:s,showAsMenu:o,visibility:d,onSelect:m,onClose:h,propertySchema:y}=e;const S=(0,n.O7)(),{device:v}=S,b=[{key:"visibilityLevels",render:e=>(0,g.jsx)(p.Z,{...e,topBorder:0!==e.index}),items:"page"===t||"relation_property"===t?f(t,s).map((e=>x(e,o,d,t,m,h,S))):i.AX.filter((e=>"property"!==t||"hide_if_empty"!==e||r.kq({propertySchema:y}))).map((e=>x(e,o,d,t,m,h,S)))}];let M;return M=v.isMobile?{menuType:l.og.Modal,title:(0,g.jsx)(a.FormattedMessage,{id:"customizePageMenuVisibilitySelect.mobile.title",defaultMessage:"Select visibility"}),right:(0,g.jsx)(a.FormattedMessage,{id:"customizePageMenuVisibilitySelect.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:()=>h&&h()}:{menuType:l.og.Popup,width:"auto",maxWidth:360},(0,g.jsx)(c.Z,{...M,children:(0,g.jsx)(u.Z,{type:u.i.Vertical,initialFocus:void 0,sections:b})})};function f(e,t){return"page"!==e&&"relation_property"!==e?[]:t||i.Sn}function x(e,t,s,n,i,a,r){const{device:l}=r;return{key:e,render:n=>(0,g.jsx)(d.Z,{...n,textWrapperStyle:{marginRight:0},title:(0,g.jsx)("div",{style:{display:"flex",alignItems:"center",width:150},children:(0,g.jsx)("div",{children:(0,m.P)(e,t)})}),right:s===e?(0,g.jsx)("div",{style:{width:l.isMobile?16:14},children:(0,o.e)()}):void 0}),action:()=>{if("page"===n){i(e)}if("relation_property"===n){i(e)}else if("property"===n){i(e)}a&&a()}}}},81070:(e,t,s)=>{s.r(t),s.d(t,{default:()=>J});var n=s(30120),i=s(67294),o=s(83355),a=s(13991),r=s(480),l=s(49085),d=s(41797),c=s(9291),u=s(40506);const p=(0,c.defineMessages)({none:{defaultMessage:"None",id:"dateFormatHelpers.reminderMenuItems.none"},onTheDay:{defaultMessage:"On day of event {formattedTimeText}",id:"dateFormatHelpers.reminderMenuItems.onTheDayOfEvent"},hoursBefore:{defaultMessage:"{numberOfHours, plural, one {{numberOfHours} hour before} other {{numberOfHours} hours before}}",id:"dateFormatHelpers.reminderMenuItems.hoursBefore"},minutesBefore:{defaultMessage:"{numberOfMinutes, plural, one {{numberOfMinutes} minute before} other {{numberOfMinutes} minutes before}}",id:"dateFormatHelpers.reminderMenuItems.minutesBefore"},yearsBefore:{defaultMessage:"{numberOfYears, plural, one {{numberOfYears} year before {formattedTimeText}} other {{numberOfYears} years before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.yearsBefore"},daysBefore:{defaultMessage:"{numberOfDays, plural, one {{numberOfDays} day before {formattedTimeText}} other {{numberOfDays} days before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.daysBefore"},monthsBefore:{defaultMessage:"{numberOfMonths, plural, one {{numberOfMonths} month before {formattedTimeText}} other {{numberOfMonths} months before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.monthsBefore"},weeksBefore:{defaultMessage:"{numberOfWeeks, plural, one {{numberOfWeeks} week before {formattedTimeText}} other {{numberOfWeeks} weeks before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.weeksBefore"},atTimeOf:{defaultMessage:"At time of event",id:"dateFormatHelpers.reminderMenuItems.atTimeOfEvent"}});function m(e){const{reminder:t,shouldShowTime:s,intl:n,formatTime:i}=e;if(!t)return n.formatMessage(p.none);if(u.vJ(t)){const{unit:e,value:o,time:a}=t,r=i({start_time:a,time_format:"LT",humanReadable:!0,intl:n}),l=s?`(${r})`:"";return 0===o?n.formatMessage(p.onTheDay,{formattedTimeText:l}):"day"===e?n.formatMessage(p.daysBefore,{formattedTimeText:l,numberOfDays:o}):"year"===e?n.formatMessage(p.yearsBefore,{formattedTimeText:l,numberOfYears:o}):"month"===e?n.formatMessage(p.monthsBefore,{formattedTimeText:l,numberOfMonths:o}):n.formatMessage(p.weeksBefore,{formattedTimeText:l,numberOfWeeks:o})}{const{unit:e,value:s}=t;return 0===s?n.formatMessage(p.atTimeOf):"hour"===e?n.formatMessage(p.hoursBefore,{numberOfHours:s}):n.formatMessage(p.minutesBefore,{numberOfMinutes:s})}}var g=s(7057),h=s(53877),f=s(84795),x=s(42875),y=s(11843),S=s(36700),v=s(16001),b=s(70203),M=s(31701),j=s(53965),C=s(1898),w=s(19584),k=s(36610),T=s(60709),I=s(18514),Z=s(77907),P=s(76150),F=s(69582),A=s(52275),_=s(31945),R=s(37601),O=s(88359),B=s(1743),D=s(74194),L=s(78140),V=s(32163),N=s(72495),E=s(14871),U=s(24006),W=s(26388),K=s(64369),z=s(83182),q=s(46247),G=s(62069),H=s(85893);const Y={backgroundColor:M.ZP.blueWithAlpha(.15)};class Q extends o.Z{constructor(){super(...arguments),this.storeTypes={store:P.ZP,timezoneQuery:l.default.createClass("")},this.handleWindowKeyDown=e=>{"Escape"===e.key&&this.maybePreEmptivelyBlurInput()},this.handleWindowMouseDown=e=>{e.target instanceof HTMLInputElement&&e.target===document.activeElement||this.maybePreEmptivelyBlurInput()},this.handleChangeReminder=e=>{const t=this.getDateValue();var s,n;if(e){if(u.vJ(e)){var i,o;null===(i=(o=this.props).onChangeValue)||void 0===i||i.call(o,{...t,reminder:{...e,defaultTimeZone:(0,x.r)()}})}else if("datetime"===t.type||"datetimerange"===t.type){var a,r;null===(a=(r=this.props).onChangeValue)||void 0===a||a.call(r,{...t,reminder:e})}}else null===(s=(n=this.props).onChangeValue)||void 0===s||s.call(n,{...t,reminder:e});k.IM(this.environment,{date:t,reminder:e})},this.handleInputChange=e=>{const{device:t}=this.environment,{store:s}=this.stores;s.setState({...s.state,inputTemporaryValue:{...s.state.inputTemporaryValue,[s.state.focus]:e.target.value||""}}),t.isAndroid&&this.handleInputBlur()},this.handleStartDateInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.startDate;if(!t)return;const s=ae(t,this.props.intl,this.props.dateFormat,this.environment,this.props.locale);if(!s)return P.pd.InvalidDate;const n={...this.getDateValue(),start_date:s},i=h.XI(n);if(!i)return P.pd.InvalidRange;ye({newDate:n,currentMonth:i.start,resetField:P.Hv.StartDate},this.stores.store,this.props.onChangeValue)},this.handleStartTimeInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.startTime;if(!t)return;const s=oe(t,this.props.timeFormat,this.props.intl);if(!s)return P.pd.InvalidTime;const n=this.getDateValue();if(u.qg(n)){const{newDate:e,currentMonth:t}=h.vz({previous:n,updatedStartTime:s});ye({newDate:e,currentMonth:t,resetField:P.Hv.StartTime},this.stores.store,this.props.onChangeValue),xe(P.Hv.EndDate,this.stores.store),xe(P.Hv.EndTime,this.stores.store)}else{const e={...n,start_time:s};ye({newDate:e,currentMonth:h.XI(e).start,resetField:P.Hv.StartTime},this.stores.store,this.props.onChangeValue)}},this.handleEndDateInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.endDate;if(!t)return;const s=ae(t,this.props.intl,this.props.dateFormat,this.environment,this.props.locale);if(!s)return P.pd.InvalidDate;const n={...this.getDateValue(),end_date:s},i=h.XI(n);if(!i)return P.pd.InvalidRange;ye({newDate:n,currentMonth:i.end,resetField:P.Hv.EndDate},this.stores.store,this.props.onChangeValue)},this.handleEndTimeInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.endTime;if(!t)return;const s=oe(t,this.props.timeFormat,this.props.intl);if(!s)return P.pd.InvalidTime;const n={...this.getDateValue(),end_time:s},i=h.XI(n);if(!i)return P.pd.InvalidRange;ye({newDate:n,currentMonth:i.end,resetField:P.Hv.EndTime},this.stores.store,this.props.onChangeValue)},this.handleInputBlur=e=>{const{focus:t}=this.stores.store.state;let s;t===P.Hv.StartDate?s=this.handleStartDateInputChange():t===P.Hv.StartTime?s=this.handleStartTimeInputChange():t===P.Hv.EndDate?s=this.handleEndDateInputChange():t===P.Hv.EndTime&&(s=this.handleEndTimeInputChange()),s?this.stores.store.setState({...this.stores.store.state,error:{...this.stores.store.state.error,[t]:s}}):this.stores.store.setState({...this.stores.store.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},inputIsFocused:!1,error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})},this.handleInputSubmit=()=>{const{focus:e}=this.stores.store.state;let t;e===P.Hv.StartDate?t=this.handleStartDateInputChange():e===P.Hv.StartTime?t=this.handleStartTimeInputChange():e===P.Hv.EndDate?t=this.handleEndDateInputChange():e===P.Hv.EndTime&&(t=this.handleEndTimeInputChange()),t?this.stores.store.setState({...this.stores.store.state,error:{...this.stores.store.state.error,[e]:t}}):this.stores.store.setState({...this.stores.store.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})},this.handleDayPickerDayClick=(e,t,s)=>{if(this.props.disabled)return;let i=j.Xh(this.getDateValue());const{focus:o}=this.stores.store.state,a=n.ou.fromJSDate(e).setLocale(u.ah).toFormat(h.Iq);if(!s.shiftKey||"date"!==i.type&&"datetime"!==i.type)if("daterange"===i.type||"datetimerange"===i.type){var r,l;o===P.Hv.StartDate||o===P.Hv.StartTime?i={...i,start_date:a}:o!==P.Hv.EndDate&&o!==P.Hv.EndTime||(i={...i,end_date:a});const e=h.NK(i,(0,x.r)());if(e.end&&e.end<e.start){if("datetimerange"===i.type){const{start_date:e,start_time:t,end_date:s,end_time:n}=i;i={...i,start_date:s,start_time:n,end_date:e,end_time:t}}else{const{start_date:e,end_date:t}=i;i={...i,start_date:t,end_date:e}}this.stores.store.setState({...this.stores.store.state,focus:o===P.Hv.StartDate||o===P.Hv.StartTime?P.Hv.EndDate:P.Hv.StartDate})}null===(r=(l=this.props).onChangeValue)||void 0===r||r.call(l,i),xe(o,this.stores.store);const t=o===P.Hv.StartDate||o===P.Hv.StartTime?P.Hv.EndDate:P.Hv.StartDate;this.stores.store.setState({...this.stores.store.state,focus:t})}else{var d,c;const e={...i,start_date:a};null===(d=(c=this.props).onChangeValue)||void 0===d||d.call(c,e),xe(o,this.stores.store)}else fe({dateValue:i,endDate:a},this.stores.store,this.props.onChangeValue)},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDayPickerMonthChange=e=>function(e,t){t.setState({...t.state,currentMonth:n.ou.fromJSDate(e)})}(e,this.stores.store),this.handleEndDateControlChange=()=>{const e=this.getDateValue();if("datetimerange"===e.type){var t,s;const n={type:"datetime",start_date:e.start_date,start_time:e.start_time,time_zone:e.time_zone,reminder:e.reminder};null===(t=(s=this.props).onChangeValue)||void 0===t||t.call(s,n)}else if("daterange"===e.type){var n,i;const t={type:"date",start_date:e.start_date,reminder:e.reminder};null===(n=(i=this.props).onChangeValue)||void 0===n||n.call(i,t)}else fe({dateValue:e},this.stores.store,this.props.onChangeValue)},this.handleAllDayChange=()=>{const e=this.getDateValue();if("date"===e.type){var t,s;const n={type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:(0,x.r)(),reminder:e.reminder&&u.AE(e.reminder)};null===(t=(s=this.props).onChangeValue)||void 0===t||t.call(s,n)}else if("daterange"===e.type){var n,i;const t={type:"datetimerange",start_date:e.start_date,start_time:"00:00",end_date:e.end_date,end_time:"00:00",time_zone:(0,x.r)(),reminder:e.reminder&&u.AE(e.reminder)};null===(n=(i=this.props).onChangeValue)||void 0===n||n.call(i,t)}else if("datetime"===e.type){var o,a;const t={type:"date",start_date:e.start_date,reminder:e.reminder&&u.wg(e.reminder,(0,x.r)())};null===(o=(a=this.props).onChangeValue)||void 0===o||o.call(a,t)}else{var r,l;const t={type:"daterange",start_date:e.start_date,end_date:e.end_date,reminder:e.reminder&&u.wg(e.reminder,(0,x.r)())};null===(r=(l=this.props).onChangeValue)||void 0===r||r.call(l,t)}},this.handleTimeZoneChange=e=>{const t=this.getDateValue();if("datetime"===t.type||"datetimerange"===t.type){var s,n;const i={...t,time_zone:e};null===(s=(n=this.props).onChangeValue)||void 0===s||s.call(n,i)}},this.handleStartInputDateFocus=()=>{const e=this.getDateValue(),t=h.NK(e,(0,x.r)());this.stores.store.setState({...this.stores.store.state,focus:P.Hv.StartDate,inputIsFocused:!0,currentMonth:t.start})},this.handleStartInputTimeFocus=()=>{const e=this.getDateValue(),t=h.NK(e,(0,x.r)());this.stores.store.setState({...this.stores.store.state,focus:P.Hv.StartTime,inputIsFocused:!0,currentMonth:t.start})},this.handleEndInputDateFocus=()=>{const e=this.getDateValue(),t=h.NK(e,(0,x.r)());t.end&&this.stores.store.setState({...this.stores.store.state,focus:P.Hv.EndDate,inputIsFocused:!0,currentMonth:t.end})},this.handleEndInputTimeFocus=()=>{const e=this.getDateValue(),t=h.NK(e,(0,x.r)());t.end&&this.stores.store.setState({...this.stores.store.state,focus:P.Hv.EndTime,inputIsFocused:!0,currentMonth:t.end})}}UNSAFE_willMount(e){super.UNSAFE_willMount(e),this.openTimeFormat=h.Lg((0,x.r)()),window.addEventListener("mousedown",this.handleWindowMouseDown),window.addEventListener("keydown",this.handleWindowKeyDown,!0)}willUnmount(){super.willUnmount(),window.removeEventListener("mousedown",this.handleWindowMouseDown),window.removeEventListener("keydown",this.handleWindowKeyDown,!0)}maybePreEmptivelyBlurInput(){const{inputIsFocused:e}=this.stores.store.state;e&&this.handleInputBlur()}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,{disabled:s,canConfigureCollection:n,shouldShowReminder:i,header:o,isTemplatePage:a}=this.props,{inputIsFocused:r}=this.stores.store.state,l=this.getDateValue(),d="datetime"===l.type||"datetimerange"===l.type,u="daterange"===l.type||"datetimerange"===l.type,p=(0,H.jsxs)("div",{style:{paddingTop:e.isMobile?16:8,paddingBottom:e.isMobile?16:8,paddingLeft:e.isMobile?t.getSafePaddingLeftCSS(16):14,paddingRight:e.isMobile?t.getSafePaddingRightCSS(16):14,display:d?"block":"flex",...e.isMobile&&{boxShadow:`\n\t\t\t\t\t\t\t0 1px 0 ${this.theme.regularDividerColor}\n\t\t\t\t\t\t`,position:"relative",zIndex:2},background:e.isMobile?this.theme.popoverBackground:void 0},children:[this.renderStartInput(),u&&(0,H.jsx)("div",{style:{width:12,height:8}}),this.renderEndInput(),this.renderTimeZone()]});let m;return m=e.isMobile?{menuType:T.og.Modal,title:(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Date",id:"LuxonDatePropertyMenu.mobileDate.title"}),right:(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneButton.label"}),left:i?(0,H.jsx)(re,{}):void 0,onClickRight:this.props.onDismiss,header:p}:{menuType:T.og.Popup,maxHeight:"none",width:270,header:o},(0,H.jsx)(B.Z,{debugName:"DatePropertyMenu",capture:r,allowEsc:!0,children:(0,H.jsx)(B.Z,{debugName:"DatePropertyMenu",capture:!0,allowUndo:!0,allowEsc:!0,children:(0,H.jsxs)(L.Z,{...m,children:[(0,H.jsx)(R.Z,{show:r}),a&&(0,H.jsx)($,{onChangeValue:this.props.onChangeValue}),(0,H.jsxs)(N.Z,{topBorder:!0,children:[!e.isMobile&&p,(0,H.jsx)("div",{style:{padding:e.isMobile?"16px 14px 16px":"4px 0 4px",textAlign:"center",...e.isMobile&&{borderBottom:`1px solid ${this.theme.regularDividerColor}`,background:this.theme.popoverBackground}},children:this.renderCalendar()})]}),!s&&this.renderControls(),!s&&n&&(0,H.jsx)(N.Z,{topBorder:!0,children:this.renderFormatPopup()}),!s&&(0,H.jsx)(N.Z,{topBorder:!0,children:(0,H.jsx)(he,{onChangeValue:this.props.onChangeValue})}),!s&&!e.isMobile&&i&&(0,H.jsx)(N.Z,{topBorder:!0,children:(0,H.jsx)(re,{})})]})})})}renderStartInput(){const{device:e}=this.environment,{disabled:t}=this.props,{focus:s,inputTemporaryValue:n,error:i}=this.stores.store.state,o=this.getDateValue(),a=h.NK(o,(0,x.r)(),te(this.props.locale,this.props.intl)),r=Boolean(i.startDate||i.startTime),l="datetime"===o.type||"datetimerange"===o.type,d="daterange"===o.type||"datetimerange"===o.type,c=s===P.Hv.StartDate||s===P.Hv.StartTime,p=(0,w.z4)(n.startDate)?a.start.toFormat(ie(this.props.dateFormat,this.props.intl,this.props.locale)):n.startDate,m=(0,w.z4)(n.startTime)?a.start.toFormat(se(this.props.timeFormat,!1)):n.startTime,g=(0,w.z4)(n.startDate)?a.start.toFormat(h.Iq):n.startDate,f=(0,w.z4)(n.startTime)?a.start.toFormat(u.jK):n.startTime;return(0,H.jsxs)("div",{style:{...r?pe(this.theme):c&&d?me(this.theme):ue(this.theme),fontSize:e.isMobile?16:14},children:[(0,H.jsx)(W.ZP,{renderTooltip:()=>ne(i.startDate,this.props.intl),originGap:12,forceVisibleState:Boolean(i.startDate),placement:W.ug.Left,render:()=>e.isMobile?(0,H.jsx)(D.Z,{type:"date",format:D.B.Transparent,value:g,onChange:this.handleInputChange,onFocus:this.handleStartInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,disabled:t,size:1}):(0,H.jsx)(D.Z,{selectAll:!0,format:D.B.Transparent,value:p,focusInitial:s===P.Hv.StartDate,onChange:this.handleInputChange,onFocus:this.handleStartInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,disabled:t,size:1})}),l&&de(this.theme),l&&(0,H.jsx)(W.ZP,{renderTooltip:()=>ne(i.startTime,this.props.intl),originGap:12,forceVisibleState:Boolean(i.startTime),placement:W.ug.Right,render:()=>e.isMobile?(0,H.jsx)(D.Z,{type:"time",format:D.B.Transparent,value:f,onChange:this.handleInputChange,onFocus:this.handleStartInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t}):(0,H.jsx)(D.Z,{format:D.B.Transparent,value:m,focusInitial:s===P.Hv.StartTime,onChange:this.handleInputChange,onFocus:this.handleStartInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})})]})}renderEndInput(){const{device:e}=this.environment,{disabled:t}=this.props,s=this.getDateValue(),n=h.NK(s,(0,x.r)(),te(this.props.locale,this.props.intl)),i="datetime"===s.type||"datetimerange"===s.type;if(n.end){const{focus:s,error:o,inputTemporaryValue:a}=this.stores.store.state,r=Boolean(o.endDate||o.endTime),l=s===P.Hv.EndDate||s===P.Hv.EndTime,d=(0,w.z4)(a.endDate)?n.end.toFormat(ie(this.props.dateFormat,this.props.intl,this.props.locale)):a.endDate,c=(0,w.z4)(a.endTime)?n.end.toFormat(se(this.props.timeFormat,!1)):a.endTime,p=(0,w.z4)(a.endDate)?n.end.toFormat(h.Iq):a.endDate,m=(0,w.z4)(a.endTime)?n.end.toFormat(u.jK):a.endTime,g=this.getDateRangeBounds(),f=g&&g.earliestValidEnd;return(0,H.jsxs)("div",{style:{...r?pe(this.theme):l?me(this.theme):ue(this.theme),fontSize:e.isMobile?16:14},children:[(0,H.jsx)(W.ZP,{renderTooltip:()=>ne(o.endDate,this.props.intl),originGap:12,forceVisibleState:Boolean(o.endDate),placement:W.ug.Left,render:()=>e.isMobile?(0,H.jsx)(D.Z,{type:"date",format:D.B.Transparent,value:p,onChange:this.handleInputChange,onFocus:this.handleEndInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t,inputElementAttributes:{min:f}}):(0,H.jsx)(D.Z,{format:D.B.Transparent,value:d,focusInitial:s===P.Hv.EndDate,onChange:this.handleInputChange,onFocus:this.handleEndInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})}),i&&de(this.theme),i&&(0,H.jsx)(W.ZP,{renderTooltip:()=>ne(o.endTime,this.props.intl),originGap:12,forceVisibleState:Boolean(o.endTime),placement:W.ug.Right,render:()=>e.isMobile?(0,H.jsx)(D.Z,{type:"time",format:D.B.Transparent,value:m,onChange:this.handleInputChange,onFocus:this.handleEndInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t}):(0,H.jsx)(D.Z,{format:D.B.Transparent,value:c,focusInitial:s===P.Hv.EndTime,onChange:this.handleInputChange,onFocus:this.handleEndInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})})]})}}renderTimeZone(){const{device:e}=this.environment,{intl:t}=this.props,s=this.getDateValue();if(("datetime"===s.type||"datetimerange"===s.type)&&s.time_zone!==(0,x.r)())return(0,H.jsx)(K.Z,{isSmall:!0,isMobile:e.isMobile,style:{marginTop:8},children:(0,d.E)(t)[s.time_zone]})}renderCalendar(){const{firstDayOfWeek:e}=this.props,t=this.getDateValueForceCurrentTimeZone(),s=h.NK(t,(0,x.r)()),n=this.stores.store.state.currentMonth||s.start,{focus:i}=this.stores.store.state;if(s.end){const t=s.start.toJSDate(),o=s.end.toJSDate(),r=i===P.Hv.StartDate||i===P.Hv.StartTime;return(0,H.jsx)(Z.LazyDayPicker,{className:"notion-date-property-menu notranslate",weekStartsOn:e,numberOfMonths:1,defaultMonth:n.toJSDate(),month:n.toJSDate(),locale:a.SP,modifiers:{range:{from:t,to:o},...r?{end:o,start:t}:{start:t,end:o}},modifiersStyles:{range:Y,start:r?X():ee(),end:r?ee():X()},showOutsideDays:!0,fixedWeeks:!0,onDayClick:this.handleDayPickerDayClick,onMonthSelected:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDayPickerMonthChange})}{const t=s.start.toJSDate();return(0,H.jsx)(Z.LazyDayPicker,{className:"notion-date-property-menu notranslate",numberOfMonths:1,weekStartsOn:e,defaultMonth:n.toJSDate(),month:n.toJSDate(),locale:a.SP,selected:[t],modifiers:{start:t},modifiersStyles:{start:X()},showOutsideDays:!0,fixedWeeks:!0,onDayClick:this.handleDayPickerDayClick,onMonthSelected:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDayPickerMonthChange})}}renderControls(){const{device:e}=this.environment,{shouldShowReminder:t}=this.props;return e.isMobile?(0,H.jsxs)(N.Z,{topBorder:!0,children:[t&&this.renderReminderControl(),this.renderEndDateControl(),this.renderAllDayControl()]}):(0,H.jsxs)(i.Fragment,{children:[t&&(0,H.jsx)(N.Z,{topBorder:!0,children:this.renderReminderControl()}),(0,H.jsxs)(N.Z,{topBorder:!0,children:[this.renderEndDateControl(),this.renderAllDayControl()]})]})}renderEndDateControl(){const e=this.getDateValue();return(0,H.jsx)(A.Z,{focused:!1,onClick:this.handleEndDateControlChange,title:(0,H.jsx)(c.FormattedMessage,{defaultMessage:"End date",id:"LuxonDatePropertyMenu.menuItem.endDate.label"}),right:(0,H.jsx)(U.Z,{on:"daterange"===e.type||"datetimerange"===e.type,onClick:this.handleEndDateControlChange})})}renderAllDayControl(){const e=this.getDateValue();return(0,H.jsx)(A.Z,{focused:!1,onClick:this.handleAllDayChange,title:(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Include time",id:"LuxonDatePropertyMenu.menuItem.includeTime.label"}),right:(0,H.jsx)(U.Z,{on:"date"!==e.type&&"daterange"!==e.type,onClick:this.handleAllDayChange})})}renderReminderControl(){const{device:e}=this.environment,{intl:t}=this.props,s=this.getDateValue();return(0,H.jsx)(_.ZP,{popupType:e.isMobile?_.Z4.SlideUp:_.Z4.Popup,placementToOrigin:_.pO.Right,renderOrigin:n=>(0,H.jsx)(O.Z,{...n,icon:(0,S.m)({width:14}),title:(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.menuItem.remind.label"}),focused:!1,showExtensionArrow:e.isMobile,right:m({reminder:s.reminder,intl:t,formatTime:g.mr})}),render:n=>{let i;i=e.isMobile?{menuType:T.og.Modal,title:(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.mobileRemindModal.title"}),right:(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneReminderButton.label"}),onClickRight:n.close}:{menuType:T.og.Popup,width:250};const o=("date"===s.type||"daterange"===s.type?u.PI:u.dG).map((e=>{const s=m({reminder:e,shouldShowTime:!0,intl:t,formatTime:g.mr});return{key:s,action:t=>{this.handleChangeReminder(e),n.close()},render:(e,t)=>(0,H.jsx)(A.Z,{...e,title:s})}}));return(0,H.jsx)(L.Z,{...i,children:(0,H.jsx)(V.Z,{type:V.i.Vertical,sections:[{key:"reminder section",render:e=>(0,H.jsx)(N.Z,{...e}),items:o}],initialFocus:void 0})})}})}renderFormatPopup(){const{device:e}=this.environment;return(0,H.jsx)(_.ZP,{popupType:e.isMobile?_.Z4.SlideUp:_.Z4.Popup,placementToOrigin:_.pO.Right,renderOrigin:t=>(0,H.jsx)(A.Z,{...t,icon:(0,v.r)({width:14}),title:(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Date format & timezone",id:"LuxonDatePropertyMenu.menuItem.formatAndTimezone.label"}),focused:!1,showExtensionArrow:e.isMobile}),render:t=>{let s;return s=e.isMobile?{menuType:T.og.Modal,title:(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.mobileDateFormatModal.title"}),right:(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneButton.label"}),onClickRight:t.close}:{menuType:T.og.Popup,width:250},(0,H.jsx)(L.Z,{...s,children:(0,H.jsxs)(N.Z,{children:[(0,H.jsx)(ge,{dateFormat:this.props.dateFormat,onChangeDateFormat:this.props.onChangeDateFormat}),!y.S.includes(a.SP)&&this.renderTimeFormatControl(),this.renderTimeZoneControl()]})})}})}renderTimeFormatControl(){const e=this.getDateValue(),t="date"===e.type||"daterange"===e.type,s=se(this.props.timeFormat,!0),{intl:n}=this.props,i=function(e){const t=se(e,!0),s=le();for(const n in s)if(s[n]===t)return n;return"12h"}(this.props.timeFormat),o={menuTitle:n.formatMessage({defaultMessage:"Time format",id:"LuxonDatePropertyMenu.timeFormatMenu.title"}),items:u.L7,getKey:e=>e,selectedItem:i,onSelect:e=>function(e,t){const s=le()[e];null==t||t(s)}(e,this.props.onChangeTimeFormat),renderItem:e=>(0,H.jsx)(A.Z,{...e,title:n.formatMessage(u.Fi[e.value])}),disabled:t,renderOrigin:e=>(0,H.jsx)(O.Z,{focused:!1,title:(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Time format",id:"LuxonDatePropertyMenu.menuItem.timeFormat.label"}),disabled:t,right:!t&&(s?n.formatMessage(u.Fi[i]):(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.timeFormatMenu.emptyButton.label"})),...e})};return(0,H.jsx)(E.Z,{...o})}renderTimeZoneControl(){const e=this.getDateValue(),t="date"===e.type||"daterange"===e.type,s=this.getTimeZone();return(0,H.jsx)(G.Z,{disabled:t,renderOrigin:e=>(0,H.jsx)(O.Z,{...e,focused:!1,title:(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Timezone",id:"datePropertyMenu.menuItem.time.label"}),disabled:t,right:!t&&h.er(s)}),onSelect:e=>this.handleTimeZoneChange(e)})}getDateValue(){const{value:e}=this.props;return e&&!j.i2(e)?e:this.openTimeFormat}getDateRangeBounds(){const e=this.getDateValue();if(u.h(e)||u.qg(e)){const t=h.NK(e,(0,x.r)());return{earliestValidEnd:t.start.toFormat(h.Iq),latestValidStart:t.end.toFormat(h.Iq)}}}getDateValueForceCurrentTimeZone(){const{value:e}=this.props;return e&&!j.i2(e)?"datetime"===e.type||"datetimerange"===e.type?{...e,time_zone:(0,x.r)()}:e:this.openTimeFormat}getTimeZone(){const e=this.getDateValue();return"datetime"===e.type||"datetimerange"===e.type?e.time_zone:(0,x.r)()}}function $(e){const{onChangeValue:t}=e,s=(0,c.useIntl)();return(0,H.jsx)(N.Z,{title:(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Shortcuts",id:"DatePropertyMenu.menuItem.shortcuts.label"}),children:["now","today"].map((e=>(0,H.jsx)(A.Z,{title:(0,H.jsx)(F.w,{templateVariableType:e}),caption:b.Z08(e,s),inline:!0,onClick:()=>{null==t||t(e)},focused:!1},`relative-date-shortcut-${e}`)))})}Q.displayName="DatePropertyMenu";const J=(0,c.injectIntl)(Q);function X(){return{backgroundColor:M.ZP.blue,color:M.ZP.white}}function ee(){return{backgroundColor:M.ZP.blueWithAlpha(.43)}}function te(e,t){return e||t.locale}function se(e,t){return e&&(e!==u.n3||t)?u._F(e):u.Sc}function ne(e,t){switch(e){case P.pd.InvalidDate:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateError.tooltip",defaultMessage:"Invalid date"});case P.pd.InvalidRange:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateOrTimeRangeError.tooltip",defaultMessage:"Invalid range"});case P.pd.InvalidTime:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidTimeError.tooltip",defaultMessage:"Invalid time"});default:return}}function ie(e,t,s){return void 0===e||"relative"===e||"ll"===e?u.oq(te(s,t)):u.jG(e)}function oe(e,t,s){return(0,f.$v)(e,se(t,!1),s)}function ae(e,t,s,n,i){return n.device.isMobile?(0,f.f_)(e,h.Iq,t):(0,f.f_)(e,ie(s,t,i),t)}function re(){const e=(0,r.O7)(),{device:t}=e;return t.isMobile?(0,H.jsx)(q.Z,{href:(0,I.UY)("guides.reminders"),analyticsFrom:"date_selector"}):(0,H.jsx)(z.Z,{title:(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Learn about reminders",id:"LuxonDatePropertyMenu.learnMore.helpButton.label"}),href:(0,I.UY)("guides.reminders"),analyticsFrom:"date_selector"})}function le(){return(0,y.E)(a.SP).time}function de(e){return(0,H.jsx)("div",{style:{height:14,width:1,background:e.regularDividerColor,marginLeft:6,marginRight:12,flexShrink:0}})}function ce(e){return{display:"flex",alignItems:"center",borderRadius:4,height:28,lineHeight:1.2,background:e.inputBackground,paddingLeft:8,paddingRight:8,flexBasis:"50%"}}function ue(e){return{...ce(e),boxShadow:e.inputBoxShadow,flexGrow:1}}function pe(e){return{...ce(e),boxShadow:`inset 0 0 0 2px ${M.ZP.red}`,background:M.ZP.redWithAlpha(.15),flexGrow:1}}function me(e){return{...ce(e),boxShadow:`inset 0 0 0 2px ${M.ZP.blue}`,background:M.ZP.blueWithAlpha(.15),flexGrow:1}}function ge(e){let{dateFormat:t,onChangeDateFormat:s}=e;const n=(0,c.useIntl)(),i=t||u.sF,o={menuTitle:n.formatMessage({defaultMessage:"Date format",id:"LuxonDatePropertyMenu.dateFormatDropdownButton.label"}),items:u.Zy,getKey:e=>e,selectedItem:i,onSelect:e=>function(e,t){null==t||t(e)}(e,s),renderItem:e=>(0,H.jsx)(A.Z,{...e,title:n.formatMessage(u.fy[e.value])}),renderOrigin:e=>(0,H.jsx)(O.Z,{focused:!1,title:(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.menuItem.format.label"}),right:i?n.formatMessage(u.fy[i]):(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.formatMenu.emptyButton.label"}),...e})};return(0,H.jsx)(E.Z,{...o})}function he(e){let{onChangeValue:t}=e;return(0,H.jsx)(A.Z,{focused:!1,onClick:()=>function(e){null==e||e(void 0)}(t),title:(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Clear",id:"LuxonDatePropertyMenu.clearButton.label"})})}function fe(e,t,s){const{dateValue:n,endDate:i,endTime:o}=e;if("datetime"===n.type){const e={type:"datetimerange",start_date:n.start_date,start_time:n.start_time,end_date:i||n.start_date,end_time:o||n.start_time,time_zone:n.time_zone,reminder:n.reminder};null==s||s(e),t.setState({...t.state,focus:P.Hv.EndDate})}else if("date"===n.type){const e={type:"daterange",start_date:n.start_date,end_date:i||n.start_date,reminder:n.reminder};null==s||s(e),t.setState({...t.state,focus:P.Hv.EndDate})}else(0,C.t1)(n)}function xe(e,t){const{state:s}=t;t.setState({...s,error:{...s.error,[s.focus]:void 0},inputTemporaryValue:{...s.inputTemporaryValue,[s.focus]:void 0}})}function ye(e,t,s){const{newDate:n,currentMonth:i,resetField:o}=e;null==s||s(n),t.setState({...t.state,currentMonth:i}),xe(0,t)}},92660:(e,t,s)=>{s.d(t,{Z:()=>l});s(67294);var n=s(480),i=s(86628),o=s(50506),a=s(53437),r=s(85893);function l(e){const t=(0,n.O7)(),{modalStore:s,render:l}=e,{device:d}=t,c=(0,i.VK)((()=>s.state.open),[s]);return d.isMobile?(0,r.jsx)(a.ZP,{ariaLabel:e.ariaLabel,open:c,popupType:a.ZP.PopupType.SlideUp,origin:e.origin,onDismiss:e.onDismiss,render:l,style:e.style}):(0,r.jsx)(o.Z,{ariaLabel:e.ariaLabel,open:c,preventHideChildrenWhileOpening:!0,render:l,onDismiss:e.onDismiss,style:e.style,innerStyle:e.innerStyle})}},1176:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Y});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(41892),l=s(43593),d=s(23512),c=s(23867),u=s(75246),p=s(9291),m=s(53965),g=s(61652),h=s(12457),f=s(77080);var x=s(60709),y=s(98742),S=s(5691),v=s(61766),b=s(88632),M=s(71071),j=s(44041),C=s(54669),w=s(52275),k=s(1743),T=s(74194),I=s(78140),Z=s(32163),P=s(89728),F=s(58297),A=s(72495),_=s(7931),R=s(24006),O=s(87968),B=s(26388),D=s(64369),L=s(92660),V=s(6202),N=s(60442),E=s(85893);const U=["pdf","html","markdown"],W=["currentView","all"],K=1;function z(e){return e>.1&&e<2}const q=["everything","no_files"],G=(0,p.defineMessages)({dialogLabel:{id:"exportModal.dialogLabel",defaultMessage:"Export"}});function H(e){let{value:t,onChange:s}=e;const i=(0,p.useIntl)(),o=n.useCallback((e=>{const t=e.target.value,n=(0,d._g)(t)||(0,S.m)(t,i);let o;"object"==typeof n?o="percent"===n.format?n.value:n.value/100:"number"==typeof n&&(o=n/100),void 0!==o&&s(o)}),[s,i]),[a,r]=n.useState(!1),l=n.useMemo((()=>(0,d.uf)(Math.round(100*t),"number",i)),[t,i]);return(0,E.jsx)(k.Z,{debugName:"ExportModal",capture:a,children:(0,E.jsx)(T.Z,{value:l,onChange:o,onFocus:()=>r(!0),onBlur:()=>r(!1),style:{width:60},inputStyle:{textAlign:"right"}})})}const Y=function(){const e=(0,p.useIntl)(),t=(0,o.qz)(void 0,v.Z),s=(0,o.qz)(void 0,v.Z),i=(0,o.qz)(void 0,v.Z),a=(0,o.qz)(void 0,v.Z),r=(0,n.useCallback)((()=>(0,E.jsx)(he,{includeContentsPopupStore:a,exportTypePopupStore:i,pdfFormatPopupStore:s,collectionViewExportTypePopupStore:t})),[a,i,s,t]);return(0,E.jsx)(L.Z,{ariaLabel:e.formatMessage(G.dialogLabel),onDismiss:ie,render:r,requireOnline:!0,modalStore:M.ZP})};function Q(e){switch(e){case"pdf":return(0,E.jsx)(p.FormattedMessage,{id:"exportModal.exportFormatButton.pdf.label",defaultMessage:"PDF"});case"markdown":return(0,E.jsx)(p.FormattedMessage,{id:"exportModal.exportFormatButton.markdownAndCSV.label",defaultMessage:"Markdown & CSV"});case"html":return(0,E.jsx)(p.FormattedMessage,{id:"exportModal.exportFormatButton.html.label",defaultMessage:"HTML"})}}function $(e){switch(e){case"everything":return(0,E.jsx)(p.FormattedMessage,{id:"exportModal.includeContentTypes.everything.label",defaultMessage:"Everything"});case"no_files":return(0,E.jsx)(p.FormattedMessage,{id:"exportModal.includeContentTypes.no_files.label",defaultMessage:"No files or images"})}}function J(e){switch(e){case"all":return f.default.checkGate("export_collections_v1")?(0,E.jsx)(p.FormattedMessage,{id:"exportModal.includeDatabases.all.label.defaultView",defaultMessage:"Default View"}):(0,E.jsx)(p.FormattedMessage,{id:"exportModal.includeDatabases.all.label.everything",defaultMessage:"Everything"});case"currentView":return(0,E.jsx)(p.FormattedMessage,{id:"exportModal.includeDatabases.currentView.label",defaultMessage:"Current view"})}}function X(e){switch(e){case"Letter":return(0,E.jsx)(p.FormattedMessage,{id:"exportModal.pageFormatButton.letter.label",defaultMessage:"Letter"});case"A3":return(0,E.jsx)(p.FormattedMessage,{id:"exportModal.pageFormatButton.a3.label",defaultMessage:"A3"});case"A4":return(0,E.jsx)(p.FormattedMessage,{id:"exportModal.pageFormatButton.a4.label",defaultMessage:"A4"});case"Legal":return(0,E.jsx)(p.FormattedMessage,{id:"exportModal.pageFormatButton.legal.label",defaultMessage:"Legal"});case"Tabloid":return(0,E.jsx)(p.FormattedMessage,{id:"exportModal.pageFormatButton.tabloid.label",defaultMessage:"Tabloid"})}}function ee(){const e=M.ZP.state;return e.open&&(0,M.Sw)(e)?void 0===e.exportOptions.scale?K:e.exportOptions.scale:K}function te(){return z(ee())}function se(e){return{width:320,padding:24,fontSize:14,color:e.mediumTextColor}}function ne(){const e=(0,a.Fg)();return(0,E.jsx)("div",{style:se(e),children:(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Please go online to export.",id:"exportModal.offlineMessage.description"})})}function ie(){g.Qr()}function oe(e){const t=M.ZP.state;if(t.open){if((0,M.Sw)(t)&&!g.y1(e))return void j.y(e,{from:"export_modal",for:"enterprise"});g.BO(e,{...t,recursive:!t.recursive})}}function ae(e){if(!te())return;const t=M.ZP.state;t.open&&(g.Qr(),t.root.table===u.bx?g.AW(e,{spaceId:t.root.id,exportOptions:t.exportOptions,shouldExportComments:t.shouldExportComments}):g.ZO(e,{block:{id:t.root.id,spaceId:(0,c.C)(t.root.spaceId)},recursive:t.recursive,exportOptions:t.exportOptions,shouldExportComments:t.shouldExportComments}))}function re(e,t,s,n){const i=M.ZP.state,o=i.open&&"pdf"===e&&"space"===i.root.table&&!g.y1(n)&&"business";return{key:e,action:()=>{t.close(),o?j.y(n,{from:"export_modal",for:o}):function(e,t,s){const n=M.ZP.state;if(!n.open)return;const{exportOptions:i}=n;if(e===i.exportType)return;let o;o="pdf"===e?{...i,exportType:"pdf",pdfFormat:g.GI(t)}:{...i,exportType:e},g.BO(s,{...n,exportOptions:o})}(e,s,n)},render:t=>{let{onClick:s,key:n,...i}=t;return(0,E.jsx)(C.Z,{requireUpgradeToTier:o,analyticsName:"export_modal",onClick:s,render:(t,s)=>(0,E.jsx)(w.Z,{...(0,y.Z)(i,t),title:Q(e),right:s}),renderUpgradeTooltip:()=>(0,E.jsx)(N.Z,{imageURL:r.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Upgrade to export the workspace as PDFs",id:"exportModal.workspacePdfUpgradeTooltip.title"}),caption:(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Creates a zip file containing all pages in the workspace as PDF files.",id:"exportModal.workspacePdfUpgradeTooltip.caption"})}),tooltipPlacement:B.ug.Left,upgradeButtonDesktopStyle:{marginTop:2}},n)}}}function le(e,t,s){return{key:e,action:()=>{t.close(),function(e,t){const s=M.ZP.state;s.open&&g.BO(t,{...s,exportOptions:{...s.exportOptions,includeContents:e}})}(e,s)},render:t=>(0,E.jsx)(w.Z,{...t,title:$(e)})}}function de(e,t,s){return{key:e,action:()=>{t.close(),function(e,t){const s=M.ZP.state;s.open&&g.BO(t,{...s,exportOptions:{...s.exportOptions,collectionViewExportType:e}})}(e,s)},render:t=>(0,E.jsx)(w.Z,{...t,title:J(e)})}}function ce(e,t,s){return{key:e,action:()=>{t.close(),function(e,t){const s=M.ZP.state;s.open&&(0,M.Sw)(s)&&g.BO(t,{...s,exportOptions:{...s.exportOptions,pdfFormat:e}})}(e,s)},render:t=>(0,E.jsx)(w.Z,{...t,title:X(e)})}}function ue(){const e=(0,a.Fg)(),t=(0,i.O7)(),s=(0,o.VK)((()=>ee()),[]);return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",height:32},children:[(0,E.jsx)(D.Z,{style:{color:e.lightTextColor},children:(0,E.jsx)(p.FormattedMessage,{id:"exportModal.pageScale.description",defaultMessage:"Scale percent"})}),(0,E.jsx)(H,{value:s,onChange:e=>function(e,t){const s=M.ZP.state;s.open&&(0,M.Sw)(s)&&g.BO(t,{...s,exportOptions:{...s.exportOptions,scale:e}})}(e,t)})]}),!z(s)&&(0,E.jsx)(h.Z,{show:!0,showDelay:500,showHold:100,render:t=>t&&(0,E.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:32,padding:"4px 0"},children:(0,E.jsx)(D.Z,{isSmall:!0,isMultiline:!0,style:{color:e.errorText},children:(0,E.jsx)(p.FormattedMessage,{id:"exportModal.pageScale.invalidScaleError",defaultMessage:"Scale percent must be a number between 10 and 200"})})})})]})}function pe(e){let{modalState:t,includeContentsPopupStore:s,exportTypePopupStore:n,pdfFormatPopupStore:d,collectionViewExportTypePopupStore:c}=e;const u=(0,a.Fg)(),m=(0,i.O7)(),h=(0,o.qz)(c,v.Z),f=(0,o.qz)(d,v.Z),x=(0,o.qz)(n,v.Z),y=(0,o.qz)(s,v.Z),{device:S,currentUser:b}=m,j=(0,o.VK)((()=>(0,M.Sw)(t)&&!g.y1(m)&&"business"),[t,m]),w=m.device.isWindows,k=(0,o.VK)((()=>te()),[]),T=(0,o.VK)((()=>J(t.exportOptions.collectionViewExportType||"currentView")),[t]);return(0,E.jsxs)("div",{style:{width:320,padding:24,fontSize:14},children:[(0,E.jsx)(_.Z,{isMenuItem:S.isMobile,buttonPopupStore:x,label:(0,E.jsx)(p.FormattedMessage,{id:"exportModal.exportFormat.description",defaultMessage:"Export format"}),selectedTitle:Q(t.exportOptions.exportType),renderMenuSections:e=>[{key:"exportType",render:e=>(0,E.jsx)(A.Z,{...e}),items:U.map((t=>re(t,e,b.id,m)))}]}),t.exportOptions.collectionViewExportType&&(0,E.jsx)(_.Z,{isMenuItem:S.isMobile,buttonPopupStore:h,label:(0,E.jsx)(p.FormattedMessage,{id:"exportModal.includeDatabases.description",defaultMessage:"Include databases"}),selectedTitle:T,renderMenuSections:e=>[{key:"exportCollection",render:e=>(0,E.jsx)(A.Z,{...e}),items:W.map((t=>de(t,e,m)))}]}),(0,E.jsx)(_.Z,{isMenuItem:S.isMobile,buttonPopupStore:y,label:(0,E.jsx)(p.FormattedMessage,{id:"exportModal.includeContents.description",defaultMessage:"Include content"}),selectedTitle:$(t.exportOptions.includeContents||"everything"),renderMenuSections:e=>[{key:"includeContents",render:e=>(0,E.jsx)(A.Z,{...e}),items:q.map((t=>le(t,e,m)))}]}),(0,M.Sw)(t)&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(_.Z,{isMenuItem:S.isMobile,buttonPopupStore:f,label:(0,E.jsx)(p.FormattedMessage,{id:"exportModal.pageFormat.description",defaultMessage:"Page format"}),selectedTitle:X(t.exportOptions.pdfFormat),renderMenuSections:e=>[{key:"isoPaperFormats",render:e=>(0,E.jsx)(A.Z,{...e}),items:l.lJ.map((t=>ce(t,e,m)))},{key:"otherPaperFormats",render:e=>(0,E.jsx)(A.Z,{topBorder:!0,...e}),items:l.bY.map((t=>ce(t,e,m)))}]}),(0,E.jsx)(ue,{})]}),"space"!==t.root.table&&(0,E.jsx)(C.Z,{requireUpgradeToTier:j,analyticsName:"export_modal",onClick:()=>oe(m),render:(e,s)=>(0,E.jsxs)("div",{...e,style:{display:"flex",alignItems:"center",height:32},children:[(0,E.jsxs)("div",{style:{display:"flex",alignItems:"center",marginRight:"auto",color:u.lightTextColor,fontSize:14},children:[(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Include subpages",id:"exportModal.includeSubpages.label"})," ",s&&(0,E.jsx)("div",{style:{marginLeft:8},children:s})]}),(0,E.jsx)(R.Z,{on:t.recursive,disabled:Boolean(j)})]}),renderUpgradeTooltip:()=>(0,E.jsx)(N.Z,{imageURL:r.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Upgrade to include subpages in PDF exports",id:"exportModal.pdfSubpageUpgradeTooltip.title"}),caption:(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Creates a zip file containing all the pages nested inside the current page as PDF files.",id:"exportModal.pdfSubpageUpgradeTooltip.caption"})}),tooltipPlacement:B.ug.Left,upgradeButtonDesktopStyle:{marginTop:2}}),(0,E.jsx)(O.Z,{title:(0,E.jsx)(p.FormattedMessage,{id:"exportModal.flattenExportFiletree.description",defaultMessage:"Create folders for subpages"}),subtitle:"",style:{color:u.lightTextColor,fontSize:14,display:"flex",alignItems:"center",marginRight:"auto",height:32},on:void 0===t.exportOptions.flattenExportFiletree?!w:!t.exportOptions.flattenExportFiletree,disabled:!t.recursive,onChange:()=>function(e){const t=M.ZP.state;t.open&&g.BO(e,{...t,exportOptions:{...t.exportOptions,flattenExportFiletree:!t.exportOptions.flattenExportFiletree}})}(m)}),"html"===t.exportOptions.exportType?(0,E.jsx)(O.Z,{title:(0,E.jsx)(p.FormattedMessage,{id:"exportModal.shouldExportComments.description",defaultMessage:"Export comments"}),subtitle:"",style:{color:u.lightTextColor,fontSize:14,display:"flex",alignItems:"center",marginRight:"auto",height:32},on:t.shouldExportComments,onChange:()=>function(e){const t=M.ZP.state;t.open&&g.BO(e,{...t,shouldExportComments:!t.shouldExportComments})}(m)}):null,(0,E.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:16},children:[(0,E.jsx)(P.Z,{isGray:!0,style:{marginLeft:"auto",marginRight:8},onClick:ie,children:(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Cancel",id:"exportModal.cancelButton.label"})}),(0,E.jsx)(F.Z,{onClick:()=>ae(m),disabled:!k,children:(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Export",id:"exportModal.exportButton.label"})})]})]})}function me(e,t,s,n){const{currentUser:i,device:o}=t;return m.oA([{key:"export type",render:n=>{let{ref:a,...r}=n;return(0,E.jsx)(_.Z,{...r,isMenuItem:o.isMobile,buttonPopupStore:s,label:(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Export format",id:"exportModal.exportFormat.description"}),selectedTitle:Q(e.exportOptions.exportType),renderMenuSections:e=>[{key:"exportType",render:e=>(0,E.jsx)(A.Z,{...e}),items:U.map((s=>re(s,e,i.id,t)))}]})},action:()=>{s.setState({open:!0})}},(0,M.Sw)(e)&&{key:"pdf format",render:s=>{let{ref:i,...a}=s;return(0,E.jsx)(_.Z,{...a,isMenuItem:o.isMobile,buttonPopupStore:n,label:(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Page format",id:"exportModal.pageFormat.description"}),selectedTitle:X(e.exportOptions.pdfFormat),renderMenuSections:e=>[{key:"isoPaperFormats",render:e=>(0,E.jsx)(A.Z,{...e}),items:l.lJ.map((s=>ce(s,e,t)))},{key:"otherPaperFormats",render:e=>(0,E.jsx)(A.Z,{topBorder:!0,...e}),items:l.bY.map((s=>ce(s,e,t)))}]})},action:()=>{n.setState({open:!0})}},"space"!==e.root.table&&{key:"recursive",render:s=>{let{onClick:n,key:i,...o}=s;const a=(0,M.Sw)(e)&&!g.y1(t)&&"business";return(0,E.jsx)(C.Z,{requireUpgradeToTier:a,analyticsName:"export_modal",onClick:n,render:(t,s)=>{const n=(0,y.Z)(o,t);return(0,E.jsx)(w.Z,{...n,title:(0,E.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Include subpages",id:"exportModal.includeSubpages.label"})," ",s&&(0,E.jsx)("div",{style:{marginLeft:8},children:s})]}),right:(0,E.jsx)(R.Z,{...n,on:e.recursive,disabled:Boolean(a)})})},renderUpgradeTooltip:()=>(0,E.jsx)(N.Z,{imageURL:r.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Upgrade to include subpages in PDF exports",id:"exportModal.pdfSubpageUpgradeTooltip.title"}),caption:(0,E.jsx)(p.FormattedMessage,{defaultMessage:"Creates a zip file containing all the pages nested inside the current page as PDF files.",id:"exportModal.pdfSubpageUpgradeTooltip.caption"})}),tooltipPlacement:B.ug.Left,upgradeButtonDesktopStyle:{marginTop:2}},i)},action:()=>oe(t)}])}function ge(e){let{modalState:t,exportTypePopupStore:s,pdfFormatPopupStore:n}=e;const o=(0,i.O7)(),a={menuType:x.og.Modal,title:(0,E.jsx)(p.FormattedMessage,{id:"exportModal.title",defaultMessage:"Export"}),right:(0,E.jsx)(p.FormattedMessage,{id:"exportModal.closeButton.label",defaultMessage:"Close"}),onClickRight:ie};return(0,E.jsx)(I.Z,{...a,children:(0,E.jsx)(Z.Z,{type:Z.i.Vertical,initialFocus:void 0,sections:[{key:"exportOptions",render:e=>(0,E.jsx)(A.Z,{...e}),items:me(t,o,s,n)},{key:"actions",render:e=>{let{children:t,...s}=e;return(0,E.jsx)(A.Z,{isSubmitButton:!0,...s,children:t})},items:[{key:"submit",render:e=>{const{onClick:t,...s}=e;return(0,E.jsx)(V.Z,{...s,onClick:t||(()=>ae(o)),disabled:!te(),title:(0,E.jsx)(p.FormattedMessage,{id:"exportModal.exportButton.label",defaultMessage:"Export"})})},action:()=>ae(o)}]}]})})}function he(e){let{includeContentsPopupStore:t,exportTypePopupStore:s,pdfFormatPopupStore:n,collectionViewExportTypePopupStore:a}=e;const r=(0,i.O7)(),{device:l}=r,d=(0,o.VK)((()=>b.Z.state.online),[]),c=(0,o.VK)((()=>M.ZP.state),[]);return d?c.open&&l.isMobile?(0,E.jsx)(ge,{exportTypePopupStore:s,pdfFormatPopupStore:n,modalState:c}):c.open?(0,E.jsx)(pe,{includeContentsPopupStore:t,exportTypePopupStore:s,pdfFormatPopupStore:n,collectionViewExportTypePopupStore:a,modalState:c}):null:(0,E.jsx)(ne,{})}},16972:(e,t,s)=>{s.d(t,{Z:()=>se});var n=s(67294),i=s(73935),o=s(83355),a=s(480),r=s(9291),l=s(53965),d=s(47307),c=s(27153),u=s(53471),p=s(33929),m=s(60709),g=s(83279),h=s(13401),f=s(79131),x=s(1743),y=s(78140),S=s(40721),v=s(72495),b=(s(57658),s(86628)),M=s(24405),j=s(95538),C=s(43593),w=s(50066),k=s(88864),T=s(99813),I=s(54604),Z=s(95477),P=s(49085);class F extends P.default{getInitialState(){return{open:!1}}}const A=F;var _=s(24736),R=s(52275),O=s(31945),B=s(74194),D=s(32163),L=s(53437),V=s(81865),N=s(85893);const E={flex:"auto",overflow:"hidden"},U={display:"block",maxWidth:"100%",maxHeight:180,cursor:"zoom-in"};class W extends o.Z{constructor(){super(...arguments),this.storeTypes={filePropertyMenuItemStore:A},this.imageNode=null,this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderRenameMenu=()=>(0,N.jsx)(Q,{url:this.props.url,onChange:this.props.onChange,filePropertyMenuItemStore:this.stores.filePropertyMenuItemStore}),this.handleFullScreen=()=>{if(!this.imageNode)return;const e=this.imageNode.getBoundingClientRect(),t=e.width/e.height;I.ui({environment:this.environment,renderFullScreenNode:()=>(0,N.jsx)(V.Z,{url:this.props.url,isAuthenticated:!0,permissionRecord:this.props.store.pointer,width:window.innerWidth,render:(e,t)=>(0,N.jsx)("img",{src:t,style:{position:"relative",maxHeight:"100%",maxWidth:"100%",margin:0,alignSelf:"center",width:"100%"}})}),fullScreenNodeRect:e,contentAspectRatio:t,block:this.props.store,imageUrl:this.props.url})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleRename=()=>{return e=this.props.name,void this.stores.filePropertyMenuItemStore.setState({open:!0,inputValue:e});var e},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleCloseRename=()=>H(this.stores.filePropertyMenuItemStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleRenameInputChange=e=>Y(e,this.props.url,this.props.onChange,this.stores.filePropertyMenuItemStore)}renderComponent(){const{url:e}=this.props;return j.SR({url:e})?this.renderImage(e):this.renderFile()}renderImage(e){const{device:t}=this.environment,{disabled:s}=this.props;return(0,N.jsx)(R.Z,{focused:!1,showDragHandle:!s&&!t.isMobile,style:{paddingTop:t.isMobile?12:8,paddingBottom:t.isMobile?12:8,alignItems:"flex-start"},title:(0,N.jsx)(V.Z,{url:e,isAuthenticated:!0,permissionRecord:this.props.store.pointer,width:300,render:(e,t)=>(0,N.jsx)("div",{style:E,children:(0,N.jsx)("img",{src:t,style:U,onClick:this.handleFullScreen,ref:e=>this.imageNode=e})})}),right:this.renderActionMenu(!0),dontShrinkRight:!0})}renderFile(){const{device:e}=this.environment,{disabled:t}=this.props,{name:s}=this.props;return(0,N.jsx)(L.GI,{open:this.stores.filePropertyMenuItemStore.state.open,popupType:e.isMobile?O.Z4.SlideUp:O.Z4.Popup,origin:(0,N.jsx)(R.Z,{focused:!1,showDragHandle:!t&&!e.isMobile,onClick:()=>G(this.props.url,this.props.name,this.props.store,this.environment),title:s,icon:(0,N.jsx)("div",{style:{width:e.isMobile?16:14},children:(0,w.R)()}),right:this.renderActionMenu(!1),dontShrinkRight:!0}),render:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderRenameMenu,onDismiss:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleCloseRename})}getActionMenuItems(e){const{device:t}=this.environment,{url:s,disabled:n}=this.props,i=[];return e&&i.push({key:"fullscreen",render:e=>(0,N.jsx)(R.Z,{...e,title:(0,N.jsx)(r.FormattedMessage,{defaultMessage:"Full screen",id:"database.actionMenu.fileProperty.fullscreen.title"})}),action:this.handleFullScreen}),(C.E$(s,[Z.default.secureFileS3.url,Z.default.secureFileS3V2.url])||t.isNative)&&i.push({key:"download",render:e=>(0,N.jsx)(R.Z,{...e,title:(0,N.jsx)(r.FormattedMessage,{defaultMessage:"Download",id:"database.actionMenu.fileProperty.download.title"})}),action:()=>function(e,t,s,n){k.Uk(n,{url:e,fileName:t,from:"FilePropertyMenuItem"}),T.ji(n,{url:e,download:!0,downloadName:t,permissionRecord:s.pointer})}(this.props.url,this.props.name,this.props.store,this.environment)}),i.push({key:"original",render:e=>(0,N.jsx)(R.Z,{...e,title:(0,N.jsx)(r.FormattedMessage,{defaultMessage:"View original",id:"database.actionMenu.fileProperty.viewOriginal.title"})}),action:()=>G(this.props.url,this.props.name,this.props.store,this.environment)}),n||e||i.push({key:"rename",render:e=>(0,N.jsx)(R.Z,{...e,title:(0,N.jsx)(r.FormattedMessage,{defaultMessage:"Rename",id:"database.actionMenu.fileProperty.rename.title"})}),action:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleRename}),n||i.push({key:"delete",render:e=>(0,N.jsx)(R.Z,{...e,title:(0,N.jsx)(r.FormattedMessage,{defaultMessage:"Delete",id:"database.actionMenu.fileProperty.delete.title"})}),action:()=>function(e,t){e(t)}(this.props.onDelete,this.props.url)}),i}renderActionMenu(e){const{device:t}=this.environment;return(0,N.jsx)(O.ZP,{popupType:t.isMobile?O.Z4.SlideUp:O.Z4.Popup,renderOrigin:e=>(0,N.jsx)(_.Z,{isMobile:t.isMobile,...e}),render:s=>{let n;return n=t.isMobile?{menuType:m.og.ActionSheet}:{menuType:m.og.Popup,width:200},(0,N.jsx)(y.Z,{...n,children:(0,N.jsx)(D.Z,{type:D.i.Vertical,initialFocus:0,onAccept:s.close,sections:[{key:"section",render:e=>(0,N.jsx)(v.Z,{...e}),items:this.getActionMenuItems(e)}]})})}})}}W.displayName="FilePropertyMenuItem";const K=W;function z(e){return{display:"flex",alignItems:"center",color:e.regularTextColor,fontSize:"13px",padding:"4px 8px"}}function q(e){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}}function G(e,t,s,n){T.Wl(n,{url:e,type:"file",from:"view_original",downloadName:t,permissionRecord:s.pointer})}function H(e){e.setState({open:!1})}function Y(e,t,s,n){const i=n.state;if(!i.open)return;const o=e.target.value;n.setState({...i,inputValue:o});s({url:t,name:C.rF({title:o,source:t})})}function Q(e){let{url:t,onChange:s,filePropertyMenuItemStore:i}=e;const o=(0,M.Fg)(),r=(0,a.O7)(),l=(0,n.useCallback)((()=>H(i)),[i]),d=(0,n.useCallback)((e=>Y(e,t,s,i)),[t,s,i]),{device:c}=r,u=(0,b.VK)((()=>i.state),[i]);if(!u.open)return null;let p;return p=c.isMobile?{menuType:m.og.ActionSheet}:{menuType:m.og.Popup,width:380},(0,N.jsx)(y.Z,{...p,children:(0,N.jsx)("div",{style:z(o),children:(0,N.jsx)(B.Z,{style:q(o),value:u.inputValue,placeholder:C.w2(t),onChange:d,onSubmit:l,focusInitial:!0,selectAll:!0})})})}var $=s(68785),J=s(28992),X=s(32854);const ee=function(e){return(0,N.jsx)(J.Z,{title:(0,N.jsxs)("div",{style:{display:"flex"},children:[(0,N.jsx)($.Z,{style:{marginTop:1,marginRight:6}}),(0,N.jsx)(X.Z,{percentage:e.progressPercent})]})})};class te extends o.Z{constructor(){super(...arguments),this.uploadingFiles=void 0,this.storeTypes={fileUploadStore:g.Z},this.handleAddFileMount=e=>{e&&(this.addFileButton=e)},this.handleAddFileClick=()=>{this.showMediaPicker()},this.handleMediaPickerUploadStart=e=>{c.Z(),this.stores.fileUploadStore.setState({isLoading:!0,progressPercent:0}),this.uploadingFiles=[e]},this.handleMediaPickerUploadComplete=e=>{const{value:t,onChange:s}=this.props;if(!this.uploadingFiles)return;const n=this.uploadingFiles[0];if(!n)return;s({value:[...t,{name:n.name||e,url:e}]}),this.stores.fileUploadStore.reset(),c.Z()},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMediaPickerEmbedComplete=e=>function(e,t,s,n){const i={name:e,url:e};s({value:[...t,i]}),n.reset(),c.Z()}(e,this.props.value,this.props.onChange,this.stores.fileUploadStore),this.handleUploadFilesStart=e=>{this.stores.fileUploadStore.setState({isLoading:!0,progressPercent:0}),this.uploadingFiles=e},this.handleUploadFilesComplete=e=>{const{value:t,onChange:s}=this.props;if(!this.uploadingFiles)return;s({value:[...this.uploadingFiles.map(((t,s)=>{const n=e[s];return{name:t.name||n,url:n}})),...t]}),this.stores.fileUploadStore.reset()},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleUploadProgress=e=>function(e,t){const{progressPercent:s}=e;t.setState({...t.state,progressPercent:s})}(e,this.stores.fileUploadStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleUploadError=()=>(this.stores.fileUploadStore.reset(),void d.showErrorMessage((0,N.jsx)(r.FormattedMessage,{id:"filePropertyMenu.uploadFileFailedError.message",defaultMessage:"Upload failed."})))}didMount(){const{device:e}=this.environment,{uploadFiles:t,store:s}=this.props;t?u.IL({environment:this.environment,files:t,bucket:"secure",record:s.pointer,onBatchStart:this.handleUploadFilesStart,onBatchProgress:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleUploadProgress,onBatchComplete:this.handleUploadFilesComplete,onBatchError:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleUploadError}):ne(this.props.value)&&!e.isMobile&&this.showMediaPicker()}willUnmount(){c.Z()}renderComponent(){const{device:e}=this.environment,{disabled:t}=this.props,s=ne(this.props.value),{isLoading:n,progressPercent:i}=this.stores.fileUploadStore.state;let o;return o=e.isMobile?{menuType:m.og.Modal,title:(0,N.jsx)(r.FormattedMessage,{defaultMessage:"File property",id:"database.fileProperty.mobileMenu.title"}),right:(0,N.jsx)(S.DoneMenuText,{}),onClickRight:this.props.onDismiss}:{menuType:m.og.Popup},(0,N.jsx)(x.Z,{debugName:"FilePropertyMenu",capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!0,children:(0,N.jsxs)(y.Z,{...o,children:[(0,N.jsx)(re,{value:this.props.value,disabled:this.props.disabled,store:this.props.store,onChange:this.props.onChange}),(0,N.jsxs)(v.Z,{topBorder:!s&&!t,desktopStyle:{...s&&{paddingTop:3,paddingBottom:3}},children:[n&&(0,N.jsx)(ee,{progressPercent:i}),!n&&!t&&(0,N.jsx)(h.Z,{focused:!1,onClick:this.handleAddFileClick,title:(0,N.jsx)(r.FormattedMessage,{id:"database.fileProperty.focusedLabel",defaultMessage:"Add a file or image"}),ref:this.handleAddFileMount})]})]})})}showMediaPicker(){const{store:e}=this.props,t=i.findDOMNode(this.addFileButton);if(!t)return;if(!(t instanceof Element))return;const s=p.default.getIntl();c.$(this.environment,{originRect:t.getBoundingClientRect(),originGap:3,isSmallWidth:!0,showArrow:!0,title:s.formatMessage({id:"filePropertyMenu.header",defaultMessage:"File"}),currentTab:"file",tabs:[{type:"file",fileUpload:!0,imageUpload:!1,videoUpload:!1,onUpload:t=>{u.cT({environment:this.environment,file:t,bucket:"secure",record:e.pointer,onStart:this.handleMediaPickerUploadStart,onProgress:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleUploadProgress,onComplete:this.handleMediaPickerUploadComplete,onError:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleUploadError})}},{type:"embed",onChange:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMediaPickerEmbedComplete}]})}}te.displayName="FilePropertyMenu";const se=te;function ne(e){return 0===e.length}function ie(e,t,s){s({value:t.map((t=>t.url===e.url?{name:e.name,url:e.url}:t))})}function oe(e,t,s){s({value:t.filter((t=>t.url!==e))})}function ae(e){let{url:t,value:s,disabled:n,store:i,onChange:o}=e;const r=(0,a.O7)(),{device:l}=r,d=s.find((e=>e.url===t));if(d){const e=d.url,t=d.name;return l.isMobile?(0,N.jsx)(v.Z,{children:(0,N.jsx)(K,{store:i,name:t,url:e,onDelete:e=>oe(e,s,o),onChange:e=>ie(e,s,o),disabled:n})}):(0,N.jsx)(K,{store:i,name:t,url:e,onDelete:e=>oe(e,s,o),onChange:e=>ie(e,s,o),disabled:n})}return null}function re(e){let{value:t,disabled:s,store:i,onChange:o}=e;const r=(0,a.O7)(),{device:d}=r,c=l.oA(t.map((e=>e.url)));return 0===c.length?null:d.isMobile||s?(0,N.jsx)(n.Fragment,{children:c.map((e=>(0,N.jsx)(ae,{url:e,value:t,disabled:s,store:i,onChange:o},e)))}):(0,N.jsx)(v.Z,{children:(0,N.jsx)(f.ZP,{direction:"vertical",keys:c,renderKey:e=>(0,N.jsx)(ae,{url:e,value:t,disabled:s,store:i,onChange:o}),onDrop:e=>function(e,t,s){t({value:l.MR(s,(t=>{const s=t.url;return s?e.indexOf(s):1/0}))})}(e,o,t)})})}},79027:(e,t,s)=>{s.r(t),s.d(t,{default:()=>x});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(41892),l=s(9291),d=s(37810),c=s(91376),u=s(17311),p=s(7844),m=s(50506),g=s(58297),h=s(62385),f=s(85893);function x(){const e=(0,i.Fy)(),t=(0,o.VK)((()=>p.Z.state.open),[]),s=()=>{p.Z.state.open&&p.Z.state.onDecline&&p.Z.state.onDecline(),p.Z.setState({open:!1})},x=()=>{p.Z.state.open&&p.Z.state.onConfirm(),p.Z.setState({open:!1})},y=()=>{s(),c.r$({currentTab:"connected_apps"})},S=(0,a.yK)((e=>({wrap:{padding:"24px 36px 24px",minWidth:300,maxWidth:400},modalHeaderWrap:{textAlign:"center",marginTop:8,marginBottom:18,justifyContent:"space-between"},modalMessage:{fontSize:16,lineHeight:1.5,fontWeight:d.Z.fontWeight.medium,marginTop:15,marginBottom:20,color:e.mediumTextColor}})),[]);return(0,f.jsx)(m.Z,{open:t,innerStyle:S.wrap,preventHideChildrenWhileOpening:!0,render:()=>(0,f.jsx)(n.Fragment,{children:(0,f.jsxs)("div",{style:S.modalHeaderWrap,children:[(0,f.jsx)("img",{src:r.Z.images.googleDriveLogoPng,style:{width:50,display:"inline-block"}}),(0,f.jsx)("div",{style:S.modalMessage,children:(0,f.jsx)(l.FormattedMessage,{defaultMessage:"Notion cannot access the Google Drive file you are trying to embed.",id:"googleAuthPromptModal.noAccessFile.errorMessage"})}),e.isMobileNative?(0,f.jsx)("div",{style:S.modalMessage,children:(0,f.jsx)(l.FormattedMessage,{defaultMessage:"Please use Notion on desktop to connect a new account.",id:"googleAuthPromptModal.mobileUseDesktopPrompt.errorMessage"})}):(0,f.jsx)(g.Z,{isLarge:!0,onClick:x,children:(0,f.jsx)(l.FormattedMessage,{defaultMessage:"Connect to Google",id:"googleAuthPromptModal.connectToGoogleButton.label"})}),!e.isMobile&&(0,f.jsx)("div",{style:{display:"block",marginTop:u.Z.vertical.tiny},children:(0,f.jsx)(h.Z,{underlined:!0,onClick:y,children:(0,f.jsx)(l.FormattedMessage,{defaultMessage:"See my connected accounts",id:"googleAuthPromptModal.seeConnectedAccountsButton.label"})})})]})}),onDismiss:s})}},2520:(e,t,s)=>{s.d(t,{DQ:()=>J,rw:()=>X,OF:()=>G,L6:()=>H,ZP:()=>ne});s(57658);var n=s(67294),i=s(83355),o=s(15095),a=s(54153),r=s(9291),l=s(31701),d=s(53965),c=s(68425),u=s(23586),p=s(72187),m=s(79947),g=s(5385),h=s(33929),f=s(4391),x=s(29798),y=s(73657),S=s(68785),v=s(32163),b=s(43145),M=s(72495),j=s(480),C=s(86628),w=s(24405),k=s(79362),T=s(98742),I=s(61766),Z=s(64921),P=s(31945),F=s(1743),A=s(3386),_=s(26388),R=s(85893);function O(e){let{shouldOpenVariations:t,icon:s,focused:n,color:i,onClick:o,onMouseEnter:a,variations:r,hideTooltip:l,insertIcon:d}=e;const c=(0,C.qz)(void 0,I.Z);return t?(0,R.jsx)(E,{icon:s,focused:n,color:i,onClick:o,onMouseEnter:a,variations:r,hideTooltip:l,insertIcon:d,buttonPopupStore:c}):(0,R.jsx)(V,{icon:s,focused:n,color:i,onClick:o,onMouseEnter:a,variations:r,hideTooltip:l})}const B=O;function D(e){const{device:t}=e;return t.isMobile?{width:p.mz,height:p.mz,fontSize:p.jo}:{width:p.T8,height:p.T8,fontSize:p.WB}}function L(e){return{iconButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,...D(e)},variationMenu:{display:"flex",padding:2,gap:1},iconImage:{...e.device.isMobile?{width:p.jo,height:p.jo}:{width:p.WB,height:p.WB}}}}function V(e){let{events:t,icon:s,focused:n,color:i,onClick:o,onMouseEnter:a,variations:r,hideTooltip:l}=e;const d=(0,w.Fg)(),c=(0,j.O7)(),u=r.tooltip?r.tooltip:s,p="dark"===d.mode?r.dark:r.light;return(0,R.jsx)(_.ZP,{allowHover:Boolean(s&&!l),disableTooltip:l,renderTooltip:()=>u.replaceAll("-"," ").replaceAll("_"," "),closeDelay:0,render:e=>(0,R.jsx)(Z.Z,{focused:n,onClick:o,...(0,T.Z)(t||{},(0,T.Z)({onMouseEnter:a},e)),ignoreLocalHoverState:!0,style:L(c).iconButton,children:(0,R.jsx)("img",{src:`data:image/svg+xml;utf8,${encodeURIComponent(p[i])}`,style:L(c).iconImage,onContextMenu:e=>e.preventDefault()})},s)})}function N(e){const{parent:t,icon:s,variations:n,insertIcon:i}=e,o=(0,w.Fg)(),a=(0,j.O7)(),r="dark"===o.mode?n.light:n.dark,l=Object.keys(r).sort(((e,t)=>k.Oe.indexOf(e)-k.Oe.indexOf(t))).map((o=>{const a=`${s}_${o}`;return{key:a,action:e=>{t.close(),i(`/icons/${a}.svg`)},render:t=>(0,R.jsx)(O,{...e,...t,icon:a,color:o,variations:n,shouldOpenVariations:!1,hideTooltip:!0})}}));return(0,R.jsx)(F.Z,{debugName:"IconPickerMenuItem",capture:!0,allowEsc:!0,children:(0,R.jsx)(v.Z,{type:v.i.Grid,itemsPerRow:5,initialFocus:0,sections:[{key:"variations",render:e=>(0,R.jsx)("div",{...e}),items:l}],renderRow:(e,t)=>(0,R.jsx)("div",{style:L(a).variationMenu,children:e},t)})})}function E(e){let{icon:t,focused:s,color:i,onClick:o,onMouseEnter:a,variations:r,hideTooltip:l,insertIcon:d,buttonPopupStore:c}=e;const u=(0,n.useCallback)((()=>function(e){e.setState({...e.state,open:!1})}(c)),[c]),p=(0,n.useCallback)((e=>function(e,t){e.preventDefault(),t.setState({...t.state,open:!0})}(e,c)),[c]);return(0,R.jsx)(A.Z,{debugName:"IconPickerMenuItem",capture:s,onEnter:p,onEsc:u,children:(0,R.jsx)(P.ZP,{buttonPopupStore:c,popupType:P.Z4.Popup,renderOrigin:e=>(0,R.jsx)(V,{icon:t,focused:s,color:i,onClick:o,onMouseEnter:a,variations:r,hideTooltip:l,events:e}),render:e=>(0,R.jsx)(N,{parent:e,icon:t,variations:r,insertIcon:d})})},t)}const U={display:"flex",flexDirection:"column"},W="recentIcons",K=8,z=p.tg,q=p.Nm,G=p.II,H=p.pq,Y=p.$P,Q=p.qJ,$=p.PS,J=356,X=p.T8*K+2*$,ee=p.vP,te=(0,r.defineMessages)({noResults:{defaultMessage:"No results",id:"emojiPicker.noResults.message"}});class se extends i.Z{constructor(){super(...arguments),this.filter="",this.splitFilter=[],this.storeTypes={store:f.Z,menuListStore:x.Z},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_insertIcon=e=>re(e,this.environment,this.props.onSubmit,this.props.menuRef,this.stores.store,this.props.iconLoggingData),this.createListItem=(e,t)=>{const s=g.x(),n=this.props.enforceIconColor??s,i=`/icons/${`${e}${n?`_${n}`:""}`}.svg`;return{key:i,action:e=>function(e,t,s,n,i,o){re(e,t,s,n,i,o)}(i,this.environment,this.props.onSubmit,this.props.menuRef,this.stores.store,this.props.iconLoggingData),render:s=>(0,R.jsx)(B,{...s,icon:e,color:n??"gray",variations:t,insertIcon:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_insertIcon,shouldOpenVariations:!Boolean(n)})}},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_performGetAllIconsRequest=e=>async function(e,t,s){if(!d.xb(s.getState().allIcons))return s.getState().allIcons;const n=await(0,m.ZP)({environment:t,url:e,method:"GET",format:"json",mode:"cors"});if("success"===n.type)return s.setState({...s.state,allIcons:n.data}),n.data;throw n.error}(e,this.environment,this.stores.store),this.createCategory=(e,t)=>{if(!t)return;let s=[];return s="recent"===e.id?this.stores.store.state.recentIcons||[]:Object.keys(t),0!==s.length?{key:e.id,items:s.map((e=>{if(void 0!==t[e])return this.createListItem(e,t[e])})).filter(Boolean),render:t=>(0,R.jsx)(M.Z,{isTitleUppercase:!0,title:e.title,children:(0,R.jsx)("div",{style:ae(this.environment,this.theme),children:t.children})},t.key)}:void 0},this.handleScroll=e=>{if(Math.abs(e)<100){const{loadIconCount:e,allIcons:t}=this.stores.store.state,s=ie(this.environment,this.props.menuRef)*oe(this.environment),n=Math.max(s,this.getAllSectionsIconCount(t));this.stores.store.setState({...this.stores.store.state,loadIconCount:Math.min(n,e+s)})}}}UNSAFE_willMount(e){super.UNSAFE_willMount(e);const t=a.Z.get(W);this.stores.store.setState({...this.stores.store.state,recentIcons:t||[]})}renderComponent(){return(0,R.jsx)(u.Z,{request:"/icons/all",performRequest:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_performGetAllIconsRequest,render:(e,t,s)=>s?this.renderIconPicker(t):(0,R.jsx)("div",{style:{display:"flex",width:"100%",height:"100%",justifyContent:"center",alignItems:"center",paddingBottom:"10px"},children:(0,R.jsx)(S.Z,{})})})}renderIconPicker(e){const{menuListStore:t}=this.stores,s=function(e,t,s,n){let{loadIconCount:i}=n.state;0===i&&(i+=ie(t,s)*oe(t));const o=[];let a=0;for(const r of e){if(!(a+r.items.length<=i)){o.push({...r,items:r.items.slice(0,i-a)});break}o.push(r),a+=r.items.length}return o}(this.getAllSections(e),this.environment,this.props.menuRef,this.stores.store),n=this.environment.device.isDesktop&&s.length>0?0:void 0;return 0===s.length&&(this.props.onNoResults&&this.props.onNoResults(),s.push({key:"no results",items:[{key:"no results",action:e=>{},render:(e,t)=>(0,R.jsx)(y.Z,{...e,caption:h.default.formatMessage(te.noResults)})}],render:e=>(0,R.jsx)(M.Z,{...e})})),(0,R.jsxs)("div",{style:U,children:[(0,R.jsx)("div",{style:{flexGrow:1},children:(0,R.jsx)(v.Z,{...(i=this.environment,o=this.props.menuRef,{type:v.i.Grid,itemsPerRow:ie(i,o),renderRow:(e,t)=>(0,R.jsx)("div",{style:{display:"flex"},children:e},t)}),store:t,initialFocus:n,sections:s,disableKeyboardArrowWrap:!0,unfocusOnScroll:this.environment.device.isMobile})}),(0,R.jsx)(b.Z,{onChange:this.handleScroll})]});var i,o}createFilteredSection(e){if(!e)return[];const t=function(e,t){const s=d.oA(Object.keys(e).map((s=>{const n=e[s],i=((null==n?void 0:n.tooltip)??s).replace("-"," "),o=[i,...n.tags],a=o.findIndex((e=>e===t));if(-1!==a)return[0===a?100:50,s];const r=o.findIndex((e=>e.startsWith(t))),l=i.includes(t);return 0!==r&&l?[40,s]:-1!==r?[0===r?80:30,s]:void 0})));return d.MR(s,(e=>-e[0])).map((e=>e[1]))}(e,this.filter);return 0===t.length?[]:[{key:"search-results",items:t.map((t=>this.createListItem(t,e[t]))),render:e=>(0,R.jsx)(M.Z,{children:(0,R.jsx)("div",{style:ae(this.environment,this.theme),children:e.children})},e.key)}]}getAllSections(e){this.filter=o.rJ(this.props.filter)??"",this.splitFilter=this.filter?this.filter.split(" ").filter(Boolean):[];const t=d.oA((s=this.props.filter,d.oA([!s&&{id:"recent",title:(0,R.jsx)(r.FormattedMessage,{id:"iconPicker.section.recent",defaultMessage:"Recent"})},!s&&{id:"icons",title:(0,R.jsx)(r.FormattedMessage,{id:"iconPicker.section.icons",defaultMessage:"Icons"})}])).map((t=>this.createCategory(t,e))));var s;return this.props.filter&&this.filter?this.createFilteredSection(e):t}getAllSectionsIconCount(e){const t=this.getAllSections(e);let s=0;for(const n of t)s+=n.items.length;return s}}se.displayName="IconPicker";const ne=se;function ie(e,t){var s,n;const{device:i,WindowSizeStore:o}=e;return i.isPhone?(window.innerWidth-o.getSafePaddingLeftPx(Y)-o.getSafePaddingRightPx(Q))/p.mz:i.isTablet?z:null!=t&&null!==(s=t.current)&&void 0!==s&&s.offsetWidth?((null==t||null===(n=t.current)||void 0===n?void 0:n.offsetWidth)-2*$)/p.T8:i.isTablet?z:K}function oe(e){return e.device.isMobile?H:G}function ae(e,t){const{device:s,WindowSizeStore:n}=e;return{display:"flex",flexDirection:"column",flexWrap:"wrap",alignItems:"flex-start",...s.isPhone?{background:t.popoverBackground,paddingTop:10,paddingBottom:10,paddingLeft:n.getSafePaddingLeftCSS(Y),paddingRight:n.getSafePaddingLeftCSS(Q),boxShadow:`0 1px 0 ${t.regularDividerColor}`,marginBottom:1}:{background:l.ZP.transparent,paddingLeft:s.isTablet?ee:$,paddingRight:s.isTablet?ee:$}}}function re(e,t,s,n,i,o){const r=function(e){return e.replace("_dark","")}(e);s(r);const l=r.split(/[/_.]/),u=l[2],p=l[3];!function(e,t,s,n){const i=a.Z.get(W),o=d.G0([e],i),r=d.qn(o,ie(t,s)*q);a.Z.set(W,r),n.setState({...n.state,recentIcons:r})}(u,t,n,i),o&&c.fA(t,"pick_colored_icon",{icon:u,color:p,...o})}},25228:(e,t,s)=>{s.r(t),s.d(t,{ImportIntoNewPageModal:()=>p,default:()=>m});s(67294);var n=s(86628);const i=(0,s(45238).CZ)("importIntoNewFile",{default:{loader:()=>s.e(3465).then(s.bind(s,73465)),size:20},small:{loader:()=>s.e(193).then(s.bind(s,193)),size:16},mini:{loader:()=>s.e(928).then(s.bind(s,80928)),size:14},large:{loader:()=>s.e(3882).then(s.bind(s,53882)),size:24}});var o=s(9291),a=s(70681),r=s(92083),l=s(82914),d=s(7184),c=s(85893);function u(){a.Z.setState({open:!1})}function p(){const e=(0,n.VK)((()=>a.Z.state),[]);return(0,c.jsx)(d.c,{isOpen:e.open,onDismiss:u,onClosed:u,areaConstraint:{width:{min:300,max:300}},children:(0,c.jsx)(l.sR,{header:(0,c.jsx)(l.vI,{iconAndTitle:(0,c.jsx)(l.kC,{iconGroup:i,title:(0,c.jsx)(o.FormattedMessage,{defaultMessage:"Import into new page?",id:"importIntoNewPageModal.title"})}),description:(0,c.jsx)(o.FormattedMessage,{id:"importIntoNewPageModal.description",defaultMessage:"Since this page already has content, we’ll need to create a new page for you and import contents there."})}),footer:(0,c.jsx)(l.a6,{layout:"vertical",primaryButtons:[{buttonType:"primary",label:(0,c.jsx)(o.FormattedMessage,{defaultMessage:"Yes, continue",id:"importIntoNewPageModal.importButton"}),onClick:()=>{r.Z.setState({open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0,openedFrom:"collection"}),u()}}],secondaryButtons:[{buttonType:"secondary",label:"Cancel",onClick:u}]})})})}const m=p},90185:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var n=s(67294),i=s(480),o=s(86628),a=s(15145),r=s(84169),l=s(9291),d=s(37810),c=s(25888),u=s(75754),p=s(18514),m=s(80444),g=s(49085);class h extends g.default{getInitialState(){return{open:!1}}}const f=new h;var x=s(16354),y=s(50506),S=s(89728),v=s(51560),b=s(85893);const M={fontSize:24,lineHeight:1.2,marginBottom:6,fontWeight:d.Z.fontWeight.bold,marginRight:"auto"},j={display:"flex",alignItems:"center",marginTop:8,marginBottom:18},C={padding:"24px 36px 24px",minWidth:300};const w=function(){const e=(0,o.VK)((()=>f.state),[]);return(0,b.jsx)(y.Z,{open:e.open,innerStyle:C,preventHideChildrenWhileOpening:!0,render:()=>(0,b.jsxs)(n.Fragment,{children:[(0,b.jsxs)("div",{style:j,children:[(0,b.jsx)("div",{style:M,children:(0,b.jsx)(l.FormattedMessage,{id:"importModal.importButton.label",defaultMessage:"Import"})}),(0,b.jsx)(k,{})]}),(0,b.jsx)("div",{children:(0,b.jsx)(I,{modalState:e})})]}),onDismiss:T})};function k(){const e=(0,i.O7)();return(0,b.jsx)(x.Z,{href:(0,p.UY)("guides.import"),onClick:()=>c.Fs(e,{from:"import"}),external:!0,children:(0,b.jsx)(S.Z,{isSmall:!0,icon:r.m,isGray:!0,children:(0,b.jsx)(l.FormattedMessage,{id:"importModal.helpButton.label",defaultMessage:"Learn about importing"})})})}function T(){f.setState({open:!1})}function I(e){let{modalState:t}=e;const s=(0,i.O7)(),{mainEditorCurrentBlockStore:n,currentSpaceStore:r,currentSpaceViewStore:l,currentUserSettingsStore:d}=(0,o.VK)((()=>m.default.state),[]);return n&&r&&l&&d?(0,b.jsx)(v.Z,{pageStore:t.open&&t.pageStore?t.pageStore:n,spaceStore:r,spaceViewStore:l,userSettingsStore:d,analyticsFrom:"modal",onComplete:e=>function(e,t){f.setState({open:!1}),u._c({environment:t,store:e,pageVisitSource:a.tY.Import})}(e,s),readOnlyCreditButton:!1}):null}},51560:(e,t,s)=>{s.d(t,{Z:()=>Ut});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(41892),l=s(56666),d=s(84169),c=s(7220),u=s(45238),p=s(85893);const m=(0,u.IU)("importCSV",{viewBox:"0 0 32 32",svg:(0,p.jsx)("polygon",{points:"21.0286 9.14285 10.7429 9.14285 10.7429 10.8571 16.3143 16 10.7429 21.1429 10.7429 22.8571 21.0286 22.8571 21.0286 20.2857 15.0286 20.2857 19.3143 16 15.0286 11.7143 21.0286 11.7143"})}),g=(0,u.IU)("importHTML",{viewBox:"0 0 32 32",svg:(0,p.jsx)("path",{d:"M13.088,21.472 L7.93605,16.32 L13.088,11.168 L11.52,9.59999 L4.80005,16.32 L11.52,23.04 L13.088,21.472 Z M18.912,21.472 L24.0641,16.32 L18.912,11.168 L20.48,9.59999 L27.2,16.32 L20.48,23.04 L18.912,21.472 Z"})}),h=(0,u.IU)("importText",{viewBox:"0 0 32 32",svg:(0,p.jsx)("path",{d:"M6.3999,22.4 L19.1999,22.4 L19.1999,20.2667 L6.3999,20.2667 L6.3999,22.4 Z M6.3999,9.59999 L6.3999,11.7333 L25.5999,11.7333 L25.5999,9.59999 L6.3999,9.59999 Z M6.3999,17.0667 L25.5999,17.0667 L25.5999,14.9333 L6.3999,14.9333 L6.3999,17.0667 Z"})});var f=s(34390),x=s(9291),y=s(7032),S=s(952),v=s(57549),b=s(41311),M=s(47307),j=s(49085);class C extends j.default{getInitialState(){return{}}}const w=new C;var k=s(54642),T=s(92625);async function I(e){const{environment:t,spaceId:s,requestStore:n}=e;if(!t.currentUser.id)return M.showMessage({message:"Invalid details"}),void T.x();w.setState({...w.state,[s]:{...w.state[s],showLoader:!0}});const i=await k.getConfluenceSpaces(t,{spaceId:s});if(await(null==n?void 0:n.refresh()),w.setState({...w.state,[s]:{...w.state[s],showLoader:!1}}),"failed"!==i.type)return w.setState({...w.state,[s]:{...w.state[s],spacesResult:i.data}}),i.data;console.error(i.error),M.showError(i),T.x()}var Z=s(83805),P=s(601),F=s(61397),A=s(52192),_=s(23586),R=s(72340),O=s(8989),B=s(28415),D=s(22756);class L extends j.default{getInitialState(){return{loading:!1,areAccountsFetched:!1,accountsResponse:{accounts:[]}}}}const V=new L;var N=s(69122);async function E(e){const t=await k.getTrelloAccount(e,{});return"success"===t.type?t.data:(console.error(t.error),{})}async function U(e){return Promise.resolve({areAccountsFetched:V.state.areAccountsFetched,isGoogleDocImporterEnabled:(0,B.I2)()})}async function W(e){D.Z.setState({...D.Z.state,isFetchingAsanaAccount:!0});const t=await k.getAsanaAccount(e,{});if("success"===t.type){const{account:e}=t.data;return D.Z.setState({...D.Z.state,account:e,isFetchingAsanaAccount:!1}),e?t.data:{}}return console.error(t.error),D.Z.setState({...D.Z.state,isFetchingAsanaAccount:!1}),{}}async function K(e){try{const t=await k.getEvernoteAccount(e,{});if("success"===t.type){const{userInfo:e}=t.data;return{userInfo:e}}return console.error(t.error),{userInfo:void 0}}catch(t){return console.error(t),{userInfo:void 0}}}var z=s(92283),q=s(60709),G=s(56335),H=s(5749),Y=s(18514),Q=s(88632),$=s(78900),J=s(90365),X=s(67940),ee=s(82066),te=s(21039),se=s(72087),ne=s(92083),ie=s(81676),oe=s(31701),ae=s(80444),re=s(61766);const le=new re.Z;var de=s(93405),ce=s(31945),ue=s(73063),pe=s(16354),me=s(68785),ge=s(78140),he=s(32163),fe=s(53437),xe=s(72495),ye=s(26388),Se=s(64369),ve=s(37810),be=s(64921);const Me={fontSize:16,fontWeight:ve.Z.fontWeight.medium},je=28,Ce={flexShrink:0,width:je,height:je,borderRadius:4,marginRight:10,background:oe.O9.white};const we=function(e){let{title:t,actionButton:s,onClick:n,tooltipEvents:i,icon:o,logo:r,caption:l,shouldWrapCaption:d}=e;const c=(0,a.Fg)();return(0,p.jsxs)(be.Z,{...i,onClick:n,style:ke(c),children:[(0,p.jsx)(Ze,{icon:o,logo:r}),(0,p.jsxs)("div",{style:{minWidth:0,width:"100%"},children:[(0,p.jsxs)("div",{style:{display:"flex"},children:[(0,p.jsx)("div",{style:Me,children:t}),(0,p.jsx)("div",{style:{marginLeft:"auto"},children:s})]}),(0,p.jsx)(Pe,{caption:l,shouldWrapCaption:d})]})]})};function ke(e){return{display:"flex",alignItems:"center",padding:10,paddingRight:8,borderRadius:4,marginBottom:12,cursor:"pointer",boxShadow:e.lightBoxShadow,transition:"background 200ms ease-out",background:e.importOptionsButtonBackground}}function Te(e){return{display:"flex",alignItems:"center",justifyContent:"center",width:je,height:je,borderRadius:4,marginRight:8,color:e.mediumTextColor,background:e.importOptionsIconWrapBackground}}function Ie(e,t){return{fontSize:12,color:e.mediumTextColor,wordBreak:"keep-all",...!t&&{...ve.Z.textOverflowStyle}}}function Ze(e){let{icon:t,logo:s}=e;const n=(0,a.Fg)();return s?(0,p.jsx)("img",{style:Ce,src:s}):t?(0,p.jsx)("div",{style:Te(n),children:t({flexShrink:0,width:je,height:je})}):null}function Pe(e){let{caption:t,shouldWrapCaption:s}=e;const n=(0,a.Fg)();return t?(0,p.jsx)("div",{style:Ie(n,s),children:t}):null}const Fe={whiteSpace:"pre-wrap"};function Ae(e,t){return(0,p.jsx)(ye.ZP,{renderTooltip:()=>(0,p.jsx)(Se.Z,{style:{color:oe.ZP.white},isSmall:!0,children:(0,p.jsx)(x.FormattedMessage,{id:"AsanaImportOption.helpButton.tooltip",defaultMessage:"Learn about how to import"})}),render:s=>(0,p.jsx)(pe.Z,{...s,external:!0,href:e,style:{marginLeft:"auto"},children:(0,p.jsx)(ue.Z,{icon:d.m,ariaLabel:t.formatMessage({id:"AsanaImportOption.helpButton.ariaLabel",defaultMessage:"Learn about how to asana import help icon"})})})})}const _e=function(){const e=(0,o.VK)((()=>D.Z.state),[]),{account:t,isLoadingAsanaWorkspaces:s,isAccountDelinkingInProgress:a,isAccountLinkingInProgress:d}=e,c=(0,i.O7)(),u=(0,x.useIntl)(),{device:m}=c,g=(0,o.VK)((()=>X.Z.state),[]),h=g.flowId||(0,y.ZP)();(0,n.useEffect)((()=>{g.flowId||X.Z.setState({flowId:h})}),[h,g]);const f={title:u.formatMessage({id:"asanaImportOption.asanaButton.title",defaultMessage:"Asana"}),logo:r.Z.images.import.asanaPng,caption:d?u.formatMessage({id:"asanaImportOption.asanaButton.accountLinkingInProgress",defaultMessage:"Authenticating..."}):a?u.formatMessage({id:"asanaImportOption.asanaButton.accountDelinkingInProgress",defaultMessage:"Removing account..."}):t,actionButton:t?(S=[{name:u.formatMessage({id:"asanaImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),captionText:u.formatMessage({id:"asanaImportOption.connectAnotherAccount.captionText",defaultMessage:"Ensure you are logged into the new Asana account in your browser"}),action:()=>b.w1({environment:c,flowId:h}).catch((()=>{}))},{name:u.formatMessage({id:"asanaImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>b.XP({environment:c})}],(0,p.jsx)(ce.ZP,{popupType:fe.kQ.Popup,renderOrigin:e=>s?(0,p.jsx)(me.Z,{}):(0,p.jsx)(ue.Z,{ariaLabel:u.formatMessage({id:"asanaImportOption.asanaButton.ariaLabel",defaultMessage:"Import from Asana button"}),icon:l.o,...e}),render:e=>{const t={key:"section",render:e=>(0,p.jsx)(xe.Z,{...e}),items:S.map((t=>{let{name:s,captionText:n,action:i}=t;return{key:s,render:e=>(0,p.jsx)(de.Z,{...e,title:s,caption:n,captionStyle:n?Fe:void 0}),action:()=>{i(),e.close()}}}))};return(0,p.jsx)(ge.Z,{menuType:q.og.Popup,width:200,children:(0,p.jsx)(he.Z,{type:he.i.Vertical,initialFocus:void 0,sections:[t]})})}})):Ae((0,Y.UY)("guides.importAsana"),u),onClick:()=>{}};var S;return(0,p.jsx)(ce.ZP,{onClick:async()=>{var e;D.Z.resetImport(),s||d||a||(t?(v.ay(c,{import_source:"asana",from:"settings_modal",userId:c.currentUser.id,spaceId:null===(e=ae.default.state.currentSpaceStore)||void 0===e?void 0:e.id,flowId:h}),await b.bA({environment:c}),b.h7()):b.w1({environment:c,flowId:h}).catch((()=>{})))},popupType:m.isMobile?ce.Z4.SlideUp:ce.Z4.Popup,buttonPopupStore:le,renderOrigin:e=>{let{onClick:t}=e;return(0,p.jsx)(we,{...f,onClick:t})},render:()=>null})};var Re=s(36591),Oe=s(42853),Be=s(44495),De=s(22711),Le=s(52275),Ve=s(61519),Ne=s(1743),Ee=s(74194),Ue=s(50506),We=s(63296),Ke=s(89728),ze=s(58297),qe=s(74523),Ge=s(83355),He=s(58573);class Ye extends j.default{getInitialState(){return{searchQuery:"",selection:new Set}}}const Qe=Ye;var $e=s(68894),Je=s(43765),Xe=s(29551);class et extends Ge.Z{constructor(){super(...arguments),this.storeTypes={store:Qe}}UNSAFE_willMount(e){const t=this.stores.store.state.selection,[s]=e.sections;if(s){const[e]=s.items;e&&t.add(e.key)}this.stores.store.emit()}renderComponent(){return(0,p.jsx)(ge.Z,{menuType:q.og.Popup,header:(0,p.jsx)(st,{searchInputPlaceholder:this.props.searchInputPlaceholder,store:this.stores.store}),width:280,maxHeight:350,children:(0,p.jsx)(nt,{sections:this.props.sections,noSearchResultsPlaceholder:this.props.noSearchResultsPlaceholder,handleClickImportConfluenceWorkspace:this.props.handleClickImportConfluenceWorkspace,onComplete:this.props.onComplete,store:this.stores.store})})}}et.displayName="IntegrationConfluenceImportPopup";const tt=et;function st(e){let{searchInputPlaceholder:t,store:s}=e;const n=(0,o.qz)(s,Qe),{searchQuery:i}=(0,o.VK)((()=>n.state),[n]);return(0,p.jsx)(xe.Z,{isInput:!0,desktopStyle:{paddingBottom:2},children:(0,p.jsx)($e.ZP,{focus:!0,focusAfterAnimation:!0,value:i,onChange:e=>{n.setState({...n.state,searchQuery:e.target.value})},placeholder:t})})}function nt(e){let{sections:t,noSearchResultsPlaceholder:s,handleClickImportConfluenceWorkspace:n,onComplete:i,store:a}=e;const r=(0,o.qz)(a,Qe),{searchQuery:l}=(0,o.VK)((()=>r.state),[r]),d=t.map((e=>{const t=(0,He.ZP)(l,e.items,(t=>`${t.key} ${t.name} ${e.name}`));return{...e,items:t}})).filter((e=>e.items.length>0));if(0===d.length)return(0,p.jsx)(xe.Z,{children:(0,p.jsx)(Je.Z,{title:s})});const c=d.map((e=>{const s=e.items.map((e=>e.name)),o={};return s.forEach((e=>{o[e]=o[e]?o[e]+1:1})),{key:e.name,render:s=>(0,p.jsx)(xe.Z,{...s,title:t.length>1?e.name:void 0}),items:e.items.map((e=>({key:e.key,render:t=>(0,p.jsx)(Le.Z,{...t,title:(0,p.jsxs)(Xe.gq,{gap:2,alignItems:"center",children:[e.name,o[e.name]>1&&(0,p.jsx)(ye.ZP,{placement:ye.ug.Right,renderTooltip:()=>e.key,render:t=>(0,p.jsx)(ue.Z,{ariaLabel:`Associated space key is ${e.key}`,disableBackground:!0,icon:Be.D,...t})})]}),right:void 0!==e.count&&(0,p.jsx)(Se.Z,{isSmall:!0,children:e.count})}),action:()=>{n(e.key,e.name),function(e,t){t(e)}(e,i)}})))}}));return(0,p.jsx)(he.Z,{type:he.i.Vertical,initialFocus:void 0,sections:c})}const it={whiteSpace:"pre-wrap"};function ot(e){const{key:t,value:s,spaceId:n}=e;w.setState({...w.state,[n]:{...w.state[n],[t]:s}})}function at(e){var t;const{onSelectOption:s,options:n,currentOption:i}=e,o=null===(t=n.find((e=>{let{key:t}=e;return t===i})))||void 0===t?void 0:t.label,r=(0,a.yK)((e=>({icon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,p.jsx)(ce.ZP,{popupType:ce.Z4.Popup,placementToOrigin:ce.pO.Left,renderOrigin:e=>(0,p.jsxs)(Ke.Z,{...e,isLarge:!0,style:{opacity:1},disabled:!1,children:[o,(0,Oe.i)(r.icon)]}),render:e=>{const t={menuType:q.og.Popup,width:250,left:50},i=[{key:"settings-item-section",render:e=>(0,p.jsx)(xe.Z,{...e}),items:n.map((t=>{let{key:n,label:i}=t;return{key:n,action:()=>{s(n),e.close()},render:e=>(0,p.jsx)(Le.Z,{...e,title:i,shouldWrapCaption:!0,right:o===i?(0,p.jsx)("div",{style:{width:14},children:(0,Re.e)()}):void 0})}}))}];return(0,p.jsx)(ge.Z,{...t,children:(0,p.jsx)(he.Z,{type:he.i.Vertical,sections:i,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})}})}async function rt(e){await async function(e){const{environment:t,requestStore:s,userEmail:n,site:i,access_token:o,instance:a,spaceId:r,username:l,password:d,flowId:c}=e;if(!t.currentUser.id)return M.showMessage({message:"Invalid details"}),void T.x();const u=await k.authenticateConfluenceUser(t,{userEmail:n,site:i,access_token:o,instance:a,userId:t.currentUser.id,spaceId:r,username:l,password:d});await s.refresh(),"failed"===u.type?(v.a1(t,{import_source:"confluence",data:{import_type:"api",status:"failure",error:u.error},flowId:c}),console.error(u.error),M.showError(u)):(v.a1(t,{import_source:"confluence",data:{import_type:"api",status:"success"},flowId:c}),M.showMessage({message:"Successfully connected confluence instance."}),await I({environment:t,requestStore:s,spaceId:r})),T.x()}(e)}function lt(e){let{environment:t,title:s,email:n,accountType:i,site:r,APIToken:l,personalAccessToken:d,confluenceVersion:c,username:u,password:m,hidePopup:g,spaceId:h,flowId:f,requestStore:y}=e;const S=(0,o.VK)((()=>w.getState()),[]),v=(0,a.yK)((e=>({title:{fontWeight:ve.Z.fontWeight.semibold},inputLabels:{fontSize:"14px",fontWeight:"400"},helpText:{textAlign:"center",marginTop:"5px",lineHeight:"15px",fontSize:12,color:e.lightTextColor}})),[]);return(0,p.jsx)(Ne.Z,{debugName:"ConfluenceImportOption",capture:!0,children:(0,p.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",padding:20,width:"100%"},children:[(0,p.jsxs)("div",{style:{overflowY:"scroll"},children:[(0,p.jsxs)("div",{style:{marginBottom:24},children:[(0,p.jsx)("div",{style:v.title,children:s}),(0,p.jsx)(qe.Z,{title:(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.helpButton.caption",defaultMessage:"Learn more about importing from Confluence"}),href:"https://www.notion.so/help/import-from-confluence",analyticsFrom:"import",style:{marginTop:8}})]}),(0,p.jsxs)("div",{children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row"},children:[(0,p.jsx)("label",{htmlFor:"accountType",style:{...v.inputLabels},children:i}),(0,p.jsx)(at,{onSelectOption:e=>{ot({key:"instanceValue",value:e,spaceId:h})},options:[{key:"Cloud",label:(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.accountTypeDropdownCloudOption.label",defaultMessage:"Cloud"})},{key:"Server",label:(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.accountTypeDropdownServerOption.label",defaultMessage:"Server/On-Premise"})}],currentOption:S[h].instanceValue??"Cloud"})]}),(0,p.jsx)(Ve.Z,{size:12,isHidden:!0}),(0,p.jsx)("div",{children:"Server"===S[h].instanceValue?(0,p.jsxs)("div",{children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row",alignItems:"center"},children:[(0,p.jsx)("label",{htmlFor:"confluenceVersion",style:{...v.inputLabels},children:c}),(0,p.jsx)(at,{onSelectOption:e=>{ot({key:"confluenceAuthenticationTypeValue",value:e,spaceId:h})},options:[{key:"OAuth2.0",label:(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.confluenceVersionDropdownNewVersionOption.label",defaultMessage:"7.9 or later"})},{key:"Basic",label:(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.confluenceVersionDropdownOlderVersionOption.label",defaultMessage:"Prior to 7.9"})}],currentOption:S[h].confluenceAuthenticationTypeValue??"OAuth2.0"})]}),(0,p.jsx)(Ve.Z,{size:12,isHidden:!0})]}):void 0}),(0,p.jsx)("label",{htmlFor:"email",style:{...v.inputLabels},children:n}),(0,p.jsx)(Ee.Z,{id:"email",value:S[h].emailValue,autoComplete:"off",autoCapitalize:"off",onChange:e=>{ot({key:"emailValue",value:e.target.value,spaceId:h})},showClearButton:!0,placeholder:"sample@gmail.com",inputElementAttributes:{minLength:4}}),(0,p.jsx)(Ve.Z,{size:12,isHidden:!0}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"site",style:{...v.inputLabels},children:r}),(0,p.jsx)(Ee.Z,{id:"site",value:S[h].siteValue,onChange:e=>ot({key:"siteValue",value:e.target.value,spaceId:h}),showClearButton:!0,placeholder:"Cloud"===S[h].instanceValue?"https://confluence.atlassian.net":"https://domain.com",inputElementAttributes:{minLength:4}}),(0,p.jsx)(Ve.Z,{size:12,isHidden:!0}),"Cloud"===S[h].instanceValue?(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"APIToken",style:{...v.inputLabels},children:l}),(0,p.jsx)(Ee.Z,{id:"AccessToken",type:"password",value:S[h].tokenValue,onChange:e=>{ot({key:"tokenValue",value:e.target.value,spaceId:h})},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABC7h",inputElementAttributes:{minLength:4}})]}):(0,p.jsx)("div",{children:(0,p.jsx)("div",{children:"Basic"===S[h].confluenceAuthenticationTypeValue?(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"username",style:{...v.inputLabels},children:u}),(0,p.jsx)(Ee.Z,{id:"username",value:S[h].usernameValue,onChange:e=>{ot({key:"usernameValue",value:e.target.value,spaceId:h})},showClearButton:!0,placeholder:"confluenceUser",inputElementAttributes:{minLength:1}}),(0,p.jsx)(Ve.Z,{size:12,isHidden:!0}),(0,p.jsx)("label",{htmlFor:"password",style:{...v.inputLabels},children:m}),(0,p.jsx)(Ee.Z,{type:"password",id:"password",value:S[h].passwordValue,onChange:e=>{ot({key:"passwordValue",value:e.target.value,spaceId:h})},showClearButton:!0,placeholder:"P@S$w0rd",inputElementAttributes:{minLength:1}})]}):(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"AccessToken",style:{fontSize:"14px",fontWeight:"400"},children:d}),(0,p.jsx)(Ee.Z,{id:"AccessToken",type:"password",value:S[h].tokenValue,onChange:e=>{ot({key:"tokenValue",value:e.target.value,spaceId:h})},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABCi7h",inputElementAttributes:{minLength:4}})]})})})]})]})]}),(0,p.jsxs)("div",{style:{flexGrow:0,flexShrink:0},children:[(0,p.jsx)(Ve.Z,{size:24}),(0,p.jsx)(ze.Z,{isLarge:!0,onClick:async()=>{const e=S[h].instanceValue??"Cloud",s=S[h].confluenceAuthenticationTypeValue??"OAuth2.0";await rt({environment:t,userEmail:S[h].emailValue,site:S[h].siteValue,access_token:"Server"===e&&"Basic"===s?void 0:S[h].tokenValue,instance:S[h].instanceValue??"Cloud",username:"Basic"===s?S[h].usernameValue:void 0,password:"Basic"===s?S[h].passwordValue:void 0,spaceId:h,flowId:f,requestStore:y}),g()},children:(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.authenticateButton.label",defaultMessage:"Authenticate"})}),(0,p.jsx)(We.Z,{isLarge:!0,style:{marginLeft:12},onClick:()=>{g()},children:(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.cancelButton.label",defaultMessage:"Cancel"})})]})]})})}const dt=(0,x.injectIntl)((function(e){var t,s;const n=(0,o.VK)((()=>w.getState()),[]),{spaceStore:a,flowId:l}=e,d=[{name:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaApi",defaultMessage:"Import via API"}),captionText:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaApi.message",defaultMessage:"Recommended for the best import experience"}),action:()=>{e.handleApiImportClick("confluence",l),ot({key:"open",value:!0,spaceId:a.id})}},{name:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile",defaultMessage:"Import via file"}),captionText:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile.message",defaultMessage:"Best for importing partial workspace content"}),action:()=>e.handleFileUploadClick("confluence",l)}],c=(0,i.O7)(),{device:u}=c,{confluenceResult:m,onComplete:g,intl:h,requestStore:f,spaceViewStore:S}=e,{account:b}=m,M={spacesResult:void 0,showLoader:!1},{showLoader:j}=n[a.id]||M;function C(e,t){v.qy(c,{import_source:"confluence",data:{spaceKey:e,spaceName:t},flowId:l})}function k(e){return(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{style:{fontSize:"12px",color:"rgba(55, 53, 47, 0.65)",paddingLeft:"12px"},children:(0,p.jsx)(x.FormattedMessage,{id:"confluenceImportOption.search.title",defaultMessage:"Select a space to import"})}),(0,p.jsx)(tt,{searchInputPlaceholder:h.formatMessage({id:"confluenceImportOption.search.placeholder",defaultMessage:"Search for a Space"}),noSearchResultsPlaceholder:h.formatMessage({id:"confluenceImportOption.search.noResultsPlaceholder",defaultMessage:"No Spaces"}),sections:[e],onComplete:async e=>{await async function(e){const{environment:t,onComplete:s,selectedSpace:n,spaceStore:i,spaceViewStore:o,flowId:a}=e,r=await P.A1({environment:t,spaceStore:i,spaceViewStore:o,space:n,flowId:a||(0,y.ZP)()});s(r)}({environment:c,onComplete:g,selectedSpace:e,spaceStore:a,spaceViewStore:S,flowId:l})},handleClickImportConfluenceWorkspace:C})]})}const T={title:"Confluence",logo:r.Z.images.import.confluencePng,caption:b,actionButton:b&&j?(0,p.jsx)(me.Z,{}):b&&e.renderItemActionsButton([{name:h.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile",defaultMessage:"Import via file"}),action:()=>e.handleFileUploadClick("confluence",l)},{name:h.formatMessage({id:"confluenceImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another instance"}),action:()=>{e.handleApiImportClick("confluence",l),ot({key:"open",value:!0,spaceId:a.id})}},{name:h.formatMessage({id:"confluenceImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>async function(e){const{environment:t,spaceId:s,requestStore:n}=e;w.setState({...w.state,[s]:{...w.state[s],showLoader:!1}}),await De.DP(t,n,s)}({environment:c,spaceId:a.id,requestStore:f})}]),onClick:()=>{}},Z=(null===(t=n[a.id])||void 0===t||null===(t=t.spacesResult)||void 0===t?void 0:t.spaces)||[],F={key:"default",name:h.formatMessage({id:"confluenceImportOption.spacesProperty.defaultName",defaultMessage:"Spaces"}),items:Z.map((e=>({id:e.id,key:e.key,name:e.name})))},A={key:"section",render:e=>(0,p.jsx)(xe.Z,{...e}),items:d.map((e=>{let{name:t,captionText:s,action:n}=e;const i={key:t,render:e=>(0,p.jsx)(de.Z,{...e,title:t,caption:s,captionStyle:s?it:void 0}),action:n};return i}))};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(ce.ZP,{popupType:u.isMobile?ce.Z4.SlideUp:ce.Z4.Popup,onClick:()=>{b&&I({environment:c,requestStore:f,spaceId:a.id}).catch((()=>{}))},buttonPopupStore:$.Z,render:e=>b?function(e){return j?(0,p.jsx)(p.Fragment,{}):k(e)}(F):(0,p.jsx)(ge.Z,{menuType:q.og.Popup,width:200,children:(0,p.jsx)(he.Z,{onAccept:e.close,type:he.i.Vertical,initialFocus:void 0,sections:[A]})}),renderOrigin:e=>{let{onClick:t}=e;return(0,p.jsx)(we,{...T,onClick:t})}}),(0,p.jsx)(Ue.Z,{open:null===(s=n[a.id])||void 0===s?void 0:s.open,innerStyle:{width:600,maxWidth:"calc(100vw - 100px)",overflow:"hidden",borderRadius:5,maxHeight:"90vh"},onDismiss:()=>{ot({key:"open",value:!1,spaceId:a.id})},render:()=>(0,p.jsx)(lt,{hidePopup:()=>{ot({key:"open",value:!1,spaceId:a.id})},environment:c,title:(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.titleMessage",defaultMessage:"Authentication details"}),email:(0,p.jsxs)(Xe.gq,{style:{alignItems:"center",gap:2},children:[(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.emailMessage",defaultMessage:"Email"}),(0,p.jsx)(ye.ZP,{placement:ye.ug.Right,renderTooltip:()=>(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.emailHelpText",defaultMessage:"Email address of the Confluence user importing the data"}),render:e=>(0,p.jsx)(ue.Z,{ariaLabel:"Email help text button",disableBackground:!0,icon:Be.D,...e})})]}),accountType:(0,p.jsxs)(Xe.gq,{style:{alignItems:"center",gap:2},children:[(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.instanceMessage",defaultMessage:"Confluence instance"}),(0,p.jsx)(ye.ZP,{style:{width:300,whiteSpace:"normal"},placement:ye.ug.Right,renderTooltip:()=>(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.instanceHelperText",defaultMessage:"On Confluence, click 'Help', the (?) next to your profile, then click on 'About Confluence' this will tell you if it is a Server, Cloud or Data Center"}),render:e=>(0,p.jsx)(ue.Z,{ariaLabel:"Confluence instance type help text button",disableBackground:!0,icon:Be.D,...e})})]}),site:(0,p.jsxs)(Xe.gq,{style:{alignItems:"center",gap:2},children:[(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.siteMessage",defaultMessage:"Site"}),(0,p.jsx)(ye.ZP,{style:{width:300,whiteSpace:"normal"},placement:ye.ug.Right,renderTooltip:()=>(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.siteHelperText",defaultMessage:"The base URL that is used to access Confluence. If you are running on a non-standard port, please provide the input in host:port format"}),render:e=>(0,p.jsx)(ue.Z,{ariaLabel:"Confluence site help text button",disableBackground:!0,icon:Be.D,...e})})]}),APIToken:(0,p.jsxs)(Xe.gq,{style:{alignItems:"center",gap:2},children:[(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.apiTokenMessage",defaultMessage:"API token"}),(0,p.jsx)(ye.ZP,{placement:ye.ug.Right,renderTooltip:()=>(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluenceAccessToken.captions",defaultMessage:"Click to learn how to get access token from Confluence cloud"}),render:e=>(0,p.jsx)(ue.Z,{ariaLabel:"Confluence access token help text button",onClick:()=>{window.open("https://support.atlassian.com/atlassian-account/docs/manage-api-tokens-for-your-atlassian-account","_blank")},icon:Be.D,...e})})]}),personalAccessToken:(0,p.jsxs)(Xe.gq,{style:{alignItems:"center",gap:2},children:[(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.personalAccessTokenMessage",defaultMessage:"Personal Access Token"}),(0,p.jsx)(ye.ZP,{placement:ye.ug.Right,style:{width:300,whiteSpace:"normal"},renderTooltip:()=>(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluencePAT.caption",defaultMessage:"Click to learn how to get personal authentication token from Confluence server"}),render:e=>(0,p.jsx)(ue.Z,{ariaLabel:"Confluence personal access token help text button",onClick:()=>{window.open("https://confluence.atlassian.com/enterprise/using-personal-access-tokens-1026032365.html","_blank")},icon:Be.D,...e})})]}),confluenceVersion:(0,p.jsxs)(Xe.gq,{style:{alignItems:"center",gap:2},children:[(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.confluenceVersion",defaultMessage:"Confluence version"}),(0,p.jsx)(ye.ZP,{style:{width:300,whiteSpace:"normal"},placement:ye.ug.Right,renderTooltip:()=>(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluenceVersion.captions",defaultMessage:"Click to learn how to know the version of Confluence you are running"}),render:e=>(0,p.jsx)(ue.Z,{ariaLabel:"Confluence version help text button",onClick:()=>{window.open("https://confluence.atlassian.com/confkb/how-do-i-know-what-version-of-confluence-is-running-179441565.html","_blank")},icon:Be.D,...e})})]}),username:(0,p.jsxs)(Xe.gq,{style:{alignItems:"center",gap:2},children:[(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.username",defaultMessage:"Username"}),(0,p.jsx)(ye.ZP,{placement:ye.ug.Right,renderTooltip:()=>(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.usernameHelpText",defaultMessage:"Username of the Confluence user importing the data"}),render:e=>(0,p.jsx)(ue.Z,{ariaLabel:"Confluence user's username help text button",disableBackground:!0,icon:Be.D,...e})})]}),password:(0,p.jsxs)(Xe.gq,{style:{alignItems:"center",gap:2},children:[(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.password",defaultMessage:"Password"}),(0,p.jsx)(ye.ZP,{placement:ye.ug.Right,renderTooltip:()=>(0,p.jsx)(x.FormattedMessage,{id:"confluenceAuthentication.passwordHelpText",defaultMessage:"Password of the Confluence user importing the data"}),render:e=>(0,p.jsx)(ue.Z,{ariaLabel:"Confluence user's password help text button",disableBackground:!0,icon:Be.D,...e})})]}),spaceId:a.id,flowId:l,requestStore:f})})]})}));var ct=s(23867),ut=s(53965),pt=s(12714),mt=s(53833),gt=(s(57658),s(60458)),ht=s(28992),ft=s(62385);const xt=function(e){const{style:t}=(0,a.yK)((t=>({style:{display:"inline-block",textAlign:"center",color:e.disabled?t.lightTextColor:t.mediumTextColor,userSelect:"none",WebkitUserSelect:"none",width:8}})),[e]);return(0,p.jsx)("div",{style:t,children:"·"})};class yt extends Ge.Z{constructor(){super(...arguments),this.storeTypes={store:Qe},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleSelectAllClick=()=>vt(this.environment,this.props.sections,this.props.analyticsName,this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDeselectAllClick=()=>bt(this.environment,this.props.analyticsName,this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleImport=()=>Mt(this.props.sections,this.props.onComplete,this.stores.store)}UNSAFE_willMount(e){const t=this.stores.store.state.selection,[s]=e.sections;if(s){const[e]=s.items;e&&t.add(e.key)}this.stores.store.emit()}renderComponent(){return(0,p.jsx)(ge.Z,{menuType:q.og.Popup,header:(0,p.jsx)(jt,{analyticsName:this.props.analyticsName,sections:this.props.sections,searchInputPlaceholder:this.props.searchInputPlaceholder,store:this.stores.store}),footer:(0,p.jsx)(Ct,{sections:this.props.sections,onComplete:this.props.onComplete,store:this.stores.store}),width:280,maxHeight:350,children:(0,p.jsx)(wt,{sections:this.props.sections,noSearchResultsPlaceholder:this.props.noSearchResultsPlaceholder,analyticsName:this.props.analyticsName,store:this.stores.store})})}}yt.displayName="IntegrationImportPopup";const St=yt;function vt(e,t,s,n){const{selection:i}=n.state;for(const o of t)for(const e of o.items)i.add(e.key);n.emit(),v.Vf(e,{integration_name:s})}function bt(e,t,s){const{selection:n}=s.state;n.clear(),s.emit(),v.FI(e,{integration_name:t})}function Mt(e,t,s){const{selection:n}=s.state,i=ut.xH(e.map((e=>e.items))),o=[];n.forEach((e=>{const t=i.find((t=>t.key===e));t&&o.push(t)})),t(o)}function jt(e){let{analyticsName:t,sections:s,searchInputPlaceholder:a,store:r}=e;const l=(0,i.O7)(),d=(0,n.useCallback)((()=>bt(l,t,r)),[l,t,r]),c=(0,n.useCallback)((()=>vt(l,s,t,r)),[l,s,t,r]),{searchQuery:u}=(0,o.VK)((()=>r.state),[r]),m=Boolean(u);return(0,p.jsxs)(xe.Z,{isInput:!0,desktopStyle:{paddingBottom:2},children:[(0,p.jsx)($e.ZP,{focus:!0,focusAfterAnimation:!0,value:u,onChange:e=>{r.setState({...r.state,searchQuery:e.target.value})},placeholder:a}),(0,p.jsx)(ht.Z,{isTokenTitle:!0,style:{marginTop:2},title:(0,p.jsxs)("div",{style:{marginLeft:-3},children:[(0,p.jsx)(ft.Z,{onClick:c,disabled:m,disabledFeedback:!0,children:(0,p.jsx)(x.FormattedMessage,{id:"importPopup.selectAll",defaultMessage:"Select all"})}),(0,p.jsx)(xt,{disabled:m}),(0,p.jsx)(ft.Z,{onClick:d,disabled:m,disabledFeedback:!0,children:(0,p.jsx)(x.FormattedMessage,{id:"importPopup.deselectAll",defaultMessage:"Deselect all"})})]})})]})}function Ct(e){let{sections:t,onComplete:s,store:i}=e;const a=(0,n.useCallback)((()=>Mt(t,s,i)),[t,s,i]),r=0===(0,o.VK)((()=>i.state.selection.size),[i]);return(0,p.jsx)(xe.Z,{topBorder:!0,desktopStyle:{paddingTop:8,paddingBottom:8},children:(0,p.jsx)(ht.Z,{title:(0,p.jsx)(ze.Z,{disabled:r,onClick:a,children:(0,p.jsx)(x.FormattedMessage,{id:"integrationImportPopup.importButton.label",defaultMessage:"Import"})})})})}function wt(e){let{sections:t,noSearchResultsPlaceholder:s,analyticsName:n,store:a}=e;const r=(0,i.O7)(),{searchQuery:l,selection:d}=(0,o.VK)((()=>a.state),[a]),c=t.map((e=>{const t=(0,He.ZP)(l,e.items,(t=>`${t.name} ${e.name}`));return{...e,items:t}})).filter((e=>e.items.length>0));if(0===c.length)return(0,p.jsx)(xe.Z,{children:(0,p.jsx)(Je.Z,{title:s})});const u=c.map((e=>({key:e.name,render:s=>(0,p.jsx)(xe.Z,{...s,title:t.length>1?e.name:void 0}),items:e.items.map((e=>{const t=()=>function(e,t,s,n){const{selection:i}=n.state;i.has(e.key)?(i.delete(e.key),v.Z3(t,{integration_name:s})):(i.add(e.key),v.Gl(t,{integration_name:s})),n.emit()}(e,r,n,a);return{key:e.key,render:s=>(0,p.jsx)(Le.Z,{...s,title:e.name,icon:(0,p.jsx)(gt.Z,{checked:d.has(e.key),size:16,onClick:t}),right:void 0!==e.count&&(0,p.jsx)(Se.Z,{isSmall:!0,children:e.count})}),action:t}}))})));return(0,p.jsx)(he.Z,{type:he.i.Vertical,initialFocus:void 0,sections:u})}const kt=function(e){let{requestStore:t,analyticsFrom:s,evernoteResult:a,renderItemActionsButton:l,defaultActionButton:d,spaceStore:c,spaceViewStore:u,userSettingsStore:m,onComplete:g}=e;const h=(0,i.O7)(),f=(0,x.useIntl)(),y=(0,o.VK)((()=>mt.Z.getState()),[]),S=(0,n.useCallback)((()=>async function(e,t,s,n){var i;const{isFetchingNotebooks:o}=n;o&&await Z.B({environment:e,requestStore:t});const a=X.Z.getOrCreateFlowId();v.ay(e,{import_source:"evernote",from:s,flowId:a,userId:e.currentUser.id,spaceId:null===(i=ae.default.state.currentSpaceStore)||void 0===i?void 0:i.id})}(h,t,s,y)),[h,t,s,y]),{device:b}=h,{userInfo:M}=a,{notebooksResponse:j,showLoader:C}=y,w=(null==j?void 0:j.notebooks)||[],T=ut.vM(w,(e=>e.stack||"")),I=Object.keys(T).map((e=>{const t=e||"Top-Level";return{key:t,name:t,items:(T[e]||[]).map((e=>({key:e.guid,name:e.title,count:e.noteCount})))}})),F={title:"Evernote",logo:r.Z.images.import.evernotePng,shouldWrapCaption:!M,caption:M?M.name||M.username||M.email:void 0,actionButton:M&&C?(0,p.jsx)(me.Z,{}):M?l([{name:f.formatMessage({id:"evernoteImportOption.actionsMenu.learnMore",defaultMessage:"Learn more"}),action:()=>function(e){pt.D({environment:e,url:(0,Y.UY)("guides.importEvernote")})}(h)},{name:f.formatMessage({id:"evernoteImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>J.Z.setState({open:!0})},{name:f.formatMessage({id:"evernoteImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:()=>Tt(t,h)},{name:f.formatMessage({id:"evernoteImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>async function(e,t){await k.disconnectEvernote(t,{}),mt.Z.setState({notebooksResponse:{notebooks:[]},isFetchingNotebooks:!0,showLoader:!1}),await e.refresh(),v.qJ(t,{integration_name:"evernote"})}(t,h)}]):d,onClick:()=>{}};return(0,p.jsx)(ce.ZP,{popupType:b.isMobile?ce.Z4.SlideUp:ce.Z4.Popup,buttonPopupStore:J.Z,onClick:S,render:()=>C?(0,p.jsx)(p.Fragment,{}):(0,p.jsx)(St,{searchInputPlaceholder:f.formatMessage({id:"evernoteImportOption.search.placeholder",defaultMessage:"Search for a notebook…"}),noSearchResultsPlaceholder:f.formatMessage({id:"evernoteImportOption.search.noResultsPlaceholder",defaultMessage:"No notebooks"}),analyticsName:"evernote",sections:I,onComplete:e=>async function(e,t,s,n,i,o,a){const{notebooks:r}=e,l=r.filter((e=>Boolean(t.find((t=>t.key===e.guid)))));v.G7(a,{integration_name:"evernote",count:t.length});const d=await P.am({environment:a,spaceStore:s,spaceViewStore:n,userSettingsStore:i,notebooks:l});v.qy(a,{import_source:"evernote",data:{notebooks:l.map((e=>e.guid)),userId:a.currentUser.id,spaceId:(0,ct.C)(s.id)},flowId:X.Z.getOrCreateFlowId()}),o(d)}(j,e,c,u,m,g,h)}),renderOrigin:e=>{let{onClick:s}=e;return(0,p.jsx)(we,{...F,onClick:M?s:()=>Tt(t,h)})}})};async function Tt(e,t){await Z.e({environment:t,requestStore:e})}var It=s(91584),Zt=s(12673);const Pt=new re.Z;const Ft=function(e){let{requestStore:t,renderItemActionsButton:s,spaceStore:a,spaceViewStore:l,pageStore:d,onComplete:c}=e;const u=(0,i.O7)(),m=(0,x.useIntl)(),{loading:g,areAccountsFetched:h,accountsResponse:f}=(0,o.VK)((()=>V.state),[]),{open:y}=(0,o.VK)((()=>Pt.state),[]),v=(0,n.useCallback)((async()=>{await At(u,t,h)}),[u,t,h]),{device:b}=u,M=f.accounts,j={title:"Google Docs",logo:r.Z.images.import.googleDocsPng,actionButton:M&&M.length>0&&s([{name:m.formatMessage({id:"googleDocImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:()=>async function(e,t){const s=await It.qN(e);s&&(await t.refresh(),ne.Z.setState({...ne.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0}),await At(e,t,!1))}(u,t)},{name:m.formatMessage({id:"googleDocImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove All Accounts"}),action:()=>async function(e,t,s){if(!s||0===s.length)return;s.forEach((async e=>{await k.disconnectDrive(t,{googleUserId:e.accountId})})),V.setState({...V.state,accountsResponse:{accounts:[]},loading:!1}),await e.refresh()}(t,u,M)}]),onClick:()=>{}},C={type:"drive",title:(0,p.jsx)(x.FormattedMessage,{defaultMessage:"Browse Google Drive",id:"googleDriveBlock.mediaPicker.googleDriveTab.title"}),onSelect:async e=>{e&&e.token||await async function(e,t){await It.qN(e),await t.refresh(),await At(e,t,!1)}(u,t),e&&e.token&&await(0,B.vE)({environment:u,accessToken:e.token.accessToken,viewType:"documents",callback:async t=>{await async function(e){const{fileId:t,token:s,environment:n,spaceStore:i,spaceViewStore:o,onComplete:a,pageStore:r}=e;if(!r)return;V.setState({...V.state,loading:!0}),await P.xG({environment:n,fileId:t,token:s,spaceStore:i,spaceViewStore:o,pageStore:r}).then((e=>{e&&(S.W(n,{from:"import",type:"page",new_page_id:e.id,creating_block_id:e.id,parent_collection_id:e.getParentCollectionIdUpToTwoLevels()}),a(e))})).catch((()=>{})),V.setState({...V.state,loading:!1})}({fileId:t,token:e.token,environment:u,spaceStore:a,spaceViewStore:l,onComplete:c,pageStore:d})}})}};return(0,p.jsx)(ce.ZP,{open:y,popupType:b.isMobile?ce.Z4.SlideUp:ce.Z4.Popup,buttonPopupStore:Pt,onClick:v,render:()=>g?(0,p.jsx)(p.Fragment,{}):(0,p.jsx)(Zt.v3,{tab:C,accounts:M,type:Zt.s5.Docs}),renderOrigin:e=>{let{onClick:t}=e;return(0,p.jsx)(we,{...j,onClick:t})}})};async function At(e,t,s){let n;return s||(V.setState({...V.state,loading:!0}),n=await It.vQ(e),n&&n.accounts&&V.setState({...V.state,accountsResponse:n,areAccountsFetched:!0,loading:!1})),Pt.setState({...Pt.state,open:!0}),await t.refresh(),n}var _t=s(48779);const Rt=function(e){var t;const s=(0,i.O7)(),{device:n}=s,{jiraResult:a,flowId:l,spaceStore:d,requestStore:c}=e,u=null==a||null===(t=a.account)||void 0===t?void 0:t[0],m=(0,x.useIntl)(),g=(0,o.VK)((()=>(0,_t.lQ)(d)),[d]),h=[{name:m.formatMessage({id:"jiraImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another instance"}),action:()=>{te.Z.setState({...te.Z.state,open:!0,type:"auth",flowId:l||(0,y.ZP)()})}}];g&&u&&h.push({name:m.formatMessage({id:"jiraImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>async function(e){const{environment:t,spaceId:s,requestStore:n,accountId:i}=e;await De.M(t,n,s,i)}({environment:s,spaceId:d.id,requestStore:c,accountId:null==u?void 0:u.id})});const f={title:"Jira",logo:r.Z.images.externalIntegrations.jiraIconPng,onClick:()=>{},caption:null==u?void 0:u.site,actionButton:u?e.renderItemActionsButton(h):null};return(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(ce.ZP,{renderOrigin:e=>{let{onClick:t}=e;return(0,p.jsx)(we,{...f,onClick:()=>{if(te.Z.setState({...te.Z.state,open:!0,type:u?"teamspace-selection":"auth",flowId:l||(0,y.ZP)(),site:null==u?void 0:u.site,spaceId:d.id,botId:null==u?void 0:u.id}),u){const e=ne.Z.getInitialState();ne.Z.setState(e)}}})},popupType:n.isMobile?ce.Z4.SlideUp:ce.Z4.Popup,render:()=>(0,p.jsx)(p.Fragment,{})})})},Ot={whiteSpace:"pre-wrap"};function Bt(e){const t=(0,o.VK)((()=>N.Z.state),[]),{environment:s,spaceStore:n,flowId:i}=e;return(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(Ue.Z,{open:t.showAuthPopup,innerStyle:{width:600,maxWidth:"calc(100vw - 100px)",overflow:"hidden",borderRadius:5,maxHeight:"90vh"},onDismiss:()=>{N.Z.setState({...N.Z.state,showAuthPopup:!1})},render:()=>(0,p.jsx)(Dt,{hidePopup:()=>{N.Z.setState({...N.Z.state,showAuthPopup:!1})},environment:s,title:(0,p.jsx)(x.FormattedMessage,{id:"mondayAuthentication.titleMessage",defaultMessage:"Authentication details"}),email:(0,p.jsxs)(Xe.gq,{style:{alignItems:"center",gap:2},children:[(0,p.jsx)(x.FormattedMessage,{id:"mondayAuthentication.emailMessage",defaultMessage:"Email"}),(0,p.jsx)(ye.ZP,{placement:ye.ug.Right,renderTooltip:()=>(0,p.jsx)(x.FormattedMessage,{id:"mondayAuthentication.emailHelpText",defaultMessage:"Email address of the Monday.com user importing the data"}),render:e=>(0,p.jsx)(ue.Z,{...e,ariaLabel:"Email help text button",disableBackground:!0,icon:Be.D})})]}),APIToken:(0,p.jsxs)(Xe.gq,{style:{alignItems:"center",gap:2},children:[(0,p.jsx)(x.FormattedMessage,{id:"mondayAuthentication.apiTokenMessage",defaultMessage:"API token"}),(0,p.jsx)(ye.ZP,{placement:ye.ug.Right,renderTooltip:()=>(0,p.jsx)(x.FormattedMessage,{id:"mondayAuthentication.stepsToGetMondayAPIToken.captions",defaultMessage:"Click to learn how to get API token from Monday.com"}),render:e=>(0,p.jsx)(ue.Z,{...e,ariaLabel:"Monday.com API token help text button",onClick:()=>{window.open("https://developer.monday.com/api-reference/docs/authentication#accessing-api-tokens","_blank")},icon:Be.D})})]}),flowId:i,spaceStore:n})})})}function Dt(e){let{environment:t,title:s,email:n,APIToken:i,hidePopup:r,flowId:l,spaceStore:d}=e;const c=(0,o.VK)((()=>N.Z.state),[]),u=(0,a.yK)((e=>({title:{fontWeight:ve.Z.fontWeight.semibold},inputLabels:{fontSize:"14px",fontWeight:"400"},helpText:{textAlign:"center",marginTop:"5px",lineHeight:"15px",fontSize:12,color:e.lightTextColor}})),[]);return(0,p.jsx)(Ne.Z,{debugName:"MondayImportOption",capture:!0,children:(0,p.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",padding:20,width:"100%"},children:[(0,p.jsxs)("div",{style:{overflowY:"scroll"},children:[(0,p.jsxs)("div",{style:{marginBottom:24},children:[(0,p.jsx)("div",{style:u.title,children:s}),(0,p.jsx)(qe.Z,{title:(0,p.jsx)(x.FormattedMessage,{id:"mondayAuthentication.helpButton.caption",defaultMessage:"Learn more about importing from Monday.com"}),href:"https://www.notion.so/help/monday",analyticsFrom:"import",style:{marginTop:8}})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"email",style:{...u.inputLabels},children:n}),(0,p.jsx)(Ee.Z,{id:"email",value:c.email,autoComplete:"off",autoCapitalize:"off",onChange:e=>{N.Z.setState({...N.Z.state,email:e.target.value})},showClearButton:!0,placeholder:"sample@gmail.com",inputElementAttributes:{minLength:4}}),(0,p.jsx)(Ve.Z,{size:12,isHidden:!0}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"APIToken",style:{...u.inputLabels},children:i}),(0,p.jsx)(Ee.Z,{id:"AccessToken",type:"password",value:c.APIToken,onChange:e=>{N.Z.setState({...N.Z.state,APIToken:e.target.value})},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABC7h",inputElementAttributes:{minLength:4}})]})]})]}),(0,p.jsxs)("div",{style:{flexGrow:0,flexShrink:0},children:[(0,p.jsx)(Ve.Z,{size:24}),(0,p.jsx)(ze.Z,{isLarge:!0,onClick:async()=>{await F.qF({environment:t,userEmail:c.email,APIToken:c.APIToken,flowId:l,spaceId:d.id}),r()},children:(0,p.jsx)(x.FormattedMessage,{id:"mondayAuthentication.authenticateButton.label",defaultMessage:"Authenticate"})}),(0,p.jsx)(We.Z,{isLarge:!0,style:{marginLeft:12},onClick:()=>{r()},children:(0,p.jsx)(x.FormattedMessage,{id:"mondayAuthentication.cancelButton.label",defaultMessage:"Cancel"})})]})]})})}const Lt=function(e){const t=(0,o.VK)((()=>N.Z.state),[]),s=(0,o.VK)((()=>X.Z.state),[]),{account:a,isLoadingMondayWorkspaces:d}=t,{spaceStore:c}=e,u=(0,i.O7)(),m=(0,x.useIntl)(),{device:g}=u,h=s.flowId||(0,y.ZP)();(0,n.useEffect)((()=>{s.flowId||X.Z.setState({flowId:h})}),[h,s]);const f={title:m.formatMessage({id:"mondayImportOption.mondayButton.title",defaultMessage:"Monday.com"}),logo:r.Z.images.import.mondayPng,caption:a,actionButton:a?(S=[{name:m.formatMessage({id:"mondayImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:()=>{N.Z.setState({...N.Z.state,showAuthPopup:!0})}},{name:m.formatMessage({id:"mondayImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>F.sC({environment:u,spaceId:c.id})}],(0,p.jsx)(ce.ZP,{popupType:fe.kQ.Popup,renderOrigin:e=>d?(0,p.jsx)(me.Z,{}):(0,p.jsx)(ue.Z,{ariaLabel:m.formatMessage({id:"mondayImportOption.mondayButton.ariaLabel",defaultMessage:"Import from Monday.com button"}),icon:l.o,...e}),render:e=>{const t=S.map((t=>{let{name:s,captionText:n,action:i}=t;const o={key:s,render:e=>(0,p.jsx)(de.Z,{...e,title:s,caption:n,captionStyle:n?Ot:void 0}),action:()=>{i(),e.close()}};return o})),s={key:"section",render:e=>(0,p.jsx)(xe.Z,{...e}),items:t};return(0,p.jsx)(ge.Z,{menuType:q.og.Popup,width:200,children:(0,p.jsx)(he.Z,{type:he.i.Vertical,initialFocus:void 0,sections:[s]})})}})):void 0,onClick:()=>{}};var S;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(ce.ZP,{onClick:async()=>{N.Z.resetImport(),a?(v.ay(u,{import_source:"monday.com",from:e.analyticsFrom,userId:u.currentUser.id,spaceId:c.id,flowId:h}),await F.FM({environment:u,spaceId:c.id}),F.h7()):N.Z.setState({...N.Z.state,showAuthPopup:!0})},popupType:g.isMobile?ce.Z4.SlideUp:ce.Z4.Popup,buttonPopupStore:le,renderOrigin:e=>{let{onClick:t}=e;return(0,p.jsx)(we,{...f,onClick:t})},render:()=>null}),(0,p.jsx)(Bt,{environment:u,spaceStore:c,flowId:h})]})};const Vt=function(e){let{requestStore:t,analyticsFrom:s,trelloResult:a,renderItemActionsButton:l,spaceStore:d,spaceViewStore:c,onComplete:u}=e;const m=(0,i.O7)(),g=(0,x.useIntl)(),{boardsResponse:h,showLoader:f,isFetchingBoards:y}=(0,o.VK)((()=>ie.Z.state),[]),S=(0,n.useCallback)((()=>async function(e,t,s,n){n&&await A.u(e,t);v.ay(e,{import_source:"trello",from:s})}(m,t,s,y)),[m,t,s,y]),{device:b}=m,{account:M}=a,j=h.boards,C={key:"default",name:g.formatMessage({id:"trelloImportOption.boardProperty.defaultName",defaultMessage:"Boards"}),items:j.map((e=>({key:e.id,name:e.name})))},w={title:"Trello",logo:r.Z.images.import.trelloPng,actionButton:M&&f?(0,p.jsx)(me.Z,{}):M&&l([{name:g.formatMessage({id:"trelloImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>ee.Z.setState({open:!0})},{name:g.formatMessage({id:"trelloImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:()=>Nt(t,m)},{name:g.formatMessage({id:"trelloImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>async function(e,t){await k.disconnectTrello(t,{}),ie.Z.setState({boardsResponse:{boards:[]},isFetchingBoards:!0,showLoader:!1}),await e.refresh(),v.qJ(t,{integration_name:"trello"})}(t,m)}]),onClick:()=>{}};return(0,p.jsx)(ce.ZP,{popupType:b.isMobile?ce.Z4.SlideUp:ce.Z4.Popup,buttonPopupStore:ee.Z,onClick:S,render:()=>f?(0,p.jsx)(p.Fragment,{}):(0,p.jsx)(St,{searchInputPlaceholder:g.formatMessage({id:"trelloImportOption.search.placeholder",defaultMessage:"Search for a board…"}),noSearchResultsPlaceholder:g.formatMessage({id:"trelloImportOption.search.noResultsPlaceholder",defaultMessage:"No boards found."}),analyticsName:"trello",sections:[C],onComplete:e=>async function(e,t,s,n,i,o){const{boards:a}=e,r=a.filter((e=>Boolean(t.find((t=>t.key===e.id)))));v.G7(o,{integration_name:"trello",count:t.length});const l=await P.su({environment:o,spaceStore:s,spaceViewStore:n,boards:r});i(l)}(h,e,d,c,u,m)}),renderOrigin:e=>{let{onClick:s}=e;return(0,p.jsx)(we,{...w,onClick:M?s:()=>Nt(t,m)})}})};async function Nt(e,t){await A.M({environment:t,requestStore:e})}const Et={display:"flex",alignItems:"center",justifyContent:"center",width:752,minHeight:240};const Ut=function(e){let{analyticsFrom:t,spaceStore:s,onComplete:n,spaceViewStore:r,userSettingsStore:l,pageStore:d}=e;const c=(0,i.O7)(),u=(0,a.Fg)(),m=(0,o.qz)(void 0,se.Z),g=(0,o.qz)(void 0,se.Z),h=(0,o.qz)(void 0,se.Z),M=(0,o.qz)(void 0,se.Z),j=(0,o.qz)(void 0,se.Z),C=(0,o.qz)(void 0,se.Z),k=(0,o.qz)(void 0,se.Z),T=(0,o.VK)((()=>Q.Z.state.online),[]),_=(0,o.VK)((()=>ne.Z.getState()),[]),R=(0,o.VK)((()=>zt()),[]);return T?(0,p.jsx)(Yt,{spaceStore:s,trelloRequestStore:C,asanaRequestStore:j,evernoteRequestStore:M,confluenceRequestStore:h,mondayRequestStore:g,jiraRequestStore:m,googleDocRequestStore:k,renderChildren:e=>{if(e){const{defaultSubtab:i}=_;return function(e){let{defaultSubtab:t,environment:s,pageStore:n,spaceStore:i,spaceViewStore:o,trelloRequestStore:a,evernoteRequestStore:r,confluenceRequestStore:l,googleDocRequestStore:d,result:c,onComplete:u,analyticsFrom:p,flowId:m}=e;if(!t)return;if(!f.U.includes(t)||"gdocs"===t&&c.googleDocResult.isGoogleDocImporterEnabled)switch(t){case"trello":!function(e,t,s){const n=s.account;n?A.u(e,t).then((()=>{ee.Z.setState({open:!0})})).catch((()=>{ie.Z.setState({...ie.Z.state,isFetchingBoards:!1,showLoader:!1})})):A.M({environment:e,requestStore:t}).then((()=>{})).catch((()=>{}))}(s,a,c.trelloResult);break;case"evernote":!function(e,t,s){const{userInfo:n}=s;n?Z.B({environment:e,requestStore:t}).then((()=>{J.Z.setState({open:!0})})).catch((()=>{})):Z.e({environment:e,requestStore:t}).then((()=>{})).catch((()=>{}))}(s,r,c.evernoteResult);break;case"monday":!function(e,t,s){t.user?F.FM({environment:e,spaceId:s}).then((()=>{N.Z.setState({...N.Z.state,currentTab:"selectData",isModalOpen:!0})})).catch((()=>{})):N.Z.setState({...N.Z.state,showAuthPopup:!0})}(s,c.mondayResult,i.id);break;case"confluenceApi":!function(e,t,s,n){const{account:i}=t;ne.Z.setState({...ne.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0}),i?I({environment:e,requestStore:n,spaceId:s}).then((()=>{$.Z.setState({open:!0})})).catch((()=>{w.setState({...w.state,[s]:{...w.state[s],showLoader:!1}})})):w.setState({...w.state,[s]:{...w.state[s],open:!0}})}(s,c.confluenceResult,i.id,l);break;case"asana":!function(e,t){const{account:s}=t;s?b.bA({environment:e}).then((()=>{D.Z.setState({...D.Z.state,isModalOpen:!0})})).catch((()=>{D.Z.setState({...D.Z.state,isAccountLinkingInProgress:!1,isModalOpen:!1})})):b.w1({environment:e,flowId:(0,y.ZP)()}).then((()=>{})).catch((()=>{}))}(s,c.asanaResult);break;case"jira":!function(e){const{account:t}=e;if(!t)return;const s=te.Z.getState();te.Z.setState({...s,type:t.length?"auth":"teamspace-selection",open:!0})}(c.jiraResult);break;case"gdocs":!function(e,t,s){At(e,t,s).then((()=>{})).catch((()=>{}))}(s,d,c.googleDocResult.areAccountsFetched)}else!function(e){let{environment:t,pageStore:s,spaceStore:n,spaceViewStore:i,uploadType:o,onComplete:a}=e;if(!s)return;P.Pv({environment:t,pageStore:s,spaceStore:n,spaceViewStore:i,uploadType:o,flowId:(0,y.ZP)()}).then((e=>{e&&(S.W(t,{from:"import",type:"page",new_page_id:e.id,creating_block_id:e.id,parent_collection_id:e.getParentCollectionIdUpToTwoLevels()}),a(e))})).catch((()=>{}))}({pageStore:n,spaceStore:i,spaceViewStore:o,environment:s,uploadType:t,onComplete:u});v.ay(s,{import_source:t,from:p,flowId:m,userId:s.currentUser.id,spaceId:i.id})}({defaultSubtab:i,pageStore:d,spaceStore:s,spaceViewStore:r,trelloRequestStore:C,evernoteRequestStore:M,confluenceRequestStore:h,googleDocRequestStore:k,result:e,environment:c,onComplete:n,analyticsFrom:t,flowId:R}),ne.Z.setState({...ne.Z.state,defaultSubtab:void 0}),(0,p.jsx)("div",{style:Et,children:(0,p.jsx)(es,{analyticsFrom:t,onComplete:n,spaceStore:s,spaceViewStore:r,userSettingsStore:l,pageStore:d,trelloRequestStore:C,evernoteRequestStore:M,confluenceRequestStore:h,jiraRequestStore:m,googleDocRequestStore:k,result:e})})}return(0,p.jsx)("div",{style:"onboarding"===t?{}:Et,children:(0,p.jsx)(me.Z,{})})}}):(0,p.jsx)("div",{style:{...Et,fontSize:14,color:u.mediumTextColor},children:(0,p.jsx)(x.FormattedMessage,{id:"importOptions.offlineErrorMessage",defaultMessage:"Please go online to import."})})};function Wt(e){let{url:t,helpButtonMessage:s,helpMessageWidth:n,disableBackground:i}=e;return(0,p.jsx)(ye.ZP,{renderTooltip:()=>s??(0,p.jsx)(x.FormattedMessage,{id:"importOptions.helpButton.tooltip",defaultMessage:"Learn about how to import"}),style:{width:n??170},textWrap:!0,render:e=>(0,p.jsx)(pe.Z,{external:!0,href:t,style:{marginLeft:"auto"},...e,children:(0,p.jsx)(ue.Z,{icon:d.m,disableBackground:i??!1})})})}function Kt(e){let{actions:t}=e;return(0,p.jsx)(ce.ZP,{popupType:fe.kQ.Popup,renderOrigin:e=>(0,p.jsx)(ue.Z,{icon:l.o,...e}),render:e=>{const s={key:"section",render:e=>(0,p.jsx)(xe.Z,{...e}),items:t.map((t=>{let{name:s,action:n}=t;return{key:s,render:e=>(0,p.jsx)(Le.Z,{...e,title:s}),action:()=>{n(),e.close()}}}))};return(0,p.jsx)(ge.Z,{menuType:q.og.Popup,width:200,children:(0,p.jsx)(he.Z,{type:he.i.Vertical,initialFocus:void 0,sections:[s]})})}})}function zt(){return X.Z.state.flowId||(0,y.ZP)()}async function qt(e,t,s,n,i,o,a,r){v.ay(o,{import_source:e,from:t,import_type:"file",flowId:r});const l=await P.Pv({environment:o,pageStore:a,spaceStore:s,spaceViewStore:n,uploadType:e,flowId:r});l&&(S.W(o,{from:"import",type:"page",new_page_id:l.id,creating_block_id:l.id,parent_collection_id:l.getParentCollectionIdUpToTwoLevels()}),i(l))}function Gt(e){let{flowId:t,analyticsFrom:s,spaceStore:n,spaceViewStore:o,onComplete:a,pageStore:l}=e;const d=(0,i.O7)();return(0,p.jsx)(we,{title:"Confluence",logo:r.Z.images.import.confluencePng,onClick:()=>qt("confluence",s,n,o,a,d,l,t),actionButton:(0,p.jsx)(Wt,{url:(0,Y.UY)("guides.importConfluence")})})}function Ht(e){let{analyticsFrom:t,spaceStore:s,spaceViewStore:n,onComplete:o,pageStore:a}=e;const r=(0,i.O7)();return(0,p.jsx)(ye.ZP,{placement:ye.ug.Bottom,render:e=>(0,p.jsx)(we,{tooltipEvents:e,title:"CSV",icon:m,onClick:()=>qt("csv",t,s,n,o,r,a)}),renderTooltip:()=>(0,p.jsx)(x.FormattedMessage,{id:"importOptions.csvImport.tooltip",defaultMessage:"Ensure first row in the CSV is the header"})})}function Yt(e){let{renderChildren:t,spaceStore:s,trelloRequestStore:n,asanaRequestStore:o,evernoteRequestStore:a,confluenceRequestStore:r,mondayRequestStore:l,jiraRequestStore:d,googleDocRequestStore:c}=e;const u=(0,i.O7)();return(0,p.jsx)(_.Z,{request:u,performRequest:E,requestStore:n,render:(e,n)=>(0,p.jsx)(_.Z,{request:u,performRequest:W,requestStore:o,render:(e,i)=>(0,p.jsx)(_.Z,{request:u,performRequest:K,requestStore:a,render:(e,o)=>(0,p.jsx)(_.Z,{request:u,performRequest:()=>async function(e,t){const s=await k.getConfluenceAccount(e,{spaceId:t});return"success"===s.type?s.data:(console.error(s.error),{})}(u,s.id),requestStore:r,render:(e,a)=>(0,p.jsx)(_.Z,{request:u,performRequest:()=>async function(e,t){N.Z.setState({...N.Z.state,isFetchingMondayAccount:!0});const s=await k.getMondayUser(e,{spaceId:t});var n,i;return"success"===s.type?null!==(n=s.data.user)&&void 0!==n&&n.email?(N.Z.setState({...N.Z.state,isFetchingMondayAccount:!1,account:null===(i=s.data.user)||void 0===i?void 0:i.email}),s.data):{user:void 0}:(N.Z.setState({...N.Z.state,isFetchingMondayAccount:!1}),console.error(s.error),{user:void 0})}(u,s.id),requestStore:l,render:(e,r)=>(0,p.jsx)(_.Z,{request:u,performRequest:()=>async function(e,t){const s=await k.getJiraAccount(e,{spaceId:t});return"success"===s.type?s.data:(console.error(s.error),{})}(u,s.id),requestStore:d,render:(e,s)=>(0,p.jsx)(_.Z,{request:u,performRequest:U,requestStore:c,render:(e,l)=>t(n&&i&&o&&a&&r&&s&&l?{trelloResult:n,asanaResult:i,evernoteResult:o,confluenceResult:a,mondayResult:r,jiraResult:s,googleDocResult:l}:void 0)})})})})})})})}function Qt(e){let{onComplete:t,spaceStore:s,spaceViewStore:n,userSettingsStore:i,googleDocRequestStore:o,pageStore:a}=e;return(0,p.jsx)(Ft,{renderItemActionsButton:e=>(0,p.jsx)(Kt,{actions:e}),onComplete:t,requestStore:o,spaceStore:s,spaceViewStore:n,userSettingsStore:i,pageStore:a})}function $t(e){let{trelloResult:t,analyticsFrom:s,onComplete:n,spaceStore:i,spaceViewStore:o,userSettingsStore:a,trelloRequestStore:r}=e;return(0,p.jsx)(Vt,{trelloResult:t,analyticsFrom:s,renderItemActionsButton:e=>(0,p.jsx)(Kt,{actions:e}),onComplete:n,requestStore:r,spaceStore:i,spaceViewStore:o,userSettingsStore:a})}function Jt(e){let{confluenceResult:t,flowId:s,analyticsFrom:n,onComplete:o,spaceStore:a,spaceViewStore:r,userSettingsStore:l,pageStore:d,confluenceRequestStore:c}=e;const u=(0,i.O7)();return(0,p.jsx)(dt,{confluenceResult:t,analyticsFrom:n,flowId:s,renderItemActionsButton:e=>(0,p.jsx)(Kt,{actions:e}),onComplete:o,spaceStore:a,requestStore:c,spaceViewStore:r,userSettingsStore:l,handleFileUploadClick:(e,t)=>qt(e,n,a,r,o,u,d,t),handleApiImportClick:(e,t)=>function(e,t,s,n,i,o){I({environment:i,requestStore:t,spaceId:s.id}).catch((()=>{})),v.ay(i,{import_source:e,from:n,import_type:"api",flowId:o})}(e,c,a,n,u,t)})}function Xt(e){let{evernoteResult:t,onComplete:s,spaceStore:n,spaceViewStore:i,userSettingsStore:o,evernoteRequestStore:a}=e;return(0,p.jsx)(kt,{evernoteResult:t,analyticsFrom:"onboarding",renderItemActionsButton:e=>(0,p.jsx)(Kt,{actions:e}),defaultActionButton:(0,p.jsx)(Wt,{url:(0,Y.UY)("guides.importEvernote")}),onComplete:s,requestStore:a,spaceStore:n,spaceViewStore:i,userSettingsStore:o})}function es(e){let{result:t,analyticsFrom:s,onComplete:n,spaceStore:a,spaceViewStore:l,userSettingsStore:d,pageStore:u,trelloRequestStore:m,evernoteRequestStore:f,confluenceRequestStore:y,jiraRequestStore:S,googleDocRequestStore:v}=e;const b=(0,i.O7)(),M=(0,o.VK)((()=>zt()),[]),j=(0,o.VK)((()=>(0,R.Tc)(b)),[b]),C=(0,o.VK)((()=>(0,G.d)()),[]),w=(0,o.VK)((()=>(0,O.tt)()),[]),k=(0,o.VK)((()=>(0,O.RT)()),[]),T=(0,o.VK)((()=>(0,z.K)()),[]),I=(0,o.VK)((()=>(0,H.n)()),[]),Z=(0,o.VK)((()=>(0,B.I2)()),[]);return(0,p.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gridAutoRows:"1fr",gap:"4px 16px",width:"100%"},children:[(0,p.jsx)(_e,{}),j?(0,p.jsx)(Jt,{analyticsFrom:s,onComplete:n,spaceStore:a,spaceViewStore:l,userSettingsStore:d,pageStore:u,confluenceRequestStore:y,confluenceResult:t.confluenceResult,flowId:M}):(0,p.jsx)(Gt,{analyticsFrom:s,spaceStore:a,spaceViewStore:l,onComplete:n,pageStore:u,flowId:M}),Z?(0,p.jsx)(Qt,{onComplete:n,spaceStore:a,spaceViewStore:l,userSettingsStore:d,googleDocRequestStore:v,pageStore:u,analyticsFrom:s}):(0,p.jsx)(we,{title:"Google Docs",logo:r.Z.images.import.googleDocsPng,actionButton:(0,p.jsx)(Wt,{url:(0,Y.UY)("guides.importGoogleDocs")}),onClick:()=>qt("gdocs",s,a,l,n,b,u)}),(0,p.jsx)(Ht,{analyticsFrom:s,spaceStore:a,spaceViewStore:l,onComplete:n,pageStore:u}),(0,p.jsx)(we,{title:(0,p.jsx)(x.FormattedMessage,{id:"importOptions.textMarkdown.title",defaultMessage:"Text & Markdown"}),icon:h,onClick:()=>qt("markdown",s,a,l,n,b,u)}),(0,p.jsx)(we,{title:"HTML",icon:g,onClick:()=>qt("html",s,a,l,n,b,u)}),(0,p.jsx)(we,{title:"Word",logo:r.Z.images.import.wordPng,onClick:()=>qt("docx",s,a,l,n,b,u)}),(0,p.jsx)(we,{title:"Dropbox Paper",logo:r.Z.images.import.dropboxPaperPng,actionButton:(0,p.jsx)(Wt,{url:(0,Y.UY)("guides.importDropboxPaper")}),onClick:()=>qt("dropbox",s,a,l,n,b,u)}),(0,p.jsx)($t,{analyticsFrom:s,onComplete:n,spaceStore:a,spaceViewStore:l,userSettingsStore:d,trelloRequestStore:m,trelloResult:t.trelloResult}),(0,p.jsx)(Xt,{onComplete:n,spaceStore:a,spaceViewStore:l,userSettingsStore:d,evernoteRequestStore:f,evernoteResult:t.evernoteResult}),C&&(0,p.jsx)(Lt,{spaceStore:a,analyticsFrom:s,flowId:M}),(0,p.jsx)(we,{title:"Quip",logo:r.Z.images.import.quipPng,actionButton:(0,p.jsx)(Wt,{url:(0,Y.UY)("guides.importQuip")}),onClick:()=>qt("quip",s,a,l,n,b,u)}),(0,p.jsx)(we,{title:"Workflowy",logo:r.Z.images.import.workflowyPng,actionButton:(0,p.jsx)(Wt,{url:(0,Y.UY)("guides.importWorkflowy")}),onClick:()=>qt("workflowy",s,a,l,n,b,u)}),w&&!k&&(0,p.jsx)(we,{title:(0,p.jsx)(x.FormattedMessage,{id:"importOptions.genericImporter.title",defaultMessage:"Universal import"}),icon:c.l,onClick:()=>qt("genericImporter",s,a,l,n,b,u,M),actionButton:(0,p.jsx)(Wt,{url:"",helpButtonMessage:(0,p.jsx)(x.FormattedMessage,{id:"importOptions.universalImport.tooltip",defaultMessage:"Import any ZIP file that contains text, Markdown, CSV, HTML, and other files"}),helpMessageWidth:240,disableBackground:!0})}),T&&(0,p.jsx)(Rt,{flowId:M,spaceStore:a,requestStore:S,jiraResult:t.jiraResult,renderItemActionsButton:e=>(0,p.jsx)(Kt,{actions:e})}),I&&(0,p.jsx)(we,{title:"PDF",onClick:()=>qt("pdf",s,a,l,n,b,u)})]})}},74584:(e,t,s)=>{s.r(t),s.d(t,{default:()=>se});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(15145),l=s(41892),d=s(59054),c=s(32566),u=s(82855),p=s(5257),m=s(64275),g=s(9291),h=s(7032),f=s(1898),x=s(37810),y=s(54642),S=s(47307),v=s(91367),b=s(8055),M=s(84210),j=s(60709),C=s(75546),w=s(80444),k=s(21039),T=s(6258),I=s(72087),Z=s(30397),P=s(69464),F=s(74016),A=s(42853),_=s(31945),R=s(61519),O=s(1743),B=s(74194),D=s(89728),L=s(42402),V=s(29551),N=s(85893);function E(e){let{email:t,site:s,APIToken:n,instanceType:i,emailValue:r,setEmailValue:l,siteValue:d,setSiteValue:c,tokenValue:u,setTokenValue:p}=e;const m=(0,o.VK)((()=>k.Z.state),[]),h=(0,a.yK)((e=>({inputLabels:{fontSize:x.Z.fontSize.UISmall.desktop,fontWeight:x.Z.fontWeight.semibold,font:"SF Pro",lineHeight:x.Z.lineHeight.UISmall.desktop,color:e.lightTextColor},dropdown:{padding:"0px, 6px, 0px, 6px",borderRadius:4,gap:4,width:68,height:24},placeHolder:{font:"SF Pro",fontWeight:x.Z.fontWeight.regular,fontSize:x.Z.fontSize.UIRegular.desktop,lineHeight:x.Z.lineHeight.UISmall.desktop},captionText:{font:"SF Pro",fontWeight:x.Z.fontWeight.regular,lineHeight:x.Z.lineHeight.UISmall.desktop,fontSize:x.Z.fontSize.UISmall.desktop,color:e.lightTextColor},inputBox:{width:380,height:28,padding:4,gap:4,radius:"default"}})),[]);return(0,N.jsx)(O.Z,{debugName:"AtlassianAPIAuthContentPopup",capture:!0,children:(0,N.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",width:"100%"},children:(0,N.jsx)("div",{style:{overflowY:"scroll"},children:(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{htmlFor:"instanceType",style:{...h.inputLabels},children:i}),(0,N.jsx)(U,{options:[{key:"Cloud",label:(0,N.jsx)(g.FormattedMessage,{id:"confluenceAuthentication.accountTypeDropdownCloudOption.label",defaultMessage:"Cloud"})}],currentOption:"Cloud"})]}),(0,N.jsx)(R.Z,{size:14,isHidden:!0}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{htmlFor:"email",style:h.inputLabels,children:t}),(0,N.jsx)(R.Z,{size:8,isHidden:!0}),(0,N.jsx)(B.Z,{id:"email",value:r,autoComplete:"off",autoCapitalize:"off",onChange:e=>{l(e.target.value)},showClearButton:!0,placeholder:"notion@acmelabs.com",inputElementAttributes:{minLength:4},style:h.inputBox})]}),(0,N.jsx)(R.Z,{size:14,isHidden:!0}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{htmlFor:"site",style:h.inputLabels,children:s}),(0,N.jsx)(R.Z,{size:8,isHidden:!0}),(0,N.jsx)(B.Z,{id:"site",value:d,onChange:e=>c(e.target.value),showClearButton:!0,placeholder:"jira.atlassian.com",inputElementAttributes:{minLength:4},style:h.inputBox}),(0,N.jsx)(R.Z,{size:8,isHidden:!0}),(0,N.jsx)("div",{style:{...h.captionText},children:(0,N.jsx)(g.FormattedMessage,{id:"AtlassianApiTokenAuthentication.stepsToGetAPIToken.helpTextForSiteInput",defaultMessage:"If you’re using Jira on a non-standard port, please include the port number in the URL, such as https://acme.atlassian.com:43"})})]}),(0,N.jsx)(R.Z,{size:14,isHidden:!0}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{htmlFor:"APIToken",style:h.inputLabels,children:n}),(0,N.jsx)(R.Z,{size:8,isHidden:!0}),(0,N.jsx)(B.Z,{id:"AccessToken",type:"password",value:u,onChange:e=>{p(e.target.value)},showClearButton:!0,placeholder:"Paste your token here",inputElementAttributes:{minLength:4},style:{...h.inputBox,...m.adminTokenError&&{boxShadow:"#D44C47"}}}),(0,N.jsx)(R.Z,{size:8,isHidden:!0}),(0,N.jsx)("div",{style:{...h.captionText},children:(0,N.jsx)(g.FormattedMessage,{id:"AtlassianApiTokenAuthentication.stepsToGetAPIToken.helpTextForApiTokenInput",defaultMessage:"<admintokenmessage>Must be an admin token.</admintokenmessage> Learn how to <createapitokenhelpdoc>create an API token</createapitokenhelpdoc>",values:{createapitokenhelpdoc:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,N.jsx)(L.Z,{external:!0,href:"https://support.atlassian.com/atlassian-account/docs/manage-api-tokens-for-your-atlassian-account",onClick:()=>{},children:t})},admintokenmessage:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,N.jsx)("span",{style:{...h.captionText,...m.adminTokenError&&{color:"#D44C47"}},children:t})}}})})]})]})})})})}function U(e){var t;const{options:s,currentOption:n}=e,i=null===(t=s.find((e=>{let{key:t}=e;return t===n})))||void 0===t?void 0:t.label,o=(0,a.yK)((e=>({icon:{marginLeft:4,fill:e.lightIconColor,width:16,height:16,padding:"0.5px, 0px, 0px, 0px",gap:10,fontSize:x.Z.fontSize.UISmall.desktop},dropdownLabel:{font:"SF Pro",fontSize:x.Z.fontSize.UIRegular.desktop,fontWeight:x.Z.fontWeight.regular,lineHeight:x.Z.lineHeight.UISmall.desktop}})),[]);return(0,N.jsx)(_.ZP,{popupType:_.Z4.Popup,placementToOrigin:_.pO.Left,renderOrigin:e=>(0,N.jsxs)(D.Z,{...e,isLarge:!0,style:o.dropdownLabel,disabled:!1,children:[i,(0,A.i)(o.icon)]}),render:()=>(0,N.jsx)(N.Fragment,{})})}const W=function(e){const{emailValue:t,setEmailValue:s,siteValue:n,setSiteValue:i,tokenValue:o,setTokenValue:a}=e;return(0,N.jsx)(E,{email:(0,N.jsx)(V.gq,{style:{alignItems:"center",gap:2},children:(0,N.jsx)(g.FormattedMessage,{id:"AtlassianApiTokenAuthentication.emailMessage",defaultMessage:"Email"})}),site:(0,N.jsx)(V.gq,{style:{alignItems:"center",gap:2},children:(0,N.jsx)(g.FormattedMessage,{id:"AtlassianApiTokenAuthentication.siteMessage",defaultMessage:"Site"})}),APIToken:(0,N.jsx)(V.gq,{style:{alignItems:"center",gap:2},children:(0,N.jsx)(g.FormattedMessage,{id:"AtlassianApiTokenAuthentication.apiTokenMessage",defaultMessage:"API token"})}),instanceType:(0,N.jsx)(V.gq,{style:{alignItems:"center",gap:2},children:(0,N.jsx)(g.FormattedMessage,{id:"AtlassianApiTokenAuthentication.instanceType",defaultMessage:"Jira instance type"})}),emailValue:t,setEmailValue:s,siteValue:n,setSiteValue:i,tokenValue:o,setTokenValue:a})};var K=s(64921),z=s(52275),q=s(36488),G=s(56940),H=s(68785),Y=s(78140),Q=s(32163),$=s(50506),J=s(58297),X=s(72495),ee=s(64369);const te={backButton:(0,N.jsx)(g.FormattedMessage,{id:"jiraSyncTeamSelectionModal.footer.back",defaultMessage:"Back"})};function se(){const e=(0,o.VK)((()=>k.Z.state),[]),t=(0,i.O7)(),{open:s,type:n}=e,a=()=>{const e=k.Z.getInitialState();k.Z.setState(e)},r=(0,o.qz)(void 0,I.Z),l=(0,o.VK)((()=>w.default.state),[]).currentSpaceStore,d=e.site,c=e.flowId||(0,h.ZP)();if(!n||!l)return null;const u="auth"===n?420:500,p="auth"===n?556:"calc(100vh - 100px)";return(0,N.jsx)($.Z,{open:s,innerStyle:{width:u,height:p,overflow:"scroll",borderRadius:5,maxHeight:675,padding:6},render:()=>(0,N.jsx)(q.Z,{capture:!0,allowEsc:!0,render:()=>(0,N.jsx)(G.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,render:()=>(0,N.jsx)(ne,{type:n,handleModalClose:a,environment:t,requestStore:r,spaceStore:l,site:d,flowId:c})})}),onDismiss:a})}function ne(e){const{type:t,environment:s,requestStore:n,spaceStore:i,site:o}=e,a=e.flowId||(0,h.ZP)();switch(t){case"teamspace-selection":return o?(0,N.jsx)(oe,{handleModalClose:e.handleModalClose,flowId:a,site:o}):(0,N.jsx)(N.Fragment,{});case"auth":return(0,N.jsx)(le,{handleModalClose:e.handleModalClose,environment:s,requestStore:n,spaceStore:i,flowId:a});default:return(0,N.jsx)(N.Fragment,{})}}function ie(e){const t=(0,a.yK)((e=>({spinner:{width:"100%",height:"100%",backgroundColor:e.modalUnderlayBackground,position:"absolute",top:0,left:0}})),[]);return(0,N.jsx)(N.Fragment,{children:e.loading&&(0,N.jsx)("div",{style:t.spinner,children:(0,N.jsx)(H.Z,{style:{position:"absolute",top:"50%",left:"50%"}})})})}function oe(e){let{handleModalClose:t}=e;const s=(0,i.O7)(),c=(0,g.useIntl)(),[m,h]=n.useState(),[j,I]=n.useState(),[A,_]=n.useState(!1),[R,O]=n.useState([]),[L,V]=n.useState(),[E,U]=n.useState(""),W=(0,o.VK)((()=>{var e;return null===(e=w.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),q=(0,o.VK)((()=>Z.Z.state.teams.filter((e=>e.canAddOrRemoveTopLevelPages()))),[]),G=(0,o.VK)((()=>k.Z.state),[]),[{value:H}]=(0,d.r5)((async()=>{if(W)return await y.getExternalSyncedCollectionInTeams(s,{spaceId:W})}),[s,W]),[{value:Y}]=(0,d.r5)((async()=>{if(W)return await y.getJiraSitesForWorkspace(s,{spaceId:W})}),[s,W]);(0,n.useEffect)((()=>{var e;if("success"===(null==Y?void 0:Y.type)&&null!==(e=Y.data)&&void 0!==e&&null!==(e=e.data)&&void 0!==e&&e.connections){const e=Y.data.data.connections.map((e=>{let{metainfo:t}=e;return t.siteUrl})).filter(f.$K);O(e),1===e.length&&V(e[0])}}),[Y]);const $=(0,o.VK)((()=>{if("success"===(null==H?void 0:H.type)&&H.data&&L){const e=H.data.filter((e=>e.site===L));return e.length||_(!0),e}return[]}),[H,L]),se=(0,o.VK)((()=>q.filter((e=>{var t;return null===(t=e.getName())||void 0===t?void 0:t.toLowerCase().includes(E.toLowerCase())}))),[q,E]),ne=(0,a.yK)((e=>({card:{flexGrow:1,borderRadius:6,borderStyle:"solid",borderWidth:1,borderColor:e.strikethroughLineColor,padding:"4px 0px",overflow:"auto",margin:"8px 0px 18px",maxHeight:180},wrapper:{padding:"20px 14px 0px 14px",height:"100%",display:"flex",flexDirection:"column"},teamsListTitle:{fontSize:12,fontWeight:x.Z.fontWeight.medium,color:e.mediumTextColor,marginBottom:8},teamsListSubTitle:{fontSize:14,color:e.mediumTextColor,fontWeight:x.Z.fontWeight.regular},teamBody:{padding:"0px 6px",margin:"24px 0px",height:"--webkit-fill-available",flexGrow:1}})),[]),oe=e=>{h(e),I(null)},ae=e=>{if(e){const t=(0,M.ZP)({store:e,preferPublicLink:!1,pageVisitSource:r.tY.Import});b.Li({environment:s,url:t})}else S.showDialog({showCancel:!1,keepFocus:!1,message:(0,N.jsx)(g.FormattedMessage,{defaultMessage:"Error occurred while creating project page. Please try again.",id:"action.jiraSyncImportFailed.message"}),items:[{label:(0,N.jsx)(g.FormattedMessage,{defaultMessage:"Ok",id:"action.jiraSyncImportFailed.okLabel"}),color:"blue",onAccept(){}}]});const t=k.Z.getInitialState();k.Z.setState(t)},le=se.map((e=>({key:e.id,render:t=>(0,N.jsx)(P.Z,{team:e,onAccept:oe,focused:(null==m?void 0:m.id)===e.id,showMemberCount:!0},e.id),action:()=>{}}))),ue=$.map((e=>{const t=`${e.projectId}`,s=q.find((t=>t.id===e.teamId));if(s)return{key:t,render:()=>(0,N.jsx)(z.Z,{buttonStyle:{marginBottom:6},onClick:()=>{return t={pageId:e.projectId,team:s},I(t),void h(null);var t},icon:(0,N.jsx)("img",{src:l.Z.images.integrations.jiraTargetSvg}),title:(0,N.jsx)(g.FormattedMessage,{id:"jiraSyncTeamSelectionModal.teamsList.syncCount",defaultMessage:"{projects} projects, {tasks} tasks",values:{projects:e.projectsCount,tasks:e.tasksCount}}),focused:(null==j?void 0:j.pageId)===e.projectId,caption:(0,N.jsxs)("div",{style:{display:"flex",gap:6,alignItems:"center",marginTop:6},children:[(0,N.jsx)(g.FormattedMessage,{defaultMessage:"in",id:"jiraSyncTeamSelectionModal.teamsList.teamspace.prefix"}),(0,N.jsx)(F.p,{store:s,size:20,disabled:!0}),(0,N.jsx)(C.o,{teamStore:s})]})}),action:()=>{}}})).filter(f.$K),pe=$.length>0&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(ee.Z,{isSecondaryColor:!0,style:ne.teamsListTitle,children:(0,N.jsx)(g.FormattedMessage,{id:"jiraSyncTeamSelectionModal.existingSync.title",defaultMessage:"Edit existing Jira sync"})}),(0,N.jsx)(ee.Z,{isSecondaryColor:!0,style:ne.teamsListSubTitle,children:(0,N.jsx)(g.FormattedMessage,{id:"jiraSyncTeamSelectionModal.existingSync.subtitle",defaultMessage:"Add or remove projects to an existing Jira sync"})}),(0,N.jsx)("div",{style:ne.card,children:(0,N.jsx)(Q.Z,{type:Q.i.Vertical,initialFocus:0,sections:[{key:"existingSyncs",render:e=>(0,N.jsx)(X.Z,{topBorder:!1,...e}),items:ue}]})})]}),me=A||1===R.length&&0===$.length,ge=(0,N.jsxs)(N.Fragment,{children:[$.length?(0,N.jsxs)(K.Z,{onClick:()=>_(!A),style:{...ne.teamsListTitle,display:"flex",alignItems:"center",gap:6},children:[(0,N.jsx)(g.FormattedMessage,{id:"jiraSyncTeamSelectionModal.createNewSync.title",defaultMessage:"or create a new sync"}),A?(0,u.E)({height:8,width:12}):(0,p.o)({height:16,width:12})]}):L&&(0,N.jsx)(N.Fragment,{children:(0,N.jsx)(ee.Z,{style:ne.teamsListTitle,children:(0,N.jsx)(g.FormattedMessage,{id:"jiraSyncTeamSelectionModal.addNewSync.title",defaultMessage:"Add a new sync"})})}),me&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(B.Z,{focus:!0,placeholder:c.formatMessage({id:"jiraSyncTeamSelectionModal.searchPlaceholder",defaultMessage:"Search for a teamspace"}),showClearButton:!0,onChange:e=>U(e.target.value),value:E,style:{marginTop:12,marginBottom:12}}),(0,N.jsx)("div",{style:{...ne.card,maxHeight:320},children:(0,N.jsx)(Q.Z,{type:Q.i.Vertical,initialFocus:0,sections:[{key:"teamspaces",render:e=>(0,N.jsx)(X.Z,{topBorder:!1,...e}),items:le}]})})]})]});return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{style:ne.wrapper,children:[(0,N.jsx)(de,{handleModalClose:t}),(0,N.jsxs)("div",{style:{flexGrow:1,overflow:"scroll"},className:"hide-scrollbar",children:[(0,N.jsx)("div",{style:ne.teamsListTitle,children:(0,N.jsx)(g.FormattedMessage,{id:"jiraSyncTeamSelectionModal.site.title",defaultMessage:"Site"})}),(0,N.jsx)(re,{sites:R,onChange:e=>{V(e)},selectedSite:L}),pe,ge]}),(0,N.jsxs)(ce,{children:[(0,N.jsx)(D.Z,{isGray:!0,onClick:t,children:te.backButton}),(0,N.jsx)(J.Z,{onClick:()=>{if(m)(async e=>{k.Z.setState({...k.Z.state,loading:!0});const t=await v.Pf({environment:s,selectedTeamspaceId:e,siteUrl:G.site,botId:G.botId});ae(t)})(m.id);else if(j){const{pageId:e,team:t}=j,s=T.G.createChildStore(t,{id:e,table:"block",spaceId:W});s&&ae(s)}},disabled:!(L&&(Boolean(j)||Boolean(m))),children:j?(0,N.jsx)(g.FormattedMessage,{id:"jiraSyncTeamSelectionModal.footer.addToExistingTeam",defaultMessage:"Edit sync"}):(0,N.jsx)(g.FormattedMessage,{id:"jiraSyncTeamSelectionModal.footer.addToNewTeam",defaultMessage:"Add sync"})})]})]}),(0,N.jsx)(ie,{loading:G.loading})]})}function ae(e){var t;const s=null==e?void 0:e.split("/");return(null==s||null===(t=s[2])||void 0===t||null===(t=t.split("."))||void 0===t?void 0:t[0])||""}function re(e){const{sites:t,selectedSite:s,onChange:n}=e,{isMobile:o}=(0,i.Fy)(),r=(0,a.yK)((e=>({card:{flexGrow:1,borderRadius:6,borderStyle:"solid",borderWidth:1,borderColor:e.strikethroughLineColor,overflow:"auto",marginBottom:18,display:"flex",gap:8},integrationIcon:{width:20,height:20,marginTop:4},chooseSiteButton:{display:"flex",marginTop:6,marginBottom:6,marginLeft:"-8px",gap:6,alignItems:"center",width:"fit-content"}})),[]);return(0,N.jsx)(_.ZP,{popupType:o?_.Z4.SlideUp:_.Z4.Popup,placementToOrigin:_.pO.Bottom,alignmentToOrigin:_.vR.Start,renderOrigin:e=>s?(0,N.jsx)("div",{style:r.card,children:(0,N.jsx)(z.Z,{...e,title:(0,N.jsx)(ee.Z,{style:{fontWeight:x.Z.fontWeight.regular,textTransform:"capitalize"},children:ae(s)}),caption:(0,N.jsx)(ee.Z,{isSecondaryColor:!0,style:{fontWeight:x.Z.fontWeight.regular},children:s}),icon:(0,N.jsx)("img",{style:r.integrationIcon,src:l.Z.images.externalIntegrations.jiraPng}),right:(0,u.E)({height:8,width:12}),shouldWrapCaption:!0,focused:!1})}):(0,N.jsxs)(D.Z,{...e,isLarge:!0,style:r.chooseSiteButton,disabled:!1,children:[(0,N.jsx)(g.FormattedMessage,{id:"jiraSyncTeamSelectionModal.site.change",defaultMessage:"Choose Jira site"}),(0,u.E)({height:8,width:12})]}),render:e=>{const s=[{key:"sites",render:e=>(0,N.jsx)(X.Z,{...e}),items:t.map((e=>({key:e,action:()=>{n(e)},render:t=>(0,N.jsx)(z.Z,{...t,title:(0,N.jsx)(ee.Z,{style:{fontWeight:x.Z.fontWeight.regular,textTransform:"capitalize"},children:ae(e)}),caption:(0,N.jsx)(ee.Z,{isSecondaryColor:!0,style:{fontWeight:x.Z.fontWeight.regular},children:e}),shouldWrapCaption:!0,focused:!1})})))}];let i;return i=o?{menuType:j.og.Modal,title:"site",right:(0,N.jsx)(g.FormattedMessage,{defaultMessage:"Done",id:"settingItem.buttonPopup.done.label"}),onClickRight:e.close}:{menuType:j.og.Popup,width:270},(0,N.jsx)(Y.Z,{...i,children:(0,N.jsx)(Q.Z,{type:Q.i.Vertical,sections:s,initialFocus:void 0,onAccept:e.close})})}})}function le(e){let{environment:t,requestStore:s,spaceStore:i,handleModalClose:r,flowId:l}=e;const d=(0,o.VK)((()=>k.Z.state),[]),c=(0,a.yK)((e=>({wrapper:{padding:"20px 14px 16px 14px",height:"100%",display:"flex",flexDirection:"column"},teamsListTitle:{fontSize:12,fontWeight:x.Z.fontWeight.medium,color:e.mediumTextColor,padding:"0px 6px"}})),[]),[u,p]=(0,n.useState)(""),[m,h]=(0,n.useState)(""),[f,y]=(0,n.useState)("");return(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)("div",{style:{height:"100%"},children:[(0,N.jsxs)("div",{style:c.wrapper,children:[(0,N.jsx)(de,{handleModalClose:r}),(0,N.jsx)(W,{emailValue:u,setEmailValue:p,siteValue:m,setSiteValue:h,tokenValue:f,setTokenValue:y}),(0,N.jsxs)(ce,{children:[(0,N.jsx)(D.Z,{isGray:!0,onClick:r,children:te.backButton}),(0,N.jsx)(J.Z,{onClick:async()=>{await(async e=>{const{site:n,email:o,apiToken:a}=e,r=null==i?void 0:i.id;r&&await v.G2({environment:t,requestStore:s,userEmail:o,site:n,apiToken:a,spaceId:r,flowId:l})})({site:m,email:u,apiToken:f})},children:(0,N.jsx)(g.FormattedMessage,{id:"jiraSyncAuthModal.footer.chooseSyncLocation",defaultMessage:"Choose sync location"})})]})]}),(0,N.jsx)(ie,{loading:d.loading})]})})}function de(e){let{handleModalClose:t}=e;const s=(0,a.yK)((e=>({header:{fontWeight:x.Z.fontWeight.medium,fontSize:17,textAlign:"center",marginTop:8},description:{fontWeight:x.Z.fontWeight.regular,color:e.mediumTextColor,fontSize:14,maxHeight:72,textAlign:"center",padding:"0px 68px",marginBottom:24},icon:{height:40,width:40},iconGroup:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gridColumnGap:9,marginBottom:9},arrowRight:{width:20,height:20,opacity:.4,fontWeight:"bold",padding:3},closeButton:{position:"absolute",top:14,right:14,zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:14,fill:e.mediumTextColor}})),[]);return(0,N.jsxs)("div",{children:[(0,N.jsx)(K.Z,{onClick:t,style:s.closeButton,hoveredStyle:s.closeButtonHover,children:(0,m.D)(s.closeButtonIcon)}),(0,N.jsxs)("div",{style:s.iconGroup,children:[(0,N.jsx)("img",{style:s.icon,src:l.Z.images.externalIntegrations.jiraPng,alt:"Jira Icon"}),(0,c.k)(s.arrowRight),(0,N.jsx)("img",{style:s.icon,src:l.Z.images.notionLogoPng,alt:"Notion Logo"})]}),(0,N.jsx)("div",{style:s.header,children:(0,N.jsx)(g.FormattedMessage,{id:"jiraSyncTeamSelectionModal.header.label",defaultMessage:"Sync Jira projects and issues"})}),(0,N.jsx)("div",{style:s.description,children:(0,N.jsx)(g.FormattedMessage,{id:"jiraSyncTeamSelectionModal.description.label",defaultMessage:"Sync Jira information to a Notion database and view the latest updates"})})]})}function ce(e){const t=(0,a.yK)((e=>({footer:{display:"flex",justifyContent:"space-between",marginTop:6,marginBottom:10}})),[]);return(0,N.jsx)("div",{style:t.footer,children:e.children})}},42752:(e,t,s)=>{s.d(t,{Z:()=>w});s(67294);var n=s(480),i=s(86628),o=s(24405),a=s(42853),r=s(57222),l=s(9291),d=s(72933),c=s(14549),u=s(47307),p=s(43250),m=s(60709),g=s(61766),h=s(77080),f=s(31194),x=s(52275),y=s(31945),S=s(78140),v=s(32163),b=s(74136),M=s(89728),j=s(72495),C=s(85893);const w=function(e){let{currentLocale:t,pickerLabel:s,confirm:r,onChange:x,origin:w}=e;const I=(0,o.Fg)(),Z=(0,n.O7)(),P=(0,l.useIntl)(),F=(0,i.qz)(void 0,g.Z),{device:A}=Z,_=(0,i.VK)((()=>"ja-JP"===t&&h.default.checkGate("japan_full_launch")),[t]),R=(0,i.VK)((()=>h.default.checkGate("polyglot")),[]);return A.isMobile?null:(0,C.jsx)(y.ZP,{onClick:()=>{c.xU(Z,{origin:w})},popupType:y.Z4.Popup,buttonPopupStore:F,renderOrigin:e=>(0,C.jsx)(C.Fragment,{children:(0,C.jsxs)(M.Z,{style:{marginLeft:-8,paddingLeft:8,paddingRight:8},...e,children:[s||k(t,P).label,(0,d.ay)(t)&&!_&&(0,C.jsx)(b.Z,{desktopStyle:{marginLeft:4},children:(0,C.jsx)(l.FormattedMessage,{id:"languagePicker.betaBadge",defaultMessage:"Beta"})}),(0,a.i)({width:10,marginLeft:4,fill:I.lightIconColor})]})}),placementToOrigin:f.Iw.Bottom,alignmentToOrigin:f.lU.Start,render:e=>{let s;s=R?[...d.tp,...d.is]:[...d.tp];const n=[{key:"languages",render:e=>(0,C.jsx)(j.Z,{...e,topBorder:0!==e.index}),items:s.map((s=>{const n={key:s,render:e=>function(e,t,s,n){const{label:i,caption:o}=k(e,n);return(0,C.jsx)(T,{label:i,caption:o,focused:t,props:s,locale:e})}(s,e.focused,e,P),action:()=>{!function(e,t,s,n,i){t!==e&&function(e,t,s,n){const{label:i}=k(e,t);if(s){const t=()=>{n(e)};u.showDialog({showCancel:!0,keepFocus:!1,message:(0,C.jsx)(l.FormattedMessage,{id:"languagePicker.changeLanguage.confirmationMessage",defaultMessage:"Are you sure you want to update the language to {language}?",values:{language:i}}),items:[{label:(0,C.jsx)(l.FormattedMessage,{id:"languagePicker.changeLanguage.updateButton.label",defaultMessage:"Update"}),color:"red",onAccept:t}]})}else n(e)}(e,s,n,i)}(s,t,P,r,x),e.close()}};return n}))}],i={menuType:m.og.Popup,width:240};return(0,C.jsx)(S.Z,{className:p.hKO,...i,children:(0,C.jsx)(v.Z,{type:v.i.Vertical,initialFocus:void 0,sections:n})})}})};function k(e,t){return(0,r.t)(t)[e]}function T(e){const{locale:t}=e,s=(0,o.Fg)(),n=(0,i.VK)((()=>"ja-JP"===t&&h.default.checkGate("japan_full_launch")),[t]);return(0,C.jsx)(x.Z,{...e.props,title:(0,C.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,C.jsx)("div",{style:{...e.style,marginRight:0},children:e.label})}),caption:e.caption&&(0,C.jsx)("span",{style:{color:s.mediumTextColor},children:e.caption}),shouldWrapCaption:!0,right:(0,d.ay)(e.locale)&&!n&&(0,C.jsx)(b.Z,{children:(0,C.jsx)(l.FormattedMessage,{id:"languagePicker.betaBadge",defaultMessage:"Beta"})})})}},99472:(e,t,s)=>{s.d(t,{Z:()=>f,d:()=>h});s(67294);var n=s(480),i=s(86628),o=s(54153),a=s(9291),r=s(14549),l=s(54642),d=s(47307),c=s(47839),u=s(53730),p=s(64369),m=s(42752),g=s(85893);async function h(e){let{locale:t,environment:s,origin:n}=e;r.A0(s,{locale:t,origin:n});const i=await l.setLocale(s,{locale:t});"success"===i.type?(o.Z.set("preferredLocale",t),await u.transactionQueue.drain(),s.device.isElectron?c.refreshAll({includeFocusedWindow:!0}):window.location.reload(!0)):d.showError(i)}const f=function(e){const t=(0,n.O7)(),{device:s,WindowSizeStore:o}=t,r=(0,i.VK)((()=>o.state.paddingLeftCSS),[o]),l=(0,i.VK)((()=>o.state.paddingRightCSS),[o]);return(0,g.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto",paddingLeft:s.isMobile?r:0,paddingRight:s.isMobile?l:0},children:(0,g.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",width:"100%"},children:[(0,g.jsxs)("div",{style:{flex:1},children:[(0,g.jsx)(p.Z,{children:(0,g.jsx)(a.FormattedMessage,{id:"languageRegionSettings.language.label",defaultMessage:"Language"})}),(0,g.jsx)(p.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"},children:(0,g.jsx)(a.FormattedMessage,{id:"languageSettings.languageSwitcher.subtitle",defaultMessage:"Change the language used in the user interface."})})]}),(0,g.jsx)(m.Z,{confirm:!0,onChange:e=>h({locale:e,environment:t,origin:"languageSettings"}),currentLocale:e.locale,origin:"languageSettings"})]})})}},72280:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Z});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(66673),l=s(45238),d=s(85893);const c=(0,l.IU)("appDownload",{viewBox:"0 0 23 16",svg:(0,d.jsx)("path",{clipRule:"evenodd",d:"m23 11.4338c0 2.5317-2.1591 4.5662-4.922 4.5662h-12.59789c-3.12888 0-5.48011-2.2739-5.48011-4.9804 0-2.2463 1.28998-4.10591 3.3576-4.43732.04574-2.57768 2.49761-4.2992 4.74821-3.63637 1.09785-1.61104 2.86359-2.94591 5.34289-2.94591 3.7418 0 6.6786 2.96433 6.6603 7.0702 1.784.75489 2.891 2.43038 2.891 4.3636zm-17.51989 3.084h12.59789c1.9487 0 3.449-1.3717 3.449-3.084 0-1.66625-1.0704-2.89065-2.7354-3.25889-.1098-.02761-.1556-.09206-.1464-.21173.0366-.43269.064-.92981.0366-1.35328-.1555-2.73418-2.2323-5.12774-5.2331-5.12774-2.3695 0-3.73271 1.30725-4.62014 2.89989-.05489.10126-.11893.12888-.22872.09206-1.8755-.6168-3.90652.22094-3.90652 3.05638 0 .11968-.04575.18412-.17383.18412-1.93954 0-3.04654 1.46376-3.04654 3.30499 0 1.878 1.70167 3.4982 4.00716 3.4982zm7.19089-9.49502c0-.39047-.3145-.70701-.7026-.70701-.388 0-.7026.31654-.7026.70701v4.89196l-1.61105-1.62112c-.27439-.27611-.71927-.27611-.99366 0-.2744.27611-.2744.72377 0 .99987l2.81051 2.82811c.2744.2761.7193.2761.9936 0l2.8106-2.82811c.2743-.2761.2743-.72376 0-.99987-.2744-.27611-.7193-.27611-.9937 0l-1.6111 1.62112z",fillRule:"evenodd"})});var u=s(64275),p=s(99405),m=s(89101),g=s(9291),h=s(37810),f=s(29845),x=s(54642),y=s(8055),S=s(21969),v=s(4023),b=s(45946),M=s(60458),j=s(73063),C=s(16354),w=s(53437),k=s(58297),T=s(62385),I=s(64369);function Z(){const e=(0,i.O7)(),t=(0,g.useIntl)(),[s,l]=(0,n.useState)(!0),{isDesktopBrowser:Z,os:P}=(0,i.Fy)(),F=(0,o.VK)((()=>e.RouterStore.state.route.name in p.c$),[e]),A=e.currentUser.isLoggedIn(),_=(0,o.VK)((()=>b.Z.state),[]),[R,O]=(0,n.useState)(!1),B=(0,o.VK)((()=>b.Z.canPersistToLocalStorage()),[]),D=!R&&A&&void 0===_&&Z&&("mac"===P||"windows"===P)&&F&&B,[L,V]=(0,n.useState)(!1),N=D&&L,E=(0,n.useRef)(!1);(0,n.useEffect)((()=>{D&&!E.current&&(async function(e,t){const s=await x.getDesktopAppRegistration(e,{os:t});return"data"in s&&s.data.isRegistered}(e,P).then((e=>{V(e)})),E.current=!0)}),[D,V,e,P]);const U=(0,r.D9)(N);(0,n.useEffect)((()=>{N&&!U&&f.wW(e)}),[N,U,e]);const W=(0,a.yK)((()=>({origin:{position:"fixed",left:"50%",top:"100%"},container:{bottom:20,padding:"8px 12px 12px",minWidth:300},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},headerText:{fontSize:14,fontWeight:h.Z.fontWeight.medium},appDownloadButton:{fontSize:14,marginLeft:-5},appDownloadIcon:{width:14,height:14,marginRight:6},actions:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},alwaysOpenLinks:{display:"flex",alignItems:"center"},alwaysOpenLinksLabel:{marginLeft:6},alwaysOpenLinksButton:{paddingLeft:12,paddingRight:12,height:34,marginLeft:12}})),[]);return(0,d.jsx)(w.ZP,{popupType:w.kQ.Popup,placementToOrigin:v.u.Bottom,origin:(0,d.jsx)("div",{style:W.origin}),disableMouseCapture:!0,open:N,style:W.container,render:()=>(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{style:W.header,children:[(0,d.jsx)(I.Z,{style:W.headerText,children:(0,d.jsx)(g.FormattedMessage,{id:"openInDesktopAppPopup.header",defaultMessage:"Open in Notion's desktop app?"})}),(0,d.jsx)(j.Z,{ariaLabel:t.formatMessage({id:"openInDesktopAppPopup.closeButton",defaultMessage:"Dismiss"}),icon:u.D,onClick:()=>{b.Z.setState("never"),O(!0),f.Zy(e)}})]}),(0,d.jsx)(C.Z,{href:m.AR.desktop,external:!0,onClick:()=>{f.iD(e)},children:(0,d.jsxs)(T.Z,{style:W.appDownloadButton,children:[c(W.appDownloadIcon),(0,d.jsx)("span",{children:(0,d.jsx)(g.FormattedMessage,{id:"openInDesktopAppPopup.appDownloadButton",defaultMessage:"Don't have the app? Download"})})]})}),(0,d.jsxs)("div",{style:W.actions,children:[(0,d.jsxs)("div",{style:W.alwaysOpenLinks,children:[(0,d.jsx)(M.Z,{checked:s,size:16,onClick:()=>{l(!s)}}),(0,d.jsx)(I.Z,{isInline:!0,style:W.alwaysOpenLinksLabel,children:(0,d.jsx)(g.FormattedMessage,{id:"openInDesktopAppPopup.alwaysOpenLinksLabel",defaultMessage:"Always open in app",values:{strongtext:e=>(0,d.jsx)("strong",{children:e})}})})]}),(0,d.jsx)(k.Z,{style:W.alwaysOpenLinksButton,onClick:()=>{b.Z.setState(s?"always":"never"),O(!0),y.RX({url:(0,S.W)(window.location.href),environment:e}),f.LC(e,{always_open_in_app:s})},children:(0,d.jsx)(g.FormattedMessage,{id:"openInDesktopAppPopup.openInAppButton",defaultMessage:"Open in app",values:{strongtext:e=>(0,d.jsx)("strong",{children:e})}})})]})]})})}},73085:(e,t,s)=>{s.r(t),s.d(t,{default:()=>$});var n=s(67294),i=s(480),o=s(86628),a=s(9291),r=s(54564),l=s(47307),d=s(4617),c=s(13447),u=s(80444),p=s(56638),m=s(88923),g=s(26263),h=s(49085);class f extends h.default{getInitialState(){return{inMemoryRecordCache:new g.Z({name:"TemplateRecordCacheStore"})}}}var x=s(68785),y=s(40721),S=s(53437),v=s(45953),b=s(99405),M=s(21202),j=s(77420),C=s(23867),w=s(19889),k=s(70203),T=s(54642),I=s(61045),Z=s(95477),P=s(66213),F=s(23586),A=s(28020),_=s(88632),R=s(4548);class O extends h.default{getInitialState(){return{}}}const B=O;var D=s(82136),L=s(6258),V=s(88893),N=s(88280),E=s(53336),U=s(64369),W=s(81059),K=s(31192),z=s(3553),q=s(85893);const G=function(e){let{style:t,disabled:s,previewRootId:r,templateRecordCacheStore:l}=e;const d=(0,i.O7)(),c=(0,o.qz)(l,f),p=(0,o.qz)(void 0,B),m=(0,o.VK)((()=>_.Z.state),[]),g=(0,n.useCallback)(((e,n)=>(0,q.jsx)(Y,{err:e,store:n,style:t,disabled:s,pageTemplatePreviewStore:p})),[t,s,p]),h=(0,n.useCallback)((e=>async function(e,t,s){const n=await T.loadBlockSubtree(t,{block:{id:e,spaceId:(0,C.C)(void 0)},shallow:!1});if("failed"===n.type)throw n.error;const{currentSpaceStore:i}=u.default.state,o=N.subscriptionDataStoreInstance.state,{inMemoryRecordCache:a}=s.state;a.clearCache(),a.isTemplatePreview=!0;const r=new Set,l=new Set,d=v.PF.create(n.data.subtreeRecordMap);for(const u of d){const{pointer:e,model:s,role:n}=u;if(!n)return;if(a.setModelAndRole({pointer:e,userId:t.currentUser.id},s,"editor"),(null==s?void 0:s.table)===M.iU){const e=s.getProperties();for(const t of Object.keys(e)){const s=(0,k.lcG)(e[t]);for(const e of s)r.add(e);const n=(0,k.zyy)(e[t]);for(const e of n)l.add(e)}s.created_by_table&&s.created_by_id&&(s.created_by_table===w.KJ?r.add(s.created_by_id):l.add(s.created_by_id)),s.last_edited_by_table&&s.last_edited_by_id&&(s.last_edited_by_table===w.KJ?r.add(s.last_edited_by_id):l.add(s.last_edited_by_id))}}if(o)for(const u of(0,V.CM)(o))r.add(u.userId);const c=await Promise.all(Array.from(r).map((async e=>{if(i){const t=L.U6.createChildStore(i,{table:w.KJ,id:e});await t.load();return t.getValue()}{const s=await T.syncRecordValue(t,{pointer:{table:w.KJ,id:e},userId:t.currentUser.id,version:-1});return s&&s.value}})));for(const u of c)u&&a.setRecord({pointer:{table:w.KJ,id:u.id},userId:t.currentUser.id},{role:"reader",value:u});const p=await Promise.all(Array.from(l).map((async e=>{if(i){const t=(0,L.Kv)(i,{table:j.cZ,id:e,spaceId:i.id});await t.load();return t.getValue()}{const s=await T.syncRecordValue(t,{pointer:{table:j.cZ,id:e},userId:t.currentUser.id,version:-1});return s&&s.value}})));for(const u of p)u&&a.setRecord({pointer:{table:j.cZ,id:u.id,spaceId:u.space_id},userId:t.currentUser.id},{role:"reader",value:u});const{currentUserStore:m}=u.default.state;m&&(await m.load(),a.setRecord({pointer:m.pointer,userId:t.currentUser.id},{role:"editor",value:m.getValue()}));const g=new L.G(t,{table:M.iU,id:e},{inMemoryRecordCache:a});return g}(e,d,c)),[d,c]),x=(0,n.useCallback)((e=>function(e,t,s){const{device:n}=t,i=(0,b.Wj)({url:e,isMobile:n.isMobile,baseUrl:Z.default.domainBaseUrl,publicDomainName:Z.default.publicDomainName,protocol:Z.default.protocol,currentUrl:window.location.href});"page"===i.name&&(i.peekViewBlockId?s.setState({...s.state,navigatedRootId:i.peekViewBlockId}):s.setState({...s.state,navigatedRootId:i.blockId}))}(e,d,p)),[d,p]);return m.online?(0,q.jsx)(P.LF,{value:x,children:(0,q.jsx)(F.Z,{request:r,performRequest:h,render:g})}):(0,q.jsx)(P.LF,{value:x,children:(0,q.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",...t},children:(0,q.jsx)(U.Z,{isSmall:!0,children:(0,q.jsx)(a.FormattedMessage,{defaultMessage:"Please go online to view this template.",id:"pageTemplatePreview.offline.message"})})})})};function H(e){const{device:t}=e;return{flex:1,...t.isSafari&&{zIndex:1}}}function Y(e){let{store:t,style:s,disabled:n,pageTemplatePreviewStore:a}=e;const r=(0,i.O7)(),l=(0,o.qz)(a,B),{navigatedRootId:d}=(0,o.VK)((()=>l.state),[l]),c=(0,o.VK)((()=>t&&(0,A.Zy)({environment:r,store:t})),[r,t]);if(t&&c){let e;return e=d?L.G.createChildStore(t,{table:M.iU,id:d}):t,(0,q.jsx)("div",{style:s,children:(0,q.jsx)(z.Z,{store:e,isDefaultContainer:!0,droppable:!0,render:t=>{let{selectableEvents:s,selectableHoverMenuOverlay:i}=t;return(0,q.jsxs)(E.Z,{style:H(r),type:c,store:R.Z,preventType:I.Q7(r),...s,children:[i,(0,q.jsx)(K.ZP,{store:e,context:D.S.InAppTemplatePreview,paddingBottom:K.ZP.paddingBottom(r),disabled:n})]},e.id)}},e.id)})}return(0,q.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",...s},children:(0,q.jsx)(x.Z,{style:{width:W.T,height:W.T}})})}const Q={width:"100%",flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",overflow:"hidden"};const $=function(){const e=(0,i.O7)(),t=(0,o.qz)(void 0,f),s=(0,n.useCallback)((()=>se(e,t)),[e,t]),a=(0,n.useCallback)((()=>(0,q.jsx)(ne,{templateRecordCacheStore:t})),[t]),{device:r}=e,l=(0,o.VK)((()=>p.Z.state),[]),{currentSpaceViewStore:m}=(0,o.VK)((()=>u.default.state),[]);return(0,n.useEffect)((()=>{l.open&&m&&c.createAndCommit({userAction:"PageTemplateModal.willMountOrUpdate",environment:e,perform:e=>{d.GF({item:l.item,spaceViewStore:m,transaction:e})}})}),[m,e,l.item,l.open]),r.isMobile?(0,q.jsx)(S.GI,{open:l.open,render:a,forceFullScreenSlideUp:!0,onDismiss:s,popupType:S.GI.PopupType.SlideUp}):null};function J(){return new Promise(((e,t)=>{l.showDialog({message:(0,q.jsx)(a.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.prompt",defaultMessage:"It looks like you've modified the template. Would you like to save your edits?"}),showCancel:!1,keepFocus:!0,items:[{label:(0,q.jsx)(a.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.saveButton.label",defaultMessage:"Save edits"}),onAccept:()=>{e(!0)}},{label:(0,q.jsx)(a.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.discardEditsButton.label",defaultMessage:"Discard"}),color:"red",onAccept:()=>{e(!1)}}]})}))}function X(e){d.xv(e),r.LZ()}function ee(e){let{modalState:t,templateRecordCacheStore:s}=e;const n=(0,o.qz)(s,f);return(0,q.jsx)(G,{previewRootId:t.item.previewRootId,style:Q,templateRecordCacheStore:n,disabled:!0},t.item.previewRootId)}function te(e,t,s){const{inMemoryRecordCache:n}=s.state,i=p.Z.state,{currentSpaceViewStore:o,currentSpaceStore:a,mainEditorCurrentBlockStore:r}=u.default.state;if(i.open&&o&&a){const s=r&&r.isEmptyPage()?r:void 0,l=m.default.state.open&&m.default.state.target&&m.default.state.target.isEmptyPage()?m.default.state.target:void 0;d.RL({environment:t,item:i.item,spaceStore:a,spaceViewStore:o,useRecordCache:e?n:void 0,initializeStore:i.createNewPage?void 0:s||l,isPrivate:i.isPrivate,from:i.createNewPage?"sidebar":"newPage"})}}async function se(e,t){const{inMemoryRecordCache:s}=t.state;if(s.appliedTransaction){await J()?te(!0,e,t):X(e)}else X(e)}function ne(e){let{templateRecordCacheStore:t}=e;const s=(0,i.O7)(),r=(0,n.useCallback)((()=>async function(e,t){const{inMemoryRecordCache:s}=t.state;s.appliedTransaction?te(!!(await J()),e,t):te(!1,e,t)}(s,t)),[s,t]),l=(0,n.useCallback)((()=>se(s,t)),[s,t]),d=(0,o.VK)((()=>p.Z.state),[]);return d.open?(0,q.jsx)(y.default,{title:(0,q.jsx)(a.FormattedMessage,{defaultMessage:"Try this template",id:"pageTemplateModal.mobileModal.title"}),left:(0,q.jsx)(y.CancelMenuText,{}),onClickLeft:l,right:d.isLoading?(0,q.jsx)(x.Z,{}):(0,q.jsx)(a.FormattedMessage,{defaultMessage:"Use",id:"pageTemplateModal.mobileModal.useButton.label"}),onClickRight:r,forceFullScreenSlideUp:!0,children:(0,q.jsx)(ee,{templateRecordCacheStore:t,modalState:d})}):null}},57806:(e,t,s)=>{s.r(t),s.d(t,{PermissionsInviteBase:()=>_,default:()=>R});s(67294);var n=s(83355),i=s(94044),o=s(9291),a=s(31701),r=s(53965),l=s(91219),d=s(95209),c=s(43250),u=s(60709),p=s(45101),m=s(65598),g=s(18514),h=s(48779),f=s(95697),x=s(18245),y=s(85834),S=s(1903),v=s(29677),b=s(6258),M=s(81023),j=s(35057),C=s(78140),w=s(40721),k=s(72495),T=s(83182),I=s(7567),Z=s(44385),P=s(24145),F=s(43579),A=s(85893);class _ extends n.Z{constructor(){super(...arguments),this.renderInShareMenu=this.createComputedStore((()=>Boolean(this.props.renderInShareMenu&&!this.environment.device.isMobile))),this.inviteOrigin=this.createComputedStore((()=>this.props.inviteOrigin?this.props.inviteOrigin:this.props.store instanceof b.G?"page_share_modal":"space_share_modal")),this.defaultRoleForSpaceBot=this.createComputedStore((()=>"editor")),this.defaultRoleForNonBot=this.createComputedStore((()=>{const{store:e,isSubscribed:t}=this.props;return p.xT({environment:this.environment,store:e,isSubscribed:t})})),this.inputDebounce=void 0,this.storeTypes={permissionsInviteStore:S.Z,contextualInviteStore:y.ZP},this.handleModalDismiss=async()=>{await d.kL({environment:this.environment,permissionsInviteStore:this.stores.permissionsInviteStore,from:"share_menu"})},this.handleInputChange=async e=>{var t;null===(t=this.inputDebounce)||void 0===t||t.cancel(),this.inputDebounce=r.Ds((()=>{l.UW(this.environment,{invite_flow_id:this.stores.permissionsInviteStore.state.flowId,subscription_tier:(0,j.zt)(),invite_origin:this.inviteOrigin.state})}),1e3),this.inputDebounce(),await d.jC({environment:this.environment,event:e,permissionsInviteStore:this.stores.permissionsInviteStore})},this.handleClickRemoveToken=e=>{d.PV({targetToRemove:e,permissionsInviteStore:this.stores.permissionsInviteStore,defaultRoleForNonBot:this.defaultRoleForNonBot.state})}}async UNSAFE_willMount(){await M.bi(this.environment)}willUnmount(){var e;null===(e=this.inputDebounce)||void 0===e||e.flush()}renderComponent(){if(this.renderInShareMenu.state)return this.renderComponentInShareMenu();const e=this.renderHeader(),t=this.renderSearchRequest();return this.renderComponentOriginal(e,t)}renderHeader(){const{permissionsInviteStore:e}=this.stores,{device:t}=this.environment;return(0,A.jsx)(P.Z,{permissionsInviteStore:e,store:this.props.store,handleClickRemoveToken:e=>{this.handleClickRemoveToken(e)},handleInputChange:async e=>{await this.handleInputChange(e)},handleInputSubmit:async()=>{await this.handleInviteInputSubmit()},origin:Boolean(this.renderInShareMenu.state)?"share_menu":"share_modal",defaultRoleForNonBot:this.defaultRoleForNonBot.state,isTeamsEnabled:(0,f.bq)(),right:!t.isMobile&&this.renderDesktopInputRightInner(),focus:"invitee"===e.state.inputFocus||"invitee-popup-closed"===e.state.inputFocus,handleFocus:()=>{t.isMobile||e.setState({...e.state,inputFocus:"invitee"})}})}renderSearchRequest(){const{permissionsInviteStore:e}=this.stores,t=(0,m.OY)(this.props.store),s=(0,m.OY)(this.props.store),n=this.props.store instanceof b.G&&(0,h.Q6)(this.props.store.getSpaceStore());return(0,A.jsx)(F.Z,{permissionsInviteStore:e,store:this.props.store,defaultRoleForSpaceBot:this.defaultRoleForSpaceBot.state,shouldShowBots:t,shouldShowGroups:s,sectionRenderLimit:this.renderInShareMenu.state?5:10,membersOnly:this.props.membersOnly,guestsMustBeRequested:n})}renderComponentOriginal(e,t){const{device:s}=this.environment;let n;return n=s.isMobile?{menuType:u.og.Modal,title:(0,m.Mm)(this.props.store)?(0,A.jsx)(o.FormattedMessage,{id:"inviteUserModal.addMemberMenu.title",defaultMessage:"Add members"}):(0,A.jsx)(o.FormattedMessage,{id:"inviteUserModal.invitePersonMenu.title",defaultMessage:"Invite a person"}),right:(0,A.jsx)("div",{style:{color:a.ZP.blue},children:(0,A.jsx)(o.FormattedMessage,{id:"inviteUserModal.mobile.inviteButton.label",defaultMessage:"Invite"})}),left:(0,A.jsx)(w.CancelMenuText,{}),onClickLeft:this.handleModalDismiss,onClickRight:async()=>{await this.handleInviteClick()},header:e}:{menuType:u.og.Popup,width:480,height:"60vh",header:e,tokenInputHeader:!0,footer:this.renderHelpButton(),disableScroller:!1},(0,A.jsxs)(C.Z,{...n,className:c.FJA,children:[s.isMobile&&(0,A.jsx)(k.Z,{title:(0,A.jsx)(o.FormattedMessage,{id:"inviteUserModal.permissionLevel.title",defaultMessage:"Permission level"}),children:this.renderDesktopInputRightInnerSelect()}),(0,A.jsx)("div",{children:t}),s.isMobile&&this.renderHelpButton()]})}renderHelpButton(){return this.renderInShareMenu.state?null:(0,A.jsx)(k.Z,{topBorder:!0,disableDesktopPadding:!0,children:(0,A.jsx)(T.Z,{title:(0,A.jsx)(o.FormattedMessage,{id:"inviteUserModal.helpButton.caption",defaultMessage:"Learn how to invite people and set permissions"}),href:(0,g.UY)("guides.invitePerson"),analyticsFrom:"invite_person"})})}renderDesktopInputRightInner(){return(0,A.jsxs)("div",{style:{marginLeft:i.p_,display:"flex",alignItems:"center"},children:[this.renderDesktopInputRightInnerSelect(),!this.renderInShareMenu.state&&this.renderDesktopInputRightInnerButton({isLarge:!0})]})}renderDesktopInputRightInnerButton(e){const{isLarge:t}=e;return(0,A.jsx)(Z.Z,{store:this.props.store,permissionsInviteStore:this.stores.permissionsInviteStore,handleUpgradeClick:()=>{return e=this.props.upgradeButtonName,t=this.environment,s=this.props.onUpgradeButtonClick,void d.Vu({environment:t,upgradeButtonName:e,onUpgradeButtonClick:s});var e,t,s},handleInviteClick:()=>this.handleInviteClick(),disabled:this.props.disabled,isLarge:t})}renderDesktopInputRightInnerSelect(){const{device:e}=this.environment,{store:t}=this.props,{permissionsInviteStore:s}=this.stores;if(s.state.isInviteTargetsEmpty||!(0,v.ow)(s.state))return(0,A.jsx)(I.ZP,{disabled:(0,m.Mm)(t)&&!t.canAdmin(),role:s.state.inviteRole,table:s.state.table,type:"user_permission",blockType:(0,m.OY)(t)?t.getType():void 0,isInvite:!0,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,buttonStyle:{display:"flex",whiteSpace:"nowrap",height:26,color:a.ZP.uiGray,...this.renderInShareMenu.state&&{marginTop:e.isMobile?4:s.state.isInviteTargetsEmpty?1:6,marginBottom:e.isMobile?4:s.state.isInviteTargetsEmpty?1:6,marginRight:0}},isMenuItem:e.isMobile,onChange:e=>{d.XC({environment:this.environment,newRole:e,permissionsInviteStore:this.stores.permissionsInviteStore})}})}renderComponentInShareMenu(){const e={menuType:u.og.Popup,header:(0,A.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"top",marginLeft:12,marginRight:12,gap:10},children:[this.renderHeader(),this.renderDesktopInputRightInnerButton({isLarge:!0})]}),footer:this.renderHelpButton(),disableScroller:!1};return(0,A.jsx)("div",{style:{paddingTop:14,paddingBottom:14,paddingLeft:2,paddingRight:2},children:(0,A.jsx)(C.Z,{...e,children:this.renderSearchRequest()})})}async handleInviteInputSubmit(){await this.handleInviteClick()}async handleInviteClick(){const e=x.default.mark("share_menu.invite_user_lag");await d.qg({environment:this.environment,store:this.props.store,sudoModeStore:this.props.sudoModeStore,permissionsInviteStore:this.stores.permissionsInviteStore,contextualInviteStore:this.stores.contextualInviteStore,onInviteClick:this.props.onInviteClick,onInviteComplete:this.props.onInviteComplete,inviteOrigin:this.inviteOrigin.state,intl:this.props.intl}),x.default.measure(e,{environment:this.environment})}}_.displayName="PermissionsInviteBase";const R=(0,o.injectIntl)(_)},44385:(e,t,s)=>{s.d(t,{Z:()=>x,e:()=>f});s(67294);var n=s(86628),i=s(94044),o=s(9291),a=s(46654),r=s(45101),l=s(65598),d=s(26781),c=s(4023),u=s(35057),p=s(88280),m=s(58297),g=s(26388),h=s(85893);function f(){const e=(0,n.VK)((()=>(0,u.c4)(p.subscriptionDataStoreInstance.state)),[]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{children:(0,h.jsx)(o.FormattedMessage,{id:"inviteUserButton.modalTooltip.guestLimitLine1",defaultMessage:"Your plan allows up to {guestLimit} unique guests.",values:{guestLimit:e}})}),(0,h.jsx)("div",{children:(0,h.jsx)(o.FormattedMessage,{id:"inviteUserButton.modalTooltip.guestLimitLine2",defaultMessage:"Upgrade to go unlimited."})})]})}const x=function(e){const{store:t,permissionsInviteStore:s,handleUpgradeClick:u,handleInviteClick:x,isLarge:y}=e,[S]=(0,n.AF)(s),v=(0,n.VK)((()=>S.inviteTargets.some((e=>r.OA(e)))),[S]),b=(0,d.S)(t),M=(0,n.VK)((()=>{const e=S.inviteTargets,s=e.filter((e=>{let{type:t}=e;return"newUser"===t})).map((e=>{let{value:t}=e;return t.email})),n=e.filter((e=>{let{type:t}=e;return"existingUser"===t})).map((e=>{let{value:t}=e;return t.id}));return!(0,l.Mm)(t)&&a.Xu({subscriptionData:p.subscriptionDataStoreInstance.state,newGuestIds:[...s,...n]})}),[S,t]),j=v?b:void 0;return(0,h.jsx)(g.ZP,{alignment:c.v.Center,disableTooltip:!(M||j),renderTooltip:()=>M?(0,h.jsx)(f,{}):j,render:e=>(0,h.jsx)(m.Z,{isLarge:y,style:{minWidth:i.UF},disabled:Boolean(j),onClick:M?u:x,...e,children:M?(0,h.jsx)(o.FormattedMessage,{id:"inviteUserModal.inviteButton.upgradeLabel",defaultMessage:"Upgrade"}):(0,h.jsx)(o.FormattedMessage,{id:"inviteUserModal.inviteButton.label",defaultMessage:"Invite"})})})}},13904:(e,t,s)=>{s.r(t),s.d(t,{default:()=>N});var n=s(67294),i=s(83355),o=s(480),a=s(41892),r=s(9291),l=s(91536),d=s(45101),c=s(65598),u=s(1903),p=s(81023),m=s(44041),g=s(35057),h=s(88280),f=s(31945),x=s(9019),y=s(53437),S=s(58297),v=s(26388),b=s(57806),M=s(95691),j=s(86628),C=s(24405),w=s(84169),k=s(60709),T=s(18514),I=s(77907),Z=s(29798),P=s(51077),F=s(16354),A=s(78140),_=s(32163),R=s(89728),O=s(72495),B=s(85893);function D(e){const{onInviteClick:t,onInviteComplete:s}=e,i=(0,j.qz)(void 0,Z.Z),o=(0,C.yK)((e=>({InviteDropdownMenu:{background:e.cardContentBackground,width:265,borderRadius:8},slackTitle:{display:"flex",fontSize:14,color:e.text.primary},integrationIcon:{marginRight:8},slackButtonContainer:{padding:"0 6px",alignItems:"center"},slackButton:{height:28,borderRadius:4,border:void 0,width:"100%"},helpIcon:{width:16,height:16,fill:e.icon.secondary},helpSection:{color:e.text.secondary,fontSize:12,padding:"0 8px",width:"100%"}})),[]),l=(0,n.useMemo)((()=>(0,B.jsxs)("div",{style:o.slackTitle,children:[(0,B.jsx)(P.Z,{type:"image_url",imageURL:a.Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:o.integrationIcon}),(0,B.jsx)(r.FormattedMessage,{defaultMessage:"Slack",id:"spacePermissionsSettings.inviteLinkRefreshModal.inviteDropdownMenu.slackButtonLabel"})]})),[o]),d={key:"all_import_sections",render:e=>(0,B.jsx)(O.Z,{...e,title:(0,B.jsx)(r.FormattedMessage,{id:"spacePermissionsSettings.inviteLinkRefreshModal.inviteDropdownMenu.title",defaultMessage:"Import from"})}),items:[{key:"slack_imports",render:e=>(0,B.jsx)(I.LazySlackImportsInviteWithModal,{inviteOrigin:"space_setting_slack_dropdown",canEditPermission:!0,onInviteClick:t,onInviteComplete:s,slackButtonLabel:l,slackButtonStyle:o.slackButton,slackButtonContainerStyle:o.slackButtonContainer}),action:()=>{}}]},c={key:"help_section",render:e=>(0,B.jsx)(O.Z,{...e,topBorder:!0}),items:[{key:"help_section",render:e=>u,action:()=>{}}]},u=(0,B.jsx)(F.Z,{style:{display:"flex",padding:"0 4px"},className:"notion-print-ignore",href:(0,T.UY)("guides.publicAPI"),external:!0,children:(0,B.jsx)(R.Z,{icon:w.m,iconStyle:o.helpIcon,style:o.helpSection,children:(0,B.jsx)(r.FormattedMessage,{id:"spacePermissionsSettings.inviteLinkRefreshModal.inviteDropdownMenu.learnMore",defaultMessage:"Learn more"})})});return(0,B.jsx)(A.Z,{menuType:k.og.Popup,children:(0,B.jsx)(_.Z,{type:_.i.Vertical,store:i,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,sections:[d,c],style:o.InviteDropdownMenu})})}var L=s(60442);class V extends i.Z{constructor(){super(...arguments),this.storeTypes={permissionsInviteStore:u.Z},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderOverlay=()=>(0,B.jsx)(b.default,{...this.props,store:this.props.store,sudoModeStore:this.props.sudoModeStore,disabled:this.props.disabled,isSubscribed:this.props.isSubscribed,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,shouldGrow:this.props.shouldGrow,membersOnly:this.props.membersOnly,onInviteClick:this.props.onInviteClick,onInviteComplete:this.props.onInviteComplete,buttonStyle:this.props.buttonStyle,permissionsInviteStore:this.stores.permissionsInviteStore,inviteOrigin:this.props.analyticsFrom}),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleButtonClick=()=>U(this.environment,this.props.store,this.props.isSubscribed,this.stores.permissionsInviteStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleModalDismiss=()=>async function(e,t,s,n){await(0,d.Aw)({environment:e,permissionsInviteStoreState:s.state,from:n??((0,c.Mm)(t)?"space_share_modal":"page_share_modal")})||s.reset()}(this.environment,this.props.store,this.stores.permissionsInviteStore,this.props.analyticsFrom)}async UNSAFE_willMount(){await p.bi(this.environment)}renderComponent(){const{store:e,origin:t}=this.props,{modalOpen:s}=this.stores.permissionsInviteStore.state;let n,i,o=!1;return e.canEditMembership()?e.canEditMembership()&&(0,c.Mm)(e)&&h.subscriptionDataStoreInstance.state&&!g.Mk()?(n=!1,o=!0,i=(0,B.jsx)(L.Z,{imageURL:a.Z.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:(0,B.jsx)(r.FormattedMessage,{defaultMessage:"Members are teammates you invite to your workspace. They can access and add pages for all members to see, or be added to pages with permissions for private collaboration.",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.caption"}),title:(0,B.jsx)(r.FormattedMessage,{defaultMessage:"Upgrade to add members",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.title"})})):n=!0:(n=!1,i=(0,c.Mm)(e)?(0,B.jsx)(r.FormattedMessage,{id:"inviteUserButton.tooltip.adminsOnlyMessage",defaultMessage:"Only admins can add members."}):(0,B.jsx)(r.FormattedMessage,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."})),(0,B.jsx)("div",{children:(0,c.Mm)(e)?(0,B.jsx)(x.Z,{open:s,onDismiss:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleModalDismiss,renderContent:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderOverlay,origin:(0,B.jsx)(v.ZP,{renderTooltip:()=>i,disableTooltip:n,render:e=>(0,B.jsx)(W,{store:this.props.store,isSubscribed:this.props.isSubscribed,enableInviteDropdown:this.props.enableInviteDropdown,onInviteClick:this.props.onInviteClick,upgradeButtonName:this.props.upgradeButtonName,onUpgradeButtonClick:this.props.onUpgradeButtonClick,shouldGrow:this.props.shouldGrow,buttonStyle:this.props.buttonStyle,permissionsInviteStore:this.stores.permissionsInviteStore,tooltipEvents:e,showUpgrade:o,actionEnabled:n,buttonInner:t})})}):(0,B.jsx)(x.Z,{open:s,onDismiss:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleModalDismiss,renderContent:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderOverlay,origin:null})})}}V.displayName="PermissionsInviteWithModal";const N=(0,r.injectIntl)(V);function E(e,t,s){m.y(t,{from:e,for:"plus"}),s&&s(),l.L7(t,{type:"upgrade"})}function U(e,t,s,n){(0,d.z5)({environment:e,permissionsInviteStore:n,store:t,renderInShareModal:!1,isSubscribed:s}),l.L7(e,{type:"invite"})}function W(e){let{tooltipEvents:t,showUpgrade:s,actionEnabled:i,store:a,isSubscribed:l,enableInviteDropdown:d,onInviteClick:c,upgradeButtonName:u,onUpgradeButtonClick:p,shouldGrow:m,buttonStyle:g,permissionsInviteStore:h,buttonInner:x}=e;const v=(0,o.O7)(),b=(0,n.useCallback)((()=>U(v,a,l,h)),[v,a,l,h]);return x?(0,B.jsx)("div",{onClick:b,children:x}):d?(0,B.jsx)(f.ZP,{popupType:y.kQ.Popup,alignmentToOrigin:f.vR.End,placementToOrigin:f.pO.Bottom,render:e=>(0,B.jsx)(D,{onInviteClick:c}),originGap:12,renderOrigin:e=>(0,B.jsx)(M.Z,{onClick:s?()=>E(u,v,p):b,disabled:!i&&!s,style:{flex:m?1:0,...g},title:(0,B.jsx)(r.FormattedMessage,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"}),dropdownEvents:e,color:"blue",...t})}):(0,B.jsx)(S.Z,{isLarge:!0,onClick:s?()=>E(u,v,p):b,disabled:!i&&!s,style:{flex:m?1:0,...g},...t,children:(0,B.jsx)(r.FormattedMessage,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"})})}},35229:(e,t,s)=>{s.d(t,{Z:()=>q});s(57658);var n=s(67294),i=s(83355),o=s(49085),a=s(66897),r=s(19889),l=s(70203),d=s(9291),c=s(53965),u=s(1898),p=s(23586),m=s(60709),g=s(77907),h=s(480),f=s(86628),x=s(24405),y=s(33728),S=s(47612),v=s(10020),b=s(81918),M=s(49068),j=s(52275),C=s(31945),w=s(96525),k=s(43765),T=s(72495),I=s(80444),Z=s(77080),P=s(55899),F=s(35057),A=s(22508),_=s(13394),R=s(7314),O=s(85893);function B(e){const t=(0,f.qz)(void 0,P.ZP),s=(0,f.qz)(void 0,_.Z),{store:i,inputValue:o,intl:a,propertySchemaLimit:l,isLoading:c,handlePersonPropertyMenuChange:u}=e,p=(0,h.O7)(),m=(0,x.yK)((e=>({moreBarTitleStyle:{color:e.text.secondary,fontSize:11},inviteIconStyle:{width:20,height:20,fill:e.icon.primary},rightIconStyle:{width:20,height:20,fill:e.icon.secondary},desktopTitleStyle:{color:e.text.secondary,fontSize:11},messageBodyStyle:{color:e.text.tertiary,paddingLeft:2},messageTitleStyle:{color:e.text.tertiary},inviteBodyStyle:{color:e.text.primary}})),[]),{isMobile:g}=(0,h.Fy)(),B=(0,f.VK)((()=>{var e;return null===(e=I.default.state.currentSpaceStore)||void 0===e?void 0:e.getName()}),[]),D=(0,f.VK)((()=>s.state.flowId),[s]),{email:L,isEmail:V,inviteButtonTitle:N}=(0,n.useMemo)((()=>{const e=(0,y.H3)(o),t=(0,y.oH)(e),s=a.formatMessage({id:"invite.person_property.button.invite_people",defaultMessage:"Invite people"}),n=a.formatMessage({id:"invite.person_property.button.invite_email",defaultMessage:"Invite ”{email}”"},{email:e});return{email:e,isEmail:t,inviteButtonTitle:t?n:s}}),[o,a]),E=(0,n.useCallback)((()=>{V&&L&&A.Co({email:L,inviteTargetsStore:t}),b.P0(p,{origin:"person_property_invite",invite_flow_id:D})}),[V,D,L,p,t]),U=(0,n.useCallback)((()=>{b.Zv(p,{origin:"person_property_invite",invite_flow_id:D})}),[D,p]);return(0,f.VK)((()=>{const e=function(e){const{canAddPermissions:t,isMobile:s}=e,n="enterprise"===e.subscriptionTier;if(s||n||!t)return!1;return"on"===Z.default.getEligibleGroup({experimentId:"acq_person_property_invite_v1",defaultGroup:"control"})}({canAddPermissions:i.canEditMembership(),isMobile:g,subscriptionTier:(0,F.zt)()});return e&&b.x8(p,{origin:"person_property_invite",invite_flow_id:D}),e}),[i,D,g,p])?(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(T.Z,{title:(0,O.jsx)(d.FormattedMessage,{defaultMessage:"People",id:"database.personPropertyValue.selectPerson.noSearchResults.resultsTitle"}),desktopTitleStyle:m.desktopTitleStyle,loading:c,desktopStyle:{paddingBottom:4},children:(0,O.jsx)(k.Z,{title:(0,O.jsx)("span",{style:m.messageBodyStyle,children:(0,O.jsx)(d.FormattedMessage,{defaultMessage:"No matches in {spaceName}",id:"database.personPropertyMenu.noSearchResults.messageWithSpaceName",values:{spaceName:B}})}),titleStyle:m.messageTitleStyle})}),(0,O.jsx)(T.Z,{title:(0,O.jsx)(d.FormattedMessage,{defaultMessage:"More",id:"database.personPropertyValue.selectPerson.noSearchResults.suggestionTitle"}),desktopTitleStyle:m.moreBarTitleStyle,topBorder:!0,desktopStyle:{marginTop:0,paddingTop:10},children:(0,O.jsx)(w.Z,{focused:!1,stopClickPropagation:!0,popupType:C.Z4.Popup,renderOrigin:e=>(0,O.jsx)(j.Z,{...e,focused:!1,icon:(0,S.C)(m.inviteIconStyle),title:N,right:(0,v.C)(m.rightIconStyle),textWrapperStyle:m.inviteBodyStyle}),onClick:E,onClose:U,borderRadius:8,render:e=>(0,O.jsx)(R.Z,{inviteOrigin:"person_property_invite",store:i,handleBackButtonClick:()=>e.close(),inviteTargetsStore:t,personPropertyInviteStore:s,onInviteCompleteFn:t=>{e.close();const s=(t.success?Object.values(t.invitedUsers):[]).map((e=>({table:r.KJ,id:e})));u(s)}})})})]}):(0,O.jsx)(T.Z,{title:(0,M.$)(l),loading:c,children:(0,O.jsx)(k.Z,{title:(0,O.jsx)(d.FormattedMessage,{defaultMessage:"No results",id:"database.personPropertyMenu.noSearchResults.message"})})})}var D=s(69582),L=s(78140),V=s(32163),N=s(40721),E=s(92864),U=s(47082),W=s(97680);const K=(0,d.defineMessages)({searchForPerson:{defaultMessage:"Search for a person…",id:"database.personPropertyValue.searchPlaceholder"}});class z extends i.Z{constructor(){super(...arguments),this.inputValue=o.default.createValue(""),this.handlePersonPropertyMenuChange=e=>{const{schema:t,property:s}=this.props,n=t[s];if(!n||"person"!==n.type)return;let i;i=1===n.limit?e.length>0?[e[e.length-1]]:[]:e,this.props.onChange({value:i}),this.inputValue.setState("")}}UNSAFE_willMount(e){super.UNSAFE_willMount(e),e.insertChar&&this.inputValue.setState(e.insertChar)}renderComponent(){const{device:e}=this.environment,{disabled:t,intl:s,schema:i,property:o,isTemplatePage:h}=this.props,f=i[o];if(!f||"person"!==f.type)return;const x=[],y=this.props.value.map((s=>{if((0,l.D4X)(s))return x.push(s),(0,O.jsx)(D.w,{templateVariableType:s,showRemoveButton:!t,onRemove:()=>{const e=this.props.value.filter((e=>(0,a.Wk)(e)));this.props.onChange({value:e})},style:{margin:"0px 6px 6px 0px"}},s);if((0,a.Wk)(s)){const n=(0,a.Hl)({pointer:s,getRecordValue:this.props.parentStore.getRecordValue});return(0,O.jsx)(E.ZP,{actor:n,format:e.isMobile?E.ZP.Format.Large:E.ZP.Format.Medium,showRemoveButton:!t,onClickRemove:()=>{const e=this.props.value.filter((e=>(0,l.D4X)(e)||(0,a.Wk)(e)&&e.id!==s.id));this.props.onChange({value:e})},shouldShrink:!0,isSingle:!1},s.id)}(0,u.t1)(s)})),S=l.s8k.filter((e=>!x.includes(e))),v={request:{query:this.inputValue.state,actors:c.hX(this.props.value,a.Wk)},performRequest:async e=>{let{query:t,actors:s}=e;const n=await g.deps.searchActions.loader(),{users:i}=await n.searchSpaceActors({environment:this.environment,query:t,membersOnly:!1});return{users:i.filter((e=>!s.some((t=>t.id===e.id)))).slice(0,20)}},render:(e,t,n)=>{if(e)return(0,O.jsx)(T.Z,{title:(0,M.$)(f.limit),loading:!n,children:(0,O.jsx)(k.Z,{title:(0,O.jsx)(d.FormattedMessage,{defaultMessage:"Something went wrong.",id:"database.personPropertyMenu.searchErrorMessage"})})});if(t&&0===t.users.length)return(0,O.jsx)(B,{store:this.props.parentStore,inputValue:this.inputValue.state,intl:s,propertySchemaLimit:f.limit,isLoading:!n,handlePersonPropertyMenuChange:e=>{this.handlePersonPropertyMenuChange([...this.props.value,...e])}});const i=c.oA((t&&t.users||[]).map((e=>({key:e.id,render:t=>(0,O.jsx)(W.Z,{...t,actor:(0,a.dp)(e)}),action:()=>{this.handlePersonPropertyMenuChange([...this.props.value,{table:r.KJ,id:e.id}])}})))),o=c.oA([i.length>0?{key:"person section",render:e=>(0,O.jsx)(T.Z,{...e,title:(0,M.$)(f.limit),loading:!n}),items:i}:void 0]);return(0,O.jsx)(V.Z,{type:V.i.Vertical,initialFocus:this.inputValue.state.length>0?0:void 0,sections:o})}},b=(0,O.jsx)(U.Z,{focus:!e.isMobile||void 0,focusAfterAnimation:!0,format:U.U.Person,tokens:y,placeholder:s.formatMessage(K.searchForPerson),hideInput:t,onRemoveLastToken:()=>{this.props.onChange({value:this.props.value.slice(0,this.props.value.length-1)})},value:this.inputValue.state,onChange:e=>this.inputValue.setState(e.target.value),dontShowBorderBottom:e.isAndroid});let C;return C=e.isMobile?{menuType:m.og.Modal,title:f.name,right:(0,O.jsx)(N.DoneMenuText,{}),onClickRight:this.props.onDismiss,header:b}:{menuType:m.og.Popup,header:b,tokenInputHeader:!0,maxHeight:333},t?(0,O.jsx)(L.Z,{...C}):(0,O.jsxs)(L.Z,{...C,children:[h&&(0,O.jsx)(T.Z,{title:(0,O.jsx)(d.FormattedMessage,{defaultMessage:"Shortcuts",id:"PersonPropertyMenu.menuItem.shortcuts.label"}),children:S.length>0?(0,O.jsx)(n.Fragment,{children:S.map((e=>(0,O.jsx)(j.Z,{focused:!1,title:(0,O.jsx)(D.w,{templateVariableType:e}),caption:(0,l.Z08)(e,s),inline:!0,onClick:()=>{this.handlePersonPropertyMenuChange([...this.props.value,e])}},`relative-person-shortcut-${e}`)))}):(0,O.jsx)(k.Z,{title:(0,O.jsx)(d.FormattedMessage,{id:"database.personPropertyMenu.noShorcuts.message",defaultMessage:"No shortcuts"})})}),(0,O.jsx)(p.Z,{...v})]})}}z.displayName="PersonPropertyMenu";const q=(0,d.injectIntl)(z)},3072:(e,t,s)=>{s.d(t,{Z:()=>b});s(57658),s(67294);var n=s(480),i=s(2032),o=s(9291),a=s(53965),r=s(47853),l=s(16187),d=s(60709),c=s(98742),u=s(52275),p=s(78140),m=s(32163),g=s(40721),h=s(53437),f=s(72495),x=s(26388),y=s(42782),S=s(85893);const v=(0,o.defineMessages)({noneText:{defaultMessage:"None",id:"database.propertyAggregationMenu.noneText"}});const b=(0,o.injectIntl)((function(e){let{onClose:t,property:s,schema:a,currentAggregation:r,source:l,noneText:c,intl:h,onChange:x}=e;const y=(0,n.O7)(),{device:b}=y;let M;M=b.isMobile?{menuType:d.og.Modal,title:(0,S.jsx)(o.FormattedMessage,{defaultMessage:"Table aggregation",id:"database.mobilePropertyAggregationMenu.title"}),right:(0,S.jsx)(g.DoneMenuText,{}),onClickRight:t}:{menuType:d.og.Popup,width:200};const[w,k]=function(e,t,s,n,o,a,r,l){const d=[],c=t[e];if(!c)return[[],void 0];let p;d.push({key:"none",render:e=>(0,S.jsx)(u.Z,{...e,title:l||n.formatMessage(v.noneText)}),action:()=>o(void 0)});for(const u of i.o5)d.push(j(u,o)),r===u&&(p=d.length-1);if((0,i.iV)(c))for(const u of i.Sy){const e=j(u,o);if("show_unique"===u)switch(s){case"tableAggregation":continue;case"rollupPropertyMenu":d.splice(1,0,e);continue}d.push(e),r===u&&(p=d.length-1)}if((0,i.O4)(c))for(const u of i.k$)d.push(j(u,o)),r===u&&(p=d.length-1);if((0,i.dN)(c))for(const u of i.f8)d.push(j(u,o)),r===u&&(p=d.length-1);if((0,i.Mv)(c))for(const u of i.gC)d.push(j(u,o)),r===u&&(p=d.length-1);if((0,i.Ei)(c))for(const u of i.OK)d.push(C(e,u,r,t,o,a)),"object"==typeof r&&"operator"in r&&r.operator===u&&(p=d.length-1);if((0,i.FN)(c))for(const u of i.tD)d.push(j(u,o)),r===u&&(p=d.length-1);return[d,p]}(s,a,l,h,x,y,r,c);return(0,S.jsx)(p.Z,{...M,children:(0,S.jsx)(m.Z,{type:m.i.Vertical,initialFocus:k??0,sections:[{key:0,render:e=>(0,S.jsx)(f.Z,{...e}),items:w}],onAccept:t})})}));function M(e){let{aggregationType:t,label:s,props:n}=e;const i=l.Sn[t];return(0,S.jsx)(x.ZP,{placement:h.GI.Placement.Right,delayThreshold:0,render:e=>(0,S.jsx)(u.Z,{title:s,...(0,c.Z)(e,n)}),renderTooltip:()=>(0,S.jsxs)("div",{style:{width:140,whiteSpace:"normal"},children:[i&&(0,S.jsx)("img",{src:(0,r.D)(i),style:{borderRadius:4,width:140,marginTop:4}}),l.BG[t]]})},n.key)}function j(e,t){const s=l.VN[e],n=l.Sn[e];return{key:s,render:t=>(0,S.jsx)(x.ZP,{placement:h.GI.Placement.Right,delayThreshold:0,render:e=>(0,S.jsx)(u.Z,{title:s,...(0,c.Z)(e,t)}),renderTooltip:()=>(0,S.jsxs)("div",{style:{width:140,whiteSpace:"normal"},children:[n&&(0,S.jsx)("img",{src:(0,r.D)(n),style:{borderRadius:4,width:140,marginTop:4}}),l.BG[e]]})},t.key),action:()=>{t(e)}}}function C(e,t,s,n,i,o){const{device:r}=o,c=l.VN[t],h=a.oA(function(e,t,s,n){const i=s[e];if(!i||"status"!==i.type)return;const o=i.groups;return o?o.map((e=>({key:`${t}${e.name}`,render:s=>(0,S.jsx)(M,{aggregationType:t,label:e.name,props:s}),action:()=>{n({operator:t,groupName:e.name})}}))):void 0}(e,t,n,i));let x=0;if("object"==typeof s&&"operator"in s&&s.operator===t){const e=s.groupName,n=h.findIndex((s=>s.key===`${t}${e}`));-1!==n&&(x=n)}return{key:t,render:(e,t)=>(0,S.jsx)(y.Z,{...e,onFocus:t.onFocus,renderOrigin:e=>(0,S.jsx)(u.Z,{...e,title:c}),renderExtension:(e,s)=>{let n;return n=r.isMobile?{menuType:d.og.Modal,title:c,right:(0,S.jsx)(g.DoneMenuText,{}),onClickRight:s.close,...e}:{menuType:d.og.Popup,width:200,...e},(0,S.jsx)(p.Z,{...n,children:(0,S.jsx)(m.Z,{type:m.i.Vertical,initialFocus:x,sections:[{key:"groups",render:e=>(0,S.jsx)(f.Z,{...e}),items:h}],onAccept:t.onAccept})})}}),action:()=>null}}},86326:(e,t,s)=>{s.r(t),s.d(t,{default:()=>ae});var n=s(67294),i=s(480),o=s(86628),a=s(15145),r=s(86658),l=s(15769),d=s(88437),c=s(43876),u=s(27714),p=s(45238),m=s(85893);const g=(0,p.IU)("loginArrow",{viewBox:"0 0 16 12",svg:(0,m.jsx)("path",{d:"M8.65 11.116a.615.615 0 00.444-.184l4.546-4.54a.66.66 0 00.205-.39v4.526c0 .349.253.588.608.588.356 0 .615-.239.615-.588V1.361a.59.59 0 00-.615-.608.585.585 0 00-.608.608v4.512a.698.698 0 00-.205-.396L9.094.944a.623.623 0 00-.445-.191.58.58 0 00-.594.588c0 .164.054.328.164.437L9.75 3.33l2.242 2.05-1.456-.054h-9.01c-.355 0-.601.253-.601.609 0 .355.246.615.601.615h9.01L12 6.495 9.75 8.54l-1.531 1.559a.616.616 0 00-.164.43c0 .342.26.588.594.588z"})});var h=s(60651),f=s(25651),x=s(18442),y=s(45137),S=s(89101),v=s(9291),b=s(893),M=s(47307),j=s(3297),C=s(40277),w=s(69915),k=s(8055),T=s(29974),I=s(10182),Z=s(93405),P=s(72495),F=s(19037),A=s(28020),_=s(84210),R=s(33929),O=s(80444),B=s(83212),D=s(82763),L=s(62967);const V=(0,p.IU)("reportPage",{viewBox:"0 0 13 14",svg:(0,m.jsx)("path",{d:"M.832 13.846c.349 0 .636-.28.636-.636V9.47a4.696 4.696 0 011.634-.273c2.488 0 4.156 1.244 6.562 1.244 1.053 0 1.538-.13 2.065-.376.492-.218.779-.622.779-1.25v-6.81c0-.45-.349-.73-.814-.73-.39 0-1.005.26-2.098.26C7.216 1.534 5.515.29 3.033.29 2.001.29 1.53.42.976.666.49.892.189 1.247.189 1.869V13.21c0 .349.294.636.643.636zm8.805-4.703c-2.215 0-3.931-1.238-6.508-1.238-.663 0-1.265.075-1.627.212v-6.07c.123-.198.629-.465 1.552-.465 2.33 0 4.047 1.244 6.514 1.244.657 0 1.21-.075 1.627-.191v6.05c-.116.198-.635.458-1.558.458z",fill:"#ED6A5F"})});var N=s(31701),E=s(360);const U=(0,v.defineMessages)({reportPageName:{id:"action.reportPage.name",defaultMessage:"Report page"}}),W=(0,L.cN)({key:"action report page",displayName:U.reportPageName,analyticsName:U.reportPageName.defaultMessage,validators:[F.Ggh,F.iKo,F.Id2],closeParentMenu:!0,render:e=>(0,m.jsx)(Z.Z,{...e,style:{color:N.ZP.red},svg:V,title:(0,m.jsx)(v.FormattedMessage,{...U.reportPageName})}),action:e=>{let{blocks:t,environment:s}=e;E.l()}}),K=(0,v.defineMessages)({signUpOrLogInName:{id:"action.signUpOrlogIn.name",defaultMessage:"Sign up or log in"},shareLinkName:{id:"action.shareLink.name",defaultMessage:"Share link"},editPageName:{id:"action.editPage.name",defaultMessage:"Edit"},commentPageName:{id:"action.commentPage.name",defaultMessage:"Comment"},duplicatePageName:{id:"action.duplicatePage.name",defaultMessage:"Duplicate page"},backtoNotionName:{id:"action.backtoNotion.name",defaultMessage:"Back to Notion"}}),z=(0,L.cN)({key:"log in",displayName:K.signUpOrLogInName,analyticsName:K.signUpOrLogInName.defaultMessage,svg:g,validators:[F.ffD(F.jlf)],closeParentMenu:!0,action:async e=>{let{environment:t}=e;await w.yF(t,{utmContent:"sign_up_or_log_in",nextRoute:S._j.login})}}),q=(0,L.cN)({key:"ios share link",displayName:K.shareLinkName,analyticsName:K.shareLinkName.defaultMessage,svg:c.s,validators:[F.U7o,F.Fxc,F.gnQ],closeParentMenu:!0,action:e=>{let{blocks:t,environment:s}=e;const n=t[0],i=n.getNavigableBlockStore();if(i){const e=(0,_.ZP)({store:i,scrollToBlockId:i.id===n.id?void 0:n.id,fullyQualified:!0,pageVisitSource:a.tY.NativeShareLink});s.mobileNative&&s.mobileNative.share(e)}}}),G=(0,L.cN)({key:"android share link",displayName:K.shareLinkName,analyticsName:K.shareLinkName.defaultMessage,svg:l.Q,validators:[F.U7o,F.Fxc,F.DtP],closeParentMenu:q.closeParentMenu,action:q.action}),H=(0,L.cs)({key:"copy link",displayName:L.RE.copyLinkName,analyticsName:L.RE.copyLinkName.defaultMessage,svg:u.N,shortcuts:["copyLinkToBlock"],validators:[F.jlf,F.U7o,F.ffD(F.Fxc),F.ffD(F.DFt)],closeParentMenu:!0,action:(e,t)=>{b.Hs({...e,event:t})}}),Y=(0,L.cN)({key:"edit page",displayName:K.editPageName,analyticsName:K.editPageName.defaultMessage,svg:f.R,validators:[F.U7o,F.DFt,F.Zk8,F.ffD(F.eMw)],closeParentMenu:!0,action:e=>{let{environment:t,blocks:s}=e;const{RouterStore:n}=t,i=n.state.route,o=A.np();if("page"===i.name&&i.requestedOnPublicDomain&&o){const e=(0,_.ZP)({store:o,preferPublicLink:!1,pageVisitSource:a.tY.EditPublicPage});k.Li({environment:t,url:e})}else t.currentUser.isLoggedIn()?M.showDialog({showCancel:!0,keepFocus:!1,message:(0,m.jsx)(v.FormattedMessage,{defaultMessage:"When you start editing, your name, email and photo may become visible to anyone who can view the page.",id:"action.startPublicEditDialog.message"}),items:[{label:(0,m.jsx)(v.FormattedMessage,{defaultMessage:"Continue",id:"action.startPublicEditDialog.continueLabel"}),color:"blue",onAccept(){B.Z.setState({editing:!0,commenting:!0})}}]}):(C.Hr({currentUserId:t.currentUser.id,blockId:s[0].id}),k.Li({environment:t,url:S._j.login}))}}),Q=(0,L.cN)({key:"comment page",displayName:K.commentPageName,analyticsName:K.commentPageName.defaultMessage,svg:y.o,validators:[F.U7o,F.DFt,F.RFc,F.ffD(F.jlf)],closeParentMenu:!0,action:e=>{let{environment:t,blocks:s}=e;const{RouterStore:n}=t,i=n.state.route,o=A.np();if("page"===i.name&&i.requestedOnPublicDomain&&o){const e=(0,_.ZP)({store:o,preferPublicLink:!1,pageVisitSource:a.tY.CommentPublicPage});k.Li({environment:t,url:e})}else C.Hr({currentUserId:t.currentUser.id,blockId:s[0].id}),k.Li({environment:t,url:S._j.login})}}),$=(0,L.cN)({key:"fork page",displayName:K.duplicatePageName,analyticsName:K.duplicatePageName.defaultMessage,svg:d.a,validators:[F.U7o,F.tqC,F.DFt,F.S4z],closeParentMenu:!0,action:e=>{let{blocks:t,originRect:s,environment:n}=e;j.S({environment:n,store:t[0],originRect:s})}}),J=(0,L.cN)({key:"back to my content",displayName:K.backtoNotionName,analyticsName:K.backtoNotionName.defaultMessage,svg:h.h,validators:[F.jlf,F.tqC],closeParentMenu:!0,action:(e,t)=>{let{environment:s}=e;const{currentUserRootStore:n,currentUserSettingsStore:i}=O.default.state;n&&i&&T.L5({environment:s,userRootStore:n,userSettingsStore:i,pageVisitSource:a.tY.SwitchSpace})}}),X=(0,L.cN)({key:"cookie settings",displayName:r.ze.cookieSettingsLabel,analyticsName:r.ze.cookieSettingsLabel.defaultMessage,validators:[F.ffD(F.tYA)],closeParentMenu:!1,render:e=>(0,m.jsx)(I.Z,{hasDismissButton:!1,renderOrigin:t=>{const{onClick:s,...n}=e;return(0,m.jsx)(Z.Z,{...n,...t,title:R.default.formatMessage(r.ze.cookieSettingsLabel),svg:x.H})}}),action:()=>{}}),ee=[(0,L.$J)({key:"page",render:e=>(0,m.jsx)(P.Z,{...e}),actions:[Y,Q,$,H,D.K,q,G]}),(0,L.$J)({key:"user",render:e=>(0,m.jsx)(P.Z,{...e}),actions:[J,z]}),(0,L.$J)({key:"report page actions",render:e=>(0,m.jsx)(P.Z,{...e}),actions:[W,X]})];var te=s(36610),se=s(60709),ne=s(35328),ie=s(48019),oe=s(78140);const ae=function(e){let{block:t,onDismiss:s}=e;const a=(0,i.O7)(),{device:r}=a,l=(0,o.VK)((()=>B.Z.getMode(a,t)),[a,t]),d={environment:a,blocks:[t],publicEditMode:l};let c;c=r.isMobile?{menuType:se.og.ActionSheet}:{menuType:se.og.Popup,width:210,maxHeight:"80vh"};const u=(0,n.useCallback)((e=>{const{mainEditorCurrentBlockStore:t}=O.default.state;if(t){const s=t.getType();var n;if(s)te.dh(a,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"public_topbar_more_menu",block_id:t.id,block_type:s,is_toggleable:(0,ne._A)(s,t.getFormat()),collection_id:null===(n=t.getCollectionViewCollectionStore())||void 0===n?void 0:n.id,parent_collection_id:t.getParentCollectionIdUpToTwoLevels()})}e.closeParentMenu&&s()}),[a,s]),p=ee;return(0,m.jsx)(oe.Z,{...c,children:(0,m.jsx)(ie.Z,{sections:p,onAccept:u,context:d})})}},55880:(e,t,s)=>{s.r(t),s.d(t,{default:()=>B});s(67294);var n=s(480),i=s(86628),o=s(24405),a=s(45238),r=s(85893);const l=(0,a.IU)("thanksShield",{viewBox:"0 0 27 32",svg:(0,r.jsx)("path",{d:"M13.5 31.672c.281 0 .672-.125 1.031-.328 8.75-5.063 11.64-6.969 11.64-12.344V7.125c0-1.672-.624-2.219-2.062-2.797-2.218-.89-7.14-2.719-9.375-3.484-.406-.14-.828-.235-1.234-.235-.422 0-.844.11-1.25.235-2.219.719-7.156 2.61-9.375 3.484C1.437 4.891.812 5.453.812 7.125V19c0 5.375 2.922 7.234 11.641 12.344.36.203.75.328 1.047.328zm0-2.14c-.266 0-.547-.126-.922-.36-7.25-4.5-9.844-5.797-9.844-10.547V7.485c0-.782.141-1.063.735-1.298 2.078-.828 7.187-2.656 9.281-3.468.281-.125.547-.188.75-.188.188 0 .438.078.75.188 2.078.812 7.156 2.703 9.266 3.469.593.218.734.515.734 1.296v11.141c0 4.75-2.625 6.016-9.844 10.547-.375.234-.656.36-.906.36zm-1.688-6.75c.391 0 .72-.188.954-.548l7.593-11.859c.141-.234.282-.5.282-.75 0-.531-.485-.906-.985-.906-.312 0-.61.203-.843.547L11.75 20.437 8.156 16c-.281-.375-.562-.484-.89-.484a.944.944 0 00-.938.953c0 .265.11.531.281.765l4.188 5c.297.391.61.547 1.015.547z",fill:"#636363"})});var d=s(9291);const c=(0,d.defineMessages)({phishing_or_spam:{id:"reportPage.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"},inappropriate_content:{id:"reportPage.reportReasons.inappropriate_content",defaultMessage:"Inappropriate content"},other_content_policy_violation:{id:"reportPage.reportReasons.other_content_policy_violation",defaultMessage:"Other"}});var u=s(7250),p=s(31701),m=s(37810),g=s(54642),h=s(47307),f=s(360),x=s(28020),y=s(33929),S=s(60709),v=s(18514),b=s(88632),M=s(25399),j=s(36488),C=s(74194),w=s(78140),k=s(28992),T=s(32163),I=s(17293),Z=s(63296),P=s(72495),F=s(92660),A=s(74523),_=s(6202);const R={fontSize:16,marginBottom:12,fontWeight:m.Z.fontWeight.medium},O=(0,d.defineMessages)({additionalInformationPlaceholder:{id:"reportPage.additionalInformation.placeholder",defaultMessage:"Add additional information (optional)"},dialogLabel:{id:"reportPage.dialogLabel",defaultMessage:"Report page"}});const B=function(){return(0,r.jsx)(F.Z,{ariaLabel:y.default.formatMessage(O.dialogLabel),onDismiss:W,render:()=>(0,r.jsx)(q,{}),requireOnline:!0,modalStore:M.Z})};function D(){const{state:e}=M.Z;if(e.open){const{reason:t}=e;return void 0!==t}return!1}function L(e){let{modalState:t}=e;const{reason:s}=t;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(I.Z,{title:(0,r.jsx)(d.FormattedMessage,{id:"reportPageModal.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"}),isSelected:"phishing_or_spam"===s,onClick:()=>M.Z.setState({...t,reason:"phishing_or_spam"}),name:"report-page-modal"},"phishing_or_spam"),(0,r.jsx)(I.Z,{title:y.default.formatMessage(c.inappropriate_content),isSelected:"inappropriate_content"===s,onClick:()=>M.Z.setState({...t,reason:"inappropriate_content"}),name:"report-page-modal"},"inappropriate_content"),(0,r.jsx)(I.Z,{title:(0,r.jsx)(d.FormattedMessage,{id:"reportPageModal.reportReasons.other_content_policy_violation",defaultMessage:"Other"}),isSelected:"other_content_policy_violation"===s,onClick:()=>M.Z.setState({...t,reason:"other_content_policy_violation"}),name:"report-page-modal"},"other_content_policy_violation")]})}async function V(e){const t=M.Z.getState();if(!t.open)return;const{additionalInformation:s,reason:n}=t,i=(0,x.Fv)();if(!n||null==i||!i.id)return void h.showErrorMessage((0,r.jsx)(d.FormattedMessage,{defaultMessage:"Something went wrong.",id:"reportPageModal.somethingWentWrong.label"}));const o=await(a=(0,u.OP)(),g.reportPage(e,{reason:n,page:i,intercomVisitorId:a,additionalInformation:s}));var a;"failed"===o.type?h.showError(o):(M.Z.setState({open:!1}),h.showMessage({message:(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[l({width:40}),(0,r.jsx)("div",{style:{paddingTop:12,paddingBottom:8,fontSize:"large",textAlign:"center"},children:(0,r.jsx)(d.FormattedMessage,{id:"reportPageModal.thanksForReporting",defaultMessage:"Thanks for reporting this page, our team will take a look."})})]})})}))}function N(e){return{width:360,padding:24,fontSize:14,color:e.mediumTextColor}}function E(e,t){const{device:s}=e;return{width:"100%",background:t.popoverBackground,display:"block",padding:s.isMobile?16:"10px 12px",height:s.isMobile?150:130,marginTop:17,marginBottom:17,fontSize:s.isMobile?16:14}}function U(){const e=(0,o.Fg)();return(0,r.jsx)("div",{style:N(e),children:(0,r.jsx)(d.FormattedMessage,{defaultMessage:"Please go online to make a report.",id:"reportPageModal.offlineMessage.description"})})}function W(){f.q()}function K(e){let{modalState:t}=e;const s=(0,o.Fg)(),i=(0,n.O7)();if(!t.open)return null;const{reason:a}=t,l={menuType:S.og.Modal,title:(0,r.jsx)(d.FormattedMessage,{id:"reportPageModal.mobile.title",defaultMessage:"Report page"}),right:(0,r.jsx)(d.FormattedMessage,{id:"reportPageModal.closeButton.label",defaultMessage:"Close"}),onClickRight:W};return(0,r.jsx)(w.Z,{...l,children:(0,r.jsx)(T.Z,{type:T.i.Vertical,initialFocus:void 0,sections:[{key:"help",render:e=>{let{children:t,...s}=e;return(0,r.jsx)(P.Z,{...s,children:t})},items:[{key:"help",render:()=>(0,r.jsx)(k.Z,{title:(0,r.jsx)(A.Z,{title:(0,r.jsx)(d.FormattedMessage,{id:"reportPage.helpButton.caption",defaultMessage:"Notion's content policy"}),href:(0,v.UY)("contentPolicy"),analyticsFrom:"report_page"}),right:(0,r.jsx)(r.Fragment,{}),onClick:()=>{}}),action:()=>{}}]},{key:"reportOptions",render:e=>{let{children:t,...s}=e;return(0,r.jsx)(P.Z,{...s,children:t})},items:[{key:"options",render:()=>(0,r.jsx)(L,{modalState:t}),action:()=>{}},{key:"additionalInfo",render:()=>a&&(0,r.jsx)(C.Z,{textarea:!0,style:E(i,s),focus:Boolean(t.reason),value:t.additionalInformation,placeholder:y.default.formatMessage(O.additionalInformationPlaceholder),onChange:e=>{M.Z.setState({...t,additionalInformation:e.target.value})}}),action:()=>{}}]},{key:"actions",render:e=>{let{children:t,...s}=e;return(0,r.jsx)(P.Z,{isSubmitButton:!0,...s,children:t})},items:[{key:"submit",render:e=>{const{onClick:t,...s}=e;return(0,r.jsx)(_.Z,{...s,disabled:!D(),title:(0,r.jsx)("div",{style:{color:p.ZP.red},children:(0,r.jsx)(d.FormattedMessage,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})}),onClick:t||V})},action:()=>V(i)}]}]},"main list")})}function z(e){let{modalState:t}=e;const s=(0,o.Fg)(),i=(0,n.O7)();if(!t.open)return null;const{reason:a}=t;return(0,r.jsx)(j.Z,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:()=>(0,r.jsxs)("div",{style:{width:360,padding:24,fontSize:14},children:[(0,r.jsx)("div",{style:R,children:(0,r.jsx)(d.FormattedMessage,{id:"reportPageModal.title",defaultMessage:"Why are you reporting this page?"})}),(0,r.jsx)("div",{style:{paddingBottom:12},children:(0,r.jsx)(A.Z,{title:(0,r.jsx)(d.FormattedMessage,{id:"reportPage.helpButton.caption",defaultMessage:"Notion's content policy"}),href:(0,v.UY)("contentPolicy"),analyticsFrom:"report_page"})}),(0,r.jsx)("div",{children:(0,r.jsx)(L,{modalState:t})}),a&&(0,r.jsx)(C.Z,{textarea:!0,style:E(i,s),focus:Boolean(t.reason),value:t.additionalInformation,placeholder:y.default.formatMessage(O.additionalInformationPlaceholder),onChange:e=>{M.Z.setState({...t,additionalInformation:e.target.value})}}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18},children:[(0,r.jsx)(Z.Z,{isLarge:!0,onClick:W,style:{marginRight:12},children:(0,r.jsx)(d.FormattedMessage,{id:"reportPageModal.cancelButton.label",defaultMessage:"Cancel"})}),(0,r.jsx)(Z.Z,{isRed:!0,isLarge:!0,onClick:()=>V(i),disabled:!D(),disabledFeedback:!0,children:(0,r.jsx)(d.FormattedMessage,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})})]})]})})}function q(){const e=(0,n.O7)(),{device:t}=e,s=(0,i.VK)((()=>b.Z.state.online),[]),o=(0,i.VK)((()=>M.Z.state),[]);return s?o.open?t.isMobile?(0,r.jsx)(K,{modalState:o}):(0,r.jsx)(z,{modalState:o}):null:(0,r.jsx)(U,{})}},18168:(e,t,s)=>{s.d(t,{Z:()=>r});s(67294);var n=s(24405),i=s(64921),o=s(85893);function a(e){const{isFirst:t,isLast:s,isSelected:a,item:r,itemStyle:l,innerStyle:d,children:c,colors:u,onClick:p}=e,{isDisabled:m}=r,g=(0,n.yK)((e=>{const n=(null==u?void 0:u.selectedOutline)??e.blueColor,i=(null==u?void 0:u.unselectedOutline)??e.accentColors.gray[100];return{SegmentedItem:{alignItems:"center",background:a?null==u?void 0:u.selectedBackground:void 0,borderBottomLeftRadius:t?3:0,borderBottomRightRadius:s?3:0,borderColor:a?n:i,borderStyle:"solid",borderTopLeftRadius:t?3:0,borderTopRightRadius:s?3:0,borderWidth:1,cursor:m?void 0:"pointer",display:"flex",flexBasis:"50%",marginLeft:t?0:-1,padding:0,userSelect:"none",zIndex:a?10:0,...l},Inner:{borderBottomLeftRadius:t?2:0,borderBottomRightRadius:s?2:0,borderColor:a?n:"transparent",borderStyle:"solid",borderTopLeftRadius:t?2:0,borderTopRightRadius:s?2:0,borderWidth:1,display:"flex",flexDirection:"column",height:"100%",justifyContent:"center",padding:"12px 20px",textAlign:"center",width:"100%",...d}}}),[null==u?void 0:u.selectedBackground,null==u?void 0:u.selectedOutline,null==u?void 0:u.unselectedOutline,t,s,a,m,l,d]);return(0,o.jsx)(i.Z,{ariaLabel:r.ariaLabel,"aria-pressed":a,onClick:()=>{p&&p(r.key)},style:g.SegmentedItem,disabled:m,children:(0,o.jsx)("div",{style:g.Inner,children:c})})}function r(e){const{items:t=[],itemStyle:s,innerStyle:i,value:r,onChange:l,colors:d}=e,c=(0,n.yK)((e=>({SegmentedButton:{background:e.cardContentBackground,display:"flex",width:"100%"}})),[]);return 0===t.length?null:(0,o.jsx)("div",{style:c.SegmentedButton,children:t.map(((e,n)=>(0,o.jsx)(a,{isFirst:0===n,isLast:n===t.length-1,isSelected:e.key===r,item:e,itemStyle:s,innerStyle:i,colors:d,onClick:l,children:e.render()},e.key)))})}},9050:(e,t,s)=>{s.d(t,{Z:()=>d});s(67294);var n=s(480),i=s(24405),o=s(31701),a=s(80025),r=s(52275),l=s(85893);const d=function(e){const{color:t}=e;return(0,l.jsx)(r.Z,{...e,icon:(0,l.jsx)(c,{color:t}),title:(0,a.Vn)(t)})};function c(e){let{color:t}=e;const s=(0,i.Fg)(),a=(0,n.O7)(),r=(0,o.KR)(s,t);return(0,l.jsx)("div",{style:{width:a.device.isMobile?24:18,height:a.device.isMobile?24:18,background:r.menuBackgroundColor,color:r.textColor,boxShadow:s.innerBorderBoxShadow,borderRadius:4}})}},40424:(e,t,s)=>{s.d(t,{Z:()=>ne});s(57658);var n=s(43261),i=s.n(n),o=s(67294),a=s(83355),r=s(480),l=s(86628),d=s(99036),c=s(80951),u=s(84619),p=s(6287),m=s(3791),g=s(9291),h=s(53965),f=s(7032),x=s(15828),y=s(36610),S=s(10906),v=s(66890),b=s(75079),M=s(19124),j=s(60709),C=s(29798),w=s(49085);class k extends w.default{getInitialState(){return{inputValue:"",openPropertyActionMenu:void 0}}}const T=k;var I=s(88280),Z=s(24405),P=s(11751),F=s(54642),A=s(4023),_=s(64921),R=s(36596),O=s(72495),B=s(22084),D=s(85893);function L(e){const{menuArgs:t,environment:s,store:n,property:i,propertySchema:a,addNewTokens:r}=e,[d,c]=(0,o.useState)(!1),[p,m]=(0,o.useState)([]),x=(0,Z.Fg)();(0,o.useEffect)((()=>{if(0===p.length){c(!0);const e=(0,f.ZP)();F.publishAiSession(s,{inference_type:"autofill",id:e,metadata:{is_select_property_menu:!0}}),F.getCompletionForSelectOption(s,{blockPropertyPointer:{...n.pointer,spaceId:n.getSpaceId(),propertyId:i},collectionId:n.getParentId()??"",model:"default",aiSessionId:e}).then((e=>{"success"===e.type&&"success"===e.data.type&&(c(!1),m(e.data.completion.split(",")))}))}}),[s,i,a,n,p.length]);const y=(0,l.VK)((()=>(0,h.oA)(p.map((e=>{var t;return null===(t=a.options)||void 0===t?void 0:t.find((t=>t.value===e))})))),[a.options,p]),S=()=>(0,D.jsxs)("div",{style:{display:"flex",flexDirection:"row",width:"100%",color:x.accentColors.purple[400]},children:[(0,P.t)({width:16,height:16,fill:x.accentColors.purple[400],marginRight:5}),(0,D.jsx)(g.FormattedMessage,{id:"database.selectPropertyEditMenu.aiSuggestionSectionTitle",defaultMessage:"AI suggested"})]});return d?(0,D.jsx)(O.Z,{...t,title:S(),children:(0,D.jsx)("div",{style:{display:"flex",flexDirection:"row",maxWidth:"100%",overflow:"clip"},children:[...Array("select"===a.type?1:4)].map(((e,t)=>(0,D.jsx)(R.Z,{style:{width:100,height:24,marginLeft:0===t?20:10,borderRadius:4}},t)))})}):y.length>0?(0,D.jsx)(O.Z,{...t,title:S(),right:y.length>1?(0,D.jsx)(_.Z,{style:{color:x.blueColor},onClick:()=>{r(p)},children:(0,D.jsx)(g.FormattedMessage,{id:"database.selectPropertyEditMenu.aiSuggestionSectionTitle.addAllButton",defaultMessage:"Add all"})}):null,children:(0,D.jsx)("div",{className:"hide-scrollbar",style:{display:"flex",flexDirection:"row",maxWidth:"100%",overflow:"scroll"},children:y.map(((e,t)=>(0,D.jsx)(_.Z,{style:{display:"flex",marginLeft:0===t?20:10,textAlign:"center",borderRadius:4},hoveredStyle:{display:"flex"},onClick:()=>{r([e.value])},children:(0,D.jsx)(B.a,{format:s.device.isMobile?u.lo.Large:u.lo.Medium,value:e.value,color:e.color,descriptionTooltip:e.description,tooltipPlacement:A.u.Left,showRemoveButton:!1,isSingle:!0,showEllipsis:!0})},t)))})}):(0,D.jsx)(D.Fragment,{})}var V=s(52275),N=s(79131),E=s(78140),U=s(32163),W=s(43765),K=s(40721),z=s(92658),q=s(43224),G=s(12534),H=s(98742),Y=s(24736),Q=s(3386),$=s(26388),J=s(73456);const X=function(e){var t;const{locked:s,option:n,actionMenuOpen:i,property:a,collectionId:d,analyticsFrom:c,onChange:p,onCloseActionMenu:m,focused:g,propertySchema:f,onOpenActionMenu:x}=e,y=(0,Z.Fg)(),S=(0,r.O7)(),v=(0,l.qz)(void 0,z.Z),b=(0,o.useRef)(i);return(0,o.useEffect)((()=>{i!==b.current&&v.setState({...v.state,inputValue:n.value}),b.current=i}),[i,n.value,v]),(0,D.jsx)(Q.Z,{debugName:"SelectPropertyMenuItem",capture:i,onEnter:h.yR,children:(0,D.jsx)($.ZP,{renderTooltip:e=>(0,D.jsxs)("div",{...e,style:q.F6,children:[(0,D.jsx)("div",{children:n.value}),(0,D.jsx)("div",{style:{color:y.mediumInvertedTextColor},children:n.description})]}),placement:A.u.Left,disableTooltip:!(null!==(t=n.description)&&void 0!==t&&t.length),render:t=>(0,D.jsx)(V.Z,{...(0,H.Z)(t,e),title:(0,D.jsx)(B.a,{format:S.device.isMobile?u.lo.Large:u.lo.Medium,value:n.value,color:n.color,hideTooltip:!0,showRemoveButton:!1,isSingle:!0,showEllipsis:!0}),desktopTitleStyle:{marginRight:6},isTokenTitle:!0,right:!s&&(0,D.jsx)(ee,{property:a,collectionId:d,analyticsFrom:c,onChange:p,onCloseActionMenu:m,actionMenuOpen:i,focused:g,option:n,propertySchema:f,onOpenActionMenu:x})})})})};function ee(e){let{property:t,collectionId:s,analyticsFrom:n,onChange:i,onCloseActionMenu:o,actionMenuOpen:a,focused:l,option:d,propertySchema:c,onOpenActionMenu:u}=e;const p=(0,r.O7)(),{device:m}=p;return(0,D.jsx)(J.Z,{open:a,origin:(0,D.jsx)(Y.Z,{onClick:e=>function(e,t,s){(0,G.ZP)({event:e,context:G.Af.MenuListClick,callback:()=>t(s.value)})}(e,u,d),isMobile:m.isMobile,style:{opacity:l||m.isMobile?1:0}}),option:d,propertySchema:c,property:t,collectionId:s,analyticsFrom:n,onChange:i,onClose:o})}var te=s(47082);class se extends a.Z{constructor(){super(...arguments),this.storeTypes={store:T,menuListStore:C.Z},this.createSelectColorRef={current:void 0}}UNSAFE_willMount(e){if(ce(this.props.schema,this.props.property,this.createSelectColorRef),e.insertChar){const t=e.insertChar;this.stores.store.setState({...this.stores.store.state,inputValue:t})}}renderComponent(){const{device:e}=this.environment,{disabled:t,canConfigureCollection:s,autofillExplanation:n,bulkAutofillButton:o}=this.props,a=this.props.schema[this.props.property];if(!a)return;if(!d.cu(a))return;const r=a.options||[],l=this.renderCurrentTokens(r),c=function(e,t,s){const n=t.map((e=>e.value));let o;if(e){o=i().filter(e,n).map((e=>e.original));!t.find((t=>t.value===e))&&e.trim().length>0&&s&&o.push(e.trim().replace(/,/g,""))}else o=n;return o}(this.stores.store.state.inputValue,r,this.props.canConfigureCollection),u=a.select_ai_inference,p=0===c.length,m=(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(te.Z,{focus:e.isMobile?void 0:!this.stores.store.state.openPropertyActionMenu,focusAfterAnimation:!0,format:te.U.Select,tokens:l,placeholder:null!=u&&u.auto_update_on_edit?this.props.intl.formatMessage({id:"database.selectPropertyEditMenu.searchPlaceholder.aiAutoUpdate",defaultMessage:"Empty"}):this.props.intl.formatMessage({id:"database.selectPropertyEditMenu.searchPlaceholder",defaultMessage:"Search for an option..."}),onRemoveLastToken:()=>{ue(this.props.value.slice(0,this.props.value.length-1),this.environment,this.props.collectionId,this.props.allowMultiple,this.props.property,this.props.schema,this.props.onChange,this.props.analyticsFrom,this.stores.store,this.createSelectColorRef,this.context.collectionContextStore)},value:this.stores.store.state.inputValue,disabled:t,hideInput:!1,onChange:e=>this.stores.store.setState({...this.stores.store.state,inputValue:e.target.value}),dontShowBorderBottom:e.isAndroid}),n]});let g;return g=e.isMobile?{menuType:j.og.Modal,title:a.name,right:(0,D.jsx)(K.DoneMenuText,{}),onClickRight:this.props.onDismiss,header:m,footer:o}:{menuType:j.og.Popup,header:m,tokenInputHeader:!0,footer:o},t?(0,D.jsx)(E.Z,{...g}):(0,D.jsx)(E.Z,{...g,children:p?(0,D.jsx)(O.Z,{title:s?(0,D.jsx)(ae,{}):(0,D.jsx)(ie,{}),children:e.isMobileNative&&(0,D.jsx)(W.Z,{title:(0,D.jsx)(ie,{})})}):(0,D.jsx)(U.Z,{type:U.i.Vertical,initialFocus:this.stores.store.state.inputValue.length>0?0:void 0,sections:[{key:0,render:e=>this.renderAiSuggestionSection(e),items:[]},{key:1,render:e=>(0,D.jsx)(le,{collectionId:this.props.collectionId,property:this.props.property,schema:this.props.schema,onChange:this.props.onChange,canConfigureCollection:this.props.canConfigureCollection,menuListStore:this.stores.menuListStore,args:e,tokens:c}),items:pe(c,r,this.environment,this.props.schema,this.props.property,this.props.canConfigureCollection,this.props.analyticsFrom,this.props.collectionId,this.props.value,this.props.onChange,this.props.allowMultiple,this.stores.store,this.createSelectColorRef,this.context.collectionContextStore)}],onAccept:(e,t,s)=>{this.props.onAccept(s)},store:this.stores.menuListStore})})}renderAiSuggestionSection(e){var t;const s=(null===(t=I.subscriptionDataStoreInstance.state)||void 0===t?void 0:t.addOns)??[];if(!(0,m.de)(s)||!(0,M.KZ)()||!(0,M.q)())return;const n=this.props.schema[this.props.property];return n&&d.cu(n)?(0,D.jsx)(L,{menuArgs:e,environment:this.environment,property:this.props.property,propertySchema:n,store:this.props.blockStore,addNewTokens:e=>{ue([...this.props.value,...e],this.environment,this.props.collectionId,this.props.allowMultiple,this.props.property,this.props.schema,this.props.onChange,this.props.analyticsFrom,this.stores.store,this.createSelectColorRef,this.context.collectionContextStore)}}):void 0}renderCurrentTokens(e){const{disabled:t}=this.props,{device:s}=this.environment;return h.oA(this.props.value.map((n=>{const i=(0,c.i7)(e,n);if(i)return(0,D.jsx)(B.a,{value:i.value,color:i.color,showRemoveButton:!t,isSingle:!1,format:s.isMobile?u.lo.Large:u.lo.Medium,shouldShrink:!0,onClickRemove:()=>{ue(this.props.value.filter((e=>e!==n)),this.environment,this.props.collectionId,this.props.allowMultiple,this.props.property,this.props.schema,this.props.onChange,this.props.analyticsFrom,this.stores.store,this.createSelectColorRef,this.context.collectionContextStore)},showEllipsis:!0},i.id)})))}}se.displayName="SelectPropertyMenu",se.contextTypes={...a.w,...v.xm};const ne=(0,g.injectIntl)(se);function ie(){return(0,D.jsx)(g.FormattedMessage,{id:"database.selectPropertyEditMenu.noResults",defaultMessage:"No options found"})}function oe(){return(0,D.jsx)(g.FormattedMessage,{id:"database.selectPropertyEditMenu.selectOnlyPrompt",defaultMessage:"Select an option"})}function ae(){return(0,D.jsx)(g.FormattedMessage,{id:"database.selectPropertyEditMenu.selectOrCreatePrompt",defaultMessage:"Select an option or create one"})}function re(e){let{props:t,newOption:s,token:n}=e;const i=(0,r.O7)(),{device:o}=i;return(0,D.jsx)(V.Z,{...t,title:(0,D.jsxs)("div",{style:{display:"flex",minWidth:0},children:[(0,D.jsx)("div",{style:{marginRight:6,lineHeight:1.3},children:(0,D.jsx)(g.FormattedMessage,{id:"database.selectPropertyEditMenu.createLabel",defaultMessage:"Create"})}),(0,D.jsx)(B.a,{value:s.value,color:s.color,showRemoveButton:!1,isSingle:!0,format:o.isMobile?u.lo.Large:u.lo.Medium,showEllipsis:!0})]}),isTokenTitle:!0})}function le(e){let{args:t,tokens:s,collectionId:n,property:i,schema:a,onChange:r,canConfigureCollection:l,menuListStore:c}=e;const u=(0,o.useCallback)((e=>function(e,t,s,n,i,o){const a=(0,S.YL)({newOptions:e,collectionId:t,property:s,schema:n});if(a){const e=n[s];e&&d.cu(e)&&"manual"!==(e.auto_sort_options||"manual")&&a.push({pointer:{table:p.vF,id:t},command:"update",path:["schema",s],args:{auto_sort_options:"manual"}}),i({operations:a})}o.reset()}(e,n,i,a,r,c)),[n,i,a,r,c]);return l?(0,D.jsx)(O.Z,{...t,title:(0,D.jsx)(ae,{}),children:(0,D.jsx)(N.ZP,{direction:"vertical",keys:s,renderKey:e=>t.children[s.indexOf(e)],onDrop:u})}):(0,D.jsx)(O.Z,{...t,title:(0,D.jsx)(oe,{}),children:t.children})}function de(e){let{props:t,option:s,schema:n,property:i,canConfigureCollection:a,analyticsFrom:r,collectionId:c,value:u,onChange:p,store:m}=e;const g=(0,o.useCallback)((e=>function(e,t){t.setState({...t.state,openPropertyActionMenu:e})}(e,m)),[m]),f=(0,o.useCallback)((()=>function(e){e.setState({...e.state,openPropertyActionMenu:void 0})}(m)),[m]),x=(0,l.VK)((()=>m.state.openPropertyActionMenu===s.value),[m,s]),y=n[i];return y&&d.cu(y)?(0,D.jsx)(X,{...t,option:s,showDragHandle:a,locked:!a,property:i,analyticsFrom:r,collectionId:c,onChange:e=>function(e,t,s,n,i){const o=s[t];if(!o)return;if(!d.cu(o))return;const a=o.options||[],r=[...a],l={},c=n.filter((e=>{const t=a.find((t=>t.value===e));return!t||r.some((e=>e.id===t.id))}));l.operations=e,h.Xy(c,n)||(l.value=c),i(l)}(e,i,n,u,p),actionMenuOpen:x,propertySchema:y,onCloseActionMenu:f,onOpenActionMenu:g}):null}function ce(e,t,s){const n=e[t];if(!n)return;if(!d.cu(n))return;const i=n.options||[],o=(0,d.TL)(i);s.current=o}function ue(e,t,s,n,i,o,a,r,l,c,u){l.setState({...l.state,inputValue:""});const m=o[i];if(!m)return;if(!d.cu(m))return;const g=m.options||[];let x;x=n?e:e.length>0?[e[e.length-1]]:[];const v=h.jj(h.oA(x.map((e=>{const t=g.find((t=>t.value===e));if(t)return t.value})))),M=x.find((e=>!g.find((t=>t.value===e)))),j={value:v.concat(h.oA([M]))};if(M){const e={id:(0,f.ZP)(),value:M,color:c.current};let n;n="alphabetical"===m.auto_sort_options||"reverse_alphabetical"===m.auto_sort_options?[(0,S.Ch)({collectionId:s,property:i,propertySchema:m,newOption:e,isAscending:"alphabetical"===m.auto_sort_options})]:[{pointer:{table:p.vF,id:s},command:"keyedObjectListAfter",path:["schema",i,"options"],args:{value:e}}],j.operations=n,ce(o,i,c),y.$q(t,{...(0,b.Pn)(u),property_type:m.type,action:"select_add_option",from:r})}a(j)}function pe(e,t,s,n,i,o,a,r,l,d,c,u,p,m){return e.map((e=>{const g=t.find((t=>t.value===e));return{key:e,render:t=>{if(g)return(0,D.jsx)(de,{schema:n,property:i,canConfigureCollection:o,analyticsFrom:a,collectionId:r,value:l,onChange:d,store:u,props:t,option:g});{const s={id:(0,x.ZP)(),value:e,color:p.current};return(0,D.jsx)(re,{props:t,newOption:s,token:e})}},action:()=>{ue([...l,e],s,r,c,i,n,d,a,u,p,m)}}}))}},77376:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var n=s(67294),i=s(480),o=s(86628),a=s(9291),r=s(49386),l=s(36610),d=s(10906),c=s(75079),u=s(60709),p=s(18514),m=s(35328),g=s(73819),h=s(27724),f=s(13713),x=s(80209),y=s(48019),S=s(68894),v=s(78140),b=s(72495),M=s(83182),j=s(85893);const C=(0,a.defineMessages)({filterActions:{defaultMessage:"Search actions…",id:"selectableHoverMenu.filterActions.placeholder"}});function w(e){const{hasEditorPermissions:t,isWorkspaceAdmin:s,store:a,onDismiss:p,containerRef:S,query:b,setQuery:M}=e,C=(0,i.O7)(),w=(0,i.MO)(),I=(0,o.VK)((()=>{var e;return{environment:C,blocks:h.default.state.stores.length?h.default.state.stores:[a],originRect:null===(e=S.current)||void 0===e?void 0:e.getBoundingClientRect(),publicEditMode:void 0}}),[C,a,S]),Z=(0,o.VK)((()=>a.isNavigableAncestorNonEditableState()),[a]),[P,F]=(0,n.useState)(void 0),A=(0,n.useCallback)((e=>{const t=h.default.state.stores[0];if(t){const s=t.getType();if(s){const n=(0,d.fm)(t),i=(0,c.Pn)(n)||{};l.dh(C,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"selection_menu",block_id:t.id,block_type:s,is_toggleable:(0,m._A)(s,t.getFormat()),parent_collection_id:t.getParentCollectionIdUpToTwoLevels(),...i})}}e.closeParentMenu&&p()}),[C,p]),_=(0,o.VK)((()=>a.isCollectionView()),[a]),R=(0,g.cR)(a),O=!w&&t&&!Z&&!R&&(0,j.jsx)(k,{filter:b,setQuery:M,comboboxAriaProps:P});let B;return B=w?{menuType:u.og.ActionSheet,header:O}:{menuType:u.og.Popup,width:265,header:O},(0,j.jsxs)(v.Z,{...B,children:[(0,j.jsx)(y.Z,{filter:b,initialFocus:b?0:void 0,sections:r.Qi,context:I,onAccept:A,setComboboxAriaProps:F}),!b&&(t||s)&&(0,j.jsx)(f.Z,{store:a,isPageMoreButton:!1,hideTopBorder:!1}),!b&&(0,j.jsx)(x.Z,{store:a}),!b&&_&&(0,j.jsx)(T,{})]})}function k(e){const{filter:t,setQuery:s,comboboxAriaProps:n}=e,o=(0,i.Fy)(),r=(0,a.useIntl)();return(0,j.jsx)(b.Z,{isInput:!0,children:(0,j.jsx)(S.ZP,{value:t,onChange:e=>s(e.target.value),focus:!o.isMobile||void 0,focusAfterAnimation:!0,placeholder:r.formatMessage(C.filterActions),preventCaptureDeleteWhenEmpty:!0,preventCaptureClipboardShortcuts:!0,...n})})}function T(){return(0,j.jsx)(b.Z,{topBorder:!0,children:(0,j.jsx)(M.Z,{title:(0,j.jsx)(a.FormattedMessage,{defaultMessage:"Learn about databases",id:"blocks.hoverBlockMenu.collectionHelpButton"}),href:(0,p.UY)("guides.database"),analyticsFrom:"selectable_hover_menu"})})}},30761:(e,t,s)=>{s.r(t),s.d(t,{default:()=>l});s(67294);var n=s(480),i=s(24405),o=s(50506),a=s(86993),r=s(85893);function l(e){const t=(0,n.Fy)(),s=(0,i.yK)((e=>({modal:{width:t.isMobile?"auto":890,height:t.isMobile?"auto":606,borderRadius:8}})),[t.isMobile]);return(0,r.jsx)(o.Z,{open:e.modalOpened,innerStyle:s.modal,onDismiss:e.onModalClose,render:()=>(0,r.jsx)("div",{style:{height:"100%",display:"flex",flexDirection:"row",borderRadius:8,overflow:"hidden"},children:(0,r.jsx)(a.Z,{location:"sidebar-modal"})})})}},42353:(e,t,s)=>{s.r(t),s.d(t,{MembersTabTitle:()=>us,PeopleRow:()=>ds,SettingToggle:()=>ps,SidebarTeamModal:()=>cs});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(9291),l=s(53965),d=s(1898),c=s(37810),u=s(17224),p=s(43250),m=s(95697),g=s(55838),h=s(34859),f=s(80444),x=s(6258),y=s(44041),S=s(86232),v=s(43488),b=(s(57658),s(45238)),M=s(85893);const j=(0,b.IU)("leaveArrow",{viewBox:"0 0 16 12",svg:(0,M.jsx)("path",{d:"M8.65 11.116a.615.615 0 00.444-.184l4.546-4.54a.66.66 0 00.205-.39v4.526c0 .349.253.588.608.588.356 0 .615-.239.615-.588V1.361a.59.59 0 00-.615-.608.585.585 0 00-.608.608v4.512a.698.698 0 00-.205-.396L9.094.944a.623.623 0 00-.445-.191.58.58 0 00-.594.588c0 .164.054.328.164.437L9.75 3.33l2.242 2.05-1.456-.054h-9.01c-.355 0-.601.253-.601.609 0 .355.246.615.601.615h9.01L12 6.495 9.75 8.54l-1.531 1.559a.616.616 0 00-.164.43c0 .342.26.588.594.588z"})});var C=s(31701),w=s(64964),k=s(13447),T=s(36488),I=s(74194),Z=s(58297),P=s(26388),F=s(64369),A=s(33929),_=s(78122),R=s(4023),O=s(9867),B=s(73365),D=s(56187);function L(e){return!(0,D.q)(e)}var V=s(97082),N=s(64552),E=s(8787),U=s(80068),W=s(74016),K=s(80993),z=s(48779),q=s(60701);const G=(0,r.defineMessages)({editor:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsFull",defaultMessage:"Teamspace members have full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsEdit",defaultMessage:"Teamspace members can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsComment",defaultMessage:"Teamspace members can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsView",defaultMessage:"Teamspace members can view"}}),H=(0,r.defineMessages)({editor:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsFull",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} has full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsEdit",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsComment",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsView",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can view"},none:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsNone",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} does not have access"}});function Y(e){let{teamStore:t}=e;const s=(0,a.yK)((()=>({listItem:{padding:0,margin:0},spacer:{height:20,width:"100%"},accessLevelButton:{border:"none"}})),[]),[n,i]=(0,o.AF)(g.Z),l=g.a.Members,d=(0,o.VK)((()=>t.getTeamAccessLevel()),[t]);return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("div",{style:s.spacer}),(0,M.jsx)(K.Ph,{title:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.permissions",defaultMessage:"Permissions"}),rows:[(0,M.jsx)(q._,{currentAccessLevel:d,teamStore:t,disabledWithRightChevron:!0,style:s.accessLevelButton},"visibility"),(0,M.jsx)(Q,{teamStore:t},"permissions")],onClick:()=>{n.open&&i({...n,tab:l})},itemStyle:s.listItem})]})}function Q(e){let{teamStore:t}=e;const s=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]),n=(0,i.O7)(),r=(0,a.yK)((e=>({label:{color:e.regularTextColor,whiteSpace:"normal"},row:{display:"inline-flex",alignItems:"center",marginTop:12,marginBottom:12,paddingRight:15,paddingLeft:15},icon:{marginRight:15}})),[]),l=(0,o.VK)((()=>t.getTeamPermission()||{type:"team_permission",role:"none"}),[t]),d=(0,o.VK)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),{spaceIcon:c,spaceName:u}=(0,o.VK)((()=>{if(!s)return{spaceIcon:void 0,spaceName:void 0};const e=(0,z.rn)(n,s);return{spaceIcon:(0,M.jsx)(W.p,{disabled:!0,store:s,size:20,style:r.icon}),spaceName:e}}),[s,n,r.icon]),p=(0,o.VK)((()=>(0,M.jsx)(W.p,{disabled:!0,store:t,size:20,style:r.icon})),[t,r.icon]),m=!(l.role===d.role),g=m?p:c,h=A.default.formatMessage(H[d.role],{showTeam:m,spaceName:u}),x=A.default.formatMessage(G[l.role]);return(0,M.jsxs)("div",{style:r.row,children:[g,(0,M.jsxs)(F.Z,{isSmall:!0,style:r.label,children:[m&&(0,M.jsxs)(M.Fragment,{children:[x,(0,M.jsx)("span",{style:{marginLeft:5,marginRight:5},children:"•"})]}),h]})]})}var $=s(52867),J=s(89728),X=s(91694),ee=s(11628),te=s(42853),se=s(72141),ne=(s(59730),s(87479));const ie=["none","reader","comment_only","read_and_write","editor"],oe=["reader","comment_only","read_and_write"],ae=["reader","comment_only","read_and_write","editor"],re=["editor"];function le(e){const t=function(e){var t,s;let{teamId:n,permissions:i}=e;const o=(null===(t=i.find((e=>(0,se.ix)(e))))||void 0===t?void 0:t.role)??"none",a=(null===(s=i.find((e=>(0,se.zU)(e)&&e.team_id===n)))||void 0===s?void 0:s.role)??o,r=i.find((e=>(0,se.bm)(e)));return{spacePermission:{type:"space_permission",role:o},teamMemberPermission:{type:"explicit_team_permission",team_id:n,role:a},teamOwnerPermission:{type:"explicit_team_owner_permission",team_id:n,role:"editor"},...r&&{teamGuestPermission:{type:"explicit_team_guest_permission",team_id:n,role:r.role}}}}({teamId:e.id,permissions:e.permissions??[]}),{spacePermission:s,teamMemberPermission:n}=t,i={visibility:["team_members","space_members"],space_member_join_access:["invite_only","self_join"],invite_access:["team_members","team_owners"]},o={spacePermission:ce({roles:ie,currentRole:n.role}),teamGuestPermission:oe,teamMemberPermission:de({roles:ae,currentRole:s.role}),teamOwnerPermission:re},{visibility:a,space_member_join_access:r}=e.settings;return"team_members"===a&&(i.space_member_join_access=["invite_only"],o.spacePermission=["none"]),"self_join"===r&&(i.visibility=["space_members"],i.invite_access=["team_members"],o.spacePermission=o.spacePermission.filter((e=>"none"!==e))),e.is_default&&(o.teamMemberPermission=[n.role],o.spacePermission=[n.role]),{settingsOptions:i,permissionItemRoleOptions:o,currentTeamPermissionItems:t}}function de(e){let{roles:t,currentRole:s}=e;return t.filter((e=>(0,ne.IF)(e,s)))}function ce(e){let{roles:t,currentRole:s}=e;return t.filter((e=>(0,ne.SL)(e,s)))}var ue=s(52275),pe=s(31945),me=s(78140),ge=s(32163),he=s(72495),fe=s(24006),xe=s(4708),ye=s(60709),Se=s(98742);function ve(e){let{teamStore:t}=e;const{teamSettings:s,isInviteToggleVisible:n}=(0,o.VK)((()=>({teamSettings:t.getSettingsStore().getValue(),isInviteToggleVisible:(0,xe.s$)()})),[t]),i=(0,o.VK)((()=>{const e=t.getSettingsStore().getValue();if(e)return le({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t]);if(!s||!i)return null;const a=[(0,M.jsx)(Me,{teamStore:t,hasMultiInviteAccessOptions:1===i.settingsOptions.invite_access.length,inviteAccess:s.invite_access},"invite"),(0,M.jsx)(be,{teamStore:t,disablePageEdits:s.disable_team_page_edits},"editSidebar")];return n&&a.push((0,M.jsx)(je,{teamStore:t},"toggleInviteLink")),(0,M.jsx)(K.Ph,{title:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsSecurity.teamspaceSettingsTitle",defaultMessage:"Teamspace Security"}),rows:a,hideDividers:!0})}function be(e){const{teamStore:t,disablePageEdits:s}=e,a=(0,i.O7)(),l=L(t),d=(0,o.VK)((()=>{var e;return(null===(e=t.getTeamPermission())||void 0===e?void 0:e.role)??"none"}),[t]),c=(0,n.useCallback)((e=>{k.createAndCommit({userAction:"teamsHelpers.changeTeamSetting",environment:a,perform:s=>{O.$x({environment:a,store:t,update:{disable_team_page_edits:e},transaction:s})}})}),[a,t]),u=(0,se.J5)(d),p=[{option:!0,label:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>c(!0)}];return u&&p.push({option:!1,label:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>c(!1)}),(0,M.jsx)(Ce,{title:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.title",defaultMessage:"Who can edit teamspace sidebar"}),caption:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.caption",defaultMessage:"Adding, removing, or re-ordering sidebar pages"}),disabled:l||!u,currentOption:!u||Boolean(s),allOptions:p,optionTooltip:u?void 0:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsPermissions.settingSelect.whoCanEditTeamPages.teamMemberPermissionTooltip",defaultMessage:"Change member permissions to Can edit or Full access to allow teamspace members to edit the sidebar"})})}function Me(e){const{teamStore:t,hasMultiInviteAccessOptions:s,inviteAccess:o}=e,a=(0,D.q)(t),l=(0,i.O7)(),d=(0,n.useCallback)((e=>{k.createAndCommit({userAction:"team.setInviteAccess",environment:l,perform:s=>{O.$x({environment:l,store:t,update:{invite_access:e},transaction:s})}})}),[l,t]),c=!a||s;return(0,M.jsx)(Ce,{title:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.title",defaultMessage:"Who can invite teamspace members"}),disabled:c,optionTooltip:c&&a&&(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembersDisabled.caption",defaultMessage:"Change access level to Closed or Private to restrict who can invite teamspace members"}),currentOption:o,allOptions:[{option:"team_members",label:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamspaceMembers.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>d("team_members")},{option:"team_owners",label:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>d("team_owners")}]})}function je(e){const{teamStore:t}=e,s=(0,i.O7)(),n=(0,o.VK)((()=>m.U2(t)),[t]),l=L(t),d=(0,a.yK)((()=>({container:{display:"flex",justifyContent:"space-between"},subtitle:{marginBottom:5},switcher:{marginTop:5}})),[]);return(0,M.jsxs)("div",{style:d.container,children:[(0,M.jsxs)("div",{children:[(0,M.jsx)(F.Z,{children:(0,M.jsx)(r.FormattedMessage,{id:"TeamsecuritySection.inviteLink.label",defaultMessage:"Invite Link"})}),(0,M.jsx)(F.Z,{isSmall:!0,style:d.subtitle,children:(0,M.jsx)(r.FormattedMessage,{id:"TeamsecuritySection.inviteLink.description",defaultMessage:"Only users who can invite members can see the invite link"})})]}),(0,M.jsx)("div",{style:d.switcher,children:(0,M.jsx)(fe.Z,{disabled:l,on:!n,onClick:()=>{k.createAndCommit({userAction:"team.setInviteAccess",environment:s,perform:e=>{O.$x({environment:s,store:t,update:{disable_invite_link:!n},transaction:e})}})}})})]})}function Ce(e){const{title:t,caption:s,currentOption:n,allOptions:o,disabled:r,optionTooltip:l}=e,d=(0,i.Fy)(),c=(0,a.yK)((e=>({root:{display:"flex",alignItems:"center",width:"100%"},title:{fontSize:14,marginRight:8,flexGrow:1},divider:{marginTop:14,marginBottom:14},chevron:{width:10,marginLeft:4,fill:e.lightIconColor},buttonStyle:{fontSize:12.5,color:e.mediumTextColor},tooltipWidth:{width:300}})),[]),u=o.find((e=>e.option===n));return u?(0,M.jsxs)("div",{style:c.root,children:[(0,M.jsxs)("div",{style:c.title,children:[t,s&&(0,M.jsx)(F.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:1,width:"95%",marginBottom:5},children:s})]}),(0,M.jsx)(P.ZP,{style:c.tooltipWidth,placement:R.u.Top,alignment:R.v.Start,textWrap:!0,disableTooltip:!l,renderTooltip:()=>l,render:e=>(0,M.jsx)(pe.ZP,{...e,disablePopup:r,popupType:d.isMobile?pe.Z4.SlideUp:pe.Z4.Popup,alignmentToOrigin:pe.vR.End,renderOrigin:t=>(0,M.jsxs)(J.Z,{style:c.buttonStyle,disabled:r,...(0,Se.Z)(e,t),children:[u.label,!r&&(0,te.i)(c.chevron)]}),render:e=>{let t;t=d.isMobile?{menuType:ye.og.ActionSheet}:{menuType:ye.og.Popup,minWidth:150};const s=[{key:"options",render:e=>(0,M.jsx)(he.Z,{...e}),items:o.map((t=>{const s={key:t.option.toString(),render:e=>(0,M.jsx)(ue.Z,{...e,title:t.label,caption:t.caption,checkState:n===t.option}),action:()=>{t.action(),e.close()}};return s}))}];return(0,M.jsx)(me.Z,{...t,children:(0,M.jsx)(ge.Z,{type:ge.i.Vertical,initialFocus:void 0,sections:s})})}})})]}):null}function we(e){let{teamStore:t}=e;const{currentSpaceStore:s}=(0,o.Kw)(f.default),n=(0,i.O7)(),a=(0,ee.z)(),l="enterprise",d=n.currentUser.id,c=(0,o.VK)((()=>({disable_public_access:{spaceIsDisabled:(null==s?void 0:s.getDisablePublicAccess())??!1,teamIsDisabled:t.getDisablePublicAccess()},disable_export:{spaceIsDisabled:(null==s?void 0:s.getDisableExport())??!1,teamIsDisabled:t.getDisableExport()},disable_guests:{spaceIsDisabled:(null==s?void 0:s.getDisableGuests())??!1,teamIsDisabled:t.getDisableGuests()},disable_team_page_edits:{spaceIsDisabled:void 0,teamIsDisabled:t.getDisableTeamPageEdits()}})),[s,t]),u=(0,D.q)(t),p=(0,o.VK)((()=>(null==s?void 0:s.canAdmin())??!1),[s]);if(!s)return null;if(!d)return null;const m=e=>a||c[e].teamIsDisabled,g=e=>{if(!m(e))return!1;if(!u)return!1;const t=(e=>c[e].spaceIsDisabled&&c[e].teamIsDisabled)(e);return!t||p},h=e=>!m(e)&&p,x=e=>{const{teamIsDisabled:s,spaceIsDisabled:i}=c[e],o=!s;O.d({environment:n,store:t,settingName:e,newTeamSettingValue:Ze(o),spaceSettingValue:void 0===i?void 0:Ze(i)})},y=e=>{if((e=>c[e].spaceIsDisabled)(e))return(e=>c[e].teamIsDisabled)(e)?(0,M.jsx)(r.FormattedMessage,{id:"teamSettingsSecurity.basedOnWorkspaceSettings",defaultMessage:"Based on <underline>workspace settings</underline>",values:{underline:e=>(0,M.jsx)("span",{style:{textDecoration:"underline"},children:e})}}):(0,M.jsx)(r.FormattedMessage,{id:"teamSettingsSecurity.overridesWorkspaceSettings",defaultMessage:"Overriding <underline>workspace setting</underline>",values:{underline:e=>(0,M.jsx)("span",{style:{textDecoration:"underline"},children:e})}})},S=(0,M.jsx)(X.Z,{subscriptionTier:l,analyticsName:"team_security_settings",desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3}}),v=(0,M.jsx)(r.FormattedMessage,{id:"teamSettingsSecurity.setting.enterpriseGateToggleTooltip",defaultMessage:"Upgrade to Enterprise Plan to change security settings"}),b=[(0,M.jsx)(ps,{upsellTier:l,on:c.disable_public_access.teamIsDisabled,disabled:!g("disable_public_access"),onChange:()=>x("disable_public_access"),shouldTriggerUpsell:h("disable_public_access"),secondCaption:y("disable_public_access"),title:(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(r.FormattedMessage,{id:"teamSettingsSecurity.setting.shareTitle",defaultMessage:"Disable public page sharing"}),!m("disable_public_access")&&S]}),tooltip:!m("disable_public_access")&&v}),(0,M.jsx)(ps,{upsellTier:l,on:c.disable_guests.teamIsDisabled,disabled:!g("disable_guests"),onChange:()=>x("disable_guests"),shouldTriggerUpsell:h("disable_guests"),secondCaption:y("disable_guests"),title:(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(r.FormattedMessage,{id:"teamSettingsSecurity.setting.guestTitle",defaultMessage:"Disable guests"}),!m("disable_guests")&&S]}),tooltip:!m("disable_guests")&&v}),(0,M.jsx)(ps,{upsellTier:l,on:c.disable_export.teamIsDisabled,disabled:!g("disable_export"),onChange:()=>x("disable_export"),shouldTriggerUpsell:h("disable_export"),secondCaption:y("disable_export"),title:(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(r.FormattedMessage,{id:"teamSettingsSecurity.setting.exportTitle",defaultMessage:"Disable export"}),!m("disable_export")&&S]}),tooltip:!m("disable_export")&&v})];return(0,M.jsx)(ke,{teamStore:t,toggles:b})}function ke(e){let{teamStore:t,toggles:s}=e;const n=(0,a.yK)((e=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},spacer:{height:20,width:"100%"}})),[]),i=(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsSecurity.pageSettingsTitle",defaultMessage:"Page Security"});return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(ve,{teamStore:t}),(0,M.jsx)("div",{style:n.spacer}),(0,M.jsx)(K.Ph,{title:i,rows:s,hideDividers:!0}),(0,M.jsx)(U.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_security",containerStyle:n.learnMoreLinkContainer,message:(0,M.jsx)(r.FormattedMessage,{id:"teamSettingsSecurity.learnMore",defaultMessage:"Learn about teamspace security"})})]})}function Te(e){const t=(0,i.O7)();return(0,M.jsx)(M.Fragment,{children:(0,M.jsx)(J.Z,{style:e.style,icon:e=>(0,$.H)({...e,margin:"2px 17px 2px 2px",width:16,height:16}),onClick:()=>(e=>{let{teamStore:s,teamName:n}=e;return O.YH({environment:t,teamStore:s,teamName:n,from:"sidebar_team_modal"})})({teamName:e.teamName,teamStore:e.teamStoreInstance}),children:(0,M.jsxs)("div",{children:[(0,M.jsx)(F.Z,{children:(0,M.jsx)(r.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamButton",defaultMessage:"Restore teamspace"})}),(0,M.jsx)(F.Z,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,M.jsx)(r.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamCaption",defaultMessage:"Restoring this teamspace will add it to the sidebar for all teamspace members that were previously added."})})]})})})}function Ie(e){const t=(0,i.O7)(),s=(0,a.yK)((()=>({archiveLabel:{color:C.ZP.red}})),[]);return(0,M.jsx)(J.Z,{style:e.style,isRed:!0,icon:e=>(0,$.H)({...e,margin:"2px 17px 2px 2px",width:16,height:16}),disabled:e.disabled,disabledFeedback:e.disabled,onClick:()=>e.disabled?void 0:async function(e){let{teamStore:t,environment:s}=e;await O.aQ({environment:s,teamStore:t,from:"sidebar_team_modal"})}({environment:t,teamStore:e.teamStoreInstance}),...e.tooltipEvents,children:(0,M.jsxs)("div",{children:[(0,M.jsx)(F.Z,{style:s.archiveLabel,children:(0,M.jsx)(r.FormattedMessage,{id:"teamSettingsSecurity.dangerZone.archiveTeamButton",defaultMessage:"Archive teamspace"})}),(0,M.jsx)(F.Z,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,M.jsx)(r.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.archiveTeamDescription",defaultMessage:"Removes teamspace from the sidebar for all members"})})]})})}function Ze(e){return e?"disable":"allow"}const Pe=(0,r.defineMessages)({noDescription:{id:"TeamSettingsGeneral.generalSettings.noDescription",defaultMessage:"No description"}});function Fe(e){let{teamStore:t}=e;const s=(0,i.O7)(),l=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]),d=L(t),[c,u]=(0,n.useState)(void 0),[p,m]=(0,n.useState)(void 0),g=(0,a.yK)((()=>({container:{maxWidth:"none",marginLeft:4},nameAndIconWrap:{display:"flex",alignItems:"center",marginBottom:0,marginTop:4},icon:{marginRight:7},name:{height:20,background:"none",boxShadow:"none",padding:"0 8px"},description:{minHeight:20,background:"none",boxShadow:"none",padding:"0 8px",margin:"0 -8px"},updateButton:{marginTop:14},learnMoreLinkContainer:{marginTop:15,marginBottom:15}})),[20]),[h,x]=(0,o.VK)((()=>[t.getName(),t.getDescription()]),[t]);if(void 0===h)return null;const y=h||"",S=x??"",v=S.length>0,b=null==c?void 0:c.trim(),j=null==p?void 0:p.trim(),C=""===b||(void 0===p||j===S.trim())&&(void 0===c||b===y.trim()),T=(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.iconAndName.title",defaultMessage:"Icon and name"}),I=(0,M.jsxs)("div",{style:g.nameAndIconWrap,children:[(0,M.jsx)(W.p,{disabled:d,store:t,style:g.icon,size:20,onChange:e=>{k.createAndCommit({userAction:"TeamSettingsGeneral.updateIcon",environment:s,perform:s=>{O.fs({store:t,update:{icon:e},transaction:s})}})}}),d?(0,M.jsx)(F.Z,{children:y}):(0,M.jsx)(Ae,{value:c??y,style:g.name,onBlur:e=>{u(e)},onChange:e=>{u(e)},disabled:d,placeholder:"Acme Labs"})]}),P=(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.description.title",defaultMessage:"Description"}),R=A.default.formatMessage(Pe.noDescription),B=d?(0,M.jsx)(F.Z,{isMultiline:!0,isSecondaryColor:!v,children:v?S:R}):(0,M.jsx)(Ae,{value:void 0===p?S:p,onBlur:e=>{m(e)},onChange:e=>{m(e)},disabled:d,textarea:!0,autosize:!0,placeholder:R,style:g.description}),D=[(0,M.jsxs)(n.Fragment,{children:[(0,M.jsx)(F.Z,{isSmall:!0,children:T}),I]},"name"),(0,M.jsxs)(n.Fragment,{children:[(0,M.jsx)(F.Z,{isSmall:!0,children:P}),B]},"description")];return(0,M.jsxs)("div",{style:g.container,children:[(0,M.jsx)(K.Ph,{title:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.details",defaultMessage:"Details"}),rows:D}),!d&&(0,M.jsx)(Z.Z,{style:g.updateButton,disabled:C,isLarge:!0,onClick:async()=>{if(C)return;if(b&&b!==y.trim()){if(!(await(0,_.Xg)({environment:s,spaceStore:l,teamName:b})))return}const{performResult:e,serverCommitResult:n}=k.createAndCommit({userAction:"TeamSettingsGeneral.updateNameAndDescription",environment:s,perform:e=>{O.fs({store:t,update:{name:b??y,description:j??S},transaction:e})}});try{await Promise.all([e,n])}catch(i){return}w.oV({label:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsGeneral.settingsChanged",defaultMessage:"Updated teamspace details"})})},children:(0,M.jsx)(r.FormattedMessage,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"})}),(0,M.jsx)("br",{}),(0,M.jsx)(Y,{teamStore:t}),(0,M.jsx)(_e,{teamStore:t}),(0,M.jsx)(U.Z,{helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_team_settings_general",containerStyle:g.learnMoreLinkContainer})]})}function Ae(e){const{value:t,style:s,onBlur:i,onChange:o,placeholder:a,disabled:r}=e,[l,d]=(0,n.useState)(!1),c=(0,n.useRef)(null);return(0,M.jsx)(T.Z,{capture:l,render:n=>(0,M.jsx)(I.Z,{textarea:e.textarea,autosize:e.autosize,ref:c,onFocus:e=>{d(!0)},onBlur:e=>{d(!1),i(e.target.value)},onChange:e=>{d(!1),o&&o(e.target.value)},onSubmit:e=>{e.target.blur()},placeholder:a,disabled:r,value:t,style:s,...n})})}function _e(e){let{teamStore:t}=e;const s=(0,a.yK)((()=>({buttonStyle:{alignItems:"center",height:"auto",width:"100%",paddingTop:K.MQ,paddingBottom:K.MQ,paddingLeft:K.oM,paddingRight:K.oM}})),[]),[n,i]=(0,o.VK)((()=>[t.getName(),t.isArchived()]),[t]),l=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]),d=(0,D.q)(t),c=(0,N.e)(t),u=(0,V.y)(t.id),p=(0,B.n)(l),m=u&&!p;if(void 0===n||!c)return null;const g=[],h=(0,M.jsx)(E.Z,{buttonInternals:(0,M.jsx)(Re,{isTeamOwner:d}),teamStore:t,placement:R.u.Bottom,alignment:R.v.Start,from:"sidebar_team_modal",style:s.buttonStyle,icon:e=>j({...e,margin:"2px 17px 2px 2px",width:16,height:16}),isRed:!d});if(g.push(h),d)if(i)g.push((0,M.jsx)(Te,{teamStoreInstance:t,teamName:n,style:s.buttonStyle}));else{const e=(0,M.jsx)(P.ZP,{disableTooltip:!m,placement:R.u.Bottom,alignment:R.v.Start,renderTooltip:()=>(0,M.jsx)(r.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.cannotArchive",defaultMessage:"Cannot archive this teamspace because it is the only default teamspace in this workspace."}),render:e=>(0,M.jsx)(Ie,{disabled:m,teamStoreInstance:t,tooltipEvents:e,style:s.buttonStyle})});g.push(e)}return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("div",{style:{height:20,width:"100%"}}),(0,M.jsx)(K.Ph,{title:(0,M.jsx)(r.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.title",defaultMessage:"Danger zone"}),rows:g,itemStyle:{padding:0,margin:0}})]})}function Re(e){let{isTeamOwner:t}=e;const s=(0,a.yK)((()=>({label:{color:t?"inherit":C.ZP.red}})),[t]);return(0,M.jsxs)("div",{children:[(0,M.jsx)(F.Z,{style:s.label,children:(0,M.jsx)(r.FormattedMessage,{id:"teamBrowser.teamCard.button.leaveTeam",defaultMessage:"Leave teamspace"})}),(0,M.jsx)(F.Z,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,M.jsx)(r.FormattedMessage,{id:"teamBrowser.teamCard.button.leaveTeamDescription",defaultMessage:"Removes teamspace from your sidebar"})})]})}var Oe=s(35840),Be=s(77907),De=s(33052),Le=s(82740),Ve=s(38078);function Ne(e){let{teamStore:t}=e;const s=(0,a.yK)((e=>({container:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,background:e.modalBackground,zIndex:10,paddingBottom:8},input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12,width:"45%",maxWidth:260,marginRight:2},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]),n=(0,r.useIntl)(),[i,l]=(0,o.AF)(g.Z),[d,c,u]=(0,o.AF)(void 0,De.Z),p=(0,Le.e)(t),h=(0,o.VK)((()=>(0,xe.s$)()&&!m.U2(t)),[t]);return(0,M.jsxs)("div",{style:s.container,children:[(0,M.jsxs)("div",{children:[(0,M.jsx)(Be.LazyTeamPermissionsInviteWithModal,{store:t,permissionsInviteStore:u,origin:(0,M.jsx)(P.ZP,{placement:P.ug.Left,alignment:P.v2.Start,textWrap:!0,renderTooltip:()=>p?(0,M.jsx)("div",{style:{width:"max-content",maxWidth:150},children:(0,M.jsx)(r.FormattedMessage,{id:"teamPermissionsInviteWithModal.addMembers.tooltip",defaultMessage:"Add members and groups"})}):(0,M.jsx)("div",{style:{width:220},children:(0,M.jsx)(r.FormattedMessage,{id:"teamPermissionsInviteWithModal.addMembersNoPermissions.tooltip",defaultMessage:"You do not have permissions to add members to this teamspace"})}),render:e=>(0,M.jsx)(Z.Z,{disabled:!p,isLarge:!0,onClick:()=>{c({...d,modalOpen:!0})},...e,children:(0,M.jsx)(r.FormattedMessage,{id:"teamPermissionsInviteWithModal.openModal",defaultMessage:"Add members"})})})}),h&&(0,M.jsx)(Ve.u,{store:t,isSmall:!0})]}),(0,M.jsx)(I.Z,{placeholder:n.formatMessage({id:"teamPermissionsInviteWithModal.filterGroupsAndMembersInput.placeholder",defaultMessage:"Search for members or groups…"}),style:s.input,value:i.memberFilterQuery,onChange:e=>{l({...i,memberFilterQuery:e.target.value,limitMembers:!0})},left:(0,Oe.R)(s.searchIcon),showClearButton:!0,format:I.B.Small})]})}var Ee=s(58573),Ue=s(59054),We=s(62385),Ke=s(75246),ze=s(64684),qe=s(7928),Ge=s(86125),He=s(12793),Ye=s(31278),Qe=s(45653),$e=s(25735),Je=(s(21703),s(36591)),Xe=s(47307),et=s(61519),tt=s(61766),st=s(31194),nt=s(29369),it=s(7567),ot=s(46654);function at(e){const{teamStore:t,memberInfo:s,permissionItem:l,memberName:d,style:c,onMenuItemClicked:u,isPermissionOverridden:p}=e,m=(0,i.O7)(),g=(0,r.useIntl)(),h=(0,a.Fg)(),x=(0,n.useMemo)((()=>new tt.Z),[]),y=(0,a.yK)((e=>({header:{display:"flex",flexDirection:"column",backgroundColor:e.sidebarSecondaryBackground,fontSize:12,color:e.mediumTextColor,alignItems:"flex-start",paddingTop:10,paddingLeft:12,paddingRight:12,paddingBottom:10},overrideTitle:{display:"flex",alignItems:"center",justifyContent:"space-between",height:28},overrideLabel:{paddingLeft:8,color:e.mediumTextColor}})),[]),S=(0,o.VK)((()=>t.getTeamPermission()),[t]),v=(0,o.VK)((()=>{if(null==t||!t.isDefined())return;const e=g.formatMessage({id:"teamMemberPermissionRoleSelect.member.permissionitem.description",defaultMessage:"You can't give less access than the teamspace default. Lower teamspace members‘ access to enable this option."}),s=(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionItem.defaultTag",defaultMessage:"default"});function n(s){return(0,ne.bk)({teamValue:{id:t.id,permissions:t.getPermissionItems()},permissionRole:s})?{isDisabled:!0,disabledMessage:e}:void 0}return["editor","read_and_write","comment_only","reader"].map((e=>({role:e,disabledInfo:n(e),tag:(null==S?void 0:S.role)===e?s:void 0})))}),[S,g,t]);const b=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]),j=(0,o.VK)((()=>!("enterprise"===(null==b?void 0:b.getSubscriptionTier()))&&!p),[b,p]),C=(0,M.jsxs)("div",{style:y.overrideTitle,children:[(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.permissionsOverride",defaultMessage:"Custom permissions"}),j?(0,M.jsx)(X.Z,{subscriptionTier:"enterprise",analyticsName:"team_member_permission_override",desktopStyle:{marginLeft:8,marginRight:12}}):(0,M.jsx)(it.ZP,{role:"owner"===s.type?"none":l.role,table:nt.e0,type:"user"===s.entity_type?"user_permission":"group_permission",upgradeButtonName:"user"===s.entity_type?"user_permission_item":"group_permission_item",buttonStyle:{marginRight:0,fontSize:12,color:h.mediumTextColor,visibility:p?void 0:"hidden"},availableRoleItems:v,header:(0,M.jsx)(F.Z,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:600,marginLeft:16,marginTop:8},children:(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionOverride.menuHeader",defaultMessage:"Select custom role"})}),onChange:e=>{"none"!==e&&(!function(e){Xe.showDialog({message:(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.message",defaultMessage:"Are you sure you want to change {name}'s role to {role}?",values:{name:d,role:(0,ot.r_)(e).toLowerCase()}}),description:(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.description",defaultMessage:"This change won't apply to any restricted pages in the teamspace."}),showCancel:!0,keepFocus:!1,handleCancel:Xe.dismissDialog,items:[{label:(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:async()=>{const{serverCommitResult:n}=k.createAndCommit({userAction:"TeamMemberPermissionRoleSelect.handleRoleSelect",environment:m,perform:n=>{O.jg({memberInfo:s,teamStore:t,transaction:n,environment:m,permissionRole:e})}});await n,t.isDefault()&&(t.getMembershipDefinedOnTeam().some((e=>(0,ze.ah)(e,s)))||await O.Uj({environment:m,teamStore:t,teamMemberInfos:[s],isSettingDefaultTeam:!0,createNewTeamFlowId:void 0}))}}]})}(e),u&&u())},buttonPopupStore:x,placementToOrigin:st.Iw.Right,alignmentToOrigin:st.lU.End})]});return(0,M.jsx)(P.ZP,{placement:P.ug.Left,textWrap:!0,renderTooltip:()=>(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip",defaultMessage:"Set a custom permission level for all pages in this teamspace"}),render:e=>(0,M.jsx)(ue.Z,{...e,focused:!1,style:c,textWrapperStyle:{marginRight:0},disabled:j,onClick:()=>x.setState({open:!0}),title:C,icon:p?(0,M.jsx)("div",{style:{marginTop:8},children:(0,Je.e)({width:14})}):void 0})})}function rt(e){let{teamStore:t,memberInfo:s,permissionItem:n,memberName:a,isPermissionOverridden:l,disabled:c}=e;const u=(0,o.qz)(void 0,tt.Z),[p,g]=(0,o.AF)(u),h=(0,i.O7)(),x=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]),y=(0,o.VK)((()=>f.default.state.currentUserStore),[]),S=(0,o.VK)((()=>{const e=null==y?void 0:y.userId;return"user"===s.entity_type&&s.user_id===e}),[null==y?void 0:y.userId,s]),v=()=>g({...p,open:!1}),b=async e=>{v();const n="owner"===e?(0,M.jsx)(r.FormattedMessage,{defaultMessage:"owner",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelOwner"}):(0,M.jsx)(r.FormattedMessage,{defaultMessage:"member",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelMember"});if("team_level_guest"!==s.type||"owner"!==e&&"member"!==e)if("owner"===e){if("user"===s.entity_type){const{serverCommitResult:e}=k.createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:h,perform:e=>{O.W8({environment:h,userId:s.user_id,teamStore:t,transaction:e})}});await e}}else S?Xe.showDialog({message:(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionSettings.removeSelfTeamOwner.confirmation.message",defaultMessage:"Are you sure you want to remove yourself as a teamspace owner? You'll no longer be able to edit teamspace settings and permissions."}),showCancel:!0,keepFocus:!1,handleCancel:Xe.dismissDialog,items:[{label:(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:j}]}):await j();else{const i=(0,m.Mf)(s.user_id).length;Xe.showDialog({message:(0,M.jsx)(M.Fragment,{children:i>1?(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionSettings.upgradeGuestConfirmationWithOtherTeamspaces.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member, and they will become a member in {numberOfOtherTeams, plural, one {{numberOfOtherTeams} other teamspace} other {{numberOfOtherTeams} other teamspaces}}.",values:{memberOrOwner:n,numberOfOtherTeams:i-1}}):(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member.",values:{memberOrOwner:n}})}),showCancel:!0,keepFocus:!1,handleCancel:Xe.dismissDialog,items:[{label:(0,M.jsx)(r.FormattedMessage,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.accept",defaultMessage:"Add to workspace"}),color:"blue",onAccept:async()=>{if(x){const{serverCommitResult:n}=k.createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:h,perform:n=>{O.Ce({environment:h,userId:s.user_id,teamStore:t,transaction:n,spaceStore:x,newTeamRole:e})}});await n}}}]})}},j=async()=>{if("owner"===s.type&&"user"===s.entity_type){const{serverCommitResult:e}=k.createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:h,perform:e=>{O.mX({userId:s.user_id,teamStore:t,transaction:e,environment:h})}});await e}else if("member"===s.type){const{serverCommitResult:e}=k.createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:h,perform:e=>{O.X0({environment:h,memberInfo:s,teamStore:t,transaction:e})}});await e}},C=async()=>{const{entity_type:e}=s;switch(v(),e){case"group":const n=(0,z.TC)({spaceStore:x,groupId:s.group_id});if(!n)throw new Error("Permission group not found in space.");O.mN({environment:h,teamStore:t,group:n});break;case"user":await O.WO({environment:h,teamStore:t,currentSpaceStore:x,userId:s.user_id,from:"team_settings_member_table"});break;default:(0,d.t1)(e)}};return(0,M.jsx)(pe.ZP,{buttonPopupStore:u,placementToOrigin:st.Iw.Bottom,renderOrigin:e=>(0,M.jsx)(dt,{buttonPopupEvents:e,isPermissionOverridden:l,permissionItem:n,memberInfo:s,disabled:c}),render:()=>(0,M.jsx)(lt,{teamStore:t,isPermissionOverridden:l,memberInfo:s,permissionItem:n,memberName:a,onMenuItemClicked:b,onRemoveClicked:C,onSubMenuItemClicked:v}),popupType:pe.Z4.Popup})}function lt(e){let{teamStore:t,isPermissionOverridden:s,memberInfo:n,permissionItem:i,memberName:d,onRemoveClicked:u,onMenuItemClicked:g,onSubMenuItemClicked:h}=e;const x=(0,o.VK)((()=>{const{currentSpaceStore:e}=f.default.state;return!Boolean(null==e?void 0:e.getSettingsStore().getKeyStore("disable_team_guests").getValue())&&(0,xe.F$)()}),[]),y=(0,o.VK)((()=>t.isDefault()),[t]),S=(0,o.VK)((()=>(0,m.Hu)({membership:t.getKeyStore("membership").getValue()})),[t]),v=(0,o.VK)((()=>1===t.getMembers().filter((e=>"owner"===e.type)).length),[t]),b=(0,a.yK)((e=>{const t={paddingTop:5,paddingBottom:5},s={...t,width:280,alignItems:"flex-start"};return{actionMenu:{marginTop:-4},removeButton:{...t,color:e.errorText},menuItem:s,indentedMenuItem:{...s,paddingLeft:20},overrideLabel:{paddingLeft:10,color:e.mediumTextColor,fontSize:12,fontWeight:c.Z.fontWeight.regular}}}),[]),j=(e,t)=>{const n=("owner"===e||"team_level_guest"===e)&&"group"===t.entity_type,o="member"===e&&"owner"===t.type&&v,a="team_level_guest"===e&&("owner"===t.type||"member"===t.type),l=n||o||a;return{key:e,action:()=>g(e),render:d=>{const c=!s&&t.type===e;return(0,M.jsx)(P.ZP,{disableTooltip:!l,placement:P.ug.Right,textWrap:!0,renderTooltip:()=>n?"owner"===e?(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableOwnerForGroupsTooltip",defaultMessage:"Groups can't be teamspace owners"}):(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableTeamGuestForGroupsTooltip",defaultMessage:"Groups can't be teamspace guests"}):o?(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableWithOnlyOneOwnerTooltip",defaultMessage:"Add another teamspace owner to downgrade yourself to member"}):a?(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableDowngradeToGuestTooltip",defaultMessage:"To change this user to a teamspace guest, first remove them from the workspace."}):void 0,render:t=>(0,M.jsx)("span",{...t,children:(0,M.jsx)(ue.Z,{...d,style:c?b.menuItem:b.indentedMenuItem,disabled:l,disabledFeedback:l,title:(0,M.jsx)(ct,{isPermissionOverridden:s,type:e,permissionItem:i}),caption:pt(e),shouldWrapCaption:!0,icon:c?(0,Je.e)({width:14}):void 0})})})}}},C=y&&"user"===n.entity_type,w="group"!==n.entity_type,k="group"!==n.entity_type&&x,T=[{key:"teamRoles",items:l.oA([w?j("owner",n):void 0,j("member",n),k?j("team_level_guest",n):void 0,mt({onRemoveClicked:u,styles:b,isMemberInDefaultTeam:C}),..."owner"===n.type||S?[]:[{key:"divider",action:()=>{},render:()=>(0,M.jsx)(et.Z,{size:10})},{key:"permissions_override",action:()=>{},render:e=>(0,M.jsx)("span",{...e,children:(0,M.jsx)(at,{teamStore:t,memberInfo:n,permissionItem:i,memberName:d,onMenuItemClicked:h,isPermissionOverridden:s,style:s?b.menuItem:b.indentedMenuItem})})}]]),render:e=>(0,M.jsx)(he.Z,{...e,topBorder:0!==e.index})}];return(0,M.jsx)(me.Z,{className:p.a6i,menuType:ye.og.Popup,children:(0,M.jsx)(ge.Z,{type:ge.i.Vertical,initialFocus:void 0,sections:T})})}function dt(e){let{buttonPopupEvents:t,disabled:s,isPermissionOverridden:n,permissionItem:i,memberInfo:o}=e;const l=(0,a.yK)((e=>({label:{color:e.regularTextColor,fontSize:12.5,fontWeight:c.Z.fontWeight.regular},overrideLabel:{color:e.mediumTextColor,fontSize:12,fontWeight:c.Z.fontWeight.regular},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),u=function(e,t,s){if(t&&s)return function(e){switch(e){case"none":return(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.none",defaultMessage:"No access"});case"reader":return(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.reader",defaultMessage:"Can view"});case"comment_only":return(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.comment_only",defaultMessage:"Can comment"});case"content_only_editor":return(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.content_only_editor",defaultMessage:"Can edit content"});case"membership_admin":case"read_and_write":return(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.read_and_write",defaultMessage:"Can edit"});case"editor":return(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.editor",defaultMessage:"Full access"});default:(0,d.t1)(e)}}(s);return ut(e)}(o.type,n,i.role);return(0,M.jsxs)(J.Z,{disabled:s,...t,children:[n&&(0,M.jsxs)("span",{style:l.overrideLabel,children:[(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.custom",defaultMessage:"Custom"}),(0,M.jsx)("span",{style:{marginLeft:5,marginRight:5},children:"•"})]}),(0,M.jsx)("span",{style:l.label,children:u}),!s&&(0,te.i)(l.chevron)]})}function ct(e){let{isPermissionOverridden:t,permissionItem:s,type:n}=e;const i=ut(n);return(0,M.jsx)("div",{children:(0,M.jsx)("span",{children:i})})}function ut(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,M.jsx)(r.FormattedMessage,{...m.q9[e].label});case"none":return;default:(0,d.t1)(e)}}function pt(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,M.jsx)(r.FormattedMessage,{...m.q9[e].caption});case"none":return;default:(0,d.t1)(e)}}function mt(e){let{styles:t,onRemoveClicked:s,isMemberInDefaultTeam:n}=e;const i=n?(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.remove.disabledTooltip.cannotRemoveFromDefault",defaultMessage:"Members cannot be removed from a default teamspace."}):void 0;return{key:"remove",action:s,render:e=>(0,M.jsx)(P.ZP,{disableTooltip:!i,placement:P.ug.Right,textWrap:!1,renderTooltip:()=>i,render:s=>(0,M.jsx)("span",{...s,children:(0,M.jsx)(ue.Z,{...e,style:{...t.removeButton,...t.indentedMenuItem},disabled:Boolean(i),disabledFeedback:!0,title:(0,M.jsx)(r.FormattedMessage,{id:"TeamMemberOwnerSelect.remove",defaultMessage:"Remove"})})})})}}var gt=s(30765);function ht(e){const{icon:t,label:s,name:n,tag:i,style:o}=e,r=(0,a.yK)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",gap:10,...o},labelContainer:{display:"flex",flexDirection:"column",...c.Z.textOverflowStyle,marginLeft:5},name:{minWidth:30},nameContainer:{display:"flex",flexDirection:"row",alignItems:"center"}})),[o]);return(0,M.jsxs)("div",{style:r.container,children:[t,(0,M.jsxs)("div",{style:r.labelContainer,children:[(0,M.jsxs)("div",{style:r.nameContainer,children:[(0,M.jsx)(gt.s,{style:r.name,children:n}),i]}),s&&(0,M.jsx)(F.Z,{isSmall:!0,isSecondaryColor:!1,isMultiline:!0,children:(0,M.jsx)(gt.s,{children:s})})]})]})}function ft(e){const{iconComponent:t,label:s,name:n,permissionRoleSelectComponent:i,tag:o,tooltip:r,style:l}=e,d=(0,a.yK)((e=>({permissionRow:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:36,justifyContent:"space-between",alignItems:"center",...l}})),[l]);return(0,M.jsxs)("div",{style:d.permissionRow,children:[(0,M.jsx)(ht,{icon:t,name:n,tag:o,label:s,style:{minWidth:200,marginRight:6}}),(0,M.jsx)(P.ZP,{textWrap:!0,style:{width:210},disableTooltip:!r,placement:P.ug.Left,renderTooltip:()=>r,render:e=>(0,M.jsx)("span",{...e,children:i})})]})}function xt(e){const{type:t,store:s,permissionItem:n,memberInfo:l}=e,c=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]),u=(0,r.useIntl)(),p=(0,o.VK)((()=>{switch(t){case"group":return"none";case"user":const e=l.user_id;return null!=c&&c.isDefined()?c.getSpaceUserStore(e).getMembershipTypeAsRoleOrNone():"none";default:(0,d.t1)(t)}}),[t,l,c]),m=(0,D.q)(s),g=(0,o.VK)((()=>{const{currentSpaceStore:e}=f.default.state;return null==e?void 0:e.canEditMembership()}),[]),h=(0,i.O7)(),x=(0,o.VK)((()=>{const e=h.currentUser.id,t=s.getSettingsStore().getValue();return!!(null!=c&&c.isDefined()&&s.isDefined()&&t&&e)&&(0,ze.W9)({membership:s.getMembers(),settings:t,is_default:s.isDefault()},e,{permissions:c.getPermissionItems(),subscription_tier:c.getSubscriptionTier(),permission_groups:c.getPermissionGroups()})}),[h.currentUser.id,c,s]),y=(0,o.VK)((()=>{const e=s.getPermissionItems()||[];switch(l.entity_type){case"group":return!!e.find((e=>(0,se.hV)(e)&&e.group_id===l.group_id));case"user":return!!e.find((e=>(0,se.jg)(e)&&e.user_id===l.user_id));default:return!1}}),[l,s]),{name:S,label:v,icon:b}=(0,o.VK)((()=>{switch(t){case"group":return St({permissionGroup:e.permissionGroup,spaceId:null==c?void 0:c.id});case"user":return function(e){let{intl:t,userStore:s}=e;return{name:(0,qe.Nz)(t,null==s?void 0:s.getModel()),label:null==s?void 0:s.getEmail(),icon:(0,M.jsx)(Qe.Z,{avatarShouldShowShadow:!0,userStore:s,size:32})}}({intl:u,userStore:e.userStore});default:(0,d.t1)(t)}}),[t,e,u,null==c?void 0:c.id]),j=(0,M.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,M.jsx)(rt,{teamStore:s,memberInfo:l,memberName:S,permissionItem:n,isPermissionOverridden:y,disabled:!m&&!x||"team_level_guest"===l.type&&!g})}),C=(0,a.yK)((e=>({row:{minHeight:52},pill:{marginLeft:6,height:17}})),[]);return(0,M.jsx)(ft,{style:C.row,tag:(0,se.Bc)(p)?(0,M.jsx)(Ge.Z,{desktopStyle:C.pill,mobileStyle:C.pill,role:yt(p)}):"group"===t?(0,M.jsx)("div",{style:C.pill,children:b}):void 0,permissionRoleSelectComponent:j,iconComponent:"group"===t?(0,M.jsx)(He.Z,{size:32}):b,name:S,label:v})}function yt(e){switch(e){case"editor":return"admin";case"membership_admin":return"membership_admin";default:(0,d.t1)(e)}}function St(e){let{spaceId:t,permissionGroup:s}=e;const{name:n,user_ids:i,icon:o}=s,a=(null==i?void 0:i.length)??0;return{name:n??(0,M.jsx)(r.FormattedMessage,{id:"teamPermissionSettings.unknownGroup",defaultMessage:"Unknown Group"}),label:(0,M.jsx)(P.ZP,{placement:P.ug.Bottom,alignment:P.v2.Start,disableTooltip:0===a,renderTooltip:()=>(0,M.jsx)($e.Y,{group:s,limit:10,noMembersMessage:void 0}),render:e=>(0,M.jsxs)("div",{...e,children:[(0,M.jsx)(r.FormattedMessage,{id:"teamPermissionSettings.group",defaultMessage:"Group"})," • ",(0,M.jsx)(r.FormattedMessage,{id:"teamPermissionSettings.numberOfMembers",defaultMessage:"{groupSize, plural, one {{groupSize} member} other {{groupSize} members}}",values:{groupSize:a}})]})}),icon:o&&(0,M.jsx)(Ye.Z,{bucket:"public",disabled:!0,onChange:()=>{},isEmptyPage:!1,title:n,size:18,icon:o&&t?{icon:o,pointer:{table:Ke.bx,id:t}}:void 0})}}var vt=s(47453),bt=s(81023);function Mt(e){let{teamStore:t,...s}=e;const l=(0,i.O7)(),d=(0,o.VK)((()=>{var e;return null===(e=f.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),c=(0,r.useIntl)(),u=(0,a.yK)((()=>({container:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:52,justifyContent:"space-between",alignItems:"center"},pill:{marginLeft:6,height:17}})),[]),p=(0,n.useCallback)((e=>{w.oV({label:(0,M.jsx)(r.FormattedMessage,{id:"SpecificTeamMemberToAddRow.team_invite_failure",defaultMessage:"Failed to add {userOrGroupName}",values:{userOrGroupName:e}})})}),[]),m=(0,n.useCallback)((async(e,s)=>{await O.Uj({environment:l,teamMemberInfos:[e],teamStore:t,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})?await bt.bi(l):p(s)}),[l,p,t]),g=(0,n.useCallback)(((e,t)=>m({type:"member",entity_type:"user",user_id:e.id},t)),[m]),h=(0,n.useCallback)(((e,t)=>m({type:"member",entity_type:"group",group_id:e.id},t)),[m]);if("memberToAdd"in s){const{memberToAdd:e}=s,t=(0,qe.Nz)(c,e);return(0,M.jsxs)("div",{style:u.container,children:[(0,M.jsx)(ht,{icon:(0,M.jsx)(Qe.Z,{userValue:e,size:32}),name:t,label:e.email}),jt((()=>{g(e,t)}))]})}{if(!d)return(0,M.jsx)(M.Fragment,{});const{groupToAdd:e}=s,t=St({spaceId:d,permissionGroup:e});return(0,M.jsxs)("div",{style:u.container,children:[(0,M.jsx)(ht,{icon:(0,M.jsx)(He.Z,{size:32}),name:t.name,label:t.label,tag:(0,M.jsx)("div",{style:u.pill,children:t.icon})}),jt((()=>{h(e,t.name)}))]})}}function jt(e){return(0,M.jsx)(J.Z,{isBlue:!0,onClick:e,icon:vt.R,children:(0,M.jsx)(r.FormattedMessage,{id:"SpecificTeamMemberToAddRow.addMemberButton.text",defaultMessage:"Add"})})}var Ct=s(40745),wt=s(8597);function kt(e){let{sortType:t,onChangeSortType:s}=e;const n=(0,a.yK)((e=>({container:{width:"100%",display:"flex",justifyContent:"space-between",borderBottom:`1px solid ${e.regularDividerColor}`}})),[]),i=e=>e===t.column?t.sortedAscending?"ascending":"descending":"none",o=e=>{const n=e===t.column&&!t.sortedAscending;s({column:e,sortedAscending:n})};return(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)("div",{style:n.container,children:[(0,M.jsx)(Tt,{title:(0,M.jsx)(r.FormattedMessage,{id:"TeamPermissionsListHeader.nameColumn",defaultMessage:"Name"}),sortedType:i("name"),onClick:()=>o("name")}),(0,M.jsx)(Tt,{title:(0,M.jsx)(r.FormattedMessage,{id:"TeamPermissionsListHeader.roleColumn",defaultMessage:"Role"}),sortedType:i("role"),onClick:()=>o("role")})]})})}function Tt(e){let{sortedType:t,title:s,onClick:n}=e;const i=(0,a.yK)((e=>({button:{color:e.mediumTextColor,fontSize:12,padding:0},buttonHover:{background:"unset"},sortIcon:{width:14,height:14,marginRight:5,fill:e.mediumIconColor}})),[]);return(0,M.jsxs)(J.Z,{style:i.button,hoveredStyle:i.buttonHover,onClick:n,children:["ascending"===t&&(0,wt.Z)(i.sortIcon),"descending"===t&&(0,Ct.M)(i.sortIcon),s]})}function It(e){var t;let{store:s}=e;const l=(0,i.O7)(),u=(0,a.yK)((e=>({container:{display:"block",overflow:"hidden"},membersHeader:{marginBottom:8},noResult:{fontSize:c.Z.fontSize.UIRegular.desktop,color:e.mediumTextColor,marginTop:8},showMore:{marginBottom:24,width:"max-content"}})),[]),p=(0,r.useIntl)(),[h,x]=(0,n.useState)({column:"role",sortedAscending:!1}),[y]=(0,o.AF)(g.Z),S=(0,Le.e)(s),v=(0,o.VK)((()=>s.getMembers()),[s]),b=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]),j=(0,o.VK)((()=>f.default.state.currentUserStore),[]),{permissionRowInfos:C,numNotShown:w}=(0,o.VK)((()=>{const e=function(e){let{permissionRowInfos:t,memberFilterQuery:s,intl:n}=e;if(""===s)return t;return(0,Ee.ZP)(s,t,(e=>{const{type:t}=e;switch(t){case"group":return e.permissionGroup.name??"";case"user":const{userStore:s}=e;return s.getSearchName(n);default:(0,d.t1)(t)}}))}({permissionRowInfos:(0,m.tu)({currentUserStore:j,currentSpaceStore:b,teamStore:s,members:v}),memberFilterQuery:y.memberFilterQuery,intl:p}),t=function(e){let{permissionRowInfos:t,sortType:s,intl:n}=e;const{column:i,sortedAscending:o}=s,a={permissionRowInfos:t,sortedAscending:o};if("role"===i)return function(e){let{permissionRowInfos:t,sortedAscending:s}=e;const n=["owner","member","team_level_guest"],i=["group","user"];return[...t].sort(((e,t)=>{const s=e.memberInfo.entity_type,n=t.memberInfo.entity_type;return i.indexOf(s)-i.indexOf(n)})).sort(((e,t)=>{const i=e.memberInfo.type,o=t.memberInfo.type,a=n.indexOf(i)-n.indexOf(o);return s?-a:a}))}(a);if("name"===i)return function(e){let{permissionRowInfos:t,sortedAscending:s,intl:n}=e;return[...t].sort(((e,t)=>{const i=Zt(e,n)??"",o=Zt(t,n)??"";if(i===o)return 0;const a=i<o?-1:1;return s?-a:a}))}({...a,intl:n});(0,d.t1)(i)}({permissionRowInfos:e,sortType:h,intl:p}),n=y.limitMembers?t.slice(0,50):t;return{permissionRowInfos:n,numNotShown:e.length-n.length}}),[b,j,v,s,h,y.memberFilterQuery,y.limitMembers,p]),k=(0,Be.useDependency)(Be.deps.searchActions),[T]=(0,Ue.r5)((async()=>{var e;if(!S||null===(e=y.memberFilterQuery)||void 0===e||!e.trim().length||"resolved"!==k.status)return[];const t=k.value,s=(await t.searchVisibleSpaceUsers({environment:l,query:y.memberFilterQuery,membersOnly:!0})).map((e=>({type:"user",value:e}))),n=t.searchSpaceGroups({query:y.memberFilterQuery,intl:p}).map((e=>({type:"group",value:e}))),i=new Set(C.map(Ft));return[...s,...n].filter((e=>!i.has(e.value.id))).slice(0,5)}),[S,y.memberFilterQuery,l,p,C,k.status,k.value]),I=Boolean(null===(t=y.memberFilterQuery)||void 0===t?void 0:t.trim().length),Z=C.length>0,P="resolved"===T.status?T.value:[];return(0,M.jsxs)("div",{style:u.container,children:[(0,M.jsx)(Pt,{title:I?(0,M.jsx)(r.FormattedMessage,{id:"TeamPermissionsList.search.inThisTeam",defaultMessage:"In this teamspace"}):(0,M.jsx)(kt,{sortType:h,onChangeSortType:x}),rows:C,renderRow:e=>(0,M.jsx)(xt,{store:s,...e})}),w>0&&(0,M.jsx)(We.Z,{style:u.showMore,onClick:()=>{g.Z.setState({...y,limitMembers:!1})},children:(0,M.jsx)(r.FormattedMessage,{defaultMessage:"Show {numNotShown} more",id:"teamPermissionSettings.member.showMore",values:{numNotShown:w}})}),P.length>0&&(0,M.jsx)(Pt,{title:(0,M.jsx)(r.FormattedMessage,{id:"TeamPermissionsList.search.notInTeam",defaultMessage:"Not in teamspace"}),rows:P,renderRow:e=>"user"===e.type?(0,M.jsx)(Mt,{teamStore:s,memberToAdd:e.value}):(0,M.jsx)(Mt,{teamStore:s,groupToAdd:e.value})}),!Z&&0===P.length&&(0,M.jsx)("div",{style:u.noResult,children:(0,M.jsx)(r.FormattedMessage,{id:"TeamPermissionsList.search.zeroState",defaultMessage:"No members or groups found"})})]})}function Zt(e,t){const{type:s}=e;if("user"===s){const{userStore:s}=e;return s.getDisplayName(t)}if("group"===s){const{permissionGroup:t}=e;return t.name}(0,d.t1)(s)}function Pt(e){let{rows:t,renderRow:s,title:i}=e;const o=(0,a.yK)((e=>({membersList:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",width:"100%",marginBottom:12},memberDivider:{borderBottom:`1px solid ${e.regularDividerColor}`}})),[]);return t.length?(0,M.jsxs)(M.Fragment,{children:[i&&(0,M.jsx)(F.Z,{isSmall:!0,children:i}),(0,M.jsx)("div",{style:o.membersList,children:t.map(((e,t)=>(0,M.jsxs)(n.Fragment,{children:[t>0&&(0,M.jsx)("div",{style:o.memberDivider}),s(e)]},t)))})]}):null}function Ft(e){switch(e.type){case"user":return e.memberInfo.user_id;case"group":return e.memberInfo.group_id;default:(0,d.t1)(e)}}function At(e){let{teamStore:t}=e;const s=(0,a.yK)((()=>({content:{display:"grid",gridAutoFlow:"row",rowGap:6}})),[]);return(0,M.jsxs)("div",{style:s.content,children:[(0,M.jsx)(Ne,{teamStore:t}),(0,M.jsx)(It,{store:t})]})}var _t=s(79362);function Rt(e){const{teamStore:t}=e,s=(0,i.O7)(),n=(0,r.useIntl)(),{teamGuestPermissionItem:l,teamPermissions:d}=(0,o.VK)((()=>({teamGuestPermissionItem:t.getTeamGuestsPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),c=L(t),u=(0,o.VK)((()=>[{role:"editor",disabledInfo:{isDisabled:!0,disabledMessage:n.formatMessage({id:"teamPermissionsSettings.teamspace.guest.disabledPermissionitem.description",defaultMessage:"Teamspace guests can't have full access."})}},{role:"read_and_write",disabledInfo:void 0},{role:"comment_only",disabledInfo:void 0},{role:"reader",disabledInfo:void 0}]),[n]),p=(0,a.yK)((e=>({button:{fontSize:12.5,marginRight:0,color:e.mediumTextColor}})),[]),m=l&&(0,M.jsx)(it.ZP,{role:l.role,table:nt.e0,type:"explicit_team_guest_permission",upgradeButtonName:"team_permission_item",disabled:c,buttonStyle:p.button,availableRoleItems:u,onChange:async e=>{if(d.filter((t=>((0,se.jg)(t)||(0,se.hV)(t))&&(0,ne.xO)(e,t.role))).length>0){if(!(await(0,_.Bt)()))return}k.createAndCommit({userAction:"TeamGuestsPermissionRow.permissionComponent",environment:s,perform:n=>{O.$J({environment:s,teamStore:t,newRole:e,transaction:n,permissionsToClear:[]})}})}}),g=(0,o.VK)((()=>t.getName()),[t]),h=(0,o.VK)((()=>t.getIcon()),[t]),f=h&&_t.V2(h.icon)?_t.mk(h.icon):"gray",x=h?{...h,icon:`/icons/user-circle_${f}.svg`}:void 0,y=(0,M.jsx)(W.p,{disabled:!0,store:t,size:K.Kt,icon:x});return m?(0,M.jsx)(ft,{permissionRoleSelectComponent:m,iconComponent:y,name:Ot(g)}):null}function Ot(e){return e?(0,M.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,M.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessWithoutTeamspaceName"})}function Bt(e){const{teamStore:t}=e,s=(0,i.O7)(),n=(0,a.Fg)(),l=(0,r.useIntl)(),{teamPermissionItem:d,teamPermissions:c}=(0,o.VK)((()=>({teamPermissionItem:t.getTeamPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),u=L(t),p=(0,o.VK)((()=>{var e;const s=null===(e=t.getPermissionItems())||void 0===e?void 0:e.find((e=>"space_permission"===e.type)),n=l.formatMessage({id:"teamPermissionsSettings.teamspace.disabledPermissionitem.description",defaultMessage:"Teamspace members can't have lower permissions than workspace members"});function i(e){return s&&e!==s.role&&(0,ne.nl)(e,s.role)===s.role&&!t.isDefault()?{isDisabled:!0,disabledMessage:n}:void 0}return[{role:"editor",disabledInfo:i("editor")},{role:"read_and_write",disabledInfo:i("read_and_write")},{role:"comment_only",disabledInfo:i("comment_only")},{role:"reader",disabledInfo:i("reader")}]}),[l,t]),m=d&&(0,M.jsx)(it.ZP,{role:d.role,table:nt.e0,type:(0,se.zU)(d)?"explicit_team_permission":"team_permission",upgradeButtonName:"team_permission_item",disabled:u,buttonStyle:{fontSize:12.5,marginRight:0,color:n.mediumTextColor},availableRoleItems:p,onChange:async e=>{const n=c.filter((t=>((0,se.jg)(t)||(0,se.hV)(t))&&(0,ne.xO)(e,t.role)));if(n.length>0){if(!(await(0,_.Bt)()))return}k.createAndCommit({userAction:"TeamMembersPermissionRow.permissionComponent",environment:s,perform:i=>{O.xI({environment:s,teamStore:t,newRole:e,transaction:i,permissionsToClear:n})}})}}),{teamName:g}=(0,o.VK)((()=>({teamName:t.getName()})),[t]),h=(0,M.jsx)(W.p,{disabled:!0,store:t,size:K.Kt});return(0,M.jsx)(ft,{permissionRoleSelectComponent:m,iconComponent:h,name:Dt(g)})}function Dt(e){return e?(0,M.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,M.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutTeamspaceName"})}var Lt=s(19889),Vt=s(79414);function Nt(e){const{teamStore:t,teamOwnerIds:s}=e,n=(0,a.Fg)(),i=(0,o.VK)((()=>t.getName()),[t]),l=(0,o.VK)((()=>t.getTeamOwnerPermission()),[t]),d=(0,o.VK)((()=>f.default.state.currentUserStore),[]),c=(0,o.VK)((()=>d?s.map((e=>x.U6.createChildStore(d,{table:Lt.KJ,id:e}))):[]),[d,s]);return(0,M.jsx)(ft,{tooltip:(0,M.jsx)(r.FormattedMessage,{id:"TeamOwnersPermissionRow.teamspaceOwnersRowTooltip",defaultMessage:"Teamspace owners have full access to teamspace pages by default"}),permissionRoleSelectComponent:(0,M.jsx)(it.ZP,{role:"editor",table:nt.e0,type:l&&(0,se.LW)(l)?"explicit_team_owner_permission":"team_owner_permission",upgradeButtonName:"team_owner_permission_item",disabled:!0,buttonStyle:{fontSize:12.5,color:n.mediumTextColor,marginRight:0},availableRoleItems:[]}),iconComponent:(0,M.jsx)(Vt.n,{teamStore:t,ownerStores:c,isSmall:!0}),name:Et(i)})}function Et(e){return e?(0,M.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleName",values:{teamName:e}}):(0,M.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleNameWithoutTeamName"})}var Ut=s(16184),Wt=s(76464);function Kt(e){const{teamStore:t}=e,s=(0,i.O7)(),n=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]),{iconComponent:a,spaceName:r}=(0,o.VK)((()=>{if(!n)return{iconComponent:void 0,spaceName:void 0};const e=(0,z.rn)(s,n);return{iconComponent:(0,M.jsx)(W.p,{disabled:!0,store:n,size:K.Kt}),spaceName:e}}),[n,s]);return(0,M.jsx)(ft,{permissionRoleSelectComponent:(0,M.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:(0,M.jsx)(qt,{teamStore:t})}),iconComponent:a,name:zt(r)})}function zt(e){return e?(0,M.jsx)(r.FormattedMessage,{defaultMessage:"Everyone else in {spaceName}",id:"TeamMembersTopSection.permissionItem.defaultAccessSpaceName",values:{spaceName:e}}):(0,M.jsx)(r.FormattedMessage,{defaultMessage:"Everyone else in the workspace",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutSpaceName"})}function qt(e){const{teamStore:t}=e,s=(0,i.O7)(),n=(0,a.Fg)(),d=(0,o.VK)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),c=L(t),u=(0,o.VK)((()=>{const e=t.getSettingsStore().getValue();if(e)return le({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t],{useDeepEqual:!0});if(!u)return null;const p=u.permissionItemRoleOptions.spacePermission;if(1===p.length&&"none"===p[0])return(0,M.jsx)(P.ZP,{renderTooltip:()=>(0,M.jsx)(r.FormattedMessage,{id:"teamPermissionsSettings.privateTeam.noAccessTooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,M.jsxs)("div",{style:{display:"flex",alignItems:"center",maxWidth:170},...e,children:[(0,Ut.Q)({width:14,height:14,fill:n.timelineRed,marginRight:4}),(0,M.jsx)("div",{style:{fontSize:12.5,color:n.timelineRed,marginRight:8},children:(0,M.jsx)(r.FormattedMessage,{id:"teamPermissionsSettings.privateTeam.noAccessLabel",defaultMessage:"No access • Invite only"})})]})});{const e=l.MR(p,(e=>-se.xm[e])).map((e=>({role:e})));return(0,M.jsx)(it.ZP,{role:d.role,table:nt.e0,type:"space_permission",upgradeButtonName:"space_permission_item",disabled:c||1===p.length,buttonStyle:{fontSize:12.5,marginRight:0,color:n.mediumTextColor},availableRoleItems:e,onChange:e=>{const n={...d,role:e};k.createAndCommit({userAction:"TeamSpacePermissionRow.permissionComponent",environment:s,perform:e=>{Wt.ep({environment:s,store:t,permissionItems:[n],transaction:e})}})}})}}function Gt(e){let{teamStore:t}=e;const s=(0,o.VK)((()=>t.isDefault()),[t]),n=(0,o.VK)((()=>(0,ze.XO)({membership:t.getMembers()})),[t]),i=(0,o.VK)((()=>{const e=f.default.state.currentSpaceStore;if(!e)return!1;return!(null==e?void 0:e.getDisableTeamGuests())&&(!s&&(0,xe.F$)())}),[s]),r=(0,a.yK)((()=>({container:{marginLeft:15,marginRight:7,paddingBottom:4,paddingTop:4}})),[]);return(0,M.jsxs)("div",{style:r.container,children:[(0,M.jsx)(Nt,{teamStore:t,teamOwnerIds:n},"0"),(0,M.jsx)(Bt,{teamStore:t},"1"),i&&(0,M.jsx)(Rt,{teamStore:t},"2"),!s&&(0,M.jsx)(Kt,{teamStore:t},"3")]})}var Ht=s(14465);function Yt(e){let{teamStore:t}=e;const s=(0,a.yK)((()=>({spacer:{width:"100%",height:20},heading:{marginBottom:10}})),[]);return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Qt,{teamStore:t}),(0,M.jsx)("div",{style:s.spacer}),(0,M.jsx)(Ht.z,{title:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsMembers.memberSettings.membersTitle",defaultMessage:"Members"}),style:s.heading}),(0,M.jsx)(At,{teamStore:t})]})}function Qt(e){let{teamStore:t}=e;const s=(0,i.O7)(),l=(0,o.VK)((()=>t.getName()),[t]),d=(0,a.yK)((()=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},teamSettingsListItems:{padding:0,margin:0},accessButton:{border:"none"}})),[]),c=(0,n.useCallback)(((e,n)=>{O.Ju({environment:s,accessLevel:e,isDefault:n,store:t,teamName:l,from:"sidebar_team_modal"})}),[s,t,l]),u=(0,o.VK)((()=>t.getTeamAccessLevel()),[t]),p=[(0,M.jsx)(q._,{teamStore:t,currentAccessLevel:u,onChange:c,style:d.accessButton},"visibility"),(0,M.jsx)(Gt,{teamStore:t},"permissions")];return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(K.Ph,{title:(0,M.jsx)(r.FormattedMessage,{id:"TeamSettingsMembers.memberSettings.permissionsTitle",defaultMessage:"Permissions"}),rows:p,itemStyle:d.teamSettingsListItems}),(0,M.jsx)(U.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_permissions",message:(0,M.jsx)(r.FormattedMessage,{id:"teamSettingsPermissions.learnMore",defaultMessage:"Learn about teamspace permissions"}),containerStyle:d.learnMoreLinkContainer})]})}var $t=s(22487),Jt=s(3386),Xt=s(50506),es=s(76798),ts=s(53336),ss=s(29302),ns=s(13490),is=s(66957),os=s(74136);function as(e){return(0,M.jsx)(os.Z,{...e,children:(0,M.jsx)(r.FormattedMessage,{id:"sidebarTeamModalTab.unownedBadge",defaultMessage:"Unowned"})})}function rs(e){const{teamStore:t}=e,s=(0,o.VK)((()=>g.Z.state.tab),[]);if(void 0===s)return null;switch(s){case g.a.General:return(0,M.jsx)(Fe,{teamStore:t});case g.a.Members:return(0,M.jsx)(Yt,{teamStore:t});case g.a.Security:return(0,M.jsx)(we,{teamStore:t});default:(0,d.t1)(s)}}function ls(e){const{userId:t,currentSpaceStore:s}=e,{userStore:n,isDefined:i}=(0,o.VK)((()=>{const e=x.U6.createChildStore(s,{table:"notion_user",id:t,spaceId:s.id});return{userStore:e,isDefined:e.isDefined()}}),[s,t]);return i?(0,M.jsx)(ss.Z,{avatarShouldShowShadow:!0,userStore:n,style:{paddingRight:6,minHeight:34,lineHeight:1.2,fontSize:14,width:"100%"},avatarSize:24}):null}function ds(e){const{userIds:t,label:s,hasMarginTop:n}=e,i=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]);return i?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(ns.Z,{hasMarginTop:n,children:s}),t.map((e=>(0,M.jsx)(ls,{userId:e,currentSpaceStore:i},e)))]}):null}function cs(){const e=(0,i.O7)(),t=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]),s=(0,o.VK)((()=>f.default.state.currentSpaceViewStore),[]),n=(0,i.Fy)(),x=(0,a.yK)((e=>({modal:{width:n.isMobile?"auto":630,height:n.isMobile?"auto":640,maxWidth:"calc(100vw - 100px)",maxHeight:"calc(100vh - 100px)",borderRadius:5,overflow:"auto"},modalWrap:{userSelect:"none",WebkitUserSelect:"none",height:"100%"},innerWrap:{width:"100%",height:"100%",display:"flex",flexDirection:"column",paddingTop:20},header:{display:"flex",alignItems:"center",flexGrow:0,flexShrink:0,margin:"0px 36px"},tabBar:{display:"flex",width:void 0,flexGrow:0,flexShrink:0,margin:"0px 36px 20px"},scroller:{flexGrow:1},contentWrap:{margin:"0px 36px"},lockIcon:{width:16,marginLeft:6,marginBottom:1,fill:e.mediumIconColor},icon:{marginRight:8,fontWeight:c.Z.fontWeight.medium},unownedPill:{marginLeft:6,height:17},unownedPillInner:{display:"flex",height:"100%",alignItems:"center",color:e.regularTextColor,fontWeight:c.Z.fontWeight.regular,textTransform:"unset",fontSize:11}})),[n.isMobile]),{open:y,tab:b,teamStore:j}=(0,o.VK)((()=>{const{open:e,tab:t}=g.Z.state;return{open:e,tab:t,teamStore:g.Z.getTeamStore()}}),[]),C=(0,o.VK)((()=>null==j?void 0:j.getSettings()),[j]),w=(0,D.q)(j);if(!t||!s||!j)return null;const k=[g.a.General,g.a.Members,g.a.Security];return(0,M.jsx)(Xt.Z,{open:y,innerStyle:x.modal,onDismiss:()=>{g.Z.reset()},render:()=>y?(0,M.jsx)("div",{className:p.rIj,style:{height:"100%"},children:(0,M.jsx)("div",{style:x.modalWrap,children:(0,M.jsx)(Jt.Z,{debugName:"SidebarTeamModal",capture:!0,onBackspace:l.yR,onLeft:l.yR,onRight:l.yR,onSelectAll:l.yR,onRedo:l.yR,onUndo:l.yR,onCut:l.yR,onCopy:l.yR,onPaste:l.yR,onKeypress:l.yR,onDelete:l.yR,onTab:l.yR,children:(0,M.jsxs)("div",{style:x.innerWrap,children:[(0,M.jsxs)("div",{style:x.header,children:[(0,M.jsx)(W.p,{disabled:!0,store:j,size:24,style:x.icon}),(0,M.jsx)(es.Z,{store:j,style:{fontSize:16,fontWeight:c.Z.fontWeight.semibold}}),(0,m.C2)(C)&&(0,M.jsx)(v.Z,{iconStyle:x.lockIcon}),(0,m.Hu)({membership:j.getRawMembership()})&&(0,M.jsx)("div",{style:{gap:5,display:"flex"},children:(0,M.jsx)(as,{desktopStyle:x.unownedPill,mobileStyle:x.unownedPill,innerStyle:x.unownedPillInner})}),(0,M.jsx)("div",{style:{flexGrow:1}}),(0,M.jsx)(S.M,{teamStore:j,onLeavingTeam:()=>g.Z.reset(),from:"sidebar_team_modal",navigateToTeamHomeOnJoin:!1})]}),(0,M.jsx)(is.Z,{tabs:k.map((e=>function(e,t){switch(e){case g.a.General:return(0,M.jsx)(r.FormattedMessage,{id:"sidebarTeamModalTab.option.general",defaultMessage:"General"});case g.a.Members:return(0,M.jsx)(us,{teamStore:t});case g.a.Security:return(0,M.jsx)(r.FormattedMessage,{id:"sidebarTeamModalTab.option.security",defaultMessage:"Security"});default:(0,d.t1)(e)}}(e,j))),selectedIndex:(0,d.$K)(b)?k.indexOf(b):1,onChange:t=>{y&&(u.rF(e,{store:j,tab_old_value:b??g.a.General,tab_new_value:k[t]}),g.Z.update((e=>e.open?{...e,tab:k[t]}:e)))},tabStyle:{marginLeft:-8},style:x.tabBar,tabTitleStyle:{marginLeft:8,marginRight:8}}),(0,M.jsx)(ts.Z,{type:h.Z.Y,style:x.scroller,children:(0,M.jsx)("div",{style:x.contentWrap,children:(0,M.jsx)(rs,{currentSpaceStore:t,teamStore:j,userIsTeamOwner:w})})})]})})})}):null})}function us(e){let{teamStore:t}=e;const s=(0,$t.K)(t),n=(0,a.Fg)();return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(r.FormattedMessage,{id:"sidebarTeamModalTab.option.members",defaultMessage:"Members"}),(0,M.jsx)("span",{children:" "}),(0,M.jsx)("div",{style:{color:n.lightTextColor},children:s})]})}function ps(e){let{title:t,caption:s,secondCaption:n,on:o,disabled:r,tooltip:l,style:d,onChange:c,shouldTriggerUpsell:u,upsellTier:p}=e;const m=(0,i.O7)(),g=(0,a.yK)((()=>({root:{display:"flex",alignItems:"center",width:"100%",marginTop:0,marginBottom:0,cursor:u?"pointer":void 0,...d},title:{fontSize:14,marginRight:8,flexGrow:1},switcherWrap:{marginTop:5,marginRight:18}})),[d,u]);return(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)("div",{style:g.root,onClick:()=>{if(u)return y.y(m,{from:"team_security_settings",for:p,dontOpenPlansOnCancel:!0})},children:[(0,M.jsxs)("div",{style:g.title,children:[t,s&&(0,M.jsx)(F.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"95%"},children:s}),n&&(0,M.jsx)(F.Z,{isSmall:!0,children:n})]}),(0,M.jsx)("div",{style:g.switcherWrap,children:(0,M.jsx)(P.ZP,{disableTooltip:!l,renderTooltip:()=>l,render:e=>(0,M.jsx)("div",{...e,children:(0,M.jsx)(fe.Z,{on:o,disabled:r,onClick:c})})})})]})})}},636:(e,t,s)=>{s.r(t),s.d(t,{default:()=>I});s(67294);var n=s(83355),i=s(13991),o=s(480),a=s(86628),r=s(46225),l=s(36610),d=s(15944),c=s(84084),u=s(13447),p=s(68204),m=s(64286),g=s(60709),h=s(68056),f=s(31352),x=s(35328),y=s(5162),S=s(80444),v=s(27724),b=s(10743),M=s(24666),j=s(48019),C=s(78140),w=s(53437),k=s(85893);class T extends n.Z{UNSAFE_willMountOrUpdate(){let e=b.Z.state;if(e.open){var t;const s=M.default.state;if("editing"!==s.mode)return!1;const n=Z(e),i=(0,p.sG)({sections:P(e),context:{blocks:v.default.state.stores,environment:this.environment,publicEditMode:void 0},query:n||""});let o=0;if(n)if(0===i.length)o=n.length-e.lettersAtLastResult;else{const t={...e,lettersAtLastResult:(null==n?void 0:n.length)??0,filter:n};b.Z.setState(t),e=t}const{currentUserSettingsStore:a}=S.default.state;!a||null!==(t=a.getSettings())&&void 0!==t&&t.pressed_slash_tooltip||!(0,m.u)(this.environment)||d.q(this.environment);const{multiSelection:r}=s;(0,h.qS)(r)&&r.start.store===e.textStore&&!f.Ye(n,!0,i.length,o,e.textStore)||c.xv()}}renderComponent(){const{device:e}=this.environment,t=b.Z.state;return(0,k.jsx)(w.ZP,{popupType:e.isMobileNative&&!e.isTablet?w.ZP.PopupType.SlideUp:w.ZP.PopupType.Popup,open:t.open&&!(0,y.Y)("supportsNativeMobileDynamicActionBar"),originRect:t.open?t.selectionRect:void 0,placementToOrigin:w.ZP.Placement.Bottom,alignmentToOrigin:w.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,preventBlockRenderQueueOnEnter:!0,onDismiss:A,render:()=>(0,k.jsx)(_,{})})}}T.displayName="SlashMenu";const I=T;function Z(e){return f.zK(e.textStore,e.oldTextValue,(0,y.Y)("supportsNativeMobileDynamicActionBar")||!e.isAddMenu)}function P(e){const{insertActions:t,slashActions:s}=r.w.state;return e.isAddMenu?t:s}function F(){const e=b.Z.state;return e.open?e.filter.length:0}function A(){c.xv()}function _(){const e=(0,o.O7)(),t=(0,o.Fy)(),s=(0,a.VK)((()=>b.Z.state),[]),n=(0,a.VK)((()=>s.open?P(s):[]),[s]),r=(0,a.VK)((()=>s.open?Z(s):void 0),[s]),d=(0,a.VK)((()=>v.default.state.stores),[]);if(!s.open)return null;let p;return p=t.isMobileNative&&!t.isTablet?{menuType:g.og.ActionSheet}:{menuType:g.og.Popup,width:"fr-FR"===i.SP?375:324,maxHeight:"40vh",onClickOutside:c.xv},(0,k.jsx)(C.Z,{...p,children:(0,k.jsx)(j.Z,{sections:n,onAccept:(t,s,n,i)=>function(e,t,s,n,i){const o=v.default.state.stores[0];if(o){const t=o.getType(),s=o.getFormat();l.dh(n,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"slash_menu",block_id:o.id,block_type:t,is_toggleable:t?(0,x._A)(t,s):void 0,slash_menu_filter_length:F(),slash_menu_section:i,parent_collection_id:o.getParentCollectionIdUpToTwoLevels()})}u.createAndCommit({userAction:"SlashMenu.handleAccept",environment:n,perform:e=>{c.RL({environment:n,transaction:e})}})}(t,0,0,e,i),context:{environment:e,blocks:d,originRect:s.selectionRect,publicEditMode:void 0},filter:r,initialFocus:0,onEmptyEnter:A,useLimit:!0})})}},68012:(e,t,s)=>{s.d(t,{Z:()=>f});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(14577),l=s(84169),d=s(51454),c=s(69454),u=s(1310),p=s(84076),m=s(4827),g=s(85893);function h(){const[e,t]=(0,n.useReducer)(((e,t)=>{switch(t.type){case"push":return[...e.map((e=>({...e,isAnimatingOut:!0}))),{item:t.item,isAnimatingOut:!1}];case"delete":return e.filter((e=>e.item.key!==t.key));case"clear":return e.map((e=>({...e,isAnimatingOut:!0})));default:return e}}),[]);return(0,n.useEffect)((()=>{const e=new r.Z((()=>u.ZP.state.currentItem),{debugName:"currentItemStore"});let s=null;function n(){const n=e.state;n&&s!==n.key?(t({type:"push",item:n}),s=n.key):n||t({type:"clear"})}return e.addListener(n),()=>{e.removeListener(n)}}),[]),(0,g.jsx)(m.Z,{open:e.length>0,zIndex:201,children:e.map((e=>(0,n.createElement)(x,{...e,key:e.item.key,dispatch:t})))})}const f=n.memo(h),x=n.memo((function(e){let{dispatch:t,isAnimatingOut:s,item:r}=e;const u=(0,a.Fg)(),m=(0,i.O7)(),{WindowSizeStore:h,device:f}=m,x=(0,o.VK)((()=>c.Z.state.estimatedKeyboardWebViewOverlap),[]),y=(0,o.VK)((()=>c.Z.estimatedNativeWebBottomOverlap()),[]),S=(0,o.VK)((()=>h.getSafePaddingBottomCSS(24+y)),[24,y,h]),v=(0,n.useCallback)((()=>{t({type:"delete",key:r.key})}),[t,r.key]),b=(0,n.useRef)(s);(0,n.useEffect)((()=>{if(!b.current&&s){const e=setTimeout(v,270);return()=>{v(),clearTimeout(e)}}b.current=s}),[s,v]);const M=r.position??"bottom";let j=24;f.isMobileNative&&f.isIOS&&(j=x>0?24+y:S);const C="top"===M?{top:24}:{bottom:j};return(0,g.jsx)("div",{style:{...C,position:"fixed",left:0,width:"100%",display:"flex",zIndex:d.E,padding:4,pointerEvents:"none"},children:(0,g.jsxs)("div",{"aria-live":"polite",style:{background:u.tooltipBackground,color:u.regularInvertedTextColor,borderRadius:8,padding:"11px 16px",boxShadow:u.largeBoxShadow,margin:"0 auto",fontSize:14,display:"flex",alignItems:"center",pointerEvents:"auto",...r.style,animationName:`snackbar-slide-in-${M}`,animationDuration:"270ms",animationTimingFunction:"ease",transitionProperty:"transform, opacity",transitionDuration:"270ms",transitionTimingFunction:"ease",transform:s?"scale(0.95)":"scale(1)",opacity:s?0:1},onTransitionEnd:s?v:void 0,children:[r.label,r.helpUrl&&(0,g.jsx)(p.Z,{href:r.helpUrl,external:!0,style:{marginLeft:8,width:16,height:16,color:u.regularInvertedTextColor},children:(0,l.m)({fill:u.mediumInvertedTextColor})}),(0,g.jsx)("div",{style:{marginLeft:4,marginRight:-4},children:r.right})]})})}))},71482:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Sx});s(21703);var n=s(67294),i=s(83355),o=s(480),a=s(86628),r=s(24405),l=s(16184),d=s(45238),c=s(85893);const u=(0,d.IU)("magnifyingGlass",{viewBox:"0 0 16 16",svg:(0,c.jsx)("path",{d:"M1.321 6.28c0 .751.142 1.458.424 2.118a5.52 5.52 0 001.176 1.737 5.51 5.51 0 001.736 1.175 5.326 5.326 0 002.12.424c.592 0 1.157-.09 1.695-.273a5.639 5.639 0 001.476-.752l3.364 3.37a.8.8 0 00.266.171c.1.041.205.062.315.062a.766.766 0 00.683-.397.83.83 0 00.041-.718.715.715 0 00-.164-.253L11.11 9.581c.351-.456.625-.964.82-1.524.201-.56.301-1.153.301-1.778 0-.752-.14-1.456-.423-2.112a5.497 5.497 0 00-2.92-2.919A5.284 5.284 0 006.777.824c-.752 0-1.458.141-2.119.424a5.52 5.52 0 00-2.912 2.919 5.284 5.284 0 00-.424 2.112zm1.17 0A4.204 4.204 0 013.74 3.25a4.286 4.286 0 011.367-.923 4.179 4.179 0 011.668-.335 4.13 4.13 0 011.662.335 4.19 4.19 0 011.367.923c.392.392.7.848.922 1.367a4.13 4.13 0 01.335 1.661c0 .593-.111 1.149-.335 1.668a4.357 4.357 0 01-2.29 2.283 4.13 4.13 0 01-1.66.335 4.179 4.179 0 01-1.669-.335 4.357 4.357 0 01-2.29-2.283A4.254 4.254 0 012.49 6.28zM6.79 9.15c.114 0 .187-.066.219-.198.068-.369.137-.683.205-.943.068-.26.153-.474.253-.643.1-.173.23-.314.39-.424a2.01 2.01 0 01.628-.26 8.31 8.31 0 01.964-.184c.137-.018.205-.091.205-.219 0-.127-.068-.205-.205-.232a8.214 8.214 0 01-.97-.178 2.217 2.217 0 01-.643-.266 1.355 1.355 0 01-.403-.417 2.49 2.49 0 01-.246-.643 10.063 10.063 0 01-.178-.93c-.023-.136-.096-.205-.219-.205s-.2.066-.232.198c-.073.374-.144.69-.212.95A2.49 2.49 0 016.1 5.2c-.1.169-.233.308-.397.417a2.14 2.14 0 01-.622.26c-.255.064-.574.12-.957.17-.141.028-.212.106-.212.233 0 .123.07.196.212.22.479.05.864.12 1.155.211.292.087.518.216.677.39.164.173.287.41.37.71.086.297.163.675.232 1.135.009.06.034.11.075.15a.228.228 0 00.157.055z"})});var p=s(3791),m=s(47425),g=s(9291),h=s(53965),f=s(7032),x=s(37810),y=s(48298),S=s(7512),v=s(57549),b=s(14549),M=s(47307),j=s(91376),C=s(12714),w=s(29974),k=s(71119),T=s(54642);async function I(e,t){const s=await T.getEmailDomainSettings(e,{});"success"===s.type&&t.setState({...t.state,emailDomainSettings:s.data});try{const s=await(0,k.pu)(e);t.setState({...t.state,accountSettings:{...s,error:void 0}})}catch(n){t.setState({...t.state,accountSettings:{...t.state.accountSettings,error:n}})}}var Z=s(10259),P=s(13447),F=s(37181),A=s(53877),_=s(59730),R=s(80085),O=s(77420),B=s(19889),D=s(33954),L=s(33929),V=s(77907),N=s(22326),E=s(49085);class U extends E.default{getInitialState(){return{spaceId:void 0,allUserIds:new Set,allBotIds:new Set,removedUserIds:new Set,removedBotIds:new Set}}isUserOrBotRemoved(e){return Boolean(e&&(this.state.removedUserIds.has(e)||this.state.removedBotIds.has(e)))}}const W=new U;class K extends E.default{getInitialState(){return{cachedResponses:{}}}getCursor(e,t,s){if(s<=1||this.state.spaceId!==e)return;const n=(0,N.r)(t);if(this.state.filterStr!==n)return;const i=this.state.cachedResponses[s-1];return"success"===i.status?null==i?void 0:i.nextCursor:void 0}startLoading(e,t){this.updateResultHelper(e,t,{status:"loading"})}updateLoadedResult(e,t,s){this.updateResultHelper(e,t,{...s,status:"success",loadedAt:Date.now()})}updateError(e,t){this.updateResultHelper(e,t,{status:"error"})}updateResultHelper(e,t,s){const n=(0,N.r)(t);1!==t.pageNum&&this.state.spaceId===e&&this.state.filterStr===n?this.setState({spaceId:e,filterStr:n,cachedResponses:{...this.state.cachedResponses,[t.pageNum]:{...s}}}):this.setState({spaceId:e,filterStr:n,cachedResponses:{[t.pageNum||1]:{...s}}})}}const z=new K,q=(0,g.defineMessages)({loadCurrentAuditLogError:{id:"auditlog.error.loadCurrentAuditLogError",defaultMessage:"Failed to load audit logs"}});async function G(e){const{environment:t,spaceId:s}=e,n=await T.getHistoricalAuditLogUsers(t,{spaceId:s});return"success"!==n.type?[]:n.data.results}async function H(e){const{environment:t,spaceId:s}=e;if(W.getState().spaceId!==s&&W.reset(),!s)return;const n=await V.deps.searchActions.loader(),[i,o]=await Promise.all([n.searchSpaceActorIds({environment:t,membersOnly:!1}),G({environment:t,spaceId:s})]),a={spaceId:s,allUserIds:new Set,allBotIds:new Set,removedUserIds:new Set,removedBotIds:new Set};i.userIds.forEach((e=>{a.allUserIds.add(e)})),i.botIds.forEach((e=>{a.allBotIds.add(e)})),o.forEach((e=>{var t;(t=e.actorId)!==O._H.id&&t!==B.s$.id&&t!==B.el.id||a.allUserIds.has(e.actorId)?e.actorType!==B.KJ||a.allUserIds.has(e.actorId)?e.actorType!==O.cZ||a.allBotIds.has(e.actorId)||(a.allBotIds.add(e.actorId),a.removedBotIds.add(e.actorId)):(a.allUserIds.add(e.actorId),a.removedUserIds.add(e.actorId)):a.allUserIds.add(e.actorId)})),W.setState(a)}var Y=s(23399),Q=s(69651),$=s(23096),J=s(8319),X=s(66897),ee=s(22686),te=s(74136),se=s(97680),ne=s(6258),ie=s(27617);class oe extends E.default{getInitialState(){return{tempSelections:new Set([])}}setTempSelections(e){this.setState({tempSelections:new Set(e)})}}class ae extends i.Z{constructor(){super(...arguments),this.storeTypes={localStore:oe},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderResultMenuItem=(e,t)=>(0,c.jsx)(de,{item:e,props:t,auditLogHistoricalUserStore:this.props.auditLogHistoricalUserStore,parentStore:this.props.parentStore,localStore:this.stores.localStore})}didMount(){ce(this.props.selectedActors,this.stores.localStore)}renderComponent(){const{selectedActors:e,intl:t}=this.props,{localStore:s}=this.stores,n=(0,c.jsx)(g.FormattedMessage,{id:"auditlogActorFilter.title",defaultMessage:"User"});return(0,c.jsx)(J.Z,{mode:J.z.Pill,title:n,icon:ee.f,iconStyles:{marginRight:2},items:Array.from(s.state.tempSelections),hasItemsSelected:(null==e?void 0:e.length)>0,onChange:e=>{s.setTempSelections(e)},renderFooter:!0,allowApplyBatchSelection:!0,keepInputOnItemConfirm:!0,onMenuDismiss:e=>{"applyButton"!==e?ce(this.props.selectedActors,this.stores.localStore):function(e,t){const s=Array.from(t.state.tempSelections).map(ie.Ij).filter((e=>Boolean(e)));e(s)}(this.props.onChange,this.stores.localStore)},labelText:{title:n,tokenInputPlaceholder:t.formatMessage({defaultMessage:"Search user...",id:"auditlogActorFilter.searchActor.placeholder"}),resultSectionTitle:t.formatMessage({defaultMessage:"Select users",id:"auditlogActorFilter.searchActor.resultsTitle"}),componentDebugName:"SearchActorFilter"},performRequest:e=>async function(e,t,s,n){let{query:i,current:o}=e;const{allUserIds:a,allBotIds:r}=t.getState(),l=100,d=await V.deps.searchActions.loader(),c=await d.searchActorsById({environment:n,query:i,userIds:[...a],botIds:[...r]}),u=[...c.users.map((e=>`notion_user:${e.id}`)),...c.bots.map((e=>`bot:${e.id}`))];if(i.length>0)return u.slice(0,l);const p=s.map(ie.eW),m=new Set(p),g=u.filter((e=>!m.has(e)));return[...p,...g].slice(0,Math.max(p.length,l))}(e,this.props.auditLogHistoricalUserStore,this.props.selectedActors,this.environment),renderResultMenuItem:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderResultMenuItem,renderToken:()=>null,renderFilter:()=>null,renderItemForSummary:()=>null,addItemLabel:null,focused:!1})}}ae.displayName="AuditLogActorFilter";const re=(0,g.injectIntl)(ae);function le(e,t){const s=(0,ie.Ij)(e);return s?"notion_user"===s.actorType?(0,X.m3)(function(e,t){return ne.U6.createChildStore(t,{table:B.KJ,id:e}).getValue()}(s.actorId,t)):(0,X.ON)(function(e,t){return(0,ne.Kv)(t,{table:O.cZ,id:e}).getValue()}(s.actorId,t)):(0,X.m3)(void 0)}function de(e){let{item:t,props:s,auditLogHistoricalUserStore:n,parentStore:i,localStore:o}=e;const r=(0,g.useIntl)(),l=(0,a.qz)(o,oe),d=(0,a.VK)((()=>le(t,i)),[t,i]),u=(0,a.VK)((()=>l.state.tempSelections),[l]),p=(0,a.VK)((()=>{var e;return n.isUserOrBotRemoved(null===(e=d.asActor)||void 0===e?void 0:e.id)}),[d,n]);return(0,c.jsx)(se.Z,{...s,actor:d,useEmailAsTooltip:!0,checkState:u.has(t),userTitle:(0,c.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,X.$4)(r,d),p&&(0,c.jsx)(te.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"auditlogActorFilter.removed_user",defaultMessage:"Removed"})})]})})}function ce(e,t){const s=e.map(ie.eW);t.setTempSelections(s)}var ue=s(86100);const pe=(0,g.injectIntl)((function(e){const{spaceStore:t}=e,[s,n]=(0,a.AF)(N.Z),[i,o,r]=(0,a.AF)(W);return(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:4},children:[(0,c.jsx)($.Z,{mode:J.z.Pill,focused:!1,title:(0,c.jsx)(g.FormattedMessage,{id:"auditlogDateFilter.title",defaultMessage:"Date"}),icon:Q.C,value:s.timeRange,showButtons:"footer",onChange:e=>{n({...s,timeRange:e,pageNum:1})}}),(0,c.jsx)(re,{parentStore:t,auditLogHistoricalUserStore:r,selectedActors:s.actors,onChange:e=>{n({...s,actors:e,pageNum:1})}}),(0,c.jsx)(ue.Z,{parentStore:t,selectedEvents:s.actions,onChange:e=>{n({...s,actions:e,pageNum:1})}})]})}));var me=s(23189);function ge(){return(0,c.jsx)(me.Z,{large:!0,style:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:x.Z.fontWeight.medium,display:"flex",justifyContent:"space-between"},children:(0,c.jsx)("div",{style:{gap:8,display:"flex"},children:(0,c.jsx)(g.FormattedMessage,{id:"auditlog.title",defaultMessage:"Audit log"})})})}var he=s(81549),fe=s(61275),xe=s(75553),ye=s(893),Se=s(40394),ve=s(64921),be=s(26388),Me=s(64369),je=s(4708),Ce=s(77080),we=s(21752);function ke(e){const{auditLogEntry:t,spaceStore:s,id:i}=e,o=(0,g.useIntl)(),l=(0,a.VK)((()=>{if(t.actor.actorType===B.KJ){const e=ne.U6.createChildStore(s,{id:t.actor.actorId,table:B.KJ});if(e.isDefined()&&!e.getIsDeleted())return{actorStore:e};if(t.actor.email)return{avatar:{name:t.actor.name,email:t.actor.email}}}else if(t.actor.actorType===O.cZ){const e=ne.Qx.createChildStore(s,{id:t.actor.actorId,table:O.cZ});return e.isDefined()?{actorStore:e}:{avatar:{name:t.actor.name,email:t.actor.actorId}}}return{actorStore:void 0}}),[s,t]),d=(0,a.VK)((()=>{var e,t;if(l)return(null===(e=l.actorStore)||void 0===e?void 0:e.getDisplayName(o))??(null===(t=l.avatar)||void 0===t?void 0:t.name)}),[l,o]),u=(0,a.VK)((()=>{var e,t;if(l)return(null===(e=l.actorStore)||void 0===e?void 0:e.getDetail())??(null===(t=l.avatar)||void 0===t?void 0:t.email)}),[l]),p=(0,n.useMemo)((()=>{var e;if(t.actor.actorType===B.KJ)return(0,we.K)(null===(e=t.actor.meta)||void 0===e?void 0:e.spaceRole)}),[t]),m=(0,r.yK)((()=>({container:{display:"block",width:"100%",paddingBlock:6}})),[]),h=(0,n.createRef)();return(0,c.jsx)(be.ZP,{disableTooltip:Te(h.current),renderTooltip:()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{children:d}),(0,c.jsx)("div",{children:u})]}),placement:be.ug.Bottom,render:e=>(0,c.jsx)("div",{...e,style:m.container,children:(0,c.jsx)(we.Z,{id:i,...l,spaceRole:p})})})}function Te(e){return!!e&&(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)}var Ie=s(19044),Ze=s(33581),Pe=s(58015);const Fe={id:"actor",headerTitle:(0,c.jsx)(g.FormattedMessage,{id:"auditlog.logTable.userColumn.header",defaultMessage:"User"}),renderCell:e=>{const t=`actor-${e.auditLogEntry.actionName}-${e.id}`;return(0,c.jsx)(ke,{spaceStore:e.spaceStore,auditLogEntry:e.auditLogEntry,id:t})},widthData:{width:30},sortable:!1},Ae={id:"event",headerTitle:(0,c.jsx)(g.FormattedMessage,{id:"auditlog.logTable.eventColumn.header",defaultMessage:"Event"}),renderCell:e=>{const t=`event-${e.auditLogEntry.actionName}-${e.id}`;return(0,c.jsx)(Ze.p,{auditLogEntry:e.auditLogEntry,id:t})},widthData:{width:40},sortable:!1},_e={id:"dateTimeAndMenu",headerTitle:(0,c.jsx)(g.FormattedMessage,{id:"auditlog.logTable.dateColumn.header",defaultMessage:"Date"}),renderCell:e=>{const t=`actor-${e.auditLogEntry.actionName}-${e.id}`,s=`event-${e.auditLogEntry.actionName}-${e.id}`,n=`datetime-${e.auditLogEntry.actionName}-${e.id}`;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Ie.t,{auditLogEntry:e.auditLogEntry,id:n}),(0,c.jsx)(Be,{auditLogEntry:e.auditLogEntry,ids:{actorColumnId:t,eventColumnId:s,dateTimeColumnId:n}})]})},widthData:{width:25},sortable:!0},Re=[Fe,Ae,_e];function Oe(){return(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"40vh",flexDirection:"column"},children:[(0,c.jsx)("div",{children:(0,c.jsx)(Me.Z,{isSecondaryColor:!0,style:{fontWeight:500},children:(0,c.jsx)(g.FormattedMessage,{id:"auditlog.logTable.noResults",defaultMessage:"No results"})})}),(0,c.jsx)(Me.Z,{isSecondaryColor:!0,children:(0,c.jsx)(g.FormattedMessage,{id:"auditlog.logTable.noResultsHelpText",defaultMessage:"Try different filters. Logs may take some time to show up."})})]})}function Be(e){const{auditLogEntry:t,ids:s}=e,n=(0,a.VK)((()=>(0,je.F$)()),[]),i=(0,a.VK)((()=>Ce.default.checkGate("audit_log_event_name_column")?fe.pz:fe.C9),[]),l=(0,g.useIntl)(),d=(0,o.O7)(),u=(0,r.Fg)(),p=(0,r.yK)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"flex-end",width:"100%"},button:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:4}})),[]);return(0,c.jsx)(be.ZP,{delayThreshold:80,placement:be.ug.Bottom,render:e=>(0,c.jsx)("div",{style:p.container,...e,children:(0,c.jsx)(ve.Z,{style:p.button,onClick:()=>{var e;ye.RD({environment:d,stringValue:(0,fe.eA)({auditLogEntry:t,intl:l,getAuditLogEventText:(e=s.eventColumnId,t=>{var s;return null===(s=document.getElementById(e))||void 0===s?void 0:s.textContent}),isTeamGuestsEnabled:n,csvColumnNames:i}),copiedMessage:ye.tq.copiedToClipboard})},children:(0,xe.U)({width:16,height:16,fill:u.mediumIconColor})})}),renderTooltip:()=>(0,c.jsx)(g.FormattedMessage,{id:"AuditLogSettings.copyAuditLogEvent",defaultMessage:"Copy row"})})}const De=(0,g.injectIntl)((function(e){const{searchResponse:t,spaceStore:s}=e,[i,o]=(0,a.AF)(N.Z),l=t.results||[],d=t.hasMoreResults,u=Boolean(l.length),p=e=>{const t={...i,pageNum:e};o(t)},m=(0,r.yK)((e=>(0,Se.b)({columnRenderInfo:Re,theme:e,containerMarginTop:0})),[]),h=l.map(((e,t)=>({id:t.toString(),auditLogEntry:e,spaceStore:s,isClickable:!1}))),f=(0,n.useCallback)((()=>{const e=i.sortOrder===R.NQ.CreatedOldest?R.NQ.CreatedNewest:R.NQ.CreatedOldest;o({...i,sortOrder:e,pageNum:1})}),[i,o]),x=(0,n.useMemo)((()=>({column:_e,sortAscending:i.sortOrder===R.NQ.CreatedOldest})),[i]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Se.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:Re,rows:h,sortState:x,onSortStateChanged:f,renderNoRowsComponent:Oe,styles:m}),u?(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:10},children:[(0,c.jsx)(Pe.v,{onClick:()=>{p(i.pageNum-1)},disabled:1===i.pageNum,children:(0,c.jsx)(g.FormattedMessage,{id:"auditlog.logTable.previousPage",defaultMessage:"Previous"})}),(0,c.jsx)(Pe.v,{disabled:!d,onClick:()=>{p(i.pageNum+1)},children:(0,c.jsx)(g.FormattedMessage,{id:"auditlog.logTable.nextPage",defaultMessage:"Next"})})]}):null]})}));const Le=(0,g.injectIntl)((function(e){const{spaceStore:t}=e,s=(0,o.O7)(),i=null==t?void 0:t.id,[r]=(0,a.AF)(z),[l]=(0,a.AF)(N.Z),d=(0,N.r)(l)!==r.filterStr?void 0:r.cachedResponses[l.pageNum];return(0,n.useEffect)((()=>{i&&async function(e){var t,s;const{environment:n,spaceId:i}=e,o=N.Z.getState();z.startLoading(i,o);const{sortOrder:a,pageSize:r,pageNum:l}=o,d={spaceId:i,limit:r,cursor:z.getCursor(i,o,l),filters:{timeRange:{starting:o.timeRange.starting?A.OQ.toUnixMs(o.timeRange.starting):void 0,ending:o.timeRange.ending?A.OQ.toUnixMs(o.timeRange.ending):void 0},...(null===(t=o.actors)||void 0===t?void 0:t.length)>0?{actors:o.actors}:void 0,...(null===(s=o.actions)||void 0===s?void 0:s.length)>0?{actions:o.actions}:void 0},sort:a||R.NQ.CreatedNewest},c=await T.searchAuditLog(n,d);if("success"!==c.type)if(z.updateError(i,o),(0,_.Jx)(c.body)){const e=(0,D.wf)(L.default.getIntl(),c);M.showErrorMessage(e)}else M.showErrorMessage(L.default.formatMessage(q.loadCurrentAuditLogError));else z.updateLoadedResult(i,o,c.data)}({environment:s,spaceId:i})}),[s,i,l]),(0,n.useEffect)((()=>{H({environment:s,spaceId:i})}),[s,i]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(ge,{}),(0,c.jsxs)("div",{style:{justifyContent:"space-between",display:"flex",paddingTop:12,paddingBottom:12},children:[(0,c.jsx)(pe,{spaceStore:t}),(0,c.jsx)(Y.Z,{})]}),"loading"===(null==d?void 0:d.status)&&(0,c.jsx)(he.Z,{}),"success"===(null==d?void 0:d.status)&&(0,c.jsx)(De,{searchResponse:d,spaceStore:t})]})}));var Ve=s(28020),Ne=s(43250),Ee=s(8989),Ue=s(18514),We=s(95697),Ke=s(80444),ze=s(67940);class qe extends E.default{getInitialState(){return{status:"unconfigured",emailDomains:[],domainVerifications:[],spaces:[],createAccount:!1,useMetadataUrl:!0}}}const Ge=qe;var He=s(53680);class Ye extends E.default{getInitialState(){return{displaySummary:!0,openDropdown:!1,query:""}}}const Qe=new Ye;var $e=s(24026);class Je extends E.default{getInitialState(){return{name:"",domain:"",domainState:"current-space",emailDomains:[],publicHomePage:void 0}}getValueForSpace(e){const t=e.getPublicContentDomain(),s=e.getPublicHomePage();if(e.isDefined())return{name:e.getName()||"",domain:t||"",emailDomains:e.getEmailDomains(),domainState:"current-space",publicHomePage:s}}}const Xe=Je;class et extends E.default{getInitialState(){return{emailDomains:[],spaceCreation:"admins_only",settings:{}}}async updateValueForSpace(e){const{environment:t,spaceId:s,store:n}=e,i=await T.getEmailDomainsForSpace(t,{spaceId:s});if("failed"===i.type)return void M.showError(i);const{data:o}=i,a=Object.keys(o);return 0!==a.length?n.setState({emailDomains:a,spaceCreation:o[a[0]].spaceCreationEnum,settings:o[a[0]].settings}):n.setState(this.getInitialState()),n.state}}const tt=et;class st extends E.default{getInitialState(){return{uploadingProfilePhoto:!1,givenName:"",familyName:"",name:"",startDayOfWeek:(0,A.aN)(),accountSettings:{hasPassword:!1,canConfigurePassword:!1,isSamlEnforced:!1,mfaStatus:"loading",numMfaSettings:0,regenerateBackupCodes:!1,error:void 0}}}getValueForUser(e,t,s){if(e.isDefined()){const n=e.getFullName(s),i=e.getProfilePhoto(),o=t.getSettings();return{...this.state,uploadingProfilePhoto:!1,profilePhoto:i,name:n||"",startDayOfWeek:void 0===(null==o?void 0:o.start_day_of_week)?(0,A.aN)():null==o?void 0:o.start_day_of_week}}}}const nt=st;var it=s(92083),ot=s(98905),at=s(85703),rt=s(81023),lt=s(91496),dt=s(71095),ct=s(84747),ut=s(53336),pt=s(27386),mt=s(93108),gt=s(7220),ht=s(47409),ft=s(18442),xt=s(15967),yt=s(1436),St=s(36312);const vt=(0,d.IU)("settingsIntegration",{viewBox:"0 0 20 20",svg:(0,c.jsx)("path",{d:"M4.633 9.42h3.154c1.093 0 1.632-.532 1.632-1.656V4.655C9.42 3.532 8.88 3 7.787 3H4.633C3.532 3 3 3.532 3 4.655v3.109c0 1.124.532 1.655 1.633 1.655zm7.58 0h3.162C16.468 9.42 17 8.887 17 7.763V4.655C17 3.532 16.468 3 15.374 3h-3.16c-1.094 0-1.633.532-1.633 1.655v3.109c0 1.124.539 1.655 1.633 1.655zm-7.58-1.251c-.262 0-.382-.135-.382-.405V4.648c0-.27.12-.405.382-.405h3.146c.262 0 .39.135.39.405v3.116c0 .27-.128.405-.39.405H4.633zm7.588 0c-.262 0-.39-.135-.39-.405V4.648c0-.27.128-.405.39-.405h3.146c.262 0 .39.135.39.405v3.116c0 .27-.128.405-.39.405h-3.146zM4.633 17h3.154c1.093 0 1.632-.532 1.632-1.655v-3.109c0-1.124-.539-1.655-1.632-1.655H4.633C3.532 10.58 3 11.112 3 12.236v3.109C3 16.468 3.532 17 4.633 17zm7.58 0h3.162C16.468 17 17 16.468 17 15.345v-3.109c0-1.124-.532-1.655-1.626-1.655h-3.16c-1.094 0-1.633.531-1.633 1.655v3.109c0 1.123.539 1.655 1.633 1.655zm-7.58-1.25c-.262 0-.382-.128-.382-.398v-3.116c0-.277.12-.405.382-.405h3.146c.262 0 .39.128.39.405v3.116c0 .27-.128.397-.39.397H4.633zm7.588 0c-.262 0-.39-.128-.39-.398v-3.116c0-.277.128-.405.39-.405h3.146c.262 0 .39.128.39.405v3.116c0 .27-.128.397-.39.397h-3.146z"})}),bt=(0,d.IU)("settingsLanguage",{viewBox:"0 0 20 20",svg:(0,c.jsx)("path",{d:"M10 18.3281C14.3594 18.3281 17.9688 14.7109 17.9688 10.3594C17.9688 6 14.3516 2.39062 9.99219 2.39062C5.64062 2.39062 2.03125 6 2.03125 10.3594C2.03125 14.7109 5.64844 18.3281 10 18.3281ZM5.32812 5.29688C6.10938 4.57031 7.0625 4.02344 8.10938 3.71875C7.57031 4.26562 7.10938 5.03906 6.76562 5.99219C6.21094 5.8125 5.72656 5.57812 5.32812 5.29688ZM11.8984 3.72656C12.9375 4.03125 13.8828 4.57812 14.6719 5.30469C14.2734 5.58594 13.7891 5.8125 13.2344 5.99219C12.8906 5.04688 12.4297 4.27344 11.8984 3.72656ZM7.77344 6.25C8.21094 5.05469 8.82031 4.19531 9.49219 3.89844V6.42969C8.875 6.40625 8.30469 6.34375 7.77344 6.25ZM10.5156 3.89844C11.1797 4.19531 11.7891 5.05469 12.2266 6.25C11.6953 6.34375 11.125 6.40625 10.5156 6.42969V3.89844ZM3.10938 9.84375C3.21875 8.42188 3.77344 7.10156 4.63281 6.03906C5.11719 6.40625 5.74219 6.71094 6.46875 6.94531C6.24219 7.82031 6.10156 8.79688 6.0625 9.84375H3.10938ZM13.9375 9.84375C13.8984 8.79688 13.7578 7.82031 13.5312 6.94531C14.2578 6.71094 14.8828 6.40625 15.3594 6.04688C16.2266 7.10156 16.7812 8.42188 16.8906 9.84375H13.9375ZM10.5156 9.84375V7.45312C11.2188 7.42969 11.8906 7.34375 12.5234 7.21094C12.7266 8.01562 12.8516 8.90625 12.8906 9.84375H10.5156ZM7.10938 9.84375C7.14844 8.90625 7.28125 8.01562 7.47656 7.21094C8.10938 7.34375 8.78125 7.42969 9.49219 7.45312V9.84375H7.10938ZM3.10938 10.8672H6.0625C6.10156 11.9375 6.24219 12.9219 6.46875 13.8047C5.75 14.0391 5.13281 14.3438 4.65625 14.7031C3.78125 13.6328 3.21875 12.3047 3.10938 10.8672ZM7.10938 10.8672H9.49219V13.3047C8.78906 13.3281 8.11719 13.4141 7.49219 13.5391C7.28125 12.7266 7.14062 11.8203 7.10938 10.8672ZM10.5156 13.3047V10.8672H12.8906C12.8594 11.8203 12.7188 12.7266 12.5078 13.5391C11.8906 13.4141 11.2109 13.3281 10.5156 13.3047ZM13.5312 13.8047C13.7578 12.9219 13.8984 11.9375 13.9375 10.8672H16.8906C16.7812 12.3047 16.2188 13.6328 15.3438 14.7031C14.8672 14.3438 14.25 14.0391 13.5312 13.8047ZM10.5156 14.3281C11.1172 14.3516 11.6875 14.4062 12.2109 14.5078C11.7734 15.6719 11.1719 16.5312 10.5156 16.8281V14.3281ZM7.78906 14.5078C8.3125 14.4062 8.88281 14.3516 9.49219 14.3281V16.8281C8.82812 16.5312 8.22656 15.6719 7.78906 14.5078ZM13.2266 14.7578C13.7734 14.9375 14.25 15.1641 14.6484 15.4375C13.8672 16.1484 12.9375 16.6875 11.9062 16.9922C12.4297 16.4531 12.8828 15.6875 13.2266 14.7578ZM5.35156 15.4375C5.75 15.1641 6.22656 14.9375 6.77344 14.7578C7.11719 15.6875 7.57031 16.4531 8.10156 16.9922C7.07031 16.6875 6.13281 16.1484 5.35156 15.4375Z"})});var Mt=s(5108);const jt=(0,d.IU)("settingsNotifications",{viewBox:"3 1 17 17",svg:(0,c.jsx)("path",{d:"M5.36914 13.7627C5.36914 13.0381 6.03906 12.416 6.6543 11.8145C7.13965 11.3428 7.24902 10.3994 7.33789 9.46289C7.42676 6.87207 8.17871 5.14258 9.96289 4.49316C10.2227 3.59082 10.9814 2.90039 12 2.90039C13.0186 2.90039 13.7773 3.59082 14.0371 4.49316C15.8213 5.14258 16.5732 6.87207 16.6621 9.46289C16.751 10.3994 16.8672 11.3428 17.3457 11.8145C17.9678 12.416 18.6309 13.0381 18.6309 13.7627C18.6309 14.3369 18.2002 14.7266 17.4893 14.7266H14.6797C14.6182 16.0391 13.5518 17.2285 12 17.2285C10.4482 17.2285 9.38184 16.0322 9.32031 14.7266H6.51074C5.80664 14.7266 5.36914 14.3369 5.36914 13.7627ZM7.00293 13.4756H16.9834V13.3936C16.8125 13.1953 16.4297 12.833 16.0879 12.4434C15.623 11.9033 15.3975 10.9258 15.3291 9.62695C15.2539 6.85156 14.3994 5.92871 13.2988 5.62793C13.1279 5.58691 13.0322 5.50488 13.0186 5.32031C12.9912 4.62305 12.6016 4.1582 12 4.1582C11.3984 4.1582 11.0156 4.62305 10.9814 5.32031C10.9678 5.50488 10.8721 5.58691 10.708 5.62793C9.60059 5.92871 8.75293 6.85156 8.6709 9.62695C8.60254 10.9258 8.38379 11.9033 7.91211 12.4434C7.57715 12.833 7.18066 13.1953 7.00293 13.3936V13.4756ZM10.6123 14.7266C10.667 15.5811 11.2275 16.1348 12 16.1348C12.7793 16.1348 13.3398 15.5811 13.3877 14.7266H10.6123Z"})});var Ct=s(64530),wt=s(5517),kt=s(62397);const Tt=(0,d.IU)("settingsSubscription",{viewBox:"0 0 20 20",svg:(0,c.jsx)("path",{d:"M9 18.6191C13.9043 18.6191 17.9648 14.5498 17.9648 9.6543C17.9648 4.75 13.8955 0.689453 8.99121 0.689453C4.0957 0.689453 0.0351562 4.75 0.0351562 9.6543C0.0351562 14.5498 4.10449 18.6191 9 18.6191ZM9 17.125C4.85156 17.125 1.53809 13.8027 1.53809 9.6543C1.53809 5.50586 4.84277 2.18359 8.99121 2.18359C13.1396 2.18359 16.4619 5.50586 16.4707 9.6543C16.4795 13.8027 13.1484 17.125 9 17.125ZM5.07129 10.0586C5.07129 12.2559 6.82031 14.0225 8.99121 14.0225C11.1621 14.0225 12.9111 12.2559 12.9111 10.085C12.9111 9.75977 12.6299 9.49609 12.3047 9.49609C11.9795 9.49609 11.6982 9.75977 11.6982 10.085C11.6982 11.5967 10.4941 12.8096 8.99121 12.8096C7.48828 12.8096 6.28418 11.5967 6.28418 10.085C6.28418 8.58203 7.48828 7.38672 8.99121 7.38672C9.10547 7.38672 9.22852 7.38672 9.31641 7.4043L8.45508 8.24805C8.34961 8.35352 8.28809 8.49414 8.28809 8.65234C8.28809 8.95996 8.53418 9.20605 8.8418 9.20605C8.99121 9.20605 9.13184 9.13574 9.22852 9.03906L10.9336 7.33398C11.1533 7.13184 11.1357 6.73633 10.9336 6.52539L9.24609 4.80273C9.14941 4.69727 9 4.62695 8.8418 4.62695C8.52539 4.62695 8.28809 4.88184 8.28809 5.18945C8.28809 5.34766 8.34961 5.48828 8.44629 5.59375L9.07031 6.22656C9 6.21777 8.90332 6.20898 8.82422 6.20898C6.84668 6.20898 5.07129 7.90527 5.07129 10.0586Z"})});var It=s(72263),Zt=s(73039),Pt=s(85354),Ft=s(11751),At=s(46783),_t=s(69196),Rt=s(88893),Ot=s(35057),Bt=s(88280),Dt=s(74420),Lt=s(39849),Vt=s(59054),Nt=s(19584);class Et extends E.default{getInitialState(){return{recentRecoverableUsers:[],searchQuery:void 0,unreadMemberRequestsCount:0,unreadGuestRequestsCount:0}}}const Ut=new Et;function Wt(e){let{spaceStore:t,requestType:s}=e;const i=Kt({spaceStore:t}),r=(0,o.O7)(),[{value:l}]=(0,Vt.r5)((async()=>{if(!i)return;const e=await T.getAccessRequests(r,{parentTable:"space",parentId:t.id,size:100,status:"pending"});if("failed"===e.type)throw e.error;const n=e.data.accessRequestIds;return(await y.Vy(t,n)).filter((e=>e.requestType===s))}),[t,r,s,i]),d=(0,a.VK)((()=>null==l?void 0:l.filter((e=>"pending"===e.accessRequestStore.getKeyStore("status").getValue()))),[l]);return(0,n.useEffect)((()=>{if(!d)return;const{currentSpaceViewStore:e}=Ke.default.state;if(!e)return;const t=d.filter((t=>function(e){var t,s;let{requestType:n,currentSpaceViewStore:i}=e;const o=Date.now()-10*Nt._I,a="member"===n?null===(t=i.getSettings())||void 0===t?void 0:t.last_opened_member_request_tab:null===(s=i.getSettings())||void 0===s?void 0:s.last_opened_guest_request_tab;return a??o}({requestType:s,currentSpaceViewStore:e})<t.accessRequest.created_time)).length;"member"===s&&Ut.setState({...Ut.state,unreadMemberRequestsCount:t}),"guest"===s&&Ut.setState({...Ut.state,unreadGuestRequestsCount:t})}),[d,s]),{requests:d??[]}}function Kt(e){let{spaceStore:t}=e;return(0,a.VK)((()=>t.canEditMembership()&&(0,je.p1)()),[t])}function zt(e){let{requestType:t,spaceStore:s}=e;const i=(0,o.O7)(),a=Kt({spaceStore:s});(0,n.useEffect)((()=>{const{currentSpaceViewStore:e}=Ke.default.state;e&&a&&"member"!==t&&P.createAndCommit({userAction:"SpaceSettingsRequests.updateLastOpened",environment:i,perform:t=>{P.applyOperation({store:e,operation:{pointer:e.pointer,path:["settings","last_opened_guest_request_tab"],command:"set",args:Date.now()},transaction:t})}})}),[t,i,a]),(0,n.useEffect)((()=>()=>{const{currentSpaceViewStore:e}=Ke.default.state;e&&a&&"guest"!==t&&(P.createAndCommit({userAction:"SpaceSettingsRequests.updateLastOpened",environment:i,perform:t=>{P.applyOperation({store:e,operation:{pointer:e.pointer,path:["settings","last_opened_member_request_tab"],command:"set",args:Date.now()},transaction:t})}}),Ut.setState({...Ut.state,unreadMemberRequestsCount:0}))}),[t,i,a])}function qt(){const{currentSpaceStore:e}=(0,a.VK)((()=>Ke.default.state),[]);return e?(0,c.jsx)(Gt,{spaceStore:e}):null}function Gt(e){let{spaceStore:t}=e;Wt({spaceStore:t,requestType:"guest"}),Wt({spaceStore:t,requestType:"member"});const{count:s,styles:n}=function(){const e=(0,a.VK)((()=>{const{unreadMemberRequestsCount:e,unreadGuestRequestsCount:t}=Ut.state;return e+t}),[]),t=(0,r.yK)((e=>({container:{position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",right:6,top:6},badge:{top:-3,right:-5}})),[]);return{count:e,styles:t}}();return 0===s?null:(0,c.jsx)("div",{style:n.container,children:(0,c.jsx)(Lt.Z,{count:s,style:n.badge,color:Lt.N.Red})})}const Ht=(0,g.defineMessages)({accountTab:{id:"spaceSettingsSidebar.accountTab.title",defaultMessage:"My account"},settingsTab:{id:"spaceSettingsSidebar.settingsTab.title",defaultMessage:"Settings"},teamsTab:{id:"spaceSettingsSidebar.teamsTab.title",defaultMessage:"Teamspaces"},peopleTab:{id:"spaceSettingsSidebar.peopleTab.title",defaultMessage:"People"},membersTab:{id:"spaceSettingsSidebar.membersTab.title",defaultMessage:"Members"},plansTab:{id:"spaceSettingsSidebar.plansTab.title",defaultMessage:"Plans"},upgradeTab:{id:"spaceSettingsSidebar.upgradeTab.title",defaultMessage:"Upgrade"},billingTab:{id:"spaceSettingsSidebar.billingTab.title",defaultMessage:"Billing"},subscriptionTab:{id:"spaceSettingsSidebar.subscriptionTab.title",defaultMessage:"Subscription"},connectedAppsTab:{id:"spaceSettingsSidebar.connectedAppsTab.title",defaultMessage:"My connected apps"},userConnectionsTab:{id:"spaceSettingsSidebar.userConnectionsTab.title",defaultMessage:"My connections"},securitySAMLTab:{id:"spaceSettingsSidebar.securityAndSAMLTab.title",defaultMessage:"Security & identity"},securityTab:{id:"spaceSettingsSidebar.securityTab.title",defaultMessage:"Security"},identityProvisioningTab:{id:"spaceSettingsSidebar.identity&ProvisioningTab.title",defaultMessage:"Identity & provisioning"},sitesTab:{id:"spaceSettingsSidebar.sites.title",defaultMessage:"Sites"},adminContentSearchTab:{id:"spaceSettingsSidebar.adminContentSearch.title",defaultMessage:"Content search"},languageAndRegionTab:{id:"spaceSettingsSidebar.languageAndRegionTab.title",defaultMessage:"Language & region"},integrationsTab:{id:"spaceSettingsSidebar.integrationsTab.title",defaultMessage:"Integrations"},spaceConnectionsTab:{id:"spaceSettingsSidebar.spaceConnectionsTab.title",defaultMessage:"Connections"},experimentsTab:{id:"spaceSettingsSidebar.experimentsTab.title",defaultMessage:"Experiments"},auditLogTab:{id:"spaceSettingsSidebar.auditLogTab.title",defaultMessage:"Audit log"},notificationsAndSettings:{id:"spaceSettingsSidebar.notificationsAndSettings.title",defaultMessage:"My notifications & settings"},mySettings:{id:"spaceSettingsSidebar.mySettings.title",defaultMessage:"My settings"},myNotifications:{id:"spaceSettingsSidebar.myNotifications.title",defaultMessage:"My notifications"},debugZoneTab:{id:"spaceSettingsSidebar.debugZoneTab.title",defaultMessage:"Debug Zone"},analyticsTab:{id:"spaceSettingsSidebar.analyticsTab.title",defaultMessage:"Analytics"},importTab:{id:"spaceSettingsSidebar.importsTab.title",defaultMessage:"Import"}}),Yt={width:20,height:20},Qt={profile:e=>(0,_t.H)(Yt),notifications_and_settings:()=>(0,Ct.y)(Yt),user_settings:()=>(0,Ct.y)(Yt),notifications:()=>jt(Yt),connected_apps:()=>(0,yt.g)(Yt),language_and_region:()=>bt(Yt),settings:()=>(0,ft.H)(Yt),teams:()=>(0,Zt.K)(Yt),members:()=>(0,Mt.n)(Yt),plans:()=>{const e=Bt.subscriptionDataStoreInstance.state;return e&&Rt.YK(e)?(0,wt.q)(Yt):(0,It._)(Yt)},billing:()=>(0,xt.J)(Yt),subscription:()=>Tt(Yt),security:()=>(0,kt.I)(Yt),identity_provisioning:()=>(0,St.o)(Yt),admin_content_search:()=>(0,mt.p)(Yt),integrations:()=>vt(Yt),experiments:()=>(0,Ft.t)(Yt),audit_log:()=>(0,ht.N)(Yt),debug_zone:()=>(0,At.w)(Yt),analytics:()=>u(Yt),imports:()=>(0,gt.l)(Yt),sites:()=>(0,Pt.u)(Yt)},$t={profile:()=>`${L.default.formatMessage(Ht.accountTab)}`,notifications_and_settings:()=>L.default.formatMessage(Ht.notificationsAndSettings),user_settings:()=>L.default.formatMessage(Ht.mySettings),notifications:()=>L.default.formatMessage(Ht.myNotifications),connected_apps:()=>L.default.formatMessage(Ht.userConnectionsTab),language_and_region:()=>L.default.formatMessage(Ht.languageAndRegionTab),settings:()=>L.default.formatMessage(Ht.settingsTab),teams:()=>L.default.formatMessage(Ht.teamsTab),members:e=>(0,je.F$)()||(0,je.wE)(e)?L.default.formatMessage(Ht.peopleTab):L.default.formatMessage(Ht.membersTab),plans:()=>{const e=Bt.subscriptionDataStoreInstance.state;return e&&Rt.YK(e)?L.default.formatMessage(Ht.plansTab):L.default.formatMessage(Ht.upgradeTab)},billing:()=>L.default.formatMessage(Ht.billingTab),subscription:()=>L.default.formatMessage(Ht.subscriptionTab),security:()=>L.default.formatMessage(Ht.securityTab),identity_provisioning:()=>L.default.formatMessage(Ht.identityProvisioningTab),admin_content_search:()=>L.default.formatMessage(Ht.adminContentSearchTab),integrations:()=>L.default.formatMessage(Ht.spaceConnectionsTab),experiments:()=>L.default.formatMessage(Ht.experimentsTab),audit_log:()=>L.default.formatMessage(Ht.auditLogTab),debug_zone:()=>L.default.formatMessage(Ht.debugZoneTab),analytics:()=>L.default.formatMessage(Ht.analyticsTab),imports:()=>L.default.formatMessage(Ht.importTab),sites:()=>L.default.formatMessage(Ht.sitesTab)},Jt={profile:()=>null,notifications_and_settings:()=>null,user_settings:()=>null,notifications:()=>null,connected_apps:()=>null,language_and_region:()=>null,settings:()=>null,teams:()=>null,members:e=>(0,je.wE)(e)&&(0,c.jsx)(qt,{}),plans:()=>null,billing:()=>null,subscription:()=>null,security:()=>null,identity_provisioning:()=>null,sites:()=>(0,c.jsx)(Dt.Z,{}),admin_content_search:()=>null,integrations:()=>Ce.default.checkGate("webhooks_beta")&&Ot.Rs()?(0,c.jsx)(Dt.Z,{}):null,experiments:()=>null,audit_log:()=>null,debug_zone:()=>null,analytics:()=>null,imports:()=>null};var Xt=s(89728);const es=(0,g.defineMessages)({apply_credit:{id:"spaceSubscriptionBilling.applyCreditButton.label",defaultMessage:"Apply credit"},update:{id:"spaceSubscriptionBilling.updateButton.label",defaultMessage:"Update"},add:{id:"spaceSubscriptionBilling.addButton.label",defaultMessage:"Add"},apply:{id:"spaceSubscriptionBilling.apply.label",defaultMessage:"Apply"}});const ts=(0,g.injectIntl)((function(e){const t=(0,r.Fg)(),s={marginLeft:18,marginRight:-4,fontWeight:x.Z.fontWeight.medium},{title:n,caption:i,buttonArgs:o}=e,a=(0,c.jsx)(g.FormattedMessage,{...es[o.buttonPurpose]});return(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:14},children:[(0,c.jsx)("div",{style:{marginRight:"auto"},children:n}),(0,c.jsx)("div",{style:{color:t.mediumTextColor},children:i}),(0,c.jsx)("div",{style:{minWidth:110,display:"flex",justifyContent:"flex-end"},children:o.showButton&&(0,c.jsx)(Xt.Z,{isBlue:!0,onClick:o.onClick,style:s,children:a})})]})}));var ss=s(34859),ns=s(88632),is=s(93349);const os={workspaceBalance:(0,c.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.workspaceSubscriptionBalance.title",defaultMessage:"Workspace balance"}),applyCoupon:(0,c.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.applyCoupon.title",defaultMessage:"Apply coupon"}),discount:(0,c.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.discount.title",defaultMessage:"Discount"})};var as=s(31796),rs=s(27533),ls=s(94401);const ds={height:"100%",padding:"36px 60px"},cs={display:"flex",flexDirection:"column",height:"100%"};const us=function(e){let{data:t,spaceStore:s}=e;const n=(0,o.O7)(),i=(0,a.qz)(void 0,is.Z),r=(0,a.VK)((()=>ns.Z.state),[]),l=(0,a.VK)((()=>i.state),[i]);return(0,ct.Z)((()=>{rt.bi(n),rt.zb(n,i)})),r.online?(0,c.jsx)("div",{style:cs,children:(0,c.jsxs)(ut.Z,{style:ds,type:ss.Z.Y,children:[(0,c.jsx)(me.Z,{large:!0,divider:"full",children:(0,c.jsx)(g.FormattedMessage,{...Ht.billingTab})}),(0,c.jsx)(ps,{data:t}),(0,c.jsx)(ms,{}),(0,c.jsx)(as.V,{spaceStore:s,events:l.billingEvents,upcomingInvoiceData:void 0})]})}):(0,c.jsx)(pt.ZP,{children:(0,c.jsx)(Me.Z,{isSmall:!0,style:{textAlign:"center"},children:ls.s.offline})})};function ps(e){var t;let{data:s}=e;const n=null===(t=s.customerData)||void 0===t?void 0:t.stripe.currencyCode;if(!n)return null;const i=-Math.min(0,s.accountBalance);return(0,c.jsx)(ts,{title:os.workspaceBalance,caption:(0,c.jsx)("div",{children:(0,c.jsx)(rs.W,{cost:{amount:i,currencyCode:n},trailingZeroDisplay:"stripIfInteger"})}),buttonArgs:{showButton:!1,buttonPurpose:"apply_credit",onClick:h.ZT}})}function ms(){return(0,c.jsx)("div",{style:{flex:"none",marginTop:30}})}var gs=s(12544),hs=s(5220),fs=s(1898),xs=s(60396);class ys extends E.default{getInitialState(){return{loadingState:"uninitialized"}}}const Ss=new ys;async function vs(e){let{environment:t,messageStoreEmitValue:s}=e;if(!function(e){const t=Ss.state;if("loading"===t.loadingState)return!1;if(("uninitialized"===t.loadingState?void 0:t.messageStoreEmitValue)===e)return!1;return!0}(s))return!1;const{currentSpaceStore:n,currentUserStore:i}=Ke.default.state;if(!n||!i)return!1;"uninitialized"===Ss.state.loadingState&&Ss.setState({loadingState:"loading"});const o=await async function(e){var t;let{environment:s,currentSpaceStore:n,currentUserStore:i}=e;const o=n.getModel(),a=i.id,r=null===(t=n.getSpaceUserStore(a))||void 0===t?void 0:t.getModel();if(void 0===o||void 0===r)return;if((0,hs.RI)({space:o,spaceUser:r})){return await(0,We.sj)({environment:s,spaceStore:n,includeArchived:!0,currentUserId:a,minRoleOnTeamStores:"reader"})}return await(0,We.qX)({environment:s,spaceStore:n,includeArchived:!0,currentUserId:i.id})}({environment:t,currentSpaceStore:n,currentUserStore:i});if(!(0,fs.$K)(o))return Ss.setState({loadingState:"uninitialized"}),!1;const{archivedTeams:a,unarchivedTeams:r}=(0,We.tV)(o);return Ss.setState({loadingState:"loaded",archivedTeamIds:a.map((e=>e.id)),unarchivedTeamIds:r.map((e=>e.id)),messageStoreEmitValue:s}),!0}var bs=s(85579),Ms=s(75246),js=s(76463),Cs=s(98688),ws=s(61202),ks=s(23586),Ts=s(48779),Is=s(72087),Zs=(s(57658),s(9999)),Ps=s(80920),Fs=s(74181),As=s(90965),_s=s(94826),Rs=s(9953),Os=s(72371),Bs=s(74021),Ds=s(17549),Ls=s(30874),Vs=s(20454),Ns=s(22616),Es=s(44041),Us=s(33493),Ws=s(47453),Ks=s(31701),zs=s(77657),qs=s(9844),Gs=s(95477),Hs=s(60709),Ys=s(75822),Qs=s(52275),$s=s(78140),Js=s(28992),Xs=s(32163),en=s(31278),tn=s(72495),sn=s(78948);function nn(e){const{query:t}=e,s=(0,o.O7)(),i=(0,a.VK)((()=>Ke.default.state.currentSpaceStore),[]),r=(0,a.VK)((()=>null==i?void 0:i.getBotSettingsStore().getValue()),[i]),l="approved_or_built_by_notion"===(null==r?void 0:r.integration_restrictions),d=(0,a.VK)((()=>null!=r&&r.integration_approval_statuses?Object.keys(r.integration_approval_statuses):[]),[r]),u=(0,a.VK)((()=>Object.keys(zs.u2).map((e=>{const t=null==i?void 0:i.getRecordModel({id:e,table:qs.K2});if("published"===(null==t?void 0:t.status))return e})).filter(fs.$K)),[i]),p=(0,n.useMemo)((()=>u.some((e=>e===zs.f3))),[u]),m=(0,a.VK)((()=>u.filter((e=>!d.includes(e))).slice(0,5)),[d,u]);return(0,c.jsx)($s.Z,{menuType:Hs.og.Popup,width:255,header:rn(t,m,l),children:(0,c.jsx)(ks.Z,{request:t,performRequest:e=>async function(e){const{query:t,integrationType:s,environment:n,spaceId:i,approvedIntegrationIds:o,popularIntegrationIds:a,autoApproveBuiltByNotion:r}=e;if(!ns.Z.state.online||!i)return[];if((0,f.e)(t)||(0,f.qn)(t))return[t];if(""===t&&!r)return a;const l=await T.searchIntegrations(n,{query:t,type:s,spaceId:i});if("success"===l.type){const e=l.data.integrationIds.filter((e=>!o.includes(e))),t="production";if(!r){return e.sort(((e,s)=>(0,zs.BP)({integrationId:e,env:t})===(0,zs.BP)({integrationId:s,env:t})?0:(0,zs.BP)({integrationId:e,env:t})?-1:1)).slice(0,5)}return e.filter((e=>!(0,zs.BP)({integrationId:e,env:t}))).slice(0,5)}if("failed"===l.type)throw l.error;return(0,fs.t1)(l)}({query:e,environment:s,spaceId:null==i?void 0:i.id,approvedIntegrationIds:d,popularIntegrationIds:m,autoApproveBuiltByNotion:l}),debounce:Ys.vp,render:(n,o,a)=>{if(!o||!a)return(0,c.jsx)(tn.Z,{children:(0,c.jsx)(sn.Z,{})});const l=Fs.ns.filter((e=>t&&e.name.toLowerCase().includes(t.toLowerCase())&&!d.includes(e.id)&&(e.id!==Fs._o||!p))),u=[];if(0===o.length&&0===l.length)u.push({key:"no_results",render:()=>(0,c.jsx)(Me.Z,{isSmall:!0,style:{marginLeft:8},children:(0,c.jsx)(g.FormattedMessage,{id:"adminIntegrationSettings.search.label.noResults",defaultMessage:"No results"})}),action:()=>{}});else{const t=o.map((t=>{var n;const o={table:qs.K2,id:t};if(!i)return;const a=ne.y2.createChildStore(i,o),l=null===(n=a.getInfo())||void 0===n?void 0:n.icon;return{key:`${t}`,render:e=>{var t;return(0,c.jsx)(Qs.Z,{...e,title:(0,c.jsx)(Me.Z,{style:{fontWeight:x.Z.fontWeight.semibold},children:a.getName()}),icon:l&&(0,c.jsx)(en.Z,{disabled:!0,icon:{pointer:o,icon:l},isEmptyPage:!1,size:20}),style:l?{paddingBottom:12}:{paddingLeft:30,paddingBottom:12},shouldWrapCaption:!0,caption:(0,c.jsx)(ln,{tagline:null===(t=a.getInfo())||void 0===t?void 0:t.tagline,isNotionIntegration:(0,zs.BP)({integrationId:a.id,env:"production"})}),className:"notranslate"})},action:()=>{e.closeDropdown(),an({environment:s,currentSpaceStore:i,botSettings:r,integrationId:t})}}})).filter(fs.$K),n=l.map((t=>({key:`${t.id}`,render:e=>(0,c.jsx)(Qs.Z,{...e,title:(0,c.jsx)(Me.Z,{style:{fontWeight:x.Z.fontWeight.semibold},children:t.name}),icon:(0,c.jsx)("img",{src:t.info.icon,style:{height:20}}),caption:t.info.tagline,style:{paddingBottom:12},shouldWrapCaption:!0,className:"notranslate"}),action:()=>{e.closeDropdown(),an({environment:s,currentSpaceStore:i,botSettings:r,integrationId:t.id})}}))).filter(fs.$K);u.push(...t,...n)}return(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,c.jsx)(tn.Z,{...e}),items:u}]})}})})}function on(e){const{query:t}=e,s=(0,o.O7)(),n=(0,a.VK)((()=>Ke.default.state.currentSpaceStore),[]);return n?(0,c.jsx)($s.Z,{menuType:Hs.og.Popup,width:255,header:rn(t,[],!1),children:(0,c.jsx)(ks.Z,{request:t,performRequest:e=>async function(e){const{query:t,environment:s,spaceId:n}=e;if(!ns.Z.state.online||!n)return[];if((0,f.e)(t)||(0,f.qn)(t))return[t];const i=await T.searchIntegrations(s,{query:t,type:"compliance",spaceId:n});if("success"===i.type)return i.data.integrationIds;if("failed"===i.type)throw i.error;return(0,fs.t1)(i)}({query:e,environment:s,spaceId:null==n?void 0:n.id}),debounce:Ys.vp,render:(t,s,i)=>{if(!s||!i)return(0,c.jsx)(tn.Z,{children:(0,c.jsx)(sn.Z,{})});const o=[];if(0===s.length)o.push({key:"no_results",render:()=>(0,c.jsx)(Me.Z,{isSmall:!0,style:{marginLeft:8},children:(0,c.jsx)(g.FormattedMessage,{id:"adminIntegrationSettings.search.label.noResults",defaultMessage:"No results"})}),action:()=>{}});else{const t=Os.Z.state.loaded&&Ls.Z.state.loaded?Os.Z.state.webhookSubscriptions.map((e=>{var t;return null===(t=Ls.Z.getBotsAsRecordMap().getValue({table:O.cZ,id:e.bot_id}))||void 0===t?void 0:t.integration_id})):[],i=s.map((s=>{var i;const o=ne.y2.createChildStore(n,{id:s,table:qs.K2});if(t.includes(s))return;const a={table:qs.K2,id:s},r=ne.y2.createChildStore(n,a),l=null===(i=r.getInfo())||void 0===i?void 0:i.icon,d=(0,_s.I$)(r.id);return{key:`${s}`,render:e=>(0,c.jsx)(Qs.Z,{...e,title:(0,c.jsxs)("div",{style:{display:"flex",float:"left",alignItems:"center"},children:[(0,c.jsx)(Me.Z,{style:{fontWeight:x.Z.fontWeight.semibold},children:r.getName()}),(null==d?void 0:d.type)&&(0,c.jsx)("div",{style:{marginLeft:4},children:(0,c.jsx)(te.Z,{children:d.type})})]}),icon:l&&(0,c.jsx)(en.Z,{disabled:!0,icon:{pointer:a,icon:l},isEmptyPage:!1,size:20}),style:null!=d&&d.icon?{paddingBottom:12}:{paddingLeft:30,paddingBottom:12},shouldWrapCaption:!0,caption:(0,c.jsx)(ln,{tagline:null!=d&&d.tagline?L.default.formatMessage(null==d?void 0:d.tagline):"A SIEM or DLP partner",isNotionIntegration:!1})}),action:()=>{var t;e.closeDropdown();o.getModel()&&(null!=d&&null!==(t=d.oauth)&&void 0!==t&&t.accountInfoPropertyNames||"dlp"===(null==d?void 0:d.type))?Ds.Z.setState({open:!0,integrationId:r.id}):Bs.Z.setState({open:!0,integrationId:r.id})}}})).filter(fs.$K);o.push(...i)}return(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,c.jsx)(tn.Z,{...e}),items:o}]})}})}):null}function an(e){const{environment:t,currentSpaceStore:s,botSettings:n,integrationId:i}=e;if(s&&!(0,_s.z6)(i)){const e={...null==n?void 0:n.integration_approval_statuses,[i]:{type:"integration",status:"approved"}};P.createAndCommit({userAction:"AdminIntegrationSettingsSearchResults.handleIntegrationSelection",environment:t,perform:t=>{Rs.sW({store:s,data:{bot_settings:{...n,integration_approval_statuses:e}},transaction:t})}})}}function rn(e,t,s){return!e&&!s&&t.length>0&&(0,c.jsx)(Js.Z,{title:(0,c.jsx)(Me.Z,{isSmall:!0,style:{marginTop:4,fontWeight:x.Z.fontWeight.medium},children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Popular integrations",id:"adminIntegrationSettings.search.title.popularIntegrations"})})})}function ln(e){const{tagline:t,isNotionIntegration:s}=e,n=(0,r.Fg)(),i=s?{}:{maxHeight:52,overflow:"auto"};return t?(0,c.jsxs)("div",{style:i,children:[t,s&&(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:8},children:[(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Developed by Notion",id:"adminIntegrationSettings.search.subtitle.notionBuilt"}),(0,Ps.X)({marginLeft:3,width:12,height:12,fill:n.invoiceGreen})]})]}):null}var dn=s(74194),cn=s(53437);const un=(0,g.defineMessages)({searchInputPlaceholder:{id:"adminConnectionsSettings.search.input.placeholder",defaultMessage:"Add by name or integration ID"},complianceIntegrationSearchInputPlaceholder:{id:"adminConnectionsSettings.search.input.complianceIntegrationPlaceholder",defaultMessage:"Add by name"}});function pn(){const e=(0,o.MO)(),t=(0,r.Fg)(),[s,i]=(0,n.useState)(!0),[a,l]=(0,n.useState)(!1),[d,u]=(0,n.useState)(""),p=n.createRef();return s?(0,c.jsx)(ve.Z,{style:{display:"flex",alignItems:"center",height:28,fontWeight:x.Z.fontWeight.medium,fontSize:x.Z.fontSize.UIRegular.desktop,color:Ks.ZP.blue,padding:"0px 6px"},onClick:()=>{i(!1)},children:(0,c.jsx)(g.FormattedMessage,{id:"adminConnectionsSettings.search.button.label",defaultMessage:"{plusIcon} Add approved connection",values:{plusIcon:(0,Ws.R)({fill:Ks.ZP.blue,width:14,height:14,flexGrow:0,flexShrink:0})}})}):(0,c.jsx)(cn.ZP,{alignmentToOrigin:cn.ZP.Alignment.Start,keepFocus:e,onDismiss:()=>{var e;null===(e=p.current)||void 0===e||e.handleBlur(),i(!0),l(!1)},origin:(0,c.jsx)(dn.Z,{type:"text",style:{width:255},left:(0,Ws.R)({fill:t.lightIconColor,width:14,height:14,marginRight:8,flexGrow:0,flexShrink:0}),ref:p,value:d,onFocus:()=>{l(!0)},placeholder:L.default.formatMessage(un.searchInputPlaceholder),onChange:e=>u(e.target.value)}),open:a,popupType:cn.ZP.PopupType.Popup,style:{width:255},render:()=>(0,c.jsx)(nn,{query:d,closeDropdown:()=>l(!1)})})}function mn(){const e=(0,o.MO)(),t=(0,r.Fg)(),[s,i]=(0,n.useState)(!0),[a,l]=(0,n.useState)(!1),[d,u]=(0,n.useState)(""),p=n.createRef();return s?(0,c.jsx)(Xt.Z,{isBlue:!0,style:{display:"flex",alignItems:"center",height:28,fontWeight:x.Z.fontWeight.medium,fontSize:x.Z.fontSize.UIRegular.desktop,color:Ks.ZP.blue,padding:"0px 6px"},onClick:()=>{var e;i(!1),null===(e=p.current)||void 0===e||e.focusInput()},children:(0,c.jsx)(g.FormattedMessage,{id:"adminConnectionsSettingsAddComplianceMenu.search.button.label",defaultMessage:"{plusIcon} Add connection",values:{plusIcon:(0,Ws.R)({fill:Ks.ZP.blue,width:14,height:14,flexGrow:0,flexShrink:0})}})}):(0,c.jsx)(cn.ZP,{alignmentToOrigin:cn.ZP.Alignment.Start,keepFocus:e,onDismiss:()=>{var e;null===(e=p.current)||void 0===e||e.handleBlur(),i(!0),l(!1)},origin:(0,c.jsx)(dn.Z,{type:"text",style:{width:255},left:(0,Ws.R)({fill:t.lightIconColor,width:14,height:14,marginRight:8,flexGrow:0,flexShrink:0}),focus:!0,ref:p,value:d,onFocus:()=>{l(!0)},placeholder:L.default.formatMessage(un.complianceIntegrationSearchInputPlaceholder),onChange:e=>u(e.target.value)}),open:a,popupType:cn.ZP.PopupType.Popup,style:{width:255},render:()=>(0,c.jsx)(on,{query:d,closeDropdown:()=>{i(!0),l(!1)}})})}var gn=s(87446),hn=s(94512),fn=s(70578),xn=s(11066),yn=s(61519),Sn=s(58297),vn=s(42402),bn=s(55422),Mn=s(66957);const jn=["member_connections","workspace_connections"];function Cn(e){const t=(0,o.O7)(),{isMobile:s}=t.device,{guestBotIds:i}=e,l=(0,a.VK)((()=>Ke.default.state.currentSpaceStore),[]),d=(0,a.VK)((()=>Os.Z.webhookSubscriptions.state.reduce(((e,t)=>{const s=t.getBotId();return s&&(e[s]=t.id),e}),{})),[]),u=(0,a.VK)((()=>Ce.default.checkGate("webhooks_beta")||Ce.default.checkGate("e_discovery")),[]),p=(0,a.VK)((()=>l?(0,h.jj)([...i,...Ls.Z.bots.state.map((e=>e.id))]).map((e=>{const t=ne.Qx.createChildStore(l,{table:O.cZ,id:e,spaceId:l.id});return t.getAlive()?t:void 0})).filter(fs.$K):[]),[l,i]),m=(0,a.VK)((()=>function(e){return e.reduce(((e,t)=>{const s=t.getIntegrationId();if(!s)return e;return(0,_s.EY)(s)?(s in e.compliance||(e.compliance[s]=[]),e.compliance[s].push(t.id)):(s in e.nonCompliance||(e.nonCompliance[s]=[]),e.nonCompliance[s].push(t.id)),e}),{compliance:{},nonCompliance:{}})}(p)),[p]),f=(0,a.VK)((()=>function(e){return e.filter((e=>!e.getIntegrationId())).map((e=>e.id))}(p)),[p]),y=(0,a.VK)((()=>function(e,t){if(!t)return{};return e.reduce(((e,s)=>{const n=Vs.U.createChildStore(t,{table:B.KJ,id:s.getCreatedById()}),i=s.getIntegrationId();return i?e[i]=i in e?[...e[i],n]:[n]:e[s.id]=[n],e}),{})}(p,l)),[p,l]),S=(0,a.VK)((()=>null==l?void 0:l.getBotSettingsStore().getValue()),[l]),v=(0,a.VK)((()=>Object.keys(m.nonCompliance).length+f.length),[m.nonCompliance,f]),b=(0,a.VK)((()=>Object.values(m.compliance).flat().length),[m.compliance]),M=(0,a.VK)((()=>null!=S&&S.integration_approval_statuses?Object.keys(S.integration_approval_statuses).length+f.length:f.length),[S,f]),j={member_connections:(0,c.jsx)(g.FormattedMessage,{id:"admin.connections.tabs.member_connections",defaultMessage:"Member{numberOfIntegrations}",values:{numberOfIntegrations:0!==v&&(0,c.jsx)(Me.Z,{isSecondaryColor:!0,style:{marginLeft:6},children:v+Fs.T2.length})}}),workspace_connections:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(g.FormattedMessage,{id:"admin.connections.tabs.workspace_connections",defaultMessage:"Workspace{numberOfIntegrations}",values:{numberOfIntegrations:0!==b&&(0,c.jsx)(Me.Z,{isSecondaryColor:!0,style:{marginLeft:6},children:b})}}),(0,c.jsx)(Dt.Z,{})]})},w=jn.map((e=>j[e])),k=(0,a.VK)((()=>"integrations"===it.Z.state.currentTab?it.Z.state.defaultSubtab:void 0),[]),T=(0,a.VK)((()=>Os.Z.integrations.state),[]),[I,Z]=(0,n.useState)(k||"member_connections"),P=(0,a.VK)((()=>(0,Ot.wP)()),[]),F=(0,r.yK)((e=>({connectedSection:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"relative"},connectedSectionDescription:{fontSize:14,marginRight:8,color:e.lightTextColor,fontWeight:400,marginBottom:12},addMenu:{position:"absolute",right:0,top:0},discoverSectionUpsell:{backgroundColor:e.accentColors.uiBlue[100],padding:16,borderRadius:4},discoverSectionHeader:{display:"flex",justifyContent:"space-between",marginBottom:8},discoverSectionTitle:{fontSize:16,fontWeight:510},discoverSectionButtons:{display:"flex"},learnMoreButton:{padding:"0px 8px",borderRadius:4,display:"flex",alignItems:"center",color:e.blueColor},upgradeButton:{marginLeft:12,padding:"0px 14px"},alias:{marginLeft:6,width:"0.9em",height:"0.9em",padding:1,border:"1px solid",borderRadius:2}})),[]),A={member_connections:()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(wn,{}),(null==S?void 0:S.integration_restrictions)&&(0,c.jsx)("div",{style:{marginTop:"19px"},children:(0,c.jsx)(kn,{})}),(0,c.jsx)(yn.Z,{size:s?32:18,isHidden:!s}),Boolean(null==S?void 0:S.integration_restrictions)?(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:19},children:[(0,c.jsx)(Me.Z,{style:{fontWeight:x.Z.fontWeight.medium,display:"flex",alignItems:"center",height:28},children:(0,c.jsx)(g.FormattedMessage,{id:"adminConnectionsSettings.table.allowIntegrations.title",defaultMessage:"Approved connections{numberOfIntegrations}",values:{numberOfIntegrations:0!==M&&(0,c.jsx)(Me.Z,{isSecondaryColor:!0,style:{marginLeft:6},children:M})}})}),(0,c.jsx)(pn,{})]}):(0,c.jsx)(Me.Z,{style:{fontWeight:x.Z.fontWeight.medium,display:"flex",height:28,alignItems:"center",marginBottom:"19px"},children:(0,c.jsx)(g.FormattedMessage,{id:"adminConnectionsSettings.table.default.title",defaultMessage:"All connections{numberOfIntegrations}",values:{numberOfIntegrations:0!==v&&(0,c.jsx)(Me.Z,{isSecondaryColor:!0,style:{marginLeft:6},children:v+Fs.T2.length})}})}),(0,c.jsx)(gn.ZP,{integrationIdToBotIds:m.nonCompliance,internalIntegrationIds:f,integrationIdToUsers:y}),(0,c.jsx)("div",{style:{marginTop:16,marginBottom:32,display:"grid",gridTemplateColumns:"1fr",gap:4},children:(0,c.jsx)(fn.Z,{})})]}),workspace_connections:()=>{const e=Object.keys(m.compliance),s=e.length>0,n=function(e){const{allIntegrations:t,connectedIntegrationIds:s,isEnterprise:n}=e,i=[];for(const o of t)if(!s.includes(o.id)){const e=(0,_s.I$)(o.id);if(!e)continue;i.push({id:o.id,appName:o.name,account:void 0,caption:o.getInfo().tagline,logo:o.getInfo().icon,shouldHideInDiscover:!1,shouldShowNewBadge:!1,shouldHideConnectAccount:!0,shouldShowUpsell:!n,integrationTypes:[e.type],capabilities:(0,c.jsx)(c.Fragment,{}),canSelectPageAccess:!1,onConnect:()=>{var t;null!=e&&null!==(t=e.oauth)&&void 0!==t&&t.accountInfoPropertyNames||"dlp"===(null==e?void 0:e.type)||"ediscovery"===(null==e?void 0:e.type)?Ds.Z.setState({open:!0,integrationId:o.id}):Bs.Z.setState({open:!0,integrationId:o.id})},onDisconnect:()=>{}})}return i}({allIntegrations:T,connectedIntegrationIds:e,isEnterprise:P}),i=n.length>0;return(0,c.jsx)(c.Fragment,{children:u?(0,c.jsxs)(c.Fragment,{children:[s&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{style:F.connectedSectionDescription,children:(0,c.jsx)(g.FormattedMessage,{id:"admin.connections.tab.workspace_connections.description",defaultMessage:"These integrations connect your workspace to external apps, or improve security and compliance. Only workspace owners can install them"})}),(0,c.jsxs)("div",{style:F.connectedSection,children:[(0,c.jsx)("div",{style:F.addMenu,children:(0,c.jsx)(mn,{})}),(0,c.jsx)(gn.cP,{botIdToWebhookSubscriptionId:d,complianceIntegrationsIdToBotIds:m.compliance})]})]}),i&&(0,c.jsx)("div",{style:{...P?{}:F.discoverSectionUpsell,marginTop:s?32:void 0},children:(0,c.jsx)(hn.Z,{apps:n,numberOfConnectedApps:e.length,numberOfDisplayRows:2,title:(0,c.jsxs)("div",{style:F.discoverSectionHeader,children:[(0,c.jsx)("div",{style:F.discoverSectionTitle,children:P?(0,c.jsx)(g.FormattedMessage,{id:"connectionsSettings.discoverNewConnectionsSection.title",defaultMessage:"Discover new connections"}):(0,c.jsx)(g.FormattedMessage,{id:"connectionsSettings.discoverNewConnectionsSection.titleUpsell",defaultMessage:"Upgrade to Enterprise to use these connections"})}),!P&&(0,c.jsxs)("div",{style:F.discoverSectionButtons,children:[(0,c.jsxs)(xn.Z,{onClick:()=>{C.D({environment:t,url:"https://www.notion.so/integrations/collections/security-and-compliance"})},style:F.learnMoreButton,children:[(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Learn more",id:"connectionsSettings.discoverNewConnectionsSection.learnMore"}),(0,Zs.J)(F.alias)]}),(0,c.jsx)(Sn.Z,{style:F.upgradeButton,onClick:async()=>{l&&(Ns.Zz({environment:t,spaceId:l.id}),await Us.Z.waitUntilReady()),Es.y(t,{from:"workspace_connections",for:"enterprise",dontOpenPlansOnCancel:!0})},children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Upgrade",id:"connectionsSettings.discoverNewConnectionsSection.upgrade"})})]})]})})})]}):null})}},_=e=>A[e];return u?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Mn.Z,{tabs:w,selectedIndex:jn.findIndex((e=>e===I)),onChange:e=>(e=>{Z(jn[e])})(e),style:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},tabTitleStyle:{fontSize:16}}),_(I)()]}):_("member_connections")()}function wn(){const e=(0,o.O7)(),t=(0,a.VK)((()=>Ke.default.state.currentSpaceStore),[]),{isMobile:s}=e.device,n=(0,a.VK)((()=>(0,Ot.wP)()),[]),i=(0,a.VK)((()=>null==t?void 0:t.getBotSettingsStore().getValue()),[t]);return(0,c.jsx)(bn.Z,{isMobile:s,title:(0,c.jsx)(g.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.title",defaultMessage:"Restrict members from adding connections"}),caption:(0,As.CJ)(i)?(0,c.jsx)(g.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.allowList.workspaceOwner.caption",defaultMessage:"Workspace members can only install connections pre-approved by workspace owners."}):(0,c.jsx)(g.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.off.caption",defaultMessage:"Workspace members can install any new connection."}),upsellOptions:{shouldUpsell:!n,subscriptionTier:"enterprise",analyticsName:"integration_settings"},type:"dropdown",currentOption:(0,As.CJ)(i)?"allow_list":"any_integrations",options:[{key:"any_integrations",label:(0,c.jsx)(g.FormattedMessage,{id:"adminIntegrationSettings.integrationRestrictions.off.title",defaultMessage:"No restrictions"}),caption:(0,c.jsx)(g.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.off.caption",defaultMessage:"Workspace members can install any connection."})},{key:"allow_list",label:(0,c.jsx)(g.FormattedMessage,{id:"adminIntegrationSettings.integrationRestrictions.allowList.title",defaultMessage:"Only from approved list"}),caption:(0,c.jsx)(g.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.allowList.caption",defaultMessage:"Workspace members can only install connections pre-approved by a workspace owner."})}],onSelectOption:s=>{!function(e){const{environment:t,currentSpaceStore:s,botSettings:n,setting:i}=e;if(s){if("allow_list"===i&&(0,As.CJ)(n))return;const e="allow_list"===i?"approved_only":void 0;P.createAndCommit({userAction:"AdminIntegrationSettings.handleIntegrationRestrictionSelect",environment:t,perform:t=>{Rs.sW({store:s,data:{bot_settings:{...n,integration_restrictions:e}},transaction:t})}})}}({environment:e,currentSpaceStore:t,botSettings:i,setting:s})},info:[{key:"learn_more",label:(0,c.jsx)(g.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.info.title",defaultMessage:"Workspace owners can always install and approve new connections."})}]})}function kn(){const e=(0,o.O7)(),t=(0,r.Fg)(),s=(0,a.VK)((()=>Ke.default.state.currentSpaceStore),[]),{isMobile:n}=e.device,i=(0,a.VK)((()=>(0,Ot.wP)()),[]),l=(0,a.VK)((()=>null==s?void 0:s.getBotSettingsStore().getValue()),[s]);return(0,c.jsx)(bn.Z,{isMobile:n,title:(0,c.jsx)(g.FormattedMessage,{id:"adminConnectionsSettings.autoApproveBuiltByNotion.title",defaultMessage:"Auto-approve <builtbynotion>Built by Notion</builtbynotion> connections",values:{builtbynotion:e=>(0,c.jsxs)("span",{style:{color:t.invoiceGreen,marginRight:4,marginLeft:4},children:[(0,Ps.X)({width:14,display:"inline",verticalAlign:"bottom",marginRight:2}),e]})}}),caption:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Toggle this on to approve all workspace members to install connections <helpcenterlink>built by Notion</helpcenterlink>.",id:"adminConnectionsSettings.autoApproveBuiltByNotion.caption",values:{helpcenterlink:e=>(0,c.jsx)(vn.Z,{href:(0,Ue.UY)("guides.enterpriseIntegrationSettings"),children:e})}}),upsellOptions:{shouldUpsell:!i,subscriptionTier:"enterprise",analyticsName:"integration_settings"},type:"toggle",isOn:"approved_or_built_by_notion"===(null==l?void 0:l.integration_restrictions),onToggle:()=>function(e){const{environment:t,currentSpaceStore:s,botSettings:n}=e;if(s){const e="approved_or_built_by_notion"===(null==n?void 0:n.integration_restrictions)?"approved_only":"approved_or_built_by_notion";P.createAndCommit({userAction:"AdminIntegrationSettings.handleAutoApproveBuiltByNotionToggle",environment:t,perform:t=>{Rs.sW({store:s,data:{bot_settings:{...n,integration_restrictions:e}},transaction:t})}})}}({environment:e,currentSpaceStore:s,botSettings:l})})}var Tn=s(25777);const In=function(e){let{spaceStore:t,userStore:s}=e;const i=(0,o.O7)(),r=(0,a.qz)(void 0,Is.Z),{device:l}=i,d=(0,a.VK)((()=>(0,Ts.Fn)(i)),[i]);return(0,n.useEffect)((()=>{d||j.r$({currentTab:"members"})}),[d]),d?(0,c.jsxs)(pt.ZP,{children:[(0,c.jsx)(me.Z,{large:!l.isMobile||void 0,divider:l.isMobile?void 0:"full",style:{paddingBottom:12},children:(0,c.jsx)(g.FormattedMessage,{id:"spaceConnectionsSettings.title",defaultMessage:"Connections"})}),(0,c.jsx)(Pn,{spaceStore:t,userStore:s,requestStore:r})]}):null};function Zn(e){let{error:t,result:s,ready:n}=e;const{currentSpaceStore:i}=(0,a.VK)((()=>Ke.default.state),[]);return i?(0,c.jsxs)(Tn.Z,{loaded:n,spinnerSize:16,showSpinnerTimeout:600,children:[t&&(0,c.jsx)("div",{children:(0,c.jsx)(g.FormattedMessage,{id:"spaceIntegrationSettings.error",defaultMessage:"Something went wrong…"})}),s&&(0,c.jsx)(Cn,{...s})]}):null}function Pn(e){let{spaceStore:t,userStore:s,requestStore:n}=e;const i=(0,o.O7)(),r=(0,a.qz)(n,Is.Z);return(0,c.jsx)(ks.Z,{requestStore:r,request:{spaceId:t.id,userId:s.id},performRequest:e=>async function(e,t){let{spaceId:s}=e;return{guestBotIds:(await Promise.all([js.Yw({environment:t,table:Ms.bx,id:s,type:"guest"}),js.Yw({environment:t,table:Ms.bx,id:s,type:"external"}),ws.pJ({environment:t}),Cs.v({environment:t})]))[0].botIds}}(e,i),render:(e,t,s)=>(0,c.jsx)(Zn,{error:e,result:t,ready:s})})}var Fn=s(36488),An=s(56940),_n=s(50506),Rn=s(45653),On=s(79603),Bn=s(83265),Dn=s(53770),Ln=s(57347);const Vn=10,Nn=[50,100,200,500,1e3],En=50;function Un(e){let{spaceStore:t,samlConfigStore:s,memberCountFilter:i,isPrimarySpace:r}=e;const l=(0,o.O7)(),d=(0,a.VK)((()=>s.state.emailDomains),[s]),[c,u]=(0,n.useState)({spaces:[],nextEarliestCreatedAt:Date.now(),numPagesLoaded:0,hasNextPage:!1,loading:!1,error:void 0}),p=(0,a.VK)((()=>(0,Ot.wP)()),[]),m=(0,n.useCallback)((async e=>{if(p&&0!==d.length&&r&&c.nextEarliestCreatedAt&&!c.loading&&!(e&&c.numPagesLoaded>0||c.error)){u((e=>({...e,loading:!0})));try{const{spaces:e,earliestCreatedAt:s,hasMoreSpaces:n}=await(0,Dn.XD)({fn:async()=>await async function(e,t,s,n,i){const o=await T.getSpacesCreatedByUserWithDomains(e,{spaceId:t,emailDomains:s,spacesLimit:Vn,memberCountFilter:i,spaceCreatedTimeUpperBound:n});if("failed"===o.type)throw o.error;return{spaces:o.data.results.map((e=>({id:e.id,name:e.spaceName,icon:e.spaceIcon,createdAt:e.spaceCreatedTime,memberCount:e.memberCount,subscriptionTier:e.subscriptionTier,creatorEmailDomain:e.spaceCreatedByDomain,creator:e.spaceCreator,admins:e.admins,spaceRequest:e.spaceRequest,isDelinquent:e.isDelinquent,isPendingBilling:e.isPendingBilling,isActorInSpace:e.isActorInSpace}))),earliestCreatedAt:o.data.hasMoreSpaces?o.data.earliestCreatedAt:void 0,hasMoreSpaces:o.data.hasMoreSpaces}}(l,t.id,d,c.nextEarliestCreatedAt?c.nextEarliestCreatedAt-1:Date.now(),i),handleError:(e,t)=>t?{status:"throw",error:e}:{status:"retry"},retryAttemptsMS:Nn,retryAttemptRandomOffsetMS:En,initialInput:void 0});u((t=>{const i=[...t.spaces],o=new Set(t.spaces.map((e=>e.id)));for(const s of e)o.has(s.id)||i.push(s);return{spaces:i,nextEarliestCreatedAt:s,numPagesLoaded:t.numPagesLoaded+1,hasNextPage:n,loading:!1,error:void 0}}))}catch(s){const e=(0,Ln.t)(s);u((t=>({...t,loading:!1,error:e})))}}}),[l,p,i,r,t,d,c.nextEarliestCreatedAt,c.numPagesLoaded,c.loading,c.error]);const g=(0,n.useCallback)((async()=>{await m(!1)}),[m]),h=(0,n.useCallback)((async()=>{await m(!0)}),[m]),f=(0,n.useCallback)((async()=>{u({spaces:[],nextEarliestCreatedAt:Date.now(),numPagesLoaded:0,hasNextPage:!1,loading:!1,error:void 0}),await m(!0)}),[m]);return{claimableSpaces:c.spaces,loading:c.loading,error:c.error,hasNextPage:c.hasNextPage,loadFirstPage:h,loadNextPage:g,resetFirstPage:f,setSpaceRequest:function(e,t){u((s=>{const n=s.spaces.map((s=>s.id===e?{...s,spaceRequest:t}:s));return{...s,spaces:n}}))},removeClaimableSpace:function(e){u((t=>{const s=t.spaces.filter((t=>t.id!==e));return{...t,spaces:s}}))}}}async function Wn(e){const{environment:t,spaceId:s,store:n}=e;if(!(0,Ot.Rs)())return n.reset(),{};const i=await T.getSamlConfigForSpace(t,{spaceId:s});if("failed"===i.type)M.showError(i);else if(i.data&&i.data.samlConfig){const e={...i.data.samlConfig,useMetadataUrl:!Boolean(i.data.samlConfig.idpMetadata)};return n.setState(e),i.data}return n.reset(),{}}const Kn={SettingsPage:"settings-page",WorkspacesPage:"workspaces-page",ManagedUsersPage:"managed-users-page"};let zn=function(e){return e[e.Single=0]="Single",e[e.Multi=1]="Multi",e}({});const qn=(0,n.createContext)(null);function Gn(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:i,children:r}=e;const l=(0,o.O7)(),[d,u]=(0,n.useState)(Kn.SettingsPage),[p,g]=(0,n.useState)(zn.Single),h=(0,a.VK)((()=>s.state.emailDomains),[s]),f=(0,a.VK)((()=>Boolean(s.state.id)&&s.state.id===t.id),[s,t]),{loading:x,error:y,loaded:S}=function(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:n}=e;const i=(0,o.O7)(),[{status:a,error:r}]=(0,Vt.r5)((async()=>{const e=await Wn({environment:i,spaceId:t.id,store:s});return(0,_.Zw)(e)?e:e.samlConfig?{samlResponse:e,domainResponse:await n.updateValueForSpace({environment:i,spaceId:t.id,store:n})}:{samlResponse:e,domainResponse:void 0}}),[i,s,t,n]);return{loading:"pending"===a,loaded:"resolved"===a,error:r}}({spaceStore:t,samlConfigStore:s,domainSettingsStore:i}),{loading:v,error:b,claimableSpaces:M,setSpaceRequest:j,removeClaimableSpace:C,hasNextPage:w,loadNextPage:k,loadFirstPage:I,resetFirstPage:Z}=Un({spaceStore:t,samlConfigStore:s,isPrimarySpace:f,memberCountFilter:"single"}),{loading:P,error:F,claimableSpaces:A,setSpaceRequest:R,removeClaimableSpace:O,hasNextPage:B,loadNextPage:D,loadFirstPage:L,resetFirstPage:V}=Un({spaceStore:t,samlConfigStore:s,isPrimarySpace:f,memberCountFilter:"multi"}),N=M.length+A.length>0,[E,U,W,K,z,q,G,H]=p===zn.Single?[v,b,M,j,C,w,k,I,Z]:[P,F,A,R,O,B,D,L,V],{loading:Y,error:Q,domainVerifications:$}=function(e){let{spaceStore:t}=e;const s=(0,o.O7)(),[i,a]=(0,n.useState)([]),[{status:r,error:l}]=(0,Vt.r5)((async()=>{if(!(0,m.Rs)(t.getSubscriptionTier()))return void a([]);const e=await T.getDomainVerificationCodesForSpace(s,{spaceId:t.id,verifiedOnly:!0});"success"===e.type?a(e.data.domainVerifications):a([])}),[s,t]);return{loading:"pending"===r,domainVerifications:"resolved"===r?i:[],error:l}}({spaceStore:t,emailDomains:h});(0,n.useEffect)((()=>{I(),L()}),[W,I,L]);const J={page:d,navigateTo:function(e){u(e),0===M.length&&A.length>0&&g(zn.Multi),"workspaces-page"===e&&Bn.Ce(l,{verifiedDomains:h,tab:p===zn.Single?"single":"multi"})},loadingSaml:x,loadingSpaces:E,loadingVerifications:Y,errorSaml:y,errorClaimableSpaces:U,errorVerifications:Q,loadedSaml:S,domainVerifications:$,hasBrowsableSpaces:N,claimableSpaces:W,setSpaceRequest:K,removeClaimableSpace:z,resetInitialClaimableSpaces:H,hasMoreClaimableSpaces:q,loadMoreClaimableSpaces:G,tab:p,setSelectedTab:function(e){g(e),"workspaces-page"===d&&Bn.Ce(l,{verifiedDomains:h,tab:e===zn.Single?"single":"multi"})},verifiedDomains:h};return(0,c.jsx)(qn.Provider,{value:J,children:r})}var Hn=s(84169),Yn=s(66994),Qn=s(73063),$n=s(19981),Jn=s(66466),Xn=s(25651),ei=s(29851),ti=s(2356),si=s(37612),ni=s(97608),ii=s(81918),oi=s(64964);const ai={managedUsers:[],filters:{query:"",multiFactorStatus:void 0,workspaceId:void 0},numPagesLoaded:0,hasNextPage:!0,paginationToken:void 0,loading:!1,error:void 0};function ri(e){let{spaceStore:t,samlConfigStore:s,userStatus:i}=e;const r=(0,o.O7)(),[l,d]=(0,n.useState)(ai),c=(0,n.useRef)(l.filters),u=(0,a.VK)((()=>Boolean(s.state.id)&&s.state.id===t.id),[s,t]),p=(0,a.VK)((()=>s.state.emailDomains),[s]),m=(0,n.useCallback)((async e=>{if(0===p.length)return;if(!u)return;let s=l.loading,n=l.error,o=l.hasNextPage,a=l.paginationToken;if(e.restartSearch&&(d((e=>({...ai,filters:e.filters}))),s=ai.loading,n=ai.error,o=ai.hasNextPage,a=ai.paginationToken),o&&!s&&!n){d((e=>({...e,loading:!0}))),c.current=l.filters;try{var m;const e=await T.getManagedUsers(r,{spaceId:t.id,emailDomains:p,query:l.filters.query,multiFactorStatus:l.filters.multiFactorStatus,workspaceId:l.filters.workspaceId,paginationToken:a,userStatus:i});if(ii.HH(r,{filters:{multiFactorStatus:l.filters.multiFactorStatus,workspaceId:l.filters.workspaceId},query_length:(null===(m=l.filters.query)||void 0===m?void 0:m.length)??0,current_page:a,user_status:i}),"failed"===e.type)throw e.error;const s=e.data.nextPaginationToken,n=e.data.results;d((e=>{const t=[...e.managedUsers],i=new Set(e.managedUsers.map((e=>e.userId)));for(const s of n)i.has(s.userId)||t.push(s);return{...e,managedUsers:t,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:s,hasNextPage:Boolean(s)}}))}catch(g){const e=(0,Ln.t)(g);d((t=>({...t,loading:!1,error:e})))}}}),[r,t,p,u,l.loading,l.error,l.hasNextPage,l.paginationToken,l.filters,i]);(0,n.useEffect)((()=>{h.Xy(c.current,l.filters)||m({restartSearch:!0})}),[l.filters,m]);const g=(0,n.useCallback)((()=>m({restartSearch:!1})),[m]),f=(0,n.useCallback)((e=>{d((t=>({...t,filters:{...t.filters,...e}})))}),[]),x=(0,n.useCallback)(((e,t)=>{d((s=>({...s,managedUsers:s.managedUsers.map((s=>s.userId===e?{...s,workspaces:s.workspaces.filter((e=>e.id!==t))}:s))})))}),[]),y=(0,n.useCallback)((e=>{d((t=>({...t,managedUsers:[...t.managedUsers,e]})))}),[]),S=(0,n.useCallback)((e=>{d((t=>({...t,managedUsers:t.managedUsers.filter((t=>t.userId!==e))})))}),[]);return{managedUsers:l.managedUsers,filters:l.filters,loading:l.loading,error:l.error,removeWorkspaceFromUser:x,addUserToManagedUsers:y,removeUserFromManagedUsers:S,setFilters:f,hasNextPage:l.hasNextPage,loadNextPage:g}}let li=function(e){return e[e.NotSuspended=0]="NotSuspended",e[e.Suspended=1]="Suspended",e}({});function di(e){switch(e){case li.Suspended:return"suspended";case li.NotSuspended:return"notSuspended";default:(0,fs.t1)(e)}}var ci=s(44495),ui=s(71291),pi=s(53695),mi=s(55255),gi=s(58720),hi=s(52498),fi=s(82162),xi=function(e){return e.ManagedUser="managed-user",e.Loading="loading",e}(xi||{});const yi={marginLeft:4,height:14,width:14,opacity:.5},Si=[{id:"user",headerTitle:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.user",defaultMessage:"Users"}),renderCell:e=>e.type===xi.ManagedUser?(0,c.jsx)(fi.S,{userId:e.managedUser.userId}):(0,c.jsx)(fi.L,{}),widthData:{width:70},sortable:!1},{id:"access",headerTitle:(0,c.jsx)("span",{style:{paddingInline:8},children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.access",defaultMessage:"Workspaces"})}),renderCell:e=>e.type===xi.ManagedUser?(0,c.jsx)(gi.m,{workspaceSummaries:e.managedUser.workspaces}):(0,c.jsx)(pi.z,{}),widthData:{width:60},sortable:!1},{id:"lastActive",headerTitle:(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},children:[(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.lastActive",defaultMessage:"Last active"}),(0,c.jsx)(be.ZP,{render:e=>(0,c.jsx)("div",{...e,children:(0,ci.D)(yi)}),renderTooltip:()=>(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.lastActive.tooltip",defaultMessage:"This may be delayed by several hours."})})]}),renderCell:e=>e.type===xi.ManagedUser?(0,c.jsx)(mi.B,{lastActiveAt:e.managedUser.lastActiveAt}):(0,c.jsx)(ui.I,{}),widthData:{width:60},sortable:!1},{id:"menu",headerTitle:null,renderCell:e=>e.type===xi.ManagedUser?(0,c.jsx)(hi.G,{managedUser:e.managedUser,managedUserActionSections:e.managedUserActionSections}):null,widthData:{width:15},sortable:!1,hasClickableContents:!0}],vi=[{id:"1",isClickable:!1,type:xi.Loading},{id:"2",isClickable:!1,type:xi.Loading},{id:"3",isClickable:!1,type:xi.Loading}];function bi(e){let{managedUsers:t,loadMoreManagedUsers:s,onEditDetails:n,loading:i,managedUserActionSections:o}=e;const a=t.map((e=>({id:e.userId,type:xi.ManagedUser,managedUser:e,isClickable:!0,managedUserActionSections:o}))),l=(0,r.yK)((e=>(0,Se.b)({columnRenderInfo:Si,theme:e,containerMarginTop:0})),[]);const d=i?[...a,...vi]:a;return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(Se.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:Si,rows:d,onRowClick:function(e){e.type===xi.ManagedUser&&n(e.managedUser)},renderNoRowsComponent:()=>(0,c.jsx)(Mi,{loading:i}),styles:l,onLoadMore:s})})}function Mi(e){const t=(0,r.yK)((()=>({text:{marginTop:15,marginBottom:40,textAlign:"center"}})),[]);return(0,c.jsx)(Me.Z,{isSmall:!0,style:t.text,children:!e.loading&&(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.empty",defaultMessage:"No users found."})})}var ji=s(33602),Ci=s(18261),wi=s(28608);const ki=(0,g.defineMessages)({placeholder:{id:"identityProvisioningSettings.managedUsers.searchInput.placeholder",defaultMessage:"Search name, email, or user ID"}});function Ti(e){let{spaceStore:t,samlConfigStore:s}=e;const{navigateTo:i}=(0,n.useContext)(qn),l=(0,o.O7)(),d=(0,g.useIntl)(),u=(0,r.yK)((e=>({link:{fontSize:14,fontWeight:400,color:e.mediumTextColor,textDecoration:"none"},title:{marginTop:21,fontWeight:x.Z.fontWeight.semibold,fontSize:17,display:"flex",justifyContent:"flex-start",alignItems:"center"},byline:{fontSize:14,fontWeight:x.Z.fontWeight.regular,color:e.mediumTextColor,paddingBottom:20},count:{marginLeft:4,opacity:.5,fontWeight:400},tabBarMenu:{margin:"12px 0 0",boxShadow:"none"},filters:{display:"flex",justifyContent:"flex-start",alignItems:"center",width:"100%",margin:"0 auto 12px"}})),[]),p=(0,a.VK)((()=>s.state.spaces),[s]),{managedUsers:m,filters:h,loadNextPage:f,setFilters:y,removeWorkspaceFromUser:S,loading:v,selectedTab:b,setSelectedTab:j,onOpenDetailsModal:w,onCloseDetailsModal:k,selectedUser:I,managedUserActionSections:Z}=function(e){let{spaceStore:t,samlConfigStore:s}=e;const i=(0,o.O7)(),r=(0,g.useIntl)(),[l,d]=(0,n.useState)(),[u,p]=(0,n.useState)(li.NotSuspended),m=(0,a.VK)((()=>i.currentUser.id),[i]),h=(0,n.useCallback)(((e,t)=>{ii.JX(i,{user_status:di(u),from:t}),d(e.userId)}),[i,u]),f=ri({userStatus:"notSuspended",spaceStore:t,samlConfigStore:s}),x=ri({userStatus:"suspended",spaceStore:t,samlConfigStore:s});let y;y=u===li.NotSuspended?f:x;const S=(0,n.useCallback)((async e=>{ii.rZ(i);const{accept:s}=await M.confirmUserActionV2({message:(0,c.jsx)(Me.Z,{style:M.dialogStyles.title,children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Suspend this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser.dialog.title"})}),acceptLabel:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Yes",id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser.dialog.acceptLabel"}),description:(0,c.jsx)(Me.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"This user will not be able to log into Notion and their Notion integrations will stop working. They can be unsuspended at any time from the Managed Users dashboard.",id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser.dialog.description"})})});if(!s)return;const n=await T.updateUserSuspension(i,{userId:e.userId,spaceId:t.id,suspend:!0});ii.rv(i),"failed"===n.type&&M.showErrorMessage((0,D.wf)(L.default.getIntl(),n)),x.addUserToManagedUsers(e),f.removeUserFromManagedUsers(e.userId)}),[i,t.id,x,f]),v=(0,n.useCallback)((async e=>{ii.NF(i);const{accept:s}=await M.confirmUserActionV2({message:(0,c.jsx)(Me.Z,{style:M.dialogStyles.title,children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Log out this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.logoutUser.dialog.title"})}),acceptLabel:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Log out user",id:"identityAndProvisioning.managedUsers.table.menu.action.logoutUser.dialog.acceptLabel"}),description:(0,c.jsx)(Me.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.logoutUser.dialog.description",defaultMessage:"You are about to log out this user from their current session. They will need to re-authenticate to log back into Notion."})})});if(!s)return;const n=await T.logoutManagedUsers(i,{spaceId:t.id,target:{type:ni.J.User,userId:e.userId}});if(ii._m(i),"failed"===n.type)return M.showErrorMessage((0,D.wf)(L.default.getIntl(),n)),void oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"managedUsers.toastMessage.logout.failed",defaultMessage:"Failed to logged out user"})});oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"managedUsers.toastMessage.logout.success",defaultMessage:"Successfully logged out user"})})}),[i,t.id]),b=(0,n.useCallback)((async e=>{ii.Zm(i);const{accept:s}=await M.confirmUserActionV2({message:(0,c.jsx)(Me.Z,{style:M.dialogStyles.title,children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Reset password for this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.forcePasswordReset.dialog.title"})}),acceptLabel:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.forcePasswordReset.dialog.acceptLabel",defaultMessage:"Reset passwords for user"}),description:(0,c.jsx)(Me.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.forcePasswordReset.dialog.description",defaultMessage:"You are about to reset the password for this user. This will also remove any 2-step verification settings they might have and they will be logged out of of their current session.{br}{br}This user will need to re-authenticate via their email the next time they attempt to log back into Notion, and they will be prompted to set a new password upon logging in.",values:{br:(0,c.jsx)("br",{})}})})});if(!s)return;const n=await T.resetPasswordsForManagedUsers(i,{spaceId:t.id,target:{type:ni.J.User,userId:e.userId}});if(ii.vC(i),"failed"===n.type)return M.showErrorMessage((0,D.wf)(r,n)),void oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"managedUsers.toastMessage.forcePasswordReset.fail",defaultMessage:"Failed to reset password for user"})});oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"managedUsers.toastMessage.forcePasswordReset.success",defaultMessage:"Successfully reset password for user"})})}),[i,r,t.id]),j=(0,n.useCallback)((async e=>{const s=await T.updateUserSuspension(i,{userId:e.userId,spaceId:t.id,suspend:!1});ii.Ci(i),"failed"===s.type&&M.deprecatedShowErrorMessage(s.error.message),x.removeUserFromManagedUsers(e.userId),f.addUserToManagedUsers(e)}),[i,t.id,x,f]),C=(0,n.useCallback)((async e=>{ii.P1(i,{user_status:di(u)});const{accept:s}=await M.confirmUserActionV2({message:(0,c.jsx)(Me.Z,{style:M.dialogStyles.title,children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Delete this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser.dialog.title"})}),acceptLabel:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Yes",id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser.dialog.acceptLabel"}),description:(0,c.jsx)(Me.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"This action cannot be undone. This will permanently delete the user's entire account. All private workspaces will be deleted, and they will be removed from all shared workspaces.",id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser.dialog.description"})})});if(!s)return;const n=await T.deleteManagedUser(i,{userId:e.userId,spaceId:t.id});ii.j7(i,{user_status:di(u)}),"failed"===n.type&&M.deprecatedShowErrorMessage(n.error.message),x.removeUserFromManagedUsers(e.userId),f.removeUserFromManagedUsers(e.userId)}),[i,u,t.id,x,f]),w=(0,n.useMemo)((()=>y.managedUsers.find((e=>{let{userId:t}=e;return t===l}))),[l,y.managedUsers]),k=(0,n.useMemo)((()=>{let e;const t={onClick:e=>h(e,"dropdown_menu"),icon:Xn.R,title:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.userDetails",defaultMessage:"Edit details"})},s={onClick:e=>C(e),icon:si.y,title:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser",defaultMessage:"Delete user"}),isDestructive:!0};switch(u){case li.NotSuspended:e=[[t,{onClick:v,icon:Jn.S,title:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.logout",defaultMessage:"Log out"})},{onClick:b,icon:ei.z,title:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.passwordReset",defaultMessage:"Reset password"})}],[{onClick:S,icon:$n.V,title:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser",defaultMessage:"Suspend user"}),getDisabledState:e=>e.userId===m},s]];break;case li.Suspended:e=[[t],[{onClick:e=>j(e),icon:ti.u,title:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.unSuspendUser",defaultMessage:"Reactivate user"})},s]];break;default:(0,fs.t1)(u)}return e.filter((e=>e.length>0))}),[h,m,u,C,S,j,v,b]);return{...y,selectedTab:u,setSelectedTab:p,selectedUser:w,managedUserActionSections:k,onOpenDetailsModal:h,onCloseDetailsModal:function(){d(void 0)}}}({spaceStore:t,samlConfigStore:s}),P=(0,n.useCallback)((e=>w(e,"row_click")),[w]);return(0,c.jsxs)(pt.ZP,{children:[(0,c.jsx)(vn.Z,{style:u.link,onClick:()=>i(Kn.SettingsPage),children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.breadcrumb",defaultMessage:"← Identity & Provisioning"})}),(0,c.jsxs)(me.Z,{large:!0,style:u.title,children:[(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.title",defaultMessage:"User management"}),(0,c.jsx)(Qn.Z,{icon:Hn.m,ariaLabel:d.formatMessage({defaultMessage:"Managed users settings help button",id:"identityProvisioningSettings.managedUsers.helpButton.label"}),onClick:()=>C.D({environment:l,url:(0,Ue.UY)("guides.managedUsers")})})]}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:u.byline,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.byline",defaultMessage:"Manage and view users that are using your verified domains"})}),(0,c.jsx)(Mn.Z,{tabs:[(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.table.notSuspendedTab.title",defaultMessage:"Active"},"notSuspended.title"),(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.table.suspendedTab.title",defaultMessage:"Suspended"},"suspended")],selectedIndex:b,onChange:e=>j(e),style:u.tabBarMenu}),(0,c.jsx)(Yn.O,{mode:Yn.p.Button,query:h.query,setQueryFilter:e=>{y({query:e})},placeholderText:L.default.formatMessage(ki.placeholder)}),(0,c.jsxs)("div",{style:u.filters,children:[(0,c.jsx)(wi.O,{selectedSpaceId:h.workspaceId,setSelectedSpaceId:e=>{y({workspaceId:e})},spaceData:p}),(0,c.jsx)(ji.V,{selectedMfaMethod:h.multiFactorStatus,setSelectedMfaMethod:e=>{y({multiFactorStatus:e})}})]}),(0,c.jsx)(bi,{managedUsers:m,loading:v,loadMoreManagedUsers:f,onEditDetails:P,managedUserActionSections:Z},b),(0,c.jsx)(Ci.W,{spaceStore:t,managedUser:I,onClose:k,removeWorkspaceFromUser:S})]})}function Ii(e){let{environment:t,samlConfigStore:s}=e;const n=s.state.emailDomains.length>0,i=(0,Ot.zt)();return n||("business"===i||"enterprise"===i)}var Zi=s(81236),Pi=s(68785),Fi=s(58698);async function Ai(e){let{onRequest:t,onSuccess:s}=e;const n=await t();switch(n.type){case"success":s&&await s(n);break;case"failed":M.showErrorMessage((0,D.wf)(L.default.getIntl(),n));break;default:(0,fs.t1)(n)}}function _i(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:i}=e;const r=(0,o.O7)(),l=(0,a.VK)((()=>s.state.emailDomains),[s]),d=(0,a.VK)((()=>"disabled"!==s.state.status&&"unconfigured"!==s.state.status),[s]),c=(0,a.VK)((()=>Ii({environment:r,samlConfigStore:s})),[s,r]),u=(0,a.VK)((()=>c&&(!s.state.id||s.state.id===t.id)),[c,s,t]),p=(0,a.VK)((()=>i.state.emailDomains.length>0&&(0,Ot.wP)()),[i]),m=(0,a.VK)((()=>l.length>0),[l]),g=(0,n.useCallback)((async()=>{if(s.state.emailDomains.length>0)return Ai({onRequest:()=>T.updateWorkspaceCreationForEmailDomains(r,{emailDomains:s.state.emailDomains,workspaceCreationEnum:i.state.spaceCreation,spaceId:t.id}),onSuccess:()=>{i.setState({...i.state,emailDomains:s.state.emailDomains})}})}),[r,t,i,s]),h=(0,n.useCallback)((async()=>{if(s.state.emailDomains.length>0)return Ai({onRequest:()=>T.updateEmailDomainSettings(r,{emailDomains:s.state.emailDomains,spaceId:t.id,preventProfileEdits:i.state.settings.prevent_profile_edits,preventMembersJoiningExternalWorkspace:i.state.settings.prevent_members_joining_external_workspace,customSessionDuration:(0,Fi.K)(i.state.settings.custom_session_duration),preventGrantingSupportAccess:i.state.settings.prevent_granting_support_access}),onSuccess:()=>{i.setState({...i.state,emailDomains:s.state.emailDomains})}})}),[r,t,i,s]),f=(0,a.VK)((()=>c&&(0,Ot.wP)()),[c]);return{verifiedDomains:l,isSamlStatusEnabled:d,isSamlAvailable:c,isSamlEditable:u,isDomainSettingsAvailable:p,isClaimSpacesAvailable:f,canSaveWorkspaceCreationSetting:m,saveWorkspaceCreationSetting:g,saveEmailDomainSettings:h}}var Ri=s(63296),Oi=s(80422),Bi=s(91694);function Di(e){let{title:t,byline:s,targetTier:i}=e;const a=(0,o.O7)(),r=(0,n.useCallback)((()=>Es.y(a,{from:"space_saml",for:i})),[a,i]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(me.Z,{smallMarginBottom:!0,style:{fontWeight:x.Z.fontWeight.regular,display:"flex",alignItems:"center"},children:[(0,c.jsx)("span",{style:{marginRight:8},children:t}),(0,c.jsx)(Bi.Z,{subscriptionTier:i,analyticsName:"space_saml",onClick:r})]}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,children:s})]})}const Li={browseWorkspaces:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Browse workspaces",id:"identityAndProvisioning.claimWorkspaces.button"}),noWorkspaces:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"No workspaces",id:"identityAndProvisioning.claimWorkspaces.buttonEmpty"}),loadingError:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Error loading workspaces.",id:"identityAndProvisioning.claimWorkspaces.errorByline"})};function Vi(e){let{promptUpgrade:t}=e;const{navigateTo:s,loadingSpaces:i,hasBrowsableSpaces:o,errorClaimableSpaces:a}=(0,n.useContext)(qn),l=Boolean(a),d=!o||i,u=!o&&!i,p=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.title",defaultMessage:"Claim workspaces"}),m=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.message",defaultMessage:"Claim workspaces created by users with a verified domain or require owners to use an external domain."}),h=(0,r.yK)((e=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:d?.5:1,minWidth:160},settingErrorByline:{color:e.errorText,marginTop:8,fontSize:13}})),[d]);if(t)return(0,c.jsx)(Di,{title:p,byline:m,targetTier:"enterprise"});let f;return f=i?(0,c.jsx)(Pi.Z,{}):o?Li.browseWorkspaces:Li.noWorkspaces,(0,c.jsx)("div",{style:h.settingContainer,children:(0,c.jsx)(Oi.N,{title:p,byline:m,settingItem:(0,c.jsxs)("div",{style:h.buttonAndErrorContainer,children:[(0,c.jsx)(be.ZP,{placement:be.ug.Top,alignment:be.v2.End,render:e=>(0,c.jsx)(Ri.Z,{disabled:d,isLarge:!0,style:h.button,onClick:()=>s(Kn.WorkspacesPage),...e,children:f}),disableTooltip:!u,renderTooltip:()=>(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.tooltip",defaultMessage:"There are no available workspaces to claim"})}),l?(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:h.settingErrorByline,children:Li.loadingError}):null]})})})}var Ni=s(52507),Ei=s(86249);function Ui(e){let{spaceStore:t,samlConfigStore:s,promptUpgrade:i,disabled:l,saveWorkspaceCreationSetting:d}=e;const u=(0,o.O7)(),p=(0,a.qz)(void 0,Ni.Z),m=(0,r.yK)((()=>({flex:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",margin:"18px 0px"},button:{position:"relative",marginLeft:"auto",marginRight:0,opacity:l?.5:1},plusIcon:{width:14,height:14,fill:"inherit",marginRight:"6px"}})),[l]),h=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.emailDomainsSection.title",defaultMessage:"Verified domains"}),f=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.emailDomainsSection.byline",defaultMessage:"Verify ownership of an email domain to access advanced security features including single-sign on."}),y=[...(0,a.VK)((()=>s.state.emailDomains.map(Ei.f4)),[s]),...(0,a.VK)((()=>s.state.domainVerifications.filter((e=>!s.state.emailDomains.includes(e.domain))).sort(((e,t)=>e.createdAt-t.createdAt)).map(Ei.UV)),[s])],S=(0,n.useCallback)((async()=>{await Wn({environment:u,spaceId:t.id,store:s})}),[u,t,s]),{resetInitialClaimableSpaces:v}=(0,n.useContext)(qn),b=(0,n.useCallback)((async e=>{switch(e.type){case"verified":return Ai({onRequest:()=>T.setSamlConfig(u,{spaceId:t.id,removedEmailDomains:[e.domain]}),onSuccess:async()=>{await S(),v()}});case"unverified":case"invalid":return Ai({onRequest:()=>T.deleteDomainVerificationCode(u,{id:e.id}),onSuccess:()=>S()})}}),[u,t,S,v]),M=(0,n.useCallback)((()=>Ai({onRequest:()=>T.setSamlConfig(u,{spaceId:t.id}),onSuccess:()=>S()})),[u,S,t]),j=(0,n.useCallback)((async()=>{await S(),await d()}),[d,S]);return i?(0,c.jsx)(Di,{title:h,byline:f,targetTier:"business"}):(0,c.jsx)(Ei.ZP,{disabled:l,domains:y,onRemoveDomain:b,domainVerificationStore:p,verificationType:"saml_config",verificationTargetId:t.id,refreshDomains:j,onClickAddDomain:M,renderOverrideAddDomainButton:e=>(0,c.jsxs)("div",{style:m.flex,children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(me.Z,{smallMarginBottom:!0,style:{fontWeight:x.Z.fontWeight.medium},children:h}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{marginBottom:4},children:f})]}),(0,c.jsx)("div",{children:(0,c.jsx)(Xt.Z,{isBlue:!0,style:m.button,icon:e=>(0,Ws.R)({...e,...m.plusIcon}),disabled:l,onClick:e,children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Add domain",id:"securitySAMLSettings.emailDomainsSection.addDomain"})})})]})})}function Wi(e){let{domainSettingsStore:t,samlConfigStore:s,disabled:i,promptUpgrade:l,verifiedDomains:d,tooltip:u,saveWorkspaceCreationSetting:p}=e;const m=(0,o.O7)(),h=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),f=(0,a.VK)((()=>{const e=s.state.id;if(!e)return;return new ne.H2(m,{table:Ms.bx,id:e}).getName()}),[m,s]),x=(0,n.useCallback)((async e=>{t.setState({...t.state,spaceCreation:e}),await p(),Bn.ti(m,{workspace_creation:e})}),[t,p,m]),y=(0,a.VK)((()=>d.length>0?t.state.spaceCreation:"admins_only"),[t,d]),S=(0,c.jsx)(g.FormattedMessage,{id:"domainSettings.workspaceCreation.title",defaultMessage:"Workspace creation"}),v=(0,c.jsx)(g.FormattedMessage,{id:"domainSettings.workspaceCreation.byline",defaultMessage:"Customize who can create new workspaces."}),b=(0,c.jsx)(g.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.titleWithSpaceName",defaultMessage:"{primaryWorkspaceName} workspace owners",values:{primaryWorkspaceName:f}}),M=(0,c.jsx)(g.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.title",defaultMessage:"Only workspace owners"});return l?(0,c.jsx)("div",{style:h.settingContainer,children:(0,c.jsx)(Di,{title:S,byline:v,targetTier:"enterprise"})}):(0,c.jsx)(be.ZP,{placement:be.ug.Top,alignment:be.v2.End,render:e=>(0,c.jsx)("div",{...e,style:h.settingContainer,children:(0,c.jsx)(bn.Z,{isMobile:m.device.isMobile,disabled:i,title:S,caption:v,type:"dropdown",currentOption:y,options:[{key:"unrestricted",label:(0,c.jsx)(g.FormattedMessage,{id:"domainSettings.workspaceCreation.unrestricted.title",defaultMessage:"Anyone"}),caption:(0,c.jsx)(g.FormattedMessage,{id:"domainSettings.workspaceCreation.unrestricted.caption",defaultMessage:"Any user can create new workspaces."})},{key:"admins_only",label:f?b:M,caption:(0,c.jsx)(g.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.captionWithSpaceName",defaultMessage:"Only workspace owners of this workspace can create new workspaces."})}],onSelectOption:x})}),disableTooltip:!u,renderTooltip:()=>u})}function Ki(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:n,isCurrentSpaceEnterprise:i}=e;const{verifiedDomains:o,isSamlAvailable:a,saveWorkspaceCreationSetting:r,isSamlEditable:l,isDomainSettingsAvailable:d,canSaveWorkspaceCreationSetting:u,isClaimSpacesAvailable:p}=_i({spaceStore:t,samlConfigStore:s,domainSettingsStore:n}),m=d&&l;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Ui,{disabled:!l,promptUpgrade:!a,spaceStore:t,samlConfigStore:s,saveWorkspaceCreationSetting:r}),(0,c.jsx)(Wi,{disabled:!m||!u,promptUpgrade:!i,verifiedDomains:o,samlConfigStore:s,domainSettingsStore:n,tooltip:0===o.length?(0,c.jsx)(g.FormattedMessage,{id:"domainSettings.workspaceCreation.disabledTooltip",defaultMessage:"There must be at least one verified domain to configure the workspace creation setting."}):void 0,saveWorkspaceCreationSetting:r}),(0,c.jsx)(Vi,{promptUpgrade:!p})]})}var zi=s(74523),qi=s(19639),Gi=s(16402);function Hi(e){let{domainSettingsStore:t,saveEmailDomainSettings:s,promptUpgrade:i,disabled:l}=e;const d=(0,o.O7)(),u=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),p=(0,n.useMemo)((()=>Object.entries(qi.nb).map((e=>{let[t,s]=e;return{key:t,label:(0,c.jsx)(Me.Z,{children:(0,Gi.hH)(0,s)})}}))),[]),m=(0,a.VK)((()=>(0,Fi.K)(t.state.settings.custom_session_duration)??qi.gl),[t]),h=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.customSessionDuration.title",defaultMessage:"Session duration"}),f=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.customSessionDuration.message",defaultMessage:"Control how long your managed users can be logged in for before they must re-authenticate."});return i?(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(Di,{title:h,byline:f,targetTier:"enterprise"})}):(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(bn.Z,{isMobile:d.device.isMobile,disabled:l,title:h,caption:f,type:"dropdown",currentOption:m,options:p,onSelectOption:async function(e){const n=t.state.settings.custom_session_duration??qi.nb[qi.gl],i=qi.nb[e];if(void 0===i)return;ii.LO(d,{custom_session_duration_ms:n});const{accept:o}=await M.confirmUserActionV2({message:(0,c.jsx)(Me.Z,{style:M.dialogStyles.title,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.message",defaultMessage:"Confirm change"})}),description:(0,c.jsxs)(Me.Z,{isMultiline:!0,isSecondaryColor:!0,children:[(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.description",defaultMessage:"You are about to change the session duration for all of your managed users from <b>{oldDuration}</b> to <b>{newDuration}.</b>",values:{oldDuration:(0,Gi.hH)(0,n),newDuration:(0,Gi.hH)(0,i),b:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,c.jsx)("b",{children:t})}}}),(0,c.jsx)("br",{}),(0,c.jsx)("br",{}),(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.secondDescription",defaultMessage:"This may log some users out of their current session, including you. The affected users will need to re-authenticate to log back into Notion."})]}),acceptLabel:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.acceptLabel",defaultMessage:"Confirm change"}),cancelLabel:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.cancelLabel",defaultMessage:"Cancel"})});o&&(t.setState({...t.state,settings:{...t.state.settings,custom_session_duration:i}}),ii.l0(d,{new_session_duration_ms:i}),await s())}})})}function Yi(e){let{spaceId:t,domainSettingsStore:s,promptUpgrade:n,verifiedDomains:i,disabled:a}=e;const l=i.length>0,d=(0,o.O7)(),u=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:!a&&l?1:.5}})),[a,l]),p=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.forcePasswordReset.title",defaultMessage:"Reset passwords for all users"}),m=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.forcePasswordReset.message",defaultMessage:"Force reset the passwords for all managed users and require them to create a new one the next time they log in."});async function h(){ii.Jo(d,{email_domains:i});const{accept:e}=await M.confirmUserActionV2({message:(0,c.jsx)(Me.Z,{style:M.dialogStyles.title,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.message",defaultMessage:"Reset passwords for your managed users?"})}),description:(0,c.jsx)(Me.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.description",defaultMessage:"You are about to reset the passwords for of your managed users, including you. This will also remove any 2-step verification settings they might have and they will be logged out of of their current session.{br}{br}The affected users will need to re-authenticate via their email the next time they attempt to log back into Notion, and they will be prompted to set a new password upon logging in.",values:{br:(0,c.jsx)("br",{})}})}),acceptLabel:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.acceptLabel",defaultMessage:"Reset passwords for all managed users"}),cancelLabel:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.cancelLabel",defaultMessage:"Cancel"})});if(!e)return;const n=s.state.emailDomains;await T.resetPasswordsForManagedUsers(d,{spaceId:t,target:{type:ni.J.Domains,emailDomains:n}}),oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"managedUsers.toastMessage.forcePasswordReset.all.success",defaultMessage:"Successfully reset passwords for all managed users"})}),ii.aT(d,{email_domains:n})}return n?(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(Di,{title:p,byline:m,targetTier:"enterprise"})}):(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(Oi.N,{title:p,byline:m,settingItem:(0,c.jsx)("div",{style:u.buttonAndErrorContainer,children:(0,c.jsx)(be.ZP,{placement:be.ug.Top,alignment:be.v2.End,render:e=>(0,c.jsx)(Xt.Z,{isRed:!0,disabled:a||!l,style:u.button,onClick:h,...e,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.logoutButton",defaultMessage:"Reset passwords for all users"})}),disableTooltip:l,renderTooltip:()=>(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.tooltip",defaultMessage:"You must verify a domain to manage its users"})})})})})}function Qi(e){let{spaceId:t,domainSettingsStore:s,promptUpgrade:n,verifiedDomains:i,disabled:a}=e;const l=i.length>0,d=(0,o.O7)(),u=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:!a&&l?1:.5}})),[a,l]),p=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.logoutAllUsers.title",defaultMessage:"Log out all users"}),m=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.logoutAllUsers.message",defaultMessage:"Force log out all managed users and require them to re-authenticate."});async function h(){ii.KF(d,{email_domains:i});const{accept:e}=await M.confirmUserActionV2({message:(0,c.jsx)(Me.Z,{style:M.dialogStyles.title,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.message",defaultMessage:"Log out all of your managed users?"})}),description:(0,c.jsx)(Me.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.description",defaultMessage:"You are about to log all of your managed users out of their current session, including you. The affected users will need to re-authenticate to log back into Notion."})}),acceptLabel:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.acceptLabel",defaultMessage:"Log out all managed users"}),cancelLabel:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.cancelLabel",defaultMessage:"Cancel"})});if(!e)return;const n=s.state.emailDomains;await T.logoutManagedUsers(d,{spaceId:t,target:{type:ni.J.Domains,emailDomains:n}}),oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"managedUsers.toastMessage.logout.all.success",defaultMessage:"Successfully logged out all managed users"})}),ii._6(d,{email_domains:n})}return n?(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(Di,{title:p,byline:m,targetTier:"enterprise"})}):(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(Oi.N,{title:p,byline:m,settingItem:(0,c.jsx)("div",{style:u.buttonAndErrorContainer,children:(0,c.jsx)(be.ZP,{placement:be.ug.Top,alignment:be.v2.End,render:e=>(0,c.jsx)(Xt.Z,{isRed:!0,disabled:a||!l,style:u.button,onClick:h,...e,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.logoutButton",defaultMessage:"Log out all users"})}),disableTooltip:l,renderTooltip:()=>(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.tooltip",defaultMessage:"You must verify a domain to manage its users"})})})})})}function $i(e){let{promptUpgrade:t,hasVerifiedDomains:s,disabled:i}=e;const{navigateTo:a}=(0,n.useContext)(qn),l=(0,o.O7)(),d=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.title",defaultMessage:"Managed users dashboard"}),u=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.message",defaultMessage:"Manage and view users that are using your verified domains"}),p=(0,r.yK)((e=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:!i&&s?1:.5}})),[s,i]);return t?(0,c.jsx)("div",{style:p.settingContainer,children:(0,c.jsx)(Di,{title:d,byline:u,targetTier:"enterprise"})}):(0,c.jsx)("div",{style:p.settingContainer,children:(0,c.jsx)(Oi.N,{title:d,byline:u,settingItem:(0,c.jsx)("div",{style:p.buttonAndErrorContainer,children:(0,c.jsx)(be.ZP,{placement:be.ug.Top,alignment:be.v2.End,render:e=>(0,c.jsx)(Ri.Z,{disabled:i||!s,isLarge:!0,style:p.button,onClick:()=>{ii.pC(l),a(Kn.ManagedUsersPage)},...e,children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"View dashboard",id:"identityAndProvisioning.managedUsers.button"})}),disableTooltip:s,renderTooltip:()=>(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.tooltip",defaultMessage:"You must verify a domain to manage its users"})})})})})}var Ji=s(63048);function Xi(e){let{domainSettingsStore:t,saveEmailDomainSettings:s,promptUpgrade:n,verifiedDomains:i,disabled:l}=e;const d=(0,o.O7)(),u=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),p=i.length>0,m=(0,a.VK)((()=>Boolean(t.state.settings.prevent_granting_support_access)),[t]),h=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventGrantingSupportAccess.title",defaultMessage:"Prevent managed users from granting support access"}),f=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventGrantingSupportAccess.message",defaultMessage:"Control if managed users can enable support access on their accounts."});return n?(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(Di,{title:h,byline:f,targetTier:"enterprise"})}):(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(Ji.w,{title:(0,c.jsx)("div",{style:u.settingsTitle,children:h}),byline:f,isOn:m,onToggle:async function(){const e=Boolean(!t.state.settings.prevent_granting_support_access);t.setState({...t.state,settings:{...t.state.settings,prevent_granting_support_access:e}}),ii.Dn(d,{new_value:e}),await s()},disabled:l||!p})})}function eo(e){let{domainSettingsStore:t,saveEmailDomainSettings:s,promptUpgrade:n,disabled:i}=e;const l=(0,o.O7)(),d=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),u=(0,a.VK)((()=>Boolean(t.state.settings.prevent_members_joining_external_workspace)),[t]),p=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventMembersJoiningExternalSpaces.title",defaultMessage:"External workspace access"}),m=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventMembersJoiningExternalSpaces.message",defaultMessage:"Control if managed users are able to join workspaces that aren't owned by your organization."});if(n)return(0,c.jsx)("div",{style:d.settingContainer,children:(0,c.jsx)(Di,{title:p,byline:m,targetTier:"enterprise"})});const h=u?"on":"off";return(0,c.jsx)("div",{style:d.settingContainer,children:(0,c.jsx)(bn.Z,{isMobile:l.device.isMobile,disabled:i,title:p,caption:m,type:"dropdown",currentOption:h,options:[{key:"on",label:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.enabled.titleGeneric",defaultMessage:"Only workspace owners"}),caption:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.enabled.caption",defaultMessage:"Only workspace owners of your connected workspaces can join external workspaces."})},{key:"off",label:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.disabled.titleWithSpaceName",defaultMessage:"Anyone"}),caption:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.disabled.caption",defaultMessage:"All users can join any workspace."})}],onSelectOption:async function(){const e=Boolean(!t.state.settings.prevent_members_joining_external_workspace);t.setState({...t.state,settings:{...t.state.settings,prevent_members_joining_external_workspace:e}}),ii.T4(l,{new_value:e}),await s()}})})}function to(e){let{domainSettingsStore:t,saveEmailDomainSettings:s,promptUpgrade:n,hasVerifiedDomains:i,disabled:l}=e;const d=(0,o.O7)(),u=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),p=(0,a.VK)((()=>Boolean(t.state.settings.prevent_profile_edits)),[t]),m=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventProfileEdits.title",defaultMessage:"Allow managed users to change profile information"}),h=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventProfileEdits.message",defaultMessage:"Control if managed users can change their preferred name, email address, and profile photo."});return n?(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(Di,{title:m,byline:h,targetTier:"enterprise"})}):(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(Ji.w,{title:(0,c.jsx)("div",{style:u.settingsTitle,children:m}),byline:h,isOn:!p,onToggle:async function(){const e=Boolean(!t.state.settings.prevent_profile_edits);t.setState({...t.state,settings:{...t.state.settings,prevent_profile_edits:e}}),ii.Dn(d,{new_value:e}),await s()},disabled:l||!i})})}function so(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:n}=e;const{verifiedDomains:i,isDomainSettingsAvailable:o,isSamlEditable:l,saveEmailDomainSettings:d}=_i({spaceStore:t,samlConfigStore:s,domainSettingsStore:n}),u=(0,r.yK)((e=>({byline:{fontSize:14,fontWeight:x.Z.fontWeight.regular,color:e.mediumTextColor},helpButton:{marginTop:18,marginBottom:16}})),[]),p=o&&l,m=(0,a.VK)((()=>t.id),[t]),h=(0,a.VK)((()=>(0,Ot.wP)()),[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{children:(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:u.byline,children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.byline",defaultMessage:"These settings apply to all users with a verified domain, even if they are not a member of this workspace."})})}),(0,c.jsx)(zi.Z,{title:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.helpButton",defaultMessage:"Learn about managed users"}),href:(0,Ue.UY)("guides.managedUsers"),style:u.helpButton,analyticsFrom:"managed_users_section"}),(0,c.jsx)($i,{promptUpgrade:!h,hasVerifiedDomains:i.length>0,disabled:!p}),(0,c.jsx)(to,{promptUpgrade:!h,hasVerifiedDomains:i.length>0,domainSettingsStore:n,saveEmailDomainSettings:d,disabled:!p}),(0,c.jsx)(eo,{promptUpgrade:!h,domainSettingsStore:n,saveEmailDomainSettings:d,disabled:!p}),(0,c.jsx)(Xi,{promptUpgrade:!h,verifiedDomains:i,domainSettingsStore:n,saveEmailDomainSettings:d,disabled:!p}),(0,c.jsx)(Hi,{promptUpgrade:!h,domainSettingsStore:n,saveEmailDomainSettings:d,disabled:!p}),(0,c.jsx)(Qi,{spaceId:m,promptUpgrade:!h,domainSettingsStore:n,verifiedDomains:i,disabled:!p}),(0,c.jsx)(Yi,{spaceId:m,promptUpgrade:!h,domainSettingsStore:n,verifiedDomains:i,disabled:!p})]})}function no(e){let{spaceStore:t,samlConfigStore:s}=e;const i=(0,o.O7)();return{updateSamlIdpUrl:(0,n.useCallback)((async e=>{let n=!1;return await Ai({onRequest:()=>T.setSamlConfig(i,{spaceId:t.id,idpMetadataUrl:e}),onSuccess:()=>{n=!0,s.setState({...s.state,useMetadataUrl:!0,idpMetadataUrl:e,idpMetadata:void 0})}}),n}),[s,t,i]),updateSamlIdpXml:(0,n.useCallback)((async e=>{let n=!1;return await Ai({onRequest:()=>T.setSamlConfig(i,{spaceId:t.id,idpMetadata:e}),onSuccess:()=>{n=!0,s.setState({...s.state,useMetadataUrl:!1,idpMetadataUrl:void 0,idpMetadata:e})}}),n}),[s,t,i]),updateStatus:(0,n.useCallback)((e=>Ai({onRequest:()=>T.setSamlConfig(i,{spaceId:t.id,status:e}),onSuccess:()=>{s.setState({...s.state,status:e})}})),[s,t,i]),updateCreateAccount:(0,n.useCallback)((e=>Ai({onRequest:()=>T.setSamlConfig(i,{spaceId:t.id,createAccount:e}),onSuccess:()=>{s.setState({...s.state,createAccount:e})}})),[s,t,i])}}function io(e){let{spaceStore:t,samlConfigStore:s,disabled:n}=e;const{updateCreateAccount:i}=no({samlConfigStore:s,spaceStore:t}),l=(0,o.O7)(),d=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),u=(0,a.VK)((()=>s.state.createAccount),[s]);return(0,c.jsx)("div",{style:d.settingContainer,children:(0,c.jsx)(Ji.w,{title:(0,c.jsxs)("div",{style:d.settingsTitle,children:[(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.createAccount.title",defaultMessage:"Automatic account creation"}),(0,c.jsx)(Qn.Z,{icon:Hn.m,onClick:()=>C.D({environment:l,url:(0,Ue.UY)("guides.samlJIT")})})]}),byline:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.createAccount.byline",defaultMessage:"Automatically create Notion accounts for new users who log in via SAML SSO."}),isOn:u,onToggle:async function(){await i(!s.state.createAccount)},disabled:n})})}function oo(e){let{spaceStore:t,samlConfigStore:s,promptUpgrade:n,disabled:i}=e;const l=(0,o.O7)(),{updateStatus:d}=no({samlConfigStore:s,spaceStore:t}),u=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),p=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.accountAuth.title",defaultMessage:"Login method"}),m=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.accountAuth.byline",defaultMessage:"Customize how users access SAML SSO-enabled workspaces."}),h=(0,a.VK)((()=>"enforced"===s.state.status?"enforced":"not_enforced"),[s]);return n?(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(Di,{title:p,byline:m,targetTier:"business"})}):(0,c.jsx)("div",{style:u.settingContainer,children:(0,c.jsx)(bn.Z,{isMobile:l.device.isMobile,disabled:i,title:p,caption:m,type:"dropdown",currentOption:h,options:[{key:"enforced",label:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.accountAuth.option.enforced",defaultMessage:"Only SAML SSO"})},{key:"not_enforced",label:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.accountAuth.option.notEnforced",defaultMessage:"Any method"})}],onSelectOption:async function(){"enforced"===s.state.status?await d("configured"):await d("enforced")}})})}var ao=s(13991),ro=s(54497),lo=s(5228),co=s(46978);function uo(e){let{isOpen:t,...s}=e;const n=(0,a.VK)((()=>({active:s.samlConfigStore.state.useMetadataUrl?"url":"xml",url:s.samlConfigStore.state.idpMetadataUrl||"",xml:s.samlConfigStore.state.idpMetadata||""})),[s.samlConfigStore]);return(0,c.jsx)(_n.Z,{open:t,onDismiss:s.onClose,render:()=>(0,c.jsx)(po,{...s,initialConfiguration:n})})}function po(e){let{onSaveChanges:t,initialConfiguration:s,samlConfigStore:i,spaceStore:l,onClose:d}=e;const[u,p]=(0,n.useState)(s),m=(0,o.O7)(),h=(0,r.yK)((e=>({container:{background:e.popoverBackground,width:450,padding:24,borderRadius:4,transition:"all 500ms ease"},title:{fontFamily:x.Z.getCompositeFontFamily(ao.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center"},subtitle:{fontFamily:x.Z.getCompositeFontFamily(ao.SP).sans,fontSize:14,fontWeight:500,lineHeight:"19px",margin:"20px 0 0"},copyButton:{borderRadius:4,padding:"4px 8px",display:"flex",alignItems:"center",justifyContent:"center",color:e.lightTextColor,fontFamily:x.Z.getCompositeFontFamily(ao.SP).sans,fontSize:12,fontWeight:500,lineHeight:"14px"},copyIcon:{width:16,height:16,marginRight:4,fill:e.mediumIconColor},url:{width:"100%",color:e.mediumTextColor,fontFamily:x.Z.getCompositeFontFamily(ao.SP).sans,fontSize:14,fontWeight:400,lineHeight:"18px"},readonlyInput:{display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${e.outlineButtonBorder}`,height:32,paddingLeft:12,paddingRight:12,borderRadius:4},divider:{margin:"20px auto 20px"},radioContainer:{display:"flex",justifyContent:"space-evenly",flexDirection:"column",height:60},radioOption:{display:"flex",alignItems:"center"},caption:{margin:"4px 0 8px"},centeredCaption:{margin:"4px 24px 8px",textAlign:"center"},buttonContainer:{display:"flex",alignItems:"center",justifyContent:"flex-end",marginTop:24},buttonSpacing:{marginRight:8},feedback:{color:"dark"===e.mode?e.accentColors.orange[500]:e.accentColors.orange[400],display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px",height:20}})),[]),f=(0,n.useMemo)((()=>go(u)),[u]),y=(0,a.VK)((()=>"unconfigured"===i.state.status),[i]),S=(0,a.VK)((()=>(0,lo.v9)(l.id,Gs.default.domainBaseUrl)),[l]),v=(0,n.useCallback)((()=>{ye.RD({environment:m,stringValue:S,copiedMessage:ye.tq.copiedLinkToClipboard})}),[m,S]),b=(0,n.useCallback)((()=>{p((e=>({...e,active:"url"})))}),[]),M=(0,n.useCallback)((()=>{p((e=>({...e,active:"xml"})))}),[]),j=(0,r.yK)((e=>({input:{transition:"all 200ms ease-in-out",boxShadow:"none",margin:"12px 0",width:"100%",background:e.popoverBackground,border:`1px solid ${e.outlineButtonBorder}`}})),[]),C=(0,n.useMemo)((()=>"url"===u.active?{placeholder:"https://...",value:u.url,onChange:e=>{const t=e.target.value;p((e=>({...e,url:t})))},style:{height:32,...j.input}}:{placeholder:'<md:EntityDescriptor entityID="...',value:u.xml,onChange:e=>{const t=e.target.value;p((e=>({...e,xml:t})))},textarea:!0,style:{height:118,...j.input},inputStyle:{width:"100%",height:"100%"}}),[u,j]),w=(0,n.useCallback)((()=>{t(u)}),[t,u]);return(0,c.jsxs)("div",{style:h.container,children:[(0,c.jsx)(Me.Z,{style:h.title,children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.title",defaultMessage:"SAML SSO Configuration"})}),(0,c.jsx)(Me.Z,{isSmall:!0,style:h.centeredCaption,isMultiline:!0,children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.byline",defaultMessage:"Configure SAML SSO for your Notion workspace with your Identity Provider (IDP). <guidelink>Learn more</guidelink>.",values:{guidelink:e=>(0,c.jsx)(vn.Z,{href:(0,Ue.UY)("guides.samlSettings"),external:!0,children:e})}})}),(0,c.jsx)(Me.Z,{style:h.subtitle,children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.acsTitle",defaultMessage:"Assertion Consumer Service (ACS) URL"})}),(0,c.jsx)(Me.Z,{isSmall:!0,style:h.caption,isMultiline:!0,children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.acsByline",defaultMessage:"Enter this in your IDP's SAML configuration."})}),(0,c.jsxs)("div",{style:h.readonlyInput,children:[(0,c.jsx)(Me.Z,{style:h.url,children:S}),(0,c.jsxs)(ve.Z,{onClick:v,style:h.copyButton,children:[(0,xe.U)(h.copyIcon),(0,c.jsx)(g.FormattedMessage,{id:"verifyDomainModal.editSamlConfig.copy",defaultMessage:"Copy"})]})]}),(0,c.jsx)(Me.Z,{style:h.subtitle,children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpTitle",defaultMessage:"Identity Provider Details"})}),(0,c.jsx)(Me.Z,{isSmall:!0,style:h.caption,children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpUrlByline",defaultMessage:"Enter the value provided by your IDP."})}),(0,c.jsxs)("div",{style:h.radioContainer,children:[(0,c.jsxs)(Xt.Z,{style:h.radioOption,onClick:b,children:[(0,c.jsx)(co.Z,{isSelected:"url"===u.active}),(0,c.jsx)(Me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpUrl",defaultMessage:"Identity Provider URL"})})]}),(0,c.jsxs)(Xt.Z,{style:h.radioOption,onClick:M,children:[(0,c.jsx)(co.Z,{isSelected:"xml"===u.active}),(0,c.jsx)(Me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpXml",defaultMessage:"Identity Provider Metadata XML"})})]})]}),(0,c.jsx)(dn.Z,{...C}),(0,c.jsx)("div",{style:h.feedback,children:(0,c.jsx)(mo,{validation:f})}),(0,c.jsxs)("div",{style:h.buttonContainer,children:[(0,c.jsx)(Ri.Z,{isLarge:!0,style:h.buttonSpacing,onClick:d,children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.cancel",defaultMessage:"Cancel"})}),(0,c.jsx)(Sn.Z,{isLarge:!0,disabled:"invalid"===f.type,onClick:w,children:y?(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.enableSaml",defaultMessage:"Enable SAML"}):(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.saveChanges",defaultMessage:"Save changes"})})]})]})}function mo(e){let t,{validation:s}=e;if("valid"===s.type)return null;switch(s.reason){case"empty":t=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.feedback.empty",defaultMessage:"You cannot leave this field blank"});break;case"signed_request":t=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.feedback.signed_request",defaultMessage:"Requests cannot be signed"})}return(0,c.jsxs)(c.Fragment,{children:[(0,ro.t)({height:16,width:16,margin:"0 4px 0 8px"}),(0,c.jsx)("span",{children:t})]})}function go(e){return"url"===e.active?(0,lo.jY)(e.url):"xml"===e.active?(0,lo.a7)(e.xml):void(0,fs.t1)(e.active)}function ho(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:i,isSamlStatusEnabled:o,promptUpgrade:a,disabled:l}=e;const[d,u]=(0,n.useState)({isOpened:!1,enableSamlOnSave:!1}),{updateStatus:p,updateSamlIdpUrl:m,updateSamlIdpXml:h}=no({samlConfigStore:s,spaceStore:t}),{verifiedDomains:f}=_i({spaceStore:t,samlConfigStore:s,domainSettingsStore:i}),y=(0,r.yK)((()=>({settingContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",cursor:l?"default":"pointer"},settingTitle:{fontWeight:x.Z.fontWeight.medium},settingByline:{marginBottom:4},configButton:{marginTop:14}})),[l]),S=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.samlToggle.title",defaultMessage:"Enable SAML SSO"}),v=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.samlToggle.byline",defaultMessage:"Anyone using email addresses with a verified domain can log in via SAML SSO."});return a?(0,c.jsx)(Di,{title:S,byline:v,targetTier:"business"}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Ji.w,{title:S,byline:v,isOn:o,disabled:l,tooltipForDisabled:0===f.length?(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.samlToggle.disabledTooltipNoVerifiedDomains",defaultMessage:"Verify a domain to enable SAML."}):void 0,onToggle:function(){if(l)return;const{useMetadataUrl:e,idpMetadata:t,idpMetadataUrl:n}=s.state,i=e&&n||!e&&t;switch(s.state.status){case"disabled":i?p("configured"):u({isOpened:!0,enableSamlOnSave:!0});break;case"unconfigured":u({isOpened:!0,enableSamlOnSave:!0});break;case"configured":case"enforced":p("disabled")}}}),(0,c.jsx)(Ri.Z,{disabled:l,disabledFeedback:l,isLarge:!0,style:y.configButton,onClick:function(){l||u({isOpened:!0,enableSamlOnSave:!1})},children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.samlToggle.configure",defaultMessage:"Edit SAML SSO configuration"})}),(0,c.jsx)(uo,{isOpen:d.isOpened,onClose:()=>u({isOpened:!1,enableSamlOnSave:!1}),onSaveChanges:async function(e){if("invalid"===go(e).type)return;let t=!1;switch(e.active){case"url":t=await m(e.url);break;case"xml":t=await h(e.xml)}t&&(d.enableSamlOnSave&&await p("configured"),u({isOpened:!1,enableSamlOnSave:!1}))},spaceStore:t,samlConfigStore:s})]})}var fo=s(39634),xo=s(7057);const yo={id:"name",headerTitle:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.name",defaultMessage:"Name"}),renderCell:e=>(0,c.jsx)(Co,{space:e.space,isCurrentSpace:e.isCurrentSpace}),widthData:{width:50},sortable:!0},So={id:"memberCount",headerTitle:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.memberCount",defaultMessage:"Members"}),renderCell:e=>(0,c.jsx)(Me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.members",defaultMessage:"{count} members",values:{count:e.space.memberCount}})}),widthData:{width:20},sortable:!0},vo={id:"createdAt",headerTitle:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.plan",defaultMessage:"Created at"}),renderCell:e=>{const t=e.space.createdTime;return(0,c.jsx)(Me.Z,{children:t&&(0,xo.Yx)(t,"medium",ao.SP)})},widthData:{width:20},sortable:!0},bo=[yo,So,vo];function Mo(e){let{spaceStore:t,spaces:s}=e;const[i,o]=(0,n.useState)({column:yo,sortAscending:!1}),l=(0,a.VK)((()=>s.map((e=>({id:e.id,isClickable:!1,isCurrentSpace:t.id===e.id,space:e})))),[s,t]),d=(0,r.yK)((e=>(0,Se.b)({columnRenderInfo:bo,theme:e,containerMarginTop:12})),[]);return(0,c.jsx)(Se.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:bo,rows:jo(l,i),sortState:i,onSortStateChanged:o,renderNoRowsComponent:()=>(0,c.jsx)(Me.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.empty",defaultMessage:"No linked workspaces."})}),styles:d})}function jo(e,t){let{column:s,sortAscending:n}=t,i=[];switch(s.id){case"name":i=h.MR(e,(e=>e.space.name));break;case"createdAt":i=h.MR(e,(e=>e.space.createdTime));break;case"memberCount":i=h.MR(e,(e=>e.space.memberCount))}return n?i:i.reverse()}function Co(e){const t=(0,r.yK)((()=>({container:{display:"flex",justifyContent:"center",alignItems:"center",gap:4}})),[]);return(0,c.jsxs)(Me.Z,{style:t.container,children:[e.space.name,e.isCurrentSpace?(0,c.jsx)(te.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.name.currentBadge",defaultMessage:"Current"})}):null]})}function wo(e){let{spaceStore:t,spaces:s}=e;const i=(0,o.O7)(),a=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),l=(0,n.useCallback)((()=>{fo.j({environment:i,from:"saml_settings",prepopulatedContent:`Request to add or remove a workspace for SAML Single Sign-on on workspace ${t.id}.`})}),[t,i]);return(0,c.jsxs)("div",{style:a.settingContainer,children:[(0,c.jsx)(Oi.N,{title:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.title",defaultMessage:"Linked workspaces"}),byline:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.message",defaultMessage:"This SAML SSO configuration applies to the following other workspaces. <contactlink>Contact support</contactlink> to add or remove a workspace.",values:{contactlink:e=>(0,c.jsx)(vn.Z,{onClick:l,children:e})}}),settingItem:null}),(0,c.jsx)(Mo,{spaceStore:t,spaces:s})]})}function ko(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:n}=e;const{verifiedDomains:i,isSamlAvailable:o,isSamlEditable:r,isSamlStatusEnabled:l}=_i({spaceStore:t,samlConfigStore:s,domainSettingsStore:n}),d=!r||!o||!l,u=(0,a.VK)((()=>s.state.spaces),[s]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(zi.Z,{title:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.samlToggle.learnMore",defaultMessage:"Learn about SAML SSO"}),href:(0,Ue.UY)("guides.samlSettings"),style:{marginTop:18,marginBottom:16},analyticsFrom:"saml_settings"}),(0,c.jsx)(ho,{disabled:!r||0===i.length,promptUpgrade:!o,isSamlStatusEnabled:l,spaceStore:t,samlConfigStore:s,domainSettingsStore:n}),(0,c.jsx)(oo,{disabled:d,promptUpgrade:!o,spaceStore:t,samlConfigStore:s}),(0,c.jsx)(io,{disabled:d,spaceStore:t,samlConfigStore:s}),(0,c.jsx)(wo,{spaceStore:t,spaces:u})]})}const To=(0,g.defineMessages)({failedCreatingNewScimToken:{id:"scimTokenSettings.error.failedCreatingNewScimToken",defaultMessage:"Failed to create a new SCIM token, please try again later."}});function Io(e){const[t,s]=(0,n.useState)(!1),i=(0,o.O7)();const a=!t&&"Able"===e.tokenCreationAbility,r=t||"Able"!==e.tokenCreationAbility,l=(0,c.jsx)(Xt.Z,{isBlue:a,isLightGray:r,disabled:r,style:{position:"relative",marginLeft:"auto",marginRight:0},icon:e=>(0,Ws.R)({...e,width:14,height:14,fill:"inherit",marginRight:"6px"}),onClick:async function(){s(!0);try{const t=await async function(e){let{environment:t,spaceStore:s,userStore:n}=e;const{botStore:i,transactionPromise:o}=js.lz({environment:t,spaceStore:s,name:"SCIM",userId:n.id,spaceRole:"editor",type:"scim"});return await o,i.id}({...e,environment:i});e.onNewScimToken(t)}catch(t){M.showErrorMessage(L.default.formatMessage(To.failedCreatingNewScimToken))}s(!1)},children:(0,c.jsx)(g.FormattedMessage,{id:"scimTokenSettings.NewSCIMTokenButton.title",defaultMessage:"Add token"})});let d;switch(e.tokenCreationAbility){case"Able":return l;case"Undefined":d=(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Not able to create a new SCIM token right now. Please try again later.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.undefined"});break;case"SpaceHasExistingToken":d=(0,c.jsx)(g.FormattedMessage,{defaultMessage:"To create a new SCIM token, please revoke the existing token.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.spaceHasLegacyToken"});break;case"UserHasExistingToken":d=(0,c.jsx)(g.FormattedMessage,{defaultMessage:"You already have a registered SCIM token. To create a new one, please revoke the token created by you.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.userHasExistingToken"});break;default:(0,fs.t1)(e.tokenCreationAbility)}return(0,c.jsx)(be.ZP,{textWrap:!1,renderTooltip:()=>d,placement:be.ug.Right,render:e=>(0,c.jsx)("div",{...e,style:{paddingLeft:"4px"},children:l})})}var Zo=s(15070),Po=s(59753),Fo=s(7928);function Ao(e){let{userId:t,currentSpaceStore:s}=e;return ne.U6.createChildStore(s,{table:B.KJ,id:t})}var _o=s(31945),Ro=s(62385),Oo=s(17290);const Bo={container:{display:"flex",alignItems:"center",fontSize:x.Z.fontSize.UIRegular.desktop,overflow:"hidden"},userAvatar:{paddingRight:6},userName:{flexShrink:1,...x.Z.textOverflowStyle}};function Do(e,t){const s=Po.kk.fromValue(O.cZ,e);return s.getCreatedByTable()===B.KJ&&s.getCreatedById()===t}const Lo={buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,height:20,width:20,marginRight:1},menuItemButton:{minWidth:200}};function Vo(e){let{onRevokeToken:t}=e;const s=(0,r.Fg)();return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(be.ZP,{textWrap:!1,renderTooltip:()=>(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Revoke this token.",id:"revokeTokenButton.tooltip"})}),placement:be.ug.Right,render:e=>(0,c.jsx)(_o.ZP,{popupType:_o.Z4.Popup,placementToOrigin:_o.pO.Right,renderOrigin:t=>(0,c.jsx)(ve.Z,{className:Ne.TAd,style:Lo.buttonStyle,mobileFeedback:!1,...e,...t,children:(0,si.y)({fill:s.mediumIconColor,width:12,height:12})}),onClick:()=>{M.confirmUserAction({message:(0,c.jsx)(g.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.message",defaultMessage:"Are you sure you want to revoke this token?"}),description:(0,c.jsx)(g.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.description",defaultMessage:"Existing SCIM configurations that use this token will no longer work once the token is revoked, and you'll have to provide them with a new token."}),acceptLabel:(0,c.jsx)(g.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.acceptButton.label",defaultMessage:"Revoke token"}),cancelLabel:(0,c.jsx)(g.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.cancelButton.label",defaultMessage:"Cancel"})}).then((e=>e&&t()))},render:e=>(e.close(),(0,c.jsx)(c.Fragment,{}))})})})}function No(){const e=(0,r.Fg)();return(0,c.jsx)(be.ZP,{textWrap:!1,renderTooltip:()=>(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Outdated token. Revoke this token and generate a new one to view its contents.",id:"manageScimTokenTable.OutdatedWarningIcon.tooltip"})}),placement:be.ug.Right,render:t=>(0,c.jsx)("div",{...t,style:{paddingLeft:"4px"},children:(0,ro.t)({fill:(0,Ks.fi)("orange",e).fill,width:12,height:12})})})}function Eo(e){let{clipboardTextFn:t}=e;const s=(0,o.O7)();const n=(0,r.Fg)(),i={height:25,background:n.whiteButtonBackground,color:n.regularTextColor,fontWeight:x.Z.fontWeight.regular,padding:"4px 6px",fontSize:11.5};return(0,c.jsxs)(Ro.Z,{onClick:async function(){const e=await t();void 0!==e&&ye.RD({environment:s,stringValue:e,copiedMessage:ye.tq.copiedTokenToClipboard,showCopyModal:!!s.device.isSafari||void 0})},style:i,children:[(0,xe.U)({height:16,width:16,paddingRight:4}),(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Copy",id:"codeBlock.copyToClipboard.button"})]})}const Uo="•••••••••••";function Wo(){return(0,c.jsx)(be.ZP,{textWrap:!1,renderTooltip:()=>(0,c.jsx)(g.FormattedMessage,{defaultMessage:"This token can only be viewed by its creator.",id:"manageScimTokenTable.renderTokenThatCannotBeViewed.tooltip"}),placement:be.ug.Right,render:e=>(0,c.jsx)("div",{...e,children:Uo})})}function Ko(e){let{row:t}=e;const s=(0,o.O7)();return t.legacy?(0,c.jsxs)(c.Fragment,{children:[Uo,(0,c.jsx)(No,{})]}):t.ownedByCurrentUser?(0,c.jsxs)(c.Fragment,{children:[Uo,(0,c.jsx)(Eo,{clipboardTextFn:()=>js.VG({environment:s,botId:t.id})})]}):(0,c.jsx)(Wo,{})}const zo={id:"token",headerTitle:(0,c.jsx)(g.FormattedMessage,{id:"manageScimTokenTable.columnTitle.token",defaultMessage:"Token"}),renderCell:e=>(0,c.jsx)(Ko,{row:e}),widthData:{width:40},sortable:!1,hasClickableContents:!0};function qo(){const e=Bo;return(0,c.jsx)(be.ZP,{textWrap:!1,renderTooltip:()=>(0,c.jsx)(g.FormattedMessage,{defaultMessage:"This token was created by a user who is no longer an admin in the workspace.",id:"scimTableLegacyUserCell.tooltip"}),placement:be.ug.Right,render:t=>(0,c.jsx)("div",{...t,children:(0,c.jsxs)("div",{style:e.container,children:[(0,c.jsx)(Rn.Z,{style:e.userAvatar,avatarShouldShowShadow:!0,size:20}),(0,c.jsx)("div",{style:e.userName,children:(0,c.jsx)("i",{children:"Deactivated user"})})]})})})}const Go={id:"addedBy",headerTitle:(0,c.jsx)(g.FormattedMessage,{id:"manageScimTokenTable.columnTitle.addedBy",defaultMessage:"Added by"}),renderCell:e=>{if(e.legacy)return(0,c.jsx)(qo,{});{const t=e.ownedByCurrentUser?(0,c.jsx)(Me.Z,{isSecondaryColor:!0,style:{marginLeft:4,textAlign:"center"},children:(0,c.jsx)(g.FormattedMessage,{id:"manageSCIMTokenTable.colums.addedBy.selfIndicator",defaultMessage:"(you)"})}):(0,c.jsx)(c.Fragment,{});return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Oo.G,{isClickable:!1,userStores:[e.ownerUserStore]}),t]})}},widthData:{width:40},sortable:!1,hasClickableContents:!1},Ho={id:"created",headerTitle:(0,c.jsx)(g.FormattedMessage,{id:"manageScimTokenTable.columnTitle.created",defaultMessage:"Created"}),renderCell:e=>(0,c.jsx)(ui.T,{includeTime:!0,dateTs:e.createdAt}),widthData:{width:40},sortable:!0,hasClickableContents:!1},Yo=[zo,Go,Ho,{id:"revokeToken",headerTitle:void 0,renderCell:e=>(0,c.jsx)(Vo,{onRevokeToken:()=>{e.onRevokeToken()}}),widthData:{width:10},sortable:!1,hasClickableContents:!0}];function Qo(e,t){let{column:s,sortAscending:n}=t;const i=null==s?void 0:s.id;let o=e=>e.id;switch(i){case"name":o=e=>e.name;break;case"created":o=e=>e.createdAt;break;case"token":case"addedBy":case"revokeToken":case void 0:break;default:(0,fs.t1)(i)}const a=h.MR(e,o);return n||a.reverse(),a}function $o(e){let{botStores:t,onRevokeToken:s}=e;const i=(0,a.VK)((()=>Ke.default.state.currentUserStore),[]),o=(0,a.VK)((()=>Ke.default.state.currentSpaceStore),[]),l=(0,g.useIntl)(),d=(0,a.VK)((()=>{if(!o)return[];const e=null==i?void 0:i.id;return h.oA(t.map((t=>{const n=t.getModel();if(!n||!(0,Zo.xe)(n))return;const i={id:n.id,isClickable:!1,createdAt:n.getCreatedAt(),userLocale:l.locale,name:n.getName(),onRevokeToken:()=>{s(n.id)}},a=function(e){const t=Po.kk.fromValue(O.cZ,e);return"notion_user"===t.getCreatedByTable()&&t.getCreatedById()===B.s$.id}(n);return a?{...i,legacy:a}:{...i,legacy:a,ownedByCurrentUser:Do(n,e),ownerUserStore:"notion_user"===n.getCreatedByTable()?Ao({userId:n.getCreatedById(),currentSpaceStore:o}):void 0}})))}),[t,o,i,l.locale,s]),[u,p]=(0,n.useState)({column:Ho,sortAscending:!1}),m=(0,r.yK)((e=>(0,Se.b)({columnRenderInfo:Yo,theme:e,containerMarginTop:0})),[]);return(0,c.jsx)(Se.D,{columnRenderInfo:Yo,rows:Qo(d,u),sortState:u,onSortStateChanged:p,onRowClick:()=>(0,c.jsx)(c.Fragment,{}),renderNoRowsComponent:()=>(0,c.jsx)(Me.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:(0,c.jsx)(g.FormattedMessage,{id:"manageSCIMTokenTable.noTokensFound.message",defaultMessage:"No active SCIM tokens."})}),styles:m})}async function Jo(e){let{environment:t,spaceId:s}=e;return(await js.Yw({environment:t,table:Ms.bx,id:s,type:"scim"})).botIds}const Xo=function(e){let{botIds:t,setBotIds:s,spaceStore:i}=e;const a=(0,o.O7)(),r=i.id;if((0,n.useEffect)((()=>{void 0===t&&Jo({environment:a,spaceId:r}).then(s)}),[t,a,s,r]),t){const e=t.map((e=>ne.t1.createChildStore(i,{table:O.cZ,id:e,spaceId:r})));return(0,c.jsx)($o,{botStores:e,onRevokeToken:e=>{js.P0({environment:a,botId:e,onSuccess:()=>{Jo({environment:a,spaceId:r}).then(s)}})}})}return(0,c.jsx)(Pi.Z,{})};function ea(e){let{userStore:t,spaceStore:s,promptUpgrade:i}=e;const[r,l]=(0,n.useState)(void 0),d=(0,o.O7)(),u=(0,a.VK)((()=>function(e){let{botIds:t,spaceStore:s,environment:n}=e;if(void 0===t)return"Undefined";const i=t.map((e=>ne.t1.createChildStore(s,{table:O.cZ,id:e,spaceId:s.id}))).filter((e=>e.isDefined()));if(i.some((e=>e.getCreatedByTable()===B.KJ&&e.getCreatedById()===B.s$.id)))return"SpaceHasExistingToken";const o=i.some((e=>e.getCreatedByTable()===B.KJ&&e.getCreatedById()===n.currentUser.id));if(o)return"UserHasExistingToken";return"Able"}({botIds:r,spaceStore:s,environment:d})),[r,d,s]),p=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.scim.title",defaultMessage:"SCIM tokens"}),m=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.scim.byline",defaultMessage:"Generate a token to configure SCIM."});return i?(0,c.jsx)(Di,{title:p,byline:m,targetTier:"enterprise"}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Oi.N,{title:p,byline:m,settingItem:(0,c.jsx)(Io,{onNewScimToken:e=>l((t=>[...t??[],e])),spaceStore:s,userStore:t,tokenCreationAbility:u})}),(0,c.jsx)(zi.Z,{title:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.SCIMSection.helpButton.label",defaultMessage:"Learn about SCIM"}),style:{marginTop:18,marginBottom:24},href:(0,Ue.UY)("guides.scim"),analyticsFrom:"scim_settings"}),(0,c.jsx)(Xo,{spaceStore:s,userStore:t,botIds:r,setBotIds:l})]})}function ta(e){let{spaceStore:t}=e;const s=(0,o.O7)(),n=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),i=(0,a.VK)((()=>Boolean(t.getSettings().are_scim_invite_emails_suppressed)),[t]),l=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.scim.suppressScimInviteEmails.title",defaultMessage:"Suppress invite emails from SCIM provisioning"}),d=(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.scim.suppressScimInviteEmails.message",defaultMessage:"Control if users will receive invite emails when provisioned by SCIM to workspaces and groups."});return(0,c.jsx)("div",{style:n.settingContainer,children:(0,c.jsx)(Ji.w,{title:(0,c.jsx)("div",{style:n.settingsTitle,children:l}),byline:d,isOn:i,onToggle:()=>function(e){let{environment:t,areScimInviteEmailsSuppressed:s,spaceStore:n}=e;P.createAndCommit({userAction:"ScimSection.SuppressScimInviteEmailsSetting",environment:t,perform:e=>{P.applyOperation({store:n,operation:{pointer:n.pointer,path:["settings","are_scim_invite_emails_suppressed"],command:"set",args:s},transaction:e})}})}({environment:s,spaceStore:t,areScimInviteEmailsSuppressed:!i})})})}function sa(e){let{userStore:t,spaceStore:s}=e;const n=(0,a.VK)((()=>(0,Ot.wP)()),[]),i=(0,a.VK)((()=>Ce.default.checkGate("scim_suppress_email")),[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(ea,{promptUpgrade:!n,userStore:t,spaceStore:s}),n&&i?(0,c.jsx)(ta,{spaceStore:s}):null]})}function na(e){let{primarySpaceName:t}=e;const s=(0,r.yK)((e=>({container:{background:e.accentColors.blue[100],padding:"18px 24px",borderRadius:4,margin:"0 0 24px"}})),[]);return(0,c.jsxs)("div",{style:s.container,children:[(0,c.jsx)(Me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.secondaryWorkspace.uneditableTitle",defaultMessage:"The primary workspace is <bold>{primaryWorkspaceName}</bold>.",values:{primaryWorkspaceName:t,bold:e=>(0,c.jsx)("span",{style:{fontWeight:x.Z.fontWeight.semibold},children:e})}})}),(0,c.jsx)("br",{}),(0,c.jsx)(Me.Z,{isMultiline:!0,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.secondaryWorkspace.uneditableMessage",defaultMessage:"The domain management settings and SAML SSO configuration are being managed by the workspace <bold>{primaryWorkspaceName}</bold>. Please navigate there or contact an admin of that workspace to edit the verified domains or SSO configuration.",values:{primaryWorkspaceName:t,bold:e=>(0,c.jsx)("span",{style:{fontWeight:x.Z.fontWeight.semibold},children:e})}})})]})}var ia=s(86990);function oa(e){let{userStore:t,spaceStore:s,samlConfigStore:i,domainSettingsStore:l}=e;const d=(0,o.O7)(),u=(0,a.VK)((()=>ns.Z.state.online),[]),{loadingSaml:p,loadedSaml:m,errorSaml:h}=(0,n.useContext)(qn),f=(0,a.VK)((()=>function(e){let{environment:t,samlConfigStore:s,spaceStore:n}=e;const i=Ii({environment:t,samlConfigStore:s}),o=!s.state.id||s.state.id===n.id;return i&&o}({environment:d,samlConfigStore:i,spaceStore:s})),[d,i,s]),x=(0,a.VK)((()=>i.state.id?Zi.Z.getData(d,{spaceId:i.state.id}):void 0),[d,i]),y=(0,r.yK)((()=>({header:{marginTop:48}})),[]),S=(0,a.VK)((()=>(0,Ot.wP)()),[]);return(0,n.useEffect)((()=>{u&&!p&&h&&M.deprecatedShowErrorMessage(h.message)}),[h,p,u]),u?p?(0,c.jsx)(pt.ZP,{children:(0,c.jsx)(Pi.Z,{style:{margin:"0 auto"}})}):h?null:m?(0,c.jsxs)(pt.ZP,{children:[!f&&x?(0,c.jsx)(na,{primarySpaceName:x.name}):null,(0,c.jsx)(me.Z,{large:!0,divider:"full",children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.domain.title",defaultMessage:"Domain management"})}),(0,c.jsx)(Ki,{spaceStore:s,samlConfigStore:i,domainSettingsStore:l,isCurrentSpaceEnterprise:S}),(0,c.jsx)(me.Z,{large:!0,divider:"full",style:y.header,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.userManagement.title",defaultMessage:"User management"})}),(0,c.jsx)(so,{spaceStore:s,samlConfigStore:i,domainSettingsStore:l}),(0,c.jsx)(me.Z,{large:!0,divider:"full",style:y.header,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.saml.title",defaultMessage:"SAML Single sign-on (SSO)"})}),(0,c.jsx)(ko,{spaceStore:s,samlConfigStore:i,domainSettingsStore:l}),(0,c.jsx)(me.Z,{large:!0,divider:"full",style:y.header,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.scim.title",defaultMessage:"SCIM provisioning"})}),(0,c.jsx)(sa,{userStore:t,spaceStore:s}),(0,c.jsx)(me.Z,{large:!0,divider:"full",style:y.header,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.setupInfo.title",defaultMessage:"Setup information"})}),(0,c.jsx)(ia.H,{spaceStore:s,isEnterprise:S})]}):null:(0,c.jsx)(pt.ZP,{children:(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Please go online to manage identity and provisioning settings.",id:"identityProvisioningSettings.offline.message"})})})}function aa(e,t){return(void 0===e||!(0,As.XR)(e))&&(!(void 0===e||!(0,As.TZ)(e)||0!==t)||1===t)}var ra=s(92595),la=s(92165);const da=(0,d.IU)("arrowUpCircled",{viewBox:"0 0 16 16",svg:(0,c.jsx)("path",{d:"M7.993 15.126c.966 0 1.875-.185 2.728-.554a7.218 7.218 0 003.787-3.78 6.788 6.788 0 00.553-2.728c0-.966-.184-1.875-.553-2.727a7.136 7.136 0 00-1.531-2.25 7.219 7.219 0 00-2.256-1.53 6.805 6.805 0 00-2.735-.554c-.966 0-1.875.185-2.727.554a7.241 7.241 0 00-3.774 3.78 6.788 6.788 0 00-.553 2.727c0 .967.184 1.876.553 2.728.37.852.878 1.604 1.525 2.256a7.124 7.124 0 002.256 1.524 6.77 6.77 0 002.727.554zm0-1.395a5.598 5.598 0 01-4.013-1.654 5.735 5.735 0 01-1.21-1.804 5.567 5.567 0 01-.437-2.209c0-.783.146-1.517.438-2.2a5.715 5.715 0 011.21-1.812 5.6 5.6 0 011.797-1.217 5.599 5.599 0 012.208-.438c.789 0 1.525.146 2.208.438a5.66 5.66 0 013.029 3.028 5.55 5.55 0 01.437 2.201c0 .789-.146 1.525-.437 2.209a5.68 5.68 0 01-1.217 1.804 5.68 5.68 0 01-1.805 1.217 5.567 5.567 0 01-2.208.437zM8 11.51a.597.597 0 00.43-.164.584.584 0 00.172-.431V7.688L8.547 6.28l.622.78.759.793a.53.53 0 00.417.177c.16 0 .291-.052.396-.157a.518.518 0 00.164-.39.595.595 0 00-.164-.417L8.485 4.783A.664.664 0 008 4.558c-.173 0-.333.075-.479.225L5.26 7.066a.593.593 0 00-.157.417.538.538 0 00.554.547.557.557 0 00.416-.177l.766-.8.615-.766-.055 1.401v3.227c0 .173.057.317.171.43.114.11.258.165.431.165z"})});var ca=s(61652),ua=s(99622),pa=s(27242),ma=s(54561),ga=s(73420);function ha(){return(0,c.jsx)(be.ZP,{renderTooltip:()=>(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingWorkspaceClaim.Explanation",defaultMessage:"Workspace claim request is being processed."}),render:e=>(0,c.jsx)(Me.Z,{...e,children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingClaim",defaultMessage:"Pending"})})})}function fa(e){let{admin:t}=e;const s=(0,g.useIntl)();return(0,c.jsx)(be.ZP,{renderTooltip:()=>(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingWorkspaceTransferExplanation",defaultMessage:"Waiting for {name} to transfer the workspace to an external account.",values:{name:(0,Fo.Nz)(s,t)}}),render:e=>(0,c.jsx)(Me.Z,{...e,children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingTransfer",defaultMessage:"Pending"})})})}var xa=s(56666),ya=s(61766),Sa=s(93405);let va=function(e){return e.Single="single",e.Multi="multi",e}({});function ba(e){const{space:t,mode:s}=e,n=(0,a.qz)(void 0,ya.Z),i=(0,r.yK)((()=>({container:{minWidth:325}})),[]);return s===va.Single?(0,c.jsx)(ja,{action:e.action,space:t}):(0,c.jsx)(_o.ZP,{popupType:cn.kQ.Popup,style:i.container,buttonPopupStore:n,renderOrigin:e=>(0,c.jsx)(Qn.Z,{icon:xa.o,...e}),render:()=>(0,c.jsx)(Ma,{space:t,actions:e.actions,popupStore:n})})}function Ma(e){let{space:t,actions:s,popupStore:n}=e;const i={key:"workspace-actions",render:e=>(0,c.jsx)(tn.Z,{...e}),items:s.map((e=>{const s=!!e.getDisabledState&&e.getDisabledState(t),n=e.getTooltip?e.getTooltip(t):null;return{key:e.id,render:t=>(0,c.jsx)(be.ZP,{render:n=>(0,c.jsx)(Sa.Z,{...t,...n,shouldWrapCaption:!0,svg:t=>e.getIcon(t),title:e.name,caption:e.caption,style:{paddingTop:8,paddingBottom:8,opacity:s?.5:1},disabled:s}),renderTooltip:()=>n,disableTooltip:!Boolean(n),placement:be.ug.Left}),action:()=>e.onAction(t)}}))};return(0,c.jsx)($s.Z,{menuType:Hs.og.Popup,children:(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,initialFocus:void 0,sections:[i],onAccept:()=>{n.setState({open:!1})}})})}function ja(e){const{action:t,space:s}=e,i=(0,r.yK)((e=>({button:{paddingLeft:5,paddingRight:5}})),[]),o=n.useCallback((()=>{t.onAction(s)}),[t,s]);return(0,c.jsx)(Xt.Z,{isSmall:!0,style:i.button,onClick:o,children:t.name})}var Ca=s(33941);function wa(e){let{id:t,name:s,icon:n,subscriptionTier:i,memberCount:o,highlightIconContainer:a}=e;const l=(0,g.useIntl)(),d=n?{pointer:{table:Ms.bx,id:t,spaceId:t},icon:n}:void 0,u=(0,r.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",padding:"8px 0",width:"100%"},summaryContainer:{width:"calc(100% - 38px)"},iconContainer:{height:38,width:38,flexGrow:0,flexShrink:0,flexBasis:38,marginRight:12,display:"flex",justifyContent:"center",alignItems:"center",background:a?e.selectLightGray[50]:void 0,borderRadius:6},name:{fontSize:14,fontWeight:500},byline:{fontSize:12,opacity:.5}})),[a]);return(0,c.jsxs)("div",{style:u.container,children:[(0,c.jsx)("div",{style:u.iconContainer,children:(0,c.jsx)(en.Z,{disabled:!0,icon:d,isEmptyPage:!1,size:32,title:s,isLarge:!0,emojiSize:28,isRaw:!1})}),(0,c.jsxs)("div",{style:u.summaryContainer,children:[(0,c.jsx)(Me.Z,{style:u.name,showTooltipWhenTruncated:!0,children:s}),(0,c.jsx)(Me.Z,{style:u.byline,children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.summaryByline",defaultMessage:"{subscriptionTier} · {memberCount, plural, one {{memberCount} member} other {{memberCount} members}}",values:{subscriptionTier:ka(i,l),memberCount:o}})})]})]})}function ka(e,t){switch(e){case"personal_free":case"team_free":case"free":return t.formatMessage(Ca.a.free);case"personal":return t.formatMessage(Ca.a.personal);case"plus":return t.formatMessage(Ca.a.plusPlan);case"business":return t.formatMessage(Ca.a.business);default:(0,fs.t1)(e)}}var Ta=s(3556);function Ia(e){let{users:t,deletedUserEmailDomain:s}=e;const n=(0,a.qz)(void 0,ya.Z),i=(0,r.yK)((()=>({container:{minWidth:275}})),[]);return(0,c.jsx)(_o.ZP,{popupType:cn.kQ.Popup,style:i.container,buttonPopupStore:n,renderOrigin:e=>(0,c.jsx)(Fa,{users:t,deletedUserEmailDomain:s,...e}),render:()=>(0,c.jsx)(Za,{users:t,popupStore:n})})}function Za(e){let{users:t,popupStore:s}=e;const n=(0,o.O7)(),i={key:"workspace-users-menu",render:e=>(0,c.jsx)(tn.Z,{...e}),items:t.map((e=>({key:e.id,render:t=>(0,c.jsx)(Pa,{user:e,...t}),action:()=>C.D({environment:n,url:`mailto:${e.email}`})})))};return(0,c.jsx)($s.Z,{menuType:Hs.og.Popup,children:(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,initialFocus:0,sections:[i],onAccept:()=>{s.setState({open:!1})}})})}function Pa(e){let{user:t,...s}=e;const n=(0,g.useIntl)(),i=(0,r.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",height:"auto",paddingTop:8,paddingBottom:8,margin:"0 6px"},avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center"},copyContainer:{display:"flex",justifyContent:"center",alignItems:"center",marginLeft:"auto",opacity:.5},nameContainer:{marginLeft:8,marginRight:8},name:{fontSize:14,lineHeight:1.2,maxWidth:300},email:{fontSize:12,lineHeight:1.2,opacity:.5,maxWidth:300}})),[]);return(0,c.jsxs)(Xt.Z,{style:i.container,...s,children:[(0,c.jsx)("div",{style:i.avatarContainer,children:(0,c.jsx)(Rn.Z,{userValue:t,size:24})}),(0,c.jsxs)("div",{style:i.nameContainer,children:[(0,c.jsx)(Me.Z,{style:i.name,children:(0,Fo.Nz)(n,t)}),(0,c.jsx)(Me.Z,{style:i.email,children:t.email})]}),(0,c.jsx)("div",{style:i.copyContainer,children:(0,Ta.Z)({height:18,width:18})})]})}function Fa(e){let{users:t,deletedUserEmailDomain:s,...n}=e;const i=(0,g.useIntl)(),o=(0,r.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",marginLeft:"-8px",maxWidth:"100%"},empty:{fontSize:14,maxWidth:150,opacity:.5},name:{fontSize:14,maxWidth:150},plusMore:{opacity:.5,display:"inline"}})),[]);return 0===t.length?(0,c.jsx)(be.ZP,{render:e=>(0,c.jsx)(Xt.Z,{style:o.container,disabled:!0,...n,...e,children:(0,c.jsx)(Me.Z,{style:o.empty,children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.empty",defaultMessage:"Deleted user"})})}),disableTooltip:!s,renderTooltip:()=>(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.emptyTooltip",defaultMessage:"Deleted user from {domain}",values:{domain:`@${s}`}})}):(0,c.jsx)(Xt.Z,{style:o.container,...n,children:(0,c.jsx)(Me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.name",defaultMessage:"{remainingCount, plural, =0 {{firstUser}} one {{firstUser} <gray>+{remainingCount}</gray>} other {{firstUser} <gray>+{remainingCount}</gray>}}",values:{firstUser:(0,Fo.Nz)(i,t[0]),remainingCount:t.length-1,gray:e=>(0,c.jsx)(Me.Z,{style:o.plusMore,children:e})}})})})}const Aa=[{id:"spaces",headerTitle:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.name",defaultMessage:"Workspaces"}),renderCell:e=>(0,c.jsx)(wa,{id:e.space.id,name:e.space.name,icon:e.space.icon,subscriptionTier:e.space.subscriptionTier,memberCount:e.space.memberCount}),widthData:{width:60},sortable:!1},{id:"admins",headerTitle:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.admins",defaultMessage:"Workspace owners"}),renderCell:e=>(0,c.jsx)(Ia,{users:e.space.admins}),widthData:{width:40},sortable:!1},{id:"createdBy",headerTitle:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.createdBy",defaultMessage:"Created by"}),renderCell:e=>e.space.creator?(0,c.jsx)(Ia,{users:[e.space.creator]}):(0,c.jsx)(Ia,{users:[],deletedUserEmailDomain:e.space.creatorEmailDomain}),widthData:{width:40},sortable:!1},{id:"createdAt",headerTitle:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.createdAt",defaultMessage:"Created date"}),renderCell:e=>(0,c.jsx)(Me.Z,{style:{opacity:.5},children:(0,Gi.gs)(e.space.createdAt)}),widthData:{width:30},sortable:!1},{id:"action",headerTitle:null,renderCell:e=>{if((0,As.DI)(e.space.spaceRequest))return(0,c.jsx)(fa,{admin:e.space.admins[0]});if((0,As.XR)(e.space.spaceRequest))return(0,c.jsx)(ha,{});if((0,As.TZ)(e.space.spaceRequest)){const t=e.actions.find((e=>"recover-space"===e.id));return t&&(0,c.jsx)(ba,{space:e.space,action:t,mode:va.Single})}return e.actions.length>0?(0,c.jsx)(ba,{space:e.space,actions:e.actions.filter((e=>"recover-space"!==e.id)),mode:va.Multi}):null},widthData:{width:15},sortable:!1}];function _a(e){let{claimableSpaces:t,spaceActions:s,loadMoreClaimableSpaces:n,loading:i}=e;const o=t.map((e=>({id:e.id,isClickable:!1,space:e,actions:s}))),a=(0,r.yK)((e=>(0,Se.b)({columnRenderInfo:Aa,theme:e,containerMarginTop:0})),[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Se.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:Aa,rows:o,renderNoRowsComponent:()=>(0,c.jsx)(Me.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:!i&&(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.empty",defaultMessage:"No claimable workspaces."})}),styles:a,getStyleForRow:function(e){if((0,As.DI)(e.space.spaceRequest)||(0,As.XR)(e.space.spaceRequest)||(0,As.TZ)(e.space.spaceRequest))return{opacity:.5}},onLoadMore:n}),i&&(0,c.jsx)(Pi.Z,{style:{margin:"24px auto 24px"}})]})}var Ra=s(33728),Oa=s(64275),Ba=s(36329),Da=s(98519),La=s(16354);const Va=(0,g.defineMessages)({emailPlaceholder:{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.placeholder",defaultMessage:"it@example.com"}});function Na(e){let{onDismiss:t,spaceQueuedForTransfer:s,currentSpaceId:i}=e;const[a,l]=(0,n.useState)(),[d,u]=(0,n.useState)(!1),{setSpaceRequest:p}=(0,n.useContext)(qn),m=(0,o.O7)(),h=(0,r.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:e.mediumIconColor,height:24,width:24},title:{fontWeight:x.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:x.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},dividerContainer:{marginTop:20},dividerInner:{borderBottomColor:e.regularDividerColor},contactEmailContainer:{position:"relative",width:"100%",minHeight:56,marginTop:13},contactEmailTitle:{fontWeight:x.Z.fontWeight.medium,fontSize:14,marginBottom:8,letterSpacing:-.15,display:"inline-flex",alignItems:"center"},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},primaryButton:{width:"100%",marginTop:32},buttonCaption:{color:e.mediumTextColor,marginTop:8,textAlign:"center",fontSize:12},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:x.Z.fontWeight.medium,color:e.lightTextColor},buttonCaptionError:{color:e.errorText,marginTop:8,fontSize:13}})),[]),f=Boolean(s);return(0,c.jsx)(_n.Z,{open:f,innerStyle:h.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:h.closeIconContainer,children:(0,c.jsx)(Xt.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0,children:(0,Oa.D)(h.closeIcon)})}),(0,c.jsx)("div",{children:(0,Ba._)(h.modalIcon)}),(0,c.jsxs)(Me.Z,{style:h.title,children:[(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.selfServe.title",defaultMessage:"Require account change"}),(0,c.jsx)(La.Z,{href:(0,Ue.UY)("guides.domainManagement"),children:(0,c.jsx)(Qn.Z,{icon:Hn.m})})]}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:h.description,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.byline",defaultMessage:"You’re about to require the Workspace Owner of 1 workspace to use an external Notion accounts. They will be unable to use the workspace until the change is made."})}),(0,c.jsxs)("div",{style:h.workspaceContainer,children:[s?(0,c.jsx)(wa,{id:s.id,name:s.name,icon:s.icon,subscriptionTier:s.subscriptionTier,memberCount:s.memberCount}):null,(0,c.jsx)("div",{style:h.checkContainer,children:(0,Da.k)(h.check)})]}),(0,c.jsx)(yn.Z,{size:"100%",innerStyle:h.dividerInner,style:h.dividerContainer}),(0,c.jsxs)("div",{style:h.contactEmailContainer,children:[(0,c.jsxs)(Me.Z,{style:h.contactEmailTitle,children:[(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.title",defaultMessage:"Send request from"}),(0,c.jsx)(be.ZP,{renderTooltip:()=>(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingExplanation",defaultMessage:"The Workspace Owner can contact this email for inquiries"}),render:e=>(0,c.jsx)("span",{...e,children:(0,Hn.m)(h.helpIcon)})})]}),(0,c.jsx)(dn.Z,{value:a,placeholder:L.default.formatMessage(Va.emailPlaceholder),onChange:e=>{u(!1),l(e.target.value)}}),d&&(0,c.jsx)(Me.Z,{isSmall:!0,style:h.buttonCaptionError,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.error",defaultMessage:"Invalid email address"})})]}),(0,c.jsx)(Sn.Z,{isLarge:!0,style:h.primaryButton,onClick:async()=>{const e=(0,Ra.H3)(a);var n;if((0,Ra.oH)(e)){if(s&&e){const o=await T.initiateWorkspaceTransfer(m,{requestingSpaceId:i,targetSpaceId:s.id,contactEmail:e});if("failed"===o.type)M.showErrorMessage((0,D.wf)(L.default.getIntl(),o));else{const i=o.data.workspaceTransfer;p(s.id,i),Bn.az(m,{contactEmail:e,currentOwners:s.admins.map((e=>e.id)),targetSpaceId:s.id,verifiedDomain:s.creatorEmailDomain,subscriptionTier:s.subscriptionTier}),t(),n=s.name,oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.toast",defaultMessage:"Account change successfully requested for “{spaceName}“",values:{spaceName:n}})})}}}else u(!0)},children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.confirm",defaultMessage:"Confirm change"})}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:h.buttonCaption,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.buttonCaption",defaultMessage:"This cannot be undone"})}),(0,c.jsx)(Xt.Z,{style:h.secondaryButton,onClick:t,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.cancel",defaultMessage:"Cancel"})})]})})}function Ea(e){let{onDismiss:t,spaceQueuedForClaiming:s,requestingSpaceId:i}=e;const a=(0,o.O7)(),{setSpaceRequest:l}=(0,n.useContext)(qn),d=(0,r.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},title:{fontWeight:x.Z.fontWeight.medium,fontSize:16,marginBottom:8,display:"inline-flex",alignItems:"center",justifyContent:"center"},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},description:{fontWeight:x.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:x.Z.fontWeight.medium,color:e.lightTextColor},buttonCaption:{color:e.mediumTextColor,marginTop:8,textAlign:"center",fontSize:12}})),[]),u=Boolean(s),p=async()=>{if(!s)return;const e=await T.requestClaimAndUpgrade(a,{requestingSpaceId:i,targetSpaceId:s.id});var n;"failed"===e.type?M.showError(e):(Bn.eO(a,{currentOwners:s.admins.map((e=>e.id)),targetSpaceId:s.id,verifiedDomain:s.creatorEmailDomain,memberCount:s.memberCount}),l(s.id,e.data.spaceRequest),n=s.name,oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.toast",defaultMessage:"Workspace claim successfully requested for “{spaceName}“",values:{spaceName:n}})})),t()};return(0,c.jsx)(_n.Z,{open:u,innerStyle:d.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:d.closeIconContainer,children:(0,c.jsx)(Xt.Z,{isSmall:!0,onClick:t,children:(0,Oa.D)(d.closeIcon)})}),(0,c.jsxs)(Me.Z,{style:d.title,children:[(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.title",defaultMessage:"Request workspace claim"}),(0,c.jsx)(La.Z,{href:(0,Ue.UY)("guides.domainManagement"),children:(0,c.jsx)(Qn.Z,{icon:Hn.m})})]}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:d.description,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.byline",defaultMessage:"You’re about to take ownership of {currentWorkspaceName} and upgrade it to an Enterprise plan. You’ll become the Workspace owner and the existing owners will be downgraded to members.",values:{currentWorkspaceName:s?s.name:"the workspace below"}})}),(0,c.jsxs)("div",{style:d.workspaceContainer,children:[s?(0,c.jsx)(wa,{id:s.id,name:s.name,icon:s.icon,subscriptionTier:s.subscriptionTier,memberCount:s.memberCount}):null,(0,c.jsx)("div",{style:d.checkContainer,children:(0,Da.k)(d.check)})]}),(0,c.jsx)(Sn.Z,{isLarge:!0,style:d.primaryButton,onClick:p,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.sendRequest",defaultMessage:"Send request"})}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:d.buttonCaption,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.buttonCaption",defaultMessage:"This request may take a few days to process. For more information, contact your <accountmanageremail>Account Management team</accountmanageremail>.",values:{accountmanageremail:e=>(0,c.jsx)(vn.Z,{href:"mailto:am@makenotion.com",children:e})}})}),(0,c.jsx)(Xt.Z,{style:d.secondaryButton,onClick:t,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.cancel",defaultMessage:"Cancel"})})]})})}function Ua(e){let{onDismiss:t,spaceQueuedForClaiming:s}=e;const n=(0,r.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:e.mediumIconColor,height:24,width:24},title:{fontWeight:x.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},description:{fontWeight:x.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:x.Z.fontWeight.medium,color:e.lightTextColor}})),[]),i=Boolean(s);return(0,c.jsx)(_n.Z,{open:i,innerStyle:n.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:n.closeIconContainer,children:(0,c.jsx)(Xt.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0,children:(0,Oa.D)(n.closeIcon)})}),(0,c.jsx)("div",{children:da(n.modalIcon)}),(0,c.jsxs)(Me.Z,{style:n.title,children:[(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.title",defaultMessage:"Claim workspace"}),(0,c.jsx)(La.Z,{href:(0,Ue.UY)("guides.domainManagement"),children:(0,c.jsx)(Qn.Z,{icon:Hn.m})})]}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:n.description,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.byline",defaultMessage:"You’re about to take ownership of {currentWorkspaceName} and upgrade it to an Enterprise plan. You’ll become the Workspace owner and the existing owners will be downgraded to members.",values:{currentWorkspaceName:s?s.name:"the workspace below"}})}),(0,c.jsxs)("div",{style:n.workspaceContainer,children:[s?(0,c.jsx)(wa,{id:s.id,name:s.name,icon:s.icon,subscriptionTier:s.subscriptionTier,memberCount:s.memberCount}):null,(0,c.jsx)("div",{style:n.checkContainer,children:(0,Da.k)(n.check)})]}),(0,c.jsx)(Sn.Z,{isLarge:!0,style:n.primaryButton,onClick:()=>{s&&rt.Xb(s)},children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.reviewAndPay",defaultMessage:"Review and pay"})}),(0,c.jsx)(Xt.Z,{style:n.secondaryButton,onClick:t,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.cancel",defaultMessage:"Cancel"})})]})})}var Wa=s(97466),Ka=s(60458);const za=(0,g.defineMessages)({emailPlaceholder:{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.placeholder",defaultMessage:"it@example.com"}});function qa(e){let{onDismiss:t,spaceQueuedForDeletion:s,currentSpaceId:i}=e;const[a,l]=(0,n.useState)({email:void 0,didError:!1}),[d,u]=(0,n.useState)(!1),[p,m]=(0,n.useState)(!1),{setSpaceRequest:h}=(0,n.useContext)(qn),f=(0,r.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:"dark"===e.mode?e.accentColors.red[700]:e.accentColors.red[500],height:24,width:24},title:{fontWeight:x.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:x.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},checkboxContainer:{display:"inline-flex",marginTop:8,alignItems:"center"},checkbox:{color:"dark"===e.mode?e.accentColors.gray[400]:e.accentColors.gray[200],marginRight:8},primaryButton:{width:"100%",marginTop:32,background:"dark"===e.mode?e.accentColors.red[700]:e.accentColors.red[500],justifyContent:"center",fontWeight:x.Z.fontWeight.medium,color:Ks.ZP.white},primaryButtonHovered:{background:"dark"===e.mode?(0,Wa._j)(e.accentColors.red[700],.3):(0,Wa._j)(e.accentColors.red[500],.3)},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:x.Z.fontWeight.medium,color:e.lightTextColor},checkboxCaption:{color:e.mediumTextColor,textAlign:"center",fontSize:12},dividerContainer:{marginTop:18},divider:{borderBottomColor:e.regularDividerColor}})),[]),y=(0,o.O7)(),S=(0,n.useCallback)((()=>{l({email:void 0,didError:!1}),u(!1),m(!1),t()}),[t]),v=(0,n.useCallback)((e=>{l({didError:!1,email:e.target.value})}),[]),b=(0,n.useCallback)((()=>u((e=>!e))),[]),j=(0,n.useCallback)((async()=>{const e=(0,Ra.H3)(a.email);if(!(0,Ra.oH)(e))return void l({...a,didError:!0});if(!s)return;m(!0);const t=await T.deleteSpaceForDomain(y,{requestingSpaceId:i,targetSpaceId:s.id,contactEmail:e});if("failed"===t.type)m(!1),M.showErrorMessage((0,D.wf)(L.default.getIntl(),t));else{const i=t.data.spaceDeletion;h(s.id,i),Bn.QF(y,{contactEmail:e,currentOwners:s.admins.map((e=>e.id)),targetSpaceId:s.id,verifiedDomain:s.creatorEmailDomain,targetSubscriptionTier:s.subscriptionTier}),S(),n=s.name,oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.toast",defaultMessage:"Successfully deleted “{spaceName}“",values:{spaceName:n}})})}var n}),[S,a,i,y,h,s]),C=Boolean(s);return(0,c.jsx)(_n.Z,{open:C,innerStyle:f.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:S,render:()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:f.closeIconContainer,children:(0,c.jsx)(Xt.Z,{isSmall:!0,onClick:S,ignoreLocalHoverState:!0,children:(0,Oa.D)(f.closeIcon)})}),(0,c.jsx)("div",{children:(0,si.y)(f.modalIcon)}),(0,c.jsxs)(Me.Z,{style:f.title,children:[(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.title",defaultMessage:"Delete workspace"}),(0,c.jsx)(La.Z,{href:(0,Ue.UY)("guides.domainManagement"),children:(0,c.jsx)(Qn.Z,{icon:Hn.m})})]}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:f.description,children:s?(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.byline",defaultMessage:"You’re about to permanently delete {currentWorkspaceName} and all of its contents. The workspace owner will be notified.",values:{currentWorkspaceName:s.name}}):void 0}),(0,c.jsxs)("div",{style:f.workspaceContainer,children:[s?(0,c.jsx)(wa,{id:s.id,name:s.name,icon:s.icon,subscriptionTier:s.subscriptionTier,memberCount:s.memberCount}):void 0,(0,c.jsx)("div",{style:f.checkContainer,children:(0,Da.k)(f.check)})]}),(0,c.jsx)(yn.Z,{size:0,style:f.dividerContainer,innerStyle:f.divider}),(0,c.jsx)(Ga,{value:a.email,placeholder:L.default.formatMessage(za.emailPlaceholder),onChange:v,labelMessage:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.title",defaultMessage:"Contact email"}),helpMessage:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.deleteWorkspaces.deletionModal.tooltipExplanation",defaultMessage:"The Workspace Owner of the deleted workspace can contact this email for inquiries"}),errorMessage:a.didError?(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.error",defaultMessage:"Invalid email address"}):void 0}),(0,c.jsx)(Xt.Z,{disabled:!d||!a.email||p,disabledFeedback:!0,isLarge:!0,style:f.primaryButton,hoveredStyle:f.primaryButtonHovered,onClick:j,children:p?(0,c.jsx)(Pi.Z,{}):(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.deleteButton",defaultMessage:"Delete workspace"})}),(0,c.jsxs)("div",{style:f.checkboxContainer,children:[(0,c.jsx)(Ka.Z,{style:f.checkbox,size:14,checked:d,onClick:b}),(0,c.jsx)(Me.Z,{isSmall:!0,style:f.checkboxCaption,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.checkboxLabel",defaultMessage:"I'm sure I want to delete this workspace"})})]}),(0,c.jsx)(Xt.Z,{style:f.secondaryButton,onClick:S,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.cancel",defaultMessage:"Cancel"})})]})})}function Ga(e){const t=(0,r.yK)((e=>({emailInputTitle:{fontWeight:x.Z.fontWeight.medium,fontSize:14,marginBottom:8,letterSpacing:-.15,display:"inline-flex",alignItems:"center"},emailContainer:{position:"relative",width:"100%",minHeight:56,marginTop:13},inputCaptionError:{color:e.errorText,marginTop:8,fontSize:13},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16}})),[]);return(0,c.jsxs)("div",{style:t.emailContainer,children:[(0,c.jsxs)(Me.Z,{style:t.emailInputTitle,children:[e.labelMessage,e.helpMessage&&(0,c.jsx)(be.ZP,{renderTooltip:()=>e.helpMessage,render:e=>(0,c.jsx)("span",{...e,children:(0,Hn.m)(t.helpIcon)})})]}),(0,c.jsx)(dn.Z,{value:e.value,placeholder:e.placeholder,onChange:e.onChange}),e.errorMessage&&(0,c.jsx)(Me.Z,{isSmall:!0,style:t.inputCaptionError,children:e.errorMessage})]})}function Ha(e){let{onDismiss:t,onAccept:s,spaceQueued:n,descriptionMessage:i,divider:o,modalIcon:a,title:l,acceptMessage:d,isLoading:u}=e;const p=(0,r.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{height:24,width:24,fill:e.mediumIconColor},title:{fontWeight:x.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:x.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32,justifyContent:"center",fontWeight:x.Z.fontWeight.medium},secondaryButton:{margin:"8px auto 0",width:"100%",justifyContent:"center",fontWeight:x.Z.fontWeight.medium,color:e.lightTextColor},dividerContainer:{marginTop:18},divider:{borderBottomColor:e.regularDividerColor}})),[]),m=Boolean(n);return(0,c.jsx)(_n.Z,{open:m,innerStyle:p.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:p.closeIconContainer,children:(0,c.jsx)(Xt.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0,children:(0,Oa.D)(p.closeIcon)})}),a&&(0,c.jsx)("div",{children:a(p.modalIcon)}),(0,c.jsxs)(Me.Z,{style:p.title,children:[l,(0,c.jsx)(La.Z,{href:(0,Ue.UY)("guides.domainManagement"),children:(0,c.jsx)(Qn.Z,{icon:Hn.m})})]}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:p.description,children:i}),(0,c.jsxs)("div",{style:p.workspaceContainer,children:[n?(0,c.jsx)(wa,{id:n.id,name:n.name,icon:n.icon,subscriptionTier:n.subscriptionTier,memberCount:n.memberCount}):void 0,(0,c.jsx)("div",{style:p.checkContainer,children:(0,Da.k)(p.check)})]}),o&&(0,c.jsx)(yn.Z,{size:0,style:p.dividerContainer,innerStyle:p.divider}),(0,c.jsx)(Sn.Z,{isLarge:!0,style:p.primaryButton,onClick:s,disabled:u,children:u?(0,c.jsx)(Pi.Z,{}):d}),(0,c.jsx)(Xt.Z,{style:p.secondaryButton,onClick:t,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimableSpaceConfirmationModal.cancel",defaultMessage:"Cancel"})})]})})}function Ya(e){let{onDismiss:t,spaceQueuedForRecovery:s,currentSpaceId:i}=e;const{setSpaceRequest:a}=(0,n.useContext)(qn),r=(0,o.O7)(),[l,d]=(0,n.useState)(!1),u=(0,n.useCallback)((()=>{d(!1),t()}),[t]),p=(0,n.useCallback)((async()=>{if(!i||!s)return;d(!0);const e=await T.cancelSpaceDeletionForDomain(r,{requestingSpaceId:i,targetSpaceId:s.id});if("failed"===e.type)return d(!1),void M.showErrorMessage((0,D.wf)(L.default.getIntl(),e));var t;a(s.id,void 0),Bn.Jv(r,{targetSpaceId:s.id,verifiedDomain:s.creatorEmailDomain}),u(),t=s.name,oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.table.recoverSpace.toast",defaultMessage:"Successfully recovered “{spaceName}“",values:{spaceName:t}})})}),[a,i,r,s,u]);return(0,c.jsx)(Ha,{onDismiss:u,onAccept:p,spaceQueued:s,modalIcon:ti.u,title:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.title",defaultMessage:"Recover workspace"}),descriptionMessage:s?(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.byline",defaultMessage:"Restore workspace content and the workspace owner's access.",values:{currentWorkspaceName:s.name}}):void 0,acceptMessage:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.deleteButton",defaultMessage:"Recover"}),isLoading:l,divider:!1})}let Qa=!1;function $a(e){let{spaceStore:t,subscriptionDataStore:s}=e;const{claimableSpaces:i,domainVerifications:l,loadingSpaces:d,errorClaimableSpaces:u,errorVerifications:p,navigateTo:h,removeClaimableSpace:f,loadMoreClaimableSpaces:y,tab:S,setSelectedTab:v,verifiedDomains:b}=(0,n.useContext)(qn),j=(0,o.O7)(),C=(0,a.VK)((()=>!pa.Z.state.open&&Boolean(pa.Z.state.succeeded)),[]),[w,k]=(0,n.useState)(),[T,I]=(0,n.useState)(),[Z,P]=(0,n.useState)(),[F,A]=(0,n.useState)(),_=(0,ua.Y)(Bt.subscriptionDataStoreInstance);function R(){k(void 0),I(void 0),P(void 0),A(void 0)}(0,n.useEffect)((()=>{C&&w&&(f(w.id),k(void 0),pa.Z.reset())}),[C,w,f,k]);const O="verifying"===(0,ma.r)(s),B=(0,r.yK)((e=>({link:{fontSize:14,fontWeight:400,color:e.mediumTextColor,textDecoration:"none"},title:{marginTop:21,fontWeight:x.Z.fontWeight.semibold,fontSize:17},byline:{fontSize:14,fontWeight:x.Z.fontWeight.regular,color:e.mediumTextColor,marginRight:"auto",paddingRight:20},count:{marginLeft:4,opacity:.5,fontWeight:400},tabBarMenu:{margin:"12px 0 0",boxShadow:"none"}})),[]);if((0,n.useEffect)((()=>{u?M.deprecatedShowErrorMessage(u.message):p&&M.deprecatedShowErrorMessage(p.message)}),[u,p]),u)return null;if(p)return null;const D=i.filter((e=>aa(e.spaceRequest,e.memberCount))),L=i.filter((e=>!aa(e.spaceRequest,e.memberCount))),V=[{id:"external-transfer",getIcon:e=>(0,la.Z)({...e,height:14,width:14}),name:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.externalTransfer",defaultMessage:"Require account change"}),caption:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.externalTransferCaption",defaultMessage:"Owner will be prompted to change workspace ownership to a personal account."}),onAction:e=>I(e)},{id:"space-deletion",getIcon:e=>(0,si.y)({...e,height:14,width:14}),name:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace",defaultMessage:"Delete workspace"}),caption:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpaceCaption",defaultMessage:"Owner will lose access to the workspace immediately."}),onAction:e=>P(e),getDisabledState:e=>{const{isEligible:t}=Ja(l,e.creatorEmailDomain);return!t||e.isDelinquent||e.isPendingBilling||!(0,m.QM)(e.subscriptionTier)},getTooltip:e=>{const t=Ja(l,e.creatorEmailDomain);return t.isEligible?!(0,m.QM)(e.subscriptionTier)||e.isDelinquent||e.isPendingBilling?(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace.ineligibleTooltip",defaultMessage:"The workspace is ineligible for deletion."}):void 0:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace.disabledTooltip",defaultMessage:"You're in the 14-day notification period after verifying a domain.{br} This feature will be enabled in {numDays, plural, one {{numDays} day} other {{numDays} days}}.",values:{numDays:t.daysUntilEligible,br:(0,c.jsx)("br",{})}})}},{id:"recover-space",getIcon:()=>{},name:(0,c.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.actions.recoverSpace",defaultMessage:"Recover"}),caption:void 0,onAction:e=>A(e)}],N=[{id:"claim-and-upgrade",getIcon:e=>da({...e,height:14,width:14}),name:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimAndUpgrade",defaultMessage:"Claim and upgrade"}),caption:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimAndUpgradeCaption",defaultMessage:"Take ownership of the workspace and upgrade it to an Enterprise plan"}),onAction:e=>k(e),getDisabledState:e=>{const{isEligible:t}=Ja(l,e.creatorEmailDomain);return O||!t||e.isDelinquent||e.isPendingBilling},getTooltip:e=>{const t=Ja(l,e.creatorEmailDomain);return e.isDelinquent||e.isPendingBilling?(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimSpace.ineligibleTooltip",defaultMessage:"The workspace is ineligible for claiming."}):t.isEligible?void 0:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.disabledTooltip",defaultMessage:"You're in the 14-day notification period after verifying a domain.{br} This feature will be enabled in {numDays, plural, one {{numDays} day} other {{numDays} days}}.",values:{numDays:t.daysUntilEligible,br:(0,c.jsx)("br",{})}})}}];return(0,c.jsxs)(pt.ZP,{children:[(0,c.jsx)(vn.Z,{style:B.link,onClick:()=>h(Kn.SettingsPage),children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.breadcrumb",defaultMessage:"← Identity & Provisioning"})}),(0,c.jsx)(me.Z,{large:!0,style:B.title,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.title",defaultMessage:"Manage workspaces"})}),(0,c.jsxs)(ga.X2,{children:[(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:B.byline,children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.byline",defaultMessage:"Claim verified-domain workspaces to your Enterprise plan or require Owners to use an external domain."})}),(0,c.jsx)(Ri.Z,{isLarge:!0,onClick:()=>{ca.g({environment:j,data:{spaceId:t.id,emailDomains:b}})},children:(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.exportClaimableWorkspaces.button",defaultMessage:"Export to CSV"})})]}),(0,c.jsx)(Mn.Z,{tabs:[(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.singleSpaces",defaultMessage:"Single-member"},"single"),(0,c.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.multiSpaces",defaultMessage:"Multi-member"},"multi")],selectedIndex:S,onChange:e=>v(e),style:B.tabBarMenu}),(0,c.jsx)(Na,{onDismiss:R,spaceQueuedForTransfer:T,currentSpaceId:t.id}),S===zn.Single?(0,c.jsx)(_a,{claimableSpaces:D,spaceActions:V,loadMoreClaimableSpaces:y,loading:d},"single"):(0,c.jsx)(_a,{claimableSpaces:L,spaceActions:N,loadMoreClaimableSpaces:y,loading:d},"multi"),_?(0,c.jsx)(Ea,{onDismiss:R,spaceQueuedForClaiming:w,requestingSpaceId:t.id}):(0,c.jsx)(Ua,{onDismiss:R,spaceQueuedForClaiming:w}),(0,c.jsx)(qa,{onDismiss:R,spaceQueuedForDeletion:Z,currentSpaceId:t.id}),(0,c.jsx)(Ya,{onDismiss:R,spaceQueuedForRecovery:F,currentSpaceId:t.id})]})}function Ja(e,t){if(Qa)return{isEligible:!0};const s=e.find((e=>{let{domain:s}=e;return t===s}));if(!s||!s.verified_at)return{isEligible:!0};const n=(Date.now()-s.verified_at)/Nt.A0;return n>=14?{isEligible:!0}:{isEligible:!1,daysUntilEligible:Math.ceil(14-n)}}function Xa(e){let{userStore:t,spaceStore:s,samlConfigStore:i,domainSettingsStore:o}=e;const{page:a}=(0,n.useContext)(qn);switch(a){case Kn.SettingsPage:return(0,c.jsx)(oa,{userStore:t,spaceStore:s,samlConfigStore:i,domainSettingsStore:o});case Kn.WorkspacesPage:return(0,c.jsx)($a,{spaceStore:s,subscriptionDataStore:Bt.subscriptionDataStoreInstance});case Kn.ManagedUsersPage:return(0,c.jsx)(Ti,{spaceStore:s,samlConfigStore:i})}}["local","development","staging"].includes("production")&&(0,ra.exposeDebugValue)("bypassDomainVerificationWaitingPeriod",(function(){Qa=!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}));const er=function(e){let{userStore:t,spaceStore:s,samlConfigStore:n,domainSettingsStore:i}=e;return(0,c.jsx)(Gn,{spaceStore:s,samlConfigStore:n,domainSettingsStore:i,children:(0,c.jsx)(Xa,{userStore:t,spaceStore:s,samlConfigStore:n,domainSettingsStore:i})})};var tr=s(15145),sr=s(84619),nr=s(40745),ir=s(75754),or=s(92283),ar=s(22756),rr=s(41892),lr=s(1800),dr=s(70675),cr=s(26139),ur=s(50063),pr=s(21202),mr=s(41311),gr=s(8055),hr=s(30397),fr=s(33907),xr=s(36591),yr=s(42853),Sr=s(75071),vr=s(91),br=s(9867),Mr=s(74016),jr=s(29551),Cr=s(93963),wr=s(40235);const kr=function(){const e=(0,o.O7)(),t=(0,g.useIntl)(),s=(0,a.VK)((()=>ar.Z.getState()),[]),{isLoadingProjects:i,selectedWorkspace:r,teamsAndProjects:l,workspaces:d}=s;return(0,n.useEffect)((()=>{r&&mr.y2({selectedWorkspace:r,environment:e}).catch((()=>{}))}),[r,e]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,c.jsx)("img",{src:rr.Z.images.import.asanaPng,width:16,height:16}),(0,c.jsx)(Ir,{onSelectOption:e=>{ar.Z.setState({...s,selectedProjectsAndTeamspaces:{},selectedWorkspace:e})},options:d.map((e=>({key:e.gid,label:e.name}))),currentOption:r,placeHolder:t.formatMessage({id:"asanaImporter.chooseWorkspace.chooseWorkspacePlaceholder",defaultMessage:"Choose a workspace"})})]}),r?(0,c.jsx)(Me.Z,{style:{fontWeight:x.Z.fontWeight.semibold,marginTop:18},children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.selectProjects",defaultMessage:"Select projects"})}):(0,c.jsx)(c.Fragment,{}),i?(0,c.jsxs)(jr.gq,{style:{gap:8,marginTop:32,alignItems:"center"},children:[(0,c.jsx)(Pi.Z,{style:{fontSize:12}}),(0,c.jsx)(Me.Z,{isSmall:!0,style:{color:Ks.FN.light.gray[400]},children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.loadingProjectsHelperText",defaultMessage:"Loading projects in the workspace..."})})]}):l.filter((e=>0!==e.projects.length)).map((e=>(0,c.jsx)(Tr,{team:e,selectedWorkspace:r},`${e.gid}-table`)))]})};function Tr(e){var t;let{team:s,selectedWorkspace:i}=e;const d=(0,o.O7)(),u=(0,g.useIntl)(),p=(0,r.Fg)(),[m,h]=(0,n.useState)(!1),[f,y]=(0,n.useState)(!1),[S,v]=(0,n.useState)(),b=(0,a.VK)((()=>ar.Z.getState()),[]),M=(0,a.VK)((()=>Ke.default.state.currentSpaceViewStore),[]),j=(0,a.VK)((()=>{const e=null==M?void 0:M.getTeamsStores();return null==e?void 0:e.map((e=>({id:e.id,name:e.getName(),icon:(0,c.jsx)(Mr.p,{disabled:!0,store:e})})))}),[M]);(0,n.useEffect)((()=>{if(!j||!M)return;if(!b.selectedProjectsAndTeamspaces[s.gid]){v("private"),mr.B3({teamId:s.gid,spaceId:null==M?void 0:M.id});for(const n of j){var e,t;if((null===(e=n.name)||void 0===e?void 0:e.toLowerCase())===(null===(t=s.name)||void 0===t?void 0:t.toLowerCase())){v(n.id),mr.B3({teamId:s.gid,spaceId:n.id});break}}}}),[j,s,M,b]);const C=(0,n.useCallback)((e=>{mr.B3({teamId:s.gid,spaceId:e}),v(e)}),[s.gid]),w=(0,n.useCallback)((e=>{if("create"===e)return void br.lo("asana_importer",{onClose:C});let t;if("private"===e){if(null==M||!M.id)return;t=M.id}else t=e;mr.B3({teamId:s.gid,spaceId:t}),v(e)}),[null==M?void 0:M.id,s.gid,C]),{importCompletedTasks:k,loadMoreClicks:I,selectedProjectsAndTeamspaces:Z}=b,P=[{key:"private",searchTerm:"private",label:(0,c.jsxs)(jr.gq,{alignItems:"center",style:{gap:8},children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:16,height:16,borderRadius:"0.25em",backgroundColor:Ks.FN.light.gray[75]},children:(0,l.Q)({color:p.mediumIconColor,width:12.5,height:12.5})}),(0,c.jsx)(Me.Z,{style:{fontWeight:x.Z.fontWeight.regular},children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.privateSpaceTitle",defaultMessage:"Private"})})]})}];return j&&P.push(...j.map((e=>({key:e.id,searchTerm:e.name,label:(0,c.jsxs)(jr.gq,{alignItems:"center",style:{gap:8},children:[e.icon,e.name]})})))),P.push({key:"create",searchTerm:"New teamspace",label:(0,c.jsxs)(jr.gq,{alignItems:"center",style:{gap:4},children:[(0,Sr.f)({color:p.mediumIconColor,width:16,height:16}),(0,c.jsx)(Me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.newTeamspace",defaultMessage:"New teamspace"})})]})}),(0,c.jsxs)(jr.gq,{children:[(0,c.jsx)(Qn.Z,{ariaLabel:"collapse toggle",icon:vr.L,onClick:()=>h((e=>!e)),style:{transform:m?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:24,width:10,height:10},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},iconStyle:{width:10,height:10}}),(0,c.jsx)(wr.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,c.jsxs)(jr.gq,{alignItems:"center",gap:2,children:[(0,c.jsx)(Zr,{onSelectOption:e=>{var t;ar.Z.setState({...b,selectedProjectsAndTeamspaces:{...Z,[s.gid]:{notionTeamspaceId:null===(t=Z[s.gid])||void 0===t?void 0:t.notionTeamspaceId,projects:e}}})},options:[{key:"in_complete",label:"Exclude completed projects"},{key:"all",label:"Select all projects"}],currentOption:(e=>{const t=null===(e=Z[s.gid])||void 0===e?void 0:e.projects;return"string"==typeof t?t:null!=t&&t.length?"specific":void 0})()}),(0,c.jsx)(Me.Z,{style:{width:280,textOverflow:"ellipsis"},children:s.name})]}),style:{width:300}},{key:"importInto",header:(0,c.jsxs)(jr.gq,{style:{alignItems:"center"},children:[(0,c.jsx)("div",{children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.importInto",defaultMessage:"Import into"})}),(0,c.jsx)("div",{style:{marginRight:16,marginLeft:8},children:(0,fr.n)({width:12})}),(0,c.jsxs)(jr.gq,{style:{alignItems:"center",gap:8},children:[(0,c.jsx)("img",{src:rr.Z.emails.notionLogoBlackSmallPng,height:18}),(0,c.jsx)(Ir,{options:P,onSelectOption:w,currentOption:null===(t=P.find((e=>e.key===S)))||void 0===t?void 0:t.key,narrow:!0,allowSearch:!0,placeHolder:u.formatMessage({id:"asanaImport.importsTab.chooseWorkspace.selectATeamspace",defaultMessage:"Select a teamspace"}),width:250})]})]}),style:{width:"50%"}}],rows:function(e){let{collapsed:t}=e;if(t)return[];const n=s.projects.map((e=>({key:e.gid,columns:[(0,c.jsxs)(jr.gq,{alignItems:"center",gap:6,style:{marginLeft:20},children:[(0,c.jsx)(Ka.Z,{style:{marginRight:2},onClick:()=>{const t={...Z[s.gid]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:n,projects:i}=t;let o;o="all"===i||"in_complete"===i?[]:i.includes(e.gid)?i.filter((t=>t!==e.gid)):i.concat(e.gid),ar.Z.setState({...b,selectedProjectsAndTeamspaces:{...Z,[s.gid]:{notionTeamspaceId:n,projects:o}}})},checked:(()=>{const t={...Z[s.gid]||{projects:[],notionTeamspaceId:void 0}};return"all"===t.projects||"in_complete"===t.projects&&!1===e.completed||t.projects.includes(e.gid)})(),size:14,checkSize:8}),(0,c.jsx)(Cr.z,{color:e.color,size:6}),(0,c.jsx)("div",{style:{width:240,wordWrap:"break-word"},children:e.completed?(0,c.jsxs)(Me.Z,{isMultiline:!0,style:{color:p.lightTextColor},children:[e.name,(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.completedHelperText",defaultMessage:" (Completed)"})]}):(0,c.jsx)(Me.Z,{isMultiline:!0,children:e.name})})]},`${e.gid}-container`),(0,c.jsxs)(Me.Z,{isSmall:!0,children:[k?e.task_counts.num_tasks:e.task_counts.num_incomplete_tasks,(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.tasksHelperText",defaultMessage:" tasks"})]},`${s.gid}-tasks-count`)]})));return s.nextPage&&n.push({key:"loadMore",columns:[(0,c.jsx)(xn.Z,{disabled:f,style:{marginLeft:20,color:Ks.FN.light.gray[400]},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},onClick:async()=>{if(!i)return;y(!0);const e=await T.getTeamsAndProjectsInAsanaWorkspace(d,{workspaceId:i,teamId:s.gid,size:5,nextPage:s.nextPage}),{teamsAndProjects:t}={...b},n=t.find((e=>e.gid===s.gid));if(n){if("success"===e.type){const i=e.data.find((e=>e.gid===s.gid));if(!i)return;n.projects.push(...i.projects),n.nextPage=i.nextPage,ar.Z.setState({...b,teamsAndProjects:t,loadMoreClicks:I+1})}y(!1)}},children:f?(0,c.jsxs)(jr.gq,{alignItems:"center",gap:8,children:[(0,c.jsx)(Pi.Z,{style:{fontSize:12}}),(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.loadingMoreProjects",defaultMessage:"Loading more projects..."})]}):(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.loadMoreProjects",defaultMessage:"Load more projects..."})},`${s.gid}-loadmore`)]}),n}({collapsed:m})})]})}function Ir(e){var t;const{onSelectOption:s,options:i,currentOption:o,placeHolder:a,narrow:l,allowSearch:d,width:u}=e,p=(0,g.useIntl)(),[m,h]=(0,n.useState)(""),f=null===(t=i.find((e=>{let{key:t}=e;return t===o})))||void 0===t?void 0:t.label,y=(0,r.yK)((e=>({icon:{width:12,height:12,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,c.jsx)(_o.ZP,{popupType:_o.Z4.Popup,placementToOrigin:_o.pO.Bottom,renderOrigin:e=>(0,c.jsxs)(Xt.Z,{...e,style:{paddingTop:l?2:8,paddingBottom:l?2:8,paddingLeft:8,paddingRight:8,opacity:1,width:u??376,border:`1px solid ${Ks.FN.light.gray[100]}`,justifyContent:"space-between",marginTop:8,marginBottom:8,color:o?void 0:Ks.FN.light.gray[300]},disabled:!1,children:[(0,c.jsx)(Me.Z,{style:{textOverflow:"ellipsis",fontSize:"14px",font:"SF Pro Text",color:o?void 0:"#ACABA9",lineHeight:"19.6px"},children:f||a}),(0,yr.i)(y.icon)]}),render:e=>{const t={menuType:Hs.og.Popup,width:376,left:50},n=[{key:"asanaImport.dropdown.menuList",render:e=>(0,c.jsx)(tn.Z,{...e}),items:(m.trim()?i.filter((e=>{var t;return null===(t=e.searchTerm)||void 0===t?void 0:t.toLowerCase().includes(m.toLowerCase())})):i).map((t=>{let{key:n,label:i}=t;return{key:n,action:()=>{s(n),e.close()},render:e=>(0,c.jsx)(Qs.Z,{...e,title:i,shouldWrapCaption:!0,right:f===i?(0,c.jsx)("div",{style:{width:14},children:(0,xr.e)()}):void 0})}}))}];return(0,c.jsxs)(c.Fragment,{children:[d?(0,c.jsx)("input",{style:{width:"100%",borderRadius:0,backgroundColor:Ks.FN.light.gray[200],paddingTop:2,paddingBottom:2,paddingLeft:8,paddingRight:8,opacity:1,border:`1px solid ${Ks.FN.light.gray[100]}`,justifyContent:"space-between",background:Ks.FN.light.gray[50],fontSize:x.Z.fontSize.UIRegular.desktop,textOverflow:"ellipses"},placeholder:p.formatMessage({id:"asanaImport.importsTab.chooseWorkspace.searchTeamspacePlaceholder",defaultMessage:"Search for a teamspace"}),onChange:e=>h(e.target.value),value:m}):(0,c.jsx)(c.Fragment,{}),(0,c.jsx)($s.Z,{...t,children:(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,sections:n,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})]})}})}function Zr(e){var t;const{onSelectOption:s,options:i,currentOption:o}=e,a=null===(t=i.find((e=>{let{key:t}=e;return t===o})))||void 0===t?void 0:t.label,r=(0,n.useMemo)((()=>void 0!==o&&"specific"!==o&&("all"===o||"partial")),[o]);return(0,c.jsx)(_o.ZP,{popupType:_o.Z4.Popup,placementToOrigin:_o.pO.Bottom,alignmentToOrigin:_o.vR.Start,renderOrigin:e=>(0,c.jsx)(Xt.Z,{...e,style:{padding:0,margin:0,marginRight:4,height:14},hoveredStyle:{},children:(0,c.jsx)(Ka.Z,{checked:r,disabled:!0,size:14,checkSize:8})}),render:e=>{const t={menuType:Hs.og.Popup,width:250,left:50},n=[{key:"asanaImport.checkboxDropdown.menuList",render:e=>(0,c.jsx)(tn.Z,{...e}),items:i.map((t=>{let{key:n,label:i}=t;return{key:n,action:()=>{s(n),e.close()},render:e=>(0,c.jsx)(Qs.Z,{...e,title:i,shouldWrapCaption:!0,right:a===i?(0,c.jsx)("div",{style:{width:14},children:(0,xr.e)()}):void 0})}}))}];return(0,c.jsx)($s.Z,{...t,children:(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,sections:n,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})}})}var Pr=s(91315);const Fr=function(){const e=(0,a.VK)((()=>ar.Z.state),[]);return e.result?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Me.Z,{isMultiline:!0,children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.confirm.subtitle",defaultMessage:"The following data has been successfully imported."})}),(0,c.jsx)("div",{style:{marginTop:32},children:e.result.map((e=>(0,c.jsx)(Ar,{importStatus:e},e.asanaTeamId)))})]}):(0,c.jsx)(c.Fragment,{})};function Ar(e){let{importStatus:t}=e;const s=(0,r.Fg)(),[i,o]=(0,n.useState)(!1),d=(0,a.VK)((()=>Ke.default.state.currentSpaceStore),[]),u=(0,a.VK)((()=>ar.Z.state.teamsAndProjects),[]),p=(0,a.VK)((()=>Ke.default.state.currentSpaceViewStore),[]),m=(0,a.VK)((()=>{if(!p)return;const e=p.getTeamsStores().map((e=>({id:e.id,name:e.getName(),icon:(0,c.jsx)(Mr.p,{disabled:!0,store:e})})));return d?(e||[]).concat({id:p.id,name:"Private",icon:(0,c.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:18,height:18,borderRadius:"0.25em",backgroundColor:Ks.FN.light.gray[75]},children:(0,l.Q)({color:s.mediumIconColor,width:12.5,height:12.5})})}):e}),[p,d,s]),{notionTeamspaceName:h,notionTeamspaceIcon:f}=(0,n.useMemo)((()=>{const e=null==m?void 0:m.find((e=>e.id===t.notionTeamSpaceId));return e?{notionTeamspaceName:e.name,notionTeamspaceIcon:e.icon}:{notionTeamspaceName:void 0,notionTeamspaceIcon:void 0}}),[m,t]),x=(0,n.useMemo)((()=>{const e=u.find((e=>e.gid===t.asanaTeamId));return null==e?void 0:e.name}),[u,t]);return(0,c.jsxs)(jr.gq,{style:{marginTop:16},children:[(0,c.jsx)(Qn.Z,{ariaLabel:"collapse toggle",icon:vr.L,onClick:()=>o((e=>!e)),style:{transform:i?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:4},iconStyle:{width:8,height:8}}),(0,c.jsx)(wr.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,c.jsx)(jr.gq,{alignItems:"center",gap:2,children:(0,c.jsx)(Me.Z,{isSmall:!0,style:{width:280,textOverflow:"ellipsis"},children:x})}),style:{width:300}},{key:"importedInto",header:(0,c.jsxs)(jr.gq,{gap:4,children:[(0,c.jsxs)(jr.gq,{style:{alignItems:"center",gap:4},children:[(0,c.jsx)(Me.Z,{isSmall:!0,children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.importedInto",defaultMessage:"Imported into"})}),(0,fr.n)({width:12})]}),(0,c.jsxs)(jr.gq,{style:{alignItems:"center",gap:4},children:[f,h]})]}),style:{width:300}}],rows:function(e){let{collapsed:s}=e;return s?[]:t.numberOfTasksPerProject.map((e=>({key:e.projectId,columns:[(0,c.jsxs)(jr.gq,{gap:8,alignItems:"center",children:[(0,Pr.r)({width:12,color:Ks.FN.dark.green[600]}),(0,c.jsx)(Me.Z,{isMultiline:!0,style:{wordWrap:"break-word",width:300},children:e.name})]},e.projectId),(0,c.jsxs)(Me.Z,{isSmall:!0,children:[e.numberOfTasks,(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.tasksHelperText",defaultMessage:" tasks"})]},`${e.projectId}-tasks-count`)]})))}({collapsed:i})})]})}var _r=s(86793),Rr=s(92607);const Or=function(){const e=(0,a.VK)((()=>ar.Z.state),[]);if(!e.result)return(0,c.jsx)(c.Fragment,{});const t=e.result;let s=0;return t.forEach((e=>{s+=e.numberOfProjects})),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:2},children:[(0,c.jsx)(Me.Z,{isMultiline:!0,style:{font:"SF Pro",fontWeight:x.Z.fontWeight.semibold,fontSize:x.Z.fontSize.UIRegular.mobile,paddingTop:8},children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.importComplete.subtitle",defaultMessage:"Imported {projectCount} projects into Notion",values:{projectCount:s}})}),(0,c.jsx)("div",{style:{marginTop:20},children:e.result.map((e=>(0,c.jsx)(Br,{importStatus:e},e.asanaTeamId)))})]})};function Br(e){let{importStatus:t}=e;const s=(0,r.Fg)(),i=(0,a.VK)((()=>Ke.default.state.currentSpaceStore),[]),o=(0,a.VK)((()=>ar.Z.state.teamsAndProjects),[]),d=(0,a.VK)((()=>Ke.default.state.currentSpaceViewStore),[]),u=(0,a.VK)((()=>{if(!d)return;const e=d.getTeamsStores().map((e=>({id:e.id,name:e.getName(),icon:(0,c.jsx)(Mr.p,{disabled:!0,store:e})})));return i?(e||[]).concat({id:d.id,name:"Private",icon:(0,c.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:18,height:18,borderRadius:"0.25em",backgroundColor:Ks.FN.light.gray[75]},children:(0,l.Q)({color:s.mediumIconColor,width:12.5,height:12.5})})}):e}),[d,i,s]),{notionTeamspaceName:p,notionTeamspaceIcon:m}=(0,n.useMemo)((()=>{const e=null==u?void 0:u.find((e=>e.id===t.notionTeamSpaceId));return e?{notionTeamspaceName:e.name,notionTeamspaceIcon:e.icon}:{notionTeamspaceName:void 0,notionTeamspaceIcon:void 0}}),[u,t]),h=(0,n.useMemo)((()=>{const e=o.find((e=>e.gid===t.asanaTeamId));return null==e?void 0:e.name}),[o,t]);return(0,c.jsx)(jr.gq,{style:{marginTop:16},children:(0,c.jsx)(wr.Z,{tableStyle:{borderTop:0,gap:10},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,c.jsx)(jr.gq,{children:(0,c.jsx)(jr.gq,{alignItems:"center",gap:2,children:(0,c.jsx)(Me.Z,{isSmall:!0,style:{width:280,textOverflow:"ellipsis",font:"SF Pro",fontWeight:x.Z.fontWeight.regular,fontSize:x.Z.fontSize.UIRegular.desktop},children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.importComplete.importFrom",defaultMessage:"From {asanaTeamName} in Asana",values:{asanaTeamName:h}})})})}),style:{width:300}},{key:"seperator",header:(0,c.jsx)(jr.gq,{style:{alignItems:"center",gap:4},children:(0,c.jsx)(Me.Z,{isMultiline:!0,style:{fontWeight:x.Z.fontWeight.regular,font:"SF Pro",fontSize:x.Z.fontSize.UIRegular.desktop,color:"rgba(172, 171, 169, 1)"},children:"→"})}),style:{width:13,height:18,paddingRight:20}},{key:"importedInto",header:(0,c.jsxs)(jr.gq,{style:{alignItems:"center",gap:4},children:[m,(0,c.jsx)(Me.Z,{style:{font:"SF Pro",fontWeight:x.Z.fontWeight.medium,fontSize:x.Z.fontSize.UIRegular.desktop},children:p}),(0,c.jsx)(Me.Z,{style:{fontWeight:x.Z.fontWeight.regular,fontSize:x.Z.fontSize.UIRegular.desktop,font:"SF Pro Text",color:"rgba(172, 171, 169, 1)"},children:"/"}),(0,c.jsx)(c.Fragment,{children:(0,_r.D)({width:"16px",height:"16px",color:s.mediumIconColor})}),(0,c.jsx)(Me.Z,{style:{font:"SF Pro",fontWeight:x.Z.fontWeight.medium,fontSize:x.Z.fontSize.UIRegular.desktop},children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.importComplete.projectLabel",defaultMessage:"Projects"})})]}),style:{width:300}}],rows:t.numberOfTasksPerProject.map((e=>({key:e.projectId,columns:[(0,c.jsxs)(jr.gq,{gap:8,alignItems:"start",flexDirection:"column",children:[(0,c.jsx)(Me.Z,{isMultiline:!0,style:{wordWrap:"break-word",width:300,fontWeight:x.Z.fontWeight.medium,font:"SF Pro",fontSize:x.Z.fontSize.UIRegular.desktop},children:e.name}),(0,c.jsxs)(Me.Z,{isSmall:!0,children:[e.numberOfTasks,(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.importConfir,.tasksHelperText",defaultMessage:" tasks"})]},`${e.projectId}-tasks-count`)]},e.projectId),(0,c.jsx)(jr.gq,{},`${e.projectId}-seperator`),(0,c.jsx)(jr.gq,{children:(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",gap:4,paddingBottom:6},children:[(0,_r.D)({width:20,height:20,color:s.mediumIconColor}),(0,c.jsx)(vn.Z,{href:e.notionProjectId?(0,lr.Z)({pageId:e.notionProjectId,pageModel:(0,dr.lA)({table:pr.iU,id:e.notionProjectId}),baseUrl:Gs.default.domainBaseUrl,pageVisitSource:tr.tY.Import}):void 0,style:{wordWrap:"break-word",fontWeight:x.Z.fontWeight.medium,font:"SF Pro",fontSize:x.Z.fontSize.UIRegular.desktop,textDecorationLine:"underline",textDecorationColor:"rgba(227, 226, 224, 1)"},disableHover:!0,children:e.name})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:10},children:[(0,Rr.v)({width:14,height:14,color:s.mediumIconColor}),(0,c.jsxs)(vn.Z,{href:e.notionProjectId?(0,lr.Z)({pageId:e.notionProjectId,pageModel:(0,dr.lA)({table:pr.iU,id:e.notionProjectId}),baseUrl:Gs.default.domainBaseUrl,pageVisitSource:tr.tY.Import}):void 0,style:{color:"rgba(120, 119, 116, 1)",font:"SF Pro",fontSize:x.Z.fontSize.UISmall.desktop,fontWeight:x.Z.fontWeight.regular},disableUnderline:!0,disableHover:!0,children:[e.numberOfTasks,(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.importConfir,.tasksHelperText",defaultMessage:" tasks"})]},`${e.projectId}-tasks-count`)]})]})},`${e.projectId}-notionProjects`)]})))})})}const Dr=function(){const e=(0,o.O7)(),t=(0,g.useIntl)(),s=(0,a.VK)((()=>ar.Z.getState()),[]),{isLoadingProjects:i,workspaces:r,selectedWorkspace:l,teamsAndProjects:d}=s;return(0,n.useEffect)((()=>{l&&mr.y2({selectedWorkspace:l,environment:e}).catch((()=>{}))}),[l,e]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Me.Z,{isSmall:!0,style:{paddingTop:4,paddingBottom:4},children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.workspaceChoiceHelperText",defaultMessage:"Only one workspace can be imported at a time."})}),(0,c.jsx)(Vr,{onSelectOption:e=>{ar.Z.setState({...s,selectedProjectsAndTeamspaces:{},selectedWorkspace:e})},options:r.map((e=>({key:e.gid,label:e.name}))),currentOption:l,placeHolder:t.formatMessage({id:"asanaImporter.selectData.selectWorkspacePlaceholder",defaultMessage:"Select a workspace"})}),l?(0,c.jsx)(Me.Z,{style:{fontWeight:x.Z.fontWeight.semibold,marginTop:18},children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.selectProjects",defaultMessage:"Select projects"})}):(0,c.jsx)(c.Fragment,{}),i?(0,c.jsxs)(jr.gq,{style:{gap:8,marginTop:32,alignItems:"center"},children:[(0,c.jsx)(Pi.Z,{style:{fontSize:12}}),(0,c.jsx)(Me.Z,{isSmall:!0,style:{color:Ks.FN.light.gray[400]},children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadingProjectsHelperText",defaultMessage:"Loading projects in the workspace..."})})]}):d.filter((e=>0!==e.projects.length)).map((e=>(0,c.jsx)(Lr,{team:e,selectedWorkspace:l},`${e.gid}-table`)))]})};function Lr(e){var t;let{team:s,selectedWorkspace:i}=e;const d=(0,o.O7)(),u=(0,g.useIntl)(),p=(0,r.Fg)(),[m,h]=(0,n.useState)(!1),[f,y]=(0,n.useState)(!1),[S,v]=(0,n.useState)(),b=(0,a.VK)((()=>ar.Z.getState()),[]),{importCompletedTasks:M,loadMoreClicks:j,selectedProjectsAndTeamspaces:C}=b,w=(0,a.VK)((()=>Ke.default.state.currentSpaceViewStore),[]),k=(0,a.VK)((()=>{const e=null==w?void 0:w.getTeamsStores();return null==e?void 0:e.map((e=>({id:e.id,name:e.getName(),icon:(0,c.jsx)(Mr.p,{disabled:!0,store:e})})))}),[w]);(0,n.useEffect)((()=>{if(!k||!w)return;if(!C[s.gid]){v("private"),mr.B3({teamId:s.gid,spaceId:null==w?void 0:w.id});for(const n of k){var e,t;if((null===(e=n.name)||void 0===e?void 0:e.toLowerCase())===(null===(t=s.name)||void 0===t?void 0:t.toLowerCase())){v(n.id),mr.B3({teamId:s.gid,spaceId:n.id});break}}}}),[k,s,w,C]);const I=(0,n.useCallback)((e=>{mr.B3({teamId:s.gid,spaceId:e}),v(e)}),[s.gid]),Z=(0,n.useCallback)((e=>{if("create"===e)return void br.lo("asana_importer",{onClose:I});let t;if("private"===e){if(null==w||!w.id)return;t=w.id}else t=e;mr.B3({teamId:s.gid,spaceId:t}),v(e)}),[null==w?void 0:w.id,s.gid,I]),P=[{key:"private",searchTerm:"private",label:(0,c.jsxs)(jr.gq,{alignItems:"center",style:{gap:8},children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:16,height:16,borderRadius:"0.25em",backgroundColor:Ks.FN.light.gray[75]},children:(0,l.Q)({color:p.mediumIconColor,width:12.5,height:12.5})}),(0,c.jsx)(Me.Z,{style:{fontWeight:x.Z.fontWeight.regular},children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.privateSpaceTitle",defaultMessage:"Private"})})]})}];return k&&P.push(...k.map((e=>({key:e.id,searchTerm:e.name,label:(0,c.jsxs)(jr.gq,{alignItems:"center",style:{gap:8},children:[e.icon,e.name]})})))),P.push({key:"create",searchTerm:"New teamspace",label:(0,c.jsxs)(jr.gq,{alignItems:"center",style:{gap:4},children:[(0,Sr.f)({color:p.mediumIconColor,width:16,height:16}),(0,c.jsx)(Me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.newTeamspace",defaultMessage:"New teamspace"})})]})}),(0,c.jsxs)(jr.gq,{style:{marginLeft:-18},children:[(0,c.jsx)(Qn.Z,{ariaLabel:"collapse toggle",icon:vr.L,onClick:()=>h((e=>!e)),style:{transform:m?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:24,width:10,height:10},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},iconStyle:{width:10,height:10}}),(0,c.jsx)(wr.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,c.jsxs)(jr.gq,{alignItems:"center",gap:2,children:[(0,c.jsx)(Nr,{onSelectOption:e=>{var t;ar.Z.setState({...b,selectedProjectsAndTeamspaces:{...C,[s.gid]:{notionTeamspaceId:null===(t=C[s.gid])||void 0===t?void 0:t.notionTeamspaceId,projects:e}}})},options:[{key:"in_complete",label:"Exclude completed projects"},{key:"all",label:"Select all projects"}],currentOption:(e=>{const t=null===(e=C[s.gid])||void 0===e?void 0:e.projects;return"string"==typeof t?t:null!=t&&t.length?"specific":void 0})()}),(0,c.jsx)(Me.Z,{style:{width:280,textOverflow:"ellipsis"},children:s.name})]}),style:{width:300}},{key:"importInto",header:(0,c.jsxs)(jr.gq,{style:{alignItems:"center"},children:[(0,c.jsx)("div",{children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.importInto",defaultMessage:"Import into"})}),(0,c.jsx)("div",{style:{marginRight:16,marginLeft:8},children:(0,fr.n)({width:12})}),(0,c.jsxs)(jr.gq,{style:{alignItems:"center",gap:8},children:[(0,c.jsx)("img",{src:rr.Z.emails.notionLogoBlackSmallPng,height:18}),(0,c.jsx)(Vr,{options:P,onSelectOption:Z,currentOption:null===(t=P.find((e=>e.key===S)))||void 0===t?void 0:t.key,narrow:!0,allowSearch:!0,placeHolder:u.formatMessage({id:"asanaImport.importsTab.selectData.selectATeamspace",defaultMessage:"Select a teamspace"})})]})]}),style:{width:"50%"}}],rows:function(e){let{collapsed:t}=e;if(t)return[];const n=s.projects.map((e=>({key:e.gid,columns:[(0,c.jsxs)(jr.gq,{alignItems:"center",gap:6,style:{marginLeft:20},children:[(0,c.jsx)(Ka.Z,{style:{marginRight:2},onClick:()=>{const t={...C[s.gid]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:n,projects:i}=t;let o;o="all"===i||"in_complete"===i?[]:i.includes(e.gid)?i.filter((t=>t!==e.gid)):i.concat(e.gid),ar.Z.setState({...b,selectedProjectsAndTeamspaces:{...C,[s.gid]:{notionTeamspaceId:n,projects:o}}})},checked:(()=>{const t={...C[s.gid]||{projects:[],notionTeamspaceId:void 0}};return"all"===t.projects||"in_complete"===t.projects&&!1===e.completed||t.projects.includes(e.gid)})(),size:14,checkSize:8}),(0,c.jsx)(Cr.z,{color:e.color,size:6}),(0,c.jsx)("div",{style:{width:240,wordWrap:"break-word"},children:e.completed?(0,c.jsxs)(Me.Z,{isMultiline:!0,style:{color:p.lightTextColor},children:[e.name,(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.completedHelperText",defaultMessage:" (Completed)"})]}):(0,c.jsx)(Me.Z,{isMultiline:!0,children:e.name})})]},`${e.gid}-container`),(0,c.jsxs)(Me.Z,{isSmall:!0,children:[M?e.task_counts.num_tasks:e.task_counts.num_incomplete_tasks,(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.tasksHelperText",defaultMessage:" tasks"})]},`${s.gid}-tasks-count`)]})));return s.nextPage&&n.push({key:"loadMore",columns:[(0,c.jsx)(xn.Z,{disabled:f,style:{marginLeft:20,color:Ks.FN.light.gray[400]},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},onClick:async()=>{if(!i)return;y(!0);const e=await T.getTeamsAndProjectsInAsanaWorkspace(d,{workspaceId:i,teamId:s.gid,size:5,nextPage:s.nextPage}),{teamsAndProjects:t}={...b},n=t.find((e=>e.gid===s.gid));if(n){if("success"===e.type){const i=e.data.find((e=>e.gid===s.gid));if(!i)return;n.projects.push(...i.projects),n.nextPage=i.nextPage,ar.Z.setState({...b,teamsAndProjects:t,loadMoreClicks:j+1})}y(!1)}},children:f?(0,c.jsxs)(jr.gq,{alignItems:"center",gap:8,children:[(0,c.jsx)(Pi.Z,{style:{fontSize:12}}),(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadingMoreProjects",defaultMessage:"Loading more projects..."})]}):(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadMoreProjects",defaultMessage:"Load more projects..."})},`${s.gid}-loadmore`)]}),n}({collapsed:m})})]})}function Vr(e){var t;const{onSelectOption:s,options:i,currentOption:o,placeHolder:a,narrow:l,allowSearch:d}=e,u=(0,g.useIntl)(),[p,m]=(0,n.useState)(""),h=null===(t=i.find((e=>{let{key:t}=e;return t===o})))||void 0===t?void 0:t.label,f=(0,r.yK)((e=>({icon:{width:12,height:12,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,c.jsx)(_o.ZP,{popupType:_o.Z4.Popup,placementToOrigin:_o.pO.Bottom,renderOrigin:e=>(0,c.jsxs)(Xt.Z,{...e,style:{paddingTop:l?2:8,paddingBottom:l?2:8,paddingLeft:8,paddingRight:8,opacity:1,width:250,border:`1px solid ${Ks.FN.light.gray[100]}`,justifyContent:"space-between",marginTop:8,marginBottom:8,background:o?void 0:Ks.FN.light.gray[50],color:o?void 0:Ks.FN.light.gray[300]},disabled:!1,children:[(0,c.jsx)(Me.Z,{style:{textOverflow:"ellipsis"},children:h||a}),(0,yr.i)(f.icon)]}),render:e=>{const t={menuType:Hs.og.Popup,width:250,left:50},n=[{key:"asanaImport.dropdown.menuList",render:e=>(0,c.jsx)(tn.Z,{...e}),items:(p.trim()?i.filter((e=>{var t;return null===(t=e.searchTerm)||void 0===t?void 0:t.toLowerCase().includes(p.toLowerCase())})):i).map((t=>{let{key:n,label:i}=t;return{key:n,action:()=>{s(n),e.close()},render:e=>(0,c.jsx)(Qs.Z,{...e,title:i,shouldWrapCaption:!0,right:h===i?(0,c.jsx)("div",{style:{width:14},children:(0,xr.e)()}):void 0})}}))}];return(0,c.jsxs)(c.Fragment,{children:[d?(0,c.jsx)("input",{style:{width:"100%",borderRadius:0,backgroundColor:Ks.FN.light.gray[200],paddingTop:2,paddingBottom:2,paddingLeft:8,paddingRight:8,opacity:1,border:`1px solid ${Ks.FN.light.gray[100]}`,justifyContent:"space-between",background:Ks.FN.light.gray[50],fontSize:x.Z.fontSize.UIRegular.desktop,textOverflow:"ellipses"},placeholder:u.formatMessage({id:"asanaImport.importsTab.selectData.searchTeamspacePlaceholder",defaultMessage:"Search for a teamspace"}),onChange:e=>m(e.target.value),value:p}):(0,c.jsx)(c.Fragment,{}),(0,c.jsx)($s.Z,{...t,children:(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,sections:n,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})]})}})}function Nr(e){var t;const{onSelectOption:s,options:i,currentOption:o}=e,a=null===(t=i.find((e=>{let{key:t}=e;return t===o})))||void 0===t?void 0:t.label,r=(0,n.useMemo)((()=>void 0!==o&&"specific"!==o&&("all"===o||"partial")),[o]);return(0,c.jsx)(_o.ZP,{popupType:_o.Z4.Popup,placementToOrigin:_o.pO.Bottom,alignmentToOrigin:_o.vR.Start,renderOrigin:e=>(0,c.jsx)(Xt.Z,{...e,style:{padding:0,margin:0,marginRight:4,height:14},hoveredStyle:{},children:(0,c.jsx)(Ka.Z,{checked:r,disabled:!0,size:14,checkSize:8})}),render:e=>{const t={menuType:Hs.og.Popup,width:250,left:50},n=[{key:"asanaImport.checkboxDropdown.menuList",render:e=>(0,c.jsx)(tn.Z,{...e}),items:i.map((t=>{let{key:n,label:i}=t;return{key:n,action:()=>{s(n),e.close()},render:e=>(0,c.jsx)(Qs.Z,{...e,title:i,shouldWrapCaption:!0,right:a===i?(0,c.jsx)("div",{style:{width:14},children:(0,xr.e)()}):void 0})}}))}];return(0,c.jsx)($s.Z,{...t,children:(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,sections:n,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})}})}var Er=s(24006),Ur=s(53465),Wr=s(64878);const Kr=function(e){var t;const s=(0,r.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor},closeIconStyle:{width:16,height:16,fill:e.redBadgeBackground},lightText:{color:e.lightTextColor}})),[]);return(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"},children:[(0,c.jsxs)(jr.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"},children:[(0,c.jsx)("img",{style:{width:32,height:32,marginRight:8},src:e.assetSrc}),(0,Wr.h)(s.iconStyle),(0,Wr.h)(s.iconStyle),(0,Wr.h)(s.iconStyle),(0,Ur.X)(s.closeIconStyle),(0,Wr.h)(s.iconStyle),(0,Wr.h)(s.iconStyle),(0,Wr.h)(s.iconStyle),(0,c.jsx)("img",{style:{width:32,height:32,marginLeft:8},src:rr.Z.images.notionLogoPng})]}),(0,c.jsx)(Me.Z,{style:s.lightText,children:e.failedMessage}),(0,c.jsx)(Me.Z,{style:s.lightText,children:(0,c.jsx)(g.FormattedMessage,{id:"import.importingData.failed.viewLoggerPage",defaultMessage:"Please try again or read the {link} to troubleshoot.",values:{link:(0,c.jsx)("a",{style:{color:Ks.ZP.black,cursor:"pointer"},href:`/${null===(t=e.loggerPageId)||void 0===t?void 0:t.replaceAll("-","")}`,children:(0,c.jsx)(g.FormattedMessage,{id:"import.importingData.failed.linkText",defaultMessage:"import logs"})})}})})]})};const zr=function(e){const{dotCount:t=6,speed:s=800}=e,[i,o]=(0,n.useState)(1),a=(0,r.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor,opacity:.5},iconStyleBold:{width:6,height:6,fill:e.lightIconColor}})),[]);return(0,n.useEffect)((()=>{const e=setInterval((()=>o((e=>e<t?e+1:1))),s);return()=>clearInterval(e)}),[t,s]),(0,c.jsx)(jr.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"},children:Array.from({length:t},((e,t)=>t+1)).map((e=>(0,c.jsx)("div",{children:(0,Wr.h)(i===e?a.iconStyleBold:a.iconStyle)},e)))})};const qr=function(e){const t=(0,r.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor},iconStyleBold:{width:8,height:8,fill:e.mediumIconColor},lightText:{color:e.lightTextColor}})),[]);return(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"},children:[(0,c.jsxs)(jr.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"},children:[(0,c.jsx)("img",{style:{width:32,height:32,marginRight:8},src:e.assetSrc}),(0,c.jsx)(zr,{}),(0,c.jsx)("img",{style:{width:32,height:32,marginLeft:8},src:rr.Z.images.notionLogoPng})]}),(0,c.jsx)(jr.gq,{children:(0,c.jsx)(Me.Z,{style:t.lightText,children:(0,c.jsx)(g.FormattedMessage,{id:"import.importingData.feelFreeToLeave",defaultMessage:"Data is being imported. Feel free to leave this window."})})}),(0,c.jsx)(jr.gq,{children:(0,c.jsx)(Me.Z,{style:t.lightText,children:(0,c.jsx)(g.FormattedMessage,{id:"import.importingData.sendEmail",defaultMessage:"We will send you an email when the import is complete or if any problems occur."})})})]})},Gr=(0,g.defineMessages)({failed:{defaultMessage:"Some problems occurred while importing data from your Asana workspace.",id:"Asanaimport.importingData.failed.problemsOccured"}});function Hr(e){switch(e){case"selectData":return(0,c.jsx)(Me.Z,{style:{fontWeight:x.Z.fontWeight.semibold},children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.tabTitle",defaultMessage:"Select Asana workspace"})});case"chooseWorkspace":return(0,c.jsx)(Me.Z,{style:{font:"SF Pro",fontWeight:"590",fontSize:"17px",lineHeight:"22px"},children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.tabTitle",defaultMessage:"Choose Asana workspace"})});default:return(0,c.jsx)(c.Fragment,{})}}function Yr(e){return"chooseWorkspace"===e?(0,c.jsx)(Me.Z,{style:{font:"SF Pro",fontWeight:x.Z.fontWeight.regular,fontSize:x.Z.fontSize.UIRegular.desktop,lineHeight:"19.6px",whiteSpace:"normal",wordWrap:"break-word",paddingBottom:20},children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.tabContext",defaultMessage:"Import your Asana projects and tasks into Notion. Assignees, due dates, attachments, and more will be kept, and you can use Notion’s database features to customize your projects and tasks for your team’s needs"})}):(0,c.jsx)(c.Fragment,{})}function Qr(e){const t="chooseWorkspace",s=(0,r.yK)((e=>({stepIndicator:{font:"SF Pro",alignItems:"center",fontWeight:510,fontSize:x.Z.fontSize.UIRegular.desktop,lineHeight:"18px"},stepIndicatorContainer:{display:"flex",height:32,padding:6,gap:"8px",borderRadius:4,justifyContent:"center",alignItems:"center"},verificationCheck:{width:16,height:16,padding:"0.5px, 0px, 0px, 0px",gap:"10px",color:Ks.ZP.lightIconColor}})),[]),n=(0,a.VK)((()=>ar.Z.getState()),[]),{choosingWorkspacesCompleted:i}=n;return(0,c.jsxs)("div",{style:{paddingBottom:20,display:"flex",gap:"12px",padding:"12px",alignItems:"center",alignContent:"center",paddingLeft:0},children:[(0,c.jsxs)("div",{style:{...s.stepIndicatorContainer,width:i?191:165,background:e===t?"rgba(0, 0, 0, 0.05)":void 0},children:[i?(0,ur.X)(s.verificationCheck):(0,c.jsx)(c.Fragment,{}),(0,c.jsx)(Me.Z,{style:{...s.stepIndicator,color:i?Ks.ZP.lightTextColor:e===t?Ks.ZP.regularTextColor:Ks.ZP.mediumTextColor},children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.stepIndicator.chooseWorkspaceTab",defaultMessage:"Choose what to import"})})]}),(0,c.jsxs)("div",{style:{...s.stepIndicatorContainer,width:"confirm"===e?83:57,background:"importingData"===e?"rgba(0, 0, 0, 0.05)":void 0},children:["confirm"===e?(0,ur.X)(s.verificationCheck):(0,c.jsx)(c.Fragment,{}),(0,c.jsx)(Me.Z,{style:{...s.stepIndicator,color:"confirm"===e?Ks.ZP.lightTextColor:"importingData"===e?Ks.ZP.regularTextColor:Ks.ZP.mediumTextColor},children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.stepIndicator.importTab",defaultMessage:"Import"})})]})]})}const $r=function(e){let{tab:t,fetchActiveImportTasks:s}=e;const i=L.default.getIntl(),l=(0,o.O7)(),d=(0,a.VK)((()=>Ke.default.state.currentSpaceStore),[]),u=(0,a.VK)((()=>Ke.default.state.currentSpaceViewStore),[]),p=(0,a.VK)((()=>hr.Z.state.teams),[]),m=(0,a.VK)((()=>ar.Z.state),[]),h=(0,a.VK)((()=>Ce.default.checkGate("improved_asana_importer_screens")),[]),y=(0,a.VK)((()=>ze.Z.state),[]).flowId||(0,f.ZP)(),{importCompletedTasks:S,loggerPageId:v,selectedProjectsAndTeamspaces:b,selectedWorkspace:M,templateCreationInProgress:j,result:C,workspaces:w}=m,k=(0,n.useCallback)((()=>Object.values(b).some((e=>0!==e.projects.length))),[b]),T=(0,r.yK)((e=>({closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor},helpCenterButtonStytles:{display:"flex",alignItems:"baseline",justifyContent:"center",alignContent:"center",fontSize:x.Z.fontSize.UIRegular.desktop,padding:"6px, 0px, 0px, 0px",borderRadius:4,color:e.mediumTextColor,marginTop:2,width:298,height:28,gap:"4px",lineHeight:"18px"},externalLinkIcon:{width:"16px",height:"16px",padding:"0.5px, 0px, 0px, 0px",gap:"8px"}})),[]);function I(){return(0,c.jsx)(xn.Z,{style:T.helpCenterButtonStytles,onClick:()=>{gr.c4({url:(0,Ue.UY)("guides.importAsana"),environment:l})},hoveredStyle:{background:"none"},children:(0,c.jsxs)("div",{style:{width:282,height:18,display:"flex",justifyContent:"center",alignItems:"start"},children:[(0,c.jsx)("div",{style:{width:264,height:18,font:"SF Pro",fontWeight:x.Z.fontWeight.medium,fontSize:x.Z.fontSize.UIRegular.desktop,lineHeight:"18px"},children:(0,c.jsx)(g.FormattedMessage,{id:"importsTab.confirm.helpCenter",defaultMessage:"Learn more about importing from Asana"})}),(0,cr.K)(T.externalLinkIcon)]})})}let Z=t;return h&&("selectData"===t?Z="chooseWorkspace":"confirm"===t&&(Z="importComplete")),(0,c.jsxs)(pt.ZP,{controlRow:(e=>"selectData"===e?(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,c.jsx)(Ri.Z,{style:{border:0},disabled:!w.length,onClick:()=>{s(),ar.Z.resetImport()},children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.selectData.backButtonText",defaultMessage:"Back"})}),(0,c.jsxs)(jr.gq,{alignItems:"center",gap:8,children:[M?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Er.Z,{on:S,onClick:()=>ar.Z.setState({...m,importCompletedTasks:!S})}),(0,c.jsx)(Me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"importsTab.selectData.importCompletedTasks",defaultMessage:"Import completed tasks"})})]}):(0,c.jsx)(c.Fragment,{}),(0,c.jsx)("div",{style:{gap:2},children:(0,c.jsx)(Sn.Z,{style:{marginLeft:16},disabled:!k()||j,onClick:()=>{d&&u&&mr.T_({environment:l,currentSpaceViewStore:u,spaceStore:d,teamsStores:p,flowId:y}).catch((()=>{}))},children:j?(0,c.jsxs)(jr.gq,{alignItems:"center",gap:2,children:[(0,c.jsx)(Pi.Z,{isWhite:!0}),(0,c.jsx)(g.FormattedMessage,{id:"importsTab.selectData.creatingTemplates",defaultMessage:"Creating templates"})]}):(0,c.jsx)(g.FormattedMessage,{id:"importsTab.selectData.nextButtonText",defaultMessage:"Next"})})})]})]}):"chooseWorkspace"===e?(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[I(),(0,c.jsxs)(jr.gq,{alignItems:"center",gap:8,children:[M?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Er.Z,{on:S,onClick:()=>ar.Z.setState({...m,importCompletedTasks:!S})}),(0,c.jsx)(Me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"importsTab.chooseWorkspace.importCompletedTasks",defaultMessage:"Import completed tasks"})})]}):(0,c.jsx)(c.Fragment,{}),(0,c.jsxs)("div",{style:{gap:2},children:[(0,c.jsx)(Ri.Z,{style:{border:0},disabled:!w.length,onClick:()=>{s(),ar.Z.resetImport()},children:(0,c.jsx)(g.FormattedMessage,{id:"asanaImport.chooseWorkspace.backButtonText",defaultMessage:"Back"})}),(0,c.jsx)(Sn.Z,{style:{marginLeft:16},disabled:!k()||j,onClick:()=>{d&&u&&mr.T_({environment:l,currentSpaceViewStore:u,spaceStore:d,teamsStores:p,flowId:y}).catch((()=>{}))},children:j?(0,c.jsxs)(jr.gq,{alignItems:"center",gap:2,children:[(0,c.jsx)(Pi.Z,{isWhite:!0}),(0,c.jsx)(g.FormattedMessage,{id:"importsTab.chooseWorkspace.creatingTemplates",defaultMessage:"Creating templates"})]}):(0,c.jsx)(g.FormattedMessage,{id:"importsTab.chooseWorkspace.nextButtonText",defaultMessage:"Next"})})]})]})]}):"importingData"===e?(0,c.jsxs)("div",{style:{display:"flex",justifyContent:h?"space-between":"right"},children:[h?I():(0,c.jsx)(c.Fragment,{}),(0,c.jsx)(Ri.Z,{disabled:!w.length,onClick:()=>{s(),ar.Z.resetImport()},children:(0,c.jsx)(g.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"})})]}):"confirm"===e?(0,c.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,c.jsx)(Sn.Z,{onClick:()=>{v&&gr.c4({url:(0,lr.Z)({pageId:v,pageModel:(0,dr.lA)({table:pr.iU,id:v}),baseUrl:Gs.default.domainBaseUrl,pageVisitSource:tr.tY.Import}),environment:l}),ar.Z.resetImport(),it.Z.reset()},children:(0,c.jsx)(g.FormattedMessage,{id:"importsTab.confirm.doneText",defaultMessage:"Done"})})}):"failure"===e?(0,c.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,c.jsx)(Ri.Z,{disabled:!w.length,onClick:()=>{s(),ar.Z.resetImport()},children:(0,c.jsx)(g.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"})})}):"importComplete"===e?(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",height:48,paddingTop:35,paddingBottom:28,border:"1px, 0px, 0px, 0px"},children:[I(),(0,c.jsx)(Sn.Z,{style:{width:"181px",height:"32px",padding:"0px, 0px, 0px, 8px",borderRadius:"4px",gap:"4px"},onClick:()=>{if(null!=C&&C.length&&v){const e=C.find((e=>void 0!==e.projectCollectionPageId));gr.c4({url:(0,lr.Z)({pageId:(null==e?void 0:e.projectCollectionPageId)||v,pageModel:(0,dr.lA)({table:pr.iU,id:(null==e?void 0:e.projectCollectionPageId)||v}),baseUrl:Gs.default.domainBaseUrl,pageVisitSource:tr.tY.Import}),environment:l})}ar.Z.resetImport(),it.Z.reset()},children:(0,c.jsx)(g.FormattedMessage,{id:"importsTab.confirm.viewImportedProjects",defaultMessage:"View imported projects"})})]}):void 0)(Z),controlRowPaddingTopBottom:"confirm"===t&&h?0:h?10:20,removeBoxShadow:"confirm"===t&&h,contentPaddingLeftRight:h?25:void 0,controlRowPaddingLeftRight:h?15:void 0,getPaddingTopBottom:h?()=>2:void 0,children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[h?Qr(Z):(0,c.jsx)(c.Fragment,{}),(0,c.jsx)("div",{style:{position:"absolute",top:12,right:12},children:(0,c.jsx)(xn.Z,{onClick:()=>{s(),ar.Z.resetImport()},style:T.closeButton,hoveredStyle:T.closeButtonHover,children:(0,Oa.D)(T.closeButtonIcon)})})]}),Yr(Z),(0,c.jsx)(Me.Z,{style:{paddingBottom:8,fontSize:18,fontWeight:x.Z.fontWeight.medium,width:"100%"},children:Hr(Z)}),(e=>"selectData"===e?(0,c.jsx)(Dr,{}):"importingData"===e?(0,c.jsx)(qr,{assetSrc:rr.Z.images.import.asanaPng}):"confirm"===e?(0,c.jsx)(Fr,{}):"failure"===e?(0,c.jsx)(Kr,{assetSrc:rr.Z.images.import.asanaPng,loggerPageId:v,failedMessage:i.formatMessage(Gr.failed)}):"chooseWorkspace"===e?(0,c.jsx)(kr,{}):"importComplete"===e?(0,c.jsx)(Or,{}):void 0)(Z)]})};const Jr=function(e){let{fetchActiveImportTasks:t}=e;const s=(0,a.VK)((()=>ar.Z.state),[]),{isModalOpen:i}=s,o=(0,n.useCallback)((()=>{ar.Z.resetImport()}),[]),r=(0,n.useCallback)((()=>{const{currentTab:e}=s;return(0,c.jsx)($r,{fetchActiveImportTasks:t,tab:e})}),[s,t]);return(0,c.jsx)(_n.Z,{open:i,innerStyle:{width:800,height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:5,maxHeight:675},render:()=>(0,c.jsx)(Fn.Z,{capture:!0,allowEsc:!0,render:()=>(0,c.jsx)(An.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,render:()=>r()})}),onDismiss:o})};var Xr=s(51560),el=s(69122),tl=s(61397);const sl=function(){const e=(0,a.VK)((()=>el.Z.state),[]);return e.result?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Me.Z,{isMultiline:!0,children:(0,c.jsx)(g.FormattedMessage,{id:"mondayImport.importsTab.confirm.subtitle",defaultMessage:"The following data has been successfully imported."})}),(0,c.jsx)("div",{style:{marginTop:32},children:e.result.map((e=>(0,c.jsx)(nl,{importStatus:e},e.mondayFolderId)))})]}):(0,c.jsx)(c.Fragment,{})};function nl(e){let{importStatus:t}=e;const s=(0,r.Fg)(),[i,o]=(0,n.useState)(!1),d=(0,a.VK)((()=>Ke.default.state.currentSpaceStore),[]),u=(0,a.VK)((()=>el.Z.state.mondayFoldersAndBoards),[]),p=(0,a.VK)((()=>Ke.default.state.currentSpaceViewStore),[]),m=(0,a.VK)((()=>{if(!p)return;const e=p.getTeamsStores().map((e=>({id:e.id,name:e.getName(),icon:(0,c.jsx)(Mr.p,{disabled:!0,store:e})})));return d?(e||[]).concat({id:p.id,name:"Private",icon:(0,c.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:18,height:18,borderRadius:"0.25em",backgroundColor:Ks.FN.light.gray[75]},children:(0,l.Q)({color:s.mediumIconColor,width:12.5,height:12.5})})}):e}),[p,d,s]),{notionTeamspaceName:h,notionTeamspaceIcon:f}=(0,n.useMemo)((()=>{const e=null==m?void 0:m.find((e=>e.id===t.notionTeamSpaceId));return e?{notionTeamspaceName:e.name,notionTeamspaceIcon:e.icon}:{notionTeamspaceName:void 0,notionTeamspaceIcon:void 0}}),[m,t]),x=(0,n.useMemo)((()=>{const e=u.find((e=>e.folderId===t.mondayFolderId));return null==e?void 0:e.folderName}),[u,t]);return(0,c.jsxs)(jr.gq,{style:{marginTop:16},children:[(0,c.jsx)(Qn.Z,{ariaLabel:"collapse toggle",icon:vr.L,onClick:()=>o((e=>!e)),style:{transform:i?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:4},iconStyle:{width:8,height:8}}),(0,c.jsx)(wr.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,c.jsx)(jr.gq,{alignItems:"center",gap:2,children:(0,c.jsx)(Me.Z,{isSmall:!0,style:{width:280,textOverflow:"ellipsis"},children:x})}),style:{width:300}},{key:"importedInto",header:(0,c.jsxs)(jr.gq,{gap:4,children:[(0,c.jsxs)(jr.gq,{style:{alignItems:"center",gap:4},children:[(0,c.jsx)(Me.Z,{isSmall:!0,children:(0,c.jsx)(g.FormattedMessage,{id:"mondayImport.importsTab.selectData.importedInto",defaultMessage:"Imported into"})}),(0,fr.n)({width:12})]}),(0,c.jsxs)(jr.gq,{style:{alignItems:"center",gap:4},children:[f,h]})]}),style:{width:300}}],rows:function(e){let{collapsed:s}=e;return s?[]:t.projects.map((e=>({key:e.projectId,columns:[(0,c.jsxs)(jr.gq,{gap:8,alignItems:"center",children:[(0,Pr.r)({width:12,color:Ks.FN.dark.green[600]}),(0,c.jsx)(Me.Z,{isMultiline:!0,style:{wordWrap:"break-word",width:300},children:e.name})]},e.projectId)]})))}({collapsed:i})})]})}const il=function(){const e=(0,o.O7)(),t=(0,g.useIntl)(),s=(0,a.VK)((()=>Ke.default.state.currentSpaceStore),[]),i=(0,a.VK)((()=>el.Z.getState()),[]),{workspaces:r,selectedWorkspace:l,mondayFoldersAndBoards:d}=i;return(0,n.useEffect)((()=>{l&&tl.IO({environment:e,spaceId:null==s?void 0:s.id,selectedWorkspace:l}).catch((()=>{}))}),[l,e,null==s?void 0:s.id]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Me.Z,{isSmall:!0,style:{paddingTop:4,paddingBottom:4},children:(0,c.jsx)(g.FormattedMessage,{id:"mondayImport.importsTab.selectData.workspaceChoiceHelperText",defaultMessage:"Only one workspace can be imported at a time."})}),(0,c.jsx)(al,{onSelectOption:e=>{el.Z.setState({...i,selectedProjectsAndTeamspaces:{},selectedWorkspace:e})},options:r.map((e=>({key:e.id,label:e.name}))),currentOption:i.selectedWorkspace,placeHolder:t.formatMessage({id:"mondayImporter.selectData.selectWorkspacePlaceholder",defaultMessage:"Select a workspace"})}),i.selectedWorkspace?(0,c.jsx)(Me.Z,{style:{fontWeight:x.Z.fontWeight.semibold,marginTop:18},children:(0,c.jsx)(g.FormattedMessage,{id:"mondayImport.importsTab.selectData.selectProjects",defaultMessage:"Select projects"})}):(0,c.jsx)(c.Fragment,{}),i.isLoadingProjects?(0,c.jsxs)(jr.gq,{style:{gap:8,marginTop:32,alignItems:"center"},children:[(0,c.jsx)(Pi.Z,{style:{fontSize:12}}),(0,c.jsx)(Me.Z,{isSmall:!0,style:{color:Ks.FN.light.gray[400]},children:(0,c.jsx)(g.FormattedMessage,{id:"mondayImport.importsTab.selectData.loadingProjectsHelperText",defaultMessage:"Loading projects in the workspace..."})})]}):d.map((e=>(0,c.jsx)(ol,{mondayFolderAndBoards:e},`${e.folderId}-table`)))]})};function ol(e){var t;let{mondayFolderAndBoards:s}=e;const i=(0,g.useIntl)(),o=(0,r.Fg)(),[d,u]=(0,n.useState)(!1),[p,m]=(0,n.useState)(),h=(0,a.VK)((()=>el.Z.getState()),[]),f=(0,a.VK)((()=>Ke.default.state.currentSpaceViewStore),[]),y=(0,a.VK)((()=>{const e=null==f?void 0:f.getTeamsStores();return null==e?void 0:e.map((e=>({id:e.id,name:e.getName(),icon:(0,c.jsx)(Mr.p,{disabled:!0,store:e})})))}),[f]);(0,n.useEffect)((()=>{if(!y||!f)return;if(!h.selectedProjectsAndTeamspaces[s.folderId]){m("private"),tl.eL({folderId:s.folderId,spaceId:null==f?void 0:f.id});for(const n of y){var e,t;if((null===(e=n.name)||void 0===e?void 0:e.toLowerCase())===(null===(t=s.folderName)||void 0===t?void 0:t.toLowerCase())){m(n.id),tl.eL({folderId:s.folderId,spaceId:n.id});break}}}}),[y,s,f,h.selectedProjectsAndTeamspaces]);const S=(0,n.useCallback)((e=>{tl.eL({folderId:s.folderId,spaceId:e}),m(e)}),[s.folderId]),v=(0,n.useCallback)((e=>{if("create"===e)return void br.lo("monday_importer",{onClose:S});let t;if("private"===e){if(null==f||!f.id)return;t=f.id}else t=e;tl.eL({folderId:s.folderId,spaceId:t}),m(e)}),[null==f?void 0:f.id,s.folderId,S]),b=[{key:"private",searchTerm:"private",label:(0,c.jsxs)(jr.gq,{alignItems:"center",style:{gap:8},children:[(0,c.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:16,height:16,borderRadius:"0.25em",backgroundColor:Ks.FN.light.gray[75]},children:(0,l.Q)({color:o.mediumIconColor,width:12.5,height:12.5})}),(0,c.jsx)(Me.Z,{style:{fontWeight:x.Z.fontWeight.regular},children:(0,c.jsx)(g.FormattedMessage,{id:"mondayImport.importsTab.selectData.privateSpaceTitle",defaultMessage:"Private"})})]})}];return y&&b.push(...y.map((e=>({key:e.id,searchTerm:e.name,label:(0,c.jsxs)(jr.gq,{alignItems:"center",style:{gap:8},children:[e.icon,e.name]})})))),b.push({key:"create",searchTerm:"New teamspace",label:(0,c.jsxs)(jr.gq,{alignItems:"center",style:{gap:4},children:[(0,Sr.f)({color:o.mediumIconColor,width:16,height:16}),(0,c.jsx)(Me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"mondayImport.importsTab.selectData.newTeamspace",defaultMessage:"New teamspace"})})]})}),(0,c.jsxs)(jr.gq,{style:{marginLeft:-18},children:[(0,c.jsx)(Qn.Z,{ariaLabel:"collapse toggle",icon:vr.L,onClick:()=>u((e=>!e)),style:{transform:d?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:24,width:10,height:10},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},iconStyle:{width:10,height:10}}),(0,c.jsx)(wr.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,c.jsxs)(jr.gq,{alignItems:"center",gap:2,children:[(0,c.jsx)(Ka.Z,{style:{marginRight:4,height:14},checked:(()=>{const e={...h.selectedProjectsAndTeamspaces[s.folderId]||{projects:[],notionTeamspaceId:void 0,isEntireFolderSelected:void 0}};return Boolean(e.isEntireFolderSelected)})(),size:14,checkSize:8,onClick:()=>{const e={...h.selectedProjectsAndTeamspaces[s.folderId]||{projects:[],notionTeamspaceId:void 0,isEntireFolderSelected:void 0}},{notionTeamspaceId:t,isEntireFolderSelected:n}=e;let i,o;if(n)i=[],o=!1;else{i=[...s.projects.map((e=>({name:e.name,mondayProjectId:e.id,mondayBoardId:e.boardId,collectionType:"projects"}))),...s.taskBoards.map((e=>({name:e.name,mondayProjectId:e.id,collectionType:"tasks"})))],o=!0}el.Z.setState({...h,selectedProjectsAndTeamspaces:{...h.selectedProjectsAndTeamspaces,[s.folderId]:{notionTeamspaceId:t,projects:i,isEntireFolderSelected:o}}})}}),(0,c.jsx)(Me.Z,{style:{width:280,textOverflow:"ellipsis"},children:s.folderName})]}),style:{width:300}},{key:"importInto",header:(0,c.jsxs)(jr.gq,{style:{alignItems:"center"},children:[(0,c.jsx)("div",{children:(0,c.jsx)(g.FormattedMessage,{id:"mondayImport.importsTab.selectData.importInto",defaultMessage:"Import into"})}),(0,c.jsx)("div",{style:{marginRight:16,marginLeft:8},children:(0,fr.n)({width:12})}),(0,c.jsxs)(jr.gq,{style:{alignItems:"center",gap:8},children:[(0,c.jsx)("img",{src:rr.Z.emails.notionLogoBlackSmallPng,height:18}),(0,c.jsx)(al,{options:b,onSelectOption:v,currentOption:null===(t=b.find((e=>e.key===p)))||void 0===t?void 0:t.key,narrow:!0,allowSearch:!0,placeHolder:i.formatMessage({id:"mondayImport.importsTab.selectData.selectATeamspace",defaultMessage:"Select a teamspace"})})]})]}),style:{width:"50%"}}],rows:function(e){let{collapsed:t}=e;if(t)return[];const n=s.projects.map((e=>({key:e.id,columns:[(0,c.jsxs)(jr.gq,{alignItems:"center",gap:6,style:{marginLeft:20},children:[(0,c.jsx)(Ka.Z,{style:{marginRight:2},onClick:()=>{const t={...h.selectedProjectsAndTeamspaces[s.folderId]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:n,projects:i}=t;let o;o=i.find((t=>t.mondayProjectId===e.id))?i.filter((t=>t.mondayProjectId!==e.id)):i.concat({name:e.name,mondayProjectId:e.id,mondayBoardId:e.boardId,collectionType:"projects"}),el.Z.setState({...h,selectedProjectsAndTeamspaces:{...h.selectedProjectsAndTeamspaces,[s.folderId]:{notionTeamspaceId:n,projects:o}}})},checked:{...h.selectedProjectsAndTeamspaces[s.folderId]||{projects:[],notionTeamspaceId:void 0}}.projects.some((t=>t.mondayProjectId===e.id)),size:14,checkSize:8}),(0,c.jsx)("div",{style:{width:240,wordWrap:"break-word"},children:(0,c.jsx)(Me.Z,{isMultiline:!0,children:e.name})})]},`${e.id}-container`)]}))),i=s.taskBoards.map((e=>({key:e.id,columns:[(0,c.jsxs)(jr.gq,{alignItems:"center",gap:6,style:{marginLeft:20},children:[(0,c.jsx)(Ka.Z,{style:{marginRight:2},onClick:()=>{const t={...h.selectedProjectsAndTeamspaces[s.folderId]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:n,projects:i}=t;let o;o=i.find((t=>t.mondayProjectId===e.id))?i.filter((t=>t.mondayProjectId!==e.id)):i.concat({name:e.name,mondayProjectId:e.id,collectionType:"tasks"}),el.Z.setState({...h,selectedProjectsAndTeamspaces:{...h.selectedProjectsAndTeamspaces,[s.folderId]:{notionTeamspaceId:n,projects:o}}})},checked:{...h.selectedProjectsAndTeamspaces[s.folderId]||{projects:[],notionTeamspaceId:void 0}}.projects.some((t=>t.mondayProjectId===e.id)),size:14,checkSize:8}),(0,c.jsx)("div",{style:{width:240,wordWrap:"break-word"},children:(0,c.jsx)(Me.Z,{isMultiline:!0,children:e.name})})]},`${e.id}-container`)]})));return[...n,...i]}({collapsed:d})})]})}function al(e){var t;const{onSelectOption:s,options:i,currentOption:o,placeHolder:a,narrow:l,allowSearch:d}=e,u=(0,g.useIntl)(),[p,m]=(0,n.useState)(""),h=null===(t=i.find((e=>{let{key:t}=e;return t===o})))||void 0===t?void 0:t.label,f=(0,r.yK)((e=>({icon:{width:12,height:12,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,c.jsx)(_o.ZP,{popupType:_o.Z4.Popup,placementToOrigin:_o.pO.Bottom,renderOrigin:e=>(0,c.jsxs)(Xt.Z,{...e,style:{paddingTop:l?2:8,paddingBottom:l?2:8,paddingLeft:8,paddingRight:8,opacity:1,width:250,border:`1px solid ${Ks.FN.light.gray[100]}`,justifyContent:"space-between",marginTop:8,marginBottom:8,background:o?void 0:Ks.FN.light.gray[50],color:o?void 0:Ks.FN.light.gray[300]},disabled:!1,children:[(0,c.jsx)(Me.Z,{style:{textOverflow:"ellipsis"},children:h||a}),(0,yr.i)(f.icon)]}),render:e=>{const t={menuType:Hs.og.Popup,width:250,left:50},n=[{key:"mondayImport.dropdown.menuList",render:e=>(0,c.jsx)(tn.Z,{...e}),items:(p.trim()?i.filter((e=>{var t;return null===(t=e.searchTerm)||void 0===t?void 0:t.toLowerCase().includes(p.toLowerCase())})):i).map((t=>{let{key:n,label:i}=t;return{key:n,action:()=>{s(n),e.close()},render:e=>(0,c.jsx)(Qs.Z,{...e,title:i,shouldWrapCaption:!0,right:h===i?(0,c.jsx)("div",{style:{width:14},children:(0,xr.e)()}):void 0})}}))}];return(0,c.jsxs)(c.Fragment,{children:[d?(0,c.jsx)("input",{style:{width:"100%",borderRadius:0,backgroundColor:Ks.FN.light.gray[200],paddingTop:2,paddingBottom:2,paddingLeft:8,paddingRight:8,opacity:1,border:`1px solid ${Ks.FN.light.gray[100]}`,justifyContent:"space-between",background:Ks.FN.light.gray[50],fontSize:x.Z.fontSize.UIRegular.desktop,textOverflow:"ellipses"},placeholder:u.formatMessage({id:"mondayImport.importsTab.selectData.searchTeamspacePlaceholder",defaultMessage:"Search for a teamspace"}),onChange:e=>m(e.target.value),value:p}):(0,c.jsx)(c.Fragment,{}),(0,c.jsx)($s.Z,{...t,children:(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,sections:n,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})]})}})}const rl=(0,g.defineMessages)({failed:{defaultMessage:"Some problems occurred while importing data from your Monday workspace.",id:"Mondayimport.importingData.failed.problemsOccured"}});function ll(e){return"selectData"===e?(0,c.jsx)(Me.Z,{style:{fontWeight:x.Z.fontWeight.semibold},children:(0,c.jsx)(g.FormattedMessage,{id:"MondayImport.importsTab.selectData.tabTitle",defaultMessage:"Select Monday.com workspace"})}):(0,c.jsx)(c.Fragment,{})}const dl=function(e){let{tab:t,fetchActiveImportTasks:s}=e;const i=L.default.getIntl(),l=(0,o.O7)(),d=(0,a.VK)((()=>Ke.default.state.currentSpaceStore),[]),u=(0,a.VK)((()=>Ke.default.state.currentSpaceViewStore),[]),p=(0,a.VK)((()=>hr.Z.state.teams),[]),m=(0,a.VK)((()=>el.Z.state),[]),h=(0,a.VK)((()=>ze.Z.state),[]).flowId||(0,f.ZP)(),{workspaces:y}=m,S=(0,n.useCallback)((()=>Object.values(m.selectedProjectsAndTeamspaces).some((e=>0!==e.projects.length))),[m.selectedProjectsAndTeamspaces]),v=(0,r.yK)((e=>({closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor}})),[]);return(0,c.jsxs)(pt.ZP,{controlRow:(e=>"selectData"===e?(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)(Ri.Z,{style:{border:0},disabled:!y.length,onClick:()=>{s(),el.Z.resetImport()},children:(0,c.jsx)(g.FormattedMessage,{id:"mondayImport.selectData.backButtonText",defaultMessage:"Back"})}),(0,c.jsx)(jr.gq,{alignItems:"center",gap:8,children:(0,c.jsx)(Sn.Z,{style:{marginLeft:16},disabled:!S()||m.templateCreationInProgress,onClick:()=>{d&&u&&tl.C8({environment:l,spaceStore:d,currentSpaceViewStore:u,teamsStores:p,flowId:h}).catch((()=>{}))},children:m.templateCreationInProgress?(0,c.jsxs)(jr.gq,{alignItems:"center",gap:2,children:[(0,c.jsx)(Pi.Z,{isWhite:!0}),(0,c.jsx)(g.FormattedMessage,{id:"importsTab.selectData.creatingTemplates",defaultMessage:"Creating templates"})]}):(0,c.jsx)(g.FormattedMessage,{id:"importsTab.selectData.nextButtonText",defaultMessage:"Next"})})})]}):"importingData"===e?(0,c.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,c.jsx)(Ri.Z,{disabled:!y.length,onClick:()=>{s(),el.Z.resetImport()},children:(0,c.jsx)(g.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"})})}):"confirm"===e?(0,c.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,c.jsx)(Sn.Z,{onClick:()=>{var e;if(null!==(e=m.result)&&void 0!==e&&e.length&&m.loggerPageId){const e=m.result.find((e=>void 0!==e.projectCollectionPageId));gr.c4({url:(0,lr.Z)({pageId:(null==e?void 0:e.projectCollectionPageId)||m.loggerPageId,pageModel:(0,dr.lA)({table:pr.iU,id:(null==e?void 0:e.projectCollectionPageId)||m.loggerPageId}),baseUrl:Gs.default.domainBaseUrl,pageVisitSource:tr.tY.Import}),environment:l})}el.Z.resetImport(),it.Z.reset()},children:(0,c.jsx)(g.FormattedMessage,{id:"importsTab.confirm.doneText",defaultMessage:"Done"})})}):"failure"===e?(0,c.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,c.jsx)(Ri.Z,{disabled:!y.length,onClick:()=>{s(),el.Z.resetImport()},children:(0,c.jsx)(g.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"})})}):void 0)(t),controlRowPaddingTopBottom:20,children:[(0,c.jsx)("div",{style:{position:"absolute",top:12,right:12},children:(0,c.jsx)(xn.Z,{onClick:()=>{s(),el.Z.resetImport()},style:v.closeButton,hoveredStyle:v.closeButtonHover,children:(0,Oa.D)(v.closeButtonIcon)})}),(0,c.jsx)(Me.Z,{style:{paddingBottom:8,fontSize:18,fontWeight:x.Z.fontWeight.medium,width:"100%"},children:ll(t)}),(e=>"selectData"===e?(0,c.jsx)(il,{}):"importingData"===e?(0,c.jsx)(qr,{assetSrc:rr.Z.images.import.mondayPng}):"confirm"===e?(0,c.jsx)(sl,{}):"failure"===e?(0,c.jsx)(Kr,{assetSrc:rr.Z.images.import.mondayPng,loggerPageId:m.loggerPageId,failedMessage:i.formatMessage(rl.failed)}):void 0)(t)]})};const cl=function(e){let{fetchActiveImportTasks:t}=e;const s=(0,a.VK)((()=>el.Z.state),[]),i=(0,n.useCallback)((()=>{el.Z.resetImport()}),[]),o=(0,n.useCallback)((()=>{const{currentTab:e}=s;return(0,c.jsx)(dl,{fetchActiveImportTasks:t,tab:e})}),[t,s]);return(0,c.jsx)(_n.Z,{open:s.isModalOpen,innerStyle:{width:800,height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:5,maxHeight:675},render:()=>(0,c.jsx)(Fn.Z,{capture:!0,allowEsc:!0,render:()=>(0,c.jsx)(An.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,render:()=>o()})}),onDismiss:i})};var ul=s(85567),pl=s(43876),ml=s(952),gl=s(601);class hl extends E.default{getInitialState(){return{isDragOverActive:!1}}}const fl=new hl,xl=(0,g.defineMessages)({invalidFileFormat:{id:"zipImportOptions.invalidFile",defaultMessage:"Unsupported file format, Please drag and drop a ZIP file"}});const yl=function(e){const t=(0,o.O7)(),s=(0,a.VK)((()=>fl.state.isDragOverActive),[]),n=(0,r.yK)((e=>({buttonStyle:{display:"flex",alignItems:"center",paddingLeft:12,paddingRight:12,paddingTop:2,paddingBottom:2,borderColor:e.outlineButtonBorder,border:1,borderWidth:1,borderRadius:4,height:32,gap:4,background:e.importOptionsButtonBackground},titleStyle:{fontSize:14,fontWeight:"medium",font:"SF Pro",color:e.v2.text.primary,width:183,height:18},divTitleStyle:{color:e.v2.text.secondary,display:"flex",background:s?e.fill.gray:e.fill.lightGray,width:"100%",padding:"16px",justifyContent:"center",alignItems:"center",gap:12,borderRadius:8,border:s?"2px solid":"none",borderColor:s?e.stroke.uiBlueDeemphasized:e.fill.lightGray},divStyle:{display:"flex",alignItems:"center",marginTop:10,minWidth:0,width:"100%",gap:10},UiLabelStyle:{color:e.v2.text.secondary,font:"SF Pro",fontWeight:400,fontSize:14}})),[s]),i=e=>{fl.setState({...fl.state,isDragOverActive:e})};return(0,c.jsx)("div",{onDrop:s=>{s.preventDefault(),i(!1);const n=s.dataTransfer.files[0];(async function(e,t,s,n){var i;if(1!==t.length)return;if("zip"!==(null===(i=t[0].name.split(".").pop())||void 0===i?void 0:i.toLowerCase())){const e=L.default.formatMessage(xl.invalidFileFormat);throw M.showErrorMessage(e),new _.p8("Invalid file format, please upload it as a zip file")}const{mainEditorCurrentBlockStore:o,currentSpaceStore:a,currentSpaceViewStore:r}=Ke.default.state;if(!a||!r||!o)return;const l=Sl();v.ay(e,{import_source:"genericImporter",from:n,import_type:"file",flowId:l});const d=await gl.ro({environment:e,pageStore:o,spaceStore:a,spaceViewStore:r,uploadType:"genericImporter",flowId:Sl()},t);d&&(ml.W(e,{from:"import",type:"page",new_page_id:d.id,creating_block_id:d.id,parent_collection_id:d.getParentCollectionIdUpToTwoLevels()}),s(d))})(t,[n],e.onComplete,e.analyticsFrom).then((()=>{})).catch((()=>{}))},onDragOver:e=>{e.preventDefault(),e.stopPropagation(),i(!0)},onDragLeave:e=>{e.preventDefault(),i(!1)},style:n.divStyle,children:(0,c.jsxs)("div",{style:n.divTitleStyle,children:[(0,c.jsx)(bl,{icon:pl.s}),(0,c.jsx)(Me.Z,{isSecondaryColor:!0,style:n.UiLabelStyle,children:(0,c.jsx)(g.FormattedMessage,{id:"zipImport.dragAndDrop",defaultMessage:"Drag and drop your ZIP files here, or"})}),(0,c.jsx)(xn.Z,{onClick:()=>async function(e,t,s,n){const i=Ke.default.state,{mainEditorCurrentBlockStore:o,currentSpaceStore:a,currentSpaceViewStore:r}=i;if(!a||!r||!o)return;const l=Sl();v.ay(e,{import_source:"genericImporter",from:n,import_type:"file",flowId:l});const d=await gl.Pv({environment:e,pageStore:o,spaceStore:a,spaceViewStore:r,uploadType:t,flowId:l,allowMultiple:!1});d&&(ml.W(e,{from:"import",type:"page",new_page_id:d.id,creating_block_id:d.id,parent_collection_id:d.getParentCollectionIdUpToTwoLevels()}),s(d))}(t,"genericImporter",e.onComplete,e.analyticsFrom),style:n.buttonStyle,children:(0,c.jsx)("div",{style:{minWidth:0,width:"100%"},children:(0,c.jsx)("div",{style:{display:"flex"},children:(0,c.jsx)("div",{style:n.titleStyle,children:(0,c.jsx)(g.FormattedMessage,{id:"zipImport.uploadFile",defaultMessage:"Upload from your computer"})})})})})]})})};function Sl(){return ze.Z.state.flowId||(0,f.ZP)()}const vl=20;function bl(e){let{icon:t}=e;return(0,c.jsx)("div",{children:t({flexShrink:0,width:vl,height:vl,gap:10})})}const Ml=function(e){const t=(0,a.VK)((()=>Ke.default.state),[]),s=(0,a.VK)((()=>it.Z.state),[]),i=(0,a.VK)((()=>ar.Z.state),[]),{currentSpaceStore:l,mainEditorCurrentBlockStore:d,currentSpaceViewStore:u,currentUserSettingsStore:p}=t,m=(0,o.O7)(),{device:f}=(0,o.O7)(),[y,S]=(0,n.useState)([]),v=(0,a.VK)((()=>(0,or.K)()),[]),b=(0,n.useCallback)((async()=>{if(null==l||!l.id)return;const e=await T.getActiveImportTasks(m,{spaceId:l.id});"success"===e.type&&S(e.data)}),[l,m]);(0,n.useEffect)((()=>{b().catch((()=>{}));const e=setInterval(b,6e4);return()=>clearInterval(e)}),[l,m,b]),(0,n.useEffect)((()=>{let e;const t=async n=>{const i=await T.getAsanaWorkspacesNames(m,{});if(n+=1,"success"===i.type)if(null!=i&&i.data.account)ar.Z.setState({...ar.Z.state,account:i.data.account,workspaces:i.data.workspaces,isLoadingAsanaWorkspaces:!1,isAccountLinkingInProgress:!1,currentTab:"selectData",isModalOpen:!0});else{if(n>s)return;e=setTimeout((()=>t(n)),2e3)}},s=180;if(i.isAccountLinkingInProgress){t(0).catch((()=>{}))}return()=>{clearTimeout(e)}}),[i.isAccountLinkingInProgress,m]);const M=(0,r.yK)((e=>({activeImportAndSyncTitle:{fontSize:x.Z.fontSize.UIRegular.mobile,fontWeight:x.Z.fontWeight.medium,lineHeight:x.Z.lineHeight.UIRegular.mobile},arrowDownIcon:{width:11,height:12,gap:10,radius:3,fill:"#ACABA9"},activeImportsStatusTimeDiv:{display:"flex",alignItems:"center",flexDirection:"row",gap:4}})),[]),j=v?(0,c.jsx)(g.FormattedMessage,{id:"importsTab.activeImportsAndSyncs.title",defaultMessage:"Active imports & syncs"}):(0,c.jsx)(g.FormattedMessage,{id:"importsTab.activeImports.title",defaultMessage:"Active Imports"}),C=e=>{ir._c({environment:m,store:e,pageVisitSource:tr.tY.Import}),it.Z.reset()};return l&&u&&u&&p?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(me.Z,{large:!f.isMobile||void 0,divider:f.isMobile?void 0:"full",children:(0,c.jsx)(g.FormattedMessage,{id:"importsTab.title",defaultMessage:"Import data"})}),(0,c.jsx)(Me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"importsTab.subtitle",defaultMessage:"Import data from other apps and files into Notion"})}),(0,c.jsx)(Me.Z,{isSmall:!0,children:e.genericImporterEnabled&&!e.zipImporterEnabled?(0,c.jsx)(g.FormattedMessage,{id:"importsTab.unsupportedImportsHelperTextForUniversalImport",defaultMessage:"If the app you’re using isn’t listed below, try the <boldtext>Universal import</boldtext> ",values:{boldtext:e=>(0,c.jsx)("span",{style:{fontWeight:600},children:e})}}):(0,c.jsx)(g.FormattedMessage,{id:"importsTab.unsupportedImportsHelperText",defaultMessage:"If your data is located somewhere we don't support yet, you can try importing it via CSV file."})}),(0,c.jsxs)("div",{style:{marginTop:16,display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gridAutoRows:"1fr",gap:"4px 16px",width:"100%"},children:[(0,c.jsx)(Xr.Z,{pageStore:d,spaceStore:l,spaceViewStore:u,userSettingsStore:p,analyticsFrom:s.openedFrom??"modal",onComplete:C,readOnlyCreditButton:!1}),(0,c.jsx)(Jr,{fetchActiveImportTasks:b}),(0,c.jsx)(cl,{fetchActiveImportTasks:b})]}),e.zipImporterEnabled?(0,c.jsxs)("div",{style:{marginTop:32,width:"752px",gap:10},children:[(0,c.jsx)(Me.Z,{isSecondaryColor:!0,isMultiline:!0,style:{font:"SF Pro",fontWeight:400,fontSize:14,height:40},children:(0,c.jsx)(g.FormattedMessage,{id:"importsTab.zipImport.title",defaultMessage:"Don’t see the app you use? Import a ZIP file, and Notion will convert DOCX, CSV, Text, Markdown, HTML, EPUB and Latex files into Notion pages"})}),(0,c.jsx)(yl,{onComplete:C,analyticsFrom:s.openedFrom??"modal"})]}):(0,c.jsx)(c.Fragment,{}),(null==y?void 0:y.length)>0?(0,c.jsxs)("div",{style:{marginTop:32},children:[(0,c.jsx)(Me.Z,{isMultiline:!0,style:M.activeImportAndSyncTitle,children:j}),(0,c.jsx)(wr.Z,{tableStyle:{borderTop:0},columns:[{key:"importTime",header:(0,c.jsxs)("div",{style:M.activeImportsStatusTimeDiv,children:[(0,c.jsx)(g.FormattedMessage,{id:"importsTab.activeImports.importTime",defaultMessage:"Time"}),(0,nr.M)(M.arrowDownIcon)]})},{key:"importFrom",header:(0,c.jsx)(g.FormattedMessage,{id:"importsTab.activeImports.importFrom",defaultMessage:"From"})},{key:"importStatus",header:(0,c.jsx)(g.FormattedMessage,{id:"importsTab.activeImports.importStatus",defaultMessage:"Status"})}],rows:y.map((e=>({key:`table-${e.taskId}`,columns:[e.startedAt?`${(0,xo.Yx)(e.startedAt,"long",L.default.getIntl().locale)} ${(0,xo.Yx)(e.startedAt,"time",L.default.getIntl().locale)}`:"",(0,h.kC)(e.source),(0,c.jsx)(ul.Z,{isRound:!0,showRemoveButton:!1,value:(0,c.jsx)(Me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"activeImports.status.inProgress",defaultMessage:"In progress"})}),backgroundColor:Ks.FN.light.blue[200],showColoredDot:"blue",format:sr.lo.Small,isSingle:!0},`progress-${e.taskId}`)]})))}),y.length?(0,c.jsx)(c.Fragment,{}):(0,c.jsx)(Me.Z,{isSmall:!0,style:{marginTop:16},children:(0,c.jsx)(g.FormattedMessage,{id:"importsTab.activeImportsTable.noActiveImports",defaultMessage:"There are no ongoing imports associated with your account."})})]}):(0,c.jsx)(c.Fragment,{})]}):(0,c.jsx)(c.Fragment,{})};var jl=s(24211),Cl=s(79092),wl=s(99472),kl=s(23512);const Tl="US";function Il(e){var t;return(null==e||null===(t=e.getSettingsStore())||void 0===t||null===(t=t.getKeyStore("regional_format_settings"))||void 0===t?void 0:t.getKeyStore("region").getValue())||Tl}function Zl(e,t){var s;const n=null==e||null===(s=e.getKeyStore("settings"))||void 0===s||null===(s=s.getKeyStore("regional_format_settings"))||void 0===s?void 0:s.getValue();return"full_date"===t?null!=n&&n.use_default_region_settings?Pl(Il(e)):(null==n?void 0:n.full_date)||Pl(Il(e)):"short_date"===t?null!=n&&n.use_default_region_settings?{type:"short"}:(null==n?void 0:n.short_date)||{type:"short"}:"number"===t?null!=n&&n.use_default_region_settings?"number":(null==n?void 0:n.number)||"number":"week_start_on"===t?null!=n&&n.use_default_region_settings?"sunday":(null==n?void 0:n.week_start_on)||"sunday":(0,fs.t1)(t)}function Pl(e){return"JP"===e?{type:"short"}:{type:"long"}}const Fl={full_date:(0,g.defineMessages)({full:{defaultMessage:"Full date",id:"regionalFormatSettings.customSettingOption.fullDate.full"},long:{defaultMessage:"Long",id:"regionalFormatSettings.customSettingOption.fullDate.long"},medium:{defaultMessage:"Medium",id:"regionalFormatSettings.customSettingOption.fullDate.medium"},short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.fullDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.fullDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.fullDate.custom"}}),short_date:(0,g.defineMessages)({short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.shortDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.shortDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.shortDate.custom"}}),number:(0,g.defineMessages)({number:{defaultMessage:"Number",id:"regionalFormatSettings.customSettingOption.number.number"},number_with_commas:{defaultMessage:"Number with commas",id:"regionalFormatSettings.customSettingOption.number.withCommas"},percent:{defaultMessage:"Percent",id:"regionalFormatSettings.customSettingOption.number.percent"}}),week_start_on:(0,g.defineMessages)({sunday:{defaultMessage:"Sunday",id:"regionalFormatSettings.customSettingOption.weekStartOn.sunday"},monday:{defaultMessage:"Monday",id:"regionalFormatSettings.customSettingOption.weekStartOn.monday"}})},Al=(0,g.defineMessages)({full_date:{defaultMessage:"Full date",id:"regionalFormatSettings.defaultSetting.fullDate"},short_date:{defaultMessage:"Short date",id:"regionalFormatSettings.defaultSetting.shortDate"},number:{defaultMessage:"Numbers",id:"regionalFormatSettings.defaultSetting.numbers"},week_start_on:{defaultMessage:"Week starts",id:"regionalFormatSettings.defaultSetting.weekStart"}});function _l(e,t){if("full_date"===t){return Fl[t][Zl(e,t).type]}if("short_date"===t){return Fl[t][Zl(e,t).type]}if("number"===t){return Fl[t][Zl(e,t)]}if("week_start_on"===t){return Fl[t][Zl(e,t)]}return(0,fs.t1)(t)}function Rl(e,t){return(0,kl.uf)(1234567,e,t)}const Ol=(0,g.defineMessages)({sunday:{id:"regionalFormatSettings.defaultRegionalSettings.startDayOfWeek.sunday",defaultMessage:"Sunday"},monday:{id:"regionalFormatSettings.defaultRegionalSettings.startDayOfWeek.monday",defaultMessage:"Monday"}});function Bl(e,t){const s=e.type;return"short"===s||"long"===s||"medium"===s?(0,xo.Yx)(Date.now(),s,(0,jl.E2)(t)):"iso"===s?(0,xo.$6)(Date.now()):(0,xo.Yx)(Date.now(),"long",(0,jl.E2)(t))}function Dl(e,t){const s=e.type;return"iso"===s?(0,xo.$6)(Date.now()):"short"===s?(0,xo.Yx)(Date.now(),s,(0,jl.E2)(t)):(0,xo.Yx)(Date.now(),"short",(0,jl.E2)(t))}var Ll=s(31194),Vl=s(68894),Nl=s(42782);const El={full_date:(0,g.defineMessages)({full:{defaultMessage:"Full date",id:"regionalFormatSettings.customSettingOption.fullDate.full"},long:{defaultMessage:"Long",id:"regionalFormatSettings.customSettingOption.fullDate.long"},medium:{defaultMessage:"Medium",id:"regionalFormatSettings.customSettingOption.fullDate.medium"},short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.fullDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.fullDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.fullDate.custom"}}),short_date:(0,g.defineMessages)({short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.shortDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.shortDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.shortDate.custom"}}),number:(0,g.defineMessages)({number:{defaultMessage:"Number",id:"regionalFormatSettings.customSettingOption.number.number"},number_with_commas:{defaultMessage:"Number with commas",id:"regionalFormatSettings.customSettingOption.number.withCommas"},percent:{defaultMessage:"Percent",id:"regionalFormatSettings.customSettingOption.number.percent"}}),week_start_on:(0,g.defineMessages)({sunday:{defaultMessage:"Sunday",id:"regionalFormatSettings.customSettingOption.weekStartOn.sunday"},monday:{defaultMessage:"Monday",id:"regionalFormatSettings.customSettingOption.weekStartOn.monday"}})};function Ul(e){const[,,t]=(0,a.AF)(void 0,ya.Z),s=(0,r.Fg)(),[n,i]=(0,a.VK)((()=>[e.userSettingsStore.isDefined(),_l(e.userSettingsStore,e.option)]),[e.option,e.userSettingsStore]);return n?(0,c.jsx)(_o.ZP,{popupType:_o.Z4.Popup,buttonPopupStore:t,renderOrigin:e=>(0,c.jsxs)(Xt.Z,{...e,children:[L.default.formatMessage(i),(0,yr.i)({width:10,marginLeft:4,fill:s.lightIconColor})]}),placementToOrigin:Ll.Iw.Bottom,alignmentToOrigin:Ll.lU.Start,render:t=>"week_start_on"===e.option||"number"===e.option?(0,c.jsx)(Wl,{userSettingsStore:e.userSettingsStore,option:e.option,onAccept:()=>{t.close()}}):"full_date"===e.option||"short_date"===e.option?(0,c.jsx)(Kl,{userSettingsStore:e.userSettingsStore,option:e.option,onAccept:()=>{t.close()}}):(0,fs.t1)(e.option)}):(0,c.jsx)(Pi.Z,{})}function Wl(e){const t=(0,o.O7)(),s=(0,g.useIntl)();return(0,c.jsx)($s.Z,{menuType:Hs.og.Popup,width:216,children:(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,initialFocus:void 0,sections:[{key:"options",render:e=>(0,c.jsx)(tn.Z,{...e,topBorder:0!==e.index}),items:(0,fs.Yd)(El[e.option]).map((n=>({key:n,render:t=>{const i="number"===e.option?Rl(n,s):void 0;return(0,c.jsx)(Qs.Z,{...t,title:L.default.formatMessage(El[e.option][n]),caption:i})},action:()=>{P.createAndCommit({userAction:"CustomRegionalFormatSettings.SimpleFormatPicker",environment:t,perform:t=>{F.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{...e.userSettingsStore.getRegionalFormatSettings(),use_default_region_settings:!1,region:Il(e.userSettingsStore),[e.option]:n}},transaction:t})}}),e.onAccept()}})))}]})})}function Kl(e){const t=(0,o.O7)(),[s,i]=(0,n.useState)((()=>{})),a=(0,g.useIntl)(),r=(0,fs.Yd)(El[e.option]),l=n=>{const i="custom"===n?{type:n,format:s}:{type:n};P.createAndCommit({userAction:"CustomRegionalFormatSettings.onAction",environment:t,perform:t=>{F.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{...e.userSettingsStore.getRegionalFormatSettings(),use_default_region_settings:!1,region:Il(e.userSettingsStore),[e.option]:i}},transaction:t})}}),e.onAccept()};return(0,c.jsx)($s.Z,{menuType:Hs.og.Popup,width:216,children:(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,initialFocus:void 0,sections:[{key:"options",render:e=>(0,c.jsx)(tn.Z,{...e,topBorder:0!==e.index}),items:r.map((t=>({key:t,render:n=>{if("custom"===t)return(0,c.jsx)(Nl.Z,{...n,renderOrigin:s=>(0,c.jsx)(Qs.Z,{...s,title:L.default.formatMessage(El[e.option][t])}),onFocus:()=>{},renderExtension:()=>(0,c.jsx)(zl,{customFormat:s,onChange:e=>{i(e)},onAccept:()=>{l(t)}}),title:L.default.formatMessage(El[e.option][t])});{const s="full_date"===e.option?Bl({type:t},a):Dl({type:t},a);return(0,c.jsx)(Qs.Z,{...n,title:L.default.formatMessage(El[e.option][t]),caption:s})}},action:()=>{l(t)}})))}]})})}function zl(e){const t=(0,r.yK)((e=>({container:{},label:{color:e.mediumTextColor,fontWeight:x.Z.fontWeight.semibold,paddingTop:6,paddingBottom:6,paddingLeft:14,paddingRight:14},actionButton:{marginTop:6}})),[]);return(0,c.jsxs)("div",{style:t.container,children:[(0,c.jsx)("div",{children:(0,c.jsx)(Me.Z,{isSmall:!0,style:t.label,children:(0,c.jsx)(g.FormattedMessage,{id:"regionalFormatSettings.customDateFormat.title",defaultMessage:"Custom format"})})}),(0,c.jsx)(Vl.ZP,{focus:!0,value:e.customFormat||"",onChange:t=>{e.onChange(t.target.value)}}),(0,c.jsx)(Qs.Z,{style:t.actionButton,focused:!1,onClick:e.onAccept,title:(0,c.jsx)(g.FormattedMessage,{id:"regionalFormatSettings.customDateFormat.applyChanges",defaultMessage:"Apply changes"})})]})}function ql(e){const t=(0,r.yK)((()=>({container:{flex:1,display:"flex",flexDirection:"column"},controlRow:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}})),[]),s=(0,a.VK)((()=>e.userSettingsStore.isReady()),[e.userSettingsStore]),n=(0,a.VK)((()=>e.userSettingsStore.shouldUseDefaultRegionalFormatting()),[e.userSettingsStore]),i=(0,o.O7)();return s?(0,c.jsxs)("div",{style:t.container,children:[(0,c.jsxs)("div",{style:t.controlRow,children:[(0,c.jsxs)("div",{style:t.label,children:[(0,c.jsx)(Me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"regionalFormatSettings.label.title",defaultMessage:"Use regional defaults"})}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:t.subtitle,children:(0,c.jsx)(g.FormattedMessage,{id:"regionalFormatSettings.label.subtitle",defaultMessage:"Automatically apply standard formats of your region"})})]}),(0,c.jsx)(Er.Z,{on:n,onClick:()=>{P.createAndCommit({userAction:"RegionalFormatSettings.RegionalFormatSettings",environment:i,perform:t=>{const s=n?{use_default_region_settings:!1,full_date:void 0,short_date:void 0,time:void 0,number:void 0,week_start_on:void 0}:{use_default_region_settings:!0};F.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{region:Il(e.userSettingsStore),...s}},transaction:t})}})}})]}),(0,c.jsx)("div",{children:n?(0,c.jsx)(Gl,{userSettingsStore:e.userSettingsStore}):(0,c.jsx)($l,{userSettingsStore:e.userSettingsStore})})]}):(0,c.jsx)(Pi.Z,{})}function Gl(e){const t=(0,r.yK)((()=>({container:{marginTop:12}})),[]);return(0,c.jsx)("div",{style:t.container,children:Ql.map((t=>(0,c.jsx)(Hl,{userSettingsStore:e.userSettingsStore,option:t},t)))})}function Hl(e){const t=(0,r.yK)((e=>({container:{display:"flex"},option:{color:e.lightTextColor,fontSize:x.Z.fontSize.UIRegular.desktop,width:100},example:{color:e.mediumTextColor,fontSize:x.Z.fontSize.UIRegular.desktop}})),[]),s=(0,g.useIntl)(),[n,i]=(0,a.VK)((()=>[e.userSettingsStore.isDefined(),Yl(e.userSettingsStore,s,e.option)]),[s,e.option,e.userSettingsStore]);return n?(0,c.jsxs)("div",{style:t.container,children:[(0,c.jsx)("div",{style:t.option,children:L.default.formatMessage(Al[e.option])}),(0,c.jsx)("div",{style:t.example,children:i})]}):(0,c.jsx)(Pi.Z,{})}function Yl(e,t,s){if("full_date"===s){return Bl(Zl(e,s),t)}if("short_date"===s){return Dl(Zl(e,s),t)}if("number"===s){return Rl(Zl(e,s),t)}if("week_start_on"===s){return function(e){return"sunday"===e?L.default.formatMessage(Ol.sunday):"monday"===e?L.default.formatMessage(Ol.monday):(0,fs.t1)(e)}(Zl(e,s))}return(0,fs.t1)(s)}const Ql=["full_date","short_date","number","week_start_on"];function $l(e){return(0,c.jsx)("div",{children:Ql.map((t=>(0,c.jsx)(Jl,{userSettingsStore:e.userSettingsStore,option:t},t)))})}function Jl(e){const t=(0,g.useIntl)(),[s,n,i]=(0,a.VK)((()=>[e.userSettingsStore.isDefined(),Il(e.userSettingsStore),Yl(e.userSettingsStore,t,e.option)]),[t,e.option,e.userSettingsStore]),o=(0,r.yK)(Xl,[]);return s?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(yn.Z,{size:24}),(0,c.jsx)("div",{style:o.container,children:(0,c.jsxs)("div",{style:o.controlRow,children:[(0,c.jsxs)("div",{style:o.label,children:[(0,c.jsx)(Me.Z,{children:L.default.formatMessage(Al[e.option])}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:o.subtitle,children:i})]}),(0,c.jsx)(Ul,{userSettingsStore:e.userSettingsStore,region:n,option:e.option})]})})]}):(0,c.jsx)(Pi.Z,{})}function Xl(){return{container:{flex:1,display:"flex",flexDirection:"column"},controlRow:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}}}var ed=s(80994),td=s(58573);function sd(e){const t=(0,r.yK)((()=>({container:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}})),[]);return(0,c.jsxs)("div",{style:t.container,children:[(0,c.jsxs)("div",{style:t.label,children:[(0,c.jsx)(Me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"regionSettings.region.label",defaultMessage:"Region"})}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:t.subtitle,children:(0,c.jsx)(g.FormattedMessage,{id:"regionSettings.region.subtitle",defaultMessage:"Affects the default formats for dates, numbers, and currencies"})})]}),(0,c.jsx)(nd,{userSettingsStore:e.userSettingsStore,onChange:e.onChange,pickerLabel:e.pickerLabel})]})}function nd(e){const t=(0,r.Fg)(),[,,s]=(0,a.AF)(void 0,ya.Z),i=(0,a.VK)((()=>Il(e.userSettingsStore)),[e.userSettingsStore]),[o,l]=n.useState("");return(0,c.jsx)(_o.ZP,{popupType:_o.Z4.Popup,buttonPopupStore:s,renderOrigin:s=>(0,c.jsxs)(Xt.Z,{...s,children:[e.userSettingsStore?i:e.pickerLabel,(0,yr.i)({width:10,marginLeft:4,fill:t.lightIconColor})]}),placementToOrigin:Ll.Iw.Bottom,alignmentToOrigin:Ll.lU.Start,render:t=>(0,c.jsx)($s.Z,{menuType:Hs.og.Popup,width:216,header:(0,c.jsx)(od,{value:o,onChange:e=>l(e)}),children:(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,initialFocus:void 0,sections:[{key:"regions",render:e=>(0,c.jsx)(tn.Z,{...e,topBorder:0!==e.index}),items:(0,td.ZP)(o,ed.hW,(e=>e.name)).map((s=>({key:s.countryCode,render:e=>(0,c.jsx)(Qs.Z,{...e,title:s.name}),action:()=>{e.onChange(s.countryCode),t.close(),l("")}})))}]})})})}const id=(0,g.defineMessages)({regionSearchPlaceholder:{defaultMessage:"Search for a region...",id:"settings.regionSettings.regionSearch"}});function od(e){return(0,c.jsx)(tn.Z,{isInput:!0,children:(0,c.jsx)(Vl.ZP,{value:e.value,onChange:t=>{e.onChange(t.target.value)},focus:!0,placeholder:L.default.formatMessage(id.regionSearchPlaceholder),focusAfterAnimation:!0})})}var ad=s(758),rd=s(68626),ld=s(77058),dd=s(52629);const cd=function(e){const[t,s]=n.useState([]),[i,l]=n.useState([]),d=(0,o.O7)(),u=(0,a.qz)(void 0,ya.Z),p=(0,r.yK)((e=>({span:{color:e.mediumTextColor},plainButton:{paddingLeft:8,paddingRight:8,marginLeft:-8},icon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]);function m(e){return i.some((t=>t.code===e.code))}(0,n.useEffect)((()=>{const e=d.SpellCheckStore;e&&!(0,ad.x)(e)&&(e.getAvailableLanguages().then(s).catch((e=>{rd.log({level:"error",from:"SpellcheckerLanguagesPicker",type:"getAvailableLanguages",error:(0,dd.Ui)(e)})})),e.getLanguages().then(l).catch((e=>{rd.log({level:"error",from:"SpellcheckerLanguagesPicker",type:"getLanguages",error:(0,dd.Ui)(e)})})))}),[d]),(0,n.useEffect)((()=>{const e=d.SpellCheckStore;if(!e||(0,ad.x)(e))return;const t=i.map((e=>{let{code:t}=e;return t}));e.setLanguages(t)}),[i,d.SpellCheckStore]);const h=i.length>0?i.slice(0,3).map((e=>{let{name:t}=e;return t})).join(", ")+(i.length>3?"…":""):(0,c.jsx)(g.FormattedMessage,{id:"languageRegionSettings.spellchecker.picker.label",defaultMessage:"Select languages"});return(0,c.jsx)(_o.ZP,{popupType:_o.Z4.Popup,buttonPopupStore:u,renderOrigin:e=>(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(Xt.Z,{style:p.plainButton,...e,children:[h,(0,yr.i)(p.icon)]})}),placementToOrigin:Ll.Iw.Bottom,alignmentToOrigin:Ll.lU.Start,render:e=>{const s=[{key:"spellcheckerlanguages",render:e=>(0,c.jsx)(tn.Z,{...e,topBorder:0!==e.index}),items:t.map((e=>{const t={key:e.code,render:t=>function(e){const t=e.language.name||e.language.code;return(0,c.jsx)(Qs.Z,{...e.props,title:(0,c.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,c.jsx)("div",{style:{marginRight:0},children:t})}),shouldWrapCaption:!0,right:m(e.language)?(0,ld.$)({width:12,height:12}):void 0})}({language:e,props:t}),action:()=>{m(e)?l(i.filter((t=>t.code!==e.code))):l([...i,e])}};return t}))}],n={menuType:Hs.og.Popup,width:240};return(0,c.jsx)($s.Z,{className:Ne.hKO,...n,children:(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,initialFocus:void 0,sections:s})})}})};const ud=function(e){const t=(0,o.O7)();return t.device.isElectron&&t.device.isWindows&&!(0,ad.x)(t.SpellCheckStore)?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(yn.Z,{size:24,isHidden:!0}),(0,c.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto"},children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",width:"100%"},children:[(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)(Me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"languageRegionSettings.spellchecker.label",defaultMessage:"Spellchecker languages"})}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"},children:(0,c.jsx)(g.FormattedMessage,{id:"languageSettings.spellcheckerSwitcher.subtitle",defaultMessage:"Change the languages used by the spellchecker."})})]}),(0,c.jsx)(cd,{})]})})]}):null};const pd=function(){return(0,a.VK)((()=>ns.Z.state.online),[])?(0,c.jsx)(gd,{}):(0,c.jsx)(md,{})};function md(){return(0,c.jsx)(pt.ZP,{children:(0,c.jsx)(Me.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Please go online to manage your language and region.",id:"languageSettings.offline.message"})})})}function gd(){const e=(0,a.VK)((()=>Ke.default.state.currentUserSettingsStore),[]),t=(0,a.VK)((()=>{var t;return(null==e||null===(t=e.getSettings())||void 0===t?void 0:t.preferred_locale)||jl.al}),[e]),s=(0,a.VK)((()=>"on"===Ce.default.getGroup("aloha")),[]);return e?(0,c.jsxs)(pt.ZP,{children:[(0,c.jsx)(me.Z,{large:!0,divider:"full",children:(0,c.jsx)(g.FormattedMessage,{id:"languageSettings.languageSection.title",defaultMessage:"Language & region"})}),(0,c.jsx)(wl.Z,{locale:t,userSettingsStore:e}),(0,c.jsx)(ud,{}),(0,c.jsx)(yn.Z,{size:24}),s?(0,c.jsxs)("div",{style:{marginTop:12},children:[(0,c.jsx)(sd,{locale:t,userSettingsStore:e,onChange:e=>{}}),(0,c.jsx)(yn.Z,{size:24}),(0,c.jsx)(me.Z,{large:!0,divider:"full",children:(0,c.jsx)(g.FormattedMessage,{id:"languageSettings.formatsSection.title",defaultMessage:"Formats"})}),(0,c.jsx)(ql,{locale:t,userSettingsStore:e}),(0,c.jsx)(yn.Z,{size:24})]}):(0,c.jsx)(Cl.Z,{})]}):null}var hd=s(15311),fd=s(28187),xd=s(21291),yd=s(51124),Sd=s(97876);function vd(){const{isElectron:e,isElectronMac:t,isMobile:s,desktopAppId:n}=(0,o.Fy)(),i=(0,o.O7)(),r=(0,a.VK)((()=>ns.Z.state.online),[]),l=(0,a.VK)((()=>(0,fd.oI)()),[]),d=(0,a.VK)((()=>{const i=(0,fd.kC)();return function(e){const{isMobile:t,isElectron:s,isElectronMac:n,desktopAppId:i,slackFeatureGateChecks:{showSlackNotificationSetting:o,showNotionActivityNotificationsToSlackSetting:a}}=e,r=!t&&s,l=r&&n&&Boolean(i);return[{key:"notify_mobile",renderSettingsItem:()=>(0,c.jsx)(xd.A,{target:"notify_mobile"})},r?{key:"notify_desktop",renderSettingsItem:()=>(0,c.jsx)(xd.A,{target:"notify_desktop"})}:void 0,l?{key:"desktop_badge",renderSettingsItem:()=>(0,c.jsx)(xd.A,{target:"desktop_badge"})}:void 0,o&&!a?{key:"notify_slack",renderSettingsItem:()=>(0,c.jsx)(Sd.O,{target:"notify_slack"})}:void 0].filter(fs.$K)}({isMobile:s,isElectron:e,isElectronMac:t,desktopAppId:n,slackFeatureGateChecks:{showSlackNotificationSetting:i,showNotionActivityNotificationsToSlackSetting:l}})}),[s,e,t,n,l]),u=(0,a.VK)((()=>function(e){const{showSlackNotificationSetting:t,showNotionActivityNotificationsToSlackSetting:s}=e;if(!t||!s)return[];return[{key:"notify_slack",renderSettingsItem:()=>(0,c.jsx)(Sd.O,{target:"notify_slack"})},{key:"notify_slack_mention",renderSettingsItem:()=>(0,c.jsx)(Sd.O,{target:"notify_slack_mention"})},{key:"notify_slack_all_activity",renderSettingsItem:()=>(0,c.jsx)(Sd.O,{target:"notify_slack_all_activity"})}].filter(fs.$K)}({showSlackNotificationSetting:(0,fd.kC)(),showNotionActivityNotificationsToSlackSetting:l})),[l]),p=(0,a.VK)((()=>{var e;return function(e){const{showNotifyEmailAlwaysSetting:t}=e;return[{key:"notify_email",renderSettingsItem:()=>(0,c.jsx)(xd.A,{target:"notify_email"})},t?{key:"notify_email_always",renderSettingsItem:()=>(0,c.jsx)(xd.A,{target:"notify_email_always"})}:void 0,{key:"notify_email_digest",renderSettingsItem:()=>(0,c.jsx)(xd.A,{target:"notify_email_digest"})},{key:"marketing_emails",renderSettingsItem:()=>(0,c.jsx)(xd.A,{target:"marketing_emails"})}].filter(fs.$K)}({showNotifyEmailAlwaysSetting:(null===(e=Ke.default.state.currentSpaceViewStore)||void 0===e?void 0:e.getNotifyEmail())||!1})}),[]),m=(0,a.VK)((()=>i.WindowSizeStore.state.paddingBottomCSS),[i.WindowSizeStore]);return r?(0,c.jsxs)(pt.ZP,{disableScroller:s,children:[(0,c.jsx)(me.Z,{large:!s,divider:"full",children:(0,c.jsx)(g.FormattedMessage,{id:"notificationSettings.notificationsSection.title",defaultMessage:"My notifications"})}),(0,c.jsx)(yd.O,{items:d}),(0,c.jsx)(yn.Z,{size:48,isHidden:!0}),l?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(me.Z,{large:!s,divider:"full",children:(0,c.jsx)(g.FormattedMessage,{id:"notificationSettings.slackNotificationsSection.title",defaultMessage:"Slack notifications"})}),(0,c.jsx)(yd.O,{items:u}),(0,c.jsx)(yn.Z,{size:48,isHidden:!0})]}):void 0,(0,c.jsx)(me.Z,{large:!s,divider:"full",children:(0,c.jsx)(g.FormattedMessage,{id:"notificationSettings.emailNotificationsSection.title",defaultMessage:"Email notifications"})}),(0,c.jsx)(yd.O,{items:p}),(0,c.jsx)(yn.Z,{size:48,isHidden:!0}),(0,c.jsx)("div",{style:{marginTop:4,marginBottom:s?m:void 0},children:(0,c.jsx)(zi.Z,{title:(0,c.jsx)(g.FormattedMessage,{id:"myNotificationSettings.helpButton.caption",defaultMessage:"Learn about notifications"}),href:(0,Ue.UY)("guides.notificationSettings"),analyticsFrom:"notifications_settings"})})]}):(0,c.jsx)(pt.ZP,{children:(0,c.jsx)(Me.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Please go online to manage your notification settings.",id:"myNotificationsSettings.goOnline.prompt"})})})}var bd=s(5851),Md=s(78730),jd=s(98481),Cd=s(64404),wd=s(1564),kd=function(e){return e[e.Keep=0]="Keep",e[e.Remove=1]="Remove",e}(kd||{});function Td(e){return(0,c.jsx)(_n.Z,{open:e.isOpen,onDismiss:e.onDismiss,render:()=>(0,c.jsx)(Id,{...e})})}function Id(e){const{onDismiss:t,onSave:s,guestCount:i}=e,[o,a]=(0,n.useState)(kd.Keep),l=(0,r.yK)((e=>({container:{width:350,padding:30,borderRadius:5,height:400,alignItems:"center"},title:{fontFamily:x.Z.getCompositeFontFamily(ao.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center"},subtitle:{fontFamily:x.Z.getCompositeFontFamily(ao.SP).sans,fontSize:14,fontWeight:300,lineHeight:"19px",margin:10,textAlign:"center"},radioContainer:{display:"flex",flexDirection:"column"},button:{justifyContent:"space-between",marginTop:10,height:70,borderRadius:5},buttonText:{display:"flex",flexDirection:"column"},optionSubtitle:{whiteSpace:"break-spaces"},actionButtonsContainer:{display:"flex",flexDirection:"column",marginTop:20},cancelButton:{justifyContent:"center",margin:"8px auto 0"}})),[]),d=(0,n.useCallback)((()=>{const e=o===kd.Keep;s(e)}),[s,o]);return(0,c.jsxs)("div",{style:l.container,children:[(0,c.jsx)(Me.Z,{style:l.title,children:(0,c.jsx)(g.FormattedMessage,{id:"disableGuestsConfig.title",defaultMessage:"Disable inviting guests?"})}),(0,c.jsx)(Me.Z,{isSmall:!0,style:l.subtitle,isMultiline:!0,children:(0,fs.$K)(i)?(0,c.jsx)(g.FormattedMessage,{id:"disableGuestsConfig.description",defaultMessage:"Your workspace currently has {guestCount, plural, one {1 guest} other {{guestCount} guests}}. You can choose to:",values:{guestCount:i}}):(0,c.jsx)(g.FormattedMessage,{id:"disableGuestsConfig.description.noGuestCount",defaultMessage:"You are turning off guests in this workspace. You can choose to:"})}),(0,c.jsxs)("div",{style:l.radioContainer,children:[(0,c.jsxs)(Ri.Z,{isLarge:!0,onClick:()=>a(kd.Keep),style:l.button,children:[(0,c.jsx)(co.Z,{isSelected:o===kd.Keep}),(0,c.jsxs)("div",{style:l.buttonText,children:[(0,c.jsx)(Me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"disableGuestsConfig.keepExistingGuests.title",defaultMessage:"Keep existing guests"})}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:l.optionSubtitle,children:(0,c.jsx)(g.FormattedMessage,{id:"disableGuestsConfig.keepExistingGuests.description",defaultMessage:"Guests will still be able to access the pages they've been invited to"})})]})]}),(0,c.jsxs)(Ri.Z,{isLarge:!0,onClick:()=>a(kd.Remove),style:l.button,children:[(0,c.jsx)(co.Z,{isSelected:o===kd.Remove}),(0,c.jsxs)("div",{style:l.buttonText,children:[(0,c.jsx)(Me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"disableGuestsConfig.removeExistingGuests.title",defaultMessage:"Remove existing guests"})}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:l.optionSubtitle,children:(0,c.jsx)(g.FormattedMessage,{id:"disableGuestsConfig.removeExistingGuests.description",defaultMessage:"All guests will be removed from your workspace"})})]})]})]}),(0,c.jsxs)("div",{style:l.actionButtonsContainer,children:[(0,c.jsx)(Sn.Z,{isLarge:!0,onClick:d,children:(0,c.jsx)(g.FormattedMessage,{id:"disableGuestsModal.saveChanges",defaultMessage:"Disable inviting guests"})}),(0,c.jsx)(Xt.Z,{onClick:t,style:l.cancelButton,children:(0,c.jsx)(g.FormattedMessage,{id:"disableGuestsModal.cancel",defaultMessage:"Cancel"})})]})]})}var Zd=s(64768);const Pd=.5;const Fd=function(e){let{securitySettingsStore:t,spaceStore:s}=e;return(0,a.VK)((()=>ns.Z.state.online),[])?(0,c.jsx)(pt.ZP,{children:(0,c.jsx)(Qd,{securitySettingsStore:t,spaceStore:s})}):(0,c.jsx)(Ad,{})};function Ad(){return(0,c.jsx)(pt.ZP,{children:(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Please go online to manage security settings.",id:"securitySAMLSettings.offline.message"})})})}function _d(e,t,s,n){bd.y(n,{spaceStore:s,securitySettingsStore:t,fields:e})}function Rd(e){return{fontWeight:x.Z.fontWeight.medium,fontSize:18,borderBottom:`1px solid ${e.regularDividerColor}`,paddingBottom:6,marginBottom:12,display:"flex",alignItems:"center"}}function Od(){const e=(0,r.Fg)(),t=(0,o.O7)(),s=(0,a.VK)((()=>(0,jd.J)({environment:t})),[t]),n=(0,a.VK)((()=>(0,Ot.Rs)()),[]);return s?null:(0,c.jsxs)("div",{style:{border:`1px solid ${e.regularDividerColor}`,borderRadius:4,padding:16,marginTop:void 0,marginBottom:24},children:[!n&&(0,c.jsx)(wd.Z,{subscriptionTier:"business",from:"space_saml",upgradeMessage:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.upsell.button.business",defaultMessage:"Upgrade to Business"}),title:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.upsell.title.business",defaultMessage:"Upgrade for SAML SSO & more admin tools"}),caption:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.upsell.caption.business",defaultMessage:"The Business Plan includes single sign-on to manage employee access at scale, private teamspaces to collaborate on sensitive docs, and more."}),learnMoreRoute:"guides.securitySettings",style:{marginBottom:"20px"}}),(0,c.jsx)(wd.Z,{subscriptionTier:"enterprise",from:"space_saml",upgradeMessage:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.upsell.button.enterprise",defaultMessage:"Upgrade to Enterprise"}),title:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.upsell.title.enterprise",defaultMessage:"Upgrade for SCIM, advanced security & more"}),caption:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.upsell.caption.enterprise",defaultMessage:"The Enterprise Plan allows you to automatically provision users and groups, and gain more visibility and controls across the workspace."}),learnMoreRoute:"guides.securitySettings"})]})}function Bd(e,t){const{subscriptionTier:s="enterprise"}=t||{};Es.y(e,{from:"space_saml",for:s})}async function Dd(e,t,s){const n=e.state.disableGuests,i=e.state.enableGuestInviteRequests;if(n)_d({disableGuests:!n,...i&&{enableGuestInviteRequests:!i}},e,t,s);else{if(Ce.default.checkGate("show_keep_existing_guests_modal"))return void e.setState({...e.state,disableGuestsModalOpen:!0});if(!(await M.confirmUserAction({message:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.disableGuests.confirmationModal.message",defaultMessage:"Are you sure? All guests in this workspace will be removed."}),acceptLabel:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.disableGuests.confirmationModal.confirmButton.label",defaultMessage:"Yes"})})))return;_d({disableGuests:!n},e,t,s)}}function Ld(e,t,s,n){const{name:i,isToggleEnabled:o,showUpgradeIfDisabled:a}=e;if(!o)return a?Bd(n):void 0;_d({[i]:!t.state[i]},t,s,n)}function Vd(e){let{style:t,subscriptionTier:s="enterprise"}=e;const n=(0,o.O7)();return(0,c.jsx)(Bi.Z,{subscriptionTier:s,analyticsName:"space_saml",onClick:()=>Bd(n,{subscriptionTier:s}),desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3,...t}})}function Nd(e){let{requestTogglesAvailableForTier:t,spaceStore:s,securitySettingsStore:n}=e;const i=(0,o.O7)(),r=(0,a.VK)((()=>(0,Md.U)(s,i)),[s,i]),l=(0,a.VK)((()=>(0,je.Or)()),[]),d=(0,a.VK)((()=>t&&!Boolean(n.state.disableMembershipRequests)),[t,n]),u=(0,a.VK)((()=>t&&!Boolean(n.state.disableExternalMembershipRequests)),[t,n]),p=(0,a.VK)((()=>t&&!Boolean(n.state.disableGuestMembershipRequests)),[t,n]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Zd.dy,{environment:i,toggleOn:d,onClick:()=>Ld({name:"disableMembershipRequests",isToggleEnabled:t,showUpgradeIfDisabled:!1},n,s,i),isReadOnly:!1,upsellOrigin:"space_saml",style:{marginBottom:24},shouldShowUpsell:!t}),l&&(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(Zd.ms,{environment:i,toggleOn:u,onClick:()=>Ld({name:"disableExternalMembershipRequests",isToggleEnabled:t,showUpgradeIfDisabled:!1},n,s,i),isReadOnly:!1,upsellOrigin:"space_saml",style:{marginBottom:24},shouldShowUpsell:!t})}),r&&(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(Zd.Xr,{environment:i,toggleOn:p,onClick:()=>Ld({name:"disableGuestMembershipRequests",isToggleEnabled:t,showUpgradeIfDisabled:!1},n,s,i),isReadOnly:!1,upsellOrigin:"space_saml",style:{marginBottom:24},shouldShowUpsell:!t})})]})}function Ed(e){let{toggleAvailableForTier:t,guestCount:s,securitySettingsStore:n,spaceStore:i,publicAccessRequestsExpEnabled:r}=e;const l=(0,o.O7)(),d=(0,a.VK)((()=>n.state),[n]),u=(0,a.VK)((()=>!t||r&&!n.state.disablePublicAccessRequests),[t,n,r]),p=(0,a.VK)((()=>t?u?()=>{}:()=>Dd(n,i,l):()=>Bd(l)),[l,t,n,i,u]);return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.guestsSection.disableGuests.label",defaultMessage:"Disable members inviting guests to pages"}),!t&&(0,c.jsx)(Vd,{}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.guestsSection.disableGuests.caption",defaultMessage:"Your workspace currently has <gueststablink> {guestCount, plural, one {1 guest} other {{guestCount} guests}}</gueststablink>",values:{gueststablink:e=>(0,c.jsx)(vn.Z,{onClick:()=>{ii.jk(l,{source_tab:it.Z.state.currentTab,destination_tab:"members",destination_subtab:Cd.Q.Guests}),it.Z.setState({...it.Z.state,currentTab:"members",defaultSubtab:Cd.Q.Guests})},children:e}),guestCount:s}})})]}),(0,c.jsx)("div",{onClick:p,style:{marginTop:5,opacity:u?Pd:void 0},children:(0,c.jsx)(Er.Z,{on:d.disableGuests,disabled:u})})]}),(0,c.jsx)(yn.Z,{size:24,style:{opacity:0}}),(0,c.jsx)(Td,{isOpen:Boolean(d.disableGuestsModalOpen),onDismiss:()=>{n.setState({...n.state,disableGuestsModalOpen:!1})},onSave:e=>{_d({disableGuests:!0,keepExistingGuests:e},n,i,l),n.setState({...n.state,disableGuestsModalOpen:!1})},guestCount:s})]})}function Ud(e){let{toggleAvailableForTier:t,securitySettingsStore:s,spaceStore:n,publicAccessRequestsExpEnabled:i}=e;const r=(0,o.O7)(),l=(0,a.VK)((()=>!t||!s.state.disableGuests||i&&!s.state.disablePublicAccessRequests),[s,t,i]),d=(0,a.VK)((()=>t&&l?()=>{}:()=>Ld({name:"enableGuestInviteRequests",isToggleEnabled:t,showUpgradeIfDisabled:!0},s,n,r)),[r,t,s,n,l]),u=(0,a.VK)((()=>(0,je.p1)()),[]),p=(0,a.VK)((()=>!t||s.state.disableGuests),[s,t]);return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.guestsSection.enableGuestInviteRequests.label",defaultMessage:"Allow members to request adding guests"}),t&&(0,c.jsx)(zi.Z,{style:{marginLeft:0},href:(0,Ue.UY)("guides.guestRequests"),analyticsFrom:"space_saml"}),!t&&(0,c.jsx)(Vd,{style:{marginTop:0}})]}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.guestsSection.enableGuestInviteRequests.caption",defaultMessage:"{hasRequestTab, select, true {Requests must be approved by a workspace owner. You can view all requests <requeststablink>here</requeststablink>} other {Requests must be approved by a workspace owner}}",values:{hasRequestTab:u,requeststablink:e=>(0,c.jsx)(vn.Z,{onClick:()=>{ii.jk(r,{source_tab:it.Z.state.currentTab,destination_tab:"members",destination_subtab:Cd.Q.Requests}),it.Z.setState({...it.Z.state,currentTab:"members",defaultSubtab:Cd.Q.Requests})},children:e})}})})]}),(0,c.jsx)(be.ZP,{render:e=>(0,c.jsx)("div",{onClick:d,style:{marginTop:5,opacity:l?Pd:void 0},...e,children:(0,c.jsx)(Er.Z,{on:s.state.enableGuestInviteRequests,disabled:l})}),renderTooltip:()=>(0,c.jsx)("div",{style:{},children:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.guestsSection.enableGuestInviteRequests.disabled.label",defaultMessage:"Disable inviting guests to use this feature"})}),disableTooltip:p,placement:be.ug.Top})]}),(0,c.jsx)(yn.Z,{size:24,style:{opacity:0}})]})}function Wd(e){let{disableGuestsAvailableForTier:t,enableGuestInviteRequestAvailableForTier:s,enableExternalAccessRequestSettingForTier:n,securitySettingsStore:i,spaceStore:o}=e;const r=(0,a.VK)((()=>Bt.subscriptionDataStoreInstance.state),[]),l=(0,a.VK)((()=>(0,je.p1)()),[]),d=(0,a.VK)((()=>Ce.default.checkGate("allow_public_page_access_request",!0)),[]);if(!r)return(0,c.jsx)(Pi.Z,{});const u=Rt.CM(r).filter(As.du).filter((e=>!e.isTeamGuest&&e.isPageGuest)).length;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(me.Z,{large:!0,divider:"full",children:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.guestsSection.title",defaultMessage:"Inviting members & guests"})}),(0,c.jsx)(Yd,{spaceStore:o,securitySettingsStore:i,toggleAvailableForTier:n,publicAccessRequestsExpEnabled:d}),(0,c.jsx)(Ed,{securitySettingsStore:i,spaceStore:o,toggleAvailableForTier:t,guestCount:u,publicAccessRequestsExpEnabled:d}),(0,c.jsx)(Ud,{securitySettingsStore:i,spaceStore:o,toggleAvailableForTier:s,publicAccessRequestsExpEnabled:d}),(0,c.jsx)(Nd,{spaceStore:o,securitySettingsStore:i,requestTogglesAvailableForTier:l})]})}function Kd(e){let{enable:t,featureUpsellButton:s,securitySettingsStore:n,spaceStore:i}=e;const r=(0,o.O7)(),l=(0,a.VK)((()=>n.state.disablePublicAccess),[n]);return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:t?()=>async function(e,t,s){const n=e.state.disablePublicAccess;if(!n&&!(await M.confirmUserAction({message:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.message",defaultMessage:"Are you sure? This will remove access for anyone who is not a member or guest of the workspace from all pages in this workspace."}),acceptLabel:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.confirmButton.label",defaultMessage:"Yes"})})))return;_d({disablePublicAccess:!n},e,t,s)}(n,i,r):()=>Bd(r),children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.preventPublicSharing.label",defaultMessage:"Disable public page sharing"}),!t&&s,(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.preventPublicSharing.caption",defaultMessage:"Disable the Share to web option in the Share menu on every page in this workspace."})})]}),(0,c.jsx)("div",{style:{marginTop:5,opacity:t?void 0:Pd},children:(0,c.jsx)(Er.Z,{on:l,disabled:!t})})]}),(0,c.jsx)(yn.Z,{size:24,style:{opacity:0}})]})}function zd(e){let{enable:t,featureUpsellButton:s,securitySettingsStore:n,spaceStore:i}=e;const r=(0,o.O7)(),l=(0,a.VK)((()=>n.state.disableSpacePageEdits),[n]);return(0,a.VK)((()=>(0,We.bq)()),[])?null:(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>Ld({name:"disableSpacePageEdits",isToggleEnabled:t,showUpgradeIfDisabled:!0},n,i,r),children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.label",defaultMessage:"Prevent members from editing the Workspace section"}),!t&&s,(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"85%"},children:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.caption",defaultMessage:"Disable the ability for members to create, move, reorder, and delete top-level Workspace pages."})})]}),(0,c.jsx)("div",{style:{marginTop:5,opacity:t?void 0:Pd},children:(0,c.jsx)(Er.Z,{on:l,disabled:!t})})]}),(0,c.jsx)(yn.Z,{size:24,style:{opacity:0}})]})}function qd(e){let{enable:t,featureUpsellButton:s,securitySettingsStore:n,spaceStore:i}=e;const r=(0,o.O7)(),{disableGuests:l,disableGuestsModalOpen:d}=(0,a.VK)((()=>n.state),[n]);return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:t?()=>Dd(n,i,r):()=>Bd(r),children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableGuests.label",defaultMessage:"Disable guests"}),!t&&s,(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableGuests.caption",defaultMessage:"Prevent anyone from inviting people outside the workspace to pages."})})]}),(0,c.jsx)("div",{style:{marginTop:5,opacity:t?void 0:Pd},children:(0,c.jsx)(Er.Z,{on:l,disabled:!t})})]}),(0,c.jsx)(yn.Z,{size:24,style:{opacity:0}}),(0,c.jsx)(Td,{isOpen:Boolean(d),onDismiss:()=>{n.setState({...n.state,disableGuestsModalOpen:!1})},onSave:e=>{_d({disableGuests:!0,keepExistingGuests:e},n,i,r),n.setState({...n.state,disableGuestsModalOpen:!1})},guestCount:void 0})]})}function Gd(e){let{enable:t,spaceStore:s,securitySettingsStore:n,featureUpsellButton:i}=e;const r=(0,o.O7)(),l=(0,a.VK)((()=>n.state.disableMoveToSpace),[n]);return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>Ld({name:"disableMoveToSpace",isToggleEnabled:t,showUpgradeIfDisabled:!0},n,s,r),children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableMovingPages.label",defaultMessage:"Disable duplicating pages to other workspaces"}),!t&&i,(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableMovingPages.caption",defaultMessage:"Prevent anyone from duplicating pages to other workspaces via the Move To or Duplicate To actions."})})]}),(0,c.jsx)("div",{style:{marginTop:5,opacity:t?void 0:Pd},children:(0,c.jsx)(Er.Z,{on:l,disabled:!t})})]}),(0,c.jsx)(yn.Z,{size:24,style:{opacity:0}})]})}function Hd(e){let{enable:t,securitySettingsStore:s,spaceStore:n,featureUpsellButton:i}=e;const r=(0,o.O7)(),l=(0,a.VK)((()=>s.state.disableExport),[s]);return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>Ld({name:"disableExport",isToggleEnabled:t,showUpgradeIfDisabled:!0},s,n,r),children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableExport.label",defaultMessage:"Disable export"}),!t&&i,(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableExport.caption",defaultMessage:"Prevent anyone from exporting as Markdown, CSV, or PDF."})})]}),(0,c.jsx)("div",{style:{marginTop:5,opacity:t?void 0:Pd},children:(0,c.jsx)(Er.Z,{on:l,disabled:!t})})]}),(0,c.jsx)(yn.Z,{size:24,style:{opacity:0}})]})}function Yd(e){let{securitySettingsStore:t,spaceStore:s,publicAccessRequestsExpEnabled:n,toggleAvailableForTier:i}=e;const r=(0,o.O7)(),l=(0,a.VK)((()=>t.state.disablePublicAccessRequests),[t]),d=(0,a.VK)((()=>{if(!i)return()=>Bd(r,{subscriptionTier:"plus"});const e=!t.state.disablePublicAccessRequests,n=!e;return()=>_d({disablePublicAccessRequests:e,...n&&{disableGuests:!1,enableGuestInviteRequests:!1}},t,s,r)}),[r,s,t,i]);return n?(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:d,children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.disablePublicAccessRequests.label",defaultMessage:"Allow page access requests from non-members"}),!i&&(0,c.jsx)(Vd,{subscriptionTier:"plus"}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.disablePublicAccessRequests.caption",defaultMessage:"This allows anyone with the link to a page to request access. Workspace members can always request access."})})]}),(0,c.jsx)("div",{style:{marginTop:5,opacity:i?void 0:Pd},children:(0,c.jsx)(Er.Z,{on:!l,disabled:!i})})]}),(0,c.jsx)(yn.Z,{size:24,style:{opacity:0}})]}):null}function Qd(e){let{securitySettingsStore:t,spaceStore:s}=e;const i=(0,r.Fg)(),l=(0,o.O7)(),d=(0,a.VK)((()=>(0,je.wd)()),[]),u=(0,a.VK)((()=>(0,jd.J)({environment:l})),[l]),p=(0,a.VK)((()=>t.state),[t]),m=(0,a.VK)((()=>(0,Ot.wP)()),[]),h=(0,a.VK)((()=>(0,Ot.mq)()),[]),f=(0,c.jsx)(Vd,{});return u?(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(me.Z,{large:!0,divider:"full",children:d?(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.generalSection.title",defaultMessage:"General"}):(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.title",defaultMessage:"Security"})}),(0,c.jsx)(Kd,{enable:!0,spaceStore:s,securitySettingsStore:t,featureUpsellButton:f}),(0,c.jsx)(zd,{enable:!0,spaceStore:s,securitySettingsStore:t,featureUpsellButton:f}),!d&&(0,c.jsx)(qd,{enable:!0,spaceStore:s,securitySettingsStore:t,featureUpsellButton:f}),(0,c.jsx)(Gd,{enable:!0,spaceStore:s,securitySettingsStore:t,featureUpsellButton:f}),(0,c.jsx)(Hd,{enable:!0,spaceStore:s,securitySettingsStore:t,featureUpsellButton:f}),d&&(0,c.jsx)(Wd,{securitySettingsStore:t,spaceStore:s,disableGuestsAvailableForTier:!0,enableGuestInviteRequestAvailableForTier:m,enableExternalAccessRequestSettingForTier:h}),(0,c.jsx)("div",{style:{height:36}})]}):(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(Od,{}),(0,c.jsx)("div",{style:Rd(i),children:(0,c.jsx)("span",{style:{marginRight:8},children:d?(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.generalSection.title",defaultMessage:"General"}):(0,c.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.title",defaultMessage:"Security"})})}),(0,c.jsx)(Kd,{enable:p.disablePublicAccess,spaceStore:s,securitySettingsStore:t,featureUpsellButton:f}),(0,c.jsx)(zd,{enable:p.disableSpacePageEdits,spaceStore:s,securitySettingsStore:t,featureUpsellButton:f}),!d&&(0,c.jsx)(qd,{enable:p.disableGuests,spaceStore:s,securitySettingsStore:t,featureUpsellButton:f}),(0,c.jsx)(Gd,{enable:p.disableMoveToSpace,spaceStore:s,securitySettingsStore:t,featureUpsellButton:f}),(0,c.jsx)(Hd,{enable:p.disableExport,spaceStore:s,securitySettingsStore:t,featureUpsellButton:f}),d&&(0,c.jsx)(Wd,{securitySettingsStore:t,spaceStore:s,disableGuestsAvailableForTier:p.disableGuests,enableGuestInviteRequestAvailableForTier:p.enableGuestInviteRequests,enableExternalAccessRequestSettingForTier:h}),(0,c.jsx)("div",{style:{height:32}})]})}var $d=s(58047);const Jd={whiteSpace:"normal",paddingTop:5,paddingBottom:5,height:"auto"};function Xd(e){const t=(0,o.O7)(),{onView:s}=e;return(0,n.useEffect)((()=>{s(t)}),[t,s]),(0,c.jsxs)("div",{children:[(0,c.jsx)(yn.Z,{size:0}),(0,c.jsx)($d.N,{icon:e.icon,title:e.title,description:e.descriptionMessage,onDismiss:e.onDismiss,primaryAction:{text:e.buttonText,onClick:t=>(e.onDismiss(),e.onClick(t))},secondaryAction:{icon:e=>(0,Hn.m)(e),text:(0,c.jsx)(g.FormattedMessage,{id:"settingsPrompt.learnMore.button",defaultMessage:"Learn more"}),onClick:e.onClickLearnMore},customPrimaryButtonStyles:Jd})]})}const ec=function(e){const t=(0,r.yK)((t=>({style:{display:"flex",height:"100%",flexDirection:e.isReversed?"row-reverse":"row"},sidebarStyle:{height:"100%",background:t.cardSidebarBackground,flexGrow:0,flexShrink:0,width:240,overflowY:"auto"},childrenStyle:{flexGrow:1,position:"relative",zIndex:1,height:"100%"}})),[e]);return(0,c.jsxs)("div",{style:t.style,onMouseDown:e.onMouseDown,onClick:e.onClick,onDoubleClick:e.onDoubleClick,onContextMenu:e.onContextMenu,children:[(0,c.jsx)("div",{style:t.sidebarStyle,children:e.sidebar}),(0,c.jsx)("div",{style:t.childrenStyle,children:e.children})]})};var tc=s(24697),sc=s(83726),nc=s(4023),ic=s(93502),oc=s(31303),ac=s(35238),rc=s(42485),lc=s(89426),dc=s(88149),cc=s(65552);const uc={[$e.x.Overview]:(0,c.jsx)(g.FormattedMessage,{id:"workspaceAnalyticsTabs.overview.title",defaultMessage:"Overview"}),[$e.x.Users]:(0,c.jsx)(g.FormattedMessage,{id:"workspaceAnalyticsTabs.members.title",defaultMessage:"Members"}),[$e.x.Content]:(0,c.jsx)(g.FormattedMessage,{id:"workspaceAnalyticsTabs.content.title",defaultMessage:"Content"}),[$e.x.Search]:(0,c.jsx)(g.FormattedMessage,{id:"workspaceAnalyticsTabs.search.title",defaultMessage:"Search"})};function pc(e){const{currentTab:t,spaceAnalyticsStore:s,onUserTabFilterChange:n,spaceStore:i}=e;switch(t){case $e.x.Content:return(0,c.jsx)(ac.Z,{spaceStore:i,contentEngagement:e.contentEngagementData});case $e.x.Users:return(0,c.jsx)(cc.Z,{spaceStore:i,usersTabData:s.usersTabData,onUserTabFilterChange:n,userEngagement:e.userEngagementData});case $e.x.Overview:return(0,c.jsx)(lc.Z,{contentEngagement:e.contentEngagementData,userEngagement:e.userEngagementData,spaceStore:i,onUserTabFilterChange:n});case $e.x.Search:return(0,c.jsx)(dc.Z,{spaceStore:i});default:(0,fs.t1)(t)}}const mc=function(e){let{spaceStore:t}=e;const s=(0,r.yK)((e=>({headingStyle:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:x.Z.fontWeight.medium,display:"flex",justifyContent:"space-between"},title:{display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},tabsStyle:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14}})),[]),i=(0,o.O7)(),l=(0,a.VK)((()=>{var e;return null===(e=Ke.default.state.currentUserStore)||void 0===e?void 0:e.id}),[]),d=(0,ic.U)({spaceId:t.id}),u=(0,oc.i)({spaceStore:t,userId:l}),[p,m]=(0,a.AF)($e.Z),h=(0,a.VK)((()=>Boolean(null==t?void 0:t.getSettings().disable_page_analytics)),[t]),f=(0,a.VK)((()=>null==t?void 0:t.getName()),[t]),y=(0,n.useCallback)((async e=>{await sc.Pr({environment:i,spaceStore:t,currentTab:p.currentTab,currentSpaceId:p.currentSpaceId,usersTabData:p.usersTabData,setState:m,graphFilter:e.graphFilter,tableFilter:e.tableFilter})}),[i,t,p,m]),S=(0,n.useCallback)((e=>{tc.nK(i,{tab:e}),m({...p,currentTab:e})}),[m,p,i]),v=(0,a.VK)((()=>{const e=[];return function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push($e.x.Overview),function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push($e.x.Users),e.push($e.x.Content),function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push($e.x.Search),e}),[t]),b=(0,a.VK)((()=>v.length>1),[v]),M=p.currentTab||v[0];(0,n.useEffect)((()=>{!async function(){const e=t.id;e&&$e.Z.shouldRefreshState(e)&&(M===$e.x.Users?await y({graphFilter:"last_90_days",tableFilter:"last_90_days"}):M===$e.x.Content||M===$e.x.Overview||M===$e.x.Search||(0,fs.t1)(M))}()}));const j=(0,n.useCallback)((()=>{C.D({environment:i,url:(0,Ue.UY)("guides.workspaceAnalytics")})}),[i]),w=v.map((e=>uc[e])),k=h?(0,c.jsx)(rc.y,{type:"disabled",spaceName:f}):(0,c.jsxs)(c.Fragment,{children:[b&&(0,c.jsx)(Mn.Z,{tabs:w,selectedIndex:v.indexOf(M),onChange:e=>{S(v[e])},style:s.tabsStyle}),pc({currentTab:M,spaceAnalyticsStore:p,onUserTabFilterChange:y,spaceStore:t,contentEngagementData:d,userEngagementData:u})]});return(0,c.jsxs)(pt.ZP,{children:[(0,c.jsxs)(me.Z,{large:!0,style:s.headingStyle,children:[(0,c.jsxs)("div",{style:s.title,children:[(0,c.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.title",defaultMessage:"Workspace analytics"}),(0,c.jsx)(be.ZP,{placement:nc.u.Right,render:e=>(0,c.jsx)(zi.Z,{...e,href:(0,Ue.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:s.helpInfo}),renderTooltip:()=>(0,c.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.dataDisclaimerTooltip",defaultMessage:"Data available from the start date of your Enterprise Plan"})})]}),(0,c.jsx)(Ri.Z,{isSmall:!0,onClick:j,icon:Hn.m,children:(0,c.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.title.helpButton",defaultMessage:"Learn more"})})]}),(0,pt.Um)(),k]})};var gc=s(72933),hc=s(36610),fc=s(86080);function xc(e){var t;return!(null===(t=Ke.default.state.currentSpaceStore)||void 0===t||!t.canAdmin())&&(0,Rt.qb)(e,"enterprise")}var yc=s(97978),Sc=s(64251),vc=s(33293),bc=s(52790),Mc=s(13630);const jc=function(e){let{handleExportClick:t}=e;const s=(0,a.VK)((()=>Ke.default.state),[]),{currentSpaceStore:i}=s,r=(0,a.VK)((()=>Mc.Z.state),[]),l=(0,o.O7)();return(0,n.useEffect)((()=>{ca.zh({environment:l,spaceId:null==i?void 0:i.id})}),[null==i?void 0:i.id,l]),(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.title",defaultMessage:"Export content"})}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,c.jsx)(Ri.Z,{disabled:!!r.count,isLarge:!0,onClick:t,children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.exportButton.label",defaultMessage:"Export all workspace content"})}),r.count?(0,c.jsxs)(jr.gq,{gap:4,children:[(0,c.jsx)(Pi.Z,{}),(0,c.jsx)(Me.Z,{isSmall:!0,children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.exportInProgress",defaultMessage:"Export in progress"})})]}):(0,c.jsx)(c.Fragment,{})]}),(0,c.jsx)("div",{style:{height:12}}),(0,c.jsx)(zi.Z,{title:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.helpButton.caption",defaultMessage:"Learn about exporting workspaces."}),href:(0,Ue.UY)("guides.exportWorkspace"),analyticsFrom:"space_settings"}),(0,pt.Um)()]})};var Cc=s(44071),wc=s(12457);const kc=(0,g.defineMessages)({workspaceDomainInputPlaceholder:{id:"spaceBasicSettingsDomain.domainSection.workspaceDomainInput.placeholder",defaultMessage:"Your domain"},copyDomainTooltip:{id:"spaceBasicSettingsDomain.workspaceDomain.tooltip",defaultMessage:"Click to copy link"}});function Tc(e,t){const s=t=>(0,c.jsx)(be.ZP,{delayThreshold:0,renderTooltip:()=>L.default.formatMessage(kc.copyDomainTooltip),render:s=>(0,c.jsx)(vn.Z,{onClick:()=>{ye.RD({environment:e,stringValue:t,copiedMessage:ye.tq.copiedLinkToClipboard})},...s,children:t})});return(0,c.jsxs)("div",{style:{paddingTop:8},children:[(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.domainSection.workspaceDomainInput.viewPublicPage.caption",defaultMessage:"Pages shared to web will be under {linkText}.",values:{linkText:s(`${t}.${Gs.default.publicDomainName}`)}}),(0,c.jsx)("div",{style:{paddingTop:6}}),(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.domainSection.workspaceDomainInput.joinWorkspace.caption",defaultMessage:"Anyone with an allowed email domain can join this workspace via {linkText}.",values:{linkText:s(`${window.location.host}/${t}`)}})]})}function Ic(){const e=(0,r.Fg)();return(0,c.jsxs)("div",{style:{color:e.invoiceGreen,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"},children:[(0,Pr.r)({height:16,width:16,margin:"0 4px 0 8px",color:e.invoiceGreen}),(0,c.jsx)("span",{children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Available",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.available"})})]})}function Zc(){return(0,c.jsxs)("div",{style:{color:Ks.ZP.red,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"},children:[(0,ro.t)({height:16,width:16,margin:"0 4px 0 8px"}),(0,c.jsx)("span",{children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Used",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.used"})})]})}function Pc(){return(0,c.jsxs)("div",{style:{color:Ks.ZP.red,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"},children:[(0,ro.t)({height:16,width:16,margin:"0 4px 0 8px"}),(0,c.jsx)("span",{children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Not allowed",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.notAllowed"})})]})}const Fc=function(e){const[t,s]=(0,a.AF)(e.spaceBasicSettingsStore),{domain:i,domainState:l}=t,d=(0,o.O7)(),u=(0,r.Fg)(),[p,m]=(0,n.useState)(!0),h=n.createRef();return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.domainSection.title",defaultMessage:"Domain"})}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsx)("div",{style:{background:u.inputBackground,borderRadius:4,boxShadow:"rgb(15 15 15 / 10%) 0px 0px 0px 1px inset",display:"flex"},children:(0,c.jsx)(dn.Z,{type:"text",style:{background:"none",boxShadow:"none",padding:"4px 6px",width:255},ref:h,value:i,placeholder:L.default.formatMessage(kc.workspaceDomainInputPlaceholder),readOnly:!e.canAdminSpaceStore,onChange:e.handleSpaceUrlChange,onFocus:e=>{m(!1),e.target.select()}})}),p&&e.domainIsAutogenerated&&(0,c.jsx)("div",{style:{color:Ks.ZP.blue,fontSize:x.Z.fontSize.UIRegular.desktop,fontWeight:500,textAlign:"right",padding:"4px 6px",whiteSpace:"nowrap"},onClick:()=>{var e;null===(e=h.current)||void 0===e||e.focusInput(),m(!1),s({...t,domain:""})},children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.changeDomain.cta.text",defaultMessage:"Set your own"})}),i&&"available"===l&&(0,c.jsx)(Ic,{}),"inuse"===l&&(0,c.jsx)(Zc,{}),"disallowed"===l&&(0,c.jsx)(Pc,{}),"loading"===l&&(0,c.jsx)(wc.Z,{show:!0,showDelay:500,showHold:300,render:()=>(0,c.jsx)(Pi.Z,{style:{textAlign:"center",visibility:"visible",display:"inline",marginLeft:8}})})]}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4},children:Tc(d,i)})]})};var Ac=s(35840);const _c=function(e){const t=(0,g.useIntl)(),s=(0,r.Fg)(),n=(0,o.O7)(),i=(0,a.VK)((()=>(0,Rt.M9)(n)),[n]),l=!Boolean(i),[d,u]=(0,a.AF)(Qe);return(0,c.jsx)("div",{onClick:()=>{i&&Es.y(n,{from:"public_domain_home_page",for:i})},children:(0,c.jsx)(dn.Z,{type:"text",ref:e.textInputRef,style:{background:s.inputBackground,borderRadius:4,boxShadow:"rgb(15 15 15 / 10%) 0px 0px 0px 1px inset",display:"flex",padding:"4px 6px"},value:d.query,onChange:e=>{u({...d,query:e.target.value})},onFocus:()=>{l&&u({...d,openDropdown:!0})},disabled:!l,left:(0,Ac.R)({fill:s.mediumIconColor,width:16,height:16,marginRight:8,marginLeft:8,flexGrow:0,flexShrink:0}),placeholder:t.formatMessage({defaultMessage:"Select a page shared to web",id:"spaceBasicSettings.PublicHomePageSection.input.placeholder"})})})};var Rc=s(68973),Oc=s(11470);function Bc(){return(0,c.jsx)(wc.Z,{show:!0,showDelay:500,showHold:300,render:()=>(0,c.jsx)(Pi.Z,{style:{textAlign:"center",visibility:"visible",display:"inline",marginLeft:8}})})}const Dc=function(e){const t=(0,o.O7)(),[s,n]=(0,a.AF)(e.spaceBasicSettingsStore,Xe),[i,r]=(0,a.AF)(Qe),{query:l}=i,[{value:d,status:u}]=(0,Vt.r5)((()=>Rc.a2(l,t)),[l,t]),p=(0,a.VK)((()=>(0,Ve.RM)()),[]);return l||d&&0!==d.length?(0,c.jsx)("div",{style:{marginTop:2,marginBottom:2},children:(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,sections:[{key:"recent public pages section",render:e=>(0,c.jsx)(tn.Z,{...e}),items:"idle"===u||"pending"===u?[{key:"loading spinner",render:Bc,action:()=>{}}]:p&&d&&0!==d.length?[...d.map((e=>{const t=ne.G.createChildStore(p,{table:pr.iU,id:e.id});return{key:`${e.id} page`,render:e=>(0,c.jsx)(Oc.Z,{store:t,...e}),action:()=>{n({...s,publicHomePage:e.id}),r({...i,openDropdown:!1,displaySummary:!0})}}}))]:[{key:"no results",render:()=>(0,c.jsx)(Me.Z,{isSmall:!0,style:{marginLeft:8},children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.dropdownLabel.noResults",defaultMessage:"No results"})}),action:()=>{}}]}],initialFocus:void 0})}):null};var Lc=s(76798);const Vc=function(e){const[t,s]=(0,a.AF)(e.spaceBasicSettingsStore,Xe),[n,i]=(0,a.AF)(Qe),[o,r]=(0,a.VK)((()=>{const e=(0,Ve.RM)();if(!e||!t.publicHomePage)return[];const s=ne.G.createChildStore(e,{table:pr.iU,id:t.publicHomePage});return[s,s.getIcon()]}),[t]);return o?(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsxs)("div",{style:{display:"flex",paddingRight:8,alignItems:"center"},children:[r&&(0,c.jsx)(en.Z,{icon:r,isEmptyPage:!1,size:18,disabled:!0,style:{display:"inline-flex",marginRight:2,verticalAlign:"text-top"}}),(0,c.jsx)(Lc.Z,{store:o,style:{display:"inline",whiteSpace:"normal",marginRight:Boolean(r)?3:0,wordBreak:"break-word"}})]}),(0,c.jsx)(Ri.Z,{onClick:()=>{i({...n,displaySummary:!1}),s({...t,publicHomePage:void 0})},children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.dropdownLabel",defaultMessage:"Clear"})})]}):null};const Nc=function(e){const t=(0,o.O7)(),s=(0,o.MO)(),i=n.createRef(),[r,l]=(0,a.AF)(Qe),[d]=(0,a.AF)(e.spaceBasicSettingsStore),{openDropdown:u,displaySummary:p}=r,{publicHomePage:m,domain:h}=d,f=`${h}.${Gs.default.publicDomainName}`,x=(0,a.VK)((()=>(0,Rt.M9)(t)),[t]),y=!Boolean(x);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(me.Z,{style:{display:"flex",alignItems:"center"},children:[(0,c.jsx)("span",{style:{marginRight:8},children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.title",defaultMessage:"Public home page"})}),x&&(0,c.jsx)(Bi.Z,{subscriptionTier:x,analyticsName:"public_domain_home_page",desktopStyle:{marginTop:-1}})]}),y&&m&&p?(0,c.jsx)(Vc,{spaceBasicSettingsStore:e.spaceBasicSettingsStore}):(0,c.jsx)(cn.ZP,{alignmentToOrigin:cn.ZP.Alignment.Start,keepFocus:s,onDismiss:()=>{var e;null===(e=i.current)||void 0===e||e.handleBlur(),l({...r,openDropdown:!1,displaySummary:!0})},origin:(0,c.jsx)(_c,{textInputRef:i}),open:u,popupType:cn.ZP.PopupType.Popup,style:{width:250},render:()=>(0,c.jsx)($s.Z,{menuType:Hs.og.Popup,width:250,children:(0,c.jsx)(Dc,{spaceBasicSettingsStore:e.spaceBasicSettingsStore})})}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:8},children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.caption",defaultMessage:"Access your public home page via {linkText}.",values:{linkText:(0,c.jsx)(be.ZP,{delayThreshold:0,renderTooltip:()=>(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.caption.tooltip",defaultMessage:"Click to copy link"}),render:e=>(0,c.jsx)(vn.Z,{onClick:()=>{ye.RD({environment:t,stringValue:f,copiedMessage:ye.tq.copiedLinkToClipboard})},...e,children:f})})}})})]})};var Ec=s(719);function Uc(){return(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.workspaceNameSection.nameInput.caption",defaultMessage:"You can use your organization or company name. Keep it simple."})}const Wc=(0,g.defineMessages)({nameInputPlaceholder:{id:"spaceBasicSettings.nameInput.placeholder",defaultMessage:"e.g. company name"},workspaceDomainInputPlaceholder:{id:"spaceBasicSettings.domainSection.workspaceDomainInput.placeholder",defaultMessage:"URL"},allowedEmailDomainsInputPlaceholder:{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainInput.placeholder",defaultMessage:"Type an email domain…"},copyDomainTooltip:{id:"spaceBasicSettings.workspaceDomain.tooltip",defaultMessage:"Click to copy link"},turnOffAiWhenSubscribedToAiWarning:{id:"spaceBasicSettings.aiFeature.turnOffAiWhenSubscribedToAiWarning",defaultMessage:"Your current plan includes Notion AI. You can turn off access to AI, but you will continue to be billed for it."},turnOffAiWhenSubscribedToAccept:{id:"spaceBasicSettings.aiFeature.turnOffAiWhenSubscribedToAccept",defaultMessage:"Turn off AI"}});class Kc extends i.Z{constructor(){super(...arguments),this.storeTypes={spaceBasicSettingsStore:Xe,securitySettingsStore:He.Z,store:Sc.Z,tokenQueryStore:E.default.createClass("")},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleSpaceNameChange=e=>function(e,t){t.setState({...t.state,name:e.target.value})}(e,this.stores.spaceBasicSettingsStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleCheckDomainAvailability=e=>function(e,t,s,n){w._u({environment:t,spaceStore:s,domain:e}).then((e=>{if("success"!==e.type)n.setState({...n.state,domainState:"loading"});else{const t=e.data.domain===n.state.domain;n.setState({...n.state,domainState:t?e.data.domainState:n.state.domainState})}}))}(e,this.environment,this.props.spaceStore,this.stores.spaceBasicSettingsStore),this.checkSpaceDomainAvailabilityDebounced=h.Ds(this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleCheckDomainAvailability,250),this.handleSpaceUrlChange=e=>{const t=(0,Ts.$U)(e.target.value);this.checkSpaceDomainAvailabilityDebounced(t),this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domain:t}),this.forceUpdate()},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleConfirm=()=>nu(this.environment,this.props.spaceStore,this.stores.spaceBasicSettingsStore,this.stores.securitySettingsStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDeleteClick=()=>async function(e,t,s,n){const i=(0,Ot.zt)();if(!i)return;const o=Bt.subscriptionDataStoreInstance.state,a=Rt.XX(o);if(hc.YO(e),a){if(!(await new Promise((o=>{n.setState({...n.state,churnType:i,churnSurveyModalOpen:!0,onAccept:async()=>{o(!0),await Qc(t,s,e)},onClose:()=>o(!1)})}))))return}await Qc(t,s,e)}(this.environment,this.props.spaceStore,this.props.intl,this.stores.store)}UNSAFE_willMount(e){super.UNSAFE_willMount(e);const{spaceStore:t}=this.props,{spaceBasicSettingsStore:s}=this.stores,n=s.getValueForSpace(t);n&&s.setState(n)}renderComponent(){return ns.Z.state.online?this.renderSettings():(0,c.jsx)(qc,{})}renderSettings(){var e;const{spaceStore:t}=this.props,{spaceBasicSettingsStore:s}=this.stores,{name:i}=s.state,o=Bt.subscriptionDataStoreInstance.state,{device:a}=this.environment;if(!o)return;const r=t.canAdmin(),l=(0,Ts.Cx)(t),d=(0,Ts.jv)(t),u=Rt.qF(this.environment),m=r&&!t.getDisableExport(),h=r,f=(0,Ot.zt)(),x="subscribed_admin"===o.type&&("enterprise"===f||"business"===f),y=t.getSettings().disable_page_analytics,S=Zi.Z.getData(this.environment,{spaceId:t.id}),v=(null===(e=Bt.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[],b=p.de(v),j=r&&b&&(t.getSetting("enable_ai_training")||Ce.default.checkGate("ai_leap_is_visible")),C=!(0,je.wf)();return(0,c.jsxs)(pt.ZP,{controlRow:r&&(0,c.jsx)(iu,{spaceStore:this.props.spaceStore,spaceBasicSettingsStore:this.stores.spaceBasicSettingsStore,securitySettingsStore:this.stores.securitySettingsStore}),controlRowPaddingTopBottom:14,children:[r&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Yc,{}),(0,c.jsx)(me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.workspaceNameSection.title",defaultMessage:"Name"})}),(0,c.jsx)(dn.Z,{value:i,placeholder:L.default.formatMessage(Wc.nameInputPlaceholder),readOnly:!r,onChange:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleSpaceNameChange}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4},children:(0,c.jsx)(Uc,{})}),(0,pt.Um)(),(0,c.jsx)(me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.workspaceIconSection.title",defaultMessage:"Icon"})}),(0,c.jsx)("div",{style:{width:72,height:72,border:`1px solid ${this.theme.regularDividerColor}`,borderRadius:6,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,c.jsx)(en.Z,{bucket:"public",disabled:!1,icon:(0,Ts.Wd)(this.environment,t),isEmptyPage:!1,title:i,size:64,iconLoggingData:{recordTable:t.table,source:"workspace_settings"},onChange:e=>function(e,t,s){P.createAndCommit({userAction:"SpaceBasicSettings.handleRecordIconChange",environment:s,perform:s=>{Rs.sO({store:t.getIconStore(),value:e,transaction:s})}})}(e,this.props.spaceStore,this.environment)})}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:8},children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.workspaceIconSection.caption",defaultMessage:"Upload an image or pick an emoji. It will show up in your sidebar and notifications."})}),(0,pt.Um)()]}),xc(this.environment)||j?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Hc,{}),xc(this.environment)?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Jc,{securitySettingsStore:this.props.securitySettingsStore,spaceStore:this.props.spaceStore}),(0,pt.Um)()]}):null,j?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Xc,{securitySettingsStore:this.props.securitySettingsStore,spaceStore:this.props.spaceStore}),(0,pt.Um)()]}):null]}):null,(0,c.jsx)(Gc,{}),l&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.guestLimitedAccessMessage",defaultMessage:"You are currently a guest in this workspace. Ask an admin to add you as a member in order to see other pages."})}),(0,pt.Um)()]}),C&&r&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Fc,{canAdminSpaceStore:r,domainIsAutogenerated:null==S?void 0:S.domainIsAutogenerated,spaceStore:t,spaceBasicSettingsStore:s,handleSpaceUrlChange:this.handleSpaceUrlChange}),(0,pt.Um)()]}),r&&u&&(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.title",defaultMessage:"Allowed email domains"})}),(0,c.jsx)(eu,{spaceStore:this.props.spaceStore,spaceBasicSettingsStore:this.stores.spaceBasicSettingsStore,tokenQueryStore:this.stores.tokenQueryStore}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4},children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainInput.caption",defaultMessage:"Anyone with email addresses at these domains can automatically join your workspace."})}),(0,pt.Um)()]}),C&&r&&(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(Nc,{spaceBasicSettingsStore:s}),(0,pt.Um)()]}),m&&(0,c.jsx)(jc,{handleExportClick:()=>function(e){const{currentSpaceStore:t}=Ke.default.state;t&&ca.q$({environment:e,root:{table:"space",id:t.id,spaceId:t.id},isCollectionViewExportTypeSupported:!0})}(this.environment)}),h&&(0,c.jsxs)(n.Fragment,{children:[(0,c.jsxs)(me.Z,{style:{display:"flex",alignItems:"center"},children:[(0,c.jsx)("span",{style:{marginRight:8},children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.title",defaultMessage:"Export members"})}),!x&&(0,c.jsx)(Bi.Z,{subscriptionTier:"business",analyticsName:"space_export_members",desktopStyle:{marginTop:-1}})]}),(0,c.jsx)("div",{style:{display:"flex"},children:(0,c.jsx)(Ri.Z,{isLarge:!0,disabled:!x,onClick:()=>function(e,t){const{currentSpaceStore:s}=Ke.default.state,n=Bt.subscriptionDataStoreInstance.state;s&&n&&"subscribed_admin"===n.type&&ca.$G(t,{spaceStore:s,subscriptionData:n,intl:e})}(this.props.intl,this.environment),disabledFeedback:!0,children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.exportAsCSVButton.label",defaultMessage:"Export members as CSV"})})}),(0,c.jsx)("div",{style:{height:12}}),(0,c.jsx)(zi.Z,{title:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.helpButton.caption",defaultMessage:"Learn about exporting members."}),href:(0,Ue.UY)("guides.exportMembers"),analyticsFrom:"space_settings"}),(0,pt.Um)()]}),r&&(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.analytics.title",defaultMessage:"Analytics"})}),(0,c.jsxs)("div",{style:{display:"flex",gap:12,flexDirection:"column"},children:[(0,c.jsx)(bn.Z,{isMobile:a.isMobile,title:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.analytics.settings.title",defaultMessage:"Save and display page view analytics"}),caption:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.analytics.settings.description",defaultMessage:"People with edit or full access will be able to see how many views a page has. If this is turned off, page views will not be stored for all pages in {workspaceName}.",values:{workspaceName:i}}),type:"toggle",isOn:!y,onToggle:()=>{const e=!y;P.createAndCommit({userAction:"SpaceBasicSettings.analyticsSettings.onSelectOption",environment:this.environment,perform:s=>{Rs.sW({store:t,data:{settings:{...t.getSettings(),disable_page_analytics:e}},transaction:s})}}),yc.j(this.environment,e?"page_analytics_workspace_opt_out":"page_analytics_workspace_opt_in")}}),(0,c.jsx)(zi.Z,{title:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Learn about workspace analytics.",id:"spaceBasicSettings.workspaceAnalytics.helpButton.caption"}),href:(0,Ue.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq"})]}),(0,pt.Um)()]}),(0,c.jsx)(me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.title",defaultMessage:"Danger zone"})}),(0,c.jsxs)("div",{style:{display:"flex"},children:[(d.length>1||l)&&(0,c.jsx)(Ri.Z,{isLarge:!0,onClick:()=>function(e,t){const{currentUserSettingsStore:s}=Ke.default.state;s&&M.showDialog({message:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.leaveWorkspaceConfirmationDialog.prompt",defaultMessage:"Are you sure you want to leave this workspace?"}),showCancel:!0,keepFocus:!0,items:[{label:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.leaveWorkspaceConfirmationDialog.leaveButton.label",defaultMessage:"Leave"}),color:"red",onAccept:async()=>{await w.bf({environment:t,spaceId:e.id,userSettingsStore:s})&&(ii.z0(t),it.Z.setState({...it.Z.state,open:!1}))}}]})}(this.props.spaceStore,this.environment),style:{marginRight:r?12:void 0},children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.leaveWorkspaceButton.label",defaultMessage:"Leave workspace"})}),r&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(su,{store:this.stores.store}),(0,c.jsx)(Ri.Z,{isLarge:!0,isRed:!0,onClick:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDeleteClick,children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.deleteWorkspaceButton.label",defaultMessage:"Delete entire workspace"})})]})]}),r&&(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)("div",{style:{height:12}}),(0,c.jsx)(zi.Z,{title:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.deleteWorkspaceHelpButton.caption",defaultMessage:"Learn about deleting workspaces."}),href:(0,Ue.UY)("guides.deleteWorkspace"),analyticsFrom:"space_settings"})]})]})}}Kc.displayName="SpaceBasicSettings";const zc=(0,g.injectIntl)(Kc);function qc(){return(0,c.jsx)(pt.ZP,{children:(0,c.jsx)(Me.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.offlineMessage",defaultMessage:"Please go online to manage settings."})})})}function Gc(){return(0,c.jsx)(me.Z,{large:!0,divider:"full",style:{paddingTop:12},children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.public.subtitle",defaultMessage:"Public settings"})})}function Hc(){return(0,c.jsx)(me.Z,{large:!0,divider:"full",style:{paddingTop:12},children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.feature.subtitle",defaultMessage:"Feature settings"})})}function Yc(){return(0,c.jsx)(me.Z,{large:!0,divider:"full",children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.title",defaultMessage:"Workspace settings"})})}async function Qc(e,t,s){const{currentUserSettingsStore:n}=Ke.default.state;if(!n)return;const i=(0,Ts.rn)(s,e)||t.formatMessage({defaultMessage:"Untitled workspace",id:"spaceBasicSettings.deleteWorkspace.untitledWorkspace.placeholder"}),o=(0,gc.Bd)(ao.SP)?(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.prompt",defaultMessage:"This action cannot be undone. This will permanently delete the workspace, including all pages and files. Please type the name of the workspace to confirm."}):(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(Cc.Z,{style:{marginTop:16},translations:{es:"Esta acción no se puede deshacer. Esto eliminará permanentemente el espacio de trabajo, incluidas todas las páginas y archivos. Por favor escriba el nombre del espacio de trabajo para confirmar.",ru:"Это действие не может быть отменено. Это навсегда удалит рабочее пространство, включая все страницы и файлы. Пожалуйста, введите название рабочей области для подтверждения.",zh:"此操作无法撤消。 这将永久删除工作区，包括所有页面和文件。 请输入要确认的工作空间的名称。",de:"Diese Aktion kann nicht rückgängig gemacht werden. Dadurch wird der Arbeitsbereich einschließlich aller Seiten und Dateien dauerhaft gelöscht. Bitte geben Sie den Namen des Arbeitsbereichs zur Bestätigung ein.",fr:"Cette action ne peut pas être annulée. Cela supprimera définitivement l'espace de travail, y compris toutes les pages et tous les fichiers. Veuillez saisir le nom de l'espace de travail pour confirmer.",ja:"この操作を元に戻すことはできません。 これにより、すべてのページとファイルを含むワークスペースが完全に削除されます。 確認するワークスペースの名前を入力してください。",it:"Questa azione non può essere annullata. Questo eliminerà definitivamente l'area di lavoro, incluse tutte le pagine e i file. Digita il nome dell'area di lavoro per confermare.",pt:"Essa ação não pode ser desfeita. Isso excluirá permanentemente o espaço de trabalho, incluindo todas as páginas e arquivos. Por favor, digite o nome do espaço de trabalho para confirmar.",nl:"Deze actie kan niet ongedaan gemaakt worden. Hiermee wordt de werkruimte permanent verwijderd, inclusief alle pagina's en bestanden. Typ de naam van de werkruimte om te bevestigen.",pl:"Tego działania nie można cofnąć. Spowoduje to trwałe usunięcie obszaru roboczego, w tym wszystkich stron i plików. Wpisz nazwę obszaru roboczego, aby potwierdzić.",sv:"Den här åtgärden kan inte ångras. Detta tar bort arbetsytan permanent, inklusive alla sidor och filer. Vänligen skriv in arbetsplatsens namn för att bekräfta.",uk:"Цю дію не можна скасувати. Це дозволить остаточно видалити робочу область, включаючи всі сторінки та файли. Введіть назву робочої області для підтвердження.",no:"Denne handlingen kan ikke fortrykkes. Dette vil permanent slette arbeidsområdet, inkludert alle sider og filer. Vennligst skriv navnet på arbeidsområdet for å bekrefte.",tr:"Bu işlem geri alınamaz. Bu, tüm sayfaları ve dosyaları içeren çalışma alanını kalıcı olarak siler. Lütfen onaylamak için çalışma alanının adını yazın.",cs:"Tuto akci nelze vrátit zpět. Tím se trvale odstraní pracovní prostor včetně všech stránek a souborů. Zadejte prosím název pracovního prostoru, který chcete potvrdit.",vi:"Hành động này không thể được hoàn tác. Điều này sẽ xóa vĩnh viễn không gian làm việc, bao gồm tất cả các trang và tệp. Vui lòng nhập tên của không gian làm việc để xác nhận.",da:"Denne handling kan ikke fortrydes. Dette vil permanent slette arbejdsområdet, inklusive alle sider og filer. Indtast navnet på arbejdsområdet for at bekræfte.",hu:"Ez a művelet nem visszavonható. Ez véglegesen törli a munkaterületet, beleértve az összes oldalt és fájlt. Kérjük, írja be a munkaterület nevét a megerősítéshez.",ar:"لا يمكن التراجع عن هذا الإجراء. سيؤدي ذلك إلى حذف مساحة العمل كليا ، بما يشمل جميع الصفحات والملفات. يرجى كتابة اسم مساحة العمل للتأكيد.",th:"การกระทำนี้ไม่สามารถยกเลิกได้ นี่จะเป็นการลบพื้นที่ทำงานอย่างถาวรรวมถึงหน้าและไฟล์ทั้งหมด โปรดพิมพ์ชื่อของพื้นที่ทำงานเพื่อยืนยัน",he:"לא ניתן לבטל פעולה זו. פעולה זו תמחק לצמיתות את סביבת העבודה, כולל כל הדפים והקבצים. הקלד את שם מרחב העבודה כדי לאשר.",fi:"Tätä toimintoa ei voi peruuttaa. Tämä poistaa työtilan pysyvästi, mukaan lukien kaikki sivut ja tiedostot. Vahvista kirjoittamalla työtilan nimi.",id:"Tindakan ini tidak bisa dibatalkan. Ini akan secara permanen menghapus ruang kerja, termasuk semua halaman dan file. Silakan ketik nama ruang kerja untuk mengonfirmasi."}})});await fc.b({message:(0,c.jsx)("div",{children:(0,c.jsx)("div",{children:o})}),acceptLabel:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.deleteWorkspaceButton.label",defaultMessage:"Permanently delete workspace"}),requiredInputValue:i})&&(w.Ns({environment:s,spaceId:e.id,userSettingsStore:n}),ii.BP(s),it.Z.setState({...it.Z.state,open:!1}))}function $c(){it.Z.setState({...it.Z.state,open:!1}),Qe.setState(Qe.getInitialState())}function Jc(e){let{securitySettingsStore:t,spaceStore:s}=e;const n=(0,a.VK)((()=>(0,Ts.CV)(s)),[s]),i=(0,a.VK)((()=>!n&&Boolean(null==t?void 0:t.state.enableAiFeature)),[n,t]);return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(be.ZP,{placement:be.ug.Bottom,alignment:be.v2.Start,textWrap:!0,style:{maxWidth:240},disableTooltip:!n,renderTooltip:()=>n?(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.aiFeature.hipaaTooltip",defaultMessage:"Notion AI is not currently available for HIPAA compliant workspaces."}):void 0,render:e=>(0,c.jsx)("div",{children:(0,c.jsxs)("div",{...e,style:{display:"flex",alignItems:"center",cursor:n?"not-allowed":"pointer"},onClick:()=>{!async function(e,t){var s;const n=(null===(s=Bt.subscriptionDataStoreInstance.state)||void 0===s?void 0:s.addOns)??[],i=p.de(n),o=!t.state.enableAiFeature;if(!o&&i&&!(await M.confirmUserActionV2({message:L.default.formatMessage(Wc.turnOffAiWhenSubscribedToAiWarning),acceptLabel:L.default.formatMessage(Wc.turnOffAiWhenSubscribedToAccept)})).accept)return;t&&!e&&t.setState({...t.state,enableAiFeature:o})}(n,t)},children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.aiFeature.label",defaultMessage:"Notion AI"})}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.aiFeature.ga.caption",defaultMessage:"Enable to provide AI-powered functionality for all members of your workspace.{br}By enabling Notion AI, you are agreeing to the <inlinelink>Notion AI Supplementary Terms</inlinelink>",values:{br:(0,c.jsx)("br",{}),inlinelink:e=>(0,c.jsx)(vn.Z,{href:"https://notion.notion.site/fa9034c8b5a04818a6baf3eac2adddbb",external:!0,onClick:e=>e.stopPropagation(),children:e})}})})]}),(0,c.jsx)("div",{style:{marginTop:5},children:(0,c.jsx)(Er.Z,{on:i,disabled:n})})]})})})})}function Xc(e){let{securitySettingsStore:t,spaceStore:s}=e;const n=(0,a.VK)((()=>(0,Ts.CV)(s)),[s]),i=(0,a.VK)((()=>Boolean(t.state.enableAiTraining)),[t]);return(0,c.jsx)("div",{children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},onClick:()=>{!function(e,t){var s;const n=(null===(s=Bt.subscriptionDataStoreInstance.state)||void 0===s?void 0:s.addOns)??[],i=p.de(n),o=!t.state.enableAiTraining,a=Boolean(t.state.enableAiFeature)&&!e;(Boolean(t.state.enableAiTraining)||i&&a&&t)&&t.setState({...t.state,enableAiTraining:o})}(n,t)},children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,c.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.aiLeap.label",defaultMessage:"Share data to improve Notion AI"})}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.aiLeap.description",defaultMessage:"Help improve Notion’s AI models by allowing data from across this workspace to be shared with Notion.{br}By enabling AI LEAP (Learning and Early Access Program) you are agreeing to the <inlinelink>Notion AI LEAP Supplementary Terms</inlinelink>. <learnmore>Learn more</learnmore>.",values:{br:(0,c.jsx)("br",{}),learnmore:e=>(0,c.jsx)(vn.Z,{href:"https://www.notion.so/help/notion-ai-leap-program-faqs",external:!0,onClick:e=>e.stopPropagation(),children:e}),inlinelink:e=>(0,c.jsx)(vn.Z,{href:"https://notion.notion.site/0c55d702d0154a788d9e70c4ee396399",external:!0,onClick:e=>e.stopPropagation(),children:e})}})})]}),(0,c.jsx)("div",{style:{marginTop:5},children:(0,c.jsx)(Er.Z,{on:i,disabled:n})})]})})}function eu(e){let{spaceStore:t,spaceBasicSettingsStore:s,tokenQueryStore:n}=e;const i=(0,o.O7)(),r=(0,g.useIntl)(),{device:l}=i,{emailDomains:d}=(0,a.VK)((()=>s.state),[s]),u=(0,a.VK)((()=>t.canAdmin()),[t]),p=(0,a.VK)((()=>Bt.subscriptionDataStoreInstance.state),[]),m=(0,a.VK)((()=>n.state),[n]);return(0,c.jsx)(cn.ZP,{popupType:l.isMobile?cn.ZP.PopupType.SlideUp:cn.ZP.PopupType.Popup,sameWidthAsOrigin:!0,open:m.length>0,origin:(0,c.jsx)(Ec.Z,{placeholder:r.formatMessage(Wc.allowedEmailDomainsInputPlaceholder),value:m,onChange:e=>n.setState(e.target.value),readOnly:!u,onRemoveLastToken:()=>{const e=d.slice(0,d.length-1);s.setState({...s.state,emailDomains:e})},tokens:d.map((e=>(0,c.jsx)(ul.Z,{showRemoveButton:!0,isSingle:!1,format:sr.lo.Medium,onClickRemove:()=>{const t=d.filter((t=>t!==e));s.setState({...s.state,emailDomains:t})},value:e},e)))}),render:()=>{const e=m.trim(),i=(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainsDropdown.placeholder",defaultMessage:"Type an email domain…"}),o=(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainsDropdown.placeholderNoResults",defaultMessage:"Type an email domain of a member of this workspace…"}),a=p?Rt.hn(p).map((e=>{if(("unsubscribed_admin"===p.type||"unsubscribed_member"===p.type||"subscribed_admin"===p.type)&&p.joinedMemberIds.includes(e.userId)){const s=ne.U6.createChildStore(t,{table:B.KJ,id:e.userId}).getEmail();return s&&(0,Ra.Gd)(s)}})).filter(((e,t,s)=>Boolean(e&&t===s.indexOf(e)&&!d.includes(e)))):[],r=(0,td.ZP)(e,a,(e=>e)).map(((e,t)=>({key:t,render:t=>(0,c.jsx)(Qs.Z,{...t,title:e}),action:()=>{const t=[...d,e];s.setState({...s.state,emailDomains:t}),n.setState("")}})));let u;return u=l.isMobile?{menuType:Hs.og.ActionSheet}:{menuType:Hs.og.Popup,width:"100%"},(0,c.jsx)($s.Z,{...u,children:(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,initialFocus:r.length>0?0:void 0,sections:[{key:0,render:e=>(0,c.jsx)(tn.Z,{...e,disableDesktopPadding:!0,title:r.length>0?i:o}),items:r}]})})},onDismiss:()=>{n.setState("")}})}function tu(e){let{store:t}=e;const s=(0,a.VK)((()=>Bt.subscriptionDataStoreInstance.state),[]),n=(0,a.VK)((()=>t.state),[t]),i=Rt.XX(s);return i&&n.churnSurveyModalOpen?(0,c.jsx)(bc.ZP,{churnType:n.churnType,currentPlan:n.churnType,isWorkspaceDeletion:!0,periodEnd:i.periodEnd,hasAI:p.de(i.addOns),hasPendingChanges:Boolean(i.schedule||i.willCancelAt),customerId:i.customerId,onAccept:()=>{n.churnSurveyModalOpen&&n.onAccept()},onClose:()=>{n.churnSurveyModalOpen&&n.onClose(),t.reset()}}):null}function su(e){let{store:t}=e;const{churnSurveyModalOpen:s}=(0,a.VK)((()=>t.state),[t]);return(0,c.jsx)(vc.q,{isOpen:s,dismissUsing:"onlyEscape",onDismiss:()=>{t.state.churnSurveyModalOpen&&t.state.onClose(),t.reset()},children:(0,c.jsx)(tu,{store:t})})}async function nu(e,t,s,n){await w.Y5({environment:e,spaceId:t.id,domain:s.state.domain})&&(await w.OF({environment:e,spaceStore:t,spaceBasicSettingsStore:s,securitySettingsStore:n}),Qe.setState(Qe.getInitialState()),it.Z.setState({...it.Z.state,open:!1}))}function iu(e){let{spaceStore:t,spaceBasicSettingsStore:s,securitySettingsStore:i}=e;const r=(0,o.O7)(),l=(0,n.useCallback)((()=>nu(r,t,s,i)),[r,t,s,i]),d=(0,a.VK)((()=>!function(e){const{domain:t,domainState:s}=e.state;return!!t&&("available"===s||"current-space"===s)}(s)),[s]);return(0,c.jsxs)("div",{style:{display:"flex"},children:[(0,c.jsx)(Sn.Z,{isLarge:!0,onClick:l,disabled:d,children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.updateButton.label",defaultMessage:"Update"})}),(0,c.jsx)(Ri.Z,{isLarge:!0,style:{marginLeft:12},onClick:$c,children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.cancelButton.label",defaultMessage:"Cancel"})})]})}var ou=s(44625),au=s(53471),ru=s(97832),lu=s(90403),du=s(65252),cu=s(78873);let uu=function(e){return e.Password="Password",e.CurrentEmail="TemporaryPasscode",e}({});class pu extends E.default{getInitialState(){return{open:!1,authorized:!1,authorizationType:void 0}}}const mu=pu;var gu=s(83785);const hu={modal:{width:460,padding:32,borderRadius:4,fontSize:14},loadingSpinner:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},paragraph:{marginTop:12,marginBottom:14},error:{color:Ks.ZP.red,fontSize:12,marginTop:4,marginLeft:8},bold:{fontWeight:x.Z.fontWeight.bold},input:{padding:"4px 8px"},button:{marginTop:14,width:"100%"},educationPlanWarning:{display:"flex",marginTop:14,paddingTop:14},claimedEmailDomainWarning:{marginTop:14,marginBottom:14}},fu=(0,g.defineMessages)({dialogLabel:{id:"profileSettings.accountSecuritySection.emailSetting.dialogLabel",defaultMessage:"Change email"}});class xu extends i.Z{constructor(){super(...arguments),this.storeTypes={store:mu},this.renderModalContent=()=>{const{store:e}=this.stores,{state:t}=e;return(0,c.jsx)("div",{style:{...hu.modal,...bu(this.theme).modal},children:(0,c.jsx)(gu.Z,{fetch:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_getAuthorizationType,loading:e=>e&&(0,c.jsx)("div",{style:hu.loadingSpinner,children:(0,c.jsx)(Pi.Z,{})}),render:()=>(0,c.jsxs)(n.Fragment,{children:[t.authorizationType===uu.Password?(0,c.jsx)(Bu,{userValue:this.props.userValue,store:this.stores.store,state:t}):t.authorizationType===uu.CurrentEmail?(0,c.jsx)(Eu,{userValue:this.props.userValue,store:this.stores.store,state:t}):void 0,t.authorized&&this.renderSetNewEmail(t)]})})})},this.renderSetNewEmail=e=>{const{store:t}=this.stores,{userValue:s}=this.props;if(t.state.authorized)return(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)("p",{style:hu.paragraph,children:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.newEmailInstructions",defaultMessage:"Please enter a new email and we will send you a verification code."})}),(0,c.jsx)("div",{children:(0,c.jsx)(Vu,{store:this.stores.store})}),t.state.newEmailContainsVerifiedDomain&&(0,Ra.Gd)(t.state.newEmail)!==(0,Ra.Gd)((null==s?void 0:s.email)||"")&&(0,c.jsx)(vu,{state:e}),t.state.newEmailPasscodeSent?this.renderNewEmailPasscodeInput(e):(0,c.jsx)(Nu,{store:this.stores.store,state:e}),(0,c.jsx)(Mu,{hasEducationPlan:this.props.hasEducationPlan})]})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleSendCurrentEmailVerification=()=>Cu(this.environment,this.props.userValue,this.props.intl,this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleChangeCurrentEmailPasscode=e=>wu(e,this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleChangePassword=e=>ku(e,this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleClearPassword=()=>Tu(this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleSubmitAuthorization=()=>_u(this.environment,this.props.userValue,this.props.intl,this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleChangeNewEmail=e=>Iu(e,this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleClearNewEmail=()=>Zu(this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleSendNewEmailVerification=()=>Pu(this.environment,this.props.intl,this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleChangeNewEmailPasscode=e=>function(e,t){t.setState({...t.state,newEmailPasscode:e.currentTarget.value,error:void 0})}(e,this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleSubmit=()=>Ru(this.environment,this.props.hasEducationPlan,this.props.intl,this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_openModal=()=>Fu(this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_closeModal=()=>Au(this.environment,this.props.hasEducationPlan,this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_getAuthorizationType=()=>async function(e,t,s,n){const i=ju(s,t,n);if(!i)return;const o=await cu.c({environment:e,userEmail:i});if(o.error)return void n.setState({open:n.state.open,authorized:!1,authorizationType:void 0,error:t.formatMessage({id:"profileSettings.changeEmailModal.errorFetchingAccountData",defaultMessage:"Could not fetch account information for {currentEmail}."},{currentEmail:i})});o.value.isSamlEnforced||!o.value.hasPassword?n.setState({open:!0,authorized:!1,authorizationType:uu.CurrentEmail,currentEmailPasscodeSent:!1,currentEmailPasscode:""}):n.setState({open:!0,authorized:!1,authorizationType:uu.Password,password:""})}(this.environment,this.props.intl,this.props.userValue,this.stores.store)}renderComponent(){const{userValue:e}=this.props,{store:t}=this.stores;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(bn.Z,{type:"custom",isMobile:!1,title:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.accountSecuritySection.emailSetting.label",defaultMessage:"Email"}),caption:e&&e.email,customButton:(0,c.jsx)(Ou,{userValue:this.props.userValue,areProfileEditsDisabled:this.props.areProfileEditsDisabled,store:this.stores.store})}),(0,c.jsx)(_n.Z,{ariaLabel:L.default.formatMessage(fu.dialogLabel),open:t.state.open,onDismiss:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_closeModal,render:this.renderModalContent})]})}renderNewEmailPasscodeInput(e){const t=this.getSubmitHandler();return(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)("p",{style:hu.paragraph,children:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.verificationCodeSentMessage",defaultMessage:"We just sent you a temporary verification code to {newEmail}.",values:{newEmail:(0,c.jsx)("span",{style:hu.bold,children:e.newEmail})}})}),(0,c.jsx)(dn.Z,{value:e.newEmailPasscode,onChange:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleChangeNewEmailPasscode,onSubmit:t,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.enterVerificationCodeInput.placeholder",defaultMessage:"Enter verification code"}),focusInitial:!0,style:hu.input}),e.error&&(0,c.jsx)("div",{style:hu.error,children:e.error}),(0,c.jsx)(Sn.Z,{isLarge:!0,style:hu.button,onClick:t,disabled:e.loading,children:e.loading?(0,c.jsx)(Pi.Z,{}):(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.changeEmailButton.label",defaultMessage:"Change email"})})]})}getSubmitHandler(){const{store:e}=this.stores,{userValue:t}=this.props;if(!e.state.authorized)return()=>{};if(e.state.newEmailContainsVerifiedDomain&&(0,Ra.Gd)(e.state.newEmail)!==(0,Ra.Gd)((null==t?void 0:t.email)||"")){const t=e.state.newEmail;return async()=>{const e=await function(e){return M.confirmUserAction({message:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.title",defaultMessage:"Are you sure you want to change your email?"}),description:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.description",defaultMessage:"If you continue changing this email address to this domain, any workspaces created by this account can be managed by the organization.",values:{verifiedDomain:(0,Ra.Gd)(e)}}),acceptLabel:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.acceptButton.label",defaultMessage:"Change email"}),cancelLabel:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.cancelButton.label",defaultMessage:"Go back"})})}(t);e&&await Ru(this.environment,this.props.hasEducationPlan,this.props.intl,this.stores.store)}}return this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleSubmit}}xu.displayName="EmailChangeSettings";const yu=(0,g.injectIntl)(xu);function Su(e){let{userValue:t}=e;return t?(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.currentEmail",defaultMessage:"Your current email is {currentEmail}.",values:{currentEmail:(0,c.jsx)("span",{style:hu.bold,children:t&&t.email})}}):null}function vu(e){let{state:t}=e;return(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:hu.claimedEmailDomainWarning,children:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.claimedEmailDomainWarning",defaultMessage:"The email domain {newEmailDomain} has been claimed by an organization. If you continue with changing this email address, any workspaces created by this account can be managed by the organization. See <domainclaimlink>this page</domainclaimlink> for more info.",values:{newEmailDomain:(0,Ra.Gd)(t.newEmail)??t.newEmail,domainclaimlink:e=>(0,c.jsx)(vn.Z,{href:(0,Ue.UY)("guides.domainManagement"),external:!0,children:e})}})})}function bu(e){return{modal:{background:e.contentBackground},educationPlanWarning:{color:e.lightTextColor,borderTop:`1px solid ${e.regularDividerColor}`}}}function Mu(e){let{hasEducationPlan:t}=e;const s=(0,r.Fg)(),n=(0,o.O7)();return t?(0,c.jsxs)("div",{style:{...hu.educationPlanWarning,...bu(s).educationPlanWarning},children:[(0,Hn.m)({width:14,marginTop:4,marginRight:6,fill:s.lightIconColor})," ",(0,c.jsx)("div",{children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Changing your email may downgrade your workspace on a Free Education Plan to the basic Free Plan. You won't lose any data, but you'll need to upgrade to re-access paid features. Have questions about this? <sendmessagelink>Message support</sendmessagelink>.",id:"emailChangeSettings.downgradeEducationPlan.warning.message",values:{sendmessagelink:e=>(0,c.jsx)(vn.Z,{onClick:()=>function(e){fo.j({environment:e,from:"change_email_student"})}(n),children:e})}})})]}):null}function ju(e,t,s){if(e)return e.email;s.setState({open:s.state.open,authorized:!1,authorizationType:void 0,error:t.formatMessage({id:"profileSettings.changeEmailModal.errorNoUserValue",defaultMessage:"User value is undefined."})})}async function Cu(e,t,s,n){if(!t)return;n.setState({...n.state,loading:!0});const i=await T.sendEmailVerification(e,{email:t.email});"success"===i.type?n.setState({...n.state,currentEmailPasscodeSent:!0,currentEmailPasscode:"",error:void 0,loading:!1}):n.setState({...n.state,currentEmailPasscodeSent:!0,loading:!1,error:(0,D.wf)(s,i)})}function wu(e,t){t.setState({...t.state,currentEmailPasscode:e.currentTarget.value,error:void 0})}function ku(e,t){t.setState({open:!0,authorized:!1,authorizationType:uu.Password,password:e.currentTarget.value,error:void 0})}function Tu(e){e.setState({open:!0,authorized:!1,authorizationType:uu.Password,password:""})}function Iu(e,t){t.setState({...t.state,newEmail:e.currentTarget.value,error:void 0})}function Zu(e){e.setState({...e.state,newEmail:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0})}async function Pu(e,t,s){if(!s.state.authorized)return;const n=(0,Ra.Gd)(s.state.newEmail);s.setState({...s.state,loading:!0});const[i,o]=await Promise.all([await T.sendEmailVerification(e,{email:s.state.newEmail}),n?await T.getVerifiedEmailDomain(e,{emailDomain:n}):void 0]);if("success"===i.type){const e=(0,fs.$K)(o)&&"failed"===o.type?(0,D.wf)(t,o):void 0;s.setState({...s.state,newEmailPasscodeSent:!0,newEmailPasscode:"",error:e,loading:!1,newEmailContainsVerifiedDomain:(0,fs.$K)(o)&&"success"===o.type&&void 0!==o.data.id})}else s.setState({...s.state,loading:!1,error:(0,D.wf)(t,i)})}function Fu(e){e.setState({open:!0,authorized:!1,authorizationType:void 0})}async function Au(e,t,s){s.reset(),t&&await rt.bi(e)}async function _u(e,t,s,n){if(!n.state.authorized)if(n.state.authorizationType===uu.Password){if(!ju(t,s,n))return;n.setState({...n.state,loading:!0});const i=await T.authVerifyPassword(e,{password:n.state.password});if("failed"===i.type)return void n.setState({...n.state,loading:!1,error:(0,D.wf)(s,i)});n.setState({...n.state,authorized:!0,newEmail:"",newEmailPasscode:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0,loading:!1})}else n.state.authorizationType===uu.CurrentEmail&&n.setState({...n.state,authorized:!0,newEmail:"",newEmailPasscode:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0,loading:!1})}async function Ru(e,t,s,n){if(!n.state.authorized)return;const i=n.state.authorizationType===uu.Password?{type:"Password",password:n.state.password,newEmail:n.state.newEmail,newEmailPasscode:n.state.newEmailPasscode}:{type:"CurrentEmail",currentEmailPasscode:n.state.currentEmailPasscode,newEmail:n.state.newEmail,newEmailPasscode:n.state.newEmailPasscode};n.setState({...n.state,loading:!0});const o=await T.changeEmail(e,i);if("success"===o.type)hc.tx(e,{new_email:n.state.newEmail,error:void 0}),n.setState({...n.state,loading:!1}),await Au(e,t,n);else{var a;const i=(0,D.wf)(s,o);if(hc.tx(e,{new_email:n.state.newEmail,error:i}),"IntercomError"===(null===(a=o.body)||void 0===a?void 0:a.name))return n.setState({...n.state,loading:!1}),void(await Au(e,t,n));n.setState({...n.state,loading:!1,error:i})}}function Ou(e){let{userValue:t,areProfileEditsDisabled:s,store:i}=e;const o=(0,n.useCallback)((()=>Fu(i)),[i]),a=(0,c.jsx)(Ri.Z,{isLarge:!0,onClick:s?()=>{}:o,disabled:s,disabledFeedback:s,children:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.accountSecuritySection.emailSetting.changeEmailButton.label",defaultMessage:"Change email"})});return s?(0,c.jsx)(be.ZP,{renderTooltip:()=>(0,c.jsx)(g.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",values:{emailDomain:t?(0,Ra.Gd)(t.email):""}}),placement:be.ug.Bottom,alignment:be.v2.Center,render:e=>(0,c.jsx)("div",{...e,children:a})}):a}function Bu(e){let{state:t,userValue:s,store:i}=e;const a=(0,o.O7)(),r=(0,g.useIntl)(),l=(0,n.useCallback)((()=>_u(a,s,r,i)),[a,s,r,i]),d=(0,n.useCallback)((()=>Tu(i)),[i]),u=(0,n.useCallback)((e=>ku(e,i)),[i]);return s?(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)("p",{style:{margin:0},children:(0,c.jsx)(Su,{userValue:s})}),(0,c.jsx)("p",{style:hu.paragraph,children:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.enterPasswordInstructions",defaultMessage:"Please enter your password."})}),(0,c.jsx)(dn.Z,{style:{display:"none"},type:"text",value:s.email,autoComplete:"username",disabled:!0}),(0,c.jsx)(dn.Z,{type:"password",disabled:t.authorized,value:t.password,onChange:u,showClearButton:!0,onClearButtonClick:d,onSubmit:l,placeholder:r.formatMessage({id:"profileSettings.changeEmailModal.passwordInput.label",defaultMessage:"Password"}),style:hu.input,focusInitial:!0,autoComplete:"current-password"}),!t.authorized&&t.error&&(0,c.jsx)("div",{style:hu.error,children:t.error}),!t.authorized&&(0,c.jsx)(Sn.Z,{isLarge:!0,style:hu.button,onClick:l,disabled:t.loading,children:t.loading?(0,c.jsx)(Pi.Z,{}):(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.continueButton.label",defaultMessage:"Continue"})})]}):null}function Du(e){let{userValue:t,store:s}=e;const i=(0,o.O7)(),r=(0,g.useIntl)(),l=(0,n.useCallback)((()=>Cu(i,t,r,s)),[i,t,r,s]),{loading:d}=(0,a.VK)((()=>s.state),[s]);return(0,c.jsx)(Sn.Z,{isLarge:!0,onClick:l,disabled:d,children:d?(0,c.jsx)(Pi.Z,{}):(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.sendCurrentEmailVerificationCode.label",defaultMessage:"Send verification code"})})}function Lu(e){let{state:t,userValue:s,store:i}=e;const a=(0,o.O7)(),r=(0,g.useIntl)(),l=(0,n.useCallback)((()=>_u(a,s,r,i)),[a,s,r,i]),d=(0,n.useCallback)((e=>wu(e,i)),[i]);return(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(dn.Z,{value:t.currentEmailPasscode,onChange:d,onSubmit:l,placeholder:r.formatMessage({id:"profileSettings.changeEmailModal.enterCurrentEmailVerificationCodeInput.placeholder",defaultMessage:"Enter verification code"}),focusInitial:!0,style:hu.input}),!t.authorized&&(0,c.jsx)(Sn.Z,{isLarge:!0,style:hu.button,onClick:l,disabled:t.loading,children:t.loading?(0,c.jsx)(Pi.Z,{}):(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.continueButton.label",defaultMessage:"Continue"})})]})}function Vu(e){let{store:t}=e;const s=(0,o.O7)(),i=(0,g.useIntl)(),r=(0,n.useCallback)((()=>Zu(t)),[t]),l=(0,n.useCallback)((()=>Pu(s,i,t)),[s,i,t]),d=(0,n.useCallback)((e=>Iu(e,t)),[t]),u=(0,a.VK)((()=>t.state),[t]);return u.authorized?(0,c.jsx)(dn.Z,{value:u.newEmail,onChange:d,onSubmit:l,showClearButton:!0,onClearButtonClick:r,placeholder:i.formatMessage({id:"profileSettings.changeEmailModal.newEmailInput.placeholder",defaultMessage:"Enter new email"}),style:hu.input,focusInitial:!0}):null}function Nu(e){let{state:t,store:s}=e;const i=(0,o.O7)(),a=(0,g.useIntl)(),r=(0,n.useCallback)((()=>Pu(i,a,s)),[i,a,s]);return(0,c.jsxs)(n.Fragment,{children:[t.error&&(0,c.jsx)("div",{style:hu.error,children:t.error}),(0,c.jsx)(Sn.Z,{isLarge:!0,style:hu.button,onClick:r,disabled:t.loading,children:t.loading?(0,c.jsx)(Pi.Z,{}):(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.sendVerificationCodeButton.label",defaultMessage:"Send verification code"})})]})}function Eu(e){let{state:t,userValue:s,store:i}=e;return(0,c.jsxs)(n.Fragment,{children:[(0,c.jsxs)("p",{style:{...hu.paragraph,marginTop:0},children:[(0,c.jsx)(Su,{userValue:s})," ",t.currentEmailPasscodeSent?(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.sentVerificationCodeToCurrentEmail",defaultMessage:"We've sent a temporary verification code to this email."}):(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.sendVerificationCodeToCurrentEmail",defaultMessage:"We'll send a temporary verification code to this email."})]}),t.currentEmailPasscodeSent?(0,c.jsx)(Lu,{userValue:s,store:i,state:t}):(0,c.jsx)(Du,{userValue:s,store:i})]})}var Uu=s(10020);class Wu extends E.default{getInitialState(){return{open:!1}}}const Ku=new Wu;const zu=function(){const e=(0,o.O7)(),{iconStyle:t}=(0,r.yK)((e=>({iconStyle:{width:20,height:20,fill:e.lightIconColor}})),[]),s=(0,c.jsx)(g.FormattedMessage,{id:"manageActiveSessions.title",defaultMessage:"Log out of all devices"}),n=(0,c.jsx)(g.FormattedMessage,{id:"manageActiveSessions.logOutActiveSessions.label",defaultMessage:"Log out of all other active sessions on other devices besides this one."});return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(bn.Z,{type:"custom",isMobile:!1,title:s,caption:n,customButton:(0,c.jsx)(ve.Z,{style:{borderRadius:"0.25em"},onClick:async()=>{b.AQ(e),await T.logoutActiveSessions(e,{}),Ku.setState({...Ku.state,open:!0})},children:(0,Uu.C)(t)})}),(0,c.jsx)(Gu,{})]})};function qu(){Ku.setState({...Ku.state,open:!1})}function Gu(){const e=(0,a.VK)((()=>Ku.state.open),[]),t=(0,a.VK)((()=>function(){let e;const{currentUserStore:t}=Ke.default.state;return t&&(e=t.getEmail()),e}()),[]);return(0,c.jsx)(_n.Z,{open:e,onDismiss:qu,innerStyle:{width:350,padding:24,display:"flex",flexDirection:"column"},render:()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:{marginBottom:24},children:t?(0,c.jsx)(g.FormattedMessage,{id:"manageActiveSessions.confirmationModal.withEmail",defaultMessage:"You have been logged out from other active sessions for {email}.",values:{email:t}}):(0,c.jsx)(g.FormattedMessage,{id:"manageActiveSessions.confirmationModal.withoutEmail",defaultMessage:"You have been logged out from other active sessions for your account."})}),(0,c.jsx)(Sn.Z,{onClick:qu,children:(0,c.jsx)(g.FormattedMessage,{id:"manageActiveSessions.confirmationModal.close",defaultMessage:"Close"})})]})})}var Hu=s(1799),Yu=s(16010);class Qu extends E.default{getInitialState(){return{step:"backupCodesUninitialized"}}}class $u extends Yu.o{constructor(e,t){super(e,"backupCodes"),this.service=void 0,this.service=t}backupCodesInitialSetup(e){if(!this.checkStep("backupCodesUninitialized"))return;const{onLoadingComplete:t,onComplete:s}=e;this.store.setState({step:"backupCodesLoading"}),this.doCreateBackupCodes({forceRecreate:!1,onComplete:s,onLoadingComplete:t}).catch(this.handleUnexpectedError)}backupCodesShowCreate(){this.checkStep("backupCodesUninitialized")&&this.store.setState({step:"backupCodesRegenerateCodes"})}backupCodesRegenerateCodes(){this.checkStep("backupCodesRegenerateCodes")&&(this.store.setState({step:"backupCodesRegenerateCodes",isLoading:!0}),this.doCreateBackupCodes({forceRecreate:!0,onComplete:()=>{},onLoadingComplete:()=>{}}).catch(this.handleUnexpectedError))}exit(){this.store.setState({step:"backupCodesUninitialized"})}async doCreateBackupCodes(e){const{forceRecreate:t,onComplete:s,onLoadingComplete:n}=e,i=await this.withStep(["backupCodesLoading","backupCodesRegenerateCodes"],(()=>this.service.createBackupCodes(t)));if(!i)return;const{result:o}=i;if("already-exists"===o.status)s();else{const e=function(e){const t=L.default.getIntl(),s=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.title",defaultMessage:"Notion Backup Codes"}),n=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.createdAt",defaultMessage:"Created at {createdAt}"},{createdAt:`${new Date}`}),i=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.warningMessage",defaultMessage:"Please store these in a secure location and mark off codes as they are used."}),o=`${s}\n${n}\n\n${e.map(Hu.K).join("\n")}\n\n${i}\n`;return encodeURIComponent(o)}(o.backupCodes);this.store.setState({step:"backupCodesShowCodes",backupCodes:o.backupCodes,mfaSettingId:o.mfaSettingId,backupCodesFile:e}),n()}}}var Ju=s(75752),Xu=s(88175);function ep(e){let{errorMessage:t,isLoading:s,onDisplayBackupCodes:n,onCancel:i,onDismiss:o}=e;const a=(0,c.jsx)(g.FormattedMessage,{id:"mfa.regenerateBackupCodes.title",defaultMessage:"Regenerate backup codes"}),r=(0,c.jsx)(g.FormattedMessage,{id:"mfa.regenerateBackupCodes.message",defaultMessage:"Backup codes are used to log in if you lose access to your password and second factors. <boldtext>Your existing codes won't work after regenerating new ones.</boldtext>",values:{boldtext:e=>(0,c.jsx)("span",{style:{fontWeight:x.Z.fontWeight.semibold},children:e})}}),l={text:s?(0,c.jsx)(Pi.Z,{}):(0,c.jsx)(g.FormattedMessage,{id:"mfa.regenerateBackupCodes.regenerateBackupCodes.button.message",defaultMessage:"Generate new backup codes"}),onClick:n,view:"outline",disabled:s,isRed:!0},d=[{text:(0,c.jsx)(g.FormattedMessage,{id:"mfa.regenerateBackupCodes.cancel.button.message",defaultMessage:"Cancel"}),onClick:i,view:"outline",type:"button"}];return(0,c.jsx)(Xu.Z,{title:a,header:r,errorMessage:t,primaryAction:l,secondaryActions:d,onDismiss:o})}var tp=s(457);function sp(e){let{backupCodes:t,backupCodeDownload:s,backupCodeFileName:n,errorMessage:i,onNoted:o,onDownload:a}=e;const r=(0,c.jsx)(g.FormattedMessage,{id:"mfa.showBackupCodes.title",defaultMessage:"Save your backup codes"}),l=(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(g.FormattedMessage,{id:"mfa.showBackupCodes.message",defaultMessage:"<boldtext>You can only see this once</boldtext>, so be sure to keep them to avoid getting locked out of your account.",values:{boldtext:e=>(0,c.jsx)("span",{style:{fontWeight:x.Z.fontWeight.semibold},children:e})}})}),d={text:(0,c.jsx)(g.FormattedMessage,{id:"mfa.showBackupCodes.codesNotedDown.button.message",defaultMessage:"I've saved them"}),onClick:o},u=[{text:(0,c.jsx)(g.FormattedMessage,{id:"mfa.showBackupCodes.downloadAsTextFile.button.message",defaultMessage:"Download as text file"}),href:`data:text/plain;charset=UTF-8,${s}`,saveAs:n,view:"outline",type:"link",onClick:a}];return(0,c.jsx)(Xu.Z,{title:r,header:l,errorMessage:i,primaryAction:d,secondaryActions:u,children:(0,c.jsx)(tp.Z,{type:"unencryptedCodes",backupCodes:t})})}function np(e){const{backupCodesStateMachine:t,onGoToSettings:s,onDismiss:n}=e,i=t.useCurrentStep(),o=()=>t.backupCodesRegenerateCodes();switch(i.step){case"backupCodesUninitialized":case"backupCodesLoading":return null;case"backupCodesRegenerateCodes":return(0,c.jsx)(ep,{isLoading:i.isLoading,errorMessage:i.error,onDisplayBackupCodes:o,onDismiss:n,onCancel:s});case"backupCodesShowCodes":return(0,c.jsx)(sp,{errorMessage:i.error,backupCodes:i.backupCodes,backupCodeDownload:i.backupCodesFile,backupCodeFileName:"Notion Backup Codes.txt",onNoted:s});default:return(0,fs.t1)(i)}}var ip=s(64898),op=s(3338);function ap(e){let{type:t,errorMessage:s,onDismiss:n,onAddMethod:i}=e;const o=(0,r.yK)(rp,[]),a=(0,c.jsx)(g.FormattedMessage,{id:"mfa.setupComplete.confirmation.header",defaultMessage:"Every time you enter your password, Notion will ask you for a verification code to confirm your identity."}),l=[{text:(0,c.jsx)(g.FormattedMessage,{id:"mfa.setupComplete.confirmation.viewTwoStepMethods.button.message",defaultMessage:"View 2-step methods"}),onClick:i,type:"button",view:"outline"}];return(0,c.jsx)(Xu.Z,{title:"totp"===t?(0,c.jsx)(g.FormattedMessage,{id:"mfa.totp.setupComplete.confirmation.title",defaultMessage:"2-step verification with authenticator is turned on"}):"sms"===t?(0,c.jsx)(g.FormattedMessage,{id:"mfa.sms.setupComplete.confirmation.title",defaultMessage:"2-step verification with phone number is turned on"}):(0,fs.t1)(t),header:a,errorMessage:s,icon:(0,op.p)(o.confirmationIcon),secondaryActions:l,onDismiss:n})}function rp(e){return(0,r.EM)({confirmationIcon:{width:30,fill:"green"}})}s(30541);var lp=s(4387);const dp={name:"United States",countryCode:"1",regionCode:"US"};function cp(e){let{isLoading:t,phoneNumber:s,country:i,errorMessage:o,onDismiss:l,onBack:d,onContinue:u}=e;const p=(0,r.yK)(up,[]),m=(0,g.useIntl)(),[h,f]=(0,n.useState)(s??""),[x,y]=(0,n.useState)([]),[S,v]=(0,n.useState)(""),[b,M]=(0,n.useState)(i??dp),j=(0,a.qz)(void 0,ya.Z),C=(0,n.useMemo)((()=>(0,lp.PG)(b.regionCode)),[b.regionCode]),w=(0,n.useCallback)((e=>{const t=e.target.value.replace(/\D/g,"");f(C.reset(t))}),[C]);(0,n.useEffect)((()=>{f(i!==b?C.reset(h??""):C.reset(s??""));const e=new Intl.DisplayNames(["en"],{type:"region"}),t=(0,lp.wJ)();let n=-1;const o=t.map(((t,s)=>{const i=(0,lp.t7)(t).toString(),o=e.of(t);return t===b.regionCode&&(n=s),{name:o??t,countryCode:i,regionCode:t}}));-1!==n&&o.unshift(o.splice(n,1)[0]),y(o)}),[b]);const T=(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneTitle",defaultMessage:"Add a phone number"}),I=(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneHeader",defaultMessage:"Enter your phone number to receive a 2-step verification code."}),Z={text:t?(0,c.jsx)(Pi.Z,{}):(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.sms.continueButton",defaultMessage:"Continue"}),onClick:()=>u(b,h.trim()),disabled:t||""===h},P=[{text:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneNeedHelp",defaultMessage:"Need help?"}),href:(0,Ue.UY)("guides.mfa"),isExternal:!0,type:"link",view:"plain"}],F=m.formatMessage({id:"profileSettings.mfa.sms.phoneNumberInput.placeholder",defaultMessage:"Enter phone number"}),A=m.formatMessage({defaultMessage:"Search country code",id:"profileSettings.mfa.sms.countryCodeSelect.placeholder"}),_=e=>(0,c.jsxs)("div",{style:p.countryCodeSelectTitle,children:[e.name,(0,c.jsx)(Me.Z,{isSmall:!0,children:`+${e.countryCode}`})]}),R=(0,c.jsx)(_o.ZP,{popupType:_o.Z4.Popup,placementToOrigin:Ll.Iw.Bottom,alignmentToOrigin:Ll.lU.Start,buttonPopupStore:j,renderOrigin:e=>(0,c.jsx)(Ri.Z,{...e,children:`+${b.countryCode}`}),render:e=>(0,c.jsx)($s.Z,{menuType:Hs.og.Popup,minWidth:280,maxHeight:"30vh",header:(0,c.jsx)(tn.Z,{isInput:!0,children:(0,c.jsx)(Vl.ZP,{value:S,onChange:e=>v(e.target.value),focus:!0,focusAfterAnimation:!0,placeholder:A})}),children:(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,initialFocus:0,sections:[{key:"countries",render:e=>(0,c.jsx)(tn.Z,{...e}),items:(0,td.ZP)(S,x,(e=>/\d/.test(S)?`${e.countryCode}`:e.name)).map((t=>({key:t.regionCode,render:e=>(0,c.jsx)(Qs.Z,{...e,title:_(t),right:t.name===b.name?(0,Da.k)(p.selectedCountryCodeIcon):void 0}),action:()=>{v(""),M(t),e.close()}})))}]})})});return(0,c.jsx)(Xu.Z,{onDismiss:l,onBack:d,title:T,header:I,errorMessage:o,primaryAction:Z,secondaryActions:P,children:(0,c.jsxs)("div",{style:p.container,children:[(0,c.jsx)("div",{style:p.countryCodeDropdownMenu,children:R}),(0,c.jsx)(dn.Z,{autoFocus:!0,value:h,placeholder:F,spellCheck:!1,style:p.phoneNumberInput,onChange:w,disabled:t,customElementAttributes:k.pf})]})})}function up(e){return(0,r.EM)({container:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:16,marginBottom:4},countryCodeDropdownMenu:{marginRight:5},selectedCountryCodeIcon:{width:15,height:15},countryCodeSelectTitle:{paddingTop:8,paddingBottom:8},phoneNumberInput:{background:"light"===e.mode?Ks.ZP.transparent:e.inputBackground}})}var pp=s(56839);function mp(e){const{smsStateMachine:t,onGoToSettings:s,onDismiss:n,onStartBackupCodes:i}=e,o=t.useCurrentStep();switch(o.step){case"smsUninitialized":case"smsVerified":return null;case"smsSendingSMS":case"smsSetPhoneNumber":return(0,c.jsx)(cp,{phoneNumber:o.phoneNumber,country:o.country,isLoading:"smsSendingSMS"===o.step,errorMessage:o.error,onDismiss:n,onBack:s,onContinue:(e,s)=>t.smsCreateSMS(e,s)});case"smsVerifyCode":case"smsResendSMS":case"smsBackupCodesLoading":case"smsVerifying":return(0,c.jsx)(pp.ZP,{isLoading:"smsVerifying"===o.step||"smsBackupCodesLoading"===o.step,errorMessage:o.error,phoneNumber:`+${o.country.countryCode} ${o.phoneNumber}`,onDismiss:n,onBack:()=>t.smsRestart(),onVerifyCode:e=>t.smsVerifyCode({code:e,onVerified:i}),resentStatus:"smsResendSMS"===o.step?"resending":"resentAt"in o&&void 0!==o.resentAt?"resent":"not-resent",resentAt:"resentAt"in o&&o.resentAt?o.resentAt:0,onResendLink:()=>t.smsResendSMS()});case"smsComplete":return(0,c.jsx)(ap,{type:"sms",errorMessage:o.error,onAddMethod:s,onDismiss:n});default:return(0,fs.t1)(o)}}function gp(e){const{placeholder:t,value:s,maxlength:n,style:i,onChange:o}=e,a=(0,r.yK)((e=>(0,r.EM)({input:{background:Ks.ZP.transparent,color:e.darkTextColor,...i}})),[i]);return(0,c.jsx)(dn.Z,{value:s,placeholder:t,maxlength:n,style:a.input,inputStyle:x.Z.textOverflowStyle,autoFocus:!0,spellCheck:!1,onChange:o,autoComplete:"off",customElementAttributes:k.pf})}function hp(e){let{isLoading:t,qrCode:s,friendlyName:i,errorMessage:o,onDismiss:a,onBack:l,onCantScanCode:d,onContinue:u}=e;const p=(0,r.yK)(fp,[]),m=(0,g.useIntl)(),[h,f]=(0,n.useState)(i??""),x=(0,n.useCallback)((e=>{f(e.target.value)}),[f]),y=(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeTitle",defaultMessage:"Scan code in authenticator app"}),S=(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeHeader",defaultMessage:"Generate a verification code with an authenticator app, then enter a name to remember it by."}),v={text:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.totp.continueButton",defaultMessage:"Continue"}),onClick:()=>u(h),disabled:!s||t||0===h.length},b=[{text:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.totp.cantScanCodeButton",defaultMessage:"Can't scan code?"}),onClick:d,type:"button",view:"plain",disabled:t}],M=m.formatMessage({id:"profileSettings.mfa.totp.authenticatorNameInput.placeholder",defaultMessage:"Enter authenticator name"});return(0,c.jsx)(Xu.Z,{onDismiss:a,onBack:l,title:y,header:S,errorMessage:o,primaryAction:v,secondaryActions:b,children:(0,c.jsxs)("div",{style:p.body,children:[(0,c.jsx)("div",{style:p.qrCodeContainer,children:s?(0,c.jsx)("img",{style:p.qrCode,src:s}):(0,c.jsx)(Pi.Z,{})}),(0,c.jsx)(gp,{placeholder:M,value:h,maxlength:30,onChange:x})]})})}function fp(e){return(0,r.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},qrCodeContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:116,height:116,marginBottom:15},qrCode:{width:"100%"}})}function xp(e){let{textCode:t,friendlyName:s,errorMessage:i,isLoading:o,onDismiss:a,onBack:l,onUseQrCode:d,onContinue:u}=e;const p=(0,r.yK)(yp,[]),[m,h]=(0,n.useState)(s??""),f=(0,g.useIntl)(),x=(0,n.useCallback)((e=>{h(e.target.value)}),[h]),y=(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.totp.typeTextCodeTitle",defaultMessage:"Type code from authenticator app"}),S=(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.totp.typeText.message",defaultMessage:"Input this setup key in your authenticator app, then enter a name to remember it by.",values:{authenticatorlink:e=>(0,c.jsx)(vn.Z,{external:!0,href:(0,Ue.UY)("guides.mfa"),children:e})}}),v={text:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.totp.continueButton",defaultMessage:"Continue"}),onClick:()=>u(m),disabled:o||0===m.length},b=[{text:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeButton",defaultMessage:"Scan QR code"}),onClick:d,type:"button",view:"plain",disabled:o}],M=f.formatMessage({id:"profileSettings.mfa.totp.authenticatorNameInput",defaultMessage:"Enter authenticator name"});return(0,c.jsx)(Xu.Z,{onDismiss:a,onBack:l,title:y,header:S,errorMessage:i,primaryAction:v,secondaryActions:b,children:(0,c.jsxs)("div",{style:p.body,children:[(0,c.jsx)("div",{style:p.content,children:(0,c.jsx)("div",{style:p.textCode,children:t})}),(0,c.jsx)(gp,{placeholder:M,value:m,maxlength:30,onChange:x})]})})}function yp(e){return(0,r.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},textCode:{fontWeight:x.Z.fontWeight.medium,fontSize:x.Z.fontSize.UIRegular.desktop,color:e.darkTextColor,textAlign:"center",verticalAlign:"middle"},content:{display:"flex",flexDirection:"column",justifyContent:"center",height:50,marginBottom:15}})}var Sp=s(18469);function vp(e){const{totpStateMachine:t,onGoToSettings:s,onStartBackupCodes:n,onDismiss:i}=e,o=t.useCurrentStep();switch(o.step){case"totpUninitialized":case"totpVerified":return null;case"totpLoadingQRCode":case"totpDisplayQRCode":const e="totpLoadingQRCode"===o.step?{isLoading:!0,qrCode:void 0}:{isLoading:o.isLoading,qrCode:o.qrCode};return(0,c.jsx)(hp,{...e,friendlyName:"totpDisplayQRCode"===o.step?o.friendlyName:void 0,errorMessage:o.error,onDismiss:i,onBack:s,onCantScanCode:()=>t.totpDisplayTextCode(),onContinue:e=>t.totpDisplayVerification(e)});case"totpDisplayTextCode":return(0,c.jsx)(xp,{textCode:o.rawString,friendlyName:o.friendlyName,errorMessage:o.error,isLoading:o.isLoading,onDismiss:i,onBack:s,onUseQrCode:()=>t.totpDisplayQRCode(),onContinue:e=>t.totpDisplayVerification(e)});case"totpVerifyCode":case"totpBackupCodesLoading":case"totpVerifying":return(0,c.jsx)(Sp.ZP,{isLoading:"totpVerifying"===o.step||"totpBackupCodesLoading"===o.step,errorMessage:o.error,onDismiss:i,onBack:()=>t.totpDisplayQRCode(),onVerifyCode:e=>t.totpVerifyCode({code:e,onVerified:n})});case"totpComplete":return(0,c.jsx)(ap,{type:"totp",errorMessage:o.error,onDismiss:i,onAddMethod:s});default:return(0,fs.t1)(o)}}function bp(e){const{rootStateMachine:t,settingsStateMachine:s,totpStateMachine:i,smsStateMachine:o,backupCodesStateMachine:a,onReloadSettings:r}=e,l=t.useCurrentStep(),[{showSettings:d,onRootExit:u}]=(0,n.useState)((()=>({onRootExit:()=>t.exit((()=>{s.exit(),i.exit(),o.exit(),a.exit(),r&&r()})),showSettings:()=>t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{s.settingsConfirmIdentityForSettings()}})}))),p=()=>t.rootCloseSettings((()=>{s.exit(),r&&r()})),m=()=>t.rootStartTOTP((()=>i.totpStart())),g=()=>t.rootStartSMS((()=>o.smsStart())),h=()=>{t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{i.exit(),s.settingsShow({refresh:!0})}})},f=()=>{t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{o.exit(),s.settingsShow({refresh:!0})}})},x=()=>{a.exit(),t.rootEndBackupCodes({completeTotp:()=>{i.totpComplete()},completeSMS:()=>{o.smsComplete()},showSettings:d})},y=()=>{a.backupCodesInitialSetup({onLoadingComplete:()=>{i.totpBackupCodesComplete(),t.rootShowBackupCodesFromTOTP()},onComplete:()=>{i.totpBackupCodesComplete(),i.totpComplete(),x()}})},S=()=>{a.backupCodesInitialSetup({onLoadingComplete:()=>{o.smsBackupCodesComplete(),t.rootShowBackupCodesFromSMS()},onComplete:()=>{o.smsBackupCodesComplete(),o.smsComplete(),x()}})},v=()=>{t.rootStartBackupCodesFromSettings((()=>a.backupCodesShowCreate()))},b=s.useCurrentStep(),M=i.useCurrentStep(),j=o.useCurrentStep(),C=a.useCurrentStep();let w;switch(l.step){case"rootUninitialized":break;case"rootSettings":w={open:"settingsUninitialized"!==b.step,onDismiss:u,render:()=>(0,c.jsx)(ip.Z,{settingsStateMachine:s,onDismiss:p,onStartTOTP:m,onStartSMS:g,onStartBackupCodes:v})};break;case"rootTOTP":w={open:"totpUninitialized"!==M.step,onDismiss:u,render:()=>(0,c.jsx)(vp,{totpStateMachine:i,onGoToSettings:h,onStartBackupCodes:y,onDismiss:u})};break;case"rootSMS":w={open:"smsUninitialized"!==j.step,onDismiss:u,render:()=>(0,c.jsx)(mp,{smsStateMachine:o,onGoToSettings:f,onStartBackupCodes:S,onDismiss:u})};break;case"rootBackupCodes":w={open:"backupCodesUninitialized"!==C.step,onDismiss:"backupCodesRegenerateCodes"===C.step?u:void 0,render:()=>(0,c.jsx)(np,{backupCodesStateMachine:a,onGoToSettings:x,onDismiss:u})};break;default:throw(0,fs.t1)(l)}return w?(0,c.jsx)(_n.Z,{...w,preventHideChildrenWhileOpening:!0}):null}class Mp extends E.default{getInitialState(){return{step:"rootUninitialized"}}}class jp extends Yu.o{constructor(e){super(e,"root")}rootShowSettings(e){const{refresh:t,startConfirmIdentity:s}=e;if(this.checkStep("rootSettings")){if(!t)return}else this.store.setState({step:"rootSettings"});s()}rootStartBackupCodesFromSettings(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootBackupCodes",source:"settings"}),e())}rootStartTOTP(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootTOTP"}),e())}rootShowBackupCodesFromTOTP(){this.checkStep("rootTOTP")&&this.store.setState({step:"rootBackupCodes",source:"totp"})}rootStartSMS(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootSMS"}),e())}rootShowBackupCodesFromSMS(){this.checkStep("rootSMS")&&this.store.setState({step:"rootBackupCodes",source:"sms"})}rootEndBackupCodes(e){const t=this.checkStep("rootBackupCodes");if(t)switch(t.source){case"settings":return this.store.setState({step:"rootSettings"}),e.showSettings();case"sms":return this.store.setState({step:"rootSMS"}),e.completeSMS();case"totp":return this.store.setState({step:"rootTOTP"}),e.completeTotp();default:(0,fs.t1)(t.source)}}rootCloseSettings(e){e(),this.store.setState({step:"rootUninitialized"})}exit(e){this.store.setState({step:"rootUninitialized"}),e()}}var Cp=s(24173),wp=s(49682);class kp extends E.default{getInitialState(){return{step:"smsUninitialized"}}}class Tp extends Yu.o{constructor(e,t){super(e,"sms"),this.service=void 0,this.service=t}smsStart(){this.checkStep("smsUninitialized")&&this.store.setState({step:"smsSetPhoneNumber"})}smsRestart(){const e=this.checkStep(["smsResendSMS","smsVerifyCode","smsVerifying"]);e&&this.store.setState({step:"smsSetPhoneNumber",country:e.country,phoneNumber:e.phoneNumber,error:void 0})}smsCreateSMS(e,t){this.checkStep("smsSetPhoneNumber")&&(this.store.setState({country:e,phoneNumber:t,step:"smsSendingSMS"}),this.doCreateSMS().catch(this.handleUnexpectedError))}smsResendSMS(){const e=this.checkStep(["smsVerifyCode","smsVerifying"]);e&&(this.store.setState({...e,step:"smsResendSMS",error:void 0}),this.doResendSMS().catch(this.handleUnexpectedError))}smsVerifyCode(e){const{code:t,onVerified:s}=e,n=this.checkStep("smsVerifyCode");n&&(this.store.setState({...n,step:"smsVerifying",error:void 0}),this.doVerifyCode({code:t,onVerified:s}).catch(this.handleUnexpectedError))}smsBackupCodesComplete(){this.checkStep("smsBackupCodesLoading")&&this.store.setState({step:"smsVerified"})}smsComplete(){this.checkStep("smsVerified")&&this.store.setState({step:"smsComplete"})}exit(){this.store.setState({step:"smsUninitialized"})}async doCreateSMS(){const e=await this.withStep("smsSendingSMS",(e=>this.service.createSMS(e.country.countryCode,e.phoneNumber)));if(!e)return;const{result:t,state:s}=e;switch(t.status){case"created":this.store.setState({...s,step:"smsVerifyCode",mfaSettingId:t.mfaSettingId,error:void 0});break;case"already_verified_phone_number":this.store.setState({step:"smsSetPhoneNumber",error:wp.Qj.smsAlreadyVerifiedPhoneNumber});break;case"invalid_country_code":this.store.setState({step:"smsSetPhoneNumber",error:wp.Qj.smsInvalidCountryCode});break;case"invalid_phone_number":this.store.setState({step:"smsSetPhoneNumber",error:wp.Qj.smsInvalidPhoneCode});break;case"sms_unsupported_country_code_for_enrollment":this.store.setState({step:"smsSetPhoneNumber",error:wp.Qj.smsUnsupportedCountryCodeForEnrollment});break;default:return(0,fs.t1)(t)}}async doVerifyCode(e){const{code:t,onVerified:s}=e,n=await this.withStep("smsVerifying",(e=>this.service.verifySMS({mfaSettingId:e.mfaSettingId,code:t})));if(!n)return;const{result:i,state:o}=n;switch(i.status){case"match":this.store.setState({step:"smsBackupCodesLoading",country:o.country,phoneNumber:o.phoneNumber}),s();break;case"error":this.store.setState({...o,step:"smsVerifyCode",error:wp.Qj.unexpectedError});break;case"incorrect":this.store.setState({...o,step:"smsVerifyCode",error:wp.Qj.smsIncorrectCode});break;default:return(0,fs.t1)(i.status)}}async doResendSMS(){const e=await this.withStep("smsResendSMS",(e=>this.service.sendSMS({mfaSettingId:e.mfaSettingId})));if(!e)return;const{result:t,state:s}=e;switch(t.status){case"ok":this.store.setState({...s,step:"smsVerifyCode",mfaSettingId:s.mfaSettingId,error:void 0,resentAt:Date.now()});break;case"error":this.store.setState({...s,step:"smsVerifyCode",mfaSettingId:s.mfaSettingId,error:wp.Qj.unexpectedError});break;default:return(0,fs.t1)(t.status)}}}class Ip extends E.default{getInitialState(){return{step:"totpUninitialized"}}}class Zp extends Yu.o{constructor(e,t){super(e,"totp"),this.service=void 0,this.service=t}totpStart(){this.checkStep("totpUninitialized")&&(this.store.setState({step:"totpLoadingQRCode"}),this.doCreateTOTP().catch(this.handleUnexpectedError))}totpDisplayTextCode(){const e=this.getCurrentStep();switch(e.step){case"totpDisplayQRCode":case"totpVerifyCode":this.store.setState({...e,step:"totpDisplayTextCode",error:void 0,isLoading:!1})}}totpDisplayQRCode(){const e=this.getCurrentStep();switch(e.step){case"totpDisplayTextCode":case"totpVerifyCode":this.store.setState({...e,step:"totpDisplayQRCode",error:void 0,isLoading:!1})}}totpDisplayVerification(e){this.checkStep(["totpDisplayQRCode","totpDisplayTextCode"])&&this.doRenameTOTP(e).catch(this.handleUnexpectedError)}totpVerifyCode(e){const{code:t,onVerified:s}=e,n=this.checkStep("totpVerifyCode");n&&(this.store.setState({...n,step:"totpVerifying",error:void 0}),this.doVerifyCode({code:t,onVerified:s}).catch(this.handleUnexpectedError))}totpBackupCodesComplete(){this.checkStep("totpBackupCodesLoading")&&this.store.setState({step:"totpVerified"})}totpComplete(){this.checkStep("totpVerified")&&this.store.setState({step:"totpComplete"})}exit(){this.store.setState({step:"totpUninitialized"})}async doCreateTOTP(){const e=await this.withStep("totpLoadingQRCode",(()=>this.service.createTOTP()));if(!e)return;const{result:t}=e;this.store.setState({step:"totpDisplayQRCode",qrCode:t.qrCode,rawString:t.secret,mfaSettingId:t.mfaSettingId,isLoading:!1})}async doRenameTOTP(e){const t=await this.withStep(["totpDisplayQRCode","totpDisplayTextCode"],(t=>this.service.renameSettings({mfaSettingId:t.mfaSettingId,friendlyName:e})));if(!t)return;const{result:s,state:n}=t;switch(s.status){case"saved":this.store.setState({...n,step:"totpVerifyCode",friendlyName:e,error:void 0});break;case"duplicate":this.store.setState({...n,isLoading:!1,error:wp.Qj.totpDuplicateFriendlyName});break;case"empty":this.store.setState({...n,isLoading:!1,error:wp.Qj.totpEmptyFriendlyName});break;case"bad_friendly_name":this.store.setState({...n,isLoading:!1,error:wp.Qj.totpBadFriendlyName});break;default:return(0,fs.t1)(s)}}async doVerifyCode(e){const{code:t,onVerified:s}=e,n=await this.withStep("totpVerifying",(e=>this.service.verifyTOTP({mfaSettingId:e.mfaSettingId,code:t})));if(!n)return;const{result:i,state:o}=n;switch(i.status){case"match":this.store.setState({step:"totpBackupCodesLoading"}),s();break;case"error":this.store.setState({...o,step:"totpVerifyCode",error:wp.Qj.unexpectedError});break;case"incorrect":this.store.setState({...o,step:"totpVerifyCode",error:wp.Qj.totpIncorrectCode});break;default:return(0,fs.t1)(i.status)}}}function Pp(e){let{status:t,numMfaSettings:s,onReloadSettings:i,regenerateBackupCodes:l}=e;const d=(0,o.O7)(),[{rootStateMachine:u,settingsStateMachine:p,totpStateMachine:m,smsStateMachine:h,backupCodesStateMachine:f}]=(0,n.useState)((()=>{const e=new Ju.r(d),t={totpStore:new Ip,settingsStore:new Cp.c,smsStore:new kp,backupCodesStore:new Qu,rootStore:new Mp};return{mfaService:e,rootStateMachine:new jp(t.rootStore),settingsStateMachine:new Cp.W(t.settingsStore,e),totpStateMachine:new Zp(t.totpStore,e),smsStateMachine:new Tp(t.smsStore,e),backupCodesStateMachine:new $u(t.backupCodesStore,e)}})),y=d.device.isMobile,S=(0,r.yK)((e=>({configureButton:{marginTop:y?12:0,marginBottom:y?4:0},regenerateBackupCodesBadge:{fontWeight:x.Z.fontWeight.medium,letterSpacing:0,fontSize:11,color:e.blueColor,background:"light"===e.mode?Ks.ZP.diffBackground:"rgba(35, 131, 226, 0.2)",whiteSpace:"nowrap",width:"fit-content"}})),[y]),v=(0,a.VK)((()=>it.Z.state.highlightedSetting===it.R.TwoStepVerification),[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(bn.Z,{type:"toggleToButton",isMobile:!1,title:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.label",defaultMessage:"2-step verification"}),caption:"on"===t?(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.settingConfigured.message",defaultMessage:"You have {numMfaSettings} verification methods turned on.",values:{numMfaSettings:s}}):(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.message",defaultMessage:"Add an additional layer of security to your account during login."}),isOn:"on"===t,buttonStyle:S.configureButton,buttonLabel:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSettingButton.label",defaultMessage:"Change verification methods"}),onClick:()=>{!function(e){let{rootStateMachine:t,settingsStateMachine:s}=e;t.rootShowSettings({refresh:!1,startConfirmIdentity:()=>s.settingsConfirmIdentityForSettings()})}({rootStateMachine:u,settingsStateMachine:p})},tooltipLabel:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSettingButton.tooltip",defaultMessage:"A password is required to enable 2-step verification"}),disableTooltip:"disabled"!==t,disabled:"disabled"===t,badge:l&&(0,c.jsx)(lu.Z,{style:S.regenerateBackupCodesBadge,content:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.regenerateBackupCodes.badge",defaultMessage:"Regenerate backup codes"})}),shouldHighlight:v}),(0,c.jsx)(bp,{onReloadSettings:i,rootStateMachine:u,settingsStateMachine:p,totpStateMachine:m,smsStateMachine:h,backupCodesStateMachine:f})]})}var Fp=s(60857),Ap=s(13490),_p=s(30045);const Rp=E.default.createClass(!1);const Op=function(e){let{spaceProfileSettingsStore:t,isEducationPlan:s}=e;const i=(0,g.useIntl)(),r=(0,o.O7)(),l=(0,a.qz)(void 0,Rp);return(0,n.useEffect)((()=>{!async function(){const{currentUserStore:e,currentUserSettingsStore:s,currentUserRootStore:n,currentSpaceStore:o}=Ke.default.state;if(e&&s){const n=t.getValueForUser(e,s,i);n&&t.setState({...t.state,...n})}if(n&&o){const e=await(0,Rt.Gh)({environment:r,userRootStore:n}),t=o.canAdmin()&&(e||[]).some((e=>e===Gs.default.pricing.student.productId));l.setState(t)}await I(r,t)}()}),[r,i,l,t]),(0,n.useEffect)((()=>()=>{it.Z.state.highlightedSetting&&it.Z.setState({...it.Z.state,highlightedSetting:void 0})}),[]),(0,a.VK)((()=>ns.Z.state.online),[])?(0,c.jsx)(Wp,{spaceProfileSettingsStore:t,isEducationPlan:s,isEducationStore:l}):(0,c.jsx)(Bp,{})};function Bp(){return(0,c.jsx)(pt.ZP,{children:(0,c.jsx)(Me.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Please go online to manage your profile.",id:"profileSettings.offline.message"})})})}function Dp(e){const{emailDomainForUser:t,spaceProfileSettingsStore:s,areProfileEditsDisabled:n}=e,i=(0,a.VK)((()=>{var e;return Boolean(null===(e=s.state.emailDomainSettings)||void 0===e?void 0:e.isDomainVerified)}),[s]);return(0,c.jsxs)(me.Z,{large:!0,divider:"full",children:[i?(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",margin:"0 0 8px"},children:[(0,c.jsx)(lu.Z,{style:{fontWeight:x.Z.fontWeight.medium,letterSpacing:0,whiteSpace:"nowrap",width:"fit-content",margin:0},content:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.myProfile.managedByline",defaultMessage:"Your account is managed by {domain}",values:{domain:t}})}),n?(0,c.jsx)(be.ZP,{render:e=>(0,c.jsx)("div",{...e,children:(0,ci.D)({marginLeft:4,height:14,width:14,opacity:.5})}),renderTooltip:()=>(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.myProfile.managedByTooltip",defaultMessage:"Contact your organization's administrator to change your profile information."})}):null]}):null,(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.myProfile.title",defaultMessage:"My profile"})]})}function Lp(e){let{spaceProfileSettingsStore:t}=e;const[s,n]=(0,a.VK)((()=>{var e;return[(null===(e=t.state.emailDomainSettings)||void 0===e?void 0:e.settings)??{},t.state.emailDomainSettings]}),[t]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(me.Z,{large:!0,divider:"full",children:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.support.title",defaultMessage:"Support"})}),(0,c.jsx)(_p.Z,{emailDomainSettings:s}),(0,c.jsx)(yn.Z,{size:18,isHidden:!0}),(0,c.jsx)(zu,{}),(0,c.jsx)(yn.Z,{size:18,isHidden:!0}),(0,c.jsx)(ru.Z,{userEmailDomainSettings:n})]})}function Vp(e,t){b.He(t),au.cR({environment:t,onStart:()=>function(e){e.setState({...e.state,uploadingProfilePhoto:!0})}(e),bucket:"public",onError:()=>function(e){e.setState({...e.state,uploadingProfilePhoto:!1}),M.showErrorMessage((0,c.jsx)(g.FormattedMessage,{id:"profileSettings.profilePhotoSection.uploadProfilePhotoError.message",defaultMessage:"Upload failed."}))}(e),onComplete:s=>function(e,t,s){const n=e[0];t.setState({...t.state,profilePhoto:n,uploadingProfilePhoto:!1}),P.createAndCommit({userAction:"SpaceProfileSettings.handleUploadComplete",environment:s,perform:e=>{const{currentUserStore:t}=Ke.default.state;t&&S.A({userStore:t,data:{profilePhoto:n},transaction:e})}})}(s,e,t),accept:"image/*"})}function Np(e){const t=(0,o.O7)(),{userName:s,emailDomainForUser:n,areProfileEditsDisabled:i,spaceProfileSettingsStore:a}=e;return i?(0,c.jsx)(be.ZP,{renderTooltip:()=>(0,c.jsx)(g.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",values:{emailDomain:n}}),placement:be.ug.Bottom,alignment:be.v2.Center,render:e=>(0,c.jsx)("div",{...e,style:{opacity:.4},children:(0,c.jsx)(dn.Z,{disabled:!0,value:s})})}):(0,c.jsx)(dn.Z,{value:s,onChange:e=>function(e,t,s){const n=e.target.value;b.O$(s,{from:t.state.name,to:n}),t.setState({...t.state,name:n}),P.createAndCommit({userAction:"SpaceProfileSettings.handleNameChange",environment:s,perform:e=>{const{currentUserStore:t}=Ke.default.state;t&&S.A({userStore:t,data:{name:n},transaction:e})}})}(e,a,t)})}function Ep(e){let{currentUserValue:t,spaceProfileSettingsStore:s,isEducationPlan:i,isEducationStore:r}=e;const l=(0,o.O7)(),d=(0,a.VK)((()=>s.state.accountSettings),[s]),u=(0,a.VK)((()=>{var e;return Boolean(null===(e=s.state.emailDomainSettings)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.prevent_profile_edits)}),[s]),p=(0,n.useCallback)((()=>{I(l,s)}),[l,s]),m=(0,a.VK)((()=>r.state),[r]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(me.Z,{large:!0,divider:"full",children:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.accountSecurity.title",defaultMessage:"Account security"})}),(0,c.jsx)(yu,{userValue:t,hasEducationPlan:m,areProfileEditsDisabled:u}),(0,c.jsx)(yn.Z,{size:18,isHidden:!0}),(0,c.jsx)(Fp.Z,{hasPassword:d.hasPassword,hasPasswordActions:d.canConfigurePassword,isEducationPlan:i,samlEnforced:d.isSamlEnforced,email:t.email,isError:Boolean(d.error),onReloadSettings:p,mfaStatus:d.mfaStatus}),(0,c.jsx)(yn.Z,{size:18,isHidden:!0}),(0,c.jsx)(Pp,{status:d.mfaStatus,numMfaSettings:d.numMfaSettings,onReloadSettings:p,regenerateBackupCodes:d.regenerateBackupCodes})]})}function Up(e){const{userName:t,currentUserStore:s,currentUserValue:n,spaceProfileSettingsStore:i,isEducationPlan:l,isEducationStore:d}=e,u=(0,r.Fg)(),p=(0,o.O7)(),m=(0,g.useIntl)(),h=(0,a.VK)((()=>(0,du.N5)(s,m)),[s,m]),f=(0,Ra.Gd)(n.email),x=(0,a.VK)((()=>{var e;return Boolean(null===(e=i.state.emailDomainSettings)||void 0===e||null===(e=e.settings)||void 0===e?void 0:e.prevent_profile_edits)}),[i]),y=(0,a.VK)((()=>ns.Z.state.online),[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Dp,{spaceProfileSettingsStore:i,emailDomainForUser:f,areProfileEditsDisabled:x}),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,c.jsx)(du.ZP,{size:60,avatarType:h,isOffline:!y,onUploadProfilePhoto:()=>Vp(i,p),onRemoveProfilePhoto:()=>function(e,t){e.setState({...e.state,profilePhoto:void 0}),P.createAndCommit({userAction:"SpaceProfileSettings.handleRemoveProfilePhoto",environment:t,perform:e=>{const{currentUserStore:t}=Ke.default.state;t&&S.A({userStore:t,data:{profilePhoto:null},transaction:e})}})}(i,p),disabled:x,disabledTooltipMessage:(0,c.jsx)(g.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",values:{emailDomain:f}})}),(0,c.jsxs)("div",{style:{marginLeft:20,width:250},children:[(0,c.jsx)(Ap.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"profileSettings.personalInfoSection.nameInput.label",defaultMessage:"Preferred name"})}),(0,c.jsx)(Np,{spaceProfileSettingsStore:i,userName:t,emailDomainForUser:f,areProfileEditsDisabled:x})]})]}),"photo"!==h.type&&!x&&(0,c.jsx)("div",{style:{color:u.mediumIconColor,fontSize:14,marginTop:8},children:(0,c.jsx)(g.FormattedMessage,{id:"editableUserAvatar.profilePhoto.addPhoto",defaultMessage:"Add photo"})})]}),(0,c.jsx)(yn.Z,{size:48,isHidden:!0}),(0,c.jsx)(Ep,{spaceProfileSettingsStore:i,isEducationPlan:l,isEducationStore:d,currentUserValue:n}),(0,c.jsx)(yn.Z,{size:48,isHidden:!0}),(0,c.jsx)(Lp,{spaceProfileSettingsStore:i})]})}function Wp(e){let{spaceProfileSettingsStore:t,isEducationPlan:s,isEducationStore:n}=e;const{currentUserStore:i}=(0,a.VK)((()=>Ke.default.state),[]),o=(0,a.VK)((()=>i?i.getValue():void 0),[i]),{name:r}=(0,a.VK)((()=>t.state),[t]);return i&&o?(0,c.jsx)(pt.ZP,{children:(0,c.jsx)(Up,{spaceProfileSettingsStore:t,isEducationPlan:s,isEducationStore:n,currentUserStore:i,currentUserValue:o,userName:r})}):null}var Kp=s(91536);function zp(e){let{spaceStore:t,subscriptionData:s}=e;return(0,a.VK)((()=>t.canAdmin()&&m.wP(s.subscriptionTier)),[s,t])}function qp(e){let{spaceStore:t}=e;return(0,a.VK)((()=>t.canAdmin()),[t])}function Gp(e){let{spaceStore:t}=e;return(0,a.VK)((()=>t.canEditMembership()),[t])}function Hp(){const e=(0,o.O7)();return(0,a.VK)((()=>{const t=Bt.subscriptionDataStoreInstance.state,s=Boolean(t&&Rt.YK(t));return Rt.qF(e)&&s}),[e])}var Yp=s(76781),Qp=s(41977);function $p(e){let{spaceStore:t,spacePermissionsSettingsStore:s,groups:n}=e;const{isTeamsEnabled:i,canUseGroups:o,canEditGroups:r,isSpaceStoreDefined:l}=function(e){let{spaceStore:t}=e;const s=(0,We.Gc)(),n=Hp(),{canEditMembership:i,isSpaceStoreDefined:o}=(0,a.VK)((()=>({canEditMembership:t.canEditMembership(),isSpaceStoreDefined:t.isDefined()})),[t]),r=(0,a.VK)((()=>i&&n),[i,n]);return{isTeamsEnabled:s,canUseGroups:n,canEditMembership:i,canEditGroups:r,isSpaceStoreDefined:o}}({spaceStore:t});return l?(0,c.jsxs)("div",{children:[o?0===n.length&&(0,c.jsx)(Me.Z,{isMultiline:!0,style:{marginTop:17,marginBottom:17},children:i?(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.captionWithTeamsV2",defaultMessage:"Set up groups to streamline page permissions from the share menu and manage teamspace members in bulk."}):(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.caption",defaultMessage:"Set up groups to conveniently control page permissions from the share menu."})}):(0,c.jsx)(wd.Z,{subscriptionTier:"plus",from:"permission_groups",icon:Yp.x,title:(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.upgradeTitle",defaultMessage:"Upgrade to create groups"}),caption:(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.upgradeCaption.plus",defaultMessage:"Upgrade to the Plus Plan to set up groups and control permissions from the share menu."}),learnMoreRoute:"guides.groups"}),(0,c.jsx)(Qp.Z,{spaceStore:t,permissionsSettingsStore:s,groups:n,canEdit:r,containerMarginTop:o?0:void 0})]}):null}const Jp=new(s(51444).q)((e=>{let{spaceId:t}=e;return t}),(async function(e,t){let{spaceId:n}=t;const i=await Promise.resolve().then(s.bind(s,54642)),o=await i.getInternalDomains(e,{spaceId:n});return"success"===o.type?o.data.internalDomains:void 0}));ra.exposeDebugValue("InternalDomainsStore",Jp);const Xp=Jp;var em=s(79362),tm=s(80136),sm=s(70060),nm=s(90334);class im extends E.default{getInitialState(){return{isModalOpen:!1,guests:[],handleClickDecline:()=>{}}}}const om=new im;function am(e){let{guest:t,spaceStore:s,shouldDisableInteraction:i}=e;const{environment:l,styles:d,isSubscribed:u,handleConvertToMemberClick:p,handleRemoveClick:m}=function(e){let{guest:t,spaceStore:s,shouldDisableInteraction:i}=e;const l=(0,r.yK)((e=>({container:{width:"100%",display:"flex",justifyContent:"flex-end",opacity:i?.5:1},button:{display:"flex",width:24,height:24,justifyContent:"center",alignItems:"center",gap:10,paddingLeft:0,paddingRight:0},buttonIcon:{width:20,height:20,fill:e.v2.icon.secondary},upgradeButton:{padding:"0px 6px 0px 8px",width:257},removeMenuDivider:{paddingTop:4,paddingBottom:4,borderTop:`1px solid ${e.v2.stroke.deemphasized}`},removeButton:{width:257,padding:"0px 6px 0px 8px",color:em.Lr[e.mode].red},upgradeIcon:{width:17,height:17}})),[i]),d=(0,a.VK)((()=>{const e=Bt.subscriptionDataStoreInstance.state;return Boolean(e&&Rt.YK(e))}),[]),c=(0,o.O7)(),u=(0,n.useCallback)((()=>{const e=ne.U6.createChildStore(s,{table:B.KJ,id:t.userId}),n=d?"read_and_write":"editor";tm.s({environment:c,guestUserStore:e,role:n,store:s,isConvertToAdmin:!d,origin:"guest_pages_popup"})}),[d,s,c,t.userId]),p=(0,n.useCallback)((()=>{om.setState({...om.state,isModalOpen:!0,guests:[t.userId],handleClickDecline:()=>{Kp.b4(c,{from:"guest",button_name:"confirm_in_dialog",count:1});const e=ne.U6.createChildStore(s,{table:B.KJ,id:t.userId});tm.w({environment:c,guestUserStore:e,store:s})}})}),[s,c,t]);return{environment:c,styles:l,isSubscribed:d,handleConvertToMemberClick:u,handleRemoveClick:p}}({guest:t,spaceStore:s,shouldDisableInteraction:i});return(0,c.jsx)("div",{style:d.container,children:(0,c.jsx)(_o.ZP,{popupType:_o.Z4.Popup,renderOrigin:e=>(0,c.jsx)(Xt.Z,{style:d.button,...e,children:(0,c.jsx)(c.Fragment,{children:(0,nm.O)(d.buttonIcon)})}),onClick:()=>{Kp.b4(l,{from:"guest",button_name:"actions"})},disabled:i,render:()=>(0,c.jsx)("div",{children:(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,initialFocus:void 0,sections:[{key:"upgrade",render:e=>(0,c.jsx)(tn.Z,{...e}),items:[{key:"upgrade",render:e=>(0,c.jsx)(Qs.Z,{...e,buttonStyle:d.upgradeButton,icon:da(d.upgradeIcon),title:(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionguestsTab.upgradeToAdmin",defaultMessage:"Upgrade to {isSubscribed, select, true {member} other {admin}}",values:{isSubscribed:u}})}),action:()=>{p(),Kp.b4(l,{from:"guest",button_name:"upgrade"})}}]},{key:"remove",render:e=>(0,c.jsx)(tn.Z,{...e,style:d.removeMenuDivider}),items:[{key:"remove",render:e=>(0,c.jsx)(Qs.Z,{...e,buttonStyle:d.removeButton,icon:(0,$n.V)(d.upgradeIcon),title:(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionguestsTab.remove",defaultMessage:"Remove from workspace"})}),action:()=>{m(),Kp.b4(l,{from:"guest",button_name:"remove"})}}]}]})})})})}const rm=(0,d.IU)("peopleFillXmark",{viewBox:"0 0 20 20",svg:(0,c.jsx)("path",{d:"M12.2061 6.75684C12.0374 6.75684 11.8916 6.69531 11.7686 6.57227C11.6501 6.44922 11.5908 6.30339 11.5908 6.13477C11.5908 5.96615 11.6523 5.82259 11.7754 5.7041L13.5801 3.89258L11.7754 2.08105C11.6523 1.96257 11.5908 1.81901 11.5908 1.65039C11.5908 1.47721 11.6501 1.33366 11.7686 1.21973C11.8916 1.10124 12.0374 1.04199 12.2061 1.04199C12.3838 1.04199 12.5319 1.10352 12.6504 1.22656L14.4551 3.02441L16.2803 1.21973C16.4033 1.09212 16.5469 1.02832 16.7109 1.02832C16.8841 1.02832 17.0299 1.08984 17.1484 1.21289C17.2669 1.33138 17.3262 1.47493 17.3262 1.64355C17.3262 1.80762 17.2646 1.95117 17.1416 2.07422L15.3369 3.89258L17.1348 5.69727C17.2624 5.82031 17.3262 5.96615 17.3262 6.13477C17.3262 6.30339 17.2646 6.44922 17.1416 6.57227C17.0231 6.69531 16.8796 6.75684 16.7109 6.75684C16.5332 6.75684 16.3828 6.69303 16.2598 6.56543L14.4551 4.76758L12.6572 6.56543C12.5387 6.69303 12.3883 6.75684 12.2061 6.75684ZM1.89746 13.2441C1.51465 13.2441 1.21387 13.1576 0.995117 12.9844C0.776367 12.8112 0.666992 12.5742 0.666992 12.2734C0.666992 11.8314 0.799154 11.3688 1.06348 10.8857C1.33236 10.4027 1.71745 9.94922 2.21875 9.52539C2.72461 9.10156 3.33301 8.75749 4.04395 8.49316C4.75488 8.22884 5.55241 8.09668 6.43652 8.09668C7.3252 8.09668 8.125 8.22884 8.83594 8.49316C9.54688 8.75749 10.153 9.10156 10.6543 9.52539C11.1602 9.94922 11.5475 10.4027 11.8164 10.8857C12.0853 11.3688 12.2197 11.8314 12.2197 12.2734C12.2197 12.5742 12.1104 12.8112 11.8916 12.9844C11.6729 13.1576 11.3721 13.2441 10.9893 13.2441H1.89746ZM6.44336 6.87988C5.94661 6.87988 5.48861 6.74544 5.06934 6.47656C4.65462 6.20768 4.31966 5.84538 4.06445 5.38965C3.8138 4.93392 3.68848 4.4235 3.68848 3.8584C3.68848 3.30241 3.8138 2.80111 4.06445 2.35449C4.31966 1.90332 4.6569 1.54557 5.07617 1.28125C5.49544 1.01693 5.95117 0.884766 6.44336 0.884766C6.9401 0.884766 7.39811 1.01465 7.81738 1.27441C8.23665 1.53418 8.57161 1.88965 8.82227 2.34082C9.07747 2.78743 9.20508 3.28874 9.20508 3.84473C9.20508 4.41439 9.07747 4.92936 8.82227 5.38965C8.57161 5.84538 8.23665 6.20768 7.81738 6.47656C7.39811 6.74544 6.9401 6.87988 6.44336 6.87988Z"})});function lm(e){let{isModalOpen:t,handleDismiss:s,handleConfirm:n,title:i,description:o,ctaText:a}=e;const{styles:l}=function(){const e=(0,r.yK)((e=>({modal:{width:300,overflow:"hidden",borderRadius:5},container:{display:"flex",padding:"20px 20px 12px 20px",flexDirection:"column",width:299,justifyContent:"center",alignItems:"flex-start",gap:20},iconAndTitle:{display:"flex",flexDirection:"column",alignItems:"center",gap:9,width:"100%"},iconContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:36,height:36},icon:{color:e.v2.icon.secondary,fontSize:24,fontWeight:510},title:{color:e.v2.text.primary,textAlign:"center",fontSize:17,fontWeight:590,lineBreak:"anywhere"},description:{color:e.v2.text.secondary,textAlign:"center"},footer:{display:"flex",flexDirection:"column",gap:8,alignItems:"center",width:"100%"},declineButton:{height:32,padding:"0 12px",borderRadius:6,width:"100%",textAlign:"center",alignItems:"center",justifyContent:"center",background:em.Lr[e.mode].red},declineButtonHovered:{background:e.v2.text.ui.red.pressed},declineText:{fontWeight:590,color:e.v2.text.contrast},cancelButton:{display:"flex",height:24,padding:"0px 6px",justifyContent:"center",alignItems:"center",gap:4,textAlign:"center"}})),[]);return{styles:e}}();return(0,c.jsx)(_n.Z,{open:t,innerStyle:l.modal,showCloseIcon:!0,onDismiss:s,render:()=>(0,c.jsx)(Fn.Z,{capture:!0,allowEsc:!0,render:()=>(0,c.jsx)(An.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,render:()=>(0,c.jsxs)("div",{style:l.container,children:[(0,c.jsxs)("div",{style:l.iconAndTitle,children:[(0,c.jsx)("div",{style:l.iconContainer,children:(0,c.jsx)("div",{style:l.icon,children:rm({width:24,height:24})})}),(0,c.jsx)("div",{style:l.title,children:i})]}),(0,c.jsx)("div",{style:l.description,children:o}),(0,c.jsxs)("div",{style:l.footer,children:[(0,c.jsx)(Xt.Z,{style:l.declineButton,onClick:()=>{n(),s()},hoveredStyle:l.declineButtonHovered,children:(0,c.jsx)("div",{style:l.declineText,children:a})}),(0,c.jsx)(Xt.Z,{style:l.cancelButton,onClick:s,children:(0,c.jsx)("div",{children:(0,c.jsx)(g.FormattedMessage,{id:"BulkDeclineConfirmationDialog.cancel",defaultMessage:"Cancel"})})})]})]})})})})}function dm(){const{isModalOpen:e,handleClickDecline:t,handleDismiss:s,guests:i,firstGuestName:r}=function(){const{isModalOpen:e,guests:t,handleClickDecline:s}=(0,a.VK)((()=>om.state),[]),i=(0,g.useIntl)(),r=(0,a.VK)((()=>{const{currentSpaceStore:e}=Ke.default.state;if(0===t.length||!e)return;return ne.U6.createChildStore(e,{table:B.KJ,id:t[0]}).getDisplayName(i)}),[t,i]),l=(0,o.O7)(),d=(0,n.useCallback)((()=>{om.reset(),Kp.b4(l,{from:"guest",button_name:"confirm_in_dialog",count:t.length})}),[l,t]);return{isModalOpen:e,guests:t,firstGuestName:r,handleClickDecline:s,handleDismiss:d}}();return 0===i.length?null:(0,c.jsx)(lm,{isModalOpen:e,handleDismiss:s,handleConfirm:t,title:(0,c.jsx)(g.FormattedMessage,{id:"GuestBulkRemoveConfirmationDialog.title",defaultMessage:"Remove {numberOfGuests, plural, one {{firstGuestName}} other {{numberOfGuests} guests}} from the workspace?",values:{numberOfGuests:i.length,firstGuestName:r}}),description:(0,c.jsx)(g.FormattedMessage,{id:"GuestBulkRemoveConfirmationDialog.description",defaultMessage:"They will lose access to all shared pages. To add them as a guest in the future, a request must be submitted, or an admin must invite them."}),ctaText:(0,c.jsx)(g.FormattedMessage,{id:"GuestBulkRemoveConfirmationDialog.remove",defaultMessage:"Remove"})})}var cm=s(87479),um=s(84210);function pm(e){let{guestUserId:t,pageIds:s,spaceStore:n}=e;const{menuListItems:i,styles:l}=function(e){let{guestUserId:t,pageIds:s,spaceStore:n}=e;const i=(0,r.yK)((()=>({container:{width:256},chevron:{marginLeft:8,width:16,height:16}})),[]),l=(0,o.O7)(),d=(0,g.useIntl)(),u=(0,a.VK)((()=>s.map((e=>{var s;const i=ne.G.createChildStore(n,{table:pr.iU,id:e}),o=null===(s=i.getPermissionItems().find((e=>"user_permission"===e.type&&e.user_id===t)))||void 0===s?void 0:s.role;return{key:e,render:e=>(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(Oc.Z,{...e,store:i,placeholder:(0,c.jsx)(g.FormattedMessage,{id:"guestPagesPopup.privatePagePlaceholder",defaultMessage:"Private page"}),caption:o?d.formatMessage((0,cm.kD)(o,"block")):void 0})}),action:()=>{const e=(0,um.ZP)({store:i,fullyQualified:!1,pageVisitSource:tr.tY.LinkInPage});gr.c4({environment:l,url:e,openInNew:"tab"})}}}))),[n,s,t,l,d]);return{menuListItems:u,styles:i}}({guestUserId:t,pageIds:s,spaceStore:n});return(0,c.jsx)("div",{style:l.container,children:(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,initialFocus:void 0,sections:[{key:"pages",render:e=>(0,c.jsx)(tn.Z,{...e}),items:i}]})})}function mm(e){let{from:t,guestUserId:s,pageIds:n,spaceStore:i,shouldDisableInteraction:a}=e;const{styles:l}=function(e){let{shouldDisableInteraction:t}=e;const s=(0,r.yK)((e=>({button:{opacity:t?.5:1,color:e.v2.text.secondary},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[t]);return{styles:s}}({shouldDisableInteraction:a}),d=(0,o.O7)(),u=n.length;return 0===u?(0,c.jsx)(Xt.Z,{disabled:!0,style:l.button,children:(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionguestsTab.GuestPagesButton.noPages",defaultMessage:"No pages"})}):(0,c.jsx)(_o.ZP,{popupType:_o.Z4.Popup,onClick:()=>{Kp.b4(d,{from:t,button_name:"open_pages"})},renderOrigin:e=>(0,c.jsxs)(Xt.Z,{...e,style:l.button,children:[(0,c.jsx)(g.FormattedMessage,{id:"GuestPagesButton.button",defaultMessage:"{numOfPages, plural, one {{numOfPages} page} other {{numOfPages} pages}}",values:{numOfPages:u}}),(0,yr.i)(l.chevron)]}),disabled:a,render:()=>(0,c.jsx)(pm,{pageIds:n,guestUserId:s,spaceStore:i})})}function gm(e){let{guest:t,spaceStore:s,shouldDisableInteraction:n}=e;const{pageIds:i,guestUserId:o}=function(e){let{guest:t,spaceStore:s}=e;return{pageIds:t.guestPageIds,guestUserId:t.userId}}({guest:t,spaceStore:s});return(0,c.jsx)(mm,{pageIds:i,guestUserId:o,spaceStore:s,shouldDisableInteraction:n,from:"guest"})}const hm=10,fm=10,xm=5,ym=(0,d.CZ)("checkmarkShieldFill",{default:{loader:()=>s.e(2692).then(s.bind(s,32692)),size:20},small:{loader:()=>s.e(1812).then(s.bind(s,21812)),size:16},mini:{loader:()=>s.e(3016).then(s.bind(s,98455)),size:14},large:{loader:()=>s.e(5661).then(s.bind(s,21763)),size:24}});var Sm=s(81254),vm=s(7124),bm=s(44156),Mm=s(88978);function jm(e){let{userId:t,spaceStore:s,restorationStatus:i,isInternalGuest:o}=e;const{name:l,email:d,userStore:u,styles:p}=function(e){let{userId:t,spaceStore:s}=e;const n=(0,r.yK)((e=>({container:{display:"flex",alignItems:"center",fontSize:x.Z.fontSize.UIRegular.desktop,width:"100%",justifyContent:"space-between"},titleContainer:{maxWidth:163},userAvatarWrapper:{position:"relative"},userAvatarIcon:{position:"absolute",left:17,top:18},userName:{height:17,alignSelf:"stretch",fontSize:x.Z.fontSize.UIRegular.desktop,fontStyle:"normal",fontWeight:510,lineHeight:"18px",...x.Z.textOverflowStyle},userEmail:{height:17,alignSelf:"stretch",fontSize:x.Z.fontSize.UISmall.desktop,fontStyle:"normal",fontWeight:400,lineHeight:"15px",color:e.v2.text.secondary,...x.Z.textOverflowStyle},nameContainer:{display:"flex",alignItems:"center",gap:10,marginTop:4,marginBottom:4}})),[]),i=(0,g.useIntl)(),o=ne.U6.createChildStore(s,{table:B.KJ,id:t}),{name:l,email:d}=(0,a.VK)((()=>({name:o.getDisplayName(i),email:o.getEmail()})),[o,i]);return{name:l,email:d,styles:n,userStore:o}}({userId:t,spaceStore:s}),m=(0,a.VK)((()=>(0,je.Mo)()),[]),[h,f]=(0,n.useState)(!1);return(0,c.jsxs)("div",{style:p.container,children:[(0,c.jsxs)("div",{style:p.nameContainer,children:[(0,c.jsxs)("div",{style:p.userAvatarWrapper,children:[(0,c.jsx)(Rn.Z,{userStore:u,size:28}),o&&(0,c.jsx)(be.ZP,{style:{width:250},textWrap:!0,placement:be.ug.Right,alignment:be.v2.Start,render:e=>(0,c.jsx)("div",{...e,style:p.userAvatarIcon,children:(0,c.jsx)(Sm.x,{iconGroup:ym,colorName:"secondary",variantName:"mini"})}),renderTooltip:()=>(0,c.jsxs)("div",{children:[(0,c.jsx)(vm.q,{styleName:"Body-12px/Medium",colorName:"contrast",children:(0,c.jsx)(g.FormattedMessage,{id:"userCell.internalGuest.tooltip.title",defaultMessage:"Using an email domain associated with your workspace"})}),(0,c.jsx)(vm.q,{styleName:"Body-12px/Medium",colorName:"contrastSecondary",children:(0,c.jsx)(g.FormattedMessage,{id:"userCell.internalGuest.tooltip.description",defaultMessage:"You'll see this icon for users who have a workspace owner email domain, verified domain, or allowed email domain"})})]})})]}),(0,c.jsxs)("div",{style:p.titleContainer,children:[(0,c.jsx)("div",{style:p.userName,title:l,children:l}),(0,c.jsx)("div",{style:p.userEmail,title:d,children:d}),m&&i&&(0,c.jsx)(bm.Z,{spaceStore:s,restorationStatus:i,didAttemptRecovery:h})]})]}),m&&!h&&"canBeRestored"===(null==i?void 0:i.status)&&(0,c.jsx)(Mm.Z,{spaceId:s.id,userStore:u,onSubmit:()=>f(!0)})]})}function Cm(e){let{guests:t,spaceStore:s,domainFilterValues:i,internalDomains:l}=e;const{environment:d,tableStyles:u,styles:p,sortState:m,setSortState:h,selectedRowIds:f,setSelectedRowIds:x,rows:y,searchQuery:S,onClickApprove:v,onClickDecline:b,isApproveButtonLoading:M,canEditMembership:j,columnRenderInfo:C,isSubscribed:w,shouldHideActions:k,shouldShowRequest:T,canAdmin:I,guestsCount:Z,shouldShowLoadMore:P,onLoadMore:F}=function(e){let{guests:t,spaceStore:s,domainFilterValues:i,internalDomains:l}=e;const d=Kt({spaceStore:s}),c=qp({spaceStore:s}),u=(0,o.O7)(),p=(0,r.yK)((e=>({titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510,height:32},titleNumber:{color:e.v2.text.tertiary},emptyMessage:{display:"flex",height:32,padding:"0px 4px",alignItems:"center",borderBottom:`1px solid ${e.v2.stroke.regular}`},emptyDivider:{height:1,backgroundColor:e.v2.stroke.deemphasized},headerContainer:{display:"flex",justifyContent:d&&c?"space-between":"flex-end"},actionsContainer:{display:"flex",borderRadius:6,border:`1px solid ${e.v2.stroke.regular}`,boxShadow:"0px 2px 12px 0px rgba(29, 27, 22, 0.06)"},actionLeftButton:{borderRadius:"4px 0px 0px 4px",paddingLeft:10,paddingRight:0,height:30},buttonContainerApprove:{display:"flex",padding:"0px 12px 0px 0px",justifyContent:"center",alignItems:"center",gap:4,alignSelf:"stretch",color:e.v2.text.ui.blue.primary},buttonContainerDecline:{display:"flex",padding:"0px 12px 0px 10px",justifyContent:"center",alignItems:"center",gap:4,alignSelf:"stretch",color:em.Lr[e.mode].red},buttonIcon:{width:20,height:20,paddingTop:1,flexDirection:"column",justifyContent:"center",alignItems:"center",gap:10},buttonText:{fontSize:14,fontWeight:510},buttonDivider:{width:1,background:e.v2.stroke.deemphasized},actionRightButton:{borderRadius:"0px 4px 4px 0px",paddingLeft:0,paddingRight:0,height:30}})),[d,c]),m=Gp({spaceStore:s}),h=(0,a.VK)((()=>m?[wm,km,Tm]:[wm]),[m]),f=(0,r.yK)((e=>({...(0,Se.b)({columnRenderInfo:h,theme:e,containerMarginTop:0})})),[h]),x=(0,a.VK)((()=>h[0]),[h]),[y,S]=(0,n.useState)({column:x,sortAscending:!0}),[v,b]=(0,n.useState)([]),M=(0,g.useIntl)(),j=(0,a.VK)((()=>Ut.state.searchQuery),[]),C=(0,a.VK)((()=>{const e=(0,sm.Gz)();return t.map((t=>{const n=ne.U6.createChildStore(s,{table:B.KJ,id:t.userId}),i=n.getEmail(),o=null==i?void 0:i.split("@")[1],a=e&&l.some((e=>e.url===o));return{spaceStore:s,user:t,email:i,userName:n.getDisplayName(M),id:t.userId,shouldDisableInteraction:v.includes(t.userId),isClickable:!1,isInternalGuest:a}})).filter((e=>{var t;if(j){var s;if(!((null===(s=e.email)||void 0===s?void 0:s.includes(j))||e.userName.includes(j)))return!1}if(!i||0===i.length)return!0;const n=null===(t=e.email)||void 0===t?void 0:t.split("@")[1];return null==i?void 0:i.some((e=>"other"===e?!(null!=l&&l.some((e=>e.url===n))):n===e))}))}),[s,t,M,j,v,l,i]),w=(0,a.VK)((()=>{const e=Bt.subscriptionDataStoreInstance.state;return Boolean(e&&Rt.YK(e))}),[]),k=(0,n.useCallback)((()=>{Kp.b4(u,{from:"guest",button_name:"bulk_upgrade",count:v.length}),v.forEach((e=>{const t=ne.U6.createChildStore(s,{table:B.KJ,id:e}),n=w?"read_and_write":"editor";tm.s({environment:u,guestUserStore:t,role:n,store:s,isConvertToAdmin:!w,origin:"guest_actions"}),b([])}))}),[v,u,w,s]),T=(0,n.useCallback)((()=>{Kp.b4(u,{from:"guest",button_name:"bulk_remove",count:v.length}),om.setState({...om.state,isModalOpen:!0,guests:v,handleClickDecline:()=>{Kp.b4(u,{from:"guest",button_name:"confirm_in_dialog",count:v.length}),v.forEach((e=>{const t=ne.U6.createChildStore(s,{table:B.KJ,id:e});tm.w({environment:u,guestUserStore:t,store:s})})),b([])}})}),[v,u,s]),I=!C.some((e=>v.includes(e.id))),[Z,P]=(0,n.useState)(fm),F=(0,n.useCallback)((()=>{P(Z+fm)}),[Z]),A=Z<C.length,_=C.slice(0,Z);return{environment:u,tableStyles:f,styles:p,sortState:y,setSortState:S,selectedRowIds:v,setSelectedRowIds:b,rows:_,searchQuery:j,onClickApprove:k,onClickDecline:T,isApproveButtonLoading:!1,canEditMembership:m,columnRenderInfo:h,isSubscribed:w,shouldHideActions:I,shouldShowRequest:d,canAdmin:c,guestsCount:C.length,shouldShowLoadMore:A,onLoadMore:F}}({guests:t,spaceStore:s,domainFilterValues:i,internalDomains:l});return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:p.headerContainer,children:[T&&I&&(0,c.jsxs)("div",{style:p.titleContainer,children:[(0,c.jsx)("span",{children:(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionguestsTab.activeguests.title",defaultMessage:"Active"})}),(0,c.jsx)("span",{style:p.titleNumber,children:Z})]}),f.length>0&&!k&&(0,c.jsxs)("div",{style:p.actionsContainer,children:[(0,c.jsx)(Xt.Z,{style:p.actionLeftButton,onClick:v,isLoading:M,children:(0,c.jsxs)("div",{style:p.buttonContainerApprove,children:[(0,c.jsx)("div",{style:p.buttonIcon,children:da({width:20,height:16})}),(0,c.jsx)("div",{style:p.buttonText,children:(0,c.jsx)(g.FormattedMessage,{id:"spaceSettings.peopleSection.guestsTable.bulkUpgrade",defaultMessage:"Upgrade {numberOfRequests, plural, one {1 guest} other {{numberOfRequests} guests}} to {isSubscribed, select, true {member} other {admin}}",values:{numberOfRequests:f.length,isSubscribed:w}})})]})}),(0,c.jsx)("div",{style:p.buttonDivider}),(0,c.jsx)(Xt.Z,{style:p.actionRightButton,onClick:b,children:(0,c.jsxs)("div",{style:p.buttonContainerDecline,children:[(0,c.jsx)("div",{style:{...p.buttonIcon,paddingTop:3},children:(0,$n.V)({width:20,height:16})}),(0,c.jsx)("div",{style:p.buttonText,children:(0,c.jsx)(g.FormattedMessage,{id:"spaceSettings.peopleSection.guestsTable.bulkDecline",defaultMessage:"Remove from workspace"})})]})})]})]}),(0,c.jsxs)("div",{style:{marginTop:T&&I?4:-1},children:[(0,c.jsx)(Se.D,{allowHorizontalScroll:j,setStickyHeaderRow:!0,columnRenderInfo:C,rows:Im(y,m),showRowBorders:!0,hideHeaderRowPadding:!0,sortState:m,onSortStateChanged:h,loadMoreType:"button",onLoadMore:P?F:void 0,renderNoRowsComponent:()=>(0,c.jsx)(Me.Z,{isSmall:!0,style:p.emptyMessage,children:S?(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionGuestsTab.emptySearch",defaultMessage:"No search results"}):(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionGuestsTab.emptyRow",defaultMessage:"No guests"})}),styles:u,multiselect:j?{header:{isDisabled:0===y.length,isSelected:f.length>0&&f.length===y.length,onClick:()=>{f.length===y.length?(x([]),Kp.pZ(d,{from:"guests",action:"deselect_all",row_count:f.length})):(x(y.map((e=>e.id))),Kp.pZ(d,{from:"guests",action:"select_all",row_count:y.length}))}},row:{getDisabledState:()=>!1,getSelectedState:e=>f.includes(e.id),onClick:e=>{x((t=>t.includes(e.id)?(Kp.pZ(d,{from:"guests",action:"deselect_row",row_count:1}),t.filter((t=>t!==e.id))):(Kp.pZ(d,{from:"guests",action:"select_row",row_count:1}),t.concat(e.id))))}}}:void 0}),(0,c.jsx)(dm,{})]})]})}const wm={id:"user",headerTitle:(0,c.jsx)("div",{style:{fontSize:14},children:(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionGuestsTab.user",defaultMessage:"User"})}),renderCell:e=>(0,c.jsx)(jm,{userId:e.user.userId,spaceStore:e.spaceStore,isInternalGuest:e.isInternalGuest}),widthData:{width:210},sortable:!0},km={id:"access",headerTitle:(0,c.jsx)("div",{style:{paddingLeft:8,fontSize:14},children:(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionGuestsTab.access",defaultMessage:"Access"})}),renderCell:e=>(0,c.jsx)(gm,{guest:e.user,spaceStore:e.spaceStore,shouldDisableInteraction:e.shouldDisableInteraction}),widthData:{width:180},sortable:!1},Tm={id:"actions",headerTitle:(0,c.jsx)(c.Fragment,{}),renderCell:e=>(0,c.jsx)(am,{guest:e.user,spaceStore:e.spaceStore,shouldDisableInteraction:e.shouldDisableInteraction}),widthData:{width:300},sortable:!1};function Im(e,t){let{sortAscending:s}=t;const n=h.MR(e,(e=>e.email));return s||n.reverse(),n}var Zm=s(42499),Pm=s(82114);const Fm=(0,d.IU)("checkMarkShield",{viewBox:"0 0 10 11",svg:(0,c.jsx)("path",{d:"M5.08789 10.4893C5.03906 10.4893 4.9821 10.4795 4.91699 10.46C4.85514 10.4437 4.79167 10.4193 4.72656 10.3867C4.02669 10.0189 3.43262 9.68522 2.94434 9.38574C2.45931 9.08952 2.06868 8.79655 1.77246 8.50684C1.47624 8.21712 1.25977 7.90462 1.12305 7.56934C0.989583 7.23405 0.922852 6.84831 0.922852 6.41211V2.8623C0.922852 2.52051 0.986328 2.26335 1.11328 2.09082C1.24023 1.91829 1.45345 1.77018 1.75293 1.64648C1.84733 1.60742 1.98405 1.55534 2.16309 1.49023C2.34212 1.42188 2.54069 1.35026 2.75879 1.27539C2.98014 1.19727 3.19987 1.12077 3.41797 1.0459C3.63932 0.971029 3.83789 0.904297 4.01367 0.845703C4.19271 0.787109 4.32617 0.743164 4.41406 0.713867C4.52148 0.681315 4.63379 0.655273 4.75098 0.635742C4.87142 0.616211 4.98372 0.606445 5.08789 0.606445C5.19206 0.606445 5.30436 0.616211 5.4248 0.635742C5.5485 0.655273 5.66243 0.681315 5.7666 0.713867C5.85449 0.743164 5.98633 0.787109 6.16211 0.845703C6.34115 0.904297 6.53971 0.971029 6.75781 1.0459C6.97591 1.12077 7.19564 1.19727 7.41699 1.27539C7.63835 1.35026 7.83854 1.42025 8.01758 1.48535C8.19661 1.55046 8.33333 1.60417 8.42773 1.64648C8.72721 1.77018 8.9388 1.91829 9.0625 2.09082C9.18945 2.26335 9.25293 2.52051 9.25293 2.8623V6.41211C9.25293 6.84831 9.1862 7.23568 9.05273 7.57422C8.92253 7.91276 8.70931 8.23014 8.41309 8.52637C8.12012 8.81934 7.73112 9.11393 7.24609 9.41016C6.76107 9.70638 6.16374 10.0319 5.4541 10.3867C5.389 10.4193 5.32389 10.4437 5.25879 10.46C5.19694 10.4795 5.13997 10.4893 5.08789 10.4893ZM4.55078 7.73047C4.6582 7.73047 4.75586 7.70605 4.84375 7.65723C4.9349 7.60514 5.01302 7.5319 5.07812 7.4375L7.34863 3.9707C7.3877 3.90885 7.41862 3.84538 7.44141 3.78027C7.46745 3.71517 7.48047 3.65169 7.48047 3.58984C7.48047 3.4401 7.4235 3.31641 7.30957 3.21875C7.19889 3.12109 7.07031 3.07227 6.92383 3.07227C6.73177 3.07227 6.57064 3.17643 6.44043 3.38477L4.54102 6.40723L3.68652 5.3623C3.62142 5.28092 3.55306 5.22233 3.48145 5.18652C3.41309 5.15072 3.33333 5.13281 3.24219 5.13281C3.0957 5.13281 2.96875 5.18652 2.86133 5.29395C2.75391 5.39811 2.7002 5.52507 2.7002 5.6748C2.7002 5.74642 2.71322 5.81478 2.73926 5.87988C2.7653 5.94499 2.80599 6.01172 2.86133 6.08008L4.00391 7.44727C4.08203 7.54167 4.16504 7.61328 4.25293 7.66211C4.34082 7.70768 4.4401 7.73047 4.55078 7.73047Z",fill:"#91918E"})}),Am=(0,d.IU)("globe4",{viewBox:"0 0 12 12",svg:(0,c.jsx)("path",{d:"M5.99512 10.5156C5.64355 10.5156 5.31315 10.4001 5.00391 10.1689C4.69792 9.94108 4.42773 9.62207 4.19336 9.21191C3.96224 8.7985 3.77995 8.31673 3.64648 7.7666C3.51302 7.21647 3.44629 6.6224 3.44629 5.98438C3.44629 5.3431 3.51302 4.7474 3.64648 4.19727C3.77995 3.64388 3.96224 3.16211 4.19336 2.75195C4.42448 2.33854 4.69466 2.01628 5.00391 1.78516C5.31315 1.55404 5.64355 1.43848 5.99512 1.43848C6.34993 1.43848 6.68197 1.55404 6.99121 1.78516C7.30046 2.01628 7.57064 2.33854 7.80176 2.75195C8.03613 3.16211 8.21842 3.64388 8.34863 4.19727C8.47884 4.7474 8.54395 5.3431 8.54395 5.98438C8.54395 6.6224 8.47721 7.21647 8.34375 7.7666C8.21354 8.31673 8.03125 8.7985 7.79688 9.21191C7.56576 9.62207 7.29557 9.94108 6.98633 10.1689C6.68034 10.4001 6.34993 10.5156 5.99512 10.5156ZM5.99512 2.15137C5.76725 2.15137 5.5459 2.25553 5.33105 2.46387C5.11947 2.6722 4.92904 2.95703 4.75977 3.31836C4.59375 3.67643 4.46191 4.08496 4.36426 4.54395C4.2666 5.00293 4.21777 5.48307 4.21777 5.98438C4.21777 6.48242 4.2666 6.95931 4.36426 7.41504C4.46191 7.87077 4.59375 8.27767 4.75977 8.63574C4.92904 8.99382 5.11947 9.27702 5.33105 9.48535C5.5459 9.69368 5.76725 9.79785 5.99512 9.79785C6.22624 9.79785 6.44759 9.69368 6.65918 9.48535C6.87402 9.27702 7.06445 8.99382 7.23047 8.63574C7.39974 8.27767 7.5332 7.87077 7.63086 7.41504C7.72852 6.95931 7.77734 6.48242 7.77734 5.98438C7.77734 5.48307 7.72852 5.00293 7.63086 4.54395C7.5332 4.08496 7.39974 3.67643 7.23047 3.31836C7.06445 2.95703 6.87402 2.6722 6.65918 2.46387C6.44759 2.25553 6.22624 2.15137 5.99512 2.15137ZM5.61914 1.50684H6.37598V10.4229H5.61914V1.50684ZM5.99512 7.47363C6.51921 7.47363 7.01562 7.51432 7.48438 7.5957C7.95312 7.67708 8.37142 7.79427 8.73926 7.94727C9.1071 8.10026 9.40007 8.2793 9.61816 8.48438L9.04199 8.96289C8.84017 8.8099 8.58464 8.67806 8.27539 8.56738C7.9694 8.45671 7.62272 8.3737 7.23535 8.31836C6.84798 8.25977 6.43457 8.23047 5.99512 8.23047C5.55892 8.23047 5.14714 8.25977 4.75977 8.31836C4.3724 8.3737 4.02409 8.45671 3.71484 8.56738C3.40885 8.67806 3.15332 8.8099 2.94824 8.96289L2.37207 8.48438C2.59342 8.2793 2.88802 8.10026 3.25586 7.94727C3.6237 7.79427 4.04199 7.67708 4.51074 7.5957C4.97949 7.51432 5.47428 7.47363 5.99512 7.47363ZM10.4189 5.59375V6.35059H1.57617V5.59375H10.4189ZM5.99512 4.5C5.47428 4.5 4.97949 4.45931 4.51074 4.37793C4.04199 4.29329 3.6237 4.17611 3.25586 4.02637C2.88802 3.87337 2.59342 3.69434 2.37207 3.48926L2.94824 3.00586C3.15332 3.16211 3.41048 3.29557 3.71973 3.40625C4.02897 3.51367 4.37728 3.59668 4.76465 3.65527C5.15202 3.71387 5.56217 3.74316 5.99512 3.74316C6.43457 3.74316 6.84798 3.71387 7.23535 3.65527C7.62272 3.59668 7.9694 3.51367 8.27539 3.40625C8.58464 3.29557 8.84017 3.16211 9.04199 3.00586L9.61816 3.48926C9.40007 3.69434 9.1071 3.87337 8.73926 4.02637C8.37142 4.17611 7.95312 4.29329 7.48438 4.37793C7.01562 4.45931 6.51921 4.5 5.99512 4.5ZM5.99512 11.1309C5.28874 11.1309 4.62467 10.9958 4.00293 10.7256C3.38118 10.4587 2.83268 10.0876 2.35742 9.6123C1.88216 9.1403 1.50944 8.59342 1.23926 7.97168C0.972331 7.34993 0.838867 6.68424 0.838867 5.97461C0.838867 5.26823 0.972331 4.60417 1.23926 3.98242C1.50944 3.36068 1.88053 2.81217 2.35254 2.33691C2.8278 1.86165 3.3763 1.49056 3.99805 1.22363C4.62305 0.953451 5.28874 0.818359 5.99512 0.818359C6.7015 0.818359 7.36556 0.953451 7.9873 1.22363C8.6123 1.49056 9.16081 1.86165 9.63281 2.33691C10.1081 2.81217 10.4808 3.36068 10.751 3.98242C11.0212 4.60417 11.1562 5.26823 11.1562 5.97461C11.1562 6.68424 11.0212 7.34993 10.751 7.97168C10.4808 8.59342 10.1081 9.1403 9.63281 9.6123C9.16081 10.0876 8.61393 10.4587 7.99219 10.7256C7.37044 10.9958 6.70475 11.1309 5.99512 11.1309ZM5.99512 10.1396C6.56803 10.1396 7.10514 10.0306 7.60645 9.8125C8.10775 9.5944 8.55046 9.29492 8.93457 8.91406C9.31868 8.52995 9.61816 8.08724 9.83301 7.58594C10.0511 7.08138 10.1602 6.54427 10.1602 5.97461C10.1602 5.40495 10.0511 4.86947 9.83301 4.36816C9.61816 3.86361 9.31868 3.4209 8.93457 3.04004C8.55046 2.65592 8.10612 2.35482 7.60156 2.13672C7.10026 1.91862 6.56478 1.80957 5.99512 1.80957C5.42546 1.80957 4.88835 1.91862 4.38379 2.13672C3.88249 2.35482 3.43978 2.65592 3.05566 3.04004C2.6748 3.4209 2.37533 3.86361 2.15723 4.36816C1.94238 4.86947 1.83496 5.40495 1.83496 5.97461C1.83496 6.54427 1.94238 7.08138 2.15723 7.58594C2.37533 8.08724 2.6748 8.52995 3.05566 8.91406C3.43978 9.29492 3.88249 9.5944 4.38379 9.8125C4.88835 10.0306 5.42546 10.1396 5.99512 10.1396Z",fill:"#91918E"})});var _m=s(47969),Rm=s(83817),Om=s(73254),Bm=s(89024),Dm=s(93667),Lm=s(1978);const Vm=(0,g.defineMessages)({infoTitle:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.title",defaultMessage:"Find teammates more easily by filtering to your workspace's email domains"},infoDescription:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.description",defaultMessage:"Upgrade these guests to members for better collaboration and reduced page-by-page permissions."},emailDomainTooltip:{defaultMessage:"Your workspace’s email domains include allowed email domains, verified domains, and workspace owner email domains.",id:"spacePermissionsSettings.guestsTab.internalGuestBanner.tooltip"},overLimitTitle:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.overLimit.title",defaultMessage:"Your workspace is over the {limit}-guest limit"},upsellDescription:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.overLimit.upsell.description",defaultMessage:"Find teammates who are currently guests by filtering to your workspace's email domains and upgrade them to members to continue collaborating. To get more guest seats, upgrade your plan or reach out to sales."},salesAssistedDescription:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.overLimit.salesAssisted.description",defaultMessage:"Find teammates who are currently guests by filtering to your workspace's email domains and upgrade them to members to continue collaborating. To get more guest seats, reach out to your account manager."},nonAdminTooltip:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.overLimit.nonAdmin.tooltip",defaultMessage:"New users can continue to be added as members. To resume adding guests, contact your workspace owner to upgrade or remove existing guests from your workspace."}}),Nm={warning_upsell:{iconGroup:Zm.G,tint:"yellow",label:Vm.overLimitTitle,description:Vm.upsellDescription,tooltip:Vm.emailDomainTooltip},warning_sales_assisted:{iconGroup:Zm.G,tint:"yellow",label:Vm.overLimitTitle,description:Vm.salesAssistedDescription,tooltip:Vm.emailDomainTooltip},warning_nonadmin:{iconGroup:Zm.G,tint:"yellow",label:Vm.overLimitTitle,tooltip:Vm.nonAdminTooltip},info:{iconGroup:ym,tint:"gray",label:Vm.infoTitle,description:Vm.infoDescription,tooltip:Vm.emailDomainTooltip}};function Em(e){let{guests:t,spaceStore:s,internalDomains:n,domainFilterValues:i,setDomainFilterValues:o}=e;const r=n.length>0,l=qp({spaceStore:s}),d=(0,a.VK)((()=>r&&l&&((0,sm.Gz)()||(0,sm.rs)())),[r,l]);if(!r)return null;const u=(0,c.jsx)(Um,{guests:t,spaceStore:s});return d||u?(0,c.jsxs)(Bm.jX,{padding:"16px 0px",gap:16,children:[u,d&&(0,c.jsx)(Wm,{internalDomains:n,domainFilterValues:i??[],setDomainFilterValues:o})]}):null}function Um(e){let{spaceStore:t,guests:s}=e;const n=function(e){let{spaceStore:t}=e;const s=(0,o.O7)(),n=qp({spaceStore:t}),i=s.currentUser.id,r=t.id,l=i&&r?(0,_m.Ni)({spaceId:r,userId:i}):void 0,d=(0,Om.oo)({name:"internal_guests",spaceId:r,spaceUserId:l,amount:0});return(0,a.VK)((()=>d?(0,Rm.V5)(d,{available:()=>n&&((0,sm.Gz)()||(0,sm.rs)())?{...Nm.info,messageValues:{}}:null,upsell:e=>{let{limit:t,upsell:s}=e;return s?{...Nm.warning_upsell,messageValues:{limit:t.total}}:{...Nm.warning_sales_assisted,messageValues:{limit:t.total}}},blocked:e=>{let{limit:t}=e;return{...Nm.warning_nonadmin,messageValues:{limit:t.total}}}}):null),[d,n])}({spaceStore:t});if(!n)return null;const i=(0,c.jsx)(be.ZP,{style:{width:250},textWrap:!0,renderTooltip:()=>(0,c.jsx)(g.FormattedMessage,{...n.tooltip}),originGap:6,placement:nc.u.Bottom,alignment:nc.v.Start,render:e=>(0,c.jsx)("div",{style:{paddingLeft:3,display:"inline-block",verticalAlign:"text-bottom"},...e,children:(0,Hn.m)({width:14})})});return(0,c.jsx)(Lm.j,{iconGroup:n.iconGroup,display:"inline",tint:n.tint,label:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(g.FormattedMessage,{...n.label,values:n.messageValues}),n.description?void 0:i]}),description:n.description&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(g.FormattedMessage,{...n.description}),i]})})}function Wm(e){let{internalDomains:t,domainFilterValues:s,setDomainFilterValues:n}=e;const i=(0,a.VK)((()=>[...t.map((e=>({key:e.url,value:`${e.url}`,title:Km({domain:`${e.url}`})}))),{key:"other",value:"other",title:Km({domain:"other"})}]),[t]);return(0,c.jsx)(Dm.F,{pillIcon:Pm.p,pillTitle:s?(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.guestsTab.internalDomainFilter.filtered",defaultMessage:"Email domain: {domainFilter}",values:{domainFilter:s.join(", ")}}):(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.guestsTab.internalDomainFilter.placeholder",defaultMessage:"Email domain"}),selectedItems:s,setSelectedItems:e=>{n(e)},items:i})}function Km(e){let{domain:t}=e;return(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsx)(c.Fragment,{children:"other"===t?(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Other",id:"spacePermissionsSettings.guestsTab.internalDomainFilter.other"}):`@${t}`}),(0,c.jsx)("div",{style:{paddingLeft:5},children:"other"===t?Am({width:14}):Fm({width:14})})]})}const zm=(0,d.IU)("peopleFillCheckmark",{viewBox:"0 0 20 20",svg:(0,c.jsx)("path",{d:"M14.5391 10.3174C14.4115 10.3174 14.2975 10.29 14.1973 10.2354C14.097 10.1807 13.999 10.0964 13.9033 9.98242L12.29 8.01367C12.1715 7.86328 12.1123 7.70833 12.1123 7.54883C12.1123 7.38021 12.1693 7.23665 12.2832 7.11816C12.4017 6.99967 12.5452 6.94043 12.7139 6.94043C12.8141 6.94043 12.9053 6.96322 12.9873 7.00879C13.0739 7.0498 13.1582 7.12272 13.2402 7.22754L14.5117 8.84082L17.2188 4.51367C17.3555 4.28581 17.5309 4.17188 17.7451 4.17188C17.9046 4.17188 18.0482 4.22428 18.1758 4.3291C18.3034 4.42936 18.3672 4.56608 18.3672 4.73926C18.3672 4.81673 18.349 4.89648 18.3125 4.97852C18.2806 5.05599 18.2419 5.12891 18.1963 5.19727L15.1406 9.97559C14.9948 10.2035 14.7943 10.3174 14.5391 10.3174ZM2.85645 16.2441C2.47363 16.2441 2.17285 16.1576 1.9541 15.9844C1.73535 15.8112 1.62598 15.5742 1.62598 15.2734C1.62598 14.8314 1.75814 14.3688 2.02246 13.8857C2.29134 13.4027 2.67643 12.9492 3.17773 12.5254C3.68359 12.1016 4.29199 11.7575 5.00293 11.4932C5.71387 11.2288 6.51139 11.0967 7.39551 11.0967C8.28418 11.0967 9.08398 11.2288 9.79492 11.4932C10.5059 11.7575 11.112 12.1016 11.6133 12.5254C12.1191 12.9492 12.5065 13.4027 12.7754 13.8857C13.0443 14.3688 13.1787 14.8314 13.1787 15.2734C13.1787 15.5742 13.0693 15.8112 12.8506 15.9844C12.6318 16.1576 12.3311 16.2441 11.9482 16.2441H2.85645ZM7.40234 9.87988C6.9056 9.87988 6.44759 9.74544 6.02832 9.47656C5.61361 9.20768 5.27865 8.84538 5.02344 8.38965C4.77279 7.93392 4.64746 7.4235 4.64746 6.8584C4.64746 6.30241 4.77279 5.80111 5.02344 5.35449C5.27865 4.90332 5.61589 4.54557 6.03516 4.28125C6.45443 4.01693 6.91016 3.88477 7.40234 3.88477C7.89909 3.88477 8.3571 4.01465 8.77637 4.27441C9.19564 4.53418 9.5306 4.88965 9.78125 5.34082C10.0365 5.78743 10.1641 6.28874 10.1641 6.84473C10.1641 7.41439 10.0365 7.92936 9.78125 8.38965C9.5306 8.84538 9.19564 9.20768 8.77637 9.47656C8.3571 9.74544 7.89909 9.87988 7.40234 9.87988Z"})});var qm=s(85740);class Gm extends E.default{getInitialState(){return{isModalOpen:!1,requests:[],requestType:"member",handleClickDecline:()=>{}}}}const Hm=new Gm;function Ym(e){let{request:t,spaceStore:s,shouldDisableInteraction:i,requestType:a}=e;const{styles:l,handleApprove:d,handleDecline:u,isApproveButtonLoading:p}=function(e){let{request:t,spaceStore:s,shouldDisableInteraction:i,requestType:a}=e;const l=(0,r.yK)((e=>({approveButton:{background:e.outlineBlueButtonHoveredBackground,color:e.blueColor,fontWeight:510,fontSize:14,borderRadius:4,paddingLeft:10,paddingRight:10},declineButton:{marginRight:10,borderRadius:4,paddingLeft:10,paddingRight:10,color:e.v2.text.secondary},container:{opacity:i?.5:1,display:"flex",width:"100%",justifyContent:"flex-end"}})),[i]),d=(0,o.O7)(),u=(0,n.useMemo)((()=>Po.kk.fromAccessRequest(t.accessRequest)),[t]),[p,m]=(0,n.useState)(!1),{forActor:h,accessRequestStore:f}=t,x=(0,n.useCallback)((()=>{m(!0),Kp.b4(d,{from:`${a}_request`,button_name:"approve"}),u.isGuestInviteRequest()?y.yW({environment:d,accessRequest:u,status:"approved",from:"requests_center",forActor:Po.kk.fromUser(h),onResolveComplete:e=>{m(!1),e?oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"spaceSettingsRequestRow.requestRowActions.toast.approveGuestInvite.success",defaultMessage:"Invited {actorEmail} as guest",values:{actorEmail:h.email}})}):oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"spaceSettingsRequestRow.requestRowActions.toast.approveGuestInvite.failure",defaultMessage:"Failed to invite {actorEmail} as a guest",values:{actorEmail:h.email}})})}}):u.isSpaceMembershipRequest()&&y.kn({environment:d,store:s,accessRequestStore:f,forActor:h,status:"approved",from:"requests_center",onResolveComplete:e=>{m(!1),e?oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"spaceSettingsRequestRow.requestRowActions.toast.approveSpaceMembership.success",defaultMessage:"Added {actorEmail} as a member",values:{actorEmail:h.email}})}):oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"spaceSettingsRequestRow.requestRowActions.toast.approveSpaceMembership.failure",defaultMessage:"Failed to add {actorEmail} as a member",values:{actorEmail:h.email}})})}})}),[u,d,f,h,s,a]),S=(0,n.useCallback)((()=>{Kp.b4(d,{from:`${a}_request`,button_name:"decline"}),Hm.setState({...Hm.state,isModalOpen:!0,requests:[t],requestType:a,handleClickDecline:()=>{u.isGuestInviteRequest()?y.yW({environment:d,accessRequest:u,status:"rejected",from:"requests_center",forActor:Po.kk.fromUser(h),onResolveComplete:()=>{}}):u.isSpaceMembershipRequest()&&y.kn({environment:d,store:s,accessRequestStore:f,forActor:h,status:"rejected",from:"requests_center",onResolveComplete:()=>{}})}})}),[u,d,f,h,s,a,t]);return{styles:l,handleApprove:x,handleDecline:S,isApproveButtonLoading:p}}({request:t,spaceStore:s,shouldDisableInteraction:i,requestType:a});return(0,c.jsxs)("div",{style:l.container,children:[(0,c.jsx)("div",{children:(0,c.jsx)(Xt.Z,{style:l.declineButton,onClick:u,disabled:i,children:(0,c.jsx)(g.FormattedMessage,{id:"spaceSettings.peopleSection.requestsTable.Decline",defaultMessage:"Decline"})})}),(0,c.jsx)("div",{children:(0,c.jsx)(Xt.Z,{style:l.approveButton,onClick:d,isLoading:p,disabled:i,children:(0,c.jsx)(g.FormattedMessage,{id:"spaceSettings.peopleSection.requestsTable.approve",defaultMessage:"Approve"})})})]})}function Qm(){const{isModalOpen:e,handleClickDecline:t,handleDismiss:s,requestType:i,requests:r}=function(){const{isModalOpen:e,requestType:t,requests:s,handleClickDecline:i}=(0,a.VK)((()=>Hm.state),[]),r=(0,o.O7)(),l=(0,n.useCallback)((()=>{Hm.reset(),Kp.b4(r,{from:"member"===t?"member_request":"guest_request",button_name:"dismiss_in_dialog",count:s.length})}),[r,s,t]);return{isModalOpen:e,requestType:t,requests:s,handleClickDecline:i,handleDismiss:l}}();return 0===r.length?null:(0,c.jsx)(lm,{isModalOpen:e,handleDismiss:s,handleConfirm:t,title:(0,c.jsx)(g.FormattedMessage,{id:"RequestBulkDeclineConfirmationDialog.title",defaultMessage:"Decline {numberOfRequests, plural, one {{requestType} request for {firstRequestEmail}} other {{numberOfRequests} {requestType} requests}}?",values:{numberOfRequests:r.length,requestType:i,firstRequestEmail:r[0].forActor.email}}),description:(0,c.jsx)(g.FormattedMessage,{id:"RequestBulkDeclineConfirmationDialog.description",defaultMessage:"{numberOfRequests, plural, one {To add them as a {requestType} in the future, {inviter} must resubmit a request, or an admin must invite them} other {Requests must be resubmitted, or an admin must add them as {isMemberRequest, select, true {members} other {guests}} in the future}}.",values:{numberOfRequests:r.length,requestType:i,isMemberRequest:"member"===i,inviter:r[0].createdByActorsWithReason[0].actor.name}}),ctaText:(0,c.jsx)(g.FormattedMessage,{id:"RequestBulkDeclineConfirmationDialog.decline",defaultMessage:"Decline"})})}function $m(e){let{spaceStore:t,createdByActorsWithReason:s,latestRequestTime:n}=e;return(0,c.jsx)("div",{style:{width:241,maxHeight:600,overflowY:"auto",whiteSpace:"pre-wrap",padding:"12px 12px 12px 12px"},children:s.map((e=>(0,c.jsx)(Jm,{spaceStore:t,createdByActorWithReason:e,latestRequestTime:n},e.actor.id)))})}function Jm(e){let{spaceStore:t,createdByActorWithReason:s,latestRequestTime:n}=e;const{requestorName:i,reason:o,actor:l,styles:d}=function(e){let{spaceStore:t,createdByActorWithReason:s}=e;const{actor:n,reason:i}=s,o=(0,g.useIntl)(),l=(0,a.VK)((()=>ne.U6.createChildStore(t,{table:B.KJ,id:n.id}).getDisplayName(o)),[o,n,t]),d=(0,r.yK)((e=>({avatar:{width:24,height:24},metadata:{display:"flex",alignItems:"center",gap:6,flex:"1 0 0"},userName:{textOverflow:"ellipsis",fontSize:14,fontWeight:510,overflow:"hidden",width:100,whiteSpace:"nowrap"},timestamp:{color:e.v2.text.tertiary,textAlign:"right",fontSize:12,fontWeight:400,lineHeight:"15px"},header:{display:"flex",alignItems:"center",gap:10},reason:{paddingLeft:30,fontSize:14,fontWeight:400,color:e.v2.text.primary,letterSpacing:"-0.154px",display:"inline-block",overflowWrap:"break-word",inlineSize:200},noReason:{color:e.v2.text.quaternary}})),[]);return{requestorName:l,reason:i,actor:n,styles:d}}({spaceStore:t,createdByActorWithReason:s});return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:d.header,children:[(0,c.jsx)(Rn.Z,{hasTooltip:!0,userValue:l,style:d.avatar,size:24,avatarShouldShowShadow:!1}),(0,c.jsxs)("div",{style:d.metadata,children:[(0,c.jsx)("div",{style:d.userName,children:i}),(0,c.jsx)(Me.Z,{isSmall:!0,isSecondaryColor:!0,isMultiline:!0,style:d.timestamp,children:(0,Gi.IS)(n)})]})]}),(0,c.jsx)("span",{style:d.reason,children:o||(0,c.jsx)("div",{style:d.noReason,children:(0,c.jsx)(g.FormattedMessage,{id:"requestReasonContent.noReason",defaultMessage:"No message"})})})]})}function Xm(e){let{request:t,spaceStore:s,shouldDisableInteraction:n,requestType:i}=e;const{styles:l,firstRequestorName:d,numberOfRequestors:u}=function(e){let{request:t,spaceStore:s,shouldDisableInteraction:n}=e;const i=(0,r.yK)((e=>({firstRequestorName:{color:e.v2.text.secondary,opacity:n?.5:1,maxWidth:118,...x.Z.textOverflowStyle},buttonSuffix:{color:e.v2.text.tertiary,paddingLeft:4},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[n]),o=(0,g.useIntl)(),{firstRequestorName:l}=(0,a.VK)((()=>{if(0===t.createdByActorsWithReason.length)return{firstRequestorName:void 0};return{firstRequestorName:ne.U6.createChildStore(s,{table:B.KJ,id:t.createdByActorsWithReason[0].actor.id}).getDisplayName(o)}}),[o,t.createdByActorsWithReason,s]);return{styles:i,firstRequestorName:l,numberOfRequestors:t.createdByActorsWithReason?t.createdByActorsWithReason.length:0}}({request:t,spaceStore:s,shouldDisableInteraction:n}),p=(0,o.O7)();return void 0===d||0===u?null:(0,c.jsx)(_o.ZP,{popupType:_o.Z4.Popup,onClick:()=>{Kp.b4(p,{from:`${i}_request`,button_name:"open_requested_by"})},renderOrigin:e=>(0,c.jsx)(Xt.Z,{...e,disabled:n,children:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{style:l.firstRequestorName,title:d,children:d}),(0,c.jsx)("span",{style:l.buttonSuffix,children:u>1?(0,c.jsxs)("div",{children:["+",u-1]}):null}),(0,yr.i)(l.chevron)]})}),render:()=>(0,c.jsx)($m,{spaceStore:s,createdByActorsWithReason:t.createdByActorsWithReason,latestRequestTime:t.latestRequestTime})})}function eg(e){let{request:t,spaceStore:s,shouldDisableInteraction:n}=e;const{pageIds:i,guestUserId:o}=function(e){let{request:t,spaceStore:s}=e;return{pageIds:"guest_invite_request"===t.accessRequest.type?t.accessRequest.attributes.permission_records_and_roles.map((e=>e.id)):[],guestUserId:t.forActor.id}}({request:t,spaceStore:s});return(0,c.jsx)(mm,{pageIds:i,guestUserId:o,spaceStore:s,shouldDisableInteraction:n,from:"guest_request"})}var tg=s(29369),sg=s(55838),ng=s(48019);const ig=(0,g.defineMessages)({filterTeams:{defaultMessage:"Filter teamspaces…",id:"teamsDropdownForMember.filterForTeams.placeholder"},privateTeamspace:{defaultMessage:"Private teamspace",id:"teamsDropdownForMember.privateTeamspace"}});function og(e){const t=(0,o.O7)(),[s,i]=(0,n.useState)(""),l=(0,n.useCallback)((e=>br.RF({environment:t,teamId:e,tab:sg.a.Members,from:"teams_dropdown_space_settings_people"})),[t]),d=(0,r.yK)((e=>({teamName:{color:e.v2.text.primary,fontSize:14},teamMemberCount:{color:e.v2.text.secondary,fontSize:12}})),[]),u=(0,a.VK)((()=>[{key:"teams for member",render:e=>(0,c.jsx)(tn.Z,{...e}),actions:e.teamStores.map((e=>{const t={key:e.id,displayName:e.getName()??L.default.formatMessage(ig.privateTeamspace),analyticsName:e.getName()||"team_unknown",searchName:e.getName(),render:t=>(0,c.jsx)(Qs.Z,{style:{padding:4},textWrapperStyle:{marginLeft:0,marginRight:0},title:(0,c.jsxs)("div",{style:{display:"flex",padding:"4px 6px 4px 8px",alignItems:"flex-start",gap:8,alignSelf:"stretch"},children:[(0,c.jsx)(Mr.p,{disabled:!0,store:e,size:20,style:{borderRadius:4}}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:d.teamName,children:e.getName()??L.default.formatMessage(ig.privateTeamspace)}),(0,c.jsx)("div",{style:d.teamMemberCount,children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"{numMembers} {numMembers, plural, one {member} other {members}}",id:"teamsDropdownForMember.numMembers",values:{numMembers:e.getUserIdsInTeam().length}})})]})]}),disabled:!Boolean(e.getName()),inline:!0,...t}),action:()=>{l(e.id)},closeParentMenu:!1};return t}))}]),[e.teamStores,l,d.teamMemberCount,d.teamName]),p=s,m=(0,c.jsx)(tn.Z,{isInput:!0,children:(0,c.jsx)(Vl.ZP,{value:p,onChange:(0,n.useCallback)((e=>{i(e.target.value)}),[]),focus:!0,focusAfterAnimation:!0,placeholder:L.default.formatMessage(ig.filterTeams)})}),h={menuType:Hs.og.Popup,maxWidth:350,maxHeight:300,header:e.teamStores.length>5?m:void 0};return(0,c.jsx)($s.Z,{...h,children:(0,c.jsx)(ng.Z,{filter:p,context:{blocks:[],environment:t,publicEditMode:void 0},initialFocus:void 0,sections:u})})}function ag(e){let{from:t,teamStores:s}=e;const{styles:i,onClickButton:a}=function(e){let{from:t}=e;const s=(0,r.yK)((e=>({button:{marginRight:8},noTeams:{marginRight:8,color:e.lightTextColor},chevron:{width:10,marginLeft:4,fill:e.lightIconColor},teamspaceName:{color:e.v2.text.secondary,maxWidth:70,...x.Z.textOverflowStyle},teamspaceNameSuffix:{color:e.v2.text.tertiary,paddingLeft:4}})),[]),i=(0,o.O7)(),a=(0,n.useCallback)((()=>{Kp.b4(i,{from:t,button_name:"open_teamspaces"})}),[i,t]);return{styles:s,onClickButton:a}}({from:t}),l=s.length;return(0,c.jsx)(_o.ZP,{popupType:_o.Z4.Popup,onClick:a,renderOrigin:e=>(0,c.jsx)(Xt.Z,{disabled:0===l,style:0===l?i.noTeams:i.button,...e,children:0===l?(0,c.jsx)(g.FormattedMessage,{id:"teamsDropdownForMember.teamsCountNone.label",defaultMessage:"No access"}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{style:i.teamspaceName,title:s[0].getName(),children:s[0].getName()}),(0,c.jsx)("span",{style:i.teamspaceNameSuffix,children:l>1?(0,c.jsxs)("div",{children:["+",l-1]}):null}),(0,yr.i)(i.chevron)]})}),render:()=>(0,c.jsx)(og,{teamStores:s})})}function rg(e){let{spaceStore:t,request:s}=e;const{teamStores:n}=function(e){let{request:t,spaceStore:s}=e;const n=(0,a.VK)((()=>{var e,n;const i=hr.Z.state.teams.filter((e=>e.isDefault()));if((null===(e=t.accessRequest.attributes)||void 0===e?void 0:e.origin_table)===tg.e0&&null!==(n=t.accessRequest.attributes)&&void 0!==n&&n.origin_id){var o;const e=ne.zX.createChildStore(s,{table:tg.e0,id:null===(o=t.accessRequest.attributes)||void 0===o?void 0:o.origin_id});i.includes(e)||i.push(e)}return i}),[t,s]);return{teamStores:n}}({request:s,spaceStore:t});return(0,c.jsx)(ag,{teamStores:n,from:"member_request"})}var lg=s(42875);function dg(e){let{request:t,spaceStore:s}=e;const{relativeDate:n,email:i,userStore:o,styles:l}=function(e){let{request:t,spaceStore:s}=e;const n=(0,r.yK)((e=>({container:{display:"flex",alignItems:"center",fontSize:x.Z.fontSize.UIRegular.desktop,gap:10,flex:"1 0 0",maxWidth:50},userAvatar:{},title:{height:17,alignSelf:"stretch",fontSize:x.Z.fontSize.UIRegular.desktop,fontStyle:"normal",fontWeight:510,lineHeight:"18px",maxWidth:160,...x.Z.textOverflowStyle},subtitle:{height:17,alignSelf:"stretch",fontSize:x.Z.fontSize.UISmall.desktop,fontStyle:"normal",fontWeight:400,lineHeight:"15px",color:e.v2.text.secondary,maxWidth:160,...x.Z.textOverflowStyle}})),[]),i=ne.U6.createChildStore(s,{table:B.KJ,id:t.forActor.id}),{email:o}=(0,a.VK)((()=>({email:i.getEmail()})),[i]),l=(0,g.useIntl)(),d=A.CQ(t.latestRequestTime,(0,lg.r)()),c=(0,xo.ZV)({value:d,date_format:"relative",userTimeZone:(0,lg.r)(),intl:l,allowRelativeDates:!0});return{email:o,styles:n,userStore:i,relativeDate:c}}({request:t,spaceStore:s});return(0,c.jsxs)("div",{style:l.container,children:[(0,c.jsx)(Rn.Z,{style:l.userAvatar,userStore:o,size:28}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:l.title,title:i,children:i}),(0,c.jsx)("div",{style:l.subtitle,title:n,children:n})]})]})}function cg(e){let{spaceStore:t,requests:s,requestType:i,domainFilterValues:l,internalDomains:d}=e;const{environment:u,columnRenderInfo:p,tableStyles:m,styles:f,sortState:x,setSortState:S,selectedRowIds:v,setSelectedRowIds:b,pagedRows:M,isDeclineButtonLoading:j,isApproveButtonLoading:C,onClickApprove:w,onClickDecline:k,shouldShowLoadMore:T,requestsCount:I,onLoadMore:Z,isTableEmpty:P,shouldHideActions:F}=function(e){let{spaceStore:t,requests:s,requestType:i,domainFilterValues:l,internalDomains:d}=e;const u=(0,a.VK)((()=>"member"===i?[ug,pg,gg,hg]:[ug,mg,gg,hg]),[i]),p=(0,r.yK)((e=>({...(0,Se.b)({columnRenderInfo:u,theme:e,containerMarginTop:0})})),[u]),m=(0,r.yK)((e=>({container:{paddingBottom:30},headerContainer:{display:"flex",justifyContent:"space-between"},titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510,minHeight:30,paddingTop:10},titleNumber:{color:e.v2.text.tertiary},actionsContainer:{display:"flex",borderRadius:6,border:`1px solid ${e.v2.stroke.regular}`,boxShadow:"0px 2px 12px 0px rgba(29, 27, 22, 0.06)"},actionLeftButton:{borderRadius:"4px 0px 0px 4px",paddingLeft:10,paddingRight:0,height:30},buttonContainerApprove:{display:"flex",padding:"0px 12px 0px 0px",justifyContent:"center",alignItems:"center",gap:4,alignSelf:"stretch",color:e.v2.text.ui.blue.primary},buttonContainerDecline:{display:"flex",padding:"0px 12px 0px 10px",justifyContent:"center",alignItems:"center",gap:4,alignSelf:"stretch",color:e.v2.text.secondary},buttonIcon:{width:20,height:20,paddingTop:1,flexDirection:"column",justifyContent:"center",alignItems:"center",gap:10},buttonText:{fontSize:14,fontWeight:510},buttonDivider:{width:1,background:e.v2.stroke.deemphasized},actionRightButton:{borderRadius:"0px 4px 4px 0px",paddingLeft:0,paddingRight:0,height:30},noRowContainer:{display:"flex",height:32,padding:"0px 4px",alignItems:"center",borderBottom:`1px solid ${e.v2.stroke.regular}`},noRowText:{color:e.v2.text.secondary,fontSize:14,fontWeight:400,textAlign:"center"}})),[]),[f,x]=(0,n.useState)({column:u[0],sortAscending:!0}),[S,v]=(0,n.useState)([]),b=(0,a.VK)((()=>Ut.state.searchQuery),[]),M=(0,a.VK)((()=>s.map((e=>{const s=ne.U6.createChildStore(t,{table:B.KJ,id:e.forActor.id});return{spaceStore:t,request:e,requestType:i,email:s.getEmail(),id:e.accessRequest.id,isClickable:!1,shouldDisableInteraction:S.includes(e.accessRequest.id)}})).filter((e=>{var t;if(b){var s;if(!(null===(s=e.email)||void 0===s?void 0:s.includes(b)))return!1}if(!l||0===l.length)return!0;const n=null===(t=e.email)||void 0===t?void 0:t.split("@")[1];return null==l?void 0:l.some((e=>"other"===e?!(null!=d&&d.some((e=>e.url===n))):n===e))}))),[t,s,S,b,i,l,d]),j=M.length,C=(0,a.VK)((()=>function(e,t){let{sortAscending:s}=t;const n=h.MR(e,(e=>e.email));s||n.reverse();return n}(M,f)),[M,f]),[w,k]=(0,n.useState)(xm),T=(0,n.useCallback)((()=>{k(w+xm)}),[w]),I=w<C.length,Z=C.slice(0,w),P=(0,a.VK)((()=>M.filter((e=>S.includes(e.id))).map((e=>e.request))),[S,M]),[F,A]=(0,n.useState)(!1),[_,R]=(0,n.useState)(!1),O=(0,o.O7)(),D=(0,n.useCallback)((()=>{if(Kp.b4(O,{from:`${i}_request`,button_name:"bulk_approve",count:P.length}),0===P.length)return;R(!0);const e=Po.kk.fromAccessRequest(P[0].accessRequest);e.isGuestInviteRequest()?y.mY({environment:O,requests:P,status:"approved",from:"requests_center",onResolveComplete:(e,t)=>{R(!1),v([]),e.length>0?oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkApproveToast.guests",defaultMessage:"Approved {numberOfSuccesses, plural, one {guest request for {userEmail}} other {{numberOfSuccesses} guest requests}}",values:{numberOfSuccesses:e.length,userEmail:e[0].email}})}):t.length>0&&oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkApproveToast.guests.failed",defaultMessage:"Failed approve {numberOfRequests, plural, one {guest request for {userEmail}} other {{numberOfRequests} guest requests}}, please try again.",values:{numberOfRequests:t.length,userEmail:t[0].email}})})}}):e.isSpaceMembershipRequest()&&y.YN({environment:O,store:t,requests:P,status:"approved",from:"requests_center",onResolveComplete:e=>{R(!1),v([]),e?oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkApproveToast.members.success",defaultMessage:"Approved {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}",values:{numberOfRequests:P.length,userEmail:P[0].forActor.email}})}):oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkApproveToast.members.failed",defaultMessage:"Failed approve {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}, please try again.",values:{numberOfRequests:P.length,userEmail:P[0].forActor.email}})})}})}),[P,O,t,i]),L=(0,n.useCallback)((()=>{Kp.b4(O,{from:`${i}_request`,button_name:"bulk_decline",count:P.length}),Hm.setState({...Hm.state,isModalOpen:!0,requests:P,requestType:i,handleClickDecline:()=>{Kp.b4(O,{from:`${i}_request`,button_name:"confirm_in_dialog",count:P.length});const e=Po.kk.fromAccessRequest(P[0].accessRequest);e.isGuestInviteRequest()?y.mY({environment:O,requests:P,status:"rejected",from:"requests_center",onResolveComplete:(e,t)=>{A(!1),v([]),e.length>0?oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkDeclineToast.guests.success",defaultMessage:"Declined {numberOfSuccesses, plural, one {guest request for {userEmail}} other {{numberOfSuccesses} guest requests}}",values:{numberOfSuccesses:e.length,userEmail:e[0].email}})}):t.length>0&&oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkDeclineToast.guests.failed",defaultMessage:"Failed decline {numberOfSuccesses, plural, one {guest request for {userEmail}} other {{numberOfSuccesses} guest requests}}, please try again.",values:{numberOfSuccesses:t.length,userEmail:t[0].email}})})}}):e.isSpaceMembershipRequest()&&y.YN({environment:O,store:t,requests:P,status:"rejected",from:"requests_center",onResolveComplete:e=>{A(!1),v([]),e?oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkDeclineToast.members.success",defaultMessage:"Declined {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}",values:{numberOfRequests:P.length,userEmail:P[0].forActor.email}})}):oi.oV({label:(0,c.jsx)(g.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkDeclineToast.members.failed",defaultMessage:"Failed decline {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}, please try again.",values:{numberOfRequests:P.length,userEmail:P[0].forActor.email}})})}})}})}),[P,O,t,i]),V=0===s.length,N=!M.some((e=>S.includes(e.id)));return{environment:O,columnRenderInfo:u,tableStyles:p,styles:m,sortState:f,setSortState:x,selectedRowIds:S,setSelectedRowIds:v,pagedRows:Z,selectedRequests:P,isDeclineButtonLoading:F,isApproveButtonLoading:_,onClickApprove:D,onClickDecline:L,requestsCount:j,onLoadMore:T,shouldShowLoadMore:I,isTableEmpty:V,shouldHideActions:N}}({spaceStore:t,requests:s,requestType:i,domainFilterValues:l,internalDomains:d});return P?null:(0,c.jsxs)("div",{style:f.container,children:[(0,c.jsxs)("div",{style:f.headerContainer,children:[(0,c.jsxs)("div",{style:f.titleContainer,children:[(0,c.jsx)("div",{children:(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionMembersTab.memberRequests.title",defaultMessage:"Requests"})}),(0,c.jsx)("span",{style:f.titleNumber,children:I})]}),v.length>0&&!F&&(0,c.jsxs)("div",{style:f.actionsContainer,children:[(0,c.jsx)(qm.Z,{style:f.actionLeftButton,onClick:w,isLoading:C,children:(0,c.jsxs)("div",{style:f.buttonContainerApprove,children:[(0,c.jsx)("div",{style:f.buttonIcon,children:zm({width:20,height:20})}),(0,c.jsx)("div",{style:f.buttonText,children:(0,c.jsx)(g.FormattedMessage,{id:"spaceSettings.peopleSection.requestsTable.bulkApprove",defaultMessage:"Approve {numberOfRequests, plural, one {1 request} other {{numberOfRequests} requests}}",values:{numberOfRequests:v.length}})})]})}),(0,c.jsx)("div",{style:f.buttonDivider}),(0,c.jsx)(qm.Z,{style:f.actionRightButton,onClick:k,isLoading:j,children:(0,c.jsxs)("div",{style:f.buttonContainerDecline,children:[(0,c.jsx)("div",{style:{...f.buttonIcon,paddingTop:3},children:rm({width:20,height:20})}),(0,c.jsx)("div",{style:f.buttonText,children:(0,c.jsx)(g.FormattedMessage,{id:"spaceSettings.peopleSection.requestsTable.bulkDecline",defaultMessage:"Decline"})})]})})]})]}),(0,c.jsx)("div",{style:{marginTop:4},children:(0,c.jsx)(Se.D,{allowHorizontalScroll:!0,setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:p,rows:M,showRowBorders:!0,hideHeaderRowPadding:!0,sortState:x,onSortStateChanged:S,renderNoRowsComponent:()=>(0,c.jsx)("div",{style:f.noRowContainer,children:(0,c.jsx)("div",{style:f.noRowText,children:(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionRequestTable.emptySearch",defaultMessage:"No search results"})})}),styles:m,getStyleForRow:e=>{if(e.shouldDisableInteraction)return{backgroundColor:"rgba(35, 131, 226, 0.07)"}},loadMoreType:"button",onLoadMore:T?Z:void 0,multiselect:I>0?{header:{isDisabled:0===M.length,isSelected:v.length>0&&v.length===M.length,onClick:()=>{v.length===M.length?(b([]),Kp.pZ(u,{from:`${i}_request`,action:"deselect_all",row_count:v.length})):(b(M.map((e=>e.id))),Kp.pZ(u,{from:`${i}_request`,action:"select_all",row_count:M.length}))}},row:{getDisabledState:e=>!1,getSelectedState:e=>v.includes(e.id),onClick:e=>{b((t=>t.includes(e.id)?(Kp.pZ(u,{from:`${i}_request`,action:"deselect_row",row_count:1}),t.filter((t=>t!==e.id))):(Kp.pZ(u,{from:`${i}_request`,action:"select_row",row_count:1}),t.concat(e.id))))}}}:void 0})}),(0,c.jsx)(Qm,{})]})}const ug={id:"user",headerTitle:(0,c.jsx)("div",{style:{fontSize:14},children:(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionRequestsTable.user",defaultMessage:"User"})}),renderCell:e=>(0,c.jsx)(dg,{request:e.request,spaceStore:e.spaceStore}),widthData:{width:219},sortable:!0},pg={id:"teamspaces",headerTitle:(0,c.jsx)("div",{style:{paddingLeft:8,fontSize:14},children:(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionRequestsTable.teamspaces",defaultMessage:"Teamspaces"})}),renderCell:e=>(0,c.jsx)(rg,{spaceStore:e.spaceStore,request:e.request}),widthData:{width:175},sortable:!1},mg={id:"pages",headerTitle:(0,c.jsx)("div",{style:{paddingLeft:8,fontSize:14,minWidth:175,textAlign:"left"},children:(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionRequestsTable.pages",defaultMessage:"Access"})}),renderCell:e=>(0,c.jsx)(eg,{request:e.request,spaceStore:e.spaceStore,shouldDisableInteraction:e.shouldDisableInteraction}),widthData:{width:175},sortable:!1},gg={id:"requestBy",headerTitle:(0,c.jsx)("div",{style:{paddingLeft:8,fontSize:14,minWidth:160,textAlign:"left"},children:(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionRequestsTable.requestBy",defaultMessage:"Requested by"})}),renderCell:e=>(0,c.jsx)(Xm,{request:e.request,spaceStore:e.spaceStore,shouldDisableInteraction:e.shouldDisableInteraction,requestType:e.requestType}),widthData:{width:120},sortable:!1},hg={id:"actions",headerTitle:(0,c.jsx)("div",{style:{minWidth:155}}),renderCell:e=>(0,c.jsx)(Ym,{request:e.request,spaceStore:e.spaceStore,shouldDisableInteraction:e.shouldDisableInteraction,requestType:e.requestType}),widthData:{width:100},sortable:!1};function fg(e){let{spaceStore:t,guests:s}=e;const[i,r]=(0,n.useState)(),l=(0,o.O7)(),d=(0,a.VK)((()=>(Xp.getData(l,{spaceId:t.id})??[]).filter((e=>s.some((s=>{var n;return null===(n=ne.U6.createChildStore(t,{table:B.KJ,id:s.userId}).getEmail())||void 0===n?void 0:n.endsWith(`@${e.url}`)}))))),[l,t,s]),u=Kt({spaceStore:t}),p=qp({spaceStore:t}),{requests:m}=Wt({spaceStore:t,requestType:"guest"});return zt({requestType:"guest",spaceStore:t}),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Em,{guests:s,spaceStore:t,internalDomains:d,domainFilterValues:i,setDomainFilterValues:r}),u&&p&&(0,c.jsx)(cg,{requests:m,spaceStore:t,requestType:"guest",domainFilterValues:i,internalDomains:d}),(0,c.jsx)(Cm,{guests:s,spaceStore:t,domainFilterValues:i??[],internalDomains:d})]})}function xg(e){let{spaceStore:t,spacePermissionsSettingsStore:s}=e;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(yg,{}),(0,c.jsx)(Sg,{spaceStore:t,spacePermissionsSettingsStore:s})]})}function yg(){const e=Mg(),t=(0,o.O7)(),s=(0,n.useCallback)((()=>{C.D({environment:t,url:(0,Ue.UY)("guides.invitePerson")})}),[t]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(me.Z,{large:!0,style:e.headingStyle,children:[(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.people.common.title",defaultMessage:"People"}),(0,c.jsx)(Ri.Z,{isSmall:!0,onClick:s,icon:Hn.m,children:(0,c.jsx)(g.FormattedMessage,{id:"peopleSection.title.helpButton",defaultMessage:"Learn more"})})]}),(0,pt.Um)()]})}function Sg(e){let{spaceStore:t,spacePermissionsSettingsStore:s}=e;const n=(0,o.O7)(),i=(0,a.VK)((()=>{const e=Bt.subscriptionDataStoreInstance.state;return function(e){let{environment:t,spaceStore:s,subscriptionData:n}=e;if(!s.canEditMembership())return;const i=s.id,o=n&&("subscribed_admin"===n.type||"unsubscribed_admin"===n.type||"subscribed_membership_admin"===n.type)&&n.inviteLinkCode;if(!o)return;return(0,Ts.cJ)(t,i,o)}({spaceStore:t,environment:n,subscriptionData:e})}),[t,n]),r=function(e){let{spaceStore:t}=e;const s=(0,o.O7)();return(0,a.VK)((()=>t.canEditMembership()&&Rt.qF(s)),[s,t])}({spaceStore:t}),l=(0,a.VK)((()=>Boolean(t.getInviteLinkEnabled())),[t]),d=Mg();return r&&i?(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:d.inviteLinkSection,children:[(0,c.jsxs)("div",{style:{marginRight:8,flexGrow:1},children:[(0,c.jsx)(me.Z,{children:(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.spaceMembers.inviteLink.title",defaultMessage:"Invite link"})}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"85%"},children:(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionSettings.spaceMembers.inviteLink.caption.v2",defaultMessage:"Enable a secret link for Workspace Owners and Membership Admins to invite new members."})}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"85%"},children:s&&l&&i&&(0,c.jsx)(bg,{spaceStore:t})})]}),(0,c.jsx)("div",{style:{marginTop:28},children:(0,c.jsx)(Er.Z,{on:l,onClick:()=>{!function(e){let{environment:t,spaceStore:s,inviteLinkEnabled:n}=e;const i=!n;b.eo(t,{enabled:i}),P.createAndCommit({userAction:"SpacePermissionsSettings.handleInviteLinkClick",environment:t,perform:e=>{w.ys({transaction:e,spaceStore:s,inviteLinkEnabled:Boolean(i)})}})}({environment:n,spaceStore:t,inviteLinkEnabled:l})}})})]}),s&&l&&i&&(0,c.jsx)(vg,{inviteLinkUrl:i}),(0,c.jsx)(yn.Z,{size:40})]}):null}function vg(e){let{inviteLinkUrl:t}=e;const s=(0,r.yK)((e=>({input:{height:32,padding:"0px 4px 0px 8px",alignItems:"center",gap:"8px",flex:"1 0 0",borderRadius:"6px",border:e.v2.stroke.deemphasized,background:e.v2.surface.wash},button:{display:"flex",height:"32px",padding:"0px 12px",justifyContent:"center",alignItems:"center",borderRadius:"6px",border:`1px solid ${e.v2.stroke.regular}`,paddingLeft:12,paddingRight:12},buttonText:{fontSize:"14px",fontWeight:"510",lineHeight:"18px",textAlign:"center",fontStyle:"normal",color:e.v2.text.primary}})),[]),n=(0,o.O7)();return(0,c.jsx)("div",{children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"10px",alignSelf:"stretch",paddingBottom:"0px"},children:[(0,c.jsx)(dn.Z,{type:"text",format:dn.B.Default,value:t,disabled:!0,style:s.input}),(0,c.jsx)(ve.Z,{onClick:()=>{!function(e){let{environment:t,inviteLinkUrl:s}=e;ye.RD({environment:t,stringValue:s,copiedMessage:ye.tq.copiedLinkToClipboard}),hc.nl(t)}({environment:n,inviteLinkUrl:t})},style:s.button,children:(0,c.jsx)("div",{style:s.buttonText,children:(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.spaceMembers.inviteLink.copyButton",defaultMessage:"Copy link"})})})]})})}function bg(e){let{spaceStore:t}=e;const s=(0,o.O7)();return(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionSettings.spaceMembers.inviteLink.resetLink.v2",defaultMessage:"You can also <resetlink>generate a new link</resetlink>",values:{resetlink:e=>(0,c.jsx)(vn.Z,{onClick:()=>{M.showDialog({message:(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.inviteLinkRefreshModal.description",defaultMessage:"Are you sure you want to reset the invite link for all space members? Your old one will no longer be able to be used."}),showCancel:!0,keepFocus:!1,handleCancel:M.dismissDialog,items:[{label:(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.inviteLinkRefreshModal.accept",defaultMessage:"Reset"}),color:"red",onAccept:async()=>{await T.refreshInviteLink(s,{spaceId:t.id}),rt.bi(s)}}]})},children:e})}})}function Mg(){return(0,r.yK)((e=>({commonTitle:{display:"flex",alignItems:"center"},commonTitleText:{fontSize:"17px",lineHeight:"22px",fontWeight:590,color:e.v2.text.primary,fontStyle:"normal"},commonHelpButton:{paddingLeft:"1px"},inviteLinkSection:{paddingTop:"16px",paddingBottom:"16px",display:"flex",alignItems:"flex-start"},headingStyle:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:x.Z.fontWeight.medium,display:"flex",justifyContent:"space-between"}})),[])}var jg=s(72141),Cg=s(24665);function wg(e){let{user:t,spaceStore:s,shouldDisableAction:i}=e;const{styles:l,handleRemoveMemberFromWorkspace:d,environment:u,isCurrentUser:p}=function(e){let{user:t,spaceStore:s}=e;const i=(0,r.yK)((e=>({container:{width:"100%",display:"flex",justifyContent:"flex-end"},button:{display:"flex",width:24,height:24,justifyContent:"center",alignItems:"center",gap:10,paddingLeft:0,paddingRight:0},buttonIcon:{width:20,height:20,fill:e.v2.icon.secondary},upgradeButton:{},removeMenuDivider:{borderTop:e.v2.stroke.deemphasized},removeButton:{color:em.Lr[e.mode].red},upgradeIcon:{width:17,height:17}})),[]),l=(0,o.O7)(),d=(0,n.useCallback)((async()=>{const{currentUserSettingsStore:e}=Ke.default.state;return e?await(0,Cg.$A)({user:t,spaceStore:s,environment:l,userSettingStore:e}):()=>{}}),[s,l,t]),c=(0,a.VK)((()=>{var e;return(null===(e=Ke.default.state.currentUserStore)||void 0===e?void 0:e.id)===t.userId}),[t]);return{styles:i,handleRemoveMemberFromWorkspace:d,environment:l,isCurrentUser:c}}({user:t,spaceStore:s});return(0,c.jsx)("div",{style:l.container,children:(0,c.jsx)(_o.ZP,{popupType:_o.Z4.Popup,renderOrigin:e=>(0,c.jsx)(Xt.Z,{style:l.button,...e,children:(0,c.jsx)(c.Fragment,{children:(0,nm.O)(l.buttonIcon)})}),onClick:()=>{Kp.b4(u,{from:"member",button_name:"actions"})},disabled:i,render:()=>(0,c.jsx)("div",{children:(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,initialFocus:void 0,sections:[{key:"remove",render:e=>(0,c.jsx)(tn.Z,{...e,style:l.removeMenuDivider}),items:[{key:"remove",render:e=>(0,c.jsx)(Qs.Z,{...e,buttonStyle:l.removeButton,icon:(0,$n.V)(l.upgradeIcon),title:(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionmembersTab.removeMember",defaultMessage:"{isCurrentUser, select, true {Leave workspace} other {Remove from workspace}} ",values:{isCurrentUser:p}})}),action:async()=>{await d(),Kp.b4(u,{from:"member",button_name:"remove"})}}]}]})})})})}var kg=s(16639);function Tg(e){let{shouldShowSearchHeader:t,sections:s,filterPlaceholder:i}=e;const a=(0,o.O7)(),[r,l]=(0,n.useState)(""),d=r,u=(0,c.jsx)(tn.Z,{isInput:!0,children:(0,c.jsx)(Vl.ZP,{value:d,onChange:(0,n.useCallback)((e=>{l(e.target.value)}),[]),focus:!0,focusAfterAnimation:!0,placeholder:i&&L.default.formatMessage(i)})}),p={menuType:Hs.og.Popup,maxWidth:350,maxHeight:300,header:t?u:void 0};return(0,c.jsx)($s.Z,{...p,children:(0,c.jsx)(ng.Z,{filter:d,context:{blocks:[],environment:a,publicEditMode:void 0},initialFocus:0,sections:s})})}const Ig=(0,g.defineMessages)({filterGroups:{defaultMessage:"Filter groups...",id:"GroupPopupContent.filterGroups"}});function Zg(e){let{groups:t,spaceStore:s,spacePermissionsSettingsStore:n}=e;const i=(0,a.VK)((()=>t.map((e=>({group:e,numberOfGroupMembers:(0,kg.kQ)({group:e,spaceStore:s}).length})))),[t,s]),o=(0,r.yK)((e=>({buttonTitle:{display:"flex",padding:"4px 6px 4px 8px",alignItems:"flex-start",gap:8,alignSelf:"stretch"},groupName:{color:e.v2.text.primary,fontSize:14},groupMemberCount:{color:e.v2.text.secondary,fontSize:12}})),[]),l=t.length>5;return(0,c.jsx)(Tg,{shouldShowSearchHeader:l,sections:[{key:"groups for member",render:e=>(0,c.jsx)(tn.Z,{...e}),actions:i.map((e=>{const{group:t,numberOfGroupMembers:i}=e;return{key:t.id,displayName:t.name,analyticsName:t.name??"unknown group",searchName:t.name,render:e=>(0,c.jsx)(Qs.Z,{style:{padding:4},textWrapperStyle:{marginLeft:0,marginRight:0},title:(0,c.jsxs)("div",{style:o.buttonTitle,children:[(0,c.jsx)(en.Z,{disabled:!0,bucket:"public",icon:t.icon?{pointer:s.pointer,icon:t.icon}:void 0,size:20,isEmptyPage:!1,title:t.name}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:o.groupName,children:t.name}),(0,c.jsx)("div",{style:o.groupMemberCount,children:(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.userGroup.memberCount",defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} member} other {{numberOfGroupMembers} members}}",values:{numberOfGroupMembers:i}})})]})]}),...e}),action:()=>{n.setState({...n.state,currentTab:Cd.Q.Groups})},closeParentMenu:!1}}))}],filterPlaceholder:Ig.filterGroups})}function Pg(e){let{user:t,spaceStore:s,spacePermissionsSettingsStore:i}=e;const{styles:l,groups:d,numberOfGroups:u,firstGroupName:p,onClick:m}=function(e){let{user:t,spaceStore:s}=e;const i=(0,a.VK)((()=>s.getPermissionGroups().filter((e=>(0,kg.kQ)({group:e,spaceStore:s}).includes(t.userId)))),[s,t.userId]),l=(0,o.O7)(),d=(0,n.useCallback)((()=>{Kp.b4(l,{from:"member",button_name:"open_groups"})}),[l]),c=(0,r.yK)((e=>({button:{marginRight:8},noGroups:{marginRight:8,color:e.lightTextColor},chevron:{width:10,marginLeft:4,fill:e.lightIconColor},noneGroupText:{color:e.v2.text.tertiary},groupNameText:{color:e.v2.text.secondary,maxWidth:100,...x.Z.textOverflowStyle},groupNumberText:{color:e.v2.text.secondary}})),[]),u=(0,g.useIntl)(),p=i.length,m=p>0?(0,kg.kF)({group:i[0],intl:u}):void 0;return{styles:c,groups:i,numberOfGroups:p,firstGroupName:m,onClick:d}}({user:t,spaceStore:s});return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(_o.ZP,{popupType:_o.Z4.Popup,onClick:m,renderOrigin:e=>(0,c.jsx)(Xt.Z,{disabled:0===u,style:0===u?l.noGroups:l.button,...e,children:0===u?(0,c.jsx)("span",{style:l.noneGroupText,children:(0,c.jsx)(g.FormattedMessage,{id:"userGroupsCell.noGroups",defaultMessage:"None"})}):1===u?(0,c.jsx)("span",{style:l.groupNameText,title:p,children:p}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:l.groupNumberText,children:u}),(0,yr.i)(l.chevron)]})}),render:()=>(0,c.jsx)(Zg,{groups:d,spaceStore:s,spacePermissionsSettingsStore:i})})})}var Fg=s(7567);function Ag(e){let{user:t,spaceStore:s,maxWidth:n}=e;const i=(0,r.yK)((e=>({button:{color:e.v2.text.secondary,maxWidth:n}})),[n]),l=(0,o.O7)(),{isPermissionSelectDisabled:d,currentUserId:u}=(0,a.VK)((()=>{let e=!0;return(s.canAdmin()||s.canEditMembership()&&(jg.RN(t.role)||t.userId===l.currentUser.id))&&(e=!1),{isPermissionSelectDisabled:e,currentUserId:l.currentUser.id}}),[s,l,t.role,t.userId]),p=(0,a.VK)((()=>Ke.default.state.currentUserSettingsStore),[]),m=(0,g.useIntl)(),f=(0,a.VK)((()=>{const e=m.formatMessage({id:"spacePermissionSettings.memberRoleSelect.permissionitem.roleUpgradeDisabled",defaultMessage:"Cannot upgrade to a higher role than member"}),t="enterprise"===s.getSubscriptionTier();return h.oA(jg.an.filter((e=>"none"!==e)).map((n=>{if(t||"membership_admin"!==n)return{role:n,disabledInfo:!s.canAdmin()&&jg.Bc(n)?{isDisabled:!0,disabledMessage:e}:void 0}})))}),[m,s]);return p?(0,c.jsx)(Fg.ZP,{role:t.role,table:Ms.bx,type:"user_permission",disabled:d,isUserPermission:t.userId===u,upgradeButtonName:"space_permission_item",availableRoleItems:f,buttonStyle:i.button,onChange:async e=>{await Cg.Vu({member:t,newRole:e,currentUserSettingsStore:p,spaceStore:s,environment:l})},onClick:()=>{Kp.b4(l,{from:"member",button_name:"open_role"})}}):null}function _g(e){let{user:t,spaceStore:s}=e;return(0,c.jsx)("div",{children:(0,c.jsx)(Ag,{user:t,spaceStore:s,maxWidth:148})})}function Rg(e){let{user:t}=e;const{userTeamStores:s}=function(e){let{user:t}=e;const s=(0,a.VK)((()=>hr.Z.state.teams.filter((e=>e.isMemberOrGuest(t.userId)))),[t.userId]);return{userTeamStores:s}}({user:t});return(0,c.jsx)(ag,{teamStores:s,from:"member"})}function Og(e){let{members:t,spaceStore:s,spacePermissionsSettingsStore:i}=e;const{tableStyles:l,styles:d,sortState:u,setSortState:p,rows:m,membersCount:f,searchQuery:x,columnRenderInfo:y,shouldShowRequest:S,shouldShowLoadMore:v,onLoadMore:b}=function(e){let{members:t,spaceStore:s,spacePermissionsSettingsStore:i}=e;const l=Gp({spaceStore:s}),d=(0,a.VK)((()=>s.canAdmin()),[s]),c=(0,a.VK)((()=>l?[Bg,Dg,Lg,Vg,Ng]:[Bg,Dg,Lg,Vg]),[l]),u=(0,r.yK)((e=>({...(0,Se.b)({columnRenderInfo:c,theme:e,containerMarginTop:0})})),[c]),p=(0,r.yK)((e=>({titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510,height:32},titleNumber:{color:e.v2.text.tertiary},emptyMessage:{display:"flex",height:32,padding:"0px 4px",alignItems:"center",borderBottom:`1px solid ${e.v2.stroke.regular}`}})),[]),[m,f]=(0,n.useState)({column:Vg,sortAscending:!1}),x=(0,g.useIntl)(),y=(0,a.VK)((()=>Ut.state.searchQuery),[]),S=function(e){let{spaceStore:t,members:s}=e;const n=qp({spaceStore:t}),i=(0,o.O7)(),a=t.id,[r]=(0,Vt.r5)((async()=>{if(!n)return;const e=await T.getRecentlyRemovedUsers(i,{spaceId:a});if("failed"===e.type)throw M.showError(e),e;return e.data.recentlyRemovedMembers}),[a,i,n,s]);return r.value}({spaceStore:s,members:t}),v=(0,a.VK)((()=>t.map((e=>{const t=ne.U6.createChildStore(s,{table:B.KJ,id:e.userId}),n=null==S?void 0:S.find((t=>t.userId===e.userId));return{spaceStore:s,user:e,email:t.getEmail(),userName:t.getDisplayName(x),id:e.userId,isClickable:!1,userRole:e.role,spacePermissionsSettingsStore:i,shouldDisableAction:!(d||!l||"editor"!==e.role&&"membership_admin"!==e.role),restorationStatus:null==n?void 0:n.restorationStatus}})).filter((e=>{var t,s;return void 0===y||(((null===(t=e.email)||void 0===t?void 0:t.includes(y))||(null===(s=e.userName)||void 0===s?void 0:s.includes(y)))??!1)}))),[s,t,x,y,d,l,i,S]),b=v.length,j=(0,a.VK)((()=>function(e,t){let{sortAscending:s,column:n}=t,i=e;switch(n.id){case"user":i=h.MR(e,(e=>e.email));break;case"roles":i=h.MR(e,(e=>jg.xm[e.userRole]))}s||i.reverse();return i}(v,m)),[v,m]),C=Kt({spaceStore:s}),[w,k]=(0,n.useState)(hm),I=(0,n.useCallback)((()=>{k(w+hm)}),[w]),Z=w<j.length,P=j.slice(0,w);return{tableStyles:u,styles:p,sortState:m,setSortState:f,rows:P,searchQuery:y,membersCount:b,columnRenderInfo:c,shouldShowRequest:C,onLoadMore:I,shouldShowLoadMore:Z}}({members:t,spaceStore:s,spacePermissionsSettingsStore:i});return(0,c.jsxs)(c.Fragment,{children:[S&&(0,c.jsxs)("div",{style:d.titleContainer,children:[(0,c.jsx)("span",{children:(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionMembersTab.activeMembers.title",defaultMessage:"Active"})}),(0,c.jsx)("span",{style:d.titleNumber,children:f})]}),(0,c.jsx)("div",{style:{marginTop:S?4:-1},children:(0,c.jsx)(Se.D,{allowHorizontalScroll:!0,setStickyHeaderRow:!0,columnRenderInfo:y,rows:m,showRowBorders:!0,hideHeaderRowPadding:!0,sortState:u,onSortStateChanged:p,loadMoreType:"button",onLoadMore:v?b:void 0,renderNoRowsComponent:()=>(0,c.jsx)(Me.Z,{isSmall:!0,style:d.emptyMessage,children:x?(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionMembersTab.emptySearch",defaultMessage:"No search results"}):(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionMembersTab.emptyRow",defaultMessage:"No members"})}),styles:l})})]})}const Bg={id:"user",headerTitle:(0,c.jsx)("div",{style:{fontSize:14},children:(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionMembersTab.user",defaultMessage:"User"})}),renderCell:e=>(0,c.jsx)(jm,{userId:e.user.userId,restorationStatus:e.restorationStatus,spaceStore:e.spaceStore}),widthData:{width:219},sortable:!0},Dg={id:"teamspaces",headerTitle:(0,c.jsx)("div",{style:{paddingLeft:8,fontSize:14},children:(0,c.jsx)(g.FormattedMessage,{id:"teamspaces",defaultMessage:"Teamspaces"})}),renderCell:e=>(0,c.jsx)(Rg,{user:e.user}),widthData:{width:175},sortable:!1},Lg={id:"groups",headerTitle:(0,c.jsx)("div",{style:{paddingLeft:8,fontSize:14},children:(0,c.jsx)(g.FormattedMessage,{id:"groups",defaultMessage:"Groups"})}),renderCell:e=>(0,c.jsx)(Pg,{user:e.user,spaceStore:e.spaceStore,spacePermissionsSettingsStore:e.spacePermissionsSettingsStore}),widthData:{width:118.5},sortable:!1},Vg={id:"roles",headerTitle:(0,c.jsx)("div",{style:{paddingLeft:8,fontSize:14},children:(0,c.jsx)(g.FormattedMessage,{id:"role",defaultMessage:"Role"})}),renderCell:e=>(0,c.jsx)(_g,{user:e.user,spaceStore:e.spaceStore}),widthData:{width:118.5},sortable:!0},Ng={id:"actions",headerTitle:(0,c.jsx)(c.Fragment,{}),renderCell:e=>(0,c.jsx)(wg,{user:e.user,spaceStore:e.spaceStore,shouldDisableAction:e.shouldDisableAction}),widthData:{width:51},sortable:!1};var Eg=s(47612),Ug=s(32566);function Wg(e){let{leftIcon:t,rightIcon:s,onClick:n,content:i}=e;const o=(0,r.yK)((e=>({container:{display:"flex",width:"100%",padding:8,justifyContent:"flex-start",alignItems:"center",borderRadius:8,background:e.v2.surface.washDesktop},iconContainer:{display:"flex",width:20,height:20,paddingTop:1,flexDirection:"column",alignItems:"center",justifyContent:"center",gap:10},icon:{fontSize:14,fontWeight:510,fill:e.v2.icon.secondary,cursor:n?"pointer":"default"},title:{display:"flex",fontSize:14,fontWeight:500,color:e.v2.text.secondary,paddingLeft:6,paddingRight:2,height:18,cursor:n?"pointer":"default"},ctaIconContainer:{display:"flex",width:16,height:16,paddingTop:1,flexDirection:"column",alignItems:"center",gap:10,paddingLeft:2,paddingRight:0,cursor:n?"pointer":"default"},ctaIcon:{fontSize:12,fill:e.v2.icon.secondary,fontWeight:510}})),[n]);return(0,c.jsxs)("div",{style:o.container,children:[t&&(0,c.jsx)("div",{style:o.iconContainer,onClick:n,children:t}),(0,c.jsx)("div",{style:o.title,onClick:n,children:i}),s&&(0,c.jsx)("div",{style:o.ctaIconContainer,onClick:n,children:s})]})}function Kg(e){let{currentTab:t}=e;const s=(0,r.yK)((e=>({icon:{fontSize:14,fontWeight:510,fill:e.v2.icon.secondary,cursor:"pointer"},ctaIcon:{fontSize:12,fill:e.v2.icon.secondary,fontWeight:510}})),[]),i=(0,o.O7)(),a=(0,n.useCallback)((()=>{it.Z.setState({...it.Z.state,currentTab:"security",defaultSubtab:void 0}),Kp.kx(i,{current_tab:t})}),[i,t]);return(0,n.useEffect)((()=>{Kp.Ad(i,{current_tab:t})}),[i,t]),(0,c.jsx)(Wg,{leftIcon:(0,Eg.C)(s.icon),content:(0,c.jsx)(g.FormattedMessage,{id:"PeopleSectionSecurityBanner.title",defaultMessage:"Some invite settings have moved, make changes in Security tab"}),rightIcon:(0,Ug.k)(s.ctaIcon),onClick:a})}function zg(e){let{spaceStore:t,members:s,spacePermissionsSettingsStore:n}=e;const i=Kt({spaceStore:t}),o=qp({spaceStore:t}),{requests:a}=Wt({spaceStore:t,requestType:"member"});return zt({requestType:"member",spaceStore:t}),(0,c.jsxs)(c.Fragment,{children:[i&&(0,c.jsxs)("div",{style:{paddingTop:16,paddingBottom:16},children:[o&&(0,c.jsx)(Kg,{currentTab:"members"}),(0,c.jsx)(cg,{requests:a,spaceStore:t,requestType:"member"})]}),(0,c.jsx)(Og,{members:s,spaceStore:t,spacePermissionsSettingsStore:n})]})}var qg=s(83890);function Gg(e){let{recentRecoverableUser:t,spaceStore:s}=e;const{environment:i,styles:a,handleReprovisionToUserChange:l,userId:d,selectedTransferToUser:u}=function(e){let{recentRecoverableUser:t,spaceStore:s}=e;const i=(0,r.yK)((e=>({container:{display:"flex",width:"100%",justifyContent:"flex-end"},button:{display:"flex",width:24,height:24,justifyContent:"center",alignItems:"center",gap:10,paddingLeft:0,paddingRight:0},buttonIcon:{width:20,height:20,fill:e.v2.icon.secondary},removeMenuDivider:{borderTop:e.v2.stroke.deemphasized},upgradeIcon:{width:17,height:17}})),[]),a=(0,o.O7)(),[l,d]=(0,n.useState)(),u=(0,n.useCallback)((async(e,n)=>{if(!(await M.confirmUserAction({message:(0,c.jsx)("span",{children:(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.reprovisionPrivatePagesConfirmationDialog.confirmationMessage",defaultMessage:"Are you sure you want to transfer their private pages? This action cannot be undone."})}),acceptLabel:(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.reprovisionPrivatePagesConfirmationDialog.confirmButton.label",defaultMessage:"Transfer private pages"})})))return;d(n);const i=await T.transferSpaceUserContent(a,{spaceId:s.id,fromUserId:e,toUserId:n});"failed"===i.type?M.showError(i):(t.privatePagesCount=0,Ut.setState({...Ut.state,recentRecoverableUsers:[...Ut.state.recentRecoverableUsers.filter((t=>t.userId!==e)),t]}))}),[a,s,t]);return{environment:a,styles:i,handleReprovisionToUserChange:u,userId:t.userId,selectedTransferToUser:l}}({recentRecoverableUser:t,spaceStore:s});return d?(0,c.jsx)("div",{style:a.container,children:(0,c.jsx)(_o.ZP,{popupType:_o.Z4.Popup,onClick:()=>{Kp.b4(i,{from:"recently_left",button_name:"actions"})},renderOrigin:e=>(0,c.jsx)(Xt.Z,{style:a.button,...e,children:(0,c.jsx)(c.Fragment,{children:(0,nm.O)(a.buttonIcon)})}),render:()=>(0,c.jsx)("div",{children:(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,initialFocus:void 0,sections:[{key:"transfer",render:e=>(0,c.jsx)(tn.Z,{...e,style:a.removeMenuDivider}),items:[{key:"transfer",render:e=>(0,c.jsx)(qg.Z,{mode:J.z.Button,focused:!1,title:(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.reprovision.toUser.title",defaultMessage:"Transfer private pages"}),parentStore:s,userIds:u?[u]:[],onChange:e=>{let[t]=e;l(d,t)}}),action:()=>{Kp.b4(i,{from:"recently_left",button_name:"open_transfer_ownership"})}}]}]})})})}):null}function Hg(e){let{spaceStore:t,recentRecoverableUsers:s}=e;const n=(0,r.yK)((e=>({icon:{fontSize:14,fontWeight:510,fill:e.v2.icon.secondary}})),[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:{paddingTop:16,paddingBottom:16},children:(0,c.jsx)(Wg,{leftIcon:(0,ci.D)(n.icon),content:(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionReprovisioningTab.settingsDeeplinkBannerTitle",defaultMessage:"People left the workspace in the past 30 days and had private pages appear here"})})}),(0,c.jsx)(Yg,{recentRecoverableUsers:s,spaceStore:t})]})}function Yg(e){let{spaceStore:t,recentRecoverableUsers:s}=e;const{rows:i,sortState:o,setSortState:l,tableStyles:d}=function(e){let{recentRecoverableUsers:t,spaceStore:s}=e;const i=(0,r.yK)((e=>(0,Se.b)({columnRenderInfo:$g,theme:e,containerMarginTop:0})),[]),[o,l]=(0,n.useState)({column:$g[0],sortAscending:!0}),d=(0,a.VK)((()=>t.map((e=>{const t=ne.U6.createChildStore(s,{table:B.KJ,id:e.userId});return{spaceStore:s,reprovisioningUser:e,email:t.getEmail(),id:e.userId,isClickable:!1}}))),[s,t]);return{rows:d,sortState:o,setSortState:l,tableStyles:i}}({recentRecoverableUsers:s,spaceStore:t}),u=(0,r.yK)((e=>({noRowContainer:{display:"flex",height:32,padding:"0px 4px",alignItems:"center",borderBottom:`1px solid ${e.v2.stroke.regular}`}})),[]);return(0,c.jsx)("div",{style:{marginTop:4},children:(0,c.jsx)(Se.D,{setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:$g,rows:Jg(i,o),showRowBorders:!0,hideHeaderRowPadding:!0,sortState:o,onSortStateChanged:l,renderNoRowsComponent:()=>(0,c.jsx)(Me.Z,{isSmall:!0,style:u.noRowContainer,children:(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionReprovisioningTab.noUser",defaultMessage:"No recent left user"})}),styles:d})})}function Qg(e){let{userLeftTime:t}=e;const s=(0,g.useIntl)(),n=(0,a.VK)((()=>{const e=A.CQ(t,(0,lg.r)());return(0,xo.ZV)({value:e,date_format:"relative",userTimeZone:(0,lg.r)(),intl:s,allowRelativeDates:!0})}),[t,s]);return(0,c.jsx)(Me.Z,{isSmall:!0,children:n})}const $g=[{id:"user",headerTitle:(0,c.jsx)("div",{style:{fontSize:14},children:(0,c.jsx)(g.FormattedMessage,{id:"peopleSectionReprovisioningTab.user",defaultMessage:"User"})}),renderCell:e=>(0,c.jsx)(jm,{userId:e.reprovisioningUser.userId,spaceStore:e.spaceStore}),widthData:{width:220},sortable:!0},{id:"pageCount",headerTitle:(0,c.jsx)("div",{style:{fontSize:14},children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Private pages",id:"peopleSectionReprovisioningTab.privatePages"})}),renderCell:e=>(0,c.jsx)(Me.Z,{isSmall:!0,children:e.reprovisioningUser.privatePagesCount}),widthData:{width:100},sortable:!1},{id:"leftTime",headerTitle:(0,c.jsx)("div",{style:{fontSize:14},children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Left workspace",id:"peopleSectionReprovisioningTab.leftTime"})}),renderCell:e=>(0,c.jsx)(Qg,{userLeftTime:e.reprovisioningUser.userLeftTime}),widthData:{width:100},sortable:!1},{id:"actions",headerTitle:"",renderCell:e=>(0,c.jsx)(Gg,{recentRecoverableUser:e.reprovisioningUser,spaceStore:e.spaceStore}),widthData:{width:100},sortable:!1}];function Jg(e,t){let{sortAscending:s}=t;const n=h.MR(e,(e=>e.email));return s||n.reverse(),n}var Xg=s(49019),eh=s(12534),th=s(23063);function sh(e){let{handleSearchQueryChange:t,currentTab:s,isSearchBarAlwaysOpen:i}=e;const{styles:a,isSearchOpen:l,intl:d,handleSearchButtonClick:u,handleSearchDismiss:p,searchQuery:m,setSearchQuery:h}=function(e){let{handleSearchQueryChange:t,currentTab:s,isSearchBarAlwaysOpen:i}=e;const a=(0,r.yK)((e=>({searchIcon:{width:14,height:void 0,fill:e.mediumTextColor},topbarIconButton:{display:"flex",alignItems:"center",fontSize:14,height:28,width:28,padding:6,color:e.mediumTextColor,fill:e.mediumIconColor,fontWeight:x.Z.fontWeight.regular,lineHeight:1,borderRadius:4},searchInput:{fontSize:14,lineHeight:1,paddingRight:4,color:e.regularTextColor,marginBottom:1}})),[]),l=(0,o.O7)(),[d,c]=(0,n.useState)(!1),[u,p]=(0,n.useState)(void 0),m=(0,n.useCallback)((()=>{c(!0),Kp.RP(l,{current_tab:s})}),[l,s]),h=(0,n.useCallback)((()=>{c(!1),p(void 0),t(void 0)}),[t]),f=(0,g.useIntl)();return{styles:a,isSearchOpen:d||i,intl:f,handleSearchButtonClick:m,handleSearchDismiss:h,searchQuery:u,setSearchQuery:p}}({handleSearchQueryChange:t,currentTab:s,isSearchBarAlwaysOpen:i});return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Qn.Z,{ariaLabel:d.formatMessage({id:"searchPlaceholder",defaultMessage:"Type to search..."}),icon:Xg.e,iconStyle:a.searchIcon,style:a.topbarIconButton,onClick:u,disableBackground:i}),(0,c.jsx)(th.Z,{isVisible:l,animationStyle:{width:150,opacity:1},enterAnimationStyle:{width:0,opacity:0},exitAnimationStyle:{width:0,opacity:0},skipAnimation:i,render:()=>(0,c.jsx)(Fn.Z,{capture:l,allowEsc:!0,render:e=>(0,c.jsx)("div",{...e,children:(0,c.jsx)("div",{style:{display:"flex",alignItems:"center",overflow:"hidden"},children:(0,c.jsx)(dn.Z,{style:a.searchInput,format:dn.B.Transparent,value:m,onChange:e=>{const s=e.target.value;h(s),t(s)},placeholder:d.formatMessage({id:"searchPlaceholder",defaultMessage:"Type to search..."}),focusInitial:l,showClearButton:!0,onCancel:p,onClick:eh.Wi,onClearButtonClick:p,onKeyDown:e=>{27===e.keyCode&&p()},onBlur:()=>{!m&&p()}})})})})})]})}const nh=(0,d.IU)("arrowDownPage",{viewBox:"0 0 14 18",svg:(0,c.jsx)("path",{d:"M7.67969 9.39844V11.7891L7.61719 13.0078L8.21875 12.3828L8.8125 11.7656C8.875 11.7031 8.94531 11.6536 9.02344 11.6172C9.10677 11.5755 9.19271 11.5547 9.28125 11.5547C9.45312 11.5547 9.59635 11.612 9.71094 11.7266C9.83073 11.8411 9.89062 11.9844 9.89062 12.1562C9.89062 12.2552 9.8724 12.3411 9.83594 12.4141C9.79948 12.487 9.74479 12.5573 9.67188 12.625L7.51562 14.6016C7.42708 14.6849 7.34115 14.7448 7.25781 14.7812C7.17969 14.8177 7.09375 14.8359 7 14.8359C6.90104 14.8359 6.8125 14.8177 6.73438 14.7812C6.65625 14.7448 6.57031 14.6849 6.47656 14.6016L4.32031 12.625C4.2474 12.5573 4.19271 12.487 4.15625 12.4141C4.11979 12.3411 4.10156 12.2552 4.10156 12.1562C4.10156 11.9844 4.15885 11.8411 4.27344 11.7266C4.39323 11.612 4.54167 11.5547 4.71875 11.5547C4.79688 11.5547 4.8776 11.5755 4.96094 11.6172C5.04427 11.6536 5.11719 11.7031 5.17969 11.7656L5.77344 12.3828L6.375 13.0078L6.32031 11.7891V9.39844C6.32031 9.21615 6.38542 9.0625 6.51562 8.9375C6.65104 8.80729 6.8125 8.74219 7 8.74219C7.18229 8.74219 7.34115 8.80729 7.47656 8.9375C7.61198 9.0625 7.67969 9.21615 7.67969 9.39844ZM2.83594 17.3203C1.9974 17.3203 1.36458 17.1042 0.9375 16.6719C0.510417 16.2396 0.296875 15.6016 0.296875 14.7578V2.96875C0.296875 2.13021 0.510417 1.49479 0.9375 1.0625C1.36458 0.625 1.9974 0.40625 2.83594 0.40625H6.60156C6.92969 0.40625 7.21615 0.429688 7.46094 0.476562C7.70573 0.518229 7.93229 0.598958 8.14062 0.71875C8.34896 0.833333 8.5625 1.0026 8.78125 1.22656L12.875 5.39062C13.1042 5.61979 13.276 5.84115 13.3906 6.05469C13.5104 6.26302 13.5911 6.49479 13.6328 6.75C13.6745 7 13.6953 7.30729 13.6953 7.67188V14.7578C13.6953 15.5964 13.4818 16.2318 13.0547 16.6641C12.6276 17.1016 11.9948 17.3203 11.1562 17.3203H2.83594ZM2.96094 15.7812H11.0312C11.4115 15.7812 11.6953 15.6849 11.8828 15.4922C12.0703 15.2995 12.1641 15.0234 12.1641 14.6641V7.88281H7.95312C7.39583 7.88281 6.97917 7.74479 6.70312 7.46875C6.43229 7.19271 6.29688 6.77604 6.29688 6.21875V1.9375H2.96875C2.58854 1.9375 2.30469 2.03646 2.11719 2.23438C1.92969 2.43229 1.83594 2.71094 1.83594 3.07031V14.6641C1.83594 15.0234 1.92969 15.2995 2.11719 15.4922C2.30469 15.6849 2.58594 15.7812 2.96094 15.7812ZM8.10156 6.53125H11.9531L7.64844 2.14844V6.07031C7.64844 6.23177 7.68229 6.34896 7.75 6.42188C7.82292 6.49479 7.9401 6.53125 8.10156 6.53125Z"})});function ih(e){let{spaceStore:t,guests:s}=e;const{styles:i,shouldEnableExportGuests:l,handleExportGuestsClick:d}=function(e){let{spaceStore:t,guests:s}=e;const i=(0,r.yK)((e=>({button:{display:"flex",width:28,height:28,justifyContent:"center",gap:10,alignItems:"center"},buttonIcon:{width:20,height:20,fontSize:16,fontStyle:"normal",flexDirection:"column",flexShrink:0,fontWeight:510,fill:e.v2.icon.secondary}})),[]),l=(0,a.VK)((()=>{const{currentSpaceStore:e}=Ke.default.state,t=Bt.subscriptionDataStoreInstance.state;return Boolean(e&&t&&"subscribed_admin"===t.type&&Ce.default.checkGate("enable_guest_export"))}),[]),d=(0,o.O7)(),c=(0,g.useIntl)(),u=(0,n.useCallback)((()=>{const e=Bt.subscriptionDataStoreInstance.state;t&&e&&"subscribed_admin"===e.type&&ca.Mj(d,{intl:c,spaceStore:t,guests:s})}),[s,d,c,t]);return{styles:i,shouldEnableExportGuests:l,handleExportGuestsClick:u}}({spaceStore:t,guests:s});return l?(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(be.ZP,{render:e=>(0,c.jsx)(Xt.Z,{style:i.button,onClick:d,...e,children:nh(i.buttonIcon)}),renderTooltip:()=>(0,c.jsx)(g.FormattedMessage,{id:"exportGuestsButton.label",defaultMessage:"Export guests as CSV"})})}):null}var oh=s(63134);function ah(e){let{spaceStore:t,guests:s,currentTab:i,spacePermissionsSettingsStore:o}=e;(0,n.useEffect)((()=>()=>{Ut.reset()}),[]);const r=(0,a.VK)((()=>Ce.default.getEligibleGroup({experimentId:"space_setting_people_search_bar_expand",defaultGroup:"control"})),[]);return(0,c.jsxs)("div",{style:{display:"flex",height:34,paddingBottom:0,justifyContent:"flex-end",alignItems:"center",gap:10},children:[(0,c.jsxs)("div",{style:{display:"flex",height:28,justifyContent:"flex-end",alignItems:"center",gap:4},children:[(0,c.jsx)(sh,{handleSearchQueryChange:e=>{Ut.setState({...Ut.state,searchQuery:e}),i===Cd.Q.Groups&&o.setState({...o.state,groupsFilter:e??""})},currentTab:i,isSearchBarAlwaysOpen:"on"===r}),i===Cd.Q.Guests?(0,c.jsx)(ih,{spaceStore:t,guests:s}):null]}),(0,c.jsx)("div",{style:{paddingBottom:2},children:(0,c.jsx)(rh,{spaceStore:t,currentTab:i,spacePermissionsSettingsStore:o})})]})}function rh(e){let{spaceStore:t,currentTab:s,spacePermissionsSettingsStore:i}=e;const{canUseGroups:r,canCreateGroups:l,handleCreateGroupClick:d,shouldShowRequestMemberButtion:u,canEditMembership:p}=function(e){let{spaceStore:t,currentTab:s,spacePermissionsSettingsStore:i}=e;const r=Hp(),l=Gp({spaceStore:t}),d=(0,o.O7)(),c=(0,n.useCallback)((()=>{P.createAndCommit({userAction:"PeopleSectionGroupsTab.handleCreateGroupClick",environment:d,perform:e=>{const s=w.mo({environment:d,spaceStore:t,transaction:e});s&&i.setState({...i.state,editingNameGroupId:s.id,groupNameInputValue:""})}})}),[d,t,i]),u=(0,a.VK)((()=>!t.canEditMembership()&&!t.getDisableMembershipRequests()&&(0,je.p1)()),[t]),p=Gp({spaceStore:t});return{canUseGroups:r,canCreateGroups:l,shouldShowRequestMemberButtion:u,canEditMembership:p,handleCreateGroupClick:c}}({spaceStore:t,currentTab:s,spacePermissionsSettingsStore:i});return s===Cd.Q.Groups&&r?l?(0,c.jsx)(be.ZP,{renderTooltip:()=>!l&&(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.groupCreationInsufficientPermissions",defaultMessage:"Only membership admins and workspace owners can add a permission group."}),render:e=>(0,c.jsx)(Sn.Z,{isLarge:!0,onClick:d,...e,children:(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.createGroupButton.label",defaultMessage:"Create a group"})})}):null:u||p?(0,c.jsx)(oh.Z,{spaceStore:t,requestFrom:"space_settings_add_members"}):null}function lh(){const e=(0,a.VK)((()=>{const e=Ke.default.state.currentSpaceStore;if(null!=e&&e.isDefined())return e}),[]),t=(0,a.VK)((()=>ns.Z.state.online),[]),s=(0,a.VK)((()=>Bt.subscriptionDataStoreInstance.state),[]),n=(0,a.qz)(void 0,Cd.Z);return e&&s?t?(0,c.jsxs)(pt.ZP,{children:[(0,c.jsx)(xg,{spaceStore:e,spacePermissionsSettingsStore:n}),(0,c.jsx)(ch,{subscriptionData:s,spaceStore:e,spacePermissionsSettingsStore:n})]}):(0,c.jsx)(pt.ZP,{children:(0,c.jsx)(Me.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.offlineMessage",defaultMessage:"Please go online to manage members."})})}):(0,c.jsx)(dh,{})}function dh(){return(0,c.jsx)(Pi.Z,{style:{margin:"calc(50% - 1em) auto"}})}function ch(e){let{subscriptionData:t,spaceStore:s,spacePermissionsSettingsStore:i}=e;(0,n.useEffect)((()=>{if(it.Z.state.open&&"members"===it.Z.state.currentTab&&it.Z.state.defaultSubtab){const e=it.Z.state.defaultSubtab!==Cd.Q.Requests?it.Z.state.defaultSubtab:Cd.Q.Members;i.setState({...i.state,currentTab:e})}}),[i]);const{visibleUsersLoaded:l,members:d,guests:u,groups:p,recentRecoverableUsers:m,currentTab:f,canReprovisionContent:x,tabs:y,currentTabs:S,environment:v}=function(e){let{subscriptionData:t,spaceStore:s,spacePermissionsSettingsStore:n}=e;const{visibleUsersLoaded:i,members:l,guests:d,numberOfGuests:u}=(0,a.VK)((()=>{const e=Rt.CM(t);return{visibleUsersLoaded:h.yW(e.map((e=>ne.U6.createChildStore(s,{table:B.KJ,id:e.userId}).isReady()))),members:e.filter(As.CF),guests:e.filter(As.du),numberOfGuests:e.filter(As.du).filter((e=>!e.isTeamGuest&&e.isPageGuest)).length}}),[t,s]),p=(0,a.VK)((()=>s.getPermissionGroups()),[s]);!function(e){let{spaceStore:t,subscriptionData:s}=e;const n=zp({spaceStore:t,subscriptionData:s}),i=(0,o.O7)();(0,Vt.r5)((async()=>{if(!n)return;const e=await T.getRecoverableSpaceUserContent(i,{spaceId:t.id});if("failed"===e.type)throw e;const s=e.data.recentSpaceRecoverPages;return Ut.setState({...Ut.state,recentRecoverableUsers:s}),s}),[t,i,n])}({spaceStore:s,subscriptionData:t});const m=(0,a.VK)((()=>{const{recentRecoverableUsers:e}=Ut.state;return e.filter((e=>e.privatePagesCount>0))}),[]),f=(0,a.VK)((()=>n.state.currentTab),[n]),x=zp({spaceStore:s,subscriptionData:t}),{unreadMemberRequestsCount:y,unreadGuestRequestsCount:S}=(0,a.VK)((()=>Ut.state),[]),v=(0,o.O7)(),b=(0,r.yK)((e=>({activeTabStyle:{color:e.regularTextColor},inactiveTabStyle:{color:e.lightTextColor},redDot:{background:e.redBadgeBackground,marginLeft:6,marginTop:6}})),[]),M=(0,a.VK)((()=>l?{[Cd.Q.Members]:(0,c.jsx)(mh,{text:(0,c.jsx)("div",{children:(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.membersTab.title",defaultMessage:"Members"})}),number:l.length,isCurrentTab:f===Cd.Q.Members,styles:b,unread:y>0}),[Cd.Q.Guests]:(0,c.jsx)(mh,{text:(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.guestsTab.title",defaultMessage:"Guests"}),number:u,isCurrentTab:f===Cd.Q.Guests,styles:b,unread:S>0}),[Cd.Q.Groups]:(0,c.jsx)(mh,{text:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.groupsTab.title",defaultMessage:"Groups"}),number:p.length,isCurrentTab:f===Cd.Q.Groups,styles:b}),[Cd.Q.Reprovisioning]:(0,c.jsx)(mh,{text:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.reprovisioningTab.title",defaultMessage:"Recently left"}),number:m.length,isCurrentTab:f===Cd.Q.Reprovisioning,styles:b}),[Cd.Q.Requests]:(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.requestsTab.title",defaultMessage:"Requests"})})}:{}),[l,p,u,m,f,b,y,S]),j=ph(x),C=j.map((e=>M[e]));return{visibleUsersLoaded:i,members:l,guests:d,groups:p,numberOfGuests:u,recentRecoverableUsers:m,currentTab:f,canReprovisionContent:x,tabs:C,currentTabs:j,environment:v}}({subscriptionData:t,spaceStore:s,spacePermissionsSettingsStore:i});return l?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Mn.Z,{tabs:y,selectedIndex:S.indexOf(f),onChange:e=>function(e){let{newSelectedIndex:t,environment:s,spacePermissionsSettingsStore:n,currentTab:i,canReprovisionContent:o}=e;const a=ph(o)[t];switch(a){case Cd.Q.Members:Kp.qT(s,{tab:"members"});break;case Cd.Q.Groups:Kp.qT(s,{tab:"groups"});break;case Cd.Q.Guests:Kp.qT(s,{tab:"guests"});break;case Cd.Q.Reprovisioning:Kp.qT(s,{tab:"reprovisioning"});break;case Cd.Q.Requests:Kp.qT(s,{tab:"requests"});break;default:(0,fs.t1)(a)}i===Cd.Q.Requests&&a!==Cd.Q.Requests&&ot.Z.reset();n.setState({...n.state,currentTab:a})}({newSelectedIndex:e,environment:v,spacePermissionsSettingsStore:i,currentTab:f,canReprovisionContent:x}),style:{paddingLeft:0,paddingRight:0,marginTop:-6},tabTitleStyle:{fontSize:16,fontWeight:400},tabBorderStyle:{left:0,right:0},right:(0,c.jsx)(ah,{spaceStore:s,guests:u,currentTab:f,spacePermissionsSettingsStore:i})}),(0,c.jsx)(uh,{currentTab:f,spaceStore:s,members:d,guests:u,groups:p,spacePermissionsSettingsStore:i,recentRecoverableUsers:m})]}):(0,c.jsx)(dh,{})}function uh(e){let{currentTab:t,spaceStore:s,members:n,guests:i,groups:o,spacePermissionsSettingsStore:a,recentRecoverableUsers:r}=e;switch(t){case Cd.Q.Members:return(0,c.jsx)(zg,{spaceStore:s,members:n,spacePermissionsSettingsStore:a});case Cd.Q.Guests:return(0,c.jsx)(fg,{spaceStore:s,guests:i});case Cd.Q.Groups:return(0,c.jsx)($p,{spaceStore:s,spacePermissionsSettingsStore:a,groups:o});case Cd.Q.Reprovisioning:return(0,c.jsx)(Hg,{spaceStore:s,recentRecoverableUsers:r});default:return null}}function ph(e){return[Cd.Q.Members,Cd.Q.Guests,Cd.Q.Groups,...e?[Cd.Q.Reprovisioning]:[]]}function mh(e){let{text:t,number:s,isCurrentTab:n,unread:i,styles:o}=e;return(0,c.jsxs)("div",{style:{display:"flex",fontSize:x.Z.fontSize.UIRegular.desktop,fontWeight:x.Z.fontWeight.medium,lineHeight:"18px",...n?o.activeTabStyle:o.inactiveTabStyle},children:[t,s&&s>0?(0,c.jsx)("div",{style:{fontSize:x.Z.fontSize.UIRegular.desktop,lineHeight:"18px",paddingLeft:4,...o.inactiveTabStyle},children:s}):void 0,i&&(0,c.jsx)(Cr.z,{style:o.redDot,size:6})]})}var gh=s(76117),hh=s(7189);function fh(e){const{up:t}=e,s={width:10,height:10,marginLeft:4};return t?(0,hh.K)({...s,transform:"rotate(180deg)"}):(0,hh.K)(s)}function xh(e){let{users:t,store:s,extraColumns:i,initialSort:o}=e;const[r,l]=(0,n.useState)(o),d=(0,g.useIntl)();function u(e,t){return(0,c.jsxs)(ve.Z,{disabled:!t.sortable,ignoreLocalHoverState:!0,onClick:()=>{!function(e){l({column:e,asc:(null==r?void 0:r.column)===e&&!(null!=r&&r.asc)})}(e)},style:{display:"flex",alignItems:"center"},children:[t.title,t.sortable&&r&&r.column===e&&fh({up:r.asc})]},e)}const p=(0,n.useMemo)((()=>({title:(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.userTable.userColumn.header",defaultMessage:"User"}),style:{width:"60%"},sortable:!0,renderer:e=>(0,c.jsx)(we.Z,{actorStore:e}),getValue:e=>e.getDisplayName(d)})),[d]),m=(0,n.useMemo)((()=>({name:p,...i})),[i,p]),f=h.XP(m).map((e=>({key:e,header:u(e,m[e]),style:m[e].style}))),x=(0,a.VK)((()=>{const e=t.map((e=>ne.U6.createChildStore(s,{table:B.KJ,id:e.userId}))).filter((e=>e.isDefined()));return r?e.sort(((e,t)=>{const s=m[r.column].getValue(e),n=m[r.column].getValue(t);var i=s<n?-1:s>n?1:0;return r.asc?i:-1*i})):e}),[t,s,m,r]);return(0,c.jsx)(wr.Z,{columns:f,rows:x.map((e=>{const t=Object.values(m).map(((t,s)=>t.renderer?t.renderer(e):(0,c.jsx)(n.Fragment,{children:t.getValue(e)},s)));return{key:e.id,columns:t}}))})}var yh=function(e){return e[e.UserUserSimilarity=0]="UserUserSimilarity",e}(yh||{});const Sh={[yh.UserUserSimilarity]:(0,c.jsx)(g.FormattedMessage,{id:"spaceSettingsDebugZone.userUserSimilarity.title",defaultMessage:"User Similarity"})};function vh(){const e=(0,On.mS)();return["on"===Ce.default.getGroup("user_similarity_debugging")||e?yh.UserUserSimilarity:void 0].filter(fs.$K)}function bh(e){let{store:t}=e;const{isOnline:s,subscriptionDataStoreData:n,userSimilarityData:i,visibleUsersLoaded:o,visibleUsers:r}=(0,a.VK)((()=>{const e=Bt.subscriptionDataStoreInstance.state,s=e?Rt.CM(e):[],n=h.yW(s.map((e=>ne.U6.createChildStore(t,{table:B.KJ,id:e.userId}).isReady())));return{isOnline:ns.Z.state.online,subscriptionDataStoreData:e,userSimilarityData:gh.p.state||{},visibleUsersLoaded:n,visibleUsers:s}}),[t]);if(!s)return(0,c.jsx)(Me.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,c.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.offlineMessage",defaultMessage:"Please go online to manage members."})});if(!n)return(0,c.jsx)(Pi.Z,{style:{margin:"calc(50% - 1em) auto"}});if(!o)return(0,c.jsx)(Pi.Z,{style:{margin:"calc(50% - 1em) auto"}});const l={style:{},title:(0,c.jsx)(c.Fragment,{children:"Similarity Score"}),sortable:!0,renderer:e=>{var t;return(0,c.jsx)(c.Fragment,{children:(null===(t=i[e.id])||void 0===t?void 0:t.toFixed(3))||0})},getValue:e=>i[e.id]||0};return(0,c.jsx)(xh,{users:r,store:t,extraColumns:{similarityColumn:l},initialSort:{column:"similarityColumn",asc:!1}})}function Mh(e){let{store:t}=e;const{tabs:s}=(0,a.VK)((()=>({tabs:vh()})),[]),[i,o]=(0,n.useState)(s[0]);return(0,c.jsxs)(pt.ZP,{children:[(0,c.jsx)(Mn.Z,{tabs:s.map((e=>Sh[e])),selectedIndex:s.indexOf(i),onChange:e=>o(s[e]),style:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},tabTitleStyle:{fontSize:16}}),i===yh.UserUserSimilarity&&(0,c.jsx)(bh,{store:t})]})}var jh=s(42982);const Ch="teamColumn",wh="ownersColumn",kh="membersColumn",Th="AccessLevelColumn",Ih="lastUpdatedColumn",Zh="contextMenuColumn",Ph=[Ch,kh,Th,Ih],Fh="filterAccessAny",Ah="filterAccessOnlyOpen",_h="filterAccessOnlyClosed",Rh="filterAccessOnlyPrivate",Oh="filterOwnerAny",Bh="filterOwnerShowOrphaned",Dh="filterOwnerById";class Lh extends E.default{getInitialState(){return{searchQuery:"",sortColumn:Ih,sortAscending:!1,showOnlyArchivedTeams:!1,filterByOwner:{type:Oh},filterAccess:Fh,showTeamsWithSecurityOverrides:!1}}}const Vh=new Lh;function Nh(e){let{environment:t,teamIds:s}=e;const{currentSpaceStore:n,currentUserStore:i}=Ke.default.state;return n&&i?s.map((e=>{const s=ne.zX.createChildStore(n,{table:tg.e0,id:e,spaceId:n.id});if(s.canRead())return s;const i=n&&br.Dv({environment:t,teamId:s.id,spaceStore:n,from:"manage_teams_table"});return null!=i&&i.canRead()?i:void 0})).filter(fs.$K):[]}var Eh=s(80068),Uh=s(64684);class Wh extends E.default{getInitialState(){return{tokenQuery:"",showAutoCompletePopup:!1,defaultTeams:{}}}addedAndCurrentTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"current-default"===t||"add-default"===t}))}addedTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"add-default"===t}))}removedTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"remove-default"===t}))}}const Kh=new Wh;function zh(e){var t;let{team:s}=e;return null===(t=Kh.state.defaultTeams[s.id])||void 0===t?void 0:t.state}function qh(e){let{team:t,persistedDefaultTeams:s}=e;if(s.includes(t))Gh({store:t,state:"current-default"});else{const e={...Kh.state.defaultTeams};delete e[t.id],Kh.setState({...Kh.state,defaultTeams:e})}}function Gh(e){const t=Kh.state;Kh.setState({...t,defaultTeams:{...t.defaultTeams,[e.store.id]:e}})}var Hh=s(30676),Yh=s(47082),Qh=s(75024);function $h(e){let{}=e;const t=(0,o.Fy)(),s=(0,g.useIntl)(),i=(0,o.O7)(),{allTeams:l,loaded:d}=(0,a.VK)((()=>{const e=Ss.state;return"loaded"!==e.loadingState?{allTeams:[],loaded:!1}:{allTeams:Nh({environment:i,teamIds:e.unarchivedTeamIds}),loaded:!0}}),[i]),[u,p]=(0,n.useState)(!1),m=(0,a.qz)(Kh),f=(0,a.VK)((()=>Ke.default.state.currentSpaceStore),[]),{defaultTeams:x,tokenQuery:y}=(0,a.VK)((()=>{const{defaultTeams:e,tokenQuery:t}=m.state;return{defaultTeams:e,tokenQuery:t}}),[m]),S=!y,{addedTeams:v,removedTeams:b,addedAndCurrentTeams:M}=(0,a.VK)((()=>({addedAndCurrentTeams:m.addedAndCurrentTeams(),addedTeams:m.addedTeams(),removedTeams:m.removedTeams()})),[m]),j=(0,a.VK)((()=>l.reduce(((e,t)=>(e[t.id]=t.getName(),e)),{})),[l]),C=(0,a.VK)((()=>l.filter((e=>e.isDefault()))),[l]);(0,n.useEffect)((()=>function(e){let{persistedDefaultTeams:t}=e;const s=t.reduce(((e,t)=>(e[t.id]={state:"current-default",store:t},e)),{}),n=Kh.state;Kh.setState({...n,defaultTeams:s})}({persistedDefaultTeams:C})),[C]);const w=v.length>0||b.length>0,k=e=>function(e){let{team:t,persistedDefaultTeams:s}=e;"add-default"===zh({team:t})?qh({team:t,persistedDefaultTeams:s}):Gh({store:t,state:"remove-default"})}({team:e,persistedDefaultTeams:C}),T=e=>{!function(e){let{team:t,persistedDefaultTeams:s}=e;"remove-default"===zh({team:t})?qh({team:t,persistedDefaultTeams:s}):Gh({store:t,state:"add-default"})}({team:e,persistedDefaultTeams:C}),m.update((e=>({...e,showAutoCompletePopup:!1,tokenQuery:""})))},I=new Set(b.map((e=>e.store.id))),Z=i.currentUser.id,P=(0,a.VK)((()=>Z?l.filter((e=>{const t=e.getMembers(),s=e.getSettingsStore().getValue();return!!s&&((0,Uh.pd)({membership:t},Z)&&"open"===(0,Uh.B5)(s))})):[]),[l,Z]),F=function(e){let{query:t,addedAndCurrentTeams:s,eligibleDefaultTeams:n,teamIdsToNames:i}=e;const o=new Set;for(const a of s)o.add(a.store.id);return(0,td.ZP)(t,n,(e=>i[e.id]??""))}({query:y,addedAndCurrentTeams:M,teamIdsToNames:j,eligibleDefaultTeams:P}),A=[];F.length>0&&!S&&A.push({key:"default-teams-list",render:e=>(0,c.jsx)(tn.Z,{...e,title:(0,c.jsx)(g.FormattedMessage,{id:"defaultTeamsInput.defaultTeamList.title",defaultMessage:"Teamspaces"}),loading:!1}),items:F.map((e=>({key:e.id,render:t=>(0,c.jsx)(Hh.F,{...t,teamStore:e}),action:()=>T(e)})))});const _=(0,a.VK)((()=>m.state.showAutoCompletePopup&&A.length>0),[m,A.length]),R=(0,r.yK)((e=>({defaultTeamsHeader:{fontSize:14,marginBottom:2},inputAndButtonContainer:{paddingTop:12,display:"flex"},inputContainer:{flexGrow:1},tokenInputMenu:{borderRadius:_?ef:Xh,margin:0},menuList:{maxHeight:300,border:`1px solid ${e.regularDividerColor}`,borderTop:0,borderRadius:tf},updateButton:{marginLeft:10,height:35}})),[_]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:R.defaultTeamsHeader,children:(0,c.jsx)(g.FormattedMessage,{id:"teamsWorkspaceSettings.defaultTeams.title",defaultMessage:"Default teamspaces"})}),(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,children:(0,c.jsx)(g.FormattedMessage,{id:"teamsWorkspaceSettings.defaultTeams.caption",defaultMessage:"Choose teamspaces that all new and current workspace members will automatically join"})}),(0,c.jsxs)("div",{style:R.inputAndButtonContainer,children:[(0,c.jsx)("div",{style:R.inputContainer,children:(0,c.jsx)(cn.ZP,{popupType:cn.ZP.PopupType.Popup,placementToOrigin:cn.ZP.Placement.Bottom,sameWidthAsOrigin:!0,open:_,borderRadius:tf,onDismiss:()=>m.update((e=>({...e,showAutoCompletePopup:!1}))),origin:(0,c.jsx)(Yh.Z,{disabled:!d||u,style:R.tokenInputMenu,focusInitial:t.isMobile,focusAfterAnimation:!0,format:Yh.U.Share,inputDivStyle:{alignItems:"center"},value:y,onChange:e=>m.update((t=>({...t,tokenQuery:e.target.value,showAutoCompletePopup:!0}))),type:"default-teams",tokens:Object.values(x).filter((e=>!I.has(e.store.id))).map((e=>(0,c.jsx)(Jh,{teamStore:e.store,onClickRemove:k},e.store.id))),placeholder:s.formatMessage({id:"teamsWorkspaceSettings.defaultTeams.inputPlaceholder",defaultMessage:"Select a default teamspace..."}),onRemoveLastToken:()=>{const e=M,t=h.Z$(e);t&&k(t.store)},onEmptySubmit:h.yR,showBorder:!0}),render:()=>(0,c.jsx)($s.Z,{menuType:Hs.og.Popup,tokenInputHeader:!0,disableHeaderBorder:!0,children:(0,c.jsx)("div",{style:R.menuList,children:(0,c.jsx)(Xs.Z,{type:Xs.i.Vertical,initialFocus:0,sections:A})})})})}),(0,c.jsx)(Sn.Z,{style:R.updateButton,disabled:!w||u,isLarge:!0,onClick:async()=>{if(f){p(!0);try{await async function(e){let{addedTeams:t,removedTeams:s,environment:n,spaceStore:i}=e;if(!i.isDefined())return!1;const o=await br.lH({addedStores:t.map((e=>{let{store:t}=e;return t})),removedStores:s.map((e=>{let{store:t}=e;return t})),environment:n,spaceStore:i,createNewTeamFlowId:void 0,from:"workspace_settings"});return o}({environment:i,addedTeams:v,removedTeams:b,spaceStore:f})}finally{p(!1)}}},children:(0,c.jsx)(g.FormattedMessage,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"})})]})]})}function Jh(e){const t=(0,o.Fy)(),{teamStore:s,onClickRemove:n}=e,{name:i}=(0,a.VK)((()=>({name:s.getName()})),[s]);return(0,c.jsx)(ul.Z,{showRemoveButton:!0,isSingle:!1,format:t.isMobile?sr.lo.Large:sr.lo.Medium,style:{marginLeft:6},onClickRemove:()=>n(s),value:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsx)(Mr.p,{disabled:!0,store:s,size:14,style:{marginRight:4}}),i]})})}const Xh=3,ef=(0,Qh.wK)({topLeft:Xh,topRight:Xh,bottomLeft:0,bottomRight:0}),tf=(0,Qh.wK)({topLeft:0,topRight:0,bottomLeft:Xh,bottomRight:Xh});var sf=s(43121),nf=s(17224),of=s(45257),af=s(14871);function rf(e){let{selectItems:t,currentSelectedItem:s,onChange:n,icon:i}=e;return(0,c.jsx)(af.Z,{items:t,getKey:e=>e.key,selectedItem:s,onSelect:n,renderItem:e=>(0,c.jsx)(Qs.Z,{title:e.value.name,...e,checkState:s.key===e.value.key}),renderOrigin:e=>(0,c.jsx)(of.Z,{...e,title:s.originName??s.name,on:!s.showFilterAsOffWhenSelected,icon:i})})}const lf={[Fh]:{key:Fh,name:(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterAllTeams",defaultMessage:"Any"}),originName:(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsAccessFilter.accessSelectPlaceolder",defaultMessage:"Access"}),showFilterAsOffWhenSelected:!0},[Ah]:{key:Ah,name:(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterOpenTeams",defaultMessage:"Open"})},[_h]:{key:_h,name:(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterClosedTeams",defaultMessage:"Closed"})},[Rh]:{key:Rh,name:(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterPrivateTeams",defaultMessage:"Private"})}},df=h.oA([lf[Fh],lf[Ah],lf[_h],lf[Rh]]);function cf(e){let{manageTeamsStore:t}=e;const s=(0,o.O7)(),i=(0,a.VK)((()=>t.state.filterAccess),[t]),l=(0,r.yK)((e=>({keyIcon:{width:18,height:18,...i!==Fh?{fill:Ks.ZP.blue}:{fill:e.mediumIconColor}}})),[i]),d=(0,n.useCallback)((e=>{t.update((t=>({...t,filterAccess:e.key}))),nf.GZ(s,{filter:"access",value:e.key})}),[t,s]),u=lf[i];return(0,c.jsx)(rf,{selectItems:df,currentSelectedItem:u,onChange:d,icon:(0,sf.f)(l.keyIcon)})}const uf=(0,d.IU)("archiveFilled",{viewBox:"0 0 16 16",svg:(0,c.jsx)("path",{d:"M2.16211 5.06934H13.5029C14.2754 5.06934 14.665 4.61133 14.665 3.8457V3.22363C14.665 2.45801 14.2754 2 13.5029 2H2.16211C1.43066 2 1 2.45801 1 3.22363V3.8457C1 4.61133 1.38965 5.06934 2.16211 5.06934ZM4.08301 14.585H11.582C12.9287 14.585 13.6465 13.8877 13.6465 12.5479V6.00586H2.01855V12.5479C2.01855 13.8945 2.73633 14.585 4.08301 14.585ZM5.58008 8.47363C5.29297 8.47363 5.09473 8.27539 5.09473 7.97461V7.7627C5.09473 7.46191 5.29297 7.27051 5.58008 7.27051H10.0918C10.3789 7.27051 10.584 7.46191 10.584 7.7627V7.97461C10.584 8.27539 10.3789 8.47363 10.0918 8.47363H5.58008Z"})}),pf="showArchived",mf="hideArchived",gf={[mf]:{key:mf,name:(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedFilter.hideArchivedTeams",defaultMessage:"Active"}),originName:(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedSelectPlaceolder",defaultMessage:"Archived"}),showFilterAsOffWhenSelected:!0},[pf]:{key:pf,name:(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedFilter.showArchivedTeams",defaultMessage:"Archived"})}};function hf(e){let{manageTeamsStore:t}=e;const s=(0,o.O7)(),i=(0,a.VK)((()=>t.state.showOnlyArchivedTeams),[t]),l=(0,r.yK)((e=>({archiveIcon:{width:16,height:16,marginRight:5,...i?{fill:Ks.ZP.blue}:{fill:e.mediumIconColor}}})),[i]),d=[gf[mf],gf[pf]],u=(0,n.useCallback)((e=>{t.update((t=>({...t,showOnlyArchivedTeams:e.key===pf}))),nf.GZ(s,{filter:"archived",value:e.key})}),[t,s]),p=gf[i?pf:mf];return(0,c.jsx)(rf,{selectItems:d,currentSelectedItem:p,onChange:u,icon:uf(l.archiveIcon)})}const ff="ShowTeamsWithNoOwnersId";function xf(e){let{teamStores:t,manageTeamsStore:s}=e;const i=(0,o.O7)(),l=(0,a.VK)((()=>s.state.filterByOwner),[s]),d=function(e){switch(e.type){case Oh:return;case Dh:return e.id;case Bh:return ff;default:(0,fs.t1)(e)}}(l),u=(0,a.VK)((()=>Ke.default.state.currentSpaceStore),[]),p=(0,g.useIntl)(),m=(0,a.VK)((()=>{const e=t.flatMap((e=>(0,Uh.XO)({membership:e.getMembers()})));return h.jj(e)}),[t]),f=(0,r.yK)((e=>({icon:{marginRight:2,fill:e.mediumIconColor},blueFill:{fill:Ks.ZP.blue}})),[]),x=(0,n.useCallback)((e=>{if(u)return Ao({userId:e,currentSpaceStore:u}).getValue()}),[u]),y=(0,n.useCallback)((e=>{const t=e[e.length-1];let n;n=t===d||void 0===t?{type:Oh}:t===ff?{type:Bh}:{type:Dh,id:t},s.update((e=>({...e,filterByOwner:n}))),nf.GZ(i,{filter:"owner",value:n.type})}),[d,s,i]),S=(0,V.useDependency)(V.deps.searchActions),v=(0,n.useCallback)((async e=>{let{query:t}=e;if(!u||"resolved"!==S.status)return[];const s=S.value,n=(await s.searchUsers({query:t,parentStore:u,userIds:m})).map((e=>e.id));return""===t?[ff,...n]:n}),[u,m,S.status,S.value]),b=(0,n.useCallback)(((e,t)=>{if(!u)return null;if(e===ff)return(0,c.jsx)(Qs.Z,{...t,title:(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsOwnerFilter.noOwnersFilterOption",defaultMessage:"No owners"}),checkState:l.type===Bh,className:"notranslate"});const s=x(e);return s?(0,n.createElement)(se.Z,{...t,key:e,actor:(0,X.m3)(s),checkState:d===e}):null}),[u,x,d,l.type]),M=(0,a.VK)((()=>{if(l.type!==Dh)return;const e=x(l.id);return e?(0,Fo.Nz)(p,e):void 0}),[l,x,p]);let j;return j=l.type===Bh?(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsOwnerFilter.filterTitle.onlyOrphanedTeams",defaultMessage:"Owner: None"}):M?(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsOwnerFilter.filterTitle.withSpecifiedOwner",defaultMessage:"Owner: {teamOwnerName}",values:{teamOwnerName:M}}):(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsOwnerFilter.filterTitle.unset",defaultMessage:"Owner"}),(0,c.jsx)(J.Z,{mode:J.z.Pill,title:j,disabled:0===t.length,icon:ee.f,iconStyles:{...f.icon,...l.type!==Oh&&f.blueFill},items:h.oA([d]),hasItemsSelected:(0,fs.$K)(d),onChange:y,labelText:{title:j,tokenInputPlaceholder:p.formatMessage({defaultMessage:"Search teamspace owner...",id:"manageTeamsOwnerFilter.searchOwner.placeholder"}),resultSectionTitle:p.formatMessage({defaultMessage:"Select users",id:"manageTeamsOwnerFilter.searchOwner.resultsTitle"}),componentDebugName:"ManageTeamsSearchOwnerFilter"},performRequest:v,renderResultMenuItem:b,renderToken:()=>null,renderFilter:()=>null,renderItemForSummary:()=>null,addItemLabel:null,focused:!1})}const yf="showAll",Sf="showTeamsWithSecurityOverrides",vf={[yf]:{key:yf,name:(0,c.jsx)(g.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showAllOption",defaultMessage:"Show all"}),originName:(0,c.jsx)(g.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showAllPlaceholder",defaultMessage:"Security"}),showFilterAsOffWhenSelected:!0},[Sf]:{key:Sf,name:(0,c.jsx)(g.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showTeamsWithSecurityOverrides",defaultMessage:"Has overrides"})}};function bf(e){let{manageTeamsStore:t}=e;const s=(0,o.O7)(),i=(0,a.VK)((()=>t.state.showTeamsWithSecurityOverrides),[t]),l=(0,r.yK)((e=>({securityIcon:{width:14,height:14,marginRight:5,fill:e.mediumIconColor},blueFill:{fill:Ks.ZP.blue}})),[]),d=[vf[yf],vf[Sf]],u=(0,n.useCallback)((e=>{t.setState({...t.state,showTeamsWithSecurityOverrides:e.key===Sf}),nf.GZ(s,{filter:"securityOverrides",value:e.key})}),[t,s]),p=vf[i?Sf:yf];return(0,c.jsx)(rf,{selectItems:d,currentSelectedItem:p,onChange:u,icon:(0,Ps.X)({...l.securityIcon,...i&&l.blueFill})})}function Mf(e){let{manageTeamsStore:t,teamStores:s}=e;const i=(0,r.yK)((()=>({container:{display:"flex",alignItems:"center",marginTop:20},searchContainer:{maxWidth:250,marginRight:"auto"},archivedTeamsSwitch:{display:"flex",alignItems:"center",marginLeft:15,marginRight:15},archivedTeamsLabel:{marginLeft:10},dropdownContainer:{display:"flex",alignContent:"stretch",marginLeft:5}})),[]),o=(0,a.VK)((()=>t.state.searchQuery),[t]),l=(0,n.useCallback)((e=>{t.update((t=>({...t,searchQuery:e})))}),[t]);return(0,c.jsxs)("div",{style:i.container,children:[(0,c.jsx)(jf,{style:i.searchContainer,onChange:l,value:o}),(0,c.jsxs)("div",{style:i.dropdownContainer,children:[(0,c.jsx)(hf,{manageTeamsStore:t}),(0,c.jsx)(xf,{teamStores:s,manageTeamsStore:t}),(0,c.jsx)(cf,{manageTeamsStore:t}),(0,c.jsx)(bf,{manageTeamsStore:t})]})]})}function jf(e){let{style:t,value:s,onChange:i}=e;const o=(0,g.useIntl)(),a=(0,r.yK)((e=>({input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]),l=(0,n.useCallback)((e=>i(e.target.value)),[i]);return(0,c.jsx)(dn.Z,{placeholder:o.formatMessage({defaultMessage:"Search teamspaces...",id:"manageTeamsFilterRow.searchFilter.placeholder"}),style:{...a.input,...t},value:s,onChange:l,left:(0,Ac.R)(a.searchIcon),format:dn.B.Small,showClearButton:!0})}var Cf=s(64552),wf=s(39538),kf=s(98742),Tf=s(11628);var If=s(98596),Zf=s(30765);function Pf(e){let{teamStore:t,accessLevel:s,isTeamOwner:n,onChangeAccessLevel:i,width:l}=e;const d=(0,o.O7)(),u=function(e){return(0,a.VK)((()=>e.isDefault()),[e])}(t),p=(0,If.U)({teamStore:t,onChange:i,isDefault:u}),m=u?"default":s,h=p.find((e=>e.key===m)),f=!n||Boolean(null==h?void 0:h.disableAllOptionsTooltip),y=(null==h?void 0:h.disableAllOptionsTooltip)||f&&!n&&(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsAccessCell.onlyTeamOwnersCanChangeAccessLevel",defaultMessage:"Only teamspace owners can change teamspace access levels"}),S=(0,Tf.P)(),v=(0,r.yK)((e=>{const t=e.lightTextColor;return{selectButton:{paddingLeft:8,marginLeft:-8,maxWidth:l},label:{...f&&{color:t},fontSize:x.Z.fontSize.UIRegular.desktop,fontWeight:x.Z.fontWeight.regular},chevron:{width:10,marginLeft:4,fill:e.mediumIconColor,...f&&{fill:t}},tooltip:{width:200}}}),[f,l]);if(!h)throw new Error(`Selected access level is not an option found in team access level option: ${m}`);return(0,c.jsx)(af.Z,{items:p,getKey:e=>e.key,selectedItem:h,onSelect:e=>"private"!==e.key||S?e.onSelect():Es.y(d,{from:"team_security_settings",for:"business"}),renderItem:e=>(0,c.jsx)(be.ZP,{textWrap:!0,style:v.tooltip,placement:nc.u.Bottom,disableTooltip:!e.value.tooltip,renderTooltip:()=>e.value.tooltip,render:t=>(0,c.jsx)(Qs.Z,{title:e.value.title,...(0,kf.Z)(e,t)})}),disabled:f,renderOrigin:e=>(0,c.jsx)(be.ZP,{textWrap:!0,style:v.tooltip,disableTooltip:!y,renderTooltip:()=>y,alignment:nc.v.Center,placement:nc.u.Left,render:t=>(0,c.jsxs)(Xt.Z,{style:v.selectButton,disabled:f,...(0,kf.Z)(e,t),children:[(0,c.jsx)(Zf.s,{style:v.label,children:h.level}),(0,yr.i)(v.chevron)]})})})}function Ff(e){let{teamOwners:t,manageTeamsStore:s}=e;const n=(0,a.VK)((()=>Ke.default.state.currentSpaceStore),[]),i=(0,g.useIntl)(),o=(0,a.VK)((()=>{if(!n)return;const{filterByOwner:e}=s.state;let i=t[0];if(e.type===Dh){const s=e.id;t.includes(s)&&(i=s)}return i?Ao({userId:i,currentSpaceStore:n}):void 0}),[n,s,t]),l=(0,a.VK)((()=>{if(null!=o&&o.isDefined())return(0,Fo.Nz)(i,o.getModel())}),[o,i]),d=(0,r.yK)((e=>({container:{display:"flex",alignItems:"center",fontSize:x.Z.fontSize.UIRegular.desktop,overflow:"hidden"},userAvatar:{paddingRight:6},nMoreOwnersText:{paddingLeft:3,color:e.mediumTextColor},noOwners:{marginRight:8,color:e.lightTextColor},userName:{flexShrink:1}})),[]);return t.length<1?(0,c.jsx)("div",{style:d.noOwners,children:(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsOwnersCell.noOwners",defaultMessage:"No owners"})}):(0,c.jsxs)("div",{style:d.container,children:[(0,c.jsx)(Rn.Z,{style:d.userAvatar,avatarShouldShowShadow:!0,userStore:o,size:20}),(0,c.jsx)(Zf.s,{style:d.userName,children:l}),t.length>1&&(0,c.jsx)("div",{style:d.nMoreOwnersText,children:(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsOwnersCell.nMoreOwnersLabel",defaultMessage:"+{numAdditionalOwners}",values:{numAdditionalOwners:t.length-1}})})]})}const Af=[Ch,wh,Th,Ih,Zh],_f={[Th]:{headerTitle:(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsTable.columnTitle.access",defaultMessage:"Access"}),renderCell:e=>{let{data:t,environment:s}=e;return(0,c.jsx)(Pf,{teamStore:t.store,accessLevel:t.accessLevel,isTeamOwner:t.isCurrentUserOwnerOfTeam,onChangeAccessLevel:(e,n)=>br.Ju({environment:s,store:t.store,accessLevel:e,isDefault:n,teamName:t.name,from:"manage_teams_table"}),width:90})},colWidth:{width:90},hasClickableContents:!0},[Ch]:{headerTitle:(0,c.jsx)(g.FormattedMessage,{id:"manageTeamspacesTable.columnTitle.teamspace",defaultMessage:"Teamspace"}),renderCell:e=>{let{data:t}=e;return(0,c.jsx)(Rf,{teamStore:t.store,isArchivedTeam:t.isArchivedTeam,name:t.name})},colWidth:{minWidth:30,widthPercent:35}},[wh]:{headerTitle:(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsTable.columnTitle.owners",defaultMessage:"Owners"}),renderCell:e=>{let{data:t,manageTeamsStore:s}=e;return(0,c.jsx)(Ff,{teamOwners:t.owners,manageTeamsStore:s})},colWidth:{minWidth:60,widthPercent:25}},[kh]:{headerTitle:(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsTable.columnTitle.members",defaultMessage:"Members"}),renderCell:e=>{let{data:t}=e;return(0,c.jsx)(Zf.s,{children:(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsTable.numMembersCell",defaultMessage:"{numTeamMembers, plural, one {# member} other {# members}}",values:{numTeamMembers:t.members.length}})})},colWidth:{minWidth:40,widthPercent:15}},[Ih]:{headerTitle:(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsTable.columnTitle.updated",defaultMessage:"Updated"}),renderCell:e=>{let{data:t}=e;return t.lastUpdated&&(0,c.jsx)(Of,{lastUpdatedMillis:t.lastUpdated})},colWidth:{minWidth:50,widthPercent:15}},[Zh]:{headerTitle:void 0,renderCell:e=>{let{data:t}=e;return(0,c.jsx)(wf.OutlinerTeamOverflow,{teamStore:t.store,from:"manage_teams_table"})},colWidth:{width:30},hasClickableContents:!0}};function Rf(e){let{teamStore:t,name:s,isArchivedTeam:n}=e;const i=(0,o.O7)(),l=(0,g.useIntl)(),d=(0,Cf.e)(t),u=(0,r.yK)((e=>({container:{display:"flex",alignItems:"center",overflow:"hidden"},teamIcon:{marginRight:12},nameAndMembersContainer:{display:"flex",flexDirection:"column",minWidth:0},nameAndArchivedPillContainer:{display:"flex"},nameText:{lineHeight:"18px",fontWeight:x.Z.fontWeight.regular},smallText:{fontSize:(0,Qh.yv)(i,"UISmall"),color:e.mediumTextColor,fontWeight:x.Z.fontWeight.regular},archivedTag:{marginLeft:5}})),[i]),p=(0,a.VK)((()=>Ke.default.state.currentSpaceStore),[]),m=(0,a.VK)((()=>{if(!p)return;const e=(t.getUserIdsInTeamUsingSpaceMembers((0,Rt.Io)())??[]).length;return(0,kl.uf)(e,"compact",l)}),[p,l,t]),f=(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsTableColumnData.numMembersLabel",defaultMessage:"{numMembers, plural, one {1 member} other {{numMembers} members}}",values:{numMembers:m}}),y=d?(0,c.jsxs)(c.Fragment,{children:[" • ",(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsTableColumnData.joinedLabel",defaultMessage:"Joined"})]}):void 0,S=h.oA([f,y]);return(0,c.jsxs)("div",{style:u.container,children:[(0,c.jsx)(Mr.p,{style:u.teamIcon,size:28,store:t,disabled:!0}),(0,c.jsxs)("div",{style:u.nameAndMembersContainer,children:[(0,c.jsxs)("div",{style:u.nameAndArchivedPillContainer,children:[(0,c.jsx)(Zf.s,{style:u.nameText,children:s}),n&&(0,c.jsx)(te.Z,{desktopStyle:u.archivedTag,mobileStyle:u.archivedTag,children:(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsTable.archivedTag",defaultMessage:"Archived"})})]}),(0,c.jsx)(Zf.s,{style:u.smallText,children:S})]})]})}function Of(e){let{lastUpdatedMillis:t}=e;return(0,c.jsx)(Zf.s,{children:(0,xo.Yx)(t,"very_short",ao.SP)})}function Bf(e){let{teamStores:t,manageTeamsStore:s}=e;const i=(0,o.O7)(),l=(0,a.VK)((()=>Ke.default.state.currentUserStore),[]),{sortAscending:d,sortColumn:u}=(0,a.VK)((()=>{const{sortAscending:e,sortColumn:t}=s.state;return{sortAscending:e,sortColumn:t}}),[s]),p=(0,a.VK)((()=>{const e=null==l?void 0:l.id;return e?h.oA(t.map((t=>{if(!t.canRead()||!t.isReady())return;const s=t.getMembers(),n=(0,Uh.XO)({membership:s});return{store:t,name:t.getName()??"",owners:n,isCurrentUserOwnerOfTeam:n.includes(e),members:t.getUserIdsInTeamUsingSpaceMembers((0,Rt.Io)())??[],hasSecurityOverrides:t.hasSecurityOverrides(),accessLevel:t.getTeamAccessLevel(),isArchivedTeam:(0,Uh.m4)({archived_by:t.getArchivedBy()}),lastUpdated:t.getLastEditedTime()}}))):[]}),[null==l?void 0:l.id,t]),m=(0,a.VK)((()=>{const{showOnlyArchivedTeams:e,filterByOwner:t,showTeamsWithSecurityOverrides:n,filterAccess:i}=s.state;return p.filter((t=>e?t.isArchivedTeam:!t.isArchivedTeam)).filter((e=>!n||e.hasSecurityOverrides)).filter((e=>{if(i===Ah&&"open"!==e.accessLevel)return!1;if(i===_h&&"closed"!==e.accessLevel)return!1;if(i===Rh&&"private"!==e.accessLevel)return!1;switch(t.type){case Bh:return 0===e.owners.length;case Dh:return e.owners.includes(t.id);case Oh:return!0;default:(0,fs.t1)(t)}}))}),[s,p]),g=(0,a.VK)((()=>{const{sortAscending:e,sortColumn:t}=s.state;return function(e){let{data:t,sortColumn:s,sortAscending:n}=e;const i=[n?"asc":"desc"],o=[n?"desc":"asc"];switch(s){case Ch:return h.Xo(t,(e=>e.name),o);case kh:return h.Xo(t,(e=>e.members.length),i);case Th:return h.Xo(t,(e=>tg.bx.indexOf(e.accessLevel)),i);case Ih:return h.Xo(t,(e=>e.lastUpdated),i);default:(0,fs.t1)(s)}}({data:m,sortAscending:e,sortColumn:t})}),[s,m]),f=(0,a.VK)((()=>(0,td.ZP)(s.state.searchQuery,g,(e=>e.name))),[s,g]),x=(0,n.useCallback)((e=>br.RF({environment:i,teamId:e,tab:sg.a.Members,from:"manage_teams_table"})),[i]),y=(0,r.yK)((e=>({container:{marginTop:17,tableLayout:"fixed",borderCollapse:"collapse",width:"100%",minWidth:Af.reduce(((e,t)=>e+Kf(_f[t].colWidth)+Uf),0)},tableHeaderRow:{borderTop:`1px solid ${e.tableDividerColor}`,borderBottom:`1px solid ${e.tableDividerColor}`},noTeamsLabel:{marginTop:15,marginBottom:40,textAlign:"center"}})),[]),S=(0,n.useCallback)((e=>{const{sortColumn:t,sortAscending:n}=s.state,o=e===t&&!n;s.setState({...s.state,sortAscending:o,sortColumn:e}),nf.dw(i,{sortBy:e,sortOrder:n?"ascending":"descending"})}),[s,i]),v=(0,n.useCallback)((()=>{s.reset()}),[s]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("table",{style:y.container,children:[(0,c.jsx)("tr",{style:y.tableHeaderRow,children:Af.map((e=>(0,c.jsx)(Lf,{column:e,onSortableColumnClick:S,sortAscending:d,sortColumn:u},`header_${e}`)))}),(0,c.jsx)("tr",{children:Af.map((e=>(0,c.jsx)("td",{},`padding_row_${e}`)))}),f.map((e=>(0,c.jsx)(Df,{onShowTeamSettings:x,teamData:e,manageTeamsStore:s},`${e.store.id}_row`)))]}),(0,c.jsx)(Nf,{style:y.noTeamsLabel,numItemsAfterFilter:f.length,numItemsBeforeFilter:t.length,onResetFilters:v})]})}function Df(e){let{teamData:t,manageTeamsStore:s,onShowTeamSettings:i}=e;const[o,a]=(0,n.useState)(!1),l=(0,n.useCallback)((()=>a(!0)),[]),d=(0,n.useCallback)((()=>a(!1)),[]),u=(0,n.useCallback)((e=>{Ef(e,(()=>i(t.store.id)))}),[i,t.store.id]),p=(0,r.yK)((e=>({teamRow:{cursor:"pointer",borderBottom:`1px solid ${e.tableDividerColor}`}})),[]);return(0,c.jsx)("tr",{onMouseLeave:d,onMouseEnter:l,style:p.teamRow,onClick:u,children:Af.map((e=>(0,c.jsx)(Vf,{isRowHovered:o,teamData:t,columnData:_f[e],manageTeamsStore:s},`${t.store.id}_${e}`)))})}function Lf(e){let{column:t,onSortableColumnClick:s,sortColumn:n,sortAscending:i}=e;const o=_f[t],a=(0,r.yK)((e=>({th:zf(o),innerDiv:{display:"flex",alignItems:"center",minWidth:Kf(o.colWidth),height:32},text:{fontSize:x.Z.fontSize.UISmall.desktop,fontWeight:x.Z.fontWeight.regular,color:e.mediumTextColor},sortButton:{padding:5,margin:-5,overflow:"hidden",maxWidth:"100%"},sortIcon:{fill:e.mediumTextColor,width:12,height:12,marginLeft:4}})),[o]),l=(0,c.jsx)(Zf.s,{style:a.text,children:o.headerTitle}),d=(u=t,Ph.includes(u)?(0,c.jsxs)(Xt.Z,{style:a.sortButton,onClick:()=>s(t),children:[l,(()=>{if(t===n)return(0,hh.K)({...a.sortIcon,...i&&{transform:"rotate(180deg)"}})})()]}):l);var u;return(0,c.jsx)("th",{style:a.th,children:(0,c.jsx)("div",{style:a.innerDiv,children:d})})}function Vf(e){let{teamData:t,columnData:s,isRowHovered:n,manageTeamsStore:i}=e;const a=(0,o.O7)(),l=(0,r.yK)((e=>({td:{...zf(s),...n&&{background:e.buttonHoveredBackground}},innerDiv:{minWidth:Kf(s.colWidth),fontSize:x.Z.fontSize.UIRegular.desktop,color:e.regularTextColor,height:56,display:"flex",alignItems:"center"}})),[s,n]),d=Ef,u=Boolean(s.hasClickableContents);return(0,c.jsx)("td",{style:l.td,children:(0,c.jsx)("div",{style:l.innerDiv,onClick:u?d:void 0,children:s.renderCell({environment:a,data:t,manageTeamsStore:i})})})}function Nf(e){let{style:t,numItemsBeforeFilter:s,numItemsAfterFilter:n,onResetFilters:i}=e;if(0!==n)return null;let o;return o=0!==s?(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsTable.emptyManageTeamTableDisclaimer.teamsFilteredOut",defaultMessage:"Could not find any teamspaces. <linkbutton>Reset your filters</linkbutton>",values:{linkbutton:e=>(0,c.jsx)(vn.Z,{onClick:i,children:e})}}):(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsTable.emptyManageTeamTableDisclaimer.noTeamsExist",defaultMessage:"Could not find any teamspaces."}),(0,c.jsx)(Me.Z,{isSmall:!0,style:t,children:o})}function Ef(e,t){(0,eh.ZP)({event:e,context:eh.Af.ManageTeamsRowClick,callback:t})}const Uf=10,Wf={paddingLeft:Uf/2,paddingRight:Uf/2};function Kf(e){return"minWidth"in e?e.minWidth:e.width}function zf(e){let t={};return t="width"in e.colWidth?{width:e.colWidth.width}:{width:`${e.colWidth.widthPercent}%`,minWidth:e.colWidth.minWidth},{...Wf,...t}}function qf(e){let{}=e;const{isMobile:t=!1}=(0,o.Fy)(),s=(0,o.O7)(),i=(0,a.qz)(Vh),l=(0,r.yK)((()=>({container:{marginTop:8},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},subheader:{display:"flex",flexDirection:"column"}})),[]),{unarchivedTeamIds:d,archivedTeamIds:u,isLoading:p}=(0,a.VK)((()=>{const e=Ss.state;return"loaded"!==e.loadingState?{unarchivedTeamIds:[],archivedTeamIds:[],isLoading:!0}:{unarchivedTeamIds:e.unarchivedTeamIds,archivedTeamIds:e.archivedTeamIds,isLoading:!1}}),[]),m=(0,a.VK)((()=>p?[]:Nh({environment:s,teamIds:[...d,...u]})),[u,s,p,d]),h=(0,n.useCallback)((()=>br.lo("workspace_settings")),[]);return(0,c.jsxs)("div",{style:l.container,children:[(0,c.jsxs)(me.Z,{large:!t,style:l.header,small:!0,children:[(0,c.jsxs)("div",{style:l.subheader,children:[(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsBrowser.title",defaultMessage:"Manage teamspaces"}),(0,c.jsx)(Me.Z,{isSmall:!0,style:{marginTop:3},children:(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsBrowser.subtitle",defaultMessage:"Manage all teamspaces you have access here"})})]}),(0,c.jsx)(Sn.Z,{onClick:h,isLarge:!0,className:Ne.myM,children:(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsBrowser.newTeamButton.text",defaultMessage:"New teamspace"})})]}),p?(0,c.jsx)(Pi.Z,{}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Mf,{teamStores:m,manageTeamsStore:i}),(0,c.jsx)(Bf,{teamStores:m,manageTeamsStore:i})]})]})}var Gf=s(44615),Hf=s(2688);function Yf(){const e=(0,o.O7)(),{currentSpaceStore:t,currentUserStore:s}=(0,a.VK)((()=>{const{currentSpaceStore:e,currentUserStore:t}=Ke.default.state;return{currentSpaceStore:e,currentUserStore:t}}),[]);return(0,n.useEffect)((()=>{if("loading"===Ss.state.loadingState||!t||!s)return;const n=Hf.ZP.addListener((0,Gf.pD)({userId:s.id,spaceId:t.id}),((t,s)=>{vs({environment:e,messageStoreEmitValue:s})}),void 0,e);return function(){n&&Hf.ZP.removeListener(n,e)}}),[t,s,e]),null}const Qf=n.memo(Yf);function $f(e){let{title:t,description:s,disabled:n=!1,selected:i,onChange:o=(()=>{})}=e;return(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>!n&&o(!i),children:[(0,c.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[t,s&&(0,c.jsx)(Me.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:s})]}),(0,c.jsx)("div",{style:{marginTop:5},children:(0,c.jsx)(Er.Z,{on:i,disabled:n})})]})}function Jf(){const e=(0,o.Fy)();return(0,c.jsx)(me.Z,{large:!e.isMobile||void 0,divider:e.isMobile?void 0:"full",children:(0,c.jsx)(g.FormattedMessage,{id:"teamsWorkspaceSettings.title",defaultMessage:"Teamspace settings"})})}function Xf(){const e=(0,o.O7)(),t=(0,a.VK)((()=>Ke.default.state.currentSpaceStore),[]),s=(0,a.qz)(void 0,He.Z),i=(0,a.VK)((()=>t&&s.getValueForSpace(t)),[t,s]),r=(0,a.VK)((()=>(0,je.F$)()),[]),l=(null==i?void 0:i.disableTeamCreation)??!1,d=(null==i?void 0:i.disableTeamGuests)??!1,u=void 0===i,p=(0,n.useCallback)((()=>{t&&i&&async function(e){let{newSettingValue:t,environment:s,workspaceSecuritySettings:n,spaceStore:i}=e;const o="allowTeamCreation"===t?(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsHelpers.confirmChangeSecuritySetting.allowTeamCreation",defaultMessage:"Are you sure you want to allow all members of this workspace to create teamspaces?"}):(0,c.jsx)(g.FormattedMessage,{id:"manageTeamsHelpers.confirmChangeSecuritySetting.workspaceOwners.disableTeamCreation",defaultMessage:"Are you sure you want to limit teamspace creation to only workspace owners?"});!!(await M.confirmUserAction({message:o}))&&bd.n(s,{securitySettingsState:{...n,disableTeamCreation:"disableTeamCreation"===t},spaceStore:i})}({newSettingValue:l?"allowTeamCreation":"disableTeamCreation",environment:e,spaceStore:t,workspaceSecuritySettings:i})}),[t,l,e,i]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(yn.Z,{size:34}),(0,c.jsx)($f,{disabled:u,onChange:p,title:(0,c.jsx)(g.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamCreation.workspaceOwners.title",defaultMessage:"Limit teamspace creation to only workspace owners"}),description:(0,c.jsx)(g.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamCreation.workspaceOwners.caption",defaultMessage:"Only allow workspace owners to create teamspaces"}),selected:l}),(0,c.jsx)(yn.Z,{size:34}),r&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)($f,{disabled:u,onChange:async function(){if(t&&i){if(!Boolean(i.disableTeamGuests)){if(!(await M.confirmUserAction({message:(0,c.jsx)(g.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.message",defaultMessage:"Are you sure you want to disable teamspace guests?"}),description:(0,c.jsx)(g.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.description",defaultMessage:"This action will remove all teamspace guests from the workspace."}),acceptLabel:(0,c.jsx)(g.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.acceptButton",defaultMessage:"Disable and remove teamspace guests"})})))return}bd.n(e,{securitySettingsState:{...i,disableTeamGuests:!i.disableTeamGuests},spaceStore:t})}},title:(0,c.jsx)(g.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.workspaceOwners.title",defaultMessage:"Allow teamspace owners to add teamspace guests"}),description:(0,c.jsx)(g.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.workspaceOwners.caption",defaultMessage:"This will allow teamspace owners with membership admin permissions to add teamspace guests. Disabling will remove all teamspace guests."}),selected:!d}),(0,c.jsx)(yn.Z,{size:34})]})]})}function ex(e){let{}=e;const t=(0,r.yK)((()=>({learnMoreLinkContainer:{paddingTop:6,paddingBottom:20}})),[]);return(0,c.jsxs)(pt.ZP,{children:[(0,c.jsx)(Jf,{}),(0,c.jsx)(Eh.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_workspace_settings",containerStyle:t.learnMoreLinkContainer}),(0,c.jsx)($h,{}),(0,c.jsx)(Xf,{}),(0,c.jsx)(qf,{}),(0,c.jsx)(Qf,{})]})}var tx=s(86993),sx=s(3924),nx=s(39675),ix=s(67729),ox=s(75493),ax=s(2832),rx=s(73966);function lx(e){let{isMobile:t}=e;const s=(0,o.O7)(),n=L.default.getIntl(),i=(0,a.VK)((()=>Ke.default.state.currentUserSettingsStore),[]),{currentTimeZone:r,auto_update_disabled:l}=(0,a.VK)((()=>{const e=null==i?void 0:i.getSettings();return{currentTimeZone:null==e?void 0:e.time_zone,auto_update_disabled:null==e?void 0:e.disable_auto_set_timezone}}),[i]),d=(0,a.VK)((()=>ax.S.map((e=>({key:e,label:(0,ox.Z)(n,e)})))),[n]);return(i&&(0,c.jsx)(bn.Z,{isMobile:t,disabled:!l,title:(0,c.jsx)(g.FormattedMessage,{id:"dateAndTimeSettings.timeZone.title",defaultMessage:"Time Zone"}),caption:(0,c.jsx)(g.FormattedMessage,{id:"dateAndTimeSettings.timeZone.caption",defaultMessage:"Current time zone setting."}),type:"dropdown",currentOption:r??"error_fetch_timezone",options:d,onSelectOption:e=>{rx.l6({environment:s,userSettingsStore:i,timeZone:e})}}))??null}function dx(e){let{isMobile:t}=e;const s=(0,o.O7)(),i=(0,a.VK)((()=>Ke.default.state.currentUserSettingsStore),[]),r=(0,a.VK)((()=>{var e;return null==i||null===(e=i.getSettings())||void 0===e?void 0:e.disable_auto_set_timezone}),[i])??!1,l=(0,n.useCallback)((e=>{const t=!r;rx.k2({environment:s,userSettingsStore:e,disableAutoSetTimezone:t}),t||rx.wk({environment:s,userSettingsStore:e})}),[s,r]),d=(0,c.jsx)(g.FormattedMessage,{id:"dateAndTimeSettings.autoTimeZone.title",defaultMessage:"Set timezone automatically using your location"}),u=(0,c.jsx)(g.FormattedMessage,{id:"dateAndTimeSettings.autoTimeZone.caption",defaultMessage:"Reminders, notifications and emails are delivered based on your time zone."});return(i&&(0,c.jsx)(bn.Z,{isMobile:t,title:d,caption:u,type:"toggle",isOn:!r,onToggle:()=>l(i)}))??null}const cx=function(e){let{isMobile:t}=e;const s=(0,o.O7)(),i=(0,a.VK)((()=>Ke.default.state.currentUserSettingsStore),[]),r=(0,a.VK)((()=>{var e;return null==i||null===(e=i.getSettings())||void 0===e?void 0:e.profile_discoverable}),[i])??!0,l=(0,n.useCallback)((e=>{const t=!r;P.createAndCommit({userAction:"ProfileDIscoverabilitySettings.onToggleOption",environment:s,perform:e=>{i&&F.d2({userSettingsStore:i,data:{profile_discoverable:t},transaction:e})}})}),[s,r,i]),d=(0,c.jsx)(g.FormattedMessage,{id:"profileDiscoverabilitySettings.title",defaultMessage:"Profile discoverability"}),u=(0,c.jsx)(g.FormattedMessage,{id:"profileDiscoverabilitySettings.caption",defaultMessage:"Users with your email can see your name and profile picture when inviting you to a new workspace. <inlinelink>Learn more</inlinelink>.",values:{inlinelink:e=>(0,c.jsx)(vn.Z,{external:!0,href:(0,Ue.UY)("guides.profileSettings"),onClick:e=>{e.stopPropagation()},children:e})}});return(0,c.jsx)(bn.Z,{isMobile:t,title:d,caption:u,isOn:r,type:"toggle",onToggle:()=>l(i)})};var ux=s(16347);const px=(0,sx.M)((function(e){let{passwordRequestStore:t,userEmailDomainSettings:s}=e;const{isPhone:n,isIOS:i,isMobile:r}=(0,o.Fy)(),l=(0,o.O7)(),d=(0,a.VK)((()=>ns.Z.state.online),[]),u=(0,a.VK)((()=>r&&t?(0,nx.E)({isPhone:n,isIOS:i,passwordRequestStore:t,userEmailDomainSettings:s}):(0,nx.Z)({environment:l})),[l,r,n,i,t,s]),p=[{key:"timezone-auto",renderSettingsItem:()=>(0,c.jsx)(dx,{isMobile:r})},{key:"timezone-manual",renderSettingsItem:()=>(0,c.jsx)(lx,{isMobile:r})}].filter(fs.$K),m=[(0,a.VK)((()=>(0,ix.h)(l)),[l])?{key:"cookies",renderSettingsItem:()=>(0,c.jsx)(ix.Z,{isMobile:r})}:void 0,{key:"view-history",renderSettingsItem:()=>(0,c.jsx)(ux.H,{isMobile:r})},{key:"profile-discoverability",renderSettingsItem:()=>(0,c.jsx)(cx,{isMobile:r})}].filter(fs.$K);return d?(0,c.jsxs)(pt.ZP,{disableScroller:r,children:[(0,c.jsx)(me.Z,{large:!r,divider:"full",children:(0,c.jsx)(g.FormattedMessage,{id:"mySettings.settingsSection.title",defaultMessage:"My settings"})}),(0,c.jsx)(yd.O,{items:u}),(0,c.jsx)(yn.Z,{size:48,isHidden:!0}),(0,c.jsx)(me.Z,{large:!r,divider:"full",children:(0,c.jsx)(g.FormattedMessage,{id:"notificationAndPersonalSettings.dateAndTimeSection.title",defaultMessage:"Date & time"})}),(0,c.jsx)(yd.O,{items:p}),(0,c.jsx)(yn.Z,{size:48,isHidden:!0}),(0,c.jsx)(me.Z,{large:!r,divider:"full",children:(0,c.jsx)(g.FormattedMessage,{id:"mySettings.privacySection.title",defaultMessage:"Privacy"})}),(0,c.jsx)(yd.O,{items:m})]}):(0,c.jsx)(pt.ZP,{children:(0,c.jsx)(Me.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"Please go online to manage settings.",id:"mySettings.goOnline.prompt"})})})})),mx={overflow:"auto",paddingBottom:12},gx={display:"flex",flexDirection:"column",height:"100%",justifyContent:"space-between",paddingTop:10,paddingLeft:4,paddingRight:4},hx={user_settings:{},profile:{},notifications:{},notifications_and_settings:{},connected_apps:{},language_and_region:{},debug_zone:{},settings:{},teams:{adminOnly:!0,membersOnly:!0},members:{membersOnly:!0},analytics:{membersOnly:!0,enterpriseOnly:!0},plans:{membersOnly:!0},billing:{},subscription:{},security:{adminOnly:!0},identity_provisioning:{adminOnly:!0},admin_content_search:{adminOnly:!0,enterpriseOnly:!0},integrations:{adminOnly:!0},imports:{},audit_log:{adminOnly:!0,enterpriseOnly:!0},experiments:{},sites:{membersOnly:!0}},fx=(0,g.defineMessages)({dialogLabel:{id:"spaceSettings.dialogLabel",defaultMessage:"Settings & members"}});class xx extends i.Z{constructor(){super(...arguments),this.lastSpaceSettingsStoreState=void 0,this.lastSpaceSettingsModalStoreOpen=!1,this.storeTypes={spaceBasicSettingsStore:Xe,spaceProfileSettingsStore:nt,securitySettingsStore:He.Z,samlSettingsStore:Ge,spaceDomainSettingsStore:tt}}async UNSAFE_willMount(e){super.UNSAFE_willMount(e);const{spaceStore:t}=this.props,{securitySettingsStore:s}=this.stores,n=s.getValueForSpace(t);n&&s.setState(n),await I(this.environment,this.stores.spaceProfileSettingsStore)}UNSAFE_willMountOrUpdate(e){super.UNSAFE_willMountOrUpdate(e);const{open:t}=it.Z.state,s=it.Z.state;this.lastSpaceSettingsModalStoreOpen===t&&h.Xy(this.lastSpaceSettingsStoreState,s)||t&&b.SU(this.environment,{tab:s.currentTab,from:s.openedFrom}),this.lastSpaceSettingsModalStoreOpen=t,this.lastSpaceSettingsStoreState=h.d9(s)}renderComponent(){const{open:e}=it.Z.state;return(0,c.jsx)(_n.Z,{ariaLabel:L.default.formatMessage(fx.dialogLabel),open:e,innerStyle:{width:1150,maxWidth:"calc(100vw - 100px)",height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:12,maxHeight:715},onOpen:()=>{return e=this.props.spaceStore,t=this.environment,rt.bi(t),vx(),void y.kj({environment:t,spaceId:e.id,canAdmin:e.canAdmin()});var e,t},onDismiss:()=>{return e=this.environment,t=this.props.spaceStore,s=this.stores.spaceBasicSettingsStore,n=this.stores.spaceProfileSettingsStore,i=this.stores.securitySettingsStore,o=this.stores.spaceDomainSettingsStore,Ax((()=>{it.Z.setState({...it.Z.state,open:!1}),Qe.reset(),o.reset(),vx(),ot.Z.reset()}),e,t,s,n,i);var e,t,s,n,i,o},render:()=>(0,c.jsx)(Bx,{spaceStore:this.props.spaceStore,userStore:this.props.userStore,spaceBasicSettingsStore:this.stores.spaceBasicSettingsStore,spaceProfileSettingsStore:this.stores.spaceProfileSettingsStore,securitySettingsStore:this.stores.securitySettingsStore,samlSettingsStore:this.stores.samlSettingsStore,spaceDomainSettingsStore:this.stores.spaceDomainSettingsStore}),className:Ne.zYS})}}function yx(e,t){const s=hx[e];return!(s.adminOnly&&!t.canAdmin())&&(!(s.membersOnly&&!t.canRead())&&!(s.enterpriseOnly&&!(0,m.wP)(t.getSubscriptionTier())))}xx.displayName="SpaceSettings",xx.theme=void 0;const Sx=xx;function vx(){N.Z.reset(),z.reset()}function bx(e){let{userStore:t}=e;const s=(0,g.useIntl)(),n=(0,a.VK)((()=>t.getFullName(s)),[s,t]);return n?(0,c.jsx)(Me.Z,{style:{fontWeight:x.Z.fontWeight.medium},children:n}):null}function Mx(e,t,s){const{disablePublicAccess:n,disableGuests:i,disableMoveToSpace:o,disableExport:a,disableSpacePageEdits:r,disablePublicAccessRequests:l,disableTeamCreation:d,disableMembershipRequests:c,disableExternalMembershipRequests:u,disableGuestMembershipRequests:p,enableAiFeature:m,disableTeamGuests:g,enableGuestInviteRequests:h,enableAiTraining:f}=e.state;P.createAndCommit({userAction:"SpaceSettings.attemptCloseCurrentTab",environment:s,perform:e=>{w.Xr({environment:s,disablePublicAccess:n,disableGuests:i,disableMoveToSpace:o,disableExport:a,disableSpacePageEdits:r,disablePublicAccessRequests:l,transaction:e,spaceStore:t,disableTeamCreation:d,disableMembershipRequests:c,disableExternalMembershipRequests:u,disableGuestMembershipRequests:p,enableAiFeature:Boolean(m),disableTeamGuests:g,enableGuestInviteRequests:h,enableAiTraining:Boolean(f)})}})}function jx(e){let{spaceStore:t}=e;const s=(0,o.O7)(),n=(0,a.VK)((()=>(0,je.wE)(s)),[s]),i=(0,a.VK)((()=>ot.Z.state.count),[]);return n?(0,c.jsx)(lh,{}):(0,c.jsx)(ou.Z,{store:t,unreadAccessRequests:i})}function Cx(e){let{spaceStore:t}=e;const s=(0,o.O7)(),n=(0,a.VK)((()=>Bt.subscriptionDataStoreInstance.state),[]),i=(0,a.VK)((()=>at.Z.getData(s,{spaceId:t.id})),[t,s]);if(!n)return null;const r="unsubscribed_admin"===n.type&&n.customerData&&(0,p.E3)(n.customerData.stripe.addOns);if("subscribed_admin"===n.type||r){var l;const e=null===(l=n.customerData)||void 0===l?void 0:l.stripe;return e?(0,c.jsx)(ls.Z,{spaceStore:t,subscriptionData:n,upcomingInvoiceData:i,customerData:e}):null}return n&&"unsubscribed_admin"===n.type?(0,c.jsx)(us,{spaceStore:t,data:n}):null}function wx(){const e=(0,a.VK)((()=>(0,Ee.tt)()),[]),t=(0,a.VK)((()=>(0,Ee.RT)()),[]);return(0,c.jsx)(pt.ZP,{children:(0,c.jsx)(Ml,{genericImporterEnabled:e,zipImporterEnabled:t})})}function kx(e){return{fontSize:12,lineHeight:1,marginBottom:1,color:e.mediumTextColor,fontWeight:x.Z.fontWeight.semibold,alignItems:"center",display:"flex",height:24,paddingLeft:12,paddingRight:11,textOverflow:"ellipsis",overflow:"hidden"}}function Tx(e){return{width:20,height:20,marginRight:8,color:e.regularIconColor,fill:e.regularIconColor}}function Ix(e){return{width:14,height:14,color:e.regularIconColor}}function Zx(){const e=(0,r.Fg)(),t=(0,o.O7)(),s=(0,a.VK)((()=>(0,Ve.B7)(t)),[t]),n=(0,a.VK)((()=>null==s?void 0:s.getEmail()),[s]),i={size:20,hasTooltip:!0,avatarShouldShowShadow:!0,userStore:s};return(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",height:44,paddingLeft:12,paddingRight:12},children:[(0,c.jsx)("div",{style:Tx(e),children:(0,c.jsx)(Rn.Z,{...i})}),s?(0,c.jsxs)("div",{children:[(0,c.jsx)(bx,{userStore:s}),n&&(0,c.jsx)(Me.Z,{isSmall:!0,children:n})]}):(0,c.jsx)(g.FormattedMessage,{id:"spaceSettings.sidebar.personalSettingsSection.userDetails.title",defaultMessage:"Me"})]})}function Px(e){let{tab:t}=e;const s=(0,r.Fg)(),n=(0,o.O7)(),{currentSpaceStore:i}=(0,a.VK)((()=>Ke.default.state),[]);return(0,a.VK)((()=>"members"===t&&n.device.isDesktop&&(null==i?void 0:i.canEditMembership())&&(0,je.p1)()&&!(0,je.wE)(n)&&ot.Z.state.count>0),[t,n,i])?(0,c.jsx)(Cr.z,{color:s.redBadgeBackground}):null}function Fx(e){let{spaceProfileSettingsStore:t}=e;const s=(0,a.VK)((()=>Rt.wl(Bt.subscriptionDataStoreInstance.state)),[]);return(0,c.jsx)(Op,{isEducationPlan:s,spaceProfileSettingsStore:t})}async function Ax(e,t,s,n,i,o){const{currentUserStore:a,currentUserSettingsStore:r}=Ke.default.state;if(!a||!r)throw new Error("No user or settings store.");const l=(0,c.jsx)(g.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.confirmationMessage",defaultMessage:"Your changes have not been saved. Save changes?"}),d=(0,c.jsx)(g.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.confirmationButton.label",defaultMessage:"Yes"}),u=(0,c.jsx)(g.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.cancelationButton.label",defaultMessage:"No"}),{currentTab:p}=it.Z.state;if("profile"===p){if(!h.Xy(i.state,i.getValueForUser(a,r,L.default.getIntl()))){const{profilePhoto:s,name:n,startDayOfWeek:o}=i.state;return n?M.showDialog({message:l,showCancel:!0,keepFocus:!0,items:[{label:(0,c.jsx)(g.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.updateSettingsButton.label",defaultMessage:"Update"}),color:"blue",onAccept:()=>{P.createAndCommit({userAction:"SpaceSettings.attemptCloseCurrentTab",environment:t,perform:e=>{const{currentUserStore:t}=Ke.default.state;if(t&&S.A({userStore:t,data:{name:n,profilePhoto:s},transaction:e}),r){const t=r.getSettings();(null==t?void 0:t.start_day_of_week)!==o&&F.d2({userSettingsStore:r,data:{start_day_of_week:o},transaction:e})}}}),e()}}],handleCancel:()=>{e()}}):M.showErrorMessage((0,c.jsx)(g.FormattedMessage,{id:"profileSettings.personalInfoSection.nameMissing.message",defaultMessage:"Please fill in name."})),!0}e()}else if("settings"===p&&s.canEdit()){const i=!h.Xy(o.state,o.getValueForSpace(s)),a=!h.Xy(n.state,n.getValueForSpace(s));if(i||a){if(await M.confirmUserAction({message:l,acceptLabel:d,cancelLabel:u})){if(!(await w.Y5({environment:t,spaceId:s.id,domain:n.state.domain})))return!1;a&&w.OF({environment:t,spaceStore:s,spaceBasicSettingsStore:n}),i&&Mx(o,s,t),e()}else e();return!0}e()}else if("audit_log"===p)vx(),e();else if("analytics"===p)$e.Z.reset(),e();else if("plans"===p&&s.canAdmin()){const n=o.getValueForSpace(s);!h.Xy(o.state,o.getValueForSpace(s))&&n&&(o.setState(n),Mx(o,s,t)),e()}else"teams"===p?(xs.Z.reset(),Ss.reset(),e()):e();return!1}function _x(e){let{tab:t,spaceStore:s,spaceBasicSettingsStore:n,spaceProfileSettingsStore:i,securitySettingsStore:l,spaceDomainSettingsStore:d}=e;const u=(0,r.Fg)(),p=(0,o.O7)(),m=(0,a.VK)((()=>it.Z.state.currentTab===t),[t]),g=(0,a.VK)((()=>yx(t,s)),[s,t]),h=(0,a.VK)((()=>Qt[t](p)),[p,t]),f=(0,a.VK)((()=>$t[t](p)),[p,t]),y=(0,a.VK)((()=>Jt[t](p)),[p,t]);return g?(0,c.jsxs)(ve.Z,{hovered:m,style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingLeft:12,paddingRight:12,borderRadius:4,marginTop:1,marginBottom:1,minHeight:27,position:"relative"},onClick:e=>{if(m)return null;Ax((()=>{it.Z.setState({...it.Z.state,currentTab:t,defaultSubtab:void 0}),d.reset(),b.XI(p,{tab:t})}),p,s,n,i,l)},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",...m&&{fontWeight:x.Z.fontWeight.semibold}},children:[(0,c.jsx)("div",{style:Tx(u),children:h}),(0,c.jsx)(Me.Z,{isMultiline:!0,children:f}),y]}),(0,c.jsx)(Px,{tab:t})]}):null}function Rx(e){let{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:d}=e;const p=(0,r.Fg)(),m=(0,o.O7)(),h=(0,a.VK)((()=>function(e){var t,s;const{currentSpaceViewStore:n,currentSpaceStore:i,currentUserStore:o}=Ke.default.state;if(!i||!yx("analytics",i))return!1;if(null==o||!o.id)return!1;if(null==i||!i.isDefined())return!1;const a=null==n?void 0:n.getSettings();return"dismissed"!==(null==a||null===(t=a.space_analytics_settings_prompt)||void 0===t?void 0:t.status)&&"hidden"!==(null==a||null===(s=a.space_analytics_settings_prompt)||void 0===s?void 0:s.status)&&(Z.lo(e),!0)}(m)),[m]),{currentSpaceStore:f}=(0,a.VK)((()=>Ke.default.state),[]),x=(0,a.VK)((()=>null==f?void 0:f.canAdmin()),[f]),y=(0,a.VK)((()=>function(e,t){var s,n;const{currentSpaceViewStore:i,currentSpaceStore:o,currentUserStore:a}=Ke.default.state;if(null==a||!a.id)return!1;if(null==o||!o.isDefined())return!1;const r=null==i?void 0:i.getSettings();return"dismissed"!==(null==r||null===(s=r.mfa_settings_prompt)||void 0===s?void 0:s.status)&&"hidden"!==(null==r||null===(n=r.mfa_settings_prompt)||void 0===n?void 0:n.status)&&"off"===t.state.accountSettings.mfaStatus&&(Z.GZ(e),!0)}(m,n)),[m,n]);if(h){const e=x?(0,c.jsx)(g.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.caption.workspaceOwner",defaultMessage:"Explore how members & guests are engaging with this workspace, common searches that are made, and content engagement metrics with workspace analytics."}):(0,c.jsx)(g.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.caption.member",defaultMessage:"See how your content is performing by reviewing metrics like number of views or unique visitors using workspace analytics."});return(0,c.jsx)(Xd,{onDismiss:()=>Z.TY(m),onClick:()=>{Ax((()=>{it.Z.setState({...it.Z.state,currentTab:"analytics",defaultSubtab:void 0}),d.reset(),b.XI(m,{tab:"analytics"}),Z.pE(m)}),m,t,s,n,i)},onView:e=>{"enterprise"===(null==f?void 0:f.getSubscriptionTier())&&Z.pE(e)},onClickLearnMore:()=>{const e=(0,Ue.UY)("guides.workspaceAnalytics");C.D({environment:m,url:e})},descriptionMessage:e,title:(0,c.jsx)(g.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.title",defaultMessage:"New workspace analytics"}),buttonText:(0,c.jsx)(g.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.cta",defaultMessage:"View metrics"}),icon:u(Ix(p))})}return y?(0,c.jsx)(Xd,{onClick:()=>{Ax((()=>{it.Z.setState({...it.Z.state,open:!0,currentTab:"profile",defaultSubtab:void 0,highlightedSetting:it.R.TwoStepVerification}),b.XI(m,{tab:"profile"})}),m,t,s,n,i)},onView:Z.E6,onDismiss:()=>Z.ZJ(m),onClickLearnMore:()=>{const e=(0,Ue.UY)("guides.mfa");C.D({environment:m,url:e})},descriptionMessage:(0,c.jsx)(g.FormattedMessage,{id:"mfaSettingsPrompt.description",defaultMessage:"2-step verification, also known as 2FA or MFA, is now available. Add a secondary method of verification used during login."}),title:(0,c.jsx)(g.FormattedMessage,{id:"mfaSettingsPrompt.title",defaultMessage:"Add an extra layer of security to your account."}),buttonText:(0,c.jsx)(g.FormattedMessage,{id:"mfaSettingsPrompt.button.label",defaultMessage:"Enable 2-step verification"}),icon:(0,l.Q)(Ix(p))}):null}function Ox(e){let{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l}=e;const d=(0,r.Fg)(),u=(0,o.O7)(),m=(0,a.VK)((()=>Bt.subscriptionDataStoreInstance.state),[]),h=(0,a.VK)((()=>it.Z.state.currentTab),[]),x=Rt.wY(m),y=(0,a.VK)((()=>(0,On.mS)()),[]),S=(0,a.VK)((()=>vh().length>0),[]),b=(0,a.VK)((()=>function(e,t){var s;const n=Bt.subscriptionDataStoreInstance.state;return!(!n||e||!t.canAdmin()||"subscribed_admin"!==n.type&&("unsubscribed_admin"!==n.type||!(0,p.E3)(null===(s=n.customerData)||void 0===s?void 0:s.stripe.addOns))&&!(0,Rt.MM)(n))}(x,t)),[x,t]),M=(0,a.VK)((()=>t.canRead()),[t]),j=(0,a.VK)((()=>(0,We.bq)()),[]);return(0,c.jsxs)("div",{style:gx,children:[(0,c.jsx)("div",{style:mx,children:(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:kx(d),children:(0,c.jsx)(g.FormattedMessage,{id:"spaceSettings.sidebar.personalSettingsSection.title",defaultMessage:"Account"})}),(0,c.jsx)(Zx,{}),(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"profile"}),(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"user_settings"}),(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"notifications"}),(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"connected_apps"}),(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"language_and_region"}),S&&(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"debug_zone"}),(0,c.jsx)(yn.Z,{size:18,isHidden:!0}),(0,c.jsx)("div",{style:kx(d),children:(0,c.jsx)(g.FormattedMessage,{id:"spaceSettings.sidebar.workspaceSettingsSection.title",defaultMessage:"Workspace"})}),(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"settings"}),j&&(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"teams"}),(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"members"}),!u.device.isMobile&&(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"analytics"}),(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"plans"}),b&&(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"billing"}),x&&(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"subscription"}),(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"sites"}),(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"security"}),(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"identity_provisioning"}),!u.device.isMobile&&(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"admin_content_search"}),(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"integrations"}),!u.device.isMobile&&(0,c.jsx)("span",{onClick:()=>{const e=(0,f.ZP)();ze.Z.setState({flowId:e}),v.Sy(u,{from:"settings",flowId:e})},children:(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"imports"})}),!u.device.isMobile&&(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"audit_log"}),y&&(0,c.jsx)(_x,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"experiments"})]})}),M&&(0,c.jsx)(dt.Z,{source:"settings",currentTab:h}),M&&!(0,p.E3)(null==m?void 0:m.addOns)&&(0,c.jsx)(lt.Z,{source:"settings"}),(0,c.jsx)(Rx,{spaceStore:t,spaceBasicSettingsStore:s,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l})]})}function Bx(e){let{spaceStore:t,userStore:s,spaceBasicSettingsStore:n,spaceProfileSettingsStore:i,securitySettingsStore:o,samlSettingsStore:r,spaceDomainSettingsStore:l}=e;const d=(0,a.VK)((()=>it.Z.state.currentTab),[]),u=(0,a.VK)((()=>function(e,t,s,n,i,o,a,r){const l={profile:()=>(0,c.jsx)(Fx,{spaceProfileSettingsStore:i}),notifications_and_settings:()=>(0,c.jsx)(hd.Z,{isMobile:!1}),user_settings:()=>(0,c.jsx)(px,{}),notifications:()=>(0,c.jsx)(vd,{}),language_and_region:()=>(0,c.jsx)(pd,{}),connected_apps:()=>(0,c.jsx)(tx.Z,{location:"settings-page"}),debug_zone:()=>(0,c.jsx)(Mh,{store:t}),settings:()=>(0,c.jsx)(zc,{spaceStore:t,spaceBasicSettingsStore:n,securitySettingsStore:o}),teams:()=>(0,c.jsx)(ex,{}),members:()=>(0,c.jsx)(jx,{spaceStore:t}),analytics:()=>(0,c.jsx)(mc,{spaceStore:t}),plans:()=>(0,c.jsx)(gs.SpaceSubscriptionPlans,{}),billing:()=>(0,c.jsx)(Cx,{spaceStore:t}),subscription:()=>(0,c.jsx)(pt.ZP,{children:(0,c.jsx)(jh.Z,{})}),security:()=>(0,c.jsx)(Fd,{spaceStore:t,userStore:s,securitySettingsStore:o}),identity_provisioning:()=>(0,c.jsx)(er,{spaceStore:t,userStore:s,samlConfigStore:a,domainSettingsStore:r}),admin_content_search:()=>(0,c.jsx)(bs.Z,{spaceStore:t,userStore:s}),integrations:()=>(0,c.jsx)(In,{spaceStore:t,userStore:s}),experiments:()=>(0,c.jsx)(pt.ZP,{children:(0,c.jsx)(On.Ub,{})}),audit_log:()=>(0,c.jsx)(pt.ZP,{children:(0,c.jsx)(Le,{spaceStore:t})}),imports:()=>(0,c.jsx)(wx,{}),sites:()=>(0,c.jsx)(V.LazySitesSettingsTab,{spaceStore:t})};if(yx(e,t))return l[e];{const e=j.CT(t);return j.r$({currentTab:e}),l[e]}}(d,t,s,n,i,o,r,l)),[d,r,o,n,l,i,t,s]);return(0,c.jsx)(Fn.Z,{capture:!0,allowEsc:!0,render:e=>(0,c.jsx)(An.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,render:()=>(0,c.jsx)(ec,{sidebar:(0,c.jsx)(Ox,{spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:i,securitySettingsStore:o,spaceDomainSettingsStore:l}),...e,children:u()})})})}},56633:(e,t,s)=>{s.d(t,{G:()=>x});var n=s(67294),i=s(480),o=s(86628),a=s(92996),r=s(94714),l=s(42875),d=s(59054),c=s(96367),u=s(9291),p=s(54642),m=s(66890),g=s(56596),h=s(85893);const f=(0,u.defineMessages)({cannotSetSprintToCurrentTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToCurrentTooltip",defaultMessage:"Current sprint already exists"},cannotSetSprintToNextTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToNextTooltip",defaultMessage:"Next sprint already exists"},cannotSetSprintToLastTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToLastTooltip",defaultMessage:"Last sprint already exists"}});function x(e){const{blockPropertyValueOverlayStore:t}=e,s=(0,i.O7)(),x=(0,m.Y$)(),y=(0,o.VK)((()=>x.normalizedSchemaStore.state),[x.normalizedSchemaStore]),S=function(e){let{sprintCollectionStore:t,environment:s,normalizedBlockSchema:n}=e;const[{value:i,status:o}]=(0,d.r5)((async()=>{var e;if(!t)return;const i=t.getSchema(),o=t.getFormat().app_config_uri;if(!o||o!==r.p$)return;const d=(0,c.Zv)(i,o).includes("last"),u=c.qB[o],m=u.current.reducer.get(n),g=u.next.reducer.get(n),h=u.last.reducer.get(n);if(!m||!g)return;const f={userId:s.currentUser.id,userTimeZone:(0,l.r)(),searchQuery:void 0,reducers:{[a.SF]:m,[a.YE]:g,...d&&h?{[a.Rw]:h}:{}}},x=null===(e=t.getParentBlockStore())||void 0===e?void 0:e.getCollectionViewStores()[0],y=t.getSpaceId();if(!x)return;const S=await p.queryCollection(s,{source:{type:"collection",id:t.id,spaceId:y},collectionView:{id:x.id,spaceId:y},loader:f},void 0,{src:"sprint_status_overlay_check"});if("success"!==S.type)return;const v=S.data.result.reducerResults[a.SF],b=S.data.result.reducerResults[a.YE];if("results"!==v.type||"results"!==b.type)return;const M=v.blockIds.length>0,j=b.blockIds.length>0;if(!d)return{hasCurrentSprint:M,hasNextSprint:j,hasLastSprint:!1};const C=S.data.result.reducerResults[a.Rw];if("results"!==C.type)return;return{hasCurrentSprint:M,hasNextSprint:j,hasLastSprint:C.blockIds.length>0}}),[s,n,t]);if("resolved"!==o||!i)return;return i}({sprintCollectionStore:(0,o.VK)((()=>{const e=t.state;if(e.isOpen)return e.store.getAssociatedCollectionStore()}),[t]),environment:s,normalizedBlockSchema:y}),v=(0,u.useIntl)(),b=(0,n.useCallback)((e=>void 0===S&&[a.YE,a.SF,a.Rw].includes(e)?{disabled:!0}:e===a.YE&&null!=S&&S.hasNextSprint?{disabled:!0,disableReasonMessage:v.formatMessage(f.cannotSetSprintToNextTooltip)}:e===a.SF&&null!=S&&S.hasCurrentSprint?{disabled:!0,disableReasonMessage:v.formatMessage(f.cannotSetSprintToCurrentTooltip)}:e===a.Rw&&null!=S&&S.hasLastSprint?{disabled:!0,disableReasonMessage:v.formatMessage(f.cannotSetSprintToLastTooltip)}:{disabled:!1}),[S,v]);return(0,h.jsx)(g.x,{...e,shouldDisableOption:b})}},93963:(e,t,s)=>{s.d(t,{z:()=>r});s(67294);var n=s(24405),i=s(9291),o=s(85893);const a=8;function r(e){let{color:t,size:s,style:r}=e;const l=(0,i.useIntl)(),d=(0,n.yK)((e=>({dot:{height:s||a,width:s||a,background:t||e.blueColor,flexShrink:0,borderRadius:"100%",pointerEvents:"none",...r}})),[s,t,r]);return(0,o.jsx)("div",{role:"img","aria-label":l.formatMessage({id:"statusDot.ariaLabel",defaultMessage:"New"}),style:d.dot})}},56596:(e,t,s)=>{s.d(t,{x:()=>A});var n=s(43261),i=s.n(n),o=s(67294),a=s(480),r=s(86628),l=s(24405),d=s(80951),c=s(84619),u=s(4635),p=s(9291),m=s(53965),g=s(1898),h=s(5149),f=s(75330),x=s(49616),y=s(43224),S=s(60709),v=s(98742),b=s(4023),M=s(50959),j=s(52275),C=s(78140),w=s(32163),k=s(40721),T=s(72495),I=s(26388),Z=s(22084),P=s(47082),F=s(85893);function A(e){var t;const{propertySchema:s,blockPropertyValueOverlayStore:n,onChange:A}=e,{device:_}=(0,a.O7)(),[R,O]=o.useState(e.initialValue??""),[B,D]=o.useState(""),L=(0,l.Fg)(),V=(0,p.useIntl)(),N=(0,r.VK)((()=>{const e=n.state;if(e.isOpen)return e.collectionContextStore}),[n]),E=(0,r.VK)((()=>(null==N?void 0:N.permissionScopes.state.canConfigureCollection)&&"collectionPage"!==(null==N?void 0:N.contextType)),[N]),U=(0,r.VK)((()=>{const e=n.state;return!!e.isOpen&&(0,x.aJ)({store:e.store,additionalStores:e.additionalStores,collectionContextStore:e.collectionContextStore})}),[n]),W=U?[]:s.options??[],K=(0,d.i7)(W,R),z=s.groups??[],q=K&&z.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(K.id)})),G=K?[(0,F.jsx)(Z.F,{value:K.value,color:K.color,groupColor:null==q?void 0:q.color,isSingle:!1,format:_.isMobile?c.lo.Large:c.lo.Medium,onClickRemove:()=>{O(""),A(void 0,void 0)},showRemoveButton:void 0===s.defaultOption,shouldShrink:!0,showEllipsis:!0,tooltipPlacement:b.u.Left,hideTooltip:!(null===(t=K.description)||void 0===t||!t.length)},"status")]:[],H=U?null:(0,F.jsx)(P.Z,{focus:!_.isMobile||void 0,focusAfterAnimation:!0,format:P.U.Select,tokens:G,placeholder:V.formatMessage({id:"database.selectPropertyEditMenu.searchStatusPlaceholder",defaultMessage:"Search for an option"}),onRemoveLastToken:()=>{},value:B,disabled:e.disabled,hideInput:e.disabled,onChange:e=>{D(e.target.value)},dontShowBorderBottom:_.isAndroid});let Y;if(Y=_.isMobile?{menuType:S.og.Modal,title:s.name,right:(0,F.jsx)(k.DoneMenuText,{}),onClickRight:e.onDismiss,header:H}:{menuType:S.og.Popup,header:H,tokenInputHeader:!0},e.disabled)return(0,F.jsx)(C.Z,{...Y});let Q=W;if(""!==B){const e=i().filter(B,W.map((e=>e.value))).map((e=>e.original));Q=W.filter((t=>e.includes(t.value)))}const $=z.map((e=>{const t=Q.filter((t=>{var s;return null===(s=e.optionIds)||void 0===s?void 0:s.includes(t.id)}));if(0!==t.length)return{group:e,groupOptions:t}})).filter(g.$K),J=$.length>1,X=U?[{items:z.map((t=>({key:t.name,render:e=>(0,F.jsx)(j.Z,{...e,disabledFeedback:!0,focused:e.focused,title:(0,F.jsx)(M.r_,{style:{fontWeight:500,marginTop:2},group:t,showIcon:!0,showColor:!0})}),action:()=>{e.onChange(void 0,t.name)}}))),key:"all-groups",render:e=>(0,F.jsx)(T.Z,{...e})}]:$.map(((t,s)=>{let{group:n,groupOptions:i}=t;return{items:i.map((t=>{const s=e.shouldDisableOption?e.shouldDisableOption(t.id):{disabled:!1};return{key:t.value,render:e=>{var i;return(0,F.jsx)(I.ZP,{disableTooltip:s.disabled&&!(null!==(i=t.description)&&void 0!==i&&i.length),placement:b.u.Left,renderTooltip:e=>s.disabled?s.disableReasonMessage:(0,F.jsxs)("div",{...e,style:y.F6,children:[(0,F.jsx)("div",{children:t.value}),(0,F.jsx)("div",{style:{color:L.mediumInvertedTextColor},children:t.description})]}),render:i=>{var o;return(0,F.jsx)(j.Z,{...(0,v.Z)(i,e),disabled:s.disabled,disabledFeedback:!0,focused:e.focused,title:(0,F.jsx)(Z.F,{...i,value:t.value,color:t.color,hideTooltip:!(null===(o=t.description)||void 0===o||!o.length),tooltipPlacement:b.u.Left,groupColor:n.color,showRemoveButton:!1,isSingle:!0,format:_.isMobile?c.lo.Large:c.lo.Medium}),isTokenTitle:!0})}})},action:()=>{e.onChange(t.value,void 0)}}})),key:`group-${s}`,render:e=>(0,F.jsx)(T.Z,{...e,topBorder:e.index>0,title:J&&(0,F.jsx)(M.r_,{group:n,showColor:!1,style:{fontSize:12}})})}})),ee=N&&E?{items:[{key:"edit property",render:e=>(0,F.jsx)(j.Z,{...e,title:(0,F.jsx)(p.FormattedMessage,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"}),icon:(0,u.W)({width:14})}),action:()=>{const t=N.settingsStore;N.collectionStore()&&(e.onDismiss(),f.n1({collectionContextStore:N}),h.r$({collectionContextStore:N,collectionSettingsStore:t}),h.H4({collectionSettingsStore:t,item:{type:"property",formatKey:N.getPropertyFormatKey(),property:e.property}}))}}],key:"edit-property",render:e=>(0,F.jsx)(T.Z,{...e,topBorder:e.index>0})}:void 0;return(0,F.jsx)(C.Z,{...Y,children:(0,F.jsx)(w.Z,{type:w.i.Vertical,initialFocus:B.length>0?0:void 0,sections:m.oA([...X,ee]),onAccept:(t,s,n)=>{e.onAccept(n)}})})}},13787:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(49085),l=s(84169),d=s(89101),c=s(9291),u=s(31701),p=s(37810),m=s(54642),g=s(92658),h=s(28020),f=s(92083),x=s(9209),y=s(74194),S=s(50506),v=s(58297),b=s(42402),M=s(85893);const j={padding:"24px 36px 24px",minWidth:300,maxWidth:400},C=r.default.createClass(void 0);const w=function(){const e=(0,o.qz)(void 0,C),t=(0,o.qz)(void 0,g.Z),{open:s}=(0,o.VK)((()=>x.Z.state),[]);return(0,M.jsx)(S.Z,{open:s,innerStyle:j,preventHideChildrenWhileOpening:!0,render:()=>(0,M.jsx)(F,{promoCodeStore:t,promoErrorStore:e}),onDismiss:T})};function k(){const e=(0,a.Fg)();return(0,M.jsxs)("div",{style:{display:"flex",alignItems:"center",color:e.lightTextColor,borderTop:`1px solid ${e.regularDividerColor}`,paddingTop:14},children:[(0,l.m)({width:14,marginTop:1,marginRight:6,fill:e.lightIconColor})," ",(0,M.jsx)("div",{children:(0,M.jsx)(c.FormattedMessage,{defaultMessage:"Have questions about this? <inlinelink>More info & FAQs</inlinelink>.",id:"studentNotEligibleModal.contactUsSection.message",values:{inlinelink:e=>(0,M.jsx)(b.Z,{href:"https://www.notion.so/Notion-for-students-teachers-adc631df15ee4ab9a7a33dd50f4c16fe",external:!0,children:e})}})})]})}function T(){x.Z.setState({open:!1})}function I(){T(),f.Z.setState({open:!0,openedFrom:"upsell",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0})}function Z(){const e=(0,a.Fg)(),t=(0,i.O7)(),s=(0,o.VK)((()=>(0,h.B7)(t)),[t]),n=(0,o.VK)((()=>null==s?void 0:s.getEmail()),[s]);return(0,M.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,M.jsx)("div",{style:{width:18,flexShrink:0,color:e.mediumTextColor},children:(0,M.jsx)(c.FormattedMessage,{defaultMessage:"1.",id:"studentNotEligibleModal.numberedList.firstItem"})}),(0,M.jsxs)("div",{style:{flexGrow:1},children:[(0,M.jsx)("div",{style:{color:e.mediumTextColor},children:(0,M.jsx)(c.FormattedMessage,{defaultMessage:"Your current email is:",id:"studentNotEligibleModal.numberedList.changeEmailItem.message"})}),(0,M.jsx)("div",{style:{fontWeight:p.Z.fontWeight.medium,marginTop:0},children:n}),(0,M.jsx)("div",{style:{color:e.mediumTextColor,marginTop:4},children:(0,M.jsx)(c.FormattedMessage,{defaultMessage:"Thousands of university, college, and post-secondary school domains are already eligible, not just .edu emails!",id:"studentNotEligibleModal.numberedList.changeEmailItem.message2"})}),(0,M.jsx)(v.Z,{style:{marginTop:12},onClick:I,isLarge:!0,children:(0,M.jsx)(c.FormattedMessage,{defaultMessage:"Change email",id:"studentNotEligibleModal.numberedList.changeEmailItem.button.label"})})]})]})}function P(e){let{promoCodeStore:t,promoErrorStore:s}=e;const r=(0,c.useIntl)(),l=(0,a.Fg)(),d=(0,i.O7)(),p=(0,n.useCallback)((()=>async function(e,t,s,n){const i=s.state.inputValue;if(i){const o=await m.getPromoCode(e,{code:i});"failed"!==o.type&&o.data.promo?x.Z.state.open&&(await x.Z.state.handlePromoCode(s.state.inputValue),T()):n.setState(t.formatMessage({defaultMessage:"Promo code {code} does not exist",id:"studentNotEligibleModal.numberedList.item2.promocode.errorMessage"},{code:i}))}}(d,r,t,s)),[d,r,t,s]),g=(0,n.useCallback)((e=>function(e,t,s){t.setState({...t.state,inputValue:e.target.value.toUpperCase()}),s.setState(void 0)}(e,t,s)),[t,s]),h=(0,o.VK)((()=>t.state.inputValue),[t]),f=(0,o.VK)((()=>s.state),[s]),S=r.formatMessage({defaultMessage:"Enter code…",id:"studentNotEligibleModal.numberedList.item2.promocodePlaceholder"});return(0,M.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,M.jsx)("div",{style:{width:18,flexShrink:0,color:l.mediumTextColor},children:(0,M.jsx)(c.FormattedMessage,{defaultMessage:"2.",id:"studentNotEligibleModal.numberedList.secondItem"})}),(0,M.jsxs)("div",{style:{flexGrow:1},children:[(0,M.jsx)("div",{style:{color:l.mediumTextColor},children:(0,M.jsx)(c.FormattedMessage,{defaultMessage:"Have a student promo code?",id:"studentNotEligibleModal.numberedList.promoCodeItem.message"})}),(0,M.jsxs)("div",{style:{display:"flex",marginTop:12},children:[(0,M.jsx)(y.Z,{style:{marginRight:8,height:32},value:h,onChange:g,onSubmit:p,placeholder:S}),(0,M.jsx)(v.Z,{onClick:p,disabled:!h,isLarge:!0,children:(0,M.jsx)(c.FormattedMessage,{defaultMessage:"Submit",id:"studentNotEligibleModal.numberedList.promoCodeItem.submitButton"})})]}),(0,M.jsx)("div",{style:{color:u.ZP.red,fontSize:12,marginTop:4,marginLeft:8,height:20},children:f})]})]})}function F(e){let{promoCodeStore:t,promoErrorStore:s}=e;return(0,M.jsxs)("div",{style:{fontSize:14},children:[(0,M.jsx)("div",{children:(0,M.jsx)(c.FormattedMessage,{defaultMessage:"<p>Unfortunately you are not eligible for a free Education plan if you use this email address.</p><p>K-12 students, K-12 educators, and personal email addresses such as Gmail and Outlook are not eligible to receive the <pricinglink>Education Plan</pricinglink> for free, but anyone is welcome to use the <pricinglink>Free Plan</pricinglink> for free with unlimited storage.</p>",id:"studentNotEligibleModal.header",values:{br:(0,M.jsx)("br",{}),p:e=>(0,M.jsx)("p",{style:{marginTop:0,marginBottom:8},children:1===e.length?e[0]:n.Children.toArray(e)}),pricinglink:e=>(0,M.jsx)(b.Z,{external:!0,href:d.AR.pricing,children:e})}})}),(0,M.jsx)(Z,{}),(0,M.jsx)(P,{promoCodeStore:t,promoErrorStore:s}),(0,M.jsx)(k,{})]})}},6202:(e,t,s)=>{s.d(t,{Z:()=>d});s(67294);var n=s(480),i=s(31701),o=s(64921),a=s(28992),r=s(58297),l=s(85893);const d=function(e){let{onClick:t,disabled:s,title:n}=e;return(0,l.jsx)(a.Z,{title:(0,l.jsx)(c,{onClick:t,disabled:s,title:n})})};function c(e){let{onClick:t,disabled:s,title:a}=e;const d=(0,n.O7)(),{isMobile:c}=d.device,u={width:"100%",color:i.ZP.blue};return c?(0,l.jsx)(o.Z,{onClick:t,mobileFeedback:!0,disabled:s,style:u,children:a}):(0,l.jsx)(r.Z,{onClick:t,disabled:s,style:{width:"100%",maxWidth:300,display:"flex",margin:"auto"},children:a})}},30676:(e,t,s)=>{s.d(t,{F:()=>r});s(67294);var n=s(86628),i=s(74016),o=s(52275),a=s(85893);function r(e){const{teamStore:t}=e,{name:s}=(0,n.VK)((()=>({name:t.getName()})),[t]);return(0,a.jsx)(o.Z,{...e,icon:(0,a.jsx)(i.p,{size:14,store:t,disabled:!0}),title:s})}},70268:(e,t,s)=>{s.d(t,{B:()=>a});s(67294);var n=s(24405),i=s(36596),o=s(85893);function a(e){let t=Math.floor(e.areaHeight/124);0===t&&(t=1);const s=(0,n.yK)((e=>({skeletonRect:{height:8,borderRadius:4,margin:10,backgroundColor:e.lightDividerColor},skeletonCircle:{display:"flex",width:28,height:28,marginRight:8,backgroundColor:e.lightDividerColor,borderRadius:20},skeletonSection:{display:"flex",width:"100%",margin:20,flexDirection:"row"}})),[8,10,20]),a=[...Array(t)].map(((e,t)=>(0,o.jsxs)("div",{style:s.skeletonSection,children:[(0,o.jsx)(i.Z,{style:s.skeletonCircle}),(0,o.jsxs)("div",{style:{width:"80%"},children:[(0,o.jsx)(i.Z,{style:{width:"80%",...s.skeletonRect,marginTop:0}}),(0,o.jsx)(i.Z,{style:{width:"50%",...s.skeletonRect}}),(0,o.jsx)(i.Z,{style:{width:"60%",...s.skeletonRect}}),(0,o.jsx)(i.Z,{style:{width:"50%",...s.skeletonRect}})]})]},t)));return(0,o.jsx)("div",{children:a})}},82942:(e,t,s)=>{s.r(t),s.d(t,{default:()=>V});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(36591),l=s(42853),d=s(5257),c=s(20669),u=s(35840),p=s(21202),m=s(1898),g=s(37810),h=s(4437),f=s(2405),x=s(84210),y=s(60709),S=s(34859),v=s(41747),b=s(80444),M=s(6258),j=s(64921),C=s(52275),w=s(31945),k=s(73420),T=s(73063),I=s(84076),Z=s(91839),P=s(78140),F=s(32163),A=s(89728),_=s(31278),R=s(76798),O=s(53336),B=s(72495),D=s(26388),L=s(85893);function V(){const e=(0,o.VK)((()=>v.Z.getSubTab()),[]);if("by_topic"===e)return(0,L.jsx)(N,{subTab:e},e);(0,m.t1)(e)}function N(e){let{subTab:t}=e;const s=(0,i.O7)(),a=(0,o.VK)((()=>"loading"===v.Z.state.loadingState.type),[]),r=(0,o.VK)((()=>v.Z.state.topics),[]),l=(0,n.useCallback)((()=>{(0,h.mO)({environment:s})}),[s]),d=H();return(0,L.jsxs)("div",{style:d.UpdateSidebarTabAiContext,children:[(0,L.jsxs)("div",{style:d.header,children:[(0,L.jsxs)("span",{style:d.label,children:["AI Context",(0,L.jsx)(E,{})]}),(0,L.jsx)(k.LZ,{}),!a&&r.length>0&&(0,L.jsx)(A.Z,{onClick:l,children:"Run again"})]}),(0,L.jsxs)(O.Z,{type:S.Z.Y,style:d.Scroller,children:[a&&(0,L.jsx)("div",{style:d.Empty,children:(0,L.jsx)(Z.Z,{isTriColored:!0})}),r.length>0||a?r.map((e=>(0,L.jsx)(G,{topic:e},e.title))):(0,L.jsx)("div",{style:d.Empty,children:(0,L.jsx)(A.Z,{onClick:l,children:"Run"})})]})]})}function E(){const{isMobile:e}=(0,i.Fy)(),t=(0,o.VK)((()=>v.Z.getSubTab()),[]),s=(0,n.useMemo)((()=>(0,m.Yd)(v.G)),[]),a=H();return(0,L.jsx)(w.ZP,{popupType:e?w.Z4.SlideUp:w.Z4.Popup,placementToOrigin:w.pO.Bottom,alignmentToOrigin:w.vR.Start,renderOrigin:e=>(0,L.jsx)(j.Z,{...e,style:a.sublabel,children:v.G[t].label}),render:e=>(0,L.jsx)(P.Z,{menuType:y.og.Popup,width:300,children:(0,L.jsx)(F.Z,{type:F.i.Vertical,initialFocus:0,sections:[{key:"ai_context_sub_tab",render:e=>(0,L.jsx)(B.Z,{...e,title:"Mode"}),items:s.map((s=>({key:s,render:e=>(0,L.jsx)(C.Z,{...e,title:v.G[s].label,right:s===t?(0,r.e)({width:12,height:"auto"}):void 0}),action:()=>{v.Z.setSubTab(s),e.close()}})))}]})})})}function U(e){let{topic:t,onTopicClick:s}=e;const i=(0,n.useCallback)((()=>{s(t)}),[s,t]),o=H();return(0,L.jsx)("span",{style:o.InlineSubtopic,onClick:i,children:t})}function W(e){let{text:t,onTopicClick:s}=e;return(0,L.jsx)(L.Fragment,{children:t.split(/(\[\[.*?\]\])/g).map(((e,t)=>{const n=e.slice(2,-2);return e.startsWith("[[")&&e.endsWith("]]")?(0,L.jsx)(U,{topic:n,onTopicClick:s},`${t}/${n}`):e}))})}function K(e){let{question:t,onQuestionClick:s}=e;const i=(0,n.useCallback)((()=>{s(t)}),[s,t]),o=H();return(0,L.jsx)(D.ZP,{renderTooltip:()=>(0,L.jsx)("div",{style:o.suggestedQuestionTooltip,children:t}),placement:D.ug.Bottom,render:e=>(0,L.jsx)(f.Z,{title:(0,L.jsx)("div",{style:o.suggestedQuestion,children:t}),style:o.suggestedQuestionButton,icon:u.R,iconStyle:o.suggestedQuestionIcon,onClick:i,tooltipEvents:e})})}function z(e){let{pageId:t}=e;const s=(0,i.O7)(),r=(0,o.VK)((()=>b.default.state.currentSpaceStore),[]),l=(0,n.useMemo)((()=>{if(r)return M.G.createChildStore(r,{table:p.iU,id:t})}),[r,t]),d=(0,o.VK)((()=>null==l?void 0:l.getIcon()),[l]),c=(0,o.VK)((()=>Boolean(null==l?void 0:l.isEmptyPage())),[l]),u=(0,a.yK)((()=>({relatedPageRow:{display:"block",maxWidth:"100%"},relatedPage:{display:"inline-flex",flexDirection:"row",alignItems:"center",gap:4,cursor:"pointer",padding:"2px 4px",borderRadius:4,fontWeight:500,transition:"background 0.2s ease",width:"auto",maxWidth:"100%",marginRight:"auto"}})),[]),m=(0,o.VK)((()=>s.RouterStore.state.route),[s]),{metaHref:g,href:h}=(0,o.VK)((()=>{if(!l)return{metaHref:void 0,href:void 0};const e=(0,x.ZP)({store:l,fullyQualified:!1,pageVisitSource:void 0});return"page"===m.name||"nativeTab"===m.name&&"assistant"===m.tab||"quickSearch"===m.name?{metaHref:e,href:e}:{metaHref:void 0,href:void 0}}),[m,l]);return l?(0,L.jsx)("div",{style:u.relatedPageRow,children:(0,L.jsxs)(I.Z,{href:g,metaHref:h,style:u.relatedPage,children:[(0,L.jsx)(_.Z,{disabled:!0,icon:d,isEmptyPage:c,size:16}),(0,L.jsx)(R.Z,{store:l})]})}):null}function q(e){let{pageIds:t}=e;const s=(0,a.yK)((e=>({relatedPageGroup:{display:"flex",flexDirection:"column",gap:2}})),[]);return(0,L.jsx)("div",{style:s.relatedPageGroup,children:t.map((e=>(0,L.jsx)(z,{pageId:e},e)))})}function G(e){let{topic:t}=e;const s=(0,i.O7)(),a=(0,o.VK)((()=>b.default.state.mainEditorCurrentBlockStore),[]),r=(0,n.useCallback)((()=>{v.Z.setTopicIsExpanded(t.clientId,!t.isExpanded)}),[t.clientId,t.isExpanded]),u=(0,n.useCallback)((()=>{a&&(0,h.x)({environment:s,blockStore:a,topicClientId:t.clientId})}),[s,a,t.clientId]),p=(0,n.useCallback)((e=>{(0,h.Is)({environment:s,suggestion:{type:"question",question:e}})}),[s]);(0,n.useEffect)((()=>{"initial"===t.loadingState&&u()}),[t,u]);const m=H({isSectionExpanded:!0});return(0,L.jsxs)("div",{style:m.AiContextSection,children:[(0,L.jsxs)(k.X2,{alignItems:"center",justifyContent:"space-between",gap:4,children:[(0,L.jsxs)(A.Z,{style:m.AiContextSectionTitle,onClick:r,children:[t.isExpanded?(0,l.i)(m.expandIcon):(0,d.o)(m.expandIcon),t.title]}),(0,L.jsx)(k.LZ,{}),(0,L.jsx)(T.Z,{onClick:u,icon:c.y,isPurple:!0,ariaLabel:"Generate AI Context section",disabled:"loading"===t.loadingState})]}),(0,L.jsxs)("div",{style:m.AiContextSectionBody,children:["loaded"===t.loadingState?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("p",{children:(0,L.jsx)(W,{text:t.summary,onTopicClick:e=>{(0,h.is)({environment:s,title:`${t.title}: ${e}`})}})}),(0,L.jsx)("div",{style:m.suggestedQuestionGroup,children:t.questions.map((e=>(0,L.jsx)(K,{question:e,onQuestionClick:p},e)))}),(0,L.jsx)(q,{pageIds:t.relatedPages})]}):(0,L.jsx)("div",{style:m.Empty,children:(0,L.jsx)(Z.Z,{isTriColored:!0})}),!t.isExpanded&&(0,L.jsx)("div",{style:m.AiContextSectionOverlay,onClick:r,children:(0,L.jsx)(A.Z,{style:m.AiContextOverlayButton,hoveredStyle:m.AiContextOverlayButtonHovered,pressedStyle:m.AiContextOverlayButtonPressed,children:"more"})})]})]})}function H(){let{isSectionExpanded:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.yK)((t=>({UpdateSidebarTabAiContext:{position:"relative",minHeight:0,display:"flex",flexDirection:"column",background:t.contentBackground,pointerEvents:"auto",height:"100%"},AiContextSection:{margin:"8px 0",padding:"0 12px 8px 12px",borderBottom:`1px solid ${t.accentColors.gray[100]}`},AiContextSectionTitle:{fontSize:14,fontWeight:500,color:t.mediumTextColor,marginLeft:-4,whiteSpace:"normal",flexShrink:1,height:"auto",padding:"6px 8px"},AiContextSectionBody:{fontSize:14,margin:"-4px 2px 4px 2px",position:"relative",overflow:"hidden",...e?{}:{maxHeight:64}},AiContextSectionOverlay:{position:"absolute",bottom:0,left:0,right:0,height:32,background:"linear-gradient(to bottom, rgba(255, 255, 255, 0), rgba(255, 255, 255, 1))",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},AiContextOverlayButton:{color:t.mediumTextColor,background:t.contentBackground,borderRadius:6,border:`1px solid ${t.regularDividerColor}`,fontSize:12,padding:"0 8px",height:22},AiContextOverlayButtonHovered:{background:t.accentColors.gray[50]},AiContextOverlayButtonPressed:{background:t.accentColors.gray[100]},Scroller:{flexGrow:1,minHeight:0,transform:"translateZ(0px)",zIndex:1,overflow:"hidden auto",marginBottom:0},Empty:{display:"flex",alignItems:"center",justifyContent:"center",marginTop:32},header:{display:"flex",borderBottom:`1px solid ${t.accentColors.gray[100]}`,alignItems:"center",pointerEvents:"auto",fontSize:14,padding:"8px 12px 8px 16px"},label:{color:t.regularTextColor,fontWeight:g.Z.fontWeight.medium},sublabel:{display:"inline-block",color:t.mediumTextColor,fontWeight:g.Z.fontWeight.medium,cursor:"pointer",marginLeft:2,padding:"0 2px",borderRadius:3},expandIcon:{width:16,marginLeft:-2,paddingRight:6},InlineSubtopic:{display:"inline",fontWeight:g.Z.fontWeight.medium,cursor:"pointer",padding:"0 3px",borderRadius:4,fontSize:"90%",color:t.accentColors.purple[800],background:t.accentColors.purple[50],boxShadow:`0 0 0 -1px ${t.accentColors.purple[50]}`},suggestedQuestionGroup:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:6,width:"100%",marginLeft:-2,marginBottom:"1em"},suggestedQuestionButton:{width:"auto",maxWidth:"100%",alignItems:"flex-start",borderRadius:16},suggestedQuestionTooltip:{maxWidth:"100%",whiteSpace:"normal"},suggestedQuestion:{overflow:"hidden",textOverflow:"ellipsis",width:"100%",flexShrink:1},suggestedQuestionIcon:{fill:t.aiPurpleColor,marginTop:3}})),[e])}},6175:(e,t,s)=>{s.d(t,{W:()=>l,Z:()=>c});var n=s(67294),i=s(24405),o=s(1898),a=s(55797),r=s(85893);const l={"en-US":"en","ja-JP":"ja","ko-KR":"ko","fr-FR":"fr","de-DE":"de","pt-BR":"pt-BR","es-ES":"es-ES"};function d(e){return e.src?(0,r.jsx)("img",{style:e.style,src:e.src}):null}const c=n.forwardRef(((e,t)=>{const s=(0,i.Fg)(),l=n.useRef(e);l.current=e,n.useEffect((()=>{const t=document.createElement("script");t.src="https://player.vimeo.com/api/player.js",document.body.appendChild(t);const s=window.Vimeo;if(!s)return()=>{};const n=document.getElementById(e.src),i=new s.Player(n);return i?(i.on("play",(e=>{var t,s;null===(t=(s=l.current).onPlay)||void 0===t||t.call(s,e)})),i.on("pause",(e=>{var t,s;null===(t=(s=l.current).onPause)||void 0===t||t.call(s,e)})),i.on("ended",(e=>{var t,s;null===(t=(s=l.current).onEnd)||void 0===t||t.call(s,e)})),()=>{i.off("play"),i.off("pause"),i.off("ended")}):()=>{}}),[e.src,l.current.src]);const c=function(e,t){const s=(0,o.qP)(t).flatMap((e=>{let[t,s]=e;return`${t}=${s}`})).join("&");return`${e}&${s}`}(l.current.src,{texttrack:l.current.defaultTextTrack,playsinline:!1,...l.current.options}),u={position:"absolute",top:0,left:0,width:"100%",height:"100%",borderStyle:"solid",borderColor:s.tableDividerColor,borderWidth:"0 0 1px 0"};return(0,r.jsxs)(a.Z,{ratio:l.current.aspectRatioOverride??9/16,children:[(0,r.jsx)(d,{style:u,src:l.current.preloadThumbnailSrc}),(0,r.jsx)("iframe",{ref:t,id:l.current.src,className:l.current.className,allowFullScreen:!0,src:c,style:{...u,...l.current.style}})]})}))},79649:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Z});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(64275),l=s(26139),d=s(9291),c=s(37810),u=s(12714),p=s(37181),m=s(18514),g=s(48779),h=s(80444),f=s(77080),x=s(66309),y=s(64921),S=s(61519),v=s(58297),b=s(64369),M=(s(57658),s(41892)),j=s(31701);var C=s(90403),w=s(85893);function k(){const[e,t]=(0,n.useState)(0),s=(0,n.useRef)(null),i=(0,a.Fg)(),o=function(e){return(0,a.yK)((t=>({container:{position:"relative",margin:"24px auto",textAlign:"center"},imageContainer:{position:"relative",height:280,borderRadius:8,overflow:"hidden",background:"dark"===t.mode?"#1D1B16":"#E3E2E0"},image:{height:280,width:497},caption:{fontWeight:c.Z.fontWeight.regular},navigation:{display:"flex",alignItems:"center",justifyContent:"center",gap:0,margin:"12px auto 8px"},activeDot:{background:t.regularTextColor},dot:{borderRadius:"100%",background:t.buttonPressedBackground,height:14,width:14,cursor:"pointer",border:`4px solid ${t.sidebarBackground}`},progress:{background:t.buttonPressedBackground,height:3,position:"absolute",left:0,right:0,bottom:0,transform:"translateX(-100%)",transition:`transform ${e}ms linear`}})),[e])}(5e3),{reset:r}=function(e,t){const s=(0,n.useRef)(),i=(0,n.useRef)(null),[o,a]=(0,n.useState)(t),r=(0,n.useCallback)((()=>a((e=>null===e?t:null))),[t]);function l(){var e;null===(e=s.current)||void 0===e||e.call(s)}const d=(0,n.useCallback)((()=>{i.current&&clearInterval(i.current)}),[]),c=(0,n.useCallback)((()=>{d(),i.current=setInterval(l,t)}),[d,t]);return(0,n.useEffect)((()=>{s.current=e}),[e]),(0,n.useEffect)((()=>(i.current&&clearInterval(i.current),null!==o&&(i.current=setInterval(l,o)),d)),[o,d]),{toggle:r,clear:d,reset:c}}((()=>{t((e=>(e+1)%I.length))}),5e3),l=(0,n.useCallback)((e=>{t(e%I.length),r()}),[r]),d=(0,n.useMemo)((()=>I[e%I.length]),[e]),u=(0,n.useMemo)((()=>{const t=[];for(let s=0;s<I.length;s++){const n=e===s?{...o.dot,...o.activeDot}:o.dot,i=(0,w.jsx)("div",{style:n,onClick:()=>l(s)});t.push(i)}return t}),[e,o,l]);return(0,n.useEffect)((()=>{s.current&&(s.current.style.transform="translateX(0)")}),[e]),(0,w.jsxs)("div",{style:o.container,children:[(0,w.jsxs)("div",{style:o.imageContainer,children:[(0,w.jsx)("img",{src:"dark"===i.mode?d.imageSrcDark:d.imageSrcLight,style:o.image,className:"notion-fadein-slow"},`img-${e}`),(0,w.jsx)("div",{ref:s,style:o.progress},`progress-${e}`)]}),(0,w.jsx)("div",{style:o.navigation,children:u}),(0,w.jsx)("div",{style:o.caption,className:"notion-fadein-slow",children:d.caption},`txt-${e}`)]})}function T(){const e=(0,a.yK)((e=>({textContainer:{display:"flex",alignItems:"center",justifyContent:"center",gap:4},badge:{fontWeight:c.Z.fontWeight.medium,letterSpacing:0,fontSize:11,color:e.blueColor,background:"light"===e.mode?j.ZP.diffBackground:"rgba(35, 131, 226, 0.2)",whiteSpace:"nowrap",width:"fit-content"}})),[]);return(0,w.jsxs)(b.Z,{style:e.textContainer,children:[(0,w.jsx)(d.FormattedMessage,{defaultMessage:"Organization level controls",id:"enterpriseLaunchModal.imageScene.revampedAdminConsole"}),(0,w.jsx)(C.Z,{style:e.badge,content:(0,w.jsx)(d.FormattedMessage,{defaultMessage:"Coming soon",id:"enterpriseLaunchModal.imageScene.comingSoon"})})]})}const I=[{imageSrcLight:M.Z.images.enterpriseModal.managedUsersLightPng,imageSrcDark:M.Z.images.enterpriseModal.managedUsersDarkPng,caption:(0,w.jsx)(b.Z,{children:(0,w.jsx)(d.FormattedMessage,{defaultMessage:"Managed users dashboard & controls",id:"enterpriseLaunchModal.imageScene.managedUsers"})})},{imageSrcLight:M.Z.images.enterpriseModal.securityLightPng,imageSrcDark:M.Z.images.enterpriseModal.securityDarkPng,caption:(0,w.jsx)(b.Z,{children:(0,w.jsx)(d.FormattedMessage,{defaultMessage:"Security & compliance integrations",id:"enterpriseLaunchModal.imageScene.securityAndComplianceIntegrations"})})},{imageSrcLight:M.Z.images.enterpriseModal.organizationsLightPng,imageSrcDark:M.Z.images.enterpriseModal.organizationsDarkPng,caption:(0,w.jsx)(T,{})}];const Z=(0,d.injectIntl)((function(e){const t=(0,i.O7)(),s=(0,a.yK)((e=>({container:{maxWidth:560,padding:24},closeButton:{position:"absolute",top:12,right:12,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:18,height:18},closeButtonHovered:{background:e.buttonPressedBackground},closeIcon:{width:14,fill:e.mediumTextColor},title:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",fontWeight:c.Z.fontWeight.semibold,fontSize:28,lineHeight:"30px",maxWidth:400,margin:"4px auto 16px",textAlign:"center"},captionContainer:{width:"100%"},caption:{textAlign:"center",margin:"0 auto",padding:"0 12px 0"},divider:{backgroundColor:e.tableLightDividerColor,opacity:.5,marginLeft:-24,width:"calc(100% + 48px)"},learnMoreContainer:{paddingTop:24,width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},learnMoreButton:{margin:"0 auto",gap:4},externalLinkIcon:{width:18}})),[]),M=(0,n.useCallback)((()=>{const{currentUserSettingsStore:e}=h.default.state;e&&p.Kq(t,{phase:"dismissed_modal",transactionUserAction:"EnterpriseLaunchModal.debug.clickCancel",userSettingsStore:e})}),[t]),j=(0,n.useCallback)((()=>{const{currentUserSettingsStore:e}=h.default.state;if(!e)return;const s=(0,m.UY)("blog.enterpriseLaunch");u.D({environment:t,url:s}),p.Kq(t,{phase:"dismissed_completely",transactionUserAction:"EnterpriseLaunchModal.debug.clickLearnMore",userSettingsStore:e})}),[t]),C=(0,o.VK)((()=>{const{currentUserSettingsStore:e,currentSpaceStore:s,mainEditorCurrentBlockStore:n}=h.default.state;if(t.device.isMobile)return!1;if(!e||!e.isReady())return!1;const i=e.getSettings();return!!i&&(!!(s&&n&&n.canRead())&&(!(!s.canAdmin()||!(0,g.j9)(s))&&!(void 0!==i.enterprise_launch_modal_phase||!f.default.checkGate("enterprise_launch_modal"))))}),[t.device]);return t.device.isMobile?null:(0,w.jsx)(x.default,{shouldShow:C,calloutId:"enterprise_launch_promo",desktopRenderInner:()=>(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(y.Z,{onClick:M,style:s.closeButton,hoveredStyle:s.closeButtonHovered,children:(0,r.D)(s.closeIcon)}),(0,w.jsx)(b.Z,{isMultiline:!0,style:s.title,children:(0,w.jsx)(d.FormattedMessage,{defaultMessage:"Meet the improved{br}Enterprise experience",id:"enterpriseLaunchModal.title",values:{br:(0,w.jsx)("br",{})}})}),(0,w.jsx)("div",{style:s.captionContainer,children:(0,w.jsx)(b.Z,{isSecondaryColor:!0,isMultiline:!0,style:s.caption,children:(0,w.jsx)(d.FormattedMessage,{defaultMessage:"The connected workspace people love is now easier to implement and checks all your admin, security & compliance needs",id:"enterpriseLaunchModal.caption"})})}),(0,w.jsx)(k,{}),(0,w.jsx)(S.Z,{size:1,style:s.divider}),(0,w.jsx)("div",{style:s.learnMoreContainer,children:(0,w.jsxs)(v.Z,{style:s.learnMoreButton,onClick:j,isLarge:!0,children:[(0,w.jsx)(d.FormattedMessage,{defaultMessage:"Learn more",id:"enterpriseLaunchModal.learnMore"}),(0,l.K)(s.externalLinkIcon)]})})]}),desktopInnerStyle:s.container,desktopOnDismiss:M,phoneRenderInner:()=>null})}))},21396:(e,t,s)=>{s.d(t,{F:()=>p,e:()=>u});s(21703),s(67294);var n=s(24405),i=s(73110),o=s(49019),a=s(53016),r=s(26774),l=s(1898),d=s(93044),c=s(85893);function u(e){if(e.kind===i.yp.ContextValue)return e.name;if(e.kind===i.yp.Binding||e.kind===i.yp.ThisRow)throw new Error("Not implemented yet.");(0,l.t1)(e)}function p(e){const{value:t}=e,s=(0,n.Fg)(),i=u(t);let l,p;if("date"===t.type.type?l=a.V:"person"===t.type.type?l=r.O:("block"===t.type.type||"array"===t.type.type&&"block"===t.type.of.type)&&(l=o.e),l){const e=l;p=()=>e({width:12,height:12,marginRight:4})}return(0,c.jsx)(d.ZP,{...e,title:i,renderAvatar:p,shouldShrink:!0,style:{background:s.outlineBlueButtonPressedBackground,color:s.blueColor,padding:"2px 4px"}})}},457:(e,t,s)=>{s.d(t,{Z:()=>c});s(67294);var n=s(13991),i=s(24405),o=s(1799),a=s(31701),r=s(1898),l=s(37810),d=s(85893);function c(e){const{type:t}=e,s=(0,i.yK)((e=>({pane:{display:"flex",whiteSpace:"pre-line",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:4,backgroundColor:a.FN.light.yellow[50],paddingTop:8,paddingBottom:8,marginBottom:10},textCode:{fontFamily:l.Z.getHeaderFontFamily({pageFont:"mono",locale:n.SP}),fontWeight:l.Z.fontWeight.regular,fontSize:l.Z.fontSize.UIRegular.desktop,font:l.Z.baseFontFamily.emailMono,color:a.FN.light.brown[500],textAlign:"center"},redactedBackupCode:{textDecoration:"line-through",opacity:.2}})),[]);return(0,d.jsx)("div",{style:s.pane,children:(0,d.jsx)("div",{style:s.textCode,children:"status"===t?e.status.map(((e,t)=>(0,d.jsx)("div",{style:e.hasBeenUsed?s.redactedBackupCode:{},children:o.A},t))):"unencryptedCodes"===t?e.backupCodes.map(o.K).join("\n"):(0,r.t1)(t)})})}},56839:(e,t,s)=>{s.d(t,{R$:()=>g,ZP:()=>h});var n=s(67294),i=s(24405),o=s(9291),a=s(53965),r=s(37810),l=s(18514),d=s(68785),c=s(88175),u=s(73602),p=s(11898),m=s(85893);const g=6;function h(e){let{isLoading:t,phoneNumber:s,errorMessage:r,resentStatus:h,resentAt:x,onDismiss:y,onBack:S,onVerifyCode:v,onResendLink:b}=e;const M=(0,i.yK)(f,[]),[j,C]=(0,n.useState)([]),w=(0,m.jsx)(o.FormattedMessage,{id:"profileSettings.mfa.sms.verifyCodeTitle",defaultMessage:"Verify phone number"}),k=(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(o.FormattedMessage,{id:"profileSettings.mfa.sms.verifyCodeHeader.default",defaultMessage:"Enter the code sent to {phoneNumber} to complete setup.",values:{phoneNumber:s}})," ",(0,m.jsx)(u.y,{resentAt:x,resentStatus:h,onResendLink:b})]}),T={text:t?(0,m.jsx)(d.Z,{}):(0,m.jsx)(o.FormattedMessage,{id:"profileSettings.mfa.sms.verifyCodeButton",defaultMessage:"Verify code"}),onClick:()=>v(j.join("")),disabled:t||"resending"===h||(0,a.oA)(j).length!==g},I=[{text:(0,m.jsx)(o.FormattedMessage,{id:"profileSettings.mfa.sms.verifyCodeNeedHelp",defaultMessage:"Need help?"}),href:(0,l.UY)("guides.mfa"),isExternal:!0,type:"link",view:"plain"}];return(0,m.jsx)(c.Z,{title:w,header:k,errorMessage:r,primaryAction:T,secondaryActions:I,onDismiss:y,onBack:S,disableBackButton:t,children:(0,m.jsx)("div",{style:M.body,children:(0,m.jsx)(p.ZP,{numInputs:g,format:"settings",disabled:!1,value:j,onChange:C,autoFocus:!0,isValidKey:p.rN})})})}function f(e){return(0,i.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",marginTop:16,marginBottom:4},textCode:{fontWeight:r.Z.fontWeight.medium,fontSize:r.Z.fontSize.UIRegular.desktop,lineHeight:1.2,color:e.darkTextColor,marginTop:32,marginBottom:32,textAlign:"center"}})}},18469:(e,t,s)=>{s.d(t,{R$:()=>m,ZP:()=>g});var n=s(67294),i=s(24405),o=s(9291),a=s(53965),r=s(37810),l=s(18514),d=s(68785),c=s(88175),u=s(11898),p=s(85893);const m=6;function g(e){let{isLoading:t,errorMessage:s,onDismiss:r,onBack:g,onVerifyCode:f}=e;const x=(0,i.yK)(h,[]),[y,S]=(0,n.useState)([]),v=(0,p.jsx)(o.FormattedMessage,{id:"profileSettings.mfa.totp.verifyCodeTitle",defaultMessage:"Verify code"}),b=(0,p.jsx)(o.FormattedMessage,{id:"profileSettings.mfa.totp.verifyCodeHeader",defaultMessage:"Enter the one-time code from authenticator to complete setup."}),M={text:t?(0,p.jsx)(d.Z,{}):(0,p.jsx)(o.FormattedMessage,{id:"profileSettings.mfa.totp.verifyCodeButton",defaultMessage:"Verify code"}),onClick:()=>f(y.join("")),disabled:t||(0,a.oA)(y).length!==m},j=[{text:(0,p.jsx)(o.FormattedMessage,{id:"profileSettings.mfa.totp.needHelp",defaultMessage:"Need help?"}),href:(0,l.UY)("guides.mfa"),isExternal:!0,type:"link",view:"plain"}];return(0,p.jsx)(c.Z,{title:v,header:b,errorMessage:s,primaryAction:M,secondaryActions:j,onDismiss:r,onBack:g,disableBackButton:t,children:(0,p.jsx)("div",{style:x.body,children:(0,p.jsx)(u.ZP,{numInputs:m,format:"settings",disabled:t,value:y,onChange:e=>{S(e)},autoFocus:!0,isValidKey:u.rN})})})}function h(e){return(0,i.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",marginTop:16,marginBottom:4},textCode:{fontWeight:r.Z.fontWeight.medium,fontSize:r.Z.fontSize.UIRegular.desktop,lineHeight:1.2,color:e.darkTextColor,marginTop:32,marginBottom:32,textAlign:"center"}})}},63134:(e,t,s)=>{s.d(t,{Z:()=>y});var n=s(67294),i=s(480),o=s(86628),a=s(9291),r=s(91536),l=s(92625),d=s(4708),c=s(77907),u=s(35691),p=s(88893),m=s(35057),g=s(88280),h=s(58297),f=s(29825),x=s(85893);function y(e){let{spaceStore:t,origin:s,requestFrom:y,inviteFrom:S}=e;const{shouldShowRequestMemberButtion:v,canEditMembership:b}=(0,o.VK)((()=>({shouldShowRequestMemberButtion:!t.canEditMembership()&&!t.getDisableMembershipRequests()&&(0,d.p1)(),canEditMembership:t.canEditMembership()})),[t]),M=(0,o.VK)((()=>{const e=g.subscriptionDataStoreInstance.state;return Boolean(e&&p.YK(e))}),[]),{isMobile:j}=(0,i.Fy)(),C=(0,o.VK)((()=>(0,u.shouldEnableSlackImportsInvite)({canEditPermission:b,isMobile:j,subscriptionTier:(0,m.zt)()})),[b,j]),w=(0,n.useCallback)((()=>{const e=(0,a.defineMessages)({updatingPermissions:{id:"spacePermissionsSettings.updatePermissionsMessage",defaultMessage:"Updating…"}});l.j({message:e.updatingPermissions})}),[]),k=(0,n.useCallback)((()=>{l.x()}),[]),T=(0,i.O7)(),I=(0,n.useCallback)((()=>{r.L7(T,{type:"request"})}),[T]);return v?(0,x.jsx)(f.Z,{store:t,analyticsFrom:y,origin:s?(0,x.jsx)("div",{onClick:I,children:s}):(0,x.jsx)(h.Z,{isLarge:!0,onClick:I,children:(0,x.jsx)(a.FormattedMessage,{id:"inviteUserButton.requestMemberLabel",defaultMessage:"Add members"})})}):(0,x.jsx)(c.LazyPermissionsInviteWithModal,{disabled:!b,store:t,onInviteClick:w,onInviteComplete:k,isSubscribed:M,membersOnly:!1,upgradeButtonName:"space_permission_settings",shouldGrow:!1,enableInviteDropdown:C,origin:s,analyticsFrom:S})}},69931:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Z});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(56666),l=s(45238),d=s(85893);const c=(0,l.IU)("mobileQuickCaptureMore",{viewBox:"0 0 14 3",svg:(0,d.jsx)("path",{d:"M1.86621 3.00684C1.59733 3.00684 1.35352 2.94303 1.13477 2.81543C0.916016 2.68327 0.74056 2.50781 0.608398 2.28906C0.480794 2.07031 0.416992 1.82878 0.416992 1.56445C0.416992 1.29557 0.480794 1.05176 0.608398 0.833008C0.74056 0.614258 0.916016 0.441081 1.13477 0.313477C1.35352 0.181315 1.59733 0.115234 1.86621 0.115234C2.13053 0.115234 2.37207 0.181315 2.59082 0.313477C2.80957 0.441081 2.98275 0.614258 3.11035 0.833008C3.24251 1.05176 3.30859 1.29557 3.30859 1.56445C3.30859 1.82878 3.24251 2.07031 3.11035 2.28906C2.98275 2.50781 2.80957 2.68327 2.59082 2.81543C2.37207 2.94303 2.13053 3.00684 1.86621 3.00684ZM6.99316 3.00684C6.72884 3.00684 6.4873 2.94303 6.26855 2.81543C6.0498 2.68327 5.87435 2.50781 5.74219 2.28906C5.61458 2.07031 5.55078 1.82878 5.55078 1.56445C5.55078 1.29557 5.61458 1.05176 5.74219 0.833008C5.87435 0.614258 6.0498 0.441081 6.26855 0.313477C6.4873 0.181315 6.72884 0.115234 6.99316 0.115234C7.25749 0.115234 7.49902 0.181315 7.71777 0.313477C7.94108 0.441081 8.11654 0.614258 8.24414 0.833008C8.3763 1.05176 8.44238 1.29557 8.44238 1.56445C8.44238 1.82878 8.3763 2.07031 8.24414 2.28906C8.11654 2.50781 7.94108 2.68327 7.71777 2.81543C7.49902 2.94303 7.25749 3.00684 6.99316 3.00684ZM12.127 3.00684C11.8581 3.00684 11.6143 2.94303 11.3955 2.81543C11.1768 2.68327 11.0013 2.50781 10.8691 2.28906C10.7415 2.07031 10.6777 1.82878 10.6777 1.56445C10.6777 1.29557 10.7415 1.05176 10.8691 0.833008C11.0013 0.614258 11.1768 0.441081 11.3955 0.313477C11.6143 0.181315 11.8581 0.115234 12.127 0.115234C12.3913 0.115234 12.6328 0.181315 12.8516 0.313477C13.0703 0.441081 13.2458 0.614258 13.3779 0.833008C13.5101 1.05176 13.5762 1.29557 13.5762 1.56445C13.5762 1.82878 13.5101 2.07031 13.3779 2.28906C13.2458 2.50781 13.0703 2.68327 12.8516 2.81543C12.6328 2.94303 12.3913 3.00684 12.127 3.00684Z"})});var u=s(30681),p=s(9291),m=s(36610),g=s(24677),h=s(43250),f=s(4708),x=s(98742),y=s(35328),S=s(77907),v=s(80444),b=s(21884),M=s(64921),j=s(31945),C=s(26388),w=s(28451),k=s(81415),T=s(71424);function I(e){let{originRef:t}=e;return(0,d.jsx)(w.P,{calloutId:"wiki_promo",children:(0,d.jsx)(k.U,{origin:t,placementToOrigin:"bottom",header:"Upgrade your existing wikis",content:"Look for the Turn into wiki action here",onCloseClick:()=>{b.E.reset()},pointerPosition:"98%",pointerLength:24,pointerOffset:-3,style:{width:T.G5}})})}const Z=function(e){let{buttonPopupStore:t,store:s,shouldShowAddTo:a}=e;const r=(0,i.O7)(),{device:l}=r,[c,u]=(0,n.useState)(void 0),p=(0,n.useRef)(null),h=(0,n.useCallback)((()=>{b.E.reset(),g.ZH(r);const e=p.current;e&&u(e.getBoundingClientRect()),m.kq(r)}),[p,r]),f=(0,o.VK)((()=>b.E.state.showConvertTooltip),[]);return(0,d.jsxs)(d.Fragment,{children:[f?(0,d.jsx)(I,{originRef:p}):null,(0,d.jsx)(j.ZP,{popupType:l.isMobile?j.Z4.SlideUp:j.Z4.Popup,buttonPopupStore:t,renderOrigin:e=>(0,d.jsx)(A,{ref:p,buttonPopupEvents:e,shouldShowAddTo:a}),onClick:h,render:()=>(0,d.jsx)(S.LazyTopbarMoreMenu,{blockStore:s,onClickOriginRect:c,handleAccept:e=>function(e,t,s){const{mainEditorCurrentBlockStore:n}=v.default.state;if(n){const t=n.getType();var i;if(t)m.dh(s,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"topbar_more_menu",block_id:n.id,block_type:t,is_toggleable:(0,y._A)(t,n.getFormat()),collection_id:null===(i=n.getCollectionViewSourceCollectionStore())||void 0===i?void 0:i.id,parent_collection_id:n.getParentCollectionIdUpToTwoLevels()})}e.closeParentMenu&&F(t)}(e,t,r),handleDismiss:()=>F(t)}),originGap:8,trapFocus:!0,forceInitialInbound:!0,style:l.isMobile?{}:{width:240,maxHeight:"80vh"}})]})};function P(e,t){const{device:s}=e,n=t?2:8,i=t?8:2;return s.isMobile?{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",paddingLeft:n,paddingRight:n,marginRight:i}:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:4}}function F(e){e.setState({...e.state,open:!1})}const A=n.forwardRef((function(e,t){let{buttonPopupEvents:s,shouldShowAddTo:n}=e;const l=(0,a.Fg)(),m=(0,i.O7)(),{device:g}=m,y=(0,o.VK)((()=>(n??!1)&&(0,f.kS)(m)),[n,m]);return(0,d.jsx)(C.ZP,{renderTooltip:()=>m.currentUser.isLoggedIn()?(0,d.jsx)(p.FormattedMessage,{defaultMessage:"Style, export, and more…",id:"topbarMoreButton.tooltip"}):(0,d.jsx)(p.FormattedMessage,{defaultMessage:"More…",id:"topbarMoreButton.loggedOut.tooltip"}),placement:C.ug.Bottom,delayThreshold:400,render:e=>(0,d.jsx)(M.Z,{ref:t,style:P(m,y),mobileFeedback:g.isMobile,className:h.mSZ,...(0,x.Z)(s,e),children:g.isMobile?y?c({width:20,fill:"dark"===l.mode?l.accentColors.gray[900]:l.accentColors.gray[400]}):(0,u.I)({width:26}):(0,r.o)({width:18,height:18,fill:l.regularIconColor})})})}))},1144:(e,t,s)=>{s.r(t),s.d(t,{TopbarMoreMenu:()=>jt});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(9291),l=(s(21703),s(13991)),d=s(15145),c=s(41432),u=s(83176),p=s(5336),m=s(90792),g=s(45238),h=s(85893);const f=(0,g.IU)("clockArrows",{viewBox:"0 0 18 15",svg:(0,h.jsx)("g",{children:(0,h.jsx)("path",{d:"M8.993.003c2.222 0 4.293 1.121 5.558 2.768.294.363.239.807-.075 1.026-.335.24-.732.137-1.005-.185a5.608 5.608 0 00-4.478-2.215 5.63 5.63 0 00-5.49 4.28h.978c.527 0 .664.403.376.793L3.203 8.773c-.225.315-.58.322-.813 0L.735 6.477c-.294-.404-.157-.8.376-.8h.964C2.731 2.457 5.603.003 8.993.003zM8.74 3.1c.328 0 .595.266.595.594v3.514l1.593 2.14c.212.294.191.656-.09.847-.293.212-.642.157-.888-.164L8.316 7.878a.767.767 0 01-.17-.465V3.694c0-.328.266-.594.594-.594zm.253 11.026c-2.215 0-4.286-1.114-5.55-2.769-.301-.362-.24-.8.075-1.025.335-.24.731-.137 1.004.185a5.61 5.61 0 004.471 2.221 5.66 5.66 0 005.503-4.279h-.984c-.527 0-.663-.41-.376-.8l1.654-2.304c.226-.314.581-.314.807 0l1.66 2.297c.288.404.158.807-.382.807h-.964c-.65 3.213-3.52 5.667-6.918 5.667z"})})});var x=s(77366),y=s(88437);const S=(0,g.IU)("exportArrow",{viewBox:"0 0 12 16",svg:(0,h.jsx)("g",{children:(0,h.jsx)("path",{d:"M11.291 7.613c0 .417-.3.732-.71.732a.772.772 0 01-.534-.219L8.495 6.595 6.69 4.578l.062 1.477v8.497c0 .444-.308.752-.752.752-.438 0-.745-.308-.745-.752V6.055l.055-1.47-1.805 2.01-1.552 1.531a.755.755 0 01-.526.219.708.708 0 01-.718-.732c0-.198.075-.376.232-.54l4.505-4.511a.774.774 0 01.492-.233H1.44a.717.717 0 01-.731-.738c0-.424.308-.738.731-.738h9.133c.417 0 .718.314.718.738 0 .417-.3.738-.718.738H6.068a.79.79 0 01.493.233l4.498 4.511a.758.758 0 01.232.54z"})})}),v=(0,g.IU)("graph",{viewBox:"0 0 16 14",svg:(0,h.jsx)("g",{children:(0,h.jsx)("path",{d:"M.521 12.977V1.288c0-.376.288-.677.67-.677.383 0 .67.301.67.677v5.893l2.482-1.436v-.061c0-.718.58-1.306 1.305-1.306.718 0 1.3.588 1.3 1.306 0 .068-.008.136-.014.205l1.415 1.203a1.3 1.3 0 01.601-.144 1.3 1.3 0 01.8.274l3.07-1.84a1.6 1.6 0 01-.028-.259 1.31 1.31 0 011.306-1.306 1.31 1.31 0 011.305 1.306 1.31 1.31 0 01-1.305 1.306c-.267 0-.52-.082-.725-.226l-3.13 1.873c.006.055.013.116.013.171 0 .725-.588 1.306-1.306 1.306a1.3 1.3 0 01-1.299-1.306c0-.15.028-.3.076-.437L6.44 6.716a1.286 1.286 0 01-1.682-.082L1.862 8.315v3.72c0 .143.048.19.192.19h12.749a.669.669 0 110 1.34H1.109c-.355 0-.588-.232-.588-.588z"})})});var b=s(7220),M=s(13495),j=s(27714),C=s(60651),w=s(18442),k=s(23867),T=s(31701),I=s(37810),Z=s(893),P=s(30188),F=s(79257),A=s(54532),_=s(61652),R=s(96802),O=s(94419),B=s(19785),D=s(9953),L=s(75754),V=s(8055),N=s(37834),E=s(13447),U=s(10906),W=s(93405),K=s(90403),z=s(72495),q=s(98742),G=s(64921),H=s(26388),Y=s(64369);function Q(e,t){let{id:s,caption:n,focused:o,isActive:r,onClick:l,onMouseDown:d,onMouseEnter:c,onMouseLeave:u,role:p,style:m,tooltip:g,ignoreLocalHoverState:f,disallowTabbing:x}=e;const y=(0,i.Fy)(),S=(0,a.yK)((()=>({optionItem:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:34,justifyContent:"flex-end"},button:{width:"100%",...y.isMobile?{padding:16,paddingTop:20,transition:"color 300ms, border 300ms",lineHeight:1}:{padding:6,paddingTop:10,borderRadius:4,transition:"color 300ms, border 300ms",lineHeight:1},justifyContent:"center",color:r?T.ZP.blue:"inherit"}})),[r,y]);return(0,h.jsx)(H.ZP,{renderTooltip:()=>g,placement:H.ug.Bottom,delayThreshold:80,render:e=>{const i=(0,q.Z)(e,{onMouseEnter:c,onMouseLeave:u}),{onMouseDown:a,...r}=i;return(0,h.jsx)(G.Z,{...r,id:s,role:p,ref:t,mobileFeedback:y.isMobile,onClick:l,onMouseDown:i.onMouseDown||d,hovered:o,style:S.button,ignoreLocalHoverState:f,disallowTabbing:x,className:"notranslate",children:(0,h.jsxs)("div",{style:S.optionItem,children:[(0,h.jsx)("div",{style:{...m,height:25},children:"Ag"}),(0,h.jsx)(Y.Z,{isSmall:!0,style:{marginTop:4},children:n})]})})}})}const $=n.forwardRef(Q);const J=function(e){const{children:t}=e,s=(0,i.O7)(),{mobileStyle:n,desktopStyle:o}=(0,a.yK)((e=>({mobileStyle:{display:"flex",justifyContent:"space-around",boxShadow:`0 1px 0 ${e.regularDividerColor}`,background:e.popoverBackground},desktopStyle:{display:"flex",justifyContent:"space-between",marginLeft:14,marginRight:14}})),[]);return(0,h.jsx)(z.Z,{...e,children:(0,h.jsx)("div",{style:s.device.isMobile?n:o,children:t})})};var X=s(29551),ee=s(74962),te=s(48603),se=s(95477),ne=s(27105),ie=s(19037),oe=s(97978),ae=s(28020),re=s(77181),le=s(21969),de=s(84210),ce=s(33929),ue=s(41984),pe=s(24764),me=s(82356),ge=s(74948),he=s(36896),fe=s(44604),xe=s(36391),ye=s(77556),Se=s(77080),ve=s(70681),be=s(30496),Me=s(92083),je=s(81023),Ce=s(54669),we=s(49386),ke=s(93685),Te=s(29768),Ie=s(62967),Ze=s(42784),Pe=s(2295),Fe=s(63923),Ae=s(5337),_e=s(36154);const Re=(0,r.defineMessages)({customizePageLabel:{id:"action.customizePage.label",defaultMessage:"Customize page"},exportName:{id:"action.export.name",defaultMessage:"Export"},exportCaption:{id:"action.export.caption",defaultMessage:"PDF, HTML, Markdown & CSV"},fontDefaultName:{id:"action.setPageFont.default.fuzzySearchKeywords",defaultMessage:"Font Default"},fontDefaultCaption:{id:"action.setPageFont.default.caption",defaultMessage:"Default"},fontDefaultTooltip:{id:"action.setPageFont.default.tooltip",defaultMessage:"The default sans-serif workhorse"},fontSerifName:{id:"action.setPageFont.serif.fuzzySearchKeywords",defaultMessage:"Font Serif"},fontSerifCaption:{id:"action.setPageFont.serif.caption",defaultMessage:"Serif"},fontSerifTooltip:{id:"action.setPageFont.serif.tooltip",defaultMessage:"Good for publishing"},fontMonoName:{id:"action.setPageFont.mono.fuzzySearchKeywords",defaultMessage:"Font Mono"},fontMonoCaption:{id:"action.setPageFont.mono.caption",defaultMessage:"Mono"},fontMonoTooltip:{id:"action.setPageFont.mono.tooltip",defaultMessage:"Good for drafting and notes"},fontComicName:{id:"action.setPageFont.comic.fuzzySearchKeywords",defaultMessage:"Font Comic"},fontComicCaption:{id:"action.setPageFont.comic.caption",defaultMessage:"Comic"},fontComicTooltip:{id:"action.setPageFont.comic.tooltip",defaultMessage:"Playful but cringe"},fontSmallTextKeywords:{id:"action.fontSmallText.fuzzySearchKeywords",defaultMessage:"Font Small Text"},fontSmallTextLabel:{id:"action.fontSmallText.label",defaultMessage:"Small text"},fontStyleSection:{id:"action.section.fontStyle",defaultMessage:"Style"},fullWidthLabel:{id:"action.fullWidth.label",defaultMessage:"Full width"},getNotifiedFor:{defaultMessage:"Get notified",id:"topbar.moreButton.getNotified"},importName:{id:"action.import.name",defaultMessage:"Import"},lockPageName:{id:"action.lockPage.name",defaultMessage:"Lock page"},floatingTableOfContents:{id:"action.floatingTableOfContents.name",defaultMessage:"Table of contents"},notifyMe:{id:"action.notifyMe.name",defaultMessage:"Notify me"},openAIAssistant:{id:"action.openMobileAIAssistant.name",defaultMessage:"Open AI Assistant"},openinMacAppName:{id:"action.openinMacApp.name",defaultMessage:"Open in Mac app"},openinWindowsAppName:{id:"action.openinWindowsApp.name",defaultMessage:"Open in Windows app"},openiniOSAppName:{id:"action.openiniOSApp.name",defaultMessage:"Open in iOS app"},openinAndroidAppName:{id:"action.openinAndroidApp.name",defaultMessage:"Open in Android app"},pageAnalyticsName:{id:"action.pageAnalytics.name",defaultMessage:"Page analytics"},pageHistoryName:{id:"action.pageHistory.name",defaultMessage:"View edit history"},pageUpdates:{id:"action.pageUpdates.title",defaultMessage:"Page updates"},privacySettingsName:{id:"action.privacySettings.name",defaultMessage:"Privacy settings"},showDeletedPagesName:{id:"action.showDeletedPages.name",defaultMessage:"Show deleted pages"},unlockPageName:{id:"action.unlockPageName.name",defaultMessage:"Unlock page"},viewAnalyticsName:{id:"action.viewAnalytics.name",defaultMessage:"View analytics"},openPageLayoutEditor:{id:"action.layoutEditor.open",defaultMessage:"Edit page layout"}});function Oe(e){return(0,Ie.cN)({key:`font ${e.font||"default"}`,displayName:e.displayName,analyticsName:e.displayName.defaultMessage,validators:[ie.or([ie.ffD(ie.YGm),ie.f7f]),ie.J5S,ie.ffD(ie.uY7),...e.extraValidators],render:(t,s)=>{const n=s.blocks[0].getFormat().page_font,i=e.font===n||!e.font&&!n;return(0,h.jsx)($,{...t,isActive:i,font:e.font,tooltip:e.tooltip,style:e.style,caption:e.caption})},closeParentMenu:!1,action:(t,s)=>{let{blocks:n,environment:i}=t;E.createAndCommit({userAction:"actionRegistry.createFontAction",environment:i,perform:t=>{R.FH({stores:n,update:{page_font:e.font},transaction:t}),function(e,t){oe.j(e,"change_font_type",t)}(i,{type:e.font||"default"})}})}})}const Be=Oe({displayName:Re.fontDefaultName,caption:(0,h.jsx)(r.FormattedMessage,{...Re.fontDefaultCaption}),font:void 0,tooltip:(0,h.jsx)(r.FormattedMessage,{...Re.fontDefaultTooltip}),style:{fontSize:24,fontFamily:I.Z.getCompositeFontFamily(l.SP).sans,position:"relative",top:-2},extraValidators:[]}),De=Oe({displayName:Re.fontSerifName,caption:(0,h.jsx)(r.FormattedMessage,{...Re.fontSerifCaption}),font:"serif",tooltip:(0,h.jsx)(r.FormattedMessage,{...Re.fontSerifTooltip}),style:{fontSize:25,fontFamily:I.Z.getCompositeFontFamily(l.SP).serif},extraValidators:[]}),Le=Oe({displayName:Re.fontMonoName,caption:(0,h.jsx)(r.FormattedMessage,{...Re.fontMonoCaption}),font:"mono",tooltip:(0,h.jsx)(r.FormattedMessage,{...Re.fontMonoTooltip}),style:{fontSize:26,fontFamily:I.Z.getCompositeFontFamily(l.SP).mono,position:"relative",top:-3,letterSpacing:-1},extraValidators:[]}),Ve=Oe({displayName:Re.fontComicName,caption:(0,h.jsx)(r.FormattedMessage,{...Re.fontComicCaption}),font:"comic",tooltip:(0,h.jsx)(r.FormattedMessage,{...Re.fontComicTooltip}),style:{fontSize:26,fontFamily:I.Z.getCompositeFontFamily(l.SP).comic,position:"relative",top:-3,letterSpacing:-1},extraValidators:[ie.or([ie.QLY("comic_sans"),e=>e.blocks.some((e=>"comic"===e.getFormatStore().getKeyStore("page_font").getValue()))])]}),Ne=(0,Ie.$J)({key:"font section",title:void 0,render:e=>(0,h.jsx)(J,{...e}),actions:[Be,De,Le,Ve]}),Ee=(0,Ie.N$)({key:"small text",displayName:Re.fontSmallTextKeywords,label:ce.default.formatMessage(Re.fontSmallTextLabel),isEnabled:e=>Boolean(e.getFormat().page_small_text),validators:[ie.ffD(ie.tqC),ie.or([ie.ffD(ie.YGm),ie.f7f]),ie.J5S,ie.ffD(ie.uY7)],action:(e,t,s)=>R.FH({stores:[t],update:{page_small_text:!t.getFormat().page_small_text},transaction:s}),afterAction:(e,t)=>{oe.j(t,"change_font_size",{type:e?"small":"large"})}}),Ue=(0,Ie.N$)({key:"full width",displayName:Re.fullWidthLabel,label:ce.default.formatMessage(Re.fullWidthLabel),isEnabled:e=>e.isFullWidth(),validators:[ie.ffD(ie.Mnk),ie.ffD(ie.YGm),ie.J5S,ie.ffD(ie.uY7)],action:(e,t,s)=>R.FH({stores:[t],update:{page_full_width:!t.isFullWidth()},transaction:s}),afterAction:(e,t)=>{oe.j(t,"change_page_width",{type:e?"full_width":"default_width"})}}),We=(0,Ie.N$)({key:"page lock",displayName:Re.lockPageName,label:ce.default.formatMessage(Re.lockPageName),isEnabled:e=>e.isLocked(),validators:[ie.ffD(ie.YGm),ie.J5S,ie.ffD(ie.uY7)],action:(e,t,s)=>D.sW({store:t.getFormatStore(),data:{block_locked:!t.isLocked(),block_locked_by:e.currentUser.id},transaction:s}),afterAction:()=>null}),Ke=[ie.ffD(ie.YGm),ie.J5S,ie.ffD(ie.uY7),ie.QLY("floating_table_of_contents")],ze=(0,r.defineMessages)({minimal:{id:"actionRegistry.floatingTableOfContents.displayOption.minimal",defaultMessage:"Minimal"},expanded:{id:"actionRegistry.floatingTableOfContents.displayOption.expanded",defaultMessage:"Expanded"},off:{id:"actionRegistry.floatingTableOfContents.displayOption.off",defaultMessage:"Off"}});function qe(e){return(0,Ie.cN)({key:`floating table of contents ${e}`,displayName:ze[e],analyticsName:ze[e].defaultMessage,validators:Ke,closeParentMenu:!0,action:t=>{const s=t.blocks[0];s&&E.createAndCommit({userAction:`actionRegistry.setTableOfContentsState.${e}`,environment:t.environment,perform:t=>{D.sW({store:s.getFormatStore(),data:{page_floating_table_of_contents:{state:e}},transaction:t})}})}})}const Ge=[qe("minimal"),qe("expanded"),qe("off")];function He(e,t){var s;const n=(0,T.gh)({theme:e.ThemeModeStore.state});return(0,Ie.MV)({key:"floating table of contents",displayName:Re.floatingTableOfContents,validators:Ke,analyticsName:Re.floatingTableOfContents.defaultMessage,right:(0,h.jsx)(h.Fragment,{children:ce.default.formatMessage(ze[(null===(s=t.getModel())||void 0===s?void 0:s.getFloatingTableOfContentsState())||"off"])}),rightStyle:{color:n.lightTextColor,marginRight:5},subActions:()=>[(0,Ie.$J)({key:"floating table of contents actions",render:e=>(0,h.jsx)(z.Z,{...e}),actions:Ge})]})}function Ye(e,t){return(0,Ie.$J)({key:"page style",render:e=>(0,h.jsx)(z.Z,{...e}),actions:[Ee,Ue,We,we.cO,we.Bj,we.fK,He(e,t)]})}const Qe=(0,Ie.cN)({key:"customize page",displayName:Re.customizePageLabel,analyticsName:Re.customizePageLabel.defaultMessage,svg:x.F,validators:[ie.U_8,ie.ffD(ie.YGm),ie.ffD(ie.uY7)],closeParentMenu:!0,render:e=>(0,h.jsx)(W.Z,{...e,title:(0,h.jsx)(r.FormattedMessage,{...Re.customizePageLabel}),svg:x.F}),action:e=>{F.bA({originRect:e.originRect})}}),$e=(0,Ie.cs)({key:"copy link to block non-desktop",displayName:Ie.RE.copyLinkNavigableTypeName,analyticsName:Ie.RE.copyLinkNavigableTypeName.defaultMessage,svg:j.N,shortcuts:["copyCurrentPageLinkifiedBlockTitle"],validators:[ie.jlf,ie.U7o,ie.ffD(ie.daU),ie.ffD(ie.uY7)],closeParentMenu:!0,action:(e,t)=>{Z.Hs({...e,event:t})}}),Je=(0,Ie.cs)({key:"duplicate",displayName:Ie.RE.duplicateName,analyticsName:Ie.RE.duplicateName.defaultMessage,svg:y.a,validators:[ie.DFt,ie.J5S,ie.KEd,ie.xks,ie.ffD(ie.P99(c.Ti.externalObjectInstancePage)),ie.ffD(ie.uY7),ie.ffD(ie.EYw),ie.NZn],shortcuts:["duplicate"],closeParentMenu:!0,action:async(e,t)=>{let{environment:s}=e;const n=ae.np();if(!n)return;const i=n.getAssociatedCollectionStore();if(i&&je.M_(s)){const e=new ye.Z(s);e.setContext({type:"collectionPage",collectionViewBlockStore:void 0,collectionStore:i});Se.default.checkGate("collection_subitem_nested_operations")&&(0,re.vJ)(n,e)?await P.h5({environment:s,blocks:[n],collectionContextStore:e,useCrdt:(0,ne.Sy)({event:t,contextualDefault:n.useCrdt()})}):E.createAndCommit({userAction:"actionRegistry.duplicateToCollection",environment:s,perform:e=>{const[o,a]=A.Qi({environment:s,stores:[n],addCopyName:(0,ue.Z)(n),transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!n.isInsideTemplate(),targetSpaceId:(0,k.C)(i.pointer.spaceId),baseUrl:se.default.domainBaseUrl,publicDomainName:se.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:(0,ne.Sy)({event:t,contextualDefault:n.useCrdt()})}),r=o[0];B.zw({childStore:r,parentStore:i,transaction:e}),n.isTemplate()&&O.R3({parent:i.getTemplatePagesStore(),append:r,transaction:e}),L._c({environment:s,store:r,pageVisitSource:d.tY.Duplicate})}})}}}),Xe=(0,Ie.cN)({key:"open in mac app",displayName:Re.openinMacAppName,analyticsName:Re.openinMacAppName.defaultMessage,svg:C.h,validators:[ie.U7o,ie.ffD(ie.tYA),ie.ffD(ie.tqC),ie.V5r],closeParentMenu:!0,action:(e,t)=>{let{blocks:s,environment:n}=e;const i=(0,de.ZP)({store:s[0],fullyQualified:!1,pageVisitSource:d.tY.AppRedirect});V.RX({url:(0,le.W)(i),environment:n})}}),et=(0,Ie.cN)({key:"open in windows app",displayName:Re.openinWindowsAppName,analyticsName:Re.openinWindowsAppName.defaultMessage,svg:C.h,validators:[ie.U7o,ie.ffD(ie.tYA),ie.ffD(ie.tqC),ie.EDF],closeParentMenu:!0,action:(e,t)=>{let{blocks:s,environment:n}=e;const i=(0,de.ZP)({store:s[0],fullyQualified:!1,pageVisitSource:d.tY.AppRedirect});V.RX({url:(0,le.W)(i),environment:n})}}),tt=(0,Ie.cN)({key:"open in ios app",displayName:Re.openiniOSAppName,analyticsName:Re.openiniOSAppName.defaultMessage,svg:C.h,validators:[ie.U7o,ie.ffD(ie.tYA),ie.gnQ],closeParentMenu:!0,action:(e,t)=>{let{blocks:s,environment:n}=e;const i=(0,de.ZP)({store:s[0],fullyQualified:!1,pageVisitSource:d.tY.AppRedirect});V.RX({url:i,environment:n})}}),st=(0,Ie.cN)({key:"open in android app",displayName:Re.openinAndroidAppName,analyticsName:Re.openinAndroidAppName.defaultMessage,svg:C.h,validators:[ie.U7o,ie.ffD(ie.tYA),ie.DtP],closeParentMenu:!0,action:(e,t)=>{let{blocks:s,environment:n}=e;const i=(0,de.ZP)({store:s[0],fullyQualified:!1,pageVisitSource:d.tY.AppRedirect});V.RX({url:i,environment:n})}}),nt=(0,Ie.cN)({key:"open page updates",analyticsName:"Open page updates",displayName:Re.pageUpdates,svg:m.t,validators:[ie.RFc,ie.tqC],closeParentMenu:!0,action:()=>{be.Z.setState({open:!0})}}),it=(0,Ie.cN)({key:"action page history",displayName:Re.pageHistoryName,analyticsName:Re.pageHistoryName.defaultMessage,svg:p.r,validators:[ie.or([ie._Tt,ie.k5s]),ie.Ggh,ie.DFt,ie.jlf,ie.ffD(ie.YO6)],closeParentMenu:!0,action:e=>{let{environment:t,blocks:s}=e;return N.jN({environment:t,blockStore:s[0],from:"topbar"})},render:(e,t)=>{let{onClick:s,key:n,...i}=e,{environment:o}=t;return(0,h.jsx)(Ce.Z,{requireUpgradeToTier:!1,analyticsName:"history_modal",onClick:s,alwaysAllowClick:!0,render:(e,t)=>(0,h.jsx)(W.Z,{...(0,q.Z)(i,e),title:ce.default.formatMessage(Re.pageHistoryName),svg:p.r,dontShrinkRight:!0,right:t}),renderUpgradeTooltip:()=>{}},n)}}),ot=(0,Ie.cN)({key:"open page trash",displayName:Re.showDeletedPagesName,analyticsName:Re.showDeletedPagesName.defaultMessage,svg:f,validators:[ie.DFt,ie.J5S,ie.OOv,ie.jlf,ie.ffD(ie.nJQ),ie.ffD(ie.uY7)],closeParentMenu:!0,action:()=>{he.Z.setState({open:!0}),fe.Z.setState({...fe.Z.state,currentTab:"in_current_page"})}}),at=((0,Ie.MV)({key:"page analytics menu",displayName:Re.pageAnalyticsName,analyticsName:Re.pageAnalyticsName.defaultMessage,validators:[ie.DFt],svg:u.z,subActions:e=>[{key:"view analytics",render:e=>(0,h.jsx)(z.Z,{...e}),actions:[(0,Ie.cN)({key:"view analytics",displayName:Re.viewAnalyticsName,analyticsName:Re.viewAnalyticsName.defaultMessage,svg:u.z,validators:[ie.cFU],closeParentMenu:!0,action:()=>{ge.handleSidebarButtonClick(e.environment,e.blocks[0],xe.gY.Updates,"more_menu"),xe.ZP.setState({...xe.ZP.state,currentSubTab:xe.uF.Analytics})}}),(0,Ie.cN)({key:"privacy settings",displayName:Re.privacySettingsName,analyticsName:Re.privacySettingsName.defaultMessage,svg:w.H,validators:[],closeParentMenu:!0,action:e=>{te.TopbarPageAnalyticsOptOutMenuStore.setState({isOpen:!0,rect:e.originRect})}})]}]}),(0,Ie.cN)({key:"view analytics",displayName:Re.viewAnalyticsName,analyticsName:Re.viewAnalyticsName.defaultMessage,svg:v,validators:[ie.cFU],closeParentMenu:!0,action:e=>{ge.handleSidebarButtonClick(e.environment,e.blocks[0],xe.gY.Updates,"more_menu"),xe.ZP.setState({...xe.ZP.state,currentSubTab:xe.uF.Analytics})}}));function rt(e,t){var s;const n=(0,T.gh)({theme:e.ThemeModeStore.state});return(0,Ie.$J)({key:"editorActions",render:e=>(0,h.jsx)(z.Z,{...e}),actions:[_e.Yw,nt,it,ot,at,(0,Ie.MV)({key:"notifications",displayName:Re.notifyMe,analyticsName:Re.notifyMe.defaultMessage,svg:m.t,right:(0,h.jsx)(h.Fragment,{children:null===(s=t.find((e=>e.isSelectedOption)))||void 0===s?void 0:s.action.displayName}),rightStyle:{color:n.lightTextColor,marginRight:5},width:300,initialFocus:t.findIndex((e=>e.isSelectedOption))??0,validators:[ie.ffD(ie.uY7)],subActions:()=>[(0,Ie.$J)({key:"notifications",render:e=>(0,h.jsx)(z.Z,{...e}),actions:t.map((e=>{let{action:t}=e;return t}))})]})]})}const lt=(0,Ie.cN)({key:"open import modal",displayName:Re.importName,analyticsName:Re.importName.defaultMessage,svg:b.l,validators:[ie.Ggh,ie.YZb,ie.J5S,ie.ffD(ie.P99(c.Ti.externalObjectInstancePage)),ie.ffD(ie.uY7)],closeParentMenu:!0,action:e=>{let{blocks:t}=e,s=!1;if(1===t.length){const[e]=t;s=e.isCollectionView()}s?ve.Z.setState({open:!0}):Me.Z.setState({...Me.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0,openedFrom:"topbar"})}}),dt=(0,Ie.cN)({key:"export block",displayName:Re.exportName,analyticsName:Re.exportName.defaultMessage,validators:[ie.Ggh,ie.jlf,ie.KbU],closeParentMenu:!0,render:e=>(0,h.jsx)(W.Z,{...e,svg:S,title:(0,h.jsx)(r.FormattedMessage,{...Re.exportName}),tooltipText:(0,h.jsx)(r.FormattedMessage,{...Re.exportCaption})}),action:e=>{let{blocks:t,environment:s}=e;const n=t[0];if(!n.isDefined())return;let i=!0;const o=(0,U.fm)(t[0]);if(o){const e=null==o?void 0:o.collectionStore();null!=e&&e.isPageTreeCollection()&&(i=!1)}_.q$({environment:s,root:{id:n.id,table:"block",spaceId:n.getSpaceId()},isCollectionViewExportTypeSupported:i})}}),ct=(0,Ie.cN)({key:"open page layout editor",displayName:Re.openPageLayoutEditor,analyticsName:Re.openPageLayoutEditor.defaultMessage,validators:[ie.iBZ],closeParentMenu:!0,render:e=>(0,h.jsx)(W.Z,{...e,svg:M.M,title:(0,h.jsxs)(X.gq,{children:[(0,h.jsx)(r.FormattedMessage,{...Re.openPageLayoutEditor}),(0,h.jsx)(K.Z,{content:"Dev"})]})}),action:e=>{let{environment:t,blocks:s}=e,n=null;for(const i of s){const e=i.getAssociatedCollectionStore();if(e&&!e.isPageTreeCollection()){n=e;break}}if(!n)throw new Error("Could not edit page layout: Could not find collection");me.IR({environment:t,collectionStore:n})}});var ut=s(60709),pt=s(18514),mt=s(13713),gt=s(48019),ht=s(78140),ft=s(28992),xt=s(40721),yt=s(83182),St=s(939),vt=s.n(St),bt=s(49427);function Mt(e){const t=(0,n.useMemo)((()=>function(e){const t=bt.Z.find((t=>t.props.store===e));if(t){const e=t.getContentWrapEl();if(e)return vt()(e.innerText)}return 0}(e.store)),[e.store]);return(0,h.jsx)(h.Fragment,{children:t})}function jt(e){const{blockStore:t,onClickOriginRect:s,handleAccept:n,handleDismiss:l}=e,d=(0,i.O7)(),c=(0,i.Fy)(),u=(0,o.VK)((()=>({environment:d,blocks:[t],originRect:s,publicEditMode:void 0})),[d,t,s]),p=(0,o.VK)((()=>function(e){const{environment:t,context:s}=e,n=s.blocks[0],i=n.getFollowSettingsKey(),o=pe.Z({followSettingsKey:i,environment:t,blockStore:n,from:"more_menu"});return[Ne,Ye(t,n),Ze.ww,(0,Ie.$J)({key:"topbar dictate action",render:e=>(0,h.jsx)(z.Z,{...e}),actions:[ke.g]}),(0,Ie.$J)({key:"topbar page customization",render:e=>(0,h.jsx)(z.Z,{...e}),actions:[Qe,Ae.bV,Ae.R$]}),(0,Ie.$J)({key:"topbar primary actions",render:e=>(0,h.jsx)(z.Z,{...e}),actions:[we.q6,Fe.hS,_e.aU,$e,Je,Te.m7,Te.nh,Te.fI,Te.MI,Pe.A,Fe.Op]}),rt(t,o),(0,Ie.$J)({key:"topbar import actions",render:e=>(0,h.jsx)(z.Z,{...e}),actions:[lt,we.mS,dt]}),(0,Ie.$J)({key:"topbar view options",render:e=>(0,h.jsx)(z.Z,{...e}),actions:[Xe,et,tt,st]}),(0,ee.Z)(s),...Se.default.checkGate("page_layouts")?[(0,Ie.$J)({key:"topbar layout editor actions",render:e=>(0,h.jsx)(z.Z,{...e}),actions:[ct]})]:[]]}({environment:d,context:u})),[d,u]),m=(0,o.VK)((()=>!t.isCollectionView()&&t.canEdit()&&t.hasContent()),[t]),g=(0,o.VK)((()=>t.canEdit()),[t]),f=(0,o.VK)((()=>t.canEdit()&&t.isCollectionView()),[t]),x=(0,a.yK)((e=>({caption:{color:e.lightTextColor}})),[]),y=c.isMobile?{menuType:ut.og.Modal,title:(0,h.jsx)(r.FormattedMessage,{defaultMessage:"Actions",id:"topbarMoreButton.mobileActionsMenu.title"}),right:(0,h.jsx)(xt.DoneMenuText,{}),onClickRight:l}:{menuType:ut.og.Popup,maxHeight:"80vh"};return(0,h.jsxs)(ht.Z,{...y,children:[(0,h.jsx)(gt.Z,{sections:p,onAccept:n,context:u}),(m||g)&&(0,h.jsxs)(z.Z,{topBorder:!0,children:[m&&(0,h.jsx)(ft.Z,{caption:(0,h.jsx)("span",{style:x.caption,children:(0,h.jsx)(r.FormattedMessage,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:(0,h.jsx)(Mt,{store:t})}})})}),g&&(0,h.jsx)("div",{style:{paddingBottom:m?6:0},children:(0,h.jsx)(mt.Z,{store:t,isPageMoreButton:!0})})]}),f&&(0,h.jsx)(Ct,{})]})}function Ct(){return(0,h.jsx)(z.Z,{topBorder:!0,children:(0,h.jsx)(yt.Z,{title:(0,h.jsx)(r.FormattedMessage,{defaultMessage:"Learn about databases",id:"topbar.moreButton.collectionHelpButton"}),href:(0,pt.UY)("guides.database"),analyticsFrom:"topbar_more_button"})})}},48603:(e,t,s)=>{s.r(t),s.d(t,{PageAnalyticsPageOptOut:()=>x,TopbarPageAnalyticsOptOutMenu:()=>f,TopbarPageAnalyticsOptOutMenuStore:()=>h});s(67294);var n=s(480),i=s(86628),o=s(49085),a=s(9291),r=s(10259),l=s(18514),d=s(80444),c=s(73420),u=s(53437),p=s(42402),m=s(55422),g=s(85893);const h=o.default.createValue({isOpen:!1,rect:void 0});function f(){const e=(0,n.O7)(),t=(0,i.VK)((()=>h.state.isOpen),[]),s=(0,i.VK)((()=>h.state.rect),[]),o=(0,i.VK)((()=>d.default.state.mainEditorCurrentBlockStore),[]);return o?(0,g.jsx)(u.ZP,{popupType:e.device.isMobile?u.ZP.PopupType.SlideUp:u.ZP.PopupType.Popup,alignmentToOrigin:u.ZP.Alignment.Center,open:t,render:()=>(0,g.jsx)("div",{style:{minWidth:360,padding:16},children:(0,g.jsxs)(c.sg,{gap:16,children:[(0,g.jsx)("div",{style:{fontSize:16,fontWeight:500},children:(0,g.jsx)(a.FormattedMessage,{id:"TopbarPageAnalyticsOptOutMenu.heading",defaultMessage:"Privacy settings"})}),(0,g.jsx)(x,{store:o})]})}),originRect:s,onDismiss:()=>h.setState({isOpen:!1,rect:void 0})}):null}function x(e){const t=(0,n.O7)(),s=(0,i.VK)((()=>{const e=d.default.state.currentSpaceViewStore;return null==e?void 0:e.getSettings()}),[]),o=(0,i.VK)((()=>{const t=null==s?void 0:s.page_analytics_opt_out_list;return null==t?void 0:t.includes(e.store.id)}),[s,e.store.id]);return(0,g.jsx)(m.Z,{type:"dropdown",currentOption:o?"do_not_record":"record",options:[{key:"record",label:(0,g.jsx)(a.FormattedMessage,{id:"page_analytics.opt_out.record",defaultMessage:"Record"})},{key:"do_not_record",label:(0,g.jsx)(a.FormattedMessage,{id:"page_analytics.opt_out.do_not_record",defaultMessage:"Don't record"})}],onSelectOption:s=>{"do_not_record"===s?r.kY(t,e.store.id):r.pu(t,e.store.id)},isMobile:t.device.isMobile,title:(0,g.jsx)(a.FormattedMessage,{id:"page_analytics.opt_out.title",defaultMessage:"My view history"}),caption:(0,g.jsx)(a.FormattedMessage,{id:"page_analytics.opt_out.caption",defaultMessage:"Page editors can see my view history for this page. <inlinelink>Learn more</inlinelink>.",values:{inlinelink:e=>(0,g.jsx)(p.Z,{external:!0,href:(0,l.UY)("guides.pageAnalytics"),children:e})}}),captionStyle:{maxWidth:270}})}},50034:(e,t,s)=>{s.r(t),s.d(t,{default:()=>W});var n=s(67294),i=s(83355),o=s(15769),a=s(43876),r=s(45238),l=s(85893);const d=(0,r.IU)("mobileQuickCaptureShare",{viewBox:"0 0 17 17",svg:(0,l.jsx)("path",{d:"M3.05566 15.8516C2.29915 15.8516 1.72266 15.6556 1.32617 15.2637C0.934245 14.8763 0.738281 14.3066 0.738281 13.5547V6.89648C0.738281 6.14453 0.934245 5.57487 1.32617 5.1875C1.72266 4.79557 2.29915 4.59961 3.05566 4.59961H4.9834V6.12402H3.17871C2.87793 6.12402 2.64779 6.2015 2.48828 6.35645C2.33333 6.50684 2.25586 6.73926 2.25586 7.05371V13.3975C2.25586 13.7119 2.33333 13.9466 2.48828 14.1016C2.64779 14.2565 2.87793 14.334 3.17871 14.334H10.8145C11.1107 14.334 11.3385 14.2565 11.498 14.1016C11.6576 13.9466 11.7373 13.7119 11.7373 13.3975V7.05371C11.7373 6.73926 11.6576 6.50684 11.498 6.35645C11.3385 6.2015 11.1107 6.12402 10.8145 6.12402H9.0166V4.59961H10.9443C11.7008 4.59961 12.2751 4.79557 12.667 5.1875C13.0635 5.57943 13.2617 6.14909 13.2617 6.89648V13.5547C13.2617 14.3021 13.0635 14.8717 12.667 15.2637C12.2751 15.6556 11.7008 15.8516 10.9443 15.8516H3.05566ZM6.99316 10.335C6.80176 10.335 6.6377 10.2666 6.50098 10.1299C6.36426 9.99316 6.2959 9.83138 6.2959 9.64453V2.84961L6.35742 1.84473L5.96094 2.35742L5.05859 3.32129C4.93555 3.45345 4.7806 3.51953 4.59375 3.51953C4.42513 3.51953 4.2793 3.46484 4.15625 3.35547C4.03776 3.24154 3.97852 3.09798 3.97852 2.9248C3.97852 2.7653 4.04232 2.61947 4.16992 2.4873L6.45312 0.292969C6.54883 0.201823 6.63997 0.140299 6.72656 0.108398C6.81315 0.0719401 6.90202 0.0537109 6.99316 0.0537109C7.08887 0.0537109 7.18001 0.0719401 7.2666 0.108398C7.35775 0.140299 7.44889 0.201823 7.54004 0.292969L9.82324 2.4873C9.95085 2.61947 10.0146 2.7653 10.0146 2.9248C10.0146 3.09798 9.95312 3.24154 9.83008 3.35547C9.70703 3.46484 9.56348 3.51953 9.39941 3.51953C9.21712 3.51953 9.06445 3.45345 8.94141 3.32129L8.03223 2.35742L7.64258 1.84473L7.69727 2.84961V9.64453C7.69727 9.83138 7.62891 9.99316 7.49219 10.1299C7.36003 10.2666 7.19368 10.335 6.99316 10.335Z"})});var c=s(9291),u=s(19584),p=s(24677),m=s(28040),g=s(37181),h=s(43250),f=s(4708),x=s(98742),y=s(45101),S=s(77907),v=s(57345),b=s(4023),M=s(80444),j=s(77080),C=s(55899),w=s(8675),k=s(52878),T=s(81023),I=s(88893),Z=s(88280),P=s(31945),F=s(58261),A=s(89728),_=s(53437),R=s(26388),O=s(24405),B=s(13148),D=s(31701),L=s(23063),V=s(73063),N=s(28451);function E(e){const{visible:t,onDismiss:s}=e,n=(0,O.yK)((e=>({overlayContainer:{position:"relative",width:240,height:140,paddingTop:0,paddingBottom:20,paddingLeft:20,paddingRight:20},container:{fontSize:12,color:D.ZP.white,position:"absolute",top:13,background:D.ZP.blue,borderRadius:6,padding:"8px 12px 12px 12px",width:200,boxShadow:e.largeLightBoxShadow,zIndex:9999},circle:{position:"absolute",top:-12,left:"calc(50% - 2.5px)",background:D.ZP.blue,width:5,height:5,borderRadius:5,boxShadow:`0 0 0 1.5px ${e.contentBackground}`},verticalLine:{position:"absolute",top:-12,left:"calc(50% - 1px)",background:D.ZP.blue,width:2,height:12},textContainer:{width:"90%",fontWeight:500},iconButton:{position:"absolute",top:4,right:4,opacity:.8},iconStyle:{width:12,fill:D.ZP.white}})),[]);return(0,l.jsx)("div",{style:n.overlayContainer,children:(0,l.jsx)(L.Z,{isVisible:t,animationStyle:{opacity:1},enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},render:function(){return(0,l.jsx)(N.P,{calloutId:"share_button_tooltip",children:(0,l.jsxs)("div",{style:n.container,children:[(0,l.jsx)("div",{style:n.circle}),(0,l.jsx)("div",{style:n.verticalLine}),(0,l.jsx)("div",{style:n.textContainer,children:(0,l.jsx)(c.FormattedMessage,{defaultMessage:"You can share your content with your teammates here",id:"shareButtonIntroTooltip.title"})}),(0,l.jsx)(V.Z,{icon:B.U,style:n.iconButton,iconStyle:n.iconStyle,onClick:()=>s()})]})})}})})}class U extends i.Z{constructor(){super(...arguments),this.storeTypes={universalMemberInviteStore:k.Z,sudoModeStore:w.Z,inviteTargetsStore:C.ZP},this.showShareButtonTooltip=this.createComputedStore((()=>function(e){const{currentUserSettingsStore:t,mainEditorCurrentBlockStore:s,inAppCalloutStore:n}=M.default.state;if(null!=s&&s.isTypedCollectionViewBlock())return!1;if(!t)return!1;if(t.id!==e.currentUser.id)return!1;const i=t.getKeyStore("settings").getKeyStore("seen_share_button_tooltip_at").getValue();if(Boolean(i))return!1;const o=t.getKeyStore("settings").getKeyStore("signup_time").getValue();if(!o)return!1;if(!n.canShow("share_button_tooltip"))return!1;const a=Date.now()-o;if(a<=30*u.A0){switch(j.default.getEligibleGroup({experimentId:"intro_share_tooltip_condition",defaultGroup:"control"})){case"b200":const t=Z.subscriptionDataStoreInstance.state;if(t){return(0,I.Lz)(e,t)>=200}return!1;case"d3":return a>=3*u.A0;case"control":return a>=10*u.A0}}return!1}(this.environment))),this.buttonPopupStyle=this.createComputedStore((()=>{const{device:e}=this.environment;return e.isMobile?{width:460}:{width:500,overflow:"hidden"}})),this.shareButtonStyle=this.createComputedStore((()=>{const{device:e}=this.environment;return e.isMobile?{display:"flex",alignItems:"center",height:"100%",paddingLeft:8,paddingRight:8}:{marginRight:2,marginLeft:12}})),this.shareButtonRef=n.createRef(),this.renderShareButtonOrigin=e=>{const{device:t}=this.environment;return(0,l.jsx)(R.ZP,{disableTooltip:t.isMobile,renderTooltip:()=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{children:(0,l.jsx)(c.FormattedMessage,{defaultMessage:"Share or publish to the web",id:"topbar.shareButton.tooltip"})}),(0,l.jsx)(F.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"openShareMenu"})]}),placement:b.u.Bottom,delayThreshold:400,render:t=>this.renderShareButton((0,x.Z)(e,t))})},this.renderShareButton=e=>{const{device:t}=this.environment,s=this.showShareButtonTooltip.state,n=(()=>t.isMobile?this.props.shouldShowAddTo&&(0,f.kS)(this.environment)?d({width:20,fill:"dark"===this.theme.mode?this.theme.accentColors.gray[900]:this.theme.accentColors.gray[400]}):t.isAndroid?(0,o.Q)({width:16,height:16}):(0,a.s)({width:26}):(0,l.jsx)(c.FormattedMessage,{defaultMessage:"Share",id:"topbar.shareButton.title"}))(),i=(0,l.jsx)("div",{ref:this.shareButtonRef,children:(0,l.jsx)(A.Z,{className:h.MD7,...(0,x.Z)(e,{onClick:s?()=>g.Qm(this.environment):()=>{}}),mobileFeedback:t.isMobile,style:this.shareButtonStyle.state,children:n})});return s?(0,l.jsx)(_.ZP,{popupType:_.kQ.Popup,open:!0,origin:i,placementToOrigin:b.u.Bottom,alignmentToOrigin:_.ZP.Alignment.Center,preventScaleTransition:!0,preventOpacityTransition:!0,viewportPadding:4,preventCaptureEsc:!0,preventPointerEvents:!1,disableMouseCapture:!0,render:()=>this.showShareButtonTooltip.state?(0,l.jsx)(E,{visible:this.showShareButtonTooltip.state,onDismiss:()=>g.Qm(this.environment)}):null,style:{boxShadow:"none",backgroundColor:"rgba(0, 0, 0, 0)"}}):i},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleClick=()=>{return e=this.environment,t=this.props.buttonPopupStore,s=this.stores.universalMemberInviteStore,n=this.stores.inviteTargetsStore,z(t,s,n),p.ZH(e),v.lG(e),void T.bi(e);var e,t,s,n},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleClose=()=>async function(e,t,s,n){if(n.state.inviteTargets.length>0){return void(await v.zd({environment:e,inviteTargetsStore:n})&&(v.a6(e),z(t,s,n)))}const{permissionsInviteStore:i}=s.state;"invitee"===i.state.inputFocus&&i.setState({...i.state,inputFocus:"none"});await(0,y.Aw)({environment:e,permissionsInviteStoreState:i.state,from:"share_menu"})||(v.a6(e),z(t,s,n))}(this.environment,this.props.buttonPopupStore,this.stores.universalMemberInviteStore,this.stores.inviteTargetsStore)}didMountOrUpdate(){this.props.store.canAdmin()?this.stores.sudoModeStore.reset():m.i({environment:this.environment,sudoModeStore:this.stores.sudoModeStore,pageBlockId:this.props.store.id})}renderComponent(){const{device:e}=this.environment;return(0,l.jsx)(P.ZP,{popupType:e.isMobile?P.Z4.SlideUp:P.Z4.Popup,forceInitialInbound:!0,buttonPopupStore:this.props.buttonPopupStore,renderOrigin:this.renderShareButtonOrigin,originGap:e.isMobile?void 0:8,style:this.buttonPopupStyle.state,onClick:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleClick,render:()=>(0,l.jsx)(S.LazyShareMenuContainer,{buttonPopupStore:this.props.buttonPopupStore,sudoModeStore:this.stores.sudoModeStore,store:K(this.props.store,this.stores.sudoModeStore),inviteTargetsStore:this.stores.inviteTargetsStore,onUpgradeButtonClick:()=>{this.props.buttonPopupStore.reset()},location:e.isMobile?"topbar_mobile":"topbar_share_button",onClose:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleClose}),persistOnClose:!e.isMobile&&q(this.stores.universalMemberInviteStore,this.stores.inviteTargetsStore),onDismiss:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleClose,onClose:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleClose})}}U.displayName="TopbarShareButton";const W=U;function K(e,t){return t.shouldUserHaveAccessToPrivatePageBlock()&&t.state.changePermissionsEnabled&&t.state.privatePageStore?t.state.privatePageStore:e}function z(e,t,s){e.reset(),t.reset(),s.reset()}function q(e,t){const{permissionsInviteStore:s}=e.state;return s.state.inviteTargets.length>0||t.state.inviteTargets.length>0}},71424:(e,t,s)=>{s.d(t,{EZ:()=>i,FD:()=>o,G5:()=>n,rK:()=>a});const n=220,i=24,o=-7,a=-3},68750:(e,t,s)=>{s.d(t,{O:()=>L});var n=s(67294),i=s(480),o=s(24405),a=s(53877),r=s(42875),l=s(19889),d=s(4308),c=s(97978),u=s(60709),p=s(77080),m=s(78140),g=s(40721),h=s(13148),f=s(9291),x=s(52275),y=s(72495),S=s(85893);function v(e){const{onClick:t}=e;return(0,S.jsx)(y.Z,{topBorder:!0,children:(0,S.jsx)(x.Z,{focused:!1,icon:(0,h.U)({width:14,marginLeft:0}),title:(0,S.jsx)(f.FormattedMessage,{defaultMessage:"Remove verification",id:"VerificationPropertyOverlayMenu.removeVerificationButton"}),onClick:t,style:{fontSize:14}})})}var b=s(30120),M=s(86628),j=s(28020),C=s(33929),w=s(66653),k=s(93289);const T=(0,f.defineMessages)({placeholder:{id:"VerificationExpiryMenu.pickSpecificDate.placeholder",defaultMessage:"Pick a date"}});function I(e){const{onChange:t,clearCustomDatePicker:s}=e,i=(0,n.useRef)(e.today),o=(0,n.useRef)(e.today.plus({days:1})),[r,l]=(0,n.useState)(!1),d=(0,M.VK)((()=>j.AK.state),[]);return(0,S.jsxs)(y.Z,{mobileStyle:{paddingBottom:10},style:{padding:"12px 0"},children:[(0,S.jsx)(w.Z,{placeholder:C.default.formatMessage(T.placeholder),focused:r,value:"verified"!==e.verificationState.type||e.verificationState.isIndefinite?void 0:a.ME(e.verificationState.dateTimeRange.end),onUpdate:e=>{if(e.error)return;const n=e.value&&a.XI(e.value);n?t({start:i.current,end:n.start}):s()},onFocus:()=>l(!0),onBlur:()=>l(!1),onClearButtonClick:s,hideClearButton:!0}),(0,S.jsx)(k.Z,{firstDayOfWeek:d,value:o.current.toMillis(),selectValue:!1,onChange:e=>{t({start:i.current,end:b.ou.fromMillis(e)})},disabledDays:{before:new Date(o.current.toMillis())}})]})}var Z=s(36700),P=s(69651);const F=(0,s(45238).IU)("infinity",{viewBox:"0 0 40 19",svg:(0,S.jsx)("path",{d:"M0.297852 9.42383C0.297852 11.2695 0.65918 12.876 1.38184 14.2432C2.11426 15.6104 3.13477 16.6748 4.44336 17.4365C5.75195 18.1885 7.26562 18.5645 8.98438 18.5645C10.3613 18.5645 11.6504 18.2715 12.8516 17.6855C14.0625 17.0898 15.2881 16.1963 16.5283 15.0049L20 11.6504L23.4717 15.0049C24.7119 16.1963 25.9375 17.0898 27.1484 17.6855C28.3594 18.2715 29.6484 18.5645 31.0156 18.5645C32.7344 18.5645 34.248 18.1885 35.5566 17.4365C36.8652 16.6748 37.8809 15.6104 38.6035 14.2432C39.3359 12.876 39.7021 11.2695 39.7021 9.42383C39.7021 7.57812 39.3359 5.97168 38.6035 4.60449C37.8809 3.2373 36.8652 2.17773 35.5566 1.42578C34.248 0.664062 32.7344 0.283203 31.0156 0.283203C29.6484 0.283203 28.3594 0.581055 27.1484 1.17676C25.9375 1.7627 24.7119 2.65137 23.4717 3.84277L20 7.19727L16.5283 3.84277C15.2881 2.65137 14.0625 1.7627 12.8516 1.17676C11.6504 0.581055 10.3613 0.283203 8.98438 0.283203C7.26562 0.283203 5.75195 0.664062 4.44336 1.42578C3.13477 2.17773 2.11426 3.2373 1.38184 4.60449C0.65918 5.97168 0.297852 7.57812 0.297852 9.42383ZM3.5791 9.42383C3.5791 8.23242 3.80371 7.19727 4.25293 6.31836C4.71191 5.43945 5.34668 4.76074 6.15723 4.28223C6.96777 3.80371 7.91016 3.56445 8.98438 3.56445C9.88281 3.56445 10.752 3.78418 11.5918 4.22363C12.4316 4.66309 13.3154 5.3125 14.2432 6.17188L17.7002 9.42383L14.2285 12.6758C13.3105 13.5352 12.4316 14.1846 11.5918 14.624C10.752 15.0635 9.88281 15.2832 8.98438 15.2832C7.91016 15.2832 6.96777 15.0439 6.15723 14.5654C5.34668 14.0869 4.71191 13.4082 4.25293 12.5293C3.80371 11.6406 3.5791 10.6055 3.5791 9.42383ZM22.2998 9.42383L25.7568 6.17188C26.6846 5.3125 27.5684 4.66309 28.4082 4.22363C29.248 3.78418 30.1172 3.56445 31.0156 3.56445C32.0898 3.56445 33.0322 3.80371 33.8428 4.28223C34.6533 4.76074 35.2832 5.43945 35.7324 6.31836C36.1914 7.19727 36.4209 8.23242 36.4209 9.42383C36.4209 10.6055 36.1914 11.6406 35.7324 12.5293C35.2832 13.4082 34.6533 14.0869 33.8428 14.5654C33.0322 15.0439 32.0898 15.2832 31.0156 15.2832C30.1172 15.2832 29.248 15.0635 28.4082 14.624C27.5684 14.1846 26.6895 13.5352 25.7715 12.6758L22.2998 9.42383Z"})});var A=s(70693);function _(e){const{verificationState:t,onChange:s,onCustomDateClick:i}=e,a=(0,f.useIntl)(),r=(0,n.useRef)(e.today),l=(0,o.yK)((e=>({title:{fontSize:14,color:e.regularTextColor},optionsContainer:{width:"100%"},clockIconStyle:{width:14,marginLeft:0,marginTop:2}})),[]),c="expired"===t.type||"none"===t.type?(0,S.jsx)(f.FormattedMessage,{defaultMessage:"Verify page",id:"VerificationExpiryPicker.verify.header"}):(0,S.jsx)(f.FormattedMessage,{defaultMessage:"Reverify page",id:"VerificationExpiryPicker.reverify.header"}),u="verified"===t.type&&t.isIndefinite,p="verified"===t.type&&!t.isIndefinite&&t.dateTimeRange.end;return(0,S.jsxs)(y.Z,{title:c,children:[d.Xs.map((e=>{const t=p&&d.fm({start:r.current,end:p})===e;return(0,S.jsx)(x.Z,{focused:!1,icon:(0,Z.m)(l.clockIconStyle),inline:!1,title:(0,S.jsx)("span",{style:l.title,children:(0,S.jsx)(f.FormattedMessage,{defaultMessage:"For {numDays} days",id:"VerificationExpiryMenu.preset.title",values:{numDays:e}})}),caption:a.formatMessage({defaultMessage:"Until {date}",id:"VerificationExpiryMenu.preset.subtitle"},{date:A.mb({dateTime:d.z5(e,r.current).end,intl:a,shortenDateAndRange:!0})}),checkState:!!t,onClick:()=>{return t=e,void s({start:r.current,end:r.current.plus({days:t})});var t}},e)})),(0,S.jsx)(x.Z,{focused:!1,icon:F({width:14,marginLeft:0,marginTop:1}),inline:!1,title:(0,S.jsx)("span",{style:l.title,children:(0,S.jsx)(f.FormattedMessage,{defaultMessage:"Indefinitely",id:"VerificationExpiryPicker.option.indefinitely"})}),onClick:()=>s(),checkState:u},"indefinite"),(0,S.jsx)(x.Z,{focused:!1,icon:(0,P.C)({width:14,marginLeft:0}),title:(0,S.jsx)("span",{style:l.title,children:(0,S.jsx)(f.FormattedMessage,{defaultMessage:"Pick a date",id:"VerificationExpiryPicker.option.customDate"})}),onClick:i},"custom")]})}var R=s(66897),O=s(64369);function B(e){const{getRecordModel:t,actorPointer:s,lastVerifiedDate:n}=e,o=(0,i.Fy)(),a=(0,f.useIntl)(),r=(0,M.VK)((()=>(0,R.$4)(a,(0,R.Hl)({pointer:s,getRecordModel:t}))),[t,a,s]);return(0,S.jsxs)("div",{style:{padding:"8px 14px"},children:[(0,S.jsx)(O.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:o.isMobile,isMultiline:!0,style:{marginBottom:4},children:(0,S.jsx)(f.FormattedMessage,{defaultMessage:"Last verified by {user}",id:"VerificationMetadata.lastVerified",values:{user:r}})}),(0,S.jsx)(O.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:o.isMobile,children:(0,A.mb)({dateTime:n,intl:a})})]})}var D=s(11028);function L(e){const{verificationValue:t,getRecordModel:s,onChange:c,blockId:p,propertyName:h,onClose:f}=e,x=(0,i.O7)(),y=(0,i.Fy)(),b=(0,o.Fg)(),[M,j]=(0,n.useState)(!1),C=(0,n.useMemo)((()=>d.WN(t)),[t]),w="verified"===C.type,k=(0,n.useRef)(a.Uu((0,r.r)())),T=(0,n.useRef)(a.Uu((0,r.r)()).plus({days:1})),Z=e=>{var t;const s=null===(t=x.currentUser)||void 0===t?void 0:t.id;if(!s)return;if(null!=e&&e.end&&e.end.toMillis()<T.current.toMillis())return;const n={table:l.KJ,id:s},i=e?a.OQ.toPersistedDateTimeRange(e):a.OQ.toPersistedDateTime(k.current.toMillis()),o="none"===C.type?"add":"update";V(x,{action:o,verification_page_id:p,verification_expiry:e?e.end.toMillis():void 0}),c({value:[n,i]})};let P={menuType:u.og.Popup,footer:"none"!==C.type&&(0,S.jsx)("div",{style:{borderTop:`1px solid ${b.regularDividerColor}`},children:(0,S.jsx)(B,{lastVerifiedDate:w&&C.isIndefinite?C.startDateTime:C.dateTimeRange.start,getRecordModel:s,actorPointer:C.actorPointer})})};return y.isMobile&&(P={...P,title:h,menuType:u.og.Modal,right:(0,S.jsx)(g.DoneMenuText,{}),onClickRight:f}),(0,S.jsx)(m.Z,{...P,header:!M&&"none"!==C.type&&(0,S.jsx)(S.Fragment,{children:(0,S.jsx)("div",{style:{padding:y.isMobile?10:7,paddingLeft:y.isMobile?20:7,background:y.isMobile?b.popoverBackground:b.tokenInputMenuItemBackground,display:"flex",alignItems:"center",borderBottom:`1px solid ${b.regularDividerColor}`},children:(0,S.jsx)(D.z,{verificationValue:t})})}),children:M?(0,S.jsx)(I,{today:k.current,verificationState:C,onChange:e=>Z(e),clearCustomDatePicker:()=>j(!1)}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(_,{today:k.current,verificationState:C,onChange:e=>Z(e),onCustomDateClick:()=>j(!0)}),(w||"expired"===C.type)&&(0,S.jsx)(v,{onClick:()=>{V(x,{action:"remove",verification_page_id:p}),c({value:void 0})}})]})})}function V(e,t){c.j(e,"verification_update",t),p.default.logEvent("verification_update",t.action)}},72402:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(35431);class i extends n.Z{}const o=new i},75375:(e,t,s)=>{s.d(t,{Z:()=>F});s(57658),s(67294);var n=s(83355),i=s(90902),o=s(42129),a=s(15095),r=s(54153),l=s(9291),d=s(31701),c=s(53965),u=s(1898),p=s(68425),m=s(73657),g=s(32163),h=s(43145),f=s(72495),x=s(70177),y=s(33929),S=s(29798),v=s(72187),b=s(60682),M=s(24990),j=s(83620),C=s(78453),w=s(85893);const k={display:"flex",flexDirection:"column"},T=["💡","👉","☝","👌","🔑","🚧","⚠️","🔥","📌","✂️","❓","🚫","⛔","⏰","☎️","🚨","♻️","✅","🔒","📎","📖","🗣","➡️","📢","🛠","⚙"],I=(0,l.defineMessages)({noResults:{defaultMessage:"No results",id:"emojiPicker.noResults.message"}});var Z=!1;class P extends n.Z{constructor(){super(...arguments),this.filter="",this.splitFilter=[],this.storeTypes={menuListStore:S.Z},this.createCategory=e=>{let t=[];if(t="recent"===e.id?j.Z.state.recentEmojis||[]:"callout"===e.id?T:M.Z.state.emojiByCategory[e.id]||[],this.filter&&(t=_(t,this.filter,this.splitFilter)),0!==t.length)return{key:e.id,items:t.map((e=>B(e))).map((e=>L(e,this.props.onSubmit,this.props.menuRef,this.environment,this.props.iconLoggingData))),render:t=>(0,w.jsx)(f.Z,{isTitleUppercase:!0,title:e.title,children:(0,w.jsx)("div",{style:V(this.environment,this.theme),children:t.children})},t.key)}},this.handleScroll=e=>{if(e<100){const{loadEmojiCount:e}=j.Z.state,t=Math.max(R(this.environment,this.props.menuRef)*O(this.environment),this.getAllSectionsEmojiCount());j.Z.setState({...j.Z.state,loadEmojiCount:Math.min(t,e+R(this.environment,this.props.menuRef)*O(this.environment))})}}}UNSAFE_willMount(e){super.UNSAFE_willMount(e),j.Z.setState({...j.Z.state,loadEmojiCount:R(this.environment,this.props.menuRef)*O(this.environment)}),j.Z.cleanupSkinTonedRecents((0,b.sg)()),async function(){await(0,x.L)(),await async function(){if(!Z){await M.Z.waitUntilLoaded();for(const t in M.Z.state.positionalEmojiData){var e;const s=null===(e=(0,o.y)(t,M.Z.state))||void 0===e?void 0:e.keywords;s&&(i.Q4[t]={...i.Q4[t],uniqueKeywords:c.jj(s.flatMap((e=>e.split(" "))))})}Z=!0}}()}()}didUpdate(e){const{menuListStore:t}=this.stores;e.filter!==this.props.filter&&t.setState({...t.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}renderComponent(){const{menuListStore:e}=this.stores,t=function(e){const{loadEmojiCount:t}=j.Z.state,s=[];let n=0;for(const i of e){if(!(n+i.items.length<=t)){s.push({...i,items:i.items.slice(0,t-n)});break}s.push(i),n+=i.items.length}return s}(this.getAllSections()),s=this.environment.device.isDesktop&&t.length>0?0:void 0;return 0===t.length&&(this.props.onNoResults&&this.props.onNoResults(),t.push({key:"no results",items:[{key:"no results",action:()=>{},render:(e,t)=>(0,w.jsx)(m.Z,{...e,caption:y.default.formatMessage(I.noResults)})}],render:e=>(0,w.jsx)(f.Z,{...e})})),(0,w.jsxs)("div",{style:k,children:[(0,w.jsx)("div",{style:{flexGrow:1},children:(0,w.jsx)(g.Z,{...(n=this.environment,i=this.props.menuRef,{type:g.i.Grid,itemsPerRow:R(n,i),renderRow:(e,t)=>(0,w.jsx)("div",{style:{display:"flex"},children:e},t)}),store:e,initialFocus:s,sections:t,disableKeyboardArrowWrap:!0,unfocusOnScroll:this.environment.device.isMobile})}),(0,w.jsx)(h.Z,{onChange:this.handleScroll})]});var n,i}getAllSections(){this.filter=a.rJ(this.props.filter)??"",this.splitFilter=this.filter?this.filter.split(" ").filter(Boolean):[];const e=c.oA(A(this.props.filter,this.props.isCallout).map(this.createCategory));return this.props.filter&&this.filter?function(e){let t=0;for(const s of e)t+=s.items.length;return t}(e)>R(this.environment,this.props.menuRef)*O(this.environment)/2?e:this.createFilteredSection():e}getAllSectionsEmojiCount(){const e=this.getAllSections();let t=0;for(const s of e)t+=s.items.length;return t}createFilteredSection(){const e=_(c.xH(A(this.props.filter,this.props.isCallout).map((e=>(0,u.qg)(M.Z.state.emojiByCategory,e.id)?M.Z.state.emojiByCategory[e.id]??[]:[]))),this.filter,this.splitFilter);return 0===e.length?[]:[{key:"search-results",items:e.map((e=>B(e))).map((e=>L(e,this.props.onSubmit,this.props.menuRef,this.environment,this.props.iconLoggingData))),render:e=>(0,w.jsx)(f.Z,{children:(0,w.jsx)("div",{style:V(this.environment,this.theme),children:e.children})},e.key)}]}}P.displayName="EmojiPicker";const F=P;function A(e,t){return c.oA([!e&&{id:"recent",title:(0,w.jsx)(l.FormattedMessage,{id:"emojiPicker.section.recent",defaultMessage:"Recent"})},t?{id:"callout",title:(0,w.jsx)(l.FormattedMessage,{id:"emojiPicker.section.callout",defaultMessage:"Callout"})}:void 0,{id:"People & Body",title:(0,w.jsx)(l.FormattedMessage,{id:"emojiPicker.section.people",defaultMessage:"People"})},{id:"Animals & Nature",title:(0,w.jsx)(l.FormattedMessage,{id:"emojiPicker.section.animals",defaultMessage:"Animals and nature"})},{id:"Food & Drink",title:(0,w.jsx)(l.FormattedMessage,{id:"emojiPicker.section.food",defaultMessage:"Food and drink"})},{id:"Activities",title:(0,w.jsx)(l.FormattedMessage,{id:"emojiPicker.section.activity",defaultMessage:"Activity"})},{id:"Travel & Places",title:(0,w.jsx)(l.FormattedMessage,{id:"emojiPicker.section.travel",defaultMessage:"Travel and places"})},{id:"Objects",title:(0,w.jsx)(l.FormattedMessage,{id:"emojiPicker.section.objects",defaultMessage:"Objects"})},{id:"Symbols",title:(0,w.jsx)(l.FormattedMessage,{id:"emojiPicker.section.symbols",defaultMessage:"Symbols"})},{id:"Flags",title:(0,w.jsx)(l.FormattedMessage,{id:"emojiPicker.section.flags",defaultMessage:"Flags"})}])}function _(e,t,s){const n=c.oA(e.map((e=>{const n=(0,o.y)(e,M.Z.state),i=n&&n.keywords||[],a=t.length<3||t.includes(" ")?i:i.map((e=>e.replaceAll(" ",""))),r=a.findIndex((e=>e===`:${t}`));if(-1!==r)return[100-r,e];const l=a.findIndex((e=>e===t));if(-1!==l)return[10*(10-l),e];const d=a.findIndex((e=>e.startsWith(t)));if(-1!==d)return[10-d,e];if(s.length>1){const t=n&&n.uniqueKeywords||[];if(s.every((e=>t.find((t=>t.startsWith(e))))))return[s.length,e]}return a.some((e=>e.includes(t)))?[1,e]:void 0})));return c.MR(n,(e=>-e[0])).map((e=>e[1]))}function R(e,t){var s,n;const{device:i,WindowSizeStore:o}=e;return i.isPhone?(window.innerWidth-o.getSafePaddingLeftPx(v.$P)-o.getSafePaddingRightPx(v.qJ))/v.mz:i.isTablet?v.tg:null!=t&&null!==(s=t.current)&&void 0!==s&&s.offsetWidth?((null==t||null===(n=t.current)||void 0===n?void 0:n.offsetWidth)-2*v.PS)/v.T8:v.IQ}function O(e){return e.device.isMobile?v.pq:v.II}function B(e){var t;const s=(0,b.sg)();if(!(void 0!==s&&0!==s))return e;const n=null===(t=(0,o.y)(e,M.Z.state))||void 0===t?void 0:t.variations;return 5===(null==n?void 0:n.length)||"🤝"===e?(null==n?void 0:n[s-1])??e:e}function D(e,t,s,n,i){t(e),function(e,t,s){const n=r.Z.get(j.W),i=c.jj(c.G0([(o=e,void 0===(0,b.sg)()?o:a.Gb(o))],a.p4(n)));var o;const l=c.qn(i,v.Nm*R(s,t));r.Z.set(j.W,l.join("")),j.Z.setState({...j.Z.state,recentEmojis:l})}(e,s,n),i&&p.fA(n,"pick_emoji",{icon:e,...i})}function L(e,t,s,n,i){const o=a.Hk(e,M.Z.state),r=void 0===(0,b.sg)()?a.yS(e,M.Z.state):[];return{key:e,action:()=>{0===r.length&&D(e,t,s,n,i)},render:a=>(0,w.jsx)(C.Z,{...a,emoji:e,tooltip:o,variations:r,insertEmoji:e=>D(e,t,s,n,i)})}}function V(e,t){const{device:s,WindowSizeStore:n}=e;return{display:"flex",flexDirection:"column",flexWrap:"wrap",alignItems:"flex-start",...s.isPhone?{background:t.popoverBackground,paddingTop:10,paddingBottom:10,paddingLeft:n.getSafePaddingLeftCSS(v.$P),paddingRight:n.getSafePaddingRightCSS(v.qJ),boxShadow:`0 1px 0 ${t.regularDividerColor}`,marginBottom:1}:{background:d.ZP.transparent,paddingLeft:s.isTablet?v.vP:v.PS,paddingRight:s.isTablet?v.vP:v.PS}}}},78453:(e,t,s)=>{s.d(t,{Z:()=>b});var n=s(67294),i=s(480),o=s(86628),a=s(90902),r=s(64921),l=s(31945),d=s(1743),c=s(3386),u=s(32163),p=s(26388),m=s(72187),g=s(98742),h=s(61766),f=s(60682),x=s(11059),y=s(98534),S=s(85893);function v(e){let{variations:t,emoji:s,focused:n,onClick:i,onMouseEnter:a,tooltip:r,insertEmoji:l}=e;const d=(0,o.qz)(void 0,h.Z);return void 0===(0,o.VK)((()=>(0,f.sg)()),[])&&t&&t.length>0?(0,S.jsx)(T,{emoji:s,focused:n,onClick:i,onMouseEnter:a,tooltip:r,variations:t,insertEmoji:l,buttonPopupStore:d}):(0,S.jsx)(C,{emoji:s,focused:n,onClick:i,onMouseEnter:a,tooltip:r})}const b=v;function M(e){const{device:t}=e;return t.isMobile?{width:m.mz,height:m.mz,fontSize:m.jo}:{width:m.T8,height:m.T8,fontSize:m.WB}}function j(e){return{emojiButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,...M(e)},variationMenu:{display:"flex",padding:4}}}function C(e){let{events:t,emoji:s,focused:n,onClick:o,onMouseEnter:a,tooltip:l}=e;const d=(0,i.O7)(),{fontSize:c}=M(d);return(0,S.jsx)(p.ZP,{allowHover:Boolean(l),renderTooltip:()=>l,closeDelay:0,disableTooltip:!l,render:e=>(0,S.jsx)(r.Z,{focused:n,onClick:o,...(0,g.Z)(t||{},(0,g.Z)({onMouseEnter:a},e)),ignoreLocalHoverState:!0,style:j(d).emojiButton,children:(0,S.jsx)(x.Z,{size:c,char:s})},s)})}function w(e){let{props:t}=e;const s=(0,i.O7)();return(0,S.jsx)("div",{style:j(s).variationMenu,...t})}function k(e){const{parent:t,emoji:s,variations:n,insertEmoji:o}=e,r=(0,i.O7)(),l=(n&&n.length>0?[s,...n]:[s]).map(((s,i)=>({key:s,action:e=>{t.close(),(null==n?void 0:n.length)===a.tN&&(0,y.W)({environment:r,skinTone:i}),o(s,i)},render:t=>(0,S.jsx)(v,{...e,...t,emoji:s,variations:void 0})})));return(0,S.jsx)(d.Z,{debugName:"EmojiPickerMenuItem",capture:!0,allowEsc:!0,children:(0,S.jsx)(u.Z,{type:u.i.Horizontal,initialFocus:0,sections:[{key:"variations",render:e=>(0,S.jsx)(w,{props:e}),items:l}]})})}function T(e){let{emoji:t,focused:s,onClick:i,onMouseEnter:o,tooltip:a,variations:r,insertEmoji:d,buttonPopupStore:u}=e;const p=(0,n.useCallback)((()=>function(e){e.setState({...e.state,open:!1})}(u)),[u]),m=(0,n.useCallback)((e=>function(e,t){e.preventDefault(),t.setState({...t.state,open:!0})}(e,u)),[u]);return(0,S.jsx)(c.Z,{debugName:"EmojiPickerMenuItem",capture:s,onEnter:m,onEsc:p,children:(0,S.jsx)(l.ZP,{buttonPopupStore:u,popupType:l.Z4.Popup,renderOrigin:e=>(0,S.jsx)(C,{emoji:t,focused:s,onClick:i,onMouseEnter:o,tooltip:a,events:e}),render:e=>(0,S.jsx)(k,{parent:e,emoji:t,variations:r,insertEmoji:d})})},t)}},98534:(e,t,s)=>{s.d(t,{W:()=>b,Z:()=>v});s(67294);var n=s(480),i=s(86628),o=s(90902),a=s(9291),r=s(13447),l=s(37181),d=s(31945),c=s(1743),u=s(68894),p=s(32163),m=s(26388),g=s(98742),h=s(80444),f=s(61766),x=s(83620),y=s(78453),S=s(85893);function v(){const e=(0,i.VK)((()=>{var e;return null===(e=h.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.emoji_picker_skin_tone}),[]),t=(0,n.O7)(),s=(0,i.qz)(void 0,f.Z);return(0,S.jsx)(m.ZP,{renderTooltip:()=>(0,S.jsx)(a.FormattedMessage,{defaultMessage:"Select skin tone",id:"emojiPickerSkinTonePicker.selectSkinTone"}),placement:m.ug.Bottom,render:n=>(0,S.jsx)(d.ZP,{buttonPopupStore:s,popupType:d.Z4.Popup,renderOrigin:t=>(0,S.jsx)(u.DO,{icon:()=>(0,S.jsx)("div",{style:{paddingRight:6},children:void 0!==e?o.YN[e]:"✋"}),style:{fontSize:20},...(0,g.Z)(t,n)}),render:s=>function(e){const{parent:t,environment:s,currentSkinTone:n}=e,i=o.YN.map(((e,n)=>({key:e,action:()=>{t.close(),b({environment:s,skinTone:n})},render:t=>(0,S.jsx)(y.Z,{...t,insertEmoji:()=>{},emoji:e,variations:void 0,tooltip:void 0})})));return(0,S.jsx)(c.Z,{debugName:"EmojiPickerSkinTonePicker",capture:!0,allowEsc:!0,children:(0,S.jsx)(p.Z,{type:p.i.Horizontal,initialFocus:n,sections:[{key:"variations",render:e=>(0,S.jsx)("div",{style:{display:"flex",padding:4},...e}),items:i}]})})}({parent:s,environment:t,currentSkinTone:e}),...n})})}function b(e){const{environment:t,skinTone:s}=e,{currentUserSettingsStore:n}=h.default.state;n&&(void 0!==s&&x.Z.cleanupSkinTonedRecents(s),r.createAndCommit({userAction:"mediaPicker.setEmojiSkinTone",environment:t,perform:e=>{l.d2({userSettingsStore:n,transaction:e,data:{emoji_picker_skin_tone:s}})}}))}},83620:(e,t,s)=>{s.d(t,{W:()=>r,Z:()=>d});var n=s(49085),i=s(15095),o=s(54153),a=s(53965);const r="recentEmojis";class l extends n.default{getInitialState(){return{recentEmojis:[],loadEmojiCount:0}}cleanupSkinTonedRecents(e){const t=a.jj(i.p4(o.Z.get(r)).map((t=>void 0===e?t:i.Gb(t))));return o.Z.set(r,t.join("")),this.setState({...this.state,recentEmojis:t}),t}}const d=new l},76110:(e,t,s)=>{s.d(t,{Ix:()=>r,bv:()=>a});var n=s(13991);const i={"en-US":"https://player.vimeo.com/video/879544506?h=9314829857","fr-FR":"https://player.vimeo.com/video/880663447?badge=0&amp;autopause=0&amp;quality_selector=1&amp;player_id=0&amp;app_id=58479","de-DE":"https://player.vimeo.com/video/879925635?badge=0&amp;autopause=0&amp;quality_selector=1&amp;player_id=0&amp;app_id=58479","ja-JP":"https://player.vimeo.com/video/879925814?badge=0&amp;autopause=0&amp;quality_selector=1&amp;player_id=0&amp;app_id=58479","ko-KR":"https://player.vimeo.com/video/880663466?badge=0&amp;autopause=0&amp;quality_selector=1&amp;player_id=0&amp;app_id=58479"},o={"en-US":"https://player.vimeo.com/video/881812861?h=55c8e40bb3"};function a(){const e=i["en-US"];return i[n.SP]||e}function r(){return o["en-US"]}},68657:(e,t,s)=>{s.d(t,{Cl:()=>p,NY:()=>m});var n=s(67294),i=s(480),o=s(86628),a=s(21202),r=(s(70203),s(53965)),l=s(7032),d=s(84398),c=s(77080),u=s(6258);function p(e){const{initialValue:t,onChange:s,source:c="title",parentCollection:p}=e,m=(0,i.O7)(),g=(0,d.$)("formulaPrototypeHelpers.useMockTextStore",{isMockTextStore:!0,overrideDefaultRecordCache:!0}),h=function(e){const{initialValue:t,inMemoryRecordCache:s,source:o,parentCollection:r}=e,d=(0,i.O7)(),c=(0,n.useMemo)((()=>t),[]);return(0,n.useMemo)((()=>{const e={id:(0,l.ZP)(),table:a.iU};s.setRecord({pointer:e,userId:d.currentUser.id},{value:{alive:!0,id:e.id,parent_id:(null==r?void 0:r.id)??l._6,parent_table:"block",properties:{[o]:c},space_id:(null==r?void 0:r.getSpaceId())??l._6,type:"page",version:0},role:"editor"});const t=new u.ST({environment:d,inMemoryRecordCache:s,path:["properties",o],pointer:e,userId:d.currentUser.id});return s.emitRecord(e,[]),t}),[d,s,c,r,o])}({initialValue:t,inMemoryRecordCache:g,source:c,parentCollection:p}),f=(0,n.useRef)(t),x=(0,n.useCallback)((e=>{const t=m.currentUser.id,s=h.getRecordStoreAtRootPath();if(s instanceof u.G){const n=s.getValue();n&&(g.setRecord({pointer:h.pointer,userId:t},{role:"editor",value:{...n,properties:{...null==n?void 0:n.properties,[c]:e}}}),g.emitRecord(h.pointer,[]))}}),[m.currentUser.id,h,g,c]);return(0,o.VK)((()=>{const e=h.getValue();r.Xy(f.current,e)||(f.current=e,null==s||s(e))}),[h,s]),{store:h,setValue:x}}function m(){return c.default.checkGate("formula_buttons")}},5385:(e,t,s)=>{s.d(t,{x:()=>i});var n=s(80444);function i(){var e;return null===(e=n.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.icon_picker_color}},45567:(e,t,s)=>{s.d(t,{G7:()=>a,Gh:()=>l,LR:()=>o,gU:()=>r,jo:()=>i});var n=s(1898);const i="fileTypeAnyFiles",o="fileTypeImages",a="fileTypeVideos",r="fileTypeNone";function l(e){let{fileMimeType:t,allowedType:s}=e;switch(s){case i:return!0;case o:return function(e){return e.startsWith("image")&&!e.includes("photoshop")}(t);case a:return function(e){return e.startsWith("video")}(t);case r:return!1;default:(0,n.t1)(s)}}},98481:(e,t,s)=>{s.d(t,{J:()=>d});var n=s(1898),i=s(40506);var o=s(70060),a=s(88893),r=s(35057),l=s(88280);function d(e){let{environment:t}=e;const s=(0,r.zt)(),d=l.subscriptionDataStoreInstance.state,c=(0,a.XX)(d);return function(e){let{subscriptionTier:t,subscriptionCreatedAtTime:s,useLegacyBehavior:o}=e;return"enterprise"===t||!("plus"!==t||!o)&&(0,n.$K)(s)&&s<i.Xn}({subscriptionTier:s,subscriptionCreatedAtTime:null==c?void 0:c.created,useLegacyBehavior:!(0,o.fX)()})}},84398:(e,t,s)=>{s.d(t,{$:()=>a});var n=s(67294),i=s(26263),o=s(480);function a(e,t){const{cacheFallback:s,isMockTextStore:a,isTemporaryData:r,overrideDefaultRecordCache:l}=t??{},d=(0,o.O7)(),{inMemoryRecordCache:c}=d.defaultRecordCache,u=(0,n.useMemo)((()=>{const t=new i.Z({isTemporaryData:Boolean(r),name:e});return t.isMockTextStore=Boolean(a),s&&t.addCacheFallback(s),l&&c.addCacheOverride(t),t}),[s,c,a,r,e,l]);return(0,n.useEffect)((()=>function(){s&&u.removeCacheFallback(s),l&&c.removeCacheOverride(u)}),[s,c,u,l]),u}},73205:(e,t,s)=>{s.d(t,{Z:()=>i});var n=s(67294);function i(e){const[t,s]=n.useState(!1);return n.useEffect((()=>{const t=window.matchMedia(e);function n(){s(t.matches)}return n(),t.addEventListener("change",n),()=>{t.removeEventListener("change",n)}}),[e]),t}},82787:(e,t,s)=>{s.d(t,{Z:()=>c});var n=s(67294),i=s(86628),o=s(77337),a=s(45953),r=s(13447),l=s(3932),d=s(80444);function c(e){let{unpersistedInMemoryRecordCache:t}=e;const s=(0,i.VK)((()=>{var e;return null===(e=d.default.state.currentUserStore)||void 0===e?void 0:e.userId}),[]);return{createAndCommit:(0,n.useCallback)((e=>{let{perform:n}=e;const i=new l.Y({deadlockTimeoutMs:r.DEADLOCK_WARNING_TIMEOUT_MS}),d=n(i),c=a.Ak.create();i.stores.forEach((e=>{const t=e.getRecordModel(e.pointer);t&&c.addModel(t)})),(0,o.FS)({operations:i.operations,recordMap:c,updateOnly:!1});for(const o of c){const{model:e,pointer:n}=o;t.setModelAndRole({pointer:n,userId:s},e,"editor")}return t.emitAll(),{performResult:d,serverCommitResult:Promise.resolve()}}),[t,s])}}},7314:(e,t,s)=>{s.d(t,{Z:()=>Q});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(9291),l=s(31701),d=s(53965),c=s(81918),u=s(3386),p=s(26388),m=s(7567),g=s(99273),h=s(55899),f=s(8675),x=s(22508),y=s(13394),S=(s(21703),s(72141)),v=s(37810),b=s(95209),M=s(58297),j=s(64369),C=s(44385),w=s(18168),k=s(26907),T=s(46654),I=s(53353),Z=s(26781),P=s(80444),F=s(35057),A=s(88280),_=s(85893);function R(e){const{store:t,sudoModeStore:s,personPropertyInviteStore:a,onInviteCompleteFn:l,inviteOrigin:d}=e,u=(0,i.O7)(),m=L(),g=(0,o.qz)(e.inviteTargetsStore,h.ZP),f=(0,o.VK)((()=>a.state.isLoading),[a]),v=(0,n.useCallback)((e=>{a.setState({...a.state,isLoading:e,focus:y.S.NoFocus})}),[a]),[M,j]=(0,n.useState)("member"),R=(0,o.VK)((()=>{const{emailMessage:e}=a.state;return e}),[a]),V=(0,o.VK)((()=>{const{role:e}=a.state;return e}),[a]),N=(0,r.useIntl)(),E=(0,o.VK)((()=>a.state.flowId),[a]),U=(0,o.VK)((()=>P.default.state.currentSpaceStore),[]),W=(0,o.VK)((()=>t.canEditMembership()),[t]),K=(0,o.VK)((()=>(0,k.B)({inviteTargetsStore:g})),[g]),z=(0,n.useCallback)((async()=>{await x.Uw({environment:u,inviteTargetsStore:g,personPropertyInviteStore:a,allowShowEmptyError:!0})}),[u,g,a]),q=(0,n.useCallback)((()=>{const e=(0,k.B)({inviteTargetsStore:g}),t=e.filter((e=>{let{type:t}=e;return"newUser"===t})).map((e=>{let{value:t}=e;return t.email})),s=e.filter((e=>{let{type:t}=e;return"existingUser"===t})).map((e=>{let{value:t}=e;return t.id}));return T.Xu({subscriptionData:A.subscriptionDataStoreInstance.state,newGuestIds:[...t,...s]})}),[g]),G=(0,o.VK)((()=>q()),[q]),H=(0,o.VK)((()=>T.Z9(A.subscriptionDataStoreInstance.state)),[]),Y=(0,I.Z)(t),Q=(0,o.VK)((()=>{if(Y.isGuestRequestRequired)return!1;const e=Y.isStoreInTeam&&!Y.teamAllowsGuests,t=!Y.isStoreInTeam&&!Y.spaceAllowsGuests||Y.isStoreInTeam&&!Y.teamAllowsGuests&&!Y.spaceAllowsGuests,s=K.some((e=>"newUser"===e.type||("existingUser"===e.type?"none"===e.spaceRole||"not_in_space"===e.spaceRole:void 0)));return(e||t)&&s}),[K,Y]),$=(0,o.VK)((()=>null==U?void 0:U.getRole()),[U]),J=(0,o.VK)((()=>!(!$||!(0,S.RN)($))&&!(!U||U.getDisableMembershipRequests())),[$,U]),X=(0,o.VK)((()=>!!($&&(0,S.dy)($)&&(0,F.Mk)())||(J||j("guest"),!1)),[$,J,j]),ee=(0,Z.S)(t),te=R.length>1e3,se=(0,n.useCallback)((e=>{const{response:t,shouldDoCompleteFn:s,invitedUserEmails:n,isRequestMember:i}=e;t.success?s&&(c.Y7(u,{invited_user_count:n.length,is_success:t.success,can_add_member:X,invite_option:M,origin:d,invite_flow_id:E}),x.TW({success:t.success,invitedUserEmails:n,isRequestMember:i}),v(!1),l(t)):(x.TW({success:t.success,invitedUserEmails:n}),c.Y7(u,{invited_user_count:n.length,is_success:t.success,can_add_member:X,invite_option:M,origin:d}))}),[l,E,v,u,M,X,d]),ne=(0,n.useCallback)((async e=>{const{invitedUserEmails:n,shouldDoCompleteFn:i}=e;return await x.GZ({environment:u,inviteOrigin:d,role:V,emailMessage:R,inviteTargetsStore:g,blockStore:t,sudoModeStore:s,flowId:E,onInviteComplete:e=>{se({response:e,shouldDoCompleteFn:i||!1,invitedUserEmails:n})}})}),[u,V,R,t,s,E,g,se,d]),ie=(0,n.useCallback)((async e=>{const{invitedUserEmails:t,disable_invite_email:s,guestInviteResponse:n,shouldDoCompleteFn:i}=e;if(!U)return null;const o=null!=n&&n.success?n.invitedUsers:void 0;await x.E6({environment:u,spaceStore:U,flowId:E,onInviteComplete:e=>{se({response:e,shouldDoCompleteFn:i||!1,invitedUserEmails:t})},intl:N,invitedUsers:o,inviteTargetsStore:g,inviteOrigin:d,disable_invite_email:s})}),[U,u,E,g,N,se,d]),oe=(0,n.useCallback)((async e=>{const{invitedUserEmails:s,guestInviteResponse:n}=e;if(!U)return null;const i=null!=n&&n.success?n.invitedUsers:void 0;i&&await x.rw({environment:u,spaceStore:U,originType:"person_property_invite",intl:N,invitedUsers:i,reasonMessage:void 0,originId:t.id,flowId:E,onInviteComplete:e=>{se({response:e,shouldDoCompleteFn:!0,invitedUserEmails:s,isRequestMember:!0})},inviteOrigin:d})}),[u,E,U,N,se,t,d]),ae=(0,n.useCallback)((async()=>{const e="member"===M,t=g.state.inviteTargets.filter((e=>"newUser"===e.type||"existingUser"===e.type)).map((e=>e.value.email));if(0===t.length)return void c.S4(u,{invite_stage:"click_invite_button",invite_flow_id:E,error:"No valid input emails"});const s=q();if(v(!0),e)if(s)await ie({invitedUserEmails:t,disable_invite_email:!1,guestInviteResponse:void 0,shouldDoCompleteFn:!0});else{const e=!X&&!J,s=await ne({invitedUserEmails:t,shouldDoCompleteFn:e});X?await ie({invitedUserEmails:t,disable_invite_email:!0,guestInviteResponse:s,shouldDoCompleteFn:!0}):J&&await oe({invitedUserEmails:t,guestInviteResponse:s})}else s?c.S4(u,{invite_stage:"click_invite_button",invite_flow_id:E,error:"Invite guest with guest limitation exceed"}):await ne({invitedUserEmails:t,shouldDoCompleteFn:!0});v(!1),g.reset()}),[u,X,J,M,E,q,g,ne,ie,oe,v]),re=(0,n.useCallback)((async()=>{await z();const e=(0,k.B)({inviteTargetsStore:g}).length;c.tX(u,{invited_user_count:e,invite_option:M,can_add_member:X,origin:d,inviteTargets:g.state.inviteTargets.map((e=>e.type.toString())),inviteTokenQuery:g.state.tokenQuery,invite_flow_id:E}),await ae()}),[u,E,z,ae,M,X,g,d]);let le;le=Q?ee:te?(0,_.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters."}):void 0;const de=(0,n.useMemo)((()=>[{key:"member",render:()=>(0,_.jsx)(p.ZP,{disableTooltip:X||J,renderTooltip:()=>(0,_.jsx)(r.FormattedMessage,{id:"invite.person_property.invite_member.tooltip",defaultMessage:"You do not have permission to add or request members to this workspace"}),render:e=>(0,_.jsx)(D,{isSelected:"member"===M,inviteOption:"member",events:e})}),isDisabled:!X&&!J},{key:"guest",render:()=>(0,_.jsx)(p.ZP,{disableTooltip:!G&&H,renderTooltip:()=>(0,_.jsx)(C.e,{}),render:e=>(0,_.jsx)(D,{isSelected:"guest"===M,inviteOption:"guest",events:e})})}]),[M,G,H,J,X]);return(0,_.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[(0,_.jsx)("div",{style:m.section,children:(0,_.jsx)(w.Z,{items:de,itemStyle:m.itemStyle,innerStyle:m.innerStyle,value:M,onChange:e=>{j(e),c.Io(u,{invite_option:e,invite_flow_id:E,origin:d})}})}),!G&&H||"guest"!==M?(0,_.jsx)(B,{tooltip:le,disabled:!W||Q||te,onClick:re,isLoading:f}):(0,_.jsx)(O,{onClick:()=>{c.ZA(u,{invited_user_count:K.length,invite_flow_id:E,origin:d}),b.Vu({environment:u,upgradeButtonName:"user_permission_item"})}})]})}function O(e){const{onClick:t}=e;return(0,_.jsx)(p.ZP,{disableTooltip:!1,renderTooltip:()=>(0,_.jsx)(C.e,{}),render:e=>(0,_.jsx)(M.Z,{isLarge:!0,style:{margin:"0 16px 16px 16px",borderRadius:6},onClick:t,...e,children:(0,_.jsx)(r.FormattedMessage,{id:"invite.person_property.upgrade",defaultMessage:"Upgrade"})})})}function B(e){const{tooltip:t,disabled:s,onClick:n,isLoading:i}=e;return(0,_.jsx)(p.ZP,{disableTooltip:!Boolean(t),renderTooltip:()=>t,render:e=>(0,_.jsx)(M.Z,{isLarge:!0,style:{margin:"0 16px 16px 16px",borderRadius:6},disabled:s,onClick:n,...e,isLoading:i,children:(0,_.jsx)(r.FormattedMessage,{id:"invite.person_property.invite",defaultMessage:"Invite"})})})}function D(e){const{isSelected:t,inviteOption:s,events:n}=e,i=L(),o=t?i.mainTextSelected:i.mainTextUnselected;let a,l;switch(s){case"guest":a=(0,_.jsx)(r.FormattedMessage,{id:"invite.person_property.addAsGuest.title",defaultMessage:"Add to page only"}),l=(0,_.jsx)(r.FormattedMessage,{id:"invite.person_property.addAsGuest.subtitle",defaultMessage:"Invite as a Guest"});break;case"member":a=(0,_.jsx)(r.FormattedMessage,{id:"invite.person_property.addAsMember.title",defaultMessage:"Add to Workspace"}),l=(0,_.jsx)(r.FormattedMessage,{id:"invite.person_property.addAsMember.subtitle",defaultMessage:"Invite and bill as a Member"});break;default:throw new Error(`Unsupported invite option: ${s}`)}return(0,_.jsx)(_.Fragment,{children:(0,_.jsx)("div",{style:i.row,...n,children:(0,_.jsxs)("div",{style:o,children:[a,(0,_.jsx)(j.Z,{isSmall:!0,style:i.optionSubtitle,children:l})]})})})}function L(){return(0,a.yK)((e=>({mainTextSelected:{fontWeight:v.Z.fontWeight.medium,color:e.regularTextColor,fontSize:14,lineHeight:"14px"},mainTextUnselected:{color:e.mediumTextColor,fontSize:14,lineHeight:"14px"},row:{display:"flex",alignItems:"center",justifyContent:"center",gap:4,lineHeight:"14px"},section:{padding:"16px 11px 16px 11px"},itemStyle:{margin:5,borderRadius:8,borderWidth:2},innerStyle:{borderWidth:0},optionSubtitle:{whiteSpace:"pre-wrap",paddingTop:2,fontSize:12}})),[])}var V=s(80721),N=s(73063);function E(e){let{handleBackButtonClick:t}=e;const s=(0,a.yK)((()=>({container:{display:"flex",margin:"0 12px 0px",height:40}})),[]);return(0,_.jsx)("div",{style:s.container,children:(0,_.jsx)(U,{onClick:t})})}function U(e){const{onClick:t}=e,s=(0,r.useIntl)(),n=(0,a.yK)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},iconButton:{marginRight:6,height:24,width:24},arrowIcon:{height:16,width:16,strokeWidth:v.Z.fontWeight.semibold},sendInviteLabel:{fontWeight:v.Z.fontWeight.medium}})),[]);return(0,_.jsxs)("div",{style:n.topContainer,children:[(0,_.jsx)(N.Z,{icon:V.W,iconStyle:n.arrowIcon,style:n.iconButton,onClick:t,ariaLabel:s.formatMessage({id:"shareMenu.backButton.iconButton",defaultMessage:"Go back to main share menu."})}),(0,_.jsx)(j.Z,{style:n.sendInviteLabel,children:(0,_.jsx)(r.FormattedMessage,{id:"invite.person_property.popup_title",defaultMessage:"Invite and mention"})})]})}var W=s(94044),K=s(74194),z=s(19306);const q=d.Ds((e=>{let{environment:t,flowId:s,origin:n}=e;c.KZ(t,{origin:n,invite_flow_id:s})}),1e3);function G(e){const{inviteTargetsStore:t,personPropertyInviteStore:s,inviteOrigin:a}=e,r=(0,i.O7)(),{focus:l,emailMessage:d}=(0,o.VK)((()=>{const{focus:e,emailMessage:t}=s.state;return{focus:e,emailMessage:t}}),[s]),c=(0,o.VK)((()=>s.state.flowId),[s]),u=(0,n.useCallback)((()=>{t.reset()}),[t]),p=(0,n.useCallback)((e=>{s.setState({...s.state,focus:l,emailMessage:e.target.value}),q({environment:r,flowId:c,origin:a})}),[r,s,c,a,l]),m=(0,n.useCallback)((()=>{u()}),[u]),g=(0,n.useCallback)((()=>{s.setState({...s.state,focus:y.S.MessageInput,emailMessage:d})}),[s,d]);return(0,_.jsx)(H,{focus:l===y.S.MessageInput,value:d,onFocus:g,onChange:p,onCancel:m,maxLength:1e3,inviteTargetsStore:t})}function H(e){const{focus:t,value:s,maxLength:n,inviteTargetsStore:l,onFocus:d,onChange:c,onCancel:u}=e,p=(0,r.useIntl)(),m=s.length/n>=.8,g=(0,W.TQ)(s),h=m||g,f=(0,i.Fy)(),x=(0,a.yK)((e=>({container:{maxHeight:80,bottom:0,padding:"2px 16px 2px 16px",backgroundColor:e.modalBackground,pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",overflow:"hidden",zIndex:1,height:72},input:{maxHeight:80,borderTop:1,borderTopStyle:"solid",borderTopColor:e.regularDividerColor,padding:2,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s",height:"100%"},inputBox:{padding:"0px 4px 0px 4px",boxShadow:e.inputBoxShadow,background:e.inputBackground,width:"auto",height:"100%",borderRadius:6,...t&&{background:"none",boxShadow:"rgba(35, 131, 226, 0.57) 0px 0px 0px 1px inset, rgba(35, 131, 226, 0.35) 0px 0px 0px 2px"}}})),[t]),y=(0,o.VK)((()=>l.state.inviteTargets.filter((e=>"newUser"===e.type||"existingUser"===e.type)).map((e=>e.value.email))),[l]),S=(0,o.VK)((()=>y.length>0?p.formatMessage({id:"invite.person_property.emailMessageInput.placeholder.withEmails",defaultMessage:"Add a message for {users}"},{users:(0,z.W)(y)}):p.formatMessage({id:"invite.person_property.emailMessageInput.placeholder.noEmails",defaultMessage:"Add a message to your invite..."})),[p,y]);return(0,_.jsxs)("div",{style:x.container,children:[h&&(0,_.jsx)(Y,{value:s,maxLength:n,shouldShowLengthWarning:m,shouldShowLinkWarning:g}),(0,_.jsx)(K.Z,{textarea:!0,focusInitial:!1,format:K.B.Transparent,placeholder:S,maxlength:n,focus:t,value:s,onFocus:d,onChange:c,inputStyle:x.input,onCancel:u,style:x.inputBox,onClick:()=>{f.isMobile||null==d||d()}})]})}function Y(e){const{shouldShowLengthWarning:t,shouldShowLinkWarning:s,value:n,maxLength:i}=e,o=(0,a.yK)((e=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:e.lightTextColor,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:e.modalBackground,marginTop:1}})),[]);return(0,_.jsx)("div",{style:o.container,children:(0,_.jsxs)("div",{style:o.warning,children:[t&&(0,_.jsx)(r.FormattedMessage,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:n.length,maxCharacters:i}}),t&&s&&" · ",s&&(0,_.jsx)(r.FormattedMessage,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})})}function Q(e){const{store:t,handleBackButtonClick:s,onInviteCompleteFn:r,inviteTargetsStore:l,personPropertyInviteStore:c,inviteOrigin:p}=e,m=(0,o.qz)(void 0,f.Z),g=(0,i.O7)(),h=(0,n.useCallback)((async()=>{await x.Uw({environment:g,inviteTargetsStore:l,personPropertyInviteStore:c,allowShowEmptyError:!1})}),[g,l,c]),y=(0,a.yK)((()=>({container:{position:"relative",width:450,transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:500},searchBar:{paddingLeft:16,paddingRight:16,paddingBottom:16,paddingTop:16},horizontalLine:{margin:"0",color:"#E3E2E0",opacity:.3}})),[]);return(0,_.jsx)(u.Z,{debugName:"PersonPropertyInvitePopup",capture:!0,onLeft:d.yR,onRight:d.yR,onSelectAll:d.yR,onRedo:d.yR,onUndo:d.yR,onCut:d.yR,onCopy:d.yR,onPaste:d.yR,onKeypress:d.yR,onDelete:d.yR,onBackspace:d.yR,onTab:d.yR,onEnter:h,children:(0,_.jsxs)("div",{style:y.container,children:[(0,_.jsx)(E,{handleBackButtonClick:s}),(0,_.jsx)("hr",{style:y.horizontalLine}),(0,_.jsx)("div",{style:y.searchBar,children:(0,_.jsx)($,{store:t,inviteTargetsStore:l,personPropertyInviteStore:c,inviteOrigin:p})}),(0,_.jsx)(G,{store:t,inviteTargetsStore:l,personPropertyInviteStore:c,inviteOrigin:p}),(0,_.jsx)("div",{children:(0,_.jsx)(R,{store:t,inviteTargetsStore:l,sudoModeStore:m,onInviteCompleteFn:r,personPropertyInviteStore:c,inviteOrigin:p})})]})})}function $(e){const{store:t,personPropertyInviteStore:s,inviteOrigin:n}=e,d=(0,r.useIntl)(),u=(0,i.O7)(),f=(0,o.qz)(e.inviteTargetsStore,h.ZP),{focus:x,emailMessage:S}=(0,o.VK)((()=>{const{focus:e,emailMessage:t}=s.state;return{focus:e,emailMessage:t}}),[s]),{role:v,showEmptyError:b}=(0,o.VK)((()=>{const{role:e,showEmptyError:t}=s.state;return{role:e,showEmptyError:t}}),[s]),M=(0,o.VK)((()=>t.getType()),[t]),j=(0,o.VK)((()=>s.state.flowId),[s]),C=(0,o.VK)((()=>t.canEditMembership()),[t]),w=(0,a.yK)((()=>({permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:20,margin:0,borderRadius:4,color:l.ZP.uiGray}})),[]);return(0,_.jsx)(p.ZP,{disableTooltip:C,renderTooltip:()=>{if(!C)return(0,_.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip",defaultMessage:"Only those with full access can add people."})},render:e=>(0,_.jsx)("div",{style:{display:"flex"},...e,children:(0,_.jsx)(g.Z,{store:t,inviteTargetsStore:f,disabled:!C,origin:n,flowId:j,focus:x===y.S.InviteInput,hideIconColorAndTooltips:!0,showEmptyError:b,onFocus:()=>{s.setState({...s.state,focus:y.S.InviteInput,emailMessage:S||""})},placeholder:d.formatMessage({id:"invite.person_property.inviteTargetsInput.placeholder",defaultMessage:"Add emails..."}),onInputChanged:()=>s.setState({...s.state,showEmptyError:!1}),right:(0,_.jsx)(m.ZP,{disabled:!C,role:v,table:"block",type:"user_permission",blockType:M,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:w.permissionsRoleSelectButton,isMenuItem:!1,onChange:e=>{s.setState({...s.state,role:e}),c.Om(u,{invited_role:e,invite_flow_id:j,origin:n})}})})})})}},13394:(e,t,s)=>{s.d(t,{S:()=>o,Z:()=>r});var n=s(49085),i=s(7032);let o=function(e){return e.InviteInput="invite_input",e.MessageInput="message_input",e.NoFocus="no_focus",e}({});class a extends n.default{getInitialState(){return{flowId:(0,i.ZP)(),role:"editor",focus:o.InviteInput,emailMessage:"",isLoading:!1,showEmptyError:!1}}}const r=a},12673:(e,t,s)=>{s.d(t,{v3:()=>xt,s5:()=>dt,ZP:()=>st});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(43593),l=s(79362),d=s(45238),c=s(85893);const u=(0,d.IU)("giphyLogo",{viewBox:"0 0 12 12",svg:(0,c.jsx)("path",{d:"M 1.332031 0 L 1.332031 12 L 10.667969 12 L 10.667969 4.332031 L 9.332031 5.667969 L 9.332031 10.667969 L 2.667969 10.667969 L 2.667969 1.335938 L 5 1.335938 L 6.332031 0 Z M 6.667969 0 L 6.667969 4 L 10.667969 4 L 10.667969 2.667969 L 9.332031 2.667969 L 9.332031 1.335938 L 8 1.335938 L 8 0 "})});var p=s(35840);const m=(0,d.IU)("shuffle",{viewBox:"0 0 16 16",svg:(0,c.jsx)("path",{d:"M0.162354 11.7542C0.162354 12.1365 0.458984 12.4067 0.867676 12.4067H2.41675C3.55054 12.4067 4.21631 12.0771 4.99414 11.1609L6.58936 9.26245L8.16479 11.1279C8.9624 12.0771 9.71387 12.4067 10.8477 12.4067H12.166V13.9954C12.166 14.3118 12.3572 14.4963 12.6736 14.4963C12.8186 14.4963 12.9504 14.4436 13.0625 14.3579L15.6465 12.2024C15.897 11.998 15.897 11.6816 15.6465 11.4641L13.0625 9.30859C12.9504 9.21631 12.8186 9.17017 12.6736 9.17017C12.3572 9.17017 12.166 9.34814 12.166 9.67114V11.095H10.8872C10.1094 11.095 9.60181 10.8379 9.0415 10.1655L7.43311 8.2605L9.0481 6.34888C9.62158 5.66992 10.083 5.42603 10.8477 5.42603H12.166V6.87622C12.166 7.19263 12.3572 7.3772 12.6736 7.3772C12.8186 7.3772 12.9504 7.32446 13.0625 7.23877L15.6465 5.08325C15.897 4.87891 15.897 4.5625 15.6465 4.34497L13.0625 2.18945C12.9504 2.09717 12.8186 2.05103 12.6736 2.05103C12.3572 2.05103 12.166 2.229 12.166 2.552V4.10767H10.8542C9.68091 4.10767 8.9624 4.43066 8.12524 5.43262L6.58936 7.25854L4.99414 5.36011C4.21631 4.44385 3.50439 4.11426 2.3772 4.11426H0.867676C0.458984 4.11426 0.162354 4.38452 0.162354 4.76685C0.162354 5.14917 0.458984 5.42603 0.867676 5.42603H2.32446C3.06274 5.42603 3.5769 5.68311 4.1438 6.35547L5.74561 8.2605L4.1438 10.1655C3.5769 10.8379 3.10229 11.095 2.37061 11.095H0.867676C0.458984 11.095 0.162354 11.3718 0.162354 11.7542Z"})});var g=s(11751);const h=(0,d.IU)("unsplashLogo",{viewBox:"0 0 12 12",svg:(0,c.jsx)("path",{d:"M3.75 3.375V0H8.25V3.375H3.75ZM8.25 5.25H12V12H0V5.25H3.75V8.625H8.25V5.25Z"})});var f=s(9291),x=s(97466),y=s(31701),S=s(53965),v=s(68425),b=s(57549),M=s(91584),j=s(96802),C=s(64964),w=s(53471),k=(s(57658),s(19889)),T=s(68657),I=s(80444),Z=s(6258),P=s(43250),F=s(24666),A=s(65187);function _(e){const{placeholder:t,onSubmit:s}=e,i=(0,a.yK)((e=>({wrap:{flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow,borderRadius:4,padding:"6px 10px",marginLeft:8,marginRight:8,overflow:"hidden",fontSize:14,..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},text:{minHeight:60},placeholder:{minHeight:60}})),[]),o=(0,n.useCallback)((e=>{if(s&&!e.shiftKey)s();else{if("editing"!==F.default.state.mode)return}}),[s]);return(0,c.jsx)("div",{style:i.wrap,className:P.Wh_,children:(0,c.jsx)(A.Z,{placeholder:t,disabled:!1,store:e.store,style:i.text,placeholderStyle:i.placeholder,pasteBehavior:"inline",disableSlashCommands:!0,disableEmbedMenu:!0,disableEmojiCommands:!0,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:o,disableMobileActionBar:!1,disabledMentionTypes:{reminder:!0},disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,inPageFind:{type:"none"}})})}var R=s(73657),O=s(72495),B=s(6202);function D(e){const{tab:t}=e,s=(0,i.O7)(),{store:o}=(0,T.Cl)({initialValue:void 0,onChange:S.yR}),r=(0,a.yK)((e=>({desktopStyle:{marginTop:8,marginBottom:6},sparkleStyle:{width:16,height:16,marginRight:4},captionStyle:{textAlign:s.device.isMobile?"left":"center"}})),[s.device.isMobile]),l=(0,n.useCallback)((async()=>{const s=o.getValue();if(!s)return;const n=[];for(const e of s){var i;if("‣"===e[0]&&null!==(i=e[1])&&void 0!==i&&i.length){if("d"===e[1][0][0]){const t=e[1][0][1].start_date;n.push(t)}else if("u"===e[1][0][0]){const t=e[1][0][1],{currentSpaceStore:s}=I.default.state;if(!s)return{users:[],bots:[]};const i=Z.U6.createChildStore(s,{table:k.KJ,id:t});await i.load();const o=i.getEmail();n.push(o||"")}}else n.push(e[0])}const a=n.join(""),r=t.integration;if(a){e.store.setState({...e.store.state,loading:!0});const s=await t.getResults(a,r);e.store.setState({...e.store.state,loading:!1,result:s.results})}}),[o,e.store,t]);return(0,c.jsxs)("div",{children:[(0,c.jsx)(O.Z,{desktopStyle:r.desktopStyle,children:(0,c.jsx)(_,{placeholder:e.placeholder,onSubmit:l,store:o})}),(0,c.jsx)(O.Z,{children:(0,c.jsx)(B.Z,{onClick:l,title:t.buttonText||(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Ask",id:"mediaPicker.aiSourcePickerTab.askButtonText"}),(0,c.jsx)("div",{children:(0,g.t)(r.sparkleStyle)})]}),fullWidth:e.isSmallWidth})}),t.caption&&(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:t.caption,style:r.captionStyle})]})}var L=s(52275),V=s(949),N=s(51077),E=s(68894),U=s(91839),W=s(78140),K=s(63296),z=s(89728),q=s(58297),G=s(30506),H=s(26388),Y=s(2520);const Q=(0,d.IU)("colorPickerCircle",{viewBox:"0 0 32 32",svg:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("circle",{cx:"16",cy:"16",r:"14",strokeWidth:"3",fill:"none"}),(0,c.jsx)("circle",{cx:"16",cy:"16",r:"14",opacity:"0.9"})]})});var $=s(13447),J=s(37181),X=s(72187),ee=s(98742),te=s(61766),se=s(31945),ne=s(73063),ie=s(1743),oe=s(32163),ae=s(86825);const re=(0,f.defineMessages)({selectSpecificIconColor:{defaultMessage:"Select icon color {iconColor}",id:"iconPickerColorPicker.selectSpecificColor"},selectIconColor:{defaultMessage:"Select icon color",id:"iconPickerColorPicker.selectColor"},selectIconColorWithCurrentColor:{defaultMessage:"Select icon color, {iconColor} selected",id:"iconPickerColorPicker.selectColorWithCurrentColor"},noIconColor:{defaultMessage:"no color",id:"iconPickerColorPicker.noColor"}});function le(){const e=(0,o.VK)((()=>{var e;return null===(e=I.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.icon_picker_color}),[]),t=(0,f.useIntl)(),s=(0,i.O7)(),n=(0,a.Fg)(),r=(0,i.Fy)(),d=(0,o.qz)(void 0,te.Z);return(0,c.jsx)(H.ZP,{renderTooltip:()=>t.formatMessage(re.selectIconColor),placement:H.ug.Bottom,render:i=>(0,c.jsx)(se.ZP,{preventBlockRenderQueueOnEnter:!0,buttonPopupStore:d,popupType:se.Z4.Popup,renderOrigin:s=>(0,c.jsx)(E.DO,{ariaLabel:t.formatMessage(re.selectIconColorWithCurrentColor,{iconColor:t.formatMessage(e?l.RR[e]:re.noIconColor)}),icon:t=>Q({...t,stroke:e?l.Lr[n.mode][e]:l.Lr[n.mode].lightgray,fill:e?l.Lr[n.mode][e]:n.lightIconColor}),...(0,ee.Z)(s,i)}),render:i=>function(e){const{parent:t,environment:s,currentIconPickerColor:n,theme:i,device:o,intl:a}=e,r=l.Oe.map((e=>({key:e,action:n=>{t.close(),de({environment:s,color:e})},render:t=>(0,c.jsx)(H.ZP,{renderTooltip:()=>a.formatMessage(l.RR[e]),placement:H.ug.Bottom,render:s=>(0,c.jsx)(ne.Z,{...(0,ee.Z)(s,t),ariaLabel:a.formatMessage(re.selectSpecificIconColor,{iconColor:a.formatMessage(l.RR[e])}),style:{...o.isMobile?{width:X.mz,height:X.mz}:{width:X.T8,height:X.T8}},icon:t=>Q({...t,height:o.isMobile?18:14,width:o.isMobile?18:14,stroke:l.Lr[i.mode][e],fill:l.Lr[i.mode][e]})})})})));return r.push({key:"askEveryTime",action:()=>{t.close(),de({environment:s,color:void 0})},render:e=>(0,c.jsx)(ae.Z,{...e,title:(0,c.jsx)(f.FormattedMessage,{id:"iconPickerColorPicker.askEveryTime",defaultMessage:"Ask every time"}),onClick:()=>{de(void 0!==n?{environment:s,color:void 0}:{environment:s,color:"gray"})},on:void 0===n,style:{boxShadow:void 0},textWrapperStyle:{marginLeft:o.isMobile?10:6},rightStyle:{marginRight:4}})}),(0,c.jsx)(ie.Z,{debugName:"IconPickerColorPicker",capture:!0,allowEsc:!0,children:(0,c.jsx)(oe.Z,{type:oe.i.Grid,itemsPerRow:5,initialFocus:n?Math.max(l.Oe.indexOf(n),0):10,sections:[{key:"variations",render:e=>(0,c.jsx)("div",{...e}),items:r}],renderRow:(e,t)=>(0,c.jsx)("div",{style:{display:"flex",padding:4,...t<2&&void 0===n&&{opacity:.5},...2===t&&{padding:"0 0 4px 0",flexDirection:"row-reverse"}},children:e},t)})})}({parent:i,environment:s,currentIconPickerColor:e,theme:n,device:r,intl:t})})})}function de(e){const{environment:t,color:s}=e,{currentUserSettingsStore:n}=I.default.state;n&&$.createAndCommit({userAction:"mediaPicker.setIconPickerColor",environment:t,perform:e=>{const t=void 0!==s?s:null;J.d2({userSettingsStore:n,transaction:e,data:{icon_picker_color:t}})}})}var ce=s(78948),ue=s(66957),pe=s(95477),me=s(23586),ge=s(92658),he=s(75375),fe=s(98534),xe=s(83620),ye=s(5385),Se=s(45567),ve=s(60709),be=s(75538),Me=s(49085);class je extends Me.default{getInitialState(){return{inputValue:"",focus:!1,result:void 0,loading:!1,hover:""}}}const Ce=je;var we=s(4391),ke=s(91390),Te=s(91694),Ie=s(88893),Ze=s(88280),Pe=s(3403),Fe=s(64921),Ae=s(12981),_e=s(16354),Re=s(81865),Oe=s(62385),Be=s(33929),De=s(77907);function Le(){const{device:e,WindowSizeStore:t}=(0,i.O7)(),s=(0,o.VK)((()=>e.isPhone),[e]),{phonePaddingLeft:n,phonePaddingRight:r}=(0,o.VK)((()=>({phonePaddingLeft:t.getSafePaddingLeftCSS(14),phonePaddingRight:t.getSafePaddingRightCSS(14)})),[t]);return(0,a.yK)((e=>({galleryWrap:{display:"flex",flexWrap:"wrap",alignContent:"flex-start",background:e.popoverBackground,paddingTop:s?12:0,paddingBottom:s?12:0,paddingLeft:s?n:12,paddingRight:s?r:12,boxShadow:s?`0 1px 0 ${e.regularDividerColor}`:""}})),[s,n,r])}function Ve(e){let{pageCover:t,tab:s}=e;const{coverUrl:i,title:o,subtitle:r,position:l}=t,d=(0,a.yK)((e=>({container:{width:"25%",padding:3},tooltip:{maxWidth:180,whiteSpace:"normal"},title:{color:e.regularInvertedTextColor},subtitle:{color:e.mediumInvertedTextColor},buttonHover:{opacity:.85},imageBox:{width:"100%",height:64,objectFit:"cover",objectPosition:`center ${100*(l||0)}%`,borderRadius:4}})),[l]),u=(0,n.useCallback)((()=>{s.onChange({url:i,position:l})}),[s,i,l]);return(0,c.jsx)("div",{style:d.container,children:(0,c.jsx)(H.ZP,{originGap:0,placement:H.ug.Bottom,delayThreshold:600,renderTooltip:()=>(0,c.jsxs)("div",{style:d.tooltip,children:[(0,c.jsx)("span",{style:d.title,children:Be.default.formatMessage(o)})," ",(0,c.jsx)("span",{style:d.subtitle,children:r&&Be.default.formatMessage(r)})]}),render:e=>(0,c.jsx)(Fe.Z,{hoveredStyle:d.buttonHover,...e,onClick:u,children:(0,c.jsx)(Re.Z,{url:i,width:200,isAuthenticated:!1,render:(e,t)=>t&&(0,c.jsx)(Ae.Z,{src:t,style:d.imageBox})})})})})}const Ne=function(e){let{tab:t}=e;const[s,i]=(0,n.useState)({}),[o,r]=(0,n.useState)(!1);(0,n.useEffect)((()=>{(async()=>{r(!0),await De.deps.pageCovers.loader().then((e=>{i(e.default),r(!1)}))})()}),[]);const l=Le(),d=(0,a.yK)((e=>({container:{paddingBottom:8},groupTitle:{marginLeft:-5},loader:{height:300}})),[]);return o?(0,c.jsx)("div",{style:d.loader,children:(0,c.jsx)(Pe.Z,{})}):(0,c.jsx)("div",{style:d.container,children:S.UI(s,((e,s)=>(0,c.jsx)(O.Z,{title:(0,c.jsx)(_e.Z,{style:d.groupTitle,href:e.url,external:!0,children:(0,c.jsx)(Oe.Z,{children:Be.default.formatMessage(e.title)})}),isTitleUppercase:!0,noTextOverflow:!0,children:(0,c.jsx)("div",{style:l.galleryWrap,children:e.items.map(((e,s)=>(0,c.jsx)(Ve,{pageCover:e,tab:t},s)))})},s)))})};var Ee=s(54642),Ue=s(68785),We=s(64369),Ke=s(42402),ze=s(75822);const qe=(0,f.defineMessages)({giphyPlaceholder:{id:"mediaPicker.giphyPlaceholder.text",defaultMessage:"Search GIPHY"}});function Ge(e){const{tab:t,results:s,ready:i,isSmallWidth:o,giphyRandomId:r}=e,l=(0,a.yK)((e=>({loading:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:320,flex:1},captionMenuItem:{textAlign:o?"left":"center",color:e.mediumTextColor}})),[o]);return i?!s||s&&!s.length?(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.giphy.noResultsText"}),style:l.captionMenuItem}):(0,c.jsxs)(n.Fragment,{children:[s.map(((e,s)=>(0,c.jsx)(He,{tab:t,image:e,giphyRandomId:r},s))),(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Search to find more results.",id:"mediaPicker.giphy.searchText"}),style:l.captionMenuItem})]}):(0,c.jsx)("div",{style:l.loading,children:(0,c.jsx)(Ue.Z,{})})}function He(e){var t;let{tab:s,image:o,giphyRandomId:r}=e;const l=(0,i.O7)(),{device:d}=l,u=(0,a.yK)((e=>({container:{width:d.isMobile?"33%":"25%",padding:3},hoveredButton:{opacity:.85},imageBox:{width:"100%",height:64,objectFit:"cover",objectPosition:"center 0%",borderRadius:4},label:{marginTop:2,marginBottom:4}})),[d.isMobile]),p=(0,n.useCallback)((async()=>{var e;if(s.onChange({url:o.imageUrl}),null!==(e=o.analytics)&&void 0!==e&&e.onclick)try{var t;await Ee.postGiphyAnalytics(l,{url:null===(t=o.analytics)||void 0===t?void 0:t.onclick.url,timestamp:Date.now(),random_id:r})}catch(n){}}),[l,r,o.imageUrl,s,null===(t=o.analytics)||void 0===t?void 0:t.onclick]);return(0,c.jsxs)("div",{style:u.container,children:[(0,c.jsx)(Fe.Z,{hoveredStyle:u.hoveredButton,onClick:p,children:(0,c.jsx)(Ae.Z,{src:o.thumbUrl,style:u.imageBox})}),(0,c.jsx)(We.Z,{isSmall:!0,isSecondaryColor:!0,style:u.label,children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"by <inlinetextlink>{authorName}</inlinetextlink>",id:"mediaPicker.giphy.byAuthor",values:{authorName:o.authorName||"GIPHY",inlinetextlink:e=>(0,c.jsx)(Ke.Z,{external:!0,href:o.imageUrl,children:e})}})})]},o.id)}const Ye=function(e){let{tab:t,isSmallWidth:s}=e;const[o,a]=(0,n.useState)(""),[r,l]=(0,n.useState)(""),d=(0,i.O7)(),{device:u}=d,p=Le(),m=(0,n.useCallback)((async()=>{if(!S.xb(o))return o;const e=await Ee.getGiphyRandomId(d,{});return"success"===e.type?(a(e.data.random_id),e.data.random_id):void 0}),[d,o]);return(0,c.jsxs)("div",{style:{paddingBottom:8},children:[(0,c.jsx)(O.Z,{desktopStyle:{marginTop:8,marginBottom:6},children:(0,c.jsx)(E.ZP,{value:r,placeholder:Be.default.formatMessage(qe.giphyPlaceholder),showClearButton:!0,focus:!u.isMobile||void 0,onChange:e=>l(e.target.value)})}),(0,c.jsx)("div",{style:p.galleryWrap,children:(0,c.jsx)(me.Z,{request:r,debounce:ze.vp,performRequest:async e=>{await m();const t=await Ee.searchGiphyImages(d,{query:e,page:0});if("success"===t.type)return t.data.results;throw t.error},render:(e,n,i)=>(0,c.jsx)(Ge,{tab:t,results:n,ready:i,isSmallWidth:s,giphyRandomId:o})})})]})};var Qe=s(79947);const $e=(0,f.defineMessages)({unsplashPlaceholder:{id:"mediaPicker.unsplashPlaceholder.text",defaultMessage:"Search for an image…"}});function Je(e){const{tab:t,results:s,ready:i,isSmallWidth:o}=e,r=(0,a.yK)((e=>({loading:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:320,flex:1},captionMenuItem:{textAlign:o?"left":"center",color:e.mediumTextColor}})),[o]);return i?!s||s&&!s.length?(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.unsplash.noResultsText"}),style:r.captionMenuItem}):(0,c.jsxs)(n.Fragment,{children:[s.map(((e,s)=>(0,c.jsx)(Xe,{tab:t,image:e},s))),(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Search to find more results.",id:"mediaPicker.unsplash.searchText"}),style:r.captionMenuItem})]}):(0,c.jsx)("div",{style:r.loading,children:(0,c.jsx)(Ue.Z,{})})}function Xe(e){let{tab:t,image:s}=e;const o=(0,i.O7)(),{device:a}=o,r=(0,n.useCallback)((async()=>{const e=await(0,Qe.ZP)({environment:o,url:s.downloadUrl,method:"GET",format:"json"});"success"===e.type&&t.onChange({url:e.data.url})}),[o,s.downloadUrl,t]);return(0,c.jsxs)("div",{style:{width:a.isMobile?"33%":"25%",padding:3},children:[(0,c.jsx)(Fe.Z,{hoveredStyle:{opacity:.85},onClick:r,children:(0,c.jsx)(Ae.Z,{src:s.thumbUrl,style:{width:"100%",height:64,objectFit:"cover",objectPosition:"center 0%",borderRadius:4}})}),(0,c.jsx)(We.Z,{isSmall:!0,isSecondaryColor:!0,style:{marginTop:2,marginBottom:4},children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"by <inlinetextlink>{authorName}</inlinetextlink>",id:"mediaPicker.unsplash.byAuthor",values:{authorName:s.authorName,inlinetextlink:e=>(0,c.jsx)(Ke.Z,{external:!0,href:s.unsplashUrl,children:e})}})})]},s.id)}const et=function(e){let{tab:t,isSmallWidth:s}=e;const[o,a]=(0,n.useState)(""),r=(0,i.O7)(),{device:l}=r,d=Le();return(0,c.jsxs)("div",{style:{paddingBottom:8},children:[(0,c.jsx)(O.Z,{desktopStyle:{marginTop:8,marginBottom:6},children:(0,c.jsx)(E.ZP,{value:o,placeholder:Be.default.formatMessage($e.unsplashPlaceholder),showClearButton:!0,focus:!l.isMobile||void 0,onChange:e=>a(e.target.value)})}),(0,c.jsx)("div",{style:d.galleryWrap,children:(0,c.jsx)(me.Z,{request:o,debounce:ze.vp,performRequest:async e=>{const t=await Ee.searchUnsplashImages(r,{query:e,page:0});if("success"===t.type)return t.data.results;throw t.error},render:(e,n,i)=>(0,c.jsx)(Je,{tab:t,results:n,ready:i,isSmallWidth:s})})})]})},tt=(0,f.defineMessages)({embedPlaceholder:{id:"mediaPicker.embedPlaceholder.text",defaultMessage:"Paste in https://…"},filterPlaceholder:{id:"mediaPicker.emojiFilter.text",defaultMessage:"Filter…"},aiSourcePickerPlaceholder:{id:"mediaPicker.githubPlaceholder.text",defaultMessage:"Ask query here"},aiIsFetchingLoader:{id:"mediaPicker.aiIsFetchingLoader.text",defaultMessage:"Ai is fetching"}});const st=function(e){var t,s;const a=(0,i.O7)(),r=(0,n.useRef)(null),d=(0,o.qz)(void 0,ge.Z),[u,p]=(0,n.useState)({inputValue:"",focus:!1}),[m,g]=(0,n.useState)({inputValue:"",focus:!1}),h=(0,o.qz)(void 0,we.Z),x=(0,o.qz)(void 0,Ce);function y(){const t=e.tabs.find((t=>t.type===e.currentTab));if(!t)return(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Uh oh! Something went wrong.",id:"mediaPicker.errorMessage"});switch(t.type){case"embed":return(0,c.jsx)(Mt,{isSmallWidth:e.isSmallWidth,embedInputStore:d,tab:t});case"file":return(0,c.jsx)(lt,{isSmallWidth:e.isSmallWidth,onCancel:e.onCancel,tab:t});case"emoji":return(0,c.jsx)(he.Z,{onSubmit:t.onChange,filter:u.inputValue||"",isCallout:e.isCallout,iconLoggingData:e.recordIconLoggingData,menuRef:r});case"icon":return(0,c.jsx)(Y.ZP,{store:h,filter:m.inputValue||"",onSubmit:t.onChange,iconLoggingData:e.recordIconLoggingData,enforceIconColor:t.enforceIconColor,menuRef:r});case"gallery":return(0,c.jsx)(Ne,{tab:t});case"unsplash":return(0,c.jsx)(et,{tab:t,isSmallWidth:e.isSmallWidth});case"giphy":return(0,c.jsx)(Ye,{tab:t,isSmallWidth:e.isSmallWidth});case"drive":return(0,c.jsx)(yt,{tab:t});case"box":return(0,c.jsx)(mt,{tab:t});case"aiSourcePicker":return(0,c.jsx)(St,{isSmallWidth:e.isSmallWidth,aiSourcePickerStore:x,tab:t});case"custom":return(0,c.jsx)(bt,{isSmallWidth:e.isSmallWidth,onCancel:e.onCancel,embedInputStore:d,tab:t})}}const v=null!=r&&null!==(t=r.current)&&void 0!==t&&t.offsetWidth?((null==r||null===(s=r.current)||void 0===s?void 0:s.offsetWidth)-24)/32:12,{device:b}=a,M=(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(ft,{tabs:e.tabs,onDelete:e.onDelete,currentTab:e.currentTab}),(0,c.jsx)(nt,{tabs:e.tabs,currentTab:e.currentTab,onFilterChange:e=>{const t=v*(a.device.isMobile?X.pq:X.II),s=v*(a.device.isMobile?Y.L6:Y.OF);p({...u,inputValue:e.currentTarget.value}),xe.Z.setState({...xe.Z.state,loadEmojiCount:t}),g({...m,inputValue:e.currentTarget.value}),h.setState({...h.state,loadIconCount:s})},iconInput:m.inputValue,emojiInput:u.inputValue,onRandomButtonClick:t=>{"emoji"===t.type?function(e,t,s){const{device:n}=s,i=e.find((e=>e.type===t));if(i&&"emoji"===i.type){const e=j.zM();i.onChange(e,{keepVisible:!n.isMobile})}}(e.tabs,e.currentTab,a):function(e,t,s,n){const{device:i}=e,o=t.find((e=>e.type===s));if(o&&"icon"===o.type){const e=o.enforceIconColor??ye.x(),t=`/icons/${S.UP(Object.keys(n.getState().allIcons))}_${e??S.UP(l.Oe)}.svg`;o.onChange(t,{keepVisible:!i.isMobile})}}(a,e.tabs,e.currentTab,h)}})]});let C;if(b.isMobile)C={menuType:ve.og.Modal,title:e.title,header:M,right:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Close",id:"mediaPicker.mobileCloseButton.label"}),onClickRight:e.onCancel,left:e.onDelete&&(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Remove",id:"mediaPicker.mobileRemoveButton.label"}),onClickLeft:e.onDelete};else{C={menuType:ve.og.Popup,header:M};const t=e.tabs.find((t=>t.type===e.currentTab)),s=t&&"custom"===t.type?t.tabHeight:void 0;C.width=e.popupWidth||300,C.height=s||e.popupHeight,C.maxHeight=e.maxHeight,C.maxWidth=e.maxWidth}return(0,c.jsx)(G.Z,{onSwipeLeft:()=>function(e,t){if(!ke.Z.state.isActive)return;const s=e.map((e=>e.type)).indexOf(ke.Z.state.currentTab),n=e[s+1];void 0!==n&&ht(n.type,t)}(e.tabs,a),onSwipeRight:()=>function(e,t){if(!ke.Z.state.isActive)return;const s=e.map((e=>e.type)).indexOf(ke.Z.state.currentTab),n=e[s-1];void 0!==n&&ht(n.type,t)}(e.tabs,a),render:e=>(0,c.jsx)(W.Z,{...C,...e,className:P.tQh,innerRef:r,children:y()})})};function nt(e){const t=(0,f.useIntl)(),{isPhone:s,isMobile:n,isAndroid:o}=(0,i.Fy)(),a=e.tabs.find((t=>t.type===e.currentTab));if(!a)return null;if("emoji"===a.type||"icon"===a.type){const i="emoji"===a.type?e.emojiInput:e.iconInput,r=()=>e.onRandomButtonClick(a),l=(0,c.jsx)(at,{tabs:e.tabs,currentTab:e.currentTab,hasRandomButtonOnLeft:!a.hideRandomButton});return(0,c.jsx)("div",{style:{display:"flex",...s?{}:{marginTop:16,marginBottom:10}},children:(0,c.jsx)(E.ZP,{value:i,placeholder:t.formatMessage(tt.filterPlaceholder),autoFocus:!n||void 0,focus:!n||void 0,showClearButton:!0,inputLeft:(0,c.jsx)(E.f_,{icon:p.R}),onChange:e.onFilterChange,right:(0,c.jsxs)("div",{style:{display:"flex"},children:[null!=a&&a.hideRandomButton?void 0:(0,c.jsx)(H.ZP,{renderTooltip:()=>(0,c.jsx)(f.FormattedMessage,{id:"mediaPicker.emojiTab.random",defaultMessage:"Random"}),placement:H.ug.Bottom,render:e=>(0,c.jsx)(E.DO,{icon:m,onClick:r,...e})}),l]}),isRightLastElementOfInput:!0,style:{...o&&{borderBottom:"none"}}})})}return null}function it(e){return e.fileUpload?Se.jo:e.imageUpload?Se.LR:e.videoUpload?Se.G7:void 0}async function ot(e,t){const s=await w.y({multiple:!1,accept:t});s.length&&e.onUpload(s[0])}function at(e){let{hasRandomButtonOnLeft:t,tabs:s,currentTab:n}=e;const i=s.find((e=>e.type===n));if(!i)return null;let o;return"emoji"===(null==i?void 0:i.type)?o=(0,c.jsx)(fe.Z,{}):"icon"===(null==i?void 0:i.type)&&void 0===i.enforceIconColor&&(o=(0,c.jsx)(le,{})),t&&o?(0,c.jsx)("div",{style:{marginLeft:6},children:o}):o??null}function rt(e){let{tab:t,isSmallWidth:s}=e;return t.imageUpload||t.videoUpload?(0,c.jsxs)(O.Z,{desktopStyle:{marginTop:4,display:"flex",justifyContent:"center",marginRight:12,marginLeft:12},children:[t.imageUpload&&(0,c.jsx)(K.Z,{isLarge:!0,onClick:()=>ot(t,"image/*"),style:{width:"100%"},children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Upload file",id:"mediaPicker.chooseImage.buttonText"})}),t.videoUpload&&(0,c.jsx)(B.Z,{title:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Choose a video",id:"mediaPicker.chooseVideo.buttonText"}),onClick:()=>ot(t,"video/*"),fullWidth:s})]}):null}function lt(e){let{tab:t,isSmallWidth:s,onCancel:n}=e;const r=(0,i.O7)(),l=(0,o.VK)((()=>Ze.subscriptionDataStoreInstance.state),[]),d=(0,a.yK)((e=>({dropzone:{background:(0,y.fn)([y.ZP.blueWithAlpha(.14),(0,x.Fq)(e.contentBackground,.5)])},caption:{textAlign:s?"left":"center",color:e.mediumTextColor},fileLimitWrapper:{display:"flex",alignItems:"center",justifyContent:s?"flex-start":"center"},fileLimitInner:{marginRight:6,color:e.mediumTextColor}})),[s]),u=(0,o.VK)((()=>be.default.isOnboarding.state),[]),p=(0,o.VK)((()=>Ie.M9(r)||"plus"),[r]);return(0,c.jsx)(V.Q,{type:it(t)??Se.gU,dropTargetKey:"uploadTab",onDropFile:e=>{if("invalidFileDrop"===e.type)return C.oV({label:(0,c.jsx)(f.FormattedMessage,{id:"mediaPicker.invalidImageDrop.wrongTypeErrorMessage",defaultMessage:"Sorry, that file type is not supported."})}),null;t.onUpload(e.file)},dropzoneStyle:d.dropzone,children:(0,c.jsxs)("div",{style:{marginTop:-24,paddingTop:24},children:[t.fileUpload&&(0,c.jsx)(O.Z,{desktopStyle:{marginTop:s?8:24},children:(0,c.jsx)(B.Z,{title:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Choose a file",id:"mediaPicker.chooseFile.button.label"}),onClick:()=>ot(t),fullWidth:s})}),(0,c.jsx)(rt,{isSmallWidth:s,tab:t}),t.caption&&(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:t.caption,style:d.caption}),t.preventUploadLimitFreeFileSize||l&&Ie.YK(l)&&(0,c.jsx)("div",{style:{height:8}}),l&&!t.preventUploadLimitFreeFileSize&&!Ie.YK(l)&&(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:(0,c.jsxs)("div",{style:d.fileLimitWrapper,children:[(0,c.jsx)("div",{style:d.fileLimitInner,children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"The maximum size per file is {filesize} MB.",id:"mediaPicker.maximumFileSize.notice",values:{filesize:w.K_}})}),!u&&(0,c.jsx)(Te.Z,{subscriptionTier:p,onClick:()=>{n&&n()},analyticsName:"media_picker",desktopStyle:{marginBottom:1}})]})})]})})}let dt=function(e){return e.Drive="drive",e.Docs="gDocs",e}({});function ct(e){let{tab:t,type:s}=e;return s===dt.Docs?(0,c.jsx)(pt,{tab:t}):(0,c.jsx)(ut,{tab:t})}function ut(e){let{tab:t}=e;const s=(0,a.yK)((e=>({buttonItem:{color:e.blueColor}})),[]);return(0,c.jsxs)(O.Z,{children:[(0,c.jsx)(L.Z,{title:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Connect Google account",id:"mediaPicker.menuItem.connectFirstGoogleAccount.label"}),onClick:()=>t.onSelect(),focused:!1,style:s.buttonItem}),(0,c.jsx)(R.Z,{shouldWrapCaption:!1,caption:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Find and embed your Google Drive files.",id:"mediaPicker.menuItem.connectFirstGoogleAccount.caption"})})]})}function pt(e){let{tab:t}=e;return(0,c.jsx)(O.Z,{children:(0,c.jsx)(L.Z,{title:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Connect Google account",id:"mediaPicker.menuItem.connectFirstGoogleAccount.label"}),onClick:()=>t.onSelect(),focused:!1})})}function mt(e){let{tab:t}=e;const s=(0,a.yK)((e=>({connectFirstAccountButton:{color:e.blueColor},connectSecondAccountButton:{color:e.mediumTextColor}})),[]),{accounts:n}=t;return 0===n.length?(0,c.jsxs)(O.Z,{children:[(0,c.jsx)(L.Z,{title:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Connect Box account",id:"mediaPicker.menuItem.connectFirstBoxAccount.label"}),onClick:()=>t.onSelect(),focused:!1,style:s.connectFirstAccountButton}),(0,c.jsx)(R.Z,{shouldWrapCaption:!1,caption:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Find and embed your Box files.",id:"mediaPicker.menuItem.connectFirstBoxAccount.caption"})})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(O.Z,{children:n.map((e=>(0,c.jsx)(L.Z,{title:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:e.account_name}}),onClick:()=>t.onSelect(e),focused:!1},e.account_key)))}),(0,c.jsx)(O.Z,{topBorder:!0,children:(0,c.jsx)(L.Z,{title:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreBoxAccounts.label"}),onClick:()=>t.onSelect(),style:s.connectSecondAccountButton,focused:!1})})]})}function gt(e,t){return()=>{e&&t.onChange(e)}}function ht(e,t){ke.Z.state.isActive&&(ke.Z.setState({...ke.Z.state,currentTab:e}),"icon"===e&&ke.Z.state.recordIconLoggingData&&v.kz(t,"select_icon_tab",ke.Z.state.recordIconLoggingData))}function ft(e){let{tabs:t,onDelete:s,currentTab:o}=e;const r=(0,a.yK)((e=>({sparklesIcon:{width:16,height:16,marginRight:4,color:e.accentColors.purple[400]}})),[]),l=(0,i.O7)(),{device:d}=l;if(t.length<=1&&!s)return null;{const e={gallery:(0,c.jsx)(f.FormattedMessage,{id:"mediaPicker.tabs.gallery",defaultMessage:"Gallery"}),embed:(0,c.jsx)(f.FormattedMessage,{id:"mediaPicker.tabs.embedLink",defaultMessage:"Embed link"}),file:(0,c.jsx)(f.FormattedMessage,{id:"mediaPicker.tabs.upload",defaultMessage:"Upload"}),emoji:(0,c.jsx)(f.FormattedMessage,{id:"mediaPicker.tabs.emoji",defaultMessage:"Emoji"}),icon:(0,c.jsx)(f.FormattedMessage,{id:"mediaPicker.tabs.icon",defaultMessage:"Icon"}),custom:(0,c.jsx)(f.FormattedMessage,{id:"mediaPicker.tabs.custom",defaultMessage:"Custom"}),unsplash:(0,c.jsxs)(n.Fragment,{children:[h({width:12,marginRight:4,height:12}),(0,c.jsx)("span",{children:"Unsplash"})]}),giphy:(0,c.jsxs)(n.Fragment,{children:[u({width:12,marginRight:4,height:12}),(0,c.jsx)("span",{children:"GIPHY"})]}),drive:(0,c.jsx)(f.FormattedMessage,{id:"mediaPicker.tabs.browse",defaultMessage:"Browse"}),box:(0,c.jsx)(f.FormattedMessage,{id:"mediaPicker.tabs.browse",defaultMessage:"Browse"}),aiSourcePicker:(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,c.jsx)(f.FormattedMessage,{id:"mediaPicker.tabs.ask",defaultMessage:"Ask"}),(0,g.t)(r.sparklesIcon)]})},i=t.findIndex((e=>e.type===o)),a=t.map((t=>t.title||e[t.type])),p=t.find((e=>e.type===o)),m=p&&"emoji"!==p.type&&d.isAndroid;return(0,c.jsx)(ue.Z,{tabs:a,selectedIndex:i,onChange:e=>{ht(t[e].type,l)},right:s&&!d.isMobile&&(0,c.jsx)(z.Z,{isGray:!0,onClick:s,children:(0,c.jsx)(f.FormattedMessage,{id:"mediaPicker.tabs.remove",defaultMessage:"Remove"})}),style:{...m&&{borderBottom:"none"}}})}}function xt(e){let{tab:t,accounts:s,type:i=dt.Drive}=e;const o=(0,a.yK)((e=>({buttonItem:{color:e.mediumTextColor}})),[]);return"accounts"in t?t.accounts&&0===t.accounts.length?(0,c.jsx)(ct,{tab:t,type:i}):(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(O.Z,{children:t.accounts.map(((e,s)=>(0,c.jsx)(L.Z,{title:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:e.account_name}}),onClick:()=>t.onSelect(e),focused:!1},e.account_key)))}),(0,c.jsx)(O.Z,{topBorder:!0,children:(0,c.jsx)(L.Z,{title:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreGoogleAccounts.label"}),onClick:()=>t.onSelect(),style:o.buttonItem,focused:!1})})]}):s?0===s.length?(0,c.jsx)(ct,{tab:t,type:i}):(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(O.Z,{children:s.map(((e,s)=>(0,c.jsx)(L.Z,{title:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:e.accountName}}),onClick:()=>t.onSelect(e),focused:!1},e.accountId)))}),(0,c.jsx)(O.Z,{topBorder:!0,children:(0,c.jsx)(L.Z,{title:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreGoogleAccounts.label"}),onClick:()=>t.onSelect(),style:o.buttonItem,focused:!1})})]}):null}function yt(e){let{tab:t}=e;const s=(0,i.O7)();return"accounts"in t?(0,c.jsx)(xt,{tab:t}):(0,c.jsx)(me.Z,{request:s,performRequest:M.vQ,render:(e,s,n)=>{if(!n)return(0,c.jsx)(O.Z,{children:(0,c.jsx)(ce.Z,{})});const i=s&&s.accounts?s.accounts:[];return(0,c.jsx)(xt,{tab:t,accounts:i})}})}function St(e){var t,s;let{tab:i,isSmallWidth:r,aiSourcePickerStore:l}=e;const d=(0,f.useIntl)(),u=(0,a.yK)((e=>({captionItem:{textAlign:r?"left":"center",color:e.mediumTextColor},aiResult:{cursor:"pointer",color:e.mediumTextColor,textAlign:"left",hyphens:"auto",padding:"10px 8px",display:"flex",flexDirection:"row"},aiTitleWrapper:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"rgb(55, 53, 47)",fontWeight:500,fontSize:"14px",paddingLeft:8},aiLoadingWrapper:{flex:1,color:e.accentColors.purple[400],fontWeight:500,flexDirection:"row",gap:6,display:"flex",alignItems:"center",padding:"12px 12px",marginLeft:10},loadingDots:{backgroundColor:e.accentColors.purple[400]}})),[r]),p=(0,o.qz)(l,Ce),m=(0,o.VK)((()=>p.state),[p]);return(0,c.jsxs)(n.Fragment,{children:[m.result&&!1===m.loading&&(0===(null===(t=m.result)||void 0===t?void 0:t.length)?(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.aiSourcePicker.noResultsText"}),style:u.captionItem}):null===(s=m.result)||void 0===s?void 0:s.map((e=>(0,c.jsxs)("div",{style:{...u.aiResult,backgroundColor:m.hover===e.url?"rgba(55,53,47,0.08)":""},onClick:gt(e.url,i),onMouseEnter:()=>{p.setState({...m,hover:e.url})},children:[(0,c.jsx)(N.Z,{imageURL:"NONE"===e.avatar?i.defaultAvatar:e.avatar,size:24,imageStyle:{borderRadius:34,boxShadow:"0 2px 4px rgba(15, 15, 15, 0.1)"},type:"image_url"}),(0,c.jsx)("div",{style:u.aiTitleWrapper,children:e.title})]},e.url)))),m.loading&&(0,c.jsxs)("div",{style:u.aiLoadingWrapper,children:[d.formatMessage(tt.aiIsFetchingLoader),(0,c.jsx)(U.Z,{style:u.loadingDots})]}),!m.result&&!m.loading&&(0,c.jsx)(D,{tab:i,placeholder:i.inputPlaceholder||d.formatMessage(tt.aiSourcePickerPlaceholder),store:p,isSmallWidth:r})]})}function vt(e,t,s){return()=>{const n=s.state.inputValue;if(n){const s=(0,r.Wv)(n,pe.default.secureFileS3.url,pe.default.secureFileS3V2.url,pe.default.secureFileConfig.rootPath,pe.default.secureFileConfig.hostname),i=s?s.link:n;e.onChange(i),b.bO(t,{pastedText:i,source:"media_picker"})}}}function bt(e){let{tab:t,isSmallWidth:s,onCancel:n,embedInputStore:r}=e;const l=(0,f.useIntl)(),d=(0,i.O7)(),u=(0,i.Fy)(),p=(0,o.VK)((()=>Ze.subscriptionDataStoreInstance.state),[]),m=(0,o.VK)((()=>Ie.M9(d)),[d]),g=(0,o.VK)((()=>r.state.inputValue),[r]),h=(0,o.VK)((()=>be.default.isOnboarding.state),[]),S=(0,a.yK)((e=>({dropZone:{background:(0,y.fn)([y.ZP.blueWithAlpha(.14),(0,x.Fq)(e.contentBackground,.5)])},caption:{textAlign:s?"left":"center",color:e.mediumTextColor},subscriptionLimitWrapper:{display:"flex",alignItems:"center",justifyContent:s?"flex-start":"center"},subscriptionLimitInner:{marginRight:6,color:e.mediumTextColor}})),[s]),v=(0,c.jsx)(q.Z,{onClick:vt(t,d,r),disabled:0===g.length,hovered:!1,children:t.buttonText||(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Link",id:"mediaPicker.embedTab.embedLinkButtonText"})}),b=(0,c.jsx)(O.Z,{desktopStyle:{marginTop:16,display:"flex",paddingTop:0,paddingBottom:12},children:(0,c.jsx)(E.ZP,{type:"url",value:g,placeholder:t.inputPlaceholder||l.formatMessage(tt.embedPlaceholder),autoFocus:!u.isMobile||void 0,showClearButton:!0,focus:!u.isMobile||void 0,onSubmit:vt(t,d,r),onChange:e=>{r.setState({...r.state,inputValue:e.target.value})},inputRight:u.isPhone?v:void 0,right:u.isPhone?void 0:v,isRightLastElementOfInput:!0})}),M=(0,c.jsx)(V.Q,{type:it(t)??Se.gU,dropTargetKey:"uploadTab",onDropFile:e=>{if("invalidFileDrop"===e.type)return C.oV({label:(0,c.jsx)(f.FormattedMessage,{id:"mediaPicker.invalidImageDrop.wrongTypeErrorMessage",defaultMessage:"Sorry, that file type is not supported."})}),null;t.onUpload(e.file)},dropzoneStyle:S.dropZone,children:(0,c.jsxs)("div",{style:{marginTop:-24,paddingTop:24},children:[t.fileUpload&&(0,c.jsx)(O.Z,{desktopStyle:{marginTop:s?8:24},children:(0,c.jsx)(B.Z,{title:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Choose a file",id:"mediaPicker.chooseFile.button.label"}),onClick:()=>ot(t),fullWidth:s})}),(0,c.jsx)(rt,{isSmallWidth:s,tab:t}),t.caption&&(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:t.caption,style:S.caption}),t.preventUploadLimitFreeFileSize||p&&Ie.YK(p)&&(0,c.jsx)("div",{style:{height:8}}),p&&!t.preventUploadLimitFreeFileSize&&!Ie.YK(p)&&(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:(0,c.jsxs)("div",{style:S.subscriptionLimitWrapper,children:[(0,c.jsx)("div",{style:S.subscriptionLimitInner,children:(0,c.jsx)(f.FormattedMessage,{defaultMessage:"The maximum size per file is {filesize} MB.",id:"mediaPicker.maximumFileSize.notice",values:{filesize:w.K_}})}),!h&&(0,c.jsx)(Te.Z,{subscriptionTier:m||"plus",onClick:()=>{n&&n()},analyticsName:"media_picker",desktopStyle:{marginBottom:1}})]})})]})});return(0,c.jsxs)(c.Fragment,{children:[b,M]})}function Mt(e){let{tab:t,isSmallWidth:s,embedInputStore:a}=e;const r=(0,i.O7)(),l=(0,f.useIntl)(),{device:d}=r,u=(0,o.VK)((()=>a.state.inputValue),[a]);return(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(O.Z,{desktopStyle:{marginTop:8,marginBottom:6},children:(0,c.jsx)(E.ZP,{type:"url",value:u,placeholder:t.inputPlaceholder||l.formatMessage(tt.embedPlaceholder),autoFocus:!d.isMobile||void 0,showClearButton:!0,focus:!d.isMobile||void 0,onSubmit:vt(t,r,a),onChange:e=>{a.setState({...a.state,inputValue:e.target.value})}})}),(0,c.jsx)(O.Z,{children:(0,c.jsx)(B.Z,{onClick:vt(t,r,a),title:t.buttonText||(0,c.jsx)(f.FormattedMessage,{defaultMessage:"Link",id:"mediaPicker.embedTab.embedLinkButtonText"}),fullWidth:s})}),t.caption&&(0,c.jsx)(R.Z,{shouldWrapCaption:!0,caption:t.caption,style:{textAlign:d.isMobile?"left":"center"}})]})}},35868:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{open:!1}}}const o=new i},24764:(e,t,s)=>{s.d(t,{t:()=>M,Z:()=>v});s(67294);var n=s(92996),i=s(98519),o=s(9291),a=s(1898),r=s(62967),l=s(57883),d=s(19719),c=s(9953),u=s(13447);function p(e){const{environment:t,key:s,selectedKey:n,following:i,followSettings:o,navigableBlockId:a,userId:r,spaceId:p,from:m}=e;u.createAndCommit({userAction:"UpdateSidebarFollowControl.setFollowing",environment:e.environment,canUndo:!1,perform:t=>{c.Ue({environment:e.environment,table:l.t0,args:{following:i,followSettings:o,navigableBlockId:a,userId:r,spaceId:p},inMemoryRecordCache:e.environment.defaultRecordCache.inMemoryRecordCache,transaction:t})}}),i?d.RJ(t,{from:"page_updates"}):d.ub(t,{from:"page_updates"}),n!==s&&d.kL(t,{from:m,navigableBlockId:a,oldSetting:n,newSetting:s})}var m=s(64964),g=s(93405),h=s(64369),f=s(80444),x=s(57538),y=s(85893);const S=(0,o.defineMessages)({repliesAndMentions:{id:"pageNotificationSettings.repliesAndMentions.displayName",defaultMessage:"Mentions"},comments:{id:"pageNotificationSettings.comments.displayName",defaultMessage:"Comments"},allUpdates:{id:"pageNotificationSettings.allUpdates.displayName",defaultMessage:"All"},importantUpdates:{id:"pageNotificationSettings.importantUpdates.displayName",defaultMessage:"Important"}});function v(e){const{followSettingsKey:t,environment:s,blockStore:i,from:a}=e,r=b({key:"none",selectedKey:t,title:(0,y.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.repliesAndMentions.label",defaultMessage:"Replies and @mentions"}),displayName:S.repliesAndMentions,environment:s,blockStore:i,from:a}),l=b({key:"comments",selectedKey:t,title:(0,y.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.allComments.label",defaultMessage:"All comments"}),displayName:S.comments,environment:s,blockStore:i,from:a}),d=b({key:"all",selectedKey:t,title:(0,y.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.allUpdates.label",defaultMessage:"All updates"}),caption:(0,y.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.simpleAllUpdates.caption",defaultMessage:"All comments and property changes"}),displayName:S.allUpdates,environment:s,blockStore:i,from:a}),c=i.getAssociatedCollectionStore();if(!c)return[l,r];const u=c.getDatabaseType();if(u===n.iS){return[d,b({key:"important",selectedKey:t,title:(0,y.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesTasks.label",defaultMessage:"Important updates"}),caption:(0,y.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesTasks.caption",defaultMessage:"All comments and changes to Status, Assignee, or Due Date"}),displayName:S.importantUpdates,environment:s,blockStore:i,from:a}),r]}if(u===n.wW){return[d,b({key:"important",selectedKey:t,title:(0,y.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesProjects.label",defaultMessage:"Important updates"}),caption:(0,y.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesProjects.caption",defaultMessage:"All comments and changes to Status or Date"}),displayName:S.importantUpdates,environment:s,blockStore:i,from:a}),r]}return[d,b({key:"comments",selectedKey:t,title:(0,y.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.onlyCommentsAllComments.label",defaultMessage:"All comments"}),displayName:S.comments,environment:s,blockStore:i,from:a}),r]}function b(e){const{key:t,title:s,caption:n,selectedKey:o,environment:a,blockStore:l,from:d,displayName:c}=e,u=M({key:t,userSelectedKey:o}),S={icon:{width:14,height:14},rightWrapper:n?{alignSelf:"flex-start",paddingTop:2}:{}};return{action:(0,r.cN)({key:t,displayName:c,analyticsName:t,validators:[],closeParentMenu:!0,action:()=>{const{currentUserRootStore:e}=f.default.state;if(e){const{following:s,followSettings:n}=(0,x.Z)(t),i=e.id,r=l.id,c=l.getSpaceId();p({environment:a,following:s,followSettings:n,navigableBlockId:r,spaceId:c,userId:i,from:d,key:t,selectedKey:o}),"inbox"!==d&&"more_menu"!==d||m.d4({item:{label:j(t)},undoFunc:()=>{const{following:e,followSettings:s}=(0,x.Z)(o);p({environment:a,following:e,followSettings:s,navigableBlockId:r,spaceId:c,userId:i,from:d,key:t,selectedKey:o})}})}},render:e=>(0,y.jsx)(g.Z,{...e,title:(0,y.jsx)(h.Z,{children:s}),caption:n,shouldWrapCaption:!0,right:u?(0,i.k)(S.icon):(0,y.jsx)("div",{style:S.icon}),rightStyle:S.right})}),title:s,isSelectedOption:u}}function M(e){const{key:t,userSelectedKey:s}=e;return"important"===s||"comments"===s?"important"===t||"comments"===t:t===s}function j(e){switch(e){case"none":return(0,y.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.subscribedRepliesAndMentionsSuccess.snackbarMessage",defaultMessage:"Subscribed to replies and @mentions"});case"comments":return(0,y.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.subscribedAllCommentsSuccess.snackbarMessage",defaultMessage:"Subscribed to all comments"});case"important":return(0,y.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.subscribedImportantUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to important updates"});case"all":return(0,y.jsx)(o.FormattedMessage,{id:"GetNotifiedDropdown.subscribedAllUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to all updates"});default:(0,a.t1)(e)}}},650:(e,t,s)=>{s.r(t),s.d(t,{default:()=>D});var n=s(67294),i=s(13991),o=s(480),a=s(86628),r=s(24405),l=s(45238),d=s(85893);const c=(0,l.IU)("checkedRoundedCheckmark",{viewBox:"0 0 16 16",svg:(0,d.jsx)("path",{d:"M7.99617 16C12.3807 16 15.9923 12.3807 15.9923 7.99617C15.9923 3.61167 12.373 0 7.99617 0C3.61167 0 0 3.61167 0 7.99617C0 12.3807 3.61167 16 7.99617 16ZM7.99617 14.2018C4.5605 14.2018 1.80583 11.4319 1.80583 7.99617C1.80583 4.5605 4.55285 1.79818 7.99617 1.79818C11.4319 1.79818 14.1942 4.5605 14.2018 7.99617C14.2018 11.4319 11.4319 14.2018 7.99617 14.2018ZM7.18508 11.6461C7.47585 11.6461 7.73601 11.4931 7.912 11.2329L11.3324 5.96078C11.4395 5.79244 11.5237 5.60115 11.5237 5.42516C11.5237 5.01196 11.1564 4.72119 10.7585 4.72119C10.506 4.72119 10.2841 4.86657 10.1081 5.14969L7.16212 9.84027L5.80775 8.14921C5.6241 7.912 5.43281 7.82783 5.18795 7.82783C4.7824 7.82783 4.45337 8.14921 4.45337 8.56241C4.45337 8.76136 4.52224 8.93735 4.66762 9.12099L6.42755 11.2406C6.6418 11.5084 6.87901 11.6461 7.18508 11.6461Z"})});var u=s(64275),p=s(68211),m=s(1436),g=s(9291),h=s(37810),f=s(86615),x=s(12714),y=s(61202),S=s(66309),v=s(64921),b=s(61519),M=s(84076),j=s(58297),C=s(64369),w=s(6175),k=s(95477),T=s(15010),I=s(18514),Z=s(48779),P=s(80444),F=s(77080),A=s(85844),_=s(84437),R=s(59110),O=s(91264);function B(e){let{launchModalPhase:t,renderChild:s}=e;const i=(0,o.O7)();return(0,n.useEffect)((()=>{"connected_notion_calendar"===t?f.Wy(i):f.QL(i)}),[i,t]),s()}const D=function(){const e=(0,o.O7)(),t=(0,r.yK)((e=>({container:{maxWidth:442},closeButton:{position:"absolute",top:12,right:12,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:18,height:18},closeButtonHovered:{background:e.buttonPressedBackground},closeIcon:{width:14,fill:e.mediumTextColor},content:{padding:24,display:"flex",flexDirection:"column"},title:{fontWeight:h.Z.fontWeight.bold,fontSize:25,display:"flex",marginBottom:6},divider:{backgroundColor:e.tableLightDividerColor,opacity:.5},footer:{padding:"20px 24px",display:"flex",alignItems:"center",justifyContent:"space-between"},learnMoreLink:{display:"flex",alignItems:"center",fontSize:12,color:e.mediumTextColor,padding:"0 4px",marginLeft:-4},externalLinkIcon:{width:14,height:14,marginLeft:2},successCheckmark:{width:50,height:50,display:"flex",alignItems:"center",justifyContent:"center"},successCheckmarkIcon:{width:32,height:32,color:e.mediumTextColor},successTitle:{fontSize:25,fontWeight:h.Z.fontWeight.bold,margin:"8px 0"},downloadContainer:{display:"flex",padding:"16px 20px",marginTop:28,borderRadius:12,background:e.cardBackground},downloadContent:{display:"flex",flexDirection:"column",paddingRight:8},downloadTitle:{fontSize:16,fontWeight:h.Z.fontWeight.semibold,marginBottom:4},downloadButtonContainer:{display:"flex"},downloadButton:{height:32,marginTop:12},notionCalendarLogo:{display:"flex",alignSelf:"end"},notionCalendarLogoIcon:{width:56,height:58}})),[]);(0,n.useEffect)((()=>{const t=()=>{A.Z.state.isVisible&&R.Z.state.isConnectingCalendar&&(R.Z.setState({isConnectingCalendar:!1}),y.pJ({environment:e}))};return A.Z.addListener(t),()=>{A.Z.removeListener(t)}}),[e]);const s=(0,n.useCallback)((()=>{const{currentUserSettingsStore:t}=P.default.state;t&&(_.tE({environment:e,userSettingsStore:t}),R.Z.setState({isForceShowing:!1}))}),[e]),l=(0,n.useCallback)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:s}=P.default.state;t&&s&&(_.WS(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.openCalendar",userSettingsStore:t}),R.Z.setState({isForceShowing:!1}))}),[e]),D=(0,n.useCallback)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:s}=P.default.state;t&&s&&_.WS(e,{phase:"connected_notion_calendar",transactionUserAction:"NotionCalendarLaunchModal.continueWithGoogle",userSettingsStore:t})}),[e]),L=(0,n.useCallback)((()=>{const{currentUserSettingsStore:t}=P.default.state;t&&(_.WS(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.clickDownload",userSettingsStore:t}),R.Z.setState({isForceShowing:!1}))}),[e]),V=(0,a.VK)((()=>P.default.state.currentUserSettingsStore),[]),N=(0,a.VK)((()=>{const e=null==V?void 0:V.getSettings();return null==e?void 0:e.notion_calendar_launch_modal_phase}),[V]),E=(0,a.VK)((()=>{if(!V)return!1;const e=(0,T.e2)(V);return Number(e)>=4}),[V]),U=(0,a.VK)((()=>{var t;const{currentUserSettingsStore:s,currentSpaceStore:n,mainEditorCurrentBlockStore:i}=P.default.state;if(e.device.isMobile)return!1;if(Z.Cx(n))return!1;if(!s||!s.isReady())return!1;return!!s.getSettings()&&(!!(n&&i&&i.canRead())&&(!!R.Z.state.isForceShowing||!!F.default.checkGate("notion_calendar_launch_modal")&&((null===(t=P.default.state.currentSpaceStore)||void 0===t||!t.isNotionCalendarDisabledOnSpace())&&(!!E&&(e.device.isElectron?void 0===N:void 0===N||"connected_notion_calendar"===N)))))}),[e,N,E]),W=()=>(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(v.Z,{onClick:s,style:t.closeButton,hoveredStyle:t.closeButtonHovered,children:(0,u.D)(t.closeIcon)}),(0,d.jsxs)("div",{style:t.content,children:[(0,d.jsx)("div",{style:t.successCheckmark,children:c(t.successCheckmarkIcon)}),(0,d.jsx)("div",{style:t.successTitle,children:(0,d.jsx)(g.FormattedMessage,{defaultMessage:"Success!",id:"notionCalendarLaunchModal.successTitle"})}),(0,d.jsx)(C.Z,{isSecondaryColor:!0,isMultiline:!0,children:(0,d.jsx)(g.FormattedMessage,{defaultMessage:"You can now view Notion docs, projects, tasks, and timelines alongside calendar events on Notion Calendar",id:"notionCalendarLaunchModal.successCaption"})}),(0,d.jsxs)("div",{style:t.downloadContainer,children:[(0,d.jsxs)("div",{style:t.downloadContent,children:[(0,d.jsx)("div",{style:t.downloadTitle,children:(0,d.jsx)(g.FormattedMessage,{defaultMessage:"Get the desktop app",id:"notionCalendarLaunchModal.downloadTitle"})}),(0,d.jsx)(C.Z,{isSecondaryColor:!0,isMultiline:!0,children:(0,d.jsx)(g.FormattedMessage,{defaultMessage:"See notifications, view your schedule, and join meetings from anywhere",id:"notionCalendarLaunchModal.downloadCaption"})}),(0,d.jsx)("div",{style:t.downloadButtonContainer,children:(0,d.jsx)(j.Z,{style:t.downloadButton,onClick:()=>{f.G(e,{cta:"download"}),x.D({environment:e,url:k.default.calendar.downloadUrl}),L()},children:(0,d.jsx)(g.FormattedMessage,{...O.v.downloadApp})})})]}),(0,d.jsx)("div",{style:t.notionCalendarLogo,children:(0,p.D)(t.notionCalendarLogoIcon)})]})]})]}),K=()=>(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(w.Z,{src:"https://player.vimeo.com/video/900939588?h=187435ef3c",defaultTextTrack:w.W[i.SP]||"en",options:{muted:!0,autoplay:!0,loop:!0,background:!0,playsinline:!0}}),(0,d.jsx)(v.Z,{onClick:s,style:t.closeButton,hoveredStyle:t.closeButtonHovered,children:(0,u.D)(t.closeIcon)}),(0,d.jsxs)("div",{style:t.content,children:[(0,d.jsx)("div",{style:t.title,children:(0,d.jsx)(g.FormattedMessage,{defaultMessage:"Meet Notion Calendar",id:"notionCalendarLaunchModal.title"})}),(0,d.jsx)(C.Z,{isSecondaryColor:!0,isMultiline:!0,children:(0,d.jsx)(g.FormattedMessage,{defaultMessage:"The beautifully designed calendar for your life and work. Integrated and synced with all your Google Calendar events.",id:"notionCalendarLaunchModal.caption"})})]}),(0,d.jsx)(b.Z,{size:1,style:t.divider}),(0,d.jsxs)("div",{style:t.footer,children:[(0,d.jsxs)(M.Z,{external:!0,href:(0,I.UY)("blog.notionCalendarLaunch"),style:t.learnMoreLink,children:[(0,d.jsx)(g.FormattedMessage,{defaultMessage:"Learn more",id:"notionCalendarLaunchModal.learnMore"}),(0,m.g)(t.externalLinkIcon)]}),(0,d.jsx)(O.Z,{openCalendarFrom:"onboardingModalOpenCalendar",continueWithGoogleFrom:"onboardingModalSignIn",onOpenCalendarClick:()=>{f.Et(e,{cta:"open_calendar"}),l()},onContinueWithGoogleClick:()=>{f.Et(e,{cta:"continue_with_google"}),D()},onDownloadClick:()=>{f.Et(e,{cta:"download"}),L()}})]})]});return(0,d.jsx)(S.default,{shouldShow:U,calloutId:"notion_calendar_launch_promo",desktopRenderInner:()=>(0,d.jsx)(B,{launchModalPhase:N,renderChild:()=>"connected_notion_calendar"===N?W():K()}),desktopInnerStyle:t.container,desktopOnDismiss:s,phoneRenderInner:()=>null})}},36214:(e,t,s)=>{s.d(t,{FI:()=>k,sM:()=>w,vY:()=>T});s(21703),s(57658);var n=s(45953),i=(s(21202),s(75246),s(11002)),o=s(27095),a=s(73314),r=s(9291),l=s(53965),d=(s(7032),s(32441)),c=s(54642),u=s(54532),p=s(4617),m=s(9953),g=s(4408),h=s(28014),f=s(13447),x=s(88833),y=(s(95477),s(33929)),S=s(48779),v=s(27249),b=s(80444),M=s(88632),j=s(77080);const C=(0,r.defineMessages)({invalidSpaceStore:{defaultMessage:"Invalid space data.",id:"spaceActions.dialogError.createTemplatesInSpace.invalidStorage.message"},invalidSpaceStoreOnCreateTemplate:{defaultMessage:"Invalid space view data.",id:"spaceActions.dialogError.createTemplatesInWorkspace.invalidStorage.message"},invalidUserSettings:{defaultMessage:"Invalid user settings data.",id:"spaceActions.dialogError.createTemplatesInWorkspace.invalidUserSettings.message"}});async function w(e){const{environment:t,spaceViewStore:s,isPrivate:n,userSettingsStore:i,redirectData:o,userRootStore:a,planType:r,spaceJoinOrCreate:c,teamStore:u,templates:g,personaTeamStore:M,isNewUserOnboarding:w}=e,T=s.getSpaceStore();if(!T)throw new Error(y.default.formatMessage(C.invalidSpaceStore));let I;if(i&&T&&g&&await async function(e){const{spaceStore:t,spaceViewStore:s,userSettingsStore:n,teamStore:i}=e;if(await Promise.all(l.oA([t.load(),s.load(),n.load(),null==i?void 0:i.load()])),t.canEdit()){if(!s.isDefined())throw new Error(y.default.formatMessage(C.invalidSpaceStoreOnCreateTemplate));if(!n.isDefined())throw new Error(y.default.formatMessage(C.invalidUserSettings));if(!s.getCreatedOnboardingTemplates()){const t=await async function(e){const{environment:t,spaceStore:s,spaceViewStore:n,isPrivate:i,teamStore:o,personaTeamStore:a,templateType:r}=e;let d=[];if("page_template"===r&&e.templates){const a=e.templates.map((e=>o?p.rC({environment:t,item:e,isPrivate:!1,spaceStore:s,spaceViewStore:n,useMinimalTemplates:!0,teamStore:o,type:"inTeam",from:"onboarding",isOnboarding:!0}):p.rC({environment:t,item:e,isPrivate:i,spaceStore:s,spaceViewStore:n,useMinimalTemplates:!0,type:"inSpace",isOnboarding:!0})));d=l.oA(await Promise.all(a))}else"app_template"===r&&e.templates&&o&&(d=await x.installAppsInTeam({environment:t,presets:e.templates,spaceStore:s,spaceViewStore:n,teamStore:o}));const{function:c}=(0,S.kO)();if(a&&c){let e=[];["product","marketing","sales","eng"].includes(c)&&(e=(0,v.CN)(c,j.default,y.default.getIntl()));const i=e.map((e=>p.rC({environment:t,item:e,isPrivate:!1,spaceStore:s,spaceViewStore:n,useMinimalTemplates:!0,teamStore:a,type:"inTeam",from:"onboarding",isOnboarding:!0})));d=[...d,...l.oA(await Promise.all(i))]}e.templates&&e.templates.length>0&&f.createAndCommit({userAction:"spaceActions.createOnboardingTemplatesInSpace",environment:t,perform:e=>{const t={created_onboarding_templates:!0};m.sW({store:n,data:t,transaction:e})}});return d}({...e});return t}}return[]}({...e,spaceStore:T,userSettingsStore:i,teamStore:u,personaTeamStore:M}),i)I=await async function(e){const{environment:t,spaceStore:s,spaceViewStore:n,userSettingsStore:i,planType:o,spaceJoinOrCreate:a,isNewUserOnboarding:r}=e;if(await Promise.all([s.load(),n.load(),i.load()]),s.canEdit()){if(!n.isDefined())throw new Error(y.default.formatMessage(C.invalidSpaceStoreOnCreateTemplate));if(!i.isDefined())throw new Error(y.default.formatMessage(C.invalidUserSettings));let e;if(e=t.device.isMobile?"mobile":"personal"===o?"desktopPersonal":"create"===a?function(e){if(!e)return"desktopTeamCreate";if("on"===j.default.getEligibleGroup({defaultGroup:"control",experimentId:"simplified_getting_started"}))return"desktopPersonal";return"desktopTeamCreate"}(r):"desktopTeamJoin",!n.getCreatedGettingStarted())return k({environment:t,spaceStore:s,spaceViewStore:n,type:e,userSettingsStore:i});d.VU(t,{getting_started_page_type:e,spaceId:s.id,errorType:"createdGettingStartedPageAlreadyExists"})}}({isNewUserOnboarding:w,environment:t,spaceStore:T,spaceViewStore:s,userSettingsStore:i,planType:r,spaceJoinOrCreate:c});else{const{currentUserSettingsStore:e}=b.default.state;d.VU(t,{errorType:"userSettingsStoreNotDefined",spaceId:T.id,errorMessage:e?"currentUserSettingsStore is defined but not userSettingsStore from onboarding data":"currentUserSettingsStore is not defined as well"})}return await async function(e){const{environment:t,spaceViewStore:s,isPrivate:n,redirectData:i,userRootStore:o,spaceStore:a,createdGettingStartedPage:r}=e;if("fork_page"===i.type){return await h.ux({environment:t,userRootStore:o,isPrivate:n,forkedPageId:i.pageId,spaceStore:a,spaceViewStore:s})}return r}({environment:t,redirectData:o,spaceViewStore:s,spaceStore:T,userRootStore:a,isPrivate:n,createdGettingStartedPage:I})}async function k(e){const{environment:t,type:s,spaceStore:i,spaceViewStore:r,userSettingsStore:l}=e;if(!M.Z.state.online)return;const p=function(e,t){return(0,a.G)(o.S$[e],t)}(s,y.default.getIntl()).rootId,x=await c.loadBlockSubtree(t,{block:{id:p,spaceId:i.id},shallow:!1});let S;if("failed"===x.type)return void d.VU(t,{getting_started_page_type:s,errorType:"loadBlockSubtreeFailed",spaceId:i.id,errorMessage:x.error.message,copyPageId:p});S=n.PF.create(x.data.subtreeRecordMap);const v="spaceActions.createGettingStartedPageInSpace",{performResult:b}=f.createAndCommit({userAction:v,environment:t,perform:e=>{const n=h.KE({environment:t,spaceStore:i,spaceViewStore:r,isPrivate:!0,prepend:!0,transaction:e});g.fL({environment:t,inMemoryRecordCache:n.inMemoryRecordCache,recordMap:S,debugSource:v});const o=u.K8(t,{blockId:p,inMemoryRecordCache:n.inMemoryRecordCache,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!1,allowCopyExternalObjectInstances:!0});if(!o)throw d.VU(t,{getting_started_page_type:s,errorType:"createAndDuplicatePageFailed",spaceId:i.id}),new Error(y.default.formatMessage(h.sY.createAndDuplicatePageError));u.E9({environment:t,sourceBlockId:p,targetBlockPointer:n.pointer,sourceBlockSubtree:o,targetInMemoryRecordCache:n.inMemoryRecordCache,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:n.useCrdt()});const a={},c={};return"evernote"===s?c.created_evernote_getting_started=!0:a.created_getting_started=!0,Object.keys(a).length>0&&m.sW({store:r,data:a,transaction:e}),Object.keys(c).length>0&&m.sW({store:l.getSettingsStore(),data:c,transaction:e}),n}});return d.yv(t,{getting_started_page_type:s,getting_started_page_id:p,duplicated_from_page_id:p,duplicated_to_page_id:b.id}),b}function T(e,t,s){const n="on"===j.default.getEligibleGroup({defaultGroup:"control",experimentId:"post_signup_onboarding_revamp"});let i;return i="school"===e?n?I(e,t):F:"personal"===e?n?I(e,t):P:A,(0,a.H)(i,s)}function I(e,t){const s=[];if(!t)return s;for(const i of t)s.push(Z[i]);const n="school"===e?R:_;if(s.length<4)for(const i of n)if(!s.includes(i)&&(s.push(i),s.length>=4))break;return s}const Z={planner:i.Y.onboardingPlanner,notes:i.Y.onboardingNotes,research:i.Y.onboardingResearch,clubs:i.Y.onboardingClubs,teachingLessonPlans:i.Y.onboardingTeachingLessonPlans,teachingClassroomManagement:i.Y.onboardingTeachingClassroomManagement,websiteBuildingForSchool:i.Y.onboardingWebsiteBuildingForSchool,internshipApplications:i.Y.onboardingInternshipApplications,groupProjects:i.Y.onboardingGroupProjects,todos:i.Y.onboardingTodos,projectsTasks:i.Y.onboardingProjectsTasks,habitWellness:i.Y.onboardingHabitWellness,budgetPersonalFinance:i.Y.onboardingBudgetPersonalFinance,travel:i.Y.onboardingTravel,hobbies:i.Y.onboardingHobbies,careerBuilding:i.Y.onboardingCareerBuilding,foodNutrition:i.Y.onboardingFoodNutrition,websiteBuildingForLife:i.Y.onboardingWebsiteBuildingForLife,entertainment:i.Y.onboardingEntertainment},P=[i.Y.quickNoteV2,i.Y.personalHomeV2,i.Y.taskList,i.Y.journalV2,i.Y.readingListV2],F=[i.Y.classNotesV2,i.Y.cornellNotesSystemV2,i.Y.clubHomepageV2,i.Y.gradeCalculatorV2],A=[i.Y.teamMeetingNotes,i.Y.teamDocs,i.Y.teamHome,i.Y.teamTasks,i.Y.taskList],_=[i.Y.onboardingTodos,i.Y.onboardingProjectsTasks,i.Y.onboardingHabitWellness,i.Y.onboardingBudgetPersonalFinance],R=[i.Y.onboardingPlanner,i.Y.onboardingNotes,i.Y.onboardingResearch,i.Y.onboardingClubs]},61440:(e,t,s)=>{s.r(t),s.d(t,{PageLayoutEditor:()=>Me});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(36591),l=s(13148),d=s(9291),c=s(89728),u=s(58297),p=s(29551),m=s(82356),g=s(34017),h=(s(21703),s(43119)),f=s(11318),x=s(79131),y=s(45452),S=s(47453),v=s(73063),b=s(482),M=s(15167),j=s(53965),C=s(1898),w=s(16956),k=s(96802),T=s(13447),I=s(66890),Z=s(84398),P=s(82787),F=s(80444),A=s(77556),_=s(6258),R=s(85893);const O=(0,n.createContext)(null);function B(e){let{children:t,collectionStore:s,pageStore:a}=e;const r=(0,i.O7)(),l=(0,o.VK)((()=>{var e;return null===(e=F.default.state.currentUserStore)||void 0===e?void 0:e.userId}),[]),d=(0,Z.$)("PageLayoutEditorContext",{cacheFallback:r.defaultRecordCache.inMemoryRecordCache,isTemporaryData:!0}),c=(0,P.Z)({unpersistedInMemoryRecordCache:d}),u=(0,o.VK)((()=>a.clone(d)),[a,d]),p=function(e){let{collectionStore:t,unpersistedInMemoryRecordCache:s}=e;const a=(0,i.O7)(),r=(0,n.useMemo)((()=>new A.Z(a)),[a]),l=(0,o.VK)((()=>t.clone(s)),[t,s]),d=(0,o.VK)((()=>null==t?void 0:t.getParentBlockStore()),[t]);return(0,n.useEffect)((()=>{r.setContext({type:"collectionPage",collectionViewBlockStore:d,collectionStore:l})}),[r,l,d]),r}({unpersistedInMemoryRecordCache:d,collectionStore:s}),g=(0,o.VK)((()=>{const e=p.collectionStore();if(e)return e}),[p]),h=(0,o.VK)((()=>s.getLayoutStore()),[s]),f=(0,o.VK)((()=>null==g?void 0:g.getLayoutStore()),[g]);(0,o.VK)((()=>{l&&g&&(f||c.createAndCommit({perform:e=>m.m2({transaction:e,collectionStore:g,userId:l}),userAction:"PageLayoutEditorContext.initCollectionLayout"}))}),[g,f,c,l]);const x=(0,o.VK)((()=>function(e){let{unpersistedStore:t,store:s}=e;if(!t)return!1;const n=t.getModules(),i=(null==n?void 0:n.page_layout_schema)||[];if(!s){const e=(0,M.e0)().page_layout_schema;return!(0,j.Xy)(i,e)}const o=s.getModules(),a=(null==o?void 0:o.page_layout_schema)||[];return!(0,j.Xy)(i,a)}({unpersistedStore:f,store:h})||L({unpersistedStore:g,store:s})),[s,h,g,f]),y=(0,n.useCallback)((()=>{if(l&&f&&(h?T.createAndCommit({perform(e){T.applyOperation({transaction:e,store:h,operation:b.op.update({pointer:f.pointer,path:[],args:{modules:f.getModules()}})})},userAction:"PageLayoutEditorContext.updateLayout",environment:r}):T.createAndCommit({perform(e){const t=f.getValue();if(!t)throw new Error("Could not get value of unpersisted page layout");T.applyOperation({transaction:e,store:_.t1.createChildStore(s,f.pointer),operation:b.op.set({pointer:f.pointer,path:[],args:t})}),m.CK({transaction:e,collectionStore:s,layoutStore:f})},userAction:"PageLayoutEditorContext.createLayout",environment:r}),L({unpersistedStore:g,store:s}))){if(!g)return;const e=g.getSchema(),t=s.getSchema();T.createAndCommit({environment:r,userAction:"PageLayoutEditorContext.updateCollection",perform:n=>{for(const[i,o]of(0,C.qP)(e))o&&!(0,j.Xy)(o,t[i])&&T.applyOperation({transaction:n,store:s,operation:b.op.set({pointer:s.pointer,path:["schema",i],args:o})});for(const i in t)e[i]||w.E2({environment:r,collectionStore:s,schema:s.getSchema(),property:i,transaction:n})}}),T.createAndCommit({environment:r,userAction:"PageLayoutEditorContext.updateCollection",perform:e=>{k.FH({stores:[s],update:{collection_page_properties:g.getFormat().collection_page_properties,property_visibility:g.getFormat().property_visibility},transaction:e})}})}}),[s,r,h,g,f,l]),[S,v]=(0,n.useState)();return f?(0,R.jsx)(I.L1,{value:p,children:(0,R.jsx)(O.Provider,{value:{unpersistedTransactionActions:c,layoutStore:f,pageStore:u,collectionStore:g,hasUnsavedChanges:x,saveChanges:y,editorSidebarRoute:S,setEditorSidebarRoute:v},children:t})}):null}function D(){const e=(0,n.useContext)(O),t=(0,I.Y$)(),s=(0,o.VK)((()=>t.collectionStore()),[t]);if(!e)throw new Error("usePageLayoutEditorContext must be used inside PageLayoutEditorContextProvider");if(!s)throw new Error("Error opening PageLayoutEditor: Could not find collection");return(0,n.useMemo)((()=>({...e,collectionStore:s})),[e,s])}function L(e){let{unpersistedStore:t,store:s}=e;if(!t)return!1;const n=t.getSchema(),i=t.getFormat(),o=s.getSchema(),a=s.getFormat();return!(0,j.Xy)(n,o)||!(0,j.Xy)(i,a)}O.displayName="PageLayoutEditorContext";const V=(0,d.defineMessages)({addPageModule:{id:"ariaLabel.addPageModule",defaultMessage:"Add page module"}});function N(){const{setEditorSidebarRoute:e,editorSidebarRoute:t}=D(),s=(0,d.useIntl)(),i=(0,a.yK)((e=>({bigRoundButton:{width:40,height:40,borderRadius:"100%",background:"light"===e.mode?e.accentColors.gray[50]:e.accentColors.translucentGray[300]},bigRoundButtonHovered:{background:"light"===e.mode?e.accentColors.gray[100]:e.accentColors.translucentGray[400]},bigRoundButtonPressed:{background:"light"===e.mode?e.accentColors.gray[50]:e.accentColors.translucentGray[300]}})),[]),o=(0,n.useCallback)((()=>{e({type:"add-module"})}),[e]);return"add-module"===(null==t?void 0:t.type)?(0,R.jsx)(E,{}):(0,R.jsx)(p.gq,{justifyContent:"center",children:(0,R.jsx)(v.Z,{style:i.bigRoundButton,hoveredStyle:i.bigRoundButtonHovered,pressedStyle:i.bigRoundButtonPressed,onClick:o,icon:S.R,ariaLabel:s.formatMessage(V.addPageModule)})})}function E(){const e=(0,a.yK)((e=>({ghostPageModule:{height:160,background:"light"===e.mode?e.accentColors.blue[30]:e.accentColors.translucentGray[100],border:`1px dashed ${"light"===e.mode?e.accentColors.blue[200]:e.accentColors.blue[300]}`,borderRadius:10}})),[]);return(0,R.jsx)("div",{style:e.ghostPageModule})}var U=s(2275);function W(){const{unpersistedTransactionActions:e,layoutStore:t,setEditorSidebarRoute:s,editorSidebarRoute:i}=D(),a=(0,o.VK)((()=>(null==t?void 0:t.getKeyStore("modules").getKeyStore("page_layout_schema").getValue())||h.bl.page_layout_schema),[t]).filter((e=>e.type in f.W0)).map((e=>e.id)),r=(0,n.useMemo)((()=>new y.Z),[]),l=(0,o.VK)((()=>r.state.isDragging),[r]),d=(0,n.useCallback)((e=>{s({type:"configure-module",moduleId:e})}),[s]),c=(0,n.useCallback)((s=>{const n=s.map((e=>{var s;const n=null===(s=t.getModel())||void 0===s?void 0:s.getPageModuleById(e);if(!n)throw new Error("Error reordering page modules: Could not find page module.");return n})),i=[...h.uE,...n,...h.jr];e.createAndCommit({perform(e){(0,m.jG)({transaction:e,pageLayoutSchema:i,layoutStore:t})},userAction:"BuilderLayoutModules.handleLayoutDrop"})}),[t,e]),u=(0,n.useCallback)((()=>{s(i)}),[s,i]),p=(0,n.useCallback)((e=>{const t="configure-module"===(null==i?void 0:i.type)&&i.moduleId===e;return(0,R.jsx)(K,{active:t,isLast:!1,hideBorder:!1,pageModuleId:e,isDragging:t&&l})}),[i,l]);return a&&t?(0,R.jsxs)(R.Fragment,{children:[h.uE.map((e=>(0,R.jsx)(K,{pageModuleId:e.id,active:!1,isLast:!1},e.id))),(0,R.jsx)(x.ZP,{store:r,keys:a,direction:"vertical",onDraggingKeyChanged:d,onClick:u,onDrop:e=>{c(e)},style:{gap:10},renderKey:p}),(0,R.jsx)(N,{}),h.jr.map((e=>(0,R.jsx)(K,{pageModuleId:e.id,active:!1,isLast:!1},e.id)))]}):null}function K(e){let{pageModuleId:t,active:s=!1,isDragging:i=!1,isLast:r=!1,hideBorder:l=!0}=e;const{pageStore:d,layoutStore:c}=D(),u=(0,U.mY)({store:d}),p=(0,o.VK)((()=>{var e;return null===(e=c.getModel())||void 0===e?void 0:e.getPageModuleById(t)}),[c,t]),m=(0,n.useCallback)(((e,t)=>l?{border:"3px transparent solid",padding:10}:t?{border:`3px ${e.accentColors.uiBlue[700]} solid`,padding:10}:{border:`1px ${e.accentColors.uiBlue[400]} solid`,padding:12}),[l]),g=(0,a.yK)((e=>({container:{...m(e,s),background:e.contentBackground,borderRadius:10,width:"100%",position:"relative",cursor:l?"unset":"default",marginBottom:r?0:10,...i?{transform:"rotate(1deg)"}:{}},mouseEventCover:{position:"absolute",top:0,left:0,right:0,bottom:0}})),[s,m,l,i,r]);return p?(0,R.jsxs)("div",{style:g.container,children:[u(p,t),(0,R.jsx)("div",{style:g.mouseEventCover})]}):null}var z=s(37810),q=s(99036),G=s(80951),H=s(12396),Y=s(52275),Q=s(32163),$=s(72495);function J(){const{layoutStore:e,collectionStore:t,unpersistedTransactionActions:s,setEditorSidebarRoute:i}=D(),a=(0,o.VK)((()=>{const s=new Set,n=e.getModules();if(null!=n&&n.page_layout_schema)for(const e of n.page_layout_schema)s.add(e.id);if(null!=n&&n.page_info_layout_schema)for(const e of n.page_info_layout_schema)s.add(e.id);const i=t.getSchema();return Object.keys(i).map((e=>{if(s.has(e)||e===q.iw)return;return{id:e,type:"property",propertyId:e,style:"expanded"}})).filter(C.$K)}),[t,e]),r=(0,n.useCallback)((t=>{const n=e.getModel();n&&(s.createAndCommit({perform(s){(0,m.jG)({transaction:s,pageLayoutSchema:n.appendPageLayoutModule(t),layoutStore:e})},userAction:"BuilderLayoutModules.handleLayoutDrop"}),i({type:"configure-module",moduleId:t.id}))}),[e,i,s]),l=a.map((e=>({key:e.id,render:t=>(0,R.jsx)(ee,{...t,pageModule:e}),action:()=>{r(e)}})));return(0,R.jsx)(Q.Z,{initialFocus:0,type:Q.i.Vertical,sections:[{key:0,render:e=>(0,R.jsx)($.Z,{...e}),items:l}]})}const X={property:function(e){const{pageModule:t}=e,s=(0,a.Fg)(),n=(0,a.yK)((e=>({iconContainer:{background:e.white,border:`1px solid ${e.accentColors.gray[100]}`,width:32,height:32,borderRadius:4},buttonMenuItem:{padding:6}})),[]);if("property"!==t.type)throw new Error("Invalid page module type in add page module option");const{collectionStore:i}=D(),r=(0,o.VK)((()=>{const e=i.getSchema();return(0,G.Qm)({schema:e,property:t.propertyId})}),[i,t]);return r?(0,R.jsx)(Y.Z,{...e,style:n.buttonMenuItem,itemMarginLeft:0,title:(0,R.jsxs)(p.gq,{gap:8,alignItems:"center",children:[(0,R.jsx)(p.gq,{style:n.iconContainer,alignItems:"center",justifyContent:"center",children:(0,R.jsx)(H.ZP,{size:16,theme:s,icon:r.icon,type:r.type})}),r.name]})}):null}};function ee(e){const{pageModule:t}=e,s=X[t.type];return s?(0,R.jsx)(s,{...e}):null}var te=s(37612),se=s(6695),ne=s(39132),ie=s(19584),oe=s(79257),ae=s(87167),re=s(65091),le=s(13654),de=s(45238);function ce(e){let{active:t,caption:s,onClick:n}=e;const i=(0,a.yK)((e=>({longRectOne:{fill:e.accentColors.purple[400],x:9,y:21,width:27,height:8,rx:4},longRectTwo:{x:58,y:21,width:25,height:8,rx:4,fill:e.accentColors.gray[100]},shortRect:{x:89,y:21,width:16,height:8,rx:4,fill:e.accentColors.green[400]},circle:{cx:48,cy:25,r:6,fill:e.accentColors.gray[400]}})),[]),o=me({active:t}),r=(0,de.IU)("minimal",{viewBox:"0 0 114 50",svg:(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)("rect",{...o.outerRect}),(0,R.jsx)("rect",{...i.longRectOne}),(0,R.jsx)("circle",{...i.circle}),(0,R.jsx)("rect",{...i.longRectTwo}),(0,R.jsx)("rect",{...i.shortRect})]})})();return(0,R.jsx)(pe,{active:t,caption:s,onClick:n,icon:r})}function ue(e){let{active:t,caption:s,onClick:n}=e;const i=(0,a.yK)((e=>({longRectOne:{fill:e.accentColors.purple[400],x:77,y:7,width:27,height:8,rx:4},longRectTwo:{x:79,y:21,width:25,height:8,rx:4,fill:e.accentColors.gray[100]},shortRect:{x:88,y:35,width:16,height:8,rx:4,fill:e.accentColors.green[400]},circle:{cx:69,cy:25,r:6,fill:e.accentColors.gray[400]},firstPropertyLabel:{x:10,y:8,width:40,height:6,fill:e.accentColors.gray[100]},secondPropertyLabel:{x:10,y:22,width:34,height:6,fill:e.accentColors.gray[100]},thirdPropertyLabel:{x:10,y:36,width:48,height:6,fill:e.accentColors.gray[100]}})),[]),o=me({active:t}),r=(0,de.IU)("expanded",{viewBox:"0 0 114 50",svg:(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)("rect",{...o.outerRect}),(0,R.jsx)("rect",{...i.firstPropertyLabel}),(0,R.jsx)("rect",{...i.secondPropertyLabel}),(0,R.jsx)("rect",{...i.thirdPropertyLabel}),(0,R.jsx)("rect",{...i.longRectOne}),(0,R.jsx)("circle",{...i.circle}),(0,R.jsx)("rect",{...i.longRectTwo}),(0,R.jsx)("rect",{...i.shortRect})]})})();return(0,R.jsx)(pe,{active:t,caption:s,onClick:n,icon:r})}function pe(e){let{active:t,caption:s,onClick:n,icon:i}=e;const o=me({active:t});return(0,R.jsxs)("div",{onClick:n,style:o.container,children:[(0,R.jsx)("div",{children:i}),(0,R.jsx)("span",{style:o.caption,children:s})]})}function me(e){let{active:t}=e;return(0,a.yK)((e=>({container:{cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center"},outerRect:{fill:e.contentBackground,x:1,y:1,width:112,height:48,rx:6,stroke:t?e.accentColors.blue[400]:e.accentColors.gray[100],strokeWidth:t?2:1},caption:{fontWeight:t?z.Z.fontWeight.semibold:z.Z.fontWeight.regular,color:t?e.darkTextColor:e.lightTextColor}})),[t])}function ge(){const e=(0,d.useIntl)(),{collectionStore:t,pageStore:s,unpersistedTransactionActions:i}=D(),r=(0,o.VK)((()=>t.getSchema()),[t]),l=(0,o.VK)((()=>se.iB(t.getFormat(),r,void 0,se.j5.Collection)),[t,r]),c=(0,ae.nd)({store:s,format:l,schema:r,collectionStore:t}),u=(0,o.VK)((()=>(0,ie.m8)(c.map((e=>[e.property,{...e,propertySchema:r[e.property]}])))),[c,r]),p=(0,o.VK)((()=>null==c?void 0:c.map((e=>e.property))),[c]),m=(0,ae.G_)({collectionStore:t,format:l}),g=(0,a.yK)((()=>({propertyRow:{display:"flex",alignItems:"center",width:"100%",gap:2}})),[]),h=(0,n.useCallback)((e=>"show"===e.visibility||"hide_if_empty"===e.visibility&&e.hasValue),[]),f=(0,n.useCallback)(((e,s)=>{i.createAndCommit({userAction:"LayoutBuilder.propertiesConfiguration.toggleVisibility",perform:n=>{oe.M0({property:e,visibility:s?"hide":"show",store:t,format:l,transaction:n})}})}),[l,t,i]);if(!p)return null;const y=(0,R.jsx)(x.ZP,{keys:p,onDrop:m,direction:"vertical",renderKey:n=>{const i=null==u?void 0:u[n],o=i.propertySchema,a=h(i);return o?(0,R.jsxs)("div",{style:g.propertyRow,children:[(0,R.jsx)(le.ZP,{schema:r,format:l,property:n,collectionStore:t,disabled:!1,locked:!1,canConfigureCollection:!0,isInPeekRenderer:!1,hideDragHandle:!1,blockStore:s}),(0,R.jsx)(v.Z,{ariaLabel:e.formatMessage(he.visibilityToggleIconAriaLabel,{propertyName:o.name}),isDarkIconColor:a,icon:ne.c,onClick:()=>f(n,a)})]}):null}});return(0,R.jsxs)(R.Fragment,{children:[y,(0,R.jsx)(re.le,{collectionStore:t,isInPeekRenderer:!1})]})}const he=(0,d.defineMessages)({propertiesTitle:{id:"pageLayout.configureProperties.propertiesTitle",defaultMessage:"Properties"},displayStyleTitle:{id:"pageLayout.configureProperties.styleOptionsTitle",defaultMessage:"Style"},minimalStyleCaption:{id:"pageLayout.configureProperties.minimalStyleCaption",defaultMessage:"Minimal"},expandedStyleCaption:{id:"pageLayout.configureProperties.expandedStyleCaption",defaultMessage:"Expanded"},visibilityToggleIconAriaLabel:{id:"pageLayout.configureProperties.visibilityToggleIconAriaLabel",defaultMessage:"Toggle the visibility {propertyName}"}});function fe(e){let{moduleId:t}=e;const s=(0,a.yK)((e=>({container:{margin:"0 32px 32px 32px",padding:8,background:e.sidebarBackground,width:"20%",borderRadius:16,minWidth:200,overflowY:"auto"},title:{fontWeight:z.Z.fontWeight.semibold},doneButton:{width:"100%",marginTop:10}})),[]),{layoutStore:i,setEditorSidebarRoute:r}=D(),l=(0,o.VK)((()=>{var e;return null===(e=i.getModel())||void 0===e?void 0:e.getPageModuleById(t)}),[i,t]),c=(0,n.useCallback)((()=>{r(void 0)}),[r]);return l?(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)("p",{style:s.title,children:(0,R.jsx)(d.FormattedMessage,{...ve[l.type]})}),(0,R.jsx)(ye,{pageModule:l}),(0,R.jsx)(u.Z,{onClick:c,isLarge:!0,style:s.doneButton,children:(0,R.jsx)(d.FormattedMessage,{...ve.doneButton})}),(0,R.jsx)(Se,{moduleId:t})]}):null}const xe={properties:function(e){const{pageModule:t}=e,{layoutStore:s,unpersistedTransactionActions:i}=D(),r=(0,a.yK)((e=>({container:{fontSize:z.Z.fontSize.UIRegular.desktop},title:{margin:"10px 0",fontWeight:z.Z.fontWeight.semibold,color:e.mediumTextColor}})),[]),l=(0,o.VK)((()=>{if("properties"===(null==t?void 0:t.type))return"pinned"===t.variant?"minimal":"expanded"}),[t]),c=(0,n.useCallback)((e=>{var t;const n=null===(t=s.getModules())||void 0===t?void 0:t.page_layout_schema;if(!n)return;const o=n.map((t=>t.id==t.id&&"properties"===t.type?{...t,variant:e}:t));i.createAndCommit({perform(e){m.jG({transaction:e,pageLayoutSchema:o,layoutStore:s})},userAction:"BuilderLayoutModules.toggleDisplayStyle"})}),[s,i]);return(0,R.jsxs)("div",{style:r.container,children:[(0,R.jsx)("div",{style:r.title,children:(0,R.jsx)(d.FormattedMessage,{...he.displayStyleTitle})}),(0,R.jsxs)(p.gq,{gap:10,children:[(0,R.jsx)(ce,{active:"minimal"===l,onClick:()=>c("pinned"),caption:(0,R.jsx)(d.FormattedMessage,{...he.minimalStyleCaption})}),(0,R.jsx)(ue,{active:"expanded"===l,onClick:()=>c(void 0),caption:(0,R.jsx)(d.FormattedMessage,{...he.expandedStyleCaption})})]}),(0,R.jsx)("div",{style:r.title,children:(0,R.jsx)(d.FormattedMessage,{...he.propertiesTitle})}),(0,R.jsx)(ge,{})]})}},ye=n.forwardRef((function(e){const{pageModule:t}=e,s=xe[t.type];return s?(0,R.jsx)(s,{...e}):null}));function Se(e){let{moduleId:t}=e;const{setEditorSidebarRoute:s,layoutStore:i,unpersistedTransactionActions:o}=D(),r=(0,a.yK)((()=>({deletePageModuleButtonContainer:{display:"flex",justifyContent:"center",marginTop:8}})),[]),l=(0,n.useCallback)((()=>{const e=i.getModel();e&&(o.createAndCommit({perform(s){(0,m.jG)({transaction:s,pageLayoutSchema:e.removePageLayoutModule(t),layoutStore:i})},userAction:"BuilderLayoutModules.handleLayoutDrop"}),s(void 0))}),[i,t,s,o]);return(0,R.jsx)("div",{style:r.deletePageModuleButtonContainer,children:(0,R.jsx)(c.Z,{isGray:!0,icon:te.y,onClick:l,children:(0,R.jsx)(d.FormattedMessage,{...ve.deleteModuleButton})})})}const ve=(0,d.defineMessages)({cover:{id:"pageLayoutEditor.cover",defaultMessage:"Cover"},titleWithIcon:{id:"pageLayoutEditor.titleWithIcon",defaultMessage:"Title and Icon"},properties:{id:"pageLayoutEditor.properties",defaultMessage:"Properties"},property:{id:"pageLayoutEditor.property",defaultMessage:"Property"},inlinePageSections:{id:"pageLayoutEditor.inlinePageSections",defaultMessage:"Inline Page Sections"},expandedBacklinks:{id:"pageLayoutEditor.expandedBacklinks",defaultMessage:"Backlinks"},discussions:{id:"pageLayoutEditor.discussions",defaultMessage:"Page Comments"},editor:{id:"pageLayoutEditor.editor",defaultMessage:"Editor"},tabs:{id:"pageLayoutEditor.tabs",defaultMessage:"Tabs"},transcript:{id:"pageLayoutEditor.transcript",defaultMessage:"Transcript"},bottomControls:{id:"pageLayoutEditor.bottomControls",defaultMessage:"Bottom Controls"},doneButton:{id:"pageLayoutEditor.doneButtonTitle",defaultMessage:"Done"},selectAModulePrompt:{id:"pageLayoutEditor.selectAModuleTitle",defaultMessage:"Select a module to configure"},deleteModuleButton:{id:"pageLayoutEditor.deleteModuleButton",defaultMessage:"Delete"}});function be(){const{editorSidebarRoute:e}=D(),t=(0,a.yK)((e=>({container:{margin:"0 18px 18px 18px",padding:8,background:e.sidebarBackground,width:"20%",borderRadius:16,minWidth:200,overflowY:"auto"},title:{fontWeight:z.Z.fontWeight.semibold},doneButton:{width:"100%"}})),[]);return e?(0,R.jsxs)("div",{style:t.container,children:["configure-module"===e.type&&(0,R.jsx)(fe,{moduleId:e.moduleId}),"add-module"===e.type&&(0,R.jsx)(J,{})]}):(0,R.jsx)("div",{style:t.container,children:"TODO: Top-level sidebar menu"})}function Me(){const e=(0,a.yK)((e=>({container:{width:"100%",backgroundColor:e.sidebarBackground}})),[]),t=(0,o.VK)((()=>g.Z.getState()),[g.Z]);return t.isOpen?(0,R.jsx)(B,{...t,children:(0,R.jsxs)(p.Ht,{style:e.container,children:[(0,R.jsx)(je,{}),(0,R.jsxs)(p.gq,{style:{overflowY:"auto",padding:"20px 20px 0 20px",height:"100%"},children:[(0,R.jsx)(Ce,{}),(0,R.jsx)(be,{})]})]})}):null}function je(){const e=(0,i.O7)(),{hasUnsavedChanges:t,saveChanges:s}=D(),o=(0,a.yK)((e=>({container:{width:"100%",backgroundColor:e.sidebarBackground},titleRow:{padding:"16px 32px 0px 32px"}})),[]),g=(0,n.useCallback)((()=>{m.gm({environment:e})}),[e]),h=(0,n.useCallback)((()=>{s(),m.gm({environment:e})}),[e,s]);return(0,R.jsxs)(p.gq,{style:o.titleRow,alignItems:"center",justifyContent:"space-between",children:[(0,R.jsx)(c.Z,{onClick:g,icon:l.U,isLarge:!0,children:(0,R.jsx)(d.FormattedMessage,{id:"pageLayoutEditor.close",defaultMessage:"Cancel"})}),(0,R.jsx)(u.Z,{onClick:h,disabled:!t,icon:r.e,isLarge:!0,children:(0,R.jsx)(d.FormattedMessage,{id:"pageLayoutEditor.saveAndClose",defaultMessage:"Apply to # pages"})})]})}function Ce(){const e=(0,a.yK)((e=>({container:{padding:"20px 20px",height:"100%",background:e.contentBackground,flexGrow:3,borderRadius:"12px 12px 0 0",boxShadow:e.mediumBoxShadow,borderColor:e.accentColors.gray[300],borderWidth:1,overflowY:"auto"}})),[]);return(0,R.jsx)("div",{style:e.container,children:(0,R.jsx)(W,{})})}},55535:(e,t,s)=>{s.d(t,{W:()=>a,Z:()=>l});var n=s(67294),i=s(51077),o=s(85893);const a=16;function r(e){let{icon:t,style:s,size:n=a}=e;return(0,o.jsx)(i.Z,{type:"notion_icon",size:n,icon:`/icons/${t}_lightgray.svg`,largeIcon:!0,style:s})}const l=n.memo(r)},84198:(e,t,s)=>{s.d(t,{Z:()=>y});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(37810),l=s(26388),d=s(75024),c=s(50334),u=s(61931),p=s(49085);class m extends p.default{getInitialState(){return!1}}var g=s(22863),h=s(55535),f=s(85893);function x(e){let{icon:t,title:s,tooltip:n,hasRightElement:o}=e;const c=(0,i.O7)(),u=(0,a.yK)((e=>({panelTitleAndIcon:{display:"flex",alignItems:"center",fontSize:(0,d.yv)(c,"UISmall"),fontWeight:r.Z.fontWeight.medium,color:e.text.secondary,flexShrink:0,maxWidth:o?200:"100%"},title:{...r.Z.textOverflowStyle},panelIconContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:h.W,height:h.W,marginRight:8,marginTop:1}})),[c,o]);return s?(0,f.jsx)(l.ZP,{renderTooltip:()=>n,disableTooltip:!n,placement:l.ug.Top,alignment:l.v2.Start,render:e=>(0,f.jsxs)("div",{style:u.panelTitleAndIcon,...e,children:[(0,f.jsx)("div",{style:u.panelIconContainer,children:t}),(0,f.jsx)("span",{style:u.title,children:s})]})}):null}const y=function(e){let{children:t,title:s,icon:r,tooltip:l,panelStyle:d,headerStyle:p,rightStyle:h,actions:y,right:S,disableRightFadeIn:v}=e;const b=(0,i.MO)(),M=Boolean(s),j=Boolean(S),C=(0,o.qz)(void 0,m),w=(0,n.useMemo)((()=>({isHoveredOnPanelStore:C})),[C]),k=(0,n.useCallback)((()=>C.setState(!0)),[C]),T=(0,n.useCallback)((()=>C.setState(!1)),[C]),I=(0,a.yK)((e=>({panel:{zIndex:1,position:"relative",display:"flex",flexDirection:"column",borderRadius:b?12:6,padding:u.A5,paddingBottom:20,background:e.home.tile.background,boxShadow:(0,u._U)({isPhone:b,theme:e}),...u.MI,...d},headerContainer:{flexShrink:0,display:"flex",justifyContent:"space-between",alignItems:"center",height:u.jX,marginTop:-u.A5,...p},rightActions:{display:"flex",flexDirection:"row",alignItems:"center"},actions:{paddingLeft:6}})),[b,d,p]);return(0,f.jsx)(c.L8,{value:w,children:(0,f.jsxs)("div",{style:I.panel,onMouseEnter:k,onMouseLeave:T,children:[(M||j)&&(0,f.jsxs)("div",{style:I.headerContainer,children:[(0,f.jsx)(x,{title:s,icon:r,tooltip:l,hasRightElement:j}),(j||y)&&(0,f.jsxs)("div",{style:I.rightActions,children:[j&&(0,f.jsx)(g.Z,{force:v?"forceShow":void 0,additionalStyles:h,children:S}),y&&(0,f.jsx)(g.Z,{additionalStyles:I.actions,children:y})]})]}),t]})})}},22863:(e,t,s)=>{s.d(t,{Z:()=>d});var n=s(67294),i=s(24405),o=s(1898),a=s(86628),r=s(50334);var l=s(85893);const d=function(e){let{additionalStyles:t,transitionMs:s,force:d,children:c}=e;const u=function(){var e;const t=null===(e=(0,n.useContext)(r.uU))||void 0===e?void 0:e.isHoveredOnPanelStore;return(0,a.VK)((()=>Boolean(null==t?void 0:t.getState())),[t])}(),p=(0,i.yK)((()=>{let e;switch(d){case"forceShow":e=1;break;case"forceHide":e=0;break;case void 0:e=u?1:0;break;default:(0,o.t1)(d)}return{hoverStyle:{opacity:e,transition:`opacity ${(0,o.$K)(s)?s:200}ms ease-in`,...t}}}),[t,d,u,s]);return(0,l.jsx)("div",{style:p.hoverStyle,children:c})}},50334:(e,t,s)=>{s.d(t,{L8:()=>o,uU:()=>i});const n=(0,s(67381).Q)({displayName:"HomePanelContext",legacyContextKey:"homePanelContext",modernContextDefaultValue:{isHoveredOnPanelStore:void 0}}),i=n.context,o=n.Provider;n.legacyPropTypes},17031:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(35431);class i extends n.Z{findCollectionTemplatePickerItemFromStore(e){if(e)return this.find((t=>t.props.templateStore===e))}}const o=new i},48608:(e,t,s)=>{s.d(t,{Z:()=>R});s(67294);var n=s(83355),i=s(480),o=s(86628),a=s(24405),r=s(49085),l=s(79362),d=s(89036),c=s(40462),u=s(54855),p=s(9291),m=s(1898),g=s(91219),h=s(64921),f=s(60458),x=s(63296),y=s(58297),S=s(31278),v=s(64369),b=s(43250),M=s(79817),j=s(48779),C=s(95697),w=s(24646),k=s(85834),T=s(35057),I=s(73466),Z=s(10039),P=s(85893);const F={padding:12,display:"flex",flexDirection:"column",gap:16};class A extends n.Z{constructor(){super(...arguments),this.storeTypes={contextualInviteStore:k.ZP,isSpaceCardSelectedStore:r.default.createClass(!1)}}didMount(){g.$2(this.environment,M.Oh(this.environment,this.stores.contextualInviteStore)),(0,C.$)(this.environment)&&this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:k.uq.page_guest})}renderComponent(){var e;const{contextualInviteStore:t}=this.stores,s=(null===(e=t.state)||void 0===e?void 0:e.shareModalGuestMemberConfirmationExpGroup)||"control",n=t.getGuestEmails();if(!n.length)return null;const i=(0,C.$)(this.environment),o=(0,j.Q6)(this.props.spaceStore);return(0,P.jsx)(P.Fragment,{children:(0,P.jsx)("div",{className:b.B8p,style:{...F,paddingTop:16,paddingBottom:16,paddingLeft:18,paddingRight:18},children:(0,P.jsxs)("div",{children:[(0,P.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:(0,P.jsxs)("div",{children:[t.state.inviteStage===k.TG.share_workspace?(0,P.jsx)(O,{useZeroTeamsExperience:i,shareModalGuestMemberConfirmationExpGroup:s,guestEmails:n,useGuestInviteRequestExperience:o}):(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(v.Z,{style:{fontWeight:600,marginBottom:4},children:o?(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.requestToWorkspace.guestInviteRequestEnabled.title",defaultMessage:"Also request to add as member"}):(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.requestToWorkspace.title",defaultMessage:"Request to add to workspace"})}),(0,P.jsx)(v.Z,{isMultiline:!0,isSmall:!0,children:o?(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.requestToWorkspace.guestInviteRequestEnabled.subtitle",defaultMessage:"Guest {emailCount, plural, one {request} other {requests}} sent. Do you want to send a request to your workspace admin to add {emailCount, plural, one {this person} other {these people}} to the workspace?",values:{emailCount:n.length}}):(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.requestToWorkspace.subtitle",defaultMessage:"Do you want to send a request to your workspace admin to add {emailCount, plural, one {this person} other {these people}} to the workspace?",values:{emailCount:n.length}})})]}),(0,P.jsx)("div",{style:{display:"flex",flexWrap:"wrap",marginTop:16,marginBottom:16},children:(0,P.jsx)(B,{spaceStore:this.props.spaceStore,emails:n,shareModalGuestMemberConfirmationExpGroup:s})})]})}),"control"===s?(0,P.jsx)(L,{spaceStore:this.props.spaceStore,isSpaceCardSelectedStore:this.stores.isSpaceCardSelectedStore,showSpaceCardToggle:i}):(0,P.jsx)(U,{spaceStore:this.props.spaceStore,contextualInviteStore:this.stores.contextualInviteStore,shareModalGuestMemberConfirmationExpGroup:s}),(0,P.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18},children:[(0,P.jsx)(x.Z,{isLarge:!0,style:{marginRight:10},onClick:async()=>{var e,n;"control"===s?N(this.stores.contextualInviteStore):(t.setState({...t.state,selection:k.uq.closed}),null===(e=(n=t.state).resetShareMenuFn)||void 0===e||e.call(n));await E(this.environment,this.props.spaceStore,this.props.blockStore,this.props.intl,this.stores.contextualInviteStore)},children:"control"===s?(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.skip.button",defaultMessage:"Skip for now"}):(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.cancel.button",defaultMessage:"Cancel"})}),(0,P.jsx)(y.Z,{isLarge:!0,disabled:i&&!this.stores.isSpaceCardSelectedStore.state||!i&&this.stores.contextualInviteStore.state.selection===k.uq.closed,onClick:async()=>{"control"===s&&(t.state.inviteStage===k.TG.share_workspace&&V(this.stores.contextualInviteStore),t.state.inviteStage===k.TG.request_workspace&&function(e){e.setState({...e.state,selection:k.uq.request_workspace_member})}(this.stores.contextualInviteStore)),await E(this.environment,this.props.spaceStore,this.props.blockStore,this.props.intl,this.stores.contextualInviteStore)},children:(0,P.jsx)(_,{inviteStage:t.state.inviteStage,shareModalGuestMemberConfirmationExpGroup:s,useGuestInviteRequestExperience:o})})]})]})})})}}function _(e){const{inviteStage:t,shareModalGuestMemberConfirmationExpGroup:s,useGuestInviteRequestExperience:n}=e;return t===k.TG.share_workspace?"control"===s?n?(0,P.jsx)(p.FormattedMessage,{id:"ContextualInvite.addToWorkspace.guestInviteRequestEnabled.button",defaultMessage:"Add member to workspace"}):(0,P.jsx)(p.FormattedMessage,{id:"ContextualInvite.addToWorkspace.button",defaultMessage:"Add to workspace"}):(0,P.jsx)(p.FormattedMessage,{id:"ContextualInvite.addToWorkspace.button.variant",defaultMessage:"Invite"}):n?(0,P.jsx)(p.FormattedMessage,{id:"ContextualInvite.sendRequest.guestInviteRequestEnabled.button",defaultMessage:"Send member request"}):(0,P.jsx)(p.FormattedMessage,{id:"ContextualInvite.sendRequest.button",defaultMessage:"Send request"})}A.displayName="ContextualInvite";const R=(0,p.injectIntl)(A);function O(e){let{useZeroTeamsExperience:t,useGuestInviteRequestExperience:s,shareModalGuestMemberConfirmationExpGroup:n,guestEmails:i}=e;const a=(0,o.VK)((()=>!(0,T.QM)()),[]);return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)(v.Z,{style:{fontWeight:600,marginBottom:4},children:["control"===n?s?(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.addToWorkspace.guestInviteRequestEnabled.title",defaultMessage:"Also add as member"}):(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.addToWorkspace.title",defaultMessage:"Add to workspace"}):void 0,"v1"===n?(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.addToWorkspace.title.v1",defaultMessage:"Invite as guest or member?"}):void 0,"v2"===n?(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.addToWorkspace.title.v2",defaultMessage:"Invite to page or workspace?"}):void 0]}),"control"===n?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(v.Z,{isMultiline:!0,isSmall:!0,style:{marginBottom:6},children:s?(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.addToWorkspace.guestInviteRequestEnabled.subtitle",defaultMessage:"Guest {emailCount, plural, one {request} other {requests}} sent. Do you want to add {emailCount, plural,\none {this person}\nother {these people}\n} to the workspace in addition to the page? {isPaid, select,\ntrue {This is a billable event.}\nother {}\n}",values:{emailCount:i.length,isPaid:a}}):(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.addToWorkspace.subtitle",defaultMessage:"Do you want to add {emailCount, plural,\none {this person}\nother {these people}\n} to the workspace in addition to the page? {isPaid, select,\ntrue {This is a billable event.}\nother {}\n}",values:{emailCount:i.length,isPaid:a}})}),(0,P.jsx)(v.Z,{isMultiline:!0,isSmall:!0,children:t?(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.addToWorkspace.zeroTeams.subtitle.blockLimit",defaultMessage:"Adding them as a member will auto-create a teamspace{isFreeTier, select,\nfree { and apply the 1,000 block limit to your workspace.}\nother {}\n}",values:{isFreeTier:a?"paid":"free"}}):(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.addToWorkspace.zeroTeams.subtitle",defaultMessage:"{isFreeTier, select,\nfree {This action will apply the 1,000 block limit to your workspace.}\nother {}\n}",values:{emailCount:i.length,isFreeTier:a?"paid":"free"}})})]}):void 0]})}function B(e){let{emails:t,shareModalGuestMemberConfirmationExpGroup:s,spaceStore:n}=e;const i=(0,o.VK)((()=>(0,j.Q6)(n)),[n]);return(0,P.jsx)(P.Fragment,{children:t.map((e=>(0,P.jsx)(Z.Z,{store:n,tokenType:"control"!==s?"member":i?"guestRequestRequired":"guest",showRemoveButton:!1,target:{source:"email",type:"newUser",value:{email:e},spaceRole:"not_in_space"}},e)))})}function D(e){let{title:t,subtitle:s,icon:n,selected:i,onClick:o}=e;const r=(0,a.Fg)();return(0,P.jsxs)(h.Z,{style:{display:"flex",borderWidth:1,borderStyle:"solid",borderColor:r.regularDividerColor,borderRadius:8,padding:12,justifyContent:"space-between",alignItems:"center"},onClick:o,children:[(0,P.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,P.jsx)("div",{style:{paddingRight:12},children:n}),(0,P.jsxs)("div",{children:[(0,P.jsx)(v.Z,{children:t}),(0,P.jsx)(v.Z,{isSmall:!0,style:{width:350,whiteSpace:"pre-wrap"},children:s})]})]}),(0,P.jsx)(f.Z,{round:!0,checked:i,fill:r.contentBackground,size:20,onClick:o})]})}function L(e){let{showSpaceCardToggle:t,spaceStore:s,isSpaceCardSelectedStore:n}=e;const r=(0,p.useIntl)(),l=(0,a.Fg)(),c=(0,i.O7)(),u=(0,o.VK)((()=>(0,j.Wd)(c,s)),[c,s]),m=(0,o.VK)((()=>(0,j.rn)(c,s)),[c,s]),g=(0,o.VK)((()=>s.getPublicSpaceData()),[s]),x=(0,o.VK)((()=>n.state),[n]);let y;g&&"none"!==g.role&&(y=(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.spaceCard.subtitle",defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} member} other {{numberOfWorkspaceMembers} members}} · {planType}",values:{numberOfWorkspaceMembers:r.formatNumber(g.memberCount),planType:r.formatMessage((0,w.em)(g.subscriptionTier))}}));const b=u||m?(0,P.jsx)(S.Z,{disabled:!0,icon:u,isEmptyPage:!1,title:m,size:30,style:{color:l.regularTextColor,marginRight:12}}):(0,d.v)(function(e){return{width:20,height:20,fill:e.lightIconColor}}(l));return(0,P.jsxs)(h.Z,{style:{display:"flex",borderWidth:1,borderStyle:"solid",borderColor:l.regularDividerColor,borderRadius:5,padding:12,justifyContent:"space-between",alignItems:"center"},disabled:!t,onClick:()=>n.setState(!n.state),children:[(0,P.jsxs)("div",{style:{display:"flex"},children:[b,(0,P.jsxs)("div",{children:[(0,P.jsx)(v.Z,{children:m}),(0,P.jsx)(v.Z,{isSmall:!0,children:y})]})]}),t&&(0,P.jsx)(f.Z,{round:!0,checked:x,fill:l.contentBackground,size:20,onClick:()=>n.setState(!n.state)})]})}function V(e){e.setState({...e.state,selection:k.uq.workspace_member})}function N(e){e.setState({...e.state,selection:k.uq.page_guest})}async function E(e,t,s,n,i){const{shareModalGuestMemberConfirmationExpGroup:o,callbackAsyncFn:a}=i.state;if(i.state.inviteStage===k.TG.closed||i.state.inviteStage===k.TG.share_page)return;const{selection:r}=i.state;switch(r){case k.uq.request_workspace_member:g.ci(e,{...M.Oh(e,i),from:"share_menu"}),await M.fC({environment:e,spaceStore:t,originId:s.id,originType:"share_menu",reasonMessage:void 0,contextualInviteStore:i,intl:n});break;case k.uq.workspace_member:if(g.E0(e,M.Oh(e,i)),(0,C.$)(e)){i.setState({...i.state,inviteStage:k.TG.closed});if(!(await I.HD({environment:e,flowId:i.state.flowId??"",trackCreateTeamComplete:!1})))return}"control"!==o&&await(null==a?void 0:a()),await M.j_({environment:e,spaceStore:t,contextualInviteStore:i,from:"page_contextual_invite",intl:n});break;case k.uq.page_guest:"control"!==o&&await(null==a?void 0:a()),i.reset();break;case k.uq.closed:i.reset();break;default:(0,m.t1)(r)}}function U(e){let{shareModalGuestMemberConfirmationExpGroup:t,spaceStore:s,contextualInviteStore:n}=e;const r=(0,a.Fg)(),d=(0,i.O7)(),m=(0,o.VK)((()=>n.state.selection),[n]),g=m===k.uq.page_guest,h=m===k.uq.workspace_member,f=(0,o.VK)((()=>(0,j.rn)(d,s)),[d,s]);return"v1"!==t&&"v2"!==t?null:(0,P.jsxs)("div",{style:{display:"flex",gap:8,flexDirection:"column"},children:[(0,P.jsx)("div",{children:(0,P.jsx)(D,{title:"v1"===t?(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.addToWorkspace.guest.title.v1",defaultMessage:"Guest"}):(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.addToWorkspace.guest.title.v2",defaultMessage:"Invite to Page"}),subtitle:(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.addToWorkspace.guest.subtitle",defaultMessage:"Can access only this page"}),icon:(0,u.a)({fill:l.Lr[r.mode].yellow,width:22,height:24}),selected:g,onClick:()=>{N(n)}})}),(0,P.jsx)("div",{children:(0,P.jsx)(D,{title:"v1"===t?(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.addToWorkspace.member.title.v1",defaultMessage:"Member"}):(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.addToWorkspace.member.title.v2",defaultMessage:"Invite to Workspace"}),subtitle:(0,P.jsx)(p.FormattedMessage,{id:"contextualInvite.addToWorkspace.member.subtitle",defaultMessage:"Can access all pages in {spaceName}. This person will be billed as a member.",values:{spaceName:f}}),icon:(0,c.o)({fill:l.Lr[r.mode].green,width:22,height:24}),selected:h,onClick:()=>{V(n)}})})]})}},10039:(e,t,s)=>{s.d(t,{Z:()=>F});s(67294);var n=s(480),i=s(86628),o=s(24405),a=s(84619),r=s(33728),l=s(3338),d=s(40462),c=s(84169),u=s(36329),p=s(26774),m=s(7928),g=s(9291),h=s(31701),f=s(1898),x=s(37810),y=s(26388),S=s(45653),v=s(85567),b=s(45101),M=s(16639),j=s(53353),C=s(26781),w=s(4023),k=s(80444),T=s(55899),I=s(88893),Z=s(88280),P=s(85893);const F=function(e){const{store:t,target:s}=e,F=(0,n.Fy)(),A=(0,g.useIntl)(),_=function(){const e=(0,o.yK)((()=>({verifiedDomain:{margin:2,backgroundColor:"rgba(83, 168, 63, 0.1)"},disabled:{margin:2,backgroundColor:"rgba(211, 79, 67, 0.1)",border:"dashed #D9655B 1px",paddingLeft:5},normal:{margin:2},guest:{margin:2,backgroundColor:"rgba(218, 163, 64, 0.2)"},error:{margin:2,backgroundColor:"rgba(195,90,75,0.2)",color:"#DE5550"},tokenContent:{display:"flex",alignItems:"center",maxWidth:"100%"},tokenSpan:{maxWidth:"100%"},tokenText:{marginLeft:4,...x.Z.textOverflowStyle}})),[]);return e}(),R=(0,i.VK)((()=>{const e=Z.subscriptionDataStoreInstance.state,t=e?I.CM(e):[],s={};return t.forEach((e=>{s[e.userId]=e})),s}),[]),O=(0,i.VK)((()=>{const e=k.default.state.currentSpaceStore;return new Set(null==e?void 0:e.getEmailDomains())}),[]),B=(0,j.Z)(t),D=(0,C.S)(t),L=(0,i.VK)((()=>{if("invalidUser"===s.type)return"invalidUser";if(e.tokenType)return e.tokenType;if("group"===s.type)return"group";if("existingUser"===s.type&&!Boolean(s.spaceRole)){const e=R[s.value.id];s.spaceRole=e?e.role:"not_in_space"}if(!(0,b.OA)(s))return"member";if(B.isGuestRequestRequired)return"guestRequestRequired";if(B.isStoreInTeam&&!B.teamAllowsGuests)return"teamGuestDisabled";if(!B.isStoreInTeam&&!B.spaceAllowsGuests||B.isStoreInTeam&&!B.teamAllowsGuests&&!B.spaceAllowsGuests)return"spaceGuestDisabled";const t=(0,r.Gd)(s.value.email);return t&&O.has(t)?"verifiedDomain":"guest"}),[e.tokenType,s,R,O,B]),V=(0,i.VK)((()=>{switch(L){case"member":case"group":return _.normal;case"invalidUser":return _.error;case"guest":case"guestRequestRequired":return _.guest;case"verifiedDomain":return _.verifiedDomain;case"spaceGuestDisabled":case"teamGuestDisabled":case"teamGroupOwner":return _.disabled;default:(0,f.t1)(L)}}),[L,_]);function N(){const e=(0,c.m)({height:16,width:16,color:"#D34F43"});switch(L){case"member":return(0,T.fZ)(s)?(0,P.jsx)(S.Z,{userValue:s.value,size:16}):(0,T.KU)(s)?(0,P.jsx)(S.Z,{size:16,avatar:s.value}):(0,P.jsx)(S.Z,{size:16});case"guest":case"guestRequestRequired":return(0,d.o)({height:16,width:16,color:"#DAA340"});case"invalidUser":return(0,u._)({height:16,width:16,color:"#DE5550"});case"verifiedDomain":return(0,l.p)({height:16,width:16,color:"#53A83F"});case"group":return(0,P.jsx)("div",{style:{height:16,width:16,backgroundColor:h.ZP.whiteWithAlpha(.8),borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,p.O)({height:12,width:12,color:h.ZP.mediumTextColor})});case"spaceGuestDisabled":case"teamGuestDisabled":case"teamGroupOwner":return e;default:(0,f.t1)(L)}}function E(t){const n=N();let i=function(){switch(s.type){case"newUser":return s.value.email.trim();case"invalidUser":return s.value.text.trim();case"existingUser":return(0,m.Nz)(A,s.value);case"group":return(0,M.kF)({intl:A,group:s.value});default:(0,f.t1)(s)}}(),o=_.tokenText;return e.onlyShowTokenType&&(["guest","teamGuestDisabled","spaceGuestDisabled"].includes(t)?(i="Guest",o={...o,color:"#DAA340"}):(i="Member",o={...o,color:"#53A83F"})),(0,P.jsxs)("div",{style:_.tokenContent,children:[n,(0,P.jsx)("div",{style:o,children:i})]})}function U(t){var s;t.stopPropagation(),null===(s=e.onClickRemove)||void 0===s||s.call(e)}const W="newUser"===s.type?s.value.email:"invalidUser"===s.type?s.value.text:s.value.id,K="group"!==s.type&&"invalidUser"!==s.type?s.value.email:void 0;return(0,P.jsx)(y.ZP,{placement:w.u.Top,renderTooltip:()=>function(e){const{tokenType:t,target:s,email:n}=e;return"guest"===t?(0,P.jsx)(g.FormattedMessage,{defaultMessage:"{email} will be invited as a guest",id:"inviteTargetToken.guest.tooltip",values:{email:n}}):"spaceGuestDisabled"===t||"teamGuestDisabled"===t||"guestRequestRequired"===t?D:"teamGroupOwner"===t&&"group"===s.type?(0,P.jsx)(g.FormattedMessage,{defaultMessage:"Groups cannot be added as team owners.",id:"inviteTargetToken.groupTeamOwner.tooltip"}):"invalidUser"===s.type?(0,P.jsx)(g.FormattedMessage,{defaultMessage:"{text} is not a valid email",id:"inviteTargetToken.invalidUser.tooltip",values:{text:s.value.text}}):"verifiedDomain"===t&&"group"!==s.type?(0,P.jsx)(P.Fragment,{children:(0,P.jsx)(g.FormattedMessage,{defaultMessage:"{email}{br}will automatically be added to the workspace{br}since @{domain} is a verified domain.",id:"inviteTargetToken.verifiedDomain.tooltip",values:{email:s.value.email,br:(0,P.jsx)("br",{}),domain:(0,r.Gd)(s.value.email)}})}):"group"===s.type?s.value.name??(0,P.jsx)(g.FormattedMessage,{defaultMessage:"Untitled group",id:"inviteTargetToken.group.untitled"}):n}({tokenType:L,email:K,target:s}),render:t=>(0,P.jsx)("div",{style:_.tokenSpan,...t,children:(0,P.jsx)(v.Z,{isSingle:!1,format:F.isMobile?a.lo.Large:a.lo.Medium,showRemoveButton:e.showRemoveButton,onClickRemove:U,disabledFeedback:!0,value:E(L),style:V,shouldWrap:!1})})},W)}},99273:(e,t,s)=>{s.d(t,{Z:()=>S});s(67294);var n=s(480),i=s(86628),o=s(24405),a=s(9291),r=s(31701),l=s(53965),d=s(33728),c=s(26907),u=s(35057),p=s(91219),m=s(95209);const g=l.Ds((e=>{let{environment:t,flowId:s,subscriptionTier:n,origin:i}=e;p.UW(t,{invite_flow_id:s,subscription_tier:n,invite_origin:i})}),1e3);var h=s(47082),f=s(55899),x=s(10039),y=s(85893);const S=function(e){const{flowId:t,store:s,disabled:p,placeholder:S,right:v,focus:b,hideIconColorAndTooltips:M,showEmptyError:j,origin:C,onFocus:w,onSubmit:k,onInputChanged:T}=e,I=(0,n.O7)(),Z=(0,n.Fy)(),P=(0,i.qz)(e.inviteTargetsStore,f.ZP),F=(0,i.VK)((()=>P.state.inviteTargets),[P]),A=(0,i.VK)((()=>P.state.tokenQuery),[P]),_=F.map((e=>{const t="newUser"===e.type?e.value.email:"invalidUser"===e.type?e.value.text:e.value.id;return(0,y.jsx)(x.Z,{store:s,target:e,showRemoveButton:!0,tokenType:M?"member":void 0,onClickRemove:()=>function(e){const{targetToRemove:t,inviteTargetsStore:s}=e;if(0===s.state.inviteTargets.length)return;const n=s.state.inviteTargets.filter((e=>e!==t));0===n.length?s.setState({...s.state,inviteTargets:[]}):s.setState({...s.state,inviteTargets:n})}({inviteTargetsStore:P,targetToRemove:e})},t)})),R=(0,o.yK)((e=>({tokenSpan:{maxWidth:"100%"},tokenInputMenuItem:{paddingTop:_.length>0?4:6,paddingLeft:4,paddingRight:4,paddingBottom:4,borderRadius:4,minHeight:32,...b&&{background:"none"},...p&&{background:e.inputBackground,color:e.mediumTextColor,fill:r.ZP.white,opacity:.4}},inputAndTokenWrapRight:{gap:2},tokenInputMenuItemInput:{paddingTop:0},warningMessage:{color:"#DE5550"}})),[b,p,_]),O=function(e){let{invalidInvites:t,showEmptyError:s,styles:n}=e;if(s)return(0,y.jsx)("div",{style:n,children:(0,y.jsx)(a.FormattedMessage,{id:"inviteTargetsInput.invalidWarning.noEmails",defaultMessage:"Please enter an email address"})});if(0===t.length)return null;const i=t[0].value.text;if(1===t.length)return(0,y.jsx)("div",{style:n,children:(0,y.jsx)(a.FormattedMessage,{id:"inviteTargetsInput.invalidWarning.singleEmail",defaultMessage:"“{text}” is not a valid email",values:{text:i}})});return(0,y.jsx)("div",{style:n,children:(0,y.jsx)(a.FormattedMessage,{id:"inviteTargetsInput.invalidWarning.multipleEmails",defaultMessage:"{additionalInvalid, plural, one {“{text}” and {additionalInvalid} other are not valid emails} other {“{text}” and {additionalInvalid} others are not valid emails}}",values:{text:i,additionalInvalid:t.length-1}})})}({invalidInvites:(0,l.oA)(F.map((e=>"invalidUser"===e.type?e:void 0))),showEmptyError:j,styles:R.warningMessage});return(0,y.jsx)(h.Z,{focus:b,focusAfterAnimation:!0,onClick:()=>{Z.isMobile||null==w||w()},format:h.U.Share,value:A,onChange:e=>async function(e){const{environment:t,event:s,flowId:n,inviteTargetsStore:i,inviteOrigin:o,onInputChanged:a}=e;null==a||a(),i.setState({...i.state,tokenQuery:s.target.value}),g({environment:t,flowId:n,subscriptionTier:(0,u.zt)(),origin:o});const r=s.target.value,{extractedEmails:l,invalidParts:p,newInputValue:h}=(0,d.nj)(r),f=[...await m.M5(t,l),...p.map((e=>({type:"invalidUser",value:{text:e}})))].filter((e=>!c.H({inviteTargetsStore:i,target:e}))),x=[...i.state.inviteTargets,...f];i.setState({...i.state,inviteTargets:x,tokenQuery:h})}({environment:I,event:e,inviteTargetsStore:P,inviteOrigin:C,flowId:t,onInputChanged:T}),type:"email",tokens:_,disabled:p,autoComplete:"off",placeholder:S,onRemoveLastToken:()=>{P.setState({...P.state,inviteTargets:P.state.inviteTargets.slice(0,-1)})},right:v,showBorder:!0,inputStyle:R.tokenInputMenuItemInput,inputAndTokenWrapRightStyle:R.inputAndTokenWrapRight,style:R.tokenInputMenuItem,onSubmit:k,inputFullWidth:!0,message:O})}},71862:(e,t,s)=>{s.d(t,{Z:()=>R,C:()=>B});s(67294);var n=s(83355),i=s(15145),o=s(72141),a=s(21202),r=s(29369),l=s(9291),d=s(31701),c=s(53965),u=s(1898),p=s(37810),m=s(47307),g=s(64921),h=s(84076),f=s(31278),x=s(76798),y=s(26388),S=s(64369),v=s(7567),b=s(84210),M=s(95697),j=s(31075),C=s(55838),w=s(61766),k=s(77080),T=s(6258),I=s(88893),Z=s(88280),P=s(9867),F=s(1951),A=s(85893);const _=function(e){const{store:t}=e;return(0,A.jsx)(l.FormattedMessage,{defaultMessage:"This access is based on {inlineIconAndName}. Changing this access will restrict permissions of this page.",id:"blockPermissionsSettings.restrictedPermissions.tooltip",values:{inlineIconAndName:(0,A.jsx)(F.Z,{store:t,useInvertedColors:!0})}})},R=32;class O extends n.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:w.Z},this.permissionItemStore=void 0,this.handleRoleSelect=async e=>{if(D(this.props.permissionItem))return;const t=this.props.permissionItem,s=c.d9(t);s.role=e;const n=this.props.currentBlockStore.isTopLevel();if(n&&o.ix(s)){const e=Z.subscriptionDataStoreInstance.state,i=e?I.su(e):1;if(!(0,M.bq)()&&o.YX(t.role)&&!o.YX(s.role)&&i>1){if(!(await m.confirmUserAction({message:(0,A.jsx)("span",{children:(0,A.jsx)(l.FormattedMessage,{defaultMessage:"Are you sure you want to make this page private? <semibold>Only you will be able to access it.</semibold>",values:{semibold:e=>(0,A.jsx)("span",{style:{fontWeight:p.Z.fontWeight.semibold},children:e})},id:"blockPermissionsSettings.confirmationDialog.private.message"})}),acceptLabel:(0,A.jsx)(l.FormattedMessage,{defaultMessage:"Move to Private",id:"blockPermissionsSettings.confirmationDialog.privateButton.label"})})))return}else if(!(0,M.bq)()&&n&&!o.YX(t.role)&&o.YX(s.role)){if(!(await m.confirmUserAction({message:(0,A.jsx)("span",{children:(0,A.jsx)(l.FormattedMessage,{defaultMessage:"Are you sure you want to share this page with the workspace? <semibold>It will be accessible by all {memberCount} members.</semibold>",id:"blockPermissionsSettings.confirmationDialog.workspace.message",values:{semibold:e=>(0,A.jsx)("span",{style:{fontWeight:p.Z.fontWeight.semibold},children:e}),memberCount:i}})}),acceptLabel:(0,A.jsx)(l.FormattedMessage,{defaultMessage:"Move to workspace",id:"blockPermissionsSettings.confirmationDialog.workspaceButton.label"})})))return}}await(0,j.i)({oldPermissionItem:t,newPermissionItem:s,wasInherited:this.isInherited(),environment:this.environment,store:this.props.currentBlockStore,sudoModeStore:this.props.sudoModeStore,location:this.props.location,fromPermissionWrapper:this.props.fromPermissionWrapper})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleUserItemClick=()=>{var e;(e=this.stores.buttonPopupStore).setState({...e.state,open:!0})}}UNSAFE_willMountOrUpdate(){this.permissionItemStore=W(this.props.from,this.props.currentBlockStore)}renderComponent(){const{device:e}=this.environment,t=this.props.onClick?this.props.onClick:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleUserItemClick,s=N(this.props.permissionItem,this.props.currentBlockStore),n=this.renderTooltip();return(0,A.jsx)(y.ZP,{delayThreshold:0,renderTooltip:()=>n,textWrap:!0,disableTooltip:!Boolean(n),style:{maxWidth:240},render:n=>(0,A.jsx)(g.Z,{disabled:s,mobileFeedback:e.isMobile,ignoreLocalHoverState:this.props.ignoreLocalHoverState,style:{...s?{cursor:"not-allowed"}:{}},onClick:t,...n,children:this.renderMenuItem()}),placement:y.ug.Left})}renderMenuItem(){const{device:e}=this.environment,{showInherited:t,permissionItem:s}=this.props,n=this.isInherited();return(0,A.jsxs)("div",{className:"notranslate",style:U(this.environment,this.props.isCompact),children:[(0,A.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,marginRight:e.isMobile?12:10,...this.props.iconStyle},children:this.props.icon}),(0,A.jsxs)("div",{style:{marginRight:"auto",minWidth:0},children:[(0,A.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,A.jsx)(S.Z,{style:{...!L(s)&&{fontWeight:400}},children:this.props.title}),this.props.tag&&(0,A.jsx)("div",{style:{marginLeft:4},children:this.props.tag})]}),this.props.subtitle&&(0,A.jsx)(S.Z,{isSmall:!0,children:this.props.subtitle}),t&&n&&this.renderInheritedRecordTitle()]}),(0,A.jsx)("div",{style:{display:"flex",alignItems:"center",flexShrink:0,marginLeft:8},children:this.props.permissionRoleSelect?this.props.permissionRoleSelect:!D(s)&&(0,A.jsx)(v.ZP,{role:this.role,table:a.iU,blockType:this.props.currentBlockStore.getType(),type:s.type,disabled:N(this.props.permissionItem,this.props.currentBlockStore),isUserPermission:E(s,this.environment),onChange:this.handleRoleSelect,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,buttonPopupStore:this.stores.buttonPopupStore,buttonStyle:{marginRight:-8,color:this.theme.mediumTextColor,fontSize:e.isMobile?14:12},showPermissionOverrideWarning:n,isRemovableOverride:this.props.isRemovableOverride})})]})}renderTooltip(){return this.isInherited()?!V(this.props.permissionItem)&&this.permissionItemStore?(0,A.jsx)(_,{store:this.permissionItemStore}):null:this.props.nonInheritedTooltip}renderInheritedRecordTitle(){const e=this.permissionItemStore||W(this.props.from,this.props.currentBlockStore),t=e.table===a.iU?(0,b.ZP)({store:e,fullyQualified:!1,pageVisitSource:i.tY.LinkInPage}):void 0,s=e.table===r.e0?()=>{e.table===r.e0&&P.RF({environment:this.environment,teamId:e.id,tab:C.a.Members,from:"permission_item"})}:void 0,{device:n}=this.environment,o=e.getIcon(),c="team"!==e.table&&e.isEmptyPage();return(0,A.jsx)(S.Z,{isSmall:!0,style:{lineHeight:1.4},children:n.isMobile?(0,A.jsx)(l.FormattedMessage,{defaultMessage:"Based on {linkBoxWithPageTitle}",id:"pagePermissionItem.inheritedRecordPermissions.setting",values:{linkBoxWithPageTitle:(0,A.jsx)(h.Z,{disabled:n.isMobile,underline:!n.isMobile,inline:!0,href:t,onClick:s,children:(0,A.jsx)(x.Z,{store:e,style:{display:"inline"}})})}}):(0,A.jsx)(l.FormattedMessage,{defaultMessage:"From {linkBoxWithPageTitle}",id:"pagePermissionItem.fromInheritedRecordPermissions.setting",values:{linkBoxWithPageTitle:(0,A.jsxs)(h.Z,{disabled:n.isMobile,underline:!1,inline:!0,href:t,onClick:s,innerStyle:{display:"inline-flex",alignItems:"center",borderBottom:`0.5px solid ${d.ZP.mediumTextColor}`},children:[(0,A.jsx)(f.Z,{disabled:!0,style:{marginRight:4},icon:o,size:14,isEmptyPage:c}),(0,A.jsx)(x.Z,{store:e,style:{display:"inline",fontWeight:p.Z.fontWeight.semibold}})]})}})})}get role(){const{permissionItem:e,currentBlockStore:t}=this.props;if(D(e))return"none";if("content_only_editor"===e.role&&this.isInherited()){var s,n;const i=t.getAssociatedCollectionStore(),o=null==i?void 0:i.getParentBlockStore();return o&&o.table===(null===(s=this.permissionItemStore)||void 0===s?void 0:s.table)&&o.id===(null===(n=this.permissionItemStore)||void 0===n?void 0:n.id)?e.role:"read_and_write"}return e.role}isInherited(){var e;return(null===(e=this.permissionItemStore)||void 0===e?void 0:e.id)!==this.props.currentBlockStore.id}}O.displayName="PermissionItem";const B=O;function D(e){return"team_overview_permission"===e.type||"hidden_permission"===e.type}function L(e){return"user_permission"===e.type}function V(e){return"team_overview_permission"===e.type}function N(e,t){return"hidden_permission"===e.type||(!V(e)&&!t.canAdmin()||t.pathIsDead()&&k.default.checkGate("prevent_edits_trash"))}function E(e,t){const s=t.currentUser.id;return"user_permission"===e.type&&e.user_id===s}function U(e,t){const{WindowSizeStore:s}=e;return{display:"flex",alignItems:"center",minHeight:t?44:52,paddingTop:8,paddingBottom:8,paddingLeft:s.getSafePaddingLeftCSS(14),paddingRight:s.getSafePaddingRightCSS(14)}}function W(e,t){const s=e.table;return s===a.iU?T.G.createChildStore(t,{table:a.iU,id:e.blockId}):s===r.e0?T.zX.createChildStore(t,{table:r.e0,id:e.teamId}):void(0,u.t1)(s)}},40422:(e,t,s)=>{s.r(t),s.d(t,{OfflineMessage:()=>ti,default:()=>si});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(9291),l=s(1743),d=s(56940),c=s(78140),u=s(40721),p=s(64369),m=s(46247),g=s(43250),h=s(60709),f=s(18514),x=s(80444),y=s(88632),S=s(85834),v=s(52878),b=s(90335),M=s(28578),j=s(48608),C=s(1898),w=s(55899),k=s(41892),T=s(80721),I=s(91315),Z=s(64275),P=s(45238),F=s(85893);const A=(0,P.IU)("globe3",{viewBox:"0 0 15 15",svg:(0,F.jsx)("path",{d:"M8.052 12.458c.196 0 .44-.114.731-.342a6.52 6.52 0 00.916-.882c.315-.364.609-.752.882-1.162a8.03 8.03 0 00.67-1.19c.173-.377.26-.694.26-.95 0-.19-.082-.405-.246-.642a3.52 3.52 0 00-.63-.69 3.984 3.984 0 00-.792-.547c-.27-.146-.513-.219-.732-.219a.93.93 0 00-.43.123c-.155.078-.308.157-.458.24a.842.842 0 01-.383.115c-.078 0-.182-.038-.315-.116a3.409 3.409 0 01-.758-.608c-.096-.11-.144-.194-.144-.253 0-.041.03-.084.089-.13a.296.296 0 01.178-.075c.059 0 .166.055.32.164.16.105.33.21.507.314.178.1.332.15.465.15.291 0 .526-.088.704-.266.177-.178.266-.42.266-.724 0-.187-.082-.4-.246-.636.192-.1.408-.219.65-.356.246-.14.492-.298.738-.471.246-.178.47-.372.67-.581.205-.21.36-.429.465-.657l-.663-.341c-.087.21-.235.412-.445.608a5 5 0 01-.717.54c-.265.169-.53.321-.793.458a61.02 61.02 0 00-.69.362.332.332 0 00-.172.199c-.027.082-.004.173.069.273.14.196.241.344.3.444a.47.47 0 01.096.246c0 .05-.016.092-.048.123a.182.182 0 01-.123.042c-.073 0-.191-.05-.355-.15a9.923 9.923 0 00-.527-.315c-.182-.11-.34-.164-.471-.164a.889.889 0 00-.472.143 1.38 1.38 0 00-.383.362.747.747 0 00-.15.438c0 .155.068.33.205.526.141.196.317.385.526.568.21.182.424.332.643.45.223.115.417.172.58.172.128 0 .279-.039.452-.116.173-.082.337-.164.492-.247.155-.082.265-.123.328-.123.11 0 .256.055.438.164.187.105.374.237.56.397.187.155.345.308.472.458.132.146.198.262.198.349 0 .155-.075.385-.225.69-.15.3-.342.627-.575.978-.232.35-.476.688-.731 1.011-.255.324-.492.59-.71.8-.22.205-.386.308-.5.308a.393.393 0 01-.226-.082c-.072-.06-.109-.117-.109-.171a.54.54 0 01.014-.116 5.696 5.696 0 00.192-.623c.04-.145.058-.303.054-.471-.005-.228-.103-.438-.294-.63a7.264 7.264 0 00-.882-.71 4.55 4.55 0 00-.219-.15l-.218-.164c-.196-.15-.294-.301-.294-.452 0-.082.03-.21.089-.382.068-.242.102-.415.102-.52a.703.703 0 00-.123-.41 1.948 1.948 0 00-.376-.397.747.747 0 01-.061-.054.188.188 0 00-.055-.048l-1.087-.97c-.442-.397-.743-.748-.902-1.054-.16-.31-.215-.603-.164-.881.054-.278.175-.57.362-.875l-.718-.144c-.205.324-.33.668-.376 1.032-.046.365.03.752.226 1.162.196.41.556.848 1.08 1.313l1.08.957c.123.105.214.184.273.24.064.054.098.104.103.15a1.235 1.235 0 01-.103.341c-.059.15-.089.33-.089.54 0 .401.196.748.588 1.04.392.296.709.533.95.71.247.174.37.297.37.37a1.26 1.26 0 01-.13.587c-.087.187-.13.4-.13.636 0 .16.055.312.164.458.11.146.248.267.417.363.169.095.337.143.506.143zm-.267 1.668c.966 0 1.875-.185 2.728-.554a7.22 7.22 0 003.787-3.78 6.788 6.788 0 00.553-2.728c0-.966-.184-1.875-.553-2.727a7.137 7.137 0 00-1.531-2.25 7.219 7.219 0 00-2.256-1.53A6.805 6.805 0 007.778.003a6.77 6.77 0 00-2.727.554 7.241 7.241 0 00-3.774 3.78 6.788 6.788 0 00-.553 2.727c0 .967.184 1.876.553 2.728.37.852.878 1.604 1.525 2.256a7.124 7.124 0 002.256 1.524 6.77 6.77 0 002.727.554zm0-1.094a5.692 5.692 0 01-2.304-.472 6.034 6.034 0 01-1.9-1.285 6.217 6.217 0 01-1.292-1.907 5.765 5.765 0 01-.465-2.304c0-.815.155-1.583.465-2.303a6.133 6.133 0 011.292-1.9 6.036 6.036 0 011.9-1.286 5.676 5.676 0 012.297-.471 5.7 5.7 0 012.304.471c.72.31 1.356.738 1.907 1.285.552.547.982 1.18 1.292 1.9.315.72.472 1.489.472 2.304 0 .816-.157 1.584-.472 2.304a6.06 6.06 0 01-3.192 3.192 5.693 5.693 0 01-2.304.472z"})});var _=s(43876),R=s(31701),O=s(37810),B=s(5581),D=s(51077),L=s(73063),V=s(66957);function N(e){let{inviteTargetsStore:t,mostPermissivePublicItem:s}=e;const{display:n,source:i}=(0,o.VK)((()=>{const{display:e}=M.ZP.state;if(e===M.wV.Invite){const{source:t}=M.ZP.state;return{display:e,source:t}}return{display:e,source:void 0}}),[]);switch(n){case M.wV.MainShareMenu:case M.wV.Publish:return(0,F.jsx)(U,{mostPermissivePublicItem:s});case M.wV.Invite:if("notion"===i)return(0,F.jsx)(K,{inviteTargetsStore:t});if("slack"===i)return(0,F.jsx)(z,{});throw(0,C.t1)(i);default:(0,C.t1)(n)}}const E=[M.XF.Share,M.XF.Publish];function U(e){let{mostPermissivePublicItem:t}=e;const s=(0,i.O7)(),l=n.useRef(null),{isMobile:d}=s.device,c=(0,o.VK)((()=>M.ZP.state.tab),[]),u=(0,a.yK)((e=>({tabStyle:{color:e.lightTextColor,...d&&{width:"50%",textAlign:"center"}},selectedTabStyle:{fontWeight:O.Z.fontWeight.medium},tabTitleStyle:{color:"inherit"},style:d?{marginBottom:8,justifyContent:"space-between"}:{marginBottom:14}})),[d]),p=(0,a.yK)((()=>({publishTabContainer:{display:"flex",alignItems:"center"}})),[]),m=(0,n.useCallback)((e=>{const t=E[e];t!==c&&(B.Y(s,{tab:t}),t===M.XF.Share&&M.ZP.setState({...M.ZP.state,display:M.wV.MainShareMenu,tab:M.XF.Share}),t===M.XF.Publish&&M.ZP.setState({...M.ZP.state,display:M.wV.Publish,tab:M.XF.Publish}))}),[c,s]),h="none"!==t.permissionItem.role,f=[(0,F.jsx)(n.Fragment,{children:d?(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Permissions",id:"shareMenu.permissionsTab.title"},"permissions"):(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Share",id:"shareMenu.shareTab.title"},"share")},"title"),(0,F.jsxs)("div",{ref:l,style:p.publishTabContainer,className:g.UBk,children:[(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Publish",id:"shareMenu.publishTab.title"},"publish"),h&&W.publishedCheckIcon({opacity:c===M.XF.Publish?1:.5})]},"publishTab")];return(0,F.jsx)(V.Z,{...u,tabs:f,selectedIndex:E.indexOf(c),onChange:m})}const W={[M.XF.Share]:(0,_.s)({height:17,width:17,marginRight:4}),[M.XF.Publish]:A({height:15,width:15,marginRight:4}),publishedCheckIcon:e=>{let{opacity:t}=e;return(0,I.r)({color:R.ZP.blue,width:14,height:14,marginLeft:4.5,opacity:t})}};function K(e){let{inviteTargetsStore:t}=e;const s=(0,a.yK)((()=>({container:{display:"flex",margin:"0 12px 6px",height:48}})),[]),i=(0,n.useCallback)((()=>{t.reset(),M.ZP.setState({...M.ZP.state,display:M.wV.MainShareMenu,tab:M.XF.Share})}),[t]);return(0,F.jsx)("div",{style:s.container,children:(0,F.jsx)(q,{onClick:i})})}function z(){const e=(0,r.useIntl)(),t=(0,a.yK)((()=>({container:{display:"flex",justifyContent:"space-between",margin:"0 12px",height:48,alignItems:"center"},titleLabel:{display:"flex",fontSize:12,alignItems:"center",fontWeight:O.Z.fontWeight.semibold}})),[]),s=(0,n.useCallback)((()=>{M.ZP.setState({...M.ZP.state,tab:M.XF.Share,display:M.wV.Invite,source:M.T5.Notion,focus:M.Sw.Search,emailMessage:""})}),[]),i=(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(D.Z,{type:"image_url",imageURL:k.Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:{marginLeft:4,marginRight:4}}),(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Slack",id:"shareMenu.slackIntegrationName.label"})]});return(0,F.jsxs)("div",{style:t.container,children:[(0,F.jsx)(p.Z,{style:t.titleLabel,children:(0,F.jsx)(r.FormattedMessage,{id:"shareMenu.addFromSlack.label",defaultMessage:"Add people from {integrationNameWithLogo}",values:{integrationNameWithLogo:i}})}),(0,F.jsx)(L.Z,{ariaLabel:e.formatMessage({id:"shareMenuHeader.goBackToInviteFromNotionMenu.iconButton",defaultMessage:"Close slack integration and go back to the main invite flow."}),icon:Z.D,style:{borderRadius:"100%"},onClick:s})]})}function q(e){const{onClick:t}=e,s=(0,r.useIntl)(),n=(0,a.yK)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},backButtonPressedStyle:{backgroundColor:"transparent"},iconButton:{marginRight:6,height:24,width:24},arrowIcon:{height:16,width:16,strokeWidth:O.Z.fontWeight.semibold},sendInviteLabel:{fontWeight:O.Z.fontWeight.medium}})),[]);return(0,F.jsxs)("div",{style:n.topContainer,children:[(0,F.jsx)(L.Z,{icon:T.W,iconStyle:n.arrowIcon,style:n.iconButton,onClick:t,ariaLabel:s.formatMessage({id:"shareMenu.backButton.iconButton",defaultMessage:"Go back to main share menu."})}),(0,F.jsx)(p.Z,{style:n.sendInviteLabel,children:(0,F.jsx)(r.FormattedMessage,{id:"shareMenu.sendInvite.label",defaultMessage:"Send invite"})})]})}var G=s(84169),H=s(85354),Y=s(21202),Q=s(12714),$=s(58297),J=s(98165),X=s(40134);function ee(e){let{store:t}=e;return(0,o.VK)((()=>{const e=(0,X.B)({blockId:t.id,setting:"publicAccess"});if((0,C.$K)(e))return e;const s=x.default.state.currentSpaceStore,n=(0,J.VP)(t);return n?{disabled:Boolean(n.getDisablePublicAccess()),disabledBy:"team"}:!n&&null!=s&&s.getDisablePublicAccess()?{disabled:!0,disabledBy:"space"}:{disabled:!1}}),[t])}var te=s(31075);function se(e){const{store:t,mostPermissivePublicItem:s,permissionItemArgs:l}=e,{permissionItem:d,from:c}=s,{sudoModeStore:u,location:m}=l,h=(0,i.O7)(),f=(0,o.VK)((()=>t.canAdmin()),[t]),y=(0,o.VK)((()=>!t.pathIsAccessibleAndAlive()),[t]),{disabled:S}=ee({store:t}),v=!f||S||y,b=(0,a.yK)((e=>({container:{display:"flex",flex:1,justifyContent:"center",alignItems:"center",flexDirection:"column",padding:32,textAlign:"center",cursor:v?"not-allowed":""},icon:{height:30,width:30,marginBottom:10,fill:e.mediumIconColor},title:{fontWeight:O.Z.fontWeight.semibold,fontSize:14},caption:{display:"flex",alignItems:"center",marginLeft:26,marginRight:26,marginBottom:20},button:{display:"flex",width:"100%",padding:16,cursor:v?"not-allowed":"pointer"}})),[v]),M=(0,o.VK)((()=>{var e;return null===(e=x.default.state.currentSpaceStore)||void 0===e?void 0:e.getDisableMoveToSpace()}),[]),j=c.table===Y.iU?c.blockId:c.teamId,C=(0,n.useCallback)((()=>{const e=!M&&d.allow_duplicate;(0,te.i)({oldPermissionItem:d,newPermissionItem:{...d,role:"reader",allow_duplicate:e},wasInherited:j!==t.id,environment:h,store:t,sudoModeStore:u,location:m})}),[h,j,m,M,d,t,u]);return(0,F.jsxs)("div",{style:b.container,children:[(0,H.u)(b.icon),(0,F.jsx)("div",{style:b.title,children:(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Publish to web",id:"publishTab.publishToWeb.title"})}),(0,F.jsx)(p.Z,{isMultiline:!0,isSecondaryColor:!0,style:b.caption,children:(0,F.jsx)(ne,{store:t})}),(0,F.jsx)($.Z,{style:b.button,disabled:v,onClick:C,className:g.wlU,children:(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Publish",id:"publishTab.publishToWeb.button"})})]})}function ne(e){let{store:t}=e;const s=ee({store:t}),n=(0,i.O7)(),l=(0,o.VK)((()=>t.canAdmin()),[t]),d=(0,a.yK)((e=>({helpIcon:{width:16,height:16}})),[]);return s.disabled&&"team"===s.disabledBy?(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Publishing to web is disabled for this page via teamspace settings.",id:"publishTab.publishToWeb.disabledByTeamspace.caption"}):s.disabled&&"space"===s.disabledBy?(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Publishing to web is disabled for this page via workspace settings.",id:"publishTab.publishToWeb.disabledByWorkspace.caption"}):l?(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Publish a static website of this page.",id:"publishTab.publishToWeb.hasFullAccess.caption"}),(0,F.jsx)(L.Z,{iconStyle:d.helpIcon,onClick:()=>{Q.D({environment:n,url:(0,f.UY)("guides.autogeneratedDomains")})},icon:G.m,ariaLabel:"Learn more about sites"})]}):(0,F.jsx)(r.FormattedMessage,{defaultMessage:"You must have full access to this page to publish to web.",id:"publishTab.publishToWeb.noFullAccess.caption"})}var ie=s(79395);function oe(e){const{store:t,mostPermissivePublicItem:s,permissionItemArgs:n}=e,{permissionItem:i}=s;return"none"!==i.role?(0,F.jsx)(ie.Z,{store:t,mostPermissivePublicItem:s,permissionItemArgs:n,showAllPublishedSites:!0}):(0,F.jsx)(se,{store:t,mostPermissivePublicItem:s,permissionItemArgs:n})}var ae=s(91219),re=s(95209),le=s(3386),de=s(26388),ce=s(7567),ue=s(44385),pe=s(4708),me=s(79817),ge=s(26907),he=s(46654),fe=s(45101),xe=s(73819),ye=s(53353),Se=s(26781),ve=s(29798),be=s(88893),Me=s(88280),je=s(57345);function Ce(e){const{tooltip:t,disabled:s,onClick:n}=e;return(0,F.jsx)(de.ZP,{disableTooltip:!Boolean(t),renderTooltip:()=>t,render:e=>(0,F.jsx)($.Z,{isLarge:!0,style:{marginLeft:8},disabled:s,onClick:n,...e,children:(0,F.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.invite",defaultMessage:"Invite"})})})}var we=s(77657),ke=s(54642),Te=s(53336),Ie=s(34859),Ze=s(30874),Pe=s(94044),Fe=s(74194);function Ae(e){const{shouldShowLengthWarning:t,shouldShowLinkWarning:s,value:n,maxLength:i}=e,o=(0,a.yK)((e=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:e.lightTextColor,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:e.modalBackground,marginTop:1}})),[]);return(0,F.jsx)("div",{style:o.container,children:(0,F.jsxs)("div",{style:o.warning,children:[t&&(0,F.jsx)(r.FormattedMessage,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:n.length,maxCharacters:i}}),t&&s&&" · ",s&&(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})})}function _e(e){const{open:t,focus:s,value:n,maxLength:i,onFocus:o,onChange:l,onCancel:d}=e,c=(0,r.useIntl)(),u=n.length/i>=.8,p=(0,Pe.TQ)(n),m=u||p,g=(0,a.yK)((e=>({container:{maxHeight:t?100:0,position:"absolute",bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:t?"all":"none",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",overflow:"hidden",zIndex:1},input:{maxHeight:t?100:0,borderTop:1,borderTopStyle:"solid",borderTopColor:e.regularDividerColor,padding:18,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s"}})),[t]),h=c.formatMessage({id:"shareMenu.emailMessageInput.placeholder",defaultMessage:"Add a message to your invite..."});return(0,F.jsxs)("div",{style:g.container,children:[m&&(0,F.jsx)(Ae,{value:n,maxLength:i,shouldShowLengthWarning:u,shouldShowLinkWarning:p}),(0,F.jsx)(Fe.Z,{textarea:!0,focusInitial:!1,format:Fe.B.Transparent,placeholder:h,maxlength:i,focus:s,value:n,onFocus:o,onChange:l,inputStyle:g.input,onCancel:d})]})}var Re=s(56678),Oe=(s(57658),s(33728)),Be=s(58573),De=s(59054),Le=s(85397),Ve=s(47612);const Ne=(0,P.IU)("arrowUpLeft",{viewBox:"0 0 16 16",svg:(0,F.jsx)("path",{d:"M0.845703 8.58691L0.852539 1.72363C0.852539 1.48665 0.923177 1.29525 1.06445 1.14941C1.21029 0.999023 1.40625 0.923828 1.65234 0.923828H8.51562C8.74349 0.923828 8.93034 0.999023 9.07617 1.14941C9.22201 1.2998 9.29492 1.47526 9.29492 1.67578C9.29492 1.8763 9.21973 2.04948 9.06934 2.19531C8.91895 2.33659 8.74121 2.40723 8.53613 2.40723H6.10254L3.16309 2.30469L4.40723 3.39844L10.915 9.91992C11.0745 10.084 11.1543 10.264 11.1543 10.46C11.1543 10.5921 11.1178 10.7174 11.0449 10.8359C10.972 10.9544 10.8763 11.0479 10.7578 11.1162C10.6439 11.1891 10.5186 11.2256 10.3818 11.2256C10.1813 11.2256 10.0013 11.1481 9.8418 10.9932L3.32715 4.47852L2.21973 3.23438L2.33594 6.05078V8.60742C2.33594 8.8125 2.26302 8.99251 2.11719 9.14746C1.97591 9.29785 1.80273 9.37305 1.59766 9.37305C1.39714 9.37305 1.22168 9.29785 1.07129 9.14746C0.920898 8.99707 0.845703 8.81022 0.845703 8.58691Z"})});var Ee=s(36591),Ue=s(16880),We=s(25942),Ke=s(36329),ze=s(72141),qe=s(29369),Ge=s(19889),He=s(64684),Ye=s(91536),Qe=s(21752),$e=s(52275),Je=s(12793),Xe=s(32163),et=s(43765),tt=s(31278),st=s(76798),nt=s(72495),it=s(33241),ot=s(69507),at=s(70268);function rt(){const e=Me.subscriptionDataStoreInstance.state,t=e?be.CM(e):[],s=new Map;return t.forEach((e=>{s.set(e.userId,e)})),s}function lt(e){const{spaceVisibleUserMap:t,blockStore:s,userId:n}=e,i=t.get(n);if(!i||"none"!==i.role)return;if(!i.isTeamGuest)return"guest";const o=J.VP(s);if(!o)return"guest";return(0,He.s8)({team:{membership:o.getRawMembership()},userId:n})?"team_level_guest":"guest"}var dt=s(98742),ct=s(48779),ut=s(16639),pt=s(6258),mt=s(35057),gt=s(25735),ht=s(60442),ft=s(71862);function xt(e){const{group:t}=e,s=(0,r.useIntl)(),n=(0,ut.kF)({intl:s,group:t});return(0,F.jsx)(gt.Y,{group:t,limit:15,noMembersMessage:(0,F.jsx)(ht.Z,{imageURL:k.Z.images.tooltips.share.sharedPng,imageWidth:240,imageHeight:120,caption:(0,F.jsx)(r.FormattedMessage,{defaultMessage:"For all members of the {groupName} group, this page will show up in the <boldtext>Shared</boldtext> section in their sidebar.",values:{boldtext:e=>(0,F.jsx)("span",{style:{fontWeight:O.Z.fontWeight.bold},children:e}),groupName:n},id:"blockPermissionsSettings.groupPermission.tooltip"})})})}const yt=function(e){const{store:t,groupPermission:s,spaceId:n,fromPermissionWrapper:i}=e,a=(0,r.useIntl)(),l=(0,o.VK)((()=>{const{currentSpaceStore:e}=x.default.state;if(!e)return!1;return e.getPermissionGroups().find((e=>e.id===s.permissionItem.group_id))}),[s.permissionItem.group_id]);if(!l)return null;const d=l.user_ids||[],c=(0,ut.kF)({intl:a,group:l}),u=l.icon&&(0,F.jsx)(tt.Z,{disabled:!0,title:c,icon:l.icon?{pointer:{table:"space",id:n},icon:l.icon}:void 0,isEmptyPage:!1,size:18});return(0,F.jsx)("div",{style:{fontWeight:400},className:g.gGc,children:(0,F.jsx)(ft.C,{currentBlockStore:t,permissionItem:s.permissionItem,from:s.from,icon:(0,F.jsx)(Je.Z,{size:ft.Z}),title:c,tag:u,ignoreLocalHoverState:e.ignoreLocalHoverState,showInherited:e.showInherited,nonInheritedTooltip:(0,F.jsx)(xt,{group:l}),subtitle:(0,F.jsxs)("div",{children:[(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,F.jsx)(r.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:d.length}})]}),upgradeButtonName:"group_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:i,...e.permissionItemArgs})},l.id)};var St=s(7928),vt=s(88198),bt=s(45653);function Mt(e){const{userValue:t,shouldShowPendingInvitation:s}=e,n=(0,a.yK)((()=>({iconPlaceholder:{height:ft.Z,width:ft.Z,borderRadius:20}})),[]);return t?(0,F.jsx)(bt.Z,{userValue:t,size:ft.Z,initialOverrideStyle:s?{borderStyle:"dashed"}:void 0}):(0,F.jsx)(wt,{style:n.iconPlaceholder})}function jt(e){const{userValue:t,guestLabel:s,shouldShowPendingInvitation:n}=e,i=(0,r.useIntl)(),l=(0,o.VK)((()=>{const{currentUserStore:e}=x.default.state;return!!e&&(!!t&&e.id===t.id)}),[t]),d=(0,a.yK)((e=>({titlePlaceholder:{height:8,width:81,borderRadius:4},pendingInvitation:{color:R.ZP.PendingInvitationTextColor},titleYouIndicator:{color:e.mediumTextColor}})),[]);if(!t)return(0,F.jsx)(wt,{style:d.titlePlaceholder});const c=(0,St.Nz)(i,t);return(0,F.jsx)(F.Fragment,{children:c?(0,F.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,F.jsx)(p.Z,{className:"notranslate",style:n?d.pendingInvitation:void 0,children:l?(0,F.jsx)(r.FormattedMessage,{id:"cellMemberAvatar.displayName.title",defaultMessage:"{userFullDisplayName} <youIndicatorText>(You)</youIndicatorText>",values:{userFullDisplayName:c,youIndicatorText:e=>(0,F.jsx)("span",{style:d.titleYouIndicator,children:e})}}):c}),s&&(0,F.jsx)(vt.b,{labelType:s})]}):(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Invitation sent",id:"blockPermissionsSettings.sentInvitation.message"})})}function Ct(e){const{userValue:t,shouldShowPendingInvitation:s}=e,n=(0,a.yK)((()=>({uiLabel:{display:"flex"},subtitlePlaceholder:{height:8,width:139,borderRadius:4,marginTop:10},dotSeparator:{marginLeft:2,marginRight:2},pendingInvitation:{color:R.ZP.PendingInvitationTextColor}})),[]);return null!=t&&t.email?s?(0,F.jsx)(p.Z,{isSmall:!0,style:n.pendingInvitation,children:(0,F.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.invitationSent",defaultMessage:"Pending Invitation"})}):(0,F.jsx)(p.Z,{isSmall:!0,children:t.email}):(0,F.jsx)(wt,{style:n.subtitlePlaceholder})}function wt(e){const t=(0,a.yK)((t=>({placeholder:{...e.style,background:t.lightDividerColor}})),[e.style]);return(0,F.jsx)("div",{style:t.placeholder})}const kt=function(e){const{store:t,userPermission:s,spaceVisibleUserMap:n,fromPermissionWrapper:i}=e,a=(0,o.VK)((()=>pt.U6.createChildStore(t,{table:Ge.KJ,id:s.permissionItem.user_id}).getValue()),[t,s.permissionItem.user_id]),r=(0,o.VK)((()=>{if(null!=a&&a.id)return lt({spaceVisibleUserMap:n,userId:a.id,blockStore:t})}),[t,n,a]),l=(0,o.VK)((()=>!0!==(null==a?void 0:a.onboarding_completed)&&(0,pe.fJ)()),[a]);return(0,F.jsx)("div",{children:(0,F.jsx)(ft.C,{currentBlockStore:t,permissionItem:s.permissionItem,from:s.from,ignoreLocalHoverState:e.ignoreLocalHoverState,icon:(0,F.jsx)(Mt,{userValue:a,shouldShowPendingInvitation:l}),title:(0,F.jsx)(jt,{userValue:a,guestLabel:r,shouldShowPendingInvitation:l}),subtitle:(0,F.jsx)(Ct,{userValue:a,shouldShowPendingInvitation:l}),showInherited:e.showInherited,upgradeButtonName:"user_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:i,...e.permissionItemArgs})},s.permissionItem.user_id)};var Tt=s(10039),It=s(62385);function Zt(e){const{publicPermission:t}=e,s=(0,a.yK)((e=>({banner:{backgroundColor:e.accentColors.gray[50],borderRadius:4,height:34,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingRight:14,display:"flex",alignItems:"center"},label:{fontSize:12,display:"inline-flex",marginRight:10},icon:{height:20,width:20,marginLeft:14,marginRight:8,color:e.mediumIconColor},manageButton:{color:e.regularTextColor,fontWeight:O.Z.fontWeight.medium}})),[]),n=t.permissionItem.role;return ze.YX(n)?(0,F.jsxs)("div",{style:s.banner,children:[(0,F.jsxs)(p.Z,{style:s.label,children:[A(s.icon),(0,F.jsx)(Pt,{role:n})]}),(0,F.jsx)(It.Z,{style:s.manageButton,onClick:()=>M.ZP.setState({...M.ZP.state,display:M.wV.Publish,tab:M.XF.Publish}),children:(0,F.jsx)(r.FormattedMessage,{id:"shareMenu.managePublishSettingsButton.label",defaultMessage:"Manage"})})]}):null}function Pt(e){const{role:t}=e;switch(t){case"read_and_write":return(0,F.jsx)(r.FormattedMessage,{id:"shareMenu.publicPermissionBanner.canEdit",defaultMessage:"This page allows edits from anyone on the web"});case"comment_only":return(0,F.jsx)(r.FormattedMessage,{id:"shareMenu.publicPermissionBanner.canComment",defaultMessage:"This page allows comments from anyone on the web"});case"reader":return(0,F.jsx)(r.FormattedMessage,{id:"shareMenu.publicPermissionBanner.canRead",defaultMessage:"This page can be viewed by anyone on the web"});case"editor":case"membership_admin":case"content_only_editor":case"none":return null;default:(0,C.t1)(t)}}var Ft=s(27714),At=s(90965),_t=s(74016);function Rt(e){const{store:t,spacePermission:s,fromPermissionWrapper:n}=e,i=(0,a.yK)((e=>({icon:{width:17,height:17,fill:e.mediumIconColor},iconContainer:{backgroundColor:e.lightDividerColor,borderRadius:32}})),[]);return(0,F.jsx)(ft.C,{icon:(0,Ft.N)(i.icon),iconStyle:i.iconContainer,title:(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Members with the link",id:"blockPermissionsSettings.permissionItem.linkAccess"}),currentBlockStore:t,permissionItem:s.permissionItem,from:s.from,upgradeButtonName:"space_permission_item",fromPermissionWrapper:n,...e.permissionItemArgs})}function Ot(e){const{spaceStore:t}=e,s=(0,i.O7)(),n=(0,o.VK)((()=>(0,ct.rn)(s,t)),[s,t]);return(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Everyone at {workspaceName}",id:"blockPermissionsSettings.permissionItem.workspaceAccessNew",values:{workspaceName:n}})}function Bt(e){const{spaceStore:t}=e,s=(0,o.VK)((()=>(0,At.t5)((0,ct.jv)(t))),[t]);return(0,F.jsx)(r.FormattedMessage,{defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} person} other {{numberOfWorkspaceMembers} people}}",id:"blockPermissionsSettings.spacePermission.none",values:{numberOfWorkspaceMembers:s}})}function Dt(){return(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Applies to all members in your workspace.",id:"blockPermissionsSettings.spacePermission.tooltip"})}const Lt=function(e){const{store:t,spacePermission:s,fromPermissionWrapper:n}=e,i=(0,o.VK)((()=>{const e=x.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),r=(0,a.yK)((()=>({container:{width:"100%"}})),[]);return i?s.permissionItem.unlisted_timestamp?(0,F.jsx)(Rt,{...e}):(0,F.jsx)("div",{style:r.container,className:g.afv,children:(0,F.jsx)(ft.C,{currentBlockStore:t,permissionItem:s.permissionItem,from:s.from,icon:(0,F.jsx)(_t.p,{disabled:!0,store:i,size:ft.Z}),title:(0,F.jsx)(Ot,{spaceStore:i}),nonInheritedTooltip:(0,F.jsx)(Dt,{}),subtitle:(0,F.jsx)(Bt,{spaceStore:i}),upgradeButtonName:"space_permission_item",fromPermissionWrapper:n,...e.permissionItemArgs})}):null};var Vt=s(79362),Nt=s(91192),Et=s(95697);function Ut(e){const{teamName:t,isCompact:s}=e;return s?(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace guests",id:"blockPermissionsSettings.permissionItem.teamGuestAccess.compact"}):t?(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace guests of {teamName}",id:"blockPermissionsSettings.permissionItem.teamGuestAccess",values:{teamName:t}}):(0,F.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionItem.teamspaceGuestsTeamName.hidden",defaultMessage:"Teamspace guests of a private teamspace"})}function Wt(e){const{membersCount:t,isCompact:s}=e;return s?null:(0,F.jsx)(r.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",values:{membersCount:t}})}function Kt(e){const{teamName:t}=e,s=(0,a.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?(0,F.jsx)("div",{style:s.tooltip,children:(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Applies to all teamspace guests of {teamName}.",values:{teamName:t},id:"blockPermissionsSettings.teamGuestPermission.tooltip"})}):null}const zt=function(e){const{store:t,blockTeamGuestPermission:s,isExternalTeam:n,fromPermissionWrapper:i}=e,{permissionItem:r}=s,l=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),d=(0,o.VK)((()=>{var e;return ze.bm(r)?r.team_id:null===(e=J.VP(t))||void 0===e?void 0:e.id}),[r,t]),{teamStore:c,teamIsDefined:u,teamName:p,teamIcon:m,membersCount:h}=(0,o.VK)((()=>{if(!l||!d)return{};const e=pt.zX.createChildStore(l,{table:qe.e0,id:d,spaceId:l.id});return null!=e&&e.isDefined()?{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:e.getName(),teamIcon:e.getIcon(),membersCount:(0,Et.xf)({teamStore:e,spaceStore:l}).length}:{}}),[l,d]),f=!n,y=(0,a.yK)((()=>({container:{width:"100%"}})),[]);if(!c)return null;const S=m&&Vt.V2(m.icon)?Vt.mk(m.icon):"gray",v=m?{...m,icon:`/icons/user-circle_${S}.svg`}:void 0;return(0,F.jsx)("div",{style:y.container,className:g.YHn,children:(0,F.jsx)(ft.C,{isCompact:f,currentBlockStore:t,permissionItem:r,icon:u?(0,F.jsx)(_t.p,{disabled:!0,store:c,size:ft.Z,icon:v}):(0,Nt.x)(),title:(0,F.jsx)(Ut,{teamName:p,isCompact:f}),nonInheritedTooltip:(0,F.jsx)(Kt,{teamName:p}),from:s.from,subtitle:u&&(0,F.jsx)(Wt,{membersCount:h,isCompact:f}),upgradeButtonName:"team_permission_item",fromPermissionWrapper:i,...e.permissionItemArgs})})};var qt=s(1951);function Gt(e){const{teamName:t,isCompact:s}=e;return s&&t?(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace members",id:"blockPermissionsSettings.permissionItem.teamAccessV2"}):t?(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Members of {teamName}",id:"blockPermissionsSettings.permissionItem.teamAccess",values:{teamName:t}}):(0,F.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionItem.membersTeamName.hidden",defaultMessage:"Members of a private teamspace"})}function Ht(e){const{membersCount:t,isCompact:s}=e;return s?null:(0,F.jsx)(r.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",values:{membersCount:t}})}function Yt(e){const{teamName:t}=e,s=(0,a.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?(0,F.jsx)("div",{style:s.tooltip,children:(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Applies to all owners and members of {teamName}.",values:{teamName:t},id:"blockPermissionsSettings.teamPermission.tooltip"})}):null}const Qt=function(e){const{store:t,blockTeamPermission:s,isExternalTeam:n,fromPermissionWrapper:i}=e,{permissionItem:r}=s,l=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),d=(0,o.VK)((()=>{var e;return ze.zU(r)?r.team_id:null===(e=J.VP(t))||void 0===e?void 0:e.id}),[r,t]),{teamStore:c,teamIsDefined:u,teamName:p,membersCount:m}=(0,o.VK)((()=>{if(!l||!d)return{};const e=pt.zX.createChildStore(l,{table:qe.e0,id:d,spaceId:l.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName(),membersCount:(0,Et.xf)({teamStore:e,spaceStore:l}).length}}),[l,d]),h=!n,f=(0,a.yK)((()=>({container:{width:"100%"}})),[]);return c?(0,F.jsx)("div",{style:f.container,className:g.YHn,children:(0,F.jsx)(ft.C,{isCompact:h,currentBlockStore:t,permissionItem:s.permissionItem,from:s.from,icon:u?(0,F.jsx)(_t.p,{disabled:!0,store:c,size:ft.Z}):(0,Nt.x)(),title:(0,F.jsx)(Gt,{teamName:p,isCompact:h}),nonInheritedTooltip:(0,F.jsx)(Yt,{teamName:(0,F.jsx)(qt.Z,{store:c,useInvertedColors:!0})}),subtitle:u&&(0,F.jsx)(Ht,{membersCount:m,isCompact:h}),upgradeButtonName:"team_permission_item",fromPermissionWrapper:i,...e.permissionItemArgs})}):null};var $t=s(79414);function Jt(e){const{store:t,teamOwners:s,teamStore:n,teamName:i}=e;if(i){const e=s.map((e=>pt.U6.createChildStore(t,{table:Ge.KJ,id:e})));return(0,F.jsx)($t.n,{teamStore:n,ownerStores:e})}return(0,Nt.x)()}function Xt(e){const{teamName:t,isCompact:s}=e;return s&&t?(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace owners",id:"blockPermissionsSettings.permissionItem.teamOwnerAccessV2",values:{teamName:t}}):t?(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Owners of {teamName}",id:"blockPermissionsSettings.permissionItem.teamOwnerAccess",values:{teamName:t}}):(0,F.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionItem.teamName.hidden",defaultMessage:"Owners of a private teamspace"})}function es(e){const{teamOwnersCount:t,isCompact:s}=e;return s||0===t?null:(0,F.jsx)(r.FormattedMessage,{defaultMessage:"{teamOwnersCount, plural, one {{teamOwnersCount} person} other {{teamOwnersCount} people}}",id:"blockPermissionsSettings.teamOwnerPermission.subtitle",values:{teamOwnersCount:t}})}function ts(e){const{teamName:t}=e,s=(0,a.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?(0,F.jsx)("div",{style:s.tooltip,children:(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Applies to all owners of {teamName}",values:{teamName:t},id:"blockPermissionsSettings.teamOwnerPermission.tooltip"})}):null}const ss=function(e){const{store:t,blockTeamOwnerPermission:s,isExternalTeam:n,fromPermissionWrapper:i}=e,{permissionItem:r}=s,l=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),d=(0,o.VK)((()=>{var e;return ze.LW(r)?r.team_id:null===(e=J.VP(t))||void 0===e?void 0:e.id}),[r,t]),{teamStore:c,teamName:u,teamOwners:p}=(0,o.VK)((()=>{if(!l||!d)return{undefined:void 0};const e=pt.zX.createChildStore(l,{table:qe.e0,id:d,spaceId:l.id});return{teamStore:e,teamName:e.getName(),teamOwners:(0,He.XO)({membership:e.getMembers()})}}),[l,d]),m=!n,h=(0,a.yK)((()=>({container:{width:"100%"}})),[]);return c?(0,F.jsx)("div",{style:h.container,className:g.ZmO,children:(0,F.jsx)(ft.C,{isCompact:m,currentBlockStore:t,permissionItem:s.permissionItem,from:s.from,icon:(0,F.jsx)(Jt,{store:t,teamName:u,teamStore:c,teamOwners:p}),title:(0,F.jsx)(Xt,{teamName:u,isCompact:m}),nonInheritedTooltip:(0,F.jsx)(ts,{teamName:(0,F.jsx)(qt.Z,{store:c,useInvertedColors:!0})}),subtitle:(0,F.jsx)(es,{teamOwnersCount:p.length,isCompact:m}),upgradeButtonName:"team_owner_permission_item",fromPermissionWrapper:i,...e.permissionItemArgs})}):null};function ns(e){const{store:t,shouldShowSlackOnly:s,calculatedPermissions:n,permissionItemArgs:l,tokenQuery:d,showShimmer:c,error:u,ready:p,result:m}=e,g=n.pagePermissionUIModel,h=(0,i.O7)(),f=(0,o.qz)(e.inviteTargetsStore,w.ZP),y=(0,o.qz)(e.menuListStore,ve.Z),S=(0,o.VK)((()=>rt()),[]),v=(0,o.VK)((()=>pe.Rv()),[]),b=(0,a.yK)((e=>({sectionMenuItem:{paddingTop:0,display:"flex",flexDirection:"column",gap:2},zeroState:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",color:e.mediumTextColor,fontSize:14,position:"relative",pointerEvents:"auto",paddingTop:10,marginTop:110},zeroStateText:{width:"70%",alignSelf:"center"},zeroStateIcon:{height:54,width:54,marginBottom:12,fill:e.mediumIconColor},arrowUpLeftIcon:{width:12,height:12,marginRight:3,marginTop:3,color:e.v2.text.quaternary}})),[]),{inPageTargets:M,notInPageTargets:j,filteredImportedContacts:k}=(0,o.VK)((()=>{const{inviteUsers:e,inviteGroups:s,importedContacts:i=[]}=m??{inviteUsers:[],inviteGroups:[],importedContacts:[]},o=[...e,...s],a=[],r=[],l=new Set;o.forEach((e=>{"group"!==e.type&&l.add(e.value.email.toLowerCase());const s=Boolean(fe.Zp({store:t,target:e})),i=function(e){const{inviteTarget:t,blockStore:s,spacePermission:n,teamMemberPermission:i,groupPermission:o}=e,a=t.type;if("newUser"===a)return{role:"none",type:"user_permission",user_id:t.value.email};if("existingUser"===a)return he.uY({userId:t.value.id,store:s});if("group"===a){const e={role:"none",type:"group_permission",group_id:t.value.id},a=(0,J.VP)(s),r=null==a?void 0:a.getMembers().find((e=>(0,He.lF)({groupId:t.value.id,teamMember:e})));return[n,...a&&i&&r?[i]:[],o||{permissionItem:e,from:{table:Y.iU,blockId:s.id}}].sort(((e,t)=>ze.xm[t.permissionItem.role]-ze.xm[e.permissionItem.role]))}(0,C.t1)(a)}({inviteTarget:e,blockStore:t,spacePermission:n.mostPermissiveSpaceItem,teamMemberPermission:n.mostPermissiveAncestorTeamMemberItem,groupPermission:"group"===e.type?g.mostPermissiveGroupPermissions.find((t=>t.permissionItem.group_id===e.value.id)):void 0}),o=Array.isArray(i)?i[0].permissionItem:i;if("existingUser"===e.type&&!Boolean(e.spaceRole)){const t=S.get(e.value.id);e.spaceRole=t?t.role:"not_in_space"}(s||ze.YX(o.role??"none"))&&"newUser"!==e.type?a.push({inviteTarget:e,permissionItem:o,mostPermissivePermissions:Array.isArray(i)?i:void 0}):"newUser"!==e.type&&r.push(e)}));const d=i.filter((e=>!l.has(e.value.email.toLowerCase())));return{inPageTargets:a,notInPageTargets:r,filteredImportedContacts:d}}),[t,m,n.mostPermissiveSpaceItem,n.mostPermissiveAncestorTeamMemberItem,g.mostPermissiveGroupPermissions,S]),{isValidEmail:T,isEmailInTargets:I}=(0,o.VK)((()=>{const e=(0,Oe.H3)(d);return{isValidEmail:(0,Oe.oH)(e),isEmailInTargets:[...M.map((e=>{let{inviteTarget:t}=e;return t})),...j].some((t=>"group"!==t.type&&t.value.email===e))}}),[d,M,j]),Z=T&&!I,P=!s&&j.length>0&&0===d.length,A=!s&&d.length>0&&M.length>0,_=!s&&j.length>0&&d.length>0,R=v&&k.length>0,O={key:"imported contacts",render:e=>(0,F.jsx)(nt.Z,{...e,style:b.sectionMenuItem,title:(0,F.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.importedContactsSection.title",defaultMessage:"From Slack"}),loading:!p}),items:k.map(((e,s)=>({key:e.value.email,render:s=>(0,F.jsx)(ms,{...s,invited:!1,inviteTarget:e,isInInviteTargets:ge.H({target:e,inviteTargetsStore:f}),blockStore:t,spaceVisibleUserMap:S}),action:()=>{ge.H({target:e,inviteTargetsStore:f})?f.setState({...f.state,inviteTargets:f.state.inviteTargets.filter((t=>"newUser"!==t.type||e.value.email!==t.value.email))}):(ae.hE(h,{invite_token_query:d,selected_user_token:e,selected_user_token_rank:s,from:"share_modal_invite",subscription_tier:(0,mt.zt)(),type:"slack"}),f.setState({inviteTargets:[...f.state.inviteTargets,e],tokenQuery:""}),y.unsetFocus())}})))},{shouldShowAutoFillEmail:B,showGuestVsMemberTag:D}=(0,o.VK)((()=>{if(Z){return{shouldShowAutoFillEmail:"control"!==pe.uD(),showGuestVsMemberTag:!1}}if(P||A||_||R||s)return{shouldShowAutoFillEmail:!1,showGuestVsMemberTag:!1};if(s&&0===O.items.length)return{shouldShowAutoFillEmail:!1,showGuestVsMemberTag:!1};if(0===d.length)return{shouldShowAutoFillEmail:!1,showGuestVsMemberTag:!1};return{shouldShowAutoFillEmail:"control"!==pe.uD(),showGuestVsMemberTag:!1}}),[Z,P,A,_,R,s,O.items.length,d]),L=(0,o.VK)((()=>{const e=Me.subscriptionDataStoreInstance.state,{currentSpaceStore:t}=x.default.state;return t&&e?be.hn(e).map((s=>{if(("unsubscribed_admin"===e.type||"unsubscribed_member"===e.type||"subscribed_admin"===e.type)&&e.joinedMemberIds.includes(s.userId)){const e=pt.U6.createChildStore(t,{table:Ge.KJ,id:s.userId}).getEmail();return e&&(0,Oe.Gd)(e)}})).reduce(((e,t)=>(t&&!e.includes(t)&&e.push(t),e)),[]):[]}),[]),V=(0,ye.Z)(t);if(u)return(0,F.jsx)(ot.l,{loading:!p,children:(0,F.jsx)(et.Z,{title:(0,F.jsx)(r.FormattedMessage,{id:"inviteUserModal.searchInput.errorMessage",defaultMessage:"Something went wrong"})})});if(!p&&c)return(0,F.jsx)(at.B,{areaHeight:window.innerHeight});const N={key:"user results",render:e=>(0,F.jsx)(nt.Z,{...e,style:b.sectionMenuItem,loading:!p,title:(0,F.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Keep typing an email to invite"})}),items:xs({tokenQuery:d,possibleDomains:L,showGuestVsMemberTag:D,shouldShowAutoFillEmail:B,isGuestInviteRequestRequired:V.isGuestRequestRequired,environment:h,inviteTargetsStore:f,menuListStore:y,store:t,styles:b})},E={key:"suggested",render:e=>(0,F.jsx)(nt.Z,{...e,style:b.sectionMenuItem,title:(0,F.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.suggestedSection.title",defaultMessage:"Suggested"}),loading:!p}),items:j.map(((e,s)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:s=>{const n=ge.H({target:e,inviteTargetsStore:f});return(0,F.jsx)(ms,{...s,invited:!1,inviteTarget:e,isInInviteTargets:n,blockStore:t,spaceVisibleUserMap:S})},action:()=>is({inviteTarget:e,inviteTargetsStore:f,menuListStore:y,rank:s,tokenQuery:d,environment:h,type:"suggested"})})))},U={key:"in page",render:e=>(0,F.jsx)(nt.Z,{...e,style:b.sectionMenuItem,title:(0,F.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.inPageSection.title",defaultMessage:"In page"}),loading:!p}),items:M.map(((e,s)=>{const{inviteTarget:n,permissionItem:i,mostPermissivePermissions:o}=e,{type:a}=n;if("existingUser"===a){if(!!o&&o.length>1)return{key:n.value.id,render:e=>(0,F.jsx)(rs,{...e,blockStore:t,inviteTarget:n,permissionItem:i,mostPermissivePermissions:o,spaceVisibleUserMap:S,permissionItemArgs:l,rank:s,tokenQuery:d}),action:()=>{}};{const e=g.mostPermissiveUserPermissions.find((e=>e.permissionItem.user_id===n.value.id));return e?{key:n.value.id,render:s=>(0,F.jsx)($e.Z,{...s,itemMarginLeft:0,itemMarginRight:0,title:(0,F.jsx)(kt,{store:t,userPermission:e,showInherited:!0,ignoreLocalHoverState:!0,spaceVisibleUserMap:S,permissionItemArgs:l})}),action:()=>{}}:{key:n.value.id,render:e=>(0,F.jsx)(rs,{...e,blockStore:t,inviteTarget:n,permissionItem:i,spaceVisibleUserMap:S,permissionItemArgs:l,rank:s,tokenQuery:d}),action:()=>is({inviteTarget:n,inviteTargetsStore:f,menuListStore:y,rank:s,tokenQuery:d,environment:h,type:"in_page"})}}}if("group"===a){if(!!o&&o.length>1)return{key:n.value.id,render:o=>(0,F.jsx)(rs,{...o,blockStore:t,inviteTarget:n,permissionItem:i,mostPermissivePermissions:e.mostPermissivePermissions,spaceVisibleUserMap:S,permissionItemArgs:l,rank:s,tokenQuery:d}),action:()=>{}};{const e=g.mostPermissiveGroupPermissions.find((e=>e.permissionItem.group_id===n.value.id));return e?{key:n.value.id,render:s=>(0,F.jsx)($e.Z,{...s,itemMarginLeft:0,itemMarginRight:0,title:(0,F.jsx)(yt,{store:t,groupPermission:e,spaceId:t.getSpaceId(),showInherited:!0,permissionItemArgs:l})}),action:()=>{}}:{key:n.value.id,render:e=>(0,F.jsx)(rs,{...e,blockStore:t,inviteTarget:n,permissionItem:i,spaceVisibleUserMap:S,permissionItemArgs:l,rank:s,tokenQuery:d}),action:()=>is({inviteTarget:n,inviteTargetsStore:f,menuListStore:y,rank:s,tokenQuery:d,environment:h,type:"in_page"})}}}(0,C.t1)(a)}))},W={key:"not in page",render:e=>(0,F.jsx)(nt.Z,{...e,style:b.sectionMenuItem,title:d.length>0&&(0,F.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.notInPageSection.title",defaultMessage:"Not in page"}),loading:!p}),items:j.map(((e,s)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:s=>(0,F.jsx)(ms,{...s,invited:!1,inviteTarget:e,isInInviteTargets:ge.H({target:e,inviteTargetsStore:f}),blockStore:t,spaceVisibleUserMap:S}),action:()=>is({inviteTarget:e,inviteTargetsStore:f,menuListStore:y,rank:s,tokenQuery:d,environment:h,type:"not_in_page"})})))};let K=[];return Z&&K.push(N),P&&K.push(E),A&&K.push(U),_&&K.push(W),R&&K.push(O),s&&(K=[O],0===O.items.length)?(0,F.jsx)(gs,{styles:b}):0===K.length&&(K=[N],0===d.length)?(0,F.jsx)(hs,{styles:b,shouldShowSlackMessage:v}):(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(Zt,{publicPermission:n.mostPermissivePublicItem}),(0,F.jsx)(Xe.Z,{type:Xe.i.Vertical,initialFocus:d.length>0?0:void 0,sections:K,store:y})]})}function is(e){const{inviteTarget:t,inviteTargetsStore:s,menuListStore:n,rank:i,tokenQuery:o,environment:a,type:r}=e;if(ge.H({target:t,inviteTargetsStore:s})){const e=s.state.inviteTargets.filter((e=>"group"===t.type&&"group"===e.type||"existingUser"===t.type&&"existingUser"===e.type?t.value.id!==e.value.id:"newUser"!==t.type||"newUser"!==e.type||t.value.email!==e.value.email));return s.setState({...s.state,inviteTargets:e}),void n.unsetFocus()}ae.hE(a,{invite_token_query:o,selected_user_token:t,selected_user_token_rank:i,from:"share_modal_invite",subscription_tier:(0,mt.zt)(),type:r}),s.setState({inviteTargets:[...s.state.inviteTargets,t],tokenQuery:""}),n.unsetFocus()}const os=n.forwardRef(((e,t)=>{const{blockStore:s,inviteTarget:l,permissionItem:d,mostPermissivePermissions:c,permissionItemArgs:u}=e,m=(0,i.O7)(),g=(0,r.useIntl)(),[h,f]=(0,n.useState)(!1),y=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),S=(0,o.VK)((()=>s.getSpaceId()),[s]),v=(0,o.VK)((()=>c&&c.length>0),[c]),b=(0,o.VK)((()=>{if("group"===l.type)return(0,ut.kF)({group:l.value,intl:g})}),[l,g]),j=(0,o.VK)((()=>{if(y&&"group"===l.type&&l.value.icon)return{pointer:{table:y.table,id:y.id},icon:l.value.icon}}),[y,l]),w=(0,o.VK)((()=>y?"group"!==l.type?0:(0,ut.rm)({group:l.value,spaceStore:y,limit:void 0}).totalNumberMembers:0),[y,l]),k=(0,n.useCallback)((()=>{if(v){const e=!1===h;f(!h),e&&Ye.dS(m,{share_menu_session_id:M.ZP.state.sessionId,type:"group",group_id:l.value.id})}}),[m,v,h,f,l]),T=(0,a.yK)((e=>({titleContainer:{display:"flex",alignItems:"center",paddingTop:8,paddingBottom:8,marginLeft:2,minHeight:36},groupInfoContainer:{display:"flex",flexDirection:"column"},nameAndIconContainer:{display:"flex",alignItems:"center"},groupNameLabel:{marginLeft:10,marginRight:4},groupMembersLabel:{marginLeft:10},permissionRoleButton:{marginRight:-6,color:e.mediumTextColor,fontSize:12},container:{whiteSpace:"nowrap",fontWeight:O.Z.fontWeight.bold},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"},tooltip:{maxWidth:180},expandablePermissionList:{paddingLeft:16},roundedPermissionItem:{borderRadius:4,overflow:"hidden",marginRight:4}})),[]);return(0,F.jsx)(de.ZP,{delayThreshold:0,placement:de.ug.Left,textWrap:!0,style:T.tooltip,renderTooltip:()=>(0,F.jsx)(ls,{blockStore:s,blockPermissionItem:d}),render:n=>(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)("div",{...n,children:(0,F.jsx)($e.Z,{...e,...(0,dt.Z)(e,{onClick:k}),ref:t,title:(0,F.jsxs)("div",{style:T.titleContainer,children:[(0,F.jsx)(Je.Z,{size:32}),(0,F.jsxs)("div",{style:T.groupInfoContainer,children:[(0,F.jsxs)("div",{style:T.nameAndIconContainer,children:[(0,F.jsx)(p.Z,{style:T.groupNameLabel,children:b}),Boolean(null==j?void 0:j.icon)&&(0,F.jsx)(tt.Z,{disabled:!0,bucket:"public",title:b,icon:j,size:18,isEmptyPage:!1})]}),(0,F.jsx)(p.Z,{isSmall:!0,style:T.groupMembersLabel,children:v&&h?(0,F.jsx)(ds,{}):(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,F.jsx)(r.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:w}})]})})]})]}),right:(0,F.jsx)(it.d,{table:Y.iU,disabled:!0,icon:v?h?Ue.R:We.P:void 0,role:d.role??"none",isRemovable:!1,isCurrentUser:!1,buttonStyle:T.permissionRoleButton})})}),v&&h&&(0,F.jsx)("div",{style:T.expandablePermissionList,children:null==c?void 0:c.map(((e,t)=>{const n=e.permissionItem.type;let i=null;switch(n){case"space_permission":i=(0,F.jsx)(Lt,{store:s,spacePermission:e,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_permission":i=(0,F.jsx)(Qt,{store:s,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"group_permission":i=(0,F.jsx)(yt,{spaceId:S,store:s,groupPermission:e,permissionItemArgs:u,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"user_permission":case"explicit_team_owner_permission":case"explicit_team_guest_permission":case"public_permission":case"bot_permission":case"deleted_permission":case"restricted_permission":case"exclusive_user_permission":case"team_owner_permission":case"team_permission":break;default:(0,C.t1)(n)}return(0,F.jsx)("div",{style:T.roundedPermissionItem,children:i},t)}))})]})})})),as=n.forwardRef(((e,t)=>{const{blockStore:s,inviteTarget:r,permissionItem:l,mostPermissivePermissions:d,spaceVisibleUserMap:c,permissionItemArgs:u}=e,p=(0,i.O7)(),[m,g]=(0,n.useState)(!1),h="existingUser"===r.type?pt.U6.createChildStore(s,{table:Ge.KJ,id:r.value.id}):void 0,f=(0,o.VK)((()=>"none"===r.spaceRole?lt({spaceVisibleUserMap:c,userId:r.value.id,blockStore:s}):(0,Qe.K)(r.spaceRole)),[r,c,s]),x=(0,o.VK)((()=>s.getSpaceId()),[s]),y=(0,o.VK)((()=>d&&d.length>0),[d]),S=(0,n.useCallback)((()=>{const e=!1===m;g(!m),e&&Ye.dS(p,{share_menu_session_id:M.ZP.state.sessionId,type:"user",userId:r.value.id})}),[p,m,g,r]),v=(0,a.yK)((e=>({permissionRoleButton:{marginRight:-6,color:e.mediumTextColor,fontSize:12},container:{whiteSpace:"nowrap",fontWeight:O.Z.fontWeight.bold},cellMemberAvatarContainer:{paddingTop:8,paddingBottom:8},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"},tooltip:{maxWidth:180},expandablePermissionList:{paddingLeft:24},roundedPermissionItem:{borderRadius:4,overflow:"hidden",marginRight:4}})),[]);return(0,F.jsx)(de.ZP,{delayThreshold:0,placement:de.ug.Left,textWrap:!0,style:v.tooltip,renderTooltip:()=>(0,F.jsx)(ls,{blockStore:s,blockPermissionItem:l}),render:n=>(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)("div",{...n,children:(0,F.jsx)($e.Z,{...e,...(0,dt.Z)(e,{onClick:S}),ref:t,title:(0,F.jsx)(Qe.Z,{isLarge:!0,actorStore:h,containerStyle:v.cellMemberAvatarContainer,spaceRole:f,caption:y&&m?(0,F.jsx)(ds,{}):void 0}),right:(0,F.jsx)(it.d,{table:Y.iU,disabled:!0,icon:y?m?Ue.R:We.P:void 0,role:l.role??"none",isRemovable:!1,isCurrentUser:!1,buttonStyle:v.permissionRoleButton})})}),y&&m&&(0,F.jsx)("div",{style:v.expandablePermissionList,children:null==d?void 0:d.map(((e,t)=>{const n=e.permissionItem.type;let i=null;switch(n){case"space_permission":i=(0,F.jsx)(Lt,{store:s,spacePermission:e,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_owner_permission":i=(0,F.jsx)(ss,{store:s,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_permission":i=(0,F.jsx)(Qt,{store:s,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_guest_permission":i=(0,F.jsx)(zt,{store:s,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"group_permission":i=(0,F.jsx)(yt,{store:s,spaceId:x,groupPermission:e,permissionItemArgs:u,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"user_permission":i=(0,F.jsx)(kt,{store:s,userPermission:e,permissionItemArgs:u,spaceVisibleUserMap:c,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"public_permission":case"bot_permission":case"deleted_permission":case"restricted_permission":case"exclusive_user_permission":case"team_owner_permission":case"team_permission":break;default:(0,C.t1)(n)}return(0,F.jsx)("div",{style:v.roundedPermissionItem,children:i},t)}))})]})})})),rs=n.forwardRef(((e,t)=>{const{inviteTarget:s}=e,n=s.type;switch(n){case"group":return(0,F.jsx)(os,{...e,ref:t,inviteTarget:s});case"existingUser":return(0,F.jsx)(as,{...e,ref:t,inviteTarget:s});default:(0,C.t1)(n)}}));function ls(e){const{blockStore:t,blockPermissionItem:s}=e,n=(0,i.O7)(),l=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),d=(0,o.VK)((()=>{if(l)return(0,ct.Wd)(n,l)}),[n,l]),c=(0,o.VK)((()=>{const e=s.type;if("explicit_team_permission"===e||"explicit_team_owner_permission"===e||"explicit_team_guest_permission"===e){return pt.zX.createChildStore(t,{table:qe.e0,id:s.team_id})}}),[t,s]),u=(0,o.VK)((()=>null==c?void 0:c.getIcon()),[c]),p=(0,a.yK)((()=>({container:{fontWeight:O.Z.fontWeight.bold,...O.Z.textOverflowStyle},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"}})),[]),m=s.type;return"space_permission"===m?(0,F.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.spacePermission.tooltip",defaultMessage:"Everyone at {spaceIconAndName} has access.",values:{spaceIconAndName:(0,F.jsxs)("span",{style:p.container,children:[d&&(0,F.jsx)(tt.Z,{disabled:!0,icon:d,isEmptyPage:!1,size:12,style:p.recordIcon}),l&&(0,F.jsx)(st.Z,{store:l,style:p.recordTitle})]})}}):"explicit_team_owner_permission"===m?(0,F.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.teamPermission.tooltip",defaultMessage:"Teamspace owners of {teamIconAndName} have access.",values:{teamIconAndName:(0,F.jsxs)("span",{style:p.container,children:[u&&(0,F.jsx)(tt.Z,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:p.recordIcon}),c&&(0,F.jsx)(st.Z,{store:c,style:p.recordTitle})]})}}):"explicit_team_permission"===m?(0,F.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.teamMemberPermission.tooltip",defaultMessage:"Teamspace members of {teamIconAndName} have access.",values:{teamIconAndName:(0,F.jsxs)("span",{style:p.container,children:[u&&(0,F.jsx)(tt.Z,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:p.recordIcon}),c&&(0,F.jsx)(st.Z,{store:c,style:p.recordTitle})]})}}):"explicit_team_guest_permission"===m?(0,F.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.teamGuestPermission.tooltip",defaultMessage:"Teamspace guests of {teamIconAndName} have access.",values:{teamIconAndName:(0,F.jsxs)("span",{style:p.container,children:[u&&(0,F.jsx)(tt.Z,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:p.recordIcon}),c&&(0,F.jsx)(st.Z,{store:c,style:p.recordTitle})]})}}):"group_permission"===m?(0,F.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.groupPermission.tooltip",defaultMessage:"This group has access."}):"user_permission"===m||"exclusive_user_permission"===m||"public_permission"===m||"restricted_permission"===m||"deleted_permission"===m||"team_permission"===m||"team_owner_permission"===m||"bot_permission"===m?(0,F.jsx)(F.Fragment,{children:ze.YX(s.role??"none")&&(0,F.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.userPermission.tooltip",defaultMessage:"This user has access"})}):void(0,C.t1)(m)}function ds(){return(0,F.jsx)(r.FormattedMessage,{id:"shareMenu.inPageSearchResult.caption",defaultMessage:"Permission from"})}function cs(e){const{checked:t}=e,s=(0,a.yK)((e=>({circleCheckmark:{display:"flex",justifyContent:"center",alignItems:"center",width:22,height:22,borderRadius:"50%",borderStyle:"solid",borderWidth:1.75,borderColor:t?R.ZP.blue:e.buttonPressedBackground,backgroundColor:t?R.ZP.blue:"transparent",marginRight:6},checkIcon:{height:12,width:12,color:"white"}})),[t]);return(0,F.jsx)("div",{style:s.circleCheckmark,children:t&&(0,Ee.e)(s.checkIcon)})}const us=n.forwardRef(((e,t)=>{const{inviteTarget:s,isInInviteTargets:n,disabled:i}=e,l=(0,r.useIntl)(),d=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),c=(0,o.VK)((()=>(0,ut.kF)({group:s.value,intl:l})),[s,l]),u=(0,o.VK)((()=>{if(d&&s.value.icon)return{pointer:{table:d.table,id:d.id},icon:s.value.icon}}),[d,s]),m=(0,o.VK)((()=>{if(!d)return 0;return(0,ut.rm)({group:s.value,spaceStore:d,limit:void 0}).totalNumberMembers}),[d,s]),g=(0,a.yK)((()=>({titleContainer:{display:"flex",alignItems:"center",paddingTop:8,paddingBottom:8,marginLeft:2,minHeight:36},groupInfoContainer:{display:"flex",flexDirection:"column"},nameAndIconContainer:{display:"flex",alignItems:"center"},groupNameLabel:{marginLeft:10,marginRight:4},groupMembersLabel:{marginLeft:10}})),[]),h=(0,F.jsxs)("div",{style:g.titleContainer,children:[(0,F.jsx)(Je.Z,{size:32}),(0,F.jsxs)("div",{style:g.groupInfoContainer,children:[(0,F.jsxs)("div",{style:g.nameAndIconContainer,children:[(0,F.jsx)(p.Z,{style:g.groupNameLabel,children:c}),Boolean(null==u?void 0:u.icon)&&(0,F.jsx)(tt.Z,{disabled:!0,bucket:"public",title:c,icon:u,size:18,isEmptyPage:!1})]}),(0,F.jsxs)(p.Z,{isSmall:!0,style:g.groupMembersLabel,children:[(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,F.jsx)(r.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:m}})]})]})]});return(0,F.jsx)($e.Z,{...e,ref:t,title:h,right:(0,F.jsx)(cs,{checked:n}),disabled:i})})),ps=n.forwardRef(((e,t)=>{const{inviteTarget:s,blockStore:i,isInInviteTargets:r,disabled:l,spaceVisibleUserMap:d,...c}=e,u=(0,a.yK)((()=>({cellMemberAvatarContainer:{paddingTop:8,paddingBottom:8},iconBox:{position:"absolute",bottom:-3,right:-3},iconBoxImage:{background:"white",padding:2,borderRadius:"100%"}})),[]),p=(0,o.VK)((()=>"existingUser"===s.type?lt({spaceVisibleUserMap:d,userId:s.value.id,blockStore:i}):void 0),[s,d,i]),m=(0,n.useMemo)((()=>"existingUser"===s.type?{actorStore:pt.U6.createChildStore(i,{table:Ge.KJ,id:s.value.id}),avatar:void 0}:"newUser"===s.type?{actorStore:void 0,avatar:{email:s.value.email,name:"slack"===s.source?s.value.name:void 0,avatarUrl:"slack"===s.source?s.value.avatar_url:void 0}}:void(0,C.t1)(s)),[s,i]);return(0,F.jsx)($e.Z,{...c,ref:t,title:(0,F.jsx)(Qe.Z,{isLarge:!0,...m,containerStyle:u.cellMemberAvatarContainer,avatarBadge:"newUser"===s.type&&"slack"===s.source?(0,F.jsx)(D.Z,{type:"image_url",imageURL:k.Z.images.externalIntegrations.slackIconPng,size:18,style:u.iconBox,imageStyle:u.iconBoxImage}):void 0,spaceRole:p}),disabled:l,right:!l&&(0,F.jsx)(cs,{checked:r})})})),ms=n.forwardRef(((e,t)=>{const{inviteTarget:s,blockStore:n,spaceVisibleUserMap:i}=e,o=s.type;switch(o){case"group":return(0,F.jsx)(us,{...e,ref:t,inviteTarget:s});case"newUser":case"existingUser":return(0,F.jsx)(ps,{...e,ref:t,inviteTarget:s,blockStore:n,spaceVisibleUserMap:i});default:(0,C.t1)(o)}}));function gs(e){const{styles:t}=e;return(0,F.jsxs)("div",{style:t.zeroState,children:[(0,Ke._)(t.zeroStateIcon),(0,F.jsxs)("div",{style:t.zeroStateText,children:[(0,F.jsx)("div",{style:{fontWeight:O.Z.fontWeight.semibold,marginBottom:4},children:(0,F.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noImportedContacts.title",defaultMessage:"No contacts found"})}),(0,F.jsx)("div",{children:(0,F.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noImportedContacts.text",defaultMessage:"Try connecting a different Slack workspace or typing an email address"})})]})]})}function hs(e){const{styles:t,shouldShowSlackMessage:s}=e;return(0,F.jsxs)("div",{style:t.zeroState,children:[(0,Ve.C)(t.zeroStateIcon),(0,F.jsxs)("div",{style:t.zeroStateText,children:[(0,F.jsx)("div",{style:{fontWeight:O.Z.fontWeight.semibold,marginBottom:4},children:(0,F.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noSuggestions.title",defaultMessage:"Search or add people"})}),(0,F.jsx)("div",{children:s?(0,F.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noSuggestions.text",defaultMessage:"Try connecting a Slack workspace or typing an email address"}):(0,F.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noSuggestions.defaultText",defaultMessage:"Try typing an email address"})})]})]})}function fs(e){let{tokenQuery:t,possibleDomains:s,shouldShowAutoFillEmail:n}=e;const i=(0,Be.ZP)(t,function(e,t,s){return s?Array.from(new Set([...t,"gmail.com","yahoo.com","outlook.com","hotmail.com"])).map(((t,s)=>({tokenQuery:`${e.split("@")[0]}@${t}`,weight:s}))).slice(0,3):[{tokenQuery:e,weight:0}]}(t,s,n),(e=>e.tokenQuery));return 0===i.length?[{tokenQuery:t,weight:0}]:i}function xs(e){let{tokenQuery:t,possibleDomains:s,showGuestVsMemberTag:n,isGuestInviteRequestRequired:i,shouldShowAutoFillEmail:o,environment:a,inviteTargetsStore:l,menuListStore:d,store:c,styles:u}=e;return fs({tokenQuery:t,possibleDomains:s,shouldShowAutoFillEmail:o}).map(((e,s)=>({key:e.tokenQuery,render:t=>(0,F.jsx)($e.Z,{icon:(0,Le.a)({width:24,height:24}),title:(0,F.jsx)(ys,{tokenQuery:e.tokenQuery,shouldShowAutofillEmail:o,isGuestInviteRequestRequired:i}),caption:i?(0,F.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.requestNewUser.buttonItem.caption",defaultMessage:"Workspace owners are required to view and approve guest invites"}):void 0,right:(0,F.jsxs)(F.Fragment,{children:[o?Ne(u.arrowUpLeftIcon):null,n?(0,F.jsx)(Tt.Z,{store:c,onlyShowTokenType:!0,showRemoveButton:!1,target:{source:"email",type:"newUser",value:{email:e.tokenQuery},spaceRole:"not_in_space"}},e.tokenQuery):null]}),rightStyle:{marginRight:4},...t}),action:async()=>{const n=(0,Oe.H3)(e.tokenQuery);if(!(0,Oe.oH)(n)){const t={type:"invalidUser",value:{text:e.tokenQuery}};return void(ge.H({target:t,inviteTargetsStore:l})||l.setState({inviteTargets:[...l.state.inviteTargets,t],tokenQuery:""}))}const i=await re.M5(a,[n]);if(!i.length)return;const o=i[0];ge.H({target:o,inviteTargetsStore:l})||(ae.hE(a,{invite_token_query:t,selected_user_token:o,selected_user_token_rank:s,from:"share_modal_invite",subscription_tier:(0,mt.zt)(),type:"autofill"}),l.setState({inviteTargets:[...l.state.inviteTargets,o],tokenQuery:""}),d.unsetFocus())}})))}function ys(e){const{tokenQuery:t,shouldShowAutofillEmail:s,isGuestInviteRequestRequired:n}=e;return n?(0,F.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.requestNewUser.buttonItem",defaultMessage:"Request {tokenQuery} as a guest",values:{tokenQuery:t}}):s?(0,F.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem.v1",defaultMessage:"”{tokenQuery}”",values:{tokenQuery:t}}):(0,F.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem",defaultMessage:"Invite {tokenQuery}",values:{tokenQuery:t}})}const Ss=function(e){const t=(0,i.O7)(),s=(0,r.useIntl)(),[a,l]=(0,n.useState)(!0),d=(0,o.VK)((()=>e.inviteTargetsStore.state.tokenQuery),[e.inviteTargetsStore]),c=(0,o.VK)((()=>{if(e.shouldShowSlackOnly)return{userLimit:0,botLimit:0,groupLimit:0,importContactLimit:e.sectionRenderLimit};const t=Ze.Z.completeSlackAuthentications.state.length>0&&pe.Rv();return{userLimit:e.sectionRenderLimit,botLimit:0,groupLimit:e.shouldShowGroups?e.sectionRenderLimit:0,importContactLimit:t?e.sectionRenderLimit:0}}),[e.sectionRenderLimit,e.shouldShowGroups,e.shouldShowSlackOnly]),[{value:u,status:p}]=(0,De.r5)((async()=>re.jL({query:d,sectionLimit:c,membersOnly:e.membersOnly,environment:t,intl:s}).finally((()=>l(!1)))),[t,s,e.membersOnly,d,c],{debounce:40});return(0,F.jsx)(ns,{...e,tokenQuery:d,showShimmer:a,ready:"pending"!==p,error:"rejected"===p,result:u})};function vs(e){const t=(0,i.O7)(),s=Ms(),a=(0,o.qz)(e.inviteTargetsStore,w.ZP),r=(0,o.VK)((()=>a.state.inviteTargets),[a]),{display:l,source:d,focus:c,emailMessage:u}=(0,o.VK)((()=>{const{display:e}=M.ZP.state;return e===M.wV.Invite?M.ZP.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),p=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),m=(0,o.VK)((()=>d===M.T5.Notion&&0===r.length&&(0,pe.Rv)()),[r.length,d]),g=(0,o.VK)((()=>Ze.Z.completeSlackAuthentications.state),[]),h=(0,n.useCallback)((()=>{a.reset()}),[a]),[f,y]=(0,n.useState)(!1);(0,n.useEffect)((()=>{if(p&&!f&&m){for(const e of g)ke.loadContacts(t,{botId:e.id,spaceId:p.id,integrationId:we.nO}).catch((e=>{}));y(!0)}}),[m]);const S=l===M.wV.Invite&&r.length>0;return l!==M.wV.Invite?null:(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(Te.Z,{type:Ie.Z.Y,style:s.scroller,children:(0,F.jsx)(Ss,{inviteTargetsStore:a,store:e.store,menuListStore:e.menuListStore,shouldShowGroups:!0,shouldShowSlackOnly:d===M.T5.Slack,membersOnly:!1,sectionRenderLimit:10,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs})}),m&&(0,F.jsx)(Re.Z,{onClickAuthenticated:()=>{M.ZP.setState({...M.ZP.state,tab:M.XF.Share,display:M.wV.Invite,focus:M.Sw.Search,source:M.T5.Slack,emailMessage:u}),a.setState({...a.state,tokenQuery:""})},title:(0,F.jsx)(bs,{}),containerStyle:s.importContactsContainer,buttonStyle:s.importContactsButton,from:"share_menu",inviteOrigin:"page_share_modal",flowId:e.flowId,loadContacts:!0}),(0,F.jsx)(_e,{open:S&&!m,focus:c===M.Sw.Message,value:u,onFocus:()=>{d&&l===M.wV.Invite&&M.ZP.setState({...M.ZP.state,focus:M.Sw.Message,tab:M.XF.Share,display:l,source:d,emailMessage:u})},onChange:e=>{M.ZP.setState({...M.ZP.state,focus:c,tab:M.XF.Share,display:l,source:d,emailMessage:e.target.value})},onCancel:async()=>{await je.zd({environment:t,inviteTargetsStore:a})&&(je.a6(t),h())},maxLength:1e3})]})}function bs(){const e=Ms(),t=(0,F.jsxs)("div",{style:e.integrationName,children:[(0,F.jsx)(D.Z,{type:"image_url",imageURL:k.Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:e.integrationIcon}),(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Slack",id:"importContactsButton.integrationName"})]});return(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Add contacts from {integrationNameWithLogo}",id:"importContactsButton.integrationButton.label",values:{integrationNameWithLogo:t}})}function Ms(){return(0,a.yK)((e=>({scroller:{flexGrow:1},integrationName:{display:"flex"},integrationIcon:{marginRight:4},importContactsContainer:{height:36,bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",padding:3},importContactsButton:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9}})),[])}var js=s(99273),Cs=s(64964),ws=s(64921),ks=s(77907),Ts=s(96455);const Is=function(e){const{store:t}=e,{isMobile:s}=(0,i.Fy)(),n=(0,o.VK)((()=>t.canEditMembership()),[t]),l=(0,xe.cR)(t),d=(0,a.yK)((()=>({buttonContainer:{display:"flex",alignItems:"center",gap:Pe.p_},inputButton:{flex:1,justifyContent:"flex-start",height:30,overflow:"hidden"},blueButton:{minWidth:Pe.UF}})),[]);return(0,F.jsx)(de.ZP,{renderTooltip:()=>(0,F.jsx)(r.FormattedMessage,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."}),disableTooltip:n&&!l,render:t=>(0,F.jsxs)("div",{style:d.buttonContainer,...t,children:[(0,F.jsx)(Ts.Z,{onClick:e.onClick,disabled:!n||l,style:d.inputButton,children:(0,F.jsx)("div",{style:O.Z.textOverflowStyle,children:(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"})})}),!s&&(0,F.jsx)($.Z,{isLarge:!0,onClick:e.onClick,disabled:!n||l,style:d.blueButton,children:(0,F.jsx)(r.FormattedMessage,{id:"inviteUserButton.invitePersonLabel",defaultMessage:"Invite"})})]})})};function Zs(e){const{store:t,permissionItemArgs:s}=e,{onUpgradeButtonClick:l,sudoModeStore:d}=s,c=(0,o.qz)(void 0,v.Z),{permissionsInviteStore:u}=(0,o.VK)((()=>c.state),[c]),p=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),m=(0,o.VK)((()=>c.stage),[c]),g=(0,o.VK)((()=>u.state.modalOpen),[u]),h=(0,i.MO)(),f=(0,i.O7)(),y=(0,o.VK)((()=>t.canAdmin()),[t]),M=(0,o.VK)((()=>{const e=Me.subscriptionDataStoreInstance.state;return Boolean(e&&be.YK(e))}),[]),j=(0,o.VK)((()=>(0,b.pR)({store:t})),[t]),C=(0,a.yK)((e=>({button:{display:"flex",alignItems:"center",minHeight:52},buttonInner:{width:"100%"},modalButton:{height:36},requestedUsersToast:{marginBottom:96}})),[]),w=(0,n.useCallback)(((e,t)=>{e&&t>0&&Cs.oV({label:(0,F.jsx)(r.FormattedMessage,{id:"mobileInviteSection.onInviteComplete.toastMessage.requestedUsers",defaultMessage:"Sent request to invite {numRequests, plural, one {a guest} other {{numRequests} guests}}",values:{numRequests:t}}),style:h?C.requestedUsersToast:void 0})}),[h,C.requestedUsersToast]);return p?m!==S.TG.closed?(0,F.jsx)(ks.LazyUniversalMemberInvite,{universalInviteStore:c,mode:"milestone_2",spaceStore:p,sudoModeStore:d,store:t,disabled:!y,membersOnly:j,isSubscribed:M,onUpgradeButtonClick:l,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:{height:36}}):(0,F.jsx)(ws.Z,{mobileFeedback:!0,disabled:!0,style:C.button,children:(0,F.jsxs)("div",{style:C.buttonInner,children:[g&&(0,F.jsx)(ks.LazyPermissionsInviteWithModal,{store:t,disabled:!y,membersOnly:j,isSubscribed:M,onUpgradeButtonClick:l,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:C.modalButton,permissionsInviteStore:u,onInviteComplete:w}),(0,F.jsx)(Is,{store:t,onClick:()=>(0,fe.z5)({environment:f,permissionsInviteStore:u,store:t,isSubscribed:M,renderInShareModal:!1})})]})}):null}var Ps=s(53965),Fs=s(65598),As=s(56666);function _s(e){let{permissions:t}=e;const[s,i]=(0,n.useState)(!1),o=(0,a.yK)((e=>({button:{display:s?"none":"inline-flex",padding:10,width:"100%"},icon:{width:14,transform:"rotate(90deg)",marginLeft:14,marginRight:18,fill:e.lightIconColor},list:{display:s?"block":"none"}})),[s]);return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsxs)(ws.Z,{onClick:()=>i(!0),style:o.button,children:[(0,F.jsx)("div",{children:(0,As.o)(o.icon)}),(0,F.jsx)(p.Z,{isSmall:!0,isSecondaryColor:!0,children:(0,F.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.expandButton",defaultMessage:"{count} more people",values:{count:t.length}})})]}),(0,F.jsx)("div",{style:o.list,children:t})]})}const Rs=(0,P.IU)("personBadgeQuestionMark",{viewBox:"0 0 15 14",svg:(0,F.jsx)("path",{d:"M12.4551 5.41699C12.8037 5.41699 13.0088 5.19824 13.0088 4.93164V4.84961C13.0088 4.45996 13.2344 4.2207 13.7061 3.90625C14.3691 3.46875 14.8408 3.07227 14.8408 2.25195C14.8408 1.11719 13.8291 0.501953 12.667 0.501953C11.498 0.501953 10.7256 1.0625 10.5342 1.69141C10.5 1.80078 10.4795 1.91016 10.4795 2.02637C10.4795 2.33398 10.7188 2.49805 10.9443 2.49805C11.1836 2.49805 11.3271 2.38867 11.4502 2.22461L11.5732 2.06055C11.8125 1.66406 12.1748 1.43164 12.626 1.43164C13.248 1.43164 13.6514 1.78711 13.6514 2.30664C13.6514 2.77148 13.3643 2.99707 12.7695 3.41406C12.2773 3.75586 11.915 4.11816 11.915 4.78809V4.87695C11.915 5.23242 12.1064 5.41699 12.4551 5.41699ZM5.79004 6.99609C7.25293 6.99609 8.52441 5.68359 8.52441 3.97461C8.52441 2.28613 7.25293 1.03516 5.79004 1.03516C4.32715 1.03516 3.05566 2.31348 3.05566 3.98828C3.05566 5.68359 4.32031 6.99609 5.79004 6.99609ZM12.4414 7.4541C12.8379 7.4541 13.1797 7.13965 13.1797 6.74316C13.1797 6.34668 12.8447 6.03223 12.4414 6.03223C12.0381 6.03223 11.7031 6.35352 11.7031 6.74316C11.7031 7.13281 12.0449 7.4541 12.4414 7.4541ZM1.20312 13.3262H10.3701C11.1016 13.3262 11.5391 12.9844 11.5391 12.417C11.5391 10.6533 9.33105 8.21973 5.7832 8.21973C2.24219 8.21973 0.0341797 10.6533 0.0341797 12.417C0.0341797 12.9844 0.47168 13.3262 1.20312 13.3262Z"})});const Os=function(e){const{store:t}=e,s=(0,a.yK)((e=>({icon:{width:17,height:17,fill:e.mediumIconColor},iconContainer:{backgroundColor:e.lightDividerColor,borderRadius:32}})),[]),n={table:Y.iU,blockId:t.id};return(0,F.jsx)(ft.C,{icon:Rs(s.icon),iconStyle:s.iconContainer,title:(0,F.jsx)(r.FormattedMessage,{defaultMessage:"More people may have access",id:"blockPermissionsSettings.permissionItem.hiddenAccess"}),nonInheritedTooltip:(0,F.jsx)(r.FormattedMessage,{defaultMessage:"This page may be shared with additional people through a parent page or teamspace that you don't have access to",id:"blockPermissionsSettings.hiddenAccess.tooltip"}),permissionRoleSelect:(0,F.jsx)(F.Fragment,{}),currentBlockStore:t,permissionItem:{type:"hidden_permission"},from:n,upgradeButtonName:"team_permission_item"})};var Bs=s(76781),Ds=s(84076),Ls=s(28020),Vs=s(15145),Ns=s(61061),Es=s(44495),Us=s(87479),Ws=s(84210),Ks=s(47307),zs=s(76464),qs=s(13447),Gs=s(18878);var Hs=s(55838),Ys=s(4023),Qs=s(9867);function $s(e){const{showRestoreButton:t,store:s,type:n,sudoModeStore:r}=e,{isMobile:l}=(0,i.Fy)(),d=(0,o.VK)((()=>J.uJ(s)[1]),[s]),c=(0,i.O7)(),u=(0,o.VK)((()=>({paddingLeft:c.WindowSizeStore.getSafePaddingLeftCSS(14),paddingRight:c.WindowSizeStore.getSafePaddingLeftCSS(14)})),[c]),m=(0,a.yK)((e=>({container:{display:"flex",minHeight:20,flexDirection:"row",alignItems:"center",paddingTop:8,paddingBottom:6,paddingLeft:u.paddingLeft,paddingRight:u.paddingRight},banner:{display:"flex",flexDirection:"row",width:"100%",fontSize:12},icon:{width:16,fill:e.mediumIconColor},iconContainer:{width:20,height:20,display:"flex",justifyContent:"center",alignItems:"center",marginRight:5},messageContainer:{display:"flex",flexDirection:"column"},label:{display:"inline",marginLeft:l?14:0,color:l?"#CF8807":e.mediumTextColor,fontWeight:l?O.Z.fontWeight.regular:O.Z.fontWeight.medium,marginRight:6,lineHeight:"20px"},buttonContainer:{marginLeft:-5},divider:{opacity:"75%"},mobileContainer:{borderRadius:4,height:34,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingRight:9,display:"flex",alignItems:"center",justifyContent:"space-between",backgroundColor:"rgba(246, 192, 80, 0.26)"}})),[l,u]);return l?(0,F.jsxs)("div",{style:m.mobileContainer,children:[(0,F.jsx)(p.Z,{isMultiline:!0,isSmall:!0,style:m.label,children:(0,F.jsx)(en,{type:n,navigableParentStore:d,showRestoreButton:t})}),t&&(0,F.jsx)(Js,{store:s,type:n})]}):(0,F.jsx)("div",{style:m.container,children:(0,F.jsxs)("div",{style:m.banner,children:[(0,F.jsx)("div",{style:m.iconContainer,children:tn[n](m.icon)}),(0,F.jsxs)("div",{children:[(0,F.jsx)(p.Z,{isMultiline:!0,isSmall:!0,isSecondaryColor:!0,style:m.label,children:(0,F.jsx)(en,{type:n,navigableParentStore:d,showRestoreButton:t})}),t&&(0,F.jsx)("span",{style:m.buttonContainer,children:(0,F.jsx)(Js,{store:s,type:n,sudoModeStore:r})})]})]})})}function Js(e){const{type:t,store:s,sudoModeStore:n}=e,{isMobile:l}=(0,i.Fy)(),d=(0,o.VK)((()=>!!n&&n.shouldSaveTransactionWithSudoMode(s)),[s,n]),c=(0,a.yK)((e=>({button:{color:l?"#CF8807":e.regularTextColor,fontWeight:O.Z.fontWeight.medium},tooltip:{width:210,whiteSpace:"initial"}})),[l]),u=(0,i.O7)();if("restore-team"===t){const e=async()=>{await async function(e){const{environment:t,useSudoMode:s,store:n}=e,i={type:"restoreTeamPermissions",permissionChanges:[]};await Ks.confirmUserAction({message:(0,Gs.mX)(i),acceptLabel:(0,Gs.nH)(i),cancelLabel:(0,F.jsx)(r.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"})})&&qs.createAndCommit({userAction:"PermissionsRestoreBanner.restoreTeamPermissions",environment:t,useSudoMode:s,perform:e=>{zs.Kh({environment:t,store:n,transaction:e})}})}({environment:u,useSudoMode:d,store:s})};return(0,F.jsx)(de.ZP,{style:c.tooltip,placement:Ys.u.Bottom,renderTooltip:()=>(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Reset page permissions to match default teamspace permissions",id:"permissionsRestoreBanner.tooltip.teamPermissions"}),render:t=>(0,F.jsx)("span",{...t,children:(0,F.jsx)(It.Z,{style:c.button,onClick:e,children:(0,F.jsx)(r.FormattedMessage,{id:"permissionsRestoreBanner.button.teamPermissions",defaultMessage:"Reset"})})})})}if("unrestrict"===t){const e=async()=>{const e=s.getPermissionItems(),t=J.Om(s),n=t?(0,Us.Wo)(J.fJ(t)):[],i=(0,Us.Xr)(e,n);await async function(e){const{environment:t,useSudoMode:s,store:n,permissionChanges:i}=e,o={type:"restore",permissionChanges:i};await Ks.confirmUserAction({message:(0,Gs.mX)(o),acceptLabel:(0,Gs.nH)(o),cancelLabel:(0,F.jsx)(r.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"}),description:(0,F.jsx)(Gs.mo,{openState:o})})&&(n.getPermissionItemsStore().canAdmin()?qs.createAndCommit({userAction:"PermissionsRestoreBanner.restoreRestrictedPermissions",environment:t,useSudoMode:s,perform:e=>{zs.MX({environment:t,store:n,transaction:e})}}):zs.hs({environment:t,store:n}))}({environment:u,useSudoMode:d,store:s,permissionChanges:i})};return(0,F.jsx)(It.Z,{style:c.button,onClick:e,children:(0,F.jsx)(r.FormattedMessage,{id:"permissionsRestoreBanner.button.restrictedPermissions",defaultMessage:"Restore"})})}(0,C.t1)(t)}function Xs(e){const{navigableParentStore:t,maxLength:s,showUnderline:n}=e,{isMobile:r}=(0,i.Fy)(),l=(0,i.O7)(),d=(0,a.yK)((e=>({linkBox:{color:e.mediumTextColor},title:{display:"inline"}})),[]),c=(0,o.VK)((()=>{if(t instanceof pt.G)return(0,Ws.ZP)({store:t,fullyQualified:!1,pageVisitSource:Vs.tY.LinkInPage})}),[t]);if(!t)return null;const u=r&&t.table===qe.e0;return(0,F.jsx)(Ds.Z,{disabled:u,style:u?void 0:d.linkBox,underline:n&&!u,inline:!0,onClick:t.table===qe.e0?()=>{t.table===qe.e0&&Qs.RF({environment:l,teamId:t.id,tab:Hs.a.Members,from:"permission_item"})}:void 0,href:c,children:(0,F.jsx)(st.Z,{shouldWrap:!0,maxLength:s,store:t,style:d.title})})}function en(e){const{type:t,navigableParentStore:s,showRestoreButton:n}=e,{isMobile:o}=(0,i.Fy)(),a=(0,F.jsx)(Xs,{navigableParentStore:s,maxLength:o||!n?void 0:30,showUnderline:!0});switch(t){case"restore-team":return(0,F.jsx)(r.FormattedMessage,{id:"pageShareMenu.restoreTeamPermissionsBanner.label",defaultMessage:"Page access is different from {linkBoxWithPageTitle}.",values:{linkBoxWithPageTitle:a}});case"unrestrict":return o?(0,F.jsx)(r.FormattedMessage,{id:"pageShareMenu.restrictedAccessBanner.mobileLabel",defaultMessage:"Page access is restricted to people below.",values:{linkBoxWithPageTitle:a}}):(0,F.jsx)(r.FormattedMessage,{id:"pageShareMenu.restrictedAccessBanner.label",defaultMessage:"Access restricted. May not be shared with everyone from {linkBoxWithPageTitle}.",values:{linkBoxWithPageTitle:a}});default:(0,C.t1)(t)}}const tn={unrestrict:Ns.B,"restore-team":Es.D},sn=(0,r.defineMessages)({fullAccess:{id:"permissionsLevelBanner.fullAccess.label",defaultMessage:"You have full access to this page {hasAttribution, select, true {via {attribution}} other {}}"},editor:{id:"permissionsLevelBanner.editor.label",defaultMessage:"You have edit access to this page {hasAttribution, select, true {via {attribution}} other {}}"},contentEditor:{id:"permissionsLevelBanner.contentEditor.label",defaultMessage:"You have edit access to content on this page {hasAttribution, select, true {via {attribution}} other {}}"},commenter:{id:"permissionsLevelBanner.commenter.label",defaultMessage:"You have comment access to this page {hasAttribution, select, true {via {attribution}} other {}}"},reader:{id:"permissionsLevelBanner.reader.label",defaultMessage:"You have view access to this page {hasAttribution, select, true {via {attribution}} other {}}"}});function nn(e){let{store:t}=e;const s=(0,i.O7)(),l=(0,o.VK)((()=>(0,Ls.B7)(s)),[s]),d=(0,o.VK)((()=>t.canEditContentOnly()),[t]),{role:c,attribution:u}=(0,o.VK)((()=>{if(!l)return{role:"none",attribution:null};const e=(0,he.Dt)({userId:l.id,store:t}),n=function(e){let{environment:t,calculatedPermission:s,store:n}=e;const i=(0,J.Pj)(n)||x.default.state.currentSpaceStore;if(!i)return null;if((0,ze.hV)(s)){const e=(0,ct.TC)({spaceStore:i,groupId:s.group_id}),t=null==e?void 0:e.name;return t?(0,F.jsxs)(F.Fragment,{children:[(0,Bs.x)({width:18,marginRight:5}),t]}):null}if((0,ze.fG)(s)){var o;const e=s.team_id||(null===(o=(0,J.VP)(n))||void 0===o?void 0:o.id);if(!e)return null;const t=pt.zX.createChildStore(i,{table:qe.e0,id:e,spaceId:i.id});return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(_t.p,{disabled:!0,store:t,size:18,style:{marginRight:5}}),(0,F.jsx)(Xs,{navigableParentStore:t,showUnderline:!0,maxLength:30})]})}if((0,ze.ix)(s))return(0,ze.KF)(s)?(0,F.jsx)(r.FormattedMessage,{defaultMessage:"the link",id:"permissionsLevelBanner.spacePermission.attribution"}):(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(_t.p,{disabled:!0,store:i,size:18,style:{marginRight:5}}),(0,ct.rn)(t,i)]});if((0,ze.$D)(s))return(0,F.jsx)(Ds.Z,{underline:!0,inline:!0,onClick:()=>{M.ZP.setState({...M.ZP.state,display:M.wV.Publish,tab:M.XF.Publish})},children:(0,F.jsx)(r.FormattedMessage,{defaultMessage:"the published site",id:"permissionsLevelBanner.publicPermission.attribution"})});return null}({environment:s,calculatedPermission:e,store:t});return{role:e.role,attribution:n}}),[l,t,s]),m=(0,o.VK)((()=>!!c&&(!(0,mt.QM)()&&!(0,ze.J5)(c))),[c]);(0,n.useEffect)((()=>{c&&Ye.hY(s,{share_menu_session_id:M.ZP.state.sessionId,role:c})}),[]);const g=(0,a.yK)((e=>({container:{background:e.surface.wash,border:1,borderStyle:"solid",borderColor:e.accentColors.gray[75],borderRadius:4,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingTop:10,paddingBottom:10,paddingLeft:12,paddingRight:12,display:"flex",alignItems:"center",justifyContent:"space-between"},bannerBodyContainer:{display:"flex",alignItems:"center"},icon:{marginRight:8},bannerLabel:{fontSize:12,display:"flex",flexDirection:m?"column":"row"},attribution:{display:"inline-flex",alignItems:"center",fill:e.regularIconColor,marginLeft:m?0:5},requestAccessContainer:{fontSize:12,flexShrink:0},pendingAccessRequestButton:{color:e.lightTextColor},accessRequestButton:{color:e.blueColor,padding:5,borderRadius:4}})),[m]),[h,f]=(0,n.useState)(!1),[y,S]=(0,n.useState)(!1),v=(0,n.useCallback)((async()=>{var e;if("reader"!==c&&"comment_only"!==c)return;const n=await ke.requestAccess(s,{type:"current-actor-to-block",block:{id:t.id,spaceId:t.getSpaceId()},attributes:{origin_type:"share_menu",add_permissions_on_approval:!1,role:"read_and_write",existing_permissions:c},message:void 0});"success"===n.type&&n.data.request?(f(!0),Ye.dU(s,{request_access_type:"page",previous_access_level:c,requested_access_level:"read_and_write",requestId:n.data.requestId})):"failed"===n.type&&"UserRateLimitResponse"===(null===(e=n.body)||void 0===e?void 0:e.name)&&S(!0)}),[s,c,t]);if(!(0,ze.iC)(c))return null;const b=function(e){switch(e){case"editor":return sn.fullAccess;case"read_and_write":return sn.editor;case"content_only_editor":return sn.contentEditor;case"comment_only":return sn.commenter;case"reader":return sn.reader;case"none":case"membership_admin":return null;default:(0,C.t1)(e)}}(c);return b?(0,F.jsx)(de.ZP,{delayThreshold:0,renderTooltip:()=>(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Content editors can edit pages, but cannot change view and database settings.",id:"database.viewSettings.mainTab.contentOnlyEditorPill.subtitle"}),disableTooltip:!d,textWrap:!0,style:{maxWidth:180},render:e=>(0,F.jsxs)("div",{style:g.container,...e,children:[(0,F.jsxs)("div",{style:g.bannerBodyContainer,children:[(0,F.jsx)(bt.Z,{userStore:l,size:20,style:g.icon}),(0,F.jsx)(p.Z,{style:g.bannerLabel,isMultiline:!0,children:(0,F.jsx)(r.FormattedMessage,{...b,values:{hasAttribution:Boolean(u),attribution:(0,F.jsx)("span",{style:g.attribution,children:u})}})})]}),m&&(0,F.jsx)("div",{style:g.requestAccessContainer,children:(0,F.jsx)(ws.Z,{style:h||y?g.pendingAccessRequestButton:g.accessRequestButton,onClick:v,disabled:h||y,children:h?(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Edit access requested",id:"permissionsLevelBanner.requestPermission.accessRequested"}):y?(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Try again later",id:"permissionsLevelBanner.requestPermission.rateLimited"}):(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Request edit access",id:"permissionsLevelBanner.requestPermission.requestEdit"})})})]}),placement:de.ug.Left}):null}function on(){return(0,F.jsx)(an,{children:(0,F.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.moreAttribution",defaultMessage:"More people with access"})})}function an(e){const{children:t}=e,{WindowSizeStore:s}=(0,i.O7)(),{paddingLeft:n,paddingRight:r}=(0,o.VK)((()=>({paddingLeft:s.getSafePaddingLeftCSS(14),paddingRight:s.getSafePaddingRightCSS(14)})),[s]),l=(0,a.yK)((e=>({label:{color:e.mediumTextColor,fontWeight:O.Z.fontWeight.medium,paddingLeft:n,paddingRight:r,paddingTop:8,paddingBottom:6}})),[n,r]);return(0,F.jsx)(p.Z,{isSmall:!0,style:l.label,children:t})}const rn=function(e){const{store:t}=e,{parentStore:s,canAccessParent:n}=(0,o.VK)((()=>(0,b.HB)({store:t})),[t]);return n?(0,F.jsx)(an,{children:(0,F.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.attribution",defaultMessage:"From {attribution}",values:{attribution:(0,F.jsx)(Xs,{navigableParentStore:s})}})}):(0,F.jsx)(an,{children:(0,F.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.genericHeader",defaultMessage:"People with access"})})};var ln=s(19037);function dn(e){const{store:t}=e,s=(0,i.O7)(),n=(0,o.VK)((()=>function(e){const{store:t,environment:s}=e;return ln.or([ln.zzA,ln.xDy([ln.c2G,ln.ffD(ln.zzA)])])({environment:s,blocks:[t],publicEditMode:void 0})}({store:t,environment:s})),[t,s]);return(0,F.jsx)($s,{type:"unrestrict",showRestoreButton:n,store:t,sudoModeStore:e.sudoModeStore})}function cn(e){const{store:t}=e;return(0,o.VK)((()=>(0,b.Np)({store:t})),[t])?(0,F.jsx)($s,{type:"restore-team",showRestoreButton:!1,store:t,sudoModeStore:e.sudoModeStore}):null}const un=function(e){const{store:t,showRestrictedPermissionBanner:s}=e,{canAccessParent:n}=(0,o.VK)((()=>(0,b.HB)({store:t})),[t]);return n?s?(0,F.jsx)(dn,{store:t,sudoModeStore:e.sudoModeStore}):(0,F.jsx)(cn,{store:t,sudoModeStore:e.sudoModeStore}):null};var pn=s(42853),mn=s(16184),gn=s(21213),hn=s(98519),fn=s(23063),xn=s(31945),yn=s(63296),Sn=s(89728);function vn(){const e=(0,i.O7)(),{currentSpaceStore:t}=(0,o.Kw)(x.default);return(0,o.VK)((()=>t?(0,ct.rn)(e,t):""),[e,t])}var bn=s(61766),Mn=s(31194);const jn=[{key:"private",title:()=>(0,F.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityTitle.inviteOnly",defaultMessage:"Invite only"}),caption:(0,F.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityCaption.inviteOnly",defaultMessage:"Only you and people invited can access"}),icon:mn.Q},{key:"unlisted",title:e=>(0,F.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityTitle.anyoneWithLink",defaultMessage:"Anyone with link at {spaceName}",values:{spaceName:e}}),caption:(0,F.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityCaption.anyoneWithLink",defaultMessage:"People invited and workspace members with link can access"}),icon:Ft.N},{key:"open",title:e=>(0,F.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityTitle.everyoneInWorkspace",defaultMessage:"Everyone at {spaceName}",values:{spaceName:e}}),caption:(0,F.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityCaption.everyoneInWorkspace",defaultMessage:"All workspace members can search and access"}),icon:gn.T}];function Cn(e){const{store:t,spacePermission:s}=e,i=kn(s.permissionItem),l=(0,o.VK)((()=>t.canAdmin()),[t]),d=(0,xe.cR)(t),c=vn(),u=(0,o.VK)((()=>{const e=x.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),[m,g]=(0,n.useState)(!1),h=(0,a.yK)((e=>({chevron:{width:12,fill:e.mediumIconColor,marginLeft:"auto"},button:{height:42,color:e.mediumTextColor,marginBottom:8,padding:"0 6px",marginLeft:-6,marginRight:-6,width:"100%"},icon:{fill:e.regularIconColor,width:32,height:32,backgroundColor:e.lightDividerColor,padding:6,borderRadius:4,marginRight:12},animation:{maxHeight:220},enterAnimation:{maxHeight:0},exitAnimation:{maxHeight:0},container:{overflow:"hidden"}})),[]),f=jn.find((e=>e.key===i));return f&&u?(0,F.jsxs)("div",{style:h.container,children:[(0,F.jsxs)(Sn.Z,{style:h.button,icon:f.icon,iconStyle:h.icon,disabled:!l||d,disabledFeedback:!0,onClick:()=>g(!m),children:[(0,F.jsxs)("div",{children:[(0,F.jsx)(p.Z,{isSmall:!0,children:(0,F.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityMobileTitle",defaultMessage:"Page visibility"})}),(0,F.jsx)(p.Z,{children:f.title(c)})]}),l&&(m?(0,pn.i)(h.chevron):(0,Ue.R)(h.chevron))]}),(0,F.jsx)(fn.Z,{isVisible:m,animationStyle:h.animation,enterAnimationStyle:h.enterAnimation,exitAnimationStyle:h.exitAnimation,render:()=>(0,F.jsx)(wn,{...e,parentCloseCallback:()=>g(!1)})})]}):null}function wn(e){const{store:t,spacePermission:s,sudoModeStore:n,location:r,isRestricted:l,parentCloseCallback:d}=e,u=(0,i.O7)(),m=u.device.isMobile,g=kn(s.permissionItem),f=s.from,y=f.table===Y.iU?f.blockId:f.teamId,S=!(f.table===t.table&&y===t.id),v=(0,o.VK)((()=>{const{currentSpaceStore:e}=x.default.state;return!!e&&t.isTopLevelWorkspacePage(e.id)}),[t]),M=vn(),j=(0,o.VK)((()=>{const e=b.bQ({store:t});return e?kn(e):"private"}),[t]),w=(0,a.yK)((e=>{const t={width:14,fill:m?e.regularIconColor:e.mediumTextColor};return{icon:{fill:m?e.regularIconColor:e.mediumTextColor,width:16},iconContainer:{alignSelf:"center",marginLeft:m?13:9},hiddencheckmark:{...t,visibility:"hidden"},selectedCheckmark:{...t,visibility:"visible"},checkmarkContainer:{marginLeft:12},selectedTitle:{fontWeight:O.Z.fontWeight.semibold},mobileScroller:{border:`1px solid ${e.regularDividerColor}`,borderRadius:8,marginBottom:24},mobileButton:{paddingTop:8,paddingBottom:8},mobileButtonDivider:{borderBottom:`1px solid ${e.regularDividerColor}`},caption:{whiteSpace:"normal"}}}),[m]);return(0,F.jsx)(c.Z,{menuType:h.og.Popup,disableScroller:!0,scrollerStyle:m?w.mobileScroller:{},children:(0,F.jsx)(Xe.Z,{type:Xe.i.Vertical,initialFocus:void 0,sections:[{key:"visibilityOptions",render:e=>(0,F.jsx)(nt.Z,{...e,disableDesktopPadding:m}),items:jn.map(((e,i)=>{const o=e.key,a=g===o,c=a?w.selectedCheckmark:w.hiddencheckmark,h=i!==jn.length-1,f={...m?w.mobileButton:{},...m&&h?w.mobileButtonDivider:{}};return{key:o,render:t=>(0,F.jsx)("div",{children:(0,F.jsx)($e.Z,{title:e.title(M),caption:(0,F.jsx)(p.Z,{isSmall:!0,isMultiline:!0,style:w.caption,children:e.caption}),icon:e.icon(w.icon),desktopIconStyle:w.iconContainer,titleStyle:a&&!m?w.selectedTitle:void 0,right:(0,hn.k)(c),rightStyle:w.checkmarkContainer,style:f,...t})}),action:()=>{if(a)return;const e=s.permissionItem,i={type:"space_permission",role:Tn(e,g,o)};"unlisted"===o&&(i.unlisted_timestamp=Date.now());const c=function(e,t){if(e===t)return!1;switch(t){case"open":return!1;case"unlisted":return"open"===e;case"private":return!0;default:(0,C.t1)(t)}}(j,o)&&!l&&!v;(0,te.i)({oldPermissionItem:e,newPermissionItem:i,wasInherited:S,environment:u,store:t,sudoModeStore:n,location:r,restrictingVisibility:c}),d()}}}))}]})})}function kn(e){return"none"===e.role?"private":e.unlisted_timestamp?"unlisted":"open"}function Tn(e,t,s){return"private"===s?"none":"private"===t?"editor":e.role}const In=function(e){const{store:t,spacePermission:s}=e,i=kn(s.permissionItem),l=(0,o.VK)((()=>t.canAdmin()),[t]),d=(0,xe.cR)(t),c=vn(),u=(0,o.VK)((()=>{const e=x.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),p=(0,o.qz)(void 0,bn.Z),m=(0,n.useRef)(null),g=(0,a.yK)((e=>({chevron:{width:12,marginLeft:4,fill:e.mediumIconColor},popup:{overflow:"visible",width:"100%",minWidth:430},button:{justifyContent:"center",borderRadius:32,height:32,color:e.mediumTextColor,paddingLeft:12,maxWidth:380},title:{...O.Z.textOverflowStyle},icon:{fill:e.mediumTextColor,width:16}})),[]);return u?(0,F.jsx)(xn.ZP,{buttonPopupStore:p,popupType:xn.Z4.Popup,popupWrapStyle:g.popup,renderOrigin:e=>{const t=jn.find((e=>e.key===i));return t?(0,F.jsx)(de.ZP,{placement:de.ug.Bottom,alignment:de.v2.Start,disableTooltip:l&&!d,renderTooltip:()=>l?d?(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Restore page from trash to change the privacy setting",id:"linkSharingPill.disabledTooltip.message.pageInTrash"}):void 0:(0,F.jsx)(r.FormattedMessage,{defaultMessage:"You must have full access to change the privacy setting",id:"linkSharingPill.disabledTooltip.message"}),render:s=>(0,F.jsxs)(yn.Z,{...e,ref:m,style:g.button,icon:t.icon,iconStyle:g.icon,disabled:!l||d,disabledFeedback:!0,...s,children:[(0,F.jsx)("div",{style:g.title,children:t.title(c)}),l&&(0,pn.i)(g.chevron)]})}):null},placementToOrigin:Mn.Iw.Bottom,alignmentToOrigin:Mn.lU.Start,sameWidthAsOrigin:!0,render:t=>(0,F.jsx)(wn,{...e,parentCloseCallback:()=>t.close()})}):null};var Zn=s(3303),Pn=s(893),Fn=s(95477),An=s(97978);function _n(e){const{store:t,buttonPopupStore:s,events:n}=e,o=(0,i.O7)(),{device:l,mobileNative:d}=o,c=(0,a.yK)((e=>({button:{flex:1,height:36,minHeight:36}})),[]);return(0,F.jsx)($.Z,{onClick:()=>{var e;l.isMobileNative?function(e){const{store:t,mobileNative:s}=e,n=(0,Zn.u5)({schemeUrl:(0,Ws.ZP)({store:t,pageVisitSource:Vs.tY.CopyLink}),baseUrl:Fn.default.domainBaseUrl});s&&s.share(n)}({store:t,mobileNative:d}):Bn({store:t,buttonPopupStore:s,environment:o});const n=null===(e=t.getCollectionViewCollectionStore())||void 0===e?void 0:e.id,i=t.getParentCollectionIdUpToTwoLevels();Ln(o,{collection_id:n,parent_collection_id:i})},style:c.button,...n,children:l.isMobileNative?(0,F.jsx)(r.FormattedMessage,{id:"pageShareMenu.shareLinkButton.label",defaultMessage:"Share link"}):(0,F.jsx)(r.FormattedMessage,{id:"pageShareMenu.copyLinkButton.label",defaultMessage:"Copy link"})})}function Rn(e){const{store:t,buttonPopupStore:s,events:n}=e,o=(0,i.O7)(),l=(0,a.yK)((e=>({button:{height:24,paddingLeft:8,paddingRight:8,color:e.regularTextColor,marginLeft:"auto"},icon:{width:14,height:14,fill:e.regularIconColor,marginLeft:0,marginRight:6},label:{color:e.regularTextColor}})),[]);return(0,F.jsxs)(Sn.Z,{isSmall:!0,onClick:()=>{var e;Bn({store:t,buttonPopupStore:s,environment:o});const n=null===(e=t.getCollectionViewCollectionStore())||void 0===e?void 0:e.id,i=t.getParentCollectionIdUpToTwoLevels();Ln(o,{collection_id:n,parent_collection_id:i})},style:l.button,...n,children:[(0,Ft.N)(l.icon),(0,F.jsx)(p.Z,{isSmall:!0,style:l.label,children:(0,F.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.copyLinkButton.label",defaultMessage:"Copy link"})})]})}function On(e){const{calculatedPermissions:t}=e,s=t.mostPermissivePublicItem.permissionItem;if((0,ze.YX)(s.role))return(0,F.jsx)(r.FormattedMessage,{defaultMessage:"This page has public link access, so anyone with the link will be able to view the page.",id:"blockPermissionsSettings.publicLinkInfo.tooltip"});const n=t.mostPermissiveSpaceItem.permissionItem;return(0,ze.YX)(n.role)?(0,F.jsx)(r.FormattedMessage,{defaultMessage:"This page has workspace access, so anyone in the workspace will be able to view the link.",id:"blockPermissionsSettings.workspacePermissions.tooltip"}):t.permissionItemsCount>1?(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Only you and other invited members and guests will be able to view the link.",id:"blockPermissionsSettings.userPermissions.tooltip"}):(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Only you can access this page, so the link will only work for you.",id:"blockPermissionsSettings.privatePermissions.tooltip"})}async function Bn(e){const{store:t,buttonPopupStore:s,environment:n}=e,i=(0,Ws.ZP)({store:t,pageVisitSource:Vs.tY.CopyLink});await Pn.RD({environment:n,stringValue:i,copiedMessage:Pn.tq.copiedLinkToClipboard}),s&&s.setState({open:!1})}const Dn=function(e){const{store:t,buttonPopupStore:s,calculatedPermissions:n}=e,{device:o}=(0,i.O7)(),r=(0,a.yK)((()=>({tooltip:{width:280}})),[]);return(0,F.jsx)(de.ZP,{delayThreshold:0,placement:de.ug.Bottom,renderTooltip:()=>(0,F.jsx)(On,{calculatedPermissions:n}),textWrap:!0,style:r.tooltip,render:e=>o.isMobile?(0,F.jsx)(_n,{store:t,buttonPopupStore:s,events:e}):(0,F.jsx)(Rn,{store:t,buttonPopupStore:s,events:e})})};function Ln(e,t){An.j(e,"copy_link_from_permissions_setting",t)}const Vn=function(e){const{isMobile:t}=(0,i.Fy)(),s=(0,a.yK)((e=>({container:{display:"flex",alignItems:t?"normal":"center",boxShadow:`0 -1px 0 ${e.regularDividerColor}`,flexDirection:t?"column":"row",justifyContent:"space-between",padding:"8px 14px"}})),[t]),{mostPermissiveSpaceItem:n,showRestrictedPermissionBanner:o}=e.calculatedPermissions;return(0,F.jsx)(F.Fragment,{children:(0,F.jsxs)("div",{style:s.container,children:[t?(0,F.jsx)(Cn,{store:e.store,sudoModeStore:e.permissionItemArgs.sudoModeStore,location:e.permissionItemArgs.location,spacePermission:n,isRestricted:o}):(0,F.jsx)(In,{store:e.store,sudoModeStore:e.permissionItemArgs.sudoModeStore,location:e.permissionItemArgs.location,spacePermission:n,isRestricted:o}),(0,F.jsx)(Dn,{store:e.store,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:e.calculatedPermissions})]})})};var Nn=s(22487);function En(e){const{teamName:t}=e;return t?(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Everyone at {teamName}",id:"blockPermissionsSettings.permissionItem.teamspaceAccess",values:{teamName:t??""}}):(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Everyone at a private teamspace",id:"blockPermissionsSettings.permissionItem.teamspace.hidden"})}function Un(e){const{membersCount:t}=e;return(0,F.jsx)(r.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",values:{membersCount:t}})}const Wn=function(e){const{store:t,blockTeamMemberPermission:s,blockTeamOwnerPermission:r,blockTeamGuestPermission:l}=e,d=(0,i.O7)(),c=(0,i.Fy)(),[u,p]=(0,n.useState)(!1),{permissionItem:m}=s,g=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),h=(0,o.VK)((()=>{var e;return ze.zU(m)?m.team_id:null===(e=J.VP(t))||void 0===e?void 0:e.id}),[m,t]),f=r.permissionItem.role,y=m.role,S={type:"team_overview_permission",role:f===y?y:"none"===y||"none"===f?"limited":"access"},{teamStore:v,teamIsDefined:b,teamName:j}=(0,o.VK)((()=>{if(!g||!h)return{undefined:void 0};const e=pt.zX.createChildStore(g,{table:qe.e0,id:h,spaceId:g.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName()}}),[g,h]),C=(0,Nn.K)(v),w=(0,o.VK)((()=>{if(!g)return!1;return!g.getDisableTeamGuests()&&((null==v||!v.isDefault())&&(0,pe.F$)())}),[g,v]),k=(0,n.useCallback)((()=>{const e=!1===u;if(p(!u),e){if(!v)return;Ye.dS(d,{share_menu_session_id:M.ZP.state.sessionId,type:"team",team_id:v.id})}}),[d,u,p,v]),T=(0,a.yK)((e=>({icon:{width:10,marginLeft:4,fill:e.lightIconColor},teamPermissionsContainer:{paddingLeft:16,display:u?"block":"none"},roleButton:{marginRight:-8,color:e.mediumTextColor,fontSize:c.isMobile?14:12}})),[u,c.isMobile]),I=(0,Ue.R)(T.icon);return v?(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(ft.C,{currentBlockStore:t,permissionItem:S,from:s.from,icon:b?(0,F.jsx)(_t.p,{disabled:!0,store:v,size:ft.Z}):(0,Nt.x)(),title:(0,F.jsx)(En,{teamName:j}),subtitle:b&&(0,F.jsx)(Un,{membersCount:C}),upgradeButtonName:"team_permission_item",onClick:k,permissionRoleSelect:u?I:(0,F.jsx)(it.d,{role:S.role,icon:We.P,disabled:!0,buttonStyle:T.roleButton,table:Y.iU,isRemovable:!1,isCurrentUser:!1}),...e.permissionItemArgs}),(0,F.jsxs)("div",{style:T.teamPermissionsContainer,children:[r&&(0,F.jsx)(ss,{store:t,permissionItemArgs:e.permissionItemArgs,blockTeamOwnerPermission:r,fromPermissionWrapper:"expandable_permission"}),s&&(0,F.jsx)(Qt,{store:t,permissionItemArgs:e.permissionItemArgs,blockTeamPermission:s,fromPermissionWrapper:"expandable_permission"}),w&&l&&(0,F.jsx)(zt,{store:t,permissionItemArgs:e.permissionItemArgs,blockTeamGuestPermission:l,fromPermissionWrapper:"expandable_permission"})]})]}):null};function Kn(e){const{store:t,permissionItemArgs:s}=e,{showTeamPermission:n,showSpacePermission:i,mostPermissiveAncestorTeamOwnerItem:o,mostPermissiveAncestorTeamMemberItem:a,mostPermissiveAncestorTeamGuestItem:r,mostPermissiveSpaceItem:l,pagePermissionUIModel:d}=e.calculatedPermissions,c=Number(n)+Number(i);return(0,F.jsxs)(F.Fragment,{children:[n&&o&&a&&(0,F.jsx)(Wn,{store:t,blockTeamOwnerPermission:o,blockTeamMemberPermission:a,blockTeamGuestPermission:r,permissionItemArgs:s}),i&&(0,F.jsx)(Lt,{store:t,spacePermission:l,permissionItemArgs:s,fromPermissionWrapper:"permission_list"}),(0,F.jsx)(zn,{store:t,pagePermissions:d,numberPermissionsAlreadyRendered:c,permissionItemArgs:s})]})}function zn(e){const t=(0,r.useIntl)(),s=(0,o.VK)((()=>{const e=x.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e.id:""}),[]),{store:n,pagePermissions:i,numberPermissionsAlreadyRendered:a,permissionItemArgs:l,showHeader:d}=e,{showUserPermissions:c,mostPermissiveGroupPermissions:u,mostPermissiveTeamPermissions:p,mostPermissiveUserPermissions:m,spacePermissionGroups:g}=i,h=(0,o.VK)((()=>rt()),[]),f=(0,o.VK)((()=>{const e=c?function(e){const{mostPermissiveUserPermissions:t,spaceVisibleUserMap:s}=e,n={};return t.forEach((t=>{n[t.permissionItem.user_id]=(0,F.jsx)(kt,{store:e.store,userPermission:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,spaceVisibleUserMap:s,fromPermissionWrapper:"permission_list"},t.permissionItem.user_id)})),n}({store:n,mostPermissiveUserPermissions:m,permissionItemArgs:l,spaceVisibleUserMap:h}):[];return Ps.oA(Object.keys(e).map((s=>{const i=pt.U6.createChildStore(n,{table:Ge.KJ,id:s}),o=i.getModel();if(!i.isReady()||o)return{title:(0,St.Nz)(t,o),permissionItem:e[s]}})))}),[c,m,l,n,t,h]),y=s?function(e){const{spaceId:t,spacePermissionGroups:s,mostPermissiveGroupPermissions:n}=e,i={};return n.forEach((n=>{const o=n.permissionItem.group_id;s.find((e=>e.id===o))&&(i[o]=(0,F.jsx)(yt,{store:e.store,groupPermission:n,spaceId:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,fromPermissionWrapper:"permission_list"}))})),i}({store:n,spaceId:s,spacePermissionGroups:g,mostPermissiveGroupPermissions:u,permissionItemArgs:l}):[],S=function(e){const{store:t,mostPermissiveTeamPermissions:s,permissionItemArgs:n}=e;return s.map((e=>ze.LW(e.permissionItem)?(0,F.jsx)(ss,{store:t,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:n,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.owner`):ze.bm(e.permissionItem)?(0,F.jsx)(zt,{store:t,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:n,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.teamGuest`):(0,F.jsx)(Qt,{store:t,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:n,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.member`)))}({store:n,mostPermissiveTeamPermissions:p,permissionItemArgs:l}),v=[...f,...Object.keys(y).map((e=>{const s=g.find((t=>t.id===e));return{title:s?(0,ut.kF)({intl:t,group:s}):"",permissionItem:y[e]}}))];v.sort(((e,t)=>e.title.localeCompare(t.title)));const b=S.concat(v.map((e=>e.permissionItem))),M=b.length;if(0===M)return null;if(M>5-a){const e=Math.max(2-a,0);return(0,F.jsxs)(F.Fragment,{children:[d&&(0,F.jsx)(on,{}),b.slice(0,e),(0,F.jsx)(_s,{permissions:b.slice(e,-1)}),b[M-1]]})}return(0,F.jsxs)(F.Fragment,{children:[d&&(0,F.jsx)(on,{}),b]})}function qn(e,t){return e.from.table===Y.iU&&e.from.blockId===t.id}const Gn=function(e){const t=(0,i.O7)(),{device:s}=t,{store:r,permissionItemArgs:l,calculatedPermissions:d}=e,{sudoModeStore:c}=l,{permissionItemsCount:u,pagePermissionUIModel:p,showRestrictedPermissionBanner:m}=d,g=(0,o.VK)((()=>{const e=x.default.state.currentSpaceStore;if(!e)return!0;if(r.isTopLevelPrivatePage({spaceStore:e,environment:t}))return!0;const s=(0,J.uJ)(r);for(const n of s)if((0,Fs.OY)(n)&&n.isTopLevelPrivatePage({spaceStore:e,environment:t}))return!0;return!1}),[r,t]);let h=null;const f=(0,o.VK)((()=>(0,b.up)({store:r,showRestrictedPermissionBanner:m})),[r,m]),{canAccessParent:y}=(0,o.VK)((()=>(0,b.HB)({store:r})),[r]),S={...d};if(!f&&y){const[e,t]=function(e,t){const{mostPermissiveGroupPermissions:s,mostPermissiveTeamPermissions:n,mostPermissiveUserPermissions:i}=t,[o,a]=Ps.uK(s,(t=>qn(t,e))),[r,l]=Ps.uK(n,(t=>qn(t,e))),[d,c]=Ps.uK(i,(t=>qn(t,e))),u={...t,mostPermissiveGroupPermissions:a,mostPermissiveTeamPermissions:l,mostPermissiveUserPermissions:c},p={...t,mostPermissiveGroupPermissions:o,mostPermissiveTeamPermissions:r,mostPermissiveUserPermissions:d};return[u,p]}(r,p);S.pagePermissionUIModel=e,h=(0,F.jsx)(zn,{store:r,pagePermissions:t,numberPermissionsAlreadyRendered:0,permissionItemArgs:l,showHeader:!0})}const v=(0,o.VK)((()=>!(0,b.gi)({store:r})),[r]),M=s.isMobile?Ie.Z.None:Ie.Z.Y,j=(0,a.yK)((e=>({scroller:{paddingBottom:10,minHeight:s.isMobile||0===u?void 0:1===u?60:90}})),[s,u]);return(0,n.useEffect)((()=>{Ye.oE({environment:t,calculatedPermissions:d})}),[]),(0,F.jsxs)(F.Fragment,{children:[(0,F.jsxs)(Te.Z,{style:j.scroller,type:M,children:[!g&&(0,F.jsx)(nn,{store:r}),(0,F.jsx)(un,{store:r,showRestrictedPermissionBanner:m,sudoModeStore:c}),!f&&u>0&&(0,F.jsx)(rn,{store:r}),(0,F.jsx)(Kn,{store:r,calculatedPermissions:S,permissionItemArgs:l}),h,v&&(0,F.jsx)(Os,{store:r})]}),!s.isMobile&&(0,F.jsx)(Vn,{store:r,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:S,permissionItemArgs:l})]})};function Hn(e){const{store:t,menuListStore:s,sudoModeStore:l,contextualInviteStore:d}=e,c=(0,i.O7)(),u=(0,r.useIntl)(),p=(0,o.qz)(e.inviteTargetsStore,w.ZP),{display:m,source:g,focus:h,emailMessage:f}=(0,o.VK)((()=>{const{display:e}=M.ZP.state;return e===M.wV.Invite?M.ZP.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),y=()=>{p.reset(),M.ZP.setState({...M.ZP.state,tab:M.XF.Share,display:M.wV.MainShareMenu})},[v,b]=(0,n.useState)("editor"),j=(0,o.VK)((()=>t.getType()),[t]),k=(0,o.VK)((()=>d.state.flowId),[d]),T=(0,o.VK)((()=>(0,ge.B)({inviteTargetsStore:p})),[p]),I=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),Z=(0,o.VK)((()=>new Set(null==I?void 0:I.getEmailDomains())),[I]),P=(0,o.VK)((()=>{const e=Me.subscriptionDataStoreInstance.state,t=e?be.CM(e):[],s={};return t.forEach((e=>{s[e.userId]=e})),s}),[]),A=e=>!me.$s({contextualInviteUser:e,allowedDomains:Z}),_=e=>{d.setState({...d.state,invitedUsers:e.filter(W).map(me.Si).filter(C.$K).filter(A)}),I&&me.fr({environment:c,spaceStore:I,contextualInviteStore:d})},O=(e,t,s,n)=>{d.setState({...d.state,invitedUsers:e.filter(W).map(me.Si).filter(C.$K).filter(A),inviteTargets:e,shareModalGuestMemberConfirmationExpGroup:t,callbackAsyncFn:s,resetShareMenuFn:n}),I&&(me.fr({environment:c,spaceStore:I,contextualInviteStore:d}),d.setState({...d.state,selection:S.uq.closed}))},B=(0,o.VK)((()=>t.canEditMembership()),[t]),D=(0,xe.cR)(t),L=(0,o.VK)((()=>{const e=T.filter((e=>{let{type:t}=e;return"newUser"===t})).map((e=>{let{value:t}=e;return t.email})),t=T.filter((e=>{let{type:t}=e;return"existingUser"===t})).map((e=>{let{value:t}=e;return t.id}));return he.Xu({subscriptionData:Me.subscriptionDataStoreInstance.state,newGuestIds:[...e,...t]})}),[T]),V=(0,ye.Z)(t),N=(0,o.VK)((()=>{if(V.isGuestRequestRequired)return!1;const e=V.isStoreInTeam&&!V.teamAllowsGuests,t=!V.isStoreInTeam&&!V.spaceAllowsGuests||V.isStoreInTeam&&!V.teamAllowsGuests&&!V.spaceAllowsGuests,s=T.some((e=>"newUser"===e.type||("existingUser"===e.type?"none"===e.spaceRole||"not_in_space"===e.spaceRole:void 0)));return(e||t)&&s}),[T,V]),E=(0,o.VK)((()=>{const e=T.some(fe.OA);return V.isGuestRequestRequired&&e}),[T,V]),U=(0,o.VK)((()=>{const{currentSpaceStore:e}=x.default.state;return(0,pe.gp)({currentSpaceStore:e})}),[]),W=(0,n.useCallback)((e=>{const t=e.type;if("existingUser"===t){const t=P[e.value.id];if(!t)return!0;return"none"===t.role&&!t.isTeamGuest&&t.isPageGuest}return"newUser"===t||"group"!==t&&void 0}),[P]),K=(0,o.VK)((()=>{if(!I)return"control";if(!(0,me.ch)({environment:c,spaceStore:I,contextualInviteStore:d}))return"control";return T.filter(W).length>0?(0,pe.kG)(c):"control"}),[T,c,W,I,d]),z=(0,Se.S)(t),q=f.length>1e3,G=T.length>0,H=(0,a.yK)((()=>({permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:20,margin:2,borderRadius:4,color:R.ZP.uiGray}})),[]);async function Y(){const e=T.filter(W),s=T.filter((e=>!W(e)));"control"===K?await je.qg({environment:c,intl:u,inviteOrigin:"page_share_modal",role:v,emailMessage:f,inviteTargetsStore:p,blockStore:t,sudoModeStore:l,flowId:d.state.flowId,onInviteClick:()=>{y(),_(T)},onInviteComplete:(e,t)=>je.Cv({success:e,requestedUserEmails:t,inviteTargets:T})}):(s.length>0&&(p.setState({...p.state,inviteTargets:s}),await je.qg({environment:c,intl:u,inviteOrigin:"page_share_modal",role:v,emailMessage:f,inviteTargetsStore:p,blockStore:t,sudoModeStore:l,flowId:d.state.flowId,onInviteClick:()=>{p.reset()},onInviteComplete:(e,t)=>je.Cv({success:e,requestedUserEmails:t,inviteTargets:s})})),O(T,K,(async()=>(p.setState({...p.state,inviteTargets:e}),await je.qg({environment:c,intl:u,inviteOrigin:"page_share_modal",role:v,emailMessage:f,inviteTargetsStore:p,blockStore:t,sudoModeStore:l,flowId:d.state.flowId,onInviteClick:()=>{y()},onInviteComplete:(t,s)=>je.Cv({success:t,requestedUserEmails:s,inviteTargets:e})}))),(()=>{y()})))}async function Q(){void 0===s.state.focus.indexGlobal&&void 0===s.state.focus.indexLocal&&void 0===s.state.focus.section&&(T.length<1||await Y())}let $;return $=N||E?z:q?(0,F.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters."}):void 0,(0,F.jsx)(de.ZP,{disableTooltip:B&&!D,renderTooltip:()=>B?D?(0,F.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.pageInTrash",defaultMessage:"Restore page from trash to add people"}):void 0:(0,F.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.needFullAccess",defaultMessage:"Only those with full access can add people."}),render:e=>(0,F.jsxs)("div",{style:{display:"flex"},...e,children:[(0,F.jsx)(js.Z,{store:t,inviteTargetsStore:p,flowId:k,disabled:!B||D,origin:"page_contextual_invite",focus:h===M.Sw.Search,hideIconColorAndTooltips:"control"!==K,onFocus:()=>{M.ZP.setState({...M.ZP.state,tab:M.XF.Share,display:M.wV.Invite,focus:M.Sw.Search,source:g||M.T5.Notion,emailMessage:f||""}),ae.yE(c,{source:g||M.T5.Notion})},onSubmit:Q,placeholder:U?u.formatMessage({id:"shareMenu.inviteTargetsInput.placeholder.exp",defaultMessage:"Email or group, separated by commas"}):u.formatMessage({id:"shareMenu.inviteTargetsInput.placeholder",defaultMessage:"Add people, groups, or emails..."}),right:G&&(0,F.jsx)(ce.ZP,{disabled:!B||D,role:v,table:"block",type:"user_permission",blockType:j,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:H.permissionsRoleSelectButton,isMenuItem:!1,onChange:e=>b(e)})}),L?(0,F.jsx)(Yn,{onClick:()=>re.Vu({environment:c,upgradeButtonName:"user_permission_item"})}):(0,F.jsx)(Ce,{tooltip:$,disabled:!B||D||N||q,onClick:async()=>{m!==M.wV.MainShareMenu?await Y():M.ZP.setState({...M.ZP.state,tab:M.XF.Share,display:M.wV.Invite,focus:M.Sw.Search,source:M.T5.Notion,emailMessage:""})}})]})})}function Yn(e){const{onClick:t}=e;return(0,F.jsx)(de.ZP,{disableTooltip:!1,renderTooltip:()=>(0,F.jsx)(ue.e,{}),render:e=>(0,F.jsx)($.Z,{isLarge:!0,style:{marginLeft:8},onClick:t,...e,children:(0,F.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.upgrade",defaultMessage:"Upgrade"})})})}const Qn=function(e){const{store:t,permissionItemArgs:s,inviteTargetsStore:n,contextualInviteStore:r}=e,l=(0,i.Fy)(),d=(0,o.qz)(void 0,ve.Z),{display:c}=(0,o.VK)((()=>M.ZP.state),[]),u=(0,o.VK)((()=>r.state.flowId),[r]),p=(0,a.yK)((()=>({container:{position:"relative",height:c!==M.wV.MainShareMenu?540:"unset",transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:540},searchBar:{paddingLeft:14,paddingRight:14,paddingBottom:8}})),[c]);return(0,F.jsx)(le.Z,{debugName:"ShareMenuShareTab",capture:!0,onTab:function(e){e.preventDefault(),l.isMobile||c!==M.wV.MainShareMenu||M.ZP.setState({...M.ZP.state,tab:M.XF.Share,display:M.wV.Invite,focus:M.Sw.Search,source:M.T5.Notion,emailMessage:""})},children:(0,F.jsxs)("div",{style:p.container,children:[(0,F.jsx)("div",{style:p.searchBar,children:l.isMobile?(0,F.jsx)(Zs,{store:t,permissionItemArgs:s}):(0,F.jsx)(Hn,{store:t,inviteTargetsStore:n,menuListStore:d,sudoModeStore:s.sudoModeStore,contextualInviteStore:r})}),c===M.wV.MainShareMenu&&(0,F.jsx)(Gn,{store:t,calculatedPermissions:e.calculatedPermissions,buttonPopupStore:e.buttonPopupStore,permissionItemArgs:s}),c===M.wV.Invite&&!l.isMobile&&(0,F.jsx)(vs,{store:t,inviteTargetsStore:n,menuListStore:d,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs,flowId:u})]})})};var $n=s(62397);const Jn=function(e){const{store:t,sudoModeStore:s}=e,n=(0,o.VK)((()=>s.state.changePermissionsEnabled),[s]),i=(0,o.VK)((()=>s&&s.shouldUserHaveAccessToPrivatePageBlock()&&!s.doesUserAlreadyHaveEditorAccessOnBlock(t.id)&&s.state.privatePageStore),[s,t]),l=(0,a.yK)((e=>({container:{background:e.cardBackground,padding:"12px 18px",boxShadow:e.borderBoxShadow,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"baseline"},button:{fontWeight:O.Z.fontWeight.medium,justifyContent:"center",marginTop:8,opacity:n?.5:1},icon:{width:16,height:16,marginRight:6,transition:"all 200ms ease",transform:n?"rotate(-90deg)":void 0}})),[n]);return i?(0,F.jsxs)("div",{style:l.container,children:[(0,F.jsx)(p.Z,{isMultiline:!0,children:(0,F.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessage",defaultMessage:"As a <b>workspace owner</b>, you can change the permissions of this page to add yourself or others. Any changes will appear in the audit log.",values:{b:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,F.jsx)("b",{children:t})}}})}),(0,F.jsxs)(yn.Z,{disabled:n,style:l.button,onClick:()=>{s.setState({...s.state,changePermissionsEnabled:!0})},children:[(0,$n.I)(l.icon),n?(0,F.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.workspaceOwner.isChangingPermissionsMessageButton",defaultMessage:"Changing permissions"}):(0,F.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessageButton",defaultMessage:"Change permissions"})]})]}):null};function Xn(e){const t=(0,o.VK)((()=>M.ZP.state.tab),[]);switch(t){case M.XF.Share:return(0,F.jsx)(Qn,{...e});case M.XF.Publish:return(0,F.jsx)(oe,{store:e.store,permissionItemArgs:e.permissionItemArgs,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem});default:(0,C.t1)(t)}}const ei=function(e){const{store:t,permissionItemArgs:s}=e,n=(0,i.Fy)(),r=(0,o.qz)(e.inviteTargetsStore,w.ZP),l=(0,a.yK)((()=>({container:{display:"flex",flexDirection:"column",height:"100%"}})),[]);return(0,F.jsxs)("div",{style:l.container,children:[s.sudoModeStore&&(0,F.jsx)(Jn,{store:t,sudoModeStore:s.sudoModeStore}),!n.isMobile&&(0,F.jsx)(N,{inviteTargetsStore:r,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem}),(0,F.jsx)(Xn,{inviteTargetsStore:r,...e})]})};function ti(){const e=(0,i.Fy)(),t=(0,a.yK)((()=>({container:{display:"flex",alignItems:"center",justifyContent:"center",height:160}})),[]);return(0,F.jsx)("div",{style:t.container,children:(0,F.jsx)(p.Z,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0,children:(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Please go online to publish & share.",id:"blockPermissionsSettings.offline.prompt"})})})}const si=function(e){const{store:t,sudoModeStore:s,onUpgradeButtonClick:C,location:w}=e,k=(0,i.Fy)(),T=(0,o.qz)(void 0,v.Z),{contextualInviteStore:I}=(0,o.VK)((()=>T.state),[T]),Z=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),P=(0,o.VK)((()=>b.mk({spaceStore:Z,store:t})),[Z,t]),A=(0,o.VK)((()=>I.state.inviteStage),[I]),_=(0,o.VK)((()=>M.ZP.state.tab),[]),R=(0,a.yK)((()=>({title:{fontSize:18},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto"}})),[]),O=(0,n.useMemo)((()=>({onUpgradeButtonClick:C,sudoModeStore:s,location:w})),[C,s,w]);if(!Z)return null;if(!k.isMobile&&(A===S.TG.share_workspace||A===S.TG.request_workspace))return(0,F.jsx)(j.Z,{blockStore:t,spaceStore:Z,contextualInviteStore:I});const B=k.isMobile?{menuType:h.og.Modal,disableHeaderShadow:!0,title:(0,F.jsx)(p.Z,{isMobile:k.isMobile,style:R.title,children:(0,F.jsx)(r.FormattedMessage,{defaultMessage:"Share",id:"blockPermissionsSettings.mobileShareMenu.title"})}),additionalTopbarContent:(0,F.jsx)(U,{mostPermissivePublicItem:P.mostPermissivePublicItem}),left:(0,F.jsx)(m.Z,{href:(0,f.UY)("guides.sharing"),analyticsFrom:"sharing"}),footer:_===M.XF.Share&&(0,F.jsx)(Vn,{store:t,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:P,permissionItemArgs:O}),topbarStyle:R.topbarStyle,right:(0,F.jsx)(u.DoneMenuText,{}),onClickRight:e.onClose,whiteBackground:!0}:{menuType:h.og.Popup,maxHeight:"90vh"};return(0,F.jsx)(F.Fragment,{children:(0,F.jsx)(c.Z,{...B,className:g.B8p,children:(0,F.jsx)(l.Z,{debugName:"ShareMenuContainer",capture:!0,allowEsc:!0,children:(0,F.jsx)(d.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!1,render:()=>y.Z.state.online?(0,F.jsx)(ei,{store:t,permissionItemArgs:O,calculatedPermissions:P,buttonPopupStore:e.buttonPopupStore,inviteTargetsStore:e.inviteTargetsStore,contextualInviteStore:I}):(0,F.jsx)(ti,{})})})})})}},12994:(e,t,s)=>{s.r(t),s.d(t,{default:()=>D});s(67294);var n=s(83355),i=s(42875),o=s(94044),a=s(9291),r=s(53965),l=s(74194),d=s(78140),c=s(89728),u=s(53437),p=s(57806),m=s(79817),g=s(60709),h=s(45101),f=s(65598),x=s(48779),y=s(95697),S=s(4023),v=s(80444),b=s(85834),M=s(52878),j=s(48608),C=s(480),w=s(86628),k=s(24405),T=s(84169),I=s(25888),Z=s(16354),P=s(64369),F=s(18514),A=s(85893);function _(e){const t=(0,C.O7)(),{device:s,WindowSizeStore:n}=t,i=(0,w.VK)((()=>({left:n.getSafePaddingLeftCSS(8),right:n.getSafePaddingRightCSS(12)})),[n]),o=(0,w.VK)((()=>(0,y.bq)()),[]),r=(0,k.yK)((e=>({button:{display:"flex",alignItems:"center",width:s.isMobile?"100%":void 0,height:s.isMobile?44:24,paddingTop:s.isMobile?12:4,paddingBottom:s.isMobile?12:4,paddingLeft:i.left,paddingRight:i.right},helpIcon:{width:s.isMobile?16:14,height:s.isMobile?16:14,fill:s.isMobile?e.mediumIconColor:e.lightIconColor}})),[s.isMobile,i]);return(0,A.jsx)(Z.Z,{href:(0,F.UY)("guides.sharing"),onClick:()=>I.Fs(t,{from:"sharing"}),style:{width:s.isMobile?"100%":void 0},external:!0,children:(0,A.jsxs)(c.Z,{mobileFeedback:s.isMobile,isSmall:!0,style:{...r.button,...e.style},disabled:Boolean(e.disableHover),children:[(0,A.jsx)("div",{style:{marginLeft:s.isMobile?2:0,marginRight:s.isMobile?8:6},children:(0,T.m)(r.helpIcon)}),(0,A.jsx)(P.Z,{isSmall:!0,isMobile:s.isMobile,isSecondaryColor:!s.isMobile,children:o?(0,A.jsx)(a.FormattedMessage,{defaultMessage:"Learn more",id:"blockPermissionsSettings.learnMore.prompt"}):(0,A.jsx)(a.FormattedMessage,{defaultMessage:"Learn about sharing",id:"blockPermissionsSettings.learnAboutSharing.prompt"})})]})})}_.displayName="LearnAboutSharingLink";const R=_;class O extends n.Z{constructor(){super(...arguments),this.storeTypes={universalInviteStore:M.Z},this.renderEmailInput=this.createComputedStore((()=>"milestone_2"===this.props.mode))}renderComponent(){const{universalInviteStore:e}=this.stores,{permissionsInviteStore:t,contextualInviteStore:s}=e.state,n=e.stage,{spaceStore:i}=this.props;if(this.environment.device.isMobile||n===b.TG.closed)return null;if(!(0,f.Mm)(this.props.store)&&(n===b.TG.share_workspace||n===b.TG.request_workspace))return(0,A.jsx)(j.Z,{blockStore:this.props.store,spaceStore:i,contextualInviteStore:s});if(n===b.TG.share_page){const n={...this.props,renderInShareMenu:!0,spaceStore:i,permissionsInviteStore:t,contextualInviteStore:s,onInviteClick:()=>{(0,y.$)(this.environment)?s.setState({...s.state,inviteStage:b.TG.closed}):m.fr({environment:this.environment,spaceStore:i,contextualInviteStore:s})},onInviteComplete:e=>{m.x5({success:e,intl:this.props.intl,contextualInviteStore:s})},onCancel:async()=>{await(0,h.Aw)({environment:this.environment,permissionsInviteStoreState:t.state,from:"share_menu"})||e.reset()}};return this.renderEmailInput.state?(0,A.jsx)(B,{...n}):(0,A.jsx)(p.default,{...n})}}}O.displayName="UniversalMemberInvite";class B extends p.PermissionsInviteBase{constructor(){super(...arguments),this.inviteTargetLength=this.createComputedStore((()=>this.stores.permissionsInviteStore.state.inviteTargets.length)),this.blockTitle=this.createComputedStore((()=>{if((0,f.Mm)(this.props.store))return"";const e=this.props.store;if(!e.isDefined())return"";const t=e.getModel().getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:(0,i.r)(),intl:this.props.intl});return t||e.getModel().getEmptyTitlePlaceholder({getRecordModel:e.getRecordModel,userTimeZone:(0,i.r)(),intl:this.props.intl})})),this.handleInviteInputSubmit=async()=>{const{permissionsInviteStore:e}=this.stores;"invitee"===e.state.inputFocus?e.setState({...e.state,inputFocus:"email-content"}):await super.handleInviteInputSubmit()},this.resetFocusOnClickEmpty=e=>{const{permissionsInviteStore:t}=this.stores;e.currentTarget===e.target&&t.setState({...t.state,inputFocus:"none"})}}renderComponent(){return this.renderInShareMenu.state?this.renderUniversalInviteInner():super.renderComponent()}renderUniversalInviteInner(){const{permissionsInviteStore:e}=this.stores;return(0,A.jsxs)("div",{style:L(this.environment),onClick:this.resetFocusOnClickEmpty,children:[(0,A.jsx)(u.ZP,{popupType:u.kQ.Popup,alignmentToOrigin:S.v.Start,placementToOrigin:S.u.Bottom,open:"invitee"===e.state.inputFocus,originGap:10,disableMouseCapture:!0,forceRemeasureStore:this.inviteTargetLength,origin:super.renderHeader(),onDismiss:()=>{e.setState({...e.state,inputFocus:"email-content"})},render:()=>{const e=super.renderSearchRequest(),t={menuType:g.og.Popup,disableScroller:!1};return(0,A.jsx)("div",{children:(0,A.jsx)(d.Z,{...t,children:e})})},style:{width:360}}),this.renderEmailMessageInput(),this.renderSinglePlayerOptions(),this.renderActions()]})}renderEmailMessageInput(){const{permissionsInviteStore:e}=this.stores,t=this.getEmailMessage(),{inputFocus:s,emailMessage:n}=e.state,i=n.length/o.vr>=.8,a=(0,o.TQ)(n),r=i||a,d="email-content"===s;return(0,A.jsx)(l.Z,{textarea:!0,value:n,focus:d,focusInitial:!1,maxlength:o.vr,onFocus:()=>{e.setState({...e.state,inputFocus:"email-content"})},style:{background:d?"none":this.theme.inputBackground,alignItems:"flex-start",paddingLeft:12,paddingRight:12,paddingTop:8,paddingBottom:r?34:12},inputStyle:{minHeight:100},placeholder:t,onChange:t=>{e.setState({...e.state,emailMessage:t.target.value})},right:r&&this.renderMessageWarning({shouldShowLengthWarning:i,shouldShowLinkWarning:a}),isRightLastElementOfInput:!0,onSubmit:async()=>{await super.handleInviteClick()}})}renderSinglePlayerOptions(){if((0,f.Mm)(this.props.store))return null;const{contextualInviteStore:e,permissionsInviteStore:t}=this.stores,{currentSpaceStore:s}=v.default.state;if(!s)return null;if(!(0,y.$)(this.environment))return null;const{inviteTargets:n}=t.state;return!t.state.isInviteTargetsEmpty&&n.some((e=>h.OA(e)))?(0,A.jsx)(j.Z,{blockStore:this.props.store,spaceStore:s,contextualInviteStore:e}):null}renderActions(){return(0,A.jsxs)("div",{style:{display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",alignItems:"center",width:"100%"},onClick:this.resetFocusOnClickEmpty,children:[(0,A.jsxs)("div",{style:{display:"flex",flexDirection:"row-reverse",justifyContent:"flex-end",gap:8},children:[this.renderDesktopInputRightInnerButton({isLarge:!1}),(0,A.jsx)(c.Z,{style:{minWidth:o.UF,justifyContent:"center"},isLarge:!1,isLightGray:!0,onClick:()=>{var e,t;null===(e=(t=this.props).onCancel)||void 0===e||e.call(t)},children:(0,A.jsx)(a.FormattedMessage,{defaultMessage:"Cancel",id:"ContextualInvite.permissions_invites.button.cancel"})})]}),(0,A.jsx)(R,{style:{paddingLeft:0,paddingRight:0},disableHover:!0})]})}renderMessageWarning(e){const{permissionsInviteStore:t}=this.stores,{shouldShowLengthWarning:s,shouldShowLinkWarning:n}=e;return(0,A.jsxs)("span",{style:{fontSize:12,color:this.theme.lightTextColor,position:"absolute",bottom:8,left:12},children:[s&&(0,A.jsx)(a.FormattedMessage,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:t.state.emailMessage.length,maxCharacters:o.vr}}),s&&n&&" · ",n&&(0,A.jsx)(a.FormattedMessage,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})}getEmailMessage(){const{currentUserStore:e,currentSpaceStore:t}=v.default.state,{permissionsInviteStore:s}=this.stores,{intl:n}=this.props,{inviteTargets:i}=s.state,a=!s.state.isInviteTargetsEmpty&&r.yW(i,h.OA);if(!t)return n.formatMessage(o.VX.default);const l=null==e?void 0:e.getDisplayName(n),d=(0,x.rn)(this.environment,t);if(!l||!d)return n.formatMessage(o.VX.default);return(0,o.jm)({includeOptional:!1,isGuest:a,emailProps:{userName:l,pageName:this.blockTitle.state,spaceName:d},intl:this.props.intl})}}const D=(0,a.injectIntl)(O);function L(e){const{WindowSizeStore:t}=e;return{display:"flex",alignItems:"center",minHeight:52,paddingTop:10,paddingBottom:10,paddingLeft:t.getSafePaddingLeftCSS(14),paddingRight:t.getSafePaddingRightCSS(14),flexDirection:"column",gap:10}}},75546:(e,t,s)=>{s.d(t,{o:()=>c});s(67294);var n=s(480),i=s(86628),o=s(24405),a=s(37810),r=s(95697),l=s(43488),d=s(85893);function c(e){let{teamStore:t,withSelectedStyle:s}=e;const c=(0,n.Fy)(),u=(0,i.VK)((()=>{var e;return{teamName:t.getName()??"",shouldShowLock:(0,r.C2)(null==t||null===(e=t.getSettingsStore())||void 0===e?void 0:e.getValue())}}),[t]),p=(0,o.yK)((e=>({container:{display:"flex",alignItems:"center",overflow:"hidden"},lockIcon:{width:15,marginLeft:6,marginBottom:1,fill:e.mediumIconColor},labelText:{...a.Z.textOverflowStyle,...s?{color:e.regularTextColor,fontWeight:a.Z.fontWeight.semibold}:{color:e.darkTextColor,fontWeight:a.Z.fontWeight.medium},fontSize:c.isMobile?a.Z.fontSize.UIRegular.mobile:a.Z.fontSize.UIRegular.desktop}})),[c.isMobile,s]);return u?(0,d.jsxs)("div",{style:p.container,children:[(0,d.jsx)("div",{style:p.labelText,children:u.teamName}),u.shouldShowLock&&(0,d.jsx)(l.Z,{iconStyle:p.lockIcon})]}):null}},68973:(e,t,s)=>{s.d(t,{TA:()=>b,Zg:()=>S,a2:()=>C,eT:()=>M,mk:()=>v});s(21703),s(57658),s(67294);var n=s(45953),i=s(21202),o=s(9291),a=s(37850),r=s(54642),l=s(47307),d=s(77907),c=s(57345),u=s(28578),p=s(88632),m=s(6258),g=s(29026),h=s(54801),f=s(18471),x=s(85893);const y=50;function S(e){f.Z.resetSitesForSpace(e.id)}async function v(e,t){const{spaceStore:s,currentUserId:o,limit:l}=t;if(!s.id)return;const[d]=await Promise.all([r.getPublishedPagesForUser(e,{spaceId:s.id,limit:l||y,fetchPublishedMetadata:!0}),(0,a.Vs)(1500)]);if("failed"===d.type)throw new Error("Failed to fetch published pages.");if(d.data.recordMap){const e=[],t=n.PF.create(d.data.recordMap),a=d.data.publishedEdits;for(const{model:n}of t)if(n&&n.table===i.iU){const t=m.G.createChildStore(s,{table:i.iU,id:n.id}),o=a[t.id],r=o&&o.authors?o.authors[0]:void 0,l={publishedTime:null==o?void 0:o.timestamp,publishedBy:r};e.push({store:t,publishedMetadata:l})}let r=e;return o&&(r=h.S(e,o)),f.Z.initializeSiteResultsForSpace(s.id,r),r}}function b(e){c.lG(e),u.ZP.setState({...u.ZP.state,display:u.wV.Publish,tab:u.XF.Publish})}async function M(e){return new Promise(((t,s)=>{l.showDialog({message:(0,x.jsx)("div",{style:{textAlign:"center"},children:(0,x.jsx)(o.FormattedMessage,{id:"sites.confirmUnpublish.title",defaultMessage:"Unpublish this site?"})}),description:(0,x.jsx)("div",{style:{textAlign:"center"},children:(0,x.jsx)(o.FormattedMessage,{id:"sites.confirmUnpublish.caption",defaultMessage:"{pageTitle} will no longer be live on the web.",values:{pageTitle:e}})}),keepFocus:!0,items:[{label:(0,x.jsx)(o.FormattedMessage,{id:"sites.confirmUnpublish.confirm",defaultMessage:"Unpublish"}),color:"red",onAccept:()=>t(!0)}],showCancel:!0})}))}const j=5;async function C(e,t){if(!p.Z.state.online)return[];const s=await d.deps.searchActions.loader(),n=await s.searchPublicPages({environment:t,query:e,source:"public_home_page_menu",limit:g.Xv});return""===e?n.splice(0,j):n}},54801:(e,t,s)=>{s.d(t,{N:()=>a,S:()=>o});var n=s(72141),i=s(46654);function o(e,t){return e.sort(((e,s)=>{const n=e.store.canAdmin();if(n===s.store.canAdmin()){var i,o;const n=null===(i=e.publishedMetadata.publishedBy)||void 0===i?void 0:i.id,a=e.publishedMetadata.publishedTime,r=null===(o=s.publishedMetadata.publishedBy)||void 0===o?void 0:o.id,l=s.publishedMetadata.publishedTime;if(t){if(n===t&&r===t&&a&&l)return l-a;if(n===t)return-1;if(r===t)return 1}return a&&l?l-a:0}return n?-1:1}))}function a(e){const{environment:t,store:s}=e;if(!s.pathIsAccessibleAndAlive())return!1;return!!i.YO(s).find((e=>(0,n.$D)(e.permissionItem)&&"none"!==e.permissionItem.role))&&!i.IJ(t,s)}},18471:(e,t,s)=>{s.d(t,{Z:()=>l});var n=s(49085),i=s(70203),o=s(53965),a=s(6258);class r extends n.default{getInitialState(){return{sites:{},sortAscending:!0,sortColumn:void 0}}initializeSiteResultsForSpace(e,t){this.state.sites[e]=t,this.emit()}getSortedSitesForSpace(e,t){const{sortAscending:s,sortColumn:n}=this.state,r=this.state.sites[e];if(r)switch(n){case"page":return o.Xo(r,(e=>i.QaF(e.store.getTitleValue()).toLowerCase()),s?"asc":"desc");case"published-by":return o.Xo(r,(e=>{const s=e.publishedMetadata.publishedBy,n=s?a.t1.createChildStore(e.store,s):void 0;return null==n?void 0:n.getDisplayName(t).toLowerCase()}),s?"asc":"desc");case"published-date":return o.Xo(r,(e=>e.publishedMetadata.publishedTime),s?"asc":"desc");default:return r}}removeSiteFromSpace(e,t){const s=this.state.sites[e];s&&(this.state.sites[e]=s.filter((e=>e.store.id!==t)),this.emit())}resetSitesForSpace(e){this.state.sites[e]=void 0}}const l=new r},22756:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{isModalOpen:!1,currentTab:"selectData",account:void 0,isAccountLinkingInProgress:!1,isAccountDelinkingInProgress:!1,workspaces:[],teamsAndProjects:[],selectedWorkspace:void 0,selectedProjectsAndTeamspaces:{},importCompletedTasks:!0,teams:void 0,loadMoreClicks:0,isLoadingProjects:!1,isLoadingAsanaWorkspaces:!1,result:void 0,isComplete:!1,loggerPageId:void 0,templateCreationInProgress:!1,isFetchingAsanaAccount:!1,choosingWorkspacesCompleted:!1}}resetImport(){const{account:e,workspaces:t}=this.getState();this.setState({...this.getInitialState(),account:e,workspaces:t})}}const o=new i},62395:(e,t,s)=>{s.d(t,{n:()=>n});const n=s(49085).default.createValue(void 0)},17549:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{open:!1}}}const o=new i},85680:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{isOpen:!1}}}const o=new i},45214:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{open:!1}}}const o=new i},46096:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{open:!1}}}const o=new i},4391:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{allIcons:{},recentIcons:[],loadIconCount:0}}}const o=i},78900:(e,t,s)=>{s.d(t,{Z:()=>n});const n=new(s(61766).Z)},70681:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{open:!1}}}const o=new i},69122:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{isModalOpen:!1,account:void 0,workspaces:[],isLoadingProjects:!1,mondayFoldersAndBoards:[],selectedProjectsAndTeamspaces:{},templateCreationInProgress:!1,currentTab:"selectData",loggerPageId:void 0,showAuthPopup:!1,email:void 0,APIToken:void 0,result:void 0,isComplete:!1,selectedWorkspace:void 0,isLoadingMondayWorkspaces:!1,isFetchingMondayAccount:!1}}resetImport(){const{account:e,workspaces:t}=this.getState();this.setState({...this.getInitialState(),account:e,workspaces:t})}}const o=new i},4548:(e,t,s)=>{s.d(t,{Z:()=>n});const n=new(s(45589).Z)},25399:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{open:!1}}}const o=new i},54983:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{}}}const o=i},33052:(e,t,s)=>{s.d(t,{Z:()=>a});var n=s(49085),i=s(29369);class o extends n.default{getInitialState(){return{modalOpen:!1,tokenQuery:"",inviteTargets:[],inviteRole:"member",isInviteTargetsEmpty:!0,table:i.e0,isFocused:!0,flowId:void 0,inputFocus:"invitee",emailMessage:""}}}const a=o},21884:(e,t,s)=>{s.d(t,{E:()=>n});const n=s(49085).default.createValue({showConvertTooltip:!1,forceShow:!1})},37014:(e,t,s)=>{s.d(t,{x:()=>a});s(67294);var n=s(89024),i=s(7124),o=s(85893);function a(e){const{label:t,children:s,gap:a}=e;return(0,o.jsxs)(n.jX,{gap:void 0===a?6:a,children:[t?(0,o.jsx)(i.q,{as:"label",styleName:"Body-12px/Medium",colorName:"secondary",children:t}):null,s]})}},27533:(e,t,s)=>{s.d(t,{W:()=>a});s(67294);var n=s(94919),i=s(9291),o=s(85893);function a(e){const t=(0,i.useIntl)();return(0,o.jsx)(n.W,{...e,intl:t})}},72983:(e,t,s)=>{s.d(t,{l:()=>a});s(67294);var n=s(9291),i=s(1898),o=s(85893);function a(e){const{layout:t,address:s}=e,a=(0,n.useIntl)();if(!s)return null;if("condensed"===t){const e=a.formatList([s.name,s.businessName,s.addressLine1,s.country].filter(Boolean),{type:"conjunction",style:"narrow"});return(0,o.jsx)("div",{children:e})}if("full"===t){const e=a.formatList([s.addressLine1,s.addressLine2].filter(Boolean),{type:"conjunction",style:"narrow"}),t=a.formatList([s.state,s.country,s.zipCode].filter(Boolean),{type:"conjunction",style:"narrow"}),n=[s.name,s.businessName,e,t].filter(Boolean);return(0,o.jsx)("div",{children:n.map(((e,t)=>(0,o.jsx)("div",{children:e},t)))})}(0,i.t1)(t)}},28833:(e,t,s)=>{s.r(t),s.d(t,{default:()=>pe,isCancellationStage:()=>ce,isConfirmPurchaseStage:()=>de,isLimitReachedStage:()=>le});var n=s(67294),i=s(13991),o=s(480),a=s(86628),r=s(24405),l=s(41892),d=s(7057),c=s(64275),u=s(44495),p=s(9182),m=s(896),g=s(47425),h=s(9291),f=s(31701),x=s(1898),y=s(37810),S=s(47307),v=s(64964),b=s(11066),M=s(68785),j=s(58297),C=s(92660),w=s(42402),k=s(52533),T=s(18514),I=s(48779),Z=s(80444),P=s(80671),F=s(22616),A=s(81023),_=s(40469),R=s(44041),O=s(81886),B=s(5682),D=s(40670),L=s(70060),V=s(58333),N=s(43163),E=s(88893),U=s(35057),W=s(63423),K=s(33493),z=s(88280),q=s(27533),G=s(85893);function H(e){const{addOnFeature:t,canPurchaseAddOn:s,isSubscribed:n}=e,i=re(),a=(0,o.O7)();return s&&n?(0,G.jsx)(Y,{addOnFeature:t,canPurchaseAddOn:s}):(0,G.jsxs)(G.Fragment,{children:[(0,u.D)(i.icon),(0,G.jsx)($,{addOnFeature:t,canPurchaseAddOn:s}),(0,G.jsx)(J,{addOnFeature:t,canPurchaseAddOn:s}),(0,G.jsx)(j.Z,{isLarge:!0,style:i.button,onClick:async()=>s?n?P.Cl(void 0):async function(e,t){await R.y(e,{from:"plans_page",for:t,addOnFeature:"ai"}),P.v5()}(a,"free"):P.v5(),children:s?(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.purchase.button.label",defaultMessage:"Purchase"}):(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.gotIt.button.label",defaultMessage:"Got it"})})]})}function Y(e){var t,s;const{addOnFeature:n,canPurchaseAddOn:i}=e,r=(0,o.O7)(),d=re(),c=(0,a.VK)((()=>(0,U.zt)()),[]),u=(0,a.VK)((()=>z.subscriptionDataStoreInstance.state),[]),p=(0,a.VK)((()=>W.Z.state.open?W.Z.state.coupon:null),[]),m=(0,a.VK)((()=>Z.default.state.currentSpaceStore),[]);if(!m)return null;const f=(0,k.S$)({environment:r})&&(0,g.QR)(c);if(r.device.isMobileNative&&!f)return null;let y;if(!u||"unsubscribed_admin"!==u.type&&"subscribed_admin"!==u.type||(y=u),y&&"revenueCat"===(null===(t=y.customerData)||void 0===t?void 0:t.activeSubscriptionPlatform)){const e=(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.errorMessage.switchPlanFromInAppPurchase",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. To switch plans, cancel your subscription with Apple first."});return S.showErrorMessage(e),null}const v=(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.errorMessage.notAdmin",defaultMessage:"You don't have permissions to upgrade this workspace to an add-on. If you think this is a mistake please contact your administrator."});if(!(0,E.GJ)(u))return S.showErrorMessage(v),null;const b=null===(s=y)||void 0===s||null===(s=s.customerData)||void 0===s?void 0:s.stripe;if(!b)return null;const M=b.isSubscribed?b.interval:"month",j=p?function(e){if("ai_fifty_percent"===e)return(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.coupon.fiftyPercent.label",defaultMessage:"50% off discount"});(0,x.t1)(e)}(p):"year"===M?(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.coupon.twentyPercent.label",defaultMessage:"20% off discount"}):null;return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("img",{src:l.Z.images.pricing.aiLogoPng,style:d.aiLogo}),(0,G.jsx)($,{addOnFeature:n,canPurchaseAddOn:i}),(0,G.jsx)(X,{addOnFeature:n}),j?Q(j):null,(0,G.jsx)(ee,{addOnFeature:n,interval:M,stripeData:b,spaceStore:m})]})}function Q(e){const t=re();return(0,G.jsx)(b.Z,{style:{...t.sharedStyleForDiscountBadge},disabled:!0,children:(0,G.jsx)("div",{style:{...t.innerStyleForDiscountBadge},children:e})})}function $(e){const{addOnFeature:t,canPurchaseAddOn:s}=e,n=re();let i;if("ai"===t)i=s?(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgrade.title.admin",defaultMessage:"Get more Notion AI"}):(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgrade.title.nonAdmin",defaultMessage:"Your workspace has run out of its Notion AI promotion"});else(0,x.t1)(t);return(0,G.jsx)("h3",{style:n.title,children:i})}function J(e){const{addOnFeature:t,canPurchaseAddOn:s}=e;let n;const i=re();if("ai"===t)n=s?(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgrade.description.admins",defaultMessage:"Your one-time promotion has ran out. To continue using AI features, purchase more AI uses for your workspace"}):(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgrade.description.nonAdmins",defaultMessage:"Your workspace’s one-time Notion AI promotion is over. Contact a workspace admin to purchase unlimited AI for your team to use."});else(0,x.t1)(t);return(0,G.jsx)("p",{style:i.paragraph,children:(0,G.jsx)("div",{style:i.text,children:n})})}function X(e){const{addOnFeature:t}=e;let s;const n=(0,o.O7)(),i=re(),r=(0,a.VK)((()=>Z.default.state.currentSpaceStore),[]);if(!r)return null;const l=(0,a.VK)((()=>(0,I.rn)(n,r)),[n,r]);if("ai"===t)s=(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgrade.confirmation.description.admins",defaultMessage:"Go unlimited with Notion AI for all members in {spaceName}.",values:{spaceName:l}});else(0,x.t1)(t);return(0,G.jsx)("p",{style:i.paragraph,children:(0,G.jsx)("div",{style:i.text,children:s})})}function ee(e){const{addOnFeature:t,interval:s,stripeData:i,spaceStore:r}=e,l=re(),d=(0,o.O7)(),c=(0,a.VK)((()=>(0,E.qX)()),[]),u=i.currencyCode??"USD",{tax:m,coupon:g}=(0,a.VK)((()=>({tax:W.Z.state.open?W.Z.state.tax:0,coupon:W.Z.state.open?W.Z.state.coupon:void 0})),[]),f=(0,a.VK)((()=>K.Z.getPrice(d,(e=>e.product===t&&e.billingInterval===s&&e.currencyCode===u))),[t,d,s,u]),x=(0,a.VK)((()=>K.Z.getPrice(d,(e=>e.product===t&&"month"===e.billingInterval&&e.currencyCode===u))),[t,u,d]);if((0,n.useEffect)((()=>{!async function(){if(f.result&&i&&i.address){const e=f.result.getCostPerBillingInterval({quantity:c,coupon:g}).amount;await _.nf({environment:d,priceForTaxCalculation:e,address:i.address,customerId:i.customerId,vatId:i.vatId})}}()}),[d,i,f,c,g]),!f.isLoaded||!x.isLoaded)return(0,G.jsx)(M.Z,{});if(!f.result||!x.result)return null;const y=f.result,S=y.getCostPerBillingInterval({quantity:c,coupon:g}).withAddedAmount(m),b=x.result,C=b.getMonthlyUnitCost();let k=b.getMonthlyCost({quantity:c});"year"===s&&(k=k.withMultipliedAmount(12));const{addOnCostItem:I,addOnCostItemWithMembers:Z}=(0,O.OL)(t,c,s,(0,G.jsx)(q.W,{cost:C.toMoneyValue(),trailingZeroDisplay:"stripIfInteger"}));return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)("p",{style:l.monthlyCostText,children:[(0,G.jsx)("h3",{style:l.title,children:(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgrade.confirmation.monthlyCost.title",defaultMessage:"Add on"})}),(0,G.jsxs)("div",{style:l.costSectionTitle,children:[(0,G.jsx)("div",{children:I}),(0,G.jsx)("div",{style:l.rightAlign,children:(0,G.jsx)(q.W,{cost:k.toMoneyValue(),trailingZeroDisplay:"auto"})})]}),(0,G.jsx)("div",{style:l.costSection,children:Z}),(0,G.jsx)(te,{cost:y.getCostPerBillingInterval({quantity:c}),fullCost:k}),(0,G.jsx)(se,{price:y,coupon:g,quantity:c}),(0,G.jsxs)("div",{style:l.costSection,children:[(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.taxes",defaultMessage:"Taxes:"}),(0,G.jsx)("div",{style:l.rightAlign,children:(0,G.jsx)(q.W,{cost:{amount:m,currencyCode:u},trailingZeroDisplay:"auto"})})]}),(0,G.jsxs)("div",{style:l.totalCostSection,children:[(0,G.jsx)("h3",{style:l.title,children:(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.total",defaultMessage:"Total"})}),(0,G.jsx)("div",{style:l.rightAlign,children:(0,G.jsx)("h3",{style:l.title,children:(0,G.jsx)(q.W,{cost:S.toMoneyValue(),trailingZeroDisplay:"auto"})})})]}),(0,G.jsx)("div",{style:l.perMonth,children:(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.interval.label",defaultMessage:"{interval, select, month {per month} other {per year}}",values:{interval:s}})})]}),(0,G.jsx)(j.Z,{isLarge:!0,style:l.button,onClick:async()=>{const e=r.id,s=await F.aQ({environment:d,spaceId:e}),n=(0,B.P)(s,i),o=(0,p.Lg)(n),a=(0,V.AI)(o,{price:y,quantity:c});await A.Mg({environment:d,spaceStore:r,from:"add_on_upgrade_modal",desiredState:a,inAppOffer:g}),P.v5();const l=D.aQ({addOnFeature:t});l&&v.oV(l)},children:(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.confirmPurchase.button.label",defaultMessage:"Confirm purchase"})}),(0,G.jsx)("p",{style:l.termsOfService,children:(0,G.jsx)("div",{style:l.text,children:(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgrade.confirmation.prorated.description",defaultMessage:"Performance subject to <fairUsePolicies>fair use policies</fairUsePolicies>.{br}By clicking Confirm Purchase you agree to the <terms>Notion AI Supplementary Terms</terms>.",values:{br:(0,G.jsx)("br",{}),fairUsePolicies:e=>(0,G.jsx)(w.Z,{href:(0,T.UY)("ai.fairUsePolicies"),children:e}),terms:e=>(0,G.jsx)(w.Z,{href:(0,T.UY)("ai.terms"),children:e})}})})})]})}function te(e){const t=re(),{cost:s,fullCost:n}=e;if(s.amount===n.amount)return null;const i=n.minus(s),o=Math.floor(i.amount/n.amount*100);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)("div",{style:t.costSectionTitle,children:[(0,G.jsx)("div",{children:(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.annual.dynamicDiscountMessage",defaultMessage:"<bold>Annual discount ({discountPercent}%)</bold>",values:{bold:e=>(0,G.jsx)("b",{children:e}),discountPercent:o}})}),(0,G.jsx)("div",{style:t.greenRightAlign,children:(0,G.jsx)(q.W,{cost:i.withMultipliedAmount(-1).toMoneyValue(),trailingZeroDisplay:"auto",currencySign:"standard"})})]}),(0,G.jsx)("div",{style:t.costSection,children:(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscount.annualPlanMessage",defaultMessage:"for being on the annual plan"})})]})}function se(e){const t=re(),{price:s,coupon:n,quantity:i}=e;if(!(0,m.pp)(n))return null;const o=s.getDiscountPerBillingInterval({quantity:i,coupon:n}).withMultipliedAmount(-1);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)("div",{style:t.costSectionTitle,children:[(0,G.jsx)("div",{children:(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscount",defaultMessage:"<bold>Special discount ({percentage})</bold>",values:{bold:e=>(0,G.jsx)("b",{children:e}),percentage:(0,N.o)(n)}})}),(0,G.jsx)("div",{style:t.greenRightAlign,children:(0,G.jsx)(q.W,{cost:o,trailingZeroDisplay:"auto",currencySign:"standard"})})]}),(0,G.jsx)("div",{style:t.costSection,children:(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscount.threeMonthsMessage",defaultMessage:"for the next 3 months"})})]})}function ne(e){const{data:t,addOnFeature:s}=e,n=re(),i=(0,o.O7)();return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("div",{style:n.buttonWithTopPadding,children:(0,G.jsx)(b.Z,{style:n.redButton,hoveredStyle:{background:f.ZP.redWithAlpha(.8)},onClick:async()=>{const e=(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.cancellationStage.errorMessage",defaultMessage:"Unable to cancel add-on subscription. Please try again later."}),n=Z.default.state.currentSpaceStore;if(!n)return S.showErrorMessage(e);const o=n.id,a=await F.aQ({environment:i,spaceId:o}),r=(0,B.P)(a,t),l=(0,p.Lg)(r),d=(0,V.t4)(l,s);await A.Mg({environment:i,spaceStore:n,from:"add_on_upgrade_modal",desiredState:d}),P.v5()},children:(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.midterm.yesButton.label",defaultMessage:"Schedule removal"})})}),(0,G.jsx)("div",{style:n.buttonWithTopPadding,children:(0,G.jsx)(b.Z,{style:n.noButton,onClick:()=>P.v5(),children:(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.noButton.label",defaultMessage:"Cancel"})})})]})}function ie(e){const{data:t}=e,s=re();let n,o=!1;const r=(0,a.VK)((()=>(0,L.bU)()),[]);if("subscribed_admin"===t.type||"unsubscribed_admin"===t.type){var l;const e=null===(l=t.customerData)||void 0===l?void 0:l.stripe;n=null==e?void 0:e.periodEnd,o=Boolean((null==e?void 0:e.schedule)||(null==e?void 0:e.willCancelAt))}return n?(0,G.jsx)("p",{style:s.paragraph,children:(0,G.jsx)("div",{style:s.text,children:o&&!r?(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.midterm.cancellationWithPendingChanges.description",defaultMessage:"You can continue to enjoy Notion AI until the end of your billing period on <bold>{periodEnd}</bold>. This change will cancel your previous pending changes. You can resubscribe anytime.",values:{periodEnd:(0,d.Yx)(n,"long",i.SP),bold:e=>(0,G.jsx)("b",{children:e})}}):(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.midterm.cancellation.description",defaultMessage:"Thank you for your input! You can continue to enjoy Notion AI until the end of your billing period on <bold>{periodEnd}</bold>. You can resubscribe anytime.",values:{periodEnd:(0,d.Yx)(n,"long",i.SP),bold:e=>(0,G.jsx)("b",{children:e})}})})}):null}function oe(e){const{addOnFeature:t,canPurchaseAddOn:s,data:n}=e,i=re();if(!s)return null;let o;if("ai"===t)o=(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.midterm.cancellation.title",defaultMessage:"Remove AI at the end of your billing period?"});else(0,x.t1)(t);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("h3",{style:i.cancellationTitle,children:o}),(0,G.jsx)(ie,{data:n}),(0,G.jsx)(ne,{data:n,addOnFeature:t})]})}function ae(){const e=re(),t=(0,o.O7)();let s=(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.mobileMessage.button.label",defaultMessage:"Use the web or desktop app to add Notion AI to your plan and go unlimited."});return(t.device.isIOS||t.device.isIpad)&&(s=(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.mobileMessage.ios.button.label",defaultMessage:"You are out of free AI."})),(0,G.jsxs)(G.Fragment,{children:[(0,u.D)(e.icon),(0,G.jsx)("h3",{style:e.title,children:(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgrade.title.nonAdmin",defaultMessage:"Your workspace has run out of its Notion AI promotion"})}),(0,G.jsx)("p",{style:e.paragraph,children:(0,G.jsx)("div",{style:e.text,children:s})}),(0,G.jsx)(j.Z,{isLarge:!0,style:e.button,onClick:()=>P.v5(),children:(0,G.jsx)(h.FormattedMessage,{id:"addOnUpgradeModal.gotIt.button.label",defaultMessage:"Got it"})})]})}function re(){return(0,r.yK)((e=>({modal:{maxWidth:350,padding:24,fontSize:14,textAlign:"center"},largeModal:{maxWidth:420,padding:24,fontSize:14,textAlign:"center"},mobileModal:{padding:24,fontSize:14,textAlign:"center"},cancellationModal:{maxWidth:350,padding:"24px 16px 12px",fontSize:14,textAlign:"center"},innerModalPadding:{padding:"0px 8px"},cancellationInnerModalPadding:{padding:0},innerStyle:{borderRadius:10},title:{margin:0,marginBottom:0},cancellationTitle:{margin:0,marginBottom:0,marginTop:14},monthlyCostText:{textAlign:"left",paddingBottom:16},costSection:{margin:0,marginBottom:8,display:"flex",color:e.mediumTextColor},costSectionTitle:{display:"flex",color:e.mediumTextColor},totalCostSection:{display:"flex"},paymentMethodSection:{marginBottom:8,marginTop:8,display:"flex"},rightAlign:{position:"absolute",right:24},greenRightAlign:{position:"absolute",right:24,color:e.invoiceGreen},paragraph:{lineHeight:1.4,marginTop:4,marginBottom:12},termsOfService:{fontSize:"small",marginTop:8},text:{margin:0,color:e.mediumTextColor,marginBottom:8},icon:{display:"inline",height:24,fill:e.lightIconColor,marginTop:8,marginBottom:8},aiLogo:{height:60},button:{width:"100%"},buttonWithTopPadding:{paddingTop:12},noButton:{width:"100%",height:24,display:"inline-flex",alignItems:"center",justifyContent:"center"},cancelButton:{position:"absolute",top:"10px",right:"10px",background:e.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},redButton:{width:"100%",color:f.ZP.white,background:e.redBadgeBackground,display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,borderRadius:4,lineHeight:1.2,paddingLeft:12,paddingRight:12,fontWeight:y.Z.fontWeight.medium},closeIcon:{width:14,fill:e.mediumTextColor},hovered:{background:e.buttonPressedBackground},perMonth:{position:"absolute",right:24,display:"flex",color:e.mediumTextColor,marginTop:-4},sharedStyleForDiscountBadge:{display:"inline-flex",alignItems:"center",borderRadius:4},innerStyleForDiscountBadge:{padding:"2px 6px",borderRadius:4,color:e.regularTextColor,background:e.accentColors.gray[50],fontWeight:400,fontSize:14,lineHeight:"16px",letterSpacing:"0.04em",whiteSpace:"nowrap"}})),[])}function le(){return ue("limit_reached")}function de(){return ue("confirm_purchase")}function ce(){return ue("cancel_plan")}function ue(e){const t=W.Z.state;if(t.open)return t.stage===e}const pe=function(e){const{data:t}=e,s="ai",n=(0,E.GJ)(t),i=re(),a=E.YK(t);return(0,o.O7)().device.isMobile?(0,G.jsx)(C.Z,{innerStyle:i.innerStyle,requireOnline:!0,modalStore:W.Z,onDismiss:()=>P.v5(),render:()=>(0,G.jsx)("div",{style:i.mobileModal,children:(0,G.jsx)("div",{style:i.innerModalPadding,children:(0,G.jsx)(ae,{})})})}):(0,G.jsx)(C.Z,{innerStyle:i.innerStyle,requireOnline:!0,modalStore:W.Z,onDismiss:()=>P.v5(),render:()=>(0,G.jsx)("div",{style:de()||le()&&a&&n?i.largeModal:ce()?i.cancellationModal:i.modal,children:(0,G.jsxs)("div",{style:ce()?i.cancellationInnerModalPadding:i.innerModalPadding,children:[(0,G.jsx)(b.Z,{onClick:()=>{P.v5()},style:i.cancelButton,hoveredStyle:i.hovered,children:(0,c.D)(i.closeIcon)}),le()&&(0,G.jsx)(H,{addOnFeature:s,canPurchaseAddOn:n,isSubscribed:a}),de()&&(0,G.jsx)(Y,{addOnFeature:s,canPurchaseAddOn:n}),ce()&&(0,G.jsx)(oe,{addOnFeature:s,canPurchaseAddOn:n,data:t})]})})})}},70453:(e,t,s)=>{s.r(t),s.d(t,{ContactSalesModal:()=>A,ContactSalesModalContent:()=>_,getCompanySizeOptions:()=>N});s(57658);var n=s(67294),i=s(480),o=s(84747),a=s(86628),r=s(24405),l=s(41892);const d=(0,s(45238).CZ)("infoBubble",{default:{loader:()=>s.e(9965).then(s.bind(s,39965)),size:20},small:{loader:()=>s.e(8109).then(s.bind(s,58109)),size:16},mini:{loader:()=>s.e(8036).then(s.bind(s,58036)),size:14},large:{loader:()=>s.e(5332).then(s.bind(s,5332)),size:24}});var c=s(30845),u=s(9291),p=s(86572),m=s(89024),g=s(74194),h=s(82914),f=s(66102),x=s(7124),y=s(63296),S=s(7184),v=s(26388),b=s(30221),M=s(37014),j=s(42853),C=s(52275),w=s(14871),k=s(34430),T=s(8438),I=s(85893);const Z=function(e){let{question:t,onSelect:s,invalid:n}=e;const o=(0,i.O7)(),a=(0,u.useIntl)(),l=(d=o.device.isMobile,(0,r.yK)((e=>({icon:{width:12,fill:e.icon.tertiary},inputStyle:{height:28,...d&&{height:42},padding:"2px 10px",display:"flex",alignItems:"center",justifyContent:"space-between",borderRadius:6,border:`1px solid ${e.stroke.regular}`,background:e.surface.wash,backgroundColor:e.surface.wash},invalidStyle:{boxShadow:e.outlineRedInputBoxShadow}})),[d]));var d;const c={menuTitle:a.formatMessage(k.sY.yourQuestion),items:T.T,width:"auto",minWidth:360,getKey:e=>e,selectedItem:t,originGap:4,onSelect:e=>s(e),renderItem:e=>(0,I.jsx)(C.Z,{title:a.formatMessage(k.Sn[e.value]),...e}),renderOrigin:e=>(0,I.jsxs)(y.Z,{...e,isLarge:!0,style:{...l.inputStyle,...n?l.invalidStyle:{}},children:[(0,I.jsx)(x.q,{styleName:"Body-14px/Regular",colorName:t?"primary":"tertiary",children:a.formatMessage(t?k.Sn[t]:k.sY.selectQuestion)}),(0,j.i)(l.icon)]})};return(0,I.jsx)(w.Z,{...c},"onboarding")},P=8,F=406;function A(e){let{initialQuestion:t,userModel:s}=e;const o=(0,i.O7)(),{open:r}=(0,a.VK)((()=>b.Z.state),[]),l=n.useCallback((()=>{p.g3(o),b.Z.setState({open:!1})}),[o]);return(0,I.jsx)(S.c,{isOpen:r,onClosed:l,areaConstraint:{width:{min:F}},children:(0,I.jsx)(_,{initialQuestion:t,userModel:s,handleClose:l})})}function _(e){let{initialQuestion:t,userModel:s,handleClose:r}=e;const l=(0,i.O7)(),f=(0,u.useIntl)(),x=V(),[y,S]=(0,a.VK)((()=>[null==s?void 0:s.getDisplayName(f),null==s?void 0:s.getEmail()]),[f,s]),[v,b]=n.useState("initial"),[j,C]=n.useState(!1),[w,T]=n.useState([]),[F,A]=n.useState({name:y,email:S,question:t}),_="<100"===F.companySize;function N(e,t){p.QO(l,{contactFieldType:t,contactFieldValue:e}),T((e=>e.filter((e=>e!==t)))),A((s=>({...s,[t]:e})))}return(0,o.Z)((()=>p.Zb(l))),"confirmation"===v?(0,I.jsx)(L,{}):(0,I.jsx)(h.sR,{header:(0,I.jsx)(h.vI,{iconAndTitle:(0,I.jsx)(h.kC,{iconGroup:d,title:f.formatMessage(k.sY.title)}),description:f.formatMessage(k.sY.description),descriptionStyle:x.description}),footer:(0,I.jsx)(R,{onSubmit:function(){const e=function(e){let{name:t,email:s,companySize:n,question:i,additionalFeedback:o}=e;const a=[];t||a.push("name");s&&c.B(s,"email")||a.push("email");n||a.push("companySize");i||a.push("question");"other"!==i||o||a.push("additionalFeedback");return a}(F);e&&e.length>0?T((t=>[...t,...e])):(p.Ls(l,{...F}),b("confirmation"))},onClose:r,intl:f,isIneligibleForSales:_}),children:(0,I.jsxs)(m.jX,{gap:24,padding:2,children:[(0,I.jsx)(O,{value:F.name,onChange:N,isInvalid:w.includes("name"),intl:f}),(0,I.jsx)(B,{value:F.email,onChange:N,isInvalid:w.includes("email"),intl:f}),(0,I.jsx)(D,{value:F.companySize,onChange:N,isInvalid:w.includes("companySize"),intl:f}),(0,I.jsxs)(m.jX,{gap:P,children:[(0,I.jsx)(M.x,{label:f.formatMessage(k.sY.questionLabel),gap:P,children:(0,I.jsx)(Z,{question:F.question,invalid:w.includes("question"),onSelect:e=>{C("other"===e),N(e,"question")}})}),j?(0,I.jsx)(g.Z,{textarea:!0,value:F.additionalFeedback,placeholder:f.formatMessage(k.sY.additionalFeedbackPlaceholder),style:w.includes("additionalFeedback")?x.invalidInput:void 0,onChange:e=>N(e.target.value,"additionalFeedback")}):null]})]})})}function R(e){let{onSubmit:t,onClose:s,intl:n,isIneligibleForSales:i}=e;return(0,I.jsxs)(m.jX,{gap:P,children:[(0,I.jsx)(v.ZP,{style:{width:"auto",...!i&&{display:"none"}},textWrap:!0,renderTooltip:()=>i?(0,I.jsxs)(I.Fragment,{children:[n.formatMessage(k.sY.ineligibleCompanySize),(0,I.jsx)("br",{})," ",(0,I.jsx)("br",{}),n.formatMessage(k.sY.ineligibleContactSupport)]}):null,render:e=>(0,I.jsx)(f.H,{...e,buttonInfo:{buttonType:"primary",label:n.formatMessage(k.sY.sendRequest),onClick:t,isDisabled:i}})}),(0,I.jsx)(f.H,{buttonInfo:{buttonType:"secondary",label:n.formatMessage(k.sY.cancel),onClick:s}})]})}function O(e){let{value:t,onChange:s,isInvalid:n,intl:i}=e;const o=V();return(0,I.jsx)(M.x,{label:i.formatMessage(k.sY.nameLabel),gap:P,children:(0,I.jsx)(g.Z,{focusInitial:!0,value:t,placeholder:"Ada Lovelace",style:n?o.invalidInput:void 0,onChange:e=>s(e.target.value,"name")})})}function B(e){let{value:t,onChange:s,isInvalid:n,intl:i}=e;const o=V();return(0,I.jsx)(M.x,{label:i.formatMessage(k.sY.emailLabel),gap:P,children:(0,I.jsx)(g.Z,{value:t,placeholder:"ada@lovelace.app",type:"email",style:n?o.invalidInput:void 0,onChange:e=>s(e.target.value,"email")})})}function D(e){let{value:t,onChange:s,isInvalid:n,intl:i}=e;const o=V(),a=N();return(0,I.jsxs)(M.x,{label:i.formatMessage(k.sY.companySizeLabel),gap:P,children:[(0,I.jsx)(m.jX,{gap:8,direction:"row",children:a.map((e=>{let{option:n,message:a}=e;const r=t===n;return(0,I.jsx)(y.Z,{style:r?o.selectedButton:void 0,onClick:()=>s(n,"companySize"),children:i.formatMessage(a)},n)}))}),n?(0,I.jsx)(x.q,{styleName:"Agate-10px/Medium",colorName:"uiRedPrimary",children:i.formatMessage(k.sY.companySizeError)}):null]})}function L(){return(0,I.jsx)(h.sR,{header:null,footer:null,children:(0,I.jsxs)(m.jX,{align:"top-center",gap:8,children:[(0,I.jsx)("img",{style:{width:165,height:80},src:l.Z.images.feedbackThankYouPng}),(0,I.jsx)(x.q,{styleName:"Body-14px/Regular",style:{textAlign:"center",maxWidth:250},children:(0,I.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.confirmation",defaultMessage:"We've received your inquiry and will contact you via email shortly."})})]})})}function V(){return(0,r.yK)((e=>({description:{maxWidth:250},invalidInput:{boxShadow:e.outlineRedInputBoxShadow},selectedButton:{color:e.text.uiBluePrimary,border:`1px solid ${e.text.uiBluePrimary}`}})),[])}function N(){return[{option:"<100",message:k.CF.lessThanOneHundred},{option:"100-299",message:k.CF.oneToThreeHundred},{option:"300-1999",message:k.CF.threeHundredToTwoThousand},{option:"2000+",message:k.CF.twoThousand}]}},34430:(e,t,s)=>{s.d(t,{CF:()=>o,Sn:()=>a,sY:()=>i});var n=s(9291);const i=(0,n.defineMessages)({additionalFeedbackPlaceholder:{id:"enterpriseContactModal.additionalFeedback.placeholder",defaultMessage:"What would you like to learn more about?"},title:{id:"enterpriseContactModal.initial.header",defaultMessage:"Get in touch with sales"},description:{id:"enterpriseContactModal.initial.caption",defaultMessage:"We'll work with you on your setup and help you land on the best plan."},nameLabel:{id:"enterpriseContactModal.nameLabel",defaultMessage:"Name"},emailLabel:{id:"enterpriseContactModal.emailLabel",defaultMessage:"Work email"},companySizeLabel:{id:"enterpriseContactModal.initial.companySizeLabel",defaultMessage:"Company size"},companySizeError:{id:"enterpriseContactModal.initial.companySizeError",defaultMessage:"Please select a company size"},questionLabel:{id:"enterpriseContactModal.questionLabel",defaultMessage:"Question"},sendRequest:{id:"enterpriseContactModal.sendLabel",defaultMessage:"Send request"},cancel:{id:"enterpriseContactModal.cancel",defaultMessage:"Cancel"},ineligibleForSales:{id:"enterpriseContactModal.companySize.error.label",defaultMessage:"The company size selected is not eligible for a sales assisted plan. Please message support if you have any questions."},yourQuestion:{id:"enterpriseContactModal.yourQuestion.title",defaultMessage:"Your question"},selectQuestion:{id:"enterpriseContactModal.selectQuestion.label",defaultMessage:"Select question"},setupTrial:{id:"enterpriseContactModalQuestionSelect.question.setup_trial",defaultMessage:"Setup an enterprise trial"},setupBusinessTrial:{id:"contactModalQuestionSelect.question.setup_business_trial",defaultMessage:"Setup a business trial"},liveDemo:{id:"enterpriseContactModalQuestionSelect.question.live_demo",defaultMessage:"Schedule a live demo"},planHelp:{id:"enterpriseContactModalQuestionSelect.question.plan_help",defaultMessage:"Need help choosing a plan"},other:{id:"enterpriseContactModalQuestionSelect.question.other",defaultMessage:"Other"},ineligibleCompanySize:{id:"enterpriseContactModalQuestionSelect.ineligibleCompanySize",defaultMessage:"We don't currently support sales-assisted plans for your company size."},ineligibleContactSupport:{id:"enterpriseContactModalQuestionSelect.ineligibleContactSupport",defaultMessage:"Check out eligible plans by dismissing this window or email us at support@makenotion.com if you have any questions."}}),o=(0,n.defineMessages)({lessThanOneHundred:{id:"enterpriseContactModal.initial.lessThan100Label",defaultMessage:"<100"},oneToThreeHundred:{id:"enterpriseContactModal.initial.100_299Label",defaultMessage:"100-299"},threeHundredToTwoThousand:{id:"enterpriseContactModal.initial.300_1999Label",defaultMessage:"300-1,999"},twoThousand:{id:"enterpriseContactModal.initial.2000PlusLabel",defaultMessage:"2,000+"}}),a={setup_enterprise_trial:i.setupTrial,setup_business_trial:i.setupBusinessTrial,live_demo:i.liveDemo,plan_help:i.planHelp,other:i.other}},8438:(e,t,s)=>{s.d(t,{T:()=>n});const n=["setup_enterprise_trial","setup_business_trial","live_demo","plan_help","other"]},43163:(e,t,s)=>{s.d(t,{W:()=>r,o:()=>a});s(67294);var n=s(9291),i=s(1898),o=s(85893);function a(e){switch(e){case"team_three_months":case"ai_fifty_percent":return(0,o.jsx)(n.FormattedMessage,{id:"coupon.percentage.fiftyPercent",defaultMessage:"50%"});case"team_annual":case"business_three_months":case"business_annual":case"enterprise_three_months":case"enterprise_annual":return(0,o.jsx)(n.FormattedMessage,{id:"coupon.percentage.tenPercent",defaultMessage:"10%"});default:(0,i.t1)(e)}}function r(e){switch(e){case"team_annual":case"business_annual":case"enterprise_annual":return(0,o.jsx)(n.FormattedMessage,{id:"coupon.duration.twelveMonths",defaultMessage:"12 months"});case"team_three_months":case"business_three_months":case"enterprise_three_months":case"ai_fifty_percent":return(0,o.jsx)(n.FormattedMessage,{id:"coupons.duration.threeMonths",defaultMessage:"3 months"})}}},95014:(e,t,s)=>{s.r(t),s.d(t,{getStripe:()=>S,injectStripe:()=>y,isBillingUsingSendInvoice:()=>j,translateStripeError:()=>M,useElementsOptions:()=>b});var n=s(86664),i=s(97894),o=s(67294),a=s(86628),r=s(24405),l=s(24211),d=s(2438),c=s(1898),u=s(37810),p=s(86572),m=s(95477),g=s(80444),h=s(70060),f=s(85893);let x=null;function y(e){return t=>{const[s]=o.useState(S);return(0,f.jsx)(n.Elements,{stripe:s,children:(0,f.jsx)(n.ElementsConsumer,{children:s=>{let{stripe:n,elements:i}=s;const o={...t,stripe:n,elements:i};return(0,f.jsx)(e,{...o})}})})}}async function S(){return x||(i.loadStripe.setLoadParameters({advancedFraudSignals:!1}),x=(0,i.loadStripe)(m.default.stripe.key)),x}function v(e){switch(e){case"en-US":return"en";case"ko-KR":return"ko";case"ja-JP":return"ja";case"fr-FR":return"fr-FR";case"de-DE":return"de";case"es-ES":return"es-ES";case"es-LA":return"es-419";case"pt-BR":return"pt-BR";case"zh-CN":return"zh";case"zh-TW":return"zh-TW";case"da-DK":return"da";case"nl-NL":return"nl";case"fi-FI":return"fi";case"nb-NO":return"nb";case"sv-SE":return"sv";default:return"auto"}}function b(e){const t=(0,r.Fg)(),{type:s}=e,n="setup"===s||"subscription"===s?e.currency:void 0,i="subscription"===s?e.amount:void 0,p=(0,a.VK)((()=>{var e;return(null===(e=g.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.preferred_locale)||l.al}),[]),m=(0,a.VK)((()=>{const e={},t="EUR"===n&&h.rq();return t&&(e.paymentMethodTypes=(0,d.Rb)({currency:n,isSepaEnabled:t})),e}),[n]);return(0,o.useMemo)((()=>{const e=function(e){return{labels:"floating",theme:"dark"===e.mode?"night":"stripe",variables:{spacingGridRow:"8px",spacingGridColumn:"8px",spacingUnit:"2px",spacingTab:"4px",colorPrimary:e.text.primary,colorPrimaryText:e.text.primary,colorText:e.text.primary,colorTextSecondary:e.text.secondary,colorTextPlaceholder:e.text.tertiary,colorIcon:e.text.primary,colorIconCheckmark:e.icon.contrast,colorDanger:e.text.uiRedPrimary,colorBackground:e.whiteButtonBackground,colorIconTabHover:e.text.primary,colorIconTabSelected:e.text.uiBluePrimary,colorIconChevronDown:e.text.primary,fontFamily:u.Z.baseFontFamily.sans,fontWeightLight:`${u.Z.fontWeight.light}`,fontWeightNormal:`${u.Z.fontWeight.regular}`,fontWeightMedium:`${u.Z.fontWeight.medium}`,fontWeightBold:`${u.Z.fontWeight.semibold}`,fontSizeBase:"14px",fontSizeSm:"12px",colorLogo:e.mode,colorLogoBlock:e.mode,colorLogoTab:e.mode,colorLogoTabSelected:e.mode,borderRadius:"4px"},rules:{".Tab":{padding:"10px 16px 10px 10px",fontSize:"13px",fontWeight:"510",lineHeight:"16px",color:e.text.primary,border:`1px solid ${e.stroke.regular}`,boxShadow:"none",backgroundColor:e.whiteButtonBackground},".Tab:hover":{backgroundColor:e.whiteButtonHoveredBackground,color:e.text.primary},".Tab:focus":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.stroke.regular}`,boxShadow:e.outlineBlueInputBoxShadow},".Tab--selected, .Tab--selected:hover, .Tab--selected:active":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.stroke.uiBlue}`,color:e.text.primary,boxShadow:"none",outline:"none"},".Tab--selected:focus":{border:`1px solid ${e.stroke.uiBlue}`,boxShadow:e.outlineBlueInputBoxShadow},".Input":{fontSize:"14px",lineHeight:"18px",letterSpacing:"-0.154px",padding:"4px 8px",boxShadow:"none",backgroundColor:e.surface.wash,border:`1px solid ${e.stroke.regular}`,cursor:"text",color:e.text.primary},".Input--invalid":{border:"none",color:e.text.primary,boxShadow:e.outlineRedInputBoxShadow},".Label":{fontSize:"14px",lineHeight:"18px",letterSpacing:"-0.154px",color:e.text.tertiary},".Label--floating":{fontSize:"10px",fontWeight:"590",lineHeight:"13px",letterSpacing:"0.12px",marginTop:"4px",transition:"all 200ms ease",color:e.text.secondary},".Error":{fontSize:"12px",fontWeight:"400",lineHeight:"15px",color:e.text.uiRedPrimary},".CodeInput":{backgroundColor:e.surface.wash,border:`1px solid ${e.stroke.regular}`,boxShadow:"none"},".PickerItem, .PickerItem--selected":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.stroke.regular}`,boxShadow:"none",color:e.text.primary},".PickerItem:hover, .PickerItem--selected:hover":{backgroundColor:e.whiteButtonHoveredBackground,color:e.text.primary,border:`1px solid ${e.stroke.regular}`,boxShadow:"none"},".PickerItem--new":{fontSize:"14px",fontWeight:"500",lineHeight:"18px",color:e.text.primary},".PickerItem--highlight, .PickerItem--highlight:hover":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.stroke.uiBlue}`,boxShadow:"none"},".PickerItem--highlight:hover":{backgroundColor:e.whiteButtonHoveredBackground},".TermsText":{color:e.text.secondary,fontSize:"12px",fontWeight:"400",lineHeight:"15px"},".CheckboxLabel":{color:e.text.primary,fontSize:"12px",fontWeight:"500",lineHeight:"15px"},".Action, .MenuAction":{color:e.text.primary,fontWeight:"400"},".Action:hover, .MenuAction:hover":{backgroundColor:e.buttonHoveredBackground},".BlockAction:focus, .CodeInput:focus, .Input:focus,.CheckboxInput:focus, .PickerItem:focus, .PickerAction:focus,.MenuAction:focus, .Action:focus, .SecondaryLink:focus":{boxShadow:e.outlineBlueInputBoxShadow},".MenuIcon, .MenuIcon:hover":{fill:e.text.primary},".Block":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.stroke.regular}`,boxShadow:"none",color:e.text.primary}}}}(t),o={appearance:e,locale:v(p)};switch(s){case"address":return o;case"setup":return{...o,currency:null==n?void 0:n.toLowerCase(),mode:"setup",paymentMethodCreation:"manual"};case"subscription":return{...o,...m,amount:i,currency:null==n?void 0:n.toLowerCase(),mode:"subscription",paymentMethodCreation:"manual",setupFutureUsage:"off_session"};default:(0,c.t1)(s)}}),[t,p,s,n,i,m])}function M(e,t,s){if(!s.code)return s.message||"";switch(p._q(e,{error:s.code,stripe_decline_code:s.decline_code}),s.code){case"invalid_expiry_year_past":return t.formatMessage({id:"stripeHelpers.invalidExpiryYear.error.message",defaultMessage:"Your card's expiration year is in the past."});case"invalid_cvc":return t.formatMessage({id:"stripeHelpers.invalidCVC.error.message",defaultMessage:"Your card's security code is invalid."});case"invalid_number":return t.formatMessage({id:"stripeHelpers.invalidNumber.error.message",defaultMessage:"Your card number is not a valid credit card number."});case"card_declined":return function(e,t){switch(t){case"expired_card":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.expiredCard",defaultMessage:"Your card was declined because it is an expired card."});case"incorrect_number":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.incorrectNumber",defaultMessage:"Your card was declined because you input an incorrect number."});case"insufficient_funds":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.declinedFunds",defaultMessage:"Your card was declined because of insufficient funds."});case"invalid_cvc":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.invalidCvc",defaultMessage:"Your card was declined because you input an invalid CVC number"});case"invalid_amount":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.invalidAmount",defaultMessage:"Your card was declined because payment amount exceeds the amount that's allowed."});default:return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message",defaultMessage:"Your card was declined."})}}(t,s.decline_code);default:return s.message||""}}function j(e){return e.isSubscribed&&"send_invoice"===e.billing}},76088:(e,t,s)=>{s.d(t,{P:()=>a});var n=s(67294),i=s(480),o=s(54642);function a(){const e=(0,i.O7)(),[t,s]=(0,n.useState)();return(0,n.useEffect)((()=>{!async function(){const t=await o.getExternalOrgData(e,{});if("failed"===t.type)return!1;const n=t.data;s("company_employee_count"in n&&parseInt(n.company_employee_count)>99)}()}),[e]),t}},15418:(e,t,s)=>{s.r(t),s.d(t,{CreateTeamFromPageConfirmModal:()=>f});s(67294);var n=s(480),i=s(24405),o=s(62208),a=s(9291),r=s(37810),l=s(63296),d=s(58297),c=s(92660),u=s(29551),p=s(73466),m=s(66214),g=s(80068),h=s(85893);function f(){const e=(0,n.O7)(),t=(0,a.useIntl)(),s=(0,i.yK)((e=>({modal:{maxWidth:350,padding:24},loopIcon:{height:28,width:28,fill:e.darkTextColor},infoIcon:{height:16,width:16,fill:e.lightIconColor,marginRight:4},title:{marginTop:16,marginBottom:12,color:e.regularTextColor,fontWeight:r.Z.fontWeight.semibold,fontSize:18},description:{color:e.darkTextColor,textAlign:"center",fontSize:14,marginBottom:18},confirmButton:{width:"100%",marginBottom:8},cancelButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:14}})),[]);return(0,h.jsx)(c.Z,{onDismiss:()=>{m.Z.setState({open:!1})},render:()=>(0,h.jsx)("div",{style:s.modal,children:(0,h.jsxs)(u.gq,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,o.z)(s.loopIcon),(0,h.jsx)("div",{style:s.title,children:(0,h.jsx)(a.FormattedMessage,{id:"createTeamFromPage.confirmModal.title",defaultMessage:"Turn into teamspace?"})}),(0,h.jsx)("div",{style:s.description,children:(0,h.jsx)(a.FormattedMessage,{id:"createTeamFromPage.confirmModal.description",defaultMessage:"This will move this page into a newly created teamspace along with people who already have access to this page."})}),(0,h.jsx)(d.Z,{isLarge:!0,style:s.confirmButton,onClick:()=>{if(m.Z.state.open){const{pageStore:s,flowId:n}=m.Z.state;p.Sq({environment:e,intl:t,page:s,flowId:n}),m.Z.setState({open:!1})}},children:(0,h.jsx)(a.FormattedMessage,{id:"createTeamFromPage.confirmModal.confirmButton",defaultMessage:"Create teamspace"})}),(0,h.jsx)(l.Z,{isLarge:!0,style:s.cancelButton,onClick:()=>m.Z.setState({open:!1}),children:(0,h.jsx)(a.FormattedMessage,{id:"createTeamFromPage.confirmModal.cancelButton",defaultMessage:"Cancel"})}),(0,h.jsx)(g.Z,{message:(0,h.jsx)(a.FormattedMessage,{id:"createTeamFromPage.confirmModal.learnMore",defaultMessage:"Learn more about teamspaces"}),analyticsFrom:"teams_learn_more_turn_page_into_team",helpCenterLocation:"bestPractices"})]})}),requireOnline:!0,modalStore:m.Z})}},39538:(e,t,s)=>{s.r(t),s.d(t,{OutlinerTeamOverflow:()=>ne,TeamOverflowMenu:()=>ie});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(85397),l=s(52867),d=s(9767),c=s(56666),u=s(88437),p=s(13797),m=s(19981),g=s(45238),h=s(85893);const f=(0,g.IU)("personAdmin",{viewBox:"0 0 15 16",svg:(0,h.jsx)("path",{d:"M6.082 7.215a2.71 2.71 0 001.504-.438c.451-.296.811-.69 1.08-1.182a3.352 3.352 0 00.403-1.634 3.21 3.21 0 00-.403-1.6 3.059 3.059 0 00-1.08-1.141A2.776 2.776 0 006.082.796c-.547 0-1.048.143-1.504.43a3.153 3.153 0 00-1.087 1.156 3.195 3.195 0 00-.403 1.593 3.39 3.39 0 00.41 1.627c.269.487.629.88 1.08 1.175a2.71 2.71 0 001.504.438zm0-1.19c-.314 0-.606-.088-.875-.266a1.974 1.974 0 01-.636-.738 2.247 2.247 0 01-.239-1.046c0-.379.08-.718.24-1.019.159-.3.37-.538.635-.71.264-.179.556-.267.875-.267.319 0 .61.086.875.26.264.172.476.41.636.71.16.296.239.634.239 1.012 0 .387-.08.738-.24 1.053-.159.31-.37.556-.635.738a1.508 1.508 0 01-.875.273zm-4.266 7.54h5.948a3.113 3.113 0 01-.082-.752v-.43H1.59c-.082 0-.141-.014-.178-.041-.032-.027-.048-.073-.048-.137 0-.26.105-.56.315-.902.21-.342.512-.673.909-.992.4-.323.893-.59 1.476-.8.588-.213 1.26-.32 2.017-.32a5.648 5.648 0 011.92.328c.17-.42.466-.732.89-.937a6.605 6.605 0 00-1.313-.417 6.856 6.856 0 00-1.497-.157c-.92 0-1.75.139-2.488.417-.739.273-1.372.631-1.9 1.073-.525.442-.928.918-1.21 1.429-.279.51-.418.998-.418 1.463 0 .784.584 1.175 1.75 1.175zm6.843-.731c0 .438.091.804.274 1.1.182.297.469.58.861.848.392.274.907.588 1.545.944a.6.6 0 00.294.082.62.62 0 00.335-.082c.638-.36 1.153-.675 1.545-.944.392-.269.679-.551.861-.847.182-.297.274-.664.274-1.101v-2.468a.979.979 0 00-.137-.54c-.087-.141-.24-.26-.458-.355a17.47 17.47 0 00-.417-.15c-.182-.069-.38-.14-.595-.213-.21-.077-.403-.145-.581-.205a13.002 13.002 0 01-.403-.15 1.263 1.263 0 00-.417-.055c-.146 0-.292.028-.438.082-.077.028-.205.07-.383.13l-.574.198c-.205.073-.399.144-.58.212-.183.064-.32.114-.411.15-.219.096-.374.215-.465.356a1.02 1.02 0 00-.13.54v2.468zm2.598 1.326a.601.601 0 01-.212-.04.416.416 0 01-.178-.124l-1.155-1.244a.671.671 0 01-.096-.178.492.492 0 01-.034-.178c0-.145.048-.264.144-.355a.492.492 0 01.341-.13.485.485 0 01.363.15l.793.869 1.613-2.229a.484.484 0 01.41-.219c.132 0 .246.048.342.144.1.091.15.205.15.342 0 .04-.009.086-.027.136a.463.463 0 01-.075.15l-1.983 2.722c-.086.123-.218.184-.396.184z"})});var x=s(47453);const y=(0,g.IU)("restore",{viewBox:"0 0 18 15",svg:(0,h.jsx)("path",{d:"M8.61427 3.17871C8.292 3.17871 8.02833 3.43506 8.02833 3.75732L8.02833 7.84424C8.02833 8.0127 8.0796 8.15918 8.20411 8.32031L10.0132 10.708C10.2549 11.0229 10.5918 11.0742 10.8921 10.8691C11.1631 10.6787 11.1851 10.3345 10.9653 10.0342L8.52638 6.74561L9.19288 8.79639L9.19288 3.75732C9.19288 3.43506 8.93654 3.17871 8.61427 3.17871ZM8.89259 0C5.28907 0 2.22755 2.62939 1.56105 6.05713L0.521008 6.05713C-0.00633599 6.05713-0.138172 6.41602 0.147473 6.82617L1.7881 9.15527C2.0298 9.49219 2.38136 9.48486 2.61573 9.15527L4.25636 6.81885C4.53468 6.41602 4.40284 6.05713 3.88282 6.05713L2.82814 6.05713C3.45802 3.28857 5.91896 1.25244 8.89259 1.25244C10.98 1.25977 12.811 2.26318 13.9317 3.82324C14.1514 4.12354 14.5029 4.21875 14.8032 4.02832C15.1035 3.85254 15.1841 3.44971 14.9351 3.12744C13.5435 1.25977 11.3609 0 8.89259 0ZM8.89259 14.9414C12.4961 14.9414 15.5576 12.3047 16.2241 8.88428L17.2568 8.88428C17.7842 8.88428 17.9234 8.52539 17.6304 8.11523L15.9971 5.78613C15.7554 5.44922 15.4038 5.45654 15.1694 5.78613L13.5288 8.12256C13.2432 8.52539 13.3823 8.88428 13.9024 8.88428L14.9644 8.88428C14.3272 11.6455 11.8589 13.6963 8.89259 13.6963C6.80519 13.689 4.97413 12.6782 3.85353 11.1182C3.62648 10.8179 3.28224 10.7227 2.97462 10.9058C2.68165 11.0889 2.60109 11.4917 2.85011 11.814C4.24171 13.6816 6.42433 14.9414 8.89259 14.9414Z"})});var S=s(5108),v=s(47425),b=s(64684),M=s(9291),j=s(1898),C=s(62967),w=s(17224),k=s(37181),T=s(93405),I=s(48019),Z=s(64921),P=s(31945),F=s(78140),A=s(72495),_=s(26388),R=s(43250),O=s(60709),B=s(35026),D=s(95697),L=s(77907),V=s(55838),N=s(80444),E=s(61766),U=s(33052),W=s(73466),K=s(9867);function z(e){let{adminStatus:t,accessLevel:s,isArchivedTeam:n}=e;if("adminThatCanPerformPrivilegedActions"===t)return new Set(["join","joinAsOwner"]);if(n)switch(t){case"none":return new Set;case"admin":return new Set("open"===s?["join"]:[]);default:(0,j.t1)(t)}switch(s){case"open":return new Set(["join"]);case"closed":case"private":return new Set;default:(0,j.t1)(s)}}var q=s(82740),G=s(73365),H=s(30297),Y=s(11628),Q=s(97082),$=s(64552),J=s(31931);const X=["addPages","join","view","add","duplicate","leave","archive","restore"],ee=["addPages","add"],te=["join","joinAsOwner","upgradeSelfToOwner","leave"],se=(0,M.defineMessages)({add:{defaultMessage:"Add members",id:"sidebar.outlinerTeamToggleButton.addLabel"},leave:{defaultMessage:"Leave teamspace",id:"sidebar.outlinerTeamToggleButton.leaveLabel"},joinAsOwner:{defaultMessage:"Join as owner",id:"sidebar.outlinerTeamToggleButton.joinAsOwnerLabel"},joinAsMember:{defaultMessage:"Join as member",id:"sidebar.outlinerTeamToggleButton.joinAsMemberLabel"},joinTeamspace:{defaultMessage:"Join teamspace",id:"sidebar.outlinerTeamToggleButton.joinLabel"},upgradeSelfToOwner:{defaultMessage:"Become owner",id:"sidebar.outlinerTeamToggleButton.upgradeSelfToOwnerLabel"},archive:{defaultMessage:"Archive teamspace",id:"sidebar.outlinerTeamToggleButton.archiveLabel"},restore:{defaultMessage:"Restore teamspace",id:"outlinerTeamOverflow.teamActions.restoreLabel"},duplicate:{defaultMessage:"Duplicate teamspace",id:"sidebar.outlinerTeamToggleButton.duplicateLabel"},teamspaceSettings:{defaultMessage:"Teamspace settings",id:"sidebar.outlinerTeamToggleButton.ownerViewLabel"},viewMembers:{defaultMessage:"View members",id:"sidebar.outlinerTeamToggleButton.unjoinedMemberViewLabel"},appTemplates:{defaultMessage:"Add pages",id:"sidebar.outlinerTeamToggleButton.addPages"}});function ne(e){let{teamStore:t,style:s,from:n,hideJoin:r,onPopupClick:l,onPopupClose:d}=e;const u=(0,i.Fy)(),p=(0,M.useIntl)(),m=(0,o.qz)(void 0,U.Z),g=(0,o.VK)((()=>N.default.state.currentSpaceStore),[]),f=(0,o.qz)(void 0,E.Z),x=(0,a.yK)((e=>({buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,height:20,width:20,...s},icon:{fill:e.sidebarTextColor,width:14,height:14}})),[s]),y=p.formatMessage({defaultMessage:"Teamspace settings and members...",id:"sidebar.outlinerTeamToggleButton.tooltip"});return g?u.isMobile?null:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(_.ZP,{textWrap:!1,renderTooltip:()=>y,placement:_.ug.Bottom,render:e=>(0,h.jsx)(P.ZP,{popupType:P.Z4.Popup,buttonPopupStore:f,alignmentToOrigin:P.vR.Start,originGap:2,renderOrigin:t=>(0,h.jsx)(Z.Z,{ariaLabel:y,className:R.qxR,style:x.buttonStyle,mobileFeedback:!1,...e,...t,children:(0,c.o)(x.icon)}),render:e=>(0,h.jsx)(ie,{teamStore:t,permissionsInviteStore:m,onDismiss:e.close,from:n,hideJoin:r,buttonPopupStore:f}),onClick:l,onClose:d})}),(0,h.jsx)(L.LazyTeamPermissionsInviteWithModal,{permissionsInviteStore:m,store:t})]}):null}function ie(e){const{teamStore:t,permissionsInviteStore:s,onDismiss:c,from:g,hideJoin:Z,buttonPopupStore:P}=e,L=(0,a.Fg)(),E=(0,i.O7)(),U=(0,a.yK)((()=>({menuItemButton:{minWidth:200},caption:{minWidth:230}})),[]),ne=(0,o.VK)((()=>N.default.state.currentSpaceStore),[]),ie=(0,$.e)(t),oe=(0,o.VK)((()=>(0,b.m4)({archived_by:t.getArchivedBy()})),[t]),ae=E.currentUser.id,re=(0,o.VK)((()=>ae?t.getTeamRoleForUser(ae)??"none":"none"),[ae,t]),le=(0,o.VK)((()=>!(!t.isDefined()||!ae)&&Boolean(t.isOwner(ae))),[ae,t]),de=(0,Q.y)(t.id),ce=(0,q.e)(t),{id:ue,name:pe,isDefault:me}=(0,o.VK)((()=>({id:t.id,name:t.getName(),isDefault:t.isDefault()})),[t]),ge=(0,G.n)(ne),he=(0,o.VK)((()=>(0,D.Xq)({environment:E,spaceStore:ne})),[ne,E]),fe=(0,H.r)(g),xe=function(e){const{isDefault:t,accessLevel:s,settings:n}=(0,o.VK)((()=>({isDefault:e.isDefault(),accessLevel:e.getTeamAccessLevel(),settings:e.getSettings()})),[e]),i="private"===s,a=(0,Y.P)(),r=i&&!a?"business":void 0,l=(null==n?void 0:n.disable_public_access)||(null==n?void 0:n.disable_export)||(null==n?void 0:n.disable_guests),d=(0,Y.z)(),c=l&&!d?"enterprise":void 0,u=(0,v.bo)([c,r]);if(t)return"isDefault";if(u)return u}(t),ye="isDefault"===(Se=xe)?(0,h.jsx)(M.FormattedMessage,{id:"sidebar.outlinerTeamToggleButton.cannotDuplicateDefaultTeamspace",defaultMessage:"Cannot duplicate a default teamspace"}):"business"===Se?(0,h.jsx)(M.FormattedMessage,{id:"sidebar.outlinerTeamToggleButton.cannotDuplicateTeamspaceWithBusinessFeaturesOnDowngradedAccount",defaultMessage:"Cannot duplicate a teamspace with settings only allowed on Business plans or above"}):"enterprise"===Se?(0,h.jsx)(M.FormattedMessage,{id:"sidebar.outlinerTeamToggleButton.cannotDuplicateTeamspaceWithEnterpriseFeaturesOnDowngradedAccount",defaultMessage:"Cannot duplicate a teamspace with settings only allowed on Enterprise plans or above"}):void 0===Se?void 0:(0,j.t1)(Se);var Se;const ve=(0,o.VK)((()=>t.getTeamAccessLevel()),[t]),be=(0,n.useCallback)((e=>{w.z(E,{store:t,from:g,option:e})}),[E,t,g]),Me=de&&!ge,je=(0,o.VK)((()=>Boolean(null==ne?void 0:ne.canAdmin())),[ne]),{joinLeaveOptionsToShow:Ce,leaveOptionDisabledState:we}=function(e){let{teamRole:t,adminStatus:s,isDefaultTeam:n,accessLevel:i,isArchivedTeam:o}=e;switch(t){case"owner":case"member":const e=new Set,a=!o;return a&&e.add("leave"),"owner"!==t&&"adminThatCanPerformPrivilegedActions"===s&&e.add("upgradeSelfToOwner"),{joinLeaveOptionsToShow:e,leaveOptionDisabledState:a&&n?{disabled:!0,disabledReasonKey:"defaultTeam"}:void 0};case"team_level_guest":return{joinLeaveOptionsToShow:new Set,leaveOptionDisabledState:void 0};case"none":return{joinLeaveOptionsToShow:z({adminStatus:s,accessLevel:i,isArchivedTeam:o}),leaveOptionDisabledState:void 0};default:(0,j.t1)(t)}}({teamRole:re,adminStatus:fe?"adminThatCanPerformPrivilegedActions":je?"admin":"none",isArchivedTeam:oe,isDefaultTeam:me,accessLevel:ve}),ke=(0,J.Z)({teamStore:t,from:"sidebar_team_overflow"}),Te=(0,o.VK)((()=>(0,B.si)({environment:E,teamStore:t})),[E,t]),Ie=Ce.has("joinAsOwner"),Ze=fe&&!(1===Ce.size&&Ce.has("leave")),Pe={add:{type:"action",show:!oe&&ce,handle:()=>{s.update((e=>({...e,modalOpen:!0})))},title:se.add,icon:(0,r.a)({width:17})},leave:{type:"action",...Ze&&{colorOverride:L.redBadgeBackground},show:Ce.has("leave"),handle:()=>{K.s({environment:E,teamStore:t,currentSpaceStore:ne,from:g})},title:se.leave,disabled:Boolean(null==we?void 0:we.disabled),icon:(0,m.V)({width:17}),disabledTooltipText:"defaultTeam"===(null==we?void 0:we.disabledReasonKey)&&(0,h.jsx)(M.FormattedMessage,{id:"sidebar.outlinerTeamToggleButton.cannotLeaveDefaulTeamTooltip",defaultMessage:"Cannot leave a default teamspace"})},join:{type:"action",show:!Z&&Ce.has("join"),handle:async()=>{if(ne)switch(ve){case"open":await K.um({environment:E,teamStore:t,currentSpaceStore:ne,from:g,andNavigateToTeamHome:!1});break;case"closed":case"private":await K.wT({environment:E,teamStore:t,currentSpaceStore:ne,from:g,action:"joinClosedOrPrivateTeamAsMember"});break;default:(0,j.t1)(ve)}},title:Ie?se.joinAsMember:se.joinTeamspace,icon:(0,x.R)({width:17})},joinAsOwner:{type:"action",show:Ie,handle:()=>K.wT({environment:E,teamStore:t,currentSpaceStore:ne,from:g,action:"joinTeamAsOwner"}),title:se.joinAsOwner,icon:f({width:17})},upgradeSelfToOwner:{type:"action",show:Ce.has("upgradeSelfToOwner"),handle:()=>K.wT({environment:E,teamStore:t,currentSpaceStore:ne,from:g,action:"upgradeToOwner"}),title:se.upgradeSelfToOwner,icon:f({width:17})},archive:{type:"action",show:!oe&&le,colorOverride:L.redBadgeBackground,handle:()=>{!Me&&K.aQ({teamStore:t,environment:E,from:g})},title:se.archive,disabled:Me,disabledTooltipText:(0,h.jsx)("div",{style:{whiteSpace:"normal"},children:(0,h.jsx)(M.FormattedMessage,{id:"sidebar.outlinerTeamToggleButton.cannotArchiveTooltip.moreThanOneMember",defaultMessage:"There must only be one member in the workspace to archive this teamspace"})}),icon:(0,l.H)({width:17})},restore:{type:"action",show:oe,handle:()=>{le&&K.YH({environment:E,teamStore:t,teamName:pe,from:g})},title:se.restore,icon:y({width:17}),disabled:!le,disabledTooltipText:(0,h.jsx)(M.FormattedMessage,{id:"outlinerTeamOverflow.restoreArchivedTeam.disabledTooltipText",defaultMessage:"Only teamspace owners can restore archived teamspaces."})},duplicate:{type:"action",show:!oe&&he,handle:()=>{W.tW({environment:E,teamStore:t,from:g,buttonPopupStore:P})},title:se.duplicate,disabled:void 0!==xe,icon:(0,u.a)({width:17}),disabledTooltipText:ye,caption:(0,h.jsx)(M.FormattedMessage,{id:"sidebar.outlinerTeamToggleButton.duplicateCaption",defaultMessage:"Duplicates permissions and other settings but not pages and members"})},view:{type:"action",show:!oe||"manage_teams_table"===g,handle:()=>K.RF({environment:E,teamId:ue,tab:V.a.Members,from:g}),title:ie?se.teamspaceSettings:se.viewMembers,icon:ie?(0,p.F)({width:15}):(0,S.n)({width:17})},addPages:{type:"extensionAction",show:"teamSidebar"===g&&Te,title:se.appTemplates,icon:(0,d.s)({width:17}),subActionSections:ke}},Fe=(Ze?[{sectionName:"join/leave section",orderedOptions:te},{sectionName:"other actions",orderedOptions:X.filter((e=>!te.includes(e)))}]:[{sectionName:"add section",orderedOptions:ee},{sectionName:"other actions section",orderedOptions:X.filter((e=>!ee.includes(e)))}]).map((e=>{const t=e.orderedOptions.filter((e=>Pe[e].show));if(0!==t.length)return{sectionName:e.sectionName,filteredOptions:t}})).filter(j.$K).map((e=>{const t=e.filteredOptions.map((e=>{const t=Pe[e],{type:s}=t;return"action"===s?(0,C.cN)({key:e,displayName:t.title,analyticsName:t.title.defaultMessage,svg:()=>t.icon,validators:[],closeParentMenu:!0,action:()=>{c(),be(e),t.handle()},render:e=>(0,h.jsx)(_.ZP,{placement:_.ug.Left,textWrap:!1,disableTooltip:!(t.disabled&&t.disabledTooltipText),renderTooltip:()=>t.disabledTooltipText,render:s=>(0,h.jsx)(T.Z,{...e,...s,svg:()=>t.icon,title:(0,h.jsx)(M.FormattedMessage,{...t.title}),buttonStyle:{...U.menuItemButton,...!t.disabled&&t.colorOverride?{fill:t.colorOverride,color:t.colorOverride}:{fill:L.regularIconColor,color:L.regularTextColor}},disabled:t.disabled,disabledFeedback:t.disabled,caption:t.caption,captionStyle:U.caption,shouldWrapCaption:!0})})}):"extensionAction"===s?(0,C.MV)({key:e,displayName:t.title,analyticsName:t.title.defaultMessage,svg:()=>t.icon,width:250,validators:[],subActions:()=>t.subActionSections.map((t=>({...t,actions:t.actions.map((t=>({...t,action:s=>{c(),be(e),t.action(s)}})))})))}):void(0,j.t1)(s)}));return(0,C.$J)({key:e.sectionName,render:e=>(0,h.jsx)(A.Z,{...e}),actions:t})}));return(0,n.useEffect)((()=>{k.$n({environment:E,teamId:t.id})}),[E,t.id]),(0,h.jsx)(F.Z,{className:R.Mdu,menuType:O.og.Popup,minWidth:"100%",children:(0,h.jsx)(I.Z,{context:{blocks:[],environment:E,publicEditMode:void 0},sections:Fe,initialFocus:void 0})})}},14982:(e,t,s)=>{s.r(t),s.d(t,{SidebarCreateTeamModal:()=>te});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(41892),l=s(64275),d=s(49364),c=s(9291),u=s(53965),p=s(1898),m=s(37810),g=s(17224),h=s(64921),f=s(74194),x=s(3386),y=s(68785),S=s(50506),v=s(64369),b=s(45653),M=s(13490),j=s(33929),C=s(48779),w=s(95697),k=s(68418),T=s(80444),I=s(6258),Z=s(33052),P=s(9867),F=s(58297),A=s(78122),_=s(35057),R=s(73466),O=s(80068),B=s(85893);function D(){const e=(0,i.O7)(),{currentSpaceStore:t,spaceViewStore:s}=(0,o.VK)((()=>({currentSpaceStore:T.default.state.currentSpaceStore,spaceViewStore:T.default.state.currentSpaceViewStore})),[]),r=(0,o.VK)((()=>k.Z.state),[]),l=(0,w.OX)(),d=function(){const e=(0,o.VK)((()=>_.Mk()&&!k.Z.state.isDefault),[]),t=k.F.Team,s=k.F.Members;return e?[t,s]:[t]}(),{screen:m,pageNumber:g,teamId:h}=r,f=""===r.name,x=(0,a.yK)((e=>({box:{justifyContent:"space-between",alignItems:"center",display:"flex",width:"100%",paddingTop:22},button:{marginLeft:8},previous:{fontSize:14,color:e.mediumTextColor,cursor:"pointer"},learnMoreLink:{overflow:"hidden"}})),[]),y=(0,n.useCallback)(((s,n)=>{t&&function(e){let{pageOrder:t,pageNumber:s,teamId:n,currentSpaceStore:i,environment:o,from:a}=e;const r=s+1;if(r<=t.length)k.Z.update((e=>({...e,loading:!1,screen:t[r-1],pageNumber:r})));else if(n){const e=I.zX.createChildStore(i,{table:"team",id:n,spaceId:i.id});P.hI({environment:o,teamStore:e,shouldScroll:!0}),P.ED({environment:o,from:a,teamStore:e})}}({pageOrder:d,pageNumber:g,teamId:n||h,currentSpaceStore:t,environment:e,from:s})}),[t,e,g,d,h]),S=u.Ds((async()=>{if(!t||!s)return;let n=h;switch(m){case k.F.Team:n=await async function(e){var t;let{spaceStore:s,environment:n,shouldShowZeroTeamsExperience:i,sidebarCreateTeamModalStoreState:o}=e;const{name:a,description:r,icon:l,flowId:d,accessLevel:c,isDefault:u}=o,p=await(0,A.Xg)({environment:n,spaceStore:s,teamName:a});if(!p)return;let m;k.Z.update((e=>({...e,loading:!0}))),m=i?await R.HD({environment:n,name:a,description:r,icon:l,flowId:d,trackCreateTeamComplete:!0}):await R.Cm({environment:n,name:a,description:r,icon:l,accessLevel:c,isDefault:u,flowId:d,createTeamHome:!0});if(!m)return;const g=null===(t=m)||void 0===t?void 0:t.id;return k.Z.update((e=>({...e,teamId:g}))),g}({spaceStore:t,environment:e,shouldShowZeroTeamsExperience:l,sidebarCreateTeamModalStoreState:r});break;case k.F.Members:break;default:(0,p.t1)(m)}n?y("success",n):k.Z.update((e=>({...e,loading:!1})))}),1e3,{leading:!0,trailing:!1}),v=(0,n.useCallback)(S,[S]);return(0,B.jsxs)("div",{style:x.box,children:[(0,B.jsx)(O.Z,{containerStyle:x.learnMoreLink,helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_sidebar_create_team_modal"}),(0,B.jsx)("div",{style:{display:"inline-flex"},children:(0,B.jsx)(F.Z,{isLarge:!0,onClick:v,disabled:f,style:x.button,children:(0,B.jsx)(c.FormattedMessage,{id:"sidebarCreateTeamModal.footer.createTeam",defaultMessage:"Create teamspace"})})})]})}var L=s(60701),V=s(38078),N=s(74016);const E={userSelect:"none",WebkitUserSelect:"none",position:"relative",padding:"22px 26px"},U={createTeamContainer:{...E,width:480},addMembersContainer:{...E,width:500},full:{width:"100%"}},W=(0,c.defineMessages)({teamNamePlaceholder:{id:"sidebarCreateTeamModal.teamScreen.namePlaceholder",defaultMessage:"Acme Labs"},teamDescriptionPlaceholder:{id:"sidebarCreateTeamModal.teamScreen.descriptionPlaceholder",defaultMessage:"Details about your teamspace"}});function K(){const[e,t]=(0,o.AF)(k.Z);return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(M.Z,{hasMarginTop:!0,children:(0,B.jsx)(c.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.teamDescriptionLabel",defaultMessage:"Description"})}),(0,B.jsx)(f.Z,{value:e.description,placeholder:j.default.formatMessage(W.teamDescriptionPlaceholder),textarea:!0,onChange:s=>{t({...e,description:s.target.value})}})]})}function z(e){return(0,B.jsx)("div",{id:e.titleAriaId,style:{fontSize:18,fontWeight:m.Z.fontWeight.semibold},children:(()=>{switch(e.screen){case k.F.Team:return(0,B.jsx)(c.FormattedMessage,{id:"sidebarCreateTeamModal.teamTitle.label",defaultMessage:"Create a new teamspace"});case k.F.Members:return(0,B.jsx)(c.FormattedMessage,{id:"sidebarCreateTeamModal.membersTitle.label",defaultMessage:"Add people"});default:(0,p.t1)(e.screen)}})()})}function q(e){const t=(0,i.O7)(),[s]=(0,o.AF)(k.Z),a=(0,n.useCallback)(((e,s)=>{P.ED({environment:t,from:s,teamStore:e})}),[t]),{screen:r}=s;switch(r){case k.F.Team:return(0,B.jsx)(Y,{titleAriaId:e.titleAriaId,descriptionAriaId:e.descriptionAriaId});case k.F.Members:const t=s.teamId;return t?(0,B.jsx)(J,{teamId:t,onCompleted:e=>{a(e,"success")},onCanceled:e=>{a(e,"dismiss_button")}}):null;default:(0,p.t1)(r)}}function G(){const[e,t]=(0,o.AF)(k.Z),s=(0,o.VK)((()=>T.default.state.currentSpaceStore),[]),n=(0,a.yK)((e=>({container:{display:"inline-flex",width:"100%",verticalAlign:"middle"},icon:{marginRight:8,marginTop:1}})),[]);if(!s)return null;const i=e.icon?{icon:e.icon,pointer:{table:"space",id:s.id}}:void 0;return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(M.Z,{hasMarginTop:!0,children:(0,B.jsx)(c.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.teamNameLabel",defaultMessage:"Icon & name"})}),(0,B.jsxs)("div",{style:n.container,children:[(0,B.jsx)(N.p,{icon:i,size:26,style:n.icon,onChange:s=>{t({...e,icon:s})},iconLoggingData:{recordTable:"team",source:"team_creation"}}),(0,B.jsx)(f.Z,{value:e.name,placeholder:j.default.formatMessage(W.teamNamePlaceholder),onChange:s=>{t({...e,name:s.target.value})},preventSafariAutofill:!0})]})]})}function H(e){const t=(0,a.yK)((()=>({})),[]);return(0,B.jsx)(v.Z,{id:e.descriptionAriaId,isMultiline:!0,isSmall:!0,isSecondaryColor:!0,style:t.description,children:(()=>{switch(e.screen){case k.F.Team:return(0,B.jsx)(c.FormattedMessage,{id:"sidebarCreateTeamModal.teamDescription.label",defaultMessage:"Teamspaces are where your team organizes pages, permissions, and members"});case k.F.Members:return null;default:(0,p.t1)(e.screen)}})()})}function Y(e){const[t]=(0,o.AF)(k.Z),s=(0,i.O7)();return(0,n.useEffect)((()=>{if(t.open){const{from:e,flowId:n}=t;g.kr(s,{from:e,flowId:n})}}),[]),(0,B.jsxs)("div",{style:U.createTeamContainer,children:[(0,B.jsx)(z,{titleAriaId:e.titleAriaId,screen:k.F.Team}),(0,B.jsx)(H,{descriptionAriaId:e.descriptionAriaId,screen:k.F.Team}),(0,B.jsxs)("div",{style:U.full,children:[(0,B.jsx)(G,{}),(0,B.jsx)(K,{}),(0,B.jsx)($,{})]}),(0,B.jsx)(D,{})]})}function Q(){const e=(0,o.VK)((()=>k.Z.state.loading),[]),t=(0,a.yK)((e=>({spinner:{width:"100%",height:"100%",backgroundColor:e.modalUnderlayBackground,position:"absolute",top:0,left:0}})),[]);return(0,B.jsx)(B.Fragment,{children:e&&(0,B.jsx)("div",{style:t.spinner,children:(0,B.jsx)(y.Z,{style:{position:"absolute",top:"50%",left:"50%"}})})})}function $(){const e=(0,a.yK)((e=>({openAccessMessage:{fontSize:13,color:e.mediumTextColor,marginTop:20,lineHeight:1.4,display:"flex"},iconContainer:{marginRight:8},openTeamIcon:{width:24,fill:e.mediumIconColor},teamAccessPopupContainer:{marginTop:20}})),[]),[t,s]=(0,o.AF)(k.Z),n=(0,w.OX)(),r=(0,i.O7)(),l=(0,o.VK)((()=>{const e=T.default.state.currentSpaceStore;return e?(0,C.rn)(r,e):"this workspace"}),[r]);return n?(0,B.jsxs)("div",{style:e.openAccessMessage,children:[(0,B.jsx)("div",{style:e.iconContainer,children:(0,d.R)(e.openTeamIcon)}),(0,B.jsx)(c.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.openAccessLabel",defaultMessage:"Everyone at {spaceName} and new members will have access to this teamspace",values:{spaceName:l}})]}):(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(M.Z,{hasMarginTop:!0,children:(0,B.jsx)(c.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.permissionsLabel",defaultMessage:"Permissions"})}),(0,B.jsx)(L._,{currentAccessLevel:t.accessLevel,currentIsDefault:t.isDefault,onChange:(e,n)=>{s(n?{...t,accessLevel:"open",isDefault:n}:{...t,accessLevel:e,isDefault:n})}})]})}function J(e){const t=(0,i.O7)(),[,,s]=(0,o.AF)(k.Z),[,,n]=(0,o.AF)(void 0,Z.Z);(0,o.VK)((()=>{const{defaultInviteTargets:e,flowId:t}=s.state;n.setState({...n.state,flowId:t}),e&&n.setState({...n.state,isInviteTargetsEmpty:!1,inviteTargets:e})}),[s,n]);const a=(0,o.VK)((()=>T.default.state.currentSpaceStore),[]);if(!a)return null;const r=I.zX.createChildStore(a,{table:"team",id:e.teamId,spaceId:a.id});return(0,B.jsx)("div",{style:U.full,children:(0,B.jsx)("div",{style:U.addMembersContainer,children:(0,B.jsx)(V.Z,{store:r,permissionsInviteStore:n,isNewlyCreatedTeam:!0,onSubmitSuccessful:()=>{e.onCompleted(r),P.hI({environment:t,teamStore:r,shouldScroll:!0})},onDismiss:()=>{e.onCanceled(r)}})})})}const X=[r.Z.images.avatars.avatar1Png,r.Z.images.avatars.avatar2Png,r.Z.images.avatars.avatar3Png];function ee(e){let{handleModalClose:t}=e;const s=(0,a.yK)((e=>({container:{borderTopLeftRadius:5,borderTopRightRadius:5,background:e.inputBackground,boxShadow:e.inputBoxShadow},header:{display:"flex",padding:14,fontWeight:m.Z.fontWeight.medium},avatarGroup:{display:"flex",width:"100",marginLeft:4,alignSelf:"center"},avatar:{marginLeft:-4},message:{paddingLeft:14,paddingRight:14},closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor}})),[]);return(0,B.jsx)("div",{style:s.container,children:(0,B.jsxs)("div",{style:s.header,children:[(0,B.jsx)("div",{style:s.avatarGroup,children:X.map(((e,t)=>(0,B.jsx)(b.Z,{avatarShouldShowShadow:!0,style:s.avatar,size:28,avatar:{avatarUrl:e}},t)))}),(0,B.jsx)(v.Z,{style:s.message,isMultiline:!0,isSmall:!0,children:(0,B.jsx)(c.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.firstTeamHeader",defaultMessage:"Create your first teamspace to start using Notion with your teammates"})}),(0,B.jsx)(h.Z,{onClick:t,style:s.closeButton,hoveredStyle:s.closeButtonHover,children:(0,l.D)(s.closeButtonIcon)})]})})}function te(){const e=(0,i.O7)(),[t,,]=(0,o.AF)(k.Z),s=(0,n.useId)(),r=(0,n.useId)(),d=(0,a.yK)((e=>({modal:{maxWidth:500,borderRadius:5,overflow:"visible"},closeButton:{position:"absolute",top:14,right:14,zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:14,fill:e.mediumTextColor},wrapper:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none"},container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none"}})),[]),c=(0,n.useCallback)((t=>{P.ED({environment:e,from:t})}),[e]),{open:p,loading:m,screen:g}=t,f=(0,w.OX)(),y=(0,n.useRef)(f);return(0,n.useEffect)((()=>{m||(y.current=f&&g===k.F.Team)}),[m,g,f]),p?(0,B.jsx)(S.Z,{ariaLabelledBy:s,ariaDescribedBy:r,open:p,innerStyle:d.modal,onDismiss:()=>{c("modal")},render:()=>{const{device:t}=e;return(0,B.jsxs)("div",{style:{height:"100%"},children:[!t.isMobile&&(y.current?(0,B.jsx)(ee,{handleModalClose:()=>{c("close_button")}}):(0,B.jsx)(h.Z,{onClick:()=>{c("close_button")},style:d.closeButton,hoveredStyle:d.closeButtonHover,children:(0,l.D)(d.closeButtonIcon)})),(0,B.jsx)("div",{style:d.wrapper,children:(0,B.jsx)(x.Z,{debugName:"SidebarCreateTeamModal",capture:!0,onBackspace:u.yR,onLeft:u.yR,onRight:u.yR,onSelectAll:u.yR,onRedo:u.yR,onUndo:u.yR,onCut:u.yR,onCopy:u.yR,onPaste:u.yR,onKeypress:u.yR,onDelete:u.yR,onTab:u.yR,children:(0,B.jsx)(q,{titleAriaId:s,descriptionAriaId:r})})}),(0,B.jsx)(Q,{})]})}}):null}},60701:(e,t,s)=>{s.d(t,{_:()=>M});s(67294);var n=s(480),i=s(86628),o=s(24405),a=s(36591),r=s(42853),l=s(5257),d=s(52275),c=s(31945),u=s(78140),p=s(32163),m=s(72495),g=s(26388),h=s(60709),f=s(98742),x=s(4023),y=s(31194),S=s(56187),v=s(98596),b=s(85893);function M(e){let{currentAccessLevel:t,currentIsDefault:s=!1,onChange:M,teamStore:j,disabledWithRightChevron:C=!1,style:w}=e;const{device:k}=(0,n.O7)(),T=(0,S.q)(j),I=(0,o.yK)((e=>({chevron:{width:12,marginLeft:3,marginRight:3,fill:e.lightIconColor},selectedButton:{width:"100%",margin:0,paddingTop:4,paddingBottom:4,border:`1px solid ${e.outlineButtonBorder}`,...w},selectedCheckmark:{width:k.isMobile?16:14},icon:{alignSelf:"center",marginTop:0}})),[k.isMobile,w]),Z=(0,i.VK)((()=>(null==j?void 0:j.isDefault())??s),[j,s]),P=Z?"default":t,F=(0,v.U)({teamStore:j,onChange:M,isDefault:Z});return(0,b.jsx)(c.ZP,{popupType:k.isMobile?c.Z4.SlideUp:c.Z4.Popup,renderOrigin:e=>{const t=F.find((e=>e.key===P));if(!t)return null;const s=t.disableAllOptionsTooltip,n=C||Boolean(s)||Boolean(j)&&!T;return(0,b.jsx)(g.ZP,{placement:x.u.Bottom,alignment:x.v.Start,disableTooltip:!s||!T,renderTooltip:()=>s,style:{width:350},textWrap:!0,render:s=>(0,b.jsx)(d.Z,{...(0,f.Z)(e,s),title:t.title,caption:t.caption,icon:t.icon({fill:t.iconColor}),desktopIconStyle:I.icon,disabled:n,right:C?(0,l.o)(I.chevron):n?void 0:(0,r.i)(I.chevron),focused:!1,shouldWrapCaption:!0,buttonStyle:I.selectedButton})})},placementToOrigin:y.Iw.Bottom,alignmentToOrigin:y.lU.Start,sameWidthAsOrigin:!0,render:e=>{const t=[{key:"access levels",render:e=>(0,b.jsx)(m.Z,{...e,topBorder:0!==e.index}),items:F.map((t=>{const s=t.key===P;return{key:t.key,render:e=>(0,b.jsx)(g.ZP,{placement:x.u.Top,disableTooltip:!t.tooltip,renderTooltip:()=>t.tooltip,render:n=>(0,b.jsx)(d.Z,{...(0,f.Z)(e,n),title:t.title,caption:t.caption,icon:t.icon({fill:t.iconColor}),desktopIconStyle:I.icon,right:s?(0,b.jsx)("div",{style:I.selectedCheckmark,children:(0,a.e)()}):void 0,disabled:t.disabled,shouldWrapCaption:!0})}),action:()=>{t.onSelect(),e.close()}}}))}];return(0,b.jsx)(u.Z,{menuType:h.og.Popup,children:(0,b.jsx)(p.Z,{type:p.i.Vertical,initialFocus:void 0,sections:t})})}})}},86232:(e,t,s)=>{s.d(t,{M:()=>b});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(37810),l=s(48779),d=s(95697),c=s(1083),u=s(64552),p=s(9291),m=s(89728),g=s(80444),h=s(9867),f=s(85893);const x=function(e){const{teamStore:t,from:s,navigateToTeamHomeOnJoin:a,onJoinedTeam:r,style:l,hoveredStyle:d,icon:c,isRed:u}=e,x=(0,i.O7)(),y=(0,o.VK)((()=>g.default.state.currentSpaceStore),[]),S=(0,n.useCallback)((async()=>{y&&(await h.um({environment:x,teamStore:t,currentSpaceStore:y,from:s,andNavigateToTeamHome:a??!1}),null==r||r())}),[y,x,t,s,a,r]);return(0,f.jsx)(m.Z,{style:l,hoveredStyle:d,onClick:S,icon:c,isRed:u,children:(0,f.jsx)(p.FormattedMessage,{id:"outlinerTeamToggleButton.joinTeamButton",defaultMessage:"Join"})})};var y=s(8787),S=s(14889);const v=function(e){const{teamStore:t,style:s,hoveredStyle:i}=e,[a,r]=(0,n.useState)(!1),l=(0,o.VK)((()=>t.getName()),[t]);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(m.Z,{style:s,hoveredStyle:i,onClick:()=>r(!0),children:(0,f.jsx)(p.FormattedMessage,{id:"teamRequestButton.requestButton.label",defaultMessage:"Request"})}),(0,f.jsx)(S.Z,{teamStore:t,teamName:l,teamId:t.id,isModalOpen:a,onDismiss:()=>r(!1)})]})};function b(e){const{teamStore:t,style:s,hoveredStyle:n}=e,p=(0,i.O7)(),m=(0,c.Q)(),g=(0,u.e)(t),h=(0,o.VK)((()=>t.getTeamAccessLevel()),[t]),S=(0,a.yK)((e=>({joinTeamButton:{maxHeight:26,marginLeft:10,paddingLeft:10,paddingRight:10,borderRadius:100,fontSize:13,fontWeight:r.Z.fontWeight.semibold,background:e.buttonHoveredBackground,alignSelf:"center",...s},joinTeamButtonHoveredStyle:{background:e.buttonPressedBackground,...n}})),[s,n]),b=(0,o.VK)((()=>(0,d.Hu)({membership:t.getRawMembership()})&&(0,l.Fn)(p)),[p,t]),M=!g&&"open"===h||b,j=!g&&"closed"===h;return m?null:g?(0,f.jsx)(y.Z,{...e,style:S.joinTeamButton,hoveredStyle:S.joinTeamButtonHoveredStyle}):M?(0,f.jsx)(x,{...e,style:S.joinTeamButton,hoveredStyle:S.joinTeamButtonHoveredStyle}):j?(0,f.jsx)(v,{teamStore:t,style:S.joinTeamButton,hoveredStyle:S.joinTeamButtonHoveredStyle}):null}},8787:(e,t,s)=>{s.d(t,{Z:()=>h});var n=s(67294),i=s(480),o=s(86628),a=s(36591),r=s(64684),l=s(9291),d=s(53965),c=s(89728),u=s(26388),p=s(80444),m=s(9867);var g=s(85893);const h=function(e){const{teamStore:t,from:s,onLeavingTeam:h,style:f,hoveredStyle:x,icon:y,isRed:S,placement:v,alignment:b,buttonInternals:M}=e,j=(0,i.O7)(),C=(0,o.VK)((()=>p.default.state.currentSpaceStore),[]),w=(0,n.useCallback)((async()=>{if(!C)return;await m.s({environment:j,teamStore:t,currentSpaceStore:C,from:s})&&(null==h||h())}),[C,j,t,s,h]),k=(0,g.jsx)(l.FormattedMessage,{id:"teamJoinLeaveButton.leaveTeam.enabledTooltip",defaultMessage:"Click to leave teamspace"}),T=function(e){let{teamStore:t}=e;const s=(0,i.O7)(),n=s.currentUser.id,{isDefaultTeam:a}=(0,o.VK)((()=>({isDefaultTeam:t.isDefault()})),[t]),c=function(e){const t=(0,o.VK)((()=>p.default.state.currentSpaceStore),[]);return(0,o.VK)((()=>e.isDefined()&&null!=t&&t.isDefined()?(0,r.x4)({members:e.getMembers(),groups:(null==t?void 0:t.getPermissionGroups())??[]}):[]),[e,t])}(t),u=(0,o.VK)((()=>n?c.filter((e=>{var t;return null===(t=e.user_ids)||void 0===t?void 0:t.includes(n)})):[]),[c,n]),m=(0,o.VK)((()=>{if(!t.isReady())return!1;const e=(0,r.XO)({membership:t.getMembers()});return 1===e.length&&e[0]===n}),[t,n]);return function(e){let{isDefaultTeam:t,isOnlyTeamOwner:s,userGroups:n}=e;if(t)return(0,g.jsx)(l.FormattedMessage,{id:"teamBrowser.teamCard.leaveTeam.defaultTeamTooltip",defaultMessage:"You can’t leave this teamspace because everyone in the workspace must be a member"});if(s)return(0,g.jsx)(l.FormattedMessage,{id:"teamJoinLeaveButton.leaveTeam.onlyOwnerTooltip",defaultMessage:"Invite another teamspace owner to leave this teamspace"});if(n.length>0)return(0,g.jsx)(l.FormattedMessage,{id:"teamBrowser.teamCard.leaveTeam.groupTooltip",defaultMessage:"{groupNames, plural, one {You can't leave this teamspace because you're a member of multiple groups, {groupNames}.} other {You can't leave this teamspace because you're a member of the group, {groupNames}.}}",values:{groupNames:d.oA(n.map((e=>e.name))).join()}})}({isDefaultTeam:a,isOnlyTeamOwner:m,userGroups:u})}({teamStore:t}),I=Boolean(T),Z=I?T:k;return(0,g.jsx)(u.ZP,{style:I?{width:240}:void 0,disableTooltip:!Boolean(Z),renderTooltip:e=>(0,g.jsx)("div",{...e,children:Z}),textWrap:I,placement:v,alignment:b,render:e=>(0,g.jsx)(c.Z,{...e,style:f,hoveredStyle:x,onClick:w,disabled:I,disabledFeedback:I,icon:y,isRed:S,children:M||(0,g.jsxs)(g.Fragment,{children:[(0,a.e)({width:12.5,marginRight:4}),(0,g.jsx)(l.FormattedMessage,{id:"teamBrowser.teamCard.button.joined",defaultMessage:"Joined"})]})})})}},43488:(e,t,s)=>{s.d(t,{Z:()=>r});s(67294);var n=s(16184),i=s(9291),o=s(26388),a=s(85893);function r(e){let{iconStyle:t}=e;return(0,a.jsx)(o.ZP,{textWrap:!0,style:{width:210},placement:o.ug.Bottom,renderTooltip:()=>(0,a.jsx)(i.FormattedMessage,{id:"teamLockIcon.tooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,a.jsx)("div",{...e,children:(0,n.Q)(t)})})}},38680:(e,t,s)=>{s.r(t),s.d(t,{default:()=>O});s(67294);var n=s(480),i=s(86628),o=s(24405),a=s(33728),r=s(59054),l=s(9291),d=s(78140),c=s(43579),u=s(91487),p=s(47082),m=s(4708),g=s(60709),h=s(45101),f=s(95697),x=s(80444),y=s(33052),S=s(81023),v=s(42853),b=s(53965),M=s(52275),j=s(31945),C=s(32163),w=s(89728),k=s(72495),T=s(26388),I=s(31194),Z=s(56187),P=s(85893);function F(e){const{disabled:t,selectedRole:s,allRoles:a,onChange:r,store:c,labelStyle:u}=e,{device:p}=(0,n.O7)(),m=(0,o.Fg)(),h=(0,Z.q)(c),y=(0,i.VK)((()=>{const{currentSpaceStore:e}=x.default.state;return null==e?void 0:e.canEditMembership()}),[]),S=(0,i.VK)((()=>c.isDefault()),[c]);return(0,P.jsx)(j.ZP,{popupType:p.isMobile?j.Z4.SlideUp:j.Z4.Popup,renderOrigin:e=>(0,P.jsxs)(w.Z,{style:u,disabled:t,disabledFeedback:!0,...e,children:[(0,P.jsx)(l.FormattedMessage,{...f.q9[s].label}),(0,v.i)({width:10,marginLeft:4,fill:m.lightIconColor})]}),placementToOrigin:I.Iw.Bottom,render:e=>{const t=[{key:"roles",render:e=>(0,P.jsx)(k.Z,{...e,topBorder:0!==e.index}),items:a.map((t=>{const n=!h&&"owner"===t,i=S&&"team_level_guest"===t,o=!y&&"team_level_guest"===t,a=!h&&"team_level_guest"===t,d=n||i||o||a,c={key:t,render:e=>(0,P.jsx)(T.ZP,{disableTooltip:!d,placement:T.ug.Right,textWrap:!0,renderTooltip:()=>n?(0,P.jsx)(l.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingOwnerForMembers",defaultMessage:"Teamspace members can't add owners"}):i?(0,P.jsx)(l.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingGuestsInDefaultTeam",defaultMessage:"Default teams can't contain teamspace guests"}):o||a?(0,P.jsx)(l.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingGuestForNonSpaceAdminsOrNonTeamOwners",defaultMessage:"You must be a workspace owner and a teamspace owner to add teamspace guests"}):void 0,render:n=>(0,P.jsx)("span",{...n,children:(0,P.jsx)(M.Z,{...e,focused:!1,checkState:b.Xy(t,s),disabled:d,disabledFeedback:d,title:(0,P.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,P.jsx)(l.FormattedMessage,{...f.q9[t].label})}),caption:(0,P.jsx)("span",{style:{color:m.mediumTextColor},children:(0,P.jsx)(l.FormattedMessage,{...f.q9[t].caption})}),shouldWrapCaption:!0})})}),action:()=>{r(t),e.close()}};return c}))}];let n;return n=p.isMobile?{menuType:g.og.Modal,title:(0,P.jsx)(l.FormattedMessage,{id:"teamPermissionsMenu.mobile.title",defaultMessage:"Select teamspace role"}),right:(0,P.jsx)(l.FormattedMessage,{id:"teamPermissionsMenu.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:e.close}:{menuType:g.og.Popup,width:264},(0,P.jsx)(d.Z,{...n,children:(0,P.jsx)(C.Z,{type:C.i.Vertical,initialFocus:void 0,sections:t})})}})}const A="member";function _(e){const{store:t,permissionsInviteStore:s,onEmptySubmit:n}=e,r=(0,l.useIntl)(),d=(0,i.VK)((()=>Boolean(s.state.isFocused)),[s]),c=(0,i.VK)((()=>s.state.tokenQuery),[s]),m=(0,i.VK)((()=>s.state.inviteRole),[s]),g=(0,i.VK)((()=>s.state.inviteTargets),[s]),f=(0,o.yK)((e=>({inputTokenVerticalMargin:{marginTop:3,marginBottom:3},tokenMenuItem:{alignItems:"unset",borderRadius:4,paddingTop:5,paddingBottom:5,paddingLeft:8,paddingRight:5,boxShadow:d?e.outlineBlueInputBoxShadow:e.inputBoxShadow,maxHeight:"40vh"},inputDiv:{marginBottom:0}})),[d]);function x(e){if(s.state.isInviteTargetsEmpty)return;const t=s.state.inviteTargets.filter((t=>t!==e));0===g.length?s.setState({...s.state,inviteTargets:[],inviteRole:A,isInviteTargetsEmpty:!0}):s.setState({...s.state,inviteTargets:t})}function y(e){s.setState({...s.state,isFocused:e})}const S=g.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`;return(0,P.jsx)(u.Z,{target:e,onClickRemove:x,role:m,shouldWrap:!0,style:f.inputTokenVerticalMargin,backgroundColor:(0,h.gQ)(e)},t)}));return(0,P.jsx)(p.Z,{focus:d,onClick:()=>y(!0),format:p.U.Share,value:c,onChange:function(e){const t=e.target.value,{extractedEmails:n,newInputValue:i}=(0,a.zI)(t),o=n.map((e=>({type:"newUser",value:{email:e},source:"email"}))).filter((e=>!(0,h.Nd)({target:e,permissionsInviteStore:s}))),r=[...s.state.inviteTargets,...o];r.length>0?(s.setState({...s.state,inviteTargets:r,isInviteTargetsEmpty:!1,tokenQuery:i}),y(!(o.length>0))):s.setState({...s.state,inviteTargets:[],isInviteTargetsEmpty:!0,tokenQuery:i})},onEmptySubmit:n,type:"email",placeholder:r.formatMessage({id:"teamPermissionsInvite.searchInput.placeholder",defaultMessage:"Search people or groups"}),tokens:S,onRemoveLastToken:function(){const e={...s.state};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.isInviteTargetsEmpty=!0,e.inviteRole=A),s.setState(e)},focusAfterAnimation:!0,right:(0,P.jsx)(R,{store:t,permissionsInviteStore:s}),style:f.tokenMenuItem,inputStyle:f.inputTokenVerticalMargin,inputDivStyle:f.inputDiv,inputFullWidth:!0})}function R(e){const{store:t,permissionsInviteStore:s}=e,n=(0,i.VK)((()=>{const e=x.default.state.currentSpaceStore;return!(null!=e&&e.getDisableTeamGuests())&&(0,m.F$)()}),[]),a=(0,i.VK)((()=>s.state.inviteRole),[s]),r=(0,o.yK)((()=>({teamRoleLabel:{marginTop:3,marginBottom:3,marginLeft:5}})),[]);function l(e){s.setState({...s.state,inviteRole:e})}return n?(0,P.jsx)(F,{store:t,selectedRole:a,allRoles:f.ZN,onChange:l,labelStyle:r.teamRoleLabel}):(0,P.jsx)(F,{store:t,selectedRole:a,allRoles:f.$r,onChange:l,labelStyle:r.teamRoleLabel})}const O=function(e){const{store:t,onEmptySubmit:s}=e,a=(0,n.O7)();(0,r.r5)((async()=>{await S.bi(a)}),[]);const l=(0,i.qz)(e.permissionsInviteStore,y.Z),u=(0,i.VK)((()=>Boolean(l.state.isFocused)),[l]),p=(0,i.VK)((()=>l.state.tokenQuery),[l]),m=(0,i.VK)((()=>u&&p.length>0),[u,p]),h=(0,o.yK)((e=>({permissionsInviteSearchRequest:{position:"absolute",width:"100%",borderRadius:4,backgroundColor:e.contentBackground,boxShadow:e.largeBoxShadow,marginTop:4},scroller:{zIndex:1}})),[]);function f(e){l.setState({...l.state,isFocused:e})}return(0,P.jsx)("div",{onFocus:()=>f(!0),onBlur:()=>f(!1),children:(0,P.jsx)(d.Z,{menuType:g.og.Popup,header:(0,P.jsx)(_,{store:t,permissionsInviteStore:l,onEmptySubmit:s}),scrollerStyle:h.scroller,width:"100%",tokenInputHeader:!1,disableScroller:!0,children:m&&(0,P.jsx)("div",{style:h.permissionsInviteSearchRequest,children:(0,P.jsx)(c.Z,{permissionsInviteStore:l,store:t,defaultRoleForSpaceBot:"editor",shouldShowBots:!1,shouldShowGroups:!0,sectionRenderLimit:10,membersOnly:!1,hideUserTypeToken:!0,disableInvitedUsers:!0})})})})}},38078:(e,t,s)=>{s.d(t,{Z:()=>B,u:()=>O});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(33728),l=s(27714),d=s(9291),c=s(37810),u=s(17224),p=s(893),m=s(95209),g=s(64964),h=s(68785),f=s(63296),x=s(89728),y=s(58297),S=s(26388),v=s(64369),b=s(43250),M=s(4708),j=s(45101),C=s(95697),w=s(77907),k=s(80444),T=s(35057),I=s(9867),Z=s(74016),P=s(30765),F=s(85893);const A={button:{height:32},buttonContainer:{width:"100%",paddingTop:22,display:"flex",justifyContent:"end"},multiButtonContainer:{width:"100%",paddingTop:12,display:"flex",justifyContent:"space-between"},singleButtonContainer:{width:"100%",paddingTop:12,display:"flex",justifyContent:"right"},container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none",width:"100%"},containerLeftAligned:{display:"flex",alignItems:"left",justifyContent:"left",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none",width:"100%"},titleAndIcon:{paddingBottom:18,alignItems:"center",display:"flex"},addMembersTo:{minWidth:"25%"},icon:{paddingRight:3,paddingLeft:3},teamName:{paddingRight:10,fontWeight:c.Z.fontWeight.medium,...c.Z.textOverflowStyle,maxWidth:250},full:{width:"100%"},submitTooltip:{minWidth:250},subtitle:{paddingTop:16}};function _(e){var t;let{isLoading:s,isNewlyCreatedTeam:n,onDismiss:i,onSubmit:a,inviteTargets:r,includesGroups:l,inviteRole:c,canEditSpaceMembership:u,membershipRequestsDisabled:p,spaceAllowedDomains:m,hasTeamGuestsMatchAllowedDomain:g}=e;const x=r.length>0,v=l&&"owner"===c,b=r.filter((e=>(0,j.OA)(e))).length>0&&p&&!u,C=(0,o.VK)((()=>(0,M.F$)()&&"team_level_guest"===c&&r.some((e=>"group"===e.type||"existingUser"===e.type&&"none"!==e.spaceRole&&"not_in_space"!==e.spaceRole))),[c,r]),w=v||C||b||g;if(s)return(0,F.jsx)(y.Z,{style:{...A.button,minWidth:80},disabled:!0,children:(0,F.jsx)(h.Z,{isWhite:!0})});if(n&&!x)return(0,F.jsx)(f.Z,{style:A.button,onClick:i,disabled:s,children:(0,F.jsx)(d.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.skipForNow",defaultMessage:"Skip for now"})});const k=v?(0,F.jsx)(d.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.groupsAsOwnersTooltip",defaultMessage:"Cannot add groups as teamspace owners. Remove any groups to continue."}):C?(0,F.jsx)(d.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.memberOrGroupInvitedAsTeamGuestTooltip",defaultMessage:"Cannot add space members or groups as teamspace guests. Remove them to continue."}):g?(0,F.jsx)(d.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.hasTeamGuestsMatchAllowedDomain",defaultMessage:"Cannot add users with {emailDomains} as teamspace guests. Remove them to continue.",values:{emailDomains:null==m||null===(t=m.map((e=>`@${e}`)))||void 0===t?void 0:t.join(", ")}}):null;return(0,F.jsx)(S.ZP,{textWrap:!0,style:A.submitTooltip,disableTooltip:!k,renderTooltip:()=>k,render:e=>(0,F.jsx)(y.Z,{style:A.button,onClick:a,disabled:!x||s||w,...e,children:(0,F.jsx)(d.FormattedMessage,{id:"teamPermissionsInviteOverlayV2.inviteButton.label",defaultMessage:"Invite"})})})}function R(e){let{inviteTargets:t,workspaceName:s,canEditSpaceMembership:n,membershipRequestsDisabled:i,isFreeTier:o,inviteRole:a,hasTeamGuestsMatchAllowedDomain:r}=e;if(void 0===n)return null;if(!t||0===t.length)return null;const l=t.map((e=>{if("group"!==e.type&&(0,j.OA)(e))return e.value.email})).filter((e=>e));if(!l||0===l.length)return null;const c=e=>(0,F.jsx)("b",{children:e}),u=s??"this workspace";return n?o?(0,F.jsx)(v.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:1===l.length?(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingularOwner.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a workspace owner.",values:{guestEmail:l[0],workspaceName:u,b:c}}):(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPluralOwners.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as workspace owners.",values:{firstGuest:l[0],secondGuest:l[1],numberOfOtherEmails:l.length-1,workspaceName:u,b:c}})}):"team_level_guest"===a?r?null:(0,F.jsx)(v.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:1===l.length?(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingular.teamGuest.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a billed teamspace guest.",values:{guestEmail:l[0],workspaceName:u,b:c}}):(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPlural.teamGuest.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as billed teamspace guests.",values:{firstGuest:l[0],secondGuest:l[1],numberOfOtherEmails:l.length-1,workspaceName:u,b:c}})}):(0,F.jsx)(v.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:1===l.length?(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingular.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a billed workspace member.",values:{guestEmail:l[0],workspaceName:u,b:c}}):(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPlural.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as billed workspace members.",values:{firstGuest:l[0],secondGuest:l[1],numberOfOtherEmails:l.length-1,workspaceName:u,b:c}})}):i?(0,F.jsx)(v.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipDisabled.subtitle",defaultMessage:"You can't add workspace guests to a teamspace. Ask your admin to add them as workspace members first."})}):(0,F.jsx)(v.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:1===l.length?(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipSingular.subtitle",defaultMessage:"Request will be sent to your admin to add <b>{guestEmail}</b> as a member to {workspaceName}.",values:{guestEmail:l[0],workspaceName:u,b:c}}):(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipPlural.subtitle",defaultMessage:"Request will be sent to your admin to add <b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> as members to {workspaceName}.",values:{firstGuest:l[0],secondGuest:l[1],numberOfOtherEmails:l.length-1,workspaceName:u,b:c}})})}function O(e){const{store:t,isSmall:s}=e,n=(0,i.O7)(),o=(0,a.yK)((e=>({button:{marginRight:5,marginLeft:5,height:32,fontSize:s?12:14},icon:{width:s?12:14,height:s?12:14}})),[s]);return(0,F.jsx)(x.Z,{onClick:()=>{p.RD({environment:n,stringValue:C.W8(t.id),copiedMessage:p.tq.copiedLinkToClipboard}),u.XT(n,{store:t})},icon:l.N,style:o.button,iconStyle:o.icon,isBlue:!0,children:s?(0,F.jsx)(d.FormattedMessage,{id:"teamPermissionsInviteOverlay.copyLinkCondensedButton.label",defaultMessage:"Copy link"}):(0,F.jsx)(d.FormattedMessage,{id:"teamPermissionsInviteOverlay.copyLinkButton.label",defaultMessage:"Copy invite link"})})}const B=function(e){let{store:t,permissionsInviteStore:s,isNewlyCreatedTeam:a,onSubmitSuccessful:l,onDismiss:c}=e;const u=(0,i.O7)(),{teamName:p,workspaceName:h,canEditSpaceMembership:f,membershipRequestsDisabled:x,teamAccessLevel:y,spaceAllowedDomains:S}=(0,o.VK)((()=>{const{currentSpaceStore:e}=k.default.state;return{teamName:t.getName(),workspaceName:null==e?void 0:e.getName(),canEditSpaceMembership:null==e?void 0:e.canEditMembership(),membershipRequestsDisabled:null==e?void 0:e.getDisableMembershipRequests(),teamAccessLevel:t.getTeamAccessLevel(),spaceAllowedDomains:null==e?void 0:e.getEmailDomains()}}),[t]);(0,n.useEffect)((()=>()=>{a&&I.hI({environment:u,teamStore:t,shouldScroll:!0})}),[a,t,u]);const[v,B]=(0,n.useState)(!1),D=(0,o.VK)((()=>s.state.inviteTargets),[s]),L=(0,o.VK)((()=>s.state.inviteTargets.length),[s]),V=(0,o.VK)((()=>s.state.inviteRole),[s]),N=(0,o.VK)((()=>{if(s.state.isInviteTargetsEmpty)return!1;return Boolean(s.state.inviteTargets.find((e=>"group"===e.type)))}),[s]),E=(0,o.VK)((()=>T.QM()),[]),U=(0,o.VK)((()=>!(null==S||!S.length||"team_level_guest"!==V||!(0,M.F$)())&&D.some((e=>"group"!==e.type&&(0,r.dy)(S,e.value.email)))),[S,V,D]),W=(0,o.VK)((()=>(0,M.s$)()?!E&&!C.U2(t):"open"===y&&(0,M.u3)()),[t,y,E]),K=async()=>{if(B(!0),L>0){const e=s.state.inviteTargets,{success:n}=await m.zK({environment:u,store:t,permissionsInviteStore:s,inviteOrigin:"team_invite_overlay"});if(void 0!==f)if(n){const s=(0,j.t0)({inviteTargets:e,recordStore:t,canEditSpaceMembership:f});if(!s)return;setTimeout((()=>{g.oV({label:s})}))}else setTimeout((()=>{g.oV({label:(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlay.inviteMembersFailure.message",defaultMessage:"Failed to send invites"})})}))}m.Mr({permissionsInviteStore:s}),B(!1),null==l||l()};return(0,F.jsx)("div",{className:b.D$4,style:{...A.full},children:(0,F.jsxs)("div",{style:A.containerLeftAligned,children:[(0,F.jsxs)("div",{style:A.titleAndIcon,children:[(0,F.jsx)("div",{style:A.addMembersTo,children:(0,F.jsx)(d.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.membersTitle.label",defaultMessage:"Invite people to"})}),(0,F.jsx)("div",{style:A.icon,children:(0,F.jsx)(Z.p,{disabled:!0,store:t,size:20})}),(0,F.jsx)(P.s,{style:A.teamName,children:p})]}),(0,F.jsxs)("div",{style:A.full,children:[(0,F.jsx)(w.LazyTeamPermissionsInvite,{store:t,permissionsInviteStore:s,onEmptySubmit:K}),(0,F.jsx)("div",{style:A.subtitle,children:(0,F.jsx)(R,{inviteTargets:D,workspaceName:h,canEditSpaceMembership:f,membershipRequestsDisabled:x,isFreeTier:E,inviteRole:V,hasTeamGuestsMatchAllowedDomain:U})})]}),(0,F.jsx)("div",{style:W?A.multiButtonContainer:A.singleButtonContainer,children:(0,F.jsxs)("div",{style:W?A.multiButtonContainer:{},children:[W&&(0,F.jsx)(O,{store:t}),(0,F.jsx)(_,{isLoading:v,onSubmit:K,onDismiss:()=>{m.Mr({permissionsInviteStore:s}),null==c||c()},isNewlyCreatedTeam:a,inviteTargets:D,includesGroups:N,inviteRole:V,canEditSpaceMembership:f,membershipRequestsDisabled:x,spaceAllowedDomains:S,hasTeamGuestsMatchAllowedDomain:U})]})})]})})}},71015:(e,t,s)=>{s.r(t),s.d(t,{default:()=>r});s(67294);var n=s(86628),i=s(9019),o=s(38078),a=s(85893);const r=function(e){const[t,,s]=(0,n.AF)(e.permissionsInviteStore),r=()=>{s.reset()};return(0,a.jsx)(i.Z,{modalStyle:{alignSelf:"center",overflow:"visible",top:0,width:500},open:t.modalOpen,onDismiss:r,renderContent:()=>(0,a.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"end",padding:22},children:(0,a.jsx)(o.Z,{store:e.store,permissionsInviteStore:s,isNewlyCreatedTeam:!1,onSubmitSuccessful:r,onDismiss:r})}),origin:e.origin})}},69464:(e,t,s)=>{s.d(t,{C:()=>b,Z:()=>M});s(57658);var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(16184),l=s(9291),d=s(52275),c=s(31945),u=s(78140),p=s(32163),m=s(72495),g=s(45653),h=s(60709),f=s(75546),x=s(80444),y=s(14034),S=s(74016),v=s(85893);function b(e){const{renderOrigin:t,onTeamAccept:s,sectionTitle:n,showMemberCount:a,right:f,showPrivate:S,onPrivateAccept:b,captionItem:C}=e,w=(0,i.Fy)().isMobile,k=j(),T=(0,y.E)(),I=(0,o.VK)((()=>T.filter((e=>e.canAddOrRemoveTopLevelPages()))),[T]),Z=(0,o.VK)((()=>x.default.state.currentUserStore),[]),P=[];if(C){const e={key:"caption",render:e=>(0,v.jsx)(m.Z,{...e,topBorder:!0}),items:[C]};P.push(e)}const F=I.map((e=>({key:e.id,action:()=>{s(e)},render:t=>(0,v.jsx)(M,{...t,team:e,onAccept:s,showMemberCount:a,right:f})}))),A={key:"teams",render:e=>(0,v.jsx)(m.Z,{...e,title:n}),items:F};if(P.push(A),S){const e={key:"private",render:e=>(0,v.jsx)(m.Z,{...e,topBorder:F.length>0}),items:[{key:"private",action:()=>{},render:e=>(0,v.jsx)(d.Z,{...e,icon:(0,v.jsxs)("div",{style:{position:"relative"},children:[(0,v.jsx)(g.Z,{hasTooltip:!1,userStore:Z}),(0,r.Q)(k.privateItemLockIcon)]}),title:(0,v.jsx)(l.FormattedMessage,{id:"teamPickerButton.addToPrivate",defaultMessage:"Add to Private"}),onClick:()=>{null==b||b()}})}]};P.push(e)}return(0,v.jsx)(c.ZP,{...e,popupType:w?c.Z4.SlideUp:c.Z4.Popup,renderOrigin:t,render:e=>{let t;return t=w?{menuType:h.og.ActionSheet}:{menuType:h.og.Popup,width:"100%"},(0,v.jsx)(u.Z,{...t,children:(0,v.jsx)(p.Z,{style:{width:w?void 0:256},type:p.i.Vertical,initialFocus:void 0,sections:P})})}})}const M=n.forwardRef(((e,t)=>{const{team:s,onAccept:n,showMemberCount:i,right:a,...r}=e,c=j(),u=(0,o.VK)((()=>s.getUserIdsInTeam().length),[s]);return(0,v.jsx)(d.Z,{...r,ref:t,onClick:e=>n(s),icon:(0,v.jsx)(S.p,{store:s,size:20,disabled:!0}),title:(0,v.jsx)(f.o,{teamStore:s}),right:r.focused?a:null,caption:i?(0,v.jsx)("div",{style:c.caption,children:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"{numberOfMembers, plural, one {{numberOfMembers} member} other {{numberOfMembers} members}}",id:"teamPickerButton.teamItem.teamMemberCount",values:{numberOfMembers:u}})}):null})}));function j(){return(0,a.yK)((e=>({privateItemLockIcon:{position:"absolute",bottom:-2,right:-2,zIndex:1,width:10,height:10,fill:e.accentColors.red[500]},caption:{color:e.lightTextColor}})),[])}},80068:(e,t,s)=>{s.d(t,{Z:()=>p});s(67294);var n=s(24405),i=s(9291),o=s(1898),a=s(74523),r=s(18514),l=s(30765),d=s(85893);function c(e){switch(e){case"bestPractices":return(0,r.UY)("guides.teamspacesLearnMore");case"workspaceOwnerGuide":return(0,r.UY)("guides.teamspacesWorkspaceOwner");case"settingsAndPermissions":return(0,r.UY)("guides.teamspacesSettingsAndPermissions");default:return(0,o.t1)(e)}}function u(e){return e||(0,d.jsx)(l.s,{children:(0,d.jsx)(i.FormattedMessage,{defaultMessage:"Learn about teamspaces",id:"teamsLearnMoreLink"})})}function p(e){let{onClick:t,message:s,helpCenterLocation:i,analyticsFrom:o,containerStyle:r}=e;const l=(0,n.yK)((()=>({button:{maxWidth:"100%"}})),[]);return(0,d.jsx)("div",{style:r,children:(0,d.jsx)(a.Z,{buttonStyle:l.button,title:u(s),analyticsFrom:o,href:c(i),onClick:t})})}},79414:(e,t,s)=>{s.d(t,{n:()=>g});s(67294);var n=s(86628),i=s(24405),o=s(7928),a=s(9291),r=s(31278),l=s(45653),d=s(71862),c=s(80993),u=s(85893);const p=c.Kt,m=16;function g(e){let{ownerStores:t,teamStore:s,isSmall:o=!1}=e;const a=o?p:d.Z,l=o?10:m,c=(0,i.yK)((e=>({container:{position:"relative",width:a,height:a},teamBadge:{position:"absolute",bottom:-5,right:-3,background:e.modalBackground,padding:.75,borderRadius:"0.25em"}})),[a]),{teamName:g,teamIcon:f}=(0,n.VK)((()=>({teamName:s.getName(),teamIcon:s.getIcon()})),[s]),x=e=>(0,u.jsx)(r.Z,{disabled:!0,title:g,icon:f,isEmptyPage:!1,size:e});return 0===t.length?x(a):(0,u.jsxs)("div",{style:c.container,children:[(0,u.jsx)(h,{isSmall:o,store:t[0]}),(0,u.jsx)("div",{style:c.teamBadge,children:x(l)})]})}function h(e){let{store:t,isSmall:s=!1,style:c={}}=e;const m=(0,a.useIntl)(),g=s?p:d.Z,h=(0,i.yK)((e=>({icon:{width:g,height:g,borderRadius:g,boxShadow:e.avatarBoxShadow,...c}})),[g,c]),f=(0,n.VK)((()=>null!=t&&t.isDefined()?(0,o.Nz)(m,null==t?void 0:t.getModel()):void 0),[m,t]),x=f?(0,u.jsx)(l.Z,{avatarShouldShowShadow:!0,userStore:t,size:g}):(0,u.jsx)(r.Z,{bucket:"public",disabled:!0,isEmptyPage:!1,title:f,size:g,icon:void 0});return(0,u.jsx)("div",{style:h.icon,children:x})}},14465:(e,t,s)=>{s.d(t,{z:()=>a});s(67294);var n=s(24405),i=s(37810),o=s(85893);function a(e){let{title:t,subtitle:s,style:a}=e;const r=(0,n.yK)((e=>({base:{width:"100%"},title:{fontWeight:i.Z.fontWeight.medium,color:e.regularTextColor,fontSize:14},subtitle:{fontWeight:i.Z.fontWeight.regular,color:e.mediumTextColor,fontSize:12}})),[]);return(0,o.jsxs)("div",{style:{...r.base,...a},children:[(0,o.jsx)("div",{style:r.title,children:t}),s&&(0,o.jsx)("div",{style:r.subtitle,children:s})]})}},80993:(e,t,s)=>{s.d(t,{Kt:()=>u,MQ:()=>c,Ph:()=>p,oM:()=>d});var n=s(67294),i=s(24405),o=s(61519),a=s(89728),r=s(14465),l=s(85893);const d=15,c=8,u=20;function p(e){const t=(0,i.yK)((()=>({button:{height:"auto",paddingLeft:0,paddingRight:0,display:"flex"},title:{marginBottom:10}})),[]);return Boolean(e.onClick)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.z,{title:e.title,style:t.title}),(0,l.jsx)(a.Z,{onClick:e.onClick,style:t.button,children:(0,l.jsx)(m,{...e})})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.z,{title:e.title,style:t.title}),(0,l.jsx)(m,{...e})]})}function m(e){let{title:t,rows:s,hideDividers:a=!1,itemStyle:r,onClick:u}=e;const p=(0,i.yK)((e=>({container:{border:`1px solid ${e.regularDividerColor}`,borderRadius:4,width:"100%"},list:{listStyle:"none",padding:0,margin:0},listItem:{marginLeft:d,marginRight:d,paddingTop:c,paddingBottom:c,...r},divider:{marginLeft:d,marginRight:d,borderColor:`${e.regularDividerColor}`}})),[r]);return(0,l.jsx)("div",{style:{...p.container},children:(0,l.jsx)("ul",{style:p.list,children:s.map(((e,t)=>(0,l.jsxs)(n.Fragment,{children:[!a&&t>0&&(0,l.jsx)(o.Z,{size:1,innerStyle:p.divider}),(0,l.jsx)("li",{style:p.listItem,children:e},t)]},t)))})})}},82740:(e,t,s)=>{s.d(t,{e:()=>l});var n=s(86628),i=s(1898),o=s(35057),a=s(64552),r=s(56187);function l(e){const t=(0,r.q)(e),s=(0,a.e)(e);return(0,n.VK)((()=>{if(!(0,o.Mk)())return!1;const n=e.getSetting("invite_access");switch(n){case void 0:return!1;case"team_members":return s;case"team_owners":return t;default:(0,i.t1)(n)}}),[e,t,s])}},73365:(e,t,s)=>{s.d(t,{n:()=>l});var n=s(480),i=s(86628),o=s(87479),a=s(46654),r=s(30397);function l(e){const t=(0,n.O7)();return(0,i.VK)((()=>{const s=r.Z.state.teams.map((e=>({membership:e.getMembers(),id:e.id,archived_by:e.getArchivedBy(),is_default:e.isDefault()}))),n=t.currentUser.id;if(!n||!e)return!1;const i={permissions:e.getPermissionItems(),permission_groups:e.getPermissionGroups()};return(0,o.wN)({spaceValue:i,spaceMembers:(0,a.aG)(i),teamsInSpace:s,currentUserId:n})}),[t,e])}},11628:(e,t,s)=>{s.d(t,{P:()=>d,z:()=>c});var n=s(480),i=s(86628),o=s(47425),a=s(98481),r=s(80444),l=s(70060);function d(){const{currentSpaceStore:e}=(0,i.Kw)(r.default);return(0,i.VK)((()=>{const t=(null==e?void 0:e.getSubscriptionTier())??"free";return(0,o.$V)(t,"business")}),[e])}function c(){const e=(0,n.O7)(),{currentSpaceStore:t}=(0,i.Kw)(r.default);return(0,i.VK)((()=>{const s=(null==t?void 0:t.getSubscriptionTier())??"free";return!(0,l.fX)()&&(0,o.$V)(s,"business")||(0,a.J)({environment:e})}),[e,t])}},97082:(e,t,s)=>{s.d(t,{y:()=>o});var n=s(86628),i=s(30397);function o(e){const[t]=(0,n.AF)(i.Z);return(0,n.VK)((()=>{if(!e)return!1;const s=t.teams.filter((e=>e.isDefault()&&!e.isArchived()));return 1===s.length&&s[0].id===e}),[t,e])}},1083:(e,t,s)=>{s.d(t,{Q:()=>l});var n=s(480),i=s(86628),o=s(48779),a=s(80444),r=s(88280);function l(){const e=function(){const e=(0,n.O7)();return(0,i.VK)((()=>{const t=a.default.state.currentSpaceStore,s=r.subscriptionDataStoreInstance.state;return t?o.Cx(t)?s?{loading:!1,isUserTeamGuestOfSpace:o.di(e,s)}:{loading:!0}:{loading:!1,isUserTeamGuestOfSpace:!1}:{loading:!0}}),[e])}();return(0,i.VK)((()=>e.loading||e.isUserTeamGuestOfSpace),[e])}},64552:(e,t,s)=>{s.d(t,{e:()=>r});var n=s(480),i=s(86628),o=s(95697),a=s(80444);function r(e){const t=(0,n.O7)(),s=(0,i.VK)((()=>a.default.state.currentSpaceStore),[]);return(0,i.VK)((()=>(0,o.AL)({teamStore:e,spaceStore:s,userId:t.currentUser.id})),[s,t.currentUser.id,e])}},56187:(e,t,s)=>{s.d(t,{q:()=>a});var n=s(480),i=s(86628),o=s(64684);function a(e){const t=(0,n.O7)();return(0,i.VK)((()=>{const s=t.currentUser.id;return!!(e&&e.isDefined()&&s)&&(0,o.pd)({membership:e.getMembers()},s)}),[t.currentUser.id,e])}},40215:(e,t,s)=>{s.d(t,{F:()=>h});var n=s(86628),i=s(94714),o=s(59054),a=s(6287),r=s(54814),l=s(23924),d=s(77907),c=s(75822),u=s(62395),p=s(77080),m=s(42330),g=s(6258);function h(e){let{environment:t,spaceStore:s,joinedTeamIds:h,parentStore:f,moveToTargets:x,overrideDatabaseType:y}=e;const S=(0,n.VK)((()=>{const e=null==s?void 0:s.id;if(e)return function(e){if(!u.n.state)return;if(e!==u.n.state.spaceId)return;return u.n.state.typedDatabases}(e)}),[null==s?void 0:s.id]),v=(0,n.VK)((()=>p.default.checkGate("typed_move_to_improved_default_results")),[]),b=(0,d.useDependency)(d.deps.searchActions),[{value:M,status:j}]=(0,o.r5)((async()=>{if(S)return S;if(!s||!f)return;const e=m.ZP.getTargetsDatabaseType()??y;if(!e)return;if("resolved"!==b.status)return;const n=b.value;let o=[];if(v){const i=((await n.searchCollectionsWithRecents({environment:t,query:"",limit:20,databaseType:[e],spaceStore:s,parentStore:s,collectionViewBlockStore:void 0,searchSessionId:m.ZP.state.isOpen?m.ZP.state.flowId:void 0})).results||[]).map((e=>g.NW.createChildStore(f,{table:a.vF,id:e})));o=(0,l.qJ)({typedDatabases:i,blocksToFilterParents:x})}else{const n=await r.rG({environment:t,spaceId:s.id,databaseType:e,parentStore:f})??[];o=(0,l.mL)({environment:t,typedDatabases:n,spaceStore:s,joinedTeamIds:h})}return u.n.setState({typedDatabases:o,spaceId:s.id}),m.ZP.setState({...m.ZP.state,variant:i.ii}),o}),[S,s,v,t,x,y,f,h,b.status,b.value],{debounce:c.vp,throttle:c.vp});return S?{success:!0,typedDatabases:S}:"resolved"===j&&M?{success:!0,typedDatabases:M}:{success:!1}}},22487:(e,t,s)=>{s.d(t,{K:()=>l});var n=s(86628),i=s(72141),o=s(95697),a=s(80444),r=s(88893);function l(e){return(0,n.VK)((()=>{if(!e)return 0;const t=a.default.state.currentSpaceStore,s=a.default.state.currentUserStore;if(!i.YX((null==t?void 0:t.getRole())??"none")){return(0,o.tu)({currentUserStore:s,currentSpaceStore:t,teamStore:e,members:e.getMembers()}).length}return(e.getUserIdsInTeamUsingSpaceMembers((0,r.Io)())??[]).length}),[e])}},98596:(e,t,s)=>{s.d(t,{U:()=>j});s(30541),s(67294);var n=s(480),i=s(86628),o=s(24405),a=s(45238),r=s(85893);const l=(0,a.IU)("closedTeam",{viewBox:"0 0 28 28",svg:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("path",{d:"M18.0459 13.8125C20.1377 13.8125 21.8428 11.9492 21.8428 9.68164C21.8428 7.43164 20.1465 5.66504 18.0459 5.66504C15.9541 5.66504 14.2402 7.4668 14.249 9.69922C14.2578 11.958 15.9541 13.8125 18.0459 13.8125ZM7.9209 13.8828C9.73145 13.8828 11.2168 12.2568 11.2168 10.2617C11.2168 8.31055 9.74902 6.7373 7.9209 6.7373C6.11035 6.7373 4.61621 8.33691 4.625 10.2793C4.625 12.2656 6.11035 13.8828 7.9209 13.8828ZM18.0459 12.4854C16.7627 12.4854 15.6641 11.2549 15.6641 9.69922C15.6553 8.16992 16.7363 6.99219 18.0459 6.99219C19.3555 6.99219 20.4277 8.15234 20.4277 9.68164C20.4277 11.2373 19.3379 12.4854 18.0459 12.4854ZM7.9209 12.5732C6.83984 12.5732 5.93457 11.5449 5.93457 10.2793C5.93457 9.04004 6.83105 8.04688 7.9209 8.04688C9.02832 8.04688 9.91602 9.02246 9.91602 10.2617C9.91602 11.5449 9.00195 12.5732 7.9209 12.5732ZM3.02539 21.9424H9.9248C9.50293 21.7051 9.18652 21.1777 9.24805 20.6416H2.81445C2.62988 20.6416 2.55078 20.5713 2.55078 20.4043C2.55078 18.2246 5.03809 16.1855 7.91211 16.1855C9.01074 16.1855 10.0127 16.4492 10.8652 16.9502C11.1377 16.5986 11.4629 16.291 11.8584 16.0186C10.7246 15.2715 9.3623 14.8848 7.91211 14.8848C4.22949 14.8848 1.24121 17.5566 1.24121 20.4834C1.24121 21.459 1.83887 21.9424 3.02539 21.9424ZM12.5176 21.9424H23.5566C25.0244 21.9424 25.7188 21.5029 25.7188 20.5361C25.7188 18.2334 22.8096 14.9023 18.0371 14.9023C13.2734 14.9023 10.3643 18.2334 10.3643 20.5361C10.3643 21.5029 11.0586 21.9424 12.5176 21.9424ZM12.0957 20.6152C11.8672 20.6152 11.7793 20.5537 11.7793 20.3691C11.7793 18.9277 14.0117 16.2295 18.0371 16.2295C22.0713 16.2295 24.3037 18.9277 24.3037 20.3691C24.3037 20.5537 24.207 20.6152 23.9785 20.6152H12.0957Z"})})});var d=s(40462),c=s(90199),u=s(49364),p=s(64684),m=s(9291),g=s(31701),h=s(48779),f=s(12205),x=s(80444),y=s(44041),S=s(74136);const v=function(e){let{tier:t}=e;const s=()=>"business"===t?(0,r.jsx)(m.FormattedMessage,{id:"upgradeToBusinessBadge",defaultMessage:"Business"}):(0,r.jsx)(m.FormattedMessage,{id:"upgradeToEnterpriseBadge",defaultMessage:"Enterprise"});return(0,r.jsx)(S.Z,{children:(0,r.jsx)(s,{})})};var b=s(11628),M=s(97082);function j(e){let{teamStore:t,isDefault:s,onChange:a=(()=>{})}=e;const S=(0,n.O7)(),j=(0,f.J)(),w=(0,M.y)(null==t?void 0:t.id),k=(0,b.P)(),T="business",I=(0,i.VK)((()=>x.default.state.currentSpaceStore),[]),Z=(0,i.VK)((()=>{if(I)return(0,h.rn)(S,I)}),[S,I]),P=(0,i.VK)((()=>{const e=null==t?void 0:t.getSettingsStore().getValue();return!!e&&("private"===(0,p.B5)(e)??!1)}),[t]),F=(0,o.yK)((()=>({openIcon:{width:20,height:20},lockIcon:{width:18,height:18},closedIcon:{width:20,height:20},iconContainer:{width:20,height:20,display:"flex",justifyContent:"center",alignItems:"center",marginLeft:5,marginRight:5}})),[]),A=(0,r.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.privateTeamspaceUpsellBusiness.tooltip",defaultMessage:"Upgrade to Business Plan to enable Private teamspaces"}),_=(0,r.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.defaultTeamSpace.title",defaultMessage:"Default"}),R=(0,r.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.openTeamspace.title",defaultMessage:"Open"}),O=(0,r.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.closedTeamSpace.title",defaultMessage:"Closed"}),B=(0,r.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.privateTeamSpace.title",defaultMessage:"Private"}),D="dark"===(0,o.Fg)().mode?g.ZP.uiLightGray:g.ZP.black,L=[{key:"open",icon:e=>(0,r.jsx)("div",{style:F.iconContainer,children:(0,u.R)({...e,...F.openIcon})}),iconColor:D,level:R,title:R,caption:(0,r.jsx)(m.FormattedMessage,{id:"CreateTeamspaceMenu.openTeamspace.caption",defaultMessage:"Anyone can see and join this teamspace"}),disabled:!1,onSelect:()=>a("open",!1)},{key:"closed",icon:e=>(0,r.jsx)("div",{style:F.iconContainer,children:l({...e,...F.closedIcon})}),iconColor:D,level:O,title:O,caption:(0,r.jsx)(m.FormattedMessage,{id:"CreateTeamspaceMenu.closedTeamspace.caption",defaultMessage:"Anyone can see this teamspace but not join"}),disabled:!1,onSelect:()=>a("closed",!1)},{key:"private",icon:e=>(0,r.jsx)("div",{style:F.iconContainer,children:(0,c.b)({...e,...F.lockIcon})}),iconColor:D,level:B,title:k?B:(0,r.jsx)(C,{title:B,badge:(0,r.jsx)(v,{tier:T})}),caption:(0,r.jsx)(m.FormattedMessage,{id:"CreateTeamspaceMenu.privateTeamspace.caption",defaultMessage:"Only members can see that this teamspace exists"}),disabled:!k&&!j,tooltip:k?void 0:A,onSelect:()=>{if(!k&&!P)return y.y(S,{from:"team_security_settings",for:T,dontOpenPlansOnCancel:!0});a("private",!1)}}];if(s||j){const e=s&&(!j||w),t={key:"default",icon:e=>(0,r.jsx)("div",{style:F.iconContainer,children:(0,d.o)({...e,...F.lockIcon})}),iconColor:D,level:_,title:_,caption:(0,r.jsx)(m.FormattedMessage,{id:"CreateTeamspaceMenu.defaultTeamspace.caption",defaultMessage:"Everyone at {spaceName} must be a member",values:{spaceName:Z}}),disabled:!1,disableAllOptionsTooltip:e?j?(0,r.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.closeOrPrivateTeamspace.disabledTooltipOnlyDefaultTeam",defaultMessage:"Add another default teamspace to change teamspace permissions."}):(0,r.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.defaultTeamspace.disabledTooltipNonAdmin",defaultMessage:"You can't change this setting because you are not a workspace admin"}):void 0,onSelect:()=>a("open",!0)};L.unshift(t)}return L}function C(e){let{title:t,badge:s}=e;const n=(0,o.yK)((()=>({container:{display:"flex",flexWrap:"wrap",alignItems:"center"},badge:{marginLeft:5}})),[]);return(0,r.jsxs)("div",{style:n.container,children:[t,(0,r.jsx)("div",{style:n.badge,children:s})]})}},93823:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Ve});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(15145),l=s(92996),d=s(11002),c=s(9291),u=s(952),p=s(81193),m=s(54642),g=s(4617),h=s(75754),f=s(8055),x=s(13447),y=s(88833),S=s(86095),v=s(34517),b=s(74927),M=s(40663),j=s(50506),C=s(28020),w=s(98165),k=s(48779),T=s(94660),I=s(80444),Z=s(31931),P=s(59307);var F=s(65435),A=s(51247),_=s(84465),R=s(94952),O=s(73314),B=s(1898),D=s(33929),L=s(77080);function V(e){const{subscriptionTier:t,userPersona:s,selectedTopCategory:n}=e,i=function(e){var t;const s=e??(null===(t=P.Z.state.data)||void 0===t?void 0:t.defaultCategoryId);if(!s)return;const n=(0,F.oO)(s);if(!n)return;return{selectedTopCategory:s,allTemplates:E(n)}}(n);return i||function(e){return{selectedTopCategory:void 0,allTemplates:N(e)}}({subscriptionTier:t,userPersona:s})}function N(e){let{userPersona:t,subscriptionTier:s}=e;const n=D.default.getIntl();return Object.fromEntries((0,F.Io)({userPersona:t,subscriptionTier:s}).map((e=>[e,[..._.gh[e].map((e=>(0,M.kY)((0,v.appConfigs)(),e))),..._.J9[e].filter((e=>(0,R.G)(e,L.default))).map((e=>(0,O.G)(e,n)))]])))}function E(e){return e.subcategories.reduce(((e,t)=>{let{id:s,templates:n}=t;return s&&null!=n&&n.length?{...e,[s]:n.map((e=>"preset"===e.type?(0,M.kY)((0,v.appConfigs)(),e.uri):"pageTemplate"===e.type?e.template:void(0,B.t1)(e)))}:e}),{})}var U=s(29949),W=s(41892),K=s(75071),z=s(21202),q=s(31945),G=s(73063),H=s(16354),Y=s(58297),Q=s(64369),$=s(31192),J=s(73205),X=s(82136),ee=s(6258),te=s(69464),se=s(14034),ne=s(85893);function ie(e){const t=(0,i.O7)(),s=(0,c.useIntl)(),n=(0,J.Z)("(max-width: 960px)"),r=(0,a.yK)((e=>({container:{width:"100%",height:"100%",overflow:"auto",flex:1,display:"flex",flexDirection:"column",alignItems:"stretch",background:e.contentBackground,color:e.regularTextColor},contentContainer:{margin:16,padding:"20px 24px",border:"1px solid rgba(0, 0, 0, 0.07)",borderRadius:8,background:e.sidebarBackground,display:"flex",flexDirection:"row",justifyContent:"space-between",columnGap:50,flexWrap:n?"wrap":"nowrap"},getTemplateColumn:{width:n?"100%":void 0,display:"flex",flexDirection:n?"column-reverse":"column"},heroImg:{height:"100%",width:"100%"},getTemplateButton:{width:n?"100%":220,height:38,fontSize:16},addBadgeTeamTemplateButton:{textTransform:"none",color:e.blueColor},madeByContainer:{marginBottom:16,display:"flex",flexDirection:"row",alignItems:"center",gap:6,width:"content-fit"},madeByLabel:{fontSize:14,fontWeight:500},madeByAvatarContainer:{width:30,height:30,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",borderRadius:"50%",border:`1px solid ${e.outlineButtonBorder}`,overflow:"hidden",backgroundColor:"rgb(245, 245, 245)"},madeByAvatar:{width:30,height:30},madeByNotionAvatar:{width:16,height:16}})),[n]),{status:l,selectedTemplate:d,cloneTo:u,selectedTeam:m}=(0,o.VK)((()=>U.Z.state),[]),g=(0,o.VK)((()=>{if("open"===l&&"preset"===(null==d?void 0:d.type)){const e=d.uri,t=(0,M.iX)((0,v.appConfigs)(),e),s=null==t?void 0:t.presets.find((t=>t.uri===e));if(t&&s)return{currentApp:t,currentPreset:s}}}),[l,d]),h=(0,o.VK)((()=>{if(d){if("preset"===d.type){var e;if(!g)return;const{currentPreset:s}=g,n=null===(e=s.previews)||void 0===e?void 0:e.find((e=>"previewRootId"in e)),i=n&&new ee.G(t,{table:z.iU,id:n.previewRootId,spaceId:n.spaceId}),o=i?(0,ne.jsx)("div",{style:{overflow:"hidden",paddingTop:64,paddingLeft:64,paddingRight:64},children:(0,ne.jsx)($.ZP,{store:i,context:X.S.InAppTemplatePreview,styleOverrides:{paddingX:0,pageCoverHeight:0},paddingBottom:0,titleStyle:{fontSize:32},disabled:!0},i.id)}):(0,ne.jsx)("img",{style:r.heroImg,src:W.Z.images.appPackages.projectPreview1Png});return{name:s.name,description:s.description,preview:o}}if("pageTemplate"===d.type){const{template:e}=d,s=new ee.G(t,{table:z.iU,id:e.previewRootId,spaceId:e.spaceId}),n=s.isCollectionView()?64:0,i=(0,ne.jsx)("div",{style:{overflow:"hidden",paddingTop:n,paddingLeft:n,paddingRight:n},children:(0,ne.jsx)($.ZP,{store:s,context:X.S.InAppTemplatePreview,styleOverrides:{paddingX:0},paddingBottom:0,disabled:!0,style:{...s.isFullWidth()?{width:"calc(100% - 64px)",margin:`0 ${A.wN}px`}:{}}})});return{name:e.name,description:e.description,preview:i}}(0,B.t1)(d)}}),[g,t,d,r.heroImg]),f=(0,se.E)(),x=(0,o.VK)((()=>f.filter((e=>e.canAddOrRemoveTopLevelPages()))),[f]),{creatorName:y,creatorAvatar:S,creatorUrl:b}=(0,o.VK)((()=>{if(!d||"preset"===d.type)return{creatorName:"Notion",creatorAvatar:W.Z.images.notionLogoPng,creatorUrl:(0,F.D2)("notion")};const{template:e}=d,{creatorId:s}=e;if(!s){const{creatorName:t,creatorAvatar:s,creatorHandle:n}=e;return{creatorName:t,creatorAvatar:s,creatorUrl:t&&n?(0,F.D2)(n):void 0}}const n=new ee.yj(t,{table:"template_creator",id:s}),i=n.getName(),o=n.getCreatorAvatarWithProtocol(),a=n.getUsername();return{creatorName:i,creatorAvatar:o,creatorUrl:i&&a?(0,F.D2)(a):void 0}}),[d,t]);if("open"!==l||void 0===d||!h)return null;const{name:j,description:C,preview:w}=h,k=x.length>0&&"destination_picker"===u&&!m,I=(0,ne.jsx)(c.FormattedMessage,{id:"templateDetail.getTemplateButton.label",defaultMessage:"Get template"}),Z=(0,ne.jsx)(Y.Z,{style:r.getTemplateButton,onClick:()=>{e.onAcceptTemplate(d,m),p.ye(t,{template_name:j,from:U.Z.state.analyticsFrom,template_id:(0,T.gA)(d),target_team:null==m?void 0:m.id})},children:I}),P=(0,ne.jsx)(te.C,{showMemberCount:!0,showPrivate:!0,placementToOrigin:q.pO.Top,originGap:4,sectionTitle:(0,ne.jsx)(c.FormattedMessage,{...F.cY.addToTeamspace}),renderOrigin:e=>(0,ne.jsx)(Y.Z,{...e,style:r.getTemplateButton,children:I}),onTeamAccept:s=>{e.onAcceptTemplate(d,s),p.ye(t,{template_name:j,from:U.Z.state.analyticsFrom,template_id:(0,T.gA)(d),target_team:s.id})},onPrivateAccept:()=>{e.onAcceptTemplate(d),p.ye(t,{template_name:j,from:U.Z.state.analyticsFrom,template_id:(0,T.gA)(d),target_team:"private"})},right:(0,ne.jsx)(G.Z,{isBlue:!0,style:{borderRadius:"100px",pointerEvents:"none"},icon:K.f,hovered:!0,caption:(0,ne.jsx)(c.FormattedMessage,{defaultMessage:"Add",id:"TemplateDetail.TeamItem.addButton"}),ariaLabel:s.formatMessage({id:"TemplateDetail.TeamItem.addButtonLabel",defaultMessage:"Add"}),captionStyle:r.addBadgeTeamTemplateButton})}),_=y?(0,ne.jsxs)(H.Z,{style:{...r.madeByContainer,...!b&&{cursor:"default"}},href:b,disabled:!b,external:!0,children:[S&&(0,ne.jsx)("div",{style:r.madeByAvatarContainer,children:(0,ne.jsx)("img",{src:S,style:S===W.Z.images.notionLogoPng?r.madeByNotionAvatar:r.madeByAvatar})}),(0,ne.jsx)(Q.Z,{style:r.madeByLabel,children:(0,ne.jsx)(c.FormattedMessage,{id:"templateDetail.madeBy.label.v2",defaultMessage:"By {author}",values:{author:y}})})]}):null;return(0,ne.jsx)(ne.Fragment,{children:(0,ne.jsxs)("div",{style:r.container,children:[(0,ne.jsx)("div",{style:{height:"100%",overflowX:"hidden",overflowY:"auto",maskImage:"linear-gradient(black 80%, transparent 100%)",WebkitMaskImage:"linear-gradient(black 80%, transparent 100%)"},children:(0,ne.jsxs)("div",{style:{position:"relative"},children:[(0,ne.jsx)("div",{style:{marginTop:-20,opacity:1,zIndex:999,pointerEvents:"none"},children:w}),(0,ne.jsx)("div",{style:{backgroundColor:"transparent",position:"absolute",left:0,top:0,right:0,bottom:0,zIndex:1e3}})]})}),(0,ne.jsxs)("div",{style:r.contentContainer,children:[(0,ne.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,ne.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-start",marginBottom:0},children:(0,ne.jsx)("div",{style:{display:"flex",flexDirection:"column",marginLeft:0},children:(0,ne.jsx)("span",{style:{fontSize:20,fontWeight:700,lineHeight:1.2,marginTop:3,marginBottom:12},children:j})})}),(0,ne.jsx)("div",{children:_}),(0,ne.jsx)("div",{style:{fontSize:14},children:C})]}),(0,ne.jsx)("div",{style:r.getTemplateColumn,children:k?P:Z})]})]})})}var oe=s(58573),ae=s(35840),re=s(50226),le=s(88779),de=s(53965),ce=s(73657),ue=s(52275),pe=s(61519),me=s(62896),ge=s(74194),he=s(3386),fe=s(72495),xe=s(18514),ye=s(14694);function Se(e){let{topCategoryId:t,categoryId:s}=e;const n=(0,c.useIntl)(),i=(0,a.yK)((e=>({sidebarTitle:{fontSize:12,color:e.lightTextColor,fontWeight:600,margin:"4px 4px 0 6px"}})),[]),r=(0,o.VK)((()=>{const e=function(){var e;if(!t)return;const n=F.oO(t);return n?null===(e=n.subcategories)||void 0===e?void 0:e.find((e=>e.id===s)):void 0}();if(e)return e.name;const i=_._5[s];return i?n.formatMessage(i):""}),[t,s,n]);return(0,ne.jsx)(ye.Z,{style:i.sidebarTitle,children:r})}var ve=s(83065);function be(){const e=(0,i.O7)(),t=(0,a.yK)((e=>({button:{height:28,padding:"0 4px",borderRadius:5,transition:"background 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start",fontWeight:500,marginLeft:6,marginRight:6,width:"calc(100% - 12px)"},icon:{width:14,height:14,marginLeft:6,transform:"rotate(45deg)"},linkContentV2Container:{display:"flex",flexDirection:"column",gap:4},linkContentV2Title:{display:"flex",flexDirection:"row",alignItems:"center",fontWeight:600,fontSize:14},linkContentV2Subtitle:{maxWidth:250,whiteSpace:"inherit",overflow:"inherit",fontWeight:400,fontSize:13}})),[]);return(0,ne.jsx)(H.Z,{href:(0,xe.UY)("templateGallery"),onClick:()=>p.T2(e),style:{display:"flex",flexDirection:"row",alignItems:"center"},external:!0,children:(0,ne.jsxs)("div",{style:t.linkContentV2Container,children:[(0,ne.jsxs)(Q.Z,{isInline:!1,style:t.linkContentV2Title,children:[(0,ne.jsx)(c.FormattedMessage,{defaultMessage:"More templates",id:"templateGallerySidebar.goToCommunityTemplateGalleryButton.labe2"}),(0,ve._)(t.icon)]}),(0,ne.jsx)(Q.Z,{isInline:!1,isSecondaryColor:!0,style:t.linkContentV2Subtitle,children:(0,ne.jsx)(c.FormattedMessage,{defaultMessage:"Discover thousands of templates made by Notion users like you",id:"templateGallerySidebar.goToCommunityTemplateGalleryButton.reason2"})})]})})}var Me=s(42853),je=s(98519),Ce=s(31701),we=s(37810),ke=s(51077),Te=s(78140),Ie=s(32163),Ze=s(89728),Pe=s(60709),Fe=s(98742);function Ae(e){let{}=e;const t=(0,a.yK)((e=>({newInAppGalleryTopCategoryFilterBarContainer:{border:`1px solid ${e.outlineButtonBorder}`,borderRadius:4,marginBottom:8},newInAppGalleryTopCategoryFilterButton:{display:"flex",alignItems:"center",justifyContent:"space-between",color:e.mediumTextColor,padding:"8px 12px",borderRadius:4,marginRight:0,fontSize:we.Z.fontSize.UIRegular.desktop,background:e.inputBackground},newInAppGalleryTopCategoryFilterChevronIcon:{width:15,height:15,fill:e.mediumIconColor}})),[]),{selectedTopCategory:s}=(0,o.VK)((()=>U.Z.state),[]),n=(0,o.VK)((()=>P.Z.getTopTemplateCategories()),[]),i=(0,o.VK)((()=>s?F.oO(s):void 0),[s]),r=(0,o.VK)((()=>(null==n?void 0:n.length)>0),[n]);return r?(0,ne.jsx)("div",{style:t.newInAppGalleryTopCategoryFilterBarContainer,children:(0,ne.jsx)(q.ZP,{popupType:q.Z4.Popup,alignmentToOrigin:q.vR.End,placementToOrigin:q.pO.Bottom,sameWidthAsOrigin:!0,render:e=>(0,ne.jsx)(Te.Z,{menuType:Pe.og.Popup,children:(0,ne.jsx)(Ie.Z,{type:Ie.i.Vertical,initialFocus:void 0,sections:[{key:"top-category",items:n.map((e=>({key:e.id,action:()=>{if(!r)return;const t=E(e);U.Z.setState({...U.Z.state,selectedTopCategory:e.id,allTemplates:t,limitResults:F.JL(t)})},render:t=>(0,ne.jsx)(ue.Z,{...t,title:(0,ne.jsx)(_e,{category:e,showSelected:e.id===s})})}))),render:e=>(0,ne.jsx)(fe.Z,{...e})}],onAccept:()=>e.close()})}),renderOrigin:e=>(0,ne.jsxs)(Ze.Z,{...(0,Fe.Z)(e,{onClick:()=>{}}),style:t.newInAppGalleryTopCategoryFilterButton,children:[(0,ne.jsx)(_e,{category:i}),(0,Me.i)(t.newInAppGalleryTopCategoryFilterChevronIcon)]})})}):null}function _e(e){let{category:t,showSelected:s=!1}=e;const n=(0,a.yK)((e=>({selectedIconStyle:{width:14,height:14,fill:Ce.ZP.defaultText},categorySelection:{display:"flex",flexDirection:"row",alignItems:"center",gap:8,lineHeight:"20px"},categoryButtonContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}})),[]);return t?(0,ne.jsxs)("span",{style:n.categoryButtonContainer,children:[(0,ne.jsxs)("span",{style:n.categorySelection,children:[(0,ne.jsx)(ke.Z,{type:"notion_icon",size:20,icon:t.icon.name,isLoading:!1,progressPercent:void 0,largeIcon:!0}),(0,ne.jsx)("span",{children:t.name})]}),s&&(0,ne.jsx)("span",{children:(0,je.k)(n.selectedIconStyle)})]}):null}const Re=(0,c.defineMessages)({allPersona:{id:"templateGallery.sidebar.persona.allTemplates",defaultMessage:"All templates"},noResults:{id:"templateGallery.sidebar.results",defaultMessage:"No results"}});function Oe(){const[e,t]=(0,n.useState)(""),s=(0,c.useIntl)(),r=(0,i.O7)(),{selectedCategory:l,status:d}=(0,o.VK)((()=>U.Z.state),[]),[u,m]=(0,n.useState)(!1);(0,n.useEffect)((()=>{if(!u){const t=U.Z.state.selectedTemplate;var e;if(t)null===(e=document)||void 0===e||null===(e=e.getElementById(`tg-${"uri"in t?v.presetUriToHumanReadableName[t.uri]:t.template.name}`))||void 0===e||e.scrollIntoView({block:"center"}),m(!0)}}),[u]),(0,n.useEffect)((()=>{"closed"===d&&m(!1)}),[m,d]);const g=(0,a.yK)((e=>({sidebar:{height:"100%",width:A.dm,background:e.sidebarBackground,alignContent:"center",display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"stretch",boxShadow:e.sidebarBoxShadow},sidebarMoreFromCommunityContainer:{padding:12,borderTop:`1px solid ${e.accentColors.translucentGray[200]}`},header:{padding:"12px 12px 0 12px"},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor},searchBar:{height:32,borderRadius:5,fontSize:14,marginTop:0,marginBottom:8,padding:"16px 10px"},filterBar:{display:"flex",flexDirection:"row",width:273,flexWrap:"wrap",gap:6},newInAppGalleryBrandContainer:{display:"flex",alignItems:"center",width:"100%",gap:6,marginBottom:10},newInAppGalleryBrandName:{fontSize:15,fontWeight:600,color:e.regularTextColor},newInAppGalleryBrandIcon:{width:18,height:15,fill:e.regularTextColor},newInAppGallerySearchBarContainer:{padding:"0px 12px"}})),[]),h=(0,n.useMemo)((()=>(0,ne.jsx)(he.Z,{debugName:"TemplateGallerySidebar",capture:!0,onBackspace:de.yR,onLeft:de.yR,onRight:de.yR,onSelectAll:de.yR,onRedo:de.yR,onUndo:de.yR,onCut:de.yR,onCopy:de.yR,onPaste:de.yR,onKeypress:de.yR,onDelete:de.yR,onTab:de.yR,children:(0,ne.jsx)(ge.Z,{placeholder:s.formatMessage({id:"templateGallery.sidebar.searchbar.placeholder",defaultMessage:"Search templates"}),left:(0,ae.R)(g.searchIcon),showClearButton:!0,format:ge.B.Small,value:e,style:g.searchBar,onChange:e=>t(e.target.value)})})),[e,s,g.searchBar,g.searchIcon]);return(0,ne.jsxs)("div",{style:g.sidebar,children:[(0,ne.jsxs)("div",{style:g.header,children:[(0,ne.jsxs)(H.Z,{href:(0,xe.UY)("templateGallery"),onClick:()=>p.Ib(r),style:g.newInAppGalleryBrandContainer,external:!0,children:[(0,re.I)(g.newInAppGalleryBrandIcon),(0,ne.jsx)("span",{style:g.newInAppGalleryBrandName,children:(0,ne.jsx)(c.FormattedMessage,{id:"templateGallery.brand.title",defaultMessage:"Templates"})})]}),(0,ne.jsx)(Ae,{})]}),(0,ne.jsx)("div",{style:g.newInAppGallerySearchBarContainer,children:h}),(0,ne.jsx)(Be,{currentQuery:e,selectedCategory:l}),(0,ne.jsxs)("div",{children:[(0,ne.jsx)(pe.Z,{size:"0"}),(0,ne.jsx)("div",{style:g.sidebarMoreFromCommunityContainer,children:(0,ne.jsx)(be,{})})]})]})}function Be(e){const{currentQuery:t,selectedCategory:s}=e,i=""!==t||void 0!==s,{allTemplates:r,selectedTopCategory:l,status:d,limitResults:u}=(0,o.VK)((()=>U.Z.state),[]),p=(0,a.yK)((e=>({button:{height:44,padding:"8px 0",borderRadius:4,marginBottom:4,transition:"all 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start"},categoryDiv:{marginBottom:i?0:14},unSelectedItem:{color:e.mediumTextColor},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.buttonHoveredBackground,fontWeight:500,color:e.regularTextColor},hoveredItem:{borderRadius:4,background:e.buttonHoveredBackground},presetTitle:{fontSize:14,color:e.regularTextColor},presetDescription:{fontSize:12},sidebarTitle:{fontSize:12,color:e.lightTextColor,fontWeight:600,margin:"4px 4px 0 6px"},sidebarShowMore:{fontSize:12,color:e.lightTextColor,fontWeight:600,margin:"2px 2px 0 6px"}})),[i]),m=(0,o.VK)((()=>{if("open"!==d||void 0===r)return[];const e=new Set;return Object.fromEntries(Object.entries(r).filter((e=>{let[t]=e;return void 0===s||t===s})).map((s=>{let[n,i]=s;return[n,(0,oe.ZP)(t.replaceAll("-",""),i,(e=>`${e.name}`.replaceAll("-",""))).filter((t=>{const s=e.has(t.name);return e.add(t.name),!s}))]})))}),[d,r,s,t]),g=(0,n.useCallback)((e=>{"open"===d&&void 0!==u&&U.Z.setState({...U.Z.state,limitResults:{...u,[e]:!1}})}),[u,d]);return"open"!==d?null:(0,ne.jsx)("div",{style:{flexGrow:1,width:"100%",overflowX:"hidden",overflowY:"auto"},children:(0,ne.jsxs)(fe.Z,{desktopTitleStyle:{paddingLeft:8},children:[Object.entries(m).map((e=>{let[t,s]=e;if(0===s.length)return;const n=(null==u?void 0:u[t])&&!i&&s.length>T.IJ+1,o=n?s.length-T.IJ:0,a=n?s.slice(0,T.IJ):s;return(0,ne.jsxs)("div",{style:p.categoryDiv,children:[!i&&(0,ne.jsx)(Se,{topCategoryId:l,categoryId:t}),a.map((e=>"uri"in e?(0,ne.jsx)(De,{icon:e.icon,name:e.name,template:{type:"preset",uri:e.uri},preferIcon:!0},e.uri):(0,ne.jsx)(De,{icon:e.icon,emoji:e.emoji,name:e.name,template:{type:"pageTemplate",template:e},preferIcon:"suggested"===t},e.id))),n&&o>0?(0,ne.jsx)(ue.Z,{style:p.sidebarShowMore,focused:!1,onClick:()=>g(t),title:(0,ne.jsx)(c.FormattedMessage,{defaultMessage:"{numNotShown} more...",id:"templateGallerySidebar.category.showMore",values:{numNotShown:o}})}):void 0]},t)})),0===Object.values(m).flatMap((e=>e)).length&&(0,ne.jsx)(ce.Z,{caption:D.default.formatMessage(Re.noResults),style:{lineHeight:"14px",padding:6,margin:0}})]})})}function De(e){var t;const s=(0,i.O7)(),r=(0,a.yK)((e=>({button:{height:28,padding:"0 4px",borderRadius:5,transition:"background 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start",fontWeight:500,marginLeft:6,marginRight:6,width:"calc(100% - 12px)"},itemText:{marginLeft:5},unSelectedItemText:{color:e.mediumTextColor},selectedItemText:{color:e.regularTextColor},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.sidebarItemSelectedBackground,fontWeight:500},hoveredItem:{background:e.buttonHoveredBackground},presetIcon:{width:16,height:16,fontSize:16,color:e.regularEmojiColor},presetTitle:{fontSize:14},presetDescription:{fontSize:12}})),[]),{status:l,selectedTemplate:d,analyticsFrom:c}=(0,o.VK)((()=>U.Z.state),[]),u=(0,o.VK)((()=>"open"===l&&de.Xy(d,e.template)),[l,e.template,d]),m=(0,n.useCallback)((()=>{const t="uri"in e.template?v.presetUriToHumanReadableName[e.template.uri]:e.template.template.previewRootId,n=(0,T.W4)({templateGalleryItem:t});f.c4({environment:s,url:n}),p.n1(s,{template_name:"preset"===e.template.type?e.template.uri:e.template.template.name,page_prepopulated_template_id:t,from:c})}),[c,s,e.template]);if("open"!==l)return null;let g=(0,ne.jsx)("div",{style:r.presetIcon,children:(0,ne.jsx)(me.Z,{children:le.kQ})});e.preferIcon&&null!==(t=e.icon)&&void 0!==t&&t.startsWith("/")?g=(0,ne.jsx)("img",{src:e.icon,style:r.presetIcon}):e.emoji&&(g=(0,ne.jsx)("div",{style:r.presetIcon,children:(0,ne.jsx)(me.Z,{children:e.emoji})}));const h=`tg-${"uri"in e.template?v.presetUriToHumanReadableName[e.template.uri]:e.template.template.name}`;return(0,ne.jsx)(ue.Z,{id:h,desktopIconStyle:{alignSelf:"unset"},buttonStyle:{...r.button,...u?r.selectedItem:void 0},textWrapperStyle:{...u?r.selectedItemText:r.unSelectedItemText,...r.itemText},focused:!1,icon:g,title:(0,ne.jsx)("span",{style:r.presetTitle,children:e.name}),shouldWrapCaption:!0,hoveredStyle:r.hoveredItem,onClick:m})}const Le=["companyHome","defaultWiki","engineeringWiki","salesWiki","teamWiki"];function Ve(){const e=(0,i.Fy)(),t=(0,i.O7)(),s=(0,c.useIntl)(),d=(0,n.useRef)(void 0),_=(0,a.yK)((t=>({modal:{width:e.isMobile?"auto":`${A.E2}vw`,height:e.isMobile?"auto":`${A.YQ}vh`,borderRadius:8}})),[e.isMobile]),R=(0,o.VK)((()=>I.default.state.currentSpaceStore),[]),{templateGalleryItem:O}=(0,o.VK)((()=>t.RouterStore.state.route),[t.RouterStore]),{status:B,allTemplates:D,selectedTemplate:L,cloneTo:N,limitResults:E}=(0,o.VK)((()=>U.Z.state),[]);(0,n.useEffect)((()=>{if(O)return d.current=window.setTimeout((()=>{U.Z.setState({...U.Z.state,status:"closed"})}),1e4),()=>{void 0!==d.current&&window.clearTimeout(d.current)}}),[]);const W=(0,n.useRef)(void 0);(0,n.useEffect)((()=>{W.current&&(W.current=void 0)}),[null==R?void 0:R.id]),(0,n.useEffect)((()=>{var e;W.current&&"opening"!==B||"closed"!==B&&(W.current||(W.current=async function(e){const{environment:t,spaceId:s}=e,n=await m.getInAppCategoriesAndTemplates(t,{spaceId:s});return"success"===n.type&&(P.Z.setState({data:n.data}),"current"===n.data.version)}({environment:t,spaceId:null==R?void 0:R.id})),null===(e=W.current)||void 0===e||e.then((()=>{var e;const t=O&&F.vY(O),{selectedTopCategory:s,allTemplates:n}=V({userPersona:(0,k.kO)().function,subscriptionTier:null===(e=I.default.state.currentSpaceStore)||void 0===e?void 0:e.getSubscriptionTier(),selectedTopCategory:t});U.Z.setState({...U.Z.state,selectedTopCategory:s,allTemplates:n,limitResults:F.JL(n)})})).finally((()=>{void 0!==d.current&&window.clearTimeout(d.current)})))}),[t,null==R?void 0:R.id,W,B,O]),(0,n.useEffect)((()=>{if(void 0!==D&&"opening"===B){const e=void 0!==L&&(void 0===O||"gallery"===O)?L:Ne({templateGalleryItem:O,allTemplates:D,environment:t});return U.Z.setState({...U.Z.state,status:"open",allTemplates:D,selectedTemplate:e,limitResults:E??F.JL(D),cloneTo:U.Z.state.cloneTo,analyticsFrom:U.Z.state.analyticsFrom}),void p.jW(t,{template_name:"preset"===e.type?e.uri:e.template.name,template_id:(0,T.gA)(e),from:U.Z.state.analyticsFrom})}}),[O,t,D,B,L,N,E]),(0,n.useEffect)((()=>{"open"===B&&void 0!==D&&void 0!==O&&"gallery"!==O&&U.Z.setState({...U.Z.state,selectedTemplate:Ne({templateGalleryItem:O,allTemplates:D})})}),[D,B,O]);const K=(0,o.VK)((()=>{const e=(0,C.np)();if("open"===B&&"current_page"===N&&e&&e.isEmptyPage())return e}),[N,B]),z=(0,n.useCallback)((async(e,s)=>{var n,i,o;U.Z.setState({...U.Z.state,status:"closed",selectedTemplate:void 0});const{currentSpaceStore:a,currentSpaceViewStore:d}=I.default.state,c=null==K||!K.getParentStore()||"block"!==(null===(n=K.getParentStore())||void 0===n?void 0:n.table)&&"space"!==(null===(i=K.getParentStore())||void 0===i?void 0:i.table)&&"team"!==(null===(o=K.getParentStore())||void 0===o?void 0:o.table)?s||a:K.getParentStore(),f=Date.now();let j;if("preset"===e.type&&(0,l.SA)(e.uri)){var C;const n=e.uri,i=null===(C=(0,M.iX)((0,v.appConfigs)(),n))||void 0===C?void 0:C.uri;if(!(i&&a&&d&&c))return;const o=s||w.VP(c);if(o){const e=await async function(e){let{environment:t,spaceId:s,presetUri:n,teamStore:i}=e;return await(0,Z.l)({environment:t,spaceId:s,presetUri:n,parentStore:i,teamId:i.id,from:"template_gallery"})}({environment:t,spaceId:a.id,presetUri:n,teamStore:o});if(!e)return}const r=K||(s?s.getTeamPagesStores().find((e=>e.getFormat().app_config_uri&&e.getFormat().app_config_uri===i)):void 0);x.createAndCommit({environment:t,userAction:"templateGallery.getTemplate",perform:e=>{const s=(0,v.appConfigs)().find((e=>e.uri===i)),o=null==s?void 0:s.presets.find((e=>e.uri===n));if(d&&o){const s=y.initializeApp({environment:t,spaceViewStore:d,appUri:i,presetUri:o.uri,appParentStore:c,temporaryContainerBlockStore:r,transaction:e,from:"template_gallery"});y.markTasksDatabaseTemplateIfNeeded(s),S.createSprintPage({environment:t,spaceViewStore:d,appParentStore:c,transaction:e,blockStores:s,creationEntryPoint:{type:"preset",presetUri:o.uri}})}}}),m.finalizeAppTemplate(t,{})}else{const n="preset"===e.type?(0,b.CQ)(e.uri):e.template;if(!n)return;if(!a||!d)return;const i={environment:t,item:n,spaceStore:a,spaceViewStore:d,useMinimalTemplates:!1,from:"template_gallery"},o=K?await g.rC({...i,isPrivate:!1,initializeStore:K,type:"inExistingStore"}):s?await g.rC({...i,isPrivate:!1,teamStore:s,type:"inTeam",appendOrPrepend:"append"}):await g.rC({...i,isPrivate:!0,type:"inSpace"});j=o,o&&h._c({environment:t,store:o,pageVisitSource:r.tY.Create})}const k="preset"===e.type?e.uri:e.template.name,T=Date.now()-f,P=K?!w.VP(K):!Boolean(s),F=P||null==s?void 0:s.id,A=j?j.id:null==K?void 0:K.id;p.en(t,{template_name:k,destination:P?"private":"team",template_block_id:"pageTemplate"===e.type?e.template.rootId:void 0,template_duplication_duration_ms:T,team_id:F,created_page_id:A}),u.W(t,{type:"page",from:"template_gallery",new_page_id:A,creating_block_id:A}),"preset"===e.type&&(0,l.SA)(e.uri)&&j&&p.bR(t,{preset_uri:e.uri,created_block_stores:[j],from:"template_gallery",destination_team_id:F}),"pageTemplate"===e.type&&Ue(e.template.id)&&j&&p.Jw(t,{from:"template_gallery",wiki_block_id:j.id,destination_team_id:F,wiki_template_id:e.template.id})}),[t,K]),q=(0,n.useCallback)((()=>{const{mainEditorCurrentBlockStore:e}=I.default.state,{RouterStore:s}=t,n=s.state.route;if(e&&"page"===n.name){const e=(0,T.p8)();f.c4({environment:t,url:e})}}),[t]);return(0,ne.jsx)(j.Z,{ariaLabel:s.formatMessage({id:"templateGallery.dialogLabel",defaultMessage:"Templates"}),open:"open"===B,innerStyle:_.modal,onDismiss:q,render:()=>"open"!==B?null:(0,ne.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"row",borderRadius:8,overflow:"hidden"},children:[(0,ne.jsx)(Oe,{}),(0,ne.jsx)(ie,{onAcceptTemplate:z})]})})}function Ne(e){let{templateGalleryItem:t,allTemplates:s,environment:n}=e;if(!t||"gallery"===t){var i;return"team"===(null===(i=I.default.state.currentSpaceStore)||void 0===i?void 0:i.getPlanType())?{type:"preset",uri:l.Yb}:Ee(s)}const o=Object.values(s).flatMap((e=>e)).find((e=>"uri"in e?v.presetUriToHumanReadableName[e.uri]===t:e.previewRootId===t));return o?"uri"in o?{type:"preset",uri:o.uri}:{type:"pageTemplate",template:o}:(n&&p.Ui(n,{templateBlockId:t}),Ee(s))}function Ee(e){const t=e[Object.keys(e)[0]][0];return"uri"in t?{type:"preset",uri:t.uri}:{type:"pageTemplate",template:t}}function Ue(e){return Le.some((t=>d.Y[t].nameMessage.id===e))}},94919:(e,t,s)=>{s.d(t,{W:()=>o});s(67294);var n=s(31919),i=s(85893);function o(e){const{cost:t,intl:s}=e,o=e.trailingZeroDisplay??"auto",a=e.currencySign??"accounting",r=n.n.fromValue(t);let l=s.formatNumber(r.amount/Math.pow(10,r.currencyValue.minorUnitDigits),{style:"currency",currency:r.currencyCode,currencyDisplay:"symbol",currencySign:a});return"stripIfInteger"===o&&(l=l.replace(new RegExp(`[.,]0{${r.currencyValue.minorUnitDigits}}(\\s+.*)?$`),"$1")),(0,i.jsx)(i.Fragment,{children:l})}},47612:(e,t,s)=>{s.d(t,{C:()=>o});s(67294);var n=s(45238),i=s(85893);const o=(0,n.IU)("addPersonCircle",{viewBox:"0 0 50 43",svg:(0,i.jsx)("path",{d:"M28.5 42c11.214 0 20.535-9.322 20.535-20.535C49.035 10.23 39.694.93 28.48.93 17.99.93 9.233 9.003 8.106 19.21c.987-.181 2.416-.262 3.483-.141 1.107-8.355 8.194-14.717 16.89-14.717 9.483 0 17.133 7.61 17.133 17.113 0 4.429-1.65 8.455-4.409 11.455-1.973-2.356-6.643-4.61-12.723-4.61a22.58 22.58 0 00-5.295.624 12.85 12.85 0 01-2.718 11.375 19.941 19.941 0 008.033 1.69zm-.02-17.113c3.865.04 6.905-3.261 6.905-7.59 0-4.067-3.06-7.429-6.905-7.429-3.866 0-6.946 3.362-6.905 7.43.02 4.308 3.04 7.549 6.905 7.589zM10.562 42.221c5.537 0 10.227-4.63 10.227-10.227 0-5.617-4.61-10.227-10.227-10.227-5.597 0-10.227 4.63-10.227 10.227 0 5.637 4.63 10.227 10.227 10.227zm0-3.825c-.745 0-1.228-.483-1.228-1.228v-3.946H5.388c-.725 0-1.228-.483-1.228-1.228s.503-1.228 1.228-1.228h3.946V26.82c0-.725.483-1.228 1.228-1.228s1.228.503 1.228 1.228v3.946h3.946c.725 0 1.228.483 1.228 1.228s-.503 1.228-1.228 1.228H11.79v3.946c0 .745-.483 1.228-1.228 1.228z"})})},15769:(e,t,s)=>{s.d(t,{Q:()=>o});s(67294);var n=s(45238),i=s(85893);const o=(0,n.IU)("androidShare",{viewBox:"0 0 15 15",svg:(0,i.jsx)("path",{d:"M11.9952,10.6024 C11.4229,10.6024 10.9108,10.8283 10.51928,11.1822 L5.15029999,8.05723 C5.18794999,7.88404 5.21806999,7.71084 5.21806999,7.53012 C5.21806999,7.3494 5.18794999,7.1762 5.15029999,7.00301 L10.45904,3.90813 C10.8657,4.28464 11.4003,4.51807 11.9952,4.51807 C13.2452,4.51807 14.2542,3.50904 14.2542,2.25904 C14.2542,1.00904 13.2452,0 11.9952,0 C10.7452,0 9.73614999,1.00904 9.73614999,2.25904 C9.73614999,2.43976 9.76626999,2.61295 9.80391999,2.78614 L4.49517999,5.88102 C4.08854999,5.50452 3.55391999,5.27108 2.95903999,5.27108 C1.70903999,5.27108 0.699999988,6.28012 0.699999988,7.53012 C0.699999988,8.78012 1.70903999,9.78916 2.95903999,9.78916 C3.55391999,9.78916 4.08854999,9.55572 4.49517999,9.17922 L9.85662999,12.3117 C9.81897999,12.4699 9.79638999,12.6355 9.79638999,12.8012 C9.79638999,14.0136 10.7828,15 11.9952,15 C13.2075,15 14.194,14.0136 14.194,12.8012 C14.194,11.5889 13.2075,10.6024 11.9952,10.6024 Z"})})},52867:(e,t,s)=>{s.d(t,{H:()=>o});s(67294);var n=s(45238),i=s(85893);const o=(0,n.IU)("archive",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M4.083 14.585h7.499c1.347 0 2.064-.697 2.064-2.037V5.739c.664-.11 1.019-.608 1.019-1.34V3.36c0-.834-.458-1.36-1.299-1.36H2.3C1.499 2 1 2.526 1 3.36V4.4c0 .73.355 1.23 1.019 1.34v6.808c0 1.347.717 2.037 2.064 2.037zM2.579 4.728c-.342 0-.478-.144-.478-.486v-.724c0-.342.136-.486.478-.486h10.514c.342 0 .472.144.472.486v.724c0 .342-.13.486-.472.486H2.579zm1.49 8.825c-.615 0-.95-.335-.95-.95V5.76h9.427v6.842c0 .616-.342.95-.95.95H4.069zM5.58 8.515h4.512c.287 0 .492-.199.492-.5v-.218c0-.3-.205-.492-.492-.492H5.58c-.287 0-.485.191-.485.492v.219c0 .3.198.499.485.499z"})})},37652:(e,t,s)=>{s.d(t,{V:()=>o});s(67294);var n=s(45238),i=s(85893);const o=(0,n.IU)("arrowLeft",{viewBox:"0 0 30 30",svg:(0,i.jsx)("polygon",{points:"29 14 4.813 14 13.406 5.406 12 4 1 15 12 26 13.406 24.594 4.813 16 29 16"})})},77366:(e,t,s)=>{s.d(t,{F:()=>o});s(67294);var n=s(45238),i=s(85893);const o=(0,n.IU)("customizePage",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M10.5361 5.54883C11.2744 5.54883 11.9033 5.09082 12.1631 4.44141H14.4258C14.7607 4.44141 15.0479 4.14746 15.0479 3.79199C15.0479 3.43652 14.7676 3.14258 14.4258 3.14258H12.1699C11.9102 2.49316 11.2744 2.03516 10.5361 2.03516C9.79785 2.03516 9.16211 2.49316 8.90234 3.14258H1.59473C1.23242 3.14258 0.952148 3.43652 0.952148 3.79199C0.952148 4.14746 1.23926 4.44141 1.59473 4.44141H8.90234C9.16211 5.09082 9.79785 5.54883 10.5361 5.54883ZM10.5361 4.62598C10.0713 4.62598 9.69531 4.25684 9.69531 3.79199C9.69531 3.31348 10.0713 2.95117 10.5361 2.95117C11.0078 2.95117 11.3701 3.31348 11.3701 3.79199C11.3701 4.25684 11.0078 4.62598 10.5361 4.62598ZM1.56738 7.40137C1.23242 7.40137 0.952148 7.68848 0.952148 8.05078C0.952148 8.39941 1.23926 8.69336 1.56738 8.69336H3.91211C4.16504 9.34277 4.80078 9.80762 5.5459 9.80762C6.27734 9.80762 6.91309 9.34277 7.17285 8.69336H14.4053C14.7607 8.69336 15.0479 8.40625 15.0479 8.05078C15.0479 7.68848 14.7676 7.40137 14.4053 7.40137H7.17285C6.91309 6.75195 6.27734 6.29395 5.5459 6.29395C4.80762 6.29395 4.17188 6.75195 3.91211 7.40137H1.56738ZM5.5459 8.88477C5.07422 8.88477 4.70508 8.51562 4.70508 8.05078C4.70508 7.57227 5.07422 7.20996 5.5459 7.20996C6.01758 7.20996 6.37988 7.57227 6.37988 8.05078C6.37988 8.51562 6.01758 8.88477 5.5459 8.88477ZM10.5361 14.0596C11.2744 14.0596 11.9102 13.6016 12.1699 12.9521H14.4258C14.7607 12.9521 15.0479 12.6582 15.0479 12.3027C15.0479 11.9404 14.7676 11.6533 14.4258 11.6533H12.1631C11.9102 11.0039 11.2744 10.5459 10.5361 10.5459C9.79785 10.5459 9.16211 11.0039 8.90234 11.6533H1.59473C1.23242 11.6533 0.952148 11.9473 0.952148 12.3027C0.952148 12.6582 1.23926 12.9521 1.59473 12.9521H8.90234C9.16211 13.6016 9.79785 14.0596 10.5361 14.0596ZM10.5361 13.1436C10.0713 13.1436 9.69531 12.7676 9.69531 12.3027C9.69531 11.8311 10.0713 11.4619 10.5361 11.4619C11.0078 11.4619 11.3701 11.8311 11.3701 12.3027C11.3701 12.7676 11.0078 13.1436 10.5361 13.1436Z"})})},25942:(e,t,s)=>{s.d(t,{P:()=>o});s(67294);var n=s(45238),i=s(85893);const o=(0,n.IU)("expandThin",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.992.61c.156 0 .3.033.43.1.13.069.27.16.422.274l5.265 4.25a.948.948 0 01.368.774 1 1 0 01-.149.547c-.099.156-.229.28-.39.375a1.013 1.013 0 01-.508.133 1.07 1.07 0 01-.399-.079 1.6 1.6 0 01-.375-.226L7.992 3.016 3.336 6.758a1.74 1.74 0 01-.383.226 1.056 1.056 0 01-.906-.055 1.145 1.145 0 01-.383-.374 1 1 0 01-.148-.547c0-.318.122-.576.367-.774L7.148.984C7.3.87 7.44.78 7.57.711a.9.9 0 01.422-.102zm0 14.85a.901.901 0 01-.422-.1 2.288 2.288 0 01-.422-.274l-5.265-4.25a.962.962 0 01-.367-.774 1.055 1.055 0 01.531-.914 1.01 1.01 0 01.906-.062c.125.052.253.128.383.226l4.656 3.743 4.664-3.742a1.6 1.6 0 01.375-.227c.13-.052.263-.078.399-.078a.97.97 0 01.508.14 1.036 1.036 0 01.539.915c0 .312-.123.57-.368.773l-5.265 4.258a2.512 2.512 0 01-.422.265.917.917 0 01-.43.102z"})})},43876:(e,t,s)=>{s.d(t,{s:()=>o});s(67294);var n=s(45238),i=s(85893);const o=(0,n.IU)("iOSShare",{viewBox:"0 0 27 27",svg:(0,i.jsx)("path",{d:"M13.4902 15.6055C13.9102 15.6055 14.2715 15.2539 14.2715 14.8438V4.81445L14.2129 3.34961L14.8672 4.04297L16.3516 5.625C16.4883 5.78125 16.6836 5.85938 16.8789 5.85938C17.2793 5.85938 17.5918 5.56641 17.5918 5.16602C17.5918 4.96094 17.5039 4.80469 17.3574 4.6582L14.0566 1.47461C13.8613 1.2793 13.6953 1.21094 13.4902 1.21094C13.2949 1.21094 13.1289 1.2793 12.9238 1.47461L9.62305 4.6582C9.47656 4.80469 9.39844 4.96094 9.39844 5.16602C9.39844 5.56641 9.69141 5.85938 10.1016 5.85938C10.2871 5.85938 10.502 5.78125 10.6387 5.625L12.1133 4.04297L12.7773 3.34961L12.7188 4.81445V14.8438C12.7188 15.2539 13.0703 15.6055 13.4902 15.6055ZM7.89453 23.252H19.0957C21.1367 23.252 22.1621 22.2363 22.1621 20.2246V10.4785C22.1621 8.4668 21.1367 7.45117 19.0957 7.45117H16.3711V9.02344H19.0664C20.0332 9.02344 20.5898 9.55078 20.5898 10.5664V20.1367C20.5898 21.1523 20.0332 21.6797 19.0664 21.6797H7.91406C6.9375 21.6797 6.40039 21.1523 6.40039 20.1367V10.5664C6.40039 9.55078 6.9375 9.02344 7.91406 9.02344H10.6191V7.45117H7.89453C5.85352 7.45117 4.82812 8.4668 4.82812 10.4785V20.2246C4.82812 22.2363 5.85352 23.252 7.89453 23.252Z"})})},60493:(e,t,s)=>{s.d(t,{N:()=>o});s(67294);var n=s(45238),i=s(85893);const o=(0,n.IU)("infoFilled",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.99634 15.5659C6.96118 15.5659 5.98706 15.3682 5.07397 14.9727C4.16089 14.582 3.35522 14.0376 2.65698 13.3394C1.96362 12.6411 1.41919 11.8354 1.02368 10.9224C0.628174 10.0093 0.43042 9.03516 0.43042 8C0.43042 6.96484 0.628174 5.99072 1.02368 5.07764C1.41919 4.16455 1.96362 3.36133 2.65698 2.66797C3.35522 1.96973 4.15845 1.42285 5.06665 1.02734C5.97974 0.631836 6.95386 0.434082 7.98901 0.434082C9.02905 0.434082 10.0056 0.631836 10.9187 1.02734C11.8318 1.42285 12.6375 1.96973 13.3357 2.66797C14.0339 3.36133 14.5808 4.16455 14.9763 5.07764C15.3718 5.99072 15.5696 6.96484 15.5696 8C15.5696 9.03516 15.3718 10.0093 14.9763 10.9224C14.5808 11.8354 14.0339 12.6411 13.3357 13.3394C12.6375 14.0376 11.8318 14.582 10.9187 14.9727C10.0056 15.3682 9.03149 15.5659 7.99634 15.5659ZM6.65601 12.2114H9.7395C9.91528 12.2114 10.0618 12.1577 10.179 12.0503C10.2961 11.938 10.3547 11.7939 10.3547 11.6182C10.3547 11.4521 10.2961 11.313 10.179 11.2007C10.0618 11.0835 9.91528 11.0249 9.7395 11.0249H8.89722V7.43604C8.89722 7.20654 8.84106 7.021 8.72876 6.87939C8.61646 6.73779 8.45288 6.66699 8.23804 6.66699H6.78784C6.61694 6.66699 6.4729 6.72559 6.35571 6.84277C6.23853 6.95996 6.17993 7.09912 6.17993 7.26025C6.17993 7.43604 6.23853 7.58008 6.35571 7.69238C6.4729 7.7998 6.61694 7.85352 6.78784 7.85352H7.55688V11.0249H6.65601C6.48511 11.0249 6.33862 11.0835 6.21655 11.2007C6.09937 11.313 6.04077 11.4521 6.04077 11.6182C6.04077 11.7939 6.09937 11.938 6.21655 12.0503C6.33862 12.1577 6.48511 12.2114 6.65601 12.2114ZM7.95239 5.48779C8.24536 5.48779 8.49194 5.38525 8.69214 5.18018C8.89233 4.9751 8.99243 4.73096 8.99243 4.44775C8.99243 4.1499 8.89233 3.90088 8.69214 3.70068C8.49194 3.49561 8.24536 3.39307 7.95239 3.39307C7.66431 3.39307 7.41772 3.49561 7.21265 3.70068C7.00757 3.90088 6.90503 4.1499 6.90503 4.44775C6.90503 4.73096 7.00757 4.9751 7.21265 5.18018C7.41772 5.38525 7.66431 5.48779 7.95239 5.48779Z"})})},43121:(e,t,s)=>{s.d(t,{f:()=>o});s(67294);var n=s(45238),i=s(85893);const o=(0,n.IU)("key",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M14.757 4A5.724 5.724 0 009 9.748c0 2.364 1.389 4.456 3.586 5.335V23.6c0 .255.079.483.272.676l1.53 1.477a.578.578 0 00.808-.009l2.769-2.768a.598.598 0 000-.87l-1.591-1.574 2.232-2.232a.602.602 0 00-.017-.861l-2.171-2.18c2.628-1.116 4.087-3.13 4.087-5.511A5.733 5.733 0 0014.757 4zm0 5.344a1.55 1.55 0 01-1.547-1.547c0-.861.685-1.547 1.547-1.547a1.55 1.55 0 011.547 1.547 1.55 1.55 0 01-1.547 1.547z"})})},22962:(e,t,s)=>{s.d(t,{O:()=>o});s(67294);var n=s(45238),i=s(85893);const o=(0,n.IU)("mention",{viewBox:"0 0 20 20",svg:(0,i.jsx)("path",{d:"M1 9.86523C1 15.2939 4.72705 18.6807 9.98975 18.6807C11.3511 18.6807 12.4634 18.5312 13.1606 18.2905C13.6919 18.1079 13.8828 17.8174 13.8828 17.4521C13.8828 17.0537 13.6089 16.7715 13.1523 16.7715C13.0195 16.7715 12.8784 16.7881 12.6958 16.8213C11.9238 16.9873 11.2266 17.1118 10.2637 17.1118C5.74805 17.1118 2.74316 14.4058 2.74316 9.91504C2.74316 5.56543 5.61523 2.56055 9.88184 2.56055C13.7417 2.56055 16.7383 4.97607 16.7383 9.11816C16.7383 11.3511 15.9995 12.8452 14.8125 12.8452C14.0239 12.8452 13.5757 12.3472 13.5757 11.4839V6.44531C13.5757 5.84766 13.252 5.49072 12.6709 5.49072C12.0981 5.49072 11.7578 5.84766 11.7578 6.44531V7.10107H11.6333C11.21 6.09668 10.2305 5.49072 9.01855 5.49072C6.90186 5.49072 5.43262 7.28369 5.43262 9.89844C5.43262 12.5547 6.91846 14.3892 9.11816 14.3892C10.3799 14.3892 11.3013 13.7417 11.7578 12.6045H11.8823C12.1147 13.7168 13.0942 14.3809 14.4307 14.3809C16.8877 14.3809 18.3984 12.1895 18.3984 8.96045C18.3984 4.1626 14.8706 1 9.89014 1C4.66064 1 1 4.56104 1 9.86523ZM9.5415 12.7207C8.26318 12.7207 7.46631 11.6499 7.46631 9.92334C7.46631 8.21338 8.27148 7.14258 9.5498 7.14258C10.8364 7.14258 11.6582 8.20508 11.6582 9.89844C11.6582 11.625 10.8281 12.7207 9.5415 12.7207Z"})})},80342:(e,t,s)=>{s.d(t,{$:()=>o});s(67294);var n=s(45238),i=s(85893);const o=(0,n.IU)("minus",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M3.037 8.844h9.92a.705.705 0 00.368-.103.825.825 0 00.28-.28.73.73 0 000-.773.752.752 0 00-.28-.28.705.705 0 00-.369-.102H3.037a.705.705 0 00-.369.102.824.824 0 00-.28.28.73.73 0 000 .772.914.914 0 00.28.281.705.705 0 00.37.103z"})})},4635:(e,t,s)=>{s.d(t,{W:()=>o});s(67294);var n=s(45238),i=s(85893);const o=(0,n.IU)("options",{viewBox:"0 0 17 15",svg:(0,i.jsx)("path",{d:"M11.2871 4.48438C12.1309 4.48438 12.8574 3.95312 13.1621 3.21875H15.7324C16.123 3.21875 16.4512 2.875 16.4512 2.46094C16.4512 2.04688 16.123 1.71094 15.7324 1.71094H13.1621C12.8652 0.96875 12.1387 0.4375 11.2871 0.4375C10.4355 0.4375 9.70898 0.96875 9.41211 1.71094H1.04492C0.630859 1.71094 0.302734 2.04688 0.302734 2.46094C0.302734 2.875 0.630859 3.21875 1.04492 3.21875H9.41211C9.7168 3.95312 10.4434 4.48438 11.2871 4.48438ZM11.2871 3.42188C10.748 3.42188 10.3262 2.99219 10.3262 2.46094C10.3262 1.91406 10.748 1.49219 11.2871 1.49219C11.834 1.49219 12.248 1.91406 12.248 2.46094C12.248 2.99219 11.834 3.42188 11.2871 3.42188ZM1.02148 6.58594C0.630859 6.58594 0.302734 6.92188 0.302734 7.33594C0.302734 7.74219 0.630859 8.08594 1.02148 8.08594H3.67773C3.98242 8.83594 4.70898 9.35938 5.56055 9.35938C6.4043 9.35938 7.13086 8.83594 7.43555 8.08594H15.709C16.123 8.08594 16.4512 7.75 16.4512 7.33594C16.4512 6.92188 16.123 6.58594 15.709 6.58594H7.43555C7.13086 5.84375 6.4043 5.32031 5.56055 5.32031C4.70898 5.32031 3.98242 5.84375 3.67773 6.58594H1.02148ZM5.56055 8.30469C5.02148 8.30469 4.5918 7.875 4.5918 7.33594C4.5918 6.78906 5.02148 6.375 5.56055 6.375C6.09961 6.375 6.52148 6.78906 6.52148 7.33594C6.52148 7.875 6.09961 8.30469 5.56055 8.30469ZM11.2871 14.2344C12.1387 14.2344 12.8652 13.7031 13.1621 12.9609H15.7324C16.123 12.9609 16.4512 12.625 16.4512 12.2109C16.4512 11.7891 16.123 11.4609 15.7324 11.4609H13.1621C12.8652 10.7188 12.1387 10.1875 11.2871 10.1875C10.4434 10.1875 9.70898 10.7188 9.41211 11.4609H1.04492C0.630859 11.4609 0.302734 11.7969 0.302734 12.2109C0.302734 12.6172 0.630859 12.9609 1.04492 12.9609H9.41211C9.70898 13.7031 10.4355 14.2344 11.2871 14.2344ZM11.2871 13.1719C10.748 13.1719 10.3262 12.7422 10.3262 12.2109C10.3262 11.6641 10.748 11.25 11.2871 11.25C11.834 11.25 12.248 11.6641 12.248 12.2109C12.248 12.7422 11.834 13.1719 11.2871 13.1719Z"})})},36329:(e,t,s)=>{s.d(t,{_:()=>o});s(67294);var n=s(45238),i=s(85893);const o=(0,n.IU)("personBadgeExclamationMark",{viewBox:"0 0 24 22",svg:(0,i.jsx)("path",{d:"M14 20.91c1.36 0 2.64-.26 3.838-.781a10.166 10.166 0 003.183-2.158 10.198 10.198 0 002.159-3.174 9.59 9.59 0 00.78-3.848c0-1.36-.263-2.64-.79-3.838a10.165 10.165 0 00-2.158-3.183 10.165 10.165 0 00-3.184-2.158A9.52 9.52 0 0013.99.988c-1.27 0-2.47.228-3.603.684A10.24 10.24 0 007.34 3.566 10.179 10.179 0 005.152 6.39a9.75 9.75 0 00-1.045 3.466c.235-.045.508-.074.82-.087.32-.02.61-.013.87.02.137-1.01.44-1.948.908-2.813A8.088 8.088 0 018.512 4.7a8.261 8.261 0 012.5-1.504 8.095 8.095 0 012.978-.547c1.153 0 2.23.215 3.233.645a8.233 8.233 0 012.646 1.777 8.365 8.365 0 011.787 2.647 8.11 8.11 0 01.645 3.232 8.15 8.15 0 01-2.139 5.557c-.319-.378-.775-.736-1.367-1.074-.593-.345-1.296-.625-2.11-.84-.813-.215-1.712-.322-2.695-.322-.469 0-.918.029-1.347.087-.43.053-.837.124-1.221.215.117.469.176.96.176 1.475 0 .762-.134 1.488-.4 2.178a6.308 6.308 0 01-1.095 1.865c.6.26 1.228.462 1.885.605A9.426 9.426 0 0014 20.91zm-.01-8.3a3.02 3.02 0 001.69-.47 3.53 3.53 0 001.21-1.318c.3-.56.45-1.191.45-1.894 0-.658-.15-1.26-.45-1.807a3.55 3.55 0 00-1.21-1.309 3.035 3.035 0 00-1.69-.488c-.625 0-1.191.163-1.699.489a3.622 3.622 0 00-1.65 3.115c0 .696.15 1.321.449 1.875.3.553.7.993 1.201 1.318a3.194 3.194 0 001.7.488zM5.3 21.017c.67 0 1.305-.13 1.904-.391a5.082 5.082 0 001.582-1.074A5 5 0 009.87 17.97c.26-.6.39-1.237.39-1.914 0-.684-.13-1.325-.39-1.924a4.945 4.945 0 00-1.064-1.582 4.946 4.946 0 00-1.582-1.065 4.772 4.772 0 00-1.924-.39c-.677 0-1.315.13-1.914.39a4.87 4.87 0 00-1.582 1.074A5.082 5.082 0 00.73 14.142a4.707 4.707 0 00-.391 1.914c0 .683.13 1.325.39 1.924a5.07 5.07 0 001.075 1.581c.455.456.983.811 1.582 1.065.599.26 1.237.39 1.914.39zm-.01-1.797a.788.788 0 01-.576-.244.768.768 0 01-.244-.577c0-.227.081-.423.244-.585a.788.788 0 01.576-.245c.234 0 .43.085.586.254a.788.788 0 01.244.576.77.77 0 01-.244.577.8.8 0 01-.586.244zm.01-2.325a.601.601 0 01-.43-.156.613.613 0 01-.166-.41l-.078-2.793a.63.63 0 01.176-.488.673.673 0 01.498-.186.66.66 0 01.488.186.63.63 0 01.176.488l-.078 2.793a.592.592 0 01-.176.41.554.554 0 01-.41.157z"})})},79310:(e,t,s)=>{s.d(t,{A:()=>o});s(67294);var n=s(45238),i=s(85893);const o=(0,n.IU)("pinStrikethrough",{viewBox:"0 0 15 19",svg:(0,i.jsx)("path",{d:"M3.094 1.328c0 .227.094.492.297.758.398.531 1.343 1.266 2.328 1.914l-.055.86 1.149 1.156.156-2.594c.008-.11-.008-.149-.086-.188-1.172-.601-2.078-1.312-2.14-1.468-.063-.102.007-.164.085-.164h6.68c.086 0 .148.062.086.164-.063.156-.961.867-2.14 1.468-.071.04-.087.079-.079.188l.234 3.875a7.12 7.12 0 00-1.437-.14h-.203l1.203 1.226c2.164.219 3.758 1.984 3.758 3.234 0 .04-.008.078-.008.117l.844.97c.257-.157.468-.477.468-.93 0-1.649-1.32-3.313-3.359-4.11L10.617 4c.992-.648 1.93-1.383 2.336-1.914.203-.266.297-.531.297-.758 0-.476-.367-.828-.914-.828H4.008c-.555 0-.914.352-.914.828zM.367 2.656l14.125 14.11a.603.603 0 00.852 0 .597.597 0 000-.852L1.227 1.804a.606.606 0 00-.86 0 .618.618 0 000 .852zm1.735 9.117c0 .665.445 1.102 1.148 1.102h4.234v3.648c0 1.196.493 2.188.688 2.188.195 0 .687-.992.687-2.188V12.97h.446L8.03 11.695H3.562c-.171 0-.257-.101-.226-.312.094-.875.828-1.805 1.984-2.399l-.82-.82c-1.477.867-2.398 2.234-2.398 3.61z"})})},5108:(e,t,s)=>{s.d(t,{n:()=>o});s(67294);var n=s(45238),i=s(85893);const o=(0,n.IU)("settingsMembers",{viewBox:"0 0 20 20",svg:(0,i.jsx)("path",{d:"M13.726 9.989c1.725 0 3.123-1.585 3.123-3.536 0-1.92-1.39-3.453-3.123-3.453-1.712 0-3.124 1.556-3.124 3.468.008 1.943 1.405 3.52 3.123 3.52zm-8.264.171c1.504 0 2.716-1.392 2.716-3.111 0-1.675-1.212-3.03-2.716-3.03-1.49 0-2.724 1.378-2.717 3.037 0 1.72 1.22 3.104 2.717 3.104zm8.264-1.474c-.985 0-1.819-.967-1.819-2.225 0-1.213.827-2.159 1.819-2.159.998 0 1.818.93 1.818 2.151 0 1.25-.827 2.233-1.819 2.233zm-8.264.186c-.806 0-1.49-.803-1.49-1.816 0-.967.677-1.756 1.49-1.756.827 0 1.497.774 1.497 1.749 0 1.02-.684 1.823-1.497 1.823zM1.54 17h5.54c-.392-.238-.656-.782-.606-1.273H1.476c-.136 0-.193-.067-.193-.193 0-1.705 1.911-3.327 4.172-3.327.798 0 1.597.208 2.21.566.242-.365.542-.678.934-.946-.906-.58-2.032-.893-3.144-.893C2.438 10.934 0 13.182 0 15.653 0 16.546.513 17 1.54 17zm7.743 0h8.885C19.4 17 20 16.59 20 15.712c0-2.046-2.453-4.77-6.274-4.77-3.822 0-6.275 2.724-6.275 4.77 0 .879.599 1.288 1.832 1.288zm-.228-1.303c-.164 0-.228-.059-.228-.193 0-1.139 1.761-3.26 4.899-3.26 3.137 0 4.898 2.121 4.898 3.26 0 .134-.064.194-.235.194H9.055z"})})},50226:(e,t,s)=>{s.d(t,{I:()=>o});s(67294);var n=s(45238),i=s(85893);const o=(0,n.IU)("sidebarTemplates",{viewBox:"0 0 14 15",svg:(0,i.jsx)("g",{children:(0,i.jsx)("path",{d:"M.11 5.918c0 2.367 1.628 4.348 3.837 4.916v1.412c0 1.283.686 1.969 1.987 1.969h5.97c1.295 0 1.987-.686 1.987-1.969V6.24c0-1.289-.692-1.969-1.987-1.969H10.07A5.112 5.112 0 005.23.85C2.4.85.11 3.117.11 5.918zm1.247 0c0-2.11 1.729-3.826 3.873-3.826a3.87 3.87 0 013.493 2.18h-2.79c-1.3 0-1.986.68-1.986 1.968v3.293a3.83 3.83 0 01-2.59-3.615zm4.688 6.99c-.516 0-.791-.258-.791-.797V6.375c0-.54.275-.797.79-.797h5.749c.516 0 .791.258.791.797v5.736c0 .54-.275.797-.791.797H6.045z"})})})},34390:(e,t,s)=>{s.d(t,{U:()=>a,b:()=>o});const n=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.template.macroEnabled.12"],i=["text/plain",".md",".mdown",".markdown",".mkdn",".mkd",".Rmd",".md.txt"],o={markdown:i,csv:["text/plain",".csv"],html:["text/html"],docx:n,gdocs:n,dropbox:n,quip:["text/html",i],workflowy:["text/plain"],confluence:["application/zip"],genericImporter:["application/zip"],pdf:["application/pdf"]},a=Object.keys(o)},57222:(e,t,s)=>{function n(e){return{"en-US":{label:"English",caption:e.formatMessage({defaultMessage:"English (US)",id:"languagePicker.captions.englishUS"})},"de-DE":{label:"Deutsch",caption:e.formatMessage({defaultMessage:"German",id:"languagePicker.captions.germanDE"})},"ko-KR":{label:"한국어",caption:e.formatMessage({defaultMessage:"Korean",id:"languagePicker.captions.koreanKo"})},"zh-CN":{label:"简体中文",caption:e.formatMessage({defaultMessage:"Simplified Chinese",id:"languagePicker.captions.chineseS"})},"zh-TW":{label:"繁體中文",caption:e.formatMessage({defaultMessage:"Traditional Chinese",id:"languagePicker.captions.chineseT"})},"ja-JP":{label:"日本語",caption:e.formatMessage({defaultMessage:"Japanese",id:"languagePicker.captions.japaneseJa"})},"es-ES":{label:"Español (España)",caption:e.formatMessage({defaultMessage:"Spanish (Spain)",id:"languagePicker.captions.spanishEs"})},"es-LA":{label:"Español (Latinoamérica)",caption:e.formatMessage({defaultMessage:"Spanish (Latin America)",id:"languagePicker.captions.spanishLatam"})},"pt-BR":{label:"Português (Brasil)",caption:e.formatMessage({defaultMessage:"Portuguese (Brazil)",id:"languagePicker.captions.portugueseBr"})},"fr-FR":{label:"Français (France)",caption:e.formatMessage({defaultMessage:"French",id:"languagePicker.captions.frenchFr"})},"da-DK":{label:"Dansk",caption:e.formatMessage({defaultMessage:"Danish",id:"languagePicker.captions.danishDk"})},"fi-FI":{label:"Suomi",caption:e.formatMessage({defaultMessage:"Finnish",id:"languagePicker.captions.finnishFi"})},"nb-NO":{label:"Norsk",caption:e.formatMessage({defaultMessage:"Norwegian",id:"languagePicker.captions.norwegianNo"})},"nl-NL":{label:"Nederlands",caption:e.formatMessage({defaultMessage:"Dutch",id:"languagePicker.captions.dutchNl"})},"sv-SE":{label:"Svenska",caption:e.formatMessage({defaultMessage:"Swedish",id:"languagePicker.captions.swedishSe"})},pseudo:{label:"🤡Pseudolocale🤡",caption:e.formatMessage({defaultMessage:"Pseudolocale",id:"languagePicker.captions.pseudolocale"})}}}s.d(t,{t:()=>n})}}]);