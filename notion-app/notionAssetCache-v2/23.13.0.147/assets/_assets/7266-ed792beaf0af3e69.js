"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[7266],{6758:(e,t,r)=>{r.d(t,{Pq:()=>se,oe:()=>ne,bU:()=>ie});r(57658);var o=r(67294),i=r(83355),n=r(480),s=r(76205),l=r(68965),a=r(42853),p=r(56666),c=r(88437),d=r(62208),u=r(47453),h=r(37612),g=r(9291),m=r(53965),f=r(1898),x=r(36610),y=r(2005),v=r(97004),M=r(17335),j=r(60709),b=r(61766),w=r(13401),F=r(86628),S=r(80951),C=r(43690),V=r(33929),Z=r(98742),T=r(52275),P=r(14871),I=r(26388),k=r(64369),A=r(62045),_=r(85893);function R(e){const{filter:t}=e,{isMobile:r}=(0,n.Fy)(),o=V.default.getIntl(),i={width:190,menuTitle:o.formatMessage({defaultMessage:"Date Options",id:"database.filterMenu.mobileDateFilterModeMenu.title"}),items:s.T,selectedItem:(0,s.TX)(t),getKey:e=>e,onSelect:r=>{const o={...t,use_end:(0,s.UG)(r)};e.onChange(o)},renderItem:e=>(0,_.jsx)(I.ZP,{renderTooltip:()=>(0,M._T)(e.value),render:t=>(0,_.jsx)(T.Z,{title:(0,M.IF)(e.value),...(0,Z.Z)(e,t)}),placement:I.ug.Right,textWrap:!0,style:{width:"260px"}}),renderOrigin:e=>(0,_.jsx)(A.Z,{...e,placeholder:o.formatMessage({defaultMessage:"Date Options",id:"database.filterMenu.dateFilterModeMenu.label"}),title:(0,_.jsx)(k.Z,{isMobile:r,children:(0,M.IF)((0,s.TX)(t))}),disableMargins:!0,desktopStyle:{width:"100px"}})};return(0,_.jsx)(P.Z,{...i,mobileActionSheet:!0},"date-filter-mode")}var O=r(34299);const G=(0,g.injectIntl)((function(e){const t=(0,n.O7)(),{filterValueType:r,filter:o,intl:i}=e,l=(0,s.xm)(r),a={width:190,menuTitle:i.formatMessage({defaultMessage:"Comparator",id:"database.filterMenu.mobileComparatorValueMenu.title"}),items:l,selectedItem:o.operator,getKey:e=>e,onSelect:i=>{const n=(0,M.li)(r,o,i,"combinator");e.onChange(n),x.wd(t,{view_type:e.collectionViewType,action:"set_filter_comparator"})},renderItem:e=>(0,_.jsx)(T.Z,{title:(0,M.WC)(e.value),...e}),renderOrigin:e=>(0,_.jsx)(A.Z,{...e,placeholder:i.formatMessage({defaultMessage:"Comparator",id:"database.filterMenu.comparatorMenuDropdownButton.label"}),title:(0,_.jsx)(k.Z,{isMobile:t.device.isMobile,children:(0,M.WC)(o.operator)}),disableMargins:!0})};return(0,_.jsx)(P.Z,{...a,mobileActionSheet:!0},"comparator")}));var B=r(49068);const U=(0,g.defineMessages)({setFilter:{defaultMessage:"Set filter",id:"database.filterMenu.rollupPropertyValue.mobileMenu.title"}});const D=(0,g.injectIntl)((function(e){const t=(0,n.O7)();if((0,s.a_)(e.filter))return(0,_.jsx)(W,{intl:e.intl,onChange:e.onChange,collectionViewType:e.collectionViewType,property:e.property,schema:e.schema,parentStore:e.parentStore,collectionViewId:e.collectionViewId,filter:e.filter});const r=(0,s.fI)({schema:e.schema,property:e.property,getRecordModel:e.parentStore.getRecordModel});if(!(0,s.ZB)(r,e.filter)){const t=(0,M.rn)(r);return(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)(G,{filterValueType:r,filter:t,collectionViewType:e.collectionViewType,onChange:e.onChange}),(0,_.jsx)(B.Z,{filterValueType:r,filter:t,schema:e.schema,property:e.property,parentStore:e.parentStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId,onChange:e.onChange})]})}const i=(0,_.jsx)(g.FormattedMessage,{...M.xe[r],values:{property:(0,_.jsx)(g.FormattedMessage,{id:"collectionFilterMenuFilter.property.name",defaultMessage:"Property"}),operator:(0,_.jsx)(G,{filterValueType:r,filter:e.filter,collectionViewType:e.collectionViewType,onChange:e.onChange}),operatorValue:(0,_.jsx)(B.Z,{filterValueType:r,filter:e.filter,schema:e.schema,property:e.property,parentStore:e.parentStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId,onChange:e.onChange})}});return t.device.isMobile?i:(0,_.jsx)("div",{style:{alignItems:"center",display:"grid",gridAutoFlow:"column",gridAutoColumns:"1fr",gridColumnEnd:e.isArrayFilter?void 0:"span 2",gridColumnGap:`${y.l0}px`,gridTemplateRows:`${y.fg}px`,gridTemplateColumns:"[value-start] max-content auto [value-end operator-start] auto"},children:i})})),Q=D;function W(e){let{filter:t,intl:r,onChange:i,collectionViewType:l,property:a,schema:p,parentStore:c,collectionViewId:d}=e;const u=(0,n.O7)(),h={menuTitle:r.formatMessage(U.setFilter),items:s.Rf,getKey:e=>e,selectedItem:t.operator,onSelect:e=>{const r={...t,operator:e};i(r),x.wd(u,{view_type:l,action:"set_rollup_set_filter"})},renderItem:e=>(0,_.jsx)(T.Z,{title:(0,M.SW)(e.value,r),...e}),renderOrigin:e=>(0,_.jsx)(A.Z,{...e,placeholder:r.formatMessage(U.setFilter),title:(0,M.SW)(t.operator,r),disableMargins:!0,desktopStyle:{minWidth:70}})},{targetProperty:g,targetCollectionSchema:m}=(0,F.VK)((()=>{var e;if("rollup"===(null==p||null===(e=p[a])||void 0===e?void 0:e.type)){const e=(0,O.gT)({schema:p,property:a,getRecordModel:c.getRecordModel});return{targetProperty:null==e?void 0:e.targetProperty,targetCollectionSchema:null==e?void 0:e.targetCollectionSchema}}return{targetProperty:a,targetCollectionSchema:p}}),[a,p,c]);if(!g||!m)return(0,_.jsx)("div",{style:{gridColumnEnd:"span 2"}});const f=(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)(P.Z,{...h,mobileActionSheet:!0},"set_filter"),(0,_.jsx)(D,{collectionViewId:d,filter:t.subfilter,schema:m,property:g,parentStore:c,collectionViewType:l,onChange:e=>{const r={...t,subfilter:e};i(r)},isArrayFilter:!0})]});return u.device.isMobile?f:(0,_.jsx)("div",{style:{display:"grid",gridAutoFlow:"column",gridAutoColumns:"1fr",gridColumnEnd:"span 2",gridColumnGap:`${y.l0}px`,gridTemplateColumns:"max-content",gridTemplateRows:`${y.fg}px`},children:f})}var K=r(31945),$=r(77498),z=r(50542);const E=function(e){let{schema:t,propertyFilter:r,parentStore:i,index:l,collectionViewType:a,onChange:p,filterOperator:c,collectionViewId:d}=e;const u=(0,n.O7)(),{device:h}=u,m=(0,S.Qm)({schema:t,property:r.property}),f=(0,F.VK)((()=>(0,s.J5)(t,r.property,r.filter,i.getRecordModel)),[i,r,t]);if(!m)return null;if(!f)return null;const y=(0,s.gE)(r.filter)&&(0,s.vR)(r.filter)&&(0,s.c3)(m),v=y?{width:"120px",marginRight:"4px"}:{},j=(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)(K.ZP,{popupType:h.isMobile?K.Z4.SlideUp:K.Z4.Popup,renderOrigin:e=>(0,_.jsx)(z.Z,{...e,propertySchema:m,disableMargins:!0,textWrapperStyle:{width:"100%",...v}}),render:e=>(0,_.jsx)($.Z,{isRelationProperty:!1,schema:t,onAccept:e=>function(e,t,r,o,i,n,l,a){const{property:p,filter:c}=o,d=r[p],u=r[e],h={property:e,filter:c},g=u&&(0,s.J5)(r,e,c,i.getRecordModel),m=u&&"relation"===u.type&&p!==e,f=d&&("created_by"===d.type||"last_edited_by"===d.type)&&u&&"person"===u.type,y=(0,s.Gb)(c)&&!(0,s.mv)(c)&&(0,s.R8)(c).some((e=>"exact"===e.type&&e.value&&"bot"===e.value.table));(!g||m||f&&y||!(0,C.dN)(h,r))&&(h.filter=(0,M.zZ)({schema:r,property:e,getRecordModel:i.getRecordModel}));null==a||a(n,h),x.wd(t,{view_type:l,action:"set_filter_property"})}(e,u,t,r,i,l,a,p),onClose:e.close,allowProperty:S.Kf})}),y&&(0,_.jsx)(R,{filter:r.filter,onChange:e=>{const t={...r,filter:e};null==p||p(l,t)}})]});return(0,_.jsxs)(o.Fragment,{children:[c,h.isMobile?j:(0,_.jsx)("div",{style:{display:"flex"},children:j}),(0,_.jsx)(g.FormattedMessage,{id:"collectionFilterMenuRow.propertyConjunction.label",defaultMessage:" "}),(0,_.jsx)(Q,{filter:r.filter,schema:t,property:r.property,parentStore:i,collectionViewId:d,collectionViewType:a,onChange:e=>{const t={...r,filter:e};null==p||p(l,t)},isArrayFilter:!1})]})};function L(){return(0,_.jsx)(g.FormattedMessage,{defaultMessage:"Add filter rule",id:"database.filterMenu.addFilterRuleButtonTitle"})}const N=(0,g.defineMessages)({operatorPlaceholder:{defaultMessage:"Operator",id:"database.filterMenu.operatorPlaceholder"}});const H=(0,g.injectIntl)((function(e){const{intl:t,filterOperator:r,onChange:o,disableMargins:i}=e,n={width:"auto",menuTitle:t.formatMessage({defaultMessage:"Operator",id:"database.filterMenu.filterOperatorMenu.title"}),items:s.Uz,getKey:e=>e,selectedItem:r,onSelect:o,renderItem:e=>(0,_.jsx)(T.Z,{title:(0,M.KV)(e.value,t),caption:(0,M.Qz)(e.value,t),...e}),renderOrigin:e=>(0,_.jsx)(A.Z,{...e,title:r&&(0,M.KV)(r,t),placeholder:t.formatMessage(N.operatorPlaceholder),disableMargins:i})};return(0,_.jsx)(P.Z,{...n,mobileActionSheet:!0},"operator")}));var q=r(31339),J=r(8982),X=r(73063),Y=r(78140),ee=r(32163),te=r(40721),re=r(53437),oe=r(72495);const ie=170,ne=400;class se extends i.Z{constructor(){super(...arguments),this.buttonPopupStores=[],this.renderChildFilter=(e,t)=>{const r=this.environment.device.isMobile;return(0,s.vA)(e)?r?this.renderMobileCombinatorFilter(e,t):this.renderDesktopCombinatorFilter(e,t):(0,s.aN)(e)?r?this.renderMobilePropertyFilter(e,t):this.renderDesktopPropertyFilter(e,t):void 0},this.renderCombinatorActions=()=>{const{device:e}=this.environment;if(e.isMobile)return(0,_.jsxs)(oe.Z,{topBorder:ge(this.props.combinatorFilter,this.props.level),children:[(0,_.jsx)(me,{props:{onClick:()=>ye(this.environment,this.props.schema,this.props.combinatorFilter,this.props.onChange,this.props.index,this.props.collectionViewType)}}),de(this.props.level)&&(0,_.jsx)(fe,{props:{onClick:this.handleAddFilterGroupClick}})]});const t={height:32},r={padding:`${y.cn}px 0`};return de(this.props.level)?(0,_.jsx)(oe.Z,{topBorder:ge(this.props.combinatorFilter,this.props.level),desktopStyle:r,children:(0,_.jsx)(K.ZP,{alignmentToOrigin:re.ZP.Alignment.Start,popupType:re.ZP.PopupType.Popup,renderOrigin:e=>(0,_.jsx)(J.i,{action:()=>e.onClick(),render:r=>{const{focused:o,...i}=r;return(0,_.jsx)(w.Z,{...e,...i,focused:o,isBlue:!1,style:t,title:(0,_.jsxs)("div",{children:[(0,_.jsx)(L,{}),(0,a.i)({width:10,marginLeft:6,display:"inline"})]})})}}),render:e=>(0,_.jsx)(ee.Z,{type:ee.i.Vertical,initialFocus:0,sections:[{key:"actions",render:e=>(0,_.jsx)(oe.Z,{...e}),items:[{key:"add_filter",render:e=>(0,_.jsx)(me,{props:e}),action:t=>{e.close(),ye(this.environment,this.props.schema,this.props.combinatorFilter,this.props.onChange,this.props.index,this.props.collectionViewType)}},{key:"add_filter_group",render:e=>(0,_.jsx)(fe,{props:e}),action:t=>{e.close(),this.handleAddFilterGroupClick()}}]}]})})}):(0,_.jsx)(oe.Z,{topBorder:ge(this.props.combinatorFilter,this.props.level),desktopStyle:r,children:(0,_.jsx)(J.i,{action:()=>ye(this.environment,this.props.schema,this.props.combinatorFilter,this.props.onChange,this.props.index,this.props.collectionViewType),render:e=>{const{focused:r,...o}=e;return(0,_.jsx)(w.Z,{...o,focused:e.focused,isBlue:!1,style:t,onClick:()=>ye(this.environment,this.props.schema,this.props.combinatorFilter,this.props.onChange,this.props.index,this.props.collectionViewType),title:(0,_.jsx)(L,{})})}})})},this.handleAddFilterGroupClick=()=>{const e=ue(this.props.schema,this.props.combinatorFilter),t={operator:ce(this.props.combinatorFilter),filters:[e]},r=he((e=>e.push(t)),this.props.combinatorFilter,this.props.onChange,this.props.index);this.openIndex(r-1),x.wd(this.environment,{view_type:this.props.collectionViewType,action:"add_filter_group"})}}willUnmount(){this.buttonPopupStores=[]}renderComponent(){const{combinatorFilter:e}=this.props,{device:t}=this.environment,r=(e.filters??[]).flatMap((e=>(0,s.Mm)(e)?[]:[e]));return(0,_.jsxs)(o.Fragment,{children:[ge(this.props.combinatorFilter,this.props.level)?void 0:(0,_.jsx)("div",{style:t.isMobile?void 0:{display:"grid",gridTemplateColumns:`\n             [boolean-start] 60px\n             [boolean-end property-start] minmax(min-content, 120px)\n             [property-end operator-start] 110px\n             [operator-end value-start] auto\n             [value-end menu-start] ${y.fg}px\n             [menu-end]\n        `,gridAutoRows:`minmax(${y.fg}px, auto)`,gridColumnGap:y.l0,gridRowGap:y.cn,padding:`${y.cn}px ${y.l0}px 0 ${y.l0}px`,justifyItems:"stretch",alignItems:"start"},children:r.map(this.renderChildFilter)}),this.renderCombinatorActions()]})}renderDesktopPropertyFilter(e,t){return(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)(E,{index:t,propertyFilter:e,schema:this.props.schema,filterOperator:(0,_.jsx)(ve,{combinatorFilter:this.props.combinatorFilter,onChange:this.props.onChange,index:this.props.index,collectionViewType:this.props.collectionViewType,newIndex:t}),parentStore:this.props.parentStore,onChange:(e,t)=>xe(e,t,this.props.combinatorFilter,this.props.onChange,this.props.index),collectionViewType:this.props.collectionViewType,collectionViewId:this.props.collectionViewId},t),this.renderRowActions(e,t)]},t)}renderMobilePropertyFilter(e,t){return(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)(ve,{combinatorFilter:this.props.combinatorFilter,onChange:this.props.onChange,index:this.props.index,collectionViewType:this.props.collectionViewType,newIndex:t}),(0,_.jsxs)(oe.Z,{title:(0,_.jsx)(g.FormattedMessage,{defaultMessage:"Filter {index}",id:"database.filterMenu.filterIndex",values:{index:t+1}}),children:[(0,_.jsx)(E,{index:t,propertyFilter:e,schema:this.props.schema,filterOperator:null,parentStore:this.props.parentStore,onChange:(e,t)=>xe(e,t,this.props.combinatorFilter,this.props.onChange,this.props.index),collectionViewType:this.props.collectionViewType,collectionViewId:this.props.collectionViewId},t),this.renderRowActions(e,t)]})]},t)}renderDesktopCombinatorFilter(e,t){const r={gridColumn:"property-start / value-end",...(i=this.theme,{background:i.filterGroupBackground,borderRadius:4,boxShadow:`0 0 0 1px ${i.filterGroupBorder}`,margin:1,alignSelf:"stretch"})};var i;return(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)(ve,{combinatorFilter:this.props.combinatorFilter,onChange:this.props.onChange,index:this.props.index,collectionViewType:this.props.collectionViewType,newIndex:t}),(0,_.jsx)("div",{style:r,children:(0,_.jsx)(se,{index:t,level:this.props.level+1,combinatorFilter:e,onChange:(e,t)=>xe(e,t,this.props.combinatorFilter,this.props.onChange,this.props.index),parentStore:this.props.parentStore,schema:this.props.schema,collectionViewType:this.props.collectionViewType,collectionViewId:this.props.collectionViewId})}),this.renderRowActions(e,t)]},t)}renderMobileCombinatorFilter(e,t){const r=(e.filters||[]).length,i=(0,_.jsx)(g.FormattedMessage,{defaultMessage:"Filter Group {index}",id:"database.filterMenu.filterGroupIndex",values:{index:t+1}});return(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)(ve,{combinatorFilter:this.props.combinatorFilter,onChange:this.props.onChange,index:this.props.index,collectionViewType:this.props.collectionViewType,newIndex:t}),(0,_.jsxs)(oe.Z,{title:i,children:[(0,_.jsx)(K.ZP,{buttonPopupStore:this.getButtonPopupStore(t),popupType:K.Z4.SlideUp,renderOrigin:t=>(0,_.jsx)(T.Z,{focused:!1,...t,showExtensionArrow:!0,right:r.toString(),title:(0,M.qh)({filter:e,schema:this.props.schema})}),render:r=>(0,_.jsx)(Y.Z,{menuType:j.og.Modal,title:i,left:(0,_.jsx)(te.BackMenuText,{}),onClickLeft:r.close,children:(0,_.jsx)(se,{index:t,level:this.props.level+1,combinatorFilter:e,onChange:(e,t)=>xe(e,t,this.props.combinatorFilter,this.props.onChange,this.props.index),parentStore:this.props.parentStore,schema:this.props.schema,collectionViewType:this.props.collectionViewType,collectionViewId:this.props.collectionViewId})})}),this.renderRowActions(e,t)]})]},t)}renderRowActions(e,t){return this.environment.device.isMobile?this.renderRowActionMenuItems(e,t,void 0):(0,_.jsx)(K.ZP,{popupType:re.ZP.PopupType.Popup,renderOrigin:e=>(0,_.jsx)(J.i,{action:()=>e.onClick(),render:e=>(0,_.jsx)(X.Z,{...e,hovered:e.focused,style:{width:"100%",height:32},icon:p.o})}),render:r=>this.renderRowActionMenuItems(e,t,r)})}renderRowActionMenuItems(e,t,r){const o=(0,s.vA)(e),i=o?(0,_.jsx)(g.FormattedMessage,{defaultMessage:"Remove",id:"database.filterMenu.removeFilterGroupMenuTitle"}):(0,_.jsx)(g.FormattedMessage,{defaultMessage:"Remove",id:"database.filterMenu.removeFilterMenuTitle"}),n=o?(0,_.jsx)(g.FormattedMessage,{defaultMessage:"Duplicate",id:"database.filterMenu.duplicateFilterGroupMenuTitle"}):(0,_.jsx)(g.FormattedMessage,{defaultMessage:"Duplicate",id:"database.filterMenu.duplicateFilterMenuTitle"}),l=[{key:"delete",action:()=>{r&&r.close(),this.handleDeleteFilter(t)},render:e=>(0,_.jsx)(T.Z,{...e,icon:(0,_.jsx)(pe,{icon:h.y}),isRedOnHover:!0,title:i})},{key:"duplicate",action:()=>{r&&r.close(),function(e,t,r,o,i,n){he((t=>{const r=t[e];if(r){const o={...r};t.splice(e,0,o)}}),t,r,o),x.wd(n,{view_type:i,action:"duplicate_filter"})}(t,this.props.combinatorFilter,this.props.onChange,this.props.index,this.props.collectionViewType,this.environment)},render:e=>(0,_.jsx)(T.Z,{...e,icon:(0,_.jsx)(pe,{icon:c.a}),title:n})}];if((0,s.aN)(e)&&de(this.props.level)&&l.push({key:"turn_into_group",action:()=>{r&&r.close(),this.handleTurnIntoGroup(t,e)},render:e=>(0,_.jsx)(T.Z,{...e,icon:(0,_.jsx)(pe,{icon:d.z}),title:(0,_.jsx)(g.FormattedMessage,{defaultMessage:"Turn into group",id:"database.filterMenu.turnIntoGroupMenuTitle"})})}),(0,s.vA)(e)&&e.filters&&1===e.filters.length){const o=(0,s.vA)(e.filters[0])?(0,_.jsx)(g.FormattedMessage,{defaultMessage:"Unwrap group",id:"database.filterMenu.unwrapGroupMenuTitle"}):(0,_.jsx)(g.FormattedMessage,{defaultMessage:"Turn into filter",id:"database.filterMenu.turnIntoFilterMenuTitle"});l.push({key:"turn_into_filter",action:()=>{r&&r.close(),function(e,t,r,o,i,n,l){const a=m.Ps(t.filters||[]);a&&!(0,s.Mm)(a)&&xe(e,a,o,i,n);x.wd(r,{view_type:l,action:"turn_into_filter"})}(t,e,this.environment,this.props.combinatorFilter,this.props.onChange,this.props.index,this.props.collectionViewType)},render:e=>(0,_.jsx)(T.Z,{...e,icon:(0,_.jsx)(pe,{icon:d.z}),title:o})})}const a=le(e);return(0,s.vA)(e)&&this.props.level+a+1<3&&l.push({key:"wrap_in_group",action:()=>{r&&r.close(),this.handleTurnIntoGroup(t,e)},render:e=>(0,_.jsx)(T.Z,{...e,icon:(0,_.jsx)(pe,{icon:d.z}),title:(0,_.jsx)(g.FormattedMessage,{defaultMessage:"Wrap in group",id:"database.filterMenu.wrapInGroupMenuTitle"}),caption:(0,_.jsx)(g.FormattedMessage,{defaultMessage:"Create a filter group around this",id:"database.filterMenu.wrapInGroupMenuCaption"})})}),(0,_.jsx)(ee.Z,{initialFocus:this.environment.device.isMobile?void 0:0,type:ee.i.Vertical,sections:[{key:"actions",render:this.environment.device.isMobile?e=>(0,_.jsx)("div",{...e}):e=>(0,_.jsx)(oe.Z,{...e}),items:l}]})}handleTurnIntoGroup(e,t){xe(e,{operator:ce(this.props.combinatorFilter),filters:[t]},this.props.combinatorFilter,this.props.onChange,this.props.index),this.openIndex(e),x.wd(this.environment,{view_type:this.props.collectionViewType,action:"turn_into_filter_group"})}handleDeleteFilter(e){he((t=>t.splice(e,1)),this.props.combinatorFilter,this.props.onChange,this.props.index),this.getButtonPopupStore(e).reset(),this.buttonPopupStores.splice(e,1)}openIndex(e){this.getButtonPopupStore(e).setState({open:!0})}getButtonPopupStore(e){for(;this.buttonPopupStores.length<e+1;){const e=new b.Z;this.buttonPopupStores.push(e)}return this.buttonPopupStores[e]}}function le(e){if((0,s.vA)(e)){const t=(e.filters||[]).filter(s.vA);return 1+(m.Fp(t.map(le))||0)}return 0}function ae(e){const{operator:t,lowercase:r}=e;return"or"===t?r?(0,_.jsx)(g.FormattedMessage,{id:"collectionFilterCombinatorGrid.filterOperator.or.lowercase",defaultMessage:"or"}):(0,_.jsx)(g.FormattedMessage,{id:"collectionFilterCombinatorGrid.filterOperator.or",defaultMessage:"Or"}):"and"===t?r?(0,_.jsx)(g.FormattedMessage,{id:"collectionFilterCombinatorGrid.filterOperator.and.lowercase",defaultMessage:"and"}):(0,_.jsx)(g.FormattedMessage,{id:"collectionFilterCombinatorGrid.filterOperator.and",defaultMessage:"And"}):(0,f.t1)(t)}function pe(e){let{icon:t,styles:r}=e;return(0,_.jsx)(q.Z,{icon:t,styles:r})}function ce(e){return"or"===e.operator?"and":"or"}function de(e){return e<2}function ue(e,t){const r=(t.filters||[]).filter(s.aN),o=r[r.length-1];return o?m.Xh(o):(0,v.Me)(e)}function he(e,t,r,o){const i=[...t.filters||[]],n=e(i);return r(o,{...t,filters:i}),n}function ge(e,t){return(0,s.$1)(e)&&0===t}function me(e){let{props:t}=e;const r=(0,_.jsx)(pe,{icon:u.R});return(0,_.jsx)(T.Z,{focused:!1,...t,icon:r,title:(0,_.jsx)(L,{})})}function fe(e){let{props:t}=e;const r=(0,_.jsx)(pe,{icon:l.t});return(0,_.jsx)(T.Z,{focused:!1,...t,icon:r,title:(0,_.jsx)(g.FormattedMessage,{defaultMessage:"Add filter group",id:"database.filterMenu.addFilterGroup2ButtonTitle"}),caption:(0,_.jsx)(g.FormattedMessage,{defaultMessage:"A group to nest more filters",id:"database.filterMenu.addFilterGroupButtonCaption"})})}function xe(e,t,r,o,i){he((r=>r.splice(e,1,t)),r,o,i)}function ye(e,t,r,o,i,n){const s=ue(t,r);he((e=>e.push(s)),r,o,i),x.wd(e,{view_type:n,action:"add_filter"})}function ve(e){let{newIndex:t,combinatorFilter:r,onChange:o,index:i,collectionViewType:s}=e;const l=(0,n.O7)(),a=r.operator,{device:p}=l,c={justifySelf:"end"},d={...c,lineHeight:"32px",paddingRight:4};if(0===t)return p.isMobile?null:(0,_.jsx)(k.Z,{style:d,children:(0,_.jsx)(g.FormattedMessage,{defaultMessage:"Where",id:"database.filterMenu.where"})});if(1===t){const e=(0,_.jsx)(H,{disableMargins:!0,filterOperator:a,onChange:e=>function(e,t,r,o,i,n){o(i,{...r,operator:e}),x.wd(t,{view_type:n,action:"set_filter_operator"})}(e,l,r,o,i,s)});return l.device.isMobile?(0,_.jsx)(oe.Z,{children:e}):(0,_.jsx)("div",{style:c,children:e})}return p.isMobile?null:(0,_.jsx)(k.Z,{style:d,children:(0,_.jsx)(ae,{operator:a})})}se.displayName="CollectionFilterCombinatorGrid"},49068:(e,t,r)=>{r.d(t,{Z:()=>L,$:()=>E});var o=r(67294),i=r(480),n=r(86628),s=r(24405),l=r(66897),a=r(76205),p=r(99036),c=r(80951),d=r(84619),u=r(40506),h=r(76725),g=r(96367),m=r(9291),f=r(1898),x=r(37810),y=r(36610),v=r(2005),M=r(17335),j=r(5691),b=r(29376),w=r(6258),F=r(6758),S=r(56416),C=r(68834),V=r(33929),Z=r(8982),T=r(36488),P=r(74194),I=r(68894),k=r(85893);const A=(0,m.defineMessages)({value:{defaultMessage:"Value",id:"database.filterAndSort.propertyValueInput.placeholder"}});function _(e){let{value:t,onChange:r}=e;const{device:n}=(0,i.O7)(),l=(0,o.useRef)(null),[a,p]=(0,o.useState)(!1),c=(0,o.useCallback)((()=>p(!0)),[p]),d=(0,o.useCallback)((()=>p(!1)),[p]),u=(0,o.useCallback)((e=>{r(e.target.value)}),[r]),h=(0,o.useCallback)((()=>{l.current&&(l.current.handleBlur(),d())}),[d]),g=(0,s.yK)((e=>({focused:{background:e.buttonHoveredBackground},unfocused:{background:"transparent"}})),[]),f=t||"";return(0,k.jsx)("div",{style:{display:"flex",margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},onClick:c,children:n.isMobile?(0,k.jsx)(I.ZP,{value:f,onChange:u,placeholder:V.default.formatMessage(A.value),onBlur:d,rightMobileEditLabel:(0,k.jsx)(m.FormattedMessage,{defaultMessage:"Edit",id:"database.filterAndSort.mobileEditButton.label"})}):(0,k.jsx)(Z.i,{action:c,render:e=>(0,k.jsx)("div",{ref:e.ref,onMouseEnter:e.onMouseEnter,style:{...e.focused&&!a?g.focused:g.unfocused,margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},children:(0,k.jsx)(T.Z,{capture:a,render:e=>(0,k.jsx)("div",{...e,style:{margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},children:(0,k.jsx)(P.Z,{focus:a,ref:l,value:f,onChange:u,placeholder:V.default.formatMessage(A.value),onBlur:d,onCancel:h,style:{marginRight:8,paddingLeft:6,paddingRight:0,width:80,height:30,...{margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},minWidth:F.bU}})})})})})})}_.displayName="CollectionOperatorValueInput";var R=r(52275),O=r(31945),G=r(60458),B=r(14871),U=r(92864),D=r(89845),Q=r(62045),W=r(25845),K=r(14390),$=r(22084);const z=(0,m.defineMessages)({dateTitle:{defaultMessage:"Date",id:"database.filterMenu.mobileDateSelectMenu.title"},emptyPlaceholder:{defaultMessage:"Empty",id:"database.filterMenu.dateSelectMenu.emptyPlaceholder"}});function E(e){return e?(0,k.jsx)(m.FormattedMessage,{defaultMessage:"Select one person",id:"database.personPropertyValue.selectPerson.searchPlaceholderWithLimit"}):(0,k.jsx)(m.FormattedMessage,{defaultMessage:"Select one or more people",id:"database.personPropertyValue.selectPerson.searchPlaceholder"})}const L=function(e){let{schema:t,property:r,parentStore:o,filter:n,collectionViewId:s,filterValueType:l,onChange:p,collectionViewType:c}=e;const d=(0,i.O7)(),u=(0,m.useIntl)(),h=(0,k.jsx)("span",{});if("date"===l)return(0,a.gE)(n)?(0,a.mv)(n)?h:(0,a.TQ)(n)?(0,k.jsx)(re,{intl:u,parentStore:o,schema:t,collectionViewId:s,property:r,onChange:p,collectionViewType:c,filter:n}):(0,k.jsx)(te,{intl:u,collectionViewId:s,property:r,schema:t,parentStore:o,onChange:p,collectionViewType:c,filter:n}):h;if("text"===l){if(!(0,a.Ly)(n))return h;const e=n;if((0,a.mv)(e))return h;if("string_has_no_alphabet_prefix"===e.operator)return null;const t=e.value;return(0,k.jsx)(_,{value:t.value,onChange:t=>{const r={type:"exact",value:t},o={...e,value:r};p(o)}})}if("number"===l){if(!(0,a.h6)(n))return h;const e=n;if((0,a.mv)(e))return h;const t=e.value;return(0,k.jsx)(_,{value:void 0===t.value?"":t.value.toString(),onChange:t=>{const r={type:"exact",value:(0,j.m)(t,u)},o={...e,value:r};p(o)}})}if("checkbox"===l){if(!(0,a.XA)(n)||!s)return h;const e=n,i=e.value;return(0,k.jsx)(O.ZP,{popupType:d.device.isMobile?O.Z4.SlideUp:O.Z4.Popup,renderOrigin:e=>(0,k.jsx)(q,{operatorValue:i,events:e}),render:i=>(0,k.jsx)(S.ZP,{collectionViewId:s,propertyFilter:{property:r,filter:e},schema:t,onChange:e=>{p(e)},onClose:i.close,parentStore:o,context:S.Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}if("select"===l||"multi_select"===l||"status"===l){if(!((0,a.dx)(n)||(0,a.NU)(n)||(0,a.r2)(n))||!s)return h;const e=n;if((0,a.mv)(e))return h;const i=t[r];if(!i)return h;const l=(0,a.dx)(e)?(0,a.mg)(e):(0,a.NU)(e)?(0,a.qC)(e):(0,a.Js)(i,(0,a.wB)(e));return(0,k.jsx)(O.ZP,{popupType:d.device.isMobile?O.Z4.SlideUp:O.Z4.Popup,renderOrigin:e=>(0,k.jsx)(ee,{schema:t,property:r,operatorValues:l,events:e}),render:i=>(0,k.jsx)(S.ZP,{collectionViewId:s,propertyFilter:{property:r,filter:e},schema:t,onChange:e=>{p(e)},onClose:i.close,parentStore:o,context:S.Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}if("location"===l){if(!(0,a.Mp)(n))return h;const e=n,i=(0,a.u0)(e);return(0,k.jsx)(O.ZP,{popupType:d.device.isMobile?O.Z4.SlideUp:O.Z4.Popup,renderOrigin:e=>(0,k.jsx)(X,{parentStore:o,operatorValues:i,events:e}),render:i=>(0,k.jsx)(S.ZP,{collectionViewId:s,propertyFilter:{property:r,filter:e},schema:t,onChange:e=>{p(e)},onClose:i.close,parentStore:o,context:S.Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}if("relation"===l){if(!(0,a.e)(n)||!s)return h;const e=n;if((0,a.mv)(e))return h;const i=(0,a.YO)(e);return(0,k.jsx)(O.ZP,{popupType:d.device.isMobile?O.Z4.SlideUp:O.Z4.Popup,renderOrigin:e=>(0,k.jsx)(ne,{parentStore:o,operatorValues:i,events:e,schema:t,property:r}),render:i=>(0,k.jsx)(S.ZP,{collectionViewId:s,propertyFilter:{property:r,filter:e},schema:t,onChange:e=>{p(e)},onClose:i.close,parentStore:o,context:S.Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}if("person"===l){if(!(0,a.Gb)(n)||!s)return h;const e=n;if((0,a.mv)(e))return h;const i=(0,a.R8)(e);return(0,k.jsx)(O.ZP,{popupType:d.device.isMobile?O.Z4.SlideUp:O.Z4.Popup,renderOrigin:e=>(0,k.jsx)(ie,{parentStore:o,operatorValues:i,events:e}),render:i=>(0,k.jsx)(S.ZP,{collectionViewId:s,propertyFilter:{property:r,filter:e},schema:t,onChange:e=>{p(e)},onClose:i.close,parentStore:o,context:S.Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}if("file"===l){if(!(0,a.W6)(n))return h;const e=n;if((0,a.mv)(e))return h;(0,f.t1)(e)}return"verification"===l?(0,a.Jw)(n)?(0,k.jsx)(O.ZP,{popupType:d.device.isMobile?O.Z4.SlideUp:O.Z4.Popup,renderOrigin:e=>(0,k.jsx)(J,{operatorValues:(0,a.fl)(n),events:e}),render:e=>(0,k.jsx)(S.ZP,{collectionViewId:s,propertyFilter:{property:r,filter:n},schema:t,onChange:e=>{p(e)},onClose:e.close,parentStore:o,context:S.Qv.AdvancedFilter,allowRelativePersonFilter:!1})}):h:((0,f.t1)(l),null)};function N(){return{maxWidth:F.oe}}function H(e){return{paddingTop:e?6:void 0,overflow:"hidden"}}function q(e){let{operatorValue:t,events:r}=e;const o=null==t?void 0:t.value;return(0,k.jsx)(Q.Z,{...r,disableMargins:!0,placeholder:(0,k.jsx)(m.FormattedMessage,{defaultMessage:"Select a value",id:"database.filterOperatorValue.checkboxPlaceholder.title"}),title:"boolean"==typeof o&&(0,k.jsx)(G.Z,{checked:o,size:16,disabled:!0})})}function J(e){let{operatorValues:t,events:r}=e;const o=t.filter((e=>{let{value:t}=e;return Boolean(t)})).map(M.cq);return(0,k.jsx)(Q.Z,{...r,disableMargins:!0,placeholder:(0,k.jsx)(m.FormattedMessage,{defaultMessage:"Select an option",id:"CollectionFilterMenuFilterOperatorValue.verificationFilterSelect.placeholder"}),title:o.length&&(0,k.jsx)("span",{children:(0,h.Z)(o,(e=>(0,k.jsx)("span",{style:{whiteSpace:"pre"},children:(0,k.jsx)(m.FormattedMessage,{defaultMessage:", ",id:"CollectionFilterMenuFilterOperatorValue.verificationFilterSelect.commaSeparator"})},e)))})})}function X(e){let{operatorValues:t,events:r,parentStore:o}=e;return(0,k.jsx)(Q.Z,{...r,disableMargins:!0,desktopStyle:N(),innerStyle:H(t.length>0),placeholder:(0,k.jsx)(m.FormattedMessage,{defaultMessage:"Select a location",id:"databaseLocationOperators.selectPlaceholder"}),title:t.length>0&&t.map((e=>e.value&&(0,k.jsx)("div",{style:{margin:"0 10px 6px 0"},children:(0,k.jsx)(C.Z,{collectionStore:w.NW.createChildStore(o,{table:"collection",id:e.value})})},e.value)))})}function Y(e){let{operatorValue:t,events:r,isRange:o,schema:i,property:n}=e;const s=i[n],l=s&&"date"===s.type?s.date_format:void 0;let a;if("exact"===t.type&&t.value)if((0,u.J_)(t.value))a=t.value;else if((0,u.gR)(t.value)){const e=(0,u.Gc)(t.value);e&&(a=e.value)}return(0,k.jsx)(Q.Z,{...r,placeholder:o?(0,k.jsx)(m.FormattedMessage,{defaultMessage:"Select a range",id:"database.filterAndSort.dateRangePropertyValue.placeholder"}):(0,k.jsx)(m.FormattedMessage,{defaultMessage:"Select a date",id:"database.filterAndSort.datePropertyValue.placeholder"}),desktopStyle:{minWidth:165},title:a&&(0,k.jsx)("span",{style:{...x.Z.textOverflowStyle},children:(0,k.jsx)(D.Z,{value:a,dateFormat:l||u.sF})}),disableMargins:!0})}function ee(e){let{operatorValues:t,events:r,schema:o,property:n}=e;const s=(0,i.O7)(),{device:l}=s,a=o[n],u=a&&((0,p.cu)(a)||"status"===a.type)&&a.options||[];return(0,k.jsx)(Q.Z,{...r,disableMargins:!0,desktopStyle:N(),innerStyle:H(t.length>0),placeholder:(0,k.jsx)(m.FormattedMessage,{defaultMessage:"Select an option",id:"collections.operatorValueSelect.placeholder"}),title:t.length>0&&(0,k.jsx)(k.Fragment,{children:t.map((e=>{if(void 0===e.value)return null;const t=(0,c.i7)(u,e.value);return t?(0,k.jsx)($.a,{format:l.isMobile?d.lo.Large:d.lo.Medium,isSingle:!1,value:t.value,color:t.color,showRemoveButton:!1},e.value):null}))})})}function te(e){let{filter:t,intl:r,collectionViewId:n,property:s,schema:l,parentStore:p,onChange:c,collectionViewType:d}=e;const u=(0,i.O7)();if(!n)return null;const h={menuTitle:r.formatMessage(z.dateTitle),items:a.tO,getKey:e=>"relative"===e.type?e.value:e.type,selectedItem:t.value,onSelect:e=>{const r={...t,value:e};c(r),y.wd(u,{view_type:d,action:"set_filter_value_type"})},renderItem:e=>(0,k.jsx)(R.Z,{title:(0,M.x)(e.value),...e}),renderOrigin:e=>(0,k.jsx)(Q.Z,{...e,disableMargins:!0,placeholder:r.formatMessage(z.emptyPlaceholder),title:(0,M.x)(t.value)})},g=t.value;if("exact"===g.type){const e=(0,k.jsx)(o.Fragment,{children:(0,k.jsx)(m.FormattedMessage,{id:"collectionFilterMenuFilterOperatorValue.date.exact.order",defaultMessage:"{exact}{dateValue}",values:{exact:(0,k.jsx)(B.Z,{...h,mobileActionSheet:!0},"date-filter-value-type"),dateValue:(0,k.jsx)(O.ZP,{popupType:u.device.isMobile?O.Z4.SlideUp:O.Z4.Popup,renderOrigin:e=>(0,k.jsx)(Y,{schema:l,property:s,operatorValue:g,events:e,isRange:!1}),render:e=>(0,k.jsx)(S.ZP,{collectionViewId:n,propertyFilter:{property:s,filter:t},schema:l,onChange:e=>{c(e)},onClose:e.close,parentStore:p,context:S.Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}})}),r=u.device.isDesktop?{display:"grid",justifyContent:"stretch",gridTemplateColumns:"1fr 1fr",gridColumnGap:v.l0,width:"100%"}:void 0;return(0,k.jsx)("div",{style:r,children:e})}return(0,k.jsx)(B.Z,{...h,mobileActionSheet:!0},"date-filter-value-type")}function re(e){let{filter:t,intl:r,parentStore:n,schema:s,collectionViewId:l,property:p,onChange:c,collectionViewType:d}=e;const u=(0,i.O7)();if(!l)return null;const h={menuTitle:r.formatMessage(z.dateTitle),items:(0,a.bS)(),getKey:e=>(0,a.eX)(e),selectedItem:t.value,onSelect:e=>{const r={...t,value:e};c(r),y.wd(u,{view_type:d,action:"set_filter_value_type"})},renderItem:e=>(0,k.jsx)(R.Z,{title:(0,M.ip)(e.value),...e}),renderOrigin:e=>(0,k.jsx)(Q.Z,{...e,disableMargins:!0,placeholder:r.formatMessage(z.emptyPlaceholder),title:(0,M.ip)(t.value)})},g=t.value;if("exact"===g.type){const e=(0,k.jsx)(o.Fragment,{children:(0,k.jsx)(m.FormattedMessage,{id:"collectionFilterMenuFilterOperatorValue.dateRange.exact.order",defaultMessage:"{dateValue}",values:{exact:(0,k.jsx)(B.Z,{...h,mobileActionSheet:!0},"date-filter-value-type"),dateValue:(0,k.jsx)(O.ZP,{popupType:u.device.isMobile?O.Z4.SlideUp:O.Z4.Popup,renderOrigin:e=>(0,k.jsx)(Y,{schema:s,property:p,operatorValue:g,events:e,isRange:!0}),render:e=>(0,k.jsx)(S.ZP,{collectionViewId:l,propertyFilter:{property:p,filter:t},schema:s,onChange:e=>{c(e)},onClose:e.close,parentStore:n,context:S.Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}})}),r=u.device.isDesktop?{display:"grid",justifyContent:"stretch",gridTemplateColumns:"1fr 1fr",gridColumnGap:v.l0,width:"100%"}:void 0;return(0,k.jsx)("div",{style:r,children:e})}return"relative"!==g.type||"custom"!==g.value&&"surrounding"!==g.value?(0,k.jsx)(B.Z,{...h,mobileActionSheet:!0},"date-filter-value-type"):(0,k.jsx)(K.b,{renderAsQueryDropdown:u.device.isMobile,filter:g,onUpdate:e=>{const r={...t,value:e};c(r),y.wd(u,{view_type:d,action:"set_filter_value_type"})}})}function oe(e){var t;let{operatorValue:r,parentStore:o}=e;const s=(0,i.O7)(),{device:a}=s,p=(0,n.VK)((()=>!r.value||"relative"===r.type&&"me"===r.value?void 0:(0,l.Hl)({pointer:r.value,getRecordValue:o.getRecordValue})),[r,o]);return r.value?"relative"===r.type&&"me"===r.value?(0,k.jsx)("span",{style:{marginTop:1,marginRight:10,marginBottom:6},children:(0,k.jsx)(m.FormattedMessage,{defaultMessage:"Me",id:"database.filterAndSort.firstPersonPropertyValue.title"},"relative")}):p?(0,k.jsx)(U.ZP,{actor:p,isSingle:!1,shouldShrink:!1,format:a.isMobile?U.vw.Format.Large:U.vw.Format.Medium,showRemoveButton:!1},null===(t=p.asActor)||void 0===t?void 0:t.id):null:null}function ie(e){let{operatorValues:t,events:r,parentStore:o}=e;return(0,k.jsx)(Q.Z,{...r,placeholder:E(void 0),disableMargins:!0,desktopStyle:N(),innerStyle:H(t.length>0),title:t.length>0&&t.map((e=>(0,k.jsx)(oe,{operatorValue:e,parentStore:o},`${e.type}__${e.value}`)))})}function ne(e){let{operatorValues:t,events:r,parentStore:o,schema:l,property:a}=e;const c=(0,s.Fg)(),u=(0,i.O7)(),{device:h}=u,x=(0,n.VK)((()=>{const e=l[a];if(e&&(0,p.p_)(e))return(0,b.ke)(e,o)}),[l,a,o]);return(0,k.jsx)(Q.Z,{...r,disableMargins:!0,desktopStyle:N(),innerStyle:H(t.length>0),placeholder:(0,k.jsx)(m.FormattedMessage,{defaultMessage:"Select a page",id:"databaseRelationOperators.selectPlaceholder"}),title:t.length>0&&t.map(((e,t)=>{if(!e.value)return null;const r=e.type,i={isSingle:!1,shouldShrink:!1,format:h.isMobile?d.lo.Large:d.lo.Medium};return"exact"===r?(0,k.jsx)(W.Z,{blockId:e.value,parentStore:o,...i},e.value):"relative"===r?x?(0,k.jsx)(d.ZP,{value:(0,k.jsx)(m.FormattedMessage,{...g.qB[x][e.value.variable].messageDescriptor}),backgroundColor:"transparent",theme:c,...i},t):null:void(0,f.t1)(r)}))})}},77498:(e,t,r)=>{r.d(t,{Z:()=>b});r(30541);var o=r(43261),i=r.n(o),n=(r(67294),r(480)),s=r(86628),l=r(98953),a=r(99036),p=r(80951),c=r(9291),d=r(53965),u=r(92658),h=r(60709),g=r(68894),m=r(78140),f=r(32163),x=r(43765),y=r(40721),v=r(72495),M=r(69872),j=r(85893);const b=function(e){let{selectedProperty:t,onAccept:r,schema:o,onClose:b,allowProperty:w,isRelationProperty:F}=e;const S=(0,n.O7)(),C=(0,c.useIntl)(),V=(0,s.qz)(void 0,u.Z);let Z=Object.keys(o);const T=Z.some(l.w);Z=d.MR(Z,(e=>{const t=(0,p.Qm)({schema:o,property:e});return t?t.name:""}));const P=T?a.bf:a.iw;Z=d.zu(Z,P),Z.unshift(P);const I=(0,s.VK)((()=>V.state.inputValue),[V]);if(w&&(Z=Z.filter((e=>{const t=(0,p.Qm)({schema:o,property:e});return t&&w(t)}))),I){let e=Z.map((e=>{const t=(0,p.Qm)({schema:o,property:e});return t&&t.name}));e=i().filter(I,e).map((e=>{let{original:t}=e;return t})),Z=Z.filter((t=>{const r=(0,p.Qm)({schema:o,property:t});return r&&r.name&&e.includes(r.name)}))}const k=I||Z.length>6,A=d.oA(Z.map((e=>{const i=(0,p.Qm)({schema:o,property:e});if(!i)return null;return{key:e,render:r=>(0,j.jsx)(M.Z,{...r,propertySchema:i,format:M.L.Name,selected:e===t}),action:()=>r(e)}}))),_=[{key:0,render:e=>(0,j.jsx)(v.Z,{...e}),items:A}],{device:R}=S,O=k?(0,j.jsx)(v.Z,{isInput:!0,children:(0,j.jsx)(g.ZP,{focus:!R.isMobile||void 0,focusAfterAnimation:!0,value:I,onChange:e=>V.setState({focus:!0,inputValue:e.target.value}),placeholder:F?C.formatMessage({defaultMessage:"Search for a relation property…",id:"propertySelectMenu.searchForProperty.relation.placeholder"}):C.formatMessage({defaultMessage:"Search for a property…",id:"propertySelectMenu.searchForProperty.default.placeholder"})})}):null;let G;return G=R.isMobile?{menuType:h.og.Modal,title:F?C.formatMessage({defaultMessage:"Relation property",id:"propertySelectMenu.mobileMenu.relationProperty.header"}):C.formatMessage({defaultMessage:"Property",id:"propertySelectMenu.mobileMenu.property.header"}),right:(0,j.jsx)(y.CancelMenuText,{}),onClickRight:b,header:O}:{menuType:h.og.Popup,width:280,maxHeight:480,header:O},(0,j.jsx)(m.Z,{...G,children:0===A.length?(0,j.jsx)(v.Z,{children:(0,j.jsx)(x.Z,{title:(0,j.jsx)(c.FormattedMessage,{defaultMessage:"No results",id:"propertySelectMenu.search.noResults.title"})})}):(0,j.jsx)(f.Z,{type:f.i.Vertical,sections:_,onAccept:b,initialFocus:I.length>0?0:void 0})})}},50542:(e,t,r)=>{r.d(t,{Z:()=>c});r(67294);var o=r(480),i=r(9291),n=r(52275),s=r(97820),l=r(69872),a=r(62045),p=r(85893);const c=function(e){const t=(0,o.O7)(),{device:r}=t;if(r.isMobile)return e.propertySchema?(0,p.jsx)(l.Z,{propertySchema:e.propertySchema,onClick:e.onClick,focused:!1,format:l.L.Name,showExtensionArrow:!e.disabled}):(0,p.jsx)(n.Z,{focused:!1,title:(0,p.jsx)(i.FormattedMessage,{defaultMessage:"Property",id:"database.mobileFilterAndSortMenu.property.buttonMenuItem.label"})});{const t=e.propertySchema&&(0,p.jsx)(s.Z,{propertySchema:e.propertySchema,showIcon:!0,style:{lineHeight:1.4}}),r=(0,p.jsx)(i.FormattedMessage,{defaultMessage:"Property",id:"database.filterAndSortMenu.propertyButton.label"});return(0,p.jsx)(a.Z,{title:t,placeholder:r,onClick:e.onClick,disabled:e.disabled,disableMargins:e.disableMargins,desktopStyle:e.textWrapperStyle})}}},68965:(e,t,r)=>{r.d(t,{t:()=>n});r(67294);var o=r(45238),i=r(85893);const n=(0,o.IU)("addFilterGroup",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.374 12.42h1.293v1.157c0 1.557.787 2.344 2.375 2.344h7.591c1.573 0 2.367-.787 2.367-2.344V5.924c0-1.557-.794-2.344-2.367-2.344h-1.3V2.423C12.333.866 11.539.08 9.966.08H2.374C.786.08 0 .866 0 2.423v7.653c0 1.557.786 2.344 2.374 2.344zm.015-1.218c-.756 0-1.172-.408-1.172-1.194V2.49c0-.786.416-1.194 1.172-1.194h7.554c.749 0 1.172.408 1.172 1.194v1.09H6.042c-1.588 0-2.375.778-2.375 2.343v5.278H2.39zm3.668 3.501c-.749 0-1.172-.408-1.172-1.194V5.991c0-.786.423-1.194 1.172-1.194h7.554c.748 0 1.172.408 1.172 1.194v7.516c0 .787-.424 1.195-1.172 1.195H6.057zm3.773-1.565c.4 0 .643-.272.643-.71v-2.042h2.17c.423 0 .718-.227.718-.628 0-.408-.272-.643-.718-.643h-2.17V6.938c0-.447-.242-.719-.643-.719-.4 0-.628.288-.628.719v2.177h-2.17c-.438 0-.718.235-.718.643 0 .4.295.628.718.628h2.17v2.041c0 .424.227.711.628.711z"})})}}]);