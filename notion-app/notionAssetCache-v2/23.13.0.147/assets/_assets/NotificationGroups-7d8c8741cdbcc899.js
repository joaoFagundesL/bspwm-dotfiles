"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[6329],{28260:(e,t,i)=>{i.r(t),i.d(t,{default:()=>N});var o=i(67294),n=i(480),a=i(86628),r=i(24405),s=i(21202),l=i(19719),c=i(77907),d=i(6258),u=i(37444),g=i(15145),f=i(17693),p=i(91),h=i(75246),b=i(29369),m=i(9291),y=i(37810),v=i(64921),x=i(31278),M=i(76798),k=i(63082),R=i(22649),w=i(85893);const A=(0,m.defineMessages)({open:{defaultMessage:"Open",id:"toggleButton.open"},close:{defaultMessage:"Close",id:"toggleButton.close"}});function I(e){const t=(0,n.Fy)(),i=(0,m.useIntl)(),a=t.isMobile?30:22,s=(0,r.yK)((()=>{const i=e.color||"inherit",o="chevron"===e.icon?`rotateZ(${e.open?-180:0}deg)`:`rotateZ(${e.open?180:90}deg)`,n="chevron"===e.icon,r=n&&t.isMobile;return{button:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",width:a,height:a,borderRadius:"100%",...e.style},arrow:{width:r?14:n?12:"0.6875em",height:r?14:n?12:"0.6875em",transition:"transform 200ms ease-out",transform:o,fill:i,opacity:e.fill?1:.5}}}),[t.isMobile,e.color,e.fill,e.icon,e.open,e.style,a]),l=(0,o.useMemo)((()=>"chevron"===e.icon?(0,f.A)(s.arrow):(0,p.L)(s.arrow)),[e.icon,s.arrow]);return(0,w.jsxs)(v.Z,{ariaLabel:e.open?i.formatMessage(A.close):i.formatMessage(A.open),"aria-describedby":e["aria-describedby"],"aria-expanded":e.open,"aria-controls":e.open?e["aria-controls"]:void 0,style:s.button,onClick:e.onClick,onMouseDown:e.onMouseDown,disabled:e.disabled,allowShiftClick:!0,children:[e.tapArea&&(0,w.jsx)("div",{style:{position:"absolute",opacity:0,width:e.tapArea.size,height:e.tapArea.size,top:-(e.tapArea.size-a)/2,left:-(e.tapArea.size-a)/2}}),l]})}const S=function(e){const{titledRecordStore:t,getRecordModel:i,notifications:s,isNotificationGroupExpanded:c,toggleNotificationGroup:f,isNotificationGroupTitleHovered:p,setIsNotificationGroupTitleHovered:m}=e,A=(0,n.Fy)(),[S,C]=(0,o.useState)(!1),j=(0,a.VK)((()=>t.getModel()),[t]),N=(0,a.VK)((()=>null==j?void 0:j.getRenderIcon({getRecordModel:i})),[j,i]),B=(0,a.VK)((()=>t instanceof d.G&&t.isEmptyPage()),[t]),T=(0,a.VK)((()=>{if(j&&j.table!==h.bx&&j.table!==b.e0)return j.getRenderUrl({getRecordModel:t.getRecordModel,pageVisitSource:g.tY.Notification})}),[j,t]),_=(0,a.VK)((()=>s.filter((e=>{let{notification:t}=e;return!t.read})).length),[s]),G=(0,n.O7)(),Z=(0,o.useCallback)((e=>{e.stopPropagation(),l.Ee(G,{target:"title",notificationActivityPairs:s})}),[G,s]),L=s&&(p||A.isMobile),z=(0,o.useRef)(null),[F,P]=(0,o.useState)(!1);(0,o.useEffect)((()=>{if(!z)return;const{current:e}=z;if(!e)return;const t="IntersectionObserver"in window?new IntersectionObserver((e=>{let[t]=e;return P(t.intersectionRatio<1)}),{threshold:[1]}):void 0;return null==t||t.observe(e),()=>null==t?void 0:t.unobserve(e)}),[z]);const K=(0,r.yK)((e=>({container:{position:"sticky",top:-.01,zIndex:10,background:e.buttonBackground,boxShadow:F?"0px 1px 1px rgba(0, 0, 0, 0.03)":"0 0 0 transparent",transition:"box-shadow 300ms"},button:{display:"flex",gap:10,justifyContent:"space-between",alignItems:"center",height:40,paddingLeft:3,background:p?void 0:e.buttonBackground,paddingRight:u.zF,borderTopLeftRadius:4,borderTopRightRadius:4,...!c&&{borderBottomLeftRadius:4,borderBottomRightRadius:4}},hoveredButton:{background:e.whiteButtonHoveredBackground,borderTopLeftRadius:4,borderTopRightRadius:4,...!c&&{borderBottomLeftRadius:4,borderBottomRightRadius:4}},pressedButton:{background:e.whiteButtonPressedBackground,borderTopLeftRadius:4,borderTopRightRadius:4,...!c&&{borderBottomLeftRadius:4,borderBottomRightRadius:4}},icon:{...R.e9,verticalAlign:"unset",marginRight:4},pageIcon:{...R.e9,verticalAlign:"unset",marginLeft:-1,marginRight:3},nonActionsArea:{display:"flex",flexShrink:2,minWidth:0},pageTitleButton:{display:"flex",alignItems:"center",height:24,minWidth:0,borderRadius:4,paddingLeft:2,paddingRight:6},recordTitle:{fontSize:14,fontWeight:_>0?y.Z.fontWeight.medium:y.Z.fontWeight.regular,color:S?e.mediumTextColor:e.regularTextColor,display:"inline",width:"100%",...y.Z.textOverflowStyle},updateCount:{color:e.mediumTextColor,fontSize:12},toggleContainer:{display:"flex",justifyContent:"center",alignItems:"center",height:24,width:24,flexShrink:0},toggleChevron:{color:e.lightIconColor},notificationGroupActionsMenu:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:0},noBackground:{background:void 0}})),[c,p,S,_,F]);return j?(0,w.jsx)("div",{ref:z,style:K.container,children:(0,w.jsxs)(v.Z,{onClick:f,onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1),style:K.button,hoveredStyle:K.hoveredButton,pressedStyle:K.pressedButton,mobileFeedback:!1,children:[(0,w.jsxs)("div",{style:K.nonActionsArea,children:[(0,w.jsx)("div",{style:K.toggleContainer,children:(0,w.jsx)(I,{fill:!0,isSidebar:!0,icon:"chevron",open:c,onClick:f,color:K.toggleChevron.color})}),(0,w.jsxs)(v.Z,{style:K.pageTitleButton,href:T,external:!1,disabled:!Boolean(T),onMouseEnter:()=>C(!0),onMouseLeave:()=>C(!1),hoveredStyle:K.noBackground,pressedStyle:K.noBackground,onClick:Z,children:[(0,w.jsx)(x.Z,{disabled:!0,icon:N,isEmptyPage:B,size:Boolean(N)?12:14,style:N?K.icon:K.pageIcon}),(0,w.jsx)(M.Z,{store:t,style:K.recordTitle,shouldWrap:!0})]})]}),(0,w.jsx)("div",{style:K.notificationGroupActionsMenu,children:L&&(0,w.jsx)(k.Z,{notificationActivityPairs:s})})]})}):null};function C(e){const{notifications:t,rootStore:i,source:g,tab:f,isFirst:p}=e,[h,b]=(0,o.useState)(!1),[m,y]=(0,o.useState)(!0),v=(0,n.O7)(),x=(0,o.useCallback)((()=>{y(!m),l.Ee(v,{target:m?"collapse":"expand",notificationActivityPairs:t})}),[v,m,t]),M=(0,a.VK)((()=>{const e=t[0].notification.navigable_block_id;if(e)return d.G.createChildStore(i,{table:s.iU,id:e})}),[i,t]),k=(0,r.yK)((e=>({toggle:{color:e.lightIconColor},flatIndentFooter:{height:10,backgroundColor:e.sidebarBackground},groupContainer:{backgroundColor:h?e.buttonHoveredBackground:e.buttonBackground,borderRadius:4,marginTop:p?0:u.MY,marginBottom:u.MY,marginLeft:u.MY,marginRight:u.MY},divider:{height:8,backgroundColor:e.sidebarBackground}})),[h,p]);if(!M){const{notification:i,activity:o}=t[0],n={source:"notifications_tab",tab:e.tab,notification:i};return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{style:k.groupContainer,children:(0,w.jsx)(c.LazyActivityNotification,{activity:o,rootStore:e.rootStore,tabArgs:n,isFirst:!0,isLast:!0,useInboxRedesign:!0},o.id)}),(0,w.jsx)("div",{style:k.divider})]})}const R=t.map(((i,o)=>{let{notification:n,activity:a}=i;const r={source:"notifications_tab",tab:e.tab,notification:n};return(0,w.jsx)(c.LazyActivityNotification,{activity:a,rootStore:e.rootStore,isFirst:0===o,isLast:o===t.length-1,tabArgs:r,useInboxRedesign:!0},a.id)}));return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)("div",{style:k.groupContainer,children:[(0,w.jsx)(S,{titledRecordStore:M,getRecordModel:i.getRecordModel,activity:t[0].activity,tabArgs:{source:g,tab:f,notification:t[0].notification},notifications:t,isNotificationGroupTitleHovered:h,setIsNotificationGroupTitleHovered:b,isNotificationGroupExpanded:m,toggleNotificationGroup:x}),(0,w.jsx)("div",{children:m&&R})]}),(0,w.jsx)("div",{style:k.divider})]})}function j(e){const{notifications:t,rootStore:i,source:o,tab:n}=e,a=(0,r.yK)((e=>({container:{display:"flex",flexDirection:"column",backgroundColor:e.contentBackground}})),[]);return(0,w.jsx)("div",{style:a.container,children:Array.from(t).map(((e,t,a)=>{let[r,s]=e;return(0,w.jsx)(C,{notifications:s,rootStore:i,source:o,tab:n,isFirst:0===t,isLast:t===a.length-1},`group-${r}`)}))})}j.displayName="NotificationGroups";const N=j},63082:(e,t,i)=>{i.d(t,{Z:()=>k});var o=i(67294),n=i(480),a=i(86628),r=i(24405),s=i(52867),l=i(70753),c=i(61248),d=i(9291),u=i(37810),g=i(19719),f=i(54642),p=i(17659),h=i(12534),b=i(41549),m=i(73063),y=i(26388),v=i(85893);function x(e){const{notificationActivityPairs:t}=e,i=t.map((e=>{let{notification:t}=e;return t})),x=(0,n.O7)(),k=(0,n.Fy)(),R=(0,d.useIntl)(),w=i?i[0]:void 0,A=(0,a.VK)((()=>i.every((e=>e.read))),[i]),I=(0,a.VK)((()=>b.Fz()),[]),[S,C]=(0,o.useState)(!1),j=(0,o.useCallback)((e=>{i&&w&&(0,h.ZP)({event:e,context:h.Af.NotificationClick,callback:()=>{C(!0);const e=i.map((e=>{let{id:t}=e;return t}));(async()=>{try{await f.setNotificationsStatus(x,{spaceId:w.space_id,notificationIds:e,archived:!0})}finally{C(!1)}})();const o=i.filter((e=>!e.read));p.Jl("mentions",w.space_id,(e=>Math.max(e-o.length,0))),g.Ee(x,{target:"archive",affectedNotificationIds:e,notificationActivityPairs:t})}})}),[x,i,w,t]),N=(0,o.useCallback)((e=>{i&&w&&(0,h.ZP)({event:e,context:h.Af.NotificationClick,callback:()=>{let e;if(C(!0),A){const o=i.map((e=>{let{id:t}=e;return t}));e=async()=>{try{await f.setNotificationsStatus(x,{spaceId:w.space_id,notificationIds:o,read:!1})}finally{C(!1)}},p.Jl("mentions",w.space_id,(e=>e+o.length)),g.Ee(x,{target:"mark_as_unread",affectedNotificationIds:o,notificationActivityPairs:t})}else{const o=i.filter((e=>!e.read)).map((e=>{let{id:t}=e;return t}));e=async()=>{try{await f.setNotificationsStatus(x,{spaceId:w.space_id,notificationIds:o,read:!0})}finally{C(!1)}},p.Jl("mentions",w.space_id,(e=>Math.max(e-o.length,0))),g.Ee(x,{target:"mark_as_read",affectedNotificationIds:o,notificationActivityPairs:t})}e()}})}),[x,i,w,A,t]),B=(0,r.yK)((e=>({container:{display:"flex",height:"min-content",padding:k.isMobile?0:2,borderWidth:k.isMobile?0:1,borderStyle:"solid",borderColor:k.isMobile?"transparent":e.stroke.regular,background:k.isMobile?"transparent":e.surface.elevated,borderRadius:6},button:{height:k.isMobile?30:26,width:k.isMobile?30:26},inboxIconBase:{fill:e.icon.secondary,stroke:e.icon.secondary,strokeOpacity:1,strokeWidth:.25},iconStyle:{fill:e.mediumIconColor,padding:2},readIcon:{width:k.isMobile?21:19,height:k.isMobile?22:20},archiveIcon:{width:k.isMobile?24:23,height:k.isMobile?24:23},ellipsisIcon:{width:k.isMobile?24:23,height:k.isMobile?24:23},headerLabel:{paddingLeft:16,paddingRight:16,paddingTop:10,fontWeight:u.Z.fontWeight.semibold}})),[k]);return w?"archived_only"===I?null:(0,v.jsxs)("div",{style:B.container,children:[(0,v.jsx)(y.ZP,{renderTooltip:()=>(0,v.jsx)(d.FormattedMessage,{...M.archiveNotificationGroup}),render:e=>(0,v.jsx)(m.Z,{ariaLabel:R.formatMessage(M.archiveNotificationGroup),style:B.button,icon:s.H,iconStyle:{...B.iconStyle,...B.archiveIcon,height:18,width:18,...B.inboxIconBase},onClick:j,disabled:S,...e})}),(0,v.jsx)(y.ZP,{renderTooltip:()=>A?(0,v.jsx)(d.FormattedMessage,{...M.markNotificationGroupAsUnread}):(0,v.jsx)(d.FormattedMessage,{...M.markNotificationGroupAsRead}),render:e=>(0,v.jsx)(m.Z,{ariaLabel:A?R.formatMessage(M.markNotificationGroupAsUnread):R.formatMessage(M.markNotificationGroupAsRead),style:B.button,icon:A?c.F:l.F,iconStyle:{...B.iconStyle,...B.readIcon,...A?{height:17,width:17}:{height:16,width:16},...B.inboxIconBase},onClick:N,disabled:S,...e})})]}):null}const M=(0,d.defineMessages)({markNotificationGroupAsRead:{defaultMessage:"Mark notifications in this page as read",id:"NotificationGroupActionsMenu.markNotificationAsRead.tooltipMessage"},markNotificationGroupAsUnread:{defaultMessage:"Mark notifications in this page as unread",id:"NotificationGroupActionsMenu.markNotificationAsUnread.tooltipMessage"},archiveNotificationGroup:{defaultMessage:"Archive notifications in this page",id:"NotificationGroupActionsMenu.handleArchive.tooltipMessage"},changePageNotificationSettings:{defaultMessage:"Change page notification settings",id:"NotificationGroupActionsMenu.notificationSettings.tooltipMessage"}}),k=o.memo(x)},57538:(e,t,i)=>{i.d(t,{Z:()=>a});var o=i(57883),n=i(1898);function a(e){switch(e){case"all":return{following:!0,followSettings:(0,o.yI)({explicitly_set_by_user:!0})};case"important":return{following:!0,followSettings:(0,o.GC)({explicitly_set_by_user:!0})};case"comments":return{following:!0,followSettings:(0,o.r$)({explicitly_set_by_user:!0})};case"none":return{following:!1,followSettings:(0,o.vU)({explicitly_set_by_user:!0})};default:(0,n.t1)(e)}}},90334:(e,t,i)=>{i.d(t,{O:()=>a});i(67294);var o=i(45238),n=i(85893);const a=(0,o.IU)("ellipsis",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M2.887 9.014c.273 0 .52-.064.738-.192.219-.132.394-.307.526-.526.133-.219.199-.46.199-.725 0-.405-.142-.747-.424-1.025a1.41 1.41 0 00-1.04-.417c-.264 0-.505.066-.724.198a1.412 1.412 0 00-.718 1.244c0 .265.064.506.192.725.132.219.307.394.526.526.219.128.46.192.725.192zm5.113 0a1.412 1.412 0 001.244-.718c.132-.219.198-.46.198-.725 0-.405-.14-.747-.423-1.025A1.386 1.386 0 008 6.129c-.264 0-.506.066-.725.198a1.412 1.412 0 00-.718 1.244c0 .265.064.506.192.725.132.219.308.394.526.526.22.128.46.192.725.192zm5.106 0c.265 0 .506-.064.725-.192.219-.132.394-.307.526-.526.133-.219.199-.46.199-.725 0-.405-.142-.747-.424-1.025a1.394 1.394 0 00-1.026-.417 1.474 1.474 0 00-1.265.718c-.127.218-.19.46-.19.724 0 .265.063.506.19.725.133.219.308.394.527.526.223.128.47.192.738.192z"})})},70693:(e,t,i)=>{i.d(t,{mb:()=>s,nK:()=>l,pe:()=>c});var o=i(40506),n=i(7057),a=i(53877),r=i(42875);function s(e){const{dateTime:t,intl:i,shortenDateAndRange:o}=e,r=a.OQ.toPersistedDate(t.valueOf());return n.ZV({value:r,allowRelativeDates:!0,intl:i,shortenDateAndRange:o,displayInUserTimezone:!0})}function l(e){const{dateTime:t,intl:i,userTimeZone:o,displayInUserTimezone:r,alwaysIncludeTimezone:s}=e,l=a.OQ.toPersistedDateTime(t.valueOf(),t.zoneName);return n.ZV({value:l,allowRelativeDates:!0,intl:i,userTimeZone:o,displayInUserTimezone:r,alwaysIncludeTimezone:s})}function c(e){const{luxonRange:t,intl:i}=e,s=a.OQ.toPersistedDateRange(t),l=n.ZV({value:s,allowRelativeDates:!1,shortenDateAndRange:!0,intl:i,displayInUserTimezone:!0}),c=t.end.setZone((0,r.r)()),d=n.mr({start_time:c.toFormat(o.jK),humanReadable:!1,intl:i});return i.formatMessage({id:"verification.timeRange",defaultMessage:"{formattedDateRange} at {formattedEndTime}"},{formattedDateRange:l,formattedEndTime:d})}}}]);