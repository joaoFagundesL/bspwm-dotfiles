"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[3207],{36078:(e,t,n)=>{n.r(t),n.d(t,{OrganizationSettingsConsole:()=>k,OrganizationSettingsConsoleImpl:()=>B});var o=n(67294),r=n(480),i=n(84747),a=n(86628),s=n(89101),l=n(61149),c=n(12066),u=n(8055),d=n(80444),m=n(79921),f=n(68117),h=n(84880),p=n(59054),v=n(1898),b=n(54642);var g=n(60370),S=n(86631),M=n(85893);function A(e){let{organizationId:t,currentUserStore:n,selectedTabName:i}=e;const a=(0,r.O7)(),s=(0,o.useMemo)((()=>c.cZ.filter((e=>(0,g.eT[e.name])({environment:a,currentUserStore:n,organizationId:t})))),[n,a,t]),d=(0,o.useMemo)((()=>s.map((e=>({id:e.name,name:g.ow[e.name].tab.name,icon:g.ow[e.name].tab.icon,isSelected:i===e.name,onClick:()=>{u.c4({environment:a,url:(0,l.a5)({organizationId:t,tabRoute:e})})}})))),[a,s,i,t]);return(0,M.jsx)(S.Z,{items:d})}var I=n(73150),w=n(7802),_=n(98938);function B(e){let{organizationId:t,tabRoute:n,properties:o,params:i}=e;const s=(0,r.O7)(),{loading:l,organizationIds:c}=function(){const e=(0,r.O7)(),[{status:t,error:n,value:o}]=(0,p.r5)((async()=>{const t=await b.getUserOrganizations(e,{});if("success"===t.type)return t.data;if("failed"===t.type)throw t.error;return(0,v.t1)(t)}),[e]);return{organizationIds:(null==o?void 0:o.organizationIds)??[],loading:"pending"===t||"idle"===t,error:n}}(),u=(0,a.VK)((()=>d.default.state.currentUserStore),[]);if(l)return null;const S=t&&c.includes(t)?t:c[0];if(!S||!n)return(0,M.jsx)(y,{organizationId:S,queryParams:i});const I=g.ow[n.name];return(0,g.eT[n.name])({environment:s,currentUserStore:u,organizationId:S})?(0,M.jsx)(f.L,{children:(0,M.jsx)(h.n,{organizationId:S,children:(0,M.jsx)(m.v,{left:(0,M.jsx)(A,{organizationId:S,currentUserStore:u,selectedTabName:n.name}),right:I.scene({properties:o,queryParams:i,organizationId:S,tabRoute:n})})})}):null}const k=(x=(0,I.b)(B),function(e){return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(_.Z,{}),(0,M.jsx)(w.Z,{}),(0,M.jsx)(x,{...e})]})});var x;function y(e){const t=(0,r.O7)(),{organizationId:n,queryParams:o}=e;return(0,i.Z)((()=>{n?u.c4({environment:t,url:(0,l.a5)({organizationId:n,tabRoute:c.Wq,queryParams:o})}):u.c4({environment:t,url:s._j.root})})),null}},51783:(e,t,n)=>{n.d(t,{Bo:()=>K,eQ:()=>Q,QG:()=>ne,ol:()=>ce,fn:()=>ee,_W:()=>ue,vs:()=>de,O2:()=>V,UF:()=>le,Z3:()=>te,w1:()=>me,rZ:()=>X,s0:()=>J,GH:()=>ae,hc:()=>re,hD:()=>ie,pk:()=>oe,i2:()=>se,$$:()=>W,LQ:()=>Z,$3:()=>j,y6:()=>Y,Tz:()=>H,oQ:()=>$,Oh:()=>fe});var o=n(1302),r=n(70203),i=n(11342),a=n(83249),s=n(6404),l=n(36280),c=n(45990),u=n(67060),d=n(28020),m=n(27724),f=n(31781),h=n(42858),p=n(24677),v=n(13447),b=n(53471);var g=n(52423),S=n(84084),M=n(993),A=n(98724),I=n(98104),w=n(92022),_=n(18821),B=n(45162),k=n(24646),x=n(38676),y=n(44534),T=n(5162),E=n(80444),C=n(3418),N=n(19111),L=n(19671),O=n(56638),R=n(55320),P=n(24666),U=n(19037),z=n(68056),q=n(46654),D=n(73959),G=n(89086);function Z(e){const{environment:t}=e,{isMobileNative:n,osVersion:o,isIOS:r}=t.device;return!!n&&(!r||!i.isLessThanVersion(o,[14,0]))}const F=!1;function j(e,t,n){var o;const{NativeMobileActionBarStore:r}=e,i=F||Boolean(null==r?void 0:r.state.enableShouldShowDebugging);if(!function(e,t,n){const{device:o,NativeMobileActionBarStore:r}=e,i=F||Boolean(null==r?void 0:r.state.enableShouldShowDebugging);return o.isMobile?R.default.state.open?(he(i,"canShowMobileActionBar = false (reason: quickFindOpen)"),!1):L.Z.state.isOpen?(he(i,"canShowMobileActionBar = false (reason: blockPropertyOverlayOpen)"),!1):!o.isMobileNative&&N.Z.state.open?(he(i,"canShowMobileActionBar = false (reason: !device.isMobileNative && MentionMenuStore.state.open)"),!1):P.default.isEditingComment()?(he(i,"canShowMobileActionBar = false (reason: TextSelectionStore.isEditingComment())"),!1):!O.Z.state.open&&Z({environment:e})&&C.Z.hasOpenPopups()?(he(i,"canShowMobileActionBar = false (reason: !PageTemplateModalStore.state.open && isNativeMobileActionBarAvailable({ environment }) && GlobalPopupStore.hasOpenPopups() > 0)"),!1):k.in(e)&&x.sidebarOpenStore.state?(he(i,"canShowMobileActionBar = false (reason: sidebarHelpers.sidebarIsExpanded(environment) && sidebarOpenStore.get()"),!1):(0,U.ryx)()?!!(0,U.J5S)({environment:e,blocks:[t],publicEditMode:n})||(he(i,"canShowMobileActionBar = false (reason: !_canEdit)"),!1):(he(i,"canShowMobileActionBar = false (reason: !currentPageIsNotLocked())"),!1):(he(i,"canShowMobileActionBar = false (reason: !device.isMobile)"),!1)}(e,t,n))return he(i,"shouldShowMobileActionBar = false (reason: !canShowMobileActionBar)"),{canShow:!1,canShowNativeBar:!1,shouldShow:!1};const a=Z({environment:e});if(r&&null!==r.state.menuType&&!(0,d.JE)())return he(i,"shouldShowMobileActionBar = true (reason: NativeMobileActionBarStore && NativeMobileActionBarStore.state.menuType !== null"),{canShow:!0,canShowNativeBar:a,shouldShow:!0};const s=P.default.state;if("editing"!==s.mode)return he(i,"shouldShowMobileActionBar = false (reason: TextSelectionStore.state.mode !== editing"),{canShow:!0,canShowNativeBar:a,shouldShow:!1};const l=s.multiSelection,c=(0,B.L5)(l),u=c.some((e=>e.editable.props.disableStyleAnnotations)),m=c.some((e=>e.editable.props.disableMobileActionBar)),f=c.some((e=>e.editable.props.disableComment));return c&&m?(he(i,"shouldShowMobileActionBar = false (reason: !renderedBlocks || !disableMobileActionBar)"),{canShow:!0,canShowNativeBar:a,shouldShow:!1}):(he(i,"shouldShowMobileActionBar = true"),{shouldShow:!0,canShowNativeBar:a,disableStyleAnnotations:u,disableComment:f,isEmpty:(0,z.iG)(l)&&0===l.end.index&&0===(null===(o=(0,G.x0)(l.end.store))||void 0===o?void 0:o.endIndex)})}function H(e){const{environment:t,store:n}=e,{isPhone:o}=t.device,r=E.default.state.currentLoadingContainerStore,i=Boolean(null==n?void 0:n.isCollectionView()),a=Boolean(null==n?void 0:n.getAssociatedCollectionStore()),s=t.currentUser.isLoggedIn(),l=O.Z.state.open;return Boolean(!a&&!i&&!l&&o&&n&&r&&n.isDefined()&&n.canEdit()&&!n.hasContent()&&s&&r.state.ready)}function $(e,t){const n=(0,T.Y)("supportsNativeMobileDynamicActionBar"),o=P.default.state;if("editing"===o.mode)return!t.state.isComposing&&!(0,z.iG)(o.multiSelection)||!n&&y.g$.getSimpleTableCellFromTextSelection();const r=e.state.savedTextSelectionStoreState;return!(!r||"editing"!==r.mode)&&!(0,z.iG)(r.multiSelection)}function Y(e){const{NativeMobileActionBarStore:t,device:n}=e;return Boolean(t&&null!==t.state.menuType&&!n.isTablet&&!n.isAndroid&&!(0,T.Y)("supportsMobileActionBarNativeActionMenuWithoutIgnoreSelectionArea"))}function K(e){if((0,q.YF)(e))return!1;const{stores:t}=m.default.state;return t.length>0&&t[0].canEdit()&&!t[0].isNavigableBlock()&&!Boolean(y.g$.getSimpleTableCellFromTextSelection())}function Q(e,t){return!(0,q.YF)(e)&&t.canEdit()}function V(e){if("editing"!==P.default.state.mode)return;const t=(0,D.sQ)(P.default.state.multiSelection.start.store);t&&v.createAndCommit({userAction:"mobileActionBarHelpers.handleIndent",environment:e,perform:n=>{M.n2({environment:e,transaction:n,shiftKey:!1,closestSelectable:t})}}),fe(e,"indent")}function W(e){if("editing"!==P.default.state.mode)return;const t=(0,D.sQ)(P.default.state.multiSelection.start.store);t&&v.createAndCommit({userAction:"mobileActionBarHelpers.handleUnindent",environment:e,perform:n=>{M.n2({environment:e,transaction:n,shiftKey:!0,closestSelectable:t})}}),fe(e,"unindent")}function J(e){v.createAndCommit({userAction:"mobileActionBarHelpers.handleMoveUp",environment:e,perform:t=>{M.fs({environment:e,transaction:t,direction:"up"})}}),fe(e,"move-up")}function X(e){v.createAndCommit({userAction:"mobileActionBarHelpers.handleMoveDown",environment:e,perform:t=>{M.fs({environment:e,transaction:t,direction:"down"})}}),fe(e,"move-down")}function ee(e){const t=m.default.state.stores[0],n=P.default.state;if(t&&"editing"===n.mode){const{multiSelection:o}=n,r=(0,G.hn)(o.end.store)||(0,G.mK)(o.start.store);v.createAndCommit({userAction:"mobileActionBarHelpers.handleDelete",environment:e,perform:e=>{h.Od({store:t,transaction:e})}});if(y.g$.getSimpleTableCellFromTextSelection())v.createAndCommit({userAction:"mobileActionBarHelpers.handleDelete",environment:e,perform:t=>{y.HM.clearSelectedCell({environment:e,transaction:t})}});else if(r){const t=(0,D.sQ)(r);p.eP({environment:e,store:t}),p.Db(e)}else p.ZH(e);fe(e,"remove")}}function te(e){u.lZ(e,{page:!0,heading:!0,createPage:!0,user:!0,inviteUserToWorkspace:!1,inviteUserToPage:!0,bot:!0,date:!0,reminder:!0,templateVariable:!0,group:!0}),fe(e,"mention")}function ne(e){!function(e){if(1!==m.default.state.stores.length)return;const t=P.default.state;if("empty"===t.mode)return;if((0,z.iG)(t.multiSelection)){const n=t.multiSelection.start.store;I.mT({environment:e,store:n,canSelectAllBlocks:!1})}}(e),(0,w.toggleInitialPrompt)({from:"mobile_action_bar",environment:e}),fe(e,"ai")}function oe(e,t){A.aS({environment:e,annotation:t}),fe(e,t[0])}function re(e,t,n){const{NativeMobileActionBarStore:o}=e;null==o||o.update((e=>({...e,menuType:t,shouldRestoreSelectionForMenu:n})))}function ie(e,t){const{NativeMobileActionBarStore:n}=e;null==n||n.update((e=>({...e,subMenuType:t}))),null===t?S.xv():null!==t&&fe(e,t)}function ae(e){g.KX(e),fe(e,"redo")}function se(e){g.Yw(e),fe(e,"undo")}function le(e){c.dz({type:"focusOnly",focus:!0}),fe(e,r.GKr.Link)}function ce(e,t){const n=m.default.state.stores[0];if(!n)return;const o=P.default.state,r="empty"!==o.mode&&o.multiSelection;r&&!(0,z.iG)(r)?(_.WD({environment:e,blockStore:n,multiSelection:r}),fe(e,"comment",t)):(_.yw({environment:e,blockStore:n}),fe(e,"discuss",t))}function ue(e){l.qn({environment:e,analyticsFrom:"rich_text_menu"}),fe(e,"equation")}function de(e){!async function(e){const t=m.default.state.stores,n=await b.y({multiple:!0,accept:e.device.isIOS?"image/*, video/*":"image/*"}),o=m.default.getCurrentRecordCache(),r=d.qQ(e);0!==n.length&&o&&v.createAndCommit({userAction:"mobileActions.takePicture",environment:e,perform:i=>{var a,s;const l=f.z({environment:e,files:n,inMemoryRecordCache:o,pageWidth:r,transaction:i,spaceId:0!==t.length?t[0].pointer.spaceId:null===(a=(0,d.RM)())||void 0===a?void 0:a.pointer.spaceId,useCrdt:0!==t.length?t[0].useCrdt():(null===(s=(0,d.RM)())||void 0===s?void 0:s.useCrdt())??!1});h.is({environment:e,blocks:l,selection:t,transaction:i,replaceEmptyTextBlock:!0}),p.ZH(e)}})}(e),fe(e,"take_picture")}function me(e,t,n){const{device:r}=e,i=r.isMobileNative&&r.isIOS&&r.isPhone;i||p.Z5({environment:e,stores:m.default.state.stores}),t&&n?s.Qn({environment:e,stores:m.default.state.stores,actionSectionGroupKey:"default",left:t,top:n,showInput:!1,analyticsFrom:"mobile_more_menu"}):s.$Z({environment:e,stores:m.default.state.stores,actionSectionGroupKey:"default",showInput:!1,analyticsFrom:"mobile_more_menu"}),fe(e,"more"),o.default.afterNextFlush((()=>{i&&I.sD()}))}function fe(e,t,n){a.YO(e,{itemName:t,from:n})}function he(e,t){e&&console.log(t)}},52432:(e,t,n)=>{n.d(t,{Y:()=>y,f:()=>x});var o=n(21202),r=n(45366),i=n(92338),a=n(53965),s=n(7032),l=n(97978),c=n(97638),u=(n(57658),n(71384)),d=n(80444);class m{constructor(e,t,n){var o;this.featuresets=void 0,this.queryLower=void 0,this.userId=void 0,this.spaceId=void 0,this.currentTimeMs=void 0,this.pageSignals=void 0,this.resultsFeatureMetadata={},this.featuresets=e,this.queryLower=n.toLowerCase(),this.userId=t.currentUser.id,this.spaceId=null===(o=d.default.state.currentSpaceStore)||void 0===o?void 0:o.id,this.currentTimeMs=Date.now(),this.pageSignals=u.Z.getPageSignals({spaceId:this.spaceId,userId:this.userId})}minMaxScale(e,t,n){return t===n?0:(e-t)/(n-t)}extractFeatureGroup(e){const t=[];for(const n of this.featuresets){const o={groupName:n.name,features:[]};for(const t of n.features)o.features.push(t({result:e,featureExtractor:this}));t.push(o)}return t}}var f=n(26842),h=n(55320),p=n(29026),v=n(88893),b=n(43759);const g={name:"CLIENT_FEATURESET_RELEVANCY_MODEL",features:[function(e){let{result:t,featureExtractor:n}=e;return{name:"TIME_SINCE_LAST_EDIT",value:n.currentTimeMs-t.block.blockModel.last_edited_time}},function(e){let{result:t,featureExtractor:n}=e;return{name:"IS_LAST_EDITED_BY_ME",value:n.userId&&t.block.blockModel.last_edited_by_id===n.userId?1:0}},function(e){let{result:t,featureExtractor:n}=e;return{name:"IS_CREATED_BY_ME",value:n.userId&&t.block.blockModel.created_by_id===n.userId?1:0}},...i.ik.map((e=>t=>{let{result:n}=t;return{name:`BLOCK_SOURCE_${e}`,value:n.block.source.has(e)?1:0}})),function(e){var t;let{result:n,featureExtractor:o}=e;return{name:"PAGE_AUTHORITY_V1",value:o.pageSignals?null===(t=o.pageSignals[n.block.blockModel.id])||void 0===t?void 0:t.pageAuthorityV1:void 0}},function(e){let{result:t}=e;return{name:"TITLE_LENGTH",value:t.block.text.length}},function(e){let{result:{terms:t},featureExtractor:{queryLower:n}}=e;return{name:"TERMS_COUNT_NORMALIZED",value:t.length/(0,b.pv)(n).length}},function(e){let{result:{terms:t},featureExtractor:{queryLower:n}}=e;const o=(0,b.pv)(n),r=new Set(t);return{name:"FULL_MATCH_TERM_COUNT_NORMALIZED",value:o.filter((e=>r.has(e))).length/o.length}},function(e){let{result:{terms:t,block:{text:n}}}=e;const o=(0,b.pv)(n.toLowerCase());return{name:"MATCHING_PERCENTAGE_OF_TITLE",value:t.length/o.length}}]},S=1.25,M=[g];function A(e){const{results:t,featureGroups:n}=e;return t.map(((e,t)=>{const{block:o,score:r,personalizationBoost:a,rendered:s,terms:l}=e;return{sources:[i.vp.Local],id:o.blockModel.id,spaceId:o.blockModel.space_id,score:r,localSource:o.source,personalizationBoost:a,terms:l,highlight:{text:s},featureGroups:n[t]}}))}function I(e,t,n){const o=e=>n.matches(e.block),i=(0,r.wS)(t);if(1===i.length)return e.search(t,{filter:o,prefix:!0,fields:["text","inits"]});const a=e.search(t,{filter:o,combineWith:"AND",fields:["text"]});if(a.length>0)return a;const s=i.filter((e=>e.length>=b.Qu)),l=(c=s.length,Math.round(.6*c+.5));var c;return e.search(t,{filter:e=>e.queryTerms.length>=l&&o(e)})}function w(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function _(e){const{block:t,score:n,terms:o}=e,{source:r,text:a}=t,s=o.map(w).join("|"),l=new RegExp(s,"ig");var c;return{block:t,rendered:o.length>0?a.replaceAll(l,`${i.Um}$&${i.dK}`):a,score:n,personalizationBoost:(c=r).has("recentVisit")||c.has("frecencyStore")||c.has("bookmarkedPage")||c.has("defaultRecordCache")?S:1,terms:o}}function B(e,t,n){const{blocks:o,getAllBlocks:r}=e,i=n.text.trim(),a=(0,s.nv)(i),l=a.length>0?a.join(" "):i,u=new c.uL(t);return l.length>0?function(e){const{blocksIndex:t,queryString:n,filterMatcher:o}=e;return I(t,n,o).map((e=>{const t=(0,b.RA)(n,e.block.text);return{...e,score:e.score*t}})).map(_)}({blocksIndex:o,queryString:l,filterMatcher:u}):r().filter((e=>u.matches(e.block))).map(_)}const k=(0,a.Ds)(((e,t,n)=>{M.forEach(((o,r)=>{const i=n.map(((e,n)=>({features:e[r].features,id:t[n].block.blockModel.id})));(0,l.j)(e,"search_local_result_features",{search_session_id:h.default.state.sessionId,group_name:o.name,results_features:i})}))}),1e3,{leading:!1,trailing:!0});function x(e){let{query:t,localCachedPages:n,userId:o,includeRecordMap:r,environment:i,canUseLtr:s}=e;const{query:u,limit:d}=t,{filters:f,sort:h}=u,b=B(n,f,u);if(0===b.length)return;const g=function(e,t){const{field:n}=e,o="relevance"===n||"desc"===e.direction?-1:1;switch(n){case"lastEdited":case"scroll":return(0,a.MR)(t,(e=>{let{block:{blockModel:t}}=e;return o*(t.last_edited_time||0)}));case"created":return(0,a.MR)(t,(e=>{let{block:{blockModel:t}}=e;return o*(t.created_time||0)}));default:return(0,a.MR)(t,(e=>{let{score:t}=e;return o*t}))}}(h,b),S=t.query.text.length>1&&s,I=S?function(e,t,n,o){const r=new m(t,e,n);return o.map((e=>r.extractFeatureGroup(e)))}(i,M,t.query.text,g):g.map((e=>[]));(0,l.j)(i,"search_local_recall_results",{num_visible_members:(0,v.qX)(),results:g.map(T)}),S&&k(i,g,I);const w=("relevance"===h.field?(0,c.YB)({sort:h,currentUserId:o,unsorted:A({results:g,featureGroups:I}),batchSize:p.Xv}):A({results:g,featureGroups:I})).slice(0,d),_=r??!0;return{total:b.length,results:w,recordMap:_?n.recordMap.toJson({allowVersionDowngrade:!1}):{},trackEventProperties:void 0}}function y(e){let{query:t,localCachedPages:n,parentStore:r,isOnline:a,environment:s,shouldLimitLocalResultsWhenOnline:l,maxLocalResultsOverride:u,canUseLtr:d}=e;const m=x({query:t,localCachedPages:n,userId:s.currentUser.id,environment:s,canUseLtr:d});if(!m)return;if(0===m.results.length)return{error:i.Ix.NoResults};let h=m.results.map(((e,t)=>({...e,originalPosition:t,store:f.G.createChildStore(r,{table:o.iU,id:e.id}),serverEventProperties:void 0})));const p=h.length;return a&&l&&(h=(0,c.g8)(s,h,u)),0===h.length?{error:i.Ix.NoResults}:{value:{total:p,results:h,debugInfo:void 0}}}function T(e){const{block:{source:t,blockModel:{id:n}}}=e;return{id:n,localSource:[...t]}}},29755:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{pageMap:{}}}setStatus(e,t){const{pageMap:n}=this.state;t?n[e]=t:delete n[e],this.emit()}}const i=new r},45366:(e,t,n)=>{n.d(t,{wS:()=>i});var o=n(53965);const r=/[-./\\()"'’‘”“，。、·～；,;<>~!@#$%^&*|+=[\]{}`~?:\s]/u;function i(e){return(0,o.oA)(e.split(r))}}}]);