"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[167],{50167:(e,t,n)=>{n.r(t);n(57658),n(21703);var o=n(36769),r=n(86433),a=n(35102),i=n(42875),s=n(60310),l=n(24211),c=n(11799),d=n(73360),u=n(45953),p=n(606),g=n(98963),v=n(21202),f=n(6287),m=n(76462),y=n(75246),_=n(19889),h=n(92338),S=(n(53965),n(7032)),b=n(1898),k=n(54642),C=n(13447),w=n(37181),A=n(95477),I=n(74873),P=n(8627),R=n(18752),U=n(96820),M=n(80444),$=n(77080),x=n(88923),F=n(6258),T=n(27724),E=n(7339),O=n(42198),q=n(97638);const V=20;async function B(e,t){const n=(0,S.xP)(t)||t,{inMemoryRecordCache:o,persistedRecordCache:r}=e.defaultRecordCache;let a;for(const i of o.data)if(i.pointer.id===n){console.log(`Found a ${i.pointer.table} record in the in-memory record cache:`,i.model,i.model.__IM_SORRY__getValue());const e=o.checkRecordForTemporaryData(i);if(e&&console.log("The record has been augmented by temporary data:",e),r){const e=await r.get(i.pointer,i.userId);console.log("The record is also in the persisted record cache: ",e)}a=d.mk.fromModel(i.model)}return a||console.log("Alas, no records with the id were found in the in-memory record cache."),a}function D(e,t){return"string"==typeof e&&"string"==typeof t?Object.keys(m.OC).includes(e)?{table:e,id:(0,S.xP)(t)||t}:{table:t,id:(0,S.xP)(e)||e}:"string"!=typeof e||t?"object"==typeof e?e:t:{table:"block",id:(0,S.xP)(e)||e}}function j(e,t){if(t>V)return[];const n=[],o=(null==e?void 0:e.getAutomationStores())??[];n.push(...o.map((e=>N(e))).filter(b.$K));const r=(null==e?void 0:e.getTemplatePageStores())??[];for(const i of r){const e=i.getAutomationStore();if(e){const t=N(e);t&&n.push(t)}n.push(...K(i,t+1))}const a=e.getSchema();for(const i of Object.values(a))if("button"===(null==i?void 0:i.type)&&(0,b.$K)(i.automation_id)){const t=N(F.Mz.createChildStore(e,{id:i.automation_id,spaceId:e.getSpaceId(),table:g.cv}));t&&n.push(t)}return n}function K(e,t){if(t>V)return[];const n=[];{const o=e.getAutomationStore();if(o){const e=N(o);e&&n.push(e)}if(e.isCollectionView()){const o=e.getCollectionStore();o&&n.push(...j(o,t+1))}}const o=e.getContentStores();for(const r of o){const e=r.getAutomationStore();if(e){const t=N(e);t&&n.push(t)}if(r.isCollectionView()){const e=r.getCollectionStore();e&&n.push(...j(e,t+1))}n.push(...K(r,t+1))}return n}function N(e){if(!e)return;const t=(null==e?void 0:e.getActionStores())??[],n=null==e?void 0:e.getCreatedByPointer(),o=(null==n?void 0:n.table)===_.KJ&&(null==e?void 0:e.getRecordModel(n));return o?{automation:e,actions:t,createdBy:o,parent:e.getParentBlockStore()}:void 0}(0,o.exposeDebugEnvironmentValue)("debugging",(function(e){const t=(t,n)=>{var o;const r=D(t,n),a=e.defaultRecordCache.inMemoryRecordCache.getRecord({pointer:r,userId:e.currentUser.id});if(void 0===(null==a?void 0:a.value))return`${r.table}: ${r.id}`;const i="type"in a.value?a.value.type:r.table;return"name"in(null==a?void 0:a.value)?`${i} ${a.value.id} ${a.value.name}`:"properties"in(null==a?void 0:a.value)&&(0,b.$K)(a.value.properties)&&"title"in a.value.properties&&(0,b.$K)(null==a?void 0:a.value.properties.title)?`${i} ${a.value.id} ${a.value.properties.title.join(" ").slice(0,30)}`:`${i} ${null==a||null===(o=a.value)||void 0===o?void 0:o.id}`},n=(t,n)=>{const o=D(t,n);return e.defaultRecordCache.inMemoryRecordCache.getRecord({pointer:o,userId:e.currentUser.id})},o=(e,o)=>{const r=D(e,o),a=n(e,o),i={title:t(e,o),raw:null==a?void 0:a.value,parent:void 0,id:r,children:[]};if(void 0!==(null==a?void 0:a.value)&&"parent_table"in(null==a?void 0:a.value)&&"parent_id"in(null==a?void 0:a.value)&&a.value.parent_id){var s,l;const e=D(null===(s=a.value)||void 0===s?void 0:s.parent_id,null===(l=a.value)||void 0===l?void 0:l.parent_table);i.parent=e}if(null!=a&&a.value&&"content"in(null==a?void 0:a.value)){var c;const e=(null==a||null===(c=a.value)||void 0===c?void 0:c.content)||[];for(const o of e){const e=D(o,"block"),a=n(o,"block"),s={title:t(o,"block"),raw:null==a?void 0:a.value,parent:r,id:e,children:[]};i.children.push(s)}}return i},d=(e,t)=>`${A.default.adminUrl}/__admin/${e}/${t}`,S=(e,t)=>{window.open(d(e,t))},F=()=>x.default.state.open?(console.warn("Returning peek view page, if you want the underlying page, please close it and try again"),x.default.state.target):M.default.state.mainEditorCurrentBlockStore?M.default.state.mainEditorCurrentBlockStore:void console.error("No current mainEditorCurrentBlockStore"),V=function(t){var n;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1",r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;const i="string"==typeof t?{query:{text:t,filters:(0,h.u4)(),sort:{field:"relevance"}},limit:20,debug:o}:t;return{environment:e,input:i,spaceId:null===(n=M.default.state.currentSpaceStore)||void 0===n?void 0:n.id,publicAccessPermissionAncestorBlockId:q.bC(e).publicAccessPermissionAncestorBlockId,searchExperimentOverrides:a,forcedClusterPattern:r,source:"debugging"}},j={id:"root0000-0000",table:"block"},N=t=>{const n=u.PF.create();for(const[o,r]of Object.entries(t)){if(!m.wb(o)||!Array.isArray(r))throw new Error(`Not a table: ${o}. Argument should be like { block: [id1, id2], collection: [...], ... }`);for(const t of r){const r={table:o,id:t},a=e.defaultRecordCache.inMemoryRecordCache.getRecord({pointer:r,userId:e.currentUser.id});a&&n.setValueAndRole(r,a.value,a.role)}}return n};return{getRecordFromApi:async(t,n)=>{var o,r;const a=D(t,n),i=[];i.push({pointer:a,version:-1});const s=await k.syncRecordValues(e,{requests:i},null===(o=M.default.state.currentUserStore)||void 0===o?void 0:o.id);return"success"===s.type?null===(r=s.data.recordMap[a.table])||void 0===r?void 0:r[a.id]:void 0},getRecordFromCache:n,getAdminUrl:d,getSelectedBlocks:()=>T.default.state.stores,openInAdmin:S,openSelectedBlocksInAdmin:()=>{if(0!==T.default.state.stores.length)return T.default.state.stores.forEach((e=>{S(v.iU,e.id)}));console.error("No selected block")},openCurrentPageCreatorInAdmin:()=>{var e;const t=(()=>{var e,t;const o=null===(e=F())||void 0===e?void 0:e.getCreatedById(),r=null===(t=F())||void 0===t?void 0:t.getCreatedByTable();if(o&&r)return n(o,r);console.error("no created_by_id or created_by_table for this page")})(),o=null==t||null===(e=t.value)||void 0===e?void 0:e.id;o?S(_.KJ,o):console.error("no current page Creator, not opening")},getCurrentPage:F,openCurrentPageInAdmin:()=>{var e;const t=null===(e=F())||void 0===e?void 0:e.id;t?S(v.iU,t):console.error("Not opening")},openCurrentSpaceInAdmin:()=>{M.default.state.currentSpaceStore?S(y.bx,M.default.state.currentSpaceStore.id):console.error("No current space")},quickFind:function(e){const t=V(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1",arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0),n=q.MS(t);return n&&n.then((e=>"success"===e.type?e.data:e))},quickFindRequest:function(e){return V(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1",arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0)},quickFindCollections:async function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1",o=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;const a="string"==typeof t?{query:{text:t,filters:(0,h.u4)(),sort:{field:"relevance"}},limit:20,debug:n}:t,i=M.default.state.currentSpaceStore,{query:s,limit:l}=a;if(!i)return;const c=k.search(e,{type:h.n8.CollectionsInSpace,query:s.text.trim(),spaceId:i.id,limit:l,filters:h.u4({excludeTemplates:!0,requireEditPermissions:!0}),sort:{field:"relevance"},debug:n,searchExperimentOverrides:r,forcedClusterPattern:o}),d=await c;return"success"===d.type?d.data:d},getCurrentPageDetail:()=>{var e;const t=null===(e=F())||void 0===e?void 0:e.id;if(t)return o(t,"block");console.error("Not opening")},getHomeBlockIdsForUser:()=>{var t;const n=null===(t=M.default.state.currentSpaceStore)||void 0===t?void 0:t.id,o=e.currentUser.id;if(n&&o)return(0,s.hH)({spaceId:n,userId:o})},getRecordDetail:o,getRecordTitle:t,getRecordTree:e=>{const o=new c.Z;e.map((e=>{const r=D(e.id,e.table),a=t(e.id,e.table),i=n(e.id,e.table),s={title:a,parent:(e=>{var t;if(void 0!==(null==e||null===(t=e.value)||void 0===t?void 0:t.parent_id))return D(e.value.parent_id,e.value.parent_table)})(i),id:r,raw:null==i?void 0:i.value,children:[]};o.set(r,s)}));const r={title:"root",parent:void 0,id:j,raw:void 0,children:[]};return e.map((e=>{const t=D(e.id,e.table),n=o.get(t);var a;void 0!==(null==n?void 0:n.parent)&&o.has(n.parent)?null===(a=o.get(n.parent))||void 0===a||a.children.push(n):void 0!==n?r.children.push(n):r.children.push({title:"Failed to load Record",parent:void 0,id:t,raw:void 0,children:[]})})),r},overrideStatsigLocalExperiment:(e,t)=>{const n="Failed to override Statsig local experiment";if(!$.default.isStatsigEnabled()||!E.C.isInitialized())return console.error(n),!1;try{return E.C.updateLocalOverrideConfig(e,t),!0}catch(o){return console.error(n),!1}},overrideStatsigLocalFeatureGate:(e,t)=>{const n="Failed to override Statsig local feature gate";if(!$.default.isStatsigEnabled()||!E.C.isInitialized())return console.error(n),!1;try{return E.C.updateLocalOverrideGate(e,t),!0}catch(o){return console.error(n),!1}},removeAllStatsigLocalOverrides:()=>{const e="Failed to remove all Statsig local overrides";if(!$.default.isStatsigEnabled()||!E.C.isInitialized())return console.error(e),!1;try{return E.C.removeAllLocalOverrides(),!0}catch(t){return console.error(e),!1}},getCurrentSpaceId:()=>{var e;return null===(e=F())||void 0===e?void 0:e.getSpaceId()},getCurrentUserId:()=>{var e;return null===(e=M.default.state.currentUserStore)||void 0===e?void 0:e.id},getAutomationsForSelectedBlocks:()=>T.default.state.stores.map((e=>K(e,0))).filter(b.$K),getAutomationsForCurrentPage:()=>{const e=F();if(e)return K(e,0)},debugCompileAutomation:(e,t)=>{const n=F();if(!n)return;const o=n.getRecordModel,s=n.loadRecordModel,c=o({id:e,spaceId:n.getSpaceId(),table:g.cv});if(!c)return;const d=c.getActionPointers().map((e=>o(e))).filter(b.$K);if(d.length!==c.getActionIds().length)return;const u={automationModel:c,actionModels:d,handleDataRequest:(0,a.yf)(o,s),intl:(0,l.vc)(),getRecordModel:o,loadRecordModel:s,userTimeZone:(0,i.r)()};let v;if("button_property"===t){const e=c.getParentPointer();if(e.table!==f.vF)return;v={...u,collectionPointer:p.dr.fromSpaceShardRecordId({id:e.id,spaceId:c.getSpaceId()},f.vF),contextType:t}}else if("button_block"===t){const e=n.getAssociatedCollectionStore();v={...u,collectionPointer:null==e?void 0:e.getSpaceShardedPointer(),contextType:t}}else"event"===t?v={...u,collectionPointer:p.dr.fromSpaceShardRecordId({id:c.getParentPointer().id,spaceId:c.getSpaceId()},f.vF),contextType:t}:"recurrence"===t||"assistant"===t?v={...u,contextType:t}:(0,b.t1)(t);return(0,r.rS)(v)},generateTutorialData:(e,t,n)=>void 0,setHomeTemplatesPersona:e=>{const t=[...I.az.map((e=>({personaValue:{type:"function",persona:e},key:`function - ${e}`}))),...I.ml.map((e=>({personaValue:{type:"space_intent",persona:e},key:`space_intent - ${e}`}))),...I.GK.map((e=>({personaValue:{type:"space_type",persona:e},key:`space_type - ${e}`})))],n=t.find((t=>t.key===e));n?R.Z.setState(n.personaValue):console.error("input must be one of the following values",t.map((e=>e.key)))},setHomeLearnUserType:e=>{const t={isMultiplayer:e.isMultiplayer??!1,isNewAccount:e.isNewAccount??!1,isAdmin:e.isAdmin??!1,persona:e.persona};P.Z.setState(t)},resetQnAOnboarding:()=>{const t=M.default.state.currentUserSettingsStore;t?C.createAndCommit({userAction:"debuggingHelpers.clearQnAOnboarding",environment:e,userId:t.id,perform:e=>{w.d2({userSettingsStore:t,data:{ai_qna_intro_onboarding_phase:null,last_exposed_to_ai_qna_at:null,qna_reminders_shown_at:null,ai_qna_upsell_dismissed_at:null},transaction:e})}}):console.error("Could not find current user settings")},resetNotionCalendarOnboarding:()=>{const t=M.default.state.currentUserSettingsStore;t?C.createAndCommit({userAction:"debuggingHelpers.clearNotionCalendarOnboarding",environment:e,userId:t.id,perform:e=>{w.d2({userSettingsStore:t,data:{notion_calendar_launch_modal_phase:null,notion_calendar_launch_modal_dismissed_at:null,seen_open_in_calendar_tooltip:null},transaction:e})}}):console.error("Could not find current user settings")},getAllUserSignals:()=>{var e,t,n,r,a,i;const s=null===(e=M.default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId(),l=null===(t=M.default.state.currentUserStore)||void 0===t?void 0:t.userId;if(!s||!l)return;const c=O.default.getUserSignals({spaceId:s,userId:l});return{similarUser1dRecentPages:[...(null==c||null===(n=c.similarUserRecentPages)||void 0===n||null===(n=n.pagesMetadata)||void 0===n?void 0:n.keys())||[]].map((e=>{var t;const n=null==c||null===(t=c.similarUserRecentPages)||void 0===t?void 0:t.pagesMetadata.get(e);return{...n,users:null==n?void 0:n.userIds.map((e=>o(_.KJ,e))),mostSimilarUser:o(_.KJ,null==n?void 0:n.mostSimilarUser),page:o(v.iU,e)}})),topPages7dPageView:[...(null==c||null===(r=c.topPages7dPageView)||void 0===r?void 0:r.keys())||[]].map((e=>{var t;return{pageAuthority:null==c||null===(t=c.topPages7dPageView)||void 0===t?void 0:t.get(e),record:o("block",e)}})),editedPages1d:[...(null==c||null===(a=c.editedPages1d)||void 0===a?void 0:a.keys())||[]].map((e=>{var t;return{editedAt:null==c||null===(t=c.editedPages1d)||void 0===t?void 0:t.get(e),record:o("block",e)}})),similarUsersEditedPages1d:[...(null==c||null===(i=c.similarUsersEditedPages1d)||void 0===i?void 0:i.keys())||[]].map((e=>{var t;return{editedAt:null==c||null===(t=c.similarUsersEditedPages1d)||void 0===t?void 0:t.get(e),record:o("block",e)}})),allSignals:c}},loadAllUserSignals:()=>{var t,n;const o=null===(t=M.default.state.currentSpaceStore)||void 0===t?void 0:t.getSpaceId(),r=null===(n=M.default.state.currentUserStore)||void 0===n?void 0:n.userId;o&&r&&O.default.initializeAndLoadAllUserSignals({spaceId:o,userId:r,environment:e})},getLocalSearchableCache:async()=>{const{currentSpaceStore:t,currentSpaceViewStore:n}=M.default.state;if(t){const o=await(0,U.S)({environment:e,currentSpaceStore:t,currentSpaceViewStore:n,excludeCurrentPage:!1}),r=new Map;return o.getAllBlocks().forEach((e=>{e.block.source.forEach((t=>{const n=r.get(t)||[];n?r.set(t,[...n,e.block]):r.set(t,[e.block])}))})),{...o,groupedPages:r}}},saveFileFromOpfs:async e=>{const t=await(await(await navigator.storage.getDirectory()).getFileHandle(e)).getFile(),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download=e,n.click()},resetQnAUpsellNudge:()=>{const t=M.default.state.currentUserSettingsStore;t?C.createAndCommit({userAction:"debuggingHelpers.resetQnAUpsellNudge",environment:e,userId:t.id,perform:e=>{w.d2({userSettingsStore:t,data:{ai_qna_upsell_dismissed_at:null},transaction:e})}}):console.error("Could not find current user settings")},createRecordMapWithRole:N,createRecordMap:e=>N(e).toRecordMap(),findId:B.bind(null,e)}}))},74873:(e,t,n)=>{n.d(t,{GK:()=>l,Ju:()=>h,NZ:()=>c,az:()=>i,ml:()=>s});n(57658);var o=n(1898),r=n(80444);const a=10,i=["creative","internal_communication","eng","product_design","project_or_program_management","product","marketing","sales_or_success","support","finance","hr","it_admin","knowledge_management","operations","educator","student"],s=["life","work","school"],l=["singleplayer","multiplayer"];function c(e){let{userPersonaValue:t,userUseCases:n,spaceSurveyData:r}=e;const a=[v(t),...f({userUseCases:n}),...m({spaceSurveyData:r}),y({workspaceType:p()})].filter(o.$K);let i;for(const o of a)i=i?u(i,o):o;return void 0===i?{type:"space_type",persona:"singleplayer"}:i}const d={space_type:0,space_intent:1,function:2};function u(e,t){return d[e.type]>=d[t.type]?e:t}function p(){const{currentSpaceStore:e}=r.default.state,t=null==e?void 0:e.getModel(),n=null==e?void 0:e.getMemberCountFromPublicSpaceData();return t&&n?n<=1?"singleplayer":n<a?"multiplayer_small":"multiplayer":"singleplayer"}const g={student:{type:"function",persona:"student"},educator:{type:"function",persona:"educator"},creative:{type:"function",persona:"creative"},finance:{type:"function",persona:"finance"},internalCommunication:{type:"function",persona:"internal_communication"},projectProgramMgmt:{type:"function",persona:"project_or_program_management"},itAdmin:{type:"function",persona:"it_admin"},knowledgeManagement:{type:"function",persona:"knowledge_management"},marketing:{type:"function",persona:"marketing"},eng:{type:"function",persona:"eng"},programmer:{type:"function",persona:"eng"},hr:{type:"function",persona:"hr"},hr_recruiting:{type:"function",persona:"hr"},product:{type:"function",persona:"product"},product_manager:{type:"function",persona:"product"},productDesign:{type:"function",persona:"product_design"},designer:{type:"function",persona:"product_design"},marketing_sales:{type:"function",persona:"sales_or_success"},sales:{type:"function",persona:"sales_or_success"},support:{type:"function",persona:"support"},customer_support:{type:"function",persona:"support"},operations_hr:{type:"function",persona:"operations"},operations:{type:"function",persona:"operations"},personal:{type:"space_intent",persona:"life"},media:void 0,entrepreneur:void 0,freelancer:void 0,founderCeo:void 0,other:void 0,unfilled:void 0};function v(e){return e?g[e]:void 0}function f(e){let{userUseCases:t}=e;const n=[];for(const r of t??[])switch(r){case"personal_notes_to_dos":n.push({type:"space_intent",persona:"life"});continue;case"team_docs_knowledge_base":case"team_project_management":n.push({type:"space_intent",persona:"work"});continue;case"ai":case"docs":case"wikis":case"notes":case"project":case"goals":case"ai":case"other":continue;default:(0,o.t1)(r)}return n}function m(e){let{spaceSurveyData:t}=e;const n=[],r=function(e){var t;let{spaceSurveyData:n}=e;const r=null==n||null===(t=n.intent)||void 0===t?void 0:t.value;if(r)switch(r){case"personal":case"life":return"life";case"team":case"work":return"work";case"school":return"school";default:(0,o.t1)(r)}}({spaceSurveyData:t});if(r&&n.push({type:"space_intent",persona:r}),null!=t&&t.use_cases)for(const a of t.use_cases.value)switch(a){case"personal_notes_to_dos":n.push({type:"space_intent",persona:"life"});continue;case"team_docs_knowledge_base":case"team_project_management":n.push({type:"space_intent",persona:"work"});continue;case"ai":case"docs":case"wikis":case"notes":case"project":case"goals":case"ai":case"other":continue;default:(0,o.t1)(a)}return n}function y(e){let{workspaceType:t}=e;if(!t)return;return _({workspaceType:t})?{type:"space_type",persona:"multiplayer"}:{type:"space_type",persona:"singleplayer"}}function _(e){let{workspaceType:t}=e;switch(t){case"multiplayer":case"multiplayer_small":return!0;case"singleplayer":return!1;default:(0,o.t1)(t)}}function h(){return _({workspaceType:p()})}},8627:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085);class r extends o.default{getInitialState(){}}const a=new r},18752:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085);class r extends o.default{getInitialState(){}}const a=new r}}]);