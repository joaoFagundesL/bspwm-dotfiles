"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[71],{40071:(e,t,n)=>{n.d(t,{Z:()=>re});var o=n(94184),i=n.n(o),r=(n(67294),n(83355)),s=n(15145),a=n(88437),l=n(39132),c=n(18557),u=n(53470),d=n(37612),p=n(9291),m=n(31701),h=n(53965),f=n(37810),g=n(81193),C=n(98834),v=n(47307),M=n(96802),y=n(8055),S=n(13447),x=n(93174),k=n(68155),T=n(66890),_=n(66213),E=n(28651),D=n(19037),b=n(97978),A=n(43250),R=n(84210),N=n(33929),O=n(60709),j=n(98742),I=n(25498),P=n(77907),L=n(17031),w=n(80444),Z=n(61766),F=n(77080),V=n(96049),H=n(6258),U=n(24736),B=n(93405),z=n(31945),q=n(61519),Y=n(78140),W=n(28992),K=n(32163),G=n(53437),X=n(31278),J=n(76798),Q=n(72495),$=n(26388),ee=n(42402),te=n(59658),ne=n(85893);const oe=(0,p.defineMessages)({emptyPageTitle:{defaultMessage:"Empty",id:"database.templatePicker.emptyPageTitle"}});class ie extends r.Z{constructor(){super(...arguments),this.storeTypes={mouseStore:E.Z,buttonPopupStore:Z.Z},this.renderActionMenuPopup=e=>{const{device:t}=this.environment,{templateStore:n}=this.props,o=!!n&&(0,D.J5S)({environment:this.environment,blocks:[n],publicEditMode:void 0}),i=n?H.Mz.fromBlockStore(n):void 0,r=null!=i&&i.isActive()?null==i?void 0:i.getRecurrence():void 0,s=this.canEditContentOnly.state,m=this.cannotEditRecurrence.state,f=function(e){const{templateNestingExceedsMaxDepth:t,immediateAncestorRecurrenceType:n,ancestorHasDailyTemplate:o,automationStore:i,environment:r}=e;if(!F.default.checkGate("recurrence_queue_task_improvements"))return;const s="disabled"===(null==i?void 0:i.getStatus());if(s)return(0,ne.jsx)(p.FormattedMessage,{defaultMessage:"This repeating template was turned off. <inlinelink>Turn on</inlinelink> with the same settings.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationCaptionDisabledDuringDuplication",values:{inlinelink:e=>(0,ne.jsx)(ee.Z,{external:!1,color:"notion-link-blue",hoverColor:"blue",onClick:()=>{!async function(e,t){if(!t)return;const{automationActions:n}=await x._1.loader();S.createAndCommit({userAction:"CollectionTemplatePickerItem.setAutomationStatusToActive",environment:e,perform:o=>n.enableAutomation({automationStore:t,environment:e,transaction:o})})}(r,i)},children:e})}});if(o)return(0,ne.jsx)(p.FormattedMessage,{defaultMessage:"It already gets created daily from another repeating template.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationCaptionNestedInDaily"});if(t)return(0,ne.jsx)(p.FormattedMessage,{defaultMessage:"It already gets created automatically from other repeating templates.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationCaptionTooDeeplyNested"});if(n)return(0,ne.jsx)(p.FormattedMessage,{defaultMessage:"This template already gets created every {immediateAncestorRecurrenceType} from another repeating template.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationCaptionNestedInTemplate",values:{immediateAncestorRecurrenceType:n}})}({templateNestingExceedsMaxDepth:this.templateNestingExceedsMaxDepth.state,immediateAncestorRecurrenceType:this.immediateAncestorRecurrenceType.state,ancestorHasDailyTemplate:this.ancestorHasDailyTemplate.state,automationStore:i,environment:this.environment}),M={key:"section",render:e=>(0,ne.jsx)(Q.Z,{...e}),items:h.oA([this.props.templateStore&&!s&&o&&(!i||(null==i?void 0:i.isReady()))&&!m&&{key:"repeatControl",render:e=>n&&(0,ne.jsx)(P.LazyRecurrenceConfigMenu,{...e,recurrence:r,onChange:async e=>{const{recurrenceActions:t}=await P.deps.recurrence.loader();e?t.addRecurrence({environment:this.environment,blockStore:n,recurrence:e}):t.disableRecurrence({environment:this.environment,blockStore:n})}}),action:()=>function(e,t){b.j(e,"recurrence_menu_open",{isConfigured:void 0!==t})}(this.environment,this.props.recurrence)},this.props.isOverlay&&!s&&{key:"Set default",render:e=>(0,ne.jsx)(B.Z,{...e,title:(0,ne.jsx)(p.FormattedMessage,{defaultMessage:"Set as default",id:"database.collectionTemplatePickerItem.actionMenu.setAsDefault"}),svg:c.z}),action:()=>this.handleSetAsDefault(e)},this.props.templateStore&&{key:"Edit",render:e=>(0,ne.jsx)(B.Z,{...e,title:o?(0,ne.jsx)(p.FormattedMessage,{defaultMessage:"Edit",id:"database.templatePickerItem.actionMenu.edit"}):(0,ne.jsx)(p.FormattedMessage,{defaultMessage:"View",id:"database.templatePickerItem.actionMenu.view"}),svg:o?u.H:l.c}),action:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleEdit},this.props.templateStore&&!s&&o&&{key:"Duplicate",render:e=>(0,ne.jsx)(B.Z,{...e,title:(0,ne.jsx)(p.FormattedMessage,{defaultMessage:"Duplicate",id:"database.templatePickerItem.actionMenu.duplicate"}),svg:a.a}),action:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDuplicate},this.props.templateStore&&!s&&o&&{key:"Delete",render:e=>(0,ne.jsx)(B.Z,{...e,title:(0,ne.jsx)(p.FormattedMessage,{defaultMessage:"Delete",id:"database.templatePickerItem.actionMenu.delete"}),svg:d.y}),action:o?()=>async function(e,t,n){if(!n)return;if(!(await v.confirmUserAction({message:(0,ne.jsx)(p.FormattedMessage,{defaultMessage:"Are you sure you would like to delete this template?",id:"database.confirmDialog.templatePickerItem.deleteMessage"}),acceptLabel:(0,ne.jsx)(p.FormattedMessage,{defaultMessage:"Delete",id:"database.confirmDialog.templatePickerItem.deleteButton.label"})})))return;S.createAndCommit({userAction:"CollectionTemplatePickerItem.handleDelete",environment:e,perform:e=>C.R5({collectionStore:t,templateStore:n,transaction:e})}),g.sY(e,{template_action:"delete"})}(this.environment,this.props.collectionStore,this.props.templateStore):()=>{}},(m||f)&&{key:"nestedTemplateExplanation",render:e=>(0,ne.jsxs)(ne.Fragment,{children:[(0,ne.jsx)(q.Z,{size:12}),(0,ne.jsx)(W.Z,{...e,style:{padding:2},titleStyle:this.nestingExplanationMenuItemTitleStyle,title:se({cannotAddRecurrenceToTemplate:m}),captionStyle:this.nestingExplanationMenuItemCaptionStyle,caption:f})]}),action:()=>{}}])};let y;return y=t.isMobile?{menuType:O.og.ActionSheet}:{menuType:O.og.Popup,width:230},(0,ne.jsx)(Y.Z,{...y,children:(0,ne.jsx)(K.Z,{type:K.i.Vertical,initialFocus:void 0,sections:[M]})})},this.nestingExplanationMenuItemTitleStyle={whiteSpace:"normal",fontWeight:f.Z.fontWeight.medium,fontSize:f.Z.fontSize.UISmall.desktop},this.nestingExplanationMenuItemCaptionStyle={whiteSpace:"normal",color:m.ZP.lightTextColor,fontWeight:f.Z.fontWeight.regular,fontSize:f.Z.fontSize.UISmall.desktop},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleEdit=()=>function(e,t,n,o,i){if(!n)return;null==o||o(),ae(n,e,i),t.reset(),g.sY(e,{template_action:"edit"})}(this.environment,this.stores.buttonPopupStore,this.props.templateStore,this.props.onCancelClick,this.context.overrideLinkClick),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDuplicate=e=>async function(e,t,n,o,i,r,s){if(!i)return;null==r||r();const{recurrenceActions:a}=await P.deps.recurrence.loader(),{performResult:l}=S.createAndCommit({userAction:"CollectionTemplatePickerItem.duplicatedStore",environment:t,perform:o=>{const r=C.Zh({environment:t,event:e.event,collectionStore:n,templateStore:i,transaction:o});if(i.getAutomationId()){const e=H.Mz.fromBlockStore(i),n=null==e?void 0:e.getRecurrence();e&&null!=e&&e.isActive()&&n&&a.createRecurrenceInner(o,t,r,n)}return r}});l&&ae(l,t,s);o.reset(),g.sY(t,{template_action:"duplicate"})}(e,this.environment,this.props.collectionStore,this.stores.buttonPopupStore,this.props.templateStore,this.props.onCancelClick,this.context.overrideLinkClick),this.handleSetAsDefault=e=>{var t,n;const{collectionContextStore:o}=this.context,i=null==o?void 0:o.collectionStore(),r=null==o?void 0:o.collectionViewStore();if(!i||null==r||!r.isDefined())return;const s=null!==(t=this.props.templateStore)&&void 0!==t&&t.id?{template_page_id:null===(n=this.props.templateStore)||void 0===n?void 0:n.id}:"empty";v.showDialog({showCancel:!0,keepFocus:!1,message:(0,ne.jsx)(p.FormattedMessage,{id:"database.collectionTemplatePickerItem.setAsDefaultDialog.message",defaultMessage:"<span>Use “{pageName}” as default template when creating new pages?</span>",values:{span:e=>(0,ne.jsx)("span",{children:e}),pageName:this.props.templateStore?(0,ne.jsx)(J.Z,{store:this.props.templateStore,style:{display:"inline"}}):N.default.formatMessage(oe.emptyPageTitle)}}),items:[{label:(0,ne.jsx)(p.FormattedMessage,{id:"database.collectionTemplatePickerItem.setAsDefaultDialog.setCollection",defaultMessage:"For all views in “{databaseName}”",values:{databaseName:(0,ne.jsx)(J.Z,{store:i,style:{display:"inline"}})}}),onAccept:()=>{e.close(),S.createAndCommit({environment:this.environment,userAction:"CollectionTemplatePickerItem.handleSetAsDefault:collection",perform:e=>{M.FH({stores:[i],update:{collection_default_template:s},transaction:e}),M.FH({stores:[r],update:{collection_view_default_template:s},transaction:e})}})}},{label:(0,ne.jsx)(p.FormattedMessage,{id:"database.collectionTemplatePickerItem.setAsDefaultDialog.setCollectionView",defaultMessage:"Only on “{viewName}” view",values:{viewName:(0,ne.jsx)(k.Z,{collectionViewName:r.getName(),collectionViewType:r.getType()})}}),onAccept:()=>{e.close(),S.createAndCommit({environment:this.environment,userAction:"CollectionTemplatePickerItem.handleSetAsDefault:collectionView",perform:e=>{M.FH({stores:[r],update:{collection_view_default_template:s},transaction:e})}})}}]})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseMove=()=>{return e=this.stores.mouseStore,void(V.Z.state||e.setState({...e.state,mouseEntered:!0}));var e},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave=()=>{var e;(e=this.stores.mouseStore).setState({...e.state,mouseEntered:!1})},this.getRecordModel=this.props.collectionStore.getRecordModel,this.canEditContentOnly=this.createComputedStore((()=>{var e;return Boolean(null===(e=this.props.collectionStore.getParentBlockStore())||void 0===e?void 0:e.canEditContentOnly())})),this.recurrenceConstraintReadyResult=this.createComputedStore((()=>{if(this.props.templateStore){const e=(0,I.w)(this.props.templateStore);if(e.automationStoresReady)return e}})),this.templateNestingExceedsMaxDepth=this.createComputedStore((()=>{var e;return Boolean(null===(e=this.recurrenceConstraintReadyResult.state)||void 0===e?void 0:e.templateNestingExceedsMaxDepth)})),this.immediateAncestorRecurrenceType=this.createComputedStore((()=>{var e;return null===(e=this.recurrenceConstraintReadyResult.state)||void 0===e?void 0:e.immediateAncestorRecurrenceType})),this.ancestorHasDailyTemplate=this.createComputedStore((()=>{var e;return Boolean(null===(e=this.recurrenceConstraintReadyResult.state)||void 0===e?void 0:e.ancestorHasDailyTemplate)})),this.cannotEditRecurrence=this.createComputedStore((()=>{if(!F.default.checkGate("recurrence_queue_task_improvements"))return!1;if(!this.props.templateStore)return!1;const e=(0,I.w)(this.props.templateStore);return!e.automationStoresReady||e.violatesConstraint}))}get registries(){return[L.Z]}renderComponent(){var e;const{device:t}=this.environment,{templateStore:n,isMobile:o,isOverlay:i,focused:r,locked:s,canConfigureCollection:a,draggable:l}=this.props,{mouseStore:c,buttonPopupStore:u}=this.stores,d=!n&&!i,p=(!s||s&&!l)&&(a||this.canEditContentOnly.state)&&(c.state.mouseEntered||u.state.open||o||i)&&!d,m=n?(0,ne.jsx)(J.Z,{store:n}):N.default.formatMessage(oe.emptyPageTitle),h=null==n||null===(e=n.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:this.getRecordModel});return(0,ne.jsx)(te.Z,{className:A.$ji,type:n?"custom_template":"empty_page",format:i?"collection-overlay":"page-menu-item",locked:s||!a||!l,icon:(0,ne.jsx)(X.Z,{disabled:!0,icon:h,isEmptyPage:(null==n?void 0:n.isEmptyPage())??!0,size:t.isMobile&&i?24:20,isLarge:!i,style:{...!i&&{pointerEvents:"none",marginRight:10}},pageIconStyle:{...!i&&{fill:this.theme.lightIconColor}}}),title:m,onClick:this.props.onClick,onMouseEnter:this.props.onMouseEnter,right:p&&this.renderActionMenuButton(),onMouseMove:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseMove,onMouseLeave:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave,focused:r,isDefault:this.props.isDefault,recurrence:this.props.recurrence,recurrenceDisabled:this.props.recurrenceDisabled})}renderActionMenuButton(){const{isMobile:e,isOverlay:t}=this.props,{buttonPopupStore:n}=this.stores,o=!!this.props.templateStore&&(0,D.J5S)({environment:this.environment,blocks:[this.props.templateStore],publicEditMode:void 0});return(0,ne.jsx)($.ZP,{renderTooltip:()=>o?(0,ne.jsx)(p.FormattedMessage,{defaultMessage:"Edit this template",id:"database.templatePickerItem.editTemplate.tooltip"}):(0,ne.jsx)(p.FormattedMessage,{defaultMessage:"View this template",id:"database.templatePickerItem.viewTemplate.tooltip"}),delayThreshold:300,render:o=>(0,ne.jsx)(z.ZP,{popupType:e?G.ZP.PopupType.SlideUp:G.ZP.PopupType.Popup,placementToOrigin:z.pO.Right,originGap:12,buttonPopupStore:n,renderOrigin:n=>(0,ne.jsx)(U.Z,{className:i()(A.C_N,{[A.JiD]:e||t}),isMobile:e&&t,style:{...!t&&{marginRight:0}},...(0,j.Z)(o,n)}),render:this.renderActionMenuPopup,onClick:()=>{g.sY(this.environment,{template_action:"open_menu"})}})})}}ie.displayName="CollectionTemplatePickerItem",ie.contextTypes={...r.w,..._.wK,...T.xm};const re=ie;function se(e){const{cannotAddRecurrenceToTemplate:t}=e;if(F.default.checkGate("recurrence_queue_task_improvements"))return t&&(0,ne.jsx)(p.FormattedMessage,{defaultMessage:"This template can't be repeated.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationTitle"})}function ae(e,t,n){const{mainEditorCurrentBlockStore:o}=w.default.state;!function(e,t,n){n?n(e):y.c4({environment:t,url:e})}(o?(0,R.ZP)({store:o,peekViewBlockId:e.id,fullyQualified:!1,pageVisitSource:s.tY.PeekOpen}):(0,R.ZP)({store:e,fullyQualified:!1,pageVisitSource:s.tY.LinkInPage}),t,n)}},59658:(e,t,n)=>{n.d(t,{Z:()=>y});n(67294);var o=n(480),i=n(97511),r=n(86628),s=n(24405),a=n(49271),l=n(53523),c=n(45238),u=n(85893);const d=(0,c.IU)("repeatDisabled",{viewBox:"0 0 16 14",svg:(0,u.jsxs)("svg",{children:[(0,u.jsx)("path",{d:"M1.11621 8.32422C0.888346 8.32422 0.69694 8.24674 0.541992 8.0918C0.391602 7.93685 0.316406 7.74772 0.316406 7.52441V6.77246C0.316406 6.08431 0.469076 5.49186 0.774414 4.99512C1.08431 4.49837 1.51953 4.11784 2.08008 3.85352C2.64518 3.58464 3.31283 3.4502 4.08301 3.4502H9.23047V1.95312C9.23047 1.76628 9.28288 1.62272 9.3877 1.52246C9.49251 1.41764 9.63607 1.36523 9.81836 1.36523C9.90495 1.36523 9.9847 1.37891 10.0576 1.40625C10.1305 1.43359 10.1966 1.47233 10.2559 1.52246L13.0107 3.83301C13.1566 3.9515 13.2272 4.09277 13.2227 4.25684C13.2227 4.4209 13.152 4.56217 13.0107 4.68066L10.2559 6.99121C10.1966 7.03678 10.1305 7.07552 10.0576 7.10742C9.9847 7.13477 9.90495 7.14844 9.81836 7.14844C9.63607 7.14844 9.49251 7.09603 9.3877 6.99121C9.28288 6.88639 9.23047 6.74284 9.23047 6.56055V5.00195H3.98047C3.34245 5.00195 2.83659 5.17741 2.46289 5.52832C2.09375 5.87923 1.90918 6.35319 1.90918 6.9502V7.52441C1.90918 7.74772 1.83171 7.93685 1.67676 8.0918C1.52181 8.24674 1.33496 8.32422 1.11621 8.32422ZM14.8906 7.54492C15.1094 7.54492 15.2962 7.6224 15.4512 7.77734C15.6061 7.92773 15.6836 8.11686 15.6836 8.34473V9.09668C15.6836 9.78483 15.5286 10.3773 15.2188 10.874C14.9134 11.3708 14.4782 11.7536 13.9131 12.0225C13.348 12.2868 12.6803 12.4189 11.9102 12.4189H6.7627V13.9229C6.7627 14.1051 6.71029 14.2464 6.60547 14.3467C6.50521 14.4515 6.36393 14.5039 6.18164 14.5039C6.09505 14.5039 6.01302 14.4902 5.93555 14.4629C5.86263 14.4355 5.79655 14.3968 5.7373 14.3467L2.98242 12.0361C2.84115 11.9222 2.77051 11.7832 2.77051 11.6191C2.77051 11.4505 2.84115 11.307 2.98242 11.1885L5.7373 8.87793C5.79655 8.8278 5.86263 8.78906 5.93555 8.76172C6.01302 8.73438 6.09505 8.7207 6.18164 8.7207C6.36393 8.7207 6.50521 8.77311 6.60547 8.87793C6.71029 8.97819 6.7627 9.12174 6.7627 9.30859V10.8604H12.0127C12.6553 10.8604 13.1611 10.6872 13.5303 10.3408C13.904 9.98991 14.0908 9.51595 14.0908 8.91895V8.34473C14.0908 8.11686 14.166 7.92773 14.3164 7.77734C14.4714 7.6224 14.6628 7.54492 14.8906 7.54492Z",fill:"#C7C6C4"}),(0,u.jsx)("path",{d:"M4 2L12 14",stroke:"white",strokeWidth:"3",strokeLinecap:"round"}),(0,u.jsx)("path",{d:"M4 2L12 14",stroke:"#C7C6C4",strokeLinecap:"round"})]})});var p=n(9291),m=n(31701),h=n(37810),f=n(19124),g=n(77080),C=n(64921),v=n(52275),M=n(73420);const y=function(e){let{format:t,className:n,icon:o,title:i,isDefault:r,recurrence:s,recurrenceDisabled:a,right:l,focused:c,onClick:d,onMouseMove:p,onMouseEnter:m,onMouseLeave:h,locked:f,type:g}=e;return"collection-overlay"===t?(0,u.jsx)(x,{className:n,icon:o,format:t,title:i,isDefault:r,recurrence:s,recurrenceDisabled:a,right:l,focused:c,onClick:d,onMouseMove:p,onMouseEnter:m,onMouseLeave:h,locked:f,type:g}):"phone-modal"===t?(0,u.jsx)(k,{icon:o,format:t,title:i,isDefault:r,recurrence:s,focused:c,onClick:d}):"experimental-new-page"===t?(0,u.jsx)(E,{focused:c,onClick:d,onMouseMove:p,onMouseEnter:m,onMouseLeave:h,icon:o,title:i}):"experimental-new-page-submenu"===t?(0,u.jsx)(D,{focused:c,onClick:d,onMouseMove:p,onMouseEnter:m,onMouseLeave:h,icon:o,title:i}):(0,u.jsx)(_,{focused:c,onClick:d,onMouseMove:p,onMouseEnter:m,onMouseLeave:h,icon:o,format:t,title:i,isDefault:r,recurrence:s,recurrenceDisabled:a,right:l})};function S(e){let{format:t,title:n,isDefault:o,recurrence:i,recurrenceDisabled:a}=e;const c=(0,s.Fg)(),f=(0,r.VK)((()=>g.default.checkGate("recurrence_queue_task_improvements")),[]);return"collection-overlay"!==t?(0,u.jsx)(u.Fragment,{children:n}):(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n,(0,u.jsxs)("span",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o&&(0,u.jsx)("span",{style:{fontSize:12,fontWeight:h.Z.fontWeight.medium,color:c.mediumTextColor},children:(0,u.jsx)(p.FormattedMessage,{defaultMessage:"DEFAULT",id:"database.templatePickerMenuItem.default"})}),i&&(0,l.N)({width:14,color:m.ZP.blue,marginLeft:8}),a&&f&&d({width:14,height:12.25,color:m.ZP.lightIconColor,marginLeft:8})]})]})}function x(e){let{className:t,icon:n,format:i,title:r,isDefault:s,recurrence:a,recurrenceDisabled:l,right:c,focused:d,onClick:p,onMouseMove:m,onMouseEnter:h,onMouseLeave:f,locked:g,type:C}=e;const M=(0,o.O7)(),{device:y}=M;return(0,u.jsx)(v.Z,{className:t,icon:n,title:(0,u.jsx)(S,{format:i,title:r,isDefault:s,recurrence:a,recurrenceDisabled:l}),right:c,focused:d,onClick:p,onMouseMove:m,onMouseEnter:h,onMouseLeave:f,showDragHandle:!y.isMobile&&!g,dragHandleDisabled:"empty_page"===C})}function k(e){let{icon:t,format:n,title:o,isDefault:i,recurrence:r,focused:s,onClick:a}=e;return(0,u.jsx)(v.Z,{icon:t,title:(0,u.jsx)(S,{format:n,title:o,isDefault:i,recurrence:r}),focused:s,onClick:a,showDragHandle:!1})}function T(e,t,n){const{device:o}=e;return{...a.ZD,display:"flex",alignItems:"center",flexGrow:1,height:o.isMobile?36:32,fontSize:16,borderRadius:4,paddingLeft:8,marginBottom:2,color:n?t.mediumTextColor:t.lightTextColor}}function _(e){let{focused:t,onClick:n,onMouseMove:a,onMouseEnter:l,onMouseLeave:c,icon:d,format:p,title:m,isDefault:h,recurrence:g,recurrenceDisabled:v,right:M}=e;const y=(0,s.Fg)(),x=(0,o.O7)(),k=(0,i.l)(),_=(0,r.VK)((()=>{const e=null==k?void 0:k.publicEditModeStore.state;return(0,f.GD)(e)}),[k]);return(0,u.jsxs)(C.Z,{style:T(x,y,_),hovered:t,onClick:n,onMouseMove:a,onMouseEnter:l,onMouseLeave:c,hoveredStyle:{background:y.buttonHoveredBackground,color:y.regularTextColor},pressedStyle:{background:y.buttonPressedBackground},children:[(0,u.jsx)("div",{style:{display:"flex",alignItems:"center",width:24,height:24,marginRight:10},children:d}),(0,u.jsx)(S,{format:p,title:m,isDefault:h,recurrence:g,recurrenceDisabled:v}),M&&(0,u.jsx)("div",{style:{marginLeft:"auto",marginRight:4},children:M})]})}function E(e){const{focused:t,onClick:n,onMouseMove:o,onMouseEnter:i,onMouseLeave:r,icon:a,title:l}=e,c=(0,s.yK)((e=>({item:{display:"flex",alignItems:"center",padding:"6px 14px 6px 10px",border:`1px solid ${e.stroke.regular}`,borderRadius:100},itemFocused:{background:e.tint.regular}})),[]);return(0,u.jsx)("div",{onClick:n,onMouseMove:o,onMouseEnter:i,onMouseLeave:r,style:{...c.item,...t?c.itemFocused:{}},children:(0,u.jsxs)(M.X2,{gap:4,alignItems:"center",children:[a,l]})})}function D(e){const{focused:t,onClick:n,onMouseMove:o,onMouseEnter:i,onMouseLeave:r,icon:a,title:l}=e,c=(0,s.yK)((e=>({item:{display:"flex",alignItems:"center",padding:"4px 10px 4px 8px"},itemFocused:{background:e.tint.regular}})),[]);return(0,u.jsx)("div",{onClick:n,onMouseMove:o,onMouseEnter:i,onMouseLeave:r,style:{...c.item,...t?c.itemFocused:{}},children:(0,u.jsxs)(M.X2,{gap:8,alignItems:"center",children:[a,l]})})}},25498:(e,t,n)=>{n.d(t,{m:()=>r,w:()=>s});n(57658);var o=n(81491),i=n(98165);const r=[{frequency:"day",interval:1},{frequency:"week",interval:1},{frequency:"month",interval:1},{frequency:"year",interval:1}];function s(e){const t=i.qA(e)??[],n=[];for(const o of t){if(!("block"===o.table&&!0===o.isTemplate()&&o.getFormat().automation_id&&o.id!==e.id))continue;const t=o.getAutomationStore();if(t){if(!t.isReady())return{automationStoresReady:!1};void 0!==t.getRecurrence()&&t.isDefined()&&n.push(t.getModel())}}return{automationStoresReady:!0,...(0,o.templateAncestorsViolateRecurrenceNesting)(n)}}},17031:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{findCollectionTemplatePickerItemFromStore(e){if(e)return this.find((t=>t.props.templateStore===e))}}const r=new i},53470:(e,t,n)=>{n.d(t,{H:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("rename",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M14.7881 2.5752L15.3008 2.04199C15.5605 1.76855 15.5742 1.39941 15.3213 1.13965L15.1436 0.955078C14.9111 0.722656 14.5283 0.763672 14.2754 1.00977L13.749 1.5293L14.7881 2.5752ZM6.68066 9.87598L8.0752 9.28809L14.2891 3.06738L13.25 2.03516L7.03613 8.25586L6.4209 9.60254C6.35254 9.75977 6.52344 9.9375 6.68066 9.87598ZM4.09668 14.4355H12.0674C13.373 14.4355 14.1387 13.6768 14.1387 12.2207V4.99512L12.7988 6.33496V12.1045C12.7988 12.7676 12.4434 13.1025 11.9854 13.1025H4.17871C3.54297 13.1025 3.19434 12.7676 3.19434 12.1045V4.49609C3.19434 3.83301 3.54297 3.49805 4.17871 3.49805H10.0234L11.3633 2.1582H4.09668C2.62695 2.1582 1.85449 2.91699 1.85449 4.37988V12.2207C1.85449 13.6836 2.62695 14.4355 4.09668 14.4355Z"})})},81491:(e,t,n)=>{n.r(t),n.d(t,{DEFAULT_MAX_RECURRENCE_DUPLICATION_PER_TASK:()=>m,MAXIMUM_DAILY_RECURRENCES_IN_PATH:()=>u,MAXIMUM_NESTED_RECURRENCE_LEVEL:()=>c,MAX_RECURRENCE_INTERVAL:()=>a,RRULE_WEEKDAYS_MAP:()=>s,getRecurrenceAfter:()=>p,rruleFromRecurrence:()=>l,templateAncestorsViolateRecurrenceNesting:()=>d});var o=n(30120),i=n(84885);const r={day:i.Ci.DAILY,week:i.Ci.WEEKLY,month:i.Ci.MONTHLY,year:i.Ci.YEARLY},s={MO:i.Ci.MO,TU:i.Ci.TU,WE:i.Ci.WE,TH:i.Ci.TH,FR:i.Ci.FR,SA:i.Ci.SA,SU:i.Ci.SU},a=100;function l(e){const{start_date:t,frequency:n,interval:o,weekdays:a,timezone:l,hour:c,minute:u}=e,d="week"===n&&a?a.map((e=>s[e])):void 0;return new i.Ci({freq:r[n],dtstart:new Date(t),interval:o,byweekday:d,tzid:l,byhour:c??0,byminute:u??0,bysecond:0})}const c=1,u=1;function d(e){var t;if(0===e.length)return{violatesConstraint:!1,templateNestingExceedsMaxDepth:!1,ancestorHasDailyTemplate:!1,nestedDepthOfAutomationAncestors:void 0,immediateAncestorRecurrenceType:void 0};const n=e.filter((e=>{var t;return"day"===(null===(t=e.getRecurrence())||void 0===t?void 0:t.frequency)})),o=e.length,i=null===(t=e[0].getRecurrence())||void 0===t?void 0:t.frequency,r=o>c,s=n.length>=u;return{violatesConstraint:r||s,templateNestingExceedsMaxDepth:r,ancestorHasDailyTemplate:s,nestedDepthOfAutomationAncestors:o,immediateAncestorRecurrenceType:i}}function p(e){const{recurrence:t,afterDate:n}=e,i=l({...t}).after(new Date(n));if(!i)return;return o.ou.fromJSDate(i).toUTC().setZone("local",{keepLocalTime:!0}).toJSDate()}const m=100}}]);