"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[197],{54814:(e,t,o)=>{o.d(t,{nc:()=>l,rG:()=>r});o(57658);var n=o(6287),s=o(98165),a=o(6258),i=o(54642);async function r(e){let{environment:t,spaceId:o,databaseType:s,parentStore:r}=e;if(!o)return;const l=await i.getTypedDatabases(t,{spaceId:o,databaseType:s});return"success"===l.type?l.data.result.map((e=>a.NW.createChildStore(r,{table:n.vF,id:e.collectionId}))):void 0}async function l(e){let{environment:t,spaceId:o,databaseTypes:n,parentStore:a,teamId:i}=e;const l=[];return await Promise.all(n.map((async e=>{const n=await async function(e){let{environment:t,spaceId:o,databaseType:n,parentStore:a,teamId:i}=e;const l=await r({spaceId:o,environment:t,databaseType:n,parentStore:a});if(!l)return!1;for(const r of l){const e=s.VP(r);if(e&&e.id===i)return!0}return!1}({environment:t,spaceId:o,databaseType:e,parentStore:a,teamId:i});n&&l.push(e)}))),l}},48529:(e,t,o)=>{o.d(t,{Ac:()=>i,b0:()=>a,dq:()=>r});var n=o(69246),s=o(1898);function a(e){switch(e){case n.cz:case n.mu:return!0;case n.PT:case n.kg:return!1;default:(0,s.t1)(e)}}function i(e,t){if(!t)return!1;switch(e){case n.mu:return!0;case n.PT:case n.kg:case n.cz:return!1;default:(0,s.t1)(e)}}function r(e){switch(e){case"bookmarks":case"private":case"shared":case"team":case"workspace":case n.g$:return!1;case n.PT:case n.cz:case n.mu:case n.kg:return!0;default:(0,s.t1)(e)}}},10009:(e,t,o)=>{o.d(t,{oB:()=>q,ZP:()=>R,Pr:()=>E,nW:()=>$});o(52262),o(24506);var n=o(67294),s=o(480),a=o(86628),i=o(24405),r=o(56666),l=o(75071),d=o(69246),c=o(13493),u=o(9291),p=o(6404),m=o(89858),g=o(24677),v=o(13447),b=o(75330),f=o(64921),y=o(52275),T=o(31945),h=o(78140),I=o(32163),S=o(40721),x=o(31278),C=o(76798),k=o(72495),j=o(26388),w=o(33929),P=o(60709),V=o(98742),M=o(35026),Z=o(98165),B=o(75024),L=o(80444),D=o(6258),_=o(81023),F=o(40215),K=o(74948);const A=(0,u.defineMessages)({addAPageInside:{defaultMessage:"Quickly add a page inside",id:"sidebarItem.addAPageInside.tooltip"}});var O=o(85893);function R(e){const{store:t,type:o,canEditItem:n,itemDepth:i,isHovered:r,isFocused:l,onToggle:c}=e,{isMobile:u}=(0,s.Fy)(),p=u||r||l,m=(0,a.VK)((()=>{var e;const o=Boolean(t.getAppContainerBlockStore()),s=null===(e=t.getCollectionViewCollectionStore())||void 0===e?void 0:e.isSyncedCollection();return Boolean(t.getType()&&n&&!o&&!s)}),[t,n]),g=$({showRightIcons:p});return o===d.g$?null:(0,O.jsxs)("div",{style:g.iconContainer,children:[(0,O.jsx)(q,{store:t,type:e.type,itemIndex:e.itemIndex,itemDepth:i}),m&&(0,O.jsx)(N,{store:t,onToggle:c,isTopLevelItem:0===i})]})}function N(e){const{store:t,onToggle:o,isTopLevelItem:n}=e,i=(0,s.O7)(),{isMobile:r}=i.device,l=(0,a.VK)((()=>t.isCollectionView()),[t]),d=(0,a.VK)((()=>t.getLinkedViewCollectionBlockStores()),[t]),u=(0,a.VK)((()=>{var e;const o=null===(e=t.getCollectionViewStores().at(0))||void 0===e?void 0:e.id;if(!o)return;const n=D.Xr.createChildStore(t,{table:c.np,id:o});return null==n?void 0:n.getFormatStore().getValue()}),[t]),p=(0,a.VK)((()=>{const e=null==u?void 0:u.collection_view_source;if("typed"===(null==e?void 0:e.type))return null==e?void 0:e.databaseType}),[u]),m=w.default.formatMessage(A.addAPageInside);return l&&!u&&0===d.length?(0,O.jsx)(z,{disabled:!0,events:{}}):l&&p?(0,O.jsx)(H,{store:t,databaseType:p}):d.length<=1?(0,O.jsx)(j.ZP,{renderTooltip:()=>m,placement:j.ug.Bottom,render:e=>{const s={...e,onClick:e=>{G({store:t,onToggle:o,event:e,sourceStore:d[0]??t,shouldNavigateToSource:!1,environment:i,isTopLevelItem:n})}};return(0,O.jsx)(z,{events:s})}}):(0,O.jsx)(j.ZP,{renderTooltip:()=>m,placement:j.ug.Bottom,render:e=>(0,O.jsx)(T.ZP,{popupType:r?T.Z4.SlideUp:T.Z4.Popup,renderOrigin:t=>(0,O.jsx)(z,{events:(0,V.Z)(e,t)}),render:e=>(0,O.jsx)(W,{store:t,onToggle:o,parent:e,isTopLevelItem:n})})})}function H(e){const{store:t,databaseType:o}=e,i=(0,s.O7)(),r=(0,a.VK)((()=>L.default.state.currentSpaceViewStore),[]),l=(0,a.VK)((()=>L.default.state.currentSpaceStore),[]),d=(0,a.VK)((()=>null==r?void 0:r.getTeamsStores().map((e=>e.id))),[r]),c=(0,F.F)({environment:i,spaceStore:l,parentStore:l,joinedTeamIds:d??[],moveToTargets:[],overrideDatabaseType:o}),u=(0,a.VK)((()=>{if(c.success)return c.typedDatabases}),[c]),p=(0,n.useCallback)((e=>{u&&b.rm({store:t,event:e,typedDatabases:u,environment:i})}),[i,u,t]),m=w.default.formatMessage(A.addAPageInside);return c.success&&0!==(null==u?void 0:u.length)?(0,O.jsx)(j.ZP,{renderTooltip:()=>m,placement:j.ug.Bottom,render:e=>{const t={...e,onClick:p};return(0,O.jsx)(z,{events:t})}}):(0,O.jsx)(z,{disabled:!0,events:{}})}function z(e){const{isMobile:t}=(0,s.Fy)(),o=E();return(0,O.jsx)(f.Z,{ariaLabel:w.default.formatMessage(A.addAPageInside),mobileFeedback:t,style:o.button,disabled:e.disabled,disabledFeedback:e.disabled,...e.events,children:(0,l.f)(o.buttonIcon)})}function W(e){const{store:t,onToggle:o,parent:n,isTopLevelItem:r}=e,l=(0,s.O7)(),{isMobile:d}=l.device,c=(0,a.VK)((()=>t.getLinkedViewCollectionBlockStores()),[t]),p=(0,i.yK)((()=>({menuItem:{display:"flex",alignItems:"center",whiteSpace:"pre"}})),[]),m={menuType:d?P.og.Modal:P.og.Popup,right:d?(0,O.jsx)(S.DoneMenuText,{}):void 0},g={key:"collections",render:e=>(0,O.jsx)(k.Z,{...e,title:(0,O.jsx)(u.FormattedMessage,{defaultMessage:"Add to",id:"sidebarItem.addAPageInside.popup.addTo"})}),items:c.map((e=>({key:e.id,render:t=>(0,O.jsx)(y.Z,{...t,title:(0,O.jsx)("div",{style:p.menuItem,children:(0,O.jsx)(C.Z,{store:e})}),icon:(0,O.jsx)(x.Z,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:14})}),action:t=>{G({store:e,event:t.event,onToggle:o,sourceStore:e,shouldNavigateToSource:!0,environment:l,isTopLevelItem:r})}})))};return(0,O.jsx)(h.Z,{...m,children:(0,O.jsx)(I.Z,{type:I.i.Vertical,onAccept:n.close,initialFocus:void 0,sections:[g]})})}function q(e){const{store:t,type:o,itemDepth:n,itemIndex:a,iconStyle:i,disableBackground:l}=e,d=(0,u.useIntl)(),c=(0,s.O7)(),{isMobile:m}=c.device,v=E(),b=e=>{const s=Z.VP(t);g.Ys({environment:c,store:t}),p.Qn({environment:c,stores:[t],left:e.clientX,top:e.clientY,showInput:!1,actionSectionGroupKey:"sidebar_outliner",analyticsFrom:"sidebar_more_menu",optionalAnalyticsProperties:{teamStore:s,type:0===n?"top_level":"nested",outliner_type:o,outliner_position:a,outliner_depth:n}})},y="bookmarks"===o?d.formatMessage({defaultMessage:"Remove, rename, and more…",id:"sidebarItem.favoritedPageMenuButton.tooltip"}):d.formatMessage({defaultMessage:"Delete, duplicate, and more…",id:"sidebarItem.pageMenuButton.tooltip"});return(0,O.jsx)(j.ZP,{renderTooltip:()=>y,placement:j.ug.Bottom,render:e=>(0,O.jsx)(f.Z,{ariaLabel:y,mobileFeedback:m,style:v.button,hoveredStyle:{...l&&{background:"none"}},pressedStyle:{...l&&{background:"none"}},onClick:b,...e,children:(0,r.o)({...v.buttonIcon,...i})})})}function G(e){const{store:t,sourceStore:o,shouldNavigateToSource:n,environment:s,isTopLevelItem:a,onToggle:i,event:r}=e;_.M_(s)&&(s.device.isMobile&&K.close(),v.createAndCommit({userAction:"OutlinerItem.createdPage",environment:s,perform:e=>m.D0({environment:s,event:r,store:o,transaction:e,navigateToParent:n})}),t.isCollectionView()||(i(!0),M.Ps({store:t,toOpen:!0,environment:s,isTopLevelItem:a})))}function E(){const e=(0,s.O7)().device.isMobile;return(0,i.yK)((t=>({button:e?{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,borderRadius:4,marginLeft:0}:{display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:4,marginLeft:4},buttonIcon:e?{fill:t.lightIconColor,width:18}:{fill:t.sidebarTextColor,width:14}})),[e])}function $(e){const{showRightIcons:t}=e;return(0,i.yK)((()=>({iconContainer:{display:"flex",paddingLeft:3,...t?{}:{...B.jy,display:"block"}}})),[t])}},6025:(e,t,o)=>{o.d(t,{Z:()=>b});var n=o(67294),s=o(480),a=o(24405),i=o(75071),r=o(69246),l=o(9291),d=o(89858),c=o(64921),u=o(26388),p=o(27105),m=o(48529),g=o(9867),v=o(85893);const b=function(e){let{type:t,disableTooltip:o,labelTooltip:b,spaceStore:f,spaceViewStore:y,shouldPersistToggleState:T,outlinerToggleButtonStore:h,isLarge:I,onClick:S}=e;const x=(0,s.O7)(),C=x.device.isMobile,k=(0,m.dq)(t),j=(0,l.useIntl)(),w=(0,n.useRef)(null),P=(0,n.useCallback)((e=>{y&&"team"!==t&&t!==r.g$&&(d.kC({environment:x,spaceStore:f,spaceViewStore:y,type:t,outlinerToggleButtonStore:h,prepend:!0,shouldPersistToggleState:T,useCrdt:(0,p.SL)({event:e,source:"private"===t?"private":"workspace"===t?"space":"other"})}),S&&S())}),[x,h,T,f,y,t,S]),V=(0,n.useCallback)((()=>{g.lo("sidebar_team_section")}),[]),M=(0,a.yK)((e=>({plusButton:{display:"flex",alignItems:"center",justifyContent:"center",height:I?26:20,width:I?26:20,borderRadius:4,marginLeft:C?0:4},plusIcon:{fill:e.mediumIconColor,width:I?18:14,height:I?18:14},tutorialTooltip:{width:230},tutorialText:{fontSize:16,lineHeight:.85},labelTooltip:{color:e.mediumInvertedTextColor}})),[C,I]),Z=k?j.formatMessage({defaultMessage:"New teamspace",id:"sidebar.addButton.addTeamTooltip"}):j.formatMessage({defaultMessage:"Add a page",id:"sidebar.addButton.addPageTooltip"});return(0,v.jsx)(u.ZP,{textWrap:!1,disableTooltip:o,renderTooltip:()=>(0,v.jsxs)(v.Fragment,{children:[Z,(0,v.jsx)("br",{}),(0,v.jsx)("span",{style:M.labelTooltip,children:!k&&b})]}),placement:u.ug.Bottom,render:e=>(0,v.jsxs)(c.Z,{ariaLabel:Z,style:M.plusButton,mobileFeedback:C,onClick:k?V:P,className:"private"===t?"shadow-cursor-new-page-sidebar":void 0,...e,children:[(0,v.jsx)("span",{ref:w}),(0,i.f)(M.plusIcon)]})})}},62395:(e,t,o)=>{o.d(t,{n:()=>n});const n=o(49085).default.createValue(void 0)},40215:(e,t,o)=>{o.d(t,{F:()=>v});var n=o(86628),s=o(94714),a=o(59054),i=o(6287),r=o(54814),l=o(23924),d=o(77907),c=o(75822),u=o(62395),p=o(77080),m=o(42330),g=o(6258);function v(e){let{environment:t,spaceStore:o,joinedTeamIds:v,parentStore:b,moveToTargets:f,overrideDatabaseType:y}=e;const T=(0,n.VK)((()=>{const e=null==o?void 0:o.id;if(e)return function(e){if(!u.n.state)return;if(e!==u.n.state.spaceId)return;return u.n.state.typedDatabases}(e)}),[null==o?void 0:o.id]),h=(0,n.VK)((()=>p.default.checkGate("typed_move_to_improved_default_results")),[]),I=(0,d.useDependency)(d.deps.searchActions),[{value:S,status:x}]=(0,a.r5)((async()=>{if(T)return T;if(!o||!b)return;const e=m.ZP.getTargetsDatabaseType()??y;if(!e)return;if("resolved"!==I.status)return;const n=I.value;let a=[];if(h){const s=((await n.searchCollectionsWithRecents({environment:t,query:"",limit:20,databaseType:[e],spaceStore:o,parentStore:o,collectionViewBlockStore:void 0,searchSessionId:m.ZP.state.isOpen?m.ZP.state.flowId:void 0})).results||[]).map((e=>g.NW.createChildStore(b,{table:i.vF,id:e})));a=(0,l.qJ)({typedDatabases:s,blocksToFilterParents:f})}else{const n=await r.rG({environment:t,spaceId:o.id,databaseType:e,parentStore:b})??[];a=(0,l.mL)({environment:t,typedDatabases:n,spaceStore:o,joinedTeamIds:v})}return u.n.setState({typedDatabases:a,spaceId:o.id}),m.ZP.setState({...m.ZP.state,variant:s.ii}),a}),[T,o,h,t,f,y,b,v,I.status,I.value],{debounce:c.vp,throttle:c.vp});return T?{success:!0,typedDatabases:T}:"resolved"===x&&S?{success:!0,typedDatabases:S}:{success:!1}}},75071:(e,t,o)=>{o.d(t,{f:()=>a});o(67294);var n=o(45238),s=o(85893);const a=(0,n.IU)("plusThick",{viewBox:"0 0 14 14",svg:(0,s.jsx)("path",{d:"M2 7.16357C2 7.59692 2.36011 7.95093 2.78735 7.95093H6.37622V11.5398C6.37622 11.9731 6.73022 12.3271 7.16357 12.3271C7.59692 12.3271 7.95093 11.9731 7.95093 11.5398V7.95093H11.5398C11.9731 7.95093 12.3271 7.59692 12.3271 7.16357C12.3271 6.73022 11.9731 6.37622 11.5398 6.37622H7.95093V2.78735C7.95093 2.36011 7.59692 2 7.16357 2C6.73022 2 6.37622 2.36011 6.37622 2.78735V6.37622H2.78735C2.36011 6.37622 2 6.73022 2 7.16357Z"})})}}]);