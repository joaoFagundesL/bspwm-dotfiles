"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[2284],{62284:(e,t,n)=>{n.r(t);n(21703),n(57658);var o=n(36769),r=n(41432),a=n(28020),i=n(44534),s=n(63208),c=n(27724),l=n(9953),u=n(42858),d=n(993),m=n(13447);function p(e){m.createAndCommit({userAction:"legacyTransclusionConsoleActions.createLegacyTransclusion",environment:e,perform:t=>{var n,o;const p=c.default.getCurrentRecordCache();if(!p)throw new Error("No in-memory record cache!");if(function(e){const{environment:t,transaction:n}=e,o=s.Z.state;if(!o.isActive)return!1;const{selection:r,simpleTableStore:a}=o,c=i.HM.insertRow({environment:t,index:r.end.row+1,simpleTableStore:a,transaction:n});return l.sW({store:c,data:{parent_id:a.getParentId(),parent_table:a.getParentTable()},transaction:n}),!0}({environment:e,transaction:t}))return;const v=null===(n=a.RM())||void 0===n?void 0:n.pointer.spaceId,g=(null===(o=a.RM())||void 0===o?void 0:o.useCrdt())??!1,h=l.j4({environment:e,type:r.Ti.text,inMemoryRecordCache:p,transaction:t,spaceId:v,useCrdt:g}),y=h.getTitleStore();y&&d.mM({environment:e,store:y,tokens:[['here is a legacy transclusion (a.k.a. "phantom synced block")']],index:0,transaction:t});const C=l.j4({environment:e,type:r.Ti.toggle,inMemoryRecordCache:p,transaction:t,spaceId:v,useCrdt:g}),b=C.getTitleStore();b&&d.mM({environment:e,store:b,tokens:[["this toggle has a legacy transclusion in it"]],index:0,transaction:t});const T=C.getContentStore();m.applyOperation({transaction:t,store:T,operation:{pointer:T.pointer,path:T.path,command:"set",args:[h.id]}}),u.is({environment:e,blocks:[h,C],selection:c.default.state.stores,transaction:t,replaceEmptyTextBlock:!1}),t.postSubmitCallbacks.push((e=>{e&&console.log("Submitting legacy transclusion transaction failed! You may need to run the server with the NOTION_DEBUG_DISABLE_LEGACY_TRANSCLUSION_VALIDATION environment variable set to a non-empty value.")}))}})}(0,o.exposeDebugEnvironmentValue)("createLegacyTransclusion",(e=>p.bind(null,e)))}}]);