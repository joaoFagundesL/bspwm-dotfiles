(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[5906],{16091:(e,t,n)=>{"use strict";n.d(t,{ND:()=>T,RD:()=>I,gc:()=>L,gl:()=>P,u7:()=>C});var i=n(67294),o=n(36769),r=n(480),s=n(86628),a=n(41432),l=n(9291),c=n(11969),d=n(13447),u=n(37181),p=n(81415),h=(n(95477),n(19124)),m=n(68056),g=n(89086),f=n(28685),v=n(80444),y=n(77080),b=n(83212),S=n(6258),x=n(24666),k=n(47449),w=n(89626),j=n(85893);const M=(0,l.defineMessages)({spaceForAiHeader:{id:"AiOnboardingTooltips.spaceForAi.header",defaultMessage:"Press ‘space’ for AI"},spaceForAiContent:{id:"AiOnboardingTooltips.spaceForAi.content",defaultMessage:"On a new line or page, press ‘space’ on your keyboard for AI to generate or edit the page. Try it now!"},askAiAnythingHeader:{id:"AiOnboardingTooltips.askAiAnything.header",defaultMessage:"Ask AI anything"},askAiAnythingContent:{id:"AiOnboardingTooltips.askAiAnything.content",defaultMessage:"Just tell AI what to do — the more details, the better. You can also start from an example in the menu."},refineAiResponseHeader:{id:"AiOnboardingTooltips.refineAiResponse.header",defaultMessage:"Tell AI what to do next"},refineAiResponseContent:{id:"AiOnboardingTooltips.refineAiResponse.content",defaultMessage:"How was it? Give AI further instructions to improve what it wrote, or hit ‘Done’ when finished."},showAssistantLocationHeader:{id:"AiOnboardingTooltips.showAssistantLocation.answersToYourQuestionHeader",defaultMessage:"Ask AI when searching"},showAssistantLocationContent:{id:"AiOnboardingTooltips.showAssistantLocation.askQuestionBody",defaultMessage:"AI can find pages and synthesize a quick, concise answer for you. Try it now."},showAssistantOriginElementLocationHeader:{id:"AiOnboardingTooltips.ShowAssistantOriginElementLocationTooltip.header",defaultMessage:"Start by asking a question"},showAssistantOriginElementLocationContent:{id:"AiOnboardingTooltips.ShowAssistantOriginElementLocationTooltip.content",defaultMessage:"Notion AI will find pages and compose a concise answer for you. Try it now."}});function C(){const e=(0,r.O7)(),t=function(){const e=(0,r.O7)(),t=(0,s.VK)((()=>{const t=v.default.state.mainEditorCurrentBlockStore;return t&&b.Z.getMode(e,t)}),[e]);return(0,s.VK)((()=>{if(e.device.isMobile)return;if(!y.default.checkGate("space_for_ai_tooltip_enabled"))return;const{currentUserSettingsStore:n,inAppCalloutStore:i}=v.default.state;if(!i.canShow("ai_onboarding_tooltip"))return;const o=null==n?void 0:n.getSettings();if(!o)return;if(o.signup_time&&o.signup_time>16770636e5)return;if("space_for_ai"!==(0,w.sy)())return;if(!(0,h.GD)(t))return;const r=x.default.state;if("editing"===r.mode){const e=(0,m.QY)(r.multiSelection);if(e&&(0,g.wd)(e.selection)){const t=e.store,n=f.E.findEditableWithStore(t);if(n){const e="block"===t.pointer.table?S.G.createChildStore(t,t.pointer):void 0,i=e&&e.getType(),o=Boolean(i&&(0,a.hD)(i)),r=t.getValue();if(o&&!r)return n}}}}),[e,t])}();return t?(0,j.jsx)(p.U,{origin:()=>t.getNode(),placementToOrigin:"bottom",header:(0,j.jsx)(l.FormattedMessage,{...M.spaceForAiHeader}),content:(0,j.jsx)(l.FormattedMessage,{...M.spaceForAiContent}),onCloseClick:()=>(0,w.h1)(e)}):null}function I(e){const{originRef:t,openState:n}=e,i=(0,r.O7)(),o=(0,s.VK)((()=>(0,w.sy)()),[]);if(i.device.isMobile)return null;return"ask_ai_anything"===o&&"initialPrompt"===n.stage?(0,j.jsx)(p.U,{origin:t,placementToOrigin:"top",header:(0,j.jsx)(l.FormattedMessage,{...M.askAiAnythingHeader}),content:(0,j.jsx)(l.FormattedMessage,{...M.askAiAnythingContent}),onCloseClick:()=>(0,w.h1)(i)}):null}function P(e){const{originRef:t,openState:n,isInputEmpty:i}=e,o=(0,r.O7)(),a=(0,s.VK)((()=>(0,w.sy)()),[]);if(o.device.isMobile)return null;const c="refine_ai_response"===a&&"results"===n.stage&&!n.loading&&"cursor"===n.context.type&&i;return(0,j.jsx)(p.U,{origin:c?t:void 0,placementToOrigin:"right",pointerOffset:-4,pointerLength:25,header:(0,j.jsx)(l.FormattedMessage,{...M.refineAiResponseHeader}),content:(0,j.jsx)(l.FormattedMessage,{...M.refineAiResponseContent}),onCloseClick:()=>(0,w.h1)(o)})}function T(e){const{origin:t}=e,n=(0,r.O7)();(0,i.useEffect)((()=>{c.K(n,{from:"qna_button"})}),[n]);const o=(0,i.useCallback)((()=>{const{currentUserSettingsStore:e}=v.default.state;e&&(c.y(n,{from:"qna_button"}),(0,k.CX)(n,{phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickTooltipComplete",userSettingsStore:e}))}),[n]);return(0,j.jsx)(p.U,{style:{width:250},pointerLength:25,pointerPosition:"94%",origin:t,placementToOrigin:"top",header:(0,j.jsx)(l.FormattedMessage,{...M.showAssistantOriginElementLocationHeader}),content:(0,j.jsx)(l.FormattedMessage,{...M.showAssistantOriginElementLocationContent}),onCloseClick:o})}function L(e){const{origin:t}=e,n=(0,r.O7)();(0,i.useEffect)((()=>{c.K(n,{from:"qna_search"})}),[n]);const o=(0,i.useCallback)((()=>{const{currentUserSettingsStore:e}=v.default.state;e&&(c.y(n,{from:"qna_search"}),(0,k.CX)(n,{phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickTooltipComplete",userSettingsStore:e}))}),[n]);return(0,j.jsx)(p.U,{style:{width:250},pointerLength:25,pointerPosition:"5%",origin:t,placementToOrigin:"bottom",header:(0,j.jsx)(l.FormattedMessage,{...M.showAssistantLocationHeader}),content:(0,j.jsx)(l.FormattedMessage,{...M.showAssistantLocationContent}),onCloseClick:o})}(0,o.exposeDebugEnvironmentValue)("resetAIOnboarding",(e=>()=>{const{currentUserSettingsStore:t}=v.default.state;t&&d.createAndCommit({userAction:"AiIntroModal.debugging.resetAIOnboarding",environment:e,perform:e=>{u.d2({userSettingsStore:t,transaction:e,data:{ai_onboarding_phase:"space_for_ai"}})},userId:t.id})}))},47449:(e,t,n)=>{"use strict";n.d(t,{qC:()=>g,Up:()=>m,CX:()=>h});var i=n(7032),o=n(54642),r=n(13447),s=n(37181),a=n(49085),l=n(92595);class c extends a.default{getInitialState(){return{loadingState:"initial"}}}const d=new c,u=d;(0,l.exposeDebugValue)("AiSuggestedPageQnaStore",d);var p=n(21273);function h(e,t){const{phase:n,transactionUserAction:i,userSettingsStore:o}=t;r.createAndCommit({environment:e,userAction:i,perform:e=>{s.d2({userSettingsStore:o,transaction:e,data:{ai_qna_intro_onboarding_phase:n}})}})}function m(e,t){const{userSettingsStore:n}=t;r.createAndCommit({environment:e,userAction:"aiQnaActions.setLastExposedToQnaAtToCurrentTimestamp",perform:e=>{s.d2({userSettingsStore:n,transaction:e,data:{last_exposed_to_ai_qna_at:Date.now()}})}})}async function g(e){let{environment:t,blockStore:n,reminderNumber:r,spaceId:s}=e;const a=await async function(e){let{environment:t,blockStore:n,reminderNumber:r,spaceId:s}=e;if("initial"===u.state.loadingState||u.state.reminderNumber!==r){const e=o.getSuggestedPageQna(t,{blockPointer:{...n.pointer,spaceId:s},aiSessionId:(0,i.ZP)()}).then((e=>"success"!==e.type?(u.setState({loadingState:"error",reminderNumber:r}),[]):e.data.questions));u.setState({loadingState:"loading",reminderNumber:r});const a=await e;return u.setState({loadingState:"loaded",reminderNumber:r,questions:a}),a[0]}if("loading"===u.state.loadingState)return u.waitUntil((()=>"loaded"===u.state.loadingState)).then((()=>"loaded"===u.state.loadingState?u.state.questions[0]:void 0));if("loaded"===u.state.loadingState){return u.state.questions[0]}return}({environment:t,blockStore:n,reminderNumber:r,spaceId:s});if(a&&p.Z.isQnaPageSuggestedQuestionRemindersEnabledForUser())return a}},55031:(e,t,n)=>{"use strict";n.d(t,{G:()=>u,y:()=>d});var i=n(51454),o=n(28020),r=n(39615),s=n(24646),a=n(5162),l=n(4926),c=n(99659);function d(e,t){const{theme:n,rightEdgeDistance:r,isInPeekRenderer:a}=t,d=t.width??36,p=(0,s.ll)(e,a)-(0,s.vJ)(e);return{position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",background:n.whiteButtonBackground,bottom:u(e,16+l.Z.state),right:r+l.Z.state,width:d,height:d,borderRadius:"100%",fontSize:20,boxShadow:n.lightBoxShadow,zIndex:i.hT,opacity:o.tu.state?0:1,transform:`translateX(-${p}px) translateZ(0)`,transition:`\n\t\t\topacity ${c.nk}ms,\n\t\t\tcolor ${c.nk}ms,\n\t\t\ttransform 200ms\n\t\t`}}function u(e,t){const n=e.device.isMobileNative,i=(0,a.Y)("supportsNativeBottomBar"),o=n&&!i;return e.WindowSizeStore.getSafePaddingBottomCSS(t+(o?r.VG:0))}},77207:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});n(67294);var i=n(480),o=n(86628),r=n(55367),s=n(80796),a=n(69784),l=n(85893);const c=function(e){const t=(0,i.Fy)(),n=(0,o.VK)((()=>({initiator:s.Z.state.initiator,isDragging:r.ZP.state.isDragging})),[]),c=(0,o.VK)((()=>({active:a.default.state.isActive,moved:!!a.default.state.isActive&&a.default.state.moved})),[]),d=c.moved?"default":n.isDragging?"-webkit-grabbing":"text";let u="notion-cursor-listener";return"-webkit-grabbing"===d&&(u+=" notion-disable-local-cursor"),t.isIOS&&("touch"===n.initiator||n.isDragging||c.active?document.body.classList.add("notion-disable-webkit-user-select"):document.body.classList.remove("notion-disable-webkit-user-select")),(0,l.jsx)("div",{style:{...e.style,cursor:d},className:u,children:e.children})}},39849:(e,t,n)=>{"use strict";n.d(t,{N:()=>l,Z:()=>c});n(67294);var i=n(24405),o=n(31701),r=n(37810),s=n(85893);const a={display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:16,height:16,fontSize:10,textAlign:"center",fontWeight:r.Z.fontWeight.semibold,borderRadius:4,color:o.ZP.white,position:"static",marginLeft:6,WebkitFontSmoothing:"auto"};let l=function(e){return e[e.Red=0]="Red",e[e.Gray=1]="Gray",e}({});const c=function(e){let{count:t,color:n,style:o,numberStyle:r}=e;const c=(0,i.Fg)(),u=n===l.Red;return!t||t<=0?null:(0,s.jsx)("div",{style:{...a,...o,...t>99&&{width:void 0,padding:2},background:u?c.redBadgeBackground:c.lightIconColor},children:(0,s.jsx)(d,{count:t,numberStyle:r})})};function d(e){let{count:t,numberStyle:n}=e;return t?1===t?(0,s.jsx)("span",{style:{marginLeft:-.5,...n},children:"1"}):t>99?(0,s.jsx)("span",{style:{letterSpacing:-.5,...n},children:"99+"}):t>9?(0,s.jsx)("span",{style:{letterSpacing:-.5,marginLeft:-.5,...n},children:t}):(0,s.jsx)("span",{style:{...n},children:t}):null}},58434:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>bs});var i=n(67294),o=n(34958),r=n(77907),s=n(83355),a=n(13991),l=n(79946),c=n(49271),d=n(25278),u=n(99405),p=n(89101),h=n(29369),m=n(9852),g=n(12139),f=n(9291),v=n(31701),y=n(15828),b=n(3303),S=n(18265),x=n(17224),k=n(47839),w=n(32603),j=n(91376),M=n(32953),C=n(8055),I=n(91100),P=n(73966),T=n(70782),L=n(39634),_=n(37181),A=n(95477);const E=(0,r.lazyComponent)(r.deps.CreatorProfile,(e=>e.CreatorProfile)),R=(0,r.lazyComponent)(r.deps.LocalizedTemplates,(e=>e.LocalizedTemplates));var Z=n(80444),O=n(6258);const z=(0,r.lazyComponent)(r.deps.StudentGroupSignup,(e=>e.default));var B=n(480),V=n(86628),F=n(24405),U=n(59054),D=n(49204),N=n(37810),W=n(61519),q=n(63296),K=n(58297),H=n(64369),G=n(74016),$=n(85893);const Q=function(e){const{teamStore:t}=e,n=(0,B.O7)(),{teamName:i}=(0,V.VK)((()=>({teamName:t.getName()})),[t]),o=(0,F.yK)((e=>({buttonContainer:{marginTop:15,display:"flex",justifyContent:"space-between"},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},title:{fontWeight:N.Z.fontWeight.semibold,fontSize:20,margin:10},subtitle:{color:e.mediumTextColor,fontSize:18},divider:{maxWidth:280},rightButton:{fontWeight:N.Z.fontWeight.semibold,marginLeft:10}})),[]);return(0,$.jsxs)("div",{style:o.container,children:[(0,$.jsx)(G.p,{store:t,disabled:!0,size:55}),(0,$.jsx)("div",{style:o.title,children:(0,$.jsx)(f.FormattedMessage,{id:"teamInviteLinkJoinPage.page.title",defaultMessage:"You've been invited to join {teamName}",values:{teamName:i}})}),(0,$.jsx)("div",{style:o.subtitle,children:(0,$.jsx)(f.FormattedMessage,{id:"teamInviteLinkJoinPage.page.subtitle",defaultMessage:"You can access the content in the teamspace if you join the teamspace."})}),(0,$.jsxs)("div",{style:o.buttonContainer,children:[(0,$.jsx)(K.Z,{isLarge:!0,onClick:async()=>{const e=n.currentUser.id;if(!e)return;const i=[{type:"member",entity_type:"user",user_id:e}];await D.um({environment:n,userId:e,teamStore:t,user:i}),x.Ph(n,{store:t,selection:"yes"})},children:(0,$.jsx)(f.FormattedMessage,{id:"teamInviteLinkJoinPage.joinTeam.label",defaultMessage:"Join teamspace"})}),(0,$.jsx)(q.Z,{isLarge:!0,style:o.rightButton,onClick:async()=>{x.Ph(n,{store:t,selection:"no"}),await D.Id({environment:n})},children:(0,$.jsx)(f.FormattedMessage,{id:"teamInviteLinkJoinPage.backToMyContentButton.label",defaultMessage:"Back to my content"})})]}),(0,$.jsx)(W.Z,{size:48,innerStyle:o.divider}),(0,$.jsx)(H.Z,{isSmall:!0,children:(0,$.jsx)(f.FormattedMessage,{id:"teamInviteLinkJoinPage.contact.message",defaultMessage:"Please contact your workspace owner for any questions."})})]})};var Y=n(14889);function J(e){const{teamStore:t,teamName:n,onRequestClick:i}=e,o=(0,B.O7)(),r=(0,F.yK)((e=>({buttonContainer:{marginTop:15,display:"flex",justifyContent:"space-between"},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},title:{fontWeight:N.Z.fontWeight.semibold,fontSize:20,margin:10},subtitle:{color:e.mediumTextColor,fontSize:18},divider:{maxWidth:280},rightButton:{fontWeight:N.Z.fontWeight.semibold,marginLeft:10}})),[]);return(0,$.jsxs)("div",{style:r.container,children:[(0,$.jsx)(G.p,{store:t,disabled:!0,size:55}),(0,$.jsx)("div",{style:r.title,children:(0,$.jsx)(f.FormattedMessage,{id:"teamInviteLinkRequestPage.requestAccess.title",defaultMessage:"Request access to {teamName}",values:{teamName:n??X()}})}),(0,$.jsx)("div",{style:r.subtitle,children:(0,$.jsx)(f.FormattedMessage,{id:"teamInviteLinkRequestPage.requestAccess.subtitle",defaultMessage:"You can access this teamspace if a teamspace owner approves your request."})}),(0,$.jsxs)("div",{style:r.buttonContainer,children:[(0,$.jsx)(K.Z,{isLarge:!0,onClick:i,children:(0,$.jsx)(f.FormattedMessage,{id:"teamInviteLinkRequestPage.requestAccess.label",defaultMessage:"Request access"})}),(0,$.jsx)(q.Z,{isLarge:!0,style:r.rightButton,onClick:async()=>{await D.Id({environment:o})},children:(0,$.jsx)(f.FormattedMessage,{id:"teamInviteLinkRequestPage.backToMyContentButton.label",defaultMessage:"Back to my content"})})]}),(0,$.jsx)(W.Z,{size:48,innerStyle:r.divider}),(0,$.jsx)(H.Z,{isSmall:!0,children:(0,$.jsx)(f.FormattedMessage,{id:"teamInviteLinkRequestPage.contact.message",defaultMessage:"Please contact your workspace owner for any questions."})})]})}function X(){return(0,$.jsx)(f.FormattedMessage,{id:"teamInviteLinkRequestPage.privateTeamspace.label",defaultMessage:"Private Teamspace"})}const ee=function(e){const{teamStore:t}=e,[n,o]=(0,i.useState)(!1),{teamName:r}=(0,V.VK)((()=>({teamName:t.getName()})),[t]);return(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(J,{teamStore:t,teamName:r,onRequestClick:()=>o(!0)}),(0,$.jsx)(Y.Z,{teamStore:t,teamName:r??X(),teamId:t.id,isModalOpen:n,onDismiss:()=>o(!1)})]})};function te(e){const{teamAccessLevel:t,teamStore:n}=e;switch(t){case"open":return(0,$.jsx)(Q,{teamStore:n});case"closed":case"private":return(0,$.jsx)(ee,{teamStore:n})}}const ne=function(e){const{teamId:t}=e,n=(0,B.O7)(),{teamAccessLevel:o,teamStore:s}=(0,V.VK)((()=>{const e=new O.zX(n,{table:h.e0,id:t});return{teamAccessLevel:e.getTeamAccessLevel(),teamStore:e}}),[n,t]),[{value:a}]=(0,U.r5)((async()=>await D.Ng({environment:n,teamId:t})),[n,t]);(0,i.useEffect)((()=>{!0===(null==a?void 0:a.isValidTeamRequest)&&null!=a&&a.isTeamMember&&(async()=>{var e;const t=null===(e=n.currentUser)||void 0===e?void 0:e.id;t&&s&&await D.t_({environment:n,userId:t,teamStore:s})})()}),[n,s,a]);const l=(0,F.yK)((()=>({container:{display:"flex",justifyContent:"center",height:"100%"}})),[]);return a?(0,$.jsx)("div",{style:l.container,children:a.isValidTeamRequest?(0,$.jsx)(te,{teamStore:s,teamAccessLevel:o}):"nonSpaceMember"===a.invalidRequestReason?(0,$.jsx)(r.LazyPageError,{route:{name:"teamsInvite",teamId:t},publicPageData:void 0}):(0,$.jsx)(r.LazyPageError,{route:{name:"notFound"},publicPageData:void 0})}):null};var ie=n(84549),oe=n(35061),re=n(11342);function se(e,t){const n=t.deviceType,i=t.mobileAppVersion;if(!(0,oe.wv)(e)||"local"===e||!t.isMobileNative||!i)return!1;const o=function(e){const{environmentName:t,deviceType:n,mobileAppVersion:i,androidVersions:o,iosVersions:r}=e,s=(0,re.parseMobileAppVersion)(i,"android"===n);if(!s)return!1;if("android"===n&&!o||"ios"===n&&!r)return!1;let a;if("android"===n){if(!o)return!1;a=(0,re.parseMobileAppVersion)(o[t],!0)}else{if(!r)return!1;a=(0,re.parseMobileAppVersion)(r[t],!1)}return!!a&&(0,re.isLessThanVersion)(s,a)}({environmentName:e,deviceType:n,mobileAppVersion:i,iosVersions:{staging:"0.1.1022",development:"0.5.1168",production:"0.4.1021"}});return o}var ae=n(72141),le=n(3791),ce=n(51454),de=n(50950),ue=n(65729),pe=n(72899),he=n(16091),me=n(81598),ge=n(69098),fe=n(7401),ve=n(30106),ye=n(28020),be=n(4708),Se=n(15010),xe=n(19124),ke=n(64286),we=n(46654);const je=r.deps.imageEdit,Me=(0,r.lazyComponent)(je,(e=>e.ImageEditModal));var Ce=n(97448);const Ie=(0,r.lazyComponent)(r.deps.moveTo,(e=>e.MoveToMenuRenderer));var Pe=n(48451),Te=n(50770),Le=n(34017),_e=n(94841),Ae=n(61931),Ee=n(52389),Re=n(74948),Ze=n(36596),Oe=n(38676);function ze(){const e=(0,V.VK)((()=>Oe.sidebarExpandedStore.state),[]),t=(0,V.VK)((()=>e?Oe.sidebarWidthStore.state:0),[e]),n=(0,F.yK)((n=>{const i={width:22,height:22,borderRadius:4},o={height:10,minHeight:10,borderRadius:10};return{sidebar:{backgroundColor:n.sidebarBackground,boxShadow:n.sidebarBoxShadow,display:e?"flex":"none",minWidth:t,flexDirection:"column",padding:"12px 14px",overflow:"hidden"},heroSection:{marginBottom:19,display:"flex",alignItems:"center"},heroSectionIcon:{padding:"1px",...i},heroSectionTitle:{width:177,marginLeft:8,...o},toplevelMenu:{marginBottom:16,width:78,...o},toplevelMenuLast:{marginBottom:36,width:135,...o},sectionHeader:{marginBottom:12,width:56,...o},pageRow:{display:"flex",alignItems:"center",marginBottom:8},pageChevron:{width:12,height:12,display:"block",marginRight:4,fill:"dark"===n.mode?n.accentColors.gray[300]:n.accentColors.gray[100]},pageIcon:{...i},pageTitle:{marginLeft:6,...o}}}),[e,t]),o=(0,$.jsxs)("div",{style:n.heroSection,children:[(0,$.jsx)(Ze.Z,{style:n.heroSectionIcon,emphasized:!0}),(0,$.jsx)(Ze.Z,{style:n.heroSectionTitle,emphasized:!0})]}),r=(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(Ze.Z,{style:n.toplevelMenu,emphasized:!0}),(0,$.jsx)(Ze.Z,{style:n.toplevelMenu,emphasized:!0}),(0,$.jsx)(Ze.Z,{style:n.toplevelMenuLast,emphasized:!0})]}),s=(0,$.jsx)(Ze.Z,{style:n.sectionHeader,emphasized:!0}),a=(0,i.useMemo)((()=>Array(5).fill(null).map((()=>Array(4).fill(null).map((()=>Math.floor(4*Math.random())))))),[]).map(((e,t)=>e.map(((e,i)=>(0,$.jsxs)("div",{style:{...Be(t),...n.pageRow},children:[(0,$.jsx)("svg",{viewBox:"0 0 30 30",style:n.pageChevron,children:(0,$.jsx)("polygon",{points:"17.4,15 7,25.2 9.8,28 23,15 9.8,2 7,4.8"})}),(0,$.jsx)(Ze.Z,{style:n.pageIcon,emphasized:!0}),(0,$.jsx)(Ze.Z,{style:{...n.pageTitle,width:80+20*e},emphasized:!0})]},`${t}-${i}`)))));return(0,$.jsxs)("div",{style:n.sidebar,children:[o,r,s,a]})}function Be(e){return 0===e?{}:{animation:`1s ease-in ${e}s 1 normal both running fadein`}}var Ve=n(24646),Fe=n(5162),Ue=n(80736),De=n(51),Ne=n(21273),We=n(43604),qe=n(27242),Ke=n(12309),He=n(33293);function Ge(){const e=(0,V.VK)((()=>Ke.Z.state.modalInfoById),[]);return(0,$.jsx)($.Fragment,{children:Object.entries(e).map((e=>{let[t,n]=e;const{content:i,dismissUsing:o,isOpen:r,modalStyle:s,onClosed:a,onDismiss:l}=n;return(0,$.jsx)(He.q,{dismissUsing:o,isOpen:r,onClosed:a,onDismiss:l,style:s,children:i},t)}))})}n(21703);var $e=n(30120),Qe=n(92595),Ye=n(54642);async function Je(e,t){const n=await Ye.stripeGetTestClock(t,{spaceId:e});if("success"===n.type){if("advancing"===n.data.status)throw new Error("Test clock is advancing. Please try again in a few seconds.");return n.data.epochSeconds}}async function Xe(e){const{environment:t,spaceId:n,advanceTestClockArgument:i}=e;if(i)return"number"==typeof i?i:"function"==typeof i?await async function(e){const{environment:t,spaceId:n,callback:i}=e,o=await Je(n,t);if(o)return i(o)}({environment:t,spaceId:n,callback:i}):"object"==typeof i?await async function(e){const{environment:t,spaceId:n,durationLike:i}=e,o=await Je(n,t);if(!o)return;const r=$e.ou.fromSeconds(o),s=$e.nL.fromDurationLike(i);return r.plus(s).toSeconds()}({environment:t,spaceId:n,durationLike:i}):void 0}const et=function(){const e=["local","staging","development"].includes("production"),t=(0,B.O7)();return(0,i.useEffect)((()=>{e&&((0,Qe.exposeDebugValue)("refreshTestClock",(async()=>{var e;const n=null===(e=Z.default.state.currentSpaceStore)||void 0===e?void 0:e.id;if(n){const e=await Je(n,t);if(e){const t=$e.ou.fromSeconds(e);console.log(`Test clock time is ${t.toString()} (${e} seconds)`)}}})),(0,Qe.exposeDebugValue)("advanceTestClock",(async e=>{var n;if(!e)throw new Error("advanceTestClock requires an argument. You can pass an epoch timestamp in seconds, a relative DurationLike object like { months: 2 }, or a function that takes the current epoch seconds and returns the new epoch seconds.");const i=null===(n=Z.default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(!i)return;const o=await Xe({environment:t,spaceId:i,advanceTestClockArgument:e});o&&await Ye.stripeAdvanceTestClock(t,{spaceId:i,epochSeconds:o})})))}),[e,t]),null};var tt=n(1404),nt=n(67181),it=n(59260),ot=n(62142),rt=n(30221),st=n(88280),at=(n(57658),n(19584)),lt=n(99334);const ct=!1,dt=(ct?1:10)*at.C0,ut=5*dt;function pt(){ct&&console.log(...arguments)}function ht(){return(0,i.useEffect)((()=>{if(!window.BroadcastChannel)return;const e=(0,m.c$)(),t=new Map,n=new BroadcastChannel("notion_tab_tracker");n.onmessage=e=>{const n=e.data;"string"==typeof n&&t.set(n,Date.now())};const i=window.setInterval((()=>{(()=>{const e=[],n=Date.now();for(const[i,o]of t.entries())n-o>ut&&e.push(i);e.length&&pt("Removing tab ids:",e);for(const i of e)t.delete(i)})(),n.postMessage(e);const i=t.size+1;pt("Tab count is",i),(0,lt.$)(i)}),dt);return()=>{n.close(),window.clearInterval(i)}}),[]),null}var mt=n(22491),gt=n(70203),ft=n(38585),vt=n(53965),yt=n(92120),bt=n(62740),St=n(24229),xt=n(48588);function kt(e){const{discussionId:t,level:n}=e;return`\n\t\t.${(0,mt.vE)({level:n})}.${(0,mt.dk)({discussionId:t})}.${ft.kB} {\n\t\t\tbackground: ${(0,v.Hu)(e)} !important;\n\t\t\topacity: unset !important;\n\t\t\tborder-bottom: 2px solid ${v.mO};\n\t\t}\n\t`}function wt(e){return`background: ${e.accentColors.uiBlue[150]} !important;\n\t\t\tborder-bottom: 2px solid ${e.accentColors.uiBlue[300]} !important;`}function jt(e){return`background: ${e.tint.regular} !important;\n\t\t\tcolor: ${e.text.secondary} !important;\n\t\t\tborder-bottom: 2px solid ${e.state.pressed} !important;`}function Mt(){const e=(0,F.Fg)();function t(){var e,t,n;const i=(null===(e=yt.Z.state)||void 0===e?void 0:e.discussionIds)||[],o=null!==(t=St.Z.state)&&void 0!==t&&t.open&&(null===(n=St.Z.state)||void 0===n?void 0:n.discussionIds)||[];return[...i.flatMap((e=>vt.DZ(mt.nB).map((t=>kt({discussionId:e,level:t+1,hovered:!0,selected:!1}))))),...o.flatMap((e=>vt.DZ(mt.nB).map((t=>kt({discussionId:e,level:t+1,hovered:!1,selected:!0})))))].join("\n")}function n(e){var t;return((null===(t=yt.Z.state)||void 0===t?void 0:t.discussionIds)||[]).map((t=>function(e){const{discussionId:t,theme:n}=e;return`\n\t\t.${(0,mt.Ws)({type:"update"})}.${(0,mt.dk)({discussionId:t})}.${ft.kB} {\n\t\t\t${wt(n)}\n\t\t}\n\t\t.${(0,mt.Ws)({type:"remove"})}.${(0,mt.dk)({discussionId:t})}.${ft.kB} {\n\t\t\t${jt(n)}\n\t\t}\n\t`}({theme:e,discussionId:t}))).join("\n")}function i(){var e,t;const n=null===(e=xt.Z.state)||void 0===e?void 0:e.store,i=null===(t=xt.Z.state)||void 0===t||null===(t=t.annotations)||void 0===t?void 0:t.find(gt.j0F);if(!i)return"";const o=(0,gt.zW$)(i);return"block"!==(null==n?void 0:n.table)?"":`\n\t\t\t.${(0,mt.S$)({href:o,blockId:n.id})}.${ft.kB} {\n\t\t\t\ttransition: border-color 100ms ease-in, opacity 100ms ease-in;\n\t\t\t\tborder-color: currentColor !important;\n\t\t\t\topacity: 1 !important;\n\t\t\t}\n\t\t`}function o(e){const t=bt.Z.getHoveredEdit();return t?`\n\t\t\t.${(0,mt.EO)({type:"insert",editId:t.editId})} {\n\t\t\t\t${wt(e)}\n\t\t\t}\n\t\t\t.${(0,mt.EO)({type:"remove",editId:t.editId})} {\n\t\t\t\t${jt(e)}\n\t\t\t}\n\t\t`:""}const r=(0,V.VK)((()=>[t(),n(e),i(),o(e)].filter(Boolean).join("\n")),[e]);return r?(0,$.jsx)("style",{dangerouslySetInnerHTML:{__html:r}}):null}var Ct=n(77207),It=n(74055),Pt=n(77080),Tt=n(7339);function Lt(e){return(0,$.jsx)("div",{id:"test-customer-io",style:{width:334,height:200,position:"absolute",bottom:64,right:21,zIndex:1,display:e?void 0:"none"}})}const _t=function(){const e=(0,B.O7)(),{currentUser:t}=e,n=(0,V.VK)((()=>Tt.C.state.ready),[]),o=(0,V.VK)((()=>t.isLoggedIn()&&n&&Pt.default.checkGate("customerio")),[t,n]),r=(0,V.VK)((()=>Z.default.state.inAppCalloutStore),[]),s=(0,V.VK)((()=>"dark"!==e.ThemeStore.state.mode),[e]);(0,i.useEffect)((()=>{o&&(r.canShow("customer_io")?s?It.Z.state.suppressReason===It.V.IN_APP_CALLOUT_CONFLICT?It.Z.setState({...It.Z.state,isVisible:!0,suppressReason:void 0}):It.Z.setState({...It.Z.state,suppressReason:void 0}):It.Z.setState({isVisible:!1,suppressReason:It.V.DARK_MODE}):It.Z.setState({isVisible:!1,suppressReason:It.V.IN_APP_CALLOUT_CONFLICT}))}),[r,o,s]);const a=(0,V.VK)((()=>It.Z.state.isVisible&&r.canShow("customer_io")),[r]);return(0,i.useEffect)((()=>{if(a)return r.updateCalloutStatus({calloutId:"customer_io",visible:!0}),()=>{r.updateCalloutStatus({calloutId:"customer_io",visible:!1})}}),[r,a]),o?Lt(!!a):null};var At=n(41056);function Et(e){return(0,i.useEffect)((()=>{const e=window.setInterval(At.u,5e3);return()=>{window.clearInterval(e)}}),[]),null}var Rt=n(98938),Zt=n(41892);function Ot(){const e=(0,B.Fy)(),[t,n]=(0,i.useState)(!1);return(0,i.useEffect)((()=>{if(e.isDesktop){const e=function(e){var t={addEvent:function(e,t,n){e.addEventListener(t,n,!1)},removeEvent:function(e,t,n){e.removeEventListener(t,n)},input:"",pattern:"38384040373937396665",keydownHandler:function(n){t.input+=n.keyCode,t.input.length>t.pattern.length&&(t.input=t.input.substr(t.input.length-t.pattern.length)),t.input===t.pattern&&(e(),t.input="")},load:function(){this.addEvent(document,"keydown",this.keydownHandler)},unload:function(){this.removeEvent(document,"keydown",this.keydownHandler)}};return t.load(),t}((()=>{n(!0)}));return()=>{e.unload()}}}),[e.isDesktop]),t?(0,$.jsx)("img",{className:"nyan",style:{position:"fixed",top:"calc(50vh - 100px)",zIndex:1e3,left:"50%",animationName:"leftOrRight",animationDuration:"9s",animationIterationCount:"infinite",pointerEvents:"none",userSelect:"none"},src:Zt.Z.images.nyancatGif}):null}var zt=n(15944),Bt=n(81415);const Vt=(0,f.defineMessages)({pressSlashHeader:{id:"EducationTooltips.pressSlash.header",defaultMessage:"Press {slashkey} for commands"}});function Ft(e){return(0,$.jsx)("div",{style:{background:v.ZP.whiteWithAlpha(.1),padding:3,paddingRight:8,paddingLeft:8,marginRight:6,marginLeft:6,borderRadius:4},children:e.char})}function Ut(){const e=(0,B.O7)(),t=zt.o();return(0,V.VK)((()=>{const{currentUserSettingsStore:e}=Z.default.state;var t;return!e||!e.isReady()||Boolean(null===(t=e.getSettings())||void 0===t?void 0:t.pressed_slash_tooltip)}),[])||e.device.isMobile||!t?null:(0,$.jsx)(Bt.U,{hideCloseButton:!0,origin:()=>t.getNode(),placementToOrigin:"bottom",header:(0,$.jsx)(f.FormattedMessage,{...Vt.pressSlashHeader,values:{slashkey:(0,$.jsx)(Ft,{char:"/"})}}),content:null,onCloseClick:()=>zt.q(e)})}var Dt=n(1302),Nt=n(74725),Wt=n(41432),qt=n(43690),Kt=n(6695),Ht=n(66673),Gt=n(40745),$t=n(8597),Qt=n(13148),Yt=n(75e3),Jt=n(70663),Xt=n(16275),en=n(80503),tn=n(1898),nn=n(98604),on=n(61045),rn=n(3898),sn=n(64964),an=n(993),ln=n(13447),cn=n(10906),dn=n(49394),un=n(65598),pn=n(45010),hn=n(98180),mn=n(69316),gn=n(85526),fn=n(83212),vn=n(24666),yn=n(23063),bn=n(73420),Sn=n(73063),xn=n(1743),kn=n(74194),wn=n(3386),jn=n(58261),Mn=n(85740),Cn=n(26388);function In(e){const{environment:t,pageStore:n}=e,[o,s]=(0,i.useState)(-1),[a,l]=(0,i.useState)(""),[c]=(0,i.useState)(n.id),d=(0,i.useRef)(null),{focused:u,shouldSelectAllInput:p,findQuery:h,showReplaceInput:m,open:g}=(0,V.VK)((()=>mn.Z.state),[]);(0,i.useEffect)((()=>{c!==n.id&&nn.xv({clearQuery:!0})}),[c,n.id]),(0,Nt.O)({active:g,closeHandler:()=>nn.xv({clearQuery:!1}),ref:d,ignoreKeydown:!0});const v=(0,V.VK)((()=>g?[n,...(0,un.MI)({blockStore:n,traverseTransclusionReferences:!0})]:[]),[g,n]),{schema:y,pagePropertyFormats:b,pageProperties:S}=(0,V.VK)((()=>{var e;const t=n.getProperties(),i=(null===(e=n.getAssociatedCollectionStore())||void 0===e?void 0:e.getFormat().property_visibility)??[];return{schema:n.getSchema(),pagePropertyFormats:i,pageProperties:t}}),[n]),x=(0,f.useIntl)(),k=(0,Ht.D9)(h),w=(0,V.VK)((()=>{if(!g)return[];const e=function(e){const{schema:t,find:n,propertyFormats:i,pageProperties:o}=e;if(0===n.length)return[];const r=(0,Kt.n5)({schema:t,propertyFormats:i,titleProperty:"disallow"}),s={};i.forEach((e=>{const t=e.property,n="show"===e.visibility||"hide_if_empty"===e.visibility&&Boolean(null==o?void 0:o[t]);s[t]=n}));const a=r.filter(((e,i)=>{var o;let{property:r}=e;const s=null===(o=t[r])||void 0===o?void 0:o.name.toLowerCase();return null==s?void 0:s.includes(n.toLowerCase())}));return a.map(((e,t)=>{let{property:n}=e;return{type:"property",allowReplace:!1,propertyId:n,visible:s[n]??!0}}))}({find:h,schema:y,propertyFormats:b,pageProperties:S}),t=function(e){const{find:t,childBlocks:n,intl:i}=e;if(!n||0===t.length)return[];const o=[];for(const r of n){const e=r.getType();if(!e)continue;const n=(0,Wt.XD)(e)||(0,Wt.W2)(e);if(!(n||"table_row"===e||"collection_view"===e))continue;const s=r.getProperties(),{title:a,caption:l,description:c}=s;if("table_row"===e){const e=vt.oA((0,dn.Je)({block:r,find:t,intl:i})).map((e=>({...e,type:"block",blockId:r.id,blockStore:r,propertyType:"title"})));e&&o.push(...e)}else if(n){const e={title:a,caption:l,description:c};(0,tn.qP)(e).forEach((e=>{let[n,s]=e;if(!s)return;const a={type:"block",blockId:r.id,propertyType:n,blockStore:r},l=(0,dn.ub)({textValue:s,find:t,intl:i}).map((e=>({...e,...a})));o.push(...l)}))}else if("collection_view"===e){const e=(0,cn.fm)(r);if(!e)continue;const n=e.collectionViewStore();if(!n)continue;const s=n.getType();if(!s)continue;const a=n.getFormat(),l=e.normalizedSchemaStore.state,c=Object.keys(l).filter((e=>{var t,n;return"text"===(null===(t=l[e])||void 0===t?void 0:t.type)||"title"===(null===(n=l[e])||void 0===n?void 0:n.type)})),d=vt.jj((0,qt.ps)(a,s,l));if(!d)continue;const u=d.filter((e=>c.includes(e)));e.groupsStore.state.forEach((e=>{const s=e.resultsStore.state.flatMap((e=>{const o=e.getPropertiesStore().getValue();if(!o)return[];return u.flatMap((s=>{const a=o[s];if(!a)return[];return(0,dn.ub)({textValue:a,intl:i,find:t}).map((t=>({propertyId:s,selection:t.selection,allowReplace:!1,type:"inline_collection_child_page",inlineCollectionId:r.id,inlineCollectionViewId:n.id,blockStore:e})))}))}));o.push(...vt.jj(s))}))}}return o}({find:h,childBlocks:v,intl:x}),n=[...e,...t];return h!==k?s(-1):o>=n.length&&s(n.length-1),n}),[g,h,y,b,S,v,x,k,o]);(0,i.useEffect)((()=>{w.length>0&&-1===o&&s(0);const e=w[o];if(!e)return mn.Z.update((e=>({...e,currentFocusedResult:void 0})));if("block"===e.type)return mn.Z.update((t=>({...t,currentFocusedResult:{type:"block",id:e.blockStore.id,selection:e.selection}})));if("property"===e.type){const t=e.propertyId;return mn.Z.update((e=>({...e,currentFocusedResult:{type:"property",propertyId:t}})))}if("inline_collection_child_page"===e.type){const t=e;return mn.Z.update((e=>({...e,currentFocusedResult:{type:"inline_collection_child_page",id:t.blockStore.id,inlineCollectionId:t.inlineCollectionId,inlineCollectionViewId:t.inlineCollectionViewId,propertyId:t.propertyId,selection:t.selection}})))}}),[o,w]);const{value:j}=(0,r.useDependency)(r.deps.assistant),M=(0,V.VK)((()=>Ne.Z.isInPageFindQnaOptionEnabledForUser()),[]),C=(0,i.useCallback)((async e=>{if(!j||!M)return;const i=await j.assistantActions.resetAndInitializeAssistantSession({environment:t,makeActiveSession:!0});if(!i)return;const o=hn.Z.getSessionContext(i.sessionId);o&&(o.assistantConfigurationStore.setSearchScope({pageId:n.id,type:"page"}),nn.xv({clearQuery:!1}),j.assistantMenuStore.setState({open:!0,currentView:"chat"}),e&&e.length>0&&await j.handleSubmitNewQuestion({currentSkill:void 0,newValue:(0,gt.TPx)(h),environment:t,shouldForceStartNewSession:!1,source:"in_page_find"}))}),[j,t,h,n.id,M]),I=(0,i.useCallback)((async()=>{await Dt.default.afterNextFlush();const e=document.getElementsByClassName(Xt.qp).item(0);if(!e)return;const t=pn.Z.PageScroller;t&&on.bx({element:e,scrollers:{verticalScroller:t,horizontalScroller:void 0},vertical:{reveal:"closest"},horizontal:void 0,animate:!0})}),[]);(0,U.r5)((async()=>{if(-1===o||!g)return;const e=w[o];e&&("block"===e.type?await rn.Nz(n,[e.blockStore.id]):"property"!==e.type||e.visible||gn.Z.state.forceShowProperties||gn.Z.update((e=>({...e,forceShowProperties:!0}))),await I())}),[o,w,g,n,I]);const P=vt.Ds((e=>mn.Z.update((t=>({...t,findQuery:e,currentFocusedResult:void 0,shouldSelectAllInput:!1})))),300),T=(0,i.useCallback)((async e=>{const{location:t,shouldRouteToQnaIfNoResults:n}=e;if(!w||0===w.length)return void(n&&h.length>0&&await C(h));if(1===w.length)return await I();const i="next"===t?1:-1,r=w[o+i],a="next"===t?0:w.length-1;s((e=>r?e+i:a))}),[w,o,h,C,I]),L=(0,V.VK)((()=>ye.tu.state),[])?0:(0,en.R6)(t.device.isElectronMac),_=(0,V.VK)((()=>h===a),[h,a]),A=(0,V.VK)((()=>{if(!m||0===h.length||_)return!1;return Tn({match:w[o],environment:t})}),[o,t,w,m,_,h.length]),E=(0,F.yK)((e=>({findInputContainer:{display:"flex",alignItems:"center",gap:10,padding:"0px 10px"},replaceInputContainer:{display:"flex",padding:10,flexDirection:"column",alignItems:"flex-end",gap:3},container:{boxShadow:e.largeLightBoxShadow,position:"absolute",top:0,right:26,zIndex:999,backgroundColor:e.accentColors.gray[0],borderRadius:12,width:280,outline:`3px solid ${e.accentColors.uiBlue[200]}`},inputContainer:{boxShadow:"none",border:"none",outline:"none",flexGrow:1},findInput:{paddingTop:10,paddingBottom:10},input:{fontSize:14},divider:{height:1,backgroundColor:e.lightDividerColor},replaceButton:{fontSize:13,display:"flex",borderRadius:8,height:void 0,paddingTop:7,paddingBottom:7,cursor:A?"pointer":"not-allowed"},replaceAll:{fontWeight:N.Z.fontWeight.regular,color:e.text.secondary}})),[A]);return(0,$.jsx)(yn.Z,{isVisible:g,enterAnimationStyle:{opacity:0,translateY:0},animationStyle:{opacity:1,translateY:L+10},animationConfig:{durationMS:150},exitAnimationStyle:{translateY:L,opacity:0},render:()=>(0,$.jsxs)("div",{style:E.container,ref:d,children:[(0,$.jsx)("div",{style:E.findInputContainer,children:(0,$.jsx)(xn.Z,{debugName:"FindAndReplace",capture:!0,allowSearch:!0,allowOpenLinkMenu:!0,children:(0,$.jsxs)(wn.Z,{debugName:"FindAndReplace",capture:!0,onShiftEnter:()=>T({location:"previous",shouldRouteToQnaIfNoResults:!1}),onUp:()=>T({location:"previous",shouldRouteToQnaIfNoResults:!1}),onDown:()=>T({location:"next",shouldRouteToQnaIfNoResults:!1}),onGroup:e=>{e.preventDefault&&e.preventDefault(),T({location:"next",shouldRouteToQnaIfNoResults:!1})},onEsc:()=>{nn.xv({clearQuery:!1})},onCommandJ:()=>C(),onCommandEnter:()=>C(h),children:[(0,$.jsx)(kn.Z,{value:h,onChange:e=>{const t=e.target.value;P.cancel(),t.length>0?P(e.target.value):mn.Z.update((e=>({...e,findQuery:"",currentFocusedResult:void 0,shouldSelectAllInput:!1})))},format:kn.B.Transparent,placeholder:"Find, replace, ask...",selectAll:p,focus:u,onFocus:()=>{nn.Du(),vn.default.setState({mode:"empty"})},focusInitial:!0,onBlur:()=>mn.Z.update((e=>({...e,focused:!1}))),onSubmit:()=>T({location:"next",shouldRouteToQnaIfNoResults:!1}),inputStyle:{...E.input,...E.findInput},style:E.inputContainer},"find-input-element"),(0,$.jsx)(Pn,{numberOfMatches:w.length,currentSelectedMatchIndex:o,hasQuery:h.length>0}),0===w.length?(0,$.jsx)(En,{hasQuery:h.length>0,isQnaEnabled:M,onClick:()=>C(h)}):null,(0,$.jsx)(Rn,{jumpToBlockFn:T,numberOfMatches:w.length,isShowingReplaceInput:m,onReplaceIconClick:()=>nn.AW(),hasFindQuery:h.length>0}),(0,$.jsx)(An,{})]})})}),m?(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)("div",{style:E.divider}),(0,$.jsxs)("div",{style:E.replaceInputContainer,children:[(0,$.jsx)(kn.Z,{value:a,onChange:e=>{l(e.target.value)},format:kn.B.Transparent,placeholder:"Replace with...",inputStyle:E.input,style:E.inputContainer,focusInitial:!0,onSubmit:()=>{A&&Ln({match:w[o],environment:t,replace:a})}},"replace-input-element"),(0,$.jsxs)(bn.X2,{gap:4,children:[(0,$.jsx)(Mn.Z,{onClick:()=>function(e){const{environment:t,matches:n,replace:i,find:o,intl:r}=e,s=n.filter((e=>Tn({match:e,environment:t}))),a=[i];let l=0;const c={id:"",offset:0};for(;-1!==l;){const e=l+_n,n=s.slice(l,e);l=n.length<_n?-1:e-1;const d=i.length-o.length;ln.createAndCommit({userAction:"findAndReplaceInstance",environment:t,perform:e=>{n.forEach((n=>{if("property"===n.type||"inline_collection_child_page"===n.type)return;const{blockStore:i,propertyType:o,selection:r}=n,s=i.id,l="title"===o?i.getTitleStore():i.getCaptionStore();l&&(c.id!==s?(c.id=s,c.offset=0):c.offset+=d,an.pe({environment:t,editorMode:"default",selection:{startIndex:r.startIndex+c.offset,endIndex:r.endIndex+c.offset},store:l,transaction:e}),an.mM({environment:t,index:r.startIndex+c.offset,store:l,tokens:[a],transaction:e}))}))}}),sn.d4({item:{label:r.formatMessage({id:"inPageFind.replaceAll.snackbarCopy",defaultMessage:"Replaced {numMatches} matches"},{numMatches:n.length})},undoFunc:()=>{}})}}({matches:w,environment:t,replace:a,find:h,intl:x}),style:{...E.replaceButton,...E.replaceAll},disabled:0===h.length||_,isLightGray:0===h.length||_,children:(0,$.jsx)(f.FormattedMessage,{id:"inPageFind.matches.replaceAll",defaultMessage:"Replace all"})}),(0,$.jsx)(K.Z,{onClick:()=>Ln({match:w[o],environment:t,replace:a}),style:E.replaceButton,disabled:!A,children:(0,$.jsxs)(bn.X2,{gap:4,alignItems:"center",children:[(0,$.jsx)(f.FormattedMessage,{id:"inPageFind.matches.individualReplace",defaultMessage:"Replace"}),(0,$.jsx)("span",{children:(0,Yt.U)({height:14,width:14})})]})})]})]})]}):null]})})}function Pn(e){const t=(0,F.yK)((e=>({exclamation:{width:14,height:14,color:e.accentColors.red[500]},notFound:{whiteSpace:"nowrap",fontSize:12,color:e.text.tertiary}})),[]),{currentSelectedMatchIndex:n,numberOfMatches:i,hasQuery:o}=e;return i?(0,$.jsx)(Zn,{currentSelectionIndex:n,numberOfMatches:i}):o&&0===i?(0,$.jsx)("span",{style:t.notFound,children:(0,$.jsx)(f.FormattedMessage,{id:"inPageFind.matchCount.noMatches",defaultMessage:"Not found"})}):null}function Tn(e){const{match:t,environment:n}=e;if(!t||"property"===t.type||"inline_collection_child_page"===t.type||!t.allowReplace)return!1;const{blockStore:i}=t,o=fn.Z.getMode(n,i),r=i.canEdit()&&"comment"!==o.permission;return o.permission,!!r}function Ln(e){const{match:t,environment:n,replace:i}=e;if(!t||"property"===t.type||!t.allowReplace)return;const{blockStore:o,selection:r,propertyType:s}=t,a="title"===s?o.getTitleStore():o.getCaptionStore();if(!a)return;const l=[i];ln.createAndCommit({userAction:"findAndReplaceInstance",environment:n,perform:e=>{an.pe({environment:n,editorMode:"default",selection:r,store:a,transaction:e}),an.mM({environment:n,index:r.startIndex,store:a,tokens:[l],transaction:e})}})}const _n=200;function An(){const[e,t]=(0,i.useState)(!1),n=(0,F.yK)((t=>({icon:{width:12,height:12,color:e?t.accentColors.gray[500]:t.icon.secondary,cursor:e?"pointer":void 0,strokeWidth:.4,stroke:"currentcolor"}})),[e]);return(0,$.jsx)(Sn.Z,{icon:e=>(0,Qt.U)(n.icon),ariaLabel:"Button to toggle the filter bar",onClick:()=>nn.xv({clearQuery:!1}),onMouseEnter:()=>t(!0),onMouseLeave:()=>t(!1),style:{padding:3,width:void 0,height:void 0}})}function En(e){const{hasQuery:t,isQnaEnabled:n,onClick:i}=e,o=(0,F.yK)((e=>({container:{fontSize:13,display:"flex",borderRadius:8,height:void 0,paddingTop:7,paddingBottom:7},icon:{width:12,height:12}})),[]);return t&&n?(0,$.jsx)(Cn.ZP,{placement:Cn.ug.Bottom,originGap:18,renderTooltip:()=>(0,$.jsx)(jn.Z,{name:"commandEnter"}),allowHover:!1,render:e=>(0,$.jsx)(K.Z,{style:o.container,...e,onClick:i,children:(0,$.jsx)(f.FormattedMessage,{id:"inPageFind.matchCount.ask",defaultMessage:"Ask AI"})})}):null}function Rn(e){const{numberOfMatches:t,jumpToBlockFn:n,isShowingReplaceInput:i,onReplaceIconClick:o}=e,r=(0,V.VK)((()=>t>0),[t]),s=(0,F.yK)((e=>({icon:{width:12,height:12,color:r?e.icon.secondary:e.icon.quaternary,cursor:r?"pointer":"not-allowed",strokeWidth:.4,stroke:"currentcolor"},hoveredBackground:{background:e.buttonHoveredBackground},activeHoveredBackground:{background:i?e.accentColors.uiBlue[100]:e.buttonHoveredBackground},active:{color:i?e.accentColors.uiBlue[600]:e.icon.secondary,cursor:"pointer"},iconWrapper:{padding:3,width:void 0,height:void 0}})),[r,i]);return(0,$.jsxs)(bn.X2,{alignItems:"center",gap:2,children:[r?(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(Sn.Z,{icon:e=>(0,$t.Z)(s.icon),ariaLabel:"Button to navigate to the previous result",hoveredStyle:s.hoveredBackground,onClick:()=>n({location:"previous",shouldRouteToQnaIfNoResults:!1}),style:s.iconWrapper}),(0,$.jsx)(Sn.Z,{icon:e=>(0,Gt.M)(s.icon),ariaLabel:"Button to navigate to the next result",hoveredStyle:s.hoveredBackground,onClick:()=>n({location:"next",shouldRouteToQnaIfNoResults:!1}),style:s.iconWrapper})]}):null,r||i?(0,$.jsx)(Sn.Z,{icon:e=>(0,Jt.h)({...s.icon,...s.active}),ariaLabel:"Button to the replace input section",hoveredStyle:s.activeHoveredBackground,onClick:o,style:s.iconWrapper}):null]})}function Zn(e){const{numberOfMatches:t,currentSelectionIndex:n}=e,i=(0,F.yK)((e=>({container:{fontSize:".8rem",color:e.text.tertiary}})),[]);return 0===t?null:(0,$.jsx)("div",{style:i.container,children:(0,$.jsxs)(bn.X2,{gap:4,alignItems:"center",children:[(0,$.jsx)("span",{children:n+1}),(0,$.jsx)(f.FormattedMessage,{id:"inPageFind.matchCount.ofSpacer",defaultMessage:"of"}),(0,$.jsx)("span",{children:t})]})})}var On=n(21202),zn=n(81193),Bn=n(3297),Vn=n(32360),Fn=n(60709),Un=n(83941),Dn=n(68785),Nn=n(78140),Wn=n(32163),qn=n(50506),Kn=n(72495),Hn=n(26673);class Gn extends s.Z{constructor(){super(...arguments),this.didSingleWorkspaceFork=!1,this.mountedTime=Date.now(),this.readyToExperimentStatus=this.createComputedStore((()=>{if(this.environment.device.isMobile)return"not_eligible";if(this.mountedTime+3e3<=Date.now())return"not_eligible";if(!Tt.C.state.ready)return"waiting";const{currentUserRootStore:e}=Z.default.state;if(null==e||!e.isReady())return"waiting";const{total:t,loaded:n,editable:i}=Vn.o(e);return t<2?"not_eligible":i>2?"eligible":n===t?"not_eligible":"waiting"}))}didMountOrUpdate(){const e=(e,t,n,i)=>{this.didSingleWorkspaceFork=!0;return Bn.DK({environment:this.environment,store:e,spaceStore:t,spaceViewStore:n,isPrivate:i,context:"public_page_duplicate_single_workspace"})};if(!this.environment.currentUser.isLoggedIn()){const{environment:e}=this;return Bn.nM({currentUserId:void 0,blockId:this.props.blockId}),"public_page"!==this.props.from&&"notion_template_gallery"!==this.props.from||zn.HU(e,{from:this.props.from,is_paid:!1,template_block_id:this.props.blockId,public_page_device_id:this.props.tid}),void C.c4({environment:e,url:p._j.login})}const{currentUserRootStore:t}=Z.default.state;if(t&&t&&!this.didSingleWorkspaceFork){const n=O.G.createChildStore(t,{table:On.iU,id:this.props.blockId});if("eligible"===this.readyToExperimentStatus.state)return void function(e,t,n,i,o){const r=(0,Un.M)({disableExposureLogging:!1}),s=r?"on":"control",{total:a,loaded:l,editable:c}=Vn.o(t);zn.ar(n,{templateBlockId:i,from:o,numOfSpaceViews:a,numOfLoadedSpaceViews:l,numOfEditableSpaceViews:c,group:s}),r&&(ve.Z.setState({open:!0,blockStore:e,spaceStore:void 0,spaceViewStore:void 0,teamStore:void 0}),zn.JJ(n,{templateBlockId:i,from:o,numOfSpaceViews:a,numOfLoadedSpaceViews:l,numOfEditableSpaceViews:c,group:s}),C.c4({environment:n,url:p._j.root,redirect:!0}))}(n,t,this.environment,this.props.blockId,this.props.from);if("waiting"===this.readyToExperimentStatus.state)return;const i=ye.o(t);if(1===i.length){const t=i[0],o=t.getSpaceStore();if(!o)return;e(n,o,t,!0)}else if(this.props.workspaceId&&i.length>1){const t=i.filter((e=>e.pointer.spaceId===this.props.workspaceId)),o=t[0],r=null==o?void 0:o.getSpaceStore();if(!r)return;e(n,r,o,!0)}}}renderComponent(){if("waiting"===this.readyToExperimentStatus.state)return(0,$.jsx)(Yn,{});const{device:e}=this.environment,{currentUserRootStore:t}=Z.default.state;if(!t)return(0,$.jsx)(Yn,{});const{mainEditorCurrentBlockStore:n}=Z.default.state;if(!n)return(0,$.jsx)(Yn,{});if(!n.isDefined())return(0,$.jsx)(Yn,{});const i=[{key:"spaces",render:t=>(0,$.jsx)(Kn.Z,{title:e.isMobile?void 0:(0,$.jsx)(f.FormattedMessage,{id:"forkPageScreen.chooseWorkspaceForDuplication.message",defaultMessage:"Choose a workspace to duplicate into"}),isTitleUppercase:!0,...t}),items:(0,Hn.getSpaceViewMenuItems)(this.environment,n,"eligible"===this.readyToExperimentStatus.state)}];let o;return o=e.isMobile?{menuType:Fn.og.Modal,title:(0,$.jsx)(f.FormattedMessage,{id:"forkPageScreen.chooseWorkspace.message",defaultMessage:"Choose a workspace"}),width:"100vw"}:{menuType:Fn.og.Popup,height:"auto"},(0,$.jsx)(qn.Z,{open:!0,disableAnimation:!0,render:()=>(0,$.jsx)("div",{style:Qn(this.environment),children:(0,$.jsx)(Nn.Z,{...o,children:(0,$.jsx)(Wn.Z,{type:Wn.i.Vertical,sections:i,initialFocus:1})})})})}}Gn.displayName="ForkPageScreen";const $n=Gn;function Qn(e){const{device:t}=e;return{width:"100vw",height:"100vh",paddingLeft:t.isMobile?16:30,paddingRight:t.isMobile?16:30,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}}function Yn(){const e=(0,B.O7)();return(0,$.jsx)(qn.Z,{open:!0,disableAnimation:!0,render:()=>(0,$.jsx)("div",{style:Qn(e),children:(0,$.jsx)(Dn.Z,{style:{width:20,height:20}})})})}var Jn=n(81059),Xn=n(30664),ei=n(36610),ti=n(65556);function ni(){const e=(0,B.O7)();return(0,i.useEffect)((()=>{function t(t){ei.f7(e,{reason:t})}return ti.showConfirmationDialogEventEmitter.addListener(t),()=>{ti.showConfirmationDialogEventEmitter.removeListener(t)}}),[e]),null}var ii=n(82540),oi=n(15145),ri=n(50475),si=n(70096),ai=n(92973),li=n(87420),ci=n(75754),di=n(43250),ui=n(75079),pi=n(85957),hi=n(18245),mi=n(34859),gi=n(4926),fi=n(42330),vi=n(82136),yi=n(88923),bi=n(42057),Si=n(27724),xi=n(41464),ki=n(4827),wi=n(53336),ji=n(26957),Mi=n(69206),Ci=n(31192),Ii=n(78901),Pi=n(3553),Ti=n(55064),Li=n(92996),_i=n(82855),Ai=n(16880),Ei=n(7525),Ri=n(26999);function Zi(e){const{theme:t,isSidePeekOpen:n,borderRadius:i}=e;return{zIndex:n?ce.LI:ce.Bh,background:t.peekModalBackground,borderTopLeftRadius:i??5,borderTopRightRadius:i??5}}function Oi(e){const{environment:t,padding:n,height:i}=e,o=t.device.isMobile?4:n??12;return{height:i??en.R6(t.device.isElectronMac)-1,display:"flex",justifyContent:"space-between",alignItems:"center",paddingLeft:o,paddingRight:o}}var zi=n(73819),Bi=n(81170),Vi=n(24042),Fi=n(91551);const Ui=new(n(61766).Z);var Di=n(98452),Ni=n(99332),Wi=n(24612),qi=n(58493),Ki=n(42853),Hi=n(11302),Gi=n(58239);var $i=n(48779),Qi=n(89728),Yi=n(31278),Ji=n(76798),Xi=n(45653);const eo={display:"flex",alignItems:"center",fontSize:14,minWidth:0};function to(e,t){return e&&e instanceof O.H2&&t&&e.id===t.id}function no(e){const{parentStore:t,prefixText:n}=e,i=(0,B.O7)(),o=(0,V.VK)((()=>(0,ye.B7)(i)),[i]),r=(0,V.VK)((()=>t instanceof O.G&&t.isEmptyPage()),[t]),s=(0,V.VK)((()=>t instanceof O.H2?(0,$i.Wd)(i,t):t.getIcon()),[i,t]),a=(0,V.VK)((()=>t instanceof O.H2?(0,$i.rn)(i,t):void 0),[i,t]),l=(0,V.VK)((()=>{const{currentSpaceStore:e}=Z.default.state;return to(t,e)}),[t]),c=(0,F.yK)((()=>({privatePagesText:{fontWeight:N.Z.fontWeight.medium,marginLeft:4,...N.Z.textOverflowStyle,overflow:"hidden"},icon:{marginRight:4,marginTop:1},title:{fontWeight:N.Z.fontWeight.semibold}})),[]);return(0,$.jsx)($.Fragment,{children:l?(0,$.jsxs)($.Fragment,{children:[n,(0,$.jsx)(Xi.Z,{size:22,avatarShouldShowShadow:!0,userStore:o}),(0,$.jsx)("span",{style:c.privatePagesText,children:(0,$.jsx)(f.FormattedMessage,{defaultMessage:"Private pages",id:"peekMoveToMenu.addTo.privatePages"})})]}):(0,$.jsxs)($.Fragment,{children:[n,(0,$.jsx)(Yi.Z,{disabled:!0,icon:s,isEmptyPage:r,title:a,size:18,style:c.icon}),(0,$.jsx)(Ji.Z,{style:c.title,store:t})]})})}const io=function(e){let{store:t,prefix:n,buttonStyle:o,saveParent:r,pageType:s,forceUntyped:a}=e;const l=(0,F.Fg)(),c=(0,B.O7)(),d=(0,V.VK)((()=>{const e=Z.default.state.mainEditorCurrentBlockStore;return e&&(0,_e.WE)(e)?"home_tab":e&&(0,ye.qG)(e.id)?"aggregated_type":"quick_add"}),[]),u=(0,V.VK)((()=>t.getParentStore()),[t]),p=(0,i.useRef)(null),h=(0,i.useCallback)((e=>function(e,t,n,i,o,r,s,a){e.preventDefault(),t&&Hi.bA({environment:n,blocks:[i],originRect:t.getBoundingClientRect(),moveToContext:r,onAccept:e=>function(e,t,n,i){const{currentSpaceStore:o}=Z.default.state;if(o&&t){let t;!function(e){const{pageType:t,spaceStore:n,currentUserId:i,result:o}=e;(0,Gi.rq)({currentUserId:i,spaceId:n.id,value:o}),t&&(0,Gi.ZT)({currentUserId:i,spaceId:n.id,databaseType:Li.wg[t],parent:o})}({pageType:t||i,spaceStore:o,currentUserId:n.currentUser.id,result:e})}}(e,o,n,s),isAddTo:!0,isDefaultPrivateLocation:oo(i),disableSuccessToast:!0,forceUntyped:a||ro(s)})}(e,p.current,c,t,r,d,s,a)),[p,c,t,r,d,s,a]);if(u&&!(u instanceof O.T5)&&!(u instanceof O.zq)&&!(u instanceof O.Vf)){const e=n?(0,$.jsx)("span",{style:{color:l.mediumTextColor,marginRight:4},children:(0,$.jsx)(f.FormattedMessage,{...n})}):void 0;return(0,$.jsx)(wn.Z,{debugName:"PeekMoveToMenu",capture:!0,onMoveTo:h,children:(0,$.jsx)("div",{style:eo,children:(0,$.jsx)(Cn.ZP,{renderTooltip:()=>(0,$.jsxs)("div",{children:[(0,$.jsx)(f.FormattedMessage,{defaultMessage:"Set the default page or database",id:"peekMoveToMenu.tooltip"}),(0,$.jsx)("br",{}),(0,$.jsx)(jn.Z,{style:{color:l.mediumInvertedTextColor},name:"moveTo"})]}),render:t=>(0,$.jsxs)(Qi.Z,{onClick:h,ref:p,shouldShrink:!0,style:o,...t,children:[(0,$.jsx)(no,{parentStore:u,prefixText:e}),(0,Ki.i)({width:10,marginLeft:4,fill:l.lightTextColor})]})})})})}return null};function oo(e){const t=e.getParentStore(),{currentSpaceStore:n}=Z.default.state;return to(t,n)}function ro(e){return!e||"page"===e}var so=n(25906),ao=n(28311),lo=n(26399),co=n(43377),uo=n(5002),po=n(68626),ho=n(64530),mo=n(52629),go=n(8406),fo=n(5149),vo=n(48543),yo=n(84210),bo=n(33929),So=n(98165),xo=n(52275),ko=n(31945),wo=n(16354),jo=n(53437),Mo=n(49085),Co=n(3418);const Io=165888e7;class Po extends s.Z{constructor(){super(...arguments),this.storeTypes={visible:Mo.default.createClass(!1)},this.timeout=void 0}UNSAFE_willMountOrUpdate(){(function(e){const{device:t}=e;if(t.isPhone)return!1;if(Co.Z.state.openPopups.size>0)return!1;const{currentUserSettingsStore:n}=Z.default.state;if(!n||!n.isReady())return!1;const i=n.getSettings();if(null!=i&&i.signup_time&&(null==i?void 0:i.signup_time)>Io)return!1;if(null!=i&&i.seen_peek_mode_tooltip)return!1;return!0})(this.environment)?(clearTimeout(this.timeout),this.timeout=setTimeout((()=>{this.stores.visible.setState(!0)}),500)):(clearTimeout(this.timeout),this.stores.visible.setState(!1))}renderComponent(){const{origin:e}=this.props,{visible:t}=this.stores,{device:n}=this.environment;return n.isMobile?e:(0,$.jsxs)("div",{style:{position:"relative"},children:[e,(0,$.jsx)(yn.Z,{isVisible:t.state,animationStyle:{opacity:1},enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},render:()=>(0,$.jsx)(Lo,{})})]})}}Po.displayName="PeekModeIntroTooltip";const To=(0,f.injectIntl)(Po);function Lo(){const e=(0,F.Fg)(),t=(0,B.O7)();return(0,$.jsxs)("div",{style:{fontSize:12,color:v.ZP.white,position:"absolute",top:"calc(100% + 12px)",left:"calc(50% - 110px)",background:v.ZP.blue,borderRadius:6,padding:"8px 12px 12px 12px",width:220,boxShadow:e.largeLightBoxShadow,zIndex:99},children:[(0,$.jsx)("div",{style:{position:"absolute",top:-12,left:"calc(50% - 2.5px)",background:v.ZP.blue,width:5,height:5,borderRadius:5,boxShadow:`0 0 0 1.5px ${e.contentBackground}`}}),(0,$.jsx)("div",{style:{position:"absolute",top:-12,left:"calc(50% - 1px)",background:v.ZP.blue,width:2,height:12}}),(0,$.jsx)("div",{style:{width:"90%",fontWeight:500,marginBottom:2},children:(0,$.jsx)(f.FormattedMessage,{defaultMessage:"New! Open pages in side peek",id:"peekModeIntroTooltip.title"})}),(0,$.jsx)("div",{style:{opacity:.8,lineHeight:1.35},children:(0,$.jsx)(f.FormattedMessage,{defaultMessage:"Use Tables, Boards, Lists and Timelines while opening pages on the side for faster workflows. Switch to other peek modes here.",id:"peekModeIntroTooltip.subtitle"})}),(0,$.jsx)(Sn.Z,{icon:Qt.U,style:{position:"absolute",top:4,right:4,opacity:.8},iconStyle:{width:12,fill:v.ZP.white},onClick:()=>function(e){li.Om({environment:e,seen:!0})}(t)})]})}const _o=(0,f.defineMessages)({changeForThisView:{id:"peekTopbar.changePeekOption.changeForThisView",defaultMessage:"Edit view default"}});class Ao extends s.Z{UNSAFE_willMount(){const e=Ro(this.theme),t=yi.default.getPeekMode();e.find((e=>vt.Xy(e.key,t)))||po.log({level:"warning",from:"TopbarPeekModeButton",type:"InvalidSelectedPeekMode",error:(0,mo.Ui)("Selected key is invalid.")})}renderComponent(){const{device:e}=this.environment,{mainEditorCurrentBlockStore:t}=Z.default.state,n=Ro(this.theme),i=yi.default.getPeekMode();return i?(0,$.jsx)(ko.ZP,{popupType:e.isMobile?jo.kQ.SlideUp:jo.kQ.Popup,alignmentToOrigin:ko.vR.Center,placementToOrigin:ko.pO.Bottom,style:{minWidth:190},originGap:0,onClick:()=>function(e){if(!yi.default.state.open)return;const t=yi.default.state.collectionContextStore;t?go.nS({environment:e,collectionContextStore:t,from:"peek_topbar",peek_target_id:yi.default.state.target.id,from_peek_mode:yi.default.state.mode}):ai.v2(e,{from:"peek_topbar",peek_target_id:yi.default.state.target.id,from_peek_mode:yi.default.state.mode})}(this.environment),renderOrigin:e=>(0,$.jsx)(To,{origin:(0,$.jsx)(Cn.ZP,{renderTooltip:()=>(0,$.jsx)($.Fragment,{children:(0,$.jsx)(f.FormattedMessage,{defaultMessage:"Switch peek mode",id:"peekTopbar.openPagesAs.button"})}),render:t=>(0,$.jsx)(Sn.Z,{...e,...t,icon:(0,vo.RO)(i),iconStyle:{fill:this.theme.mediumIconColor}})})}),render:o=>{var r,s,a;let l;l=e.isMobile?{menuType:Fn.og.ActionSheet}:{menuType:Fn.og.Popup,width:220};const c=vt.oA([...n.map(((e,t)=>{const n=e.key,r="full_page"===n?(0,yo.ZP)({store:this.props.store,fullyQualified:!1,pageVisitSource:oi.tY.Expand}):function(e,t){const{mainEditorCurrentBlockStore:n}=Z.default.state,i=So.uJ(t),o=t.isNavigableBlock()?i.slice(1):[...i],r=o.length>0?o[0]:void 0;return(0,cn.mb)({store:t,mainEditorCurrentBlockStore:r instanceof O.G&&!yi.default.state.open?r:n,collectionContextStore:yi.default.state.collectionContextStore,fullyQualified:!1,overridePeekMode:(0,yi.getPeekModeFromCollectionPeekModeFormat)(e)})}(n,this.props.store);return{key:t,render:t=>(0,$.jsx)(wo.Z,{href:r,onClick:()=>{var e;li.Om({environment:this.environment,seen:!0}),ai.UZ(this.environment,{from:"peek_topbar",peek_mode:n,from_peek_mode:i,target_page_id:null===(e=yi.default.peekTarget.state)||void 0===e?void 0:e.id}),o.close()},children:(0,$.jsx)(xo.Z,{...t,disabled:!1,title:e.title,icon:e.icon,caption:e.caption,body:e.body,checkState:vt.Xy(e.key,i)})}),action:()=>{}}}))]),d=yi.default.state.open?yi.default.state.collectionContextStore:void 0,u=yi.default.state.open?yi.default.state.target:void 0,p=t&&t.id===(null==d||null===(r=d.collectionViewBlockStore())||void 0===r?void 0:r.getRecordStoreUIRoot().id),h=(null==d||null===(s=d.collectionStore())||void 0===s?void 0:s.id)===(null==u||null===(a=u.getAssociatedCollectionStore())||void 0===a?void 0:a.id)&&(null==d?void 0:d.permissionScopes.state.canConfigureBlock)&&p;return(0,$.jsx)(Nn.Z,{...l,children:(0,$.jsx)(Wn.Z,{type:Wn.i.Vertical,sections:vt.oA([{key:0,render:e=>(0,$.jsx)(Kn.Z,{enableActionSheetTitle:!0,...e}),items:c},h&&{key:1,render:e=>(0,$.jsx)(Kn.Z,{enableActionSheetTitle:!0,topBorder:!0,...e}),items:[{key:"change_for_view",render:e=>(0,$.jsx)(xo.Z,{...e,disabled:!1,title:bo.default.formatMessage(_o.changeForThisView),icon:(0,ho.y)({width:16,height:16,fill:this.theme.regularIconColor})}),action:e=>{!function(e,t){const n=yi.default.state.open?yi.default.state.collectionContextStore:void 0;n&&(li.Om({environment:e,seen:!0}),yi.default.isCenterPeekOpen()&&t&&t(),fo.r$({collectionContextStore:n,collectionSettingsStore:n.settingsStore}),fo.H4({collectionSettingsStore:n.settingsStore,item:{type:"layout"}}),n.settingsStore.setState({...n.settingsStore.state,openButtonPopup:"peekModeFormat"}))}(this.environment,this.props.onClose),o.close()}}]}]),initialFocus:0})})}}):null}}Ao.displayName="TopbarPeekModeButton";const Eo=Ao;function Ro(e){return["side_peek","center_peek","full_page"].map((t=>({key:t,title:(0,vo.LQ)(t),icon:(0,vo.RO)(t)({width:16,fill:e.mediumTextColor})})))}var Zo=n(58810);const Oo=function(e){const{store:t,shouldShowMoveToMenu:n}=e,o=(0,B.O7)(),r=(0,f.useIntl)(),s=(0,V.VK)((()=>(0,yo.ZP)({store:t,fullyQualified:!1,pageVisitSource:oi.tY.Expand})),[t]),a=(0,F.yK)((e=>({keyboardShortcut:{color:e.mediumInvertedTextColor},iconButtonWrapper:{height:24}})),[]),l=(0,i.useCallback)((()=>{var e,t,i;ai.sx(o,{isNewPage:n,peek_mode:yi.default.state.mode,from:"topbar_button",target_page_id:null===(e=yi.default.peekTarget.state)||void 0===e?void 0:e.id}),ai.$C(o,{peek_mode:yi.default.state.mode,from:"topbar_open_as_page_button",target_page_id:null===(t=yi.default.peekTarget.state)||void 0===t?void 0:t.id,target_parent_id:null===(i=yi.default.peekTarget.state)||void 0===i?void 0:i.getParentId()})}),[o,n]);return(0,$.jsx)(Cn.ZP,{renderTooltip:()=>(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)("div",{children:(0,$.jsx)(f.FormattedMessage,{defaultMessage:"Open in full page",id:"peekTopbar.navigateToPage.tooltip"})}),(0,$.jsx)(jn.Z,{style:a.keyboardShortcut,name:"commandEnter"})]}),render:e=>(0,$.jsx)("div",{style:a.iconButtonWrapper,children:(0,$.jsx)(Sn.Z,{...e,icon:Zo.Z,iconStyle:{width:16,height:16},href:s,onClick:l,ariaLabel:r.formatMessage({id:"peekTopbar.navigateToPage.tooltip",defaultMessage:"Open in full page"})})})})};var zo=n(86467),Bo=n(7715),Vo=n(94107);const Fo=(0,f.defineMessages)({moveToPrefixText:{id:"peekMoveToMenu.moveTo.moveTo",defaultMessage:"Move to"},addToPrefixText:{id:"peekMoveToMenu.addTo.addTo",defaultMessage:"Add to"},closeButton:{defaultMessage:"Close",id:"peekTopbar.close.button"},previousPageTooltip:{defaultMessage:"Previous page",id:"peekTopbar.peekNavUpArrow.tooltip"},nextPageTooltip:{defaultMessage:"Next page",id:"peekTopbar.peekNavDownArrow.tooltip"}});const Uo=function(e){let{store:t,shouldShowMoveToMenu:n,onClose:i,spaceStore:o,spaceViewStore:s,pageVisitStore:a,presenceStore:l}=e;const c=(0,F.Fg)(),d=(0,B.O7)(),u=(0,V.VK)((()=>yi.default.isSidePeekOpen()),[]),p=(0,V.VK)((()=>Fi.Z.state.banners),[]),{isShowingTabBar:h,isUnifiedTitleBarEnabled:m}=(0,V.VK)((()=>{var e;return{isShowingTabBar:Boolean(Vi.Z.state.isShowingTabBar),isUnifiedTitleBarEnabled:Boolean(null===(e=Vi.Z.state.preferences)||void 0===e?void 0:e.isUnifiedTitleBarEnabled)}}),[]),g=m?d.device.isElectron&&!h&&u:d.device.isElectronMac&&!h&&u;return(0,$.jsx)(Pi.Z,{store:t,disableRectangularSelection:!0,disableEditNearestBlock:!0,isPeekRenderer:!0,render:e=>{let{selectableEvents:h}=e;return(0,$.jsxs)("div",{...h,style:Zi({theme:c,isSidePeekOpen:u}),className:g?di.pMC:void 0,children:[(0,$.jsxs)("div",{style:Oi({environment:d}),children:[(0,$.jsxs)("div",{style:{display:"grid",gridAutoFlow:"column",gridColumnGap:2,alignItems:"center"},children:[(0,$.jsx)(Wo,{onClose:i}),(0,$.jsx)(Oo,{store:t,shouldShowMoveToMenu:n}),yi.default.state.open&&(0,$.jsx)(Eo,{store:t,onClose:i}),(0,$.jsx)(qo,{shouldShowMoveToMenu:n}),(0,$.jsx)(Do,{store:t,shouldShowMoveToMenu:n}),(0,$.jsx)(qi.Z,{store:t,isMobile:!1,buttonStyle:{...!n&&{marginLeft:12}}})]}),(0,$.jsx)("div",{style:{flexGrow:1,flexShrink:1}}),(0,$.jsx)(No,{store:t,spaceStore:o,spaceViewStore:s,pageVisitStore:a,presenceStore:l})]}),(0,$.jsx)(r.LazyBannersRenderer,{banners:p,isMobile:!1,isInPeekRenderer:!0})]})}})};function Do(e){let{store:t,shouldShowMoveToMenu:n}=e;const{open:i,saveParent:o,pageVisitSource:r,collectionContextStore:s}=(0,V.VK)((()=>({open:yi.default.state.open,saveParent:!!yi.default.state.open&&yi.default.state.saveParent,pageVisitSource:yi.default.state.open?yi.default.state.pageVisitSource:void 0,collectionContextStore:yi.default.state.collectionContextStore})),[]),a=(0,V.VK)((()=>{const e=t.getAssociatedCollectionStore();return(null==e?void 0:e.getDatabaseType())===Li.iS?"tasks":void 0}),[t]),l=(0,V.VK)((()=>"collectionTypedView"===(null==s?void 0:s.contextType)),[s]);return i&&n?(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(uo.Z,{}),(0,$.jsx)(io,{store:t,saveParent:o,prefix:l?Fo.moveToPrefixText:Fo.addToPrefixText,pageType:a,forceUntyped:r===oi.tY.SidebarQuickAdd})]}):null}function No(e){let{store:t,spaceStore:n,spaceViewStore:i,pageVisitStore:o,presenceStore:s}=e;const a=(0,B.O7)(),{device:l}=a,c=(0,V.VK)((()=>(0,we.IJ)(a,t)),[a,t]),d=(0,V.VK)((()=>ye.qG(t.id)),[t]),u=(0,V.VK)((()=>(0,_e.Kj)(t.id)),[t]),p=!l.isMobile&&n&&i&&!c&&!u,h=(0,V.VK)((()=>Boolean(n&&!n.canEdit())),[n]),m=(0,V.VK)((()=>t.canEdit()),[t]),g=(0,V.VK)((()=>t.isRestricted()),[t]),f=(0,V.VK)((()=>!l.isMobile&&Pt.default.checkGate("page_layouts")),[l.isMobile]),v=n&&i&&!c&&(0,so.UP)({isSpaceGuest:h,canEditPage:m})&&!u,y=(0,zi.cR)(t);return(0,$.jsxs)("div",{style:{display:"flex",alignItems:"stretch",flexGrow:0,flexShrink:0,zIndex:1},children:[g&&(0,$.jsx)(Bo.Z,{style:{marginRight:14},onClick:()=>{Ni.Z.setState({open:!0})}}),m&&(0,$.jsx)(zo.Z,{rootStore:t,pageVisitStore:o,presenceStore:s}),v&&(0,$.jsx)(r.LazyTopbarShareButton,{store:t,buttonPopupStore:Ni.Z}),p&&(0,$.jsx)(ao.Z,{blockStore:t,spaceStore:n,buttonPopupStore:Ui}),p&&(0,$.jsx)(Vo.Z,{blockStore:t,spaceStore:n,buttonPopupStore:Wi.Z}),f&&(0,$.jsx)(co.b,{blockStore:t}),n&&i&&!c&&!y&&(0,$.jsx)(lo.Z,{store:t,spaceViewStore:i}),d&&(0,$.jsx)(Bi.Z,{}),p&&(0,$.jsx)(r.LazyTopbarMoreButton,{store:t,buttonPopupStore:Di.Z})]})}function Wo(e){let{onClose:t}=e;const n=(0,f.useIntl)(),i=(0,F.Fg)();return(0,V.VK)((()=>yi.default.isSidePeekOpen()),[])?(0,$.jsx)(Cn.ZP,{renderTooltip:()=>(0,$.jsxs)("div",{children:[n.formatMessage(Fo.closeButton),(0,$.jsx)("br",{}),(0,$.jsx)(jn.Z,{style:{color:i.mediumInvertedTextColor},name:"esc"})]}),render:e=>(0,$.jsx)(Sn.Z,{...e,ariaLabel:n.formatMessage(Fo.closeButton),icon:Ei.t,iconStyle:{width:16,height:16},onClick:()=>t("close_button")})}):null}function qo(e){let{shouldShowMoveToMenu:t}=e;const n=(0,f.useIntl)(),i=(0,F.Fg)(),o=(0,V.VK)((()=>yi.default.state),[]),{resultsStore:r}=o,s=(0,V.VK)((()=>null==r?void 0:r.getState()),[r]);if(!o.open)return null;if(t)return null;const a=o.target.id;return s&&s.length>0&&s.some((e=>e.id===a))?(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(uo.Z,{}),(0,$.jsx)(Cn.ZP,{renderTooltip:()=>(0,$.jsxs)("div",{children:[n.formatMessage(Fo.previousPageTooltip),(0,$.jsx)("br",{}),(0,$.jsx)(jn.Z,{style:{color:i.mediumInvertedTextColor},name:"peekUp"})]}),render:e=>(0,$.jsx)(Sn.Z,{...e,ariaLabel:n.formatMessage(Fo.previousPageTooltip),disabled:a===s[0].id,icon:Ai.R,onClick:()=>Ri.Qk(),iconStyle:{fill:i.mediumIconColor}})}),(0,$.jsx)(Cn.ZP,{renderTooltip:()=>(0,$.jsxs)("div",{children:[n.formatMessage(Fo.nextPageTooltip),(0,$.jsx)("br",{}),(0,$.jsx)(jn.Z,{style:{color:i.mediumInvertedTextColor},name:"peekDown"})]}),render:e=>(0,$.jsx)(Sn.Z,{...e,ariaLabel:n.formatMessage(Fo.nextPageTooltip),disabled:a===s[s.length-1].id,icon:_i.E,onClick:()=>Ri.OW(),iconStyle:{fill:i.mediumIconColor}})})]}):null}function Ko(){const{open:e}=(0,V.VK)((()=>yi.default.state),[]),t=(0,V.VK)((()=>gi.Z.state),[]),n=(0,F.yK)((e=>({containerStyles:{position:"fixed",top:0,right:0,bottom:0,left:0,zIndex:ce.Nn,background:e.overlaySmokescreen},contentStyles:{...Jo(e),top:yi.PeekModeOuterPadding,left:yi.PeekModeOuterPadding,right:yi.PeekModeOuterPadding,marginRight:"auto",height:`calc(100% - ${yi.PeekModeOuterPadding}px*2)`,maxWidth:yi.CenterPeekModeOuterWidth+t,borderRadius:4}})),[t]);return(0,$.jsx)(ki.Z,{open:e,children:(0,$.jsx)($o,{enableCaptureClick:!0,priority:void 0,showResizer:!1,styles:n})})}function Ho(){const e=(0,B.O7)(),t=(0,V.VK)((()=>yi.default.state),[]),n=(0,V.VK)((()=>yi.default.getSidePeekWidth(e.WindowSizeStore.state.width)),[e]),i=(0,F.yK)((e=>({containerStyles:{position:"fixed",top:0,right:0,bottom:0,translateX:n,width:n,zIndex:ce.YO},contentStyles:{...Jo(e),top:0,right:0,width:"100%",height:"100%",borderRadius:0}})),[n]);return(0,$.jsx)(yn.Z,{isVisible:!0,useCompositeLayer:!0,animationStyle:{translateX:t.open&&!t.isClosing?0:n},render:()=>(0,$.jsx)($o,{enableCaptureClick:!1,priority:-1,showResizer:!0,styles:i}),enterAnimationStyle:{translateX:t.open?0:n},onAnimationEnd:()=>{t.open&&t.isClosing?(yi.default.setState({...t,isClosing:!1}),li.ME()):t.open&&t.isOpening&&yi.default.setState({...t,isOpening:!1})}})}function Go(){const e=(0,B.O7)(),t=(0,V.VK)((()=>yi.default.state),[]),{currentSpaceStore:n,currentSpaceViewStore:i}=(0,V.VK)((()=>Z.default.state),[]),o=(0,V.VK)((()=>{var e;return!!t.open&&(t.showMoveTo||"collectionTypedView"===(null===(e=t.collectionContextStore)||void 0===e?void 0:e.contextType))}),[t]);return t.open?(0,$.jsx)(Uo,{store:t.target,spaceStore:n,spaceViewStore:i,pageVisitStore:t.pageVisitStore,presenceStore:t.presenceStore,shouldShowMoveToMenu:o,onClose:t=>{ir(e,t)}}):null}function $o(e){const{priority:t}=e,n=(0,B.O7)(),o=(0,V.VK)((()=>yi.default.state),[]),{shouldShowFrame:r}=(0,V.VK)((()=>(0,ye.h1)(n)),[n]),s=(0,V.VK)((()=>pi.Tx()),[]),a=(0,V.VK)((()=>o.open&&0===Si.default.state.stores.length&&!Si.default.state.pivot&&"editing"!==vn.default.state.mode&&!fi.ZP.state.isOpen),[o.open]),l=(0,i.useCallback)((()=>{or(n)}),[n]),c=(0,i.useCallback)((()=>{!function(e){yi.default.peekTarget.state&&(ci._c({environment:e,store:yi.default.peekTarget.state,pageVisitSource:oi.tY.Expand}),ai.sx(e,{isNewPage:yi.default.state.open&&yi.default.state.showMoveTo,peek_mode:yi.default.state.mode,from:"command_enter",target_page_id:yi.default.peekTarget.state.id}),ai.$C(e,{peek_mode:yi.default.state.mode,from:"command_enter",target_page_id:yi.default.peekTarget.state.id,target_parent_id:yi.default.peekTarget.state.getParentId()}))}(n)}),[n]);return r?o.open?(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(xi.Z,{debugName:"PeekRenderer",priority:t,capture:s}),(0,$.jsx)(wn.Z,{debugName:"PeekRenderer",capture:a,onEsc:l,onCommandEnter:c,children:(0,$.jsx)(Qo,{...e})},o.target.id)]}):(0,$.jsx)(Qo,{...e}):null}function Qo(e){const{enableCaptureClick:t,bottomBar:n,showResizer:o,styles:s}=e,a=(0,i.useCallback)((e=>{pn.Z.PeekViewScroller=e??void 0}),[]),l=(0,f.useIntl)(),c=(0,B.O7)(),d=(0,V.VK)((()=>yi.default.state),[]),u=(0,V.SI)((()=>d.open?fn.Z.getMode(c,d.target):fn.m.disabled),[c,d]),p=(0,V.VK)((()=>{if(!d.open)return;const{currentSpaceStore:e,currentSpaceViewStore:t}=Z.default.state;return{pageStore:d.target,spaceStore:e,spaceViewStore:t,presenceStore:d.presenceStore,pageVisitStore:d.pageVisitStore,publicEditModeStore:u}}),[d,u]),h=(0,i.useCallback)((()=>{or(c)}),[c]),m=(0,i.useCallback)((e=>{let{startTime:t,endTime:n}=e;const i=d.open?cn.fm(d.target):void 0;hi.default.measure({metricName:"collections.max_scroll_lag_in_session",startTime:t,endTime:n},{environment:c,data:ui.vS(i)})}),[c,d]),g=(0,i.useCallback)((()=>{!function(e){ir(e,"empty_space_click")}(c)}),[c]);return(0,i.useEffect)((()=>{d.open&&d.mode===si.l?k.setOverlay(!0):k.setOverlay(!1)}),[d.open,d.mode]),(0,$.jsx)(ii.Mi,{value:p,children:(0,$.jsx)("div",{role:"region","aria-label":l.formatMessage({id:"peekRenderer.ariaLabel",defaultMessage:"Side Peek"}),"aria-hidden":!d.open||void 0,style:s.containerStyles,className:di.p1Q,children:d.open&&(0,$.jsxs)($.Fragment,{children:[t&&(0,$.jsx)("div",{style:{width:"100%",height:"100%"},onClick:g}),(0,$.jsxs)("div",{style:s.contentStyles,children:[o&&(0,$.jsx)(Ti.Z,{type:"peek"}),(0,$.jsx)(Go,{}),(0,$.jsx)(Pi.Z,{store:d.target,isDefaultContainer:!0,droppable:!0,isPeekRenderer:!0,render:e=>{let{selectableEvents:t,selectableHoverMenuOverlay:n}=e;return(0,$.jsx)(i.Suspense,{fallback:(0,$.jsx)(ji.Z,{peekMode:yi.default.getPeekMode(),isVisible:!0,store:d.target}),children:(0,$.jsx)(Mi.Z,{pageStore:d.target,pageVisitStore:d.pageVisitStore,initialChunkSize:25,incrementChunkSize:25,store:d.loadingContainerStore,render:e=>{let{ready:o,initialRequestCompleted:s,endOfResultsReached:l,isCollectionInPage:p}=e;return(0,$.jsxs)(i.Fragment,{children:[(0,$.jsxs)(wi.Z,{ref:a,onScrollLagMeasure:p?m:void 0,preventType:o?on.Q7(c):mi.Z.All,type:mi.Z.Y,style:o?Xo:er,store:bi.Z,...t,children:[n,(0,xe.GD)(u.state)&&(0,$.jsx)(pe.GC,{scrollerStore:bi.Z}),(0,$.jsx)(fe.vo,{scrollerStore:bi.Z}),s&&(0,$.jsxs)(i.Fragment,{children:[(0,$.jsx)(r.LazyScrollableSitesBannerContainer,{blockStore:d.target}),(0,$.jsx)(Ci.ZP,{context:vi.S.PeekView,store:d.target,onTitleEsc:h,forceSelectTitleOnMount:!0,paddingBottom:80,styleOverrides:Yo,disabled:!d.open||d.isClosing}),(0,$.jsx)(Ii.Z,{pageVisitStore:d.pageVisitStore,presenceStore:d.presenceStore,isPeekView:!0})]}),o&&!l&&(0,$.jsx)(Dn.Z,{style:nr})]}),(0,$.jsx)(ji.Z,{peekMode:yi.default.getPeekMode(),isVisible:!o,store:d.target})]})}})})}},d.target.id),n]})]})})})}const Yo={pageCoverHeight:"20vh"};function Jo(e){return{flexDirection:"column",position:"absolute",display:"flex",marginLeft:"auto",background:e.peekModalBackground,boxShadow:e.largeLightBoxShadow}}const Xo={display:"flex",flexDirection:"column",flexGrow:1,position:"relative",transform:"translateZ(0)"},er={...Xo,opacity:0,pointerEvents:"none",height:0},tr="1.375em",nr={zIndex:1,opacity:.5,width:tr,height:tr,marginTop:0,marginBottom:24,marginLeft:"auto",marginRight:"auto"};function ir(e,t){li.xv(e,t)}function or(e){ir(e,"esc")}const rr=function(){const e=(0,B.O7)(),t=(0,V.VK)((()=>{const e=yi.default.state.open?yi.default.state.target:void 0;return null==e?void 0:e.getSystemBlockTypeStore().getValue()}),[]),n=(0,i.useCallback)((()=>{yi.default.state.open&&yi.default.isSidePeekOpen()&&(Re.toggleLeftSidebarByWindowSize(e),yi.default.setState({...yi.default.state,isOpening:!1}))}),[e]);switch((0,i.useEffect)((()=>(e.WindowSizeStore.addListener(n),()=>e.WindowSizeStore.removeListener(n))),[e.WindowSizeStore,n]),(0,i.useEffect)((()=>{(0,ri.u7)(t)&&li.xv(e,"invalid_peek_page")}),[e,t]),(0,V.VK)((()=>yi.default.getPeekMode()),[])){case si.l:return(0,$.jsx)(Ko,{});case si.R:return(0,$.jsx)(Ho,{})}};var sr=n(20993),ar=n(90965);function lr(e){let{}=e;const t=(0,V.VK)((()=>Z.default.state.currentSpaceStore),[]),n=(0,V.VK)((()=>{var e;if(!t)return;const n=null===(e=t.getSettings())||void 0===e?void 0:e.space_request;return(0,ar.DI)(n)?n:void 0}),[t]);return n?(0,$.jsx)(r.LazyTransferWorkspaceModal,{workspaceTransfer:n}):null}class cr extends s.Z{constructor(){super(...arguments),this.appRenderState=this.createComputedStore((()=>ye.h1(this.environment))),this.showHelpButtonStore=this.createComputedStore((()=>{if(!this.environment.currentUser.isLoggedIn())return!1;if(this.environment.device.isMobile)return!1;const{mainEditorCurrentBlockStore:e}=Z.default.state;return!!e&&(!(0,we.IJ)(this.environment,e)&&(!this.shouldIncludeAssistantButton.state&&(!this.isPageLayoutEditorOpen.state&&!this.shouldShowAssistantUpsellButton.state)))})),this.isFullPageAssistantChatEnabled=this.createComputedStore((()=>Ne.Z.isFullPageAssistantChatEnabled(this.environment.device))),this.shouldIncludeAssistantButton=this.createComputedStore((()=>{const{device:e}=this.environment,{RouterStore:t}=this.environment,{route:n}=t.state;return"chat"!==n.name&&(!this.isPageLayoutEditorOpen.state&&Ne.Z.shouldShowAssistantInCorner(e))})),this.shouldShowAssistantEphemeralViewModal=this.createComputedStore((()=>{const{device:e}=this.environment;return!e.isPhone&&Ne.Z.isEphemeralViewDatabaseQueryingEnabled()})),this.shouldShowAssistantUpsellButton=this.createComputedStore((()=>{var e;const{inAppCalloutStore:t,currentUserSettingsStore:n}=Z.default.state;if(!t.canShow("ai_add_on_upsell"))return!1;const{device:i}=this.environment,{RouterStore:o}=this.environment,{route:r}=o.state;if("chat"===r.name)return!1;const s=(null===(e=st.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];if((0,le.de)(s))return!1;if(!n)return!1;if(void 0!==n.getSettingsStore().getKeyStore("ai_qna_upsell_dismissed_at").getValue())return!1;if(Number((0,Se.e2)(n))<=2)return!1;const a=Ue.Z.state;if(!a.loaded)return!1;const l=a.isOnWaitlist&&(0,ae.zz)(a.spaceRole),c=!a.isOnWaitlist&&(0,ae.Jy)(a.spaceRole);return!(!l&&!c||!Ne.Z.shouldShowAssistantUpsellInCorner(i))})),this.isPageLayoutEditorOpen=this.createComputedStore((()=>Le.Z.getState().isOpen&&(0,Ce.fastCheckGate)("page_layouts")))}UNSAFE_willMount(){ye.rq()}didMount(){var e;null!==(e=this.environment.mobileNative)&&void 0!==e&&e.api.appComponentMountState&&this.environment.mobileNative.api.appComponentMountState(!0)}willUnmount(){var e;null!==(e=this.environment.mobileNative)&&void 0!==e&&e.api.appComponentMountState&&this.environment.mobileNative.api.appComponentMountState(!1)}renderComponent(){const{isElectronMac:e,isMobile:t}=this.environment.device,{RouterStore:n}=this.environment,{route:i}=n.state,{mainEditorCurrentBlockStore:o,currentSpaceStore:s,currentUserRootStore:a,currentCollectionViewStore:l}=Z.default.state,{publicPageData:c}=De.Z.state,d=this.environment.currentUser.isLoggedIn(),h=Oe.sidebarOpenStore.state,m=(0,Ve.in)(this.environment),{state:{shouldShowSidebar:g,shouldShowFrame:f,shouldShowError:v,shouldRedirectFromHome:b}}=this.appRenderState,S="page"===i.name&&i.shouldDuplicate&&o&&(0,we.S4)(o),x="page"===i.name&&o&&ve.Z.state.open&&(0,we.S4)(ve.Z.state.blockStore),k=!d&&"modal"===i.name&&(i.templateGalleryItem||i.projectManagementLaunch),w="page"===i.name&&i.workspaceId?i.workspaceId:void 0,j=(0,u.wO)(i)&&a||"nativeTab"===i.name&&a||"quickSearch"===i.name&&a||a||o,M="nativeTab"===i.name&&"search"===i.tab||"quickSearch"===i.name,I=this.isFullPageAssistantChatEnabled.state&&"chat"===i.name,P="quickSearch"===i.name,T="nativeTab"===i.name,L=(0,Fe.Y)("supportsNativeHome"),_=se("production",this.environment.device)||!(0,Fe.Y)("supportsNativeSearch"),A=(0,Te.H7)(this.environment),E=(0,be.VI)(this.environment),R=(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(r.LazySidebarCreateTeamModal,{}),(0,$.jsx)(r.LazySidebarTeamModal,{}),(0,$.jsx)(r.LazyCreateTeamFromPageConfirmModal,{}),(0,$.jsx)(r.LazyConfirmPrivilegedActionModal,{})]});de.wk({environment:this.environment});const O=st.subscriptionDataStoreInstance.state;if(k){const{environment:e}=this;return i.projectManagementLaunch?ue.j({currentUserId:void 0,params:{tg:"gallery"}}):i.templateGalleryItem&&ue.j({currentUserId:void 0,params:{tg:i.templateGalleryItem}}),void C.c4({environment:e,url:p._j.login})}return P?(0,$.jsxs)(Ct.Z,{style:pr(this.environment,this.theme),children:[j&&!v&&_&&(0,$.jsx)(r.LazySearch,{parentStore:j,renderAsPage:!0,renderId:(0,y.ZP)(),quickSearchMode:!0}),"rendered"===Z.default.state.renderPhase&&(0,$.jsx)(r.LazyAppComponents,{})]}):(0,$.jsxs)(Ct.Z,{style:pr(this.environment,this.theme),children:[g&&!t&&(0,$.jsx)(dr,{isElectronMac:e,isExpanded:m}),g&&t&&!L&&(0,$.jsx)(r.LazySidebarMobile,{}),g&&t&&L&&(0,$.jsx)(r.LazyTopLevelMobileComponents,{}),g&&(A||E)&&(0,$.jsx)(r.LazySecondarySidebar,{}),(0,$.jsx)(Mt,{}),(0,$.jsx)(ie.R,{}),"workspaceSetup"===i.name&&(0,$.jsx)(r.LazyAppsSetup,{}),o&&f&&(this.isPageLayoutEditorOpen.getState()?(0,$.jsx)(r.LazyPageLayoutEditor,{}):(0,$.jsx)(Jn.Z,{routerState:this.props.routerState,store:o,collectionViewStore:l})),I&&"chat"===i.name&&(0,$.jsx)(me.PS,{}),S?(0,$.jsx)($n,{blockId:i.blockId,workspaceId:w,tid:i.tid,from:i.from}):x&&(0,$.jsx)(r.LazyForkPageModal,{}),(v||b)&&c&&!S&&!x&&(0,$.jsx)(r.LazyPageError,{route:this.props.routerState.route,publicPageData:c,shouldRedirectFromHome:b}),g&&!(0,Ve.Jr)(this.environment)&&h&&(0,$.jsx)(mr,{}),(0,$.jsx)(_t,{}),this.showHelpButtonStore.state&&(0,$.jsx)(Xn.Z,{}),this.shouldIncludeAssistantButton.state&&(0,$.jsx)(me.eC,{}),(0,$.jsx)(fe.at,{}),this.shouldIncludeAssistantButton.state?(0,$.jsx)(me.Q,{}):this.shouldShowAssistantUpsellButton.state?(0,$.jsx)(me.F$,{}):void 0,this.shouldShowAssistantEphemeralViewModal.state&&(0,$.jsx)(me.DO,{}),o&&(0,$.jsx)(In,{pageStore:o,environment:this.environment}),(0,xe.GD)(void 0)&&(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(he.u7,{}),(0,$.jsx)(pe.oF,{})]}),(0,ke.u)(this.environment)&&(0,$.jsx)(Ut,{}),!t&&"nativeTab"!==this.props.routerState.route.name&&"workspaceSetup"!==this.props.routerState.route.name&&(0,$.jsx)(rr,{}),"rendered"===Z.default.state.renderPhase&&(0,$.jsxs)($.Fragment,{children:[d&&(0,$.jsxs)($.Fragment,{children:[R,(0,$.jsx)(Me,{}),(0,$.jsx)(Ie,{}),(0,$.jsx)(r.LazyCustomizePageMenuRenderer,{}),(0,$.jsx)(r.LazyTopbarPageAnalyticsOptOutMenu,{}),(0,$.jsx)(r.LazyImportModal,{}),(0,$.jsx)(r.LazyExportModal,{}),(0,$.jsx)(r.LazyImportIntoNewPageModal,{}),(0,$.jsx)(r.LazyPageTemplateModal,{}),(0,$.jsx)(r.LazyTemplateGalleryModal,{}),(0,$.jsx)(r.LazyGoogleAuthPromptModal,{}),(0,$.jsx)(r.LazyStudentNotEligibleModal,{}),(0,$.jsx)(r.LazyTypedDBMigrationModal,{}),(0,$.jsx)(r.LazyContactModal,{}),(0,$.jsx)(r.LazyCookieModal,{}),rt.Z.state.open&&(0,$.jsx)(r.LazyContactSalesModal,{...rt.Z.state}),We.Z.state.open&&(0,$.jsx)(r.LazyConfirmOverwriteModal,{...We.Z.state}),Ee.Z.state.open&&(0,$.jsx)(r.LazyTipsInAppModal,{...Ee.Z.state}),(0,$.jsx)(r.LazyConfigureIntegrationModal,{}),(0,$.jsx)(r.LazyConnectOAuthIntegrationModal,{}),s&&O&&qe.Z.state.open&&(0,$.jsx)(r.LazySpaceSubscriptionUpgradeModal,{data:O,spaceStore:s}),s&&O&&ot.Z.state.open&&(0,$.jsx)(r.LazyClaimAndUpgradeModal,{spaceStore:s,data:O}),s&&O&&(0,$.jsx)(r.LazySpaceSubscriptionUpdateModal,{data:O}),s&&O&&(0,$.jsx)(r.LazyAddOnUpgradeModal,{data:O}),s?(0,$.jsx)(r.LazySubscriptionDebugCommands,{}):null,f&&(0,$.jsx)(r.LazyOpenInDesktopAppPopup,{}),f&&(0,$.jsx)(r.LazyWikiPromoPopup,{}),f&&(0,$.jsx)(r.LazyAddOnDiscountPopup,{}),f&&(0,$.jsx)(r.LazyNotionCalendarLaunchModal,{}),f&&(0,$.jsx)(r.LazyAiQnaIntroModal,{}),f&&(0,$.jsx)(r.LazyAiQnaWaitlistModal,{}),f&&(0,$.jsx)(r.LazyEnterpriseLaunchModal,{}),f&&(0,$.jsx)(r.LazyJiraSyncTeamSpaceModal,{})]}),(0,$.jsx)(r.LazyAutomationModal,{}),(0,$.jsx)(r.LazyReportPageModal,{}),j&&!v&&_&&(0,$.jsx)(r.LazySearch,{parentStore:j,renderAsPage:M,renderId:M?(0,y.ZP)():void 0,quickSearchMode:!1}),T&&(0,$.jsx)(r.LazyMobileNativeFullPageComponents,{route:i}),(0,$.jsx)(r.LazyForkPagePopup,{}),void 0,(0,$.jsx)(lr,{}),void 0]}),(0,$.jsx)(Rt.Z,{}),"rendered"===Z.default.state.renderPhase&&(0,$.jsx)(Et,{}),"rendered"===Z.default.state.renderPhase&&(0,$.jsx)(r.LazyAppComponents,{}),(0,$.jsx)(Ot,{}),g&&!t&&o&&(0,$.jsx)(Pe.$H,{currentBlockStore:o,isElectronMac:e}),(0,$.jsx)(r.LazyAdminModeBannerListener,{}),(0,$.jsx)(tt.Z,{}),(0,$.jsx)(nt.Z,{}),(0,$.jsx)(it.Z,{}),(0,$.jsx)(sr.Z,{subscriptionDataStore:st.subscriptionDataStoreInstance}),(0,$.jsx)(et,{}),(0,$.jsx)(Ge,{}),(0,$.jsx)(ge.j,{}),(0,$.jsx)(ht,{}),(0,$.jsx)(ni,{})]})}}function dr(e){let{isElectronMac:t,isExpanded:n}=e;const o=(0,i.useCallback)((()=>(0,$.jsx)(ze,{})),[]);return(0,$.jsx)(r.LazySidebarComponent,{isElectronMac:t,isExpanded:n,renderLoading:o})}cr.displayName="App";const ur=cr;function pr(e,t){const{mainEditorCurrentBlockStore:n}=Z.default.state,i=(0,_e.WE)(n),o=e.device.isPhone;return{width:"100vw",height:"100%",position:"relative",display:"flex",flex:1,background:i?(0,Ae.$1)({theme:t,isPhone:o}):t.contentBackground}}function hr(){Re.close()}function mr(){const e=(0,B.O7)(),t=(0,V.VK)((()=>function(e){return{position:"absolute",top:0,left:(0,Ve.qG)(e),right:0,bottom:0,zIndex:ce.l6}}(e)),[e]);return(0,$.jsx)("div",{style:t,onClick:hr})}var gr=n(3403);var fr=n(40754);function vr(e){let{payload:t}=e;const n=(0,B.O7)(),[o,r]=(0,i.useState)(t?{type:"unconfirmed"}:{type:"error"}),s=(0,i.useCallback)((async()=>{if(!t)return void r({type:"error"});r({type:"loading"});const e=await async function(e){let{environment:t,payload:n}=e;const i=await Ye.unsubscribeFromEmails(t,{payload:n});return"success"===i.type?{type:"success",spaceName:i.data.spaceName}:{type:"error"}}({environment:n,payload:t});r("error"===e.type?{type:"error"}:{type:"confirmed",spaceName:e.spaceName})}),[n,t]),a=(0,F.yK)((()=>({confirmUnsubscribeDescription:{marginBottom:10}})),[]);switch(o.type){case"loading":return(0,$.jsx)(fr.Z,{children:(0,$.jsx)(f.FormattedMessage,{defaultMessage:"Loading…",id:"confirmUnsubscribePage.loadingMessage"})});case"unconfirmed":return(0,$.jsxs)(fr.Z,{children:[(0,$.jsx)("div",{style:a.confirmUnsubscribeDescription,children:(0,$.jsx)(f.FormattedMessage,{defaultMessage:"Are you sure you want to unsubscribe from this list?",id:"unsubscribeFromEmails.workspace.confirmUnsubscribeDescription"})}),(0,$.jsx)(K.Z,{isLarge:!0,onClick:s,analyticsName:"unsubscribe_confirm",children:(0,$.jsx)(f.FormattedMessage,{id:"confirmUnsubscribePage.confirmButton",defaultMessage:"Unsubscribe"})})]});case"confirmed":return(0,$.jsx)(fr.Z,{children:(0,$.jsx)(f.FormattedMessage,{defaultMessage:"You have successfully unsubscribed from emails for {workspaceName}",values:{workspaceName:(0,$.jsx)("b",{children:o.spaceName})},id:"unsubscribeFromEmails.workspace.message"})});case"error":return(0,$.jsx)(fr.Z,{children:(0,$.jsx)(f.FormattedMessage,{id:"confirmUnsubscribePage.errorMessage",defaultMessage:"Could not unsubscribe."})});default:(0,tn.t1)(o)}}n(82801);var yr=n(32441);const br=(0,f.defineMessages)({pageTitle:{id:"desktopEmailConfirmPage.title",defaultMessage:"Please check your email to confirm"},pageCaption:{id:"desktopEmailConfirmPage.subtitle",defaultMessage:"Almost there!"},pageDescription1:{id:"desktopEmailConfirmPage.description1",defaultMessage:"Please check your email and click the link to confirm."},pageDescription2:{id:"desktopEmailConfirmPage.description2",defaultMessage:"Once confirmed, you'll be able to return to the desktop app to complete signup."},checkYourGmail:{id:"desktopEmailConfirmPage.button.checkYourGmail",defaultMessage:"Check your Gmail inbox"}});function Sr(){return(0,$.jsxs)("svg",{style:{display:"block",height:42},viewBox:"0 0 87 30",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,$.jsx)("path",{d:"M1.805 1.294l16.6-1.226c2.039-.175 2.563-.057 3.845.875l5.299 3.733c.874.642 1.165.817 1.165 1.516v20.473c0 1.283-.466 2.042-2.097 2.158L7.34 29.99c-1.224.058-1.807-.117-2.448-.934L.99 23.982c-.7-.934-.99-1.633-.99-2.45V3.334c0-1.049.466-1.924 1.805-2.04z",fill:"#fff"}),(0,$.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.405.068l-16.6 1.226C.466 1.41 0 2.285 0 3.334v18.198c0 .817.29 1.516.99 2.45l3.902 5.074c.641.817 1.224.992 2.448.934l19.277-1.167c1.63-.116 2.097-.875 2.097-2.158V6.192c0-.663-.262-.854-1.033-1.42a85.473 85.473 0 01-.133-.096L22.25.943c-1.282-.932-1.806-1.05-3.845-.875zM7.776 5.857c-1.574.106-1.931.13-2.825-.597L2.678 3.452c-.231-.234-.115-.526.467-.584l15.958-1.166c1.34-.117 2.038.35 2.562.758l2.737 1.983c.117.059.408.408.058.408l-16.48.992-.204.014zM5.941 26.49V9.11c0-.759.233-1.109.931-1.168L25.8 6.834c.642-.058.932.35.932 1.108v17.264c0 .759-.117 1.401-1.165 1.459l-18.113 1.05c-1.048.058-1.513-.291-1.513-1.225zm17.88-16.448c.116.525 0 1.05-.525 1.11l-.873.173v12.832c-.758.408-1.456.641-2.039.641-.932 0-1.165-.292-1.863-1.166l-5.709-8.982v8.69l1.806.409s0 1.05-1.457 1.05l-4.017.233c-.117-.234 0-.817.407-.933l1.049-.291v-11.49L9.144 12.2c-.117-.525.174-1.283.99-1.342l4.31-.29 5.94 9.098v-8.049l-1.514-.174c-.117-.643.349-1.11.931-1.167l4.02-.234z",fill:"#000"}),(0,$.jsx)("path",{className:"fill",d:"M41.434 21.251v-7.91h.137l5.704 7.91h1.796V9.627h-1.997v7.902h-.137l-5.704-7.902H39.43V21.25h2.005zM54.715 21.429c2.635 0 4.238-1.724 4.238-4.584 0-2.852-1.611-4.584-4.238-4.584-2.618 0-4.237 1.74-4.237 4.584 0 2.86 1.595 4.584 4.237 4.584zm0-1.676c-1.393 0-2.19-1.063-2.19-2.908 0-1.837.797-2.908 2.19-2.908 1.386 0 2.183 1.071 2.183 2.908 0 1.845-.789 2.908-2.183 2.908zM60.778 10.28v2.215h-1.393v1.595h1.393v4.809c0 1.708.806 2.393 2.828 2.393.386 0 .757-.04 1.047-.097v-1.563c-.242.024-.395.04-.677.04-.837 0-1.208-.386-1.208-1.256V14.09h1.885v-1.595h-1.885v-2.216h-1.99zM65.85 21.251h1.99v-8.813h-1.99v8.813zm.991-10.27c.66 0 1.192-.533 1.192-1.201 0-.669-.531-1.209-1.192-1.209-.652 0-1.192.54-1.192 1.209 0 .668.54 1.2 1.192 1.2zM73.299 21.429c2.634 0 4.237-1.724 4.237-4.584 0-2.852-1.611-4.584-4.237-4.584-2.619 0-4.238 1.74-4.238 4.584 0 2.86 1.595 4.584 4.238 4.584zm0-1.676c-1.394 0-2.192-1.063-2.192-2.908 0-1.837.798-2.908 2.192-2.908 1.385 0 2.183 1.071 2.183 2.908 0 1.845-.79 2.908-2.183 2.908zM78.725 21.251h1.998V16.12c0-1.297.75-2.119 1.941-2.119 1.217 0 1.78.677 1.78 2.022v5.228h1.999v-5.703c0-2.103-1.072-3.287-3.037-3.287-1.314 0-2.2.604-2.619 1.587h-.137v-1.41h-1.925v8.813z",fill:"#000"})]})}function xr(){return(0,$.jsx)("div",{style:{padding:24},children:(0,$.jsx)(Sr,{})})}function kr(e){const{experimentVariant:t}=e;return(0,$.jsx)("div",{style:{width:800,height:"80vh",margin:"0 auto"},children:(0,$.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"80vh"},children:[(0,$.jsxs)(bn.sg,{gap:16,padding:16,children:[(0,$.jsx)("div",{style:{fontSize:36,fontWeight:N.Z.fontWeight.bold},children:(0,$.jsx)(f.FormattedMessage,{...br.pageTitle})}),(0,$.jsx)("div",{style:{fontWeight:N.Z.fontWeight.bold},children:(0,$.jsx)(f.FormattedMessage,{...br.pageCaption})}),(0,$.jsx)("div",{children:(0,$.jsx)(f.FormattedMessage,{...br.pageDescription1})}),(0,$.jsx)("div",{children:(0,$.jsx)(f.FormattedMessage,{...br.pageDescription2})}),"with_gmail_cta"===t&&(0,$.jsx)(K.Z,{style:{width:"fit-content"},isLarge:!0,onClick:()=>{window.location.href="https://mail.google.com/mail/u/0/#search/Your+Notion+signup+code+is"},children:(0,$.jsx)(f.FormattedMessage,{...br.checkYourGmail})})]}),(0,$.jsx)(bn.sg,{children:(0,$.jsx)("img",{style:{width:350},src:Zt.Z.images.onboarding.couch2Png})})]})})}function wr(){const e=(0,B.O7)(),[t,n]=(0,i.useState)(null);return(0,i.useEffect)((()=>{try{const t=new URLSearchParams(window.location.search).get("state");if(!t)return;const i=JSON.parse(atob(t));i.experimentVariant&&n(i.experimentVariant),i.email&&i.deviceId&&yr.$k(e,{desktopAppRerouteEmail:i.email,desktopAppDeviceId:i.deviceId})}catch(t){}}),[e,n]),(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(xr,{}),(0,$.jsx)(kr,{experimentVariant:t})]})}n(42875),n(23586),n(33626),n(15950);var jr=n(13559),Mr=n(44819);function Cr(e){const{preventFrontRedirect:t}=e,n=(0,B.O7)(),{pathname:i,search:o,hash:s}=window.location;if(!t&&(0,Mr.XR)(n,i)){const e=o.length>0?`${o}&${jr.AM}=1`:`?${jr.AM}=1`;return window.location.href=i+e+s,null}return(0,$.jsx)(r.LazyFrontLoginPage,{isSignup:!n.currentUser.isLoggedIn()})}var Ir=n(26198);class Pr extends s.Z{constructor(){super(...arguments),this.intersectionObserver=void 0,this.registry=new Map,this.handleIntersectionObserverEntries=(e,t)=>{for(const n of e){if(!(n.target instanceof HTMLElement))continue;const e=this.registry.get(n.target);e&&(e.isVisible=n.isIntersecting,e.latestTimestamp=n.time,e.isVisible&&!e.isSpawned&&(e.isSpawned=!0,e.onVisibilityChange(!0)))}this.despawnOldFrames()}}UNSAFE_willMount(){void 0!==window.IntersectionObserver&&(this.intersectionObserver=new IntersectionObserver(this.handleIntersectionObserverEntries))}willUnmount(){this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=void 0)}didUpdate(e){this.props.maxPreferredIFrames<e.maxPreferredIFrames&&this.despawnOldFrames()}despawnOldFrames(){const e=Array.from(this.registry.values()).filter((e=>e.isSpawned)),t=e.length-this.props.maxPreferredIFrames;if(t<=0)return;const n=e.filter((e=>!e.isVisible));n.sort(((e,t)=>e.latestTimestamp-t.latestTimestamp));for(const i of n.slice(0,t))i.isSpawned=!1,i.onVisibilityChange(!1)}track(e,t){this.intersectionObserver?(this.registry.set(e,{isVisible:!1,isSpawned:!1,latestTimestamp:0,onVisibilityChange:vt.Ds(t,50)}),this.intersectionObserver.observe(e)):Ir.uf.track(e,t)}untrack(e){this.intersectionObserver?(this.intersectionObserver.unobserve(e),this.registry.delete(e)):Ir.uf.untrack(e)}renderComponent(){return(0,$.jsx)(Ir.Lr.Provider,{value:this,children:this.props.children})}}function Tr(e){let t=e.isMobile?10:50;return e.ramSizeInGB&&(t=Math.floor(2*e.ramSizeInGB)),{maxPreferredIFrames:t}}Pr.displayName="IFrameManager";var Lr=n(25777);const _r=function(e){const t=(0,B.O7)(),n={position:"absolute",top:0,left:0,bottom:0,right:0},{device:i}=t;return t.currentUser.isLoggedIn()?(0,$.jsx)("div",{style:n,children:(0,$.jsx)(Lr.Z,{style:{width:"100%",height:"100%"},spinnerSize:Jn.T,showSpinnerTimeout:500})}):i.isElectron?(0,$.jsx)(r.LazyLoginDesktop,{}):i.isMobileNative?(0,$.jsx)(r.LazyLoginMobileNative,{}):(0,$.jsx)(Cr,{preventFrontRedirect:!0})};var Ar=n(42402),Er=n(83785),Rr=n(84076);const Zr=function(e){let{redirect:t}=e;const n=(0,F.Fg)(),o=(0,B.O7)();return(0,i.useEffect)((()=>{Or(t,o)}),[o,t]),(0,$.jsxs)(fr.Z,{children:[(0,$.jsx)("div",{style:{color:n.regularTextColor},children:(0,$.jsx)(f.FormattedMessage,{defaultMessage:"Redirecting to your Notion app…",id:"webApp.redirectingToDesktop.message"})}),(0,$.jsx)(Rr.Z,{onClick:()=>Or(t,o),style:{maxWidth:300,textAlign:"center",textDecoration:"underline",color:n.lightTextColor},children:(0,$.jsx)(f.FormattedMessage,{defaultMessage:"If you weren't redirected, click here.",id:"webApp.redirectingToDesktop.directLink.message"})}),(0,$.jsx)(Rr.Z,{href:t,style:{maxWidth:300,textAlign:"center",textDecoration:"underline",color:v.ZP.uiGray},children:(0,$.jsx)(f.FormattedMessage,{defaultMessage:"Or, continue in your browser",id:"webApp.redirectingToDesktop.continueInBrowser.message"})})]})};function Or(e,t){C.RX({url:e,environment:t})}var zr=n(84747),Br=n(93214),Vr=n(24211),Fr=n(35793),Ur=n(47307),Dr=n(57400),Nr=n(7802),Wr=n(97978),qr=n(30581),Kr=n(78354),Hr=n(77788),Gr=n(45483);function $r(e){const t=(0,V.VK)((()=>Pt.default.checkGate("inert_html_attribute")),[]),n=(0,V.VK)((()=>Gr.Z.state.openModals.size>0),[]),i={inert:t&&n?"true":null};return(0,$.jsx)("div",{style:e.style,...i,children:e.children})}var Qr=n(91948),Yr=n(31104),Jr=n(17294);const Xr=function(){const e=(0,V.VK)((()=>Yr.Z.state),[]);return(0,$.jsx)(qn.Z,{open:e.open,render:()=>(0,$.jsx)(ns,{}),overlayZIndex:ce._})};function es(e){return{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minWidth:180,padding:"18px 24px 20px",textAlign:"center",maxWidth:e.device.isMobile?"300px":"100%"}}function ts(e){return{display:"flex",alignItems:"center",fontSize:14,color:e.mediumTextColor}}function ns(){const e=(0,F.Fg)(),t=(0,B.O7)(),n=(0,V.VK)((()=>Yr.Z.state),[]),{targetRecordId:i}=n,o=(0,V.VK)((()=>function(e){return void 0!==e&&Boolean(Jr.Z.state[e])}(i)),[i]);return n.open?(0,$.jsxs)("div",{style:es(t),children:[(0,$.jsxs)("div",{style:ts(e),children:[n.message,(0,$.jsx)(Dn.Z,{style:{marginLeft:6}})]}),o&&i&&(0,$.jsx)(Qr.Z,{targetRecordId:i,style:{marginTop:10}})]}):null}var is=n(18466),os=n(12847);const rs="render_duration";new Set(["destinations","emergencyThrottlePercentage","amplitudeOptions","datadogOptions","snowflakeOptions","statsigOptions"]),os.literals("connected_apps_settings","compliance_connected_apps_settings","external_object_instance_block","external_object_instance_inline_popup","external_object_instance_block_error_dropdown","placeholder_root_external_collection_view_block","connected_relation_property_menu","source_picker_connect_another_account","integration_gallery","collection_settings_property_type","integration_file_picker","send_to_notion","unfurl","messages_tab","install_redirect","all_updates","notifications_and_settings","collection_view_settings","share_menu","space_settings","workspace_connections_redirect");var ss=n(76870);function as(){return 1}function ls(e){let{id:t,targetRenderPhase:n="all",samplePercent:o=as(),children:r}=e;const s=(0,B.O7)(),a=(0,i.useCallback)(((e,t,i,r,a,l)=>{(0,ss.lB)(o)&&("all"!==n&&t!==n||Wr.j(s,`${rs}.${e}`,{time:i,render_phase:t}))}),[s,n,o]),[l]=(0,i.useState)(is.Z.withListenerIgnored((()=>Pt.default.checkGate("client-performance-profiler"))));return l?(0,$.jsx)(i.Profiler,{id:t,onRender:a,children:r}):(0,$.jsx)($.Fragment,{children:r})}function cs(e){let{children:t}=e;const n=(0,f.useIntl)(),o=(0,B.O7)(),r=(0,F.Fg)();(0,zr.Z)((()=>{const{device:e,mobileNative:t}=o;if(Fr.mc(o),Dr.Yh(o),t&&t.hideSplashscreen(),e.isMobile){const e=document.body.parentElement;e&&e.classList.add(di.aiP)}Wr.pH(o),l.rQ({device:e,config:A.default,cookieService:o.cookieService}),e.isElectronMac&&k.getAppPath().then((e=>{e&&(e.startsWith("/Volumes/Notion Installer")||e.startsWith("/Volumes/Notion Dev Installer")||e.startsWith("/Volumes/Notion Stg Installer"))&&Ur.showMessage({message:n.formatMessage({defaultMessage:"Please move the Notion.app into the /Applications folder for the auto-updater to work.",id:"notionAppContainer.dialog.notionAppNotInApplications.message"})})})),Vr.DM(a.SP),(0,Br.yN)(window.location.href)})),(0,i.useEffect)((()=>{const{device:e}=o;"external"===(0,u.Wj)({url:window.location.href,isMobile:e.isMobile,baseUrl:A.default.domainBaseUrl,publicDomainName:A.default.publicDomainName,protocol:A.default.protocol,currentUrl:window.location.href}).name&&Ur.showDialog({message:"Mismatch between origin and baseUrl (dev).",showCancel:!1,keepFocus:!1,items:[{label:(0,$.jsx)(f.FormattedMessage,{defaultMessage:"Okay",id:"notionAppContainer.dialog.mismatchedOriginURL.okayButton.label"}),onAccept:()=>{const e=S.O_({relativeUrl:S.T1(window.location.href),baseUrl:A.default.domainBaseUrl}),t=S.Qc(e);t.protocol=S.Qc(window.location.href).protocol,window.location.href=S.WU(t)}}]})}),[o]),(0,i.useEffect)((()=>{const{mobileNative:e}=o;null==e||e.markTransitionReady({type:"mount"})}),[o]);const s="light"===r.mode?di.MsS:di.Xj_,d=(0,F.yK)((e=>({root:{...(0,c.N7)(a.SP),color:e.regularTextColor,WebkitFontSmoothing:"auto",backgroundColor:e.contentBackground}})),[]);return(0,$.jsxs)(ls,{id:"app",targetRenderPhase:"mount",children:[(0,$.jsx)(Nr.Z,{}),(0,$.jsxs)("div",{style:d.root,className:["notion-app-inner",s].join(" "),children:[(0,$.jsx)($r,{style:{height:"100%"},children:t}),(0,$.jsx)(Hr.Z,{store:qr.Z,zIndex:ce.mJ,isDefault:!0}),(0,$.jsx)(Kr.Z,{}),(0,$.jsx)(Xr,{})]})]})}var ds=n(94273),us=n(12714);function ps(){const e=(0,B.O7)();return(0,zr.Z)((()=>{const t=b.u5({schemeUrl:window.location.href,baseUrl:A.default.domainBaseUrl});us.D({environment:e,url:t}),ds.vq(),C.c4({environment:e,url:p._j.root,redirect:!0})})),null}class hs extends s.Z{constructor(){super(...arguments),this.didCatchError=!1,this.caughtErrorId=void 0,this.openSupportMessages=()=>{L.j({environment:this.environment,from:"page_error"})},this.handleOpenNativeLink=e=>{"string"==typeof e?this.handleOpenNativeLinkV2(e,!1,!1):this.handleOpenNativeLinkV2(e.url,!1,!1)},this.handleOpenNativeLinkV2=(e,t,n)=>{const{RouterStore:i}=this.environment,o=b.RD({url:e,protocol:A.default.protocol,baseUrl:A.default.domainBaseUrl}),r=b.u5({schemeUrl:o,baseUrl:A.default.domainBaseUrl}),s=u.Wj({url:r,baseUrl:A.default.domainBaseUrl,publicDomainName:A.default.publicDomainName,isMobile:this.environment.device.isMobile,protocol:A.default.protocol,currentUrl:window.location.href});(this.environment.device.isAndroid||t)&&M.Hu({RouterStore:i,currentUserId:this.environment.currentUser.id}),this.environment.mobileNative&&this.environment.mobileNative.closeInAppBrowser(),"googleAuthCallback"!==s.name&&"samlAuthCallback"!==s.name?C.c4({environment:this.environment,url:r,redirect:t,updateMobileTabbedRouterArgs:{clearNativeRootPageOverride:n},queryId:"page"===s.name?s.queryId:void 0}):C.c4({environment:this.environment,url:r})}}didMount(){this.environment.currentUser.isLoggedIn()&&Z.default.waitUntil((()=>{const e=Z.default.state.currentUserSettingsStore,t=(null==e?void 0:e.isDefined())??!1;if(e&&t){const t=e.getSettings(),n=null==t?void 0:t.disable_auto_set_timezone;t&&!n&&P.wk({environment:this.environment,userSettingsStore:e})}return t}))}UNSAFE_willMount(){const{RouterStore:e,currentUser:t}=this.environment,n=t.id;window.addEventListener("beforeunload",(()=>{M.Vz({historyId:e.state.id,currentUserId:n})})),window.onpopstate=async t=>{const n=window.location.href,i=t.state?t.state.currentUserId:void 0;let o=this.environment;i&&i!==this.environment.currentUser.id&&(o=await T.x({environment:o,newCurrentUserId:i}));const r=e.state.route,s=u.Wj({url:n,isMobile:o.device.isMobile,baseUrl:A.default.domainBaseUrl,publicDomainName:A.default.publicDomainName,protocol:A.default.protocol,currentUrl:window.location.href}),a="page"===r.name&&"page"===s.name&&r.blockId===s.blockId,l="onboarding"!==r.name&&"onboarding"===s.name;M.Vz({historyId:e.state.id,currentUserId:i}),await I.e({environment:o,id:t.state&&t.state.id||(0,y.ZP)(),action:"pop",href:n}),l&&!this.environment.device.isMobileNative&&C.c4({environment:o,url:p._j.root}),a&&C.Oj(o)},this.environment.mobileNative&&this.environment.mobileNative.subscribeToOpenLink(this.handleOpenNativeLinkV2),k.subscribeToProtocolUrl(this.handleOpenNativeLink),k.subscribeToSettingsMenuItem(ys),k.ready(),k.onNewWindow(((e,t)=>{e.preventDefault(),C.c4({environment:this.environment,url:t,openInNew:"tab"})}))}componentDidCatch(e,t){console.error("Client crash during React render:",e),this.caughtErrorId=g.rn(e,{from:"Router",type:"ClientCrash",data:{miscDataToConvertToString:t}}),this.didCatchError=!0,this.forceUpdate()}renderComponent(){return(0,$.jsx)(f.IntlProvider,{defaultLocale:"en-US",locale:a.SP,messages:a.sY,children:(0,$.jsx)(Pr,{...Tr(this.environment.device),children:this.renderRouteOrError()})})}renderRouteOrError(){return this.didCatchError?(0,$.jsxs)("div",{style:gs,children:[(0,d.H)({width:42,height:42}),(0,$.jsxs)("div",{style:fs,children:[(0,$.jsx)("div",{children:(0,$.jsx)(f.FormattedMessage,{defaultMessage:"Oops! Something went wrong.",id:"router.renderErrorPage.message.part1"})}),(0,$.jsx)("div",{children:(0,$.jsx)(f.FormattedMessage,{defaultMessage:"Please refresh and try again or <textlink>message support</textlink>.",id:"router.renderErrorPage.message.part2",values:{textlink:e=>(0,$.jsx)(Ar.Z,{onClick:this.openSupportMessages,children:e})}})}),this.caughtErrorId&&(0,$.jsx)("div",{style:vs,children:(0,$.jsx)(f.FormattedMessage,{defaultMessage:"Error ID: {errorId}",id:"router.renderErrorPage.message.errorId",values:{errorId:this.caughtErrorId.slice(0,8)}})})]}),(0,$.jsx)(K.Z,{isLarge:!0,onClick:()=>window.location.reload(),children:(0,$.jsx)(f.FormattedMessage,{defaultMessage:"Refresh",id:"router.renderErrorPage.reloadButton.label"})})]}):(0,$.jsx)(cs,{children:this.renderRoute()})}renderRoute(){const{RouterStore:e}=this.environment,t=e.state;if("root"!==t.route.name&&"page"!==t.route.name&&"space"!==t.route.name&&(w.setInitialRenderCompleted(),Z.default.setState({...Z.default.state,renderPhase:"rendered"})),this.environment.currentUser.isLoggedIn()||"page"===t.route.name||"space"===t.route.name||l.j({device:this.environment.device,event:{facebook:{eventName:"PageView",data:{content_name:window.location.href}},google:{eventName:"pageView",path:window.location.pathname}},cookieService:this.environment.cookieService}),this.environment.currentUser.isLoggedIn()&&Z.default.state.currentUserSettingsStore){const{currentUserSettingsStore:e}=Z.default.state;_.dM(this.environment,e)}const{device:i}=this.environment;if(i.isNative&&u.lQ[t.route.name])return(0,$.jsx)(ps,{});if("front"===t.route.name)return(0,$.jsx)(Cr,{preventFrontRedirect:t.route.alreadyRedirected});if("root"===t.route.name)return(0,$.jsx)(_r,{route:t.route});if("nativeRedirect"===t.route.name)return(0,$.jsx)(Zr,{redirect:t.route.redirect});if("login"===t.route.name)return(0,$.jsx)(r.LazyLoginPage,{isSignup:!1,email:t.route.email,redirectURL:t.route.redirectURL});if("desktopEmailConfirm"===t.route.name)return(0,$.jsx)(wr,{});if("teamsInvite"===t.route.name){const{teamId:e}=t.route;return x.uA(this.environment,{teamId:e}),(0,$.jsx)(Er.Z,{fetch:async()=>{const t=new O.zX(this.environment,{table:h.e0,id:e});await t.load()},render:()=>(0,$.jsx)(ne,{teamId:e})})}if("signup"===t.route.name)return(0,$.jsx)(r.LazyLoginPage,{isSignup:!0,email:t.route.email});if("unsubscribe"===t.route.name)return(0,$.jsx)(vr,{payload:t.route.payload});if("onboarding"===t.route.name)return(0,$.jsx)(r.LazyOnboarding,{});if("upcomingInvoice"===t.route.name)return(0,$.jsx)(r.LazyInvoice,{route:t.route});if("invoiceById"===t.route.name)return(0,$.jsx)(r.LazyInvoice,{route:t.route});if("settingsConsoleOrganization"===t.route.name){if(this.environment.currentUser.isLoggedIn())return(0,$.jsx)(r.LazyOrganizationSettingsConsole,{organizationId:t.route.organizationId,tabRoute:t.route.tabRoute,properties:t.route.properties,params:t.route.params});{const e=S.bf({url:`${p._j.settingsConsoleOrganization}/${t.route.organizationId}`}),n=S.bf({url:`${A.default.domainBaseUrl}${p._j.login}`,query:{redirectURL:e}});C.c4({environment:this.environment,url:n,redirect:!0})}}if("settingsConsoleWorkspace"===t.route.name&&C.c4({environment:this.environment,url:p._j.root}),t.route.name,t.route.name,"admin"===t.route.name&&A.default.isAdminMode)return(0,$.jsx)(Er.Z,{fetch:()=>Promise.all([n.e(2743),n.e(782),n.e(2069),n.e(1275),n.e(4162),n.e(637),n.e(2328)]).then(n.bind(n,68611)),render:e=>{let{default:t}=e;return(0,$.jsx)(t,{})}});if("adminListData"===t.route.name){const{category:e}=t.route;if(A.default.isAdminMode)return(0,$.jsx)(Er.Z,{fetch:()=>Promise.all([n.e(2743),n.e(782),n.e(2069),n.e(1275),n.e(4162),n.e(637),n.e(2328)]).then(n.bind(n,65585)),render:t=>{let{default:n}=t;return(0,$.jsx)(n,{category:e})}})}if("adminSingleRecord"===t.route.name&&A.default.isAdminMode){const{id:e,table:i}=t.route;return(0,$.jsx)(Er.Z,{fetch:()=>Promise.all([n.e(2743),n.e(782),n.e(2069),n.e(1275),n.e(4162),n.e(637),n.e(3854)]).then(n.bind(n,48807)),render:t=>{let{default:n}=t;return(0,$.jsx)(n,{table:i,id:e})}})}if("oauthAuthorization"===t.route.name){const{responseType:e,redirectUri:i,integrationId:o,state:r,owner:s,userId:a,spaceId:l}=t.route;return(0,$.jsx)(Er.Z,{fetch:()=>Promise.all([n.e(2774),n.e(2743),n.e(3844),n.e(3370)]).then(n.bind(n,18330)),render:t=>{let{default:n}=t;return(0,$.jsx)(n,{responseType:e,redirectUri:i,integrationId:o,state:r,owner:s,userId:a,spaceId:l})}})}if("notionCalendarAuthorization"===t.route.name){const{csrf:e,calendarCsrf:i,redirectUri:o,spaceId:r,state:s}=t.route;return(0,$.jsx)(Er.Z,{fetch:()=>n.e(7304).then(n.bind(n,67943)),render:t=>{let{default:n}=t;return(0,$.jsx)(n,{csrf:e,calendarCsrf:i,redirectUri:o,spaceId:r,state:s})}})}if("initiateExternalAuthentication"===t.route.name){const{notion_user_id:e,notion_workspace_id:i,notion_last_visited_url:o,notion_authorization_code:r,external_object_instance_block_id:s,callback_type:a,integration_id:l,redirectToAuth:c}=t.route;return(0,$.jsx)(Er.Z,{fetch:()=>n.e(1023).then(n.bind(n,84750)),render:t=>{let{default:n}=t;return(0,$.jsx)(n,{notion_user_id:e,notion_workspace_id:i,notion_last_visited_url:o,notion_authorization_code:r,external_object_instance_block_id:s,callback_type:a,integration_id:l,redirectToAuth:c})}})}if("initiateExternalAuthenticationFromDesktop"===t.route.name){const{redirectUri:e}=t.route;if(this.environment.currentUser.isLoggedIn())return(0,$.jsx)(Er.Z,{fetch:()=>n.e(3871).then(n.bind(n,94810)),render:t=>{let{default:n}=t;return(0,$.jsx)(n,{redirectUri:e})}});{const t=S.bf({url:`${A.default.domainBaseUrl}${p._j.initiateExternalAuthenticationFromDesktop}`,query:{redirectUri:e}}),n=S.bf({url:`${A.default.domainBaseUrl}${p._j.login}`,query:{redirectURL:t}});m.hw(),C.c4({environment:this.environment,url:n,redirect:!0})}}if("myIntegrations"===t.route.name)return"pointer"in t.route?(0,$.jsx)(r.LazyDeveloperIntegrationViewV2,{botOrIntegrationPointer:t.route.pointer}):(0,$.jsx)(r.LazyDeveloperIntegrationsList,{});if("myIntegrationsLab"===t.route.name)return(0,$.jsx)(r.LazyDeveloperIntegrationLab,{integrationPointer:t.route.pointer});if("inAppTemplateSubmission"===t.route.name&&C.c4({environment:this.environment,url:p._j.creatorProfileTemplates,redirect:!0}),"inAppTemplateCreatorSubmission"===t.route.name&&C.c4({environment:this.environment,url:p._j.creatorProfile,redirect:!0}),"creatorProfileAnalytics"===t.route.name&&C.c4({environment:this.environment,url:p._j.creatorProfile,redirect:!0}),"creatorProfile"===t.route.name||"creatorProfileTemplates"===t.route.name){if(this.environment.currentUser.isLoggedIn())return(0,$.jsx)(E,{});{const e=S.bf({url:`${p._j[t.route.name]}`}),n=S.bf({url:`${A.default.domainBaseUrl}${p._j.login}`,query:{redirectURL:e}});C.c4({environment:this.environment,url:n,redirect:!0})}}if("localizedTemplates"===t.route.name){if(this.environment.currentUser.isLoggedIn())return(0,$.jsx)(R,{});{const e=S.bf({url:`${p._j[t.route.name]}`}),n=S.bf({url:`${A.default.domainBaseUrl}${p._j.login}`,query:{redirectURL:e}});C.c4({environment:this.environment,url:n,redirect:!0})}}return"studentGroupSignup"===t.route.name?(0,$.jsx)(z,{}):"notFound"===t.route.name?(0,$.jsx)(r.LazyPageError,{route:t.route,publicPageData:void 0}):"page"===t.route.name||"space"===t.route.name||"nativeTab"===t.route.name||"workspaceSetup"===t.route.name||"modal"===t.route.name||"quickSearch"===t.route.name||"chat"===t.route.name?(0,$.jsx)(ur,{routerState:t}):(0,$.jsx)(gr.Z,{})}}hs.displayName="Router";const ms=hs,gs={width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingBottom:100,...(0,c.N7)(a.SP)},fs={fontSize:14,textAlign:"center",marginTop:6,marginBottom:12,color:v.ZP.uiGray},vs={fontSize:10,marginTop:8};function ys(e){j.r$({currentTab:e})}function bs(e){let{environment:t,onMount:n}=e;const s=(0,i.useRef)(!1);return(0,i.useEffect)((()=>{s.current||(s.current=!0,null==n||n())}),[n]),(0,$.jsx)(o.B9,{value:t,children:(0,$.jsx)(r.DependencyProviderAll,{children:(0,$.jsx)(ms,{})})})}},14694:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});n(67294);var i=n(480),o=n(86628),r=n(24405),s=n(39567),a=n(50659),l=n(85893);function c(){const e=(0,r.yK)((e=>({icon:{position:"absolute",width:"50%",height:"50%",right:0,bottom:0,fill:"dark"===e.mode?e.regularTextColor:"#3E3C38",stroke:"dark"===e.mode?e.sidebarBackground:"white",strokeWidth:"dark"===e.mode?"1.85px":"1.5px"}})),[]);return(0,l.jsx)("div",{children:(0,s.Y)(e.icon)})}function d(e){var t;const n=(0,i.O7)(),s=n.device.isMobile,d=(0,o.VK)((()=>{var t,i;if(s)return n.WindowSizeStore.getSafePaddingLeftCSS("number"==typeof(null===(t=e.style)||void 0===t?void 0:t.paddingLeft)?null===(i=e.style)||void 0===i?void 0:i.paddingLeft:10)}),[n.WindowSizeStore,s,null===(t=e.style)||void 0===t?void 0:t.paddingLeft]),u=(0,r.yK)((t=>({wrapper:{...s?{display:"flex",alignItems:"center",width:"100%",minHeight:26,fontSize:16,paddingTop:8,paddingBottom:8,paddingLeft:d,paddingRight:10,userSelect:"none",WebkitUserSelect:"none",boxShadow:e.disableMobileBorder?void 0:`0 1px 0 ${t.regularDividerColor}`,marginBottom:e.shouldShowMobileMarginBottom?12:1}:{display:"flex",alignItems:"center",width:"100%",fontSize:e.isBottomItem?12:14,minHeight:e.isBottomItem?24:27,paddingTop:2,paddingBottom:2,marginTop:1,marginBottom:1,...(0,a.MF)()},...e.style},icon:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,flexGrow:0,width:s?28:22,height:s?24:18,marginLeft:-3,marginRight:4,position:"relative"},right:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,flexGrow:0,height:"100%",...e.rightStyle},left:{flexShrink:0,flexGrow:0,borderRadius:4,color:t.mediumTextColor,width:s?26:22,height:s?24:22,display:"flex",alignItems:"center",justifyContent:"center",marginRight:e.icon?0:8},children:{flexGrow:1,flexShrink:1,flexBasis:"auto",whiteSpace:"nowrap",minWidth:0,overflow:"hidden",textOverflow:e.right&&!s?"clip":"ellipsis",...e.childrenStyle}})),[s,d,e.disableMobileBorder,e.shouldShowMobileMarginBottom,e.style,e.rightStyle,e.icon,e.right,e.childrenStyle,e.isBottomItem]);return(0,l.jsxs)("div",{role:e.role,"aria-current":e["aria-current"],"aria-expanded":e["aria-expanded"],"aria-owns":e["aria-owns"],"aria-labelledby":e["aria-labelledby"],style:u.wrapper,onFocus:e.onFocus,onBlur:e.onBlur,onMouseMove:e.onMouseMove,onMouseLeave:e.onMouseLeave,onClick:e.onClick,className:e.className,children:[e.left&&(0,l.jsx)("div",{style:u.left,children:e.left}),e.icon&&(0,l.jsxs)("div",{style:u.icon,children:[e.icon,e.isAlias&&(0,l.jsx)(c,{})]}),(0,l.jsx)("div",{style:u.children,children:e.children}),e.right&&(0,l.jsx)("div",{style:u.right,children:e.right})]})}},55064:(e,t,n)=>{"use strict";n.d(t,{Z:()=>P});var i=n(67294),o=n(480),r=n(86628),s=n(24405),a=n(51454),l=n(9291),c=n(1898),d=n(17659),u=n(87420),p=n(24677),h=n(28651),m=n(98742),g=n(89224),f=n(48276),v=n(28161),y=n(16746),b=n(74948),S=n(24646),x=n(38676),k=n(36391),w=n(96049),j=n(88923),M=n(6685),C=n(26388),I=n(85893);const P=function(e){let{type:t}=e;const n=(0,o.O7)(),s=(0,r.qz)(void 0,h.Z),l=(0,i.useRef)(!1),y=(0,i.useCallback)((()=>function(e,t){t.setState({...t.state,mousePressed:!1}),T({isResizing:!1},e)}(t,s)),[t,s]),P=(0,i.useCallback)((()=>function(e,t,n,i){if(!i.current){switch(t){case"page":b.setExpand({environment:e,isExpanded:!x.sidebarExpandedStore.state,from:"sidebar_resizer"}),x.sidebarOpenStore.setState(!1);break;case"update":b.setUpdateExpand({environment:e,isExpanded:!(0,S.Sx)(e),from:"drag"});break;case"peek":u.xv(e,"resizer_click");break;case"secondary_sidebar":d.qQ({environment:e,open:!1});break;default:(0,c.t1)(t)}n.setState({...n.state,mouseEntered:!1})}n.setState({...n.state,mousePressed:!1}),T({isResizing:!1},t)}(n,t,s,l)),[n,t,s]),E=(0,i.useCallback)((e=>function(e,t,n,i){switch(g.clear(t),i.current=!0,n){case"page":b.setWidth({width:L(e.currentX,n),environment:t});break;case"update":b.setUpdateWidth({width:L(e.currentX,n),environment:t});break;case"peek":b.setPeekWidth({width:L(e.currentX,n),environment:t});break;case"secondary_sidebar":v.ZP.setWidth(L(e.currentX,n));break;default:(0,c.t1)(n)}}(e,n,t,l)),[n,t]),R=(0,i.useCallback)((()=>function(e,t,n,i){p.ZH(e),n.setState({...n.state,mousePressed:!0}),i.current=!1,T({...x.sidebarResizingStore.state,isResizing:!0},t)}(n,t,s,l)),[n,t,s]),{device:Z}=n,O=(0,r.VK)((()=>function(e){const t=function(e){switch(e){case"page":return x.sidebarWidthStore.state;case"secondary_sidebar":return x.sidebarWidthStore.state+f.l_();case"update":return k.ZP.state.width;case"peek":return j.default.state.preferredSidePeekWidth;default:(0,c.t1)(e)}}(e);switch(e){case"page":case"secondary_sidebar":return t;case"peek":case"update":return window.innerWidth-t;default:(0,c.t1)(e)}}(t)),[t]),z=(0,r.VK)((()=>x.sidebarMouseEnterYStore.state),[]),B=(0,r.VK)((()=>w.Z.state),[]),V=(0,r.VK)((()=>function(e){return{cursor:"col-resize",height:"100%",width:12,marginLeft:"update"===e?-k.ZP.state.width:-6}}(t)),[t]),F=(0,r.VK)((()=>function(e,t){const n=(0,S.in)(t);return{position:"absolute",left:"peek"===e?0:void 0,right:"peek"!==e?0:void 0,width:0,flexGrow:0,zIndex:"peek"===e?a.YO:1,top:n?0:-1,bottom:n?0:-1,pointerEvents:"auto"}}(t,n)),[t,n]);return B||Z.isChromebook?null:(0,I.jsx)(C.ZP,{renderTooltip:()=>(0,I.jsx)(_,{type:t}),originRect:new DOMRect(O,z,0,0),delayThreshold:500,placement:"page"===t||"secondary_sidebar"===t?C.ug.Right:C.ug.Left,originGap:10,render:e=>(0,I.jsx)("div",{style:F,...(0,m.Z)(e,{onMouseMove:()=>function(e){T({isResizerHovered:!0},e)}(t),onMouseLeave:()=>function(e){T({isResizerHovered:!1},e)}(t),onMouseEnter:A}),children:(0,I.jsx)(M.Z,{onDraggableDragStart:R,onDraggableDragMove:E,onDraggableDragEnd:P,onDraggableDragCancel:y,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:e=>(0,I.jsx)("div",{style:V,...e})})})})};function T(e,t){switch(t){case"page":x.sidebarResizingStore.update((t=>({...t,...e})));break;case"update":k.ZP.update((t=>({...t,...e})));break;case"secondary_sidebar":y.Z.update((t=>({...t,...e})));break;case"peek":break;default:(0,c.t1)(t)}}function L(e,t){let n;switch(t){case"page":n=e;break;case"secondary_sidebar":n=e-(x.sidebarExpandedStore.state?x.sidebarWidthStore.state:0);break;case"peek":case"update":n=window.innerWidth-e;break;default:(0,c.t1)(t)}const i=function(e){const t=window.innerWidth;switch(e){case"page":return 480;case"update":return Math.min(t/2,S.Nc);case"peek":return t>2*j.sidePeekMinWidth?t/1.5:t;case"secondary_sidebar":return v.o$;default:(0,c.t1)(e)}}(t),o=function(e){switch(e){case"page":return x.SidebarMinWidth;case"update":return k.AO;case"peek":return j.sidePeekMinWidth;case"secondary_sidebar":return v.um;default:(0,c.t1)(e)}}(t);return n>i?i:n<o?o:n}function _(e){let{type:t}=e;const n=(0,s.Fg)(),a=(0,o.O7)(),d=(0,r.VK)((()=>function(e,t){switch(e){case"page":return(0,S.in)(t);case"update":return(0,S.Sx)(t);case"peek":return j.default.state.open;case"secondary_sidebar":return y.Z.isOpen();default:(0,c.t1)(e)}}(t,a)),[t,a]),u=n.mediumInvertedTextColor;return(0,I.jsxs)("div",{style:{textAlign:"center"},children:[(0,I.jsx)(l.FormattedMessage,{defaultMessage:"Drag <invertedcolor>to resize</invertedcolor>",id:"sidebarResizer.tooltip.dragMessage",values:{invertedcolor:e=>(0,I.jsx)("span",{style:{color:u},children:e})}}),(0,I.jsxs)(i.Fragment,{children:[(0,I.jsx)("br",{}),(0,I.jsx)(l.FormattedMessage,{defaultMessage:"Click <invertedcolor>to {expanded, select, true {close} other {lock open}}</invertedcolor>",id:"sidebarResizer.clickToToggleSidebar.message",values:{expanded:d,invertedcolor:e=>(0,I.jsx)("span",{style:{color:u},children:e})}})]})]})}function A(e){x.sidebarMouseEnterYStore.setState(e.clientY)}},30664:(e,t,n)=>{"use strict";n.d(t,{Z:()=>_});var i=n(67294),o=n(480),r=n(6740),s=n(86628),a=n(24405),l=n(84169),c=n(9291),d=n(25888),u=n(13991),p=n(88642),h=n(39634),m=n(97978),g=n(79897),f=n(58455),v=n(77080);var y=n(43250),b=n(98742),S=n(77907),x=n(475),k=n(16194),w=n(55031),j=n(64921),M=n(31945),C=n(26388),I=n(14694),P=n(85893);const T="?";function L(e){const t=(0,o.O7)(),{isMobile:n}=t.device,d=(0,c.useIntl)(),u=(0,a.Fg)(),p=(0,s.VK)((()=>x.Z.state.open),[]),h=(0,a.yK)((e=>({helpIcon:{fill:e.mediumIconColor,width:16,height:16},hoveredStyle:{background:e.whiteButtonHoveredBackground},pressedStyle:{background:e.whiteButtonPressedBackground}})),[]),m=(0,i.useCallback)((e=>{const t=e.target;t instanceof HTMLElement&&(0,r.E)(t)&&k.Z.setState(!0)}),[]),g=(0,i.useCallback)((()=>{k.Z.setState(!1)}),[]);if(n)return(0,P.jsx)(j.Z,{hovered:p,testId:y.lmr,mobileFeedback:n,...e,children:(0,P.jsx)(I.Z,{left:(0,l.m)(h.helpIcon),disableMobileBorder:!0,children:(0,P.jsx)(c.FormattedMessage,{defaultMessage:"Help & feedback",id:"helpButton.mobileHelpFeedbackButton.label"})})});const f=d.formatMessage({defaultMessage:"Help, feedback, and keyboard shortcuts",id:"helpButton.desktopHelpButton.ariaLabel"}),v=(0,b.Z)(e,{onFocus:m,onBlur:g});return(0,P.jsx)(P.Fragment,{children:(0,P.jsx)(C.ZP,{renderTooltip:()=>(0,P.jsx)("span",{children:(0,P.jsx)(c.FormattedMessage,{defaultMessage:"Help, feedback, and {br}keyboard shortcuts",id:"helpButton.desktopHelpButton.tooltip",values:{br:(0,P.jsx)("br",{})}})}),render:e=>(0,P.jsx)(j.Z,{ariaLabel:f,className:y.lmr,testId:y.lmr,style:(0,w.y)(t,{theme:u,rightEdgeDistance:16,isInPeekRenderer:!1}),hoveredStyle:h.hoveredStyle,pressedStyle:h.pressedStyle,...(0,b.Z)(v,e),children:T})})})}const _=(0,c.injectIntl)((function(){const e=(0,o.O7)(),{isMobile:t}=e.device,n=(0,s.VK)((()=>{var t;return(null===(t=e.mobileNative)||void 0===t?void 0:t.supportsNativeHomeOnPhone())||!1}),[e]),r=(0,i.useCallback)((()=>{d.Ar(e,{from:"corner"}),function(e){const t=f.default.state;if((0,m.Ug)()&&t.isZendeskEnabled){const{userHighestPlanType:n,isSalesAssistedPlan:i}=(0,g.rf)(e);p.j({locale:u.SP,analyticsSettings:t,isForethoughtEnabled:v.default.checkGate("forethought"),forethoughtInitializeArgs:h.z(e),userHighestPlanType:n,isSalesAssistedPlan:i,cookieService:e.cookieService})}}(e)}),[e]);return(0,P.jsx)(M.ZP,{popupType:t?M.Z4.SlideUp:M.Z4.Popup,hidesMobileNativeBottomBar:n,preventSlideUpTransition:n,renderOrigin:e=>(0,P.jsx)(L,{...e}),originGap:t?0:12,placementToOrigin:t?M.pO.Right:M.pO.Top,alignmentToOrigin:t?M.vR.Center:M.vR.End,buttonPopupStore:x.Z,onClick:r,render:()=>(0,P.jsx)(S.LazyHelpButtonContent,{shouldRenderAsStaticModal:n})})}))},46457:(e,t,n)=>{"use strict";n.d(t,{_:()=>h});var i=n(67294),o=n(480),r=n(86628),s=n(24405),a=n(9291),l=n(77907),c=n(34859),d=n(7184),u=n(53336),p=n(85893);function h(e){let{loginModalStore:t,loginStore:n,title:s,description:a,isSignup:c,disableLoginLink:u,redirectURL:h,className:v,onDismiss:y}=e;const b=(0,o.O7)(),S=(0,r.VK)((()=>t.state.open),[t]),x=(0,i.useId)(),k=(0,i.useId)(),w={loginStore:n,title:s,description:a,isSignup:c,redirectURL:h,disableLoginLink:u,titleAriaId:x,descriptionAriaId:k};return(0,p.jsx)(d.c,{ariaLabelledBy:x,ariaDescribedBy:k,isOpen:S,onDismiss:()=>{f({loginModalStore:t,loginStore:n,onDismiss:y})},areaConstraint:{width:{min:480,max:480},height:{scroll:!0}},children:(0,p.jsx)(m,{children:(0,p.jsxs)("div",{className:v,children:[!b.device.isMobile&&(0,p.jsx)(g,{loginModalStore:t,loginStore:n,onDismiss:y}),(0,p.jsx)(l.LazyLoginModalContent,{...w})]})})})}function m(e){let{children:t}=e;return(0,o.O7)().device.isMobile?(0,p.jsx)(u.Z,{type:c.Z.Y,children:t}):t}function g(e){let{loginModalStore:t,loginStore:n,onDismiss:i}=e;const o=(0,s.Fg)();return(0,p.jsx)("div",{style:{fontSize:14,color:o.mediumTextColor,position:"absolute",right:0,marginTop:16,marginRight:16,cursor:"pointer"},onClick:()=>{f({loginModalStore:t,loginStore:n,onDismiss:i})},children:(0,p.jsx)(a.FormattedMessage,{defaultMessage:"Cancel",id:"sidebarSwitcherMultiAccount.addAccountModal.cancelButton.label"})})}function f(e){const{loginModalStore:t,loginStore:n,onDismiss:i}=e;n.reset(),t.setState({open:!1}),i&&i()}},69098:(e,t,n)=>{"use strict";n.d(t,{j:()=>d,o:()=>i});var i={};n.r(i),n.d(i,{showAsyncModal:()=>p,showAsyncModalComponent:()=>h,testOnly:()=>x});var o=n(67294),r=n(86628),s=n(49085);class a extends s.default{getInitialState(){return{asyncModals:[]}}}const l=new a;var c=n(85893);const d=o.memo((function(e){const{store:t=l}=e,n=(0,r.VK)((()=>t.state.asyncModals),[t]);return(0,c.jsx)(c.Fragment,{children:n.map((e=>{const{id:t,internalRenderModal:n,isOpen:i}=e,r=n(i);return(0,c.jsx)(o.Fragment,{children:r},t)}))})}));var u=n(7032);function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;return new Promise(((n,i)=>{try{m({asyncModal:y({renderModal:e,promiseResolve:n,promiseReject:i,store:t}),store:t})}catch(o){i(o)}}))}function h(e){return p((t=>o.createElement(e,t)),arguments.length>1&&void 0!==arguments[1]?arguments[1]:l)}function m(e){const{asyncModal:t,store:n=l}=e;n.update((e=>({asyncModals:[...e.asyncModals,t]})))}function g(e){const{id:t,promiseResolve:n,store:i=l}=e;return e=>{const o=b({id:t,store:i});null!=o&&o.isOpen&&(S({id:t,store:i,update:{isOpen:!1}}),n(e))}}function f(e){const{id:t,promiseResolve:n,store:i=l}=e;return()=>{const e=b({id:t,store:i});null!=e&&e.isOpen&&(S({id:t,store:i,update:{isOpen:!1}}),n())}}function v(e){const{id:t,store:n=l}=e;return()=>{n.update((e=>({asyncModals:e.asyncModals.filter((e=>e.id!==t))})))}}function y(e){const{renderModal:t,promiseResolve:n,promiseReject:i,store:o=l}=e,r=(0,u.ZP)(),s=v({id:r,store:o}),a=f({id:r,promiseResolve:n,store:o}),c=g({id:r,promiseResolve:n,store:o});return{id:r,internalRenderModal:e=>{try{return t({isOpen:e,onClosed:s,onDismiss:a,resolve:c})}catch(n){throw i(n),n}},isOpen:!0}}function b(e){const{id:t,store:n=l}=e;return n.state.asyncModals.find((e=>e.id===t))}function S(e){const{id:t,update:n,store:i=l}=e;i.update((e=>({asyncModals:e.asyncModals.map((e=>e.id!==t?e:{...e,...n}))})))}const x={addAsyncModal:m,createAsyncModal:y,createOnClosed:v,createOnDismiss:f,createResolve:g,getAsyncModal:b,updateAsyncModal:S}},30106:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(49085);class o extends i.default{getInitialState(){return{open:!1}}}const r=new o},83420:(e,t,n)=>{"use strict";n.d(t,{TL:()=>h,nc:()=>p,ue:()=>u});n(21703);var i=n(66897),o=n(68626),r=n(54368),s=n(77420),a=n(19889),l=n(52629),c=n(1898),d=n(6258);function u(e){const{parentStore:t,pointer:n}=e,o=(0,d.Kv)(t,n).getValue();if(o)return(0,i.LU)({table:n.table,value:o})}function p(e){const{parentStore:t,pointer:n}=e;if(n.table===s.cZ)return d.Qx.createChildStore(t,n);if(n.table===a.KJ){const e=d.U6.createChildStore(t,n),i=e.isDefined()&&e.getValue();return(e.pointer.id!==n.id||e.pointer.table!==n.table||i&&i.id!==n.id)&&o.log({from:"PresenceContainer.tsx",level:"warning",type:"FetchedPointerMismatch",error:(0,l.Ui)(new Error("Value returned by getActorStore does not match avatar actor")),data:{miscDataToConvertToString:{parentStorePointer:t.pointer,requestedPointer:n,fetchedPointer:e.pointer,fetchedId:i?i.id:null}}}),e}if(n.table===r.y0)return d.fg.createChildStore(t,n);(0,c.t1)(n)}function h(e){return e.table===s.cZ?(0,i.ON)(e.getValue()):e.table===a.KJ?(0,i.m3)(e.getValue()):e.table===r.y0?(0,i.I4)(e.getValue()):void(0,c.t1)(e)}},65556:(e,t,n)=>{"use strict";n.r(t),n.d(t,{setupOnBeforeUnload:()=>r,showConfirmationDialogEventEmitter:()=>i});const i=new(n(33147).Z),o={transaction_queue_has_tasks:"Changes you made may not be saved. Are you sure you want to quit?",uploading_files:"The files you are currently uploading may not be saved. Are you sure you want to quit?",generating_ai_completions:"Changes being made by AI may not be saved. Are you sure you want to quit?"};function r(e){const{TransactionQueue:t,device:n,AppUpdateStore:r,GlobalFileUploadStore:s}=e;window.onbeforeunload=function(){const e=!t.hasTasks()||n.isMobileNative||n.isElectron||r.isMajorUpdate()?s.isUploading()?"uploading_files":void 0:"transaction_queue_has_tasks";if(e)return i.emit(e),o[e]}}},70511:(e,t,n)=>{"use strict";n.r(t),n.d(t,{setupTransactionLoadGenerator:()=>l});var i=n(92595),o=n(993),r=n(13447),s=n(80444),a=n(24666);function l(e){(0,i.exposeDebugValue)("generateTransactionLoad",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const l=s.default.state.mainEditorCurrentBlockStore;if(!l)return void console.info("Cannot generateTransactionLoad: No current block");const c=l.getTitleStore();if(!c)return void console.info("Cannot generateTransactionLoad: block has no title");if("editing"!==a.default.state.mode)return void console.info("not editing anything. Click the page title.");const d=t=>{r.createAndCommit({userAction:"generateTransactionLoad.createTransaction",environment:e,perform:i=>{console.info("createAndCommit #",t);for(let r=0;r<n;r++){const n=`This is transaction #${t+1}, op ${r+1}, of load started at ${u}`;o.aS({environment:e,editorMode:"default",store:c,newValue:n,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:i})}}})},u=new Date;if(0===i)for(let e=0;e<t;e++)d(e);else{let e=0;const n=setInterval((()=>{e<t?(d(e),e++):clearInterval(n)}),i)}}))}},26907:(e,t,n)=>{"use strict";function i(e){const{target:t,inviteTargetsStore:n}=e;return n.state.inviteTargets.some((e=>"newUser"===t.type?e.type===t.type&&t.value.email===e.value.email:"invalidUser"===t.type?e.type===t.type&&t.value.text===e.value.text:e.type===t.type&&e.value.id===t.value.id))}function o(e){return"invalidUser"!==e.type}function r(e){const{inviteTargetsStore:t}=e,{inviteTargets:n}=t.state;return n.filter(o)}n.d(t,{B:()=>r,H:()=>i})},19077:(e,t,n)=>{"use strict";n.r(t),n.d(t,{initialize:()=>a});var i=n(68626),o=n(95477),r=n(77080),s=n(15517);function a(e){"object"==typeof o.default&&o.default.version&&(i.clientLogglyEnvironmentData.version=o.default.version);const{device:t,currentUser:n}=e;t.isMobileNative&&(i.clientLogglyEnvironmentData.isMobileNative=!0),t.isMobile&&(i.clientLogglyEnvironmentData.isMobile=!0),t.isAndroid&&(i.clientLogglyEnvironmentData.isAndroid=!0),t.isIOS&&(i.clientLogglyEnvironmentData.isIOS=!0),t.isElectron&&(i.clientLogglyEnvironmentData.isElectron=!0),t.isChromeExtension&&(i.clientLogglyEnvironmentData.isChromeExtension=!0),i.clientLogglyEnvironmentData.os=t.os,i.clientLogglyEnvironmentData.platform=t.platform,window.navigator.userAgent&&(i.clientLogglyEnvironmentData.userAgent=window.navigator.userAgent),document.referrer&&(i.clientLogglyEnvironmentData.referrer=document.referrer),n.id&&(i.clientLogglyEnvironmentData.userId=n.id),i.clientLogglyEnvironmentData.experiments=r.default.getUsedNonControlExperimentsMap(),r.default.addListener((()=>{i.clientLogglyEnvironmentData.experiments=r.default.getUsedNonControlExperimentsMap()})),(0,s.sK)().then((e=>{e&&(i.clientLogglyEnvironmentData.storageUsageEstimate=e.usage,i.clientLogglyEnvironmentData.storageQuotaEstimate=e.quota)}))}},50659:(e,t,n)=>{"use strict";n.d(t,{G$:()=>r,MF:()=>s,Z3:()=>o});const i=4;function o(e){let{isMobile:t}=e;return{...!t&&{borderRadius:3}}}function r(e){let{isMobile:t}=e;return t?{}:{...o({isMobile:t}),marginLeft:i,marginRight:i,width:`calc(100% - ${2*i}px)`,transition:"background 100ms ease-out"}}function s(){return{paddingLeft:14-i,paddingRight:14-i}}},48916:(e,t,n)=>{"use strict";n.r(t),n.d(t,{mainApp:()=>i});n(21703);async function i(e){const{minimalEnvironment:t,mainStartTime:i,prefetchInitiatedTime:o,prefetchCache:r}=e,{device:s}=t,[{setupOnBeforeUnload:a},l,{createClientEnvironment:c},{setupTransactionQueue:d},{default:u},p]=await Promise.all([Promise.resolve().then(n.bind(n,65556)),Promise.resolve().then(n.bind(n,68626)),Promise.resolve().then(n.bind(n,44756)),Promise.resolve().then(n.bind(n,53730)),Promise.resolve().then(n.bind(n,27411)),Promise.resolve().then(n.bind(n,44133))]);let h=await c({minimalEnvironment:t,prefetchCache:r});const{ElectronSqlite:m}=h;p.setupRecordCacheDebugging(s);const g=await d(h);a({device:s,TransactionQueue:g,AppUpdateStore:h.AppUpdateStore,GlobalFileUploadStore:u});const[f,{default:v}]=await Promise.all([Promise.resolve().then(n.bind(n,19077)),Promise.resolve().then(n.bind(n,18245))]);if(f.initialize(h),s.isMobileNative){const e=v.mark("mobilenative.initialize_from_js"),[t,i]=await Promise.all([Promise.resolve().then(n.bind(n,98958)),Promise.resolve().then(n.bind(n,57491))]);await t.initializeMobileNativeApp(h),Object.assign(l.clientLogglyEnvironmentData,i.getMobileNativeDeviceInfo()),v.measure(e,{environment:h,data:{}})}if(s.isElectron){const e=await Promise.resolve().then(n.bind(n,47839));await e.initializeElectron({device:s,electronSqlite:m});const t=await Promise.resolve().then(n.bind(n,74503)),i=await t.getDesktopDeviceInfo();Object.assign(l.clientLogglyEnvironmentData,i,{desktopVersion:s.desktopAppVersion})}const[y,b,S,x,k]=await Promise.all([Promise.resolve().then(n.bind(n,97977)),Promise.resolve().then(n.bind(n,74948)),Promise.resolve().then(n.bind(n,89224)),Promise.resolve().then(n.bind(n,32219)),Promise.resolve().then(n.bind(n,13447))]),{setupTransactionLoadGenerator:w}=await Promise.resolve().then(n.bind(n,70511));w(h);const j=performance.now(),[{default:M},C,I,P,{CurrentUser:T},{getGhostAdminUserId:L},{default:_}]=await Promise.all([Promise.resolve().then(n.bind(n,58434)),Promise.resolve().then(n.t.bind(n,67294,19)),Promise.resolve().then(n.t.bind(n,73935,19)),Promise.resolve().then(n.t.bind(n,20745,19)),Promise.resolve().then(n.bind(n,87997)),Promise.resolve().then(n.bind(n,12955)),Promise.resolve().then(n.bind(n,77080))]);b.initialize(),S.startListeners(s),h=await y.initialize(h),h.updateCurrentUserId=async e=>{const t=await L(h),n={...e.environment,currentUser:new T({id:e.currentUserId,loggedInUserIds:e.userIds,adminUserId:t})};U(n)},x.initialize(h),g.startLoop();const[{maybeClearCookies:A,refreshNotionCookies:E,validateHasPermissionArgs:R,clearNotionCookiesWithNoPermission:Z,clearThirdPartyCookiesAndLocalStorageWithNoPermission:O},{clearNotionLocalStorageWithNoPermission:z},B,V]=await Promise.all([Promise.resolve().then(n.bind(n,12955)),Promise.resolve().then(n.bind(n,18613)),Promise.resolve().then(n.bind(n,32223)),Promise.resolve().then(n.bind(n,32603))]);A(),Promise.all([Z(h),O(h)]).then((()=>E(h))),z(),R(h);const[{TransactionQueueDependenciesImpl:F}]=await Promise.all([Promise.resolve().then(n.bind(n,68026))]),U=e=>{const t=performance.now(),n=document.querySelector("#notion-app");if(!n)throw new Error('Could not find element with id "notion-app"');const r=_.checkGate("react_18_concurrent_rendering");g.updateDependencies(new F(e)),k.updateConnectionState(e),B.updateEnvironment(e),l.clientLogglyEnvironmentData.userId=e.currentUser.id;const s=()=>{const e=document.getElementById("initial-loading-spinner"),n=document.getElementById("skeleton");e&&e.remove(),n&&n.remove();const r=performance.now();V.setSubMetricsAtRenderCallback({mainStartTime:i,prefetchInitiatedTime:o,renderStartTime:t,renderEndTime:r,mainImportEndTime:j})},a=C.createElement(M,{environment:e,onMount:r?s:void 0});if(r){P.createRoot(n).render(a)}else I.render(a,n,s)};return U(h),{transactionQueue:g,environment:h}}},52389:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(49085);class o extends i.default{getInitialState(){return{open:!1}}}const r=new o},44756:(e,t,n)=>{"use strict";n.r(t),n.d(t,{createClientEnvironment:()=>Te});var i=n(26263),o=n(45631),r=n(87997),s=n(58287),a=n(94023),l=n(91814),c=n(27328),d=n(42389),u=n(20475),p=n(99747),h=n(47839),m=n(22974),g=n(97978),f=n(12955);const v={CHROME:{TOKEN:"ArlWUsTSaH+4IS65MeoOwbwM1RkZx0YWwbDOsbbhEO5z4EsRp080qH8QB0XBn5XywqlgmNGT/LT4ZgQ86H+uxg4AAABzeyJvcmlnaW4iOiJodHRwczovL25vdGlvbi5zbzo0NDMiLCJmZWF0dXJlIjoiVW5yZXN0cmljdGVkU2hhcmVkQXJyYXlCdWZmZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlfQ==",MIN_CHROME_VERSION:92,MAX_CHROME_VERSION:124},EDGE:{TOKEN:"As03mCvy9PkdYPuaxaAQd49kbGn160q43XejPevCbQpnYeq3h4xvFd8/n1720wNf5ZQNzIvbbhDIBUZAJafg/5oAAABzeyJvcmlnaW4iOiJodHRwczovL25vdGlvbi5zbzo0NDMiLCJpc1N1YmRvbWFpbiI6dHJ1ZSwiZmVhdHVyZSI6IlVucmVzdHJpY3RlZFNoYXJlZEFycmF5QnVmZmVyIiwiZXhwaXJ5IjoxNzE0MDY5NDUyfQ=="}};function y(e){return!!e.isBrowser&&(!!function(e){if(!e.isChrome)return!1;if("Edge"===e.browserName)return!0;try{const t=Number(e.browserVersion.split(".")[0]),{MIN_CHROME_VERSION:n,MAX_CHROME_VERSION:i}=v.CHROME;return t>=n&&t<=i}catch(t){return!1}}(e)&&("localhost"!==window.location.hostname||"3003"===window.location.port))}var b=n(69151),S=n(69475),x=(n(21703),n(68626)),k=n(7032),w=n(65044),j=n(77892);const M=[WebSocket.OPEN,WebSocket.CONNECTING];class C{constructor(){this.sqliteConnection=void 0,this.requests=new Map}async initialize(){if(h.electronApi&&h.electronApi.sqliteServerEnabled){await this.initializeWebSocket();const e={execSqliteBatchV2:async e=>{const t=(0,k.ZP)(),{batch:n,precondition:i}=e,o=JSON.stringify({id:t,batch:n,precondition:i,auth:this.authToken});return await this.execSqliteBatchInner(t,o)},execSqliteBatch:async e=>{const t=(0,k.ZP)(),n=JSON.stringify({id:t,batch:e,auth:this.authToken});return await this.execSqliteBatchInner(t,n)}};this.sqliteConnection=new w.s({connection:e,type:"v2",migrations:await(0,j.kk)(e)})}}async execSqliteBatchInner(e,t){const n=new Promise((t=>{this.requests.set(e,t)}));this.ws.readyState===WebSocket.CLOSED&&await this.initializeWebSocket();try{this.ws.send(t)}catch(o){const e=this.ws;this.ws.onopen=function(n){e.send(t)}}const i=await n;if(i.error)throw new Error("Received SQLite error.");return i.value}async initializeWebSocket(){if(!h.electronApi||!h.electronApi.getSqliteMeta)return;const e=await h.electronApi.getSqliteMeta();if(e.error)return;if(this.ws&&M.includes(this.ws.readyState))return;const{serverProcessPort:t,authToken:n}=e.value;this.authToken=n;const i=`ws://127.0.0.1:${t}`;this.ws=new WebSocket(i),this.ws.onclose=()=>{x.log({level:"warning",from:"electronSqlite",type:"reinitializingWebsocket"}),this.initializeWebSocket()},this.ws.addEventListener("message",(e=>{const t=e.data.toString(),{id:n,result:i}=JSON.parse(t),o=this.requests.get(n);o&&(this.requests.delete(n),o({value:i}))})),await new Promise((e=>{this.ws.onopen=()=>{e()}}))}}const I=Symbol("Comlink.proxy"),P=Symbol("Comlink.endpoint"),T=Symbol("Comlink.releaseProxy"),L=Symbol("Comlink.finalizer"),_=Symbol("Comlink.thrown"),A=e=>"object"==typeof e&&null!==e||"function"==typeof e,E=new Map([["proxy",{canHandle:e=>A(e)&&e[I],serialize(e){const{port1:t,port2:n}=new MessageChannel;return R(e,t),[n,[n]]},deserialize:e=>(e.start(),O(e))}],["throw",{canHandle:e=>A(e)&&_ in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function R(e,t=globalThis,n=["*"]){t.addEventListener("message",(function i(o){if(!o||!o.data)return;if(!function(e,t){for(const n of e){if(t===n||"*"===n)return!0;if(n instanceof RegExp&&n.test(t))return!0}return!1}(n,o.origin))return void console.warn(`Invalid origin '${o.origin}' for comlink proxy`);const{id:r,type:s,path:a}=Object.assign({path:[]},o.data),l=(o.data.argumentList||[]).map(q);let c;try{const t=a.slice(0,-1).reduce(((e,t)=>e[t]),e),n=a.reduce(((e,t)=>e[t]),e);switch(s){case"GET":c=n;break;case"SET":t[a.slice(-1)[0]]=q(o.data.value),c=!0;break;case"APPLY":c=n.apply(t,l);break;case"CONSTRUCT":c=function(e){return Object.assign(e,{[I]:!0})}(new n(...l));break;case"ENDPOINT":{const{port1:t,port2:n}=new MessageChannel;R(e,n),c=function(e,t){return N.set(e,t),e}(t,[t])}break;case"RELEASE":c=void 0;break;default:return}}catch(d){c={value:d,[_]:0}}Promise.resolve(c).catch((e=>({value:e,[_]:0}))).then((n=>{const[o,a]=W(n);t.postMessage(Object.assign(Object.assign({},o),{id:r}),a),"RELEASE"===s&&(t.removeEventListener("message",i),Z(t),L in e&&"function"==typeof e[L]&&e[L]())})).catch((e=>{const[n,i]=W({value:new TypeError("Unserializable return value"),[_]:0});t.postMessage(Object.assign(Object.assign({},n),{id:r}),i)}))})),t.start&&t.start()}function Z(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function O(e,t){return U(e,[],t)}function z(e){if(e)throw new Error("Proxy has been released and is not useable")}function B(e){return K(e,{type:"RELEASE"}).then((()=>{Z(e)}))}const V=new WeakMap,F="FinalizationRegistry"in globalThis&&new FinalizationRegistry((e=>{const t=(V.get(e)||0)-1;V.set(e,t),0===t&&B(e)}));function U(e,t=[],n=function(){}){let i=!1;const o=new Proxy(n,{get(n,r){if(z(i),r===T)return()=>{!function(e){F&&F.unregister(e)}(o),B(e),i=!0};if("then"===r){if(0===t.length)return{then:()=>o};const n=K(e,{type:"GET",path:t.map((e=>e.toString()))}).then(q);return n.then.bind(n)}return U(e,[...t,r])},set(n,o,r){z(i);const[s,a]=W(r);return K(e,{type:"SET",path:[...t,o].map((e=>e.toString())),value:s},a).then(q)},apply(n,o,r){z(i);const s=t[t.length-1];if(s===P)return K(e,{type:"ENDPOINT"}).then(q);if("bind"===s)return U(e,t.slice(0,-1));const[a,l]=D(r);return K(e,{type:"APPLY",path:t.map((e=>e.toString())),argumentList:a},l).then(q)},construct(n,o){z(i);const[r,s]=D(o);return K(e,{type:"CONSTRUCT",path:t.map((e=>e.toString())),argumentList:r},s).then(q)}});return function(e,t){const n=(V.get(t)||0)+1;V.set(t,n),F&&F.register(e,t,e)}(o,e),o}function D(e){const t=e.map(W);return[t.map((e=>e[0])),(n=t.map((e=>e[1])),Array.prototype.concat.apply([],n))];var n}const N=new WeakMap;function W(e){for(const[t,n]of E)if(n.canHandle(e)){const[i,o]=n.serialize(e);return[{type:"HANDLER",name:t,value:i},o]}return[{type:"RAW",value:e},N.get(e)||[]]}function q(e){switch(e.type){case"HANDLER":return E.get(e.name).deserialize(e.value);case"RAW":return e.value}}function K(e,t,n){return new Promise((i=>{const o=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.addEventListener("message",(function t(n){n.data&&n.data.id&&n.data.id===o&&(e.removeEventListener("message",t),i(n.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:o},t),n)}))}var H=n(52629),G=n(1898),$=n(97448),Q=n(77144),Y=n(37850);class J{constructor(e){this.initializePromise=void 0,this.initializePromise=new Y._W(this.initialize(e))}async waitForInitialize(){await this.initializePromise.wrappedPromise}async execSqliteBatch(e){const{status:t}=this.initializePromise.state;if("pending"===t||"rejected"===t)return{body:this.emptyResults(e)};if("resolved"===t){return this.initializePromise.state.value.execSqliteBatch(e)}(0,G.t1)(t)}async initialize(e){await e.initialize();const t={execSqliteBatch:e.execSqliteBatch,execSqliteBatchV2:e.execSqliteBatchV2};return new w.s({connection:t,type:"v2",migrations:await(0,j.kk)(t)})}emptyResults(e){return e.body.map((e=>"getData"in e?{type:"DataOk",data:[]}:{type:"Ok"}))}}class X{constructor(){this.sqliteConnection=void 0,this.sqliteConnection=new J(O(new Worker(new URL(n.p+n.u(7244),n.b))))}static createInstance(){const e=(0,$.fastGetGroup)("browser_sqlite");switch(e){case"on":ee("loading");const t=new X;return t.waitForInitialize().then((()=>{ee("success")}),(e=>{ee("error"),x.log({level:"error",from:"clientEnvironment",type:"wasmSqliteInitializeError",error:(0,H.Ui)(e)})})),t;case"control":return void ee("skipped-control-group");case void 0:return void ee("skipped-undefined-group");default:(0,G.t1)(e)}}async waitForInitialize(){return await this.sqliteConnection.waitForInitialize()}}function ee(e){Q.Z.state.metricData.update((t=>({...t,wasm_sqlite_initialized:e})))}var te=n(758),ne=n(77080),ie=n(49085),oe=n(70203),re=n(77907);class se extends ie.default{getInitialState(){return{loading:!1,loaded:!1}}async loadIfNeeded(e){if(this.state.loaded||this.state.loading)return;const t=e();if(!t)return;if(0===oe.CGe(t).length)return;const n=re.deps.katex.loader();this.setState({loading:!0,loaded:!1,result:n}),this.setState({loading:!1,loaded:!0,result:await n})}getKatex(){if(this.state.loaded)return this.state.result}}var ae=n(15157),le=n(44615),ce=n(606),de=n(21202),ue=n(53965),pe=n(19584),he=n(54642),me=n(2688),ge=n(53730);class fe extends ie.default{static getCacheKey(e){return`LocalBacklinkStore2:${e}`}getInitialState(){return{}}initializeBacklinks(e){let{block:t,currentUserId:n,environment:i}=e;if(this.instanceState[t.id])return;const o=this.getCachedBacklinkState({blockId:t.id,currentUserId:n});o?this.setState({...this.instanceState,[t.id]:{state:o,loaded:!0}}):this.setState({...this.instanceState,[t.id]:{state:{backlinks:[],inaccessibleBacklinkCount:0},loaded:!1}}),ve(i,t),this.startMessageListeners(t,i)}awaitLoaded(e){return this.waitUntil((()=>{const t=this.state[e];return Boolean(t&&t.loaded)}))}destroyBacklinks(e,t){this.stopMessageListeners(e,t),delete this.instanceState[e]}getBacklinkState(e){let{blockId:t,currentUserId:n}=e;const i=this.state[t];return i?i.state:this.getCachedBacklinkState({blockId:t,currentUserId:n})||{backlinks:[],inaccessibleBacklinkCount:0}}setBacklinkState(e){let{blockId:t,state:n,currentUserId:i}=e;this.setCachedBacklinkState({blockId:t,state:n,currentUserId:i});const o=this.state[t];o&&this.setState({...this.state,[t]:{...o,state:n,loaded:!0}})}updateBacklinks(e){const{createdBacklinks:t,deletedBacklinks:n,currentUserId:i}=e,o=(0,pe.cf)(t),r=(0,pe.cf)(n),s=o.reduce(((e,t)=>{const{block_id:n}=t;return e[n]=e[n]?[...e[n],t]:[t],e}),{}),a=r.reduce(((e,t)=>{const{block_id:n}=t;return e[n]=e[n]?[...e[n],t]:[t],e}),{}),l=new Set([...Object.keys(s),...Object.keys(a)]);return l.forEach((e=>{const t=s[e]||[],n=a[e]||[],o=this.getBacklinkState({blockId:e,currentUserId:i}),r=t.filter((e=>!o.backlinks.some((t=>ue.Xy(e,t))))),l=[...o.backlinks,...r].filter((e=>!n.some((t=>ue.Xy(e,t)))));this.setBacklinkState({blockId:e,state:{...o,backlinks:l},currentUserId:i})})),Array.from(l)}resetBacklinkState(e){let{blockIds:t,currentUserId:n}=e;for(const i of t)this.setCachedBacklinkState({blockId:i,state:{backlinks:[],inaccessibleBacklinkCount:0},currentUserId:n})}getCachedBacklinkState(e){let{blockId:t,currentUserId:n}=e;return ae.Z.get({userId:n,key:fe.getCacheKey(t)})}setCachedBacklinkState(e){let{blockId:t,state:n,currentUserId:i}=e;return ae.Z.set({userId:i,key:fe.getCacheKey(t),value:n})}async startMessageListeners(e,t){const n=ce.dr.fromSpaceShardRecordId(e,de.iU);ge.transactionQueue.isPendingTransactionForRecord(n)&&await ge.transactionQueue.drain();const i=this.instanceState[n.id];if(!i)return;let o,r=!1;const s=ue.P2(((n,i)=>{const s=o,a=i||void 0;o=a,r?s!==a&&ve(t,e):r=!0}),1e3),a=(0,le.Mv)(n.id);i.messageStoreListenerReference=me.ZP.addListener(a,s,void 0,t)}stopMessageListeners(e,t){const n=this.instanceState[e];n&&n.messageStoreListenerReference&&(me.ZP.removeListener(n.messageStoreListenerReference,t),n.messageStoreListenerReference=void 0)}}async function ve(e,t){await ge.transactionQueue.awaitRecordTransaction({id:t.id,table:de.iU});const n=await he.getBacklinksForBlock(e,{block:t});"failed"!==n.type&&e.LocalBacklinkStore.setBacklinkState({blockId:t.id,state:{backlinks:n.data.backlinks,inaccessibleBacklinkCount:n.data.inaccessibleBacklinkCount},currentUserId:e.currentUser.id})}class ye extends ie.default{getInitialState(){return{isOpen:!1,subMenuType:null,menuType:null,shouldRestoreSelectionForMenu:!0,enableShouldShowDebugging:!1}}clear(e){this.update((t=>({...t,menuType:null,shouldRestoreSelectionForMenu:e})))}async clearNativeActionMenuAndRestoreSelectionIfNecessary(){null!==this.state.menuType&&(this.clear(!0),await Y.Vs(10))}}function be(e){return`PageDetailsStore:${e.type}:${e.id}`}class Se extends ie.default{getInitialState(){return{}}static getDefaultToggleState(e){return"discussion"===e.type||"backlinks"!==e.type&&void(0,G.t1)(e)}getToggleState(e){const t=be(e);if(t in this.state)return this.state[t]}setToggleState(e,t){const n=be(e);this.setState({...this.state,[n]:t})}}n(57658);var xe=n(54153);const ke="spellcheckEnabled";class we{constructor(e){let{device:t}=e;this.enabled=void 0,this.currentLanguages=void 0;const n=xe.Z.get(ke);this.setEnabled(void 0===n||n)}setEnabled(e){var t,n;(this.enabled=e,xe.Z.set(ke,e),null!==(t=h.electronApi)&&void 0!==t&&t.setSpellCheckerEnabled)&&(null===(n=h.electronApi)||void 0===n||n.setSpellCheckerEnabled(e))}isEnabled(){return this.enabled}getCorrections(e){return e.dictionarySuggestions}addToDictionary(e){var t;null!==(t=h.electronApi)&&void 0!==t&&t.addToDictionary&&h.electronApi.addToDictionary(e)}setLanguages(e){var t;ue.Xy(this.currentLanguages,e)||(this.currentLanguages=e,null!==(t=h.electronApi)&&void 0!==t&&t.setSpellCheckerLanguages&&h.electronApi.setSpellCheckerLanguages(0===e.length?[navigator.language]:e))}async getLanguages(){var e;const t=new Intl.DisplayNames([navigator.language],{type:"language"}),n=[];if(null!==(e=h.electronApi)&&void 0!==e&&e.getSpellCheckerLanguages){const e=await h.electronApi.getSpellCheckerLanguages();for(const i of e)n.push({code:i,name:t.of(i)})}return n}async getAvailableLanguages(){var e;const t=new Intl.DisplayNames([navigator.language],{type:"language"}),n=[];if(null!==(e=h.electronApi)&&void 0!==e&&e.getAvailableSpellCheckerLanguages){const e=await h.electronApi.getAvailableSpellCheckerLanguages();for(const i of e)n.push({code:i,name:t.of(i)})}return n}}var je=n(14577);class Me extends je.Z{}const Ce=["nativeRedirect","page","space","nativeTab","onboarding","unsubscribe","unknown","uiDoc","root","chat","settingsConsoleOrganization"],Ie=[...Ce,"login","signup","quickSearch"];let Pe=0;async function Te(e){var t,n;const{minimalEnvironment:v,prefetchCache:x}=e,{device:k,mobileNative:w,cookieService:j}=v,M=""+Pe++,I=k.isElectron&&Boolean(null===(t=h.electronApi)||void 0===t?void 0:t.sqliteServerEnabled)?await async function(e){var t;if(!e.device.isElectron||null===(t=h.electronApi)||void 0===t||!t.sqliteServerEnabled)return;const n=new C;return await n.initialize(),n}({device:k}):void 0,P=y(k)?X.createInstance():void 0,T=new l.Z,L=new c.Xk,_=new u.Z;let A;A=null!==(n=h.electronApi)&&void 0!==n&&n.getAvailableSpellCheckerLanguages?new we({device:k}):new te.P({device:k});const E=(null==w?void 0:w.sqliteConnection)||(null==I?void 0:I.sqliteConnection)||(null==P?void 0:P.sqliteConnection),R=E?new S.A({connection:E,maxSize:k.isDesktop?1e6:1e5,verifyRecordPointerMismatches:true}):void 0,Z=new o.q({inMemoryRecordCache:new i.Z({name:"default",verifyRecordPointerMismatches:true}),persistedRecordCache:R});P&&P.waitForInitialize().catch((()=>{Z.disablePersistedRecordCache()}));const O=function(e){const{device:t,RouterStore:n,ThemeStore:i}=e;let o=Ce;return(t.isElectron||t.isMobileNative)&&(o=Ie),new Me((()=>{const e=n.state.route;return e&&o.includes(e.name)?i.state.mode:"light"}),{debugName:"ThemeModeStore"})}({device:k,RouterStore:T,ThemeStore:_}),z=k.isMobile?new ye:void 0,B=await f.getPublicDomainUserId({device:k,mobileNative:w,cookieService:j}),V={key:M,AppUpdateStore:new s.D,device:k,WindowSizeStore:new p.j({device:k},window,{mobileBrowserRemoveBottomPaddingHack:ne.default.checkGate("mobile_browser_remove_bottom_padding_hack")}),KeyboardShortcutStackStore:new a.h({device:k}),defaultRecordCache:Z,mobileNative:w,RouterStore:T,ThemeStore:_,ThemeModeStore:O,ElectronSqlite:I,KatexStore:new se,LocalBacklinkStore:new fe,PageDetailsStore:new Se,updateCurrentUserId:void 0,currentUser:new r.CurrentUser,SpellCheckStore:A,NativeMobileActionBarStore:z,TextSelectionCompositionStore:new d.h,recordSubscriptionActions:b,prefetchCache:x,TabbedRouterStore:L,cookieService:j,publicDomainUserId:B};return m.LH(V),R&&R.setTrackWithDynamicSampling((e=>g.kB({environment:V,...e}))),V}},69475:(e,t,n)=>{"use strict";n.d(t,{A:()=>f,l:()=>v});n(21703),n(57658);var i=n(28084),o=n(68626),r=n(55652),s=n(45953),a=n(21202),l=n(49984),c=n(35092),d=n(12139),u=n(66504),p=n(53965),h=n(52629),m=n(84693);let g=1;class f{constructor(e){let{connection:t,maxSize:n,verifyRecordPointerMismatches:a}=e;this.trackWithDynamicSampling=void 0,this.getLatency=new r.s,this.batchReadWorkers=15,this.connection=void 0,this.maxSize=void 0,this.verifyRecordPointerMismatches=void 0,this.pendingWrites=s.Ao.create(),this.getManyFromDisk=async e=>{const t=s.Ao.create();e.forEach(((e,n)=>{let{pointer:i}=e;t.set(i,n)}));const n=await m.Q6(this.connection,e),i=s.Ao.create();for(const o of n)this.setCachedRecordMap(i,o);return e.map((e=>{let{pointer:t,userId:n}=e;const o=this.getInMemory(t,n);if(o)return o;const r=i.get(t);return r&&r[n]}))},this.diskReadQueue=new i.Z({batchSize:Math.floor(c.mz/3)-1,maxWorkers:this.batchReadWorkers>0?this.batchReadWorkers:1,performRequests:this.getManyFromDisk}),this.flushWrites=async()=>{const e=this.pendingWrites;this.pendingWrites=s.Ao.create();const t=p.VS(Array.from(e),(e=>{let{value:t}=e;return t?Object.values(t):[]}));try{var n;await m.Y3(this.connection,this.maxSize,t),null===(n=this.trackWithDynamicSampling)||void 0===n||n.call(this,{eventName:"sqlite_record_cache.flush_writes",eventProperties:{status:"success"},options:{preboot:!0,defaultSampleRateOverride:0}})}catch(r){var i;o.log({level:"warning",from:"SqliteRecordCache",type:"applyRecordCacheOperationsError",error:{...(0,h.Ui)(r),miscDataString:JSON.stringify(this.getExtraDataForReadOrWriteError(r))}},{forceSuppressConsoleLog:!0}),null===(i=this.trackWithDynamicSampling)||void 0===i||i.call(this,{eventName:"sqlite_record_cache.flush_writes",eventProperties:{status:"error"},options:{preboot:!0,defaultSampleRateOverride:0}})}},this.debouncedFlushWrites=p.Ds(this.flushWrites,500,{maxWait:3e3}),this.connection=t,this.maxSize=n,this.verifyRecordPointerMismatches=a}waitForInitialize(){var e,t;return(null===(e=(t=this.connection).waitForInitialize)||void 0===e?void 0:e.call(t))||Promise.resolve()}set(e,t,n,i,r){if(void 0===e||void 0===e.id){const t=new Error("Attempting to set a record with an invalid pointer.");return o.log({level:"error",from:"SqliteRecordCache",type:"SqliteRecordCache.setBadPointer",error:{message:"Attempting to set a record with an invalid pointer.",stack:t.stack},data:{pointer:e}}),void d.IE(t)}const s={pointer:e,userId:i=i||u.I,value:t,timestamp:Date.now(),importance:n};this.removePendingWrite(e,i,"delete"),this.enqueueWrite({type:"set",record:s,maybeStaleRecord:r})}async get(e,t){const n=`get ${g}`;t=t||u.I,g++,this.getLatency.start(n);try{const a=this.getInMemory(e,t);if(a){var i;if(this.enqueueWrite({type:"access",record:a}),this.getLatency.end(n,"memory"),this.verifyRecordPointerMismatches&&(a.pointer.id!==e.id||a.pointer.table!==e.table||a.value&&a.value.value&&a.value.value.id!==e.id))o.log({level:"warning",from:"SqliteRecordCache.ts",type:"FetchedPointerMismatch",error:(0,h.Ui)(new Error("Value returned does not match pointer when fetching via inMemoryResult")),data:{miscDataToConvertToString:{requestedPointer:e,fetchedPointer:a.pointer,fetchedId:null===(i=a.value)||void 0===i||null===(i=i.value)||void 0===i?void 0:i.id}}});return a.value}const l=await(this.batchReadWorkers>0?this.diskReadQueue.enqueue({pointer:e,userId:t}):this.getFromDiskUnbatched(e,t));if(l){var r,s;if(this.enqueueWrite({type:"access",record:l}),this.getLatency.end(n,"disk"),null===(r=this.trackWithDynamicSampling)||void 0===r||r.call(this,{eventName:"sqlite_record_cache.get_record",eventProperties:{status:"success"},options:{preboot:!0,defaultSampleRateOverride:0}}),this.verifyRecordPointerMismatches&&(l.pointer.id!==e.id||l.pointer.table!==e.table||l.value&&l.value.value&&l.value.value.id!==e.id))o.log({level:"warning",from:"SqliteRecordCache.ts",type:"FetchedPointerMismatch",error:(0,h.Ui)(new Error("Value returned does not match pointer when fetching via diskResult")),data:{miscDataToConvertToString:{requestedPointer:e,fetchedPointer:l.pointer,fetchedId:null===(s=l.value)||void 0===s||null===(s=s.value)||void 0===s?void 0:s.id}}});return l.value&&"comment"===l.pointer.table&&v.commentIds.add(l.pointer.id),l.value&&"notion_user"===l.pointer.table&&v.userIds.add(l.pointer.id),l.value}}catch(l){var a;return o.log({level:"warning",from:"SqliteRecordCache",type:"getError",error:{...(0,h.Ui)(l),miscDataString:JSON.stringify(this.getExtraDataForReadOrWriteError(l))}},{forceSuppressConsoleLog:!0}),void(null===(a=this.trackWithDynamicSampling)||void 0===a||a.call(this,{eventName:"sqlite_record_cache.get_record",eventProperties:{status:"error"},options:{preboot:!0,defaultSampleRateOverride:0}}))}finally{this.getLatency.end(n,"miss")}}deleteRecord(e,t){t=t||u.I,this.removePendingWrite(e,t,"set"),this.enqueueWrite({type:"delete",record:{pointer:e,userId:t}})}async getBlocksWithParent(e){const t=Date.now(),n=e.userId||u.I,i=await m.lR(this.connection,{...e,timestamp:t,userId:n}),o=s.Ao.create(),r=p.oA(Array.from(this.pendingWrites).map((i=>{const r=i&&i.value&&n&&i.value[n];if(!r||"set"!==r.type)return;const s=r.record.value?r.record.value.value:void 0;if(!s)return;if(r.record.pointer.table!==a.iU)return;const l=s;return l.parent_id===e.parent.id&&l.parent_table===e.parent.table?(o.set(r.record.pointer,!0),r.record.timestamp<t&&(r.record.timestamp=t),r.record.value):void 0})));for(const s of i)o.get(s.pointer)||this.getInMemory(s.pointer,s.userId)||r.push(s.value);return r}async getPageBlocksByParent(e){const t=Date.now(),n=e.userId||u.I,i=await m.GF(this.connection,{...e,timestamp:t,userId:n});return i.forEach((e=>{this.enqueueWrite({type:"access",record:{pointer:e.pointer,timestamp:t,userId:n,importance:void 0,value:e.value}})})),i}async reset(){this.pendingWrites=s.Ao.create(),await m.G$(this.connection)}setTrackWithDynamicSampling(e){this.trackWithDynamicSampling=e}enqueueWrite(e){this.debouncedFlushWrites();const{pointer:t,userId:n}=e.record,i=this.pendingWrites.get(t),o=i&&i[n];if(o){if("set"===o.type&&"access"===e.type){const t={type:"set",record:{...o.record,timestamp:e.record.timestamp}};return void this.setCacheOperationMap(this.pendingWrites,t)}const t="set"===o.type&&!o.maybeStaleRecord&&o.record.value&&o.record.value.value?o.record.value.value.version:void 0,n="set"===e.type&&e.maybeStaleRecord&&e.record.value&&e.record.value.value?e.record.value.value.version:void 0;if("number"==typeof t&&"number"==typeof n&&t>=n)return}this.setCacheOperationMap(this.pendingWrites,e)}async getFromDiskUnbatched(e,t){const[n]=await this.getManyFromDisk([{pointer:e,userId:t}]);return n}getInMemory(e,t){const n=this.pendingWrites.get(e),i=n&&n[t];if(i&&"set"===i.type)return i.record}setCacheOperationMap(e,t){const n=t,{pointer:i,userId:o}=n.record,r=e.get(i)||{};e.set(i,{...r,[o]:n})}setCachedRecordMap(e,t){const{pointer:n,userId:i}=t,o=e.get(n)||{};e.set(n,{...o,[i]:t})}removePendingWrite(e,t,n){const i=this.pendingWrites.get(e);i&&i[t]&&i[t].type===n&&this.pendingWrites.delete(e)}getExtraDataForReadOrWriteError(e){return{errorSql:(0,l.l)(e)?e.debugInfo.errorSql:void 0,lastSuccessfulSqlBatch:e instanceof l.q2?e.debugInfo.lastSuccessfulSqlBatch:void 0,sqliteCode:(0,l.l)(e)?e.debugInfo.sqliteCode:void 0}}}const v={commentIds:new Set([]),userIds:new Set([])}},43604:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=n(49085).default.createValue({open:!1})},74055:(e,t,n)=>{"use strict";n.d(t,{V:()=>o,Z:()=>s});var i=n(49085);let o=function(e){return e.IN_APP_CALLOUT_CONFLICT="in-app callout conflict",e.DARK_MODE="not shown in dark mode",e}({});class r extends i.default{getInitialState(){return{isVisible:!1,suppressReason:void 0}}}const s=new r},96071:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(49085);class o extends i.default{getInitialState(){return{open:!1}}}const r=o},12309:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(49085),o=n(7032);class r extends i.default{getInitialState(){return{modalInfoById:{}}}async showModal(e){const t=(0,o.ZP)();return new Promise((n=>{const i=e((e=>{n(e),this.internalCloseModal(t,(()=>{this.internalRemoveModal(t)}))}));this.update((e=>({modalInfoById:{...e.modalInfoById,[t]:{...i,isOpen:!0}}})))}))}internalRemoveModal(e){this.update((t=>{const n={...t.modalInfoById};return delete n[e],{modalInfoById:n}}))}internalCloseModal(e,t){this.update((n=>({modalInfoById:{...n.modalInfoById,[e]:{...n.modalInfoById[e],isOpen:!1,onClosed:t}}})))}}const s=new r},82855:(e,t,n)=>{"use strict";n.d(t,{E:()=>r});n(67294);var i=n(45238),o=n(85893);const r=(0,i.IU)("chevronDownRounded",{viewBox:"0 0 15 9",svg:(0,o.jsx)("path",{d:"M7.92188 8.65625C8.19531 8.64844 8.44531 8.54688 8.64844 8.32812L14.5859 2.25C14.7578 2.07812 14.8516 1.85938 14.8516 1.60156C14.8516 1.08594 14.4453 0.671875 13.9297 0.671875C13.6797 0.671875 13.4375 0.773438 13.2578 0.953125L7.92969 6.42969L2.58594 0.953125C2.40625 0.78125 2.17188 0.671875 1.91406 0.671875C1.39844 0.671875 0.992188 1.08594 0.992188 1.60156C0.992188 1.85938 1.08594 2.07812 1.25781 2.25L7.20312 8.32812C7.41406 8.54688 7.64844 8.65625 7.92188 8.65625Z"})})},64878:(e,t,n)=>{"use strict";n.d(t,{h:()=>r});n(67294);var i=n(45238),o=n(85893);const r=(0,i.IU)("dot",{viewBox:"0 0 5 4",svg:(0,o.jsx)("circle",{cx:"2.5",cy:"2",r:"2"})})},25278:(e,t,n)=>{"use strict";n.d(t,{H:()=>r});n(67294);var i=n(45238),o=n(85893);const r=(0,i.IU)("eyes",{viewBox:"0 0 72 72",svg:(0,o.jsx)("path",{d:"M17.0312 64.4375C26.25 64.4375 33.5625 52.9688 33.5625 36.4375C33.5625 19.9062 26.25 8.46875 17.0312 8.46875C7.8125 8.46875 0.5 19.9062 0.5 36.4375C0.5 52.9688 7.8125 64.4375 17.0312 64.4375ZM54.9688 64.4375C64.1875 64.4375 71.5 52.9688 71.5 36.4375C71.5 19.9062 64.1875 8.46875 54.9688 8.46875C45.75 8.46875 38.4375 19.9062 38.4375 36.4375C38.4375 52.9688 45.75 64.4375 54.9688 64.4375ZM10.0625 47.1875C15.125 47.1875 18.4688 43.6562 18.4688 38.3438C18.4688 33.0938 15.125 29.5625 10.0625 29.5625C7.6875 29.5625 5.71875 30.3125 4.25 31.6875C5.375 19.9375 10.6875 11.9375 17.0312 11.9062C24.25 11.875 30.125 22.0312 30.125 36.4375C30.125 50.7812 24.25 60.9688 17.0312 61C11.5312 61.0312 6.78125 54.9688 4.90625 45.5938C6.28125 46.625 8.03125 47.1875 10.0625 47.1875ZM47.9688 47.1875C53 47.1875 56.4062 43.6562 56.4062 38.3438C56.4062 33.0938 53 29.5625 47.9688 29.5625C45.5938 29.5625 43.5938 30.3438 42.1562 31.6875C43.2812 19.9375 48.5938 11.9375 54.9688 11.9375C62.1562 11.9062 68 22.0938 68 36.4375C68 50.7812 62.1562 60.9688 54.9688 60.9688C49.4375 61 44.6875 54.9375 42.7812 45.5938C44.1562 46.5938 45.9375 47.1875 47.9688 47.1875ZM45.5312 37.4062C44.4375 37.25 43.75 35.9688 44.0312 34.6562C44.3125 33.3125 45.3125 32.3438 46.375 32.5312C47.4688 32.75 48.0938 34.0312 47.8438 35.3125C47.5938 36.6562 46.5938 37.5938 45.5312 37.4062ZM7.625 37.4062C6.53125 37.25 5.84375 35.9688 6.09375 34.6562C6.375 33.3125 7.40625 32.3438 8.4375 32.5312C9.5625 32.7812 10.1875 34.0312 9.9375 35.3125C9.6875 36.6562 8.65625 37.5938 7.625 37.4062Z"})})},70954:(e,t,n)=>{"use strict";n.d(t,{C:()=>r});n(67294);var i=n(45238),o=n(85893);const r=(0,i.IU)("notionLogoStroked",{viewBox:"0 0 41 42",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M4.253 2.903h0-.01c-1.02.09-1.806.481-2.322 1.142-.5.642-.671 1.441-.671 2.21v23.228c0 1.267.47 2.316 1.416 3.577h0l.006.008 4.99 6.477h0l.005.005c.465.593.963 1.017 1.617 1.256.63.23 1.33.26 2.138.221h.01l24.652-1.49h.008c1.137-.08 2.038-.396 2.632-1.071.588-.668.746-1.543.746-2.431V9.904c0-.584-.133-1.05-.508-1.486-.27-.311-.669-.602-1.113-.925a54.305 54.305 0 01-.176-.13l-.007-.004-.005-.004-6.772-4.761c-.838-.609-1.516-1.017-2.365-1.21-.824-.187-1.75-.156-3.047-.044L4.253 2.903z",fill:"#fff",stroke:"#fff",strokeWidth:"1.5"}),(0,o.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M25.257 3.158L5.176 4.637c-1.62.14-2.184 1.197-2.184 2.464v21.971c0 .987.352 1.83 1.198 2.959l4.72 6.126c.776.987 1.48 1.198 2.96 1.127l23.32-1.408c1.973-.14 2.537-1.057 2.537-2.606V10.552c0-.801-.316-1.032-1.25-1.714l-.16-.117-6.41-4.507c-1.55-1.126-2.184-1.268-4.65-1.056zM12.4 10.146c-1.904.129-2.337.158-3.418-.72l-2.75-2.183c-.28-.283-.14-.635.565-.705L26.102 5.13c1.62-.141 2.466.423 3.1.916l3.311 2.394c.141.07.493.492.07.492L12.645 10.13l-.245.016zM10.179 35.06V14.074c0-.916.281-1.338 1.126-1.41l22.898-1.337c.777-.07 1.128.423 1.128 1.338v20.844c0 .916-.14 1.691-1.41 1.761l-21.91 1.268c-1.269.07-1.832-.352-1.832-1.48zm21.63-19.86c.141.635 0 1.268-.635 1.34l-1.056.21v15.492c-.916.493-1.761.775-2.466.775-1.128 0-1.41-.352-2.255-1.408l-6.905-10.845v10.493l2.185.493s0 1.267-1.763 1.267l-4.86.282c-.142-.282 0-.986.492-1.127l1.269-.351V17.947l-1.761-.142c-.141-.634.21-1.549 1.197-1.62l5.214-.351 7.187 10.986V17.1l-1.832-.21c-.14-.776.422-1.339 1.127-1.409l4.863-.283z",fill:"#222"})]})})},18613:(e,t,n)=>{"use strict";n.r(t),n.d(t,{clearNotionLocalStorageWithNoPermission:()=>r});var i=n(46637),o=n(72128);function r(){i.Z.removeAllIfNoPermission(),o.Z.removeAllIfNoPermission()}},27117:(e,t,n)=>{var i=n(17187),o=n(35717);function r(e){if(!(this instanceof r))return new r(e);"number"==typeof e&&(e={max:e}),e||(e={}),i.EventEmitter.call(this),this.cache={},this.head=this.tail=null,this.length=0,this.max=e.max||1e3,this.maxAge=e.maxAge||0}e.exports=r,o(r,i.EventEmitter),Object.defineProperty(r.prototype,"keys",{get:function(){return Object.keys(this.cache)}}),r.prototype.clear=function(){this.cache={},this.head=this.tail=null,this.length=0},r.prototype.remove=function(e){if("string"!=typeof e&&(e=""+e),this.cache.hasOwnProperty(e)){var t=this.cache[e];return delete this.cache[e],this._unlink(e,t.prev,t.next),t.value}},r.prototype._unlink=function(e,t,n){this.length--,0===this.length?this.head=this.tail=null:this.head===e?(this.head=t,this.cache[this.head].next=null):this.tail===e?(this.tail=n,this.cache[this.tail].prev=null):(this.cache[t].next=n,this.cache[n].prev=t)},r.prototype.peek=function(e){if(this.cache.hasOwnProperty(e)){var t=this.cache[e];if(this._checkAge(e,t))return t.value}},r.prototype.set=function(e,t){var n;if("string"!=typeof e&&(e=""+e),this.cache.hasOwnProperty(e)){if((n=this.cache[e]).value=t,this.maxAge&&(n.modified=Date.now()),e===this.head)return t;this._unlink(e,n.prev,n.next)}else n={value:t,modified:0,next:null,prev:null},this.maxAge&&(n.modified=Date.now()),this.cache[e]=n,this.length===this.max&&this.evict();return this.length++,n.next=null,n.prev=this.head,this.head&&(this.cache[this.head].next=e),this.head=e,this.tail||(this.tail=e),t},r.prototype._checkAge=function(e,t){return!(this.maxAge&&Date.now()-t.modified>this.maxAge)||(this.remove(e),this.emit("evict",{key:e,value:t.value}),!1)},r.prototype.get=function(e){if("string"!=typeof e&&(e=""+e),this.cache.hasOwnProperty(e)){var t=this.cache[e];if(this._checkAge(e,t))return this.head!==e&&(e===this.tail?(this.tail=t.next,this.cache[this.tail].prev=null):this.cache[t.prev].next=t.next,this.cache[t.next].prev=t.prev,this.cache[this.head].next=e,t.prev=this.head,t.next=null,this.head=e),t.value}},r.prototype.evict=function(){if(this.tail){var e=this.tail,t=this.remove(this.tail);this.emit("evict",{key:e,value:t})}}},20745:(e,t,n)=>{"use strict";var i=n(73935);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot}}]);