"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[2211],{17095:(e,t,o)=>{o.d(t,{l:()=>m});o(67294);var n=o(480),r=o(24405),i=o(60493),s=o(9291),l=o(64921),a=o(26388),c=o(43224),u=o(35948),d=o(4023),p=o(85893);const g=(0,s.defineMessages)({addDescriptionTooltip:{id:"database.description.addDescriptionTooltip",defaultMessage:"Add description"},editDescriptionTooltip:{id:"database.description.editDescriptionTooltip",defaultMessage:"Edit description"}});function m(e){let{onClick:t,description:o,showTooltip:m,addDescriptionText:S,editDescriptionText:f}=e;const{isMobile:h}=(0,n.Fy)(),[y,x]=(0,u.C)(),v=(0,s.useIntl)(),C=(0,r.yK)((e=>({button:{flexShrink:0,flexGrow:0,borderRadius:h?24:20,marginLeft:4},info:{width:h?18:16,height:h?18:16,fill:x?e.regularIconColor:e.mediumIconColor}})),[x,h]);return(0,p.jsx)(a.ZP,{renderTooltip:e=>(0,p.jsx)("div",{...e,children:null!=o&&o.length?o:S??v.formatMessage(g.addDescriptionTooltip)}),disableTooltip:!m,style:c.F6,placement:d.u.Top,render:e=>(0,p.jsx)(l.Z,{...e,ref:y,onClick:t,"aria-label":null!=o&&o.length?S:f??v.formatMessage(g.editDescriptionTooltip),style:C.button,children:(0,i.N)(C.info)})})}},27871:(e,t,o)=>{o.d(t,{i:()=>g,k:()=>d});var n=o(67294),r=o(480),i=o(24405),s=o(9291),l=o(68894),a=o(72495),c=o(43224),u=o(85893);const d=(0,s.defineMessages)({descriptionHeader:{id:"database.viewSettings.propertyTab.description.title",defaultMessage:"Description"},addDescription:{id:"database.viewSettings.propertyTab.description.addDescription",defaultMessage:"Add a description..."}}),p=60;function g(e){let{initialDescription:t,handleSaveDescription:o,disableAutoSection:g}=e;const[m,S]=(0,n.useState)(t??""),f=(0,n.useRef)(m),{isMobile:h}=(0,r.Fy)(),y=(0,s.useIntl)(),x=(0,i.yK)((e=>({title:{display:"flex",alignItems:"center",gap:4,cursor:"default",color:e.mediumTextColor},infoTooltip:{width:300,whiteSpace:"normal"},menuItem:{padding:h?"8px 0":void 0},descriptionInput:{lineHeight:"20px",fontSize:h?14:13}})),[h]),v=(0,n.useCallback)((()=>o(f.current)),[o]);(0,n.useEffect)((()=>()=>v()),[v]);const C=(0,n.useMemo)((()=>(0,u.jsx)(l.ZP,{value:m,onChange:e=>{S(e.target.value),f.current=e.target.value},onBlur:v,onSubmit:v,placeholder:y.formatMessage(d.addDescription),focusInitial:!0,disabled:!1,style:x.menuItem,inputOuterStyle:x.descriptionInput,textarea:!0,textareaSubmitOnEnter:!0,maxlength:c.pT,autosize:!0,autosizeMaxHeight:p,showClearButton:!1})),[m,y,v,x.descriptionInput,x.menuItem]);return h&&!g?(0,u.jsx)(a.Z,{topBorder:!0,title:(0,u.jsx)("span",{style:x.title,children:y.formatMessage(d.descriptionHeader)}),children:C}):C}},34464:(e,t,o)=>{o.d(t,{V:()=>T,m:()=>P});var n=o(67294),r=o(480),i=o(76487),s=o(86628),l=o(49085),a=o(92996),c=o(7289),u=o(34296),d=o(47453),p=o(9291),g=o(37810),m=o(8406),S=o(5149),f=o(94419),h=o(9953),y=o(13447),x=o(40663),v=o(75330),C=o(72495),b=o(89014),j=o(43696),w=o(97372),M=o(94166),k=o(32628),V=o(85893);function P(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,c=(0,r.O7)(),[h]=(0,n.useState)((()=>l.default.createValue(""))),b=(0,i.Z)(),[j,P,I]=(0,s.VK)((()=>[t.collectionViewBlockStore(),t.collectionStore(),t.getCollectionViewBlockSourceState()]),[t]),F=(0,s.VK)((()=>h.state),[h]);return j?(0,V.jsx)(w.ZP,{...e,title:(0,V.jsx)(p.FormattedMessage,{defaultMessage:"Select data source",id:"database.viewSettings.createViewSourceTab.title"}),handleClose:()=>{m.tW({environment:c,eventName:"abandoned_search",queryLength:F.length,sessionId:b,source:u.S.Source}),S.E3({collectionSettingsStore:o})},footer:"uninitialized"===I&&(0,V.jsx)(C.Z,{topBorder:!0,children:(0,V.jsx)(M.Z,{icon:d.R,isGray:!0,title:F?(0,V.jsx)(p.FormattedMessage,{defaultMessage:"New database “{filterText}”",id:"database.viewSettings.createViewSourceTab.newCollectionWithNameButton.title",values:{filterText:(0,V.jsx)("span",{style:{...g.Z.textOverflowStyle,fontWeight:g.Z.fontWeight.medium,maxWidth:160,display:"inline-block",verticalAlign:"bottom"},children:F})}}):(0,V.jsx)(p.FormattedMessage,{defaultMessage:"New database",id:"database.viewSettings.createViewSourceTab.newCollectionButton.title"}),onClick:()=>function(e,t,o,n){m.wd({environment:o,collectionContextStore:e,action:"select_new_collection"}),S.E3({collectionSettingsStore:t});const r=e.collectionViewStore(),i=e.collectionViewBlockStore();r&&i&&S.nr({environment:o,selectedDBType:a.br,collectionName:n,collectionContextStore:e,collectionViewBlockStore:i,collectionViewStore:r,useTemporaryRecordCache:!1,baseViewType:"table"})}(t,o,c,F)})}),children:(0,V.jsx)(k.Z,{collectionContextStore:t,selectedCollectionStore:P,parentStore:j,onAccept:e=>function(e,t,o,n){y.createAndCommit({userAction:"CollectionSettingsCreateViewSource.handleSourcePickerAccept",environment:t,perform:n=>{v.yc({environment:t,collectionContextStore:o,collectionStore:e,transaction:n});const r=o.collectionViewStore(),i=o.collectionViewBlockStore(),s=e.getParentBlockStore();r&&s&&null!=i&&i.isDefined()&&(0,x.h7)(i)&&f.BE({parent:s.getCollectionViewsStore(),insert:r,transaction:n})}}),T({environment:t,collectionStore:e,collectionContextStore:o,collectionSettingsStore:n})}(e,c,t,o),context:u.S.Source,inputStore:h,searchSessionId:b})}):null}async function T(e){var t;const{environment:o,collectionStore:n,collectionContextStore:r,collectionSettingsStore:i}=e,s=r.collectionViewBlockStore(),l=r.collectionViewStore(),a=n.getParentBlockStore();if(!s||!a||!l)return;const u=null===(t=n.getModel())||void 0===t?void 0:t.getNormalizedSchema();if("chart"===l.getType()&&u){const e=l.getFormat(),t=e.chart_config;if("placeholder"!==(null==t?void 0:t.type))return;let n;if("column"===t.placeHolderType||"line"===t.placeHolderType?n=(0,c.K0)({collectionSchema:u,axisChartType:t.placeHolderType}):"donut"===t.placeHolderType?n=(0,c.dq)({collectionSchema:u}):t.placeHolderType,!n)return;return y.createAndCommit({userAction:"slashMenu.create.barChartView",environment:o,perform:t=>{h.sW({store:l.getFormatStore(),transaction:t,data:{...e,hide_linked_collection_name:!0,chart_config:n}})}}),void i.setState({open:!0,stack:[{type:"main"}]})}await Promise.all([...a.getCollectionViewStores().map((e=>e.load())),...s.getCollectionViewStores().map((e=>e.load()))]);(0,j.g)({collectionStore:n,sourceCollectionViewBlockStore:a,currentCollectionViewBlockStore:s,currentCollectionViewStore:l,constraints:(0,b.x)(l.id)}).length>0?S.H4({collectionSettingsStore:i,item:{type:"duplicateExistingView"}}):S.H4({collectionSettingsStore:i,item:{type:"createView"}})}},43696:(e,t,o)=>{o.d(t,{Z:()=>Z,g:()=>_});o(57658),o(67294);var n=o(83355),r=o(26263),i=o(49085),s=o(56666),l=o(47453),a=o(9291),c=o(53965),u=o(8406),d=o(5149),p=o(9953),g=o(13447),m=o(75330),S=o(20616),f=o(68155),h=o(10906),y=o(73657),x=o(52275),v=o(68894),C=o(32163),b=o(72495),j=o(33929),w=o(89014),M=o(29798),k=o(6258),V=o(97372),P=o(94166),T=o(85893);const I=(0,a.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a view…",id:"database.viewSettings.duplicateExistingViewTab.inputPlaceholder"}});class F extends n.Z{constructor(){super(...arguments),this.temporaryRecordCache=new r.Z({name:"CollectionSettingsDuplicateExistingView"}),this.lastDuplicatedViewId=void 0,this.originalCollectionPointer=void 0,this.didAccept=!1,this.preselectedViewPointer=void 0,this.storeTypes={inputStore:i.default.createClass(""),menuListStore:M.Z,limitStore:i.default.createClass(!0)},this.handlePreviewCollectionView=e=>{this.duplicateViewSettings(e,!0)},this.handlePreviewCollectionViewDebounced=c.Ds(this.handlePreviewCollectionView,500),this.handleMenuListStoreChange=()=>{const e=this.stores.menuListStore.state,{device:t}=this.environment;if(void 0===e.focus.indexGlobal||t.isMobile)return;const o=R(this.props.collectionContextStore,this.stores.inputStore,this.stores.limitStore).viewStores[e.focus.indexGlobal];o&&this.handlePreviewCollectionViewDebounced(o)},this.handleDuplicateViewAccept=e=>{const{collectionSettingsStore:t,collectionContextStore:o}=this.props;this.environment.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(this.temporaryRecordCache),u.wd({environment:this.environment,collectionContextStore:o,action:"click_duplicate_view"}),this.duplicateViewSettings(e,!1),d.wl({collectionSettingsStore:t,item:{type:"main",selectViewNameInitial:!0}}),this.didAccept=!0},this.handleNewEmptyViewClick=()=>{const{collectionSettingsStore:e,collectionContextStore:t}=this.props;u.wd({environment:this.environment,collectionContextStore:t,action:"click_new_empty_view"}),d.E3({collectionSettingsStore:e}),d.H4({collectionSettingsStore:e,item:{type:"createView"}}),this.didAccept=!0}}UNSAFE_willMount(e){const{collectionContextStore:t}=e,{device:o}=this.environment,n=t.collectionStore(),r=t.collectionViewStore();if(!r)return;const i=(0,w.x)(r.id);this.preselectedViewPointer=null==i?void 0:i.viewPointer,this.originalCollectionPointer=null==n?void 0:n.pointer,this.environment.defaultRecordCache.inMemoryRecordCache.addCacheOverride(this.temporaryRecordCache),this.stores.menuListStore.addListener(this.handleMenuListStoreChange);const{viewStores:s}=R(this.props.collectionContextStore,this.stores.inputStore,this.stores.limitStore),[l]=s;!o.isMobile&&l&&this.duplicateViewSettings(l,!0)}willUnmount(){if(this.environment.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(this.temporaryRecordCache),this.stores.menuListStore.removeListener(this.handleMenuListStoreChange),!this.didAccept){const{viewStores:e}=R(this.props.collectionContextStore,this.stores.inputStore,this.stores.limitStore),t=this.lastDuplicatedViewId?e.find((e=>e.id===this.lastDuplicatedViewId)):e[0];if(!t)return;this.duplicateViewSettings(t,!1)}}renderComponent(){const{inputStore:e,menuListStore:t,limitStore:o}=this.stores,{device:n}=this.environment,r=e.state,{viewStores:i,showMore:u}=R(this.props.collectionContextStore,this.stores.inputStore,this.stores.limitStore),d=c.oA(i.map((e=>{const t=e.getType(),o=e.getFormat().collection_view_icon;if(!t||"page"===t)return;const n=e.getName(),r=e.id;return{key:r,render:e=>{var i;return(0,T.jsx)(x.Z,{...e,title:(0,T.jsx)(f.Z,{collectionViewType:t,collectionViewName:n}),icon:(0,T.jsx)(S.F,{color:"regular",viewIcon:o,viewType:t,style:{marginRight:6}}),checkState:(null===(i=this.preselectedViewPointer)||void 0===i?void 0:i.id)===r})},action:()=>{this.handleDuplicateViewAccept(e)}}})));if(u>0){const e={key:"showMore",render:e=>(0,T.jsx)(x.Z,{...e,icon:(0,s.o)({width:16,height:16,color:this.theme.mediumTextColor}),style:{color:this.theme.mediumTextColor},title:(0,T.jsx)(a.FormattedMessage,{defaultMessage:"Show {showMore} more",id:"database.viewSettings.duplicateExistingViewTab.showMore.title",values:{showMore:u}})}),action:()=>{o.setState(!1)}};d.push(e)}return(0,T.jsxs)(V.ZP,{...this.props,title:(0,T.jsx)(a.FormattedMessage,{defaultMessage:"Copy an existing view",id:"database.viewSettings.duplicateExistingViewTab.title"}),footer:(0,T.jsx)(b.Z,{topBorder:!0,children:(0,T.jsx)(P.Z,{icon:l.R,isGray:!0,title:(0,T.jsx)(a.FormattedMessage,{defaultMessage:"New empty view",id:"database.viewSettings.duplicateExistingViewTab.newEmptyViewButton.title"}),onClick:this.handleNewEmptyViewClick})}),children:[(u>0||r)&&(0,T.jsx)(b.Z,{children:(0,T.jsx)(v.ZP,{focusInitial:!n.isMobile||void 0,value:r,onChange:n=>{e.setState(n.target.value),t.setState({focus:{section:0,indexLocal:0,indexGlobal:0}}),o.setState(!0)},placeholder:j.default.formatMessage(I.inputPlaceholder),showClearButton:!0})}),d.length>0&&(0,T.jsx)(C.Z,{type:C.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,T.jsx)(b.Z,{...e}),items:d}],store:t}),0===d.length&&(0,T.jsx)(y.Z,{caption:(0,T.jsx)(a.FormattedMessage,{defaultMessage:"No results",id:"database.viewSettings.duplicateExistingViewTab.noResultsTitle"})})]})}duplicateViewSettings(e,t){if(e.id===this.lastDuplicatedViewId&&t)return;this.lastDuplicatedViewId=e.id;const{collectionContextStore:o}=this.props,n=o.collectionViewStore(),r=e.getType();if(!n||!r)return;const i=e.getName(),s=e.getPageSort(),l=e.getFormat(),a=e.getKeyStore("query2").getValue();let c=n;t&&(c=n.clone(this.temporaryRecordCache)),g.createAndCommit({userAction:"CollectionSettingsDuplicateExistingView.duplicateViewSettings",environment:this.environment,perform:e=>{p.sW({store:c,data:{name:i,type:r,page_sort:s,format:{...l,collection_pointer:this.originalCollectionPointer},query2:a},transaction:e})}}),m.Ip({collectionContextStore:o})}}function _(e){const{collectionStore:t,sourceCollectionViewBlockStore:o,currentCollectionViewBlockStore:n,currentCollectionViewStore:r,constraints:i}=e;let s=c.mN([...n.getCollectionViewStores(),...o.getCollectionViewStores()],(e=>e.id)).filter((e=>{var o;return(null===(o=e.getCollectionStore())||void 0===o?void 0:o.id)===t.id&&e.id!==r.id&&"page"!==e.getType()}));if(null!=i&&i.viewType&&(s=[...s.filter((e=>e.getType()===i.viewType)),...s.filter((e=>e.getType()!==i.viewType))]),null!=i&&i.viewPointer){const{id:e}=i.viewPointer,t=s.find((t=>t.pointer.id===e))||k.Xr.createChildStore(o,i.viewPointer);s=[t,...s.filter((t=>t.pointer.id!==e))]}return s}F.displayName="CollectionSettingsDuplicateExistingView";const Z=(0,a.injectIntl)(F);function R(e,t,o){const n=e.collectionViewBlockStore(),r=e.collectionStore(),i=e.collectionViewStore();if(!n||!r||!i)return{viewStores:[],showMore:0};const s=t.state,l=r.getParentBlockStore();if(!n||!l)return{viewStores:[],showMore:0};let a=_({collectionStore:r,sourceCollectionViewBlockStore:l,currentCollectionViewBlockStore:n,currentCollectionViewStore:i,constraints:(0,w.x)(i.id)}),c=0;return s?a=a.filter((e=>(0,h.D)(e,s))):o.state&&(c=a.length-7,a=a.slice(0,7)),{viewStores:a,showMore:c}}},71214:(e,t,o)=>{o.d(t,{I:()=>m});var n=o(67294),r=o(480),i=o(86628),s=o(49085),l=o(40107),a=o(27153),c=o(68894),u=o(2520),d=o(33929),p=o(85893);const g=s.default.createClass(""),m=n.forwardRef((function(e,t){const{placeholder:o,focusInitial:s,selectAll:m,disabled:S,inputOuterStyle:f,iconButton:h,inputRightButton:y,initialValue:x,onBlur:v,onSubmit:C}=e,b=(0,r.O7)(),j=(0,i.qz)(e.inputStore,g),w=(0,i.VK)((()=>j.state),[j]),M=(0,n.useCallback)((()=>{v(w)}),[w,v]),k=(0,n.useCallback)((()=>{C(w)}),[w,C]),V=(0,n.useCallback)((e=>{j.setState(e.target.value)}),[j]),P=(0,l.S)();return(0,n.useEffect)((()=>{j.setState(x)}),[]),(0,n.useEffect)((()=>()=>{P()&&x!==w&&v(w)}),[x,w,P,v]),(0,p.jsx)(c.ZP,{ref:t,focusInitial:s,selectAll:m,value:w,onChange:V,onBlur:M,onSubmit:k,placeholder:o,disabled:S,textWrapperStyle:{opacity:S?.7:void 0},inputOuterStyle:f,left:h&&(0,p.jsx)(c.DO,{icon:h.icon,iconStyle:h.iconStyle,onClick:e=>function(e,t,o){if(!(o&&e.target instanceof Element))return;const n=d.default.getIntl(),{onSubmit:r,enforceIconColor:i,includeEmojiTab:s}=o;a.$(t,{originRect:e.target.getBoundingClientRect(),originGap:3,popupHeight:u.DQ,popupWidth:u.rw,showArrow:!0,title:n.formatMessage({defaultMessage:"Icon",id:"mediaPicker.tabs.icon"}),currentTab:"icon",tabs:s?[{type:"emoji",onChange:(e,t)=>{r(e),t&&t.keepVisible||a.Z()}},{type:"icon",enforceIconColor:i,onChange:(e,t)=>{r(e),t&&t.keepVisible||a.Z()}}]:[{type:"icon",enforceIconColor:i,onChange:(e,t)=>{r(e),t&&t.keepVisible||a.Z()}}],onDelete:()=>{r(),a.Z()}})}(e,b,h),disabled:S}),showClearButton:!1,inputRight:y})}))},23159:(e,t,o)=>{o.d(t,{Z:()=>l});o(67294);var n=o(9291),r=o(31701),i=o(64369),s=o(85893);function l(e){return(0,s.jsx)(i.Z,{isMultiline:!0,style:{paddingTop:8,marginLeft:16,marginRight:16,color:r.ZP.red,...e.styles},children:(0,s.jsx)(n.FormattedMessage,{id:"database.viewSettings.propertyTab.duplicatePropertyNameError",defaultMessage:"A property named {propertyName} already exists in this database.",values:{propertyName:e.propertyName}})})}},27948:(e,t,o)=>{o.d(t,{Z:()=>n});const n=(0,o(9291).defineMessages)({inputPlaceholder:{defaultMessage:"Property name",id:"database.viewSettings.propertyTab.propertyName"},autofillOffLabel:{defaultMessage:"Off",id:"database.viewSettings.propertyTab.autofillOffLabel"},autofillOnLabel:{defaultMessage:"On",id:"database.viewSettings.propertyTab.autofillOnLabel"},keptUpToDateWithNotionAITooltip:{defaultMessage:"Auto-updated by AI",id:"database.tableHeaderCell.tooltipAiAutofillDescription"}})},29657:(e,t,o)=>{o.d(t,{$o:()=>z,Fv:()=>N,IL:()=>Y,J4:()=>K,KA:()=>O,Nf:()=>L,_p:()=>Q,cQ:()=>H,f$:()=>E,fX:()=>W,j2:()=>A,k2:()=>$,mg:()=>J,mz:()=>U,oP:()=>D,tF:()=>X,td:()=>G,x:()=>q});o(57658);var n=o(30120),r=o(1302),i=o(15145),s=o(92996),l=o(94714),a=o(53877),c=o(42875),u=o(15157),d=o(53965),p=o(1898),g=o(36610),m=o(8406),S=o(54569),f=o(75134),h=o(5149),y=o(96802),x=o(9953),v=o(79978),C=o(75754),b=o(26999),j=o(24677),w=o(993),M=o(98104),k=o(13447),V=o(75330),P=o(10906),T=o(75079),I=o(88632),F=o(77080),_=o(6258),Z=o(27724),R=o(81023),B=o(4430);function A(e){const{collectionViewStore:t,collectionContextStore:o,timelineState:n,environment:r}=e,i=r.currentUser.id,s=(0,B.B8)(t.id),l=(0,B.pQ)(t,r),a=o.permissionScopes.state,c=d.Ds((()=>{if(n.destroyed)return;const e={zoomLevel:n.zoomLevel.state,centerTimestamp:(0,B.al)(n)};u.Z.set({userId:i,key:s,value:e})}),1e3),p=d.Ds((()=>{if(n.destroyed||!I.Z.state.online||!r.currentUser.isLoggedIn()||!a.canConfigureBlock)return;const e={zoomLevel:n.zoomLevel.state,centerTimestamp:(0,B.al)(n)},o=t.getFormat().timeline_preference;d.Xy(o,e)||k.createAndCommit({userAction:"collectionTimelineViewActions.setRemotePreference",environment:r,perform:o=>{y.FH({stores:[t],update:{timeline_preference:e},transaction:o})}})}),5e3);n.savePreference=()=>{c(),p()},L({timelineState:n,environment:r,...l})}function L(e){const{timelineState:t,zoomLevel:o,centerTimestamp:n,environment:i}=e,{savePreference:s}=t,l=i.WindowSizeStore.state.width+2*B.Ge,a=(0,B.x2)(o,l),c=n-a/2,u=n+a/2;t.zoomLevel.setState(o),t.currentRange.setState({startTimestamp:c,endTimestamp:u}),r.default.afterNextFlush((()=>{O({timelineState:t,centerTimestamp:n}),s&&s()}))}function O(e){const{timelineState:t,centerTimestamp:o}=e,{horizontalScroller:n,outerSizeObserver:r}=t;if(!n)return;const i=t.zoomLevel.state,{startTimestamp:s,endTimestamp:l}=t.currentRange.state,a=r.rect.state.width;if(a===(0,B.e$)(i,l-s))return;const c=(0,B.e$)(i,o-s)-a/2;n.scrollLeft=c,t.scrollLeft.setState(c)}function D(e){const{environment:t,store:o,query:n,date:r,schema:i,transaction:s}=e,{timeline_by:l}=n;if(!l)return;const a=o.getAssociatedCollectionStore(),c=(null==a?void 0:a.getMappedProperty(l))??l,u=n.timeline_by_end?(null==a?void 0:a.getMappedProperty(n.timeline_by_end))??n.timeline_by_end:void 0,d=(0,B.TW)({store:o,dateValue:r,query:n,schema:(null==a?void 0:a.getSchema())??i}),p=o.getPropertyValue(c),g=u?o.getPropertyValue(u):void 0;return x.sW({store:o.getPropertiesStore(),data:d,transaction:s}),f.H({environment:t,store:o,dateProperty:{id:c,newValue:(null==d?void 0:d[c])??[],oldValue:p},otherDateProperty:u?{id:u,newValue:(null==d?void 0:d[u])??[],oldValue:g}:void 0}),o}function N(e){var t;const{environment:o,timelineState:r,collectionStore:i,collectionContextStore:s,store:l,query:u,groupFormat:d,transaction:p}=e,g=r.zoomLevel.state,m=(0,B.al)(r),{snapUnit:f,getDateRangePlaceholderDuration:h}=B.BJ[g],{timeline_by:y}=u;if(!y)return;const x=null===(t=s.groupsStore.getGroupState(d))||void 0===t?void 0:t.resultsStore.state;if(!x)return;const v=n.ou.fromMillis(m),C=(0,B.DS)(v,f),b=(0,B.DS)(h(v),f),j=(0,B.AZ)({startValue:(0,a.Lg)((0,c.r)()),snapUnit:f,desiredStart:C,desiredEnd:b});return D({environment:o,store:l,query:u,schema:i.getSchema(),date:j,transaction:p}),S.$T({environment:o,collectionStore:i,before:!0,store:x[0],insertStores:[l],collectionContextStore:s,groupsPointer:d?[d]:[],transaction:p}),l}function E(e){const{type:t,timelineState:o,store:n,startX:r,query:i,schema:s,intl:l,environment:a}=e,{horizontalScroller:c}=o,{startTimestamp:u}=o.currentRange.state;if(!c)return;j.Ys({environment:a,store:n});const p=c.scrollLeft,{stores:g}=Z.default.state,m=d.oA(g.map((e=>{const t=(0,B.bk)({store:e,query:i,schema:s,userId:a.currentUser.id,intl:l});if(t)return{startValue:t,store:e}})));o.dragState.setState({type:t,startStore:n,stores:m.map((e=>{let{store:t}=e;return t})),startValues:m.map((e=>{let{startValue:t}=e;return t})),temporaryValues:m.map((e=>{let{startValue:t}=e;return t})),startX:r,startStartTimestamp:u,startScrollLeft:p})}function K(e){const{timelineState:t,store:o,startX:n,startY:r,schema:i,collectionContextStore:s,verticalScroller:l}=e,{horizontalScroller:a}=t,{startTimestamp:c}=t.currentRange.state;if(!a||!l)return;const u=a.scrollLeft,d=l.scrollTop,p=(0,B.YE)(s,o,i);t.drawState.setState({startStore:o,startDependencyRelationPointers:p,temporaryDependencyRelationPointers:[...p],startX:n,startY:r,startScrollLeft:u,startScrollTop:d,startStartTimestamp:c,xOffsetPx:0,yOffsetPx:0,tryToCompleteDrawnArrow:!1})}function G(e){const{timelineState:t,currentX:o}=e,{horizontalScroller:n}=t,r=t.zoomLevel.state,i=t.dragState.state,{startTimestamp:s}=t.currentRange.state;if(!i||!n)return;const{type:l,startStartTimestamp:c,startValues:u,startScrollLeft:g,startX:m,startStore:S,stores:f}=i,h=B.BJ[r],{snapUnit:y}=h,x=n.scrollLeft-g+(o-m)+(0,B.e$)(r,s-c),v=(0,B.x2)(r,x),C=u[f.indexOf(S)];let b;if(l===B.px.LeftResizer){const{start:e}=(0,B.XO)(C,y),t=e.plus(v);b=u.map((e=>{const o=(0,B.AZ)({startValue:e,snapUnit:y,desiredStart:t});return(0,a.gW)(o)}))}else if(l===B.px.RightResizer){const{end:e}=(0,B.XO)(C,y),t=e.plus(v);b=u.map((e=>{const o=(0,B.AZ)({startValue:e,snapUnit:y,desiredEnd:t});return(0,a.Qq)(o)}))}else l===B.px.ItemDrag?b=u.map((e=>{const{start:t,end:o}=(0,B.XO)(e,y),n=t.plus(v),r=n.plus(o.valueOf()-t.valueOf());return(0,B.AZ)({startValue:e,snapUnit:y,desiredStart:n,desiredEnd:r})})):(0,p.t1)(l);d.Xy(i.temporaryValues,b)||t.dragState.setState({...i,temporaryValues:b})}function U(e){const{timelineState:t,currentX:o,currentY:n,verticalScroller:r}=e,i=t.drawState.state,s=t.zoomLevel.state,{startTimestamp:l}=t.currentRange.state,{horizontalScroller:a}=t;if(!i||!a||!r)return;const{startDependencyRelationPointers:c,startStore:u,startX:p,startY:g,startScrollLeft:m,startScrollTop:S,startStartTimestamp:f}=i,h=a.scrollLeft,y=r.scrollTop,x=h-m+(o-p)+(0,B.e$)(s,l-f),v=y-S+(n-g),C=t.hoveredItem.state;if(C&&C!==u&&!c.some((e=>e.id===C.id))){const e=[...c,{table:"block",id:C.id,spaceId:C.getSpaceId()}];d.Xy(i.temporaryDependencyRelationPointers,e)||t.drawState.setState({...i,temporaryDependencyRelationPointers:e,xOffsetPx:void 0,yOffsetPx:void 0})}else t.drawState.setState({...i,temporaryDependencyRelationPointers:[...c],xOffsetPx:x,yOffsetPx:v})}function W(e){const{environment:t,collectionContextStore:o,timelineState:n,query:r,schema:i,transaction:s}=e,l=n.dragState.state,{timeline_by:a}=r;if(!l||!a)return;const{temporaryValues:c,stores:u}=l;c.forEach(((e,n)=>{const l=u[n];D({environment:t,store:l,query:r,schema:i,transaction:s,date:e}),m.rv({environment:t,collectionContextStore:o,block_id:l.id,property:a,property_type:"date",from:"timeline"})})),n.dragState.setState(void 0)}function z(e){var t;const{timelineState:o,environment:n,transaction:r,collectionContextStore:i,isFullScreen:s,isRootChild:l}=e,a=o.drawState.state,c=o.dateRangePlaceholder.state;if(!a)return;const{startStore:u,startDependencyRelationPointers:d,temporaryDependencyRelationPointers:p}=a;if(!u)return void o.drawState.setState(void 0);let S;if(c.active){const{date:e,store:t,parentStore:s,groupFormat:l,newTimelineItemProps:a,existingTimelineItemProps:d}=c;if(t&&d){const{query:o,schema:i}=d;D({environment:n,store:t,query:o,schema:i,date:e,transaction:r}),S={table:"block",id:t.id,spaceId:u.getSpaceId()}}else if(a){const{query:o,schema:c,isFullScreen:d,canEditTimelineItems:p,subitemPath:g}=a,m=J({environment:n,date:e,store:t,parentStore:s,query:o,schema:c,isFullScreen:d,groupFormat:l,canEditTimelineItems:p,collectionContextStore:i,subitemPath:g,transaction:r,from:"timeline_complete_draw"});m&&(S={table:"block",id:m.id,spaceId:u.getSpaceId()})}o.dateRangePlaceholder.setState({active:!1})}else S=p.find((e=>!d.includes(e)));const f=(0,B._e)(i);if(f){const{property:e}=f;S&&(v.hE({environment:n,propertyWithInverse:f,sourceStore:u,destStore:_.G.createChildStore(u,S),position:{type:"after"},transaction:r}),m.rv({environment:n,collectionContextStore:i,block_id:u.id,property:e,property_type:"relation",from:"timeline",isFromBulkActionsToolbar:!1,isUnthrottled:!0})),o.drawState.setState(void 0)}else h.wl({item:{type:F.default.checkGate("dependency_date_shifting_by_space")?"dependencies":"arrowsBy"},collectionSettingsStore:i.settingsStore}),o.drawState.setState({...a,tryToCompleteDrawnArrow:!0});const y=null===(t=S)||void 0===t?void 0:t.id;y&&g.LE(n,{...(0,T.Pn)(i),...(0,B.Ii)({environment:n,collectionContextStore:i,timelineState:o,isFullScreen:s,isRootChild:l}),dependenciesPropertyID:null==f?void 0:f.property,blockedByStoreID:u.id,blockingStoreID:y})}function H(e){const{timelineState:t,environment:o}=e;t.dragState.state&&(t.dragState.setState(void 0),j.ZH(o))}function q(e){const{timelineState:t,environment:o}=e;t.drawState.state&&(t.drawState.setState(void 0),j.ZH(o))}function $(e){const{stores:t,collectionViewStore:o,schema:n,transaction:r}=e,i=o.getType(),s=o.getQuery(n),l=[];s&&("calendar"===i?s.calendar_by&&l.push(s.calendar_by):"timeline"===i&&(s.timeline_by&&l.push(s.timeline_by),s.timeline_by_end&&l.push(s.timeline_by_end)));for(const a of t)for(const e of l)w.sO({environment:a.environment,editorMode:"default",store:a.getNormalizedPropertyStore(e),value:void 0,transaction:r})}function Y(e){const{dependency:t,collectionContextStore:o,environment:n,timelineState:r,isFullScreen:i,isRootChild:s}=e,l=(0,B._e)(o),a=o.collectionStore();if(!l||!a)return;const{property:c}=l,{store:u,relationPointer:d}=t,p=u.getSchema()[c];p&&"relation"===p.type&&(k.createAndCommit({userAction:"CollectionTimelineDependenciesOverlay.handleRemoveRelation",environment:n,perform:e=>{v.Bl({environment:n,propertyWithInverse:l,sourceStore:u,destStore:_.G.createChildStore(u,d),transaction:e}),m.rv({environment:n,block_id:d.id,property:c,property_type:p.type,from:"timeline",collectionContextStore:o,isFromBulkActionsToolbar:!1,isUnthrottled:!0})}}),g.lf(n,{...(0,T.Pn)(o),...(0,B.Ii)({environment:n,collectionContextStore:o,timelineState:r,isFullScreen:i,isRootChild:s}),dependenciesPropertyID:c,blockedByStoreID:u.id,blockingStoreID:d.id}))}function X(e){const{collectionViewStore:t,newProperty:o,transaction:n}=e;y.FH({stores:[t],update:{timeline_arrows_by:{property:o}},transaction:n})}function Q(e){var t;const{collectionContextStore:o,relationPropertyId:n,transaction:r}=e,i=o.collectionStore();if(!i)return;const a=n?i.getSchema()[n]:void 0,c="relation"===(null==a?void 0:a.type)&&a.property&&"relation"===(null===(t=i.getSchema()[a.property])||void 0===t?void 0:t.type)?a.property:void 0;y.FH({stores:[i],update:{collection_default_arrows_by:n,...i.getFormat().app_config_uri===l.iS?{app_uri_map:{...i.getFormat().app_uri_map?i.getFormat().app_uri_map:{},[s.Es.BlockingRelation]:n,[s.Es.BlockedRelation]:c}}:{}},transaction:r})}function J(e){const{environment:t,transaction:o,date:n,parentStore:r,query:s,schema:l,isFullScreen:a,groupFormat:c,canEditTimelineItems:u,collectionContextStore:d,from:p}=e;if(!R.M_(t))return;const g=c?[c]:[],m=d.groupsStore.getGroupState(g);if(!m)return;if(r)return function(e){const{environment:t,transaction:o,date:n,store:r,parentStore:s,query:l,schema:a,groupFormat:c,canEditTimelineItems:u,collectionContextStore:d,subitemPath:p}=e;if(!r||!s)return;const g=c?[c]:[],m=S.yk({environment:t,collectionContextStore:d,groupsPointer:g,store:r,before:!1,collectionStore:s,transaction:o,subitemPath:p,subitemInsertDirection:"into"});if(m){if(D({environment:t,store:m,query:l,schema:a,date:n,transaction:o}),t.device.isMobile)C._c({environment:t,store:m,pageVisitSource:i.tY.Create});else if(m&&u){const e=m.getBlockTitleStore();M.N_({store:e})}return m}}(e);d.searchQuery.state&&V.Ug({searchQuery:"",collectionContextStore:d,isFullScreen:a});const f=S.IW({environment:t,collectionContextStore:d,groupsPointer:g,shouldCoerce:!0,initializeDefaultTemplate:!0,transaction:o,from:p});if(!f)return;const h=f.coercionSucceeded,y=f.newStore;if(D({environment:t,store:y,query:s,schema:l,date:n,transaction:o}),t.device.isMobile)C._c({environment:t,store:y,pageVisitSource:i.tY.Create});else if(h&&u){const e=y.getBlockTitleStore();M.NX({store:e})}else b.CH({environment:t,store:y,peekMode:(0,P.kr)(d),resultsStore:null==m?void 0:m.resultsStore,collectionContextStore:d,pageVisitSource:i.tY.Create});return y}},57820:(e,t,o)=>{o.d(t,{P:()=>H,Z:()=>$});var n=o(67294),r=o(480),i=o(86628),s=o(24405),l=o(49085),a=o(49019),c=o(47453),u=o(51454),d=o(9291),p=o(53965),g=o(8406),m=o(34993),S=o(5149),f=o(24677),h=o(98104),y=o(7801),x=o(86650),v=o(23063),C=o(37601),b=o(79131),j=o(1743),w=o(74194),M=o(89728),k=o(53437),V=o(53336),P=o(57200),T=o(24098),I=o(97004),F=o(68641),_=o(13273),Z=o(34859),R=o(61766),B=o(75330),A=o(1456),L=o(52387),O=o(45238),D=o(85893);const N=(0,O.IU)("arrowDownThick",{viewBox:"0 0 16 16",svg:(0,D.jsx)("path",{d:"M7.99316 1.52246C7.40527 1.52246 7.00195 1.93262 7.00195 2.54785V10.1357L7.07031 11.6191L5.69629 10.0332L4.1582 8.50195C3.98047 8.31738 3.74805 8.19434 3.44727 8.19434C2.91406 8.19434 2.51074 8.59082 2.51074 9.15137C2.51074 9.41113 2.61328 9.65039 2.81836 9.8623L7.26172 14.3125C7.44629 14.5039 7.72656 14.6133 7.99316 14.6133C8.2666 14.6133 8.54004 14.5039 8.72461 14.3125L13.1748 9.8623C13.3799 9.65039 13.4824 9.41113 13.4824 9.15137C13.4824 8.59082 13.0791 8.19434 12.5459 8.19434C12.252 8.19434 12.0195 8.31738 11.835 8.50195L10.2969 10.0332L8.92285 11.6191L8.98438 10.1357V2.54785C8.98438 1.93262 8.58789 1.52246 7.99316 1.52246Z"})});var E=o(22109);const K=(0,O.IU)("arrowUpThick",{viewBox:"0 0 16 16",svg:(0,D.jsx)("path",{d:"M7.99316 14.6133C8.58789 14.6133 8.98438 14.2031 8.98438 13.5879V6L8.92285 4.5166L10.2969 6.10254L11.835 7.63379C12.0195 7.81836 12.252 7.94141 12.5459 7.94141C13.0791 7.94141 13.4824 7.54492 13.4824 6.98438C13.4824 6.72461 13.3799 6.48535 13.1748 6.27344L8.72461 1.82324C8.54004 1.63184 8.2666 1.52246 7.99316 1.52246C7.72656 1.52246 7.44629 1.63184 7.26172 1.82324L2.81836 6.27344C2.61328 6.48535 2.51074 6.72461 2.51074 6.98438C2.51074 7.54492 2.91406 7.94141 3.44727 7.94141C3.74805 7.94141 3.98047 7.81836 4.1582 7.63379L5.69629 6.10254L7.07031 4.5166L7.00195 6V13.5879C7.00195 14.2031 7.40527 14.6133 7.99316 14.6133Z"})});var G=o(37810),U=o(45257);function W(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const{device:s}=(0,r.O7)(),l=(0,i.VK)((()=>o.state.open),[o]),a=(0,n.useCallback)((e=>{e&&(0,_.yT)(e.target)||S.E3({collectionSettingsStore:o})}),[o]),c=(0,n.useCallback)((()=>(0,D.jsx)(y.P,{context:F.HV.FilterBar,collectionContextStore:t,collectionSettingsStore:o,hideDesktopHeader:!0})),[t,o]);return(0,n.useEffect)((()=>()=>S.E3({collectionSettingsStore:o})),[]),(0,D.jsx)(k.ZP,{popupType:s.isMobile?k.ZP.PopupType.SlideUp:k.ZP.PopupType.Popup,open:l,origin:(0,D.jsx)(z,{collectionContextStore:t,collectionSettingsStore:o}),onDismiss:a,disableMouseCapture:!0,enableOutsideClickDismiss:!0,originGap:4,render:c})}function z(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const l=(0,r.O7)(),[a,c,u,p]=(0,i.VK)((()=>[t.currentSortsStore.state,t.localStateDiffStore.state,t.normalizedSchemaStore.state,t.permissionScopes.state]),[t]),m=a[0],f=m?u[m.property]:void 0,h=(0,n.useCallback)((()=>{g.wd({environment:l,collectionContextStore:t,action:"click_sort"}),S.wl({collectionSettingsStore:o,item:{type:"sort"}})}),[t,o,l]),y=(0,s.yK)((e=>({arrowIcon:{width:12,marginRight:4,fill:e.blueColor},arrowsIcon:{width:16,marginRight:4,fill:e.blueColor},title:{marginTop:-1,maxWidth:220,...G.Z.textOverflowStyle}})),[]);let x;return x=1===a.length?m&&"descending"===m.direction?N(y.arrowIcon):K(y.arrowIcon):(0,E.T)(y.arrowsIcon),(0,D.jsx)(U.Z,{on:!0,hasDiff:Boolean(p.canConfigureBlock&&c.sorts),icon:x,title:(0,D.jsx)("span",{style:y.title,children:1===a.length&&f?f.name:(0,D.jsx)(d.FormattedMessage,{defaultMessage:"{sortCount} sorts",id:"database.filterBar.sorts.label",values:{sortCount:a.length}})}),onClick:h})}W.displayName="CollectionViewFilterBarSort";let H=function(e){return e[e.FilterBar=0]="FilterBar",e[e.SettingsFilters=1]="SettingsFilters",e}({});const q=l.default.createClass({open:!1,stack:[]});const $=function(e){let{collectionContextStore:t,showHoverActionsStore:o,createFilterSettingsStore:n,saveControlMoreActionsButtonPopupStore:s}=e;const l=(0,r.MO)(),a=(0,i.qz)(s,R.Z),c=(0,i.qz)(n,q),d=(0,i.VK)((()=>(0,I.Nq)(t)),[t]),p=(0,i.VK)((()=>l&&t.searchOpen.state),[l,t]),g=(0,i.VK)((()=>t.currentPropertyFiltersStore.state),[t]),m=(0,i.VK)((()=>t.currentSortsStore.state),[t]),S=(0,i.VK)((()=>t.shouldShowSource.state?8:12),[t]),f=(0,i.VK)((()=>t.filterBarSortSettingsStore.state.open),[t]),h=m.length>0||f,y=(0,i.VK)((()=>t.permissionScopes.state),[t]),x=(0,i.VK)((()=>y.canConfigureBlock?t.currentCombinatorFilterStore.state:void 0),[y,t]);return(0,D.jsxs)("div",{style:{width:"100%",zIndex:u._Y},onClick:e=>function(e,t){t.filtersBarOpen.setState(!0)}(0,t),children:[(0,D.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[p&&(0,D.jsx)(oe,{collectionContextStore:t}),!p&&(0,D.jsx)("div",{style:{position:"relative",flexGrow:0,overflow:"hidden"},children:(0,D.jsx)(V.Z,{type:Z.Z.X,style:{display:"flex",alignItems:"center",paddingTop:S,paddingBottom:8},showLeftRightOverlay:!l,children:l?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(ne,{collectionContextStore:t}),h&&(0,D.jsx)(X,{collectionContextStore:t}),h&&!l&&(0,D.jsx)(J,{}),x&&(0,D.jsx)(Y,{collectionContextStore:t}),(0,D.jsx)(te,{collectionContextStore:t,propertyFilters:g}),(0,D.jsx)(se,{collectionContextStore:t,showHoverActionsStore:o,createFilterSettingsStore:c})]}):(0,D.jsxs)(D.Fragment,{children:[h&&(0,D.jsx)(X,{collectionContextStore:t}),h&&!l&&(0,D.jsx)(J,{}),x&&(0,D.jsx)(Y,{collectionContextStore:t}),(0,D.jsx)(te,{collectionContextStore:t,propertyFilters:g}),(0,D.jsx)(se,{collectionContextStore:t,showHoverActionsStore:o,createFilterSettingsStore:c})]})})}),(0,D.jsxs)("div",{style:{display:"flex",alignItems:"center",marginLeft:"auto"},children:[!l&&d&&(0,D.jsx)(re,{collectionContextStore:t,showHoverActionsStore:o,saveControlMoreActionsButtonPopupStore:a}),!l&&(0,D.jsx)(P.Z,{collectionContextStore:t})]})]}),l&&!p&&(0,D.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[d&&(0,D.jsx)(re,{collectionContextStore:t,showHoverActionsStore:o,saveControlMoreActionsButtonPopupStore:a}),(0,D.jsx)(P.Z,{collectionContextStore:t})]})]})};function Y(e){let{collectionContextStore:t}=e;return(0,D.jsx)(A.B,{context:H.FilterBar,collectionSettingsStore:t.filterBarCombinatorFilterSettingsStore,collectionContextStore:t})}function X(e){let{collectionContextStore:t}=e;return(0,D.jsx)(W,{collectionContextStore:t,collectionSettingsStore:t.filterBarSortSettingsStore},"sort")}function Q(e){let{filter:t,collectionContextStore:o}=e;const n=(0,i.VK)((()=>o.getFilterBarItemSettingsStore(t)),[o,t]);return(0,D.jsx)(L.Z,{id:t.id,context:H.FilterBar,collectionContextStore:o,collectionSettingsStore:n},t.id)}function J(){const e=(0,s.Fg)();return(0,D.jsx)("div",{style:{borderRight:`1px solid ${e.regularDividerColor}`,height:24,marginRight:12,marginLeft:8}})}function ee(e){e.searchOpen.setState(!1),e.searchQuery.setState("")}function te(e){let{propertyFilters:t,collectionContextStore:o}=e;const n=(0,r.O7)();if((0,i.VK)((()=>o.permissionScopes.state),[o]).canConfigureBlock){const e=t.map((e=>e.id));return(0,D.jsx)(b.ZP,{direction:"horizontal",keys:e,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,renderKey:e=>{const n=t.find((t=>t.id===e));if(n)return(0,D.jsx)(Q,{collectionContextStore:o,filter:n})},style:{display:"flex",flexShrink:0},onDrop:e=>function(e,t,o){if(!o.collectionViewBlockStore())return;const n=o.currentPropertyFiltersStore.state,r=p.oA(e.map((e=>n.find((t=>t.id===e)))));m.iU({environment:t,collectionContextStore:o,temporaryState:{...o.temporaryState.state,propertyFilters:{value:r}}}),g.wd({environment:t,collectionContextStore:o,action:"reorder_filters"})}(e,n,o)})}return(0,D.jsx)(D.Fragment,{children:t.map((e=>(0,D.jsx)(Q,{filter:e,collectionContextStore:o},e.id)))})}function oe(e){let{collectionContextStore:t}=e;const o=(0,d.useIntl)(),n=(0,s.Fg)(),l=(0,r.O7)(),c=(0,i.VK)((()=>t.searchQuery.state),[t]);return(0,D.jsx)(j.Z,{debugName:"CollectionViewFilterBar",capture:!0,children:(0,D.jsx)(T.Z,{capture:!0,render:e=>(0,D.jsx)("div",{...e,style:{width:"100%",paddingTop:l.device.isMobile?8:12,paddingBottom:6},children:(0,D.jsx)(U.Z,{wrapStyle:{width:"100%"},innerStyle:{width:"100%"},icon:(0,a.e)({width:14,fill:n.mediumIconColor,marginRight:6}),hideChevron:!0,title:(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(w.Z,{format:w.B.Transparent,value:c,placeholder:o.formatMessage({defaultMessage:"Type to search…",id:"database.filterBar.mobileSearch.placeholder"}),onChange:e=>function(e,t){t.searchQuery.setState(e.target.value)}(e,t),autoComplete:"on",autoCorrect:"on",onBlur:()=>function(e){e.searchQuery.state||ee(e)}(t),onClearButtonClick:()=>ee(t),showClearButton:!0,focus:!l.device.isIOS||void 0,focusInitial:!0,inputStyle:{height:"100%"}}),(0,D.jsx)(C.Z,{show:!0})]})})})})})}function ne(e){let{collectionContextStore:t}=e;const o=(0,s.Fg)(),n=(0,r.O7)();return(0,D.jsx)(U.Z,{wrapStyle:{display:"flex",alignItems:"center"},icon:(0,a.e)({width:14,fill:o.mediumIconColor,marginRight:6}),hideChevron:!0,title:(0,D.jsx)("span",{style:{marginTop:-1,color:o.mediumTextColor},children:(0,D.jsx)(d.FormattedMessage,{defaultMessage:"Search",id:"database.filterBar.search.title"})}),onClick:()=>function(e,t){h.ZH(e),f.ZH(e),B.wG(),t.searchOpen.setState(!0),t.searchQuery.setState(""),g.wd({environment:e,collectionContextStore:t,action:"click_mobile_search"})}(n,t)},"search")}function re(e){let{collectionContextStore:t,showHoverActionsStore:o,saveControlMoreActionsButtonPopupStore:n}=e;return(0,D.jsx)(x.ZP,{context:x.R1.FilterBar,collectionContextStore:t,showHoverActionsStore:o,moreActionsButtonPopupStore:n})}function ie(e){let{collectionContextStore:t,createFilterSettingsStore:o}=e;return(0,D.jsx)(y.P,{context:F.HV.FilterBar,collectionContextStore:t,collectionSettingsStore:o,hideDesktopHeader:!0})}function se(e){let{collectionContextStore:t,showHoverActionsStore:o,createFilterSettingsStore:s}=e;const l=(0,r.O7)(),a=(0,n.useCallback)((e=>function(e,t){e&&(0,_.yT)(e.target)||S.E3({collectionSettingsStore:t})}(e,s)),[s]),u=(0,n.useCallback)((()=>(0,D.jsx)(ie,{collectionContextStore:t,createFilterSettingsStore:s})),[t,s]),p=(0,n.useCallback)((()=>function(e,t,o){g.wd({environment:e,collectionContextStore:t,action:"click_new_filter"}),S.wl({collectionSettingsStore:o,item:{type:"createFilter"}})}(l,t,s)),[l,t,s]),m=(0,i.VK)((()=>s.state.open),[s]),f=(0,i.VK)((()=>o.state||m),[o,m]);return(0,D.jsx)(k.ZP,{open:m,popupType:l.device.isMobile?k.kQ.SlideUp:k.kQ.Popup,origin:(0,D.jsx)(v.Z,{isVisible:!0,animationStyle:{opacity:f?1:0},render:()=>(0,D.jsx)(M.Z,{icon:c.R,isSmall:!0,isLightGray:!0,hovered:m,onClick:p,style:{fontSize:14},children:(0,D.jsx)(d.FormattedMessage,{defaultMessage:"Add filter",id:"database.filterBar.addButton.title"})})}),render:u,disableMouseCapture:!0,enableOutsideClickDismiss:!0,originGap:4,onDismiss:a})}},1456:(e,t,o)=>{o.d(t,{B:()=>v});var n=o(67294),r=o(480),i=o(86628),s=o(24405),l=o(21197),a=o(9291),c=o(37810),u=o(8406),d=o(34993),p=o(5149),g=o(7801),m=o(53437),S=o(68641),f=o(12534),h=o(13273),y=o(45257),x=o(85893);function v(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const s=(0,r.O7)(),[l,a]=(0,i.VK)((()=>[o.state.open,t.currentCombinatorFilterStore.state]),[t,o]),c=(0,n.useCallback)((()=>(0,x.jsx)(g.P,{context:S.HV.FilterBar,collectionContextStore:t,collectionSettingsStore:o,hideDesktopHeader:!0})),[t,o]),u=(0,n.useCallback)((e=>{var n;e&&(0,h.yT)(e.target)||(p.E3({collectionSettingsStore:o}),a&&0===(null===(n=a.filters)||void 0===n?void 0:n.length)&&d.iU({environment:s,collectionContextStore:t,temporaryState:{...t.temporaryState.state,combinatorFilter:{value:void 0}}}))}),[t,o,s,a]);return(0,n.useEffect)((()=>()=>p.E3({collectionSettingsStore:o})),[]),(0,x.jsx)(m.ZP,{popupType:s.device.isMobile?m.ZP.PopupType.SlideUp:m.ZP.PopupType.Popup,open:l,origin:(0,x.jsx)(C,{collectionContextStore:t,collectionSettingsStore:o}),onDismiss:u,disableMouseCapture:!0,enableOutsideClickDismiss:!0,originGap:4,render:c})}function C(e){var t;let{collectionContextStore:o,collectionSettingsStore:d}=e;const g=(0,r.O7)(),m=(0,s.yK)((e=>({icon:{width:void 0,height:g.device.isMobile?14:12,fill:e.blueColor,marginRight:6},title:{maxWidth:180,...c.Z.textOverflowStyle}})),[g.device]),[S,h]=(0,i.VK)((()=>[Boolean(o.localStateDiffStore.state.combinatorFilter),o.currentCombinatorFilterStore.state]),[o]),v=(0,n.useCallback)((()=>{h&&(p.wl({collectionSettingsStore:d,item:{type:"filter"}}),u.wd({environment:g,collectionContextStore:o,action:"click_combinator_filter"}))}),[o,d,g,h]);return h?(0,x.jsx)(y.Z,{icon:(0,l.Q)(m.icon),title:(0,x.jsx)("span",{style:m.title,children:(0,x.jsx)(a.FormattedMessage,{defaultMessage:"{ruleCount, plural, one {{ruleCount} rule} other {{ruleCount} rules}}",id:"database.filterBar.advancedFilterRulesCount.title",values:{ruleCount:(null===(t=h.filters)||void 0===t?void 0:t.length)||0}})}),on:!0,hasDiff:S,onClick:e=>(0,f.ZP)({event:e,context:f.Af.CollectionSettingsClick,callback:v})},"combinator"):null}v.displayName="CollectionViewFilterBarCombinatorFilter"},52387:(e,t,o)=>{o.d(t,{Z:()=>X});var n=o(67294),r=o(480),i=o(86628),s=o(24405),l=o(76205),a=o(12396),c=o(9291),u=o(26249),d=o(37810),p=o(8406),g=o(34993),m=o(5149),S=o(56416),f=o(53437),h=o(26388),y=o(97004),x=o(75079),v=o(12534),C=o(13273),b=o(18245),j=o(57820),w=o(45257),M=o(15070),k=o(99036),V=o(40506),P=o(76725),T=o(96367),I=o(21202),F=o(77420),_=o(6287),Z=o(19889),R=o(7928),B=o(53965),A=o(1898),L=o(76798),O=o(89845),D=o(17335),N=o(29376),E=o(6258),K=o(85893);const G=function(e){let{schema:t,propertyFilter:o,parentStore:n,valueOnly:r,style:s}=e;const a=(0,i.VK)((()=>{const e=t[o.property];if(e&&(0,k.p_)(e))return(0,N.ke)(e,n)}),[t,o,n]),{filter:u}=o,d=(0,l.a_)(u)?u.subfilter:u,p=(0,l.h6)(d)&&!(0,l.mv)(u),g={...s,maxWidth:void 0};return(0,K.jsx)("span",{style:(0,l.gE)(d)?g:s,children:(0,K.jsx)(c.FormattedMessage,{defaultMessage:"{propertyName}{colonSeparator} {filterOperator} {propertyValue}",id:"database.filterBarFilterValue.title",values:{propertyName:r?void 0:(0,K.jsx)(W,{propertyFilter:o,schema:t}),colonSeparator:r||p?void 0:":",filterOperator:(0,K.jsx)(z,{propertyFilter:o}),propertyValue:(0,K.jsx)(q,{propertyFilter:o,schema:t,parentStore:n,relatedCollectionAppConfigUri:a})}})})};function U(){return(0,K.jsx)(c.FormattedMessage,{defaultMessage:"Not",id:"database.filterBarFilterValue.notOperator"})}function W(e){let{propertyFilter:t,schema:o}=e;const n=o[t.property];return n?(0,K.jsx)("span",{style:{fontWeight:d.Z.fontWeight.medium},children:n.name}):null}function z(e){let{propertyFilter:t}=e;const{filter:o}=t,n=(0,l.a_)(o)?o.subfilter:o;if((0,l.Ly)(n))return"string_contains"===n.operator||"string_is"===n.operator?null:"string_does_not_contain"===n.operator||"string_is_not"===n.operator?(0,K.jsx)(U,{}):(0,K.jsx)(K.Fragment,{children:(0,D.WC)(n.operator)});if((0,l.h6)(n))return(0,K.jsx)(K.Fragment,{children:(0,D.WC)(n.operator)});if((0,l.XA)(n)){if("checkbox_is_not"===n.operator)return(0,K.jsx)(U,{})}else{if((0,l.dx)(n))return"enum_is"===n.operator?null:"enum_is_not"===n.operator?(0,K.jsx)(U,{}):(0,K.jsx)(K.Fragment,{children:(0,D.WC)(n.operator)});if((0,l.NU)(n))return"enum_contains"===n.operator?null:"enum_does_not_contain"===n.operator?(0,K.jsx)(U,{}):(0,K.jsx)(K.Fragment,{children:(0,D.WC)(n.operator)});if((0,l.r2)(n))return"status_is"===n.operator?null:"status_is_not"===n.operator?(0,K.jsx)(U,{}):(0,K.jsx)(K.Fragment,{children:(0,D.WC)(n.operator)});if((0,l.e)(n))return"relation_contains"===n.operator?null:"relation_does_not_contain"===n.operator?(0,K.jsx)(U,{}):(0,K.jsx)(K.Fragment,{children:(0,D.WC)(n.operator)});if((0,l.Gb)(n))return"person_contains"===n.operator?null:"person_does_not_contain"===n.operator?(0,K.jsx)(U,{}):(0,K.jsx)(K.Fragment,{children:(0,D.WC)(n.operator)});if((0,l.Mp)(n)){if("location_is"===n.operator)return null;if("location_is_not"===n.operator)return(0,K.jsx)(U,{})}else if((0,l.gE)(n)){if("date_is"===n.operator)return null;if("date_is_after"===n.operator)return(0,K.jsx)(c.FormattedMessage,{defaultMessage:"After",id:"database.filterValue.dateType.dateIsAfter.title"});if("date_is_before"===n.operator)return(0,K.jsx)(c.FormattedMessage,{defaultMessage:"Before",id:"database.filterValue.dateType.dateIsBefore.title"});if("date_is_on_or_after"===n.operator)return(0,K.jsx)(c.FormattedMessage,{defaultMessage:"On or after",id:"database.filterValue.dateType.dateIsOnOrAfter.title"});if("date_is_on_or_before"===n.operator)return(0,K.jsx)(c.FormattedMessage,{defaultMessage:"On or before",id:"database.filterValue.dateType.dateIsOnOrBefore.title"});if(!(0,l.TQ)(n))return(0,K.jsx)(K.Fragment,{children:(0,D.WC)(n.operator)});{const e=n.value;if(!e.value||"exact"!==e.type||!(0,V.gR)(e.value))return(0,K.jsx)(K.Fragment,{children:(0,D.ip)(e)});if(e.value.start_date&&e.value.end_date)return null;if(e.value.start_date)return(0,K.jsx)(c.FormattedMessage,{defaultMessage:"Starting",id:"database.filterValue.dateType.starting.title"});if(e.value.end_date)return(0,K.jsx)(c.FormattedMessage,{defaultMessage:"Ending",id:"database.filterValue.dateType.ending.title"})}}else{if((0,l.Jw)(n))return"verification_is"===n.operator?null:"verification_is_not"===n.operator?(0,K.jsx)(U,{}):(0,K.jsx)(K.Fragment,{children:(0,D.WC)(n.operator)});(0,A.t1)(n)}}return null}function H(e){let{index:t}=e;return(0,K.jsx)("span",{style:{whiteSpace:"pre"},children:(0,K.jsx)(c.FormattedMessage,{defaultMessage:", ",id:"database.filterValue.commaSeparator"})},t)}function q(e){let{propertyFilter:t,schema:o,parentStore:n,relatedCollectionAppConfigUri:r}=e;const{filter:i}=t,s=(0,l.a_)(i)?i.subfilter:i;if(!(0,l.vR)(s))return null;if((0,l.Ly)(s)||(0,l.h6)(s)){const e=s.value.value;if(void 0!==e)return(0,K.jsx)("span",{children:e})}else if((0,l.XA)(s)){const e=s.value.value;if(!0===e)return(0,K.jsx)("span",{children:(0,K.jsx)(c.FormattedMessage,{defaultMessage:"Checked",id:"database.filterValue.checkboxType.checked.title"})});if(!1===e)return(0,K.jsx)("span",{children:(0,K.jsx)(c.FormattedMessage,{defaultMessage:"Unchecked",id:"database.filterValue.checkboxType.unchecked.title"})})}else{if((0,l.dx)(s)||(0,l.NU)(s)){const e=(0,l.dx)(s)?(0,l.mg)(s):(0,l.qC)(s),t=B.oA(e.map((e=>{let{value:t}=e;return t})));return 0===t.length?null:(0,K.jsx)("span",{children:(0,P.Z)(t,(e=>(0,K.jsx)(H,{index:e})))})}if((0,l.r2)(s)){const e=(0,l.wB)(s),t=B.oA(e.map((e=>{let{value:t}=e;return t})));return 0===t.length?null:(0,K.jsx)("span",{children:(0,P.Z)(t,(e=>(0,K.jsx)(H,{index:e})))})}if((0,l.e)(s)){const e=(0,l.YO)(s),t=B.oA(e.map(((e,t)=>{if(!e.value)return null;const o=e.type;if("exact"===o){const t=E.G.createChildStore(n,{table:I.iU,id:e.value});return(0,K.jsx)(L.Z,{style:{display:"inline"},store:t},e.value)}var i;if("relative"===o)return r?(0,K.jsx)("span",{children:(0,K.jsx)(c.FormattedMessage,{...null===(i=T.qB[r])||void 0===i||null===(i=i[e.value.variable])||void 0===i?void 0:i.messageDescriptor})},t):null;(0,A.t1)(o)})));return(0,K.jsx)(K.Fragment,{children:(0,P.Z)(t,(e=>(0,K.jsx)(H,{index:e})))})}if((0,l.Gb)(s))return(0,K.jsx)($,{useFilter:s,parentStore:n});if((0,l.Mp)(s)){const e=(0,l.u0)(s),t=B.oA(e.map((e=>{if(e.value){const t=e.value,o=E.t1.createChildStore(n,{table:_.vF,id:t});return(0,K.jsx)(L.Z,{style:{display:"inline"},store:o},t)}})));return(0,K.jsx)(K.Fragment,{children:(0,P.Z)(t,(e=>(0,K.jsx)(H,{index:e})))})}if((0,l.gE)(s)){const e=o[t.property],n=(e&&"date"===e.type?e.date_format:void 0)||V.sF;let r;if("exact"===s.value.type){const e=s.value;if(e.value)if((0,V.J_)(e.value))r=e.value;else if((0,V.gR)(e.value)){const t=(0,V.Gc)(e.value);t&&(r=t.value)}}else if(!(0,l.TQ)(s))return(0,K.jsx)(K.Fragment,{children:(0,D.x)(s.value)});if(r)return(0,K.jsx)(O.Z,{style:{display:"inline"},value:r,dateFormat:n,shortenDateAndRange:!0})}else{if((0,l.Jw)(s)){const e=(0,l.fl)(s).filter((e=>{let{value:t}=e;return Boolean(t)})).map(D.cq);return 0===e.length?null:(0,K.jsx)("span",{children:(0,P.Z)(e,(e=>(0,K.jsx)(H,{index:e})))})}(0,A.t1)(s)}}return null}function $(e){let{parentStore:t,useFilter:o}=e;const n=(0,c.useIntl)(),r=(0,l.R8)(o),s=(0,i.VK)((()=>B.oA(r.map(((e,o)=>{if("relative"===e.type)return(0,K.jsx)("span",{children:(0,K.jsx)(c.FormattedMessage,{defaultMessage:"Me",id:"database.filterValue.personType.firstPersonPropertyValue.title"})},o);if(e.value){const r=e.value;if(r.table===Z.KJ){const e=E.t1.createChildStore(t,{table:r.table,id:r.id});return(0,K.jsx)("span",{children:(0,R.Nz)(n,e.getModel())},o)}if(r.table===F.cZ){const e=E.t1.createChildStore(t,{table:r.table,id:r.id});return(0,K.jsx)("span",{children:(0,M.Mh)(e.getModel())},o)}}})))),[r,t,n]);return(0,K.jsx)(K.Fragment,{children:(0,P.Z)(s,(e=>(0,K.jsx)(H,{index:e})))})}function Y(e){let{id:t,context:o,collectionContextStore:u,collectionSettingsStore:d,onClick:M}=e;const k=(0,r.O7)(),V=(0,s.Fg)(),{filter:P,isReadOnly:T}=(0,i.VK)((()=>{const e=function(e,t){const o=t.currentPropertyFiltersStore.state;return o.find((t=>t.id===e))}(t,u);return{filter:e,isReadOnly:Boolean(e&&(0,y.mu)(e.id))}}),[u,t]),I=(0,i.VK)((()=>{const e=u.localStateDiffStore.state;return e.filters.updated.includes(t)||e.filters.added.includes(t)}),[u,t]),F=(0,i.VK)((()=>u.collectionViewStore()),[u]),_=(0,i.VK)((()=>u.normalizedSchemaStore.state),[u]),Z=(0,i.VK)((()=>u.permissionScopes.state.canConfigureBlock),[u]),R=(0,i.VK)((()=>d.state.open),[d]),B=(0,i.VK)((()=>{var e;return P?null==u||null===(e=u.collectionStore())||void 0===e||null===(e=e.getSchema()[P.filter.property])||void 0===e?void 0:e.type:void 0}),[u,P]),A=(0,i.VK)((()=>P&&P.id===y.OC),[P]),L=(0,n.useCallback)((e=>{e&&(0,C.yT)(e.target)||m.E3({collectionSettingsStore:d})}),[d]),O=(0,n.useCallback)((()=>{var e;M&&M(),P&&(d.state.open?m.E3({collectionSettingsStore:d}):m.wl({collectionSettingsStore:d,item:{type:"filter"}}),p.wd({environment:k,collectionContextStore:u,action:"click_property_filter",original_view_type:void 0,property_type:null==u||null===(e=u.collectionStore())||void 0===e||null===(e=e.getSchema()[P.filter.property])||void 0===e?void 0:e.type}))}),[u,d,k,P,M]),D=(0,n.useCallback)((()=>{m.E3({collectionSettingsStore:d})}),[d]),N=(0,n.useCallback)((e=>{var t;if(!P)return;const o=null===(t=u.remoteResult.state)||void 0===t?void 0:t.sizeHint,n=b.default.mark("collections.update_filter_lag");b.default.measureAfterNextFlush(n,{environment:k,getData:()=>x.Y5({from:"property_filter",property_type:B,collectionContextStore:u,sizeHintAtStart:o})});const r=P.filter,i=u.currentPropertyFiltersStore.state.map((t=>{if(t.id===P.id){return{...P,filter:{...r,filter:e}}}return t}));g.iU({environment:k,collectionContextStore:u,temporaryState:{...u.temporaryState.state,propertyFilters:{value:i}}}),p.wd({environment:k,collectionContextStore:u,action:"update_property_filter",original_view_type:void 0,property_type:B})}),[u,k,P,B]),E=(0,n.useCallback)((()=>{var e;if(!P)return;const t=u.currentPropertyFiltersStore.state.filter((e=>e.id!==P.id));g.iU({environment:k,collectionContextStore:u,temporaryState:{...u.temporaryState.state,propertyFilters:{value:t}}}),p.wd({environment:k,collectionContextStore:u,action:"delete_property_filter",original_view_type:void 0,property_type:null==u||null===(e=u.collectionStore())||void 0===e||null===(e=e.getSchema()[P.filter.property])||void 0===e?void 0:e.type})}),[u,k,P]),U=(0,n.useCallback)((()=>{var e;if(!P)return;const{combinatorFilter:t,propertyFilters:n}=(0,y.Gz)(u,P);g.iU({environment:k,collectionContextStore:u,temporaryState:{...u.temporaryState.state,propertyFilters:{value:n},combinatorFilter:{value:t}}});const r=o===j.P.FilterBar?u.filterBarCombinatorFilterSettingsStore:u.filterOptionsCombinatorFilterSettingsStore;m.wl({collectionSettingsStore:r,item:{type:"filter"}}),p.wd({environment:k,collectionContextStore:u,action:"merge_filter_into_combinator",property_type:null==u||null===(e=u.collectionStore())||void 0===e||null===(e=e.getSchema()[P.filter.property])||void 0===e?void 0:e.type})}),[u,o,k,P]),W=(0,n.useCallback)(((e,t)=>{if(!F||!P)return null;const o=P.filter,n=!(0,l.Oo)(o),r=_[o.property];return(0,K.jsx)(w.Z,{icon:r&&(0,K.jsx)(a.ZP,{type:r.type,icon:r.icon,size:k.device.isMobile?18:16,theme:V,style:{fill:n?V.blueColor:V.mediumIconColor,marginRight:6}}),title:n?(0,K.jsx)(G,{propertyFilter:o,schema:_,style:Q(),parentStore:F}):(0,K.jsx)("span",{style:Q(),children:null==r?void 0:r.name}),on:n,hasDiff:I,disabled:t,hideChevron:t,onClick:e=>((0,v.ZP)({event:e,context:v.Af.CollectionSettingsClick,callback:O}),e.preventDefault(),!1),...e},P.id)}),[F,k,P,O,I,_,V]),z=(0,n.useCallback)((()=>A?(0,K.jsx)(h.ZP,{placement:h.ug.Bottom,render:e=>W(e,!0),renderTooltip:()=>(0,K.jsx)(c.FormattedMessage,{id:"database.filterBarPropertyFilter.cannotConfigureSubitemDisplayMode",defaultMessage:"To modify this filter, first change the subitem display mode."})}):(0,K.jsx)(h.ZP,{placement:h.ug.Bottom,render:e=>W(e,!0),renderTooltip:()=>(0,K.jsx)(c.FormattedMessage,{id:"database.filterBarPropertyFilter.cannotConfigure",defaultMessage:"This filter cannot be modified on this view."})})),[W,A]),H=(0,n.useCallback)((()=>{if(!P)return;const e=P.filter;return F?(0,K.jsx)(S.ZP,{collectionViewId:F.id,propertyFilter:e,schema:_,parentStore:F,onChange:N,onClose:D,onDelete:E,onAddToCombinatorFilter:U,context:S.Qv.PropertyFilter,allowAddingToCombinatorFilter:Z,allowRelativeDateFilter:!0,allowRelativePersonFilter:!0,collectionContextStore:u}):void 0}),[Z,u,F,P,U,E,D,N,_]);return T?z():(0,K.jsx)(f.ZP,{popupType:k.device.isMobile?f.ZP.PopupType.SlideUp:f.ZP.PopupType.Popup,open:R,origin:T?z():W(void 0,!1),onDismiss:L,disableMouseCapture:!0,enableOutsideClickDismiss:!0,originGap:4,render:H})}const X=n.memo(Y,u.Z);function Q(){return{maxWidth:180,...d.Z.textOverflowStyle}}},45257:(e,t,o)=>{o.d(t,{Z:()=>a});o(67294);var n=o(480),r=o(24405),i=o(42853),s=o(64921),l=o(85893);function a(e){const{icon:t,title:o,on:a,hasDiff:u,wrapStyle:d,innerStyle:p,hideChevron:g}=e,m=(0,r.Fg)(),S=(0,n.O7)();return(0,l.jsxs)("div",{style:{borderRadius:14,marginRight:6,display:"inline-flex",...u&&{position:"relative"},...d},children:[(0,l.jsxs)(s.Z,{disabled:e.disabled,style:c(Boolean(a),m,p,S.device.isMobile),hoveredStyle:a?{background:m.outlineBlueButtonHoveredBackground}:void 0,pressedStyle:a?{background:m.outlineBlueButtonPressedBackground}:void 0,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onClick:e.onClick,onDoubleClick:e.onDoubleClick,children:[t,o,!g&&(0,i.i)({width:10,marginLeft:4,marginTop:1,fill:a?m.blueColor:m.lightIconColor})]}),u&&(0,l.jsx)("div",{style:{position:"absolute",top:-2,right:-2,background:"dark"===m.mode?m.accentColors.orange[500]:m.accentColors.orange[300],border:`1px solid ${m.contentBackground}`,width:9,height:9,borderRadius:9}})]})}function c(e,t,o,n){return{fontSize:14,display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",borderRadius:32,height:n?28:24,lineHeight:n?"28px":"24px",padding:"0 8px",border:`1px solid ${t.outlineButtonBorder}`,color:t.mediumTextColor,...e&&{color:t.blueColor,border:`1px solid ${t.filterPillBorder}`,background:t.filterPillBackground},...o}}},24248:(e,t,o)=>{o.d(t,{Z:()=>T});var n=o(67294),r=o(480),i=o(86628),s=o(24405),l=o(9291),a=o(8406),c=o(13447),u=o(88833),d=o(34517),p=o(40663),g=o(13401),m=o(52275),S=o(36488),f=o(78140),h=o(32163),y=o(40721),x=o(72495),v=o(26388),C=o(33929),b=o(60709),j=o(80444),w=o(75330),M=o(20616),k=o(85893);const V=(0,l.defineMessages)({suggestedSectionTitle:{defaultMessage:"Suggested",id:"database.collectionViewSuggestedViews.suggestedTitle"}});function P(e,t){const o=(0,r.O7)(),s=(0,i.VK)((()=>j.default.state.currentSpaceViewStore),[]),l=(0,i.VK)((()=>e.collectionViewBlockStore()),[e]),g=(0,i.VK)((()=>e.collectionStore()),[e]),S=(0,i.VK)((()=>{var e;if(!g)return;const t=null===(e=g.getFormat())||void 0===e?void 0:e.app_config_uri;return t?(0,p.YB)((0,d.appConfigs)(),t):void 0}),[g]),f=n.useCallback((n=>{if(!l||!S||!s)return;const r=l.getParentStore();if(!r||"block"!==r.table&&"space"!==r.table&&"team"!==r.table)return;if(1!==n.dependencies.length)return;const i=n.dependencies[0];c.createAndCommit({userAction:"CollectionViewSuggestedViews.createView",environment:o,perform:a=>{var c;u.applyFeatures({environment:o,spaceViewStore:s,appParentStore:r,appUri:S.uri,features:[{type:"simple",featureUri:n.uri}],appCollectionViewBlockStores:[l],createOrModify:"modify",transaction:a});const d=((null===(c=l.getFormat())||void 0===c?void 0:c.app_uri_map)??{})[i.uri];w.f8({environment:o,collectionContextStore:e,collectionViewId:d,isFullScreen:e.isFullScreen.state,isRootChild:e.isRootChild.state,isInPeekRenderer:e.isInPeekRenderer.state}),t()}}),a.xb({environment:o,collectionContextStore:e,view_type:i.value.type,view_config_uri:n.uri})}),[l,S,s,o,e,t]);return{renderSuggestedView:n.useCallback((e=>({key:e.uri,render:t=>(0,k.jsx)(v.ZP,{placement:v.ug.Left,render:o=>((e,t)=>{var o;const n=e.dependencies[0],r=(0,k.jsx)(M.F,{color:"regular",viewIcon:null===(o=n.value.format)||void 0===o?void 0:o.collection_view_icon,viewType:n.value.type});return(0,k.jsx)(m.Z,{title:n.value.name?n.value.name:"New View",icon:r,...t})})(e,{...t,...o,onMouseEnter:e=>{var n,r;null===(n=o.onMouseEnter)||void 0===n||n.call(o,e),null===(r=t.onMouseEnter)||void 0===r||r.call(t,e)}}),renderTooltip:()=>e.description}),action:()=>{f(e)}})),[f])}}function T(e){const t=(0,r.O7)().device,o=(0,s.yK)((e=>({showMoreLabel:{color:e.mediumTextColor}})),[]),a=e.suggestedViews,{renderSuggestedView:c}=P(e.collectionContextStore,e.onClose),[u,d]=(0,n.useState)(!1),{collectionContextStore:p,onClose:v,onNewEmptyViewClick:j}=e,w=(0,i.VK)((()=>p.permissionScopes.state),[p]),M=(null==a?void 0:a.map((e=>c(e))))??[],T={key:"showMore",render:e=>(0,k.jsx)(m.Z,{...e,style:o.showMoreLabel,title:(0,k.jsx)(l.FormattedMessage,{defaultMessage:"Show more...",id:"collectionViewSuggestedViews.showMore.label"})}),action:()=>{d(!0)}},I=(0,k.jsx)(h.Z,{type:h.i.Vertical,initialFocus:0,sections:[{key:"suggested_views",render:e=>(0,k.jsx)(x.Z,{...e}),items:u||M.length<=5?M:[...M.slice(0,5),T]}]}),F=w.canConfigureBlock&&(0,k.jsx)(x.Z,{topBorder:!0,children:(0,k.jsx)(g.Z,{title:(0,k.jsx)(l.FormattedMessage,{defaultMessage:"New empty view",id:"database.collectionViewSuggestedViews.newEmptyViewTitle"}),onClick:()=>{j("CollectionViewSuggestedViews2.handleNewEmptyViewClick"),v()},focused:!1})});return(0,k.jsx)(S.Z,{capture:!0,allowEsc:!0,render:o=>{let n;return n=t.isMobile?{menuType:b.og.Modal,title:e.title?e.title:C.default.formatMessage(V.suggestedSectionTitle),right:(0,k.jsx)(y.DoneMenuText,{}),onClickRight:v,...o}:{menuType:b.og.Popup,minWidth:290,maxWidth:320,maxHeight:"50vh",...o},(0,k.jsxs)(f.Z,{...n,children:[M.length&&(0,k.jsx)(x.Z,{title:!t.isMobile&&(e.title?e.title:C.default.formatMessage(V.suggestedSectionTitle)),disableMobilePadding:!0,topBorder:!1,desktopTitleStyle:{marginTop:2,marginBottom:2},style:{paddingBottom:0},children:I}),F]})}})}},68500:(e,t,o)=>{o.d(t,{Z:()=>G});var n=o(67294),r=o(83355),i=o(480),s=o(86628),l=o(24405),a=o(66897),c=o(14714),u=o(99036),d=o(75e3),p=o(96367),g=o(21202),m=o(6287),S=o(9291),f=o(53965),h=o(7032),y=o(1898),x=o(37810),v=o(47307),C=o(66890),b=o(23586),j=o(92658),w=o(60709),M=o(77907),k=o(75822),V=o(77556),P=o(29798),T=o(6258),I=o(36488),F=o(74194),_=o(68894),Z=o(78140),R=o(32163),B=o(43765),A=o(58297),L=o(11470),O=o(72495),D=o(93131),N=o(97680),E=o(85893);class K extends r.Z{constructor(){super(...arguments),this.storeTypes={inputStore:j.Z,menuListStore:P.Z,collectionContextStore:V.Z},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMenuClickRight=()=>{return e=this.props.onChange,t=this.props.currentGroups,o=this.props.groupBy,n=this.props.groupFormat,r=this.stores.inputStore,i=this.props.onClose,void H(e,t,o,n,r,i);var e,t,o,n,r,i}}UNSAFE_willMount(e){var t;super.UNSAFE_willMount(e);const{inputStore:o}=this.stores,{groupFormat:n}=this.props;n&&("select"===n.value.type||"multi_select"===n.value.type)&&n.value.value?o.setState({...o.state,inputValue:n.value.value}):n&&(0,c.R7)(n.value)&&"exact"===(null===(t=n.value.value)||void 0===t?void 0:t.type)&&o.setState({...o.state,inputValue:n.value.value.value})}renderComponent(){const{groupFormat:e,onClose:t}=this.props;let o;var n;return o=this.environment.device.isPhone?{menuType:w.og.Modal,title:e?(0,E.jsx)(S.FormattedMessage,{defaultMessage:"Rename group",id:"codeBlock.databaseEditGroupMenu.renameGroupTitle"}):(0,E.jsx)(S.FormattedMessage,{defaultMessage:"Add a group",id:"codeBlock.databaseEditGroupMenu.addGroupTitle"}),left:(0,E.jsx)(S.FormattedMessage,{defaultMessage:"Cancel",id:"codeBlock.databaseEditGroupMenu.cancelButton.label"}),right:(0,E.jsx)(S.FormattedMessage,{defaultMessage:"Done",id:"codeBlock.databaseEditGroupMenu.doneButton.label"}),onClickRight:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMenuClickRight,onClickLeft:t}:{menuType:w.og.Popup,width:(n=this.props.groupBy,"select"===n.type||"multi_select"===n.type||(0,c.HB)(n.type)?300:240),maxHeight:"50vh"},(0,E.jsx)(I.Z,{capture:!0,render:e=>(0,E.jsx)(Z.Z,{...o,...e,children:(0,E.jsx)(Q,{groupBy:this.props.groupBy,schema:this.props.schema,onChange:this.props.onChange,currentGroups:this.props.currentGroups,groupFormat:this.props.groupFormat,onClose:this.props.onClose,parentStore:this.props.parentStore,inputStore:this.stores.inputStore,menuListStore:this.stores.menuListStore})})})}}K.displayName="CollectionEditGroupMenu";const G=K;function U(){return(0,E.jsx)(S.FormattedMessage,{defaultMessage:"Group already exists.",id:"database.groupExistsAlreadyError.message"})}function W(e){let{currentGroups:t,onChange:o,groupFormat:n,onClose:r,inputStore:l,menuListStore:u}=e;const d=(0,i.O7)(),p=(0,S.useIntl)(),g=(0,s.qz)(u,P.Z),m=(0,s.qz)(l,j.Z),{inputValue:h}=(0,s.VK)((()=>m.state),[m]);return(0,E.jsx)(b.Z,{request:h,performRequest:e=>async function(e,t){const o=await M.deps.searchActions.loader();return(await o.searchVisibleSpaceUsers({environment:t,query:e,membersOnly:!1})).slice(0,20)}(e,d),debounce:k.vp,render:(e,i,s)=>{i||(i=[]);const l=f.oA(i.map((e=>({key:e.id,render:t=>(0,E.jsx)(N.Z,{actor:(0,a.dp)(e),...t}),action:()=>{const i={type:"person",value:{table:"notion_user",id:e.id}};return n&&f.Xy(i,n.value)?(null==r||r(),null):t.some((e=>(0,c.we)(i,e.value)))?(v.showErrorMessage((0,E.jsx)(U,{})),null):void o({newGroupValue:i})}}))));let u;return u=s&&i&&0===l.length?(0,E.jsx)(O.Z,{children:(0,E.jsx)(B.Z,{title:(0,E.jsx)(S.FormattedMessage,{defaultMessage:"No results",id:"database.noPersonSearchResults.message"})})}):(0,E.jsx)(R.Z,{type:R.i.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,E.jsx)(O.Z,{...e}),items:l}],store:g}),(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(O.Z,{children:(0,E.jsx)(_.ZP,{value:h,focus:!0,placeholder:p.formatMessage({defaultMessage:"Search for a person…",id:"database.searchPerson.placeholder"}),onChange:e=>{m.setState({...m.state,inputValue:e.target.value}),g.setState({...g.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}})}),u]})}})}function z(e,t,o,n,r){const i=t[o.property];if(!i||"relation"!==i.type)return null;const s=u.j0(i);if(!s)return null;const l=T.NW.createChildStore(e,s);return l.isDefined()&&r.length>0?{key:"new-page",render:e=>(0,E.jsx)(D.Z,{targetCollectionStore:l,pageName:r,...e}),action:()=>{const e={table:g.iU,id:(0,h.ZP)(),spaceId:l.getSpaceId()};n({newGroupValue:{type:"relation",value:e},newPage:{id:e.id,spaceId:e.spaceId,name:r}})}}:null}function H(e,t,o,n,r,i){const s=r.state.inputValue.trim().replace(/,/g,"");let l;"select"===o.type||"multi_select"===o.type?l={type:o.type,value:s}:(0,c.aB)(o)&&(l={type:o.type,value:{type:"exact",value:s}}),l&&s?n&&f.Xy(l,n.value)?null==i||i():t.some((e=>l&&(0,c.we)(l,e.value)))?v.showErrorMessage((0,E.jsx)(U,{})):e({newGroupValue:l}):null==i||i()}function q(e,t,o,n,r,i,s,l,a){const u=null==a?void 0:a.relativeVariableStore.state,d=u&&u[t.id],g=(e,o)=>{const r=T.NW.createChildStore(n,t);if(!r.isDefined())return;const i=r.getFormat().app_config_uri;return i&&o?e.formatMessage(p.qB[i][o].messageDescriptor):void 0};return e.map((e=>{const t=T.G.createChildStore(n,e);if(t.isTemplate())return;const a=d?(0,p.P8)(t.id,d):void 0;return{key:t.id,render:e=>(0,E.jsx)(L.Z,{store:t,titlePrefix:g(r,a),...e}),action:()=>{let t={type:"relation",value:e};a&&(t={type:"relation",value:{type:"relative",value:{type:"builtin",variable:a}}}),s&&f.Xy(t,s.value)?null==l||l():o.some((e=>(0,c.we)(t,e.value)))?v.showErrorMessage((0,E.jsx)(U,{})):i({newGroupValue:t})}}}))}function $(e){let{onChange:t,currentGroups:o,groupBy:r,groupFormat:a,onClose:c,inputStore:u,menuListStore:p}=e;const g=(0,S.useIntl)(),m=(0,l.Fg)(),f=(0,n.useCallback)((()=>function(e,t,o,n,r,i){H(e,t,o,n,r,i)}(t,o,r,a,u,c)),[t,o,r,a,u,c]),h=(0,n.useCallback)((e=>function(e,t,o,n,r,i,s){13===e.keyCode?H(t,o,n,r,i,s):27===e.keyCode&&(null==s||s())}(e,t,o,r,a,u,c)),[t,o,r,a,u,c]),y=(0,n.useCallback)((e=>function(e,t,o){t.setState({...t.state,inputValue:e.target.value}),o.setState({...o.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}(e,u,p)),[u,p]),{inputValue:v}=(0,s.VK)((()=>u.state),[u]),C=(0,i.MO)(),b=a?g.formatMessage({id:"database.collectionEditGroupMenu.renameGroupLabel.placeholder",defaultMessage:"Rename group"}):g.formatMessage({id:"database.collectionEditGroupMenu.newGroupLabel.placeholder",defaultMessage:"New group"});return C?(0,E.jsx)(O.Z,{children:(0,E.jsx)(_.ZP,{value:v,focus:!0,selectAll:!0,showClearButton:!1,focusInitial:!0,placeholder:b,onChange:y,onKeyDown:h})}):(0,E.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:6,width:"100%",background:m.inputBackground},children:[(0,E.jsx)(F.Z,{value:v,focus:!0,selectAll:!0,focusInitial:!0,placeholder:b,onChange:y,onKeyDown:h,format:F.B.Transparent,style:{fontSize:x.Z.fontSize.UIRegular.desktop}}),(0,E.jsxs)(A.Z,{onClick:f,children:[(0,E.jsx)(S.FormattedMessage,{defaultMessage:"Done",id:"database.collectionEditGroupMenu.submitButton.label"}),(0,d.U)({height:14,width:14,fill:"currentColor",marginLeft:6,marginTop:2})]})]})}function Y(e){let{parentStore:t,schema:o,groupBy:r,currentGroups:l,onChange:a,groupFormat:c,onClose:d,inputStore:p,menuListStore:S}=e;const f=(0,i.O7)(),{inputValue:h}=(0,s.VK)((()=>p.state),[p]),y=(0,n.useMemo)((()=>{const e=o[r.property];return!(!e||"relation"!==e.type)&&u.j0(e)}),[r.property,o]);return(0,s.VK)((()=>{if(!y)return!1;return T.NW.createChildStore(t,y).isDefined()}),[y,t])&&y?(0,E.jsx)(b.Z,{request:h,performRequest:e=>async function(e,t,o,n,r){const i=o[t.property];if(!i||!(0,u.p_)(i))return;const s=i.collection_pointer;if(!s)return;const l=T.NW.createChildStore(n,{table:m.vF,id:s.id});if(await l.load(),!l.isDefined())return;const a=l.getSpaceId(),c=await M.deps.searchActions.loader();return(await c.searchPagesInCollection({environment:r,query:e,collectionId:s.id,spaceId:a,excludeTemplates:!0,source:"collection_group_value",limit:20,includePublicPagesWithoutExplicitAccess:!0,boostRecentlyViewedPages:!1})).results.map((e=>({table:g.iU,id:e,spaceId:a})))}(e,r,o,t,f),debounce:k.vp,render:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;return(0,E.jsx)(X,{ready:i,results:n,parentStore:t,schema:o,groupBy:r,currentGroups:l,onChange:a,groupFormat:c,onClose:d,inputStore:p,menuListStore:S,collectionPointer:y})}}):null}function X(e){let{parentStore:t,schema:o,groupBy:r,currentGroups:i,onChange:l,groupFormat:a,onClose:c,inputStore:u,menuListStore:d,results:p,ready:g,collectionPointer:m}=e;const h=(0,S.useIntl)(),y=(0,n.useContext)(C.cu),{inputValue:x}=(0,s.VK)((()=>u.state),[u]),v=(0,s.VK)((()=>f.oA([...q(p,m,i,t,h,l,a,c,y),z(t,o,r,l,x)])),[y,m,i,r,a,x,h,l,c,t,p,o]);let b;return b=g&&p&&0===v.length?(0,E.jsx)(O.Z,{children:(0,E.jsx)(B.Z,{title:(0,E.jsx)(S.FormattedMessage,{defaultMessage:"No results",id:"database.noRelationSearchResults.message"})})}):(0,E.jsx)(R.Z,{type:R.i.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,E.jsx)(O.Z,{...e}),items:v}],store:d}),(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(O.Z,{children:(0,E.jsx)(_.ZP,{value:x,focus:!0,placeholder:h.formatMessage({defaultMessage:"Type to search...",id:"database.searchRelation.placeholder"}),onChange:e=>{u.setState({...u.state,inputValue:e.target.value}),d.setState({...d.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}})}),b]})}function Q(e){let{groupBy:t,schema:o,onChange:n,currentGroups:r,groupFormat:i,onClose:s,parentStore:l,inputStore:a,menuListStore:u}=e;return o[t.property]?"select"===t.type||"multi_select"===t.type?(0,E.jsx)($,{onChange:n,currentGroups:r,groupBy:t,groupFormat:i,onClose:s,inputStore:a,menuListStore:u}):"person"===t.type?(0,E.jsx)(W,{currentGroups:r,onChange:n,groupFormat:i,onClose:s,inputStore:a,menuListStore:u}):"relation"===t.type?(0,E.jsx)(Y,{parentStore:l,schema:o,groupBy:t,currentGroups:r,onChange:n,groupFormat:i,onClose:s,inputStore:a,menuListStore:u}):(0,c.HB)(t.type)?(0,E.jsx)($,{onChange:n,currentGroups:r,groupBy:t,groupFormat:i,onClose:s,inputStore:a,menuListStore:u}):"number"===t.type||"status"===t.type||"date"===t.type||"formula"===t.type||"checkbox"===t.type||"created_time"===t.type||"last_edited_time"===t.type||"created_by"===t.type||"last_edited_by"===t.type||"last_visited_time"===t.type||"location"===t.type?null:void(0,y.t1)(t.type):null}},38769:(e,t,o)=>{o.d(t,{Z:()=>U});var n=o(67294),r=o(480),i=o(86628),s=o(24405),l=o(66897),a=o(15145),c=o(14714),u=o(99036),d=o(80951),p=o(84619),g=o(89767),m=o(23512),S=o(96367),f=o(9291),h=o(1898),y=o(37810),x=o(5149),v=o(16732),C=o(10906),b=o(28020),j=o(92918),w=o(26991),M=o(25044),k=o(84210),V=o(29376),P=o(80444),T=o(61766),I=o(6258),F=o(68500),_=o(50959),Z=o(64921),R=o(31945),B=o(60458),A=o(84076),L=o(31278),O=o(76798),D=o(26388),N=o(92864),E=o(25845),K=o(22084),G=o(85893);const U=function(e){let{schema:t,groupFormat:o,collectionContextStore:n,isHiddenGroup:r,style:s,uncategorizedIconStyle:l,currentGroups:a,groupBy:c,onChange:d,onClose:p,disabled:g}=e;const m=(0,i.qz)(void 0,T.Z),S=(0,i.VK)((()=>{const e=n.groupsStore.getGroupState(o);return null==e?void 0:e.groupUiParentStore}),[n,o]),f=(0,i.VK)((()=>{const e=t[o.property];if(e&&(0,u.p_)(e)&&S)return(0,V.ke)(e,S)}),[t,o,S]),h=o.value,y=void 0===h.value,x=t[o.property];if(!x)return null;if(y)return(0,G.jsx)(oe,{groupFormat:o,schema:t,isHiddenGroup:r,collectionContextStore:n,style:s,uncategorizedIconStyle:l,parentStore:S});if("formula"===h.type){if("formula"!==h.type)return null;const e=h.value;return e?(0,G.jsx)(de,{schema:t,currentGroups:a,groupBy:c,groupFormat:o,onChange:d,onClose:p,disabled:g,style:s,isHiddenGroup:r,collectionContextStore:n,buttonPopupStore:m,parentStore:S,relatedCollectionAppConfigUri:f,groupValue:e,propertySchema:x}):null}return(0,G.jsx)(de,{schema:t,currentGroups:a,groupBy:c,groupFormat:o,onChange:d,onClose:p,disabled:g,style:s,isHiddenGroup:r,collectionContextStore:n,buttonPopupStore:m,parentStore:S,relatedCollectionAppConfigUri:f,groupValue:h,propertySchema:x})},W={overflow:"hidden",padding:3,borderRadius:4,fontWeight:y.Z.fontWeight.medium};function z(e){const{isHiddenGroup:t}=e;return t?(0,G.jsx)(H,{...e,tooltipEvents:void 0}):(0,G.jsx)(D.ZP,{renderTooltip:()=>(0,G.jsx)(f.FormattedMessage,{defaultMessage:"Any items with an empty <b>{name}</b> property will go here. This group cannot be removed.",values:{name:null,b:e=>(0,G.jsx)("span",{style:{fontWeight:y.Z.fontWeight.semibold},children:e})},id:"database.boardView.uncategorizedColumnTooltip"}),style:{width:240},textWrap:!0,render:t=>(0,G.jsx)(H,{...e,tooltipEvents:t})})}function H(e){const t={display:"flex",alignItems:"center",fontSize:14,lineHeight:1.2,paddingLeft:2,paddingRight:4,whiteSpace:"nowrap",overflow:"hidden",fontWeight:y.Z.fontWeight.medium},{style:o,uncategorizedIconStyle:n,tooltipEvents:r,formattedLabelMessage:i}=e;return(0,G.jsxs)("div",{style:{...t,paddingLeft:0,...o},...r,children:[(0,g.R)({width:14,marginLeft:6,marginRight:6,...n}),(0,G.jsx)("span",{style:{...y.Z.textOverflowStyle},children:i})]})}function q(e){let{value:t}=e;return"other"===t.type?(0,G.jsx)(f.FormattedMessage,{defaultMessage:"Other",id:"database.collectionGroupValue.textGroup.other"}):"alphabet_prefix"===t.type||"exact"===t.type?(0,G.jsx)(G.Fragment,{children:t.value}):void(0,h.t1)(t)}function $(e){let{groupFormat:t,schema:o}=e;const n=o[t.property];if(!n||"status"!==n.type)return null;const r=t.value;if(r.type!==n.type)return null;const{value:i}=r;if(!i)return null;const s=n.options??[],l=n.groups??[];if("by_group"===i.type){const e=l.find((e=>e.name===i.group));return e?(0,G.jsx)(_.r_,{group:e,style:{fontWeight:500},showIcon:!0,showColor:!0}):null}if("by_option"===i.type){const e=(0,d.i7)(s,i.option),t=e&&l.find((t=>{var o;return null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id)}));return e?(0,G.jsx)("span",{style:{fontWeight:500,lineHeight:"normal",overflow:"hidden"},children:(0,G.jsx)(K.F,{format:p.lo.Medium,isSingle:!0,value:e.value,color:e.color,showRemoveButton:!1,groupColor:null==t?void 0:t.color})}):null}(0,h.t1)(i)}function Y(e){let{value:t}=e;const o=(0,f.useIntl)();return(0,G.jsx)(G.Fragment,{children:(0,j.fZ)({intl:o,value:t})})}function X(e){let{value:t,format:o}=e;const n=(0,f.useIntl)();return(0,G.jsx)(G.Fragment,{children:(0,j.xg)({intl:n,value:t,format:o})})}function Q(e){let{groupValue:t,propertySchema:o,style:n}=e;const r=(0,s.yK)((()=>({checkboxStyle:{display:"inline-flex",marginRight:6},wrapperStyle:{fontWeight:y.Z.fontWeight.medium,marginRight:3,display:"flex",alignItems:"center"}})),[]);return"checkbox"!==t.type?null:(0,G.jsxs)("div",{style:{...y.Z.textOverflowStyle,...r.wrapperStyle,...n},children:[(0,G.jsx)(B.Z,{checked:t.value,checkSize:10,size:14,disabled:!0,style:r.checkboxStyle}),(0,G.jsx)("span",{children:null==o?void 0:o.name})]})}function J(e){let{groupValue:t,style:o}=e;return(0,c.Mc)(t)&&t.value?(0,G.jsx)("div",{style:{...te,...y.Z.textOverflowStyle,...o},children:(0,G.jsx)(Y,{value:t.value})}):null}function ee(e){let{groupValue:t,propertySchema:o,style:n}=e;if("number"!==t.type||!t.value)return null;const r=(null==o?void 0:o.number_format)||m.dk;return(0,G.jsx)("div",{style:{...te,...n},children:(0,G.jsx)(X,{value:t.value,format:r})})}const te={overflow:"hidden",padding:3,paddingRight:6,borderRadius:4,fontWeight:y.Z.fontWeight.medium};function oe(e){let{groupFormat:t,schema:o,isHiddenGroup:n,collectionContextStore:r,style:s,uncategorizedIconStyle:l,parentStore:a}=e;const c=o[t.property],d=(0,i.VK)((()=>r.collectionStore()),[r]),p=(0,i.VK)((()=>{let e=!1;return null!=d&&d.isDefined()&&c&&(0,u.p_)(c)&&a&&(e=(0,M.O)({collectionStore:d,property:t.property,propertySchema:c,parentStore:a})),e}),[d,t,c,a]);if(!c)return null;const{name:g}=c;return p?(0,G.jsx)(z,{style:s,uncategorizedIconStyle:l,isHiddenGroup:n,formattedLabelMessage:(0,G.jsx)(f.FormattedMessage,{...M.u.sprintUncategorizedGroup,values:{name:g}})}):(0,G.jsx)(z,{style:s,uncategorizedIconStyle:l,isHiddenGroup:n,formattedLabelMessage:(0,G.jsx)(f.FormattedMessage,{...j.nX.emptyGroupLabel,values:{name:g}})})}function ne(e){let{style:t,collectionContextStore:o,groupValue:n,parentStore:r}=e;const s=(0,i.VK)((()=>{var e;return null===(e=o.collectionViewBlockStore())||void 0===e?void 0:e.id}),[o]),l=r&&"location"===n.type&&n.value?I.NW.createChildStore(r,n.value):void 0,c=(0,i.VK)((()=>null==l?void 0:l.getParentBlockStore()),[l]),u=(0,i.VK)((()=>{let e=a.tY.LocationProperty;return s?((0,b.qG)(s)&&(e=o.isCompactView.state?a.tY.PersonalHomeTileTasks:a.tY.PersonalHomePageTasks),e):e}),[s,o]),d=(0,i.VK)((()=>c?(0,k.ZP)({store:c,fullyQualified:!1,pageVisitSource:u}):void 0),[c,u]),p=(0,i.VK)((()=>null==l?void 0:l.getIcon()),[l]);return"location"===n.type&&n.value&&r&&l?(0,G.jsxs)(A.Z,{href:d,style:{...t,display:"flex"},ignoreLocalHoverState:!0,children:[(0,G.jsx)(L.Z,{disabled:!0,icon:p,size:20,isEmptyPage:!1,style:{marginTop:2,marginRight:6}}),(0,G.jsx)(O.Z,{store:l,underline:!0,style:{fontWeight:y.Z.fontWeight.medium}})]}):null}function re(e){let{groupValue:t,schema:o,groupFormat:n,collectionContextStore:r,style:s,parentStore:l,relatedCollectionAppConfigUri:a}=e;const d=o[n.property],p=d&&"relation"===d.type?u.j0(d):void 0,g=l&&p?I.NW.createChildStore(l,p):void 0,m=(0,i.VK)((()=>null==g?void 0:g.isDefined()),[g]);return l&&"relation"===t.type&&d&&"relation"===d.type&&p&&g&&m&&t.value?(0,c.t2)(t.value)?a?(0,G.jsx)(ie,{relatedCollectionAppUri:a,groupValueInner:t.value,collectionContextStore:r,collectionPointer:p,targetCollectionStore:g,parentStore:l,style:s}):null:(0,c.RA)(t.value)?(0,G.jsx)(se,{parentStore:l,groupValueInner:t.value,collectionContextStore:r}):null:null}function ie(e){var t;let{relatedCollectionAppUri:o,groupValueInner:n,collectionContextStore:r,collectionPointer:s,targetCollectionStore:l,parentStore:c,style:u}=e;const d=(0,f.useIntl)(),p=n.value.variable,g=(0,i.VK)((()=>l.isDefined()),[l]),m=(0,i.VK)((()=>(0,w.As)(r,p,s,l)),[r,p,s,l]),{mainEditorCurrentBlockStore:b}=(0,i.VK)((()=>P.default.state),[]),j=(0,i.VK)((()=>m?C.mb({store:m,mainEditorCurrentBlockStore:b,collectionContextStore:r})??(0,k.ZP)({store:m,pageVisitSource:a.tY.LinkInPage}):void 0),[m,b,r]);let M;"current"===p?M=d.formatMessage(v.sY.tasksCurrentSprintV2ViewNamePrefix):"next"===p?M=d.formatMessage(v.sY.tasksNextSprintV2ViewNamePrefix):"last"===p?M=d.formatMessage(v.sY.tasksLastSprintV2ViewNamePrefix):(0,h.t1)(p);const V=null===(t=S.qB[o])||void 0===t?void 0:t[p];if(g){if(!m)return(0,G.jsx)("div",{style:{fontWeight:y.Z.fontWeight.medium},children:(0,G.jsx)(f.FormattedMessage,{...null==V?void 0:V.messageDescriptor})});if(m)return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)("div",{style:{fontWeight:y.Z.fontWeight.medium,marginBottom:.25},children:[M,":"]}),(0,G.jsx)(A.Z,{style:{...u,marginLeft:1},innerStyle:{...te},href:j,onClick:()=>{x.E3({collectionSettingsStore:r.settingsStore})},children:(0,G.jsx)(E.Z,{format:N.ZP.Format.Medium,blockId:m.id,isSingle:!0,shouldShrink:!0,parentStore:c})})]})}return(0,G.jsx)("div",{style:{fontWeight:y.Z.fontWeight.medium,marginBottom:.25},children:(0,G.jsx)(f.FormattedMessage,{...null==V?void 0:V.messageDescriptor})})}function se(e){let{parentStore:t,groupValueInner:o,collectionContextStore:n,style:r}=e;const s=I.G.createChildStore(t,o),{mainEditorCurrentBlockStore:l}=(0,i.VK)((()=>P.default.state),[]),c=(0,i.VK)((()=>C.mb({store:s,mainEditorCurrentBlockStore:l,collectionContextStore:n})??(0,k.ZP)({store:s,pageVisitSource:a.tY.LinkInPage})),[s,l,n]);return(0,G.jsx)(A.Z,{style:r,innerStyle:{...te},href:c,onClick:()=>{x.E3({collectionSettingsStore:n.settingsStore})},children:(0,G.jsx)(E.Z,{format:N.ZP.Format.Medium,blockId:o.id,isSingle:!0,shouldShrink:!0,parentStore:t})})}function le(e){let{schema:t,currentGroups:o,groupBy:n,groupFormat:r,onChange:i,onClose:s,buttonPopupStore:l,parentStore:a}=e;return a?(0,G.jsx)(F.Z,{groupFormat:r,groupBy:n,currentGroups:o,schema:t,onChange:e=>{l.reset(),null==i||i(e)},onClose:()=>{l.reset(),null==s||s()},parentStore:a}):null}function ae(e){var t;let{schema:o,currentGroups:i,groupBy:s,groupFormat:l,onChange:a,onClose:c,disabled:g,style:m,buttonPopupStore:S,parentStore:f}=e;const h=(0,r.O7)(),y=(0,n.useCallback)((()=>(0,G.jsx)(le,{schema:o,currentGroups:i,groupBy:s,groupFormat:l,onChange:a,onClose:c,buttonPopupStore:S,parentStore:f})),[o,i,s,l,a,c,S,f]),x=o[l.property];if(!x||!u.cu(x))return null;const v=l.value;if(null===(t=x.options)||void 0===t||!t.length||void 0===v.value||v.type!==x.type)return null;const C=(0,d.i7)(x.options,v.value);return C?(0,G.jsx)(R.ZP,{render:y,disabled:g,buttonPopupStore:S,popupType:h.device.isMobile?R.Z4.SlideUp:R.Z4.Popup,originGap:4,renderOrigin:e=>(0,G.jsx)(Z.Z,{style:{...te,...m},disabled:g,...e,children:(0,G.jsx)(K.a,{format:p.lo.Medium,isSingle:!0,value:C.value,color:C.color,showRemoveButton:!1})})}):null}function ce(e){let{groupValue:t,schema:o,currentGroups:s,groupBy:a,groupFormat:u,onChange:d,onClose:p,disabled:g,style:m,isHiddenGroup:S,buttonPopupStore:f,parentStore:h}=e;const y=(0,r.O7)(),x=(0,n.useCallback)((()=>(0,G.jsx)(le,{schema:o,currentGroups:s,groupBy:a,groupFormat:u,onChange:d,onClose:p,buttonPopupStore:f,parentStore:h})),[o,s,a,u,d,p,f,h]),{value:v}=t,C=(0,i.VK)((()=>t.value&&(0,c.q6)(t)&&h?(0,l.Hl)({pointer:t.value,getRecordValue:h.getRecordValue}):void 0),[t,h]);return(0,c.q6)(t)&&v&&h&&null!=C&&C.asActor?(0,G.jsx)(R.ZP,{render:x,disabled:g,buttonPopupStore:f,popupType:y.device.isMobile?R.Z4.SlideUp:R.Z4.Popup,originGap:4,renderOrigin:e=>(0,G.jsx)(Z.Z,{style:{...te,...m},disabled:g,...e,children:(0,G.jsx)(N.ZP,{format:N.ZP.Format.Medium,actor:C,showRemoveButton:!1,isSingle:!0,disableAvatarTooltip:S,shouldShrink:!0})})}):null}function ue(e){let{groupValue:t,schema:o,currentGroups:i,groupBy:s,groupFormat:l,onChange:a,onClose:u,disabled:d,style:p,buttonPopupStore:g,parentStore:m}=e;const S=(0,r.O7)(),f=(0,n.useCallback)((()=>(0,G.jsx)(le,{schema:o,currentGroups:i,groupBy:s,groupFormat:l,onChange:a,onClose:u,buttonPopupStore:g,parentStore:m})),[o,i,s,l,a,u,g,m]);if(!(0,c.R7)(t))return null;if(void 0!==t.value){const e=(0,G.jsx)(q,{value:t.value});return"exact"===t.value.type?(0,G.jsx)(R.ZP,{render:f,disabled:d,buttonPopupStore:g,popupType:S.device.isMobile?R.Z4.SlideUp:R.Z4.Popup,originGap:4,renderOrigin:t=>(0,G.jsx)(Z.Z,{style:{...W,...y.Z.textOverflowStyle,...p},disabled:d,...t,children:e})}):(0,G.jsx)("div",{style:W,children:e})}return null}function de(e){let{groupValue:t,propertySchema:o,schema:n,currentGroups:r,groupBy:i,groupFormat:s,onChange:l,onClose:a,disabled:u,style:d,isHiddenGroup:p,collectionContextStore:g,buttonPopupStore:m,parentStore:S,relatedCollectionAppConfigUri:f}=e;return"select"===t.type||"multi_select"===t.type?(0,G.jsx)(ae,{schema:n,currentGroups:r,groupBy:i,groupFormat:s,onChange:l,onClose:a,disabled:u,style:d,buttonPopupStore:m,parentStore:S}):"status"===t.type?(0,G.jsx)($,{groupFormat:s,schema:n}):(0,c.pd)(t.type)?(0,G.jsx)(ce,{schema:n,currentGroups:r,groupBy:i,groupFormat:s,onChange:l,onClose:a,disabled:u,style:d,isHiddenGroup:p,buttonPopupStore:m,parentStore:S,groupValue:t}):"relation"===t.type?(0,G.jsx)(re,{schema:n,groupFormat:s,collectionContextStore:g,style:d,parentStore:S,relatedCollectionAppConfigUri:f,groupValue:t}):"location"===t.type?(0,G.jsx)(ne,{style:d,collectionContextStore:g,parentStore:S,groupValue:t}):(0,c.A1)(t.type)?(0,G.jsx)(J,{style:d,groupValue:t}):(0,c.HB)(t.type)?(0,G.jsx)(ue,{schema:n,currentGroups:r,groupBy:i,groupFormat:s,onChange:l,onClose:a,disabled:u,style:d,buttonPopupStore:m,parentStore:S,groupValue:t}):"number"===t.type?(0,G.jsx)(ee,{style:d,groupValue:t,propertySchema:"number"===o.type?o:void 0}):"checkbox"===t.type?(0,G.jsx)(Q,{style:d,propertySchema:o,groupValue:t}):void(0,h.t1)(t.type)}},75498:(e,t,o)=>{o.d(t,{Z:()=>h});var n=o(67294),r=o(83355),i=o(1302),s=o(86628),l=o(49085),a=o(53965),c=o(15828),u=o(75330),d=o(77080),p=o(48190),g=o(85893);class m extends r.Z{constructor(){super(...arguments),this.reducerId=this.props.id,this.instanceId=(0,c.ZP)(),this.localResultStoreChangeIsQueued=!1,this.storeTypes={resultStore:l.default.createClass(void 0)},this.handleLocalResultStoreChange=()=>{this.localResultStoreChangeIsQueued||(this.localResultStoreChangeIsQueued=!0,i.default.afterNextFlush(this.dequeueLocalResultStoreChange))},this.dequeueLocalResultStoreChange=()=>{const{resultStore:e}=this.stores;if(this.localResultStoreChangeIsQueued=!1,!this.componentIsMounted)return;const t=this.getCurrentResult();a.Xy(t,e.state)||e.setState(t)}}UNSAFE_willMount(e){const{collectionContextStore:t}=e;t.remoteResult.addListener(this.handleLocalResultStoreChange),t.localResultStore.addListener(this.handleLocalResultStoreChange),this.updateReducer(e),this.handleLocalResultStoreChange()}UNSAFE_willUpdate(e){this.updateReducer(e)}willUnmount(){super.willUnmount();const{collectionContextStore:e,groupsPointer:t}=this.props;u.$D({reducerId:this.reducerId,instanceId:this.instanceId,reducer:void 0,collectionContextStore:e,groupsPointer:t}),e.remoteResult.removeListener(this.handleLocalResultStoreChange),e.localResultStore.removeListener(this.handleLocalResultStoreChange)}renderComponent(){const{render:e}=this.props;if(e)return e(this.stores.resultStore)}updateReducer(e){const{reducer:t,collectionContextStore:o,groupsPointer:n}=e;u.$D({reducerId:this.reducerId,instanceId:this.instanceId,reducer:t,collectionContextStore:o,groupsPointer:n})}getCurrentResult(){const{reducer:e,collectionContextStore:t}=this.props,o=t.localResultStore.state,n=t.remoteResult.state,r=o&&"reducer"===o.type?o.reducerResults[this.reducerId]:void 0,i=n&&"reducer"===n.type?n.reducerResults[this.reducerId]:void 0;return(0,p.P)({reducerId:this.reducerId,localReducerResult:r,remoteReducerResult:i,reducer:e,collectionContextStore:t})}}function S(e){const{resultStore:t,render:o,...r}=e,i=(0,p.Z)(r),a=(0,s.qz)(t,l.default.createClass(void 0));(0,n.useEffect)((()=>{a.setState(i)}),[i,a]);const c=(0,s.VK)((()=>o?o(a):null),[o,a]);return(0,g.jsx)(g.Fragment,{children:c})}m.displayName="CollectionReducerRequest";const f=n.memo(S);const h=function(e){const t=(0,s.VK)((()=>d.default.checkGate("use_collection_reducer_request_hook")),[]),[o]=(0,n.useState)(t);return o?(0,g.jsx)(f,{...e}):(0,g.jsx)(m,{...e})}},93131:(e,t,o)=>{o.d(t,{Z:()=>S});var n=o(67294),r=o(480),i=o(86628),s=o(24405),l=o(47453),a=o(9291),c=o(1018),u=o(52275),d=o(31278),p=o(76798),g=o(85893);function m(e){const{pageName:t,targetCollectionStore:o,...n}=e,m=(0,r.Fy)(),S=(0,i.VK)((()=>o.getIcon()),[o]),f=(0,s.yK)((e=>({medium:{color:e.mediumTextColor},dbName:{display:"flex",alignItems:"center",marginLeft:4},title:{marginLeft:c.Qi*(m.isRetina?.5:1)},icon:{width:16,fill:e.mediumIconColor}})),[m.isRetina]),h=(0,g.jsxs)("div",{style:f.dbName,children:[(0,g.jsx)(d.Z,{disabled:!0,icon:S,isEmptyPage:!1,size:m.isMobile?24:20}),(0,g.jsx)(p.Z,{store:o,style:f.title})]});return(0,g.jsx)(u.Z,{title:(0,g.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,g.jsx)(a.FormattedMessage,{id:"database.searchRelation.createNewPageFooter",defaultMessage:"<medium>New</medium> {pageName} <medium> in</medium> {databaseNameWithIcon}",values:{medium:e=>(0,g.jsx)("span",{style:f.medium,children:e}),pageName:(0,g.jsx)("span",{style:{marginLeft:4,marginRight:4},children:t}),databaseNameWithIcon:h}})}),icon:(0,l.R)(f.icon),...n})}const S=n.memo(m)},2520:(e,t,o)=>{o.d(t,{DQ:()=>Q,rw:()=>J,OF:()=>H,L6:()=>q,ZP:()=>ne});o(57658);var n=o(67294),r=o(83355),i=o(15095),s=o(54153),l=o(9291),a=o(31701),c=o(53965),u=o(68425),d=o(23586),p=o(72187),g=o(79947),m=o(5385),S=o(33929),f=o(4391),h=o(29798),y=o(73657),x=o(68785),v=o(32163),C=o(43145),b=o(72495),j=o(480),w=o(86628),M=o(24405),k=o(79362),V=o(98742),P=o(61766),T=o(64921),I=o(31945),F=o(1743),_=o(3386),Z=o(26388),R=o(85893);function B(e){let{shouldOpenVariations:t,icon:o,focused:n,color:r,onClick:i,onMouseEnter:s,variations:l,hideTooltip:a,insertIcon:c}=e;const u=(0,w.qz)(void 0,P.Z);return t?(0,R.jsx)(E,{icon:o,focused:n,color:r,onClick:i,onMouseEnter:s,variations:l,hideTooltip:a,insertIcon:c,buttonPopupStore:u}):(0,R.jsx)(D,{icon:o,focused:n,color:r,onClick:i,onMouseEnter:s,variations:l,hideTooltip:a})}const A=B;function L(e){const{device:t}=e;return t.isMobile?{width:p.mz,height:p.mz,fontSize:p.jo}:{width:p.T8,height:p.T8,fontSize:p.WB}}function O(e){return{iconButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,...L(e)},variationMenu:{display:"flex",padding:2,gap:1},iconImage:{...e.device.isMobile?{width:p.jo,height:p.jo}:{width:p.WB,height:p.WB}}}}function D(e){let{events:t,icon:o,focused:n,color:r,onClick:i,onMouseEnter:s,variations:l,hideTooltip:a}=e;const c=(0,M.Fg)(),u=(0,j.O7)(),d=l.tooltip?l.tooltip:o,p="dark"===c.mode?l.dark:l.light;return(0,R.jsx)(Z.ZP,{allowHover:Boolean(o&&!a),disableTooltip:a,renderTooltip:()=>d.replaceAll("-"," ").replaceAll("_"," "),closeDelay:0,render:e=>(0,R.jsx)(T.Z,{focused:n,onClick:i,...(0,V.Z)(t||{},(0,V.Z)({onMouseEnter:s},e)),ignoreLocalHoverState:!0,style:O(u).iconButton,children:(0,R.jsx)("img",{src:`data:image/svg+xml;utf8,${encodeURIComponent(p[r])}`,style:O(u).iconImage,onContextMenu:e=>e.preventDefault()})},o)})}function N(e){const{parent:t,icon:o,variations:n,insertIcon:r}=e,i=(0,M.Fg)(),s=(0,j.O7)(),l="dark"===i.mode?n.light:n.dark,a=Object.keys(l).sort(((e,t)=>k.Oe.indexOf(e)-k.Oe.indexOf(t))).map((i=>{const s=`${o}_${i}`;return{key:s,action:e=>{t.close(),r(`/icons/${s}.svg`)},render:t=>(0,R.jsx)(B,{...e,...t,icon:s,color:i,variations:n,shouldOpenVariations:!1,hideTooltip:!0})}}));return(0,R.jsx)(F.Z,{debugName:"IconPickerMenuItem",capture:!0,allowEsc:!0,children:(0,R.jsx)(v.Z,{type:v.i.Grid,itemsPerRow:5,initialFocus:0,sections:[{key:"variations",render:e=>(0,R.jsx)("div",{...e}),items:a}],renderRow:(e,t)=>(0,R.jsx)("div",{style:O(s).variationMenu,children:e},t)})})}function E(e){let{icon:t,focused:o,color:r,onClick:i,onMouseEnter:s,variations:l,hideTooltip:a,insertIcon:c,buttonPopupStore:u}=e;const d=(0,n.useCallback)((()=>function(e){e.setState({...e.state,open:!1})}(u)),[u]),p=(0,n.useCallback)((e=>function(e,t){e.preventDefault(),t.setState({...t.state,open:!0})}(e,u)),[u]);return(0,R.jsx)(_.Z,{debugName:"IconPickerMenuItem",capture:o,onEnter:p,onEsc:d,children:(0,R.jsx)(I.ZP,{buttonPopupStore:u,popupType:I.Z4.Popup,renderOrigin:e=>(0,R.jsx)(D,{icon:t,focused:o,color:r,onClick:i,onMouseEnter:s,variations:l,hideTooltip:a,events:e}),render:e=>(0,R.jsx)(N,{parent:e,icon:t,variations:l,insertIcon:c})})},t)}const K={display:"flex",flexDirection:"column"},G="recentIcons",U=8,W=p.tg,z=p.Nm,H=p.II,q=p.pq,$=p.$P,Y=p.qJ,X=p.PS,Q=356,J=p.T8*U+2*X,ee=p.vP,te=(0,l.defineMessages)({noResults:{defaultMessage:"No results",id:"emojiPicker.noResults.message"}});class oe extends r.Z{constructor(){super(...arguments),this.filter="",this.splitFilter=[],this.storeTypes={store:f.Z,menuListStore:h.Z},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_insertIcon=e=>le(e,this.environment,this.props.onSubmit,this.props.menuRef,this.stores.store,this.props.iconLoggingData),this.createListItem=(e,t)=>{const o=m.x(),n=this.props.enforceIconColor??o,r=`/icons/${`${e}${n?`_${n}`:""}`}.svg`;return{key:r,action:e=>function(e,t,o,n,r,i){le(e,t,o,n,r,i)}(r,this.environment,this.props.onSubmit,this.props.menuRef,this.stores.store,this.props.iconLoggingData),render:o=>(0,R.jsx)(A,{...o,icon:e,color:n??"gray",variations:t,insertIcon:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_insertIcon,shouldOpenVariations:!Boolean(n)})}},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_performGetAllIconsRequest=e=>async function(e,t,o){if(!c.xb(o.getState().allIcons))return o.getState().allIcons;const n=await(0,g.ZP)({environment:t,url:e,method:"GET",format:"json",mode:"cors"});if("success"===n.type)return o.setState({...o.state,allIcons:n.data}),n.data;throw n.error}(e,this.environment,this.stores.store),this.createCategory=(e,t)=>{if(!t)return;let o=[];return o="recent"===e.id?this.stores.store.state.recentIcons||[]:Object.keys(t),0!==o.length?{key:e.id,items:o.map((e=>{if(void 0!==t[e])return this.createListItem(e,t[e])})).filter(Boolean),render:t=>(0,R.jsx)(b.Z,{isTitleUppercase:!0,title:e.title,children:(0,R.jsx)("div",{style:se(this.environment,this.theme),children:t.children})},t.key)}:void 0},this.handleScroll=e=>{if(Math.abs(e)<100){const{loadIconCount:e,allIcons:t}=this.stores.store.state,o=re(this.environment,this.props.menuRef)*ie(this.environment),n=Math.max(o,this.getAllSectionsIconCount(t));this.stores.store.setState({...this.stores.store.state,loadIconCount:Math.min(n,e+o)})}}}UNSAFE_willMount(e){super.UNSAFE_willMount(e);const t=s.Z.get(G);this.stores.store.setState({...this.stores.store.state,recentIcons:t||[]})}renderComponent(){return(0,R.jsx)(d.Z,{request:"/icons/all",performRequest:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_performGetAllIconsRequest,render:(e,t,o)=>o?this.renderIconPicker(t):(0,R.jsx)("div",{style:{display:"flex",width:"100%",height:"100%",justifyContent:"center",alignItems:"center",paddingBottom:"10px"},children:(0,R.jsx)(x.Z,{})})})}renderIconPicker(e){const{menuListStore:t}=this.stores,o=function(e,t,o,n){let{loadIconCount:r}=n.state;0===r&&(r+=re(t,o)*ie(t));const i=[];let s=0;for(const l of e){if(!(s+l.items.length<=r)){i.push({...l,items:l.items.slice(0,r-s)});break}i.push(l),s+=l.items.length}return i}(this.getAllSections(e),this.environment,this.props.menuRef,this.stores.store),n=this.environment.device.isDesktop&&o.length>0?0:void 0;return 0===o.length&&(this.props.onNoResults&&this.props.onNoResults(),o.push({key:"no results",items:[{key:"no results",action:e=>{},render:(e,t)=>(0,R.jsx)(y.Z,{...e,caption:S.default.formatMessage(te.noResults)})}],render:e=>(0,R.jsx)(b.Z,{...e})})),(0,R.jsxs)("div",{style:K,children:[(0,R.jsx)("div",{style:{flexGrow:1},children:(0,R.jsx)(v.Z,{...(r=this.environment,i=this.props.menuRef,{type:v.i.Grid,itemsPerRow:re(r,i),renderRow:(e,t)=>(0,R.jsx)("div",{style:{display:"flex"},children:e},t)}),store:t,initialFocus:n,sections:o,disableKeyboardArrowWrap:!0,unfocusOnScroll:this.environment.device.isMobile})}),(0,R.jsx)(C.Z,{onChange:this.handleScroll})]});var r,i}createFilteredSection(e){if(!e)return[];const t=function(e,t){const o=c.oA(Object.keys(e).map((o=>{const n=e[o],r=((null==n?void 0:n.tooltip)??o).replace("-"," "),i=[r,...n.tags],s=i.findIndex((e=>e===t));if(-1!==s)return[0===s?100:50,o];const l=i.findIndex((e=>e.startsWith(t))),a=r.includes(t);return 0!==l&&a?[40,o]:-1!==l?[0===l?80:30,o]:void 0})));return c.MR(o,(e=>-e[0])).map((e=>e[1]))}(e,this.filter);return 0===t.length?[]:[{key:"search-results",items:t.map((t=>this.createListItem(t,e[t]))),render:e=>(0,R.jsx)(b.Z,{children:(0,R.jsx)("div",{style:se(this.environment,this.theme),children:e.children})},e.key)}]}getAllSections(e){this.filter=i.rJ(this.props.filter)??"",this.splitFilter=this.filter?this.filter.split(" ").filter(Boolean):[];const t=c.oA((o=this.props.filter,c.oA([!o&&{id:"recent",title:(0,R.jsx)(l.FormattedMessage,{id:"iconPicker.section.recent",defaultMessage:"Recent"})},!o&&{id:"icons",title:(0,R.jsx)(l.FormattedMessage,{id:"iconPicker.section.icons",defaultMessage:"Icons"})}])).map((t=>this.createCategory(t,e))));var o;return this.props.filter&&this.filter?this.createFilteredSection(e):t}getAllSectionsIconCount(e){const t=this.getAllSections(e);let o=0;for(const n of t)o+=n.items.length;return o}}oe.displayName="IconPicker";const ne=oe;function re(e,t){var o,n;const{device:r,WindowSizeStore:i}=e;return r.isPhone?(window.innerWidth-i.getSafePaddingLeftPx($)-i.getSafePaddingRightPx(Y))/p.mz:r.isTablet?W:null!=t&&null!==(o=t.current)&&void 0!==o&&o.offsetWidth?((null==t||null===(n=t.current)||void 0===n?void 0:n.offsetWidth)-2*X)/p.T8:r.isTablet?W:U}function ie(e){return e.device.isMobile?q:H}function se(e,t){const{device:o,WindowSizeStore:n}=e;return{display:"flex",flexDirection:"column",flexWrap:"wrap",alignItems:"flex-start",...o.isPhone?{background:t.popoverBackground,paddingTop:10,paddingBottom:10,paddingLeft:n.getSafePaddingLeftCSS($),paddingRight:n.getSafePaddingLeftCSS(Y),boxShadow:`0 1px 0 ${t.regularDividerColor}`,marginBottom:1}:{background:a.ZP.transparent,paddingLeft:o.isTablet?ee:X,paddingRight:o.isTablet?ee:X}}}function le(e,t,o,n,r,i){const l=function(e){return e.replace("_dark","")}(e);o(l);const a=l.split(/[/_.]/),d=a[2],p=a[3];!function(e,t,o,n){const r=s.Z.get(G),i=c.G0([e],r),l=c.qn(i,re(t,o)*z);s.Z.set(G,l),n.setState({...n.state,recentIcons:l})}(d,t,n,r),i&&u.fA(t,"pick_colored_icon",{icon:d,color:p,...i})}},3072:(e,t,o)=>{o.d(t,{Z:()=>C});o(57658),o(67294);var n=o(480),r=o(2032),i=o(9291),s=o(53965),l=o(47853),a=o(16187),c=o(60709),u=o(98742),d=o(52275),p=o(78140),g=o(32163),m=o(40721),S=o(53437),f=o(72495),h=o(26388),y=o(42782),x=o(85893);const v=(0,i.defineMessages)({noneText:{defaultMessage:"None",id:"database.propertyAggregationMenu.noneText"}});const C=(0,i.injectIntl)((function(e){let{onClose:t,property:o,schema:s,currentAggregation:l,source:a,noneText:u,intl:S,onChange:h}=e;const y=(0,n.O7)(),{device:C}=y;let b;b=C.isMobile?{menuType:c.og.Modal,title:(0,x.jsx)(i.FormattedMessage,{defaultMessage:"Table aggregation",id:"database.mobilePropertyAggregationMenu.title"}),right:(0,x.jsx)(m.DoneMenuText,{}),onClickRight:t}:{menuType:c.og.Popup,width:200};const[M,k]=function(e,t,o,n,i,s,l,a){const c=[],u=t[e];if(!u)return[[],void 0];let p;c.push({key:"none",render:e=>(0,x.jsx)(d.Z,{...e,title:a||n.formatMessage(v.noneText)}),action:()=>i(void 0)});for(const d of r.o5)c.push(j(d,i)),l===d&&(p=c.length-1);if((0,r.iV)(u))for(const d of r.Sy){const e=j(d,i);if("show_unique"===d)switch(o){case"tableAggregation":continue;case"rollupPropertyMenu":c.splice(1,0,e);continue}c.push(e),l===d&&(p=c.length-1)}if((0,r.O4)(u))for(const d of r.k$)c.push(j(d,i)),l===d&&(p=c.length-1);if((0,r.dN)(u))for(const d of r.f8)c.push(j(d,i)),l===d&&(p=c.length-1);if((0,r.Mv)(u))for(const d of r.gC)c.push(j(d,i)),l===d&&(p=c.length-1);if((0,r.Ei)(u))for(const d of r.OK)c.push(w(e,d,l,t,i,s)),"object"==typeof l&&"operator"in l&&l.operator===d&&(p=c.length-1);if((0,r.FN)(u))for(const d of r.tD)c.push(j(d,i)),l===d&&(p=c.length-1);return[c,p]}(o,s,a,S,h,y,l,u);return(0,x.jsx)(p.Z,{...b,children:(0,x.jsx)(g.Z,{type:g.i.Vertical,initialFocus:k??0,sections:[{key:0,render:e=>(0,x.jsx)(f.Z,{...e}),items:M}],onAccept:t})})}));function b(e){let{aggregationType:t,label:o,props:n}=e;const r=a.Sn[t];return(0,x.jsx)(h.ZP,{placement:S.GI.Placement.Right,delayThreshold:0,render:e=>(0,x.jsx)(d.Z,{title:o,...(0,u.Z)(e,n)}),renderTooltip:()=>(0,x.jsxs)("div",{style:{width:140,whiteSpace:"normal"},children:[r&&(0,x.jsx)("img",{src:(0,l.D)(r),style:{borderRadius:4,width:140,marginTop:4}}),a.BG[t]]})},n.key)}function j(e,t){const o=a.VN[e],n=a.Sn[e];return{key:o,render:t=>(0,x.jsx)(h.ZP,{placement:S.GI.Placement.Right,delayThreshold:0,render:e=>(0,x.jsx)(d.Z,{title:o,...(0,u.Z)(e,t)}),renderTooltip:()=>(0,x.jsxs)("div",{style:{width:140,whiteSpace:"normal"},children:[n&&(0,x.jsx)("img",{src:(0,l.D)(n),style:{borderRadius:4,width:140,marginTop:4}}),a.BG[e]]})},t.key),action:()=>{t(e)}}}function w(e,t,o,n,r,i){const{device:l}=i,u=a.VN[t],S=s.oA(function(e,t,o,n){const r=o[e];if(!r||"status"!==r.type)return;const i=r.groups;return i?i.map((e=>({key:`${t}${e.name}`,render:o=>(0,x.jsx)(b,{aggregationType:t,label:e.name,props:o}),action:()=>{n({operator:t,groupName:e.name})}}))):void 0}(e,t,n,r));let h=0;if("object"==typeof o&&"operator"in o&&o.operator===t){const e=o.groupName,n=S.findIndex((o=>o.key===`${t}${e}`));-1!==n&&(h=n)}return{key:t,render:(e,t)=>(0,x.jsx)(y.Z,{...e,onFocus:t.onFocus,renderOrigin:e=>(0,x.jsx)(d.Z,{...e,title:u}),renderExtension:(e,o)=>{let n;return n=l.isMobile?{menuType:c.og.Modal,title:u,right:(0,x.jsx)(m.DoneMenuText,{}),onClickRight:o.close,...e}:{menuType:c.og.Popup,width:200,...e},(0,x.jsx)(p.Z,{...n,children:(0,x.jsx)(g.Z,{type:g.i.Vertical,initialFocus:h,sections:[{key:"groups",render:e=>(0,x.jsx)(f.Z,{...e}),items:S}],onAccept:t.onAccept})})}}),action:()=>null}}},9050:(e,t,o)=>{o.d(t,{Z:()=>c});o(67294);var n=o(480),r=o(24405),i=o(31701),s=o(80025),l=o(52275),a=o(85893);const c=function(e){const{color:t}=e;return(0,a.jsx)(l.Z,{...e,icon:(0,a.jsx)(u,{color:t}),title:(0,s.Vn)(t)})};function u(e){let{color:t}=e;const o=(0,r.Fg)(),s=(0,n.O7)(),l=(0,i.KR)(o,t);return(0,a.jsx)("div",{style:{width:s.device.isMobile?24:18,height:s.device.isMobile?24:18,background:l.menuBackgroundColor,color:l.textColor,boxShadow:o.innerBorderBoxShadow,borderRadius:4}})}},97680:(e,t,o)=>{o.d(t,{Z:()=>h});var n=o(67294),r=o(480),i=o(86628),s=o(66897),l=o(9291),a=o(1898),c=o(98742),u=o(4023),d=o(52275),p=o(26388),g=o(70301),m=o(45653),S=o(85893);const f=n.forwardRef(((e,t)=>{const{actor:o,userTitle:n,useEmailAsTooltip:f,tooltip:h,tooltipPlacement:y}=e,x=(0,r.O7)(),v=(0,l.useIntl)(),C=(0,i.VK)((()=>o.asActor&&o.isUser()?o.email:void 0),[o]),b=f&&C?C:h,j=x.device.isMobile?24:20;let w;return(0,s.YU)(o)?w=(0,S.jsx)(g.Z,{botValue:null==o?void 0:o.asActor,size:j}):(0,s.$S)(o)?w=(0,S.jsx)(m.Z,{userValue:null==o?void 0:o.asActor,size:j}):(0,s.Iq)(o)?w=(0,S.jsx)(m.Z,{userValue:void 0,size:j}):(0,a.t1)(o),(0,S.jsx)(p.ZP,{ref:t,placement:y??u.u.Bottom,alignment:u.v.Start,textWrap:!0,render:t=>(0,S.jsx)(d.Z,{...(0,c.Z)(t,e),icon:w,title:n??(0,s.$4)(v,o),className:"notranslate",right:e.right}),disableTooltip:!b,renderTooltip:()=>b})}));f.displayName="UserMenuItem";const h=f},30905:(e,t,o)=>{o.d(t,{TB:()=>b,Xh:()=>x,Y7:()=>C,ZP:()=>v,qQ:()=>y});var n=o(67294),r=o(86628),i=o(24405),s=o(6695),l=o(20669),a=o(23512),c=o(3791),u=o(9291),d=o(44866),p=o(94166),g=o(14976),m=o(88280),S=o(91839),f=o(26388),h=o(85893);function y(e){let{collectionStore:t,propertySchema:o}=e;const n=(0,r.VK)((()=>(0,g.Xh)(t.getName(),t)),[t]),i=(0,r.VK)((()=>{var e;const t=(null===(e=m.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,c.de)(t)}),[]);return(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{color:"white",fontWeight:500,wordWrap:"break-word",whiteSpace:"pre-wrap"},children:(0,h.jsx)(u.FormattedMessage,{...d.fillAllPagesMessages.fillAllPagesTooltip,values:{hasNames:Boolean(n)&&Boolean(o.name),collectionName:n,propertyName:o.name}})}),!i&&(0,h.jsx)("div",{style:{color:"#ACABA9",fontWeight:500},children:(0,h.jsx)(u.FormattedMessage,{...d.fillAllPagesMessages.fillAllPagesAddOnMessage})})]})}function x(e){let{updateAiInferencesTaskStatus:t,iconStyle:o,progressIconStyle:n}=e;const r=(0,i.Fg)();return t.isRunning?(0,h.jsx)("div",{style:n,children:(0,h.jsx)(S.Z,{})}):(0,l.y)({width:14,color:r.accentColors.purple[400],...o})}function v(e){let{updateAiInferencesTaskStatus:t,style:o}=e;const n=(0,u.useIntl)();return(0,h.jsx)("div",{style:o,children:t.isRunning?(0,h.jsx)("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:void 0===t.numPagesFilled||void 0===t.numPagesRequested?(0,h.jsx)(u.FormattedMessage,{defaultMessage:"Autofilling all pages",id:"aiAutofill.fillallPages.updatingAllPages"}):(0,h.jsx)(u.FormattedMessage,{defaultMessage:"{numPagesRequested, plural, one {Autofilling {numPagesFilled} of {numPagesRequested} page} other {Updating {numPagesFilled} of {numPagesRequested} pages}}",id:"aiAutofill.fillallPages.updatingAllPagesWithProgress",values:{numPagesFilled:(0,a.uf)(t.numPagesFilled,"compact",n),numPagesRequested:(0,a.uf)(t.numPagesRequested,"compact",n)}})}):(0,h.jsx)(u.FormattedMessage,{defaultMessage:"Autofill all pages",id:"aiAutofill.fillAllPages.buttonTitle"})})}function C(e){let{updateAiInferencesTaskStatus:t}=e;const{numPagesFilled:o,numPagesRequested:n}={numPagesFilled:void 0,numPagesRequested:void 0,...t},r=(0,i.yK)((e=>({inner:{background:e.accentColors.purple[400],height:"100%",transition:"width .5s"},outer:{background:e.accentColors.gray[100],height:3,borderRadius:2,minWidth:120,overflow:"hidden",marginTop:8}})),[]);return void 0===o||void 0===n?null:(0,h.jsx)("div",{style:r.outer,role:"progressbar",children:(0,h.jsx)("div",{style:{...r.inner,width:100*Math.min(o/n,1)+"%"}})})}function b(e){const{environment:t,collectionContextStore:o,collectionStore:i,property:l,propertySchema:a,doesUserHaveAIAddOn:c,isAutofillSetupEnabled:u}=e,g=(0,r.VK)((()=>{const e=o.collectionStore();return e?(0,s.De)(e.getFormat(),l):{isRunning:!1,numPagesFilled:void 0,numPagesRequested:void 0}}),[o,l]),m=(0,n.useCallback)((async()=>{const e=o.collectionStore();e&&a&&await d.autofillPropertyForCollection({environment:t,collectionStore:e,propertySchema:a,property:l})}),[t,a,l,o]);return(0,h.jsx)(f.ZP,{disableTooltip:c,renderTooltip:()=>(0,h.jsx)(y,{collectionStore:i,propertySchema:a}),render:e=>(0,h.jsx)(p.Z,{icon:e=>(0,h.jsx)(x,{updateAiInferencesTaskStatus:g,iconStyle:e,progressIconStyle:{marginTop:4,marginLeft:4,marginRight:2}}),title:(0,h.jsx)(v,{updateAiInferencesTaskStatus:g}),caption:void 0!==g.numPagesFilled&&void 0!==g.numPagesRequested&&(0,h.jsx)(C,{updateAiInferencesTaskStatus:g}),focused:!1,onClick:m,disabled:g.isRunning||!u,...e})})}},43350:(e,t,o)=>{o.d(t,{Z:()=>s});o(67294);var n=o(4430);o(57658);var r=o(85893);const i=16;function s(e){const{startPoint:t,endPoint:o,style:i,showArrowHead:s,useRightAngles:c,cornerRadiusOverride:u,handleMouseMove:d,handleMouseLeave:p}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a,{startPoint:t,startCurvePoint:c?void 0:{x:t.x+n.i2,y:t.y},endPoint:s?{x:o.x-1.5,y:o.y}:o,endCurvePoint:c?void 0:{x:o.x-n.i2,y:o.y},cornerRadiusOverride:u,style:i,handleMouseMove:d,handleMouseLeave:p,children:e.children}),s&&(0,r.jsx)(l,{endPoint:o,style:i})]})}function l(e){const{endPoint:t,style:o}=e;return(0,r.jsx)("polyline",{points:`${t.x-5},${t.y-6} ${t.x},${t.y} ${t.x-5},${t.y+6}`,style:o,fill:"transparent"})}function a(e){const{startPoint:t,startCurvePoint:o,endPoint:n,endCurvePoint:s,style:l,cornerRadiusOverride:a,handleMouseMove:c,handleMouseLeave:u}=e;let d="";d=o&&s?`M ${t.x} ${t.y} L ${o.x} ${o.y} L ${s.x} ${s.y} L ${n.x} ${n.y}`:`M ${t.x} ${t.y} L ${t.x} ${n.y} L ${n.x} ${n.y}`;const p=function(e,t){function o(e,t,o){const r=t.x-e.x,i=t.y-e.y,s=Math.sqrt(r*r+i*i);return n(e,t,Math.min(1,o/s))}function n(e,t,o){return{x:e.x+(t.x-e.x)*o,y:e.y+(t.y-e.y)*o}}function r(e,t){e.length>2&&(e[e.length-2]=t.x.toString(),e[e.length-1]=t.y.toString())}function i(e){return{x:parseFloat(e[e.length-2]),y:parseFloat(e[e.length-1])}}const s=e.split(/[,\s]/).reduce(((e,t)=>{const o=t.match("([a-zA-Z])(.+)");return o?(e.push(o[1]),e.push(o[2])):e.push(t),e}),[]).reduce((function(e,t){return!isNaN(parseFloat(t))&&e.length?e[e.length-1].push(t):e.push([t]),e}),[]);let l=[];if(s.length>1){const e=i(s[0]);let a=null;"Z"===s[s.length-1][0]&&s[0].length>2&&(a=["L",e.x.toString(),e.y.toString()],s[s.length-1]=a),l.push(s[0]);for(let c=1;c<s.length;c++){const e=l[l.length-1],u=s[c],d=u===a?s[1]:s[c+1];if(d&&e&&e.length>2&&"L"===u[0]&&d.length>2&&"L"===d[0]){const s=i(e),a=i(u),c=i(d),p=o(a,s,t),g=o(a,c,t);r(u,p),l.push(u);const m=n(p,a,.5),S=n(a,g,.5),f=["C",m.x.toString(),m.y.toString(),S.x.toString(),S.y.toString(),g.x.toString(),g.y.toString()];l.push(f)}else l.push(u)}if(a){const e=i(l[l.length-1]);l.push(["Z"]),r(l[0],e)}}else l=s;return l.reduce((function(e,t){return`${e}${t.join(" ")} `}),"")}(d,a||i);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:p,style:l,fill:"transparent"}),(c||u)&&(0,r.jsxs)("g",{onMouseMove:c,onMouseLeave:u,children:[(0,r.jsx)("path",{d:p,style:{strokeOpacity:0,strokeWidth:16,pointerEvents:"stroke",cursor:"default"},fill:"transparent"}),e.children]})]})}},65089:(e,t,o)=>{o.d(t,{FF:()=>s,Yy:()=>a,bZ:()=>l});o(67294);var n=o(9291),r=o(88492),i=o(85893);function s(e){let{origin:t}=e;return(0,i.jsx)(r.r,{origin:t,placementToOrigin:"bottom",style:{minWidth:240},tutorialId:"sprints-onboarding",tutorialStepId:"current-sprint-view-tooltip",header:(0,i.jsx)(n.FormattedMessage,{id:"SprintsBoardOnboardingTooltip.SprintBoardView.header",defaultMessage:"Manage the current sprint"}),content:(0,i.jsx)(n.FormattedMessage,{id:"SprintsBoardOnboardingTooltip.SprintBoardView.content",defaultMessage:"Add tasks and update task status as your team makes progress during the sprint."})})}function l(e){let{origin:t}=e;return(0,i.jsx)(r.r,{origin:t,placementToOrigin:"bottom",tutorialId:"sprints-onboarding",tutorialStepId:"sprint-task-tooltip",header:(0,i.jsx)(n.FormattedMessage,{id:"SprintsBoardOnboardingTooltip.SprintBoardItem.header",defaultMessage:"Change tasks status"}),content:(0,i.jsx)(n.FormattedMessage,{id:"SprintsBoardOnboardingTooltip.SprintBoardItem.content",defaultMessage:'Drag this task to "In progress".'})})}function a(e){let{origin:t}=e;return(0,i.jsx)(r.r,{origin:t,placementToOrigin:"bottom",style:{minWidth:240},tutorialId:"sprints-onboarding",tutorialStepId:"complete-sprint-button-tooltip",header:(0,i.jsx)(n.FormattedMessage,{id:"SprintsBoardOnboardingTooltip.CompleteSprintButton.header",defaultMessage:"Complete this sprint"}),content:(0,i.jsx)(n.FormattedMessage,{id:"SprintsBoardOnboardingTooltip.CompleteSprintButton.content",defaultMessage:"Click the button when you're done with this sprint."})})}},48190:(e,t,o)=>{o.d(t,{P:()=>d,Z:()=>u});var n=o(67294),r=o(1302),i=o(86628),s=o(28155),l=o(40107),a=o(53965),c=o(75330);function u(e){const{id:t,reducer:o,collectionContextStore:s,groupsPointer:u}=e,p=(0,i.VK)((()=>u),[u],{useDeepEqual:!0}),g=(0,i.VK)((()=>o),[o],{useDeepEqual:!0}),m=(0,i.VK)((()=>s.collectionViewStore()),[s]),S=(0,i.VK)((()=>{var e;return null==m||null===(e=m.getFormatStore())||void 0===e?void 0:e.getKeyStore("collection_view_source").getValue()}),[m]),f=(0,n.useRef)(!1),h=(0,l.S)(),[y,x]=(0,n.useReducer)(((e,t)=>a.Xy(e,t)?e:t),void 0),v=(0,n.useCallback)((()=>{const e=s.localResultStore.state,o=s.remoteResult.state,n=e&&"reducer"===e.type?e.reducerResults[t]:void 0,r=o&&"reducer"===o.type?o.reducerResults[t]:void 0;return d({reducerId:t,collectionContextStore:s,reducer:g,localReducerResult:n,remoteReducerResult:r})}),[s,g,t]),C=(0,n.useCallback)((()=>{f.current=!1,h()||x(v())}),[v,h]),b=(0,n.useCallback)((()=>{f.current||(f.current=!0,r.default.afterNextFlush(C))}),[C]);return(0,n.useEffect)((()=>(s.remoteResult.addListener(b),s.localResultStore.addListener(b),()=>{s.remoteResult.removeListener(b),s.localResultStore.removeListener(b)})),[s,b]),(0,n.useEffect)((()=>(c.$D({reducerId:t,instanceId:void 0,reducer:g,collectionContextStore:s,groupsPointer:p}),()=>{c.$D({reducerId:t,instanceId:void 0,reducer:void 0,collectionContextStore:s,groupsPointer:p})})),[s,m,S,p,g,t]),(0,n.useEffect)((()=>{b()}),[]),y}function d(e){const{reducerId:t,localReducerResult:o,remoteReducerResult:n,collectionContextStore:r,reducer:i}=e,l=r.reducers.state,c=r.remoteResult.state;if(r.isClientModeEnabled.state)return o;if("aggregation"===i.type||"groups"===i.type){if(null!=c&&c.reducerResults[t])return c.reducerResults[t];const e=Boolean(c&&"reducer"===c.type&&a.sE(c.reducerResults,((e,t)=>{const o=l[t];return Boolean(o&&"results"===o.reducer.type&&!o.reducer.searchQuery&&"results"===e.type&&e.hasMore&&a.Xy(i.filter,o.reducer.filter))})));return e?o:n}if("results"===i.type){var u;const e=r.wasCreatedThisSession.state,i=Boolean(c&&"reducer"===c.type&&c.reducerResults[t]),l=(0,s.nx)(null===(u=r.collectionViewStore())||void 0===u?void 0:u.getCollectionSource());if((i||e)&&!l&&o&&"results"===o.type){return{...o,hasMore:n&&"results"===n.type?n.hasMore:o.hasMore}}return n}}},57200:(e,t,o)=>{o.d(t,{Z:()=>et});var n=o(67294),r=o(86628),i=o(480),s=o(24405),l=o(9291),a=o(37810),c=o(36610),u=o(27370),d=o(75079),p=o(64856),g=o(80444),m=o(65089),S=o(63123),f=o(49085),h=o(15145),y=o(92996),x=o(84619),v=o(40506),C=o(7057),b=o(36591),j=o(42853),w=o(13148),M=o(47453),k=o(53523),V=o(606),P=o(21202),T=o(94438),I=o(70203),F=o(31701),_=o(1898),Z=o(19584),R=o(75754),B=o(36821),A=o(93174),L=o(60709),O=o(37034),D=o(29376),N=o(58484),E=o(6258),K=o(97039),G=o(78030),U=o(52275),W=o(31945),z=o(73063),H=o(36596),q=o(78140),$=o(32163),Y=o(40721),X=o(89728),Q=o(58297),J=o(31278),ee=o(76798),te=o(72495),oe=o(83264),ne=o(50506),re=o(53437),ie=o(85893);function se(e){const{isOpen:t,onDismiss:o,render:n,origin:r,style:s,innerStyle:l,ariaLabel:a,ariaLabelledBy:c}=e,{isMobile:u}=(0,i.Fy)();return u?(0,ie.jsx)(re.ZP,{ariaLabel:a,ariaLabelledBy:c,open:t,popupType:re.ZP.PopupType.SlideUp,origin:r,onDismiss:o,render:n,style:s}):(0,ie.jsx)(ne.Z,{ariaLabel:a,ariaLabelledBy:c,open:t,preventHideChildrenWhileOpening:!0,render:n,onDismiss:o,style:s,innerStyle:l})}var le=o(42402),ae=o(85567);const ce=(0,l.defineMessages)({completedPercentSummary:{id:"completeAutomationSprintModal.sprintSummary.completedPercentSummary",defaultMessage:"{completedTaskCount} / {totalTaskCount} total tasks"},selectNextSprintLabel:{id:"completeAutomationSprintModal.sprintSummary.selectNextSprintLabel",defaultMessage:"Next sprint"},selectDatesForNextSprintLabel:{id:"completeAutomationSprintModal.sprintSummary.selectDatesForNextSprintLabel",defaultMessage:"Start and end dates"},nextSprintDatesLabel:{id:"completeAutomationSprintModal.sprintSummary.nextSprintDatesLabel",defaultMessage:"Next sprint dates"},cancelButton:{id:"completeAutomationSprintModal.sprintSummary.cancel",defaultMessage:"Cancel"},fallbackSprintName:{id:"completeAutomationSprintModal.sprintName.placeholder",defaultMessage:"Sprint"}});function ue(e){let{onDismiss:t,...o}=e;const{isOpen:r}=o,s=(0,i.O7)(),l=(0,n.useId)(),a=e=>{t();let n=!1;(0,_.Kn)(e)&&(0,_.$K)(e.clickedCancel)&&(n=!0===e.clickedCancel),c.$X(s,{...(0,d.Pn)(o.taskCollectionContextStore),action:n?"cancel_modal":"dismiss_modal"})};return(0,ie.jsx)(se,{ariaLabelledBy:l,isOpen:r,onDismiss:()=>a(),render:()=>(0,ie.jsx)(de,{...o,onDismiss:a,titleAriaId:l})})}function de(e){var t;const{completeSprintAutomationContext:o,setIsLoading:s,taskCollectionContextStore:a,onDismiss:c,completeSprintAutomationState:u,onAutomationComplete:d,titleAriaId:p}=e,{currentSprintId:m,querySprintsResult:h,currentSprintTaskSummary:y}=u,x=(0,l.useIntl)(),C=(0,i.O7)(),{isMobile:b}=(0,i.Fy)(),j=(0,r.VK)((()=>g.default.state.currentUserSettingsStore),[]),w=(0,r.VK)((()=>o.sprintCollectionStore),[o]),M=(0,r.VK)((()=>{var e;const t=null===(e=o.automationContext)||void 0===e?void 0:e.automationStore;return null==t?void 0:t.getRecurrence()}),[o]),k=(0,r.VK)((()=>{var e;return(null===(e=o.automationContext)||void 0===e||null===(e=e.automationActionStore.getConfig())||void 0===e?void 0:e.complete_sprint_action)??"complete_sprint_and_move_incomplete_tasks_to_next_sprint"}),[null===(t=o.automationContext)||void 0===t?void 0:t.automationActionStore]),V=(0,r.VK)((()=>w.getSpaceId()),[w]),I=(0,r.VK)((()=>{if(m)return E.G.createChildStore(w,{id:m,table:P.iU,spaceId:w.getSpaceId()})}),[m,w]),F=(0,r.VK)((()=>I?(0,O.vU)({intl:x,environment:C,store:I,untitledFallback:ce.fallbackSprintName}):x.formatMessage(ce.fallbackSprintName)),[I,x,C]),_=(0,r.VK)((()=>he({sprintBlockStore:I,sprintCollectionStore:w})),[I,w]),R=(0,r.VK)((()=>ye({sprintDateRange:_,intl:x})),[_,x]),[B,L]=n.useState(),D=(0,r.VK)((()=>f.default.createValue(k)),[k]),N=n.useMemo((()=>{if(!M||null==_||!_.end_date)return;const e=(0,T.Su)(M);return e?(0,T.rP)({currentSprintEndDate:_.end_date,sprintSchedule:e}):void 0}),[M,null==_?void 0:_.end_date]),K=(0,r.VK)((()=>{if("pointer"!==(null==B?void 0:B.type))return;return he({sprintBlockStore:E.G.createChildStore(w,B.pointer),sprintCollectionStore:w})}),[B,w]),[G,U]=n.useState(void 0),W=n.useMemo((()=>{if(G&&(0,v.h)(G))return G}),[G]),z=n.useMemo((()=>{if(!h)return;const{nextSprintIds:e,futureSprintIds:t}=h;return e.length>0?e:t}),[h]),H=(0,r.VK)((()=>{if(void 0===z)return;const e=z[0];return e?{type:"pointer",pointer:{id:e,table:P.iU,spaceId:V}}:{type:"actionId"}}),[z,V]),q=(0,r.VK)((()=>{var e;return!Boolean(null==j||null===(e=j.getSettings())||void 0===e?void 0:e.seen_sprint_settings_engagement_banner)}),[j]);n.useEffect((()=>{H&&L(H)}),[H,L]),n.useEffect((()=>{U(K??N)}),[K,N,U]);const $=n.useCallback((async()=>{if(c(),!B||!W||!o.automationContext)return;s(!0);const e=0===(null==y?void 0:y.incompleteTaskCount)?"complete_sprint":D.state;if(!o.automationContext)return;const t={type:"recurrence",recurrence:{type:"completeSprint",completeSprintActionType:e,nextSprintDateRange:W},automationStore:o.automationContext.automationStore,intl:x,parentRecordStore:o.currentCollectionViewBlockStore},n=()=>{d()},{automationExecutionActions:r}=await A._1.loader();await r.executeClientAutomation({environment:C,store:o.currentCollectionViewBlockStore,clientContext:t,onUndo:()=>{s(!0),n(),s(!1)}}),n(),s(!1)}),[c,B,W,s,null==y?void 0:y.incompleteTaskCount,D,o.automationContext,o.currentCollectionViewBlockStore,x,C,d]),Y=me({isMobile:b}),{status:J}=(0,S.V)({value:u,validateLoaded:e=>!1===e.isLoading,waitTimeInMs:1*Z.hM});if("pending"!==J&&u.isLoading)return(0,ie.jsx)(pe,{titleAriaId:p,onDismiss:c,sprintCollectionStore:w});if(u.isLoading)return(0,ie.jsx)(ge,{titleAriaId:p,onDismiss:c});const{incompleteTaskCount:ee}=u.currentSprintTaskSummary,te=Boolean(B)&&Boolean(W),oe=void 0!==z&&z.length>0;return(0,ie.jsxs)("div",{style:Y.modalContainer,children:[(0,ie.jsx)("div",{style:Y.header,id:p,children:(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.title",defaultMessage:"{sprintName} summary",values:{sprintName:F}})}),(0,ie.jsx)(fe,{currentSprintFormattedDateRange:R,currentSprintTaskSummary:y}),q&&(0,ie.jsx)(Se,{collectionContextStore:a,userSettingsStore:j,onDismissModal:c}),oe&&(0,ie.jsxs)("div",{style:Y.flexRow,children:[x.formatMessage(ce.selectNextSprintLabel),(0,ie.jsx)(je,{nextSprintInput:B,setNextSprintInput:L,completeSprintAutomationContext:o,sprintPageIds:z})]}),(0,ie.jsxs)("div",{style:Y.flexRow,children:[oe?x.formatMessage(ce.selectDatesForNextSprintLabel):x.formatMessage(ce.nextSprintDatesLabel),(0,ie.jsx)(Me,{sprintDateRange:G,setSprintDateRange:U})]}),ee>0&&(0,ie.jsxs)("div",{style:Y.flexRow,children:[(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.incompleteTasksLabel",defaultMessage:"{incompleteTaskCount, plural, one {{incompleteTaskCount} incomplete task} other {{incompleteTaskCount} incomplete tasks}}",values:{incompleteTaskCount:ee}}),(0,ie.jsx)(ve,{actionTypeStore:D})]}),(0,ie.jsx)(Q.Z,{disabled:!te,onClick:()=>{$()},style:Y.button,children:(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.completeSprintButton",defaultMessage:"Complete {sprintName}",values:{sprintName:F}})}),(0,ie.jsx)(X.Z,{onClick:()=>c({clickedCancel:!0}),style:Y.button,children:x.formatMessage(ce.cancelButton)})]})}function pe(e){const{onDismiss:t,sprintCollectionStore:o,titleAriaId:n}=e,s=(0,i.O7)(),a=(0,l.useIntl)(),{isMobile:c}=(0,i.Fy)(),u=(0,r.VK)((()=>o.getParentBlockStore()),[o]),d=me({isMobile:c});return(0,ie.jsxs)("div",{style:d.modalContainer,children:[(0,ie.jsx)("div",{style:d.header,id:n,children:(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintModal.missingCurrentSprint.title",defaultMessage:"No current sprint found"})}),(0,ie.jsx)(Q.Z,{onClick:()=>{u&&R._c({environment:s,store:u,pageVisitSource:h.tY.LinkInPage})},style:{...d.button,marginTop:24},children:(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintModal.missingCurrentSprint.navigateToSprintsDatabase",defaultMessage:"Fix in Sprints database"})}),(0,ie.jsx)(X.Z,{onClick:t,style:d.button,children:a.formatMessage(ce.cancelButton)})]})}function ge(e){const{onDismiss:t,titleAriaId:o}=e,n=(0,l.useIntl)(),{isMobile:r}=(0,i.Fy)(),s=me({isMobile:r});return(0,ie.jsxs)("div",{style:s.modalContainer,children:[(0,ie.jsx)("div",{style:s.header,id:o,children:(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.titlePlaceholder",defaultMessage:"Sprint summary"})}),(0,ie.jsx)("div",{style:s.subheader,children:(0,ie.jsx)(H.Z,{style:s.subheaderShimmer})}),(0,ie.jsxs)("div",{style:s.flexRow,children:[n.formatMessage(ce.selectNextSprintLabel),(0,ie.jsx)(H.Z,{style:s.flexRowShimmerBox1})]}),(0,ie.jsxs)("div",{style:s.flexRow,children:[n.formatMessage(ce.selectDatesForNextSprintLabel),(0,ie.jsx)(H.Z,{style:s.flexRowShimmerBox2})]}),(0,ie.jsxs)("div",{style:s.flexRow,children:[(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.incompleteTasksPlaceholder",defaultMessage:"Incomplete tasks"}),(0,ie.jsx)(H.Z,{style:s.flexRowShimmerBox3})]}),(0,ie.jsx)(Q.Z,{disabled:!0,onClick:()=>{},style:s.button,children:(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.completeSprintButtonPlaceholder",defaultMessage:"Complete sprint"})}),(0,ie.jsx)(X.Z,{onClick:t,style:s.button,children:n.formatMessage(ce.cancelButton)})]})}function me(e){let{isMobile:t}=e;return(0,s.yK)((e=>{const o={height:44,borderRadius:8,display:"flex",alignItems:"center",width:void 0},n={...o,marginTop:12,marginBottom:18};return{modalContainer:{width:400,display:"flex",fontSize:t?a.Z.fontSize.UIRegular.mobile:a.Z.fontSize.UIRegular.desktop,flexDirection:"column",justifyContent:"center",padding:20},header:{display:"flex",alignItems:"center",justifyContent:"center",fontSize:t?18:16,fontWeight:a.Z.fontWeight.semibold},subheader:{display:"flex",alignItems:"center",justifyContent:"center",color:e.lightTextColor,marginBottom:16,gap:8},separator:{height:2,width:2,borderRadius:2,backgroundColor:e.lightIconColor},flexRow:{display:"flex",...t?{flexDirection:"column",fontSize:14,color:e.mediumTextColor}:{justifyContent:"space-between",alignItems:"center",height:24,marginBottom:16}},completedTaskGroup:{display:"flex",gap:4},button:{display:"flex",alignItems:"center",justifyContent:"center",marginTop:8,...t&&o},subheaderShimmer:{borderRadius:4,marginTop:6,width:200,height:16,...t&&{height:22}},flexRowShimmerBox1:{borderRadius:4,width:60,height:16,...t&&n},flexRowShimmerBox2:{borderRadius:4,width:80,height:16,...t&&n},flexRowShimmerBox3:{borderRadius:4,width:140,height:16,...t&&n},dropdownButton:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:4,...t&&{...n,border:`1px solid ${e.accentColors.gray[50]}`,justifyContent:"space-between"}},dropdownChevronIcon:{color:e.lightIconColor,width:12,height:"auto"}}}),[t])}function Se(e){const{collectionContextStore:t,userSettingsStore:o,onDismissModal:n}=e,r=(0,i.O7)(),c=(0,s.yK)((e=>({banner:{width:"100%",display:"flex",alignItems:"start",backgroundColor:e.accentColors.blue["light"===e.mode?50:300],borderRadius:4,padding:12,marginBottom:12,fontSize:12,lineHeight:1.5,gap:8},bannerContent:{flex:"1 1 auto",color:e.regularTextColor},bannerTitle:{fontWeight:a.Z.fontWeight.regular},icon:{width:12,color:e.blueColor},repeatIcon:{flex:"0 0 auto",marginBlockStart:3},closeButton:{marginTop:-3,borderRadius:"50%"},link:{color:e.text.uiBluePrimary}})),[]);return(0,ie.jsxs)("div",{style:c.banner,children:[(0,ie.jsx)("div",{style:c.repeatIcon,children:(0,k.N)(c.icon)}),(0,ie.jsx)("div",{style:c.bannerContent,children:(0,ie.jsx)("div",{style:c.bannerTitle,children:(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintModal.turnOnAutomaticSprints.banner.title",defaultMessage:"Complete your sprints automatically. Turn on Automated sprints in <linkToSprintSettings>Settings</linkToSprintSettings>.",values:{linkToSprintSettings:function(){for(var e=arguments.length,i=new Array(e),s=0;s<e;s++)i[s]=arguments[s];return(0,ie.jsx)(le.Z,{onClick:()=>{o&&(n(),B.zX({environment:r,userSettingsStore:o}),B.Rh(t))},disableUnderline:!0,style:c.link,children:i})}}})})}),(0,ie.jsx)(z.Z,{icon:w.U,ariaLabel:"closeButton",style:c.closeButton,onClick:()=>{o&&B.zX({environment:r,userSettingsStore:o})}})]})}function fe(e){const{currentSprintFormattedDateRange:t,currentSprintTaskSummary:o}=e,{isMobile:n}=(0,i.Fy)(),r=(0,l.useIntl)(),s=me({isMobile:n}),a=o?r.formatMessage(ce.completedPercentSummary,{completedTaskCount:o.completedTaskCount,totalTaskCount:o.totalTaskCount}):void 0,c=t&&o?(0,ie.jsxs)(ie.Fragment,{children:[t,(0,ie.jsx)("div",{style:s.separator}),a]}):t||a;return void 0===c?null:(0,ie.jsx)("div",{style:s.subheader,children:c})}function he(e){const{sprintBlockStore:t,sprintCollectionStore:o}=e;if(!t)return;const n=o.getPropertyMapping(),r=null==n?void 0:n[y.b0.Dates];if(!r)return;const i=t.getPropertyValue(r);if(!i)return;const s=(0,I.nai)(i)[0];return s?(0,v.Ls)(s):void 0}function ye(e){const{sprintDateRange:t,intl:o}=e;if(t&&(0,v.h)(t))return(0,C.ZV)({value:t,allowRelativeDates:!1,shortenDateAndRange:!0,displayInUserTimezone:!0,intl:o})}const xe={complete_sprint_and_move_incomplete_tasks_to_next_sprint:(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.moveToNextSprintOption",defaultMessage:"Move to next sprint"}),complete_sprint_and_move_incomplete_tasks_to_backlog:(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.moveToBacklogOption",defaultMessage:"Move to backlog"}),complete_sprint:(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.keepInThisSprintOption",defaultMessage:"Keep in current sprint"})};function ve(e){const{actionTypeStore:t}=e,{isMobile:o}=(0,i.Fy)(),n=(0,r.VK)((()=>t.state),[t]),s=me({isMobile:o});return(0,ie.jsx)(W.ZP,{popupType:o?W.Z4.SlideUp:W.Z4.Popup,alignmentToOrigin:W.vR.Start,placementToOrigin:W.pO.Bottom,render:e=>(0,ie.jsx)(be,{actionTypeStore:t,buttonPopupParent:e}),renderOrigin:e=>(0,ie.jsxs)(X.Z,{...e,style:s.dropdownButton,children:[xe[n],(0,j.i)(s.dropdownChevronIcon)]})})}const Ce=["complete_sprint_and_move_incomplete_tasks_to_next_sprint","complete_sprint_and_move_incomplete_tasks_to_backlog","complete_sprint"];function be(e){const{actionTypeStore:t,buttonPopupParent:o}=e,{isMobile:n}=(0,i.Fy)(),l=(0,s.yK)((e=>({checkIcon:{color:e.lightIconColor,width:12,height:"auto",marginLeft:4}})),[]),a=(0,r.VK)((()=>Ce.map((e=>{const n=e===t.state;return{key:e,action:()=>{t.setState(e),o.close()},render:t=>(0,ie.jsx)(U.Z,{...t,title:xe[e],right:n&&(0,b.e)(l.checkIcon)})}}))),[t,l.checkIcon,o]);let c;return c=n?{menuType:L.og.ActionSheet}:{menuType:L.og.Popup,maxHeight:"50vh",minWidth:230},(0,ie.jsx)(q.Z,{...c,children:(0,ie.jsx)($.Z,{type:$.i.Vertical,initialFocus:0,sections:[{key:"sprint_automations",items:a,render:e=>(0,ie.jsx)(te.Z,{...e})}]})})}function je(e){const{nextSprintInput:t,completeSprintAutomationContext:o,setNextSprintInput:n,sprintPageIds:a}=e,{sprintCollectionStore:c}=o,{isMobile:u}=(0,i.Fy)(),d=(0,i.O7)(),p=(0,l.useIntl)(),g=(0,r.VK)((()=>{if(void 0===t)return(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintModal.sprintSelect.empty",defaultMessage:"Select sprint"});if("actionId"===t.type)return(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintModal.sprintSelect.newSprint",defaultMessage:"New sprint"});if("pointer"===t.type){const e=E.G.createChildStore(c,t.pointer);return(0,O.vU)({intl:p,environment:d,store:e,untitledFallback:ce.fallbackSprintName})}(0,_.t1)(t)}),[t,p,c,d]),m=me({isMobile:u}),S=(0,s.yK)((e=>({button:{...void 0===t&&{color:e.lightTextColor}}})),[t]),f={...m.dropdownButton,...S.button};return 0===a.length||1===a.length?(0,ie.jsx)(X.Z,{style:f,disabled:!0,children:g}):(0,ie.jsx)(W.ZP,{popupType:u?W.Z4.SlideUp:W.Z4.Popup,alignmentToOrigin:W.vR.Start,placementToOrigin:W.pO.Bottom,render:e=>(0,ie.jsx)(we,{buttonPopupParent:e,completeSprintAutomationContext:o,sprintPageIds:a,nextSprintInput:t,setNextSprintInput:n}),renderOrigin:e=>(0,ie.jsxs)(X.Z,{...e,style:f,children:[g,(0,j.i)(m.dropdownChevronIcon)]})})}function we(e){const{sprintPageIds:t,completeSprintAutomationContext:o,buttonPopupParent:a,nextSprintInput:c,setNextSprintInput:u}=e,{sprintCollectionStore:d}=o,{isMobile:p}=(0,i.Fy)(),g=(0,r.VK)((()=>d.getSpaceId()),[d]),m=(0,r.VK)((()=>(0,D.U1)({collectionStore:o.taskCollectionStore,property:y.Es.TaskToSprintRelation}).filter((e=>e.visible&&("title"===e.property||o.sprintCollectionSchema[e.property])))),[o]),S=(0,r.VK)((()=>new N.Z),[]),f=(0,s.yK)((e=>({checkIcon:{color:e.lightIconColor,width:12,height:"auto",marginLeft:4},plusIcon:{color:e.lightIconColor,width:12,height:"auto"},createSprintRow:{display:"flex",gap:4},sprintRow:{display:"flex",maxHeight:22,alignItems:"center"},recordTitle:{...p&&{marginRight:12}}})),[p]),h="purple",v=(0,s.Fg)(),C=(0,F.KR)(v,h),j=n.useMemo((()=>{const e="actionId"===(null==c?void 0:c.type);return{key:"new_sprint",action:()=>{u({type:"actionId"}),a.close()},render:t=>(0,ie.jsx)(U.Z,{...t,icon:(0,M.R)(f.plusIcon),title:(0,ie.jsxs)("div",{style:f.createSprintRow,children:[(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintModal.selectSprintDropdown.createNew",defaultMessage:"New sprint"}),(0,ie.jsx)(ae.Z,{isRound:!0,showRemoveButton:!1,value:(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintModal.selectSprintDropdown.createNewToken",defaultMessage:"Next"}),format:x.lo.Medium,isSingle:!0,color:C.textColor,backgroundColor:C.backgroundColor,showColoredDot:h})]}),right:e&&(0,b.e)(f.checkIcon)})}}),[c,a,u,f,C]),w=(0,r.VK)((()=>t.map((e=>{const t={id:e,table:P.iU,spaceId:g},o=E.G.createChildStore(d,t),n=o.getIcon(),r="pointer"===(null==c?void 0:c.type)&&V.dr.isEqual(c.pointer,t);return{key:e,action:()=>{u({type:"pointer",pointer:t}),a.close()},render:e=>(0,ie.jsx)(U.Z,{...e,icon:n&&(0,ie.jsx)(J.Z,{disabled:!0,icon:n,isEmptyPage:!1,size:20}),title:(0,ie.jsx)("div",{style:f.sprintRow,children:m.map((e=>"title"===e.property?(0,ie.jsx)(ee.Z,{store:o,style:f.recordTitle},"title"):(0,ie.jsx)(K.Z,{store:o,property:e.property,disabled:!1,locked:!1,format:G.C.Relation,tableWrap:!1,blockPropertyValueOverlayStore:S,collectionStore:d},e.property))).filter(_.$K)}),right:r&&(0,b.e)(f.checkIcon)})}}))),[d,S,a,c,m,g,u,f,t]),k=[{key:"sprints",items:n.useMemo((()=>w.length>0?w:[j]),[w,j]),render:e=>(0,ie.jsx)(te.Z,{...e})}];let T;return T=p?{menuType:L.og.ActionSheet}:{menuType:L.og.Popup,maxHeight:"50vh",minWidth:230},(0,ie.jsx)(q.Z,{...T,children:(0,ie.jsx)($.Z,{type:$.i.Vertical,initialFocus:0,sections:k})})}function Me(e){const{sprintDateRange:t,setSprintDateRange:o}=e,a=(0,l.useIntl)(),{isMobile:c}=(0,i.Fy)(),u=n.useMemo((()=>ye({sprintDateRange:t,intl:a})),[t,a]),d=me({isMobile:c}),p=(0,s.yK)((e=>({button:{...!u&&{color:e.lightTextColor}}})),[u]),g=(0,r.VK)((()=>u||(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.nextSprintDate.placeholder",defaultMessage:"Select dates"})),[u]);return(0,ie.jsx)(W.ZP,{popupType:c?W.Z4.SlideUp:W.Z4.Popup,alignmentToOrigin:W.vR.Start,placementToOrigin:W.pO.Bottom,render:e=>(0,ie.jsx)(ke,{sprintDateRange:t,setSprintDateRange:o,onDismiss:()=>{e.close()}}),renderOrigin:e=>(0,ie.jsxs)(X.Z,{...e,style:{...d.dropdownButton,...p.button},children:[g,(0,j.i)(d.dropdownChevronIcon)]})})}function ke(e){const{sprintDateRange:t,setSprintDateRange:o,onDismiss:r}=e,{isMobile:s}=(0,i.Fy)(),a=n.useMemo((()=>({starting:null!=t&&t.start_date?{type:"date",start_date:t.start_date}:void 0,ending:null!=t&&t.end_date?{type:"date",start_date:t.end_date}:void 0})),[t]);let c;return c=s?{menuType:L.og.Modal,right:(0,ie.jsx)(Y.DoneMenuText,{}),onClickRight:r}:{menuType:L.og.Popup,maxHeight:"50vh",paddingTop:6},(0,ie.jsxs)(q.Z,{...c,children:[(0,ie.jsx)(te.Z,{children:(0,ie.jsx)(oe.Z,{title:void 0,disableMenuWrap:!0,allowRelativeRangeFilter:!0,value:a,onUpdate:e=>{var t,n;if(e.error)return;const r={...a,...e.value},i=null===(t=r.starting)||void 0===t?void 0:t.start_date,s=null===(n=r.ending)||void 0===n?void 0:n.start_date;o({type:"daterange",start_date:i,end_date:s})},onDismiss:r})}),(0,ie.jsx)(te.Z,{topBorder:!0,children:(0,ie.jsx)(U.Z,{focused:!1,onClick:()=>{o(void 0)},title:(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.datePicker.clear",defaultMessage:"Clear"})})})]})}var Ve=o(42875),Pe=o(59054),Te=o(96367),Ie=o(54642),Fe=o(39927),_e=o(16732);function Ze(e){if(!e)return;if("aggregation"!==e.type)return;if("text"!==e.aggregationResult.type)return;const t=e.aggregationResult.value,o=null==t?void 0:t.split("/");if(!o||2!==o.length)return;const n=Number(o[0]),r=Number(o[1]);return{completedTaskCount:n,incompleteTaskCount:r-n,totalTaskCount:r,completedTaskPercent:0===r?0:n/r}}function Re(e){if(!e)return;const t=e.getPropertyMapping(),o=null==t?void 0:t[y.Es.TaskToSprintRelation];if(!o)return;return _e.Ws.filter.property=o,{..._e.Ws.filter,property:o}}function Be(e,t){if(!t)return;const o=t.getPropertyMapping(),n=Re(t);if(!n)return;const r=null==o?void 0:o[y.Es.Status];if(!r)return;const i=t.getSchema()[r];if(!i||"status"!==i.type)return;const s=(0,Fe.F_)(e,i);return s?{type:"aggregation",filter:{operator:"and",filters:[n]},aggregation:{aggregator:{operator:"count_per_group",groupName:s},property:r}}:void 0}class Ae extends f.default{getInitialState(){return{isLoading:!0,currentSprintId:void 0,querySprintsResult:void 0,currentSprintTaskSummary:void 0}}updateCurrentSprint(e){const{querySprintsResult:t,currentSprintTaskSummary:o}=this.state;void 0!==e&&void 0!==t&&void 0!==o?this.setState({isLoading:!1,currentSprintId:e,querySprintsResult:t,currentSprintTaskSummary:o}):e?this.setState({...this.state,currentSprintId:e}):this.setState({...this.state,isLoading:!0,currentSprintId:e})}updateNextAndFutureSprints(e){const{currentSprintId:t,currentSprintTaskSummary:o}=this.state;void 0!==t&&void 0!==e&&void 0!==o?this.setState({isLoading:!1,currentSprintId:t,querySprintsResult:e,currentSprintTaskSummary:o}):e?this.setState({...this.state,querySprintsResult:e}):this.setState({...this.state,isLoading:!0,querySprintsResult:e})}updateCurrentSprintTaskSummary(e){const{currentSprintId:t,querySprintsResult:o}=this.state;void 0!==t&&void 0!==o&&void 0!==e?this.setState({isLoading:!1,currentSprintId:t,querySprintsResult:o,currentSprintTaskSummary:e}):e?this.setState({...this.state,currentSprintTaskSummary:e}):this.setState({...this.state,isLoading:!0,currentSprintTaskSummary:e})}}const Le=Ae;function Oe(e){const{taskCollectionContextStore:t,completeSprintAutomationContext:o,children:s,isModalOpen:a}=e,{sprintCollectionStore:c}=o,u=c.id,d=(0,i.O7)(),p=(0,r.VK)((()=>new Le),[]),g=(0,r.VK)((()=>p.state),[p]),m=(0,r.VK)((()=>{var e;const o=t.relativeVariableStore.state;return null==o||null===(e=o[u])||void 0===e?void 0:e.current}),[u,t]);n.useEffect((()=>{p.updateCurrentSprint(m)}),[m,p]);const[{value:S}]=(0,Pe.r5)((async()=>await async function(e){var t;const{environment:o,completeSprintAutomationContext:n}=e,{sprintCollectionStore:r}=n,i=function(e){var t,o;const{sprintCollectionStore:n,sprintCollectionSchema:r}=e,i=n.getPropertyMapping(),s=null==i?void 0:i[y.b0.StatusV2];if(!s)return;const l=r[s];if(!l||"status"!==l.type)return;const a=null===(t=l.options)||void 0===t||null===(t=t.find((e=>e.id===y.YE)))||void 0===t?void 0:t.value,c=null===(o=l.options)||void 0===o||null===(o=o.find((e=>e.id===y.eH)))||void 0===o?void 0:o.value;if(!a||!c)return;const u=Te.qB[y.p$].next.reducer.getCombinatorFilter(r);if(!u)return;const d={type:"results",filter:u,limit:De},p={type:"results",filter:{operator:"and",filters:[{property:s,filter:{operator:"status_is",value:{type:"is_option",value:c}}}]},limit:De};return{[y.YE]:d,[y.eH]:p}}(n),s=r.getPropertyMapping(),l=null==s?void 0:s[y.b0.Dates],a=null==s?void 0:s[y.b0.UniqueId];if(!i||!l||!a)return;const c={userId:o.currentUser.id,userTimeZone:(0,Ve.r)(),searchQuery:void 0,sort:[{property:l,direction:"ascending"},{property:a,direction:"ascending"}],reducers:i},u=null===(t=r.getParentBlockStore())||void 0===t?void 0:t.getCollectionViewStores()[0],d=r.getSpaceId();if(!u)return;const p=await Ie.queryCollection(o,{source:{type:"collection",id:r.id,spaceId:d},collectionView:{id:u.id,spaceId:d},loader:c},void 0,{src:"complete_sprint_modal_sprint_picker"});if("success"!==p.type)return;const g=p.data.result.reducerResults[y.YE],m=p.data.result.reducerResults[y.eH];if("results"!==g.type||"results"!==m.type)return;const S=g.blockIds,f=m.blockIds;return{nextSprintIds:S,futureSprintIds:f}}({environment:d,completeSprintAutomationContext:o})),[m,d,o]);n.useEffect((()=>{p.updateNextAndFutureSprints(S)}),[S,p]);const f=(0,l.useIntl)(),[{value:h}]=(0,Pe.r5)((async()=>await async function(e){var t;const{environment:o,completeSprintAutomationContext:n,intl:r}=e,{taskCollectionStore:i}=n,s=Be(r,i);if(!s)return;const l=Re(i);if(!l)return;const a={filter:{operator:"and",filters:[l]},userId:o.currentUser.id,userTimeZone:(0,Ve.r)(),searchQuery:"",sort:[],reducers:{completed_tasks_in_current_sprint:s}},c=null===(t=i.getParentBlockStore())||void 0===t?void 0:t.getCollectionViewStores()[0],u=i.getSpaceId();if(!c)return;const d=await Ie.queryCollection(o,{source:{type:"collection",id:i.id,spaceId:u},collectionView:{id:c.id,spaceId:u},loader:a},void 0,{src:"complete_sprint_modal_sprint_picker"});if("success"!==d.type)return;return Ze(d.data.result.reducerResults.completed_tasks_in_current_sprint)}({intl:f,environment:d,completeSprintAutomationContext:o})),[m,d,o,a]);return n.useEffect((()=>{p.updateCurrentSprintTaskSummary(h)}),[h,p]),(0,ie.jsx)(ie.Fragment,{children:s({completeSprintAutomationState:g,onAutomationComplete:()=>{p.reset()}})})}const De=5;var Ne=o(63296),Ee=o(97004),Ke=o(75498),Ge=o(56247);function Ue(e){const{percentage:t}=e;return(0,ie.jsx)(Ge.b,{numberValue:t,numberFormat:void 0,numberShowAs:{type:"ring",maxValue:1,color:"blue",showValue:!1},shouldRenderTooltip:!1,progressSize:15})}var We=o(68785);const ze=function(e){const{isLoading:t,taskSummary:o,styles:n}=e;return(0,ie.jsx)("div",{style:{width:16,height:"auto",...n},children:t?(0,ie.jsx)(We.Z,{}):(0,ie.jsx)(Ue,{percentage:(null==o?void 0:o.completedTaskPercent)??0})})};function He(e){const{taskCollectionContextStore:t,children:o}=e,n=(0,r.VK)((()=>(0,Ee.Nq)(t)),[t]),i=(0,r.VK)((()=>t.collectionStore()),[t]),s=(0,l.useIntl)(),a=(0,r.VK)((()=>Be(s,i)),[i,s]);return!a||n?null:(0,ie.jsx)(Ke.Z,{id:"completed_tasks_in_current_sprint_view",collectionContextStore:t,reducer:a,render:e=>{const t=Ze(e.state);return t?(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(qe,{currentSprintTasksInView:t}),o(t)]}):null}})}function qe(e){const{currentSprintTasksInView:t}=e,o=(0,s.yK)((e=>({summary:{display:"flex",alignItems:"center",justifyContent:"center",columnGap:5,color:e.lightTextColor,fontSize:a.Z.fontSize.UIRegular.desktop,fontWeight:a.Z.fontWeight.regular,whiteSpace:"nowrap"}})),[]),{isPhone:n}=(0,i.Fy)();return n?null:(0,ie.jsxs)("div",{style:o.summary,children:[(0,ie.jsx)(ze,{styles:{paddingTop:1},isLoading:!1,taskSummary:t}),(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintAutomation.inlineSummary.completedPercentSummary",defaultMessage:"{completedTaskCount} / {totalTaskCount} tasks",values:{completedTaskCount:t.completedTaskCount,totalTaskCount:t.totalTaskCount}})]})}function $e(e){const{collectionContextStore:t,completeSprintAutomationContext:o}=e,s=(0,i.O7)(),[l,a]=n.useState(!1),[m,S]=n.useState(!1),f=n.useCallback((()=>{S(!1)}),[S]),h=(0,r.VK)((()=>o.permissionsContext.canEdit),[o.permissionsContext.canEdit]),y=(0,r.VK)((()=>g.default.state.currentUserSettingsStore),[]),x=()=>{S(!0);"complete-sprint-button-tooltip"===(0,p.wF)(y,"sprints-onboarding")&&u.tutorialGoToNextStep(s,"sprints-onboarding"),c.$X(s,{...(0,d.Pn)(t),action:"open_modal"})};return h?(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(Oe,{completeSprintAutomationContext:o,taskCollectionContextStore:t,isModalOpen:m,children:e=>{let{completeSprintAutomationState:n,onAutomationComplete:r}=e;return(0,ie.jsx)(ue,{completeSprintAutomationContext:o,isOpen:m,onDismiss:f,setIsLoading:a,taskCollectionContextStore:t,completeSprintAutomationState:n,onAutomationComplete:r})}}),(0,ie.jsx)(He,{taskCollectionContextStore:t,children:()=>(0,ie.jsx)(Ye,{taskCollectionContextStore:t,onClick:x,isLoading:l})})]}):null}function Ye(e){const{taskCollectionContextStore:t,onClick:o,isLoading:c}=e,{isPhone:u}=(0,i.Fy)(),d=n.useRef(null),p=function(e){const{isPhone:t}=e;return(0,s.yK)((e=>({button:{height:26,marginLeft:8,fontWeight:a.Z.fontWeight.medium,...t&&{flexGrow:1,borderRadius:8,height:44}}})),[t])}({isPhone:u}),S=(0,r.VK)((()=>t.collectionViewBlockStore()),[t]),f=(0,r.VK)((()=>g.default.state.currentSpaceStore),[]),h=(0,r.VK)((()=>null==S?void 0:S.getSpaceId()),[S]);if(!S)return(0,ie.jsx)(ie.Fragment,{});const y=h===(null==f?void 0:f.id);return(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(Ne.Z,{ref:d,onClick:o,style:p.button,disabled:c,disabledFeedback:c,children:(0,ie.jsx)(l.FormattedMessage,{defaultMessage:"Complete sprint",id:"completeSprintAutomationButton.label"})}),y&&(0,ie.jsx)(m.Yy,{origin:d})]})}var Xe=o(30120);function Qe(e){var t;const{collectionContextStore:o,sprintAutomationContext:n}=e,l=(0,s.yK)((e=>({summary:{display:"flex",alignItems:"center",justifyContent:"center",marginLeft:17,columnGap:5,color:e.lightTextColor,fontSize:a.Z.fontSize.UIRegular.desktop,fontWeight:a.Z.fontWeight.regular,whiteSpace:"nowrap"},icon:{width:16,height:"auto",paddingTop:2}})),[]),{isPhone:c}=(0,i.Fy)(),u=(0,r.VK)((()=>{var e;const t=null===(e=n.automationContext)||void 0===e?void 0:e.automationStore.getRunAt();if(!t)return;const o=Xe.ou.fromMillis(t,{zone:"utc"}).toLocal().startOf("day"),r=Xe.ou.now().startOf("day"),i=o.diff(r,"days").days;return i<1?"soon":1===i?"today":2===i?"tomorrow":i-1}),[null===(t=n.automationContext)||void 0===t?void 0:t.automationStore]);return u?(0,ie.jsx)(He,{taskCollectionContextStore:o,children:()=>c?null:(0,ie.jsxs)("div",{style:l.summary,children:[(0,k.N)(l.icon),(0,ie.jsx)(Je,{daysRemaining:u})]})}):null}function Je(e){const{daysRemaining:t}=e;return"soon"===t?(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintAutomation.inlineSummary.endingSoon",defaultMessage:"Ending soon"}):"today"===t?(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintAutomation.inlineSummary.endsToday",defaultMessage:"Ends today"}):"tomorrow"===t?(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintAutomation.inlineSummary.endsTomorrow",defaultMessage:"Ends tomorrow"}):(0,ie.jsx)(l.FormattedMessage,{id:"completeAutomationSprintAutomation.inlineSummary.daysRemaining",defaultMessage:"Ends in {daysRemaining} days",values:{daysRemaining:t}})}const et=function(e){var t;const{collectionContextStore:o}=e,n=(0,r.VK)((()=>o.getCompleteSprintButtonContext.state),[o]),i=(0,r.VK)((()=>{var e;return Boolean(null==n||null===(e=n.automationContext)||void 0===e?void 0:e.automationStore.isActive())}),[null==n||null===(t=n.automationContext)||void 0===t?void 0:t.automationStore]);return n?i?(0,ie.jsx)(Qe,{collectionContextStore:o,sprintAutomationContext:n}):(0,ie.jsx)($e,{collectionContextStore:o,completeSprintAutomationContext:n}):null}},25044:(e,t,o)=>{o.d(t,{O:()=>l,u:()=>s});var n=o(92996),r=o(9291),i=o(29376);const s=(0,r.defineMessages)({sprintUncategorizedGroup:{defaultMessage:"Backlog (No {name})",id:"database.sprintDatabaseView.uncategorizedGroupLabel"}});function l(e){const{collectionStore:t,property:o,propertySchema:r,parentStore:s}=e;let l=!1;if(null!=t&&t.isDefined()){const e=t.getPropertyMapping();l=(null==e?void 0:e[n.Es.TaskToSprintRelation])===o}return(0,i.ke)(r,s)===n.p$||l}},80025:(e,t,o)=>{o.d(t,{Vn:()=>s,mF:()=>l,qf:()=>c});var n=o(9291),r=o(33929);const i=(0,n.defineMessages)({default:{defaultMessage:"Light gray",id:"colors.select.lightGray"},gray:{defaultMessage:"Gray",id:"colors.select.gray"},translucentGray:{defaultMessage:"Gray",id:"colors.select.gray"},brown:{defaultMessage:"Brown",id:"colors.select.brown"},orange:{defaultMessage:"Orange",id:"colors.select.orange"},yellow:{defaultMessage:"Yellow",id:"colors.select.yellow"},green:{defaultMessage:"Green",id:"colors.select.green"},blue:{defaultMessage:"Blue",id:"colors.select.blue"},purple:{defaultMessage:"Purple",id:"colors.select.purple"},pink:{defaultMessage:"Pink",id:"colors.select.pink"},red:{defaultMessage:"Red",id:"colors.select.red"}});function s(e){const t=i[e]||i.gray;return r.default.formatMessage(t)}const l=(0,n.defineMessages)({foregroundColorDefault:{id:"action.foregroundColor.default.name",defaultMessage:"Default"},foregroundColorGray:{id:"action.foregroundColor.gray.name",defaultMessage:"Gray"},foregroundColorBrown:{id:"action.foregroundColor.brown.name",defaultMessage:"Brown"},foregroundColorOrange:{id:"action.foregroundColor.orange.name",defaultMessage:"Orange"},foregroundColorYellow:{id:"action.foregroundColor.yellow.name",defaultMessage:"Yellow"},foregroundColorGreen:{id:"action.foregroundColor.green.name",defaultMessage:"Green"},foregroundColorBlue:{id:"action.foregroundColor.blue.name",defaultMessage:"Blue"},foregroundColorPurple:{id:"action.foregroundColor.purple.name",defaultMessage:"Purple"},foregroundColorPink:{id:"action.foregroundColor.pink.name",defaultMessage:"Pink"},foregroundColorRed:{id:"action.foregroundColor.red.name",defaultMessage:"Red"},backgroundColorGray:{id:"action.backgroundColor.gray.name",defaultMessage:"Gray background"},backgroundColorBrown:{id:"action.backgroundColor.brown.name",defaultMessage:"Brown background"},backgroundColorOrange:{id:"action.backgroundColor.orange.name",defaultMessage:"Orange background"},backgroundColorYellow:{id:"action.backgroundColor.yellow.name",defaultMessage:"Yellow background"},backgroundColorGreen:{id:"action.backgroundColor.green.name",defaultMessage:"Green background"},backgroundColorBlue:{id:"action.backgroundColor.blue.name",defaultMessage:"Blue background"},backgroundColorPurple:{id:"action.backgroundColor.purple.name",defaultMessage:"Purple background"},backgroundColorPink:{id:"action.backgroundColor.pink.name",defaultMessage:"Pink background"},backgroundColorRed:{id:"action.backgroundColor.red.name",defaultMessage:"Red background"},backgroundColorDefault:{id:"action.backgroundColor.default.name",defaultMessage:"Default background"}}),a={default:{...l.foregroundColorDefault},gray:{...l.foregroundColorGray},brown:{...l.foregroundColorBrown},orange:{...l.foregroundColorOrange},yellow:{...l.foregroundColorYellow},teal:{...l.foregroundColorGreen},blue:{...l.foregroundColorBlue},purple:{...l.foregroundColorPurple},pink:{...l.foregroundColorPink},red:{...l.foregroundColorRed},gray_background:{...l.backgroundColorGray},brown_background:{...l.backgroundColorBrown},orange_background:{...l.backgroundColorOrange},yellow_background:{...l.backgroundColorYellow},teal_background:{...l.backgroundColorGreen},blue_background:{...l.backgroundColorBlue},purple_background:{...l.backgroundColorPurple},pink_background:{...l.backgroundColorPink},red_background:{...l.backgroundColorRed}};function c(e){return a[e]}},5385:(e,t,o)=>{o.d(t,{x:()=>r});var n=o(80444);function r(){var e;return null===(e=n.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.icon_picker_color}},57145:(e,t,o)=>{o.d(t,{_:()=>i});var n=o(67294);const r=new Map;function i(e){const t=!r.get(e),o=(0,n.useRef)(t);return o.current&&r.set(e,!0),(0,n.useEffect)((()=>()=>{o.current&&r.set(e,!1)}),[e]),o.current}},5933:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return!1}}const i=new r},67695:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(35431);class r extends n.Z{findTableHeaderCell(e,t){return this.find((o=>o.collectionContextStore===e&&o.property===t))}}const i=new r},4391:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{allIcons:{},recentIcons:[],loadIconCount:0}}}const i=r},22109:(e,t,o)=>{o.d(t,{T:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.IU)("arrowsUpDown",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M4.11 2.385a.61.61 0 01.48-.211c.191 0 .353.07.486.21L8.03 5.409a.66.66 0 01.2.475c0 .191-.061.347-.182.469a.627.627 0 01-.463.181.59.59 0 01-.451-.187L5.926 5.098l-.72-.844.04 1.219v7.242a.624.624 0 01-.187.469.624.624 0 01-.47.187.636.636 0 01-.468-.187.635.635 0 01-.182-.47V5.474l.041-1.22-.726.845-1.201 1.248a.61.61 0 01-.457.187.627.627 0 01-.463-.181.634.634 0 01-.182-.47.66.66 0 01.2-.474l2.958-3.023zm7.786 10.781a.636.636 0 01-.486.205.665.665 0 01-.486-.205l-2.947-3.035a.64.64 0 01-.206-.475c0-.191.061-.345.182-.463a.634.634 0 01.469-.181c.18 0 .33.06.451.181l1.201 1.248.727.85-.041-1.219V2.824c0-.187.06-.342.181-.463a.636.636 0 01.47-.187.627.627 0 01.65.65v7.248l-.041 1.219.726-.85 1.207-1.248a.6.6 0 01.451-.181c.188 0 .342.06.463.181a.615.615 0 01.182.463.648.648 0 01-.2.475l-2.953 3.035z"})})},44643:(e,t,o)=>{o.d(t,{L:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.IU)("eyeHidePadded",{viewBox:"0 0 24 24",svg:(0,r.jsx)("path",{d:"M17.3867 18.1074C17.6055 18.3193 17.9404 18.333 18.1592 18.1074C18.3848 17.875 18.3711 17.5469 18.1592 17.335L6.5791 5.76855C6.37402 5.55664 6.01855 5.5498 5.80664 5.76855C5.60156 5.97363 5.60156 6.3291 5.80664 6.53418L17.3867 18.1074ZM12 6.1582C10.8105 6.1582 9.73047 6.36328 8.72559 6.69141L9.81934 7.78516C10.5098 7.58691 11.2275 7.4707 12 7.4707C16.3682 7.4707 19.8408 11.2715 19.8408 12.0713C19.8408 12.6113 18.7334 14.0059 16.9766 15.1064L17.9883 16.125C20.1348 14.7168 21.3857 12.8779 21.3857 12.0713C21.3857 10.6699 17.6055 6.1582 12 6.1582ZM12 17.9912C13.2646 17.9912 14.4199 17.7725 15.4658 17.4102L14.3789 16.3232C13.6338 16.542 12.8477 16.6787 12 16.6787C7.63184 16.6787 4.15918 13.0283 4.15918 12.0713C4.15918 11.6133 5.32129 10.1299 7.19434 8.98145L6.16211 7.94922C3.92676 9.37109 2.60742 11.251 2.60742 12.0713C2.60742 13.4727 6.46973 17.9912 12 17.9912ZM15.4111 13.3906C15.5889 12.9873 15.6914 12.5361 15.6914 12.0713C15.6914 10.0137 14.0508 8.39355 12 8.39355C11.5283 8.39355 11.084 8.48242 10.6738 8.65332L15.4111 13.3906ZM12 15.7559C12.5332 15.7559 13.0322 15.6328 13.4766 15.4209L8.64355 10.5811C8.4248 11.0322 8.30176 11.5312 8.30176 12.0781C8.30859 14.0811 9.94238 15.7559 12 15.7559Z"})})},55964:(e,t,o)=>{o.d(t,{N:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.IU)("eyePadded",{viewBox:"0 0 24 24",svg:(0,r.jsx)("path",{d:"M12 17.9912C17.6055 17.9912 21.3857 13.4727 21.3857 12.0713C21.3857 10.6699 17.5986 6.1582 12 6.1582C6.47656 6.1582 2.60742 10.6699 2.60742 12.0713C2.60742 13.4727 6.46973 17.9912 12 17.9912ZM12 16.6787C7.63184 16.6787 4.15918 13.0283 4.15918 12.0713C4.15918 11.2715 7.63184 7.4707 12 7.4707C16.3613 7.4707 19.8408 11.2715 19.8408 12.0713C19.8408 13.0283 16.3613 16.6787 12 16.6787ZM12 15.7559C14.0508 15.7559 15.6914 14.0811 15.6914 12.0713C15.6914 10.0137 14.0508 8.39355 12 8.39355C9.94238 8.39355 8.29492 10.0137 8.30176 12.0713C8.31543 14.0811 9.94238 15.7559 12 15.7559ZM12 13.2607C11.3369 13.2607 10.7969 12.7275 10.7969 12.0713C10.7969 11.415 11.3369 10.8818 12 10.8818C12.6631 10.8818 13.1963 11.415 13.1963 12.0713C13.1963 12.7275 12.6631 13.2607 12 13.2607Z"})})},60493:(e,t,o)=>{o.d(t,{N:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.IU)("infoFilled",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M7.99634 15.5659C6.96118 15.5659 5.98706 15.3682 5.07397 14.9727C4.16089 14.582 3.35522 14.0376 2.65698 13.3394C1.96362 12.6411 1.41919 11.8354 1.02368 10.9224C0.628174 10.0093 0.43042 9.03516 0.43042 8C0.43042 6.96484 0.628174 5.99072 1.02368 5.07764C1.41919 4.16455 1.96362 3.36133 2.65698 2.66797C3.35522 1.96973 4.15845 1.42285 5.06665 1.02734C5.97974 0.631836 6.95386 0.434082 7.98901 0.434082C9.02905 0.434082 10.0056 0.631836 10.9187 1.02734C11.8318 1.42285 12.6375 1.96973 13.3357 2.66797C14.0339 3.36133 14.5808 4.16455 14.9763 5.07764C15.3718 5.99072 15.5696 6.96484 15.5696 8C15.5696 9.03516 15.3718 10.0093 14.9763 10.9224C14.5808 11.8354 14.0339 12.6411 13.3357 13.3394C12.6375 14.0376 11.8318 14.582 10.9187 14.9727C10.0056 15.3682 9.03149 15.5659 7.99634 15.5659ZM6.65601 12.2114H9.7395C9.91528 12.2114 10.0618 12.1577 10.179 12.0503C10.2961 11.938 10.3547 11.7939 10.3547 11.6182C10.3547 11.4521 10.2961 11.313 10.179 11.2007C10.0618 11.0835 9.91528 11.0249 9.7395 11.0249H8.89722V7.43604C8.89722 7.20654 8.84106 7.021 8.72876 6.87939C8.61646 6.73779 8.45288 6.66699 8.23804 6.66699H6.78784C6.61694 6.66699 6.4729 6.72559 6.35571 6.84277C6.23853 6.95996 6.17993 7.09912 6.17993 7.26025C6.17993 7.43604 6.23853 7.58008 6.35571 7.69238C6.4729 7.7998 6.61694 7.85352 6.78784 7.85352H7.55688V11.0249H6.65601C6.48511 11.0249 6.33862 11.0835 6.21655 11.2007C6.09937 11.313 6.04077 11.4521 6.04077 11.6182C6.04077 11.7939 6.09937 11.938 6.21655 12.0503C6.33862 12.1577 6.48511 12.2114 6.65601 12.2114ZM7.95239 5.48779C8.24536 5.48779 8.49194 5.38525 8.69214 5.18018C8.89233 4.9751 8.99243 4.73096 8.99243 4.44775C8.99243 4.1499 8.89233 3.90088 8.69214 3.70068C8.49194 3.49561 8.24536 3.39307 7.95239 3.39307C7.66431 3.39307 7.41772 3.49561 7.21265 3.70068C7.00757 3.90088 6.90503 4.1499 6.90503 4.44775C6.90503 4.73096 7.00757 4.9751 7.21265 5.18018C7.41772 5.38525 7.66431 5.48779 7.95239 5.48779Z"})})},94110:(e,t,o)=>{o.d(t,{j:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.IU)("sortPadded",{viewBox:"0 0 24 24",svg:(0,r.jsx)("path",{d:"M7.50879 5.80273L4.06348 9.32324C3.92676 9.4668 3.83789 9.67188 3.83789 9.85645C3.83789 10.2803 4.13184 10.5674 4.54883 10.5674C4.75391 10.5674 4.91797 10.499 5.04785 10.3623L6.46289 8.89941L7.37891 7.83984L7.32422 9.30273V17.8477C7.32422 18.2715 7.625 18.5723 8.04199 18.5723C8.45898 18.5723 8.75977 18.2715 8.75977 17.8477V9.30273L8.70508 7.83984L9.62793 8.89941L11.0361 10.3623C11.166 10.499 11.3369 10.5674 11.5352 10.5674C11.9521 10.5674 12.2461 10.2803 12.2461 9.85645C12.2461 9.67188 12.1641 9.4668 12.0205 9.32324L8.58203 5.80273C8.28125 5.48828 7.80957 5.48145 7.50879 5.80273ZM16.4912 18.3398L19.9365 14.8057C20.0732 14.6689 20.1621 14.4639 20.1621 14.2793C20.1621 13.8555 19.8682 13.5684 19.4512 13.5684C19.2461 13.5684 19.082 13.6367 18.9453 13.7734L17.5371 15.2295L16.6211 16.2959L16.6758 14.833V6.28809C16.6758 5.87109 16.375 5.56348 15.958 5.56348C15.541 5.56348 15.2334 5.87109 15.2334 6.28809V14.833L15.2881 16.2959L14.3721 15.2295L12.9639 13.7734C12.8271 13.6367 12.6631 13.5684 12.4648 13.5684C12.0479 13.5684 11.7539 13.8555 11.7539 14.2793C11.7539 14.4639 11.8359 14.6689 11.9727 14.8057L15.418 18.3398C15.7188 18.6475 16.1904 18.6543 16.4912 18.3398Z"})})}}]);