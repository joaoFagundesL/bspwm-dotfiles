"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[8636],{33052:(e,t,a)=>{a.d(t,{Z:()=>r});var s=a(49085),n=a(29369);class o extends s.default{getInitialState(){return{modalOpen:!1,tokenQuery:"",inviteTargets:[],inviteRole:"member",isInviteTargetsEmpty:!0,table:n.e0,isFocused:!0,flowId:void 0,inputFocus:"invitee",emailMessage:""}}}const r=o},49204:(e,t,a)=>{a.d(t,{Id:()=>b,Ng:()=>j,Px:()=>T,ow:()=>M,t_:()=>h,um:()=>y});var s=a(15145),n=a(19889),o=a(9291),r=a(17224),i=a(54642),l=a(9953),u=a(64964),m=a(29974),d=a(13447),c=a(33929),g=a(48779),f=a(80444),p=a(9867),v=a(28517);const S=(0,o.defineMessages)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function y(e){let{environment:t,userId:a,teamStore:s,user:n}=e;const o=s.getSpaceId();if(!o)return;await p.Cj({environment:t,teamId:s.id,spaceId:o,teamMemberInfos:n,isSettingDefaultTeam:!1,inviterId:a})&&(r.UD(t,{store:s,joined_role:"member",from:"team_invite_link"}),await h({environment:t,userId:a,teamStore:s}),u.oV({label:c.default.formatMessage(S.joinTeamSuccessMessage,{teamName:s.getName()})}))}async function h(e){let{environment:t,userId:a,teamStore:n}=e;const o=f.default.state.currentUserRootStore,r=n.getSpaceId();if(!r||!o)return;const i=o.getSpaceViewStores().filter((e=>e.getSpaceId()===r))[0];await m.y3({environment:t,spaceViewStore:i,userSettingsStore:void 0,userRootStore:o,pageVisitSource:s.tY.JoinTeam,navigationType:"switchingToOrLoadingSpace"}),await v.I({environment:t,spaceId:r,userId:a}),p.hI({environment:t,teamStore:n,shouldScroll:!0})}async function T(e){let{environment:t,teamId:a,message:s}=e;if(!t.currentUser.id)return;"success"===(await i.requestAccess(t,{type:"current-actor-to-team",teamId:a,message:s})).type?(r.LB(t,{teamId:a}),await b({environment:t}),new Promise((e=>setTimeout(e,500))).then((()=>{u.oV({label:c.default.formatMessage(S.requestTeamSuccessMessage)})}))):u.oV({label:c.default.formatMessage(S.requestTeamFailureMessage)})}async function M(e){let{environment:t,teamStore:a,accessRequestStore:s,status:o}=e;const i=s.getForActorId();if(!i)return;const u=s.getRecordModel({table:n.KJ,id:i});if(u){if("approved"===o){const e=[{type:"member",entity_type:"user",user_id:u.id}];if(!(await p.Uj({environment:t,teamStore:a,teamMemberInfos:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}d.createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,perform:e=>{l.sW({store:s,transaction:e,data:{resolved_time:Date.now(),resolved_by_table:n.KJ,resolved_by_id:t.currentUser.id,status:o}})}}),r.co(t,{store:a,resolution:o})}}async function b(e){let{environment:t}=e;const{lastVisitedSpaceView:a,userRootStore:n,userSettingsStore:o}=await(0,g.iX)({environment:t,disableRedirectUrl:!1});a?await m.y3({environment:t,spaceViewStore:a,userRootStore:n,userSettingsStore:o,pageVisitSource:s.tY.BackForward,navigationType:"switchingToOrLoadingSpace"}):await m.L5({environment:t,userRootStore:n,userSettingsStore:o,pageVisitSource:s.tY.BackForward})}async function j(e){let{environment:t,teamId:a}=e;const s=await i.getTeamAccessRequestMetadata(t,{teamId:a});if("success"===s.type)return s.data}},86232:(e,t,a)=>{a.d(t,{M:()=>M});var s=a(67294),n=a(480),o=a(86628),r=a(24405),i=a(37810),l=a(48779),u=a(95697),m=a(1083),d=a(64552),c=a(9291),g=a(89728),f=a(80444),p=a(9867),v=a(85893);const S=function(e){const{teamStore:t,from:a,navigateToTeamHomeOnJoin:r,onJoinedTeam:i,style:l,hoveredStyle:u,icon:m,isRed:d}=e,S=(0,n.O7)(),y=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]),h=(0,s.useCallback)((async()=>{y&&(await p.um({environment:S,teamStore:t,currentSpaceStore:y,from:a,andNavigateToTeamHome:r??!1}),null==i||i())}),[y,S,t,a,r,i]);return(0,v.jsx)(g.Z,{style:l,hoveredStyle:u,onClick:h,icon:m,isRed:d,children:(0,v.jsx)(c.FormattedMessage,{id:"outlinerTeamToggleButton.joinTeamButton",defaultMessage:"Join"})})};var y=a(8787),h=a(14889);const T=function(e){const{teamStore:t,style:a,hoveredStyle:n}=e,[r,i]=(0,s.useState)(!1),l=(0,o.VK)((()=>t.getName()),[t]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(g.Z,{style:a,hoveredStyle:n,onClick:()=>i(!0),children:(0,v.jsx)(c.FormattedMessage,{id:"teamRequestButton.requestButton.label",defaultMessage:"Request"})}),(0,v.jsx)(h.Z,{teamStore:t,teamName:l,teamId:t.id,isModalOpen:r,onDismiss:()=>i(!1)})]})};function M(e){const{teamStore:t,style:a,hoveredStyle:s}=e,c=(0,n.O7)(),g=(0,m.Q)(),f=(0,d.e)(t),p=(0,o.VK)((()=>t.getTeamAccessLevel()),[t]),h=(0,r.yK)((e=>({joinTeamButton:{maxHeight:26,marginLeft:10,paddingLeft:10,paddingRight:10,borderRadius:100,fontSize:13,fontWeight:i.Z.fontWeight.semibold,background:e.buttonHoveredBackground,alignSelf:"center",...a},joinTeamButtonHoveredStyle:{background:e.buttonPressedBackground,...s}})),[a,s]),M=(0,o.VK)((()=>(0,u.Hu)({membership:t.getRawMembership()})&&(0,l.Fn)(c)),[c,t]),b=!f&&"open"===p||M,j=!f&&"closed"===p;return g?null:f?(0,v.jsx)(y.Z,{...e,style:h.joinTeamButton,hoveredStyle:h.joinTeamButtonHoveredStyle}):b?(0,v.jsx)(S,{...e,style:h.joinTeamButton,hoveredStyle:h.joinTeamButtonHoveredStyle}):j?(0,v.jsx)(T,{teamStore:t,style:h.joinTeamButton,hoveredStyle:h.joinTeamButtonHoveredStyle}):null}},8787:(e,t,a)=>{a.d(t,{Z:()=>p});var s=a(67294),n=a(480),o=a(86628),r=a(36591),i=a(64684),l=a(9291),u=a(53965),m=a(89728),d=a(26388),c=a(80444),g=a(9867);var f=a(85893);const p=function(e){const{teamStore:t,from:a,onLeavingTeam:p,style:v,hoveredStyle:S,icon:y,isRed:h,placement:T,alignment:M,buttonInternals:b}=e,j=(0,n.O7)(),w=(0,o.VK)((()=>c.default.state.currentSpaceStore),[]),I=(0,s.useCallback)((async()=>{if(!w)return;await g.s({environment:j,teamStore:t,currentSpaceStore:w,from:a})&&(null==p||p())}),[w,j,t,a,p]),x=(0,f.jsx)(l.FormattedMessage,{id:"teamJoinLeaveButton.leaveTeam.enabledTooltip",defaultMessage:"Click to leave teamspace"}),R=function(e){let{teamStore:t}=e;const a=(0,n.O7)(),s=a.currentUser.id,{isDefaultTeam:r}=(0,o.VK)((()=>({isDefaultTeam:t.isDefault()})),[t]),m=function(e){const t=(0,o.VK)((()=>c.default.state.currentSpaceStore),[]);return(0,o.VK)((()=>e.isDefined()&&null!=t&&t.isDefined()?(0,i.x4)({members:e.getMembers(),groups:(null==t?void 0:t.getPermissionGroups())??[]}):[]),[e,t])}(t),d=(0,o.VK)((()=>s?m.filter((e=>{var t;return null===(t=e.user_ids)||void 0===t?void 0:t.includes(s)})):[]),[m,s]),g=(0,o.VK)((()=>{if(!t.isReady())return!1;const e=(0,i.XO)({membership:t.getMembers()});return 1===e.length&&e[0]===s}),[t,s]);return function(e){let{isDefaultTeam:t,isOnlyTeamOwner:a,userGroups:s}=e;if(t)return(0,f.jsx)(l.FormattedMessage,{id:"teamBrowser.teamCard.leaveTeam.defaultTeamTooltip",defaultMessage:"You canâ€™t leave this teamspace because everyone in the workspace must be a member"});if(a)return(0,f.jsx)(l.FormattedMessage,{id:"teamJoinLeaveButton.leaveTeam.onlyOwnerTooltip",defaultMessage:"Invite another teamspace owner to leave this teamspace"});if(s.length>0)return(0,f.jsx)(l.FormattedMessage,{id:"teamBrowser.teamCard.leaveTeam.groupTooltip",defaultMessage:"{groupNames, plural, one {You can't leave this teamspace because you're a member of multiple groups, {groupNames}.} other {You can't leave this teamspace because you're a member of the group, {groupNames}.}}",values:{groupNames:u.oA(s.map((e=>e.name))).join()}})}({isDefaultTeam:r,isOnlyTeamOwner:g,userGroups:d})}({teamStore:t}),k=Boolean(R),B=k?R:x;return(0,f.jsx)(d.ZP,{style:k?{width:240}:void 0,disableTooltip:!Boolean(B),renderTooltip:e=>(0,f.jsx)("div",{...e,children:B}),textWrap:k,placement:T,alignment:M,render:e=>(0,f.jsx)(m.Z,{...e,style:v,hoveredStyle:S,onClick:I,disabled:k,disabledFeedback:k,icon:y,isRed:h,children:b||(0,f.jsxs)(f.Fragment,{children:[(0,r.e)({width:12.5,marginRight:4}),(0,f.jsx)(l.FormattedMessage,{id:"teamBrowser.teamCard.button.joined",defaultMessage:"Joined"})]})})})}},14889:(e,t,a)=>{a.d(t,{Z:()=>p});var s=a(67294),n=a(480),o=a(24405),r=a(9291),i=a(74194),l=a(50506),u=a(58297),m=a(64369),d=a(49204),c=a(74016),g=a(85893);const f=(0,r.defineMessages)({message_placeholder:{id:"teamInviteLinkRequestPage.message.placeholder",defaultMessage:"Message (optional)"}});const p=function(e){const{teamStore:t,teamName:a,teamId:p,isModalOpen:v,onDismiss:S}=e,[y,h]=(0,s.useState)(""),T=(0,n.O7)(),M=(0,r.useIntl)(),b=async()=>{await d.Px({environment:T,teamId:p,message:y}),S()},j=(0,o.yK)((()=>({modal:{alignSelf:"center",overflow:"visible",padding:15,width:420},requestTitle:{display:"inline-flex",marginBottom:10},icon:{marginLeft:4,marginRight:4},footer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:15},requestInvitesButton:{marginLeft:20},input:{padding:8}})),[]);return(0,g.jsx)(l.Z,{open:v,onDismiss:S,innerStyle:j.modal,preventHideChildrenWhileOpening:!0,render:()=>(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{style:j.requestTitle,children:(0,g.jsx)(r.FormattedMessage,{id:"teamInviteLinkRequestModal.reasonForRequest.title",defaultMessage:"Request access to {icon} {teamName}",values:{teamName:a,icon:(0,g.jsx)(c.p,{style:j.icon,store:t,disabled:!0,size:22})}})}),(0,g.jsx)(i.Z,{textarea:!0,style:j.input,value:y,onChange:e=>{h(e.target.value)},placeholder:M.formatMessage(f.message_placeholder)}),(0,g.jsxs)("div",{style:j.footer,children:[(0,g.jsx)(m.Z,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,g.jsx)(r.FormattedMessage,{id:"teamInviteLinkRequestModal.caption",defaultMessage:"Your teamspace owners will approve or decline your request."})}),(0,g.jsx)(u.Z,{isLarge:!0,style:j.requestInvitesButton,onClick:b,children:(0,g.jsx)(r.FormattedMessage,{id:"teamInviteLinkRequestModal.requestAccessButton.label",defaultMessage:"Request"})})]})]})})}},1083:(e,t,a)=>{a.d(t,{Q:()=>l});var s=a(480),n=a(86628),o=a(48779),r=a(80444),i=a(88280);function l(){const e=function(){const e=(0,s.O7)();return(0,n.VK)((()=>{const t=r.default.state.currentSpaceStore,a=i.subscriptionDataStoreInstance.state;return t?o.Cx(t)?a?{loading:!1,isUserTeamGuestOfSpace:o.di(e,a)}:{loading:!0}:{loading:!1,isUserTeamGuestOfSpace:!1}:{loading:!0}}),[e])}();return(0,n.VK)((()=>e.loading||e.isUserTeamGuestOfSpace),[e])}},64552:(e,t,a)=>{a.d(t,{e:()=>i});var s=a(480),n=a(86628),o=a(95697),r=a(80444);function i(e){const t=(0,s.O7)(),a=(0,n.VK)((()=>r.default.state.currentSpaceStore),[]);return(0,n.VK)((()=>(0,o.AL)({teamStore:e,spaceStore:a,userId:t.currentUser.id})),[a,t.currentUser.id,e])}}}]);